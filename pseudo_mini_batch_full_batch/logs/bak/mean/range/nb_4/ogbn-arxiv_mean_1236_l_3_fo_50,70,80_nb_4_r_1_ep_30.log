Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1647779062.5398617
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026854753494262695
range selection method range initialization spend 0.01375269889831543
time for parepare:  0.018273353576660156
local_output_nid generation:  0.005312681198120117
local_in_edges_tensor generation:  0.0064275264739990234
mini_batch_src_global generation:  0.0074863433837890625
r_  generation:  0.09028077125549316
local_output_nid generation:  0.006055116653442383
local_in_edges_tensor generation:  0.003124237060546875
mini_batch_src_global generation:  0.009794235229492188
r_  generation:  0.09766983985900879
local_output_nid generation:  0.006098031997680664
local_in_edges_tensor generation:  0.0031697750091552734
mini_batch_src_global generation:  0.007712841033935547
r_  generation:  0.09967875480651855
local_output_nid generation:  0.006150484085083008
local_in_edges_tensor generation:  0.0032567977905273438
mini_batch_src_global generation:  0.008337020874023438
r_  generation:  0.10343432426452637
----------------------check_connections_block total spend ----------------------------- 0.5620160102844238
generate_one_block  0.11410212516784668
generate_one_block  0.11575913429260254
generate_one_block  0.11594033241271973
generate_one_block  0.11836075782775879
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.044847726821899414
gen group dst list time:  0.012198209762573242
time for parepare:  0.01941370964050293
local_output_nid generation:  0.01501011848449707
local_in_edges_tensor generation:  0.040477752685546875
mini_batch_src_global generation:  0.0487060546875
r_  generation:  0.4670431613922119
local_output_nid generation:  0.02430438995361328
local_in_edges_tensor generation:  0.04253196716308594
mini_batch_src_global generation:  0.056691884994506836
r_  generation:  0.49225735664367676
local_output_nid generation:  0.025555133819580078
local_in_edges_tensor generation:  0.0309600830078125
mini_batch_src_global generation:  0.057282447814941406
r_  generation:  0.49295544624328613
local_output_nid generation:  0.02630758285522461
local_in_edges_tensor generation:  0.030351638793945312
mini_batch_src_global generation:  0.06089901924133301
r_  generation:  0.48561573028564453
----------------------check_connections_block total spend ----------------------------- 2.821962594985962
generate_one_block  0.6518511772155762
generate_one_block  0.6401772499084473
generate_one_block  0.6199278831481934
generate_one_block  0.6355020999908447
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03184986114501953
gen group dst list time:  0.021863937377929688
time for parepare:  0.019069194793701172
local_output_nid generation:  0.02399158477783203
local_in_edges_tensor generation:  0.04233074188232422
mini_batch_src_global generation:  0.05339670181274414
r_  generation:  0.5594346523284912
local_output_nid generation:  0.034217119216918945
local_in_edges_tensor generation:  0.05254411697387695
mini_batch_src_global generation:  0.07012557983398438
r_  generation:  0.5705876350402832
local_output_nid generation:  0.035871028900146484
local_in_edges_tensor generation:  0.03945493698120117
mini_batch_src_global generation:  0.0696249008178711
r_  generation:  0.5787804126739502
local_output_nid generation:  0.036556243896484375
local_in_edges_tensor generation:  0.033236026763916016
mini_batch_src_global generation:  0.06474113464355469
r_  generation:  0.5731992721557617
----------------------check_connections_block total spend ----------------------------- 3.356325626373291
generate_one_block  0.7315855026245117
generate_one_block  0.7402920722961426
generate_one_block  0.7473850250244141
generate_one_block  0.7207467555999756
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  6.178288221359253
block generation total time  5.4874677658081055
average batch blocks generation time:  1.3718669414520264
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.1071619987487793  GigaBytes
Max Memory Allocated: 0.1071619987487793  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 1.1406102180480957  GigaBytes
Max Memory Allocated: 1.234022617340088  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1346435546875 GB
    Memory Allocated: 0.1111903190612793  GigaBytes
Max Memory Allocated: 1.3437457084655762  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1346435546875 GB
    Memory Allocated: 1.1461548805236816  GigaBytes
Max Memory Allocated: 1.3437457084655762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1346435546875 GB
    Memory Allocated: 0.11128854751586914  GigaBytes
Max Memory Allocated: 1.3513951301574707  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1346435546875 GB
    Memory Allocated: 1.1436114311218262  GigaBytes
Max Memory Allocated: 1.3513951301574707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1346435546875 GB
    Memory Allocated: 0.11223173141479492  GigaBytes
Max Memory Allocated: 1.3513951301574707  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1346435546875 GB
    Memory Allocated: 1.1412792205810547  GigaBytes
Max Memory Allocated: 1.3513951301574707  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06942594051361084 |0.08435499668121338 |0.1917428970336914 |0.0001437067985534668 |0.01324230432510376 |0.0045621395111083984 |
----------------------------------------------------------pseudo_mini_loss sum 6.173440456390381
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1721962
Number of first layer input nodes during this epoch:  662926
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1365966796875 GB
    Memory Allocated: 0.1556539535522461  GigaBytes
Max Memory Allocated: 1.3513951301574707  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02262258529663086
range selection method range initialization spend 0.012201547622680664
time for parepare:  0.017998218536376953
local_output_nid generation:  0.005277156829833984
local_in_edges_tensor generation:  0.006464242935180664
mini_batch_src_global generation:  0.011182546615600586
r_  generation:  0.09419655799865723
local_output_nid generation:  0.006112098693847656
local_in_edges_tensor generation:  0.005155801773071289
mini_batch_src_global generation:  0.009786844253540039
r_  generation:  0.0984807014465332
local_output_nid generation:  0.006137371063232422
local_in_edges_tensor generation:  0.0032813549041748047
mini_batch_src_global generation:  0.007516622543334961
r_  generation:  0.10152316093444824
local_output_nid generation:  0.00616145133972168
local_in_edges_tensor generation:  0.0032067298889160156
mini_batch_src_global generation:  0.008414983749389648
r_  generation:  0.10932183265686035
----------------------check_connections_block total spend ----------------------------- 0.5911290645599365
generate_one_block  0.11764049530029297
generate_one_block  0.11382627487182617
generate_one_block  0.11475467681884766
generate_one_block  0.11573386192321777
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06413555145263672
gen group dst list time:  0.01166677474975586
time for parepare:  0.02314472198486328
local_output_nid generation:  0.014848947525024414
local_in_edges_tensor generation:  0.05992531776428223
mini_batch_src_global generation:  0.0492091178894043
r_  generation:  0.4676847457885742
local_output_nid generation:  0.022285938262939453
local_in_edges_tensor generation:  0.04288053512573242
mini_batch_src_global generation:  0.05545854568481445
r_  generation:  0.47380542755126953
local_output_nid generation:  0.023171186447143555
local_in_edges_tensor generation:  0.031511783599853516
mini_batch_src_global generation:  0.05612635612487793
r_  generation:  0.49123454093933105
local_output_nid generation:  0.023566246032714844
local_in_edges_tensor generation:  0.035660505294799805
mini_batch_src_global generation:  0.060552358627319336
r_  generation:  0.4892733097076416
----------------------check_connections_block total spend ----------------------------- 2.8331801891326904
generate_one_block  0.6489307880401611
generate_one_block  0.6252682209014893
generate_one_block  0.6547296047210693
generate_one_block  0.6485540866851807
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.047150373458862305
gen group dst list time:  0.02333855628967285
time for parepare:  0.020585060119628906
local_output_nid generation:  0.025172710418701172
local_in_edges_tensor generation:  0.05246329307556152
mini_batch_src_global generation:  0.057634592056274414
r_  generation:  0.5808520317077637
local_output_nid generation:  0.037915945053100586
local_in_edges_tensor generation:  0.05626106262207031
mini_batch_src_global generation:  0.06754636764526367
r_  generation:  0.5634772777557373
local_output_nid generation:  0.03630232810974121
local_in_edges_tensor generation:  0.045021772384643555
mini_batch_src_global generation:  0.06791257858276367
r_  generation:  0.5753602981567383
local_output_nid generation:  0.035980224609375
local_in_edges_tensor generation:  0.051303863525390625
mini_batch_src_global generation:  0.06444168090820312
r_  generation:  0.5808582305908203
----------------------check_connections_block total spend ----------------------------- 3.416501045227051
generate_one_block  0.7303082942962646
generate_one_block  0.7339518070220947
generate_one_block  0.748154878616333
generate_one_block  0.742046594619751
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1365966796875 GB
    Memory Allocated: 0.1556539535522461  GigaBytes
Max Memory Allocated: 1.3513951301574707  GigaBytes

connection checking time:  6.249681234359741
block generation total time  5.531944274902344
average batch blocks generation time:  1.382986068725586
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1365966796875 GB
    Memory Allocated: 0.11282682418823242  GigaBytes
Max Memory Allocated: 1.3513951301574707  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1365966796875 GB
    Memory Allocated: 1.1475310325622559  GigaBytes
Max Memory Allocated: 1.3513951301574707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.1128854751586914  GigaBytes
Max Memory Allocated: 1.3525714874267578  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1443748474121094  GigaBytes
Max Memory Allocated: 1.3525714874267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11385536193847656  GigaBytes
Max Memory Allocated: 1.3525714874267578  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1478123664855957  GigaBytes
Max Memory Allocated: 1.3525714874267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11284875869750977  GigaBytes
Max Memory Allocated: 1.353579044342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1476655006408691  GigaBytes
Max Memory Allocated: 1.353579044342041  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08259075880050659 |0.025477290153503418 |0.0035955309867858887 |0.00010198354721069336 |0.017198562622070312 |0.001699209213256836 |
----------------------------------------------------------pseudo_mini_loss sum 3.241649627685547
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1722887
Number of first layer input nodes during this epoch:  662888
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.15545177459716797  GigaBytes
Max Memory Allocated: 1.353579044342041  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03765106201171875
range selection method range initialization spend 0.01180887222290039
time for parepare:  0.017386913299560547
local_output_nid generation:  0.005358457565307617
local_in_edges_tensor generation:  0.00943136215209961
mini_batch_src_global generation:  0.008057594299316406
r_  generation:  0.09360766410827637
local_output_nid generation:  0.0061528682708740234
local_in_edges_tensor generation:  0.0032694339752197266
mini_batch_src_global generation:  0.010053634643554688
r_  generation:  0.09743976593017578
local_output_nid generation:  0.00620722770690918
local_in_edges_tensor generation:  0.0032720565795898438
mini_batch_src_global generation:  0.008319854736328125
r_  generation:  0.10321736335754395
local_output_nid generation:  0.006203889846801758
local_in_edges_tensor generation:  0.0032987594604492188
mini_batch_src_global generation:  0.008291244506835938
r_  generation:  0.10457491874694824
----------------------check_connections_block total spend ----------------------------- 0.5739626884460449
generate_one_block  0.1182243824005127
generate_one_block  0.11533093452453613
generate_one_block  0.11953067779541016
generate_one_block  0.1159214973449707
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04417896270751953
gen group dst list time:  0.012145042419433594
time for parepare:  0.01956033706665039
local_output_nid generation:  0.01591205596923828
local_in_edges_tensor generation:  0.036830902099609375
mini_batch_src_global generation:  0.04880714416503906
r_  generation:  0.472888708114624
local_output_nid generation:  0.02347254753112793
local_in_edges_tensor generation:  0.03424239158630371
mini_batch_src_global generation:  0.05612540245056152
r_  generation:  0.48345446586608887
local_output_nid generation:  0.024247407913208008
local_in_edges_tensor generation:  0.03242158889770508
mini_batch_src_global generation:  0.05614471435546875
r_  generation:  0.49045753479003906
local_output_nid generation:  0.02390122413635254
local_in_edges_tensor generation:  0.034598588943481445
mini_batch_src_global generation:  0.05629086494445801
r_  generation:  0.487354040145874
----------------------check_connections_block total spend ----------------------------- 2.8037703037261963
generate_one_block  0.6246471405029297
generate_one_block  0.6292176246643066
generate_one_block  0.6518774032592773
generate_one_block  0.6151213645935059
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.044879913330078125
gen group dst list time:  0.022484540939331055
time for parepare:  0.019399166107177734
local_output_nid generation:  0.027597427368164062
local_in_edges_tensor generation:  0.04198169708251953
mini_batch_src_global generation:  0.05935978889465332
r_  generation:  0.5613880157470703
local_output_nid generation:  0.03659486770629883
local_in_edges_tensor generation:  0.04223465919494629
mini_batch_src_global generation:  0.06535863876342773
r_  generation:  0.5697650909423828
local_output_nid generation:  0.03471541404724121
local_in_edges_tensor generation:  0.041445255279541016
mini_batch_src_global generation:  0.06650495529174805
r_  generation:  0.5722596645355225
local_output_nid generation:  0.03470563888549805
local_in_edges_tensor generation:  0.04196310043334961
mini_batch_src_global generation:  0.06384706497192383
r_  generation:  0.5723657608032227
----------------------check_connections_block total spend ----------------------------- 3.342323064804077
generate_one_block  0.746518611907959
generate_one_block  0.7297818660736084
generate_one_block  0.7301743030548096
generate_one_block  0.7357256412506104
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.15545177459716797  GigaBytes
Max Memory Allocated: 1.353579044342041  GigaBytes

connection checking time:  6.146093368530273
block generation total time  5.463063955307007
average batch blocks generation time:  1.3657659888267517
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11299800872802734  GigaBytes
Max Memory Allocated: 1.353579044342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1500325202941895  GigaBytes
Max Memory Allocated: 1.353579044342041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11383295059204102  GigaBytes
Max Memory Allocated: 1.3552541732788086  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1437249183654785  GigaBytes
Max Memory Allocated: 1.3552541732788086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11286401748657227  GigaBytes
Max Memory Allocated: 1.3552541732788086  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1484456062316895  GigaBytes
Max Memory Allocated: 1.3552541732788086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11277103424072266  GigaBytes
Max Memory Allocated: 1.3552541732788086  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1401028633117676  GigaBytes
Max Memory Allocated: 1.3552541732788086  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06232661008834839 |0.025432825088500977 |0.00880897045135498 |9.655952453613281e-05 |0.027765750885009766 |0.0015287399291992188 |
----------------------------------------------------------pseudo_mini_loss sum 2.608640432357788
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  1722258
Number of first layer input nodes during this epoch:  662671
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.1561436653137207  GigaBytes
Max Memory Allocated: 1.3552541732788086  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022227048873901367
range selection method range initialization spend 0.012062549591064453
time for parepare:  0.016721248626708984
local_output_nid generation:  0.005390644073486328
local_in_edges_tensor generation:  0.008580923080444336
mini_batch_src_global generation:  0.007695674896240234
r_  generation:  0.09126734733581543
local_output_nid generation:  0.006046772003173828
local_in_edges_tensor generation:  0.003234386444091797
mini_batch_src_global generation:  0.009602785110473633
r_  generation:  0.09723043441772461
local_output_nid generation:  0.006139039993286133
local_in_edges_tensor generation:  0.0034034252166748047
mini_batch_src_global generation:  0.0076868534088134766
r_  generation:  0.10181975364685059
local_output_nid generation:  0.0061626434326171875
local_in_edges_tensor generation:  0.0056002140045166016
mini_batch_src_global generation:  0.00848698616027832
r_  generation:  0.10545182228088379
----------------------check_connections_block total spend ----------------------------- 0.571436882019043
generate_one_block  0.12378072738647461
generate_one_block  0.11352062225341797
generate_one_block  0.1174156665802002
generate_one_block  0.1169118881225586
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06145977973937988
gen group dst list time:  0.011689901351928711
time for parepare:  0.019394874572753906
local_output_nid generation:  0.016304731369018555
local_in_edges_tensor generation:  0.0457913875579834
mini_batch_src_global generation:  0.04799389839172363
r_  generation:  0.4695894718170166
local_output_nid generation:  0.023981094360351562
local_in_edges_tensor generation:  0.027693986892700195
mini_batch_src_global generation:  0.05612063407897949
r_  generation:  0.484325647354126
local_output_nid generation:  0.0236966609954834
local_in_edges_tensor generation:  0.02772068977355957
mini_batch_src_global generation:  0.05659341812133789
r_  generation:  0.4893667697906494
local_output_nid generation:  0.02411961555480957
local_in_edges_tensor generation:  0.031524658203125
mini_batch_src_global generation:  0.05777382850646973
r_  generation:  0.4916038513183594
----------------------check_connections_block total spend ----------------------------- 2.798020362854004
generate_one_block  0.6177265644073486
generate_one_block  0.6200933456420898
generate_one_block  0.6503028869628906
generate_one_block  0.6236205101013184
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03119039535522461
gen group dst list time:  0.021756410598754883
time for parepare:  0.020084381103515625
local_output_nid generation:  0.02517533302307129
local_in_edges_tensor generation:  0.04200339317321777
mini_batch_src_global generation:  0.05316352844238281
r_  generation:  0.5676019191741943
local_output_nid generation:  0.03393125534057617
local_in_edges_tensor generation:  0.03571581840515137
mini_batch_src_global generation:  0.06572270393371582
r_  generation:  0.5713772773742676
local_output_nid generation:  0.03465461730957031
local_in_edges_tensor generation:  0.036995649337768555
mini_batch_src_global generation:  0.0678563117980957
r_  generation:  0.5826854705810547
local_output_nid generation:  0.03497791290283203
local_in_edges_tensor generation:  0.03836250305175781
mini_batch_src_global generation:  0.06374692916870117
r_  generation:  0.5794446468353271
----------------------check_connections_block total spend ----------------------------- 3.343766689300537
generate_one_block  0.7172951698303223
generate_one_block  0.7195103168487549
generate_one_block  0.7222692966461182
generate_one_block  0.7294051647186279
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.1561436653137207  GigaBytes
Max Memory Allocated: 1.3552541732788086  GigaBytes

connection checking time:  6.141787052154541
block generation total time  5.400223255157471
average batch blocks generation time:  1.3500558137893677
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11395549774169922  GigaBytes
Max Memory Allocated: 1.3552541732788086  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.144089698791504  GigaBytes
Max Memory Allocated: 1.3552541732788086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11267566680908203  GigaBytes
Max Memory Allocated: 1.3552541732788086  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1415963172912598  GigaBytes
Max Memory Allocated: 1.3552541732788086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11309289932250977  GigaBytes
Max Memory Allocated: 1.3552541732788086  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1503643989562988  GigaBytes
Max Memory Allocated: 1.3552541732788086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11381196975708008  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.143747329711914  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09159094095230103 |0.01619488000869751 |0.0035200119018554688 |9.620189666748047e-05 |0.0037375688552856445 |0.0016276836395263672 |
----------------------------------------------------------pseudo_mini_loss sum 2.3799076080322266
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  1722459
Number of first layer input nodes during this epoch:  663129
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.1556682586669922  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022249460220336914
range selection method range initialization spend 0.011853933334350586
time for parepare:  0.01688694953918457
local_output_nid generation:  0.00535893440246582
local_in_edges_tensor generation:  0.006037235260009766
mini_batch_src_global generation:  0.007660865783691406
r_  generation:  0.08977103233337402
local_output_nid generation:  0.006169319152832031
local_in_edges_tensor generation:  0.0032007694244384766
mini_batch_src_global generation:  0.010125398635864258
r_  generation:  0.09925150871276855
local_output_nid generation:  0.006159067153930664
local_in_edges_tensor generation:  0.0032863616943359375
mini_batch_src_global generation:  0.007812023162841797
r_  generation:  0.10127067565917969
local_output_nid generation:  0.006255626678466797
local_in_edges_tensor generation:  0.0033597946166992188
mini_batch_src_global generation:  0.00851297378540039
r_  generation:  0.10370826721191406
----------------------check_connections_block total spend ----------------------------- 0.5649964809417725
generate_one_block  0.11180806159973145
generate_one_block  0.11496424674987793
generate_one_block  0.11602497100830078
generate_one_block  0.11553454399108887
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03199195861816406
gen group dst list time:  0.011780500411987305
time for parepare:  0.01926112174987793
local_output_nid generation:  0.015969276428222656
local_in_edges_tensor generation:  0.0404355525970459
mini_batch_src_global generation:  0.046555519104003906
r_  generation:  0.4673187732696533
local_output_nid generation:  0.0239565372467041
local_in_edges_tensor generation:  0.02548050880432129
mini_batch_src_global generation:  0.05696415901184082
r_  generation:  0.48023557662963867
local_output_nid generation:  0.02387070655822754
local_in_edges_tensor generation:  0.028882503509521484
mini_batch_src_global generation:  0.05682778358459473
r_  generation:  0.4877622127532959
local_output_nid generation:  0.024469375610351562
local_in_edges_tensor generation:  0.028372764587402344
mini_batch_src_global generation:  0.05761909484863281
r_  generation:  0.487154483795166
----------------------check_connections_block total spend ----------------------------- 2.776780605316162
generate_one_block  0.6237881183624268
generate_one_block  0.6258981227874756
generate_one_block  0.6450552940368652
generate_one_block  0.6258504390716553
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03319525718688965
gen group dst list time:  0.02174687385559082
time for parepare:  0.019239425659179688
local_output_nid generation:  0.025278091430664062
local_in_edges_tensor generation:  0.041959285736083984
mini_batch_src_global generation:  0.05329251289367676
r_  generation:  0.5617964267730713
local_output_nid generation:  0.03390693664550781
local_in_edges_tensor generation:  0.03818106651306152
mini_batch_src_global generation:  0.06650686264038086
r_  generation:  0.5709831714630127
local_output_nid generation:  0.03539538383483887
local_in_edges_tensor generation:  0.03776216506958008
mini_batch_src_global generation:  0.06631779670715332
r_  generation:  0.5688974857330322
local_output_nid generation:  0.035355567932128906
local_in_edges_tensor generation:  0.03593778610229492
mini_batch_src_global generation:  0.06484866142272949
r_  generation:  0.5692622661590576
----------------------check_connections_block total spend ----------------------------- 3.3215224742889404
generate_one_block  0.7253303527832031
generate_one_block  0.7313985824584961
generate_one_block  0.7327747344970703
generate_one_block  0.7287700176239014
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.1556682586669922  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

connection checking time:  6.0983030796051025
block generation total time  5.438865661621094
average batch blocks generation time:  1.3597164154052734
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11275434494018555  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1435575485229492  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11291980743408203  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1458077430725098  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11395740509033203  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.148226261138916  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11274433135986328  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1440234184265137  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09589248895645142 |0.029085874557495117 |0.003493189811706543 |8.690357208251953e-05 |0.0037027597427368164 |0.001622915267944336 |
----------------------------------------------------------pseudo_mini_loss sum 2.116619348526001
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  1722233
Number of first layer input nodes during this epoch:  662737
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.15526056289672852  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020978689193725586
range selection method range initialization spend 0.012891292572021484
time for parepare:  0.01796555519104004
local_output_nid generation:  0.005395650863647461
local_in_edges_tensor generation:  0.006521701812744141
mini_batch_src_global generation:  0.007525444030761719
r_  generation:  0.0901784896850586
local_output_nid generation:  0.006136894226074219
local_in_edges_tensor generation:  0.0035254955291748047
mini_batch_src_global generation:  0.010239839553833008
r_  generation:  0.10073089599609375
local_output_nid generation:  0.006265163421630859
local_in_edges_tensor generation:  0.0032629966735839844
mini_batch_src_global generation:  0.007672786712646484
r_  generation:  0.10004734992980957
local_output_nid generation:  0.006329774856567383
local_in_edges_tensor generation:  0.003219127655029297
mini_batch_src_global generation:  0.008249044418334961
r_  generation:  0.10289955139160156
----------------------check_connections_block total spend ----------------------------- 0.5657596588134766
generate_one_block  0.11342310905456543
generate_one_block  0.11591482162475586
generate_one_block  0.11518740653991699
generate_one_block  0.11548590660095215
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04540419578552246
gen group dst list time:  0.011617660522460938
time for parepare:  0.019216299057006836
local_output_nid generation:  0.016260147094726562
local_in_edges_tensor generation:  0.03487133979797363
mini_batch_src_global generation:  0.04706621170043945
r_  generation:  0.4702897071838379
local_output_nid generation:  0.023272037506103516
local_in_edges_tensor generation:  0.030751943588256836
mini_batch_src_global generation:  0.05724811553955078
r_  generation:  0.4859597682952881
local_output_nid generation:  0.023681163787841797
local_in_edges_tensor generation:  0.02527928352355957
mini_batch_src_global generation:  0.0558469295501709
r_  generation:  0.4877653121948242
local_output_nid generation:  0.02384805679321289
local_in_edges_tensor generation:  0.026865243911743164
mini_batch_src_global generation:  0.056670188903808594
r_  generation:  0.488537073135376
----------------------check_connections_block total spend ----------------------------- 2.7806344032287598
generate_one_block  0.632606029510498
generate_one_block  0.6275918483734131
generate_one_block  0.6434521675109863
generate_one_block  0.6155378818511963
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03523135185241699
gen group dst list time:  0.021619081497192383
time for parepare:  0.01894354820251465
local_output_nid generation:  0.02505779266357422
local_in_edges_tensor generation:  0.03668951988220215
mini_batch_src_global generation:  0.05355215072631836
r_  generation:  0.5626130104064941
local_output_nid generation:  0.033590078353881836
local_in_edges_tensor generation:  0.0415959358215332
mini_batch_src_global generation:  0.06441259384155273
r_  generation:  0.564063310623169
local_output_nid generation:  0.03474712371826172
local_in_edges_tensor generation:  0.0404210090637207
mini_batch_src_global generation:  0.06393575668334961
r_  generation:  0.5689010620117188
local_output_nid generation:  0.034723520278930664
local_in_edges_tensor generation:  0.03571796417236328
mini_batch_src_global generation:  0.06343531608581543
r_  generation:  0.5726361274719238
----------------------check_connections_block total spend ----------------------------- 3.3005175590515137
generate_one_block  0.721921443939209
generate_one_block  0.7237458229064941
generate_one_block  0.7245149612426758
generate_one_block  0.7217557430267334
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.15526056289672852  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

connection checking time:  6.081151962280273
block generation total time  5.411125898361206
average batch blocks generation time:  1.3527814745903015
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11300134658813477  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1456398963928223  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11400842666625977  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1488189697265625  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11275625228881836  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1428217887878418  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11294698715209961  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1449055671691895  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09039723873138428 |0.01593303680419922 |0.0035452842712402344 |9.304285049438477e-05 |0.0033048391342163086 |0.0028312206268310547 |
----------------------------------------------------------pseudo_mini_loss sum 1.9595355987548828
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  1722789
Number of first layer input nodes during this epoch:  663169
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.15730047225952148  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018415212631225586
range selection method range initialization spend 0.011717557907104492
time for parepare:  0.017969131469726562
local_output_nid generation:  0.005379199981689453
local_in_edges_tensor generation:  0.005641460418701172
mini_batch_src_global generation:  0.007570505142211914
r_  generation:  0.09103822708129883
local_output_nid generation:  0.0060787200927734375
local_in_edges_tensor generation:  0.0031926631927490234
mini_batch_src_global generation:  0.009799957275390625
r_  generation:  0.09979510307312012
local_output_nid generation:  0.006170511245727539
local_in_edges_tensor generation:  0.0032105445861816406
mini_batch_src_global generation:  0.007701873779296875
r_  generation:  0.10236096382141113
local_output_nid generation:  0.0061228275299072266
local_in_edges_tensor generation:  0.0031986236572265625
mini_batch_src_global generation:  0.008138656616210938
r_  generation:  0.10622072219848633
----------------------check_connections_block total spend ----------------------------- 0.5689125061035156
generate_one_block  0.11375689506530762
generate_one_block  0.11498069763183594
generate_one_block  0.11673355102539062
generate_one_block  0.11668968200683594
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02852654457092285
gen group dst list time:  0.011891365051269531
time for parepare:  0.019041061401367188
local_output_nid generation:  0.01604938507080078
local_in_edges_tensor generation:  0.029162883758544922
mini_batch_src_global generation:  0.04434394836425781
r_  generation:  0.46680355072021484
local_output_nid generation:  0.023438453674316406
local_in_edges_tensor generation:  0.024374961853027344
mini_batch_src_global generation:  0.055937767028808594
r_  generation:  0.4815850257873535
local_output_nid generation:  0.02385735511779785
local_in_edges_tensor generation:  0.026803970336914062
mini_batch_src_global generation:  0.05547952651977539
r_  generation:  0.48642945289611816
local_output_nid generation:  0.024265289306640625
local_in_edges_tensor generation:  0.02573871612548828
mini_batch_src_global generation:  0.0562748908996582
r_  generation:  0.490401029586792
----------------------check_connections_block total spend ----------------------------- 2.750749111175537
generate_one_block  0.6145272254943848
generate_one_block  0.6198179721832275
generate_one_block  0.6434826850891113
generate_one_block  0.6177563667297363
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029009342193603516
gen group dst list time:  0.021630048751831055
time for parepare:  0.019058942794799805
local_output_nid generation:  0.02518916130065918
local_in_edges_tensor generation:  0.03654909133911133
mini_batch_src_global generation:  0.05178666114807129
r_  generation:  0.5587244033813477
local_output_nid generation:  0.03393673896789551
local_in_edges_tensor generation:  0.03473496437072754
mini_batch_src_global generation:  0.06479763984680176
r_  generation:  0.566957950592041
local_output_nid generation:  0.034773826599121094
local_in_edges_tensor generation:  0.036039113998413086
mini_batch_src_global generation:  0.06431126594543457
r_  generation:  0.5687782764434814
local_output_nid generation:  0.0350186824798584
local_in_edges_tensor generation:  0.036418914794921875
mini_batch_src_global generation:  0.0635988712310791
r_  generation:  0.5724663734436035
----------------------check_connections_block total spend ----------------------------- 3.2902042865753174
generate_one_block  0.721215009689331
generate_one_block  0.7155945301055908
generate_one_block  0.7114009857177734
generate_one_block  0.7172658443450928
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.15730047225952148  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

connection checking time:  6.0409533977508545
block generation total time  5.361060619354248
average batch blocks generation time:  1.340265154838562
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11382007598876953  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1481800079345703  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11281538009643555  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1439075469970703  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11295223236083984  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1449317932128906  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11390972137451172  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1479520797729492  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08923375606536865 |0.015740513801574707 |0.0033233165740966797 |8.618831634521484e-05 |0.003319978713989258 |0.0027513504028320312 |
----------------------------------------------------------pseudo_mini_loss sum 1.8769999742507935
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  1722982
Number of first layer input nodes during this epoch:  662983
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.15571069717407227  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019868135452270508
range selection method range initialization spend 0.011722803115844727
time for parepare:  0.016840696334838867
local_output_nid generation:  0.005347251892089844
local_in_edges_tensor generation:  0.005601167678833008
mini_batch_src_global generation:  0.007509469985961914
r_  generation:  0.08953189849853516
local_output_nid generation:  0.0061566829681396484
local_in_edges_tensor generation:  0.0031423568725585938
mini_batch_src_global generation:  0.00978231430053711
r_  generation:  0.097503662109375
local_output_nid generation:  0.00609588623046875
local_in_edges_tensor generation:  0.0031871795654296875
mini_batch_src_global generation:  0.007811546325683594
r_  generation:  0.1010289192199707
local_output_nid generation:  0.006150484085083008
local_in_edges_tensor generation:  0.0032117366790771484
mini_batch_src_global generation:  0.008221149444580078
r_  generation:  0.10390853881835938
----------------------check_connections_block total spend ----------------------------- 0.5605309009552002
generate_one_block  0.11121225357055664
generate_one_block  0.11477279663085938
generate_one_block  0.11789512634277344
generate_one_block  0.11674642562866211
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030941247940063477
gen group dst list time:  0.011716842651367188
time for parepare:  0.019441843032836914
local_output_nid generation:  0.01599287986755371
local_in_edges_tensor generation:  0.02663397789001465
mini_batch_src_global generation:  0.04424858093261719
r_  generation:  0.46647143363952637
local_output_nid generation:  0.024211406707763672
local_in_edges_tensor generation:  0.025768756866455078
mini_batch_src_global generation:  0.05533862113952637
r_  generation:  0.476818323135376
local_output_nid generation:  0.023645639419555664
local_in_edges_tensor generation:  0.028403043746948242
mini_batch_src_global generation:  0.05592823028564453
r_  generation:  0.4867703914642334
local_output_nid generation:  0.024250268936157227
local_in_edges_tensor generation:  0.02834010124206543
mini_batch_src_global generation:  0.05661296844482422
r_  generation:  0.49051499366760254
----------------------check_connections_block total spend ----------------------------- 2.7526397705078125
generate_one_block  0.6235954761505127
generate_one_block  0.6206760406494141
generate_one_block  0.6427888870239258
generate_one_block  0.6157374382019043
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029915571212768555
gen group dst list time:  0.021602392196655273
time for parepare:  0.019313812255859375
local_output_nid generation:  0.025259971618652344
local_in_edges_tensor generation:  0.04385781288146973
mini_batch_src_global generation:  0.053794145584106445
r_  generation:  0.5594203472137451
local_output_nid generation:  0.03405880928039551
local_in_edges_tensor generation:  0.03314042091369629
mini_batch_src_global generation:  0.06604313850402832
r_  generation:  0.5637717247009277
local_output_nid generation:  0.03509402275085449
local_in_edges_tensor generation:  0.04224753379821777
mini_batch_src_global generation:  0.06927061080932617
r_  generation:  0.5718588829040527
local_output_nid generation:  0.035468339920043945
local_in_edges_tensor generation:  0.045319557189941406
mini_batch_src_global generation:  0.07785415649414062
r_  generation:  0.576021671295166
----------------------check_connections_block total spend ----------------------------- 3.3475630283355713
generate_one_block  0.7181012630462646
generate_one_block  0.7222974300384521
generate_one_block  0.7200546264648438
generate_one_block  0.7251288890838623
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.15571069717407227  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

connection checking time:  6.100202798843384
block generation total time  5.38838005065918
average batch blocks generation time:  1.347095012664795
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11275863647460938  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1414742469787598  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11288642883300781  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1451172828674316  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11393880844116211  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1479215621948242  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11284017562866211  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1479921340942383  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09268742799758911 |0.021809041500091553 |0.0036082863807678223 |9.5367431640625e-05 |0.003431558609008789 |0.0013053417205810547 |
----------------------------------------------------------pseudo_mini_loss sum 1.8004578351974487
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  1722418
Number of first layer input nodes during this epoch:  662999
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.1553659439086914  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02251744270324707
range selection method range initialization spend 0.011787891387939453
time for parepare:  0.016941308975219727
local_output_nid generation:  0.005290508270263672
local_in_edges_tensor generation:  0.009668111801147461
mini_batch_src_global generation:  0.007510662078857422
r_  generation:  0.08890795707702637
local_output_nid generation:  0.006105899810791016
local_in_edges_tensor generation:  0.003612995147705078
mini_batch_src_global generation:  0.01007080078125
r_  generation:  0.09650254249572754
local_output_nid generation:  0.006226301193237305
local_in_edges_tensor generation:  0.0033435821533203125
mini_batch_src_global generation:  0.007807731628417969
r_  generation:  0.10057783126831055
local_output_nid generation:  0.006165266036987305
local_in_edges_tensor generation:  0.0032799243927001953
mini_batch_src_global generation:  0.008592605590820312
r_  generation:  0.10318946838378906
----------------------check_connections_block total spend ----------------------------- 0.5625395774841309
generate_one_block  0.11518430709838867
generate_one_block  0.11646270751953125
generate_one_block  0.11526298522949219
generate_one_block  0.11766386032104492
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04439496994018555
gen group dst list time:  0.011549949645996094
time for parepare:  0.019285202026367188
local_output_nid generation:  0.016076087951660156
local_in_edges_tensor generation:  0.03134036064147949
mini_batch_src_global generation:  0.0466306209564209
r_  generation:  0.4616117477416992
local_output_nid generation:  0.023894071578979492
local_in_edges_tensor generation:  0.03365802764892578
mini_batch_src_global generation:  0.05847430229187012
r_  generation:  0.4827389717102051
local_output_nid generation:  0.023354768753051758
local_in_edges_tensor generation:  0.02743363380432129
mini_batch_src_global generation:  0.05748605728149414
r_  generation:  0.483778715133667
local_output_nid generation:  0.02490067481994629
local_in_edges_tensor generation:  0.028902292251586914
mini_batch_src_global generation:  0.06955337524414062
r_  generation:  0.4910423755645752
----------------------check_connections_block total spend ----------------------------- 2.7911217212677
generate_one_block  0.6175565719604492
generate_one_block  0.6257796287536621
generate_one_block  0.6473314762115479
generate_one_block  0.626354455947876
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03794693946838379
gen group dst list time:  0.022241830825805664
time for parepare:  0.01895904541015625
local_output_nid generation:  0.024941205978393555
local_in_edges_tensor generation:  0.046691179275512695
mini_batch_src_global generation:  0.05217337608337402
r_  generation:  0.5561809539794922
local_output_nid generation:  0.0336918830871582
local_in_edges_tensor generation:  0.03259587287902832
mini_batch_src_global generation:  0.06551074981689453
r_  generation:  0.5635883808135986
local_output_nid generation:  0.035161733627319336
local_in_edges_tensor generation:  0.03656482696533203
mini_batch_src_global generation:  0.06892037391662598
r_  generation:  0.5737729072570801
local_output_nid generation:  0.03528141975402832
local_in_edges_tensor generation:  0.044909000396728516
mini_batch_src_global generation:  0.07650446891784668
r_  generation:  0.5770630836486816
----------------------check_connections_block total spend ----------------------------- 3.3386831283569336
generate_one_block  0.7273790836334229
generate_one_block  0.7290980815887451
generate_one_block  0.7424468994140625
generate_one_block  0.7273552417755127
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.1553659439086914  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

connection checking time:  6.129804849624634
block generation total time  5.443301439285278
average batch blocks generation time:  1.3608253598213196
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11278676986694336  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.14111328125  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11400127410888672  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1481246948242188  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11271953582763672  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1434321403503418  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11312389373779297  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1501736640930176  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09110170602798462 |0.019372224807739258 |0.003435671329498291 |9.179115295410156e-05 |0.0036287903785705566 |0.0038390159606933594 |
----------------------------------------------------------pseudo_mini_loss sum 1.7090851068496704
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  1722067
Number of first layer input nodes during this epoch:  662906
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.15767908096313477  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022737979888916016
range selection method range initialization spend 0.01200413703918457
time for parepare:  0.018672466278076172
local_output_nid generation:  0.00547027587890625
local_in_edges_tensor generation:  0.007051944732666016
mini_batch_src_global generation:  0.008083105087280273
r_  generation:  0.09055757522583008
local_output_nid generation:  0.006206035614013672
local_in_edges_tensor generation:  0.003265380859375
mini_batch_src_global generation:  0.00998687744140625
r_  generation:  0.09874725341796875
local_output_nid generation:  0.006157398223876953
local_in_edges_tensor generation:  0.0036106109619140625
mini_batch_src_global generation:  0.007924795150756836
r_  generation:  0.10185766220092773
local_output_nid generation:  0.006203651428222656
local_in_edges_tensor generation:  0.003172159194946289
mini_batch_src_global generation:  0.008439302444458008
r_  generation:  0.10521054267883301
----------------------check_connections_block total spend ----------------------------- 0.5702590942382812
generate_one_block  0.11220812797546387
generate_one_block  0.1162405014038086
generate_one_block  0.11594581604003906
generate_one_block  0.11682844161987305
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0324711799621582
gen group dst list time:  0.011789560317993164
time for parepare:  0.0194094181060791
local_output_nid generation:  0.015880346298217773
local_in_edges_tensor generation:  0.03261518478393555
mini_batch_src_global generation:  0.047043800354003906
r_  generation:  0.47582054138183594
local_output_nid generation:  0.023757219314575195
local_in_edges_tensor generation:  0.02836322784423828
mini_batch_src_global generation:  0.05628252029418945
r_  generation:  0.4931046962738037
local_output_nid generation:  0.023778676986694336
local_in_edges_tensor generation:  0.026764869689941406
mini_batch_src_global generation:  0.05962729454040527
r_  generation:  0.49617934226989746
local_output_nid generation:  0.028140544891357422
local_in_edges_tensor generation:  0.03578376770019531
mini_batch_src_global generation:  0.0576176643371582
r_  generation:  0.5309841632843018
----------------------check_connections_block total spend ----------------------------- 2.872014045715332
generate_one_block  0.6529214382171631
generate_one_block  0.6465163230895996
generate_one_block  0.6657505035400391
generate_one_block  0.6322722434997559
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03931617736816406
gen group dst list time:  0.023154258728027344
time for parepare:  0.019969940185546875
local_output_nid generation:  0.025791645050048828
local_in_edges_tensor generation:  0.05475187301635742
mini_batch_src_global generation:  0.055173397064208984
r_  generation:  0.5764520168304443
local_output_nid generation:  0.03415536880493164
local_in_edges_tensor generation:  0.042025089263916016
mini_batch_src_global generation:  0.06546926498413086
r_  generation:  0.5773165225982666
local_output_nid generation:  0.03586459159851074
local_in_edges_tensor generation:  0.04007720947265625
mini_batch_src_global generation:  0.06561017036437988
r_  generation:  0.5810537338256836
local_output_nid generation:  0.035599470138549805
local_in_edges_tensor generation:  0.05158829689025879
mini_batch_src_global generation:  0.07494497299194336
r_  generation:  0.5955145359039307
----------------------check_connections_block total spend ----------------------------- 3.4362690448760986
generate_one_block  0.7314705848693848
generate_one_block  0.7306938171386719
generate_one_block  0.7226216793060303
generate_one_block  0.7193639278411865
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.15767908096313477  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

connection checking time:  6.308283090591431
block generation total time  5.501610517501831
average batch blocks generation time:  1.3754026293754578
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11372184753417969  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1428956985473633  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11275434494018555  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.143000602722168  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.1130228042602539  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1496167182922363  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11384344100952148  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.147998332977295  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09022057056427002 |0.02404153347015381 |0.003556489944458008 |0.00010031461715698242 |0.003650963306427002 |0.003632068634033203 |
----------------------------------------------------------pseudo_mini_loss sum 1.6351951360702515
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  1722301
Number of first layer input nodes during this epoch:  662879
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.15576887130737305  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023524999618530273
range selection method range initialization spend 0.012037038803100586
time for parepare:  0.01834583282470703
local_output_nid generation:  0.00548863410949707
local_in_edges_tensor generation:  0.006959438323974609
mini_batch_src_global generation:  0.00791621208190918
r_  generation:  0.0925590991973877
local_output_nid generation:  0.006100893020629883
local_in_edges_tensor generation:  0.0031685829162597656
mini_batch_src_global generation:  0.00991058349609375
r_  generation:  0.10412144660949707
local_output_nid generation:  0.006593465805053711
local_in_edges_tensor generation:  0.003465414047241211
mini_batch_src_global generation:  0.007853269577026367
r_  generation:  0.10050559043884277
local_output_nid generation:  0.0066547393798828125
local_in_edges_tensor generation:  0.003723621368408203
mini_batch_src_global generation:  0.008537769317626953
r_  generation:  0.10367155075073242
----------------------check_connections_block total spend ----------------------------- 0.5810079574584961
generate_one_block  0.11450481414794922
generate_one_block  0.11366105079650879
generate_one_block  0.11711382865905762
generate_one_block  0.11641716957092285
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0386202335357666
gen group dst list time:  0.01178741455078125
time for parepare:  0.01932811737060547
local_output_nid generation:  0.01663041114807129
local_in_edges_tensor generation:  0.03958606719970703
mini_batch_src_global generation:  0.04562807083129883
r_  generation:  0.4712357521057129
local_output_nid generation:  0.02385854721069336
local_in_edges_tensor generation:  0.03520655632019043
mini_batch_src_global generation:  0.0561830997467041
r_  generation:  0.4894692897796631
local_output_nid generation:  0.02346038818359375
local_in_edges_tensor generation:  0.02803182601928711
mini_batch_src_global generation:  0.055922746658325195
r_  generation:  0.49930858612060547
local_output_nid generation:  0.02427530288696289
local_in_edges_tensor generation:  0.03244495391845703
mini_batch_src_global generation:  0.0569462776184082
r_  generation:  0.5005080699920654
----------------------check_connections_block total spend ----------------------------- 2.8235785961151123
generate_one_block  0.627418041229248
generate_one_block  0.6255021095275879
generate_one_block  0.658395528793335
generate_one_block  0.6434206962585449
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0344700813293457
gen group dst list time:  0.022691965103149414
time for parepare:  0.02106761932373047
local_output_nid generation:  0.02589893341064453
local_in_edges_tensor generation:  0.05101466178894043
mini_batch_src_global generation:  0.05252671241760254
r_  generation:  0.5774509906768799
local_output_nid generation:  0.03709745407104492
local_in_edges_tensor generation:  0.043871402740478516
mini_batch_src_global generation:  0.06600356101989746
r_  generation:  0.5716652870178223
local_output_nid generation:  0.0357213020324707
local_in_edges_tensor generation:  0.041399240493774414
mini_batch_src_global generation:  0.06545805931091309
r_  generation:  0.5829782485961914
local_output_nid generation:  0.03642773628234863
local_in_edges_tensor generation:  0.03719162940979004
mini_batch_src_global generation:  0.06351900100708008
r_  generation:  0.5752463340759277
----------------------check_connections_block total spend ----------------------------- 3.3790698051452637
generate_one_block  0.7392780780792236
generate_one_block  0.7323794364929199
generate_one_block  0.7286596298217773
generate_one_block  0.7407500743865967
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.15576887130737305  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

connection checking time:  6.202648401260376
block generation total time  5.495803594589233
average batch blocks generation time:  1.3739508986473083
block dataloader generation time/epoch 13.704796314239502
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11279869079589844  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1472749710083008  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11293220520019531  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.144402027130127  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11385250091552734  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1443018913269043  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11284017562866211  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1439228057861328  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09177607297897339 |0.024792075157165527 |0.0038071870803833008 |9.995698928833008e-05 |0.003300487995147705 |0.0016896724700927734 |
----------------------------------------------------------pseudo_mini_loss sum 1.58988618850708
Total (block generation + training)time/epoch 14.295696496963501
Training time/epoch 0.5906984806060791
Training time without block to device /epoch 0.491530179977417
Training time without total dataloading part /epoch 0.030520200729370117
load block tensor time/epoch 0.36710429191589355
block to device time/epoch 0.09916830062866211
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  1722171
Number of first layer input nodes during this epoch:  663124
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.15529823303222656  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023342370986938477
range selection method range initialization spend 0.015372276306152344
time for parepare:  0.016620159149169922
local_output_nid generation:  0.005513429641723633
local_in_edges_tensor generation:  0.007254600524902344
mini_batch_src_global generation:  0.00792241096496582
r_  generation:  0.0911555290222168
local_output_nid generation:  0.006070852279663086
local_in_edges_tensor generation:  0.003152608871459961
mini_batch_src_global generation:  0.009812355041503906
r_  generation:  0.09805536270141602
local_output_nid generation:  0.006170749664306641
local_in_edges_tensor generation:  0.003280162811279297
mini_batch_src_global generation:  0.00780177116394043
r_  generation:  0.10056710243225098
local_output_nid generation:  0.006175994873046875
local_in_edges_tensor generation:  0.0032570362091064453
mini_batch_src_global generation:  0.008190155029296875
r_  generation:  0.10396528244018555
----------------------check_connections_block total spend ----------------------------- 0.5647881031036377
generate_one_block  0.11366939544677734
generate_one_block  0.11583948135375977
generate_one_block  0.11684584617614746
generate_one_block  0.11590313911437988
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.037401676177978516
gen group dst list time:  0.011541604995727539
time for parepare:  0.01932811737060547
local_output_nid generation:  0.0156400203704834
local_in_edges_tensor generation:  0.037139892578125
mini_batch_src_global generation:  0.04754304885864258
r_  generation:  0.4734792709350586
local_output_nid generation:  0.023794174194335938
local_in_edges_tensor generation:  0.031038999557495117
mini_batch_src_global generation:  0.058388471603393555
r_  generation:  0.484874963760376
local_output_nid generation:  0.023580551147460938
local_in_edges_tensor generation:  0.02820563316345215
mini_batch_src_global generation:  0.058594703674316406
r_  generation:  0.49939584732055664
local_output_nid generation:  0.024920225143432617
local_in_edges_tensor generation:  0.03416085243225098
mini_batch_src_global generation:  0.060642242431640625
r_  generation:  0.5219345092773438
----------------------check_connections_block total spend ----------------------------- 2.8594439029693604
generate_one_block  0.6594598293304443
generate_one_block  0.639801025390625
generate_one_block  0.6688334941864014
generate_one_block  0.6364686489105225
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03472590446472168
gen group dst list time:  0.02248835563659668
time for parepare:  0.02061152458190918
local_output_nid generation:  0.024982452392578125
local_in_edges_tensor generation:  0.05108833312988281
mini_batch_src_global generation:  0.06986236572265625
r_  generation:  0.5953831672668457
local_output_nid generation:  0.03611350059509277
local_in_edges_tensor generation:  0.04096055030822754
mini_batch_src_global generation:  0.06824827194213867
r_  generation:  0.57828688621521
local_output_nid generation:  0.03526592254638672
local_in_edges_tensor generation:  0.03544282913208008
mini_batch_src_global generation:  0.06900835037231445
r_  generation:  0.5938200950622559
local_output_nid generation:  0.03878474235534668
local_in_edges_tensor generation:  0.039083003997802734
mini_batch_src_global generation:  0.06482386589050293
r_  generation:  0.5867574214935303
----------------------check_connections_block total spend ----------------------------- 3.4843530654907227
generate_one_block  0.7424600124359131
generate_one_block  0.7465951442718506
generate_one_block  0.7243907451629639
generate_one_block  0.7434635162353516
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.15529823303222656  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

connection checking time:  6.343796968460083
block generation total time  5.561472415924072
average batch blocks generation time:  1.390368103981018
block dataloader generation time/epoch 13.768002033233643
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11294126510620117  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1496291160583496  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11382389068603516  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1429600715637207  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11281394958496094  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1475553512573242  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.1129603385925293  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.145308017730713  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09432655572891235 |0.02164536714553833 |0.0036790966987609863 |9.584426879882812e-05 |0.003787696361541748 |0.0014348030090332031 |
----------------------------------------------------------pseudo_mini_loss sum 1.5463178157806396
Total (block generation + training)time/epoch 14.35864007472992
Training time/epoch 0.5901026725769043
Training time without block to device /epoch 0.503521203994751
Training time without total dataloading part /epoch 0.03168535232543945
load block tensor time/epoch 0.3773062229156494
block to device time/epoch 0.08658146858215332
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  1722084
Number of first layer input nodes during this epoch:  662715
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.15732288360595703  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022716283798217773
range selection method range initialization spend 0.011975526809692383
time for parepare:  0.01742076873779297
local_output_nid generation:  0.005663633346557617
local_in_edges_tensor generation:  0.006983041763305664
mini_batch_src_global generation:  0.007925748825073242
r_  generation:  0.09210634231567383
local_output_nid generation:  0.006025791168212891
local_in_edges_tensor generation:  0.003210783004760742
mini_batch_src_global generation:  0.009943246841430664
r_  generation:  0.09822273254394531
local_output_nid generation:  0.006095170974731445
local_in_edges_tensor generation:  0.0031850337982177734
mini_batch_src_global generation:  0.007484912872314453
r_  generation:  0.10028266906738281
local_output_nid generation:  0.0061266422271728516
local_in_edges_tensor generation:  0.0032601356506347656
mini_batch_src_global generation:  0.00829768180847168
r_  generation:  0.10381746292114258
----------------------check_connections_block total spend ----------------------------- 0.5657238960266113
generate_one_block  0.12055158615112305
generate_one_block  0.11506962776184082
generate_one_block  0.11523556709289551
generate_one_block  0.11952471733093262
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04413938522338867
gen group dst list time:  0.01160287857055664
time for parepare:  0.0195009708404541
local_output_nid generation:  0.016210079193115234
local_in_edges_tensor generation:  0.028128862380981445
mini_batch_src_global generation:  0.04802703857421875
r_  generation:  0.4734776020050049
local_output_nid generation:  0.02421712875366211
local_in_edges_tensor generation:  0.03190755844116211
mini_batch_src_global generation:  0.05670166015625
r_  generation:  0.48221564292907715
local_output_nid generation:  0.0237734317779541
local_in_edges_tensor generation:  0.025789737701416016
mini_batch_src_global generation:  0.05594944953918457
r_  generation:  0.48712897300720215
local_output_nid generation:  0.02415013313293457
local_in_edges_tensor generation:  0.031138181686401367
mini_batch_src_global generation:  0.05729413032531738
r_  generation:  0.49120473861694336
----------------------check_connections_block total spend ----------------------------- 2.7842624187469482
generate_one_block  0.6368234157562256
generate_one_block  0.633685827255249
generate_one_block  0.6548876762390137
generate_one_block  0.6417820453643799
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.041716575622558594
gen group dst list time:  0.024642467498779297
time for parepare:  0.01868152618408203
local_output_nid generation:  0.0261228084564209
local_in_edges_tensor generation:  0.048882246017456055
mini_batch_src_global generation:  0.0523831844329834
r_  generation:  0.5601696968078613
local_output_nid generation:  0.034749507904052734
local_in_edges_tensor generation:  0.04449748992919922
mini_batch_src_global generation:  0.06524324417114258
r_  generation:  0.5700278282165527
local_output_nid generation:  0.034784793853759766
local_in_edges_tensor generation:  0.038077592849731445
mini_batch_src_global generation:  0.06565403938293457
r_  generation:  0.5703005790710449
local_output_nid generation:  0.03498554229736328
local_in_edges_tensor generation:  0.03791999816894531
mini_batch_src_global generation:  0.06381869316101074
r_  generation:  0.5737462043762207
----------------------check_connections_block total spend ----------------------------- 3.3303916454315186
generate_one_block  0.719653844833374
generate_one_block  0.7279882431030273
generate_one_block  0.7362463474273682
generate_one_block  0.7255816459655762
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.15732288360595703  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

connection checking time:  6.114654064178467
block generation total time  5.476649045944214
average batch blocks generation time:  1.3691622614860535
block dataloader generation time/epoch 13.686231851577759
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11394596099853516  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.148451328277588  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11271238327026367  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1435279846191406  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11287403106689453  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.145498275756836  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11387395858764648  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.144092082977295  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0981476902961731 |0.01791316270828247 |0.0036801695823669434 |9.691715240478516e-05 |0.003893136978149414 |0.0013005733489990234 |
----------------------------------------------------------pseudo_mini_loss sum 1.5193208456039429
Total (block generation + training)time/epoch 14.276947895685831
Training time/epoch 0.590601921081543
Training time without block to device /epoch 0.5189492702484131
Training time without total dataloading part /epoch 0.031981468200683594
load block tensor time/epoch 0.3925907611846924
block to device time/epoch 0.07165265083312988
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  1722672
Number of first layer input nodes during this epoch:  662921
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.15561628341674805  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023331403732299805
range selection method range initialization spend 0.011797904968261719
time for parepare:  0.0208890438079834
local_output_nid generation:  0.0056536197662353516
local_in_edges_tensor generation:  0.009314298629760742
mini_batch_src_global generation:  0.007840633392333984
r_  generation:  0.09473180770874023
local_output_nid generation:  0.0061986446380615234
local_in_edges_tensor generation:  0.003550291061401367
mini_batch_src_global generation:  0.009807825088500977
r_  generation:  0.10112237930297852
local_output_nid generation:  0.006245851516723633
local_in_edges_tensor generation:  0.0037984848022460938
mini_batch_src_global generation:  0.0076751708984375
r_  generation:  0.10635519027709961
local_output_nid generation:  0.0067272186279296875
local_in_edges_tensor generation:  0.0034906864166259766
mini_batch_src_global generation:  0.008385181427001953
r_  generation:  0.1050715446472168
----------------------check_connections_block total spend ----------------------------- 0.5898761749267578
generate_one_block  0.11350798606872559
generate_one_block  0.11855149269104004
generate_one_block  0.11684560775756836
generate_one_block  0.11909890174865723
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.049597978591918945
gen group dst list time:  0.011357545852661133
time for parepare:  0.01941084861755371
local_output_nid generation:  0.01615142822265625
local_in_edges_tensor generation:  0.04230332374572754
mini_batch_src_global generation:  0.04778027534484863
r_  generation:  0.471513032913208
local_output_nid generation:  0.024574995040893555
local_in_edges_tensor generation:  0.03174614906311035
mini_batch_src_global generation:  0.05611681938171387
r_  generation:  0.48273468017578125
local_output_nid generation:  0.02397298812866211
local_in_edges_tensor generation:  0.0284883975982666
mini_batch_src_global generation:  0.05689740180969238
r_  generation:  0.48754286766052246
local_output_nid generation:  0.024080514907836914
local_in_edges_tensor generation:  0.032372474670410156
mini_batch_src_global generation:  0.05723881721496582
r_  generation:  0.49401402473449707
----------------------check_connections_block total spend ----------------------------- 2.8039638996124268
generate_one_block  0.6226217746734619
generate_one_block  0.6250660419464111
generate_one_block  0.6587631702423096
generate_one_block  0.6354506015777588
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03319573402404785
gen group dst list time:  0.02369070053100586
time for parepare:  0.01937103271484375
local_output_nid generation:  0.025625228881835938
local_in_edges_tensor generation:  0.05000734329223633
mini_batch_src_global generation:  0.05492544174194336
r_  generation:  0.559901237487793
local_output_nid generation:  0.03358602523803711
local_in_edges_tensor generation:  0.04962277412414551
mini_batch_src_global generation:  0.06551933288574219
r_  generation:  0.5986692905426025
local_output_nid generation:  0.03936266899108887
local_in_edges_tensor generation:  0.04375338554382324
mini_batch_src_global generation:  0.0716102123260498
r_  generation:  0.5688705444335938
local_output_nid generation:  0.0364689826965332
local_in_edges_tensor generation:  0.03835296630859375
mini_batch_src_global generation:  0.06598353385925293
r_  generation:  0.5751113891601562
----------------------check_connections_block total spend ----------------------------- 3.394564390182495
generate_one_block  0.7193968296051025
generate_one_block  0.7199358940124512
generate_one_block  0.7313728332519531
generate_one_block  0.7264728546142578
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.15561628341674805  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

connection checking time:  6.198528289794922
block generation total time  5.439079999923706
average batch blocks generation time:  1.3597699999809265
block dataloader generation time/epoch 13.665123641490936
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11273002624511719  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1435585021972656  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11294841766357422  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1448278427124023  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.1138763427734375  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1479730606079102  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11284732818603516  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1473512649536133  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09022402763366699 |0.023826897144317627 |0.00360262393951416 |9.554624557495117e-05 |0.00376051664352417 |0.003126382827758789 |
----------------------------------------------------------pseudo_mini_loss sum 1.4824374914169312
Total (block generation + training)time/epoch 14.253547668457031
Training time/epoch 0.5812773704528809
Training time without block to device /epoch 0.48596978187561035
Training time without total dataloading part /epoch 0.032961130142211914
load block tensor time/epoch 0.36089611053466797
block to device time/epoch 0.09530758857727051
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  1722645
Number of first layer input nodes during this epoch:  663117
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.15538740158081055  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02512192726135254
range selection method range initialization spend 0.011858940124511719
time for parepare:  0.01732635498046875
local_output_nid generation:  0.005555629730224609
local_in_edges_tensor generation:  0.006760597229003906
mini_batch_src_global generation:  0.007828235626220703
r_  generation:  0.0910177230834961
local_output_nid generation:  0.006150960922241211
local_in_edges_tensor generation:  0.0032148361206054688
mini_batch_src_global generation:  0.010180234909057617
r_  generation:  0.09958148002624512
local_output_nid generation:  0.006175041198730469
local_in_edges_tensor generation:  0.0032765865325927734
mini_batch_src_global generation:  0.007826805114746094
r_  generation:  0.10201215744018555
local_output_nid generation:  0.0062198638916015625
local_in_edges_tensor generation:  0.003282308578491211
mini_batch_src_global generation:  0.008114337921142578
r_  generation:  0.10396623611450195
----------------------check_connections_block total spend ----------------------------- 0.5697910785675049
generate_one_block  0.11316275596618652
generate_one_block  0.11563324928283691
generate_one_block  0.11580991744995117
generate_one_block  0.11619329452514648
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03427267074584961
gen group dst list time:  0.011647939682006836
time for parepare:  0.019427061080932617
local_output_nid generation:  0.015315055847167969
local_in_edges_tensor generation:  0.03403186798095703
mini_batch_src_global generation:  0.04772353172302246
r_  generation:  0.46599364280700684
local_output_nid generation:  0.02393054962158203
local_in_edges_tensor generation:  0.03143954277038574
mini_batch_src_global generation:  0.055755615234375
r_  generation:  0.4847877025604248
local_output_nid generation:  0.023850202560424805
local_in_edges_tensor generation:  0.02922201156616211
mini_batch_src_global generation:  0.05577206611633301
r_  generation:  0.4892754554748535
local_output_nid generation:  0.023891687393188477
local_in_edges_tensor generation:  0.027315139770507812
mini_batch_src_global generation:  0.05614972114562988
r_  generation:  0.4956979751586914
----------------------check_connections_block total spend ----------------------------- 2.784360408782959
generate_one_block  0.6335089206695557
generate_one_block  0.6333391666412354
generate_one_block  0.6588687896728516
generate_one_block  0.644970178604126
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03422665596008301
gen group dst list time:  0.023088932037353516
time for parepare:  0.018918991088867188
local_output_nid generation:  0.025572538375854492
local_in_edges_tensor generation:  0.049550771713256836
mini_batch_src_global generation:  0.053143978118896484
r_  generation:  0.5663859844207764
local_output_nid generation:  0.03601217269897461
local_in_edges_tensor generation:  0.04449748992919922
mini_batch_src_global generation:  0.06428337097167969
r_  generation:  0.5661044120788574
local_output_nid generation:  0.03534555435180664
local_in_edges_tensor generation:  0.038675546646118164
mini_batch_src_global generation:  0.06477808952331543
r_  generation:  0.5722265243530273
local_output_nid generation:  0.03557443618774414
local_in_edges_tensor generation:  0.04047036170959473
mini_batch_src_global generation:  0.06622719764709473
r_  generation:  0.5776901245117188
----------------------check_connections_block total spend ----------------------------- 3.3476030826568604
generate_one_block  0.7278807163238525
generate_one_block  0.7298824787139893
generate_one_block  0.7260277271270752
generate_one_block  0.7311422824859619
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.15538740158081055  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

connection checking time:  6.131963491439819
block generation total time  5.4856202602386475
average batch blocks generation time:  1.3714050650596619
block dataloader generation time/epoch 13.643000316619872
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11298704147338867  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1446256637573242  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11384296417236328  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1486082077026367  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11276483535766602  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1441130638122559  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11296987533569336  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.149744987487793  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08925926685333252 |0.02168816328048706 |0.009063243865966797 |9.828805923461914e-05 |0.0037804841995239258 |0.0029473304748535156 |
----------------------------------------------------------pseudo_mini_loss sum 1.4495270252227783
Total (block generation + training)time/epoch 14.232049417495727
Training time/epoch 0.5910882949829102
Training time without block to device /epoch 0.5043356418609619
Training time without total dataloading part /epoch 0.05471539497375488
load block tensor time/epoch 0.3570370674133301
block to device time/epoch 0.08675265312194824
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  1723325
Number of first layer input nodes during this epoch:  662857
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.15747642517089844  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0234224796295166
range selection method range initialization spend 0.012184381484985352
time for parepare:  0.017884016036987305
local_output_nid generation:  0.005575656890869141
local_in_edges_tensor generation:  0.009296655654907227
mini_batch_src_global generation:  0.007754325866699219
r_  generation:  0.09025788307189941
local_output_nid generation:  0.0060253143310546875
local_in_edges_tensor generation:  0.003596782684326172
mini_batch_src_global generation:  0.009891748428344727
r_  generation:  0.09769487380981445
local_output_nid generation:  0.006142377853393555
local_in_edges_tensor generation:  0.003214120864868164
mini_batch_src_global generation:  0.007898092269897461
r_  generation:  0.10286593437194824
local_output_nid generation:  0.00616145133972168
local_in_edges_tensor generation:  0.003243684768676758
mini_batch_src_global generation:  0.008400201797485352
r_  generation:  0.10479283332824707
----------------------check_connections_block total spend ----------------------------- 0.5716209411621094
generate_one_block  0.11364126205444336
generate_one_block  0.11738991737365723
generate_one_block  0.12048625946044922
generate_one_block  0.12366843223571777
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0438230037689209
gen group dst list time:  0.011802196502685547
time for parepare:  0.021961688995361328
local_output_nid generation:  0.01645517349243164
local_in_edges_tensor generation:  0.04094219207763672
mini_batch_src_global generation:  0.04920816421508789
r_  generation:  0.4712951183319092
local_output_nid generation:  0.02430272102355957
local_in_edges_tensor generation:  0.03530097007751465
mini_batch_src_global generation:  0.05586671829223633
r_  generation:  0.48763275146484375
local_output_nid generation:  0.02406144142150879
local_in_edges_tensor generation:  0.02735161781311035
mini_batch_src_global generation:  0.056485891342163086
r_  generation:  0.4913492202758789
local_output_nid generation:  0.024629592895507812
local_in_edges_tensor generation:  0.028828859329223633
mini_batch_src_global generation:  0.05798459053039551
r_  generation:  0.4955282211303711
----------------------check_connections_block total spend ----------------------------- 2.816211462020874
generate_one_block  0.6399986743927002
generate_one_block  0.6267192363739014
generate_one_block  0.650925874710083
generate_one_block  0.6281571388244629
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.037854909896850586
gen group dst list time:  0.022480010986328125
time for parepare:  0.018863201141357422
local_output_nid generation:  0.0252840518951416
local_in_edges_tensor generation:  0.03680229187011719
mini_batch_src_global generation:  0.05526852607727051
r_  generation:  0.5667216777801514
local_output_nid generation:  0.0337216854095459
local_in_edges_tensor generation:  0.043889522552490234
mini_batch_src_global generation:  0.06796407699584961
r_  generation:  0.5931696891784668
local_output_nid generation:  0.03805088996887207
local_in_edges_tensor generation:  0.04437756538391113
mini_batch_src_global generation:  0.06696176528930664
r_  generation:  0.5747623443603516
local_output_nid generation:  0.03595376014709473
local_in_edges_tensor generation:  0.04448390007019043
mini_batch_src_global generation:  0.06435012817382812
r_  generation:  0.5781276226043701
----------------------check_connections_block total spend ----------------------------- 3.3911478519439697
generate_one_block  0.7241132259368896
generate_one_block  0.7231583595275879
generate_one_block  0.7419223785400391
generate_one_block  0.7424304485321045
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.15747642517089844  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

connection checking time:  6.207359313964844
block generation total time  5.4774253368377686
average batch blocks generation time:  1.3693563342094421
block dataloader generation time/epoch 13.638886054356893
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11387777328491211  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1433897018432617  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11278295516967773  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.142557144165039  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11294412612915039  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.149259090423584  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11397981643676758  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.148165225982666  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09681379795074463 |0.022367119789123535 |0.0036824941635131836 |9.584426879882812e-05 |0.01704305410385132 |0.0029442310333251953 |
----------------------------------------------------------pseudo_mini_loss sum 1.4274821281433105
Total (block generation + training)time/epoch 14.230103929837545
Training time/epoch 0.6017971038818359
Training time without block to device /epoch 0.5123286247253418
Training time without total dataloading part /epoch 0.08622980117797852
load block tensor time/epoch 0.3872551918029785
block to device time/epoch 0.08946847915649414
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  1722145
Number of first layer input nodes during this epoch:  663075
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.15576601028442383  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02357625961303711
range selection method range initialization spend 0.012062788009643555
time for parepare:  0.018561601638793945
local_output_nid generation:  0.0067059993743896484
local_in_edges_tensor generation:  0.009493350982666016
mini_batch_src_global generation:  0.007732868194580078
r_  generation:  0.09148383140563965
local_output_nid generation:  0.006237506866455078
local_in_edges_tensor generation:  0.00339508056640625
mini_batch_src_global generation:  0.010354757308959961
r_  generation:  0.09828782081604004
local_output_nid generation:  0.0063037872314453125
local_in_edges_tensor generation:  0.0033292770385742188
mini_batch_src_global generation:  0.00781393051147461
r_  generation:  0.10267305374145508
local_output_nid generation:  0.006267070770263672
local_in_edges_tensor generation:  0.0037567615509033203
mini_batch_src_global generation:  0.008550167083740234
r_  generation:  0.10415267944335938
----------------------check_connections_block total spend ----------------------------- 0.5759487152099609
generate_one_block  0.11213874816894531
generate_one_block  0.11552023887634277
generate_one_block  0.11514997482299805
generate_one_block  0.11823916435241699
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03980898857116699
gen group dst list time:  0.01741194725036621
time for parepare:  0.02781391143798828
local_output_nid generation:  0.018461227416992188
local_in_edges_tensor generation:  0.03649592399597168
mini_batch_src_global generation:  0.04799628257751465
r_  generation:  0.47287487983703613
local_output_nid generation:  0.026932239532470703
local_in_edges_tensor generation:  0.03183102607727051
mini_batch_src_global generation:  0.056966543197631836
r_  generation:  0.4816892147064209
local_output_nid generation:  0.027286052703857422
local_in_edges_tensor generation:  0.025320768356323242
mini_batch_src_global generation:  0.05650019645690918
r_  generation:  0.49523401260375977
local_output_nid generation:  0.0278170108795166
local_in_edges_tensor generation:  0.028217315673828125
mini_batch_src_global generation:  0.058860063552856445
r_  generation:  0.49570584297180176
----------------------check_connections_block total spend ----------------------------- 2.8271188735961914
generate_one_block  0.6532464027404785
generate_one_block  0.6580626964569092
generate_one_block  0.6670563220977783
generate_one_block  0.6611106395721436
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.041184425354003906
gen group dst list time:  0.02415156364440918
time for parepare:  0.019351720809936523
local_output_nid generation:  0.025757551193237305
local_in_edges_tensor generation:  0.047472476959228516
mini_batch_src_global generation:  0.05480837821960449
r_  generation:  0.5661149024963379
local_output_nid generation:  0.03554344177246094
local_in_edges_tensor generation:  0.0487360954284668
mini_batch_src_global generation:  0.06526398658752441
r_  generation:  0.5947473049163818
local_output_nid generation:  0.04032468795776367
local_in_edges_tensor generation:  0.04717373847961426
mini_batch_src_global generation:  0.06672883033752441
r_  generation:  0.5818941593170166
local_output_nid generation:  0.03641557693481445
local_in_edges_tensor generation:  0.04210782051086426
mini_batch_src_global generation:  0.06437444686889648
r_  generation:  0.57332444190979
----------------------check_connections_block total spend ----------------------------- 3.404585838317871
generate_one_block  0.7204761505126953
generate_one_block  0.724860668182373
generate_one_block  0.740170955657959
generate_one_block  0.7391855716705322
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.15576601028442383  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

connection checking time:  6.2317047119140625
block generation total time  5.564169406890869
average batch blocks generation time:  1.3910423517227173
block dataloader generation time/epoch 13.656467199325562
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11270427703857422  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1416163444519043  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11304712295532227  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1495542526245117  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11374568939208984  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.142716407775879  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11291313171386719  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1483001708984375  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09536135196685791 |0.022099077701568604 |0.003580152988433838 |9.512901306152344e-05 |0.003746211528778076 |0.0029730796813964844 |
----------------------------------------------------------pseudo_mini_loss sum 1.3927440643310547
Total (block generation + training)time/epoch 14.247757537024361
Training time/epoch 0.591456413269043
Training time without block to device /epoch 0.5030601024627686
Training time without total dataloading part /epoch 0.032659053802490234
load block tensor time/epoch 0.38144540786743164
block to device time/epoch 0.08839631080627441
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  1722727
Number of first layer input nodes during this epoch:  663149
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.1555638313293457  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023584842681884766
range selection method range initialization spend 0.011940240859985352
time for parepare:  0.01702880859375
local_output_nid generation:  0.0053784847259521484
local_in_edges_tensor generation:  0.009407520294189453
mini_batch_src_global generation:  0.007867574691772461
r_  generation:  0.09183430671691895
local_output_nid generation:  0.0061604976654052734
local_in_edges_tensor generation:  0.003171205520629883
mini_batch_src_global generation:  0.009987354278564453
r_  generation:  0.09862589836120605
local_output_nid generation:  0.006272792816162109
local_in_edges_tensor generation:  0.0031900405883789062
mini_batch_src_global generation:  0.007692098617553711
r_  generation:  0.10323548316955566
local_output_nid generation:  0.006279945373535156
local_in_edges_tensor generation:  0.003578662872314453
mini_batch_src_global generation:  0.008239269256591797
r_  generation:  0.10536456108093262
----------------------check_connections_block total spend ----------------------------- 0.5738599300384521
generate_one_block  0.11832308769226074
generate_one_block  0.11708450317382812
generate_one_block  0.11592555046081543
generate_one_block  0.11912393569946289
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03872990608215332
gen group dst list time:  0.011876583099365234
time for parepare:  0.01955723762512207
local_output_nid generation:  0.016049861907958984
local_in_edges_tensor generation:  0.03752446174621582
mini_batch_src_global generation:  0.04771304130554199
r_  generation:  0.4717094898223877
local_output_nid generation:  0.026602983474731445
local_in_edges_tensor generation:  0.03323030471801758
mini_batch_src_global generation:  0.05993795394897461
r_  generation:  0.48215484619140625
local_output_nid generation:  0.024930238723754883
local_in_edges_tensor generation:  0.030601024627685547
mini_batch_src_global generation:  0.05839657783508301
r_  generation:  0.48419904708862305
local_output_nid generation:  0.025069236755371094
local_in_edges_tensor generation:  0.027872562408447266
mini_batch_src_global generation:  0.060228586196899414
r_  generation:  0.4873538017272949
----------------------check_connections_block total spend ----------------------------- 2.809671401977539
generate_one_block  0.6202442646026611
generate_one_block  0.6162426471710205
generate_one_block  0.6491289138793945
generate_one_block  0.6296203136444092
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.037807464599609375
gen group dst list time:  0.022477388381958008
time for parepare:  0.019129276275634766
local_output_nid generation:  0.02517223358154297
local_in_edges_tensor generation:  0.04545450210571289
mini_batch_src_global generation:  0.05463266372680664
r_  generation:  0.5607335567474365
local_output_nid generation:  0.03382992744445801
local_in_edges_tensor generation:  0.04301905632019043
mini_batch_src_global generation:  0.06485962867736816
r_  generation:  0.5664727687835693
local_output_nid generation:  0.03464698791503906
local_in_edges_tensor generation:  0.03634929656982422
mini_batch_src_global generation:  0.06481504440307617
r_  generation:  0.5704085826873779
local_output_nid generation:  0.03467607498168945
local_in_edges_tensor generation:  0.04328489303588867
mini_batch_src_global generation:  0.06342411041259766
r_  generation:  0.5751025676727295
----------------------check_connections_block total spend ----------------------------- 3.320035219192505
generate_one_block  0.7180697917938232
generate_one_block  0.7216591835021973
generate_one_block  0.7268660068511963
generate_one_block  0.7185323238372803
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.1555638313293457  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

connection checking time:  6.129706621170044
block generation total time  5.400363445281982
average batch blocks generation time:  1.3500908613204956
block dataloader generation time/epoch 13.63162910938263
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11293220520019531  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1454696655273438  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11384820938110352  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1475334167480469  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11279726028442383  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1442360877990723  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11301755905151367  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.144514560699463  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0978316068649292 |0.015881717205047607 |0.0036908388137817383 |9.459257125854492e-05 |0.0037761926651000977 |0.0019359588623046875 |
----------------------------------------------------------pseudo_mini_loss sum 1.3693718910217285
Total (block generation + training)time/epoch 14.221466958522797
Training time/epoch 0.5794830322265625
Training time without block to device /epoch 0.5159561634063721
Training time without total dataloading part /epoch 0.03218245506286621
load block tensor time/epoch 0.3913264274597168
block to device time/epoch 0.06352686882019043
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  1722147
Number of first layer input nodes during this epoch:  663037
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.1574535369873047  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02681136131286621
range selection method range initialization spend 0.01226186752319336
time for parepare:  0.020723342895507812
local_output_nid generation:  0.005750179290771484
local_in_edges_tensor generation:  0.006175994873046875
mini_batch_src_global generation:  0.008156776428222656
r_  generation:  0.09191179275512695
local_output_nid generation:  0.006037712097167969
local_in_edges_tensor generation:  0.0035827159881591797
mini_batch_src_global generation:  0.010023117065429688
r_  generation:  0.10149669647216797
local_output_nid generation:  0.006083250045776367
local_in_edges_tensor generation:  0.003998994827270508
mini_batch_src_global generation:  0.008165597915649414
r_  generation:  0.10600829124450684
local_output_nid generation:  0.008864164352416992
local_in_edges_tensor generation:  0.003617525100708008
mini_batch_src_global generation:  0.008267641067504883
r_  generation:  0.1083371639251709
----------------------check_connections_block total spend ----------------------------- 0.5885782241821289
generate_one_block  0.11663150787353516
generate_one_block  0.11933565139770508
generate_one_block  0.11757206916809082
generate_one_block  0.11863541603088379
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04502296447753906
gen group dst list time:  0.01170802116394043
time for parepare:  0.021582603454589844
local_output_nid generation:  0.01667308807373047
local_in_edges_tensor generation:  0.03567314147949219
mini_batch_src_global generation:  0.0483555793762207
r_  generation:  0.46805644035339355
local_output_nid generation:  0.024495363235473633
local_in_edges_tensor generation:  0.03314208984375
mini_batch_src_global generation:  0.058213233947753906
r_  generation:  0.48914265632629395
local_output_nid generation:  0.024341583251953125
local_in_edges_tensor generation:  0.02708268165588379
mini_batch_src_global generation:  0.05691647529602051
r_  generation:  0.48488688468933105
local_output_nid generation:  0.0243990421295166
local_in_edges_tensor generation:  0.026298999786376953
mini_batch_src_global generation:  0.05700826644897461
r_  generation:  0.4929220676422119
----------------------check_connections_block total spend ----------------------------- 2.7937867641448975
generate_one_block  0.6212368011474609
generate_one_block  0.6372971534729004
generate_one_block  0.6641483306884766
generate_one_block  0.6305971145629883
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04109644889831543
gen group dst list time:  0.023473739624023438
time for parepare:  0.021741867065429688
local_output_nid generation:  0.027028799057006836
local_in_edges_tensor generation:  0.04025602340698242
mini_batch_src_global generation:  0.057691097259521484
r_  generation:  0.5824108123779297
local_output_nid generation:  0.036278486251831055
local_in_edges_tensor generation:  0.04737424850463867
mini_batch_src_global generation:  0.09715509414672852
r_  generation:  0.5914146900177002
local_output_nid generation:  0.03675985336303711
local_in_edges_tensor generation:  0.04044651985168457
mini_batch_src_global generation:  0.06917285919189453
r_  generation:  0.5812458992004395
local_output_nid generation:  0.03712892532348633
local_in_edges_tensor generation:  0.03641629219055176
mini_batch_src_global generation:  0.06653714179992676
r_  generation:  0.5877959728240967
----------------------check_connections_block total spend ----------------------------- 3.471423864364624
generate_one_block  0.7373075485229492
generate_one_block  0.7526774406433105
generate_one_block  0.735975980758667
generate_one_block  0.7633235454559326
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.1574535369873047  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

connection checking time:  6.2652106285095215
block generation total time  5.5425639152526855
average batch blocks generation time:  1.3856409788131714
block dataloader generation time/epoch 13.647157218721178
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11374616622924805  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1422739028930664  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11283254623413086  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.147709846496582  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11297035217285156  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1464405059814453  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.1138296127319336  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1430087089538574  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08972620964050293 |0.025618433952331543 |0.0036400556564331055 |9.554624557495117e-05 |0.0035153627395629883 |0.0028090476989746094 |
----------------------------------------------------------pseudo_mini_loss sum 1.3511028289794922
Total (block generation + training)time/epoch 14.236426803800795
Training time/epoch 0.5845327377319336
Training time without block to device /epoch 0.4820590019226074
Training time without total dataloading part /epoch 0.03181290626525879
load block tensor time/epoch 0.3589048385620117
block to device time/epoch 0.10247373580932617
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  1721940
Number of first layer input nodes during this epoch:  662933
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.1555776596069336  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023578882217407227
range selection method range initialization spend 0.011888265609741211
time for parepare:  0.01679205894470215
local_output_nid generation:  0.005666255950927734
local_in_edges_tensor generation:  0.00650787353515625
mini_batch_src_global generation:  0.007857799530029297
r_  generation:  0.09217405319213867
local_output_nid generation:  0.006203889846801758
local_in_edges_tensor generation:  0.003198862075805664
mini_batch_src_global generation:  0.010184526443481445
r_  generation:  0.09921956062316895
local_output_nid generation:  0.006188154220581055
local_in_edges_tensor generation:  0.003376007080078125
mini_batch_src_global generation:  0.008345842361450195
r_  generation:  0.10222673416137695
local_output_nid generation:  0.0062408447265625
local_in_edges_tensor generation:  0.0032930374145507812
mini_batch_src_global generation:  0.008545637130737305
r_  generation:  0.10407233238220215
----------------------check_connections_block total spend ----------------------------- 0.5725815296173096
generate_one_block  0.12082242965698242
generate_one_block  0.1145620346069336
generate_one_block  0.11876559257507324
generate_one_block  0.1177978515625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03942465782165527
gen group dst list time:  0.011563777923583984
time for parepare:  0.019501447677612305
local_output_nid generation:  0.01631474494934082
local_in_edges_tensor generation:  0.03421378135681152
mini_batch_src_global generation:  0.048607826232910156
r_  generation:  0.47819089889526367
local_output_nid generation:  0.0245208740234375
local_in_edges_tensor generation:  0.033213138580322266
mini_batch_src_global generation:  0.05821633338928223
r_  generation:  0.49082374572753906
local_output_nid generation:  0.023955821990966797
local_in_edges_tensor generation:  0.026021242141723633
mini_batch_src_global generation:  0.056945085525512695
r_  generation:  0.49465513229370117
local_output_nid generation:  0.02435898780822754
local_in_edges_tensor generation:  0.02822422981262207
mini_batch_src_global generation:  0.05672025680541992
r_  generation:  0.5000240802764893
----------------------check_connections_block total spend ----------------------------- 2.819781541824341
generate_one_block  0.6286301612854004
generate_one_block  0.6303155422210693
generate_one_block  0.6552579402923584
generate_one_block  0.6328301429748535
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03246021270751953
gen group dst list time:  0.02301192283630371
time for parepare:  0.018685340881347656
local_output_nid generation:  0.02602982521057129
local_in_edges_tensor generation:  0.043131351470947266
mini_batch_src_global generation:  0.05516242980957031
r_  generation:  0.5652000904083252
local_output_nid generation:  0.03535962104797363
local_in_edges_tensor generation:  0.03924131393432617
mini_batch_src_global generation:  0.06547212600708008
r_  generation:  0.5832152366638184
local_output_nid generation:  0.03533148765563965
local_in_edges_tensor generation:  0.042328596115112305
mini_batch_src_global generation:  0.0681772232055664
r_  generation:  0.5874087810516357
local_output_nid generation:  0.037664175033569336
local_in_edges_tensor generation:  0.03882288932800293
mini_batch_src_global generation:  0.06464219093322754
r_  generation:  0.5794899463653564
----------------------check_connections_block total spend ----------------------------- 3.404881715774536
generate_one_block  0.7215030193328857
generate_one_block  0.7260022163391113
generate_one_block  0.7406277656555176
generate_one_block  0.7238540649414062
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.1555776596069336  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

connection checking time:  6.224663257598877
block generation total time  5.4590208530426025
average batch blocks generation time:  1.3647552132606506
block dataloader generation time/epoch 13.643909025192261
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11278820037841797  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1476707458496094  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11295175552368164  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1496086120605469  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11387109756469727  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.147761344909668  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11273860931396484  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.142928123474121  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09292459487915039 |0.02204883098602295 |0.003611326217651367 |9.822845458984375e-05 |0.0037249326705932617 |0.003186464309692383 |
----------------------------------------------------------pseudo_mini_loss sum 1.3379307985305786
Total (block generation + training)time/epoch 14.232327961921692
Training time/epoch 0.5804989337921143
Training time without block to device /epoch 0.49230360984802246
Training time without total dataloading part /epoch 0.03292441368103027
load block tensor time/epoch 0.37169837951660156
block to device time/epoch 0.0881953239440918
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  1722965
Number of first layer input nodes during this epoch:  662866
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.1551194190979004  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022456884384155273
range selection method range initialization spend 0.011754274368286133
time for parepare:  0.016798973083496094
local_output_nid generation:  0.005690574645996094
local_in_edges_tensor generation:  0.0072863101959228516
mini_batch_src_global generation:  0.008045196533203125
r_  generation:  0.09087014198303223
local_output_nid generation:  0.006096601486206055
local_in_edges_tensor generation:  0.003286123275756836
mini_batch_src_global generation:  0.010043621063232422
r_  generation:  0.09861016273498535
local_output_nid generation:  0.0062656402587890625
local_in_edges_tensor generation:  0.003140687942504883
mini_batch_src_global generation:  0.007630586624145508
r_  generation:  0.10185360908508301
local_output_nid generation:  0.006137371063232422
local_in_edges_tensor generation:  0.0032148361206054688
mini_batch_src_global generation:  0.008663654327392578
r_  generation:  0.10530972480773926
----------------------check_connections_block total spend ----------------------------- 0.5706076622009277
generate_one_block  0.11081433296203613
generate_one_block  0.11666631698608398
generate_one_block  0.11726617813110352
generate_one_block  0.11834192276000977
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03788900375366211
gen group dst list time:  0.011365890502929688
time for parepare:  0.019483327865600586
local_output_nid generation:  0.016081809997558594
local_in_edges_tensor generation:  0.033136606216430664
mini_batch_src_global generation:  0.04555058479309082
r_  generation:  0.4666783809661865
local_output_nid generation:  0.024024248123168945
local_in_edges_tensor generation:  0.03195929527282715
mini_batch_src_global generation:  0.056699514389038086
r_  generation:  0.4836921691894531
local_output_nid generation:  0.023788928985595703
local_in_edges_tensor generation:  0.03126096725463867
mini_batch_src_global generation:  0.0562899112701416
r_  generation:  0.48420190811157227
local_output_nid generation:  0.023908615112304688
local_in_edges_tensor generation:  0.02628922462463379
mini_batch_src_global generation:  0.05717301368713379
r_  generation:  0.49773192405700684
----------------------check_connections_block total spend ----------------------------- 2.786078691482544
generate_one_block  0.6504907608032227
generate_one_block  0.6402459144592285
generate_one_block  0.662665843963623
generate_one_block  0.625917911529541
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04246950149536133
gen group dst list time:  0.022437572479248047
time for parepare:  0.019063949584960938
local_output_nid generation:  0.025536298751831055
local_in_edges_tensor generation:  0.05006122589111328
mini_batch_src_global generation:  0.0538027286529541
r_  generation:  0.558851957321167
local_output_nid generation:  0.03388333320617676
local_in_edges_tensor generation:  0.041364431381225586
mini_batch_src_global generation:  0.06449007987976074
r_  generation:  0.569429874420166
local_output_nid generation:  0.03504204750061035
local_in_edges_tensor generation:  0.04132223129272461
mini_batch_src_global generation:  0.06778669357299805
r_  generation:  0.5726077556610107
local_output_nid generation:  0.03492093086242676
local_in_edges_tensor generation:  0.036673784255981445
mini_batch_src_global generation:  0.06579995155334473
r_  generation:  0.5793707370758057
----------------------check_connections_block total spend ----------------------------- 3.3423871994018555
generate_one_block  0.7341668605804443
generate_one_block  0.7580821514129639
generate_one_block  0.7380945682525635
generate_one_block  0.7543139457702637
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.1551194190979004  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

connection checking time:  6.128465890884399
block generation total time  5.563977956771851
average batch blocks generation time:  1.3909944891929626
block dataloader generation time/epoch 13.641607262871482
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11284542083740234  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1423845291137695  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11386680603027344  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.147874355316162  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.1128077507019043  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1443018913269043  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11296224594116211  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1495418548583984  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08999192714691162 |0.02184373140335083 |0.0044133663177490234 |0.00010436773300170898 |0.0036235451698303223 |0.002480030059814453 |
----------------------------------------------------------pseudo_mini_loss sum 1.3284032344818115
Total (block generation + training)time/epoch 14.228656942194158
Training time/epoch 0.5730834007263184
Training time without block to device /epoch 0.48570847511291504
Training time without total dataloading part /epoch 0.03504514694213867
load block tensor time/epoch 0.3599677085876465
block to device time/epoch 0.08737492561340332
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 20 |
Number of nodes for computation during this epoch:  1721973
Number of first layer input nodes during this epoch:  662829
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.157501220703125  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023640871047973633
range selection method range initialization spend 0.011817693710327148
time for parepare:  0.016724824905395508
local_output_nid generation:  0.005614757537841797
local_in_edges_tensor generation:  0.009077072143554688
mini_batch_src_global generation:  0.007912874221801758
r_  generation:  0.09009313583374023
local_output_nid generation:  0.006051063537597656
local_in_edges_tensor generation:  0.003272533416748047
mini_batch_src_global generation:  0.011645317077636719
r_  generation:  0.09618020057678223
local_output_nid generation:  0.006056547164916992
local_in_edges_tensor generation:  0.0035758018493652344
mini_batch_src_global generation:  0.007786273956298828
r_  generation:  0.10121297836303711
local_output_nid generation:  0.006072282791137695
local_in_edges_tensor generation:  0.0031795501708984375
mini_batch_src_global generation:  0.008203983306884766
r_  generation:  0.10349130630493164
----------------------check_connections_block total spend ----------------------------- 0.5665183067321777
generate_one_block  0.11673235893249512
generate_one_block  0.11557221412658691
generate_one_block  0.11783003807067871
generate_one_block  0.11608147621154785
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03423571586608887
gen group dst list time:  0.011532068252563477
time for parepare:  0.019475936889648438
local_output_nid generation:  0.016232967376708984
local_in_edges_tensor generation:  0.03855299949645996
mini_batch_src_global generation:  0.047461509704589844
r_  generation:  0.46882104873657227
local_output_nid generation:  0.024311065673828125
local_in_edges_tensor generation:  0.027428388595581055
mini_batch_src_global generation:  0.05572676658630371
r_  generation:  0.4811973571777344
local_output_nid generation:  0.023839473724365234
local_in_edges_tensor generation:  0.043975830078125
mini_batch_src_global generation:  0.05613207817077637
r_  generation:  0.5158331394195557
local_output_nid generation:  0.027008056640625
local_in_edges_tensor generation:  0.03383684158325195
mini_batch_src_global generation:  0.05787968635559082
r_  generation:  0.49161815643310547
----------------------check_connections_block total spend ----------------------------- 2.8373637199401855
generate_one_block  0.6390175819396973
generate_one_block  0.6299176216125488
generate_one_block  0.6665182113647461
generate_one_block  0.6443965435028076
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04443192481994629
gen group dst list time:  0.02312946319580078
time for parepare:  0.018883228302001953
local_output_nid generation:  0.026325225830078125
local_in_edges_tensor generation:  0.04966425895690918
mini_batch_src_global generation:  0.05316901206970215
r_  generation:  0.5836985111236572
local_output_nid generation:  0.038398027420043945
local_in_edges_tensor generation:  0.0466310977935791
mini_batch_src_global generation:  0.0687096118927002
r_  generation:  0.5663928985595703
local_output_nid generation:  0.036485910415649414
local_in_edges_tensor generation:  0.03664398193359375
mini_batch_src_global generation:  0.06469559669494629
r_  generation:  0.5719025135040283
local_output_nid generation:  0.036568641662597656
local_in_edges_tensor generation:  0.036318063735961914
mini_batch_src_global generation:  0.06608843803405762
r_  generation:  0.5726358890533447
----------------------check_connections_block total spend ----------------------------- 3.3675317764282227
generate_one_block  0.7206950187683105
generate_one_block  0.7311756610870361
generate_one_block  0.7357974052429199
generate_one_block  0.7323906421661377
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.157501220703125  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

connection checking time:  6.204895496368408
block generation total time  5.499908685684204
average batch blocks generation time:  1.374977171421051
block dataloader generation time/epoch 13.64067538579305
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11386823654174805  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.144458293914795  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11275768280029297  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1430792808532715  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11295557022094727  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1455960273742676  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11394119262695312  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.148362159729004  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0926864743232727 |0.021374523639678955 |0.003627002239227295 |0.00010007619857788086 |0.003795146942138672 |0.0039196014404296875 |
----------------------------------------------------------pseudo_mini_loss sum 1.309680700302124
Total (block generation + training)time/epoch 14.227055013179779
Training time/epoch 0.5788218975067139
Training time without block to device /epoch 0.49332380294799805
Training time without total dataloading part /epoch 0.03400850296020508
load block tensor time/epoch 0.3707458972930908
block to device time/epoch 0.08549809455871582
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 21 |
Number of nodes for computation during this epoch:  1722687
Number of first layer input nodes during this epoch:  662970
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.15573453903198242  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028899431228637695
range selection method range initialization spend 0.012166023254394531
time for parepare:  0.016779661178588867
local_output_nid generation:  0.005486249923706055
local_in_edges_tensor generation:  0.006720781326293945
mini_batch_src_global generation:  0.00787973403930664
r_  generation:  0.09039449691772461
local_output_nid generation:  0.00615692138671875
local_in_edges_tensor generation:  0.003198385238647461
mini_batch_src_global generation:  0.010323047637939453
r_  generation:  0.10669755935668945
local_output_nid generation:  0.006627798080444336
local_in_edges_tensor generation:  0.0032045841217041016
mini_batch_src_global generation:  0.007773399353027344
r_  generation:  0.10008573532104492
local_output_nid generation:  0.006653785705566406
local_in_edges_tensor generation:  0.003478527069091797
mini_batch_src_global generation:  0.008211135864257812
r_  generation:  0.10435104370117188
----------------------check_connections_block total spend ----------------------------- 0.5817372798919678
generate_one_block  0.11611127853393555
generate_one_block  0.11637592315673828
generate_one_block  0.1161341667175293
generate_one_block  0.11726737022399902
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.036932945251464844
gen group dst list time:  0.011541366577148438
time for parepare:  0.020241975784301758
local_output_nid generation:  0.016442298889160156
local_in_edges_tensor generation:  0.035469770431518555
mini_batch_src_global generation:  0.048494815826416016
r_  generation:  0.4729313850402832
local_output_nid generation:  0.0250091552734375
local_in_edges_tensor generation:  0.036336421966552734
mini_batch_src_global generation:  0.05888628959655762
r_  generation:  0.49124884605407715
local_output_nid generation:  0.02416229248046875
local_in_edges_tensor generation:  0.029439687728881836
mini_batch_src_global generation:  0.05844736099243164
r_  generation:  0.4887866973876953
local_output_nid generation:  0.024486780166625977
local_in_edges_tensor generation:  0.02585577964782715
mini_batch_src_global generation:  0.05739092826843262
r_  generation:  0.4926126003265381
----------------------check_connections_block total spend ----------------------------- 2.813472032546997
generate_one_block  0.6363630294799805
generate_one_block  0.6334502696990967
generate_one_block  0.6550045013427734
generate_one_block  0.6400494575500488
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04089760780334473
gen group dst list time:  0.025283336639404297
time for parepare:  0.018731117248535156
local_output_nid generation:  0.025927305221557617
local_in_edges_tensor generation:  0.04899096488952637
mini_batch_src_global generation:  0.05536317825317383
r_  generation:  0.5582554340362549
local_output_nid generation:  0.03478240966796875
local_in_edges_tensor generation:  0.04356098175048828
mini_batch_src_global generation:  0.06447839736938477
r_  generation:  0.5650756359100342
local_output_nid generation:  0.03685355186462402
local_in_edges_tensor generation:  0.03657650947570801
mini_batch_src_global generation:  0.06485533714294434
r_  generation:  0.5702502727508545
local_output_nid generation:  0.04667067527770996
local_in_edges_tensor generation:  0.03634810447692871
mini_batch_src_global generation:  0.06373929977416992
r_  generation:  0.5762147903442383
----------------------check_connections_block total spend ----------------------------- 3.344348669052124
generate_one_block  0.7326934337615967
generate_one_block  0.7341511249542236
generate_one_block  0.7250101566314697
generate_one_block  0.7403151988983154
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.15573453903198242  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

connection checking time:  6.157820701599121
block generation total time  5.497037172317505
average batch blocks generation time:  1.3742592930793762
block dataloader generation time/epoch 13.639265794020433
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11285638809204102  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.147613525390625  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.1130375862121582  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1501274108886719  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11367511749267578  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.140615463256836  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11280488967895508  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1473417282104492  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09518414735794067 |0.02558135986328125 |0.0036965608596801758 |9.554624557495117e-05 |0.003573894500732422 |0.001627206802368164 |
----------------------------------------------------------pseudo_mini_loss sum 1.2934691905975342
Total (block generation + training)time/epoch 14.227019750154936
Training time/epoch 0.6038763523101807
Training time without block to device /epoch 0.5015509128570557
Training time without total dataloading part /epoch 0.03109121322631836
load block tensor time/epoch 0.3807365894317627
block to device time/epoch 0.102325439453125
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 22 |
Number of nodes for computation during this epoch:  1722714
Number of first layer input nodes during this epoch:  663013
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.15529727935791016  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.034395456314086914
range selection method range initialization spend 0.015629291534423828
time for parepare:  0.01693415641784668
local_output_nid generation:  0.005682468414306641
local_in_edges_tensor generation:  0.0065000057220458984
mini_batch_src_global generation:  0.007925271987915039
r_  generation:  0.09095954895019531
local_output_nid generation:  0.006256103515625
local_in_edges_tensor generation:  0.0035178661346435547
mini_batch_src_global generation:  0.01021432876586914
r_  generation:  0.09824848175048828
local_output_nid generation:  0.006207942962646484
local_in_edges_tensor generation:  0.003515005111694336
mini_batch_src_global generation:  0.007746458053588867
r_  generation:  0.10195183753967285
local_output_nid generation:  0.006327629089355469
local_in_edges_tensor generation:  0.0032324790954589844
mini_batch_src_global generation:  0.008254528045654297
r_  generation:  0.10392332077026367
----------------------check_connections_block total spend ----------------------------- 0.5679750442504883
generate_one_block  0.11858773231506348
generate_one_block  0.11497807502746582
generate_one_block  0.11549639701843262
generate_one_block  0.11597633361816406
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03780841827392578
gen group dst list time:  0.011375904083251953
time for parepare:  0.01935863494873047
local_output_nid generation:  0.016007423400878906
local_in_edges_tensor generation:  0.03467106819152832
mini_batch_src_global generation:  0.045876264572143555
r_  generation:  0.4714477062225342
local_output_nid generation:  0.023914575576782227
local_in_edges_tensor generation:  0.029210805892944336
mini_batch_src_global generation:  0.056195974349975586
r_  generation:  0.4819040298461914
local_output_nid generation:  0.023821592330932617
local_in_edges_tensor generation:  0.027395963668823242
mini_batch_src_global generation:  0.055948734283447266
r_  generation:  0.48654675483703613
local_output_nid generation:  0.02415919303894043
local_in_edges_tensor generation:  0.025495290756225586
mini_batch_src_global generation:  0.05826544761657715
r_  generation:  0.4928560256958008
----------------------check_connections_block total spend ----------------------------- 2.7774202823638916
generate_one_block  0.623051643371582
generate_one_block  0.6324610710144043
generate_one_block  0.6595535278320312
generate_one_block  0.6537275314331055
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.043355703353881836
gen group dst list time:  0.025321245193481445
time for parepare:  0.018692493438720703
local_output_nid generation:  0.02612471580505371
local_in_edges_tensor generation:  0.05539655685424805
mini_batch_src_global generation:  0.05582690238952637
r_  generation:  0.5623741149902344
local_output_nid generation:  0.03438711166381836
local_in_edges_tensor generation:  0.041075706481933594
mini_batch_src_global generation:  0.06604599952697754
r_  generation:  0.5681436061859131
local_output_nid generation:  0.034972190856933594
local_in_edges_tensor generation:  0.03664565086364746
mini_batch_src_global generation:  0.0660243034362793
r_  generation:  0.567413330078125
local_output_nid generation:  0.03525805473327637
local_in_edges_tensor generation:  0.03850436210632324
mini_batch_src_global generation:  0.06376171112060547
r_  generation:  0.5754392147064209
----------------------check_connections_block total spend ----------------------------- 3.3407225608825684
generate_one_block  0.7342612743377686
generate_one_block  0.7242217063903809
generate_one_block  0.719388484954834
generate_one_block  0.7290713787078857
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.15529727935791016  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

connection checking time:  6.11814284324646
block generation total time  5.475736618041992
average batch blocks generation time:  1.368934154510498
block dataloader generation time/epoch 13.63402111189706
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11306953430175781  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.150106430053711  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11371994018554688  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1420764923095703  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11274147033691406  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1426692008972168  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11289501190185547  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.149362564086914  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09476649761199951 |0.02100127935409546 |0.003685295581817627 |9.745359420776367e-05 |0.0038527846336364746 |0.0015676021575927734 |
----------------------------------------------------------pseudo_mini_loss sum 1.2799677848815918
Total (block generation + training)time/epoch 14.221659455980573
Training time/epoch 0.5859086513519287
Training time without block to device /epoch 0.5019035339355469
Training time without total dataloading part /epoch 0.032109737396240234
load block tensor time/epoch 0.37906599044799805
block to device time/epoch 0.08400511741638184
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 23 |
Number of nodes for computation during this epoch:  1721885
Number of first layer input nodes during this epoch:  662770
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.15735912322998047  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023003101348876953
range selection method range initialization spend 0.011751651763916016
time for parepare:  0.017418622970581055
local_output_nid generation:  0.005609989166259766
local_in_edges_tensor generation:  0.0058710575103759766
mini_batch_src_global generation:  0.00780940055847168
r_  generation:  0.09592390060424805
local_output_nid generation:  0.0065517425537109375
local_in_edges_tensor generation:  0.0036134719848632812
mini_batch_src_global generation:  0.010075092315673828
r_  generation:  0.09891438484191895
local_output_nid generation:  0.006561756134033203
local_in_edges_tensor generation:  0.003185749053955078
mini_batch_src_global generation:  0.012418985366821289
r_  generation:  0.10183048248291016
local_output_nid generation:  0.006563425064086914
local_in_edges_tensor generation:  0.003165006637573242
mini_batch_src_global generation:  0.008385181427001953
r_  generation:  0.10503506660461426
----------------------check_connections_block total spend ----------------------------- 0.5858697891235352
generate_one_block  0.11349034309387207
generate_one_block  0.11535310745239258
generate_one_block  0.11562085151672363
generate_one_block  0.11588144302368164
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04811549186706543
gen group dst list time:  0.011484622955322266
time for parepare:  0.019435644149780273
local_output_nid generation:  0.016285181045532227
local_in_edges_tensor generation:  0.03714799880981445
mini_batch_src_global generation:  0.04818248748779297
r_  generation:  0.46691060066223145
local_output_nid generation:  0.0242612361907959
local_in_edges_tensor generation:  0.034537553787231445
mini_batch_src_global generation:  0.057062387466430664
r_  generation:  0.48387765884399414
local_output_nid generation:  0.023775815963745117
local_in_edges_tensor generation:  0.025534629821777344
mini_batch_src_global generation:  0.056958675384521484
r_  generation:  0.4840877056121826
local_output_nid generation:  0.023979902267456055
local_in_edges_tensor generation:  0.027782678604125977
mini_batch_src_global generation:  0.059633731842041016
r_  generation:  0.48889827728271484
----------------------check_connections_block total spend ----------------------------- 2.783264398574829
generate_one_block  0.6252820491790771
generate_one_block  0.6248722076416016
generate_one_block  0.6430578231811523
generate_one_block  0.6247100830078125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03338909149169922
gen group dst list time:  0.02221512794494629
time for parepare:  0.018539905548095703
local_output_nid generation:  0.02449178695678711
local_in_edges_tensor generation:  0.03762960433959961
mini_batch_src_global generation:  0.051847219467163086
r_  generation:  0.5559146404266357
local_output_nid generation:  0.033463239669799805
local_in_edges_tensor generation:  0.03783535957336426
mini_batch_src_global generation:  0.06756949424743652
r_  generation:  0.5645084381103516
local_output_nid generation:  0.03433060646057129
local_in_edges_tensor generation:  0.03799128532409668
mini_batch_src_global generation:  0.06572556495666504
r_  generation:  0.5669939517974854
local_output_nid generation:  0.034569740295410156
local_in_edges_tensor generation:  0.03813791275024414
mini_batch_src_global generation:  0.0636453628540039
r_  generation:  0.571117639541626
----------------------check_connections_block total spend ----------------------------- 3.292292594909668
generate_one_block  0.7140059471130371
generate_one_block  0.7188663482666016
generate_one_block  0.7236533164978027
generate_one_block  0.726813554763794
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.15735912322998047  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

connection checking time:  6.075556993484497
block generation total time  5.401261329650879
average batch blocks generation time:  1.3503153324127197
block dataloader generation time/epoch 13.619199991226196
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.1138601303100586  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1428580284118652  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11283063888549805  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1478338241577148  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11291933059692383  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1495518684387207  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11394691467285156  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1481313705444336  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09163457155227661 |0.01619821786880493 |0.0035358667373657227 |9.78708267211914e-05 |0.0030146241188049316 |0.0017693042755126953 |
----------------------------------------------------------pseudo_mini_loss sum 1.2706432342529297
Total (block generation + training)time/epoch 14.20458525021871
Training time/epoch 0.5536587238311768
Training time without block to device /epoch 0.48886585235595703
Training time without total dataloading part /epoch 0.028362751007080078
load block tensor time/epoch 0.36653828620910645
block to device time/epoch 0.06479287147521973
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 24 |
Number of nodes for computation during this epoch:  1723169
Number of first layer input nodes during this epoch:  662880
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.1557903289794922  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027358055114746094
range selection method range initialization spend 0.013006448745727539
time for parepare:  0.01660442352294922
local_output_nid generation:  0.0055084228515625
local_in_edges_tensor generation:  0.005953550338745117
mini_batch_src_global generation:  0.007896184921264648
r_  generation:  0.09138798713684082
local_output_nid generation:  0.00609278678894043
local_in_edges_tensor generation:  0.003404855728149414
mini_batch_src_global generation:  0.010287046432495117
r_  generation:  0.09731221199035645
local_output_nid generation:  0.006034374237060547
local_in_edges_tensor generation:  0.0032279491424560547
mini_batch_src_global generation:  0.008032560348510742
r_  generation:  0.10436511039733887
local_output_nid generation:  0.006194114685058594
local_in_edges_tensor generation:  0.003225564956665039
mini_batch_src_global generation:  0.008624076843261719
r_  generation:  0.1037452220916748
----------------------check_connections_block total spend ----------------------------- 0.5678398609161377
generate_one_block  0.1136171817779541
generate_one_block  0.11417245864868164
generate_one_block  0.11640667915344238
generate_one_block  0.11544537544250488
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.031351327896118164
gen group dst list time:  0.011247396469116211
time for parepare:  0.01928567886352539
local_output_nid generation:  0.01617264747619629
local_in_edges_tensor generation:  0.03555917739868164
mini_batch_src_global generation:  0.045736074447631836
r_  generation:  0.471668004989624
local_output_nid generation:  0.02392435073852539
local_in_edges_tensor generation:  0.029796361923217773
mini_batch_src_global generation:  0.05521440505981445
r_  generation:  0.47440671920776367
local_output_nid generation:  0.023962974548339844
local_in_edges_tensor generation:  0.02987980842590332
mini_batch_src_global generation:  0.0580136775970459
r_  generation:  0.49346017837524414
local_output_nid generation:  0.024072647094726562
local_in_edges_tensor generation:  0.029972314834594727
mini_batch_src_global generation:  0.0562138557434082
r_  generation:  0.5052230358123779
----------------------check_connections_block total spend ----------------------------- 2.803253412246704
generate_one_block  0.625394344329834
generate_one_block  0.6131088733673096
generate_one_block  0.6510021686553955
generate_one_block  0.6165995597839355
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03047776222229004
gen group dst list time:  0.022249937057495117
time for parepare:  0.018445253372192383
local_output_nid generation:  0.024771451950073242
local_in_edges_tensor generation:  0.04673600196838379
mini_batch_src_global generation:  0.052309513092041016
r_  generation:  0.5615592002868652
local_output_nid generation:  0.03374981880187988
local_in_edges_tensor generation:  0.04484748840332031
mini_batch_src_global generation:  0.06716251373291016
r_  generation:  0.5613961219787598
local_output_nid generation:  0.03452897071838379
local_in_edges_tensor generation:  0.04019427299499512
mini_batch_src_global generation:  0.06708216667175293
r_  generation:  0.5689225196838379
local_output_nid generation:  0.03473949432373047
local_in_edges_tensor generation:  0.03662109375
mini_batch_src_global generation:  0.06309747695922852
r_  generation:  0.5738396644592285
----------------------check_connections_block total spend ----------------------------- 3.3142199516296387
generate_one_block  0.7204732894897461
generate_one_block  0.7151980400085449
generate_one_block  0.7200160026550293
generate_one_block  0.7099685668945312
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.1557903289794922  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

connection checking time:  6.117473363876343
block generation total time  5.371760845184326
average batch blocks generation time:  1.3429402112960815
block dataloader generation time/epoch 13.603630244731903
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11284875869750977  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1473383903503418  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11287212371826172  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1435599327087402  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.1139225959777832  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1485748291015625  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11269283294677734  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.142472743988037  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09239757061004639 |0.015441596508026123 |0.0035421252250671387 |9.185075759887695e-05 |0.003627181053161621 |0.004899024963378906 |
----------------------------------------------------------pseudo_mini_loss sum 1.2554696798324585
Total (block generation + training)time/epoch 14.186972171068192
Training time/epoch 0.5524647235870361
Training time without block to device /epoch 0.49069833755493164
Training time without total dataloading part /epoch 0.03394365310668945
load block tensor time/epoch 0.36959028244018555
block to device time/epoch 0.06176638603210449
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 25 |
Number of nodes for computation during this epoch:  1722003
Number of first layer input nodes during this epoch:  663024
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.15503835678100586  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021065711975097656
range selection method range initialization spend 0.012096881866455078
time for parepare:  0.016560077667236328
local_output_nid generation:  0.0056002140045166016
local_in_edges_tensor generation:  0.0059070587158203125
mini_batch_src_global generation:  0.00784921646118164
r_  generation:  0.08930063247680664
local_output_nid generation:  0.006254434585571289
local_in_edges_tensor generation:  0.0033817291259765625
mini_batch_src_global generation:  0.01023411750793457
r_  generation:  0.09696650505065918
local_output_nid generation:  0.006253957748413086
local_in_edges_tensor generation:  0.0033304691314697266
mini_batch_src_global generation:  0.00774073600769043
r_  generation:  0.0999147891998291
local_output_nid generation:  0.0062406063079833984
local_in_edges_tensor generation:  0.003217935562133789
mini_batch_src_global generation:  0.008223772048950195
r_  generation:  0.10195302963256836
----------------------check_connections_block total spend ----------------------------- 0.5609989166259766
generate_one_block  0.11220765113830566
generate_one_block  0.1141359806060791
generate_one_block  0.11603069305419922
generate_one_block  0.11428499221801758
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03551530838012695
gen group dst list time:  0.011741161346435547
time for parepare:  0.021520376205444336
local_output_nid generation:  0.018739938735961914
local_in_edges_tensor generation:  0.034456491470336914
mini_batch_src_global generation:  0.05072927474975586
r_  generation:  0.48717308044433594
local_output_nid generation:  0.029165267944335938
local_in_edges_tensor generation:  0.032826900482177734
mini_batch_src_global generation:  0.0625905990600586
r_  generation:  0.4915766716003418
local_output_nid generation:  0.02948284149169922
local_in_edges_tensor generation:  0.030071020126342773
mini_batch_src_global generation:  0.06268525123596191
r_  generation:  0.5111346244812012
local_output_nid generation:  0.031513214111328125
local_in_edges_tensor generation:  0.0322573184967041
mini_batch_src_global generation:  0.06530332565307617
r_  generation:  0.5322985649108887
----------------------check_connections_block total spend ----------------------------- 2.9958317279815674
generate_one_block  0.6512141227722168
generate_one_block  0.6405761241912842
generate_one_block  0.666562557220459
generate_one_block  0.6288225650787354
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03432750701904297
gen group dst list time:  0.024807214736938477
time for parepare:  0.018737077713012695
local_output_nid generation:  0.02575397491455078
local_in_edges_tensor generation:  0.05365180969238281
mini_batch_src_global generation:  0.055908918380737305
r_  generation:  0.5611648559570312
local_output_nid generation:  0.03406214714050293
local_in_edges_tensor generation:  0.04567837715148926
mini_batch_src_global generation:  0.06509041786193848
r_  generation:  0.5743238925933838
local_output_nid generation:  0.03630208969116211
local_in_edges_tensor generation:  0.039916276931762695
mini_batch_src_global generation:  0.06854701042175293
r_  generation:  0.5762357711791992
local_output_nid generation:  0.035490989685058594
local_in_edges_tensor generation:  0.04863572120666504
mini_batch_src_global generation:  0.07482147216796875
r_  generation:  0.5858943462371826
----------------------check_connections_block total spend ----------------------------- 3.4096426963806152
generate_one_block  0.7257847785949707
generate_one_block  0.7309341430664062
generate_one_block  0.7352283000946045
generate_one_block  0.7427496910095215
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.15503835678100586  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

connection checking time:  6.405474424362183
block generation total time  5.521872282028198
average batch blocks generation time:  1.3804680705070496
block dataloader generation time/epoch 13.615923601038316
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11292505264282227  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1458334922790527  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11382722854614258  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 1.1427221298217773  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1385498046875 GB
    Memory Allocated: 0.11295032501220703  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 1.1481614112854004  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11291170120239258  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.145925521850586  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07957535982131958 |0.0215032696723938 |0.004112958908081055 |0.00010460615158081055 |0.017000436782836914 |0.0013172626495361328 |
----------------------------------------------------------pseudo_mini_loss sum 1.2431718111038208
Total (block generation + training)time/epoch 14.19927326370688
Training time/epoch 0.5831892490386963
Training time without block to device /epoch 0.4971761703491211
Training time without total dataloading part /epoch 0.08618927001953125
load block tensor time/epoch 0.3183014392852783
block to device time/epoch 0.0860130786895752
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 26 |
Number of nodes for computation during this epoch:  1722195
Number of first layer input nodes during this epoch:  662878
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15735435485839844  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021967649459838867
range selection method range initialization spend 0.011905431747436523
time for parepare:  0.01896953582763672
local_output_nid generation:  0.0057260990142822266
local_in_edges_tensor generation:  0.006511688232421875
mini_batch_src_global generation:  0.007811784744262695
r_  generation:  0.09044241905212402
local_output_nid generation:  0.00635075569152832
local_in_edges_tensor generation:  0.0033757686614990234
mini_batch_src_global generation:  0.01025247573852539
r_  generation:  0.09962892532348633
local_output_nid generation:  0.006371736526489258
local_in_edges_tensor generation:  0.0034685134887695312
mini_batch_src_global generation:  0.007750511169433594
r_  generation:  0.10263991355895996
local_output_nid generation:  0.006278514862060547
local_in_edges_tensor generation:  0.0033042430877685547
mini_batch_src_global generation:  0.00834345817565918
r_  generation:  0.10469555854797363
----------------------check_connections_block total spend ----------------------------- 0.5727880001068115
generate_one_block  0.11330056190490723
generate_one_block  0.11774325370788574
generate_one_block  0.11605405807495117
generate_one_block  0.11644172668457031
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03361225128173828
gen group dst list time:  0.011163711547851562
time for parepare:  0.019647836685180664
local_output_nid generation:  0.016107797622680664
local_in_edges_tensor generation:  0.029825687408447266
mini_batch_src_global generation:  0.046657562255859375
r_  generation:  0.4682738780975342
local_output_nid generation:  0.02458024024963379
local_in_edges_tensor generation:  0.02885913848876953
mini_batch_src_global generation:  0.05783796310424805
r_  generation:  0.4830360412597656
local_output_nid generation:  0.024451494216918945
local_in_edges_tensor generation:  0.02483344078063965
mini_batch_src_global generation:  0.05679512023925781
r_  generation:  0.4871969223022461
local_output_nid generation:  0.02425241470336914
local_in_edges_tensor generation:  0.029961347579956055
mini_batch_src_global generation:  0.058181047439575195
r_  generation:  0.4934117794036865
----------------------check_connections_block total spend ----------------------------- 2.7826497554779053
generate_one_block  0.6294088363647461
generate_one_block  0.629328727722168
generate_one_block  0.6582071781158447
generate_one_block  0.6390233039855957
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.038483619689941406
gen group dst list time:  0.025088071823120117
time for parepare:  0.01860189437866211
local_output_nid generation:  0.025310754776000977
local_in_edges_tensor generation:  0.051575660705566406
mini_batch_src_global generation:  0.05580639839172363
r_  generation:  0.5657510757446289
local_output_nid generation:  0.03404688835144043
local_in_edges_tensor generation:  0.038639068603515625
mini_batch_src_global generation:  0.06885504722595215
r_  generation:  0.5690016746520996
local_output_nid generation:  0.0346219539642334
local_in_edges_tensor generation:  0.03448367118835449
mini_batch_src_global generation:  0.06770706176757812
r_  generation:  0.5710153579711914
local_output_nid generation:  0.03484630584716797
local_in_edges_tensor generation:  0.04140615463256836
mini_batch_src_global generation:  0.0641322135925293
r_  generation:  0.573209285736084
----------------------check_connections_block total spend ----------------------------- 3.3376526832580566
generate_one_block  0.7229936122894287
generate_one_block  0.7252321243286133
generate_one_block  0.7393317222595215
generate_one_block  0.7497067451477051
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15735435485839844  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

connection checking time:  6.120302438735962
block generation total time  5.493232250213623
average batch blocks generation time:  1.3733080625534058
block dataloader generation time/epoch 13.611572808689541
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11380958557128906  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1431050300598145  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.1127924919128418  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1474170684814453  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11292648315429688  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1445326805114746  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11382532119750977  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1478080749511719  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09712201356887817 |0.018948912620544434 |0.0036323070526123047 |9.483098983764648e-05 |0.0038759708404541016 |0.003918647766113281 |
----------------------------------------------------------pseudo_mini_loss sum 1.2299150228500366
Total (block generation + training)time/epoch 14.195134705967373
Training time/epoch 0.586932897567749
Training time without block to device /epoch 0.5111372470855713
Training time without total dataloading part /epoch 0.03433108329772949
load block tensor time/epoch 0.3884880542755127
block to device time/epoch 0.07579565048217773
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 27 |
Number of nodes for computation during this epoch:  1722176
Number of first layer input nodes during this epoch:  662804
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15566158294677734  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022655725479125977
range selection method range initialization spend 0.011615753173828125
time for parepare:  0.01655745506286621
local_output_nid generation:  0.005629301071166992
local_in_edges_tensor generation:  0.008852005004882812
mini_batch_src_global generation:  0.007767677307128906
r_  generation:  0.09305572509765625
local_output_nid generation:  0.00654292106628418
local_in_edges_tensor generation:  0.004437446594238281
mini_batch_src_global generation:  0.011287450790405273
r_  generation:  0.10098981857299805
local_output_nid generation:  0.006388664245605469
local_in_edges_tensor generation:  0.004011631011962891
mini_batch_src_global generation:  0.007853507995605469
r_  generation:  0.10190582275390625
local_output_nid generation:  0.008091926574707031
local_in_edges_tensor generation:  0.004093170166015625
mini_batch_src_global generation:  0.008249759674072266
r_  generation:  0.10774350166320801
----------------------check_connections_block total spend ----------------------------- 0.6011507511138916
generate_one_block  0.11713266372680664
generate_one_block  0.1215825080871582
generate_one_block  0.12253069877624512
generate_one_block  0.11876797676086426
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.040406227111816406
gen group dst list time:  0.011253833770751953
time for parepare:  0.02104353904724121
local_output_nid generation:  0.016613483428955078
local_in_edges_tensor generation:  0.04298210144042969
mini_batch_src_global generation:  0.05460381507873535
r_  generation:  0.4851417541503906
local_output_nid generation:  0.02442145347595215
local_in_edges_tensor generation:  0.03195905685424805
mini_batch_src_global generation:  0.05899405479431152
r_  generation:  0.49594736099243164
local_output_nid generation:  0.024936914443969727
local_in_edges_tensor generation:  0.02840876579284668
mini_batch_src_global generation:  0.0607454776763916
r_  generation:  0.5011229515075684
local_output_nid generation:  0.027304887771606445
local_in_edges_tensor generation:  0.03774285316467285
mini_batch_src_global generation:  0.06451153755187988
r_  generation:  0.5194065570831299
----------------------check_connections_block total spend ----------------------------- 2.9443275928497314
generate_one_block  0.6562094688415527
generate_one_block  0.653813362121582
generate_one_block  0.6692898273468018
generate_one_block  0.6448071002960205
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04101133346557617
gen group dst list time:  0.023369789123535156
time for parepare:  0.01898336410522461
local_output_nid generation:  0.02992844581604004
local_in_edges_tensor generation:  0.057096242904663086
mini_batch_src_global generation:  0.05311250686645508
r_  generation:  0.5614967346191406
local_output_nid generation:  0.03560638427734375
local_in_edges_tensor generation:  0.04595303535461426
mini_batch_src_global generation:  0.06586956977844238
r_  generation:  0.5646140575408936
local_output_nid generation:  0.03618431091308594
local_in_edges_tensor generation:  0.03485226631164551
mini_batch_src_global generation:  0.0659782886505127
r_  generation:  0.5689644813537598
local_output_nid generation:  0.036280155181884766
local_in_edges_tensor generation:  0.03740215301513672
mini_batch_src_global generation:  0.06455302238464355
r_  generation:  0.5677576065063477
----------------------check_connections_block total spend ----------------------------- 3.341404914855957
generate_one_block  0.7186708450317383
generate_one_block  0.7447295188903809
generate_one_block  0.7191932201385498
generate_one_block  0.7294096946716309
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.15566158294677734  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

connection checking time:  6.2857325077056885
block generation total time  5.536123037338257
average batch blocks generation time:  1.3840307593345642
block dataloader generation time/epoch 13.621102207585386
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11266279220581055  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1422815322875977  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11303997039794922  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1498327255249023  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.1138615608215332  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1439242362976074  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11278629302978516  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1473212242126465  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08932209014892578 |0.021035194396972656 |0.0036739110946655273 |9.620189666748047e-05 |0.0035421252250671387 |0.0018277168273925781 |
----------------------------------------------------------pseudo_mini_loss sum 1.2203999757766724
Total (block generation + training)time/epoch 14.203690930416709
Training time/epoch 0.564678430557251
Training time without block to device /epoch 0.48053765296936035
Training time without total dataloading part /epoch 0.031076669692993164
load block tensor time/epoch 0.3572883605957031
block to device time/epoch 0.08414077758789062
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 28 |
Number of nodes for computation during this epoch:  1722492
Number of first layer input nodes during this epoch:  662895
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.1551804542541504  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023159027099609375
range selection method range initialization spend 0.012044906616210938
time for parepare:  0.017074108123779297
local_output_nid generation:  0.005589962005615234
local_in_edges_tensor generation:  0.006968259811401367
mini_batch_src_global generation:  0.007815361022949219
r_  generation:  0.09096670150756836
local_output_nid generation:  0.006229400634765625
local_in_edges_tensor generation:  0.0032944679260253906
mini_batch_src_global generation:  0.01019430160522461
r_  generation:  0.09688663482666016
local_output_nid generation:  0.006142139434814453
local_in_edges_tensor generation:  0.0033063888549804688
mini_batch_src_global generation:  0.008126258850097656
r_  generation:  0.10074377059936523
local_output_nid generation:  0.006028890609741211
local_in_edges_tensor generation:  0.0036416053771972656
mini_batch_src_global generation:  0.00838470458984375
r_  generation:  0.10449481010437012
----------------------check_connections_block total spend ----------------------------- 0.5668833255767822
generate_one_block  0.11344742774963379
generate_one_block  0.11435413360595703
generate_one_block  0.11739921569824219
generate_one_block  0.11920738220214844
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04508805274963379
gen group dst list time:  0.011445283889770508
time for parepare:  0.01957392692565918
local_output_nid generation:  0.01631951332092285
local_in_edges_tensor generation:  0.03328084945678711
mini_batch_src_global generation:  0.04824328422546387
r_  generation:  0.47254037857055664
local_output_nid generation:  0.024350404739379883
local_in_edges_tensor generation:  0.030977725982666016
mini_batch_src_global generation:  0.05585026741027832
r_  generation:  0.4784705638885498
local_output_nid generation:  0.024445295333862305
local_in_edges_tensor generation:  0.029646873474121094
mini_batch_src_global generation:  0.05675506591796875
r_  generation:  0.48885679244995117
local_output_nid generation:  0.024082422256469727
local_in_edges_tensor generation:  0.030133724212646484
mini_batch_src_global generation:  0.05719637870788574
r_  generation:  0.491912841796875
----------------------check_connections_block total spend ----------------------------- 2.791102647781372
generate_one_block  0.6296322345733643
generate_one_block  0.6417036056518555
generate_one_block  0.670189619064331
generate_one_block  0.6564621925354004
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0414888858795166
gen group dst list time:  0.025793790817260742
time for parepare:  0.02075338363647461
local_output_nid generation:  0.026165008544921875
local_in_edges_tensor generation:  0.04939770698547363
mini_batch_src_global generation:  0.055876731872558594
r_  generation:  0.5596215724945068
local_output_nid generation:  0.034010887145996094
local_in_edges_tensor generation:  0.043364524841308594
mini_batch_src_global generation:  0.0655508041381836
r_  generation:  0.5640184879302979
local_output_nid generation:  0.0346674919128418
local_in_edges_tensor generation:  0.0400238037109375
mini_batch_src_global generation:  0.06581997871398926
r_  generation:  0.5664308071136475
local_output_nid generation:  0.03522491455078125
local_in_edges_tensor generation:  0.04213070869445801
mini_batch_src_global generation:  0.06618547439575195
r_  generation:  0.5841672420501709
----------------------check_connections_block total spend ----------------------------- 3.349290132522583
generate_one_block  0.7252209186553955
generate_one_block  0.7188773155212402
generate_one_block  0.7251317501068115
generate_one_block  0.7339074611663818
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.1551804542541504  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

connection checking time:  6.140392780303955
block generation total time  5.50112509727478
average batch blocks generation time:  1.375281274318695
block dataloader generation time/epoch 13.619438195228577
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11296224594116211  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1498346328735352  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11378669738769531  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.140965461730957  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11279773712158203  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1442112922668457  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 0.11303949356079102  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9022216796875 GB
    Memory Allocated: 1.1496243476867676  GigaBytes
Max Memory Allocated: 1.355783462524414  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09018129110336304 |0.022209763526916504 |0.003618478775024414 |9.614229202270508e-05 |0.003809213638305664 |0.0029172897338867188 |
----------------------------------------------------------pseudo_mini_loss sum 1.2093002796173096
Total (block generation + training)time/epoch 14.20168262720108
Training time/epoch 0.575434684753418
Training time without block to device /epoch 0.48659563064575195
Training time without total dataloading part /epoch 0.03301262855529785
load block tensor time/epoch 0.36072516441345215
block to device time/epoch 0.08883905410766602
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 29 |
Number of nodes for computation during this epoch:  1722407
Number of first layer input nodes during this epoch:  662921
