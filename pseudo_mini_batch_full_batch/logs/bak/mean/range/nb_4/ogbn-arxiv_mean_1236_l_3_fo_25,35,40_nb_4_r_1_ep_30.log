Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1647767052.247206
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024470090866088867
range selection method range initialization spend 0.013616085052490234
time for parepare:  0.018299102783203125
local_output_nid generation:  0.005444049835205078
local_in_edges_tensor generation:  0.005922794342041016
mini_batch_src_global generation:  0.007010936737060547
r_  generation:  0.08262777328491211
local_output_nid generation:  0.0060579776763916016
local_in_edges_tensor generation:  0.0030364990234375
mini_batch_src_global generation:  0.008908987045288086
r_  generation:  0.08740234375
local_output_nid generation:  0.006285429000854492
local_in_edges_tensor generation:  0.0031778812408447266
mini_batch_src_global generation:  0.006886959075927734
r_  generation:  0.08975911140441895
local_output_nid generation:  0.006214141845703125
local_in_edges_tensor generation:  0.003144979476928711
mini_batch_src_global generation:  0.007194995880126953
r_  generation:  0.09125804901123047
----------------------check_connections_block total spend ----------------------------- 0.5105628967285156
generate_one_block  0.10274624824523926
generate_one_block  0.1029200553894043
generate_one_block  0.10374045372009277
generate_one_block  0.10545802116394043
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04024815559387207
gen group dst list time:  0.011319875717163086
time for parepare:  0.020383119583129883
local_output_nid generation:  0.014898061752319336
local_in_edges_tensor generation:  0.036174774169921875
mini_batch_src_global generation:  0.04287099838256836
r_  generation:  0.39551639556884766
local_output_nid generation:  0.024918794631958008
local_in_edges_tensor generation:  0.03590226173400879
mini_batch_src_global generation:  0.0494382381439209
r_  generation:  0.4481687545776367
local_output_nid generation:  0.026769161224365234
local_in_edges_tensor generation:  0.04891014099121094
mini_batch_src_global generation:  0.06863856315612793
r_  generation:  0.4153165817260742
local_output_nid generation:  0.02341008186340332
local_in_edges_tensor generation:  0.02997112274169922
mini_batch_src_global generation:  0.051200151443481445
r_  generation:  0.4194624423980713
----------------------check_connections_block total spend ----------------------------- 2.5298640727996826
generate_one_block  0.5524649620056152
generate_one_block  0.5381128787994385
generate_one_block  0.5267493724822998
generate_one_block  0.5235848426818848
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05542945861816406
gen group dst list time:  0.020911693572998047
time for parepare:  0.019143104553222656
local_output_nid generation:  0.024628639221191406
local_in_edges_tensor generation:  0.05296754837036133
mini_batch_src_global generation:  0.056752681732177734
r_  generation:  0.5157122611999512
local_output_nid generation:  0.03330659866333008
local_in_edges_tensor generation:  0.05983543395996094
mini_batch_src_global generation:  0.06057620048522949
r_  generation:  0.543769359588623
local_output_nid generation:  0.0380859375
local_in_edges_tensor generation:  0.05381035804748535
mini_batch_src_global generation:  0.06211996078491211
r_  generation:  0.5164363384246826
local_output_nid generation:  0.03525280952453613
local_in_edges_tensor generation:  0.04493880271911621
mini_batch_src_global generation:  0.0590662956237793
r_  generation:  0.527390718460083
----------------------check_connections_block total spend ----------------------------- 3.1692779064178467
generate_one_block  0.6479382514953613
generate_one_block  0.644636869430542
generate_one_block  0.6431994438171387
generate_one_block  0.668473482131958
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  5.699141979217529
block generation total time  4.745160102844238
average batch blocks generation time:  1.1862900257110596
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.10184288024902344  GigaBytes
Max Memory Allocated: 0.10184288024902344  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6463623046875 GB
    Memory Allocated: 1.09660005569458  GigaBytes
Max Memory Allocated: 1.184628963470459  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.1062936782836914  GigaBytes
Max Memory Allocated: 1.2882485389709473  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 1.101921558380127  GigaBytes
Max Memory Allocated: 1.2882485389709473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0604248046875 GB
    Memory Allocated: 0.10604095458984375  GigaBytes
Max Memory Allocated: 1.2951703071594238  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0604248046875 GB
    Memory Allocated: 1.0973320007324219  GigaBytes
Max Memory Allocated: 1.2951703071594238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0604248046875 GB
    Memory Allocated: 0.10605478286743164  GigaBytes
Max Memory Allocated: 1.2951703071594238  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0604248046875 GB
    Memory Allocated: 1.0956482887268066  GigaBytes
Max Memory Allocated: 1.2951703071594238  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06505316495895386 |0.10918909311294556 |0.20501059293746948 |0.00011605024337768555 |0.020897388458251953 |0.0018892288208007812 |
----------------------------------------------------------pseudo_mini_loss sum 6.151419639587402
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1680171
Number of first layer input nodes during this epoch:  656921
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0604248046875 GB
    Memory Allocated: 0.14435815811157227  GigaBytes
Max Memory Allocated: 1.2951703071594238  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0265200138092041
range selection method range initialization spend 0.013080835342407227
time for parepare:  0.017411470413208008
local_output_nid generation:  0.005352020263671875
local_in_edges_tensor generation:  0.006329059600830078
mini_batch_src_global generation:  0.007135152816772461
r_  generation:  0.0822458267211914
local_output_nid generation:  0.006104946136474609
local_in_edges_tensor generation:  0.003258228302001953
mini_batch_src_global generation:  0.009077787399291992
r_  generation:  0.08676695823669434
local_output_nid generation:  0.006251096725463867
local_in_edges_tensor generation:  0.00323486328125
mini_batch_src_global generation:  0.007032871246337891
r_  generation:  0.09067988395690918
local_output_nid generation:  0.00629425048828125
local_in_edges_tensor generation:  0.0031461715698242188
mini_batch_src_global generation:  0.007417917251586914
r_  generation:  0.09430551528930664
----------------------check_connections_block total spend ----------------------------- 0.5169837474822998
generate_one_block  0.11487030982971191
generate_one_block  0.10255813598632812
generate_one_block  0.10375809669494629
generate_one_block  0.10431742668151855
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03685808181762695
gen group dst list time:  0.011102914810180664
time for parepare:  0.019575834274291992
local_output_nid generation:  0.01479959487915039
local_in_edges_tensor generation:  0.03529095649719238
mini_batch_src_global generation:  0.03988146781921387
r_  generation:  0.3950307369232178
local_output_nid generation:  0.021433353424072266
local_in_edges_tensor generation:  0.0365145206451416
mini_batch_src_global generation:  0.049703359603881836
r_  generation:  0.4128420352935791
local_output_nid generation:  0.022453784942626953
local_in_edges_tensor generation:  0.026084184646606445
mini_batch_src_global generation:  0.053899526596069336
r_  generation:  0.42336440086364746
local_output_nid generation:  0.024172306060791016
local_in_edges_tensor generation:  0.034325599670410156
mini_batch_src_global generation:  0.050626277923583984
r_  generation:  0.4290647506713867
----------------------check_connections_block total spend ----------------------------- 2.4528958797454834
generate_one_block  0.5688397884368896
generate_one_block  0.5378053188323975
generate_one_block  0.565786600112915
generate_one_block  0.5435013771057129
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03631162643432617
gen group dst list time:  0.02118396759033203
time for parepare:  0.019420862197875977
local_output_nid generation:  0.024268388748168945
local_in_edges_tensor generation:  0.05499911308288574
mini_batch_src_global generation:  0.05174732208251953
r_  generation:  0.49497389793395996
local_output_nid generation:  0.03363394737243652
local_in_edges_tensor generation:  0.049312591552734375
mini_batch_src_global generation:  0.0585932731628418
r_  generation:  0.5088989734649658
local_output_nid generation:  0.04632115364074707
local_in_edges_tensor generation:  0.03738069534301758
mini_batch_src_global generation:  0.054822683334350586
r_  generation:  0.5292291641235352
local_output_nid generation:  0.0353240966796875
local_in_edges_tensor generation:  0.04673147201538086
mini_batch_src_global generation:  0.05733966827392578
r_  generation:  0.5473072528839111
----------------------check_connections_block total spend ----------------------------- 3.1051063537597656
generate_one_block  0.6601231098175049
generate_one_block  0.6280078887939453
generate_one_block  0.6346545219421387
generate_one_block  0.644512414932251
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0604248046875 GB
    Memory Allocated: 0.14435815811157227  GigaBytes
Max Memory Allocated: 1.2951703071594238  GigaBytes

connection checking time:  5.558002233505249
block generation total time  4.783231019973755
average batch blocks generation time:  1.1958077549934387
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0604248046875 GB
    Memory Allocated: 0.10871696472167969  GigaBytes
Max Memory Allocated: 1.2951703071594238  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1036462783813477  GigaBytes
Max Memory Allocated: 1.2951703071594238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10867023468017578  GigaBytes
Max Memory Allocated: 1.2968273162841797  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.09771728515625  GigaBytes
Max Memory Allocated: 1.2968273162841797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.1086130142211914  GigaBytes
Max Memory Allocated: 1.2968273162841797  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1041550636291504  GigaBytes
Max Memory Allocated: 1.2968273162841797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10780668258666992  GigaBytes
Max Memory Allocated: 1.2971587181091309  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1062664985656738  GigaBytes
Max Memory Allocated: 1.2971587181091309  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09281659126281738 |0.018173575401306152 |0.003845036029815674 |9.584426879882812e-05 |0.016513526439666748 |0.0030622482299804688 |
----------------------------------------------------------pseudo_mini_loss sum 3.233076333999634
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1681043
Number of first layer input nodes during this epoch:  656952
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.1444082260131836  GigaBytes
Max Memory Allocated: 1.2993669509887695  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028072357177734375
range selection method range initialization spend 0.011791229248046875
time for parepare:  0.017499685287475586
local_output_nid generation:  0.00513911247253418
local_in_edges_tensor generation:  0.008212804794311523
mini_batch_src_global generation:  0.011618614196777344
r_  generation:  0.0824127197265625
local_output_nid generation:  0.006018161773681641
local_in_edges_tensor generation:  0.0030083656311035156
mini_batch_src_global generation:  0.010941743850708008
r_  generation:  0.08913350105285645
local_output_nid generation:  0.006072044372558594
local_in_edges_tensor generation:  0.003045797348022461
mini_batch_src_global generation:  0.006798982620239258
r_  generation:  0.0902857780456543
local_output_nid generation:  0.0060575008392333984
local_in_edges_tensor generation:  0.0031228065490722656
mini_batch_src_global generation:  0.007405757904052734
r_  generation:  0.09372305870056152
----------------------check_connections_block total spend ----------------------------- 0.5242254734039307
generate_one_block  0.11099815368652344
generate_one_block  0.10281848907470703
generate_one_block  0.10430502891540527
generate_one_block  0.10257172584533691
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03502488136291504
gen group dst list time:  0.011568546295166016
time for parepare:  0.019516944885253906
local_output_nid generation:  0.015641212463378906
local_in_edges_tensor generation:  0.03158116340637207
mini_batch_src_global generation:  0.05610823631286621
r_  generation:  0.40360164642333984
local_output_nid generation:  0.022722721099853516
local_in_edges_tensor generation:  0.021955251693725586
mini_batch_src_global generation:  0.04927635192871094
r_  generation:  0.4116208553314209
local_output_nid generation:  0.022788047790527344
local_in_edges_tensor generation:  0.026182889938354492
mini_batch_src_global generation:  0.04922008514404297
r_  generation:  0.4186422824859619
local_output_nid generation:  0.023169755935668945
local_in_edges_tensor generation:  0.022812366485595703
mini_batch_src_global generation:  0.049932003021240234
r_  generation:  0.41593194007873535
----------------------check_connections_block total spend ----------------------------- 2.4175684452056885
generate_one_block  0.5245649814605713
generate_one_block  0.5250453948974609
generate_one_block  0.5553543567657471
generate_one_block  0.526282787322998
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03838658332824707
gen group dst list time:  0.023643016815185547
time for parepare:  0.019291162490844727
local_output_nid generation:  0.024875879287719727
local_in_edges_tensor generation:  0.04433941841125488
mini_batch_src_global generation:  0.05013751983642578
r_  generation:  0.4963111877441406
local_output_nid generation:  0.03415393829345703
local_in_edges_tensor generation:  0.0420379638671875
mini_batch_src_global generation:  0.058126211166381836
r_  generation:  0.5147571563720703
local_output_nid generation:  0.03496742248535156
local_in_edges_tensor generation:  0.0390927791595459
mini_batch_src_global generation:  0.05632472038269043
r_  generation:  0.5317292213439941
local_output_nid generation:  0.03729891777038574
local_in_edges_tensor generation:  0.03751945495605469
mini_batch_src_global generation:  0.059438228607177734
r_  generation:  0.5177402496337891
----------------------check_connections_block total spend ----------------------------- 3.044767141342163
generate_one_block  0.6279289722442627
generate_one_block  0.6387734413146973
generate_one_block  0.6388969421386719
generate_one_block  0.6326005458831787
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.1444082260131836  GigaBytes
Max Memory Allocated: 1.2993669509887695  GigaBytes

connection checking time:  5.462335586547852
block generation total time  4.669447422027588
average batch blocks generation time:  1.167361855506897
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10866737365722656  GigaBytes
Max Memory Allocated: 1.2993669509887695  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.107027530670166  GigaBytes
Max Memory Allocated: 1.2993669509887695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10877418518066406  GigaBytes
Max Memory Allocated: 1.3002653121948242  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.0987153053283691  GigaBytes
Max Memory Allocated: 1.3002653121948242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10867500305175781  GigaBytes
Max Memory Allocated: 1.3002653121948242  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.107640266418457  GigaBytes
Max Memory Allocated: 1.3002653121948242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10760354995727539  GigaBytes
Max Memory Allocated: 1.3011198043823242  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.0968337059020996  GigaBytes
Max Memory Allocated: 1.3011198043823242  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07959681749343872 |0.01817864179611206 |0.008857250213623047 |9.465217590332031e-05 |0.011652052402496338 |0.0017848014831542969 |
----------------------------------------------------------pseudo_mini_loss sum 2.618921995162964
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  1681224
Number of first layer input nodes during this epoch:  657102
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14400434494018555  GigaBytes
Max Memory Allocated: 1.3011198043823242  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02835988998413086
range selection method range initialization spend 0.014189004898071289
time for parepare:  0.017284154891967773
local_output_nid generation:  0.005476474761962891
local_in_edges_tensor generation:  0.007195711135864258
mini_batch_src_global generation:  0.007533550262451172
r_  generation:  0.0855865478515625
local_output_nid generation:  0.006047487258911133
local_in_edges_tensor generation:  0.003910541534423828
mini_batch_src_global generation:  0.009634017944335938
r_  generation:  0.08995771408081055
local_output_nid generation:  0.006247520446777344
local_in_edges_tensor generation:  0.004009246826171875
mini_batch_src_global generation:  0.0074100494384765625
r_  generation:  0.10231995582580566
local_output_nid generation:  0.006322145462036133
local_in_edges_tensor generation:  0.004194974899291992
mini_batch_src_global generation:  0.03360915184020996
r_  generation:  0.10718035697937012
----------------------check_connections_block total spend ----------------------------- 0.6317253112792969
generate_one_block  0.10187959671020508
generate_one_block  0.10361504554748535
generate_one_block  0.10692119598388672
generate_one_block  0.10678267478942871
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.045705318450927734
gen group dst list time:  0.01194453239440918
time for parepare:  0.021492958068847656
local_output_nid generation:  0.0283203125
local_in_edges_tensor generation:  0.03805255889892578
mini_batch_src_global generation:  0.043451786041259766
r_  generation:  0.40602564811706543
local_output_nid generation:  0.028794527053833008
local_in_edges_tensor generation:  0.038107872009277344
mini_batch_src_global generation:  0.04959511756896973
r_  generation:  0.41678571701049805
local_output_nid generation:  0.02790546417236328
local_in_edges_tensor generation:  0.0350949764251709
mini_batch_src_global generation:  0.05007529258728027
r_  generation:  0.43101072311401367
local_output_nid generation:  0.029301881790161133
local_in_edges_tensor generation:  0.03999733924865723
mini_batch_src_global generation:  0.052826881408691406
r_  generation:  0.43074822425842285
----------------------check_connections_block total spend ----------------------------- 2.564164400100708
generate_one_block  0.5510964393615723
generate_one_block  0.5238630771636963
generate_one_block  0.5614368915557861
generate_one_block  0.5371787548065186
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029685258865356445
gen group dst list time:  0.02240729331970215
time for parepare:  0.021662473678588867
local_output_nid generation:  0.02635645866394043
local_in_edges_tensor generation:  0.06299352645874023
mini_batch_src_global generation:  0.05589699745178223
r_  generation:  0.5444338321685791
local_output_nid generation:  0.03660273551940918
local_in_edges_tensor generation:  0.04607200622558594
mini_batch_src_global generation:  0.06101632118225098
r_  generation:  0.518218994140625
local_output_nid generation:  0.03811216354370117
local_in_edges_tensor generation:  0.04002714157104492
mini_batch_src_global generation:  0.06352376937866211
r_  generation:  0.590766191482544
local_output_nid generation:  0.03859758377075195
local_in_edges_tensor generation:  0.03920459747314453
mini_batch_src_global generation:  0.06092500686645508
r_  generation:  0.5316042900085449
----------------------check_connections_block total spend ----------------------------- 3.308464527130127
generate_one_block  0.6675395965576172
generate_one_block  0.6382665634155273
generate_one_block  0.6362488269805908
generate_one_block  0.6463639736175537
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14400434494018555  GigaBytes
Max Memory Allocated: 1.3011198043823242  GigaBytes

connection checking time:  5.872628927230835
block generation total time  4.761994123458862
average batch blocks generation time:  1.1904985308647156
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10843753814697266  GigaBytes
Max Memory Allocated: 1.3011198043823242  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1030969619750977  GigaBytes
Max Memory Allocated: 1.3011198043823242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10874080657958984  GigaBytes
Max Memory Allocated: 1.3011198043823242  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.0973482131958008  GigaBytes
Max Memory Allocated: 1.3011198043823242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10866832733154297  GigaBytes
Max Memory Allocated: 1.3011198043823242  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1043739318847656  GigaBytes
Max Memory Allocated: 1.3011198043823242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10768795013427734  GigaBytes
Max Memory Allocated: 1.3011198043823242  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.0985021591186523  GigaBytes
Max Memory Allocated: 1.3011198043823242  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09118694067001343 |0.016697466373443604 |0.003683030605316162 |9.566545486450195e-05 |0.0038906335830688477 |0.0015270709991455078 |
----------------------------------------------------------pseudo_mini_loss sum 2.379162549972534
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  1679934
Number of first layer input nodes during this epoch:  657025
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14427947998046875  GigaBytes
Max Memory Allocated: 1.3011198043823242  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024573564529418945
range selection method range initialization spend 0.01186060905456543
time for parepare:  0.01713252067565918
local_output_nid generation:  0.005280256271362305
local_in_edges_tensor generation:  0.006654024124145508
mini_batch_src_global generation:  0.007172584533691406
r_  generation:  0.08121323585510254
local_output_nid generation:  0.0060651302337646484
local_in_edges_tensor generation:  0.0033180713653564453
mini_batch_src_global generation:  0.015223979949951172
r_  generation:  0.08778882026672363
local_output_nid generation:  0.006150007247924805
local_in_edges_tensor generation:  0.0030341148376464844
mini_batch_src_global generation:  0.007434368133544922
r_  generation:  0.09242105484008789
local_output_nid generation:  0.006337881088256836
local_in_edges_tensor generation:  0.003097057342529297
mini_batch_src_global generation:  0.007721662521362305
r_  generation:  0.09112763404846191
----------------------check_connections_block total spend ----------------------------- 0.5279536247253418
generate_one_block  0.09900832176208496
generate_one_block  0.10260915756225586
generate_one_block  0.10479044914245605
generate_one_block  0.1024925708770752
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.036206722259521484
gen group dst list time:  0.011213302612304688
time for parepare:  0.040612220764160156
local_output_nid generation:  0.020793914794921875
local_in_edges_tensor generation:  0.03596854209899902
mini_batch_src_global generation:  0.04138660430908203
r_  generation:  0.39452028274536133
local_output_nid generation:  0.025684595108032227
local_in_edges_tensor generation:  0.02822422981262207
mini_batch_src_global generation:  0.051445722579956055
r_  generation:  0.4126608371734619
local_output_nid generation:  0.026326417922973633
local_in_edges_tensor generation:  0.024570941925048828
mini_batch_src_global generation:  0.04950428009033203
r_  generation:  0.4136922359466553
local_output_nid generation:  0.026829242706298828
local_in_edges_tensor generation:  0.027512311935424805
mini_batch_src_global generation:  0.05102109909057617
r_  generation:  0.4165654182434082
----------------------check_connections_block total spend ----------------------------- 2.453784227371216
generate_one_block  0.5254595279693604
generate_one_block  0.5336766242980957
generate_one_block  0.5657522678375244
generate_one_block  0.5507190227508545
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.035445451736450195
gen group dst list time:  0.02504873275756836
time for parepare:  0.020908117294311523
local_output_nid generation:  0.025304555892944336
local_in_edges_tensor generation:  0.05173492431640625
mini_batch_src_global generation:  0.05093264579772949
r_  generation:  0.49282002449035645
local_output_nid generation:  0.03300333023071289
local_in_edges_tensor generation:  0.03944993019104004
mini_batch_src_global generation:  0.05941915512084961
r_  generation:  0.5068497657775879
local_output_nid generation:  0.03354358673095703
local_in_edges_tensor generation:  0.037424325942993164
mini_batch_src_global generation:  0.054765939712524414
r_  generation:  0.5143997669219971
local_output_nid generation:  0.03398275375366211
local_in_edges_tensor generation:  0.03274869918823242
mini_batch_src_global generation:  0.05410337448120117
r_  generation:  0.5158326625823975
----------------------check_connections_block total spend ----------------------------- 3.00248384475708
generate_one_block  0.6441380977630615
generate_one_block  0.6410837173461914
generate_one_block  0.6283135414123535
generate_one_block  0.6201198101043701
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14427947998046875  GigaBytes
Max Memory Allocated: 1.3011198043823242  GigaBytes

connection checking time:  5.456268072128296
block generation total time  4.7092626094818115
average batch blocks generation time:  1.1773156523704529
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.1085505485534668  GigaBytes
Max Memory Allocated: 1.3011198043823242  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1000757217407227  GigaBytes
Max Memory Allocated: 1.3011198043823242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.1088418960571289  GigaBytes
Max Memory Allocated: 1.3011198043823242  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1003694534301758  GigaBytes
Max Memory Allocated: 1.3011198043823242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10801982879638672  GigaBytes
Max Memory Allocated: 1.3011198043823242  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.107388973236084  GigaBytes
Max Memory Allocated: 1.3011198043823242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10881805419921875  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.103015422821045  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09023183584213257 |0.017174243927001953 |0.0037618279457092285 |9.691715240478516e-05 |0.0037903785705566406 |0.003106355667114258 |
----------------------------------------------------------pseudo_mini_loss sum 2.10892391204834
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  1680641
Number of first layer input nodes during this epoch:  656987
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.1454024314880371  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02023005485534668
range selection method range initialization spend 0.01189422607421875
time for parepare:  0.01728510856628418
local_output_nid generation:  0.005330085754394531
local_in_edges_tensor generation:  0.005636453628540039
mini_batch_src_global generation:  0.007213592529296875
r_  generation:  0.08034467697143555
local_output_nid generation:  0.006226301193237305
local_in_edges_tensor generation:  0.0036814212799072266
mini_batch_src_global generation:  0.009442329406738281
r_  generation:  0.08881330490112305
local_output_nid generation:  0.006302833557128906
local_in_edges_tensor generation:  0.0031266212463378906
mini_batch_src_global generation:  0.007129669189453125
r_  generation:  0.08948135375976562
local_output_nid generation:  0.006139039993286133
local_in_edges_tensor generation:  0.0031027793884277344
mini_batch_src_global generation:  0.0073206424713134766
r_  generation:  0.09252071380615234
----------------------check_connections_block total spend ----------------------------- 0.5131115913391113
generate_one_block  0.10044145584106445
generate_one_block  0.10325026512145996
generate_one_block  0.10591411590576172
generate_one_block  0.10272216796875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03263354301452637
gen group dst list time:  0.01122736930847168
time for parepare:  0.022427797317504883
local_output_nid generation:  0.01521158218383789
local_in_edges_tensor generation:  0.03405499458312988
mini_batch_src_global generation:  0.04310727119445801
r_  generation:  0.4094109535217285
local_output_nid generation:  0.024883508682250977
local_in_edges_tensor generation:  0.02873539924621582
mini_batch_src_global generation:  0.04986286163330078
r_  generation:  0.41090965270996094
local_output_nid generation:  0.023096799850463867
local_in_edges_tensor generation:  0.02563190460205078
mini_batch_src_global generation:  0.04968380928039551
r_  generation:  0.41263413429260254
local_output_nid generation:  0.023186922073364258
local_in_edges_tensor generation:  0.024020671844482422
mini_batch_src_global generation:  0.049927711486816406
r_  generation:  0.41411614418029785
----------------------check_connections_block total spend ----------------------------- 2.421804904937744
generate_one_block  0.5169403553009033
generate_one_block  0.5341672897338867
generate_one_block  0.5475096702575684
generate_one_block  0.5236599445343018
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02773880958557129
gen group dst list time:  0.021398305892944336
time for parepare:  0.019279003143310547
local_output_nid generation:  0.025999069213867188
local_in_edges_tensor generation:  0.0359041690826416
mini_batch_src_global generation:  0.04791855812072754
r_  generation:  0.49240756034851074
local_output_nid generation:  0.033156394958496094
local_in_edges_tensor generation:  0.0383150577545166
mini_batch_src_global generation:  0.07070231437683105
r_  generation:  0.499889612197876
local_output_nid generation:  0.0341494083404541
local_in_edges_tensor generation:  0.03650951385498047
mini_batch_src_global generation:  0.05376839637756348
r_  generation:  0.5143387317657471
local_output_nid generation:  0.0343022346496582
local_in_edges_tensor generation:  0.032552242279052734
mini_batch_src_global generation:  0.05444669723510742
r_  generation:  0.5203332901000977
----------------------check_connections_block total spend ----------------------------- 2.9910037517547607
generate_one_block  0.6205580234527588
generate_one_block  0.635847806930542
generate_one_block  0.6251468658447266
generate_one_block  0.6288309097290039
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.1454024314880371  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

connection checking time:  5.412808656692505
block generation total time  4.632660865783691
average batch blocks generation time:  1.1581652164459229
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10796308517456055  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.100337028503418  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10886573791503906  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1046738624572754  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10791635513305664  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.0996947288513184  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10877752304077148  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.098745346069336  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08753979206085205 |0.020087718963623047 |0.0035988688468933105 |9.578466415405273e-05 |0.003748953342437744 |0.0018579959869384766 |
----------------------------------------------------------pseudo_mini_loss sum 1.9529237747192383
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  1680315
Number of first layer input nodes during this epoch:  656843
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14405584335327148  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02140188217163086
range selection method range initialization spend 0.012124300003051758
time for parepare:  0.017513513565063477
local_output_nid generation:  0.005492687225341797
local_in_edges_tensor generation:  0.00919651985168457
mini_batch_src_global generation:  0.007454633712768555
r_  generation:  0.08039975166320801
local_output_nid generation:  0.006345987319946289
local_in_edges_tensor generation:  0.0030188560485839844
mini_batch_src_global generation:  0.009022712707519531
r_  generation:  0.08899402618408203
local_output_nid generation:  0.006500959396362305
local_in_edges_tensor generation:  0.0032885074615478516
mini_batch_src_global generation:  0.0068171024322509766
r_  generation:  0.0902566909790039
local_output_nid generation:  0.0063512325286865234
local_in_edges_tensor generation:  0.0037164688110351562
mini_batch_src_global generation:  0.007779598236083984
r_  generation:  0.09283256530761719
----------------------check_connections_block total spend ----------------------------- 0.5209383964538574
generate_one_block  0.10127425193786621
generate_one_block  0.10241174697875977
generate_one_block  0.10446047782897949
generate_one_block  0.1044619083404541
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03781867027282715
gen group dst list time:  0.01130223274230957
time for parepare:  0.019877910614013672
local_output_nid generation:  0.01528620719909668
local_in_edges_tensor generation:  0.03431558609008789
mini_batch_src_global generation:  0.04255843162536621
r_  generation:  0.39792323112487793
local_output_nid generation:  0.0221860408782959
local_in_edges_tensor generation:  0.028217554092407227
mini_batch_src_global generation:  0.04951214790344238
r_  generation:  0.4086308479309082
local_output_nid generation:  0.02221202850341797
local_in_edges_tensor generation:  0.02545332908630371
mini_batch_src_global generation:  0.04970502853393555
r_  generation:  0.4163997173309326
local_output_nid generation:  0.022589683532714844
local_in_edges_tensor generation:  0.023230552673339844
mini_batch_src_global generation:  0.05028200149536133
r_  generation:  0.41518712043762207
----------------------check_connections_block total spend ----------------------------- 2.4038572311401367
generate_one_block  0.5258522033691406
generate_one_block  0.5217583179473877
generate_one_block  0.5413637161254883
generate_one_block  0.5233566761016846
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03945326805114746
gen group dst list time:  0.021550655364990234
time for parepare:  0.01931023597717285
local_output_nid generation:  0.02496647834777832
local_in_edges_tensor generation:  0.034393310546875
mini_batch_src_global generation:  0.047495126724243164
r_  generation:  0.4956238269805908
local_output_nid generation:  0.03303050994873047
local_in_edges_tensor generation:  0.03369855880737305
mini_batch_src_global generation:  0.05817389488220215
r_  generation:  0.508941650390625
local_output_nid generation:  0.03479409217834473
local_in_edges_tensor generation:  0.03343963623046875
mini_batch_src_global generation:  0.054700374603271484
r_  generation:  0.5123138427734375
local_output_nid generation:  0.03438758850097656
local_in_edges_tensor generation:  0.03513908386230469
mini_batch_src_global generation:  0.05513167381286621
r_  generation:  0.523245096206665
----------------------check_connections_block total spend ----------------------------- 2.9800448417663574
generate_one_block  0.6183192729949951
generate_one_block  0.619391918182373
generate_one_block  0.6245529651641846
generate_one_block  0.6268675327301025
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14405584335327148  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

connection checking time:  5.383902072906494
block generation total time  4.6014626026153564
average batch blocks generation time:  1.1503656506538391
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10863113403320312  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.107414722442627  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.1077117919921875  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.0994868278503418  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10846757888793945  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.0985369682312012  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.1089162826538086  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1074180603027344  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09093266725540161 |0.013144135475158691 |0.0036986470222473145 |9.489059448242188e-05 |0.0038010478019714355 |0.0029480457305908203 |
----------------------------------------------------------pseudo_mini_loss sum 1.8773878812789917
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  1681103
Number of first layer input nodes during this epoch:  657033
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14516210556030273  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022409677505493164
range selection method range initialization spend 0.011917591094970703
time for parepare:  0.017294645309448242
local_output_nid generation:  0.005274295806884766
local_in_edges_tensor generation:  0.0053746700286865234
mini_batch_src_global generation:  0.0072650909423828125
r_  generation:  0.08454728126525879
local_output_nid generation:  0.006333827972412109
local_in_edges_tensor generation:  0.0036580562591552734
mini_batch_src_global generation:  0.009199380874633789
r_  generation:  0.09094715118408203
local_output_nid generation:  0.006215810775756836
local_in_edges_tensor generation:  0.0039713382720947266
mini_batch_src_global generation:  0.006922483444213867
r_  generation:  0.09224295616149902
local_output_nid generation:  0.006466388702392578
local_in_edges_tensor generation:  0.003941059112548828
mini_batch_src_global generation:  0.010256052017211914
r_  generation:  0.0969228744506836
----------------------check_connections_block total spend ----------------------------- 0.5324227809906006
generate_one_block  0.10241436958312988
generate_one_block  0.10781645774841309
generate_one_block  0.10892033576965332
generate_one_block  0.10477828979492188
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03504753112792969
gen group dst list time:  0.011409759521484375
time for parepare:  0.020269393920898438
local_output_nid generation:  0.015891075134277344
local_in_edges_tensor generation:  0.03892064094543457
mini_batch_src_global generation:  0.04214787483215332
r_  generation:  0.39566755294799805
local_output_nid generation:  0.022533416748046875
local_in_edges_tensor generation:  0.031001806259155273
mini_batch_src_global generation:  0.04976987838745117
r_  generation:  0.409820556640625
local_output_nid generation:  0.022788047790527344
local_in_edges_tensor generation:  0.025669097900390625
mini_batch_src_global generation:  0.051718711853027344
r_  generation:  0.4163491725921631
local_output_nid generation:  0.023491382598876953
local_in_edges_tensor generation:  0.023920297622680664
mini_batch_src_global generation:  0.050765037536621094
r_  generation:  0.41739320755004883
----------------------check_connections_block total spend ----------------------------- 2.4226863384246826
generate_one_block  0.5249576568603516
generate_one_block  0.5304579734802246
generate_one_block  0.5515608787536621
generate_one_block  0.5236783027648926
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03862285614013672
gen group dst list time:  0.021837711334228516
time for parepare:  0.019447803497314453
local_output_nid generation:  0.02439403533935547
local_in_edges_tensor generation:  0.03917407989501953
mini_batch_src_global generation:  0.047821998596191406
r_  generation:  0.502065896987915
local_output_nid generation:  0.03458070755004883
local_in_edges_tensor generation:  0.037451744079589844
mini_batch_src_global generation:  0.061750173568725586
r_  generation:  0.5063340663909912
local_output_nid generation:  0.03687262535095215
local_in_edges_tensor generation:  0.04680800437927246
mini_batch_src_global generation:  0.058045387268066406
r_  generation:  0.5294144153594971
local_output_nid generation:  0.03832554817199707
local_in_edges_tensor generation:  0.038958072662353516
mini_batch_src_global generation:  0.062012434005737305
r_  generation:  0.5164592266082764
----------------------check_connections_block total spend ----------------------------- 3.055544853210449
generate_one_block  0.6247787475585938
generate_one_block  0.6250061988830566
generate_one_block  0.6333925724029541
generate_one_block  0.6438250541687012
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14516210556030273  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

connection checking time:  5.478231191635132
block generation total time  4.6576573848724365
average batch blocks generation time:  1.1644143462181091
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10791826248168945  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.098254680633545  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10880851745605469  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.0989699363708496  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10865068435668945  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1043481826782227  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10779094696044922  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1063570976257324  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08834296464920044 |0.01837056875228882 |0.003643929958343506 |9.644031524658203e-05 |0.0037807822227478027 |0.0028946399688720703 |
----------------------------------------------------------pseudo_mini_loss sum 1.7981806993484497
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  1680708
Number of first layer input nodes during this epoch:  657077
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14429807662963867  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0267789363861084
range selection method range initialization spend 0.01212167739868164
time for parepare:  0.01737380027770996
local_output_nid generation:  0.005314826965332031
local_in_edges_tensor generation:  0.009648323059082031
mini_batch_src_global generation:  0.007622241973876953
r_  generation:  0.08192777633666992
local_output_nid generation:  0.006138324737548828
local_in_edges_tensor generation:  0.0030832290649414062
mini_batch_src_global generation:  0.00945425033569336
r_  generation:  0.0889272689819336
local_output_nid generation:  0.006234169006347656
local_in_edges_tensor generation:  0.0031266212463378906
mini_batch_src_global generation:  0.006991386413574219
r_  generation:  0.09391260147094727
local_output_nid generation:  0.006184816360473633
local_in_edges_tensor generation:  0.003204822540283203
mini_batch_src_global generation:  0.007597923278808594
r_  generation:  0.09391593933105469
----------------------check_connections_block total spend ----------------------------- 0.5243656635284424
generate_one_block  0.09839129447937012
generate_one_block  0.10280871391296387
generate_one_block  0.10333013534545898
generate_one_block  0.10295629501342773
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03948664665222168
gen group dst list time:  0.011367082595825195
time for parepare:  0.02023768424987793
local_output_nid generation:  0.014816522598266602
local_in_edges_tensor generation:  0.030679941177368164
mini_batch_src_global generation:  0.041852474212646484
r_  generation:  0.39360761642456055
local_output_nid generation:  0.025855064392089844
local_in_edges_tensor generation:  0.022098541259765625
mini_batch_src_global generation:  0.049590349197387695
r_  generation:  0.41374897956848145
local_output_nid generation:  0.024251222610473633
local_in_edges_tensor generation:  0.024241209030151367
mini_batch_src_global generation:  0.050063371658325195
r_  generation:  0.4150383472442627
local_output_nid generation:  0.024461984634399414
local_in_edges_tensor generation:  0.02709650993347168
mini_batch_src_global generation:  0.0503842830657959
r_  generation:  0.42122507095336914
----------------------check_connections_block total spend ----------------------------- 2.4061198234558105
generate_one_block  0.519749641418457
generate_one_block  0.5312774181365967
generate_one_block  0.5524096488952637
generate_one_block  0.5288341045379639
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.031179189682006836
gen group dst list time:  0.021674633026123047
time for parepare:  0.020943641662597656
local_output_nid generation:  0.025109052658081055
local_in_edges_tensor generation:  0.04604196548461914
mini_batch_src_global generation:  0.0509183406829834
r_  generation:  0.511077880859375
local_output_nid generation:  0.03906536102294922
local_in_edges_tensor generation:  0.0369873046875
mini_batch_src_global generation:  0.06237149238586426
r_  generation:  0.503154993057251
local_output_nid generation:  0.03827095031738281
local_in_edges_tensor generation:  0.03869009017944336
mini_batch_src_global generation:  0.05439400672912598
r_  generation:  0.5178956985473633
local_output_nid generation:  0.038546085357666016
local_in_edges_tensor generation:  0.03772735595703125
mini_batch_src_global generation:  0.054151058197021484
r_  generation:  0.5220983028411865
----------------------check_connections_block total spend ----------------------------- 3.0471107959747314
generate_one_block  0.6340792179107666
generate_one_block  0.6265933513641357
generate_one_block  0.6430716514587402
generate_one_block  0.6316313743591309
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14429807662963867  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

connection checking time:  5.453230619430542
block generation total time  4.667646408081055
average batch blocks generation time:  1.1669116020202637
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10834836959838867  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.0940141677856445  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.1086726188659668  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.103813648223877  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10787391662597656  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.0994434356689453  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10866832733154297  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.107208251953125  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0892866849899292 |0.016263186931610107 |0.0037009119987487793 |9.775161743164062e-05 |0.0038475394248962402 |0.0015635490417480469 |
----------------------------------------------------------pseudo_mini_loss sum 1.6975582838058472
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  1679575
Number of first layer input nodes during this epoch:  656692
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14517831802368164  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021223783493041992
range selection method range initialization spend 0.011900663375854492
time for parepare:  0.017746925354003906
local_output_nid generation:  0.0054624080657958984
local_in_edges_tensor generation:  0.009351491928100586
mini_batch_src_global generation:  0.007387638092041016
r_  generation:  0.08080625534057617
local_output_nid generation:  0.0061457157135009766
local_in_edges_tensor generation:  0.0030345916748046875
mini_batch_src_global generation:  0.009365558624267578
r_  generation:  0.0875396728515625
local_output_nid generation:  0.00624847412109375
local_in_edges_tensor generation:  0.003043651580810547
mini_batch_src_global generation:  0.0068318843841552734
r_  generation:  0.09273386001586914
local_output_nid generation:  0.006602287292480469
local_in_edges_tensor generation:  0.0036444664001464844
mini_batch_src_global generation:  0.007872581481933594
r_  generation:  0.09205937385559082
----------------------check_connections_block total spend ----------------------------- 0.5246727466583252
generate_one_block  0.09968018531799316
generate_one_block  0.10464620590209961
generate_one_block  0.1034698486328125
generate_one_block  0.10572481155395508
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.035119056701660156
gen group dst list time:  0.011239290237426758
time for parepare:  0.020162343978881836
local_output_nid generation:  0.015315055847167969
local_in_edges_tensor generation:  0.030158281326293945
mini_batch_src_global generation:  0.04142570495605469
r_  generation:  0.3933417797088623
local_output_nid generation:  0.02227640151977539
local_in_edges_tensor generation:  0.027527570724487305
mini_batch_src_global generation:  0.049439430236816406
r_  generation:  0.4090237617492676
local_output_nid generation:  0.021866559982299805
local_in_edges_tensor generation:  0.022928714752197266
mini_batch_src_global generation:  0.04981732368469238
r_  generation:  0.41217613220214844
local_output_nid generation:  0.02279973030090332
local_in_edges_tensor generation:  0.023369789123535156
mini_batch_src_global generation:  0.05073976516723633
r_  generation:  0.4182605743408203
----------------------check_connections_block total spend ----------------------------- 2.391207218170166
generate_one_block  0.5166440010070801
generate_one_block  0.5213236808776855
generate_one_block  0.5502674579620361
generate_one_block  0.5274243354797363
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03173327445983887
gen group dst list time:  0.024559736251831055
time for parepare:  0.019369125366210938
local_output_nid generation:  0.02453446388244629
local_in_edges_tensor generation:  0.0417482852935791
mini_batch_src_global generation:  0.05295228958129883
r_  generation:  0.5031042098999023
local_output_nid generation:  0.03597664833068848
local_in_edges_tensor generation:  0.04052329063415527
mini_batch_src_global generation:  0.059142112731933594
r_  generation:  0.5032608509063721
local_output_nid generation:  0.03552103042602539
local_in_edges_tensor generation:  0.03795504570007324
mini_batch_src_global generation:  0.0546877384185791
r_  generation:  0.5099689960479736
local_output_nid generation:  0.035428524017333984
local_in_edges_tensor generation:  0.03311753273010254
mini_batch_src_global generation:  0.054491281509399414
r_  generation:  0.5112435817718506
----------------------check_connections_block total spend ----------------------------- 3.003659725189209
generate_one_block  0.6298532485961914
generate_one_block  0.6331515312194824
generate_one_block  0.6290037631988525
generate_one_block  0.6260380744934082
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14517831802368164  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

connection checking time:  5.394866943359375
block generation total time  4.633706092834473
average batch blocks generation time:  1.1584265232086182
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.1078958511352539  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.0986099243164062  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10857772827148438  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.0998120307922363  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10863256454467773  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.0997190475463867  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10773563385009766  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.103102207183838  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09309536218643188 |0.014545261859893799 |0.003710508346557617 |9.846687316894531e-05 |0.0038607120513916016 |0.001631021499633789 |
----------------------------------------------------------pseudo_mini_loss sum 1.6378865242004395
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  1680259
Number of first layer input nodes during this epoch:  656895
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14447307586669922  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01723933219909668
range selection method range initialization spend 0.012094736099243164
time for parepare:  0.017334938049316406
local_output_nid generation:  0.005410671234130859
local_in_edges_tensor generation:  0.007976531982421875
mini_batch_src_global generation:  0.0074310302734375
r_  generation:  0.08136582374572754
local_output_nid generation:  0.006036043167114258
local_in_edges_tensor generation:  0.002997159957885742
mini_batch_src_global generation:  0.00933074951171875
r_  generation:  0.0885622501373291
local_output_nid generation:  0.00616455078125
local_in_edges_tensor generation:  0.0031299591064453125
mini_batch_src_global generation:  0.007207393646240234
r_  generation:  0.09028387069702148
local_output_nid generation:  0.006112575531005859
local_in_edges_tensor generation:  0.0030274391174316406
mini_batch_src_global generation:  0.007439374923706055
r_  generation:  0.09409689903259277
----------------------check_connections_block total spend ----------------------------- 0.5182969570159912
generate_one_block  0.10090351104736328
generate_one_block  0.10236167907714844
generate_one_block  0.10330772399902344
generate_one_block  0.10357260704040527
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0268709659576416
gen group dst list time:  0.011249542236328125
time for parepare:  0.02006387710571289
local_output_nid generation:  0.015721797943115234
local_in_edges_tensor generation:  0.02970409393310547
mini_batch_src_global generation:  0.040246009826660156
r_  generation:  0.3993039131164551
local_output_nid generation:  0.022257566452026367
local_in_edges_tensor generation:  0.027637481689453125
mini_batch_src_global generation:  0.04961276054382324
r_  generation:  0.4098656177520752
local_output_nid generation:  0.022402048110961914
local_in_edges_tensor generation:  0.024142742156982422
mini_batch_src_global generation:  0.05100893974304199
r_  generation:  0.41478419303894043
local_output_nid generation:  0.022636890411376953
local_in_edges_tensor generation:  0.023545026779174805
mini_batch_src_global generation:  0.050156593322753906
r_  generation:  0.41639184951782227
----------------------check_connections_block total spend ----------------------------- 2.396535634994507
generate_one_block  0.5220413208007812
generate_one_block  0.5212678909301758
generate_one_block  0.5425341129302979
generate_one_block  0.528862714767456
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02258133888244629
gen group dst list time:  0.021952390670776367
time for parepare:  0.019654035568237305
local_output_nid generation:  0.025330543518066406
local_in_edges_tensor generation:  0.03594398498535156
mini_batch_src_global generation:  0.04814291000366211
r_  generation:  0.49494385719299316
local_output_nid generation:  0.03308606147766113
local_in_edges_tensor generation:  0.03562283515930176
mini_batch_src_global generation:  0.05840349197387695
r_  generation:  0.5023198127746582
local_output_nid generation:  0.03380632400512695
local_in_edges_tensor generation:  0.03174614906311035
mini_batch_src_global generation:  0.05360102653503418
r_  generation:  0.5120666027069092
local_output_nid generation:  0.03408956527709961
local_in_edges_tensor generation:  0.03121161460876465
mini_batch_src_global generation:  0.05766558647155762
r_  generation:  0.5123636722564697
----------------------check_connections_block total spend ----------------------------- 2.964777946472168
generate_one_block  0.6199877262115479
generate_one_block  0.6197569370269775
generate_one_block  0.618790864944458
generate_one_block  0.6216886043548584
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14447307586669922  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

connection checking time:  5.361313581466675
block generation total time  4.594930171966553
average batch blocks generation time:  1.1487325429916382
block dataloader generation time/epoch 11.666428089141846
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10871076583862305  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1034307479858398  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10887813568115234  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1072478294372559  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10799551010131836  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1000828742980957  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10884428024291992  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.0994181632995605  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08635950088500977 |0.013331413269042969 |0.003370523452758789 |8.869171142578125e-05 |0.003628969192504883 |0.0019903182983398438 |
----------------------------------------------------------pseudo_mini_loss sum 1.587558388710022
Total (block generation + training)time/epoch 12.185078620910645
Training time/epoch 0.5184295177459717
Training time without block to device /epoch 0.4651038646697998
Training time without total dataloading part /epoch 0.030343055725097656
load block tensor time/epoch 0.34543800354003906
block to device time/epoch 0.053325653076171875
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  1680853
Number of first layer input nodes during this epoch:  657215
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.144134521484375  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.015313863754272461
range selection method range initialization spend 0.01180124282836914
time for parepare:  0.017289161682128906
local_output_nid generation:  0.005294322967529297
local_in_edges_tensor generation:  0.005316495895385742
mini_batch_src_global generation:  0.007402181625366211
r_  generation:  0.08107852935791016
local_output_nid generation:  0.00609135627746582
local_in_edges_tensor generation:  0.0030803680419921875
mini_batch_src_global generation:  0.009493112564086914
r_  generation:  0.08622384071350098
local_output_nid generation:  0.006092548370361328
local_in_edges_tensor generation:  0.0031418800354003906
mini_batch_src_global generation:  0.006906986236572266
r_  generation:  0.0903329849243164
local_output_nid generation:  0.0062563419342041016
local_in_edges_tensor generation:  0.0030128955841064453
mini_batch_src_global generation:  0.007201433181762695
r_  generation:  0.09261822700500488
----------------------check_connections_block total spend ----------------------------- 0.5107355117797852
generate_one_block  0.10250496864318848
generate_one_block  0.10265779495239258
generate_one_block  0.10364603996276855
generate_one_block  0.10306715965270996
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.025026321411132812
gen group dst list time:  0.011226654052734375
time for parepare:  0.019820213317871094
local_output_nid generation:  0.015382051467895508
local_in_edges_tensor generation:  0.02446269989013672
mini_batch_src_global generation:  0.04029726982116699
r_  generation:  0.39951086044311523
local_output_nid generation:  0.022610187530517578
local_in_edges_tensor generation:  0.023514270782470703
mini_batch_src_global generation:  0.04930520057678223
r_  generation:  0.41437530517578125
local_output_nid generation:  0.022600650787353516
local_in_edges_tensor generation:  0.026033401489257812
mini_batch_src_global generation:  0.04970073699951172
r_  generation:  0.41658735275268555
local_output_nid generation:  0.02305912971496582
local_in_edges_tensor generation:  0.023449420928955078
mini_batch_src_global generation:  0.049957990646362305
r_  generation:  0.41623759269714355
----------------------check_connections_block total spend ----------------------------- 2.3954968452453613
generate_one_block  0.5249073505401611
generate_one_block  0.5192961692810059
generate_one_block  0.538139820098877
generate_one_block  0.5231814384460449
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.027650117874145508
gen group dst list time:  0.02239990234375
time for parepare:  0.020221948623657227
local_output_nid generation:  0.02480792999267578
local_in_edges_tensor generation:  0.03593039512634277
mini_batch_src_global generation:  0.0484929084777832
r_  generation:  0.48991942405700684
local_output_nid generation:  0.033091068267822266
local_in_edges_tensor generation:  0.03045201301574707
mini_batch_src_global generation:  0.05929970741271973
r_  generation:  0.5042102336883545
local_output_nid generation:  0.03401064872741699
local_in_edges_tensor generation:  0.03182673454284668
mini_batch_src_global generation:  0.055593013763427734
r_  generation:  0.5086877346038818
local_output_nid generation:  0.03475618362426758
local_in_edges_tensor generation:  0.0319364070892334
mini_batch_src_global generation:  0.0549311637878418
r_  generation:  0.5170097351074219
----------------------check_connections_block total spend ----------------------------- 2.960264205932617
generate_one_block  0.6347720623016357
generate_one_block  0.6216695308685303
generate_one_block  0.6296036243438721
generate_one_block  0.6358203887939453
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.144134521484375  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

connection checking time:  5.3557610511779785
block generation total time  4.627390384674072
average batch blocks generation time:  1.156847596168518
block dataloader generation time/epoch 11.659592509269714
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10856151580810547  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1042203903198242  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10765790939331055  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1018643379211426  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.1085977554321289  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1004939079284668  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10884714126586914  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.0990614891052246  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08947288990020752 |0.01648092269897461 |0.0035498738288879395 |8.618831634521484e-05 |0.0037969350814819336 |0.0013513565063476562 |
----------------------------------------------------------pseudo_mini_loss sum 1.5527050495147705
Total (block generation + training)time/epoch 12.188871383666992
Training time/epoch 0.5397803783416748
Training time without block to device /epoch 0.47385668754577637
Training time without total dataloading part /epoch 0.031083345413208008
load block tensor time/epoch 0.3578915596008301
block to device time/epoch 0.06592369079589844
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  1680362
Number of first layer input nodes during this epoch:  656898
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14410972595214844  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020456314086914062
range selection method range initialization spend 0.011846780776977539
time for parepare:  0.017024755477905273
local_output_nid generation:  0.005562782287597656
local_in_edges_tensor generation:  0.005360126495361328
mini_batch_src_global generation:  0.007437229156494141
r_  generation:  0.08160066604614258
local_output_nid generation:  0.005996227264404297
local_in_edges_tensor generation:  0.0030601024627685547
mini_batch_src_global generation:  0.009181022644042969
r_  generation:  0.08672451972961426
local_output_nid generation:  0.00615239143371582
local_in_edges_tensor generation:  0.0029878616333007812
mini_batch_src_global generation:  0.0067141056060791016
r_  generation:  0.0900428295135498
local_output_nid generation:  0.006090641021728516
local_in_edges_tensor generation:  0.003341197967529297
mini_batch_src_global generation:  0.007716655731201172
r_  generation:  0.09287214279174805
----------------------check_connections_block total spend ----------------------------- 0.5127406120300293
generate_one_block  0.10178947448730469
generate_one_block  0.10173153877258301
generate_one_block  0.10254931449890137
generate_one_block  0.10314607620239258
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.031966209411621094
gen group dst list time:  0.011124372482299805
time for parepare:  0.019884347915649414
local_output_nid generation:  0.015259504318237305
local_in_edges_tensor generation:  0.028433799743652344
mini_batch_src_global generation:  0.04726672172546387
r_  generation:  0.40682268142700195
local_output_nid generation:  0.02267003059387207
local_in_edges_tensor generation:  0.03206753730773926
mini_batch_src_global generation:  0.05117344856262207
r_  generation:  0.4119589328765869
local_output_nid generation:  0.022507429122924805
local_in_edges_tensor generation:  0.0244140625
mini_batch_src_global generation:  0.04947352409362793
r_  generation:  0.4134507179260254
local_output_nid generation:  0.022699356079101562
local_in_edges_tensor generation:  0.02453327178955078
mini_batch_src_global generation:  0.058483123779296875
r_  generation:  0.42172718048095703
----------------------check_connections_block total spend ----------------------------- 2.436290979385376
generate_one_block  0.5258538722991943
generate_one_block  0.525000810623169
generate_one_block  0.5453212261199951
generate_one_block  0.5184357166290283
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028609752655029297
gen group dst list time:  0.021802425384521484
time for parepare:  0.019194602966308594
local_output_nid generation:  0.024501562118530273
local_in_edges_tensor generation:  0.04636693000793457
mini_batch_src_global generation:  0.050568580627441406
r_  generation:  0.49369120597839355
local_output_nid generation:  0.03360748291015625
local_in_edges_tensor generation:  0.03153109550476074
mini_batch_src_global generation:  0.05878043174743652
r_  generation:  0.5047924518585205
local_output_nid generation:  0.034403324127197266
local_in_edges_tensor generation:  0.03366589546203613
mini_batch_src_global generation:  0.05625510215759277
r_  generation:  0.5098080635070801
local_output_nid generation:  0.03441619873046875
local_in_edges_tensor generation:  0.034667253494262695
mini_batch_src_global generation:  0.05380725860595703
r_  generation:  0.5202109813690186
----------------------check_connections_block total spend ----------------------------- 2.987229347229004
generate_one_block  0.6215415000915527
generate_one_block  0.6262946128845215
generate_one_block  0.6350059509277344
generate_one_block  0.6312839984893799
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14410972595214844  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

connection checking time:  5.42352032661438
block generation total time  4.628737688064575
average batch blocks generation time:  1.1571844220161438
block dataloader generation time/epoch 11.693315426508585
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10870599746704102  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1076583862304688  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10762166976928711  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.0989136695861816  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10842752456665039  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1065940856933594  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10887765884399414  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.0994477272033691  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08991807699203491 |0.013516426086425781 |0.0036714673042297363 |9.483098983764648e-05 |0.0037598013877868652 |0.0013170242309570312 |
----------------------------------------------------------pseudo_mini_loss sum 1.5166802406311035
Total (block generation + training)time/epoch 12.224010785420736
Training time/epoch 0.5332207679748535
Training time without block to device /epoch 0.4791550636291504
Training time without total dataloading part /epoch 0.03142142295837402
load block tensor time/epoch 0.35967230796813965
block to device time/epoch 0.054065704345703125
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  1681108
Number of first layer input nodes during this epoch:  656960
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14411163330078125  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021343708038330078
range selection method range initialization spend 0.011871576309204102
time for parepare:  0.017272233963012695
local_output_nid generation:  0.005292415618896484
local_in_edges_tensor generation:  0.005558967590332031
mini_batch_src_global generation:  0.007363796234130859
r_  generation:  0.08238029479980469
local_output_nid generation:  0.006027936935424805
local_in_edges_tensor generation:  0.003290891647338867
mini_batch_src_global generation:  0.009105205535888672
r_  generation:  0.0874185562133789
local_output_nid generation:  0.006095409393310547
local_in_edges_tensor generation:  0.003084421157836914
mini_batch_src_global generation:  0.008785009384155273
r_  generation:  0.09012341499328613
local_output_nid generation:  0.0061266422271728516
local_in_edges_tensor generation:  0.003020048141479492
mini_batch_src_global generation:  0.008465051651000977
r_  generation:  0.09275555610656738
----------------------check_connections_block total spend ----------------------------- 0.516547441482544
generate_one_block  0.10067081451416016
generate_one_block  0.10227537155151367
generate_one_block  0.10358834266662598
generate_one_block  0.10455536842346191
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.031656503677368164
gen group dst list time:  0.011047124862670898
time for parepare:  0.019959688186645508
local_output_nid generation:  0.014975547790527344
local_in_edges_tensor generation:  0.026465892791748047
mini_batch_src_global generation:  0.04044961929321289
r_  generation:  0.3905625343322754
local_output_nid generation:  0.02279043197631836
local_in_edges_tensor generation:  0.0250856876373291
mini_batch_src_global generation:  0.05433297157287598
r_  generation:  0.40692973136901855
local_output_nid generation:  0.02219414710998535
local_in_edges_tensor generation:  0.022821426391601562
mini_batch_src_global generation:  0.049707889556884766
r_  generation:  0.4116652011871338
local_output_nid generation:  0.022740602493286133
local_in_edges_tensor generation:  0.024963855743408203
mini_batch_src_global generation:  0.05015730857849121
r_  generation:  0.4158134460449219
----------------------check_connections_block total spend ----------------------------- 2.378469944000244
generate_one_block  0.5170633792877197
generate_one_block  0.5154118537902832
generate_one_block  0.5448856353759766
generate_one_block  0.5199916362762451
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.026686429977416992
gen group dst list time:  0.021781206130981445
time for parepare:  0.018965482711791992
local_output_nid generation:  0.024741411209106445
local_in_edges_tensor generation:  0.03415179252624512
mini_batch_src_global generation:  0.04945707321166992
r_  generation:  0.4945261478424072
local_output_nid generation:  0.0331568717956543
local_in_edges_tensor generation:  0.03313899040222168
mini_batch_src_global generation:  0.05825376510620117
r_  generation:  0.5073544979095459
local_output_nid generation:  0.03403639793395996
local_in_edges_tensor generation:  0.0343630313873291
mini_batch_src_global generation:  0.05630326271057129
r_  generation:  0.5213038921356201
local_output_nid generation:  0.0349268913269043
local_in_edges_tensor generation:  0.03760981559753418
mini_batch_src_global generation:  0.05540871620178223
r_  generation:  0.5185866355895996
----------------------check_connections_block total spend ----------------------------- 2.9921560287475586
generate_one_block  0.6339695453643799
generate_one_block  0.6242861747741699
generate_one_block  0.6235480308532715
generate_one_block  0.6363832950592041
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14411163330078125  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

connection checking time:  5.370625972747803
block generation total time  4.61553955078125
average batch blocks generation time:  1.1538848876953125
block dataloader generation time/epoch 11.69412910938263
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10863161087036133  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1081013679504395  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10861349105834961  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.0994982719421387  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10802507400512695  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1028614044189453  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10863208770751953  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1041197776794434  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09110128879547119 |0.015070736408233643 |0.0036028623580932617 |8.928775787353516e-05 |0.0037446022033691406 |0.0015919208526611328 |
----------------------------------------------------------pseudo_mini_loss sum 1.4814155101776123
Total (block generation + training)time/epoch 12.227587938308716
Training time/epoch 0.5415346622467041
Training time without block to device /epoch 0.48125171661376953
Training time without total dataloading part /epoch 0.03133893013000488
load block tensor time/epoch 0.36440515518188477
block to device time/epoch 0.06028294563293457
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  1681084
Number of first layer input nodes during this epoch:  657229
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14503049850463867  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020431041717529297
range selection method range initialization spend 0.011878013610839844
time for parepare:  0.017192840576171875
local_output_nid generation:  0.0056078433990478516
local_in_edges_tensor generation:  0.005767822265625
mini_batch_src_global generation:  0.007456779479980469
r_  generation:  0.08111095428466797
local_output_nid generation:  0.006217241287231445
local_in_edges_tensor generation:  0.003093719482421875
mini_batch_src_global generation:  0.009296894073486328
r_  generation:  0.08775091171264648
local_output_nid generation:  0.006241321563720703
local_in_edges_tensor generation:  0.003026247024536133
mini_batch_src_global generation:  0.007094383239746094
r_  generation:  0.09012722969055176
local_output_nid generation:  0.006226778030395508
local_in_edges_tensor generation:  0.0030443668365478516
mini_batch_src_global generation:  0.00734710693359375
r_  generation:  0.09327578544616699
----------------------check_connections_block total spend ----------------------------- 0.5142431259155273
generate_one_block  0.1016690731048584
generate_one_block  0.10462594032287598
generate_one_block  0.10503101348876953
generate_one_block  0.10327458381652832
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02831411361694336
gen group dst list time:  0.011078834533691406
time for parepare:  0.02005743980407715
local_output_nid generation:  0.015277624130249023
local_in_edges_tensor generation:  0.026383161544799805
mini_batch_src_global generation:  0.04035234451293945
r_  generation:  0.40037107467651367
local_output_nid generation:  0.022849321365356445
local_in_edges_tensor generation:  0.02200484275817871
mini_batch_src_global generation:  0.0494992733001709
r_  generation:  0.4190201759338379
local_output_nid generation:  0.022484302520751953
local_in_edges_tensor generation:  0.023438692092895508
mini_batch_src_global generation:  0.050476789474487305
r_  generation:  0.41621828079223633
local_output_nid generation:  0.022724390029907227
local_in_edges_tensor generation:  0.02242255210876465
mini_batch_src_global generation:  0.05056953430175781
r_  generation:  0.4177384376525879
----------------------check_connections_block total spend ----------------------------- 2.4009127616882324
generate_one_block  0.5238175392150879
generate_one_block  0.5258126258850098
generate_one_block  0.542048454284668
generate_one_block  0.5211000442504883
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.024927854537963867
gen group dst list time:  0.021840333938598633
time for parepare:  0.018956661224365234
local_output_nid generation:  0.025064706802368164
local_in_edges_tensor generation:  0.034935951232910156
mini_batch_src_global generation:  0.048198699951171875
r_  generation:  0.4998056888580322
local_output_nid generation:  0.033927202224731445
local_in_edges_tensor generation:  0.03378868103027344
mini_batch_src_global generation:  0.06029033660888672
r_  generation:  0.5065507888793945
local_output_nid generation:  0.03438568115234375
local_in_edges_tensor generation:  0.036527156829833984
mini_batch_src_global generation:  0.05434775352478027
r_  generation:  0.512962818145752
local_output_nid generation:  0.0355837345123291
local_in_edges_tensor generation:  0.03212618827819824
mini_batch_src_global generation:  0.054047346115112305
r_  generation:  0.5151650905609131
----------------------check_connections_block total spend ----------------------------- 2.980621576309204
generate_one_block  0.6332070827484131
generate_one_block  0.6246984004974365
generate_one_block  0.6287522315979004
generate_one_block  0.6373467445373535
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14503049850463867  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

connection checking time:  5.3815343379974365
block generation total time  4.636783123016357
average batch blocks generation time:  1.1591957807540894
block dataloader generation time/epoch 11.701088476181031
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.1086125373840332  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.0997562408447266  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.1086115837097168  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.107564926147461  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10798406600952148  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1001477241516113  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.1085958480834961  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1069316864013672  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09178870916366577 |0.018868982791900635 |0.003580331802368164 |8.58306884765625e-05 |0.0037963390350341797 |0.0012514591217041016 |
----------------------------------------------------------pseudo_mini_loss sum 1.4475208520889282
Total (block generation + training)time/epoch 12.240130949020386
Training time/epoch 0.5611572265625
Training time without block to device /epoch 0.48568129539489746
Training time without total dataloading part /epoch 0.031101465225219727
load block tensor time/epoch 0.3671548366546631
block to device time/epoch 0.07547593116760254
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  1681670
Number of first layer input nodes during this epoch:  657110
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.1451706886291504  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020290374755859375
range selection method range initialization spend 0.011974096298217773
time for parepare:  0.017090559005737305
local_output_nid generation:  0.0054531097412109375
local_in_edges_tensor generation:  0.005537986755371094
mini_batch_src_global generation:  0.007430553436279297
r_  generation:  0.0807499885559082
local_output_nid generation:  0.006236076354980469
local_in_edges_tensor generation:  0.0029973983764648438
mini_batch_src_global generation:  0.009307622909545898
r_  generation:  0.08680915832519531
local_output_nid generation:  0.006129026412963867
local_in_edges_tensor generation:  0.003069639205932617
mini_batch_src_global generation:  0.0070514678955078125
r_  generation:  0.09175920486450195
local_output_nid generation:  0.006159305572509766
local_in_edges_tensor generation:  0.0030395984649658203
mini_batch_src_global generation:  0.007526397705078125
r_  generation:  0.09389376640319824
----------------------check_connections_block total spend ----------------------------- 0.5140492916107178
generate_one_block  0.09991598129272461
generate_one_block  0.10140633583068848
generate_one_block  0.10420989990234375
generate_one_block  0.10410857200622559
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0353388786315918
gen group dst list time:  0.011104583740234375
time for parepare:  0.019867897033691406
local_output_nid generation:  0.015008687973022461
local_in_edges_tensor generation:  0.03230905532836914
mini_batch_src_global generation:  0.04215550422668457
r_  generation:  0.3980839252471924
local_output_nid generation:  0.022845745086669922
local_in_edges_tensor generation:  0.025943279266357422
mini_batch_src_global generation:  0.059188127517700195
r_  generation:  0.41228508949279785
local_output_nid generation:  0.02337336540222168
local_in_edges_tensor generation:  0.026643037796020508
mini_batch_src_global generation:  0.05253195762634277
r_  generation:  0.41600966453552246
local_output_nid generation:  0.023818492889404297
local_in_edges_tensor generation:  0.023936986923217773
mini_batch_src_global generation:  0.05089259147644043
r_  generation:  0.4174661636352539
----------------------check_connections_block total spend ----------------------------- 2.4230737686157227
generate_one_block  0.5271275043487549
generate_one_block  0.5277953147888184
generate_one_block  0.5438084602355957
generate_one_block  0.5265676975250244
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02919912338256836
gen group dst list time:  0.02167987823486328
time for parepare:  0.018977880477905273
local_output_nid generation:  0.02472686767578125
local_in_edges_tensor generation:  0.0411837100982666
mini_batch_src_global generation:  0.05312824249267578
r_  generation:  0.4923686981201172
local_output_nid generation:  0.03351092338562012
local_in_edges_tensor generation:  0.03704690933227539
mini_batch_src_global generation:  0.05849599838256836
r_  generation:  0.5027472972869873
local_output_nid generation:  0.03362393379211426
local_in_edges_tensor generation:  0.03153204917907715
mini_batch_src_global generation:  0.05581808090209961
r_  generation:  0.5121603012084961
local_output_nid generation:  0.03419804573059082
local_in_edges_tensor generation:  0.03658771514892578
mini_batch_src_global generation:  0.056275367736816406
r_  generation:  0.5188965797424316
----------------------check_connections_block total spend ----------------------------- 2.9836924076080322
generate_one_block  0.6217441558837891
generate_one_block  0.6203305721282959
generate_one_block  0.6318404674530029
generate_one_block  0.6381502151489258
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.1451706886291504  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

connection checking time:  5.406766176223755
block generation total time  4.637364387512207
average batch blocks generation time:  1.1593410968780518
block dataloader generation time/epoch 11.709611654281616
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10798215866088867  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.0990281105041504  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10860061645507812  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.0981979370117188  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10859489440917969  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1037325859069824  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10781049728393555  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1063380241394043  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.089119553565979 |0.01327359676361084 |0.0036716461181640625 |9.167194366455078e-05 |0.0038085579872131348 |0.0014400482177734375 |
----------------------------------------------------------pseudo_mini_loss sum 1.4214184284210205
Total (block generation + training)time/epoch 12.24706502755483
Training time/epoch 0.5292379856109619
Training time without block to device /epoch 0.47614359855651855
Training time without total dataloading part /epoch 0.03172755241394043
load block tensor time/epoch 0.356478214263916
block to device time/epoch 0.05309438705444336
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  1680484
Number of first layer input nodes during this epoch:  657204
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14438772201538086  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01514744758605957
range selection method range initialization spend 0.011733293533325195
time for parepare:  0.016860008239746094
local_output_nid generation:  0.005377769470214844
local_in_edges_tensor generation:  0.00522160530090332
mini_batch_src_global generation:  0.007269859313964844
r_  generation:  0.08080840110778809
local_output_nid generation:  0.0060882568359375
local_in_edges_tensor generation:  0.00307464599609375
mini_batch_src_global generation:  0.009320259094238281
r_  generation:  0.08772850036621094
local_output_nid generation:  0.006154298782348633
local_in_edges_tensor generation:  0.0032176971435546875
mini_batch_src_global generation:  0.006939888000488281
r_  generation:  0.09046268463134766
local_output_nid generation:  0.006121635437011719
local_in_edges_tensor generation:  0.0031118392944335938
mini_batch_src_global generation:  0.007523775100708008
r_  generation:  0.09346890449523926
----------------------check_connections_block total spend ----------------------------- 0.512321949005127
generate_one_block  0.10047149658203125
generate_one_block  0.10372257232666016
generate_one_block  0.10209894180297852
generate_one_block  0.10482072830200195
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02594280242919922
gen group dst list time:  0.01110076904296875
time for parepare:  0.019803524017333984
local_output_nid generation:  0.014785051345825195
local_in_edges_tensor generation:  0.024914026260375977
mini_batch_src_global generation:  0.04034757614135742
r_  generation:  0.39577412605285645
local_output_nid generation:  0.022203683853149414
local_in_edges_tensor generation:  0.023723840713500977
mini_batch_src_global generation:  0.04962968826293945
r_  generation:  0.41402244567871094
local_output_nid generation:  0.021749258041381836
local_in_edges_tensor generation:  0.022801637649536133
mini_batch_src_global generation:  0.04944157600402832
r_  generation:  0.41312313079833984
local_output_nid generation:  0.022446393966674805
local_in_edges_tensor generation:  0.025201797485351562
mini_batch_src_global generation:  0.05040764808654785
r_  generation:  0.4193687438964844
----------------------check_connections_block total spend ----------------------------- 2.3889570236206055
generate_one_block  0.5175881385803223
generate_one_block  0.5220744609832764
generate_one_block  0.5385956764221191
generate_one_block  0.5245063304901123
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.023888587951660156
gen group dst list time:  0.021611928939819336
time for parepare:  0.019390106201171875
local_output_nid generation:  0.024433135986328125
local_in_edges_tensor generation:  0.03447675704956055
mini_batch_src_global generation:  0.04786825180053711
r_  generation:  0.4939911365509033
local_output_nid generation:  0.03299832344055176
local_in_edges_tensor generation:  0.031625986099243164
mini_batch_src_global generation:  0.05894732475280762
r_  generation:  0.5056581497192383
local_output_nid generation:  0.03401589393615723
local_in_edges_tensor generation:  0.033242225646972656
mini_batch_src_global generation:  0.0544435977935791
r_  generation:  0.5108871459960938
local_output_nid generation:  0.03455162048339844
local_in_edges_tensor generation:  0.03229022026062012
mini_batch_src_global generation:  0.054125308990478516
r_  generation:  0.5143711566925049
----------------------check_connections_block total spend ----------------------------- 2.9657318592071533
generate_one_block  0.6199750900268555
generate_one_block  0.6236577033996582
generate_one_block  0.62544846534729
generate_one_block  0.624091625213623
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14438772201538086  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

connection checking time:  5.354688882827759
block generation total time  4.595937490463257
average batch blocks generation time:  1.1489843726158142
block dataloader generation time/epoch 11.700010333742414
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10860490798950195  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.10203218460083  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.1089487075805664  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1006131172180176  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10790538787841797  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.0998210906982422  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10901975631713867  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1077957153320312  GigaBytes
Max Memory Allocated: 1.301196575164795  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09062021970748901 |0.013216853141784668 |0.003518521785736084 |8.922815322875977e-05 |0.0037622451782226562 |0.0026955604553222656 |
----------------------------------------------------------pseudo_mini_loss sum 1.38951575756073
Total (block generation + training)time/epoch 12.23723476273673
Training time/epoch 0.5356378555297852
Training time without block to device /epoch 0.4827704429626465
Training time without total dataloading part /epoch 0.032175540924072266
load block tensor time/epoch 0.36248087882995605
block to device time/epoch 0.05286741256713867
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  1681073
Number of first layer input nodes during this epoch:  657267
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14510726928710938  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.015496253967285156
range selection method range initialization spend 0.011759042739868164
time for parepare:  0.017184019088745117
local_output_nid generation:  0.005373239517211914
local_in_edges_tensor generation:  0.005305051803588867
mini_batch_src_global generation:  0.0073833465576171875
r_  generation:  0.0801236629486084
local_output_nid generation:  0.006074428558349609
local_in_edges_tensor generation:  0.003082752227783203
mini_batch_src_global generation:  0.009266138076782227
r_  generation:  0.08681344985961914
local_output_nid generation:  0.00607609748840332
local_in_edges_tensor generation:  0.002969026565551758
mini_batch_src_global generation:  0.006716489791870117
r_  generation:  0.08914470672607422
local_output_nid generation:  0.0061113834381103516
local_in_edges_tensor generation:  0.0030133724212646484
mini_batch_src_global generation:  0.007470846176147461
r_  generation:  0.09212803840637207
----------------------check_connections_block total spend ----------------------------- 0.5082595348358154
generate_one_block  0.1006627082824707
generate_one_block  0.10204672813415527
generate_one_block  0.1028296947479248
generate_one_block  0.10324645042419434
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.025578737258911133
gen group dst list time:  0.010961532592773438
time for parepare:  0.020125150680541992
local_output_nid generation:  0.014899253845214844
local_in_edges_tensor generation:  0.024458885192871094
mini_batch_src_global generation:  0.0400698184967041
r_  generation:  0.40424036979675293
local_output_nid generation:  0.022341012954711914
local_in_edges_tensor generation:  0.02205634117126465
mini_batch_src_global generation:  0.049365997314453125
r_  generation:  0.4090240001678467
local_output_nid generation:  0.0220339298248291
local_in_edges_tensor generation:  0.022073745727539062
mini_batch_src_global generation:  0.04924631118774414
r_  generation:  0.41267895698547363
local_output_nid generation:  0.022436857223510742
local_in_edges_tensor generation:  0.022511959075927734
mini_batch_src_global generation:  0.050170183181762695
r_  generation:  0.4169130325317383
----------------------check_connections_block total spend ----------------------------- 2.3842146396636963
generate_one_block  0.5171823501586914
generate_one_block  0.5189168453216553
generate_one_block  0.5417320728302002
generate_one_block  0.5192525386810303
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.022764921188354492
gen group dst list time:  0.021652936935424805
time for parepare:  0.019158601760864258
local_output_nid generation:  0.02455282211303711
local_in_edges_tensor generation:  0.0347900390625
mini_batch_src_global generation:  0.04879021644592285
r_  generation:  0.5022566318511963
local_output_nid generation:  0.03321695327758789
local_in_edges_tensor generation:  0.032572269439697266
mini_batch_src_global generation:  0.05884671211242676
r_  generation:  0.5099139213562012
local_output_nid generation:  0.03409767150878906
local_in_edges_tensor generation:  0.03177523612976074
mini_batch_src_global generation:  0.05440807342529297
r_  generation:  0.5152947902679443
local_output_nid generation:  0.0343632698059082
local_in_edges_tensor generation:  0.032001495361328125
mini_batch_src_global generation:  0.05402231216430664
r_  generation:  0.5144612789154053
----------------------check_connections_block total spend ----------------------------- 2.9804039001464844
generate_one_block  0.6226222515106201
generate_one_block  0.6254613399505615
generate_one_block  0.6272568702697754
generate_one_block  0.6356744766235352
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14510726928710938  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

connection checking time:  5.364618539810181
block generation total time  4.608098745346069
average batch blocks generation time:  1.1520246863365173
block dataloader generation time/epoch 11.690476953983307
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10791730880737305  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.0996966361999512  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10881423950195312  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1036438941955566  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.1079411506652832  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.100660800933838  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10888147354125977  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1005206108093262  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08587509393692017 |0.014552772045135498 |0.003453850746154785 |8.791685104370117e-05 |0.003407895565032959 |0.0017824172973632812 |
----------------------------------------------------------pseudo_mini_loss sum 1.3660686016082764
Total (block generation + training)time/epoch 12.225437551736832
Training time/epoch 0.5189018249511719
Training time without block to device /epoch 0.4606907367706299
Training time without total dataloading part /epoch 0.029581069946289062
load block tensor time/epoch 0.34350037574768066
block to device time/epoch 0.05821108818054199
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  1680072
Number of first layer input nodes during this epoch:  656892
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.1455092430114746  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.016563892364501953
range selection method range initialization spend 0.011937379837036133
time for parepare:  0.01763153076171875
local_output_nid generation:  0.005420684814453125
local_in_edges_tensor generation:  0.005602836608886719
mini_batch_src_global generation:  0.007288217544555664
r_  generation:  0.08116412162780762
local_output_nid generation:  0.0058939456939697266
local_in_edges_tensor generation:  0.003013134002685547
mini_batch_src_global generation:  0.008936405181884766
r_  generation:  0.08809685707092285
local_output_nid generation:  0.005993843078613281
local_in_edges_tensor generation:  0.003353595733642578
mini_batch_src_global generation:  0.007566928863525391
r_  generation:  0.09198594093322754
local_output_nid generation:  0.00609135627746582
local_in_edges_tensor generation:  0.0036678314208984375
mini_batch_src_global generation:  0.0073947906494140625
r_  generation:  0.09257245063781738
----------------------check_connections_block total spend ----------------------------- 0.5167453289031982
generate_one_block  0.10017251968383789
generate_one_block  0.10234618186950684
generate_one_block  0.10430335998535156
generate_one_block  0.10411834716796875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028118133544921875
gen group dst list time:  0.011181831359863281
time for parepare:  0.020074129104614258
local_output_nid generation:  0.015775203704833984
local_in_edges_tensor generation:  0.027820348739624023
mini_batch_src_global generation:  0.039951324462890625
r_  generation:  0.3939049243927002
local_output_nid generation:  0.023380756378173828
local_in_edges_tensor generation:  0.024259328842163086
mini_batch_src_global generation:  0.05095410346984863
r_  generation:  0.40837979316711426
local_output_nid generation:  0.02273416519165039
local_in_edges_tensor generation:  0.02777576446533203
mini_batch_src_global generation:  0.051088571548461914
r_  generation:  0.4341897964477539
local_output_nid generation:  0.025434255599975586
local_in_edges_tensor generation:  0.029624223709106445
mini_batch_src_global generation:  0.05294442176818848
r_  generation:  0.414686918258667
----------------------check_connections_block total spend ----------------------------- 2.4232330322265625
generate_one_block  0.5262224674224854
generate_one_block  0.5259239673614502
generate_one_block  0.5509986877441406
generate_one_block  0.5314733982086182
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030625581741333008
gen group dst list time:  0.023437976837158203
time for parepare:  0.019562244415283203
local_output_nid generation:  0.025322437286376953
local_in_edges_tensor generation:  0.045011043548583984
mini_batch_src_global generation:  0.05837583541870117
r_  generation:  0.49560046195983887
local_output_nid generation:  0.034172773361206055
local_in_edges_tensor generation:  0.03793621063232422
mini_batch_src_global generation:  0.05869746208190918
r_  generation:  0.5069911479949951
local_output_nid generation:  0.034574031829833984
local_in_edges_tensor generation:  0.033890724182128906
mini_batch_src_global generation:  0.05790281295776367
r_  generation:  0.515108585357666
local_output_nid generation:  0.0348818302154541
local_in_edges_tensor generation:  0.03220415115356445
mini_batch_src_global generation:  0.05449342727661133
r_  generation:  0.5151338577270508
----------------------check_connections_block total spend ----------------------------- 3.003974676132202
generate_one_block  0.6250085830688477
generate_one_block  0.6327109336853027
generate_one_block  0.6284618377685547
generate_one_block  0.6330246925354004
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.1455092430114746  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

connection checking time:  5.427207708358765
block generation total time  4.6538245677948
average batch blocks generation time:  1.1634561419487
block dataloader generation time/epoch 11.699021789762709
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.1079568862915039  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.099740982055664  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10892963409423828  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1074419021606445  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10795974731445312  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.0997695922851562  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10886669158935547  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1000933647155762  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09123575687408447 |0.01371544599533081 |0.00368344783782959 |9.429454803466797e-05 |0.0038384199142456055 |0.0028939247131347656 |
----------------------------------------------------------pseudo_mini_loss sum 1.3488671779632568
Total (block generation + training)time/epoch 12.234251075320774
Training time/epoch 0.5371019840240479
Training time without block to device /epoch 0.4822402000427246
Training time without total dataloading part /epoch 0.03335857391357422
load block tensor time/epoch 0.3649430274963379
block to device time/epoch 0.05486178398132324
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  1680447
Number of first layer input nodes during this epoch:  657270
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14555644989013672  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019118070602416992
range selection method range initialization spend 0.012115001678466797
time for parepare:  0.017083168029785156
local_output_nid generation:  0.00529789924621582
local_in_edges_tensor generation:  0.005625009536743164
mini_batch_src_global generation:  0.007213115692138672
r_  generation:  0.08019280433654785
local_output_nid generation:  0.005980014801025391
local_in_edges_tensor generation:  0.0030875205993652344
mini_batch_src_global generation:  0.011269330978393555
r_  generation:  0.08855104446411133
local_output_nid generation:  0.006147861480712891
local_in_edges_tensor generation:  0.0031671524047851562
mini_batch_src_global generation:  0.006913185119628906
r_  generation:  0.09071826934814453
local_output_nid generation:  0.006150722503662109
local_in_edges_tensor generation:  0.0030918121337890625
mini_batch_src_global generation:  0.00748133659362793
r_  generation:  0.09328985214233398
----------------------check_connections_block total spend ----------------------------- 0.5145778656005859
generate_one_block  0.10173535346984863
generate_one_block  0.10285258293151855
generate_one_block  0.10512971878051758
generate_one_block  0.10395574569702148
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029771804809570312
gen group dst list time:  0.011044025421142578
time for parepare:  0.019662141799926758
local_output_nid generation:  0.015482187271118164
local_in_edges_tensor generation:  0.028567790985107422
mini_batch_src_global generation:  0.041722774505615234
r_  generation:  0.39628100395202637
local_output_nid generation:  0.02299642562866211
local_in_edges_tensor generation:  0.024962663650512695
mini_batch_src_global generation:  0.04908013343811035
r_  generation:  0.4078085422515869
local_output_nid generation:  0.022543907165527344
local_in_edges_tensor generation:  0.024724483489990234
mini_batch_src_global generation:  0.04968094825744629
r_  generation:  0.4170713424682617
local_output_nid generation:  0.02316570281982422
local_in_edges_tensor generation:  0.02316141128540039
mini_batch_src_global generation:  0.05301809310913086
r_  generation:  0.42111754417419434
----------------------check_connections_block total spend ----------------------------- 2.401649236679077
generate_one_block  0.5257444381713867
generate_one_block  0.5292229652404785
generate_one_block  0.5518801212310791
generate_one_block  0.5343163013458252
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02680802345275879
gen group dst list time:  0.02204442024230957
time for parepare:  0.01949167251586914
local_output_nid generation:  0.02494049072265625
local_in_edges_tensor generation:  0.03667044639587402
mini_batch_src_global generation:  0.04807305335998535
r_  generation:  0.4923670291900635
local_output_nid generation:  0.03316211700439453
local_in_edges_tensor generation:  0.035101890563964844
mini_batch_src_global generation:  0.05816006660461426
r_  generation:  0.5012083053588867
local_output_nid generation:  0.03404355049133301
local_in_edges_tensor generation:  0.0347437858581543
mini_batch_src_global generation:  0.05418848991394043
r_  generation:  0.5147814750671387
local_output_nid generation:  0.03388476371765137
local_in_edges_tensor generation:  0.03162574768066406
mini_batch_src_global generation:  0.05758333206176758
r_  generation:  0.5144743919372559
----------------------check_connections_block total spend ----------------------------- 2.972743272781372
generate_one_block  0.6248681545257568
generate_one_block  0.6241505146026611
generate_one_block  0.6339678764343262
generate_one_block  0.6258456707000732
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14555644989013672  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

connection checking time:  5.374392509460449
block generation total time  4.649996042251587
average batch blocks generation time:  1.1624990105628967
block dataloader generation time/epoch 11.703881311416627
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10796022415161133  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1041393280029297  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10882234573364258  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1063923835754395  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10862445831298828  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1074128150939941  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10765695571899414  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.0983147621154785  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08396559953689575 |0.018000662326812744 |0.0034698843955993652 |9.036064147949219e-05 |0.003641843795776367 |0.0023047924041748047 |
----------------------------------------------------------pseudo_mini_loss sum 1.3404734134674072
Total (block generation + training)time/epoch 12.237650728225708
Training time/epoch 0.5204997062683105
Training time without block to device /epoch 0.44849705696105957
Training time without total dataloading part /epoch 0.031113147735595703
load block tensor time/epoch 0.335862398147583
block to device time/epoch 0.07200264930725098
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  1681316
Number of first layer input nodes during this epoch:  656984
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14420604705810547  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018320322036743164
range selection method range initialization spend 0.011735677719116211
time for parepare:  0.017701387405395508
local_output_nid generation:  0.005448102951049805
local_in_edges_tensor generation:  0.005234241485595703
mini_batch_src_global generation:  0.007202625274658203
r_  generation:  0.08033537864685059
local_output_nid generation:  0.006070613861083984
local_in_edges_tensor generation:  0.003090381622314453
mini_batch_src_global generation:  0.009264469146728516
r_  generation:  0.08839750289916992
local_output_nid generation:  0.006125926971435547
local_in_edges_tensor generation:  0.003109455108642578
mini_batch_src_global generation:  0.007018327713012695
r_  generation:  0.09227800369262695
local_output_nid generation:  0.006294965744018555
local_in_edges_tensor generation:  0.00307464599609375
mini_batch_src_global generation:  0.007843255996704102
r_  generation:  0.09443998336791992
----------------------check_connections_block total spend ----------------------------- 0.5180549621582031
generate_one_block  0.09987115859985352
generate_one_block  0.10779738426208496
generate_one_block  0.10392618179321289
generate_one_block  0.10497593879699707
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03145146369934082
gen group dst list time:  0.011113643646240234
time for parepare:  0.019850730895996094
local_output_nid generation:  0.015363216400146484
local_in_edges_tensor generation:  0.03018474578857422
mini_batch_src_global generation:  0.041474103927612305
r_  generation:  0.39720988273620605
local_output_nid generation:  0.02271723747253418
local_in_edges_tensor generation:  0.025976181030273438
mini_batch_src_global generation:  0.0502169132232666
r_  generation:  0.41843080520629883
local_output_nid generation:  0.022733211517333984
local_in_edges_tensor generation:  0.024135828018188477
mini_batch_src_global generation:  0.049690961837768555
r_  generation:  0.4160599708557129
local_output_nid generation:  0.022889375686645508
local_in_edges_tensor generation:  0.025060653686523438
mini_batch_src_global generation:  0.0502934455871582
r_  generation:  0.44336771965026855
----------------------check_connections_block total spend ----------------------------- 2.436199426651001
generate_one_block  0.5256388187408447
generate_one_block  0.5329248905181885
generate_one_block  0.5459566116333008
generate_one_block  0.5255944728851318
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.031022310256958008
gen group dst list time:  0.021572113037109375
time for parepare:  0.019442319869995117
local_output_nid generation:  0.02521991729736328
local_in_edges_tensor generation:  0.0408627986907959
mini_batch_src_global generation:  0.048036813735961914
r_  generation:  0.49835634231567383
local_output_nid generation:  0.03462100028991699
local_in_edges_tensor generation:  0.037035226821899414
mini_batch_src_global generation:  0.05816078186035156
r_  generation:  0.5033631324768066
local_output_nid generation:  0.034559011459350586
local_in_edges_tensor generation:  0.031914472579956055
mini_batch_src_global generation:  0.05478262901306152
r_  generation:  0.5156612396240234
local_output_nid generation:  0.034716129302978516
local_in_edges_tensor generation:  0.03630995750427246
mini_batch_src_global generation:  0.0538783073425293
r_  generation:  0.5211498737335205
----------------------check_connections_block total spend ----------------------------- 2.9935176372528076
generate_one_block  0.6255872249603271
generate_one_block  0.629061222076416
generate_one_block  0.6318862438201904
generate_one_block  0.6318674087524414
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14420604705810547  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

connection checking time:  5.429717063903809
block generation total time  4.648516893386841
average batch blocks generation time:  1.1621292233467102
block dataloader generation time/epoch 11.712460322813554
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10845756530761719  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.095475196838379  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10861778259277344  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.103194236755371  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10793161392211914  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1061758995056152  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10859918594360352  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1035046577453613  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09088599681854248 |0.013248443603515625 |0.0036765336990356445 |9.28044319152832e-05 |0.0038143396377563477 |0.0014088153839111328 |
----------------------------------------------------------pseudo_mini_loss sum 1.324591875076294
Total (block generation + training)time/epoch 12.246473702517422
Training time/epoch 0.5361776351928711
Training time without block to device /epoch 0.4831838607788086
Training time without total dataloading part /epoch 0.031743526458740234
load block tensor time/epoch 0.3635439872741699
block to device time/epoch 0.0529937744140625
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 20 |
Number of nodes for computation during this epoch:  1679848
Number of first layer input nodes during this epoch:  656855
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14524555206298828  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019068241119384766
range selection method range initialization spend 0.01206660270690918
time for parepare:  0.017193078994750977
local_output_nid generation:  0.0053920745849609375
local_in_edges_tensor generation:  0.005541324615478516
mini_batch_src_global generation:  0.007323265075683594
r_  generation:  0.08144187927246094
local_output_nid generation:  0.006093502044677734
local_in_edges_tensor generation:  0.0030684471130371094
mini_batch_src_global generation:  0.009416580200195312
r_  generation:  0.08774137496948242
local_output_nid generation:  0.006117343902587891
local_in_edges_tensor generation:  0.0036063194274902344
mini_batch_src_global generation:  0.0070917606353759766
r_  generation:  0.09012937545776367
local_output_nid generation:  0.006108522415161133
local_in_edges_tensor generation:  0.003144979476928711
mini_batch_src_global generation:  0.007393836975097656
r_  generation:  0.09332776069641113
----------------------check_connections_block total spend ----------------------------- 0.5144991874694824
generate_one_block  0.10383057594299316
generate_one_block  0.10255956649780273
generate_one_block  0.10344552993774414
generate_one_block  0.10322403907775879
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.031198740005493164
gen group dst list time:  0.010988712310791016
time for parepare:  0.020006895065307617
local_output_nid generation:  0.015551090240478516
local_in_edges_tensor generation:  0.024204730987548828
mini_batch_src_global generation:  0.04071831703186035
r_  generation:  0.4003458023071289
local_output_nid generation:  0.023044824600219727
local_in_edges_tensor generation:  0.022907495498657227
mini_batch_src_global generation:  0.04941749572753906
r_  generation:  0.4099860191345215
local_output_nid generation:  0.02272510528564453
local_in_edges_tensor generation:  0.023893117904663086
mini_batch_src_global generation:  0.05216264724731445
r_  generation:  0.418473482131958
local_output_nid generation:  0.023015499114990234
local_in_edges_tensor generation:  0.022943496704101562
mini_batch_src_global generation:  0.05254626274108887
r_  generation:  0.42047619819641113
----------------------check_connections_block total spend ----------------------------- 2.4054348468780518
generate_one_block  0.5267553329467773
generate_one_block  0.5196454524993896
generate_one_block  0.5472683906555176
generate_one_block  0.5218219757080078
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025580406188964844
gen group dst list time:  0.02177715301513672
time for parepare:  0.0192110538482666
local_output_nid generation:  0.0250241756439209
local_in_edges_tensor generation:  0.03525066375732422
mini_batch_src_global generation:  0.049109697341918945
r_  generation:  0.5002264976501465
local_output_nid generation:  0.033165693283081055
local_in_edges_tensor generation:  0.03443408012390137
mini_batch_src_global generation:  0.058724403381347656
r_  generation:  0.5057754516601562
local_output_nid generation:  0.03399014472961426
local_in_edges_tensor generation:  0.03165912628173828
mini_batch_src_global generation:  0.05450940132141113
r_  generation:  0.5157041549682617
local_output_nid generation:  0.03437066078186035
local_in_edges_tensor generation:  0.03148818016052246
mini_batch_src_global generation:  0.05449390411376953
r_  generation:  0.5201766490936279
----------------------check_connections_block total spend ----------------------------- 2.9799892902374268
generate_one_block  0.6251969337463379
generate_one_block  0.6264829635620117
generate_one_block  0.6342475414276123
generate_one_block  0.6432628631591797
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14524555206298828  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

connection checking time:  5.3854241371154785
block generation total time  4.644681453704834
average batch blocks generation time:  1.1611703634262085
block dataloader generation time/epoch 11.714858611424765
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10796833038330078  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.103271484375  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.1085958480834961  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.0999946594238281  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10860633850097656  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.0994234085083008  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10778570175170898  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1063365936279297  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08558517694473267 |0.01289600133895874 |0.0035022497177124023 |9.03010368347168e-05 |0.003155946731567383 |0.0029125213623046875 |
----------------------------------------------------------pseudo_mini_loss sum 1.3038991689682007
Total (block generation + training)time/epoch 12.247028748194376
Training time/epoch 0.5116820335388184
Training time without block to device /epoch 0.4600980281829834
Training time without total dataloading part /epoch 0.029906511306762695
load block tensor time/epoch 0.34234070777893066
block to device time/epoch 0.05158400535583496
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 21 |
Number of nodes for computation during this epoch:  1680972
Number of first layer input nodes during this epoch:  657152
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14440298080444336  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.015290260314941406
range selection method range initialization spend 0.011808633804321289
time for parepare:  0.017125844955444336
local_output_nid generation:  0.00537562370300293
local_in_edges_tensor generation:  0.0057065486907958984
mini_batch_src_global generation:  0.0073680877685546875
r_  generation:  0.08045816421508789
local_output_nid generation:  0.005952358245849609
local_in_edges_tensor generation:  0.0030138492584228516
mini_batch_src_global generation:  0.009421348571777344
r_  generation:  0.08712482452392578
local_output_nid generation:  0.006052255630493164
local_in_edges_tensor generation:  0.0030527114868164062
mini_batch_src_global generation:  0.006833076477050781
r_  generation:  0.0903170108795166
local_output_nid generation:  0.0060122013092041016
local_in_edges_tensor generation:  0.003032207489013672
mini_batch_src_global generation:  0.007356166839599609
r_  generation:  0.09339594841003418
----------------------check_connections_block total spend ----------------------------- 0.511934757232666
generate_one_block  0.09950065612792969
generate_one_block  0.10218048095703125
generate_one_block  0.10212326049804688
generate_one_block  0.10288453102111816
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029999494552612305
gen group dst list time:  0.010908842086791992
time for parepare:  0.019945621490478516
local_output_nid generation:  0.01508021354675293
local_in_edges_tensor generation:  0.024353504180908203
mini_batch_src_global generation:  0.04058432579040527
r_  generation:  0.39815640449523926
local_output_nid generation:  0.022680282592773438
local_in_edges_tensor generation:  0.021765708923339844
mini_batch_src_global generation:  0.04955029487609863
r_  generation:  0.40883755683898926
local_output_nid generation:  0.022159814834594727
local_in_edges_tensor generation:  0.022087812423706055
mini_batch_src_global generation:  0.05002236366271973
r_  generation:  0.4113757610321045
local_output_nid generation:  0.02261948585510254
local_in_edges_tensor generation:  0.022974014282226562
mini_batch_src_global generation:  0.05032491683959961
r_  generation:  0.4161810874938965
----------------------check_connections_block total spend ----------------------------- 2.3772406578063965
generate_one_block  0.534477949142456
generate_one_block  0.5304105281829834
generate_one_block  0.5405380725860596
generate_one_block  0.5203111171722412
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02573394775390625
gen group dst list time:  0.0217740535736084
time for parepare:  0.019145965576171875
local_output_nid generation:  0.024322032928466797
local_in_edges_tensor generation:  0.03581523895263672
mini_batch_src_global generation:  0.048326730728149414
r_  generation:  0.4978184700012207
local_output_nid generation:  0.03360271453857422
local_in_edges_tensor generation:  0.031464338302612305
mini_batch_src_global generation:  0.05935335159301758
r_  generation:  0.5030999183654785
local_output_nid generation:  0.0342097282409668
local_in_edges_tensor generation:  0.0314333438873291
mini_batch_src_global generation:  0.0547490119934082
r_  generation:  0.5117130279541016
local_output_nid generation:  0.03452301025390625
local_in_edges_tensor generation:  0.03188157081604004
mini_batch_src_global generation:  0.05423784255981445
r_  generation:  0.5153651237487793
----------------------check_connections_block total spend ----------------------------- 2.9646341800689697
generate_one_block  0.6287422180175781
generate_one_block  0.6251239776611328
generate_one_block  0.6226534843444824
generate_one_block  0.6228444576263428
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14440298080444336  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

connection checking time:  5.341874837875366
block generation total time  4.625101804733276
average batch blocks generation time:  1.156275451183319
block dataloader generation time/epoch 11.708998111578135
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10877132415771484  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1038036346435547  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.1088113784790039  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1033592224121094  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10854959487915039  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.0984678268432617  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10861635208129883  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1035518646240234  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08910214900970459 |0.013771653175354004 |0.003566443920135498 |8.982419967651367e-05 |0.003701448440551758 |0.0028426647186279297 |
----------------------------------------------------------pseudo_mini_loss sum 1.291050910949707
Total (block generation + training)time/epoch 12.241006979575523
Training time/epoch 0.5299420356750488
Training time without block to device /epoch 0.4748554229736328
Training time without total dataloading part /epoch 0.03227353096008301
load block tensor time/epoch 0.35640859603881836
block to device time/epoch 0.055086612701416016
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 22 |
Number of nodes for computation during this epoch:  1680685
Number of first layer input nodes during this epoch:  657011
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14476394653320312  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.017932891845703125
range selection method range initialization spend 0.011932611465454102
time for parepare:  0.016897201538085938
local_output_nid generation:  0.0052487850189208984
local_in_edges_tensor generation:  0.005414247512817383
mini_batch_src_global generation:  0.007791280746459961
r_  generation:  0.08177375793457031
local_output_nid generation:  0.0060689449310302734
local_in_edges_tensor generation:  0.003059864044189453
mini_batch_src_global generation:  0.00949716567993164
r_  generation:  0.08710122108459473
local_output_nid generation:  0.00601959228515625
local_in_edges_tensor generation:  0.003064393997192383
mini_batch_src_global generation:  0.0068492889404296875
r_  generation:  0.0911109447479248
local_output_nid generation:  0.0060765743255615234
local_in_edges_tensor generation:  0.003056764602661133
mini_batch_src_global generation:  0.007430553436279297
r_  generation:  0.09296703338623047
----------------------check_connections_block total spend ----------------------------- 0.5135111808776855
generate_one_block  0.10119485855102539
generate_one_block  0.10202527046203613
generate_one_block  0.10307073593139648
generate_one_block  0.10210490226745605
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02902984619140625
gen group dst list time:  0.010996103286743164
time for parepare:  0.019927263259887695
local_output_nid generation:  0.015391111373901367
local_in_edges_tensor generation:  0.026993989944458008
mini_batch_src_global generation:  0.040949106216430664
r_  generation:  0.41045618057250977
local_output_nid generation:  0.026178359985351562
local_in_edges_tensor generation:  0.02669358253479004
mini_batch_src_global generation:  0.05137014389038086
r_  generation:  0.41085290908813477
local_output_nid generation:  0.023109912872314453
local_in_edges_tensor generation:  0.023194313049316406
mini_batch_src_global generation:  0.049967288970947266
r_  generation:  0.4172060489654541
local_output_nid generation:  0.02295994758605957
local_in_edges_tensor generation:  0.022806882858276367
mini_batch_src_global generation:  0.04989933967590332
r_  generation:  0.4126408100128174
----------------------check_connections_block total spend ----------------------------- 2.4091415405273438
generate_one_block  0.5243492126464844
generate_one_block  0.5220644474029541
generate_one_block  0.5421741008758545
generate_one_block  0.5193736553192139
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029363393783569336
gen group dst list time:  0.021735429763793945
time for parepare:  0.019701719284057617
local_output_nid generation:  0.025294780731201172
local_in_edges_tensor generation:  0.037014007568359375
mini_batch_src_global generation:  0.049881696701049805
r_  generation:  0.4976010322570801
local_output_nid generation:  0.03384208679199219
local_in_edges_tensor generation:  0.0320127010345459
mini_batch_src_global generation:  0.05872678756713867
r_  generation:  0.5057859420776367
local_output_nid generation:  0.034061431884765625
local_in_edges_tensor generation:  0.03173041343688965
mini_batch_src_global generation:  0.054825782775878906
r_  generation:  0.5120663642883301
local_output_nid generation:  0.03450918197631836
local_in_edges_tensor generation:  0.031763315200805664
mini_batch_src_global generation:  0.05439615249633789
r_  generation:  0.5220811367034912
----------------------check_connections_block total spend ----------------------------- 2.9781668186187744
generate_one_block  0.6324906349182129
generate_one_block  0.6355783939361572
generate_one_block  0.6233670711517334
generate_one_block  0.6214756965637207
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14476394653320312  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

connection checking time:  5.387308359146118
block generation total time  4.620873212814331
average batch blocks generation time:  1.1552183032035828
block dataloader generation time/epoch 11.708328570638384
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.1080927848815918  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1068034172058105  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10853385925292969  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.0990910530090332  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.1085805892944336  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.0986332893371582  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.1076359748840332  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.0985679626464844  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08927929401397705 |0.015168190002441406 |0.0035563111305236816 |8.815526962280273e-05 |0.003605961799621582 |0.001607656478881836 |
----------------------------------------------------------pseudo_mini_loss sum 1.2794543504714966
Total (block generation + training)time/epoch 12.240369728633336
Training time/epoch 0.5322878360748291
Training time without block to device /epoch 0.4716150760650635
Training time without total dataloading part /epoch 0.0306093692779541
load block tensor time/epoch 0.3571171760559082
block to device time/epoch 0.060672760009765625
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 23 |
Number of nodes for computation during this epoch:  1680113
Number of first layer input nodes during this epoch:  656985
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14436006546020508  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.017999887466430664
range selection method range initialization spend 0.011781454086303711
time for parepare:  0.01757359504699707
local_output_nid generation:  0.005449533462524414
local_in_edges_tensor generation:  0.0055158138275146484
mini_batch_src_global generation:  0.0073888301849365234
r_  generation:  0.08153367042541504
local_output_nid generation:  0.006293773651123047
local_in_edges_tensor generation:  0.002987384796142578
mini_batch_src_global generation:  0.009283304214477539
r_  generation:  0.08835768699645996
local_output_nid generation:  0.006482362747192383
local_in_edges_tensor generation:  0.003081798553466797
mini_batch_src_global generation:  0.00696253776550293
r_  generation:  0.0913839340209961
local_output_nid generation:  0.006338357925415039
local_in_edges_tensor generation:  0.0033397674560546875
mini_batch_src_global generation:  0.007399797439575195
r_  generation:  0.09344339370727539
----------------------check_connections_block total spend ----------------------------- 0.5171511173248291
generate_one_block  0.10001587867736816
generate_one_block  0.10348868370056152
generate_one_block  0.10304474830627441
generate_one_block  0.10323476791381836
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030027389526367188
gen group dst list time:  0.010911226272583008
time for parepare:  0.020434141159057617
local_output_nid generation:  0.015227317810058594
local_in_edges_tensor generation:  0.02696084976196289
mini_batch_src_global generation:  0.040935516357421875
r_  generation:  0.39885926246643066
local_output_nid generation:  0.024282217025756836
local_in_edges_tensor generation:  0.025699853897094727
mini_batch_src_global generation:  0.049756526947021484
r_  generation:  0.4154849052429199
local_output_nid generation:  0.024025440216064453
local_in_edges_tensor generation:  0.026949405670166016
mini_batch_src_global generation:  0.05216622352600098
r_  generation:  0.41616296768188477
local_output_nid generation:  0.024655818939208984
local_in_edges_tensor generation:  0.024202346801757812
mini_batch_src_global generation:  0.050533294677734375
r_  generation:  0.42075204849243164
----------------------check_connections_block total spend ----------------------------- 2.4177465438842773
generate_one_block  0.5215752124786377
generate_one_block  0.537433385848999
generate_one_block  0.5467751026153564
generate_one_block  0.5275604724884033
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028970956802368164
gen group dst list time:  0.02175140380859375
time for parepare:  0.019337177276611328
local_output_nid generation:  0.024199724197387695
local_in_edges_tensor generation:  0.04036998748779297
mini_batch_src_global generation:  0.04898262023925781
r_  generation:  0.4964025020599365
local_output_nid generation:  0.03264617919921875
local_in_edges_tensor generation:  0.03538656234741211
mini_batch_src_global generation:  0.05942726135253906
r_  generation:  0.5033998489379883
local_output_nid generation:  0.034853219985961914
local_in_edges_tensor generation:  0.03855299949645996
mini_batch_src_global generation:  0.05542612075805664
r_  generation:  0.5141115188598633
local_output_nid generation:  0.034105777740478516
local_in_edges_tensor generation:  0.03292703628540039
mini_batch_src_global generation:  0.05468344688415527
r_  generation:  0.5175702571868896
----------------------check_connections_block total spend ----------------------------- 2.990964651107788
generate_one_block  0.6258969306945801
generate_one_block  0.6269736289978027
generate_one_block  0.6312308311462402
generate_one_block  0.6318278312683105
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14436006546020508  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

connection checking time:  5.408711194992065
block generation total time  4.64927339553833
average batch blocks generation time:  1.1623183488845825
block dataloader generation time/epoch 11.711803754170736
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10875606536865234  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.0985736846923828  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.1088404655456543  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1064090728759766  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.1085820198059082  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1080613136291504  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10862493515014648  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1039648056030273  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09182852506637573 |0.013534307479858398 |0.0036357641220092773 |9.000301361083984e-05 |0.0037443041801452637 |0.0017213821411132812 |
----------------------------------------------------------pseudo_mini_loss sum 1.267421007156372
Total (block generation + training)time/epoch 12.24451068242391
Training time/epoch 0.5418481826782227
Training time without block to device /epoch 0.48771095275878906
Training time without total dataloading part /epoch 0.031601667404174805
load block tensor time/epoch 0.36731410026550293
block to device time/epoch 0.054137229919433594
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 24 |
Number of nodes for computation during this epoch:  1681106
Number of first layer input nodes during this epoch:  657002
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14521503448486328  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.015465736389160156
range selection method range initialization spend 0.012055158615112305
time for parepare:  0.017090559005737305
local_output_nid generation:  0.005547523498535156
local_in_edges_tensor generation:  0.00583648681640625
mini_batch_src_global generation:  0.007520914077758789
r_  generation:  0.08090519905090332
local_output_nid generation:  0.006006479263305664
local_in_edges_tensor generation:  0.0031735897064208984
mini_batch_src_global generation:  0.009343624114990234
r_  generation:  0.08787870407104492
local_output_nid generation:  0.006148576736450195
local_in_edges_tensor generation:  0.0031239986419677734
mini_batch_src_global generation:  0.006962299346923828
r_  generation:  0.08983707427978516
local_output_nid generation:  0.006141185760498047
local_in_edges_tensor generation:  0.003177165985107422
mini_batch_src_global generation:  0.0074350833892822266
r_  generation:  0.09332871437072754
----------------------check_connections_block total spend ----------------------------- 0.5145659446716309
generate_one_block  0.10480666160583496
generate_one_block  0.10171175003051758
generate_one_block  0.1195981502532959
generate_one_block  0.10309934616088867
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03171205520629883
gen group dst list time:  0.01086115837097168
time for parepare:  0.01975083351135254
local_output_nid generation:  0.015221595764160156
local_in_edges_tensor generation:  0.02541518211364746
mini_batch_src_global generation:  0.042787790298461914
r_  generation:  0.39868855476379395
local_output_nid generation:  0.022916078567504883
local_in_edges_tensor generation:  0.022598743438720703
mini_batch_src_global generation:  0.051772117614746094
r_  generation:  0.4127199649810791
local_output_nid generation:  0.022992849349975586
local_in_edges_tensor generation:  0.023773193359375
mini_batch_src_global generation:  0.050911664962768555
r_  generation:  0.4208691120147705
local_output_nid generation:  0.023087024688720703
local_in_edges_tensor generation:  0.0233304500579834
mini_batch_src_global generation:  0.05041980743408203
r_  generation:  0.4157981872558594
----------------------check_connections_block total spend ----------------------------- 2.4038279056549072
generate_one_block  0.5211350917816162
generate_one_block  0.5147802829742432
generate_one_block  0.5413708686828613
generate_one_block  0.5186333656311035
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0259549617767334
gen group dst list time:  0.021595239639282227
time for parepare:  0.01915264129638672
local_output_nid generation:  0.025152921676635742
local_in_edges_tensor generation:  0.03484177589416504
mini_batch_src_global generation:  0.050205230712890625
r_  generation:  0.49764108657836914
local_output_nid generation:  0.033890724182128906
local_in_edges_tensor generation:  0.031113624572753906
mini_batch_src_global generation:  0.059006690979003906
r_  generation:  0.506223201751709
local_output_nid generation:  0.03450345993041992
local_in_edges_tensor generation:  0.03209662437438965
mini_batch_src_global generation:  0.05652141571044922
r_  generation:  0.5100579261779785
local_output_nid generation:  0.0346066951751709
local_in_edges_tensor generation:  0.03178977966308594
mini_batch_src_global generation:  0.054945945739746094
r_  generation:  0.5178439617156982
----------------------check_connections_block total spend ----------------------------- 2.9760773181915283
generate_one_block  0.6234555244445801
generate_one_block  0.6304869651794434
generate_one_block  0.6361618041992188
generate_one_block  0.6225154399871826
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14521503448486328  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

connection checking time:  5.3799052238464355
block generation total time  4.608539342880249
average batch blocks generation time:  1.1521348357200623
block dataloader generation time/epoch 11.711549922823906
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10803747177124023  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1026592254638672  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10865592956542969  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.0986814498901367  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.1087026596069336  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.107527256011963  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10767841339111328  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.0985183715820312  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08699285984039307 |0.013019680976867676 |0.003588080406188965 |9.262561798095703e-05 |0.003682553768157959 |0.001485586166381836 |
----------------------------------------------------------pseudo_mini_loss sum 1.2539067268371582
Total (block generation + training)time/epoch 12.243500843644142
Training time/epoch 0.5203750133514404
Training time without block to device /epoch 0.4682962894439697
Training time without total dataloading part /epoch 0.03093862533569336
load block tensor time/epoch 0.34797143936157227
block to device time/epoch 0.0520787239074707
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 25 |
Number of nodes for computation during this epoch:  1680552
Number of first layer input nodes during this epoch:  657264
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14417648315429688  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.016741037368774414
range selection method range initialization spend 0.011740922927856445
time for parepare:  0.017652273178100586
local_output_nid generation:  0.0055768489837646484
local_in_edges_tensor generation:  0.0055272579193115234
mini_batch_src_global generation:  0.007420778274536133
r_  generation:  0.0810861587524414
local_output_nid generation:  0.0062580108642578125
local_in_edges_tensor generation:  0.0031414031982421875
mini_batch_src_global generation:  0.009152412414550781
r_  generation:  0.08853554725646973
local_output_nid generation:  0.006386995315551758
local_in_edges_tensor generation:  0.0030303001403808594
mini_batch_src_global generation:  0.007105350494384766
r_  generation:  0.09029173851013184
local_output_nid generation:  0.00632786750793457
local_in_edges_tensor generation:  0.003036975860595703
mini_batch_src_global generation:  0.007314920425415039
r_  generation:  0.09325885772705078
----------------------check_connections_block total spend ----------------------------- 0.5157155990600586
generate_one_block  0.1009531021118164
generate_one_block  0.10268568992614746
generate_one_block  0.1033327579498291
generate_one_block  0.10338020324707031
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02807927131652832
gen group dst list time:  0.010918855667114258
time for parepare:  0.0201873779296875
local_output_nid generation:  0.01565265655517578
local_in_edges_tensor generation:  0.025719404220581055
mini_batch_src_global generation:  0.04048299789428711
r_  generation:  0.3975181579589844
local_output_nid generation:  0.02232646942138672
local_in_edges_tensor generation:  0.021970748901367188
mini_batch_src_global generation:  0.04957294464111328
r_  generation:  0.41094970703125
local_output_nid generation:  0.02232217788696289
local_in_edges_tensor generation:  0.022497177124023438
mini_batch_src_global generation:  0.05043768882751465
r_  generation:  0.4176945686340332
local_output_nid generation:  0.022499561309814453
local_in_edges_tensor generation:  0.02318406105041504
mini_batch_src_global generation:  0.050112247467041016
r_  generation:  0.41819119453430176
----------------------check_connections_block total spend ----------------------------- 2.389425754547119
generate_one_block  0.519359827041626
generate_one_block  0.5189247131347656
generate_one_block  0.5448558330535889
generate_one_block  0.5223922729492188
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.026774168014526367
gen group dst list time:  0.022452354431152344
time for parepare:  0.019237518310546875
local_output_nid generation:  0.025447607040405273
local_in_edges_tensor generation:  0.034372568130493164
mini_batch_src_global generation:  0.04838395118713379
r_  generation:  0.4944019317626953
local_output_nid generation:  0.03298830986022949
local_in_edges_tensor generation:  0.030888080596923828
mini_batch_src_global generation:  0.05857276916503906
r_  generation:  0.503654956817627
local_output_nid generation:  0.03387022018432617
local_in_edges_tensor generation:  0.03145432472229004
mini_batch_src_global generation:  0.0543670654296875
r_  generation:  0.5175037384033203
local_output_nid generation:  0.03450632095336914
local_in_edges_tensor generation:  0.03228497505187988
mini_batch_src_global generation:  0.05488753318786621
r_  generation:  0.514897346496582
----------------------check_connections_block total spend ----------------------------- 2.9672887325286865
generate_one_block  0.6210305690765381
generate_one_block  0.6206576824188232
generate_one_block  0.6307997703552246
generate_one_block  0.6218485832214355
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14417648315429688  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

connection checking time:  5.356714487075806
block generation total time  4.599869251251221
average batch blocks generation time:  1.1499673128128052
block dataloader generation time/epoch 11.707384838777429
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10847806930541992  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.0995063781738281  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.1087350845336914  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.0971684455871582  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10873985290527344  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.10756254196167  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10767936706542969  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.0997381210327148  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08975875377655029 |0.013951241970062256 |0.0035361647605895996 |8.815526962280273e-05 |0.003721952438354492 |0.002716064453125 |
----------------------------------------------------------pseudo_mini_loss sum 1.2398043870925903
Total (block generation + training)time/epoch 12.239357162924374
Training time/epoch 0.5321023464202881
Training time without block to device /epoch 0.47629737854003906
Training time without total dataloading part /epoch 0.03210115432739258
load block tensor time/epoch 0.35903501510620117
block to device time/epoch 0.05580496788024902
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 26 |
Number of nodes for computation during this epoch:  1680185
Number of first layer input nodes during this epoch:  656984
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14420175552368164  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020582199096679688
range selection method range initialization spend 0.01210927963256836
time for parepare:  0.01694321632385254
local_output_nid generation:  0.005505084991455078
local_in_edges_tensor generation:  0.005593061447143555
mini_batch_src_global generation:  0.007247209548950195
r_  generation:  0.08104825019836426
local_output_nid generation:  0.006029605865478516
local_in_edges_tensor generation:  0.0031299591064453125
mini_batch_src_global generation:  0.00915670394897461
r_  generation:  0.08715558052062988
local_output_nid generation:  0.006006479263305664
local_in_edges_tensor generation:  0.0032711029052734375
mini_batch_src_global generation:  0.006988525390625
r_  generation:  0.0916142463684082
local_output_nid generation:  0.0061550140380859375
local_in_edges_tensor generation:  0.0033578872680664062
mini_batch_src_global generation:  0.007594108581542969
r_  generation:  0.09301090240478516
----------------------check_connections_block total spend ----------------------------- 0.5148940086364746
generate_one_block  0.1002054214477539
generate_one_block  0.102508544921875
generate_one_block  0.1032857894897461
generate_one_block  0.1046442985534668
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030727386474609375
gen group dst list time:  0.010896682739257812
time for parepare:  0.021562814712524414
local_output_nid generation:  0.015122413635253906
local_in_edges_tensor generation:  0.026652812957763672
mini_batch_src_global generation:  0.03999519348144531
r_  generation:  0.3922295570373535
local_output_nid generation:  0.022809743881225586
local_in_edges_tensor generation:  0.021767616271972656
mini_batch_src_global generation:  0.049474239349365234
r_  generation:  0.4099292755126953
local_output_nid generation:  0.022604942321777344
local_in_edges_tensor generation:  0.022423505783081055
mini_batch_src_global generation:  0.0498502254486084
r_  generation:  0.4112417697906494
local_output_nid generation:  0.02266693115234375
local_in_edges_tensor generation:  0.022993803024291992
mini_batch_src_global generation:  0.05056047439575195
r_  generation:  0.4161231517791748
----------------------check_connections_block total spend ----------------------------- 2.378333806991577
generate_one_block  0.5159132480621338
generate_one_block  0.5198004245758057
generate_one_block  0.5431556701660156
generate_one_block  0.5333716869354248
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030901193618774414
gen group dst list time:  0.02187204360961914
time for parepare:  0.02058100700378418
local_output_nid generation:  0.025371789932250977
local_in_edges_tensor generation:  0.03438997268676758
mini_batch_src_global generation:  0.048127174377441406
r_  generation:  0.4956479072570801
local_output_nid generation:  0.033358097076416016
local_in_edges_tensor generation:  0.031000137329101562
mini_batch_src_global generation:  0.058792829513549805
r_  generation:  0.5022850036621094
local_output_nid generation:  0.03441882133483887
local_in_edges_tensor generation:  0.03411102294921875
mini_batch_src_global generation:  0.05695152282714844
r_  generation:  0.5142619609832764
local_output_nid generation:  0.03455972671508789
local_in_edges_tensor generation:  0.0342257022857666
mini_batch_src_global generation:  0.057404518127441406
r_  generation:  0.5215208530426025
----------------------check_connections_block total spend ----------------------------- 2.9827940464019775
generate_one_block  0.6264669895172119
generate_one_block  0.6261780261993408
generate_one_block  0.6306774616241455
generate_one_block  0.6340422630310059
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14420175552368164  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

connection checking time:  5.361127853393555
block generation total time  4.629605770111084
average batch blocks generation time:  1.157401442527771
block dataloader generation time/epoch 11.706856158044603
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10846328735351562  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.098649024963379  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10890769958496094  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.103858470916748  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10798072814941406  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.103468418121338  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10885810852050781  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1072564125061035  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09114933013916016 |0.016321182250976562 |0.003534376621246338 |8.934736251831055e-05 |0.003726780414581299 |0.001397848129272461 |
----------------------------------------------------------pseudo_mini_loss sum 1.2304275035858154
Total (block generation + training)time/epoch 12.239593704541525
Training time/epoch 0.5455360412597656
Training time without block to device /epoch 0.4802513122558594
Training time without total dataloading part /epoch 0.03079986572265625
load block tensor time/epoch 0.3645973205566406
block to device time/epoch 0.06528472900390625
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 27 |
Number of nodes for computation during this epoch:  1680650
Number of first layer input nodes during this epoch:  656980
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14550447463989258  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018847227096557617
range selection method range initialization spend 0.011877059936523438
time for parepare:  0.01699352264404297
local_output_nid generation:  0.0056247711181640625
local_in_edges_tensor generation:  0.005639553070068359
mini_batch_src_global generation:  0.007268428802490234
r_  generation:  0.08183026313781738
local_output_nid generation:  0.0063054561614990234
local_in_edges_tensor generation:  0.0031447410583496094
mini_batch_src_global generation:  0.009310007095336914
r_  generation:  0.08776712417602539
local_output_nid generation:  0.006368398666381836
local_in_edges_tensor generation:  0.003094196319580078
mini_batch_src_global generation:  0.006984233856201172
r_  generation:  0.0914163589477539
local_output_nid generation:  0.006177425384521484
local_in_edges_tensor generation:  0.003132343292236328
mini_batch_src_global generation:  0.007452726364135742
r_  generation:  0.0919032096862793
----------------------check_connections_block total spend ----------------------------- 0.514840841293335
generate_one_block  0.09912562370300293
generate_one_block  0.10408520698547363
generate_one_block  0.10290384292602539
generate_one_block  0.10396146774291992
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030329465866088867
gen group dst list time:  0.010961771011352539
time for parepare:  0.0199129581451416
local_output_nid generation:  0.014705181121826172
local_in_edges_tensor generation:  0.032201528549194336
mini_batch_src_global generation:  0.04173684120178223
r_  generation:  0.39713549613952637
local_output_nid generation:  0.022142887115478516
local_in_edges_tensor generation:  0.023793935775756836
mini_batch_src_global generation:  0.057886600494384766
r_  generation:  0.4193077087402344
local_output_nid generation:  0.022923946380615234
local_in_edges_tensor generation:  0.025400400161743164
mini_batch_src_global generation:  0.049732208251953125
r_  generation:  0.4209311008453369
local_output_nid generation:  0.022974491119384766
local_in_edges_tensor generation:  0.023402929306030273
mini_batch_src_global generation:  0.05054759979248047
r_  generation:  0.4216499328613281
----------------------check_connections_block total spend ----------------------------- 2.4238598346710205
generate_one_block  0.5198802947998047
generate_one_block  0.5235295295715332
generate_one_block  0.5421643257141113
generate_one_block  0.5190062522888184
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02743840217590332
gen group dst list time:  0.021671295166015625
time for parepare:  0.018985509872436523
local_output_nid generation:  0.02483510971069336
local_in_edges_tensor generation:  0.03530311584472656
mini_batch_src_global generation:  0.048862457275390625
r_  generation:  0.4960520267486572
local_output_nid generation:  0.033078908920288086
local_in_edges_tensor generation:  0.0346829891204834
mini_batch_src_global generation:  0.05899477005004883
r_  generation:  0.5024197101593018
local_output_nid generation:  0.034079551696777344
local_in_edges_tensor generation:  0.03161120414733887
mini_batch_src_global generation:  0.05471014976501465
r_  generation:  0.5101447105407715
local_output_nid generation:  0.0340275764465332
local_in_edges_tensor generation:  0.03197336196899414
mini_batch_src_global generation:  0.0542759895324707
r_  generation:  0.5187251567840576
----------------------check_connections_block total spend ----------------------------- 2.967270851135254
generate_one_block  0.6314647197723389
generate_one_block  0.621199369430542
generate_one_block  0.6249654293060303
generate_one_block  0.6266481876373291
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14550447463989258  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

connection checking time:  5.391130685806274
block generation total time  4.608858108520508
average batch blocks generation time:  1.152214527130127
block dataloader generation time/epoch 11.706516090192293
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10785198211669922  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.0993633270263672  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10888338088989258  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1035737991333008  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10797691345214844  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.100083827972412  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10879325866699219  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1029820442199707  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09172892570495605 |0.01319742202758789 |0.0036574602127075195 |9.316205978393555e-05 |0.0038407444953918457 |0.0028007030487060547 |
----------------------------------------------------------pseudo_mini_loss sum 1.22279953956604
Total (block generation + training)time/epoch 12.2396401606108
Training time/epoch 0.5398027896881104
Training time without block to device /epoch 0.4870131015777588
Training time without total dataloading part /epoch 0.03316617012023926
load block tensor time/epoch 0.3669157028198242
block to device time/epoch 0.05278968811035156
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 28 |
Number of nodes for computation during this epoch:  1680004
Number of first layer input nodes during this epoch:  656814
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14407634735107422  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03375577926635742
range selection method range initialization spend 0.011834383010864258
time for parepare:  0.016859769821166992
local_output_nid generation:  0.005601406097412109
local_in_edges_tensor generation:  0.005433559417724609
mini_batch_src_global generation:  0.0073740482330322266
r_  generation:  0.0801229476928711
local_output_nid generation:  0.006094217300415039
local_in_edges_tensor generation:  0.0033690929412841797
mini_batch_src_global generation:  0.009147167205810547
r_  generation:  0.08726739883422852
local_output_nid generation:  0.00612950325012207
local_in_edges_tensor generation:  0.002986431121826172
mini_batch_src_global generation:  0.006797313690185547
r_  generation:  0.0919649600982666
local_output_nid generation:  0.006098270416259766
local_in_edges_tensor generation:  0.0030333995819091797
mini_batch_src_global generation:  0.007663249969482422
r_  generation:  0.09442877769470215
----------------------check_connections_block total spend ----------------------------- 0.515028715133667
generate_one_block  0.10105395317077637
generate_one_block  0.10165524482727051
generate_one_block  0.10329842567443848
generate_one_block  0.10340380668640137
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030168771743774414
gen group dst list time:  0.010913372039794922
time for parepare:  0.01998305320739746
local_output_nid generation:  0.015663623809814453
local_in_edges_tensor generation:  0.028201818466186523
mini_batch_src_global generation:  0.04053664207458496
r_  generation:  0.40044713020324707
local_output_nid generation:  0.0227203369140625
local_in_edges_tensor generation:  0.024529218673706055
mini_batch_src_global generation:  0.049724578857421875
r_  generation:  0.4055213928222656
local_output_nid generation:  0.022420406341552734
local_in_edges_tensor generation:  0.022266387939453125
mini_batch_src_global generation:  0.05002307891845703
r_  generation:  0.4151899814605713
local_output_nid generation:  0.02299332618713379
local_in_edges_tensor generation:  0.02322697639465332
mini_batch_src_global generation:  0.05098271369934082
r_  generation:  0.41632080078125
----------------------check_connections_block total spend ----------------------------- 2.38983416557312
generate_one_block  0.5244626998901367
generate_one_block  0.5145885944366455
generate_one_block  0.5388047695159912
generate_one_block  0.5194957256317139
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025532245635986328
gen group dst list time:  0.021808147430419922
time for parepare:  0.01890730857849121
local_output_nid generation:  0.0250856876373291
local_in_edges_tensor generation:  0.03429007530212402
mini_batch_src_global generation:  0.04831242561340332
r_  generation:  0.49071168899536133
local_output_nid generation:  0.03327822685241699
local_in_edges_tensor generation:  0.03171181678771973
mini_batch_src_global generation:  0.05905270576477051
r_  generation:  0.5008618831634521
local_output_nid generation:  0.03443622589111328
local_in_edges_tensor generation:  0.03323507308959961
mini_batch_src_global generation:  0.055647850036621094
r_  generation:  0.5129880905151367
local_output_nid generation:  0.03433585166931152
local_in_edges_tensor generation:  0.032427072525024414
mini_batch_src_global generation:  0.056060791015625
r_  generation:  0.52901291847229
----------------------check_connections_block total spend ----------------------------- 2.9769434928894043
generate_one_block  0.6306066513061523
generate_one_block  0.6193451881408691
generate_one_block  0.6269404888153076
generate_one_block  0.638871431350708
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.14407634735107422  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

connection checking time:  5.366777658462524
block generation total time  4.613115549087524
average batch blocks generation time:  1.153278887271881
block dataloader generation time/epoch 11.706111323833465
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10861730575561523  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1074223518371582  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10764074325561523  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.0974969863891602  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10850858688354492  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1035089492797852  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10890960693359375  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1071391105651855  GigaBytes
Max Memory Allocated: 1.3012175559997559  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09141939878463745 |0.015906333923339844 |0.0035867691040039062 |9.268522262573242e-05 |0.003820657730102539 |0.002767801284790039 |
----------------------------------------------------------pseudo_mini_loss sum 1.207616925239563
Total (block generation + training)time/epoch 12.240112924575806
Training time/epoch 0.5504608154296875
Training time without block to device /epoch 0.4868354797363281
Training time without total dataloading part /epoch 0.03276824951171875
load block tensor time/epoch 0.3656775951385498
block to device time/epoch 0.06362533569335938
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 29 |
Number of nodes for computation during this epoch:  1680908
Number of first layer input nodes during this epoch:  657065
