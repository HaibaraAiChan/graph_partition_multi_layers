Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1647775211.490495
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027302026748657227
range selection method range initialization spend 0.0139007568359375
time for parepare:  0.017960309982299805
local_output_nid generation:  0.0026772022247314453
local_in_edges_tensor generation:  0.004876852035522461
mini_batch_src_global generation:  0.003804445266723633
r_  generation:  0.04259324073791504
local_output_nid generation:  0.0030007362365722656
local_in_edges_tensor generation:  0.0016863346099853516
mini_batch_src_global generation:  0.0047571659088134766
r_  generation:  0.043405771255493164
local_output_nid generation:  0.003108978271484375
local_in_edges_tensor generation:  0.0017688274383544922
mini_batch_src_global generation:  0.0033299922943115234
r_  generation:  0.044588565826416016
local_output_nid generation:  0.003110170364379883
local_in_edges_tensor generation:  0.0017211437225341797
mini_batch_src_global generation:  0.0033392906188964844
r_  generation:  0.04565906524658203
local_output_nid generation:  0.0031273365020751953
local_in_edges_tensor generation:  0.0017313957214355469
mini_batch_src_global generation:  0.0035169124603271484
r_  generation:  0.046755313873291016
local_output_nid generation:  0.0031702518463134766
local_in_edges_tensor generation:  0.0016863346099853516
mini_batch_src_global generation:  0.0036802291870117188
r_  generation:  0.04750418663024902
local_output_nid generation:  0.003095865249633789
local_in_edges_tensor generation:  0.0017123222351074219
mini_batch_src_global generation:  0.0037941932678222656
r_  generation:  0.04700613021850586
local_output_nid generation:  0.0031321048736572266
local_in_edges_tensor generation:  0.0016875267028808594
mini_batch_src_global generation:  0.0038030147552490234
r_  generation:  0.04778456687927246
----------------------check_connections_block total spend ----------------------------- 0.5309245586395264
generate_one_block  0.061756134033203125
generate_one_block  0.06168532371520996
generate_one_block  0.06260275840759277
generate_one_block  0.06233096122741699
generate_one_block  0.06462621688842773
generate_one_block  0.0628969669342041
generate_one_block  0.06325721740722656
generate_one_block  0.06431055068969727
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04442238807678223
gen group dst list time:  0.01651763916015625
time for parepare:  0.020048856735229492
local_output_nid generation:  0.01162576675415039
local_in_edges_tensor generation:  0.034475088119506836
mini_batch_src_global generation:  0.03928089141845703
r_  generation:  0.3636453151702881
local_output_nid generation:  0.019842863082885742
local_in_edges_tensor generation:  0.03268170356750488
mini_batch_src_global generation:  0.04805254936218262
r_  generation:  0.36876440048217773
local_output_nid generation:  0.020851850509643555
local_in_edges_tensor generation:  0.02706742286682129
mini_batch_src_global generation:  0.0513460636138916
r_  generation:  0.3730635643005371
local_output_nid generation:  0.02148580551147461
local_in_edges_tensor generation:  0.030625104904174805
mini_batch_src_global generation:  0.0453493595123291
r_  generation:  0.3836691379547119
local_output_nid generation:  0.021363496780395508
local_in_edges_tensor generation:  0.020289182662963867
mini_batch_src_global generation:  0.04920315742492676
r_  generation:  0.37558460235595703
local_output_nid generation:  0.02179884910583496
local_in_edges_tensor generation:  0.0210878849029541
mini_batch_src_global generation:  0.05082249641418457
r_  generation:  0.38715124130249023
local_output_nid generation:  0.021933794021606445
local_in_edges_tensor generation:  0.02734827995300293
mini_batch_src_global generation:  0.049666404724121094
r_  generation:  0.382981538772583
local_output_nid generation:  0.022346019744873047
local_in_edges_tensor generation:  0.02141880989074707
mini_batch_src_global generation:  0.0557093620300293
r_  generation:  0.38970041275024414
----------------------check_connections_block total spend ----------------------------- 4.4664506912231445
generate_one_block  0.5180020332336426
generate_one_block  0.4978034496307373
generate_one_block  0.49709057807922363
generate_one_block  0.5646851062774658
generate_one_block  0.49201416969299316
generate_one_block  0.5584983825683594
generate_one_block  0.5423479080200195
generate_one_block  0.5070335865020752
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.10425209999084473
gen group dst list time:  0.04527544975280762
time for parepare:  0.018571138381958008
local_output_nid generation:  0.02668905258178711
local_in_edges_tensor generation:  0.0546877384185791
mini_batch_src_global generation:  0.0477755069732666
r_  generation:  0.49205684661865234
local_output_nid generation:  0.033303022384643555
local_in_edges_tensor generation:  0.047872304916381836
mini_batch_src_global generation:  0.05816388130187988
r_  generation:  0.4889090061187744
local_output_nid generation:  0.03416919708251953
local_in_edges_tensor generation:  0.055617570877075195
mini_batch_src_global generation:  0.055023193359375
r_  generation:  0.4932980537414551
local_output_nid generation:  0.03522753715515137
local_in_edges_tensor generation:  0.03889775276184082
mini_batch_src_global generation:  0.06708264350891113
r_  generation:  0.5079042911529541
local_output_nid generation:  0.03812360763549805
local_in_edges_tensor generation:  0.04489278793334961
mini_batch_src_global generation:  0.054990291595458984
r_  generation:  0.4914734363555908
local_output_nid generation:  0.03566122055053711
local_in_edges_tensor generation:  0.031622886657714844
mini_batch_src_global generation:  0.05415987968444824
r_  generation:  0.49758434295654297
local_output_nid generation:  0.03559517860412598
local_in_edges_tensor generation:  0.031740665435791016
mini_batch_src_global generation:  0.05730485916137695
r_  generation:  0.498091459274292
local_output_nid generation:  0.03582763671875
local_in_edges_tensor generation:  0.03399848937988281
mini_batch_src_global generation:  0.054639339447021484
r_  generation:  0.5065619945526123
----------------------check_connections_block total spend ----------------------------- 5.955153942108154
generate_one_block  0.6590123176574707
generate_one_block  0.6312296390533447
generate_one_block  0.6177074909210205
generate_one_block  0.6188595294952393
generate_one_block  0.6266493797302246
generate_one_block  0.6076869964599609
generate_one_block  0.6441879272460938
generate_one_block  0.6154065132141113
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  10.421604633331299
block generation total time  9.198215007781982
average batch blocks generation time:  1.1497768759727478
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.10041046142578125  GigaBytes
Max Memory Allocated: 0.10041046142578125  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4783935546875 GB
    Memory Allocated: 0.948448657989502  GigaBytes
Max Memory Allocated: 1.014519214630127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8514404296875 GB
    Memory Allocated: 0.10245847702026367  GigaBytes
Max Memory Allocated: 1.0890092849731445  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8514404296875 GB
    Memory Allocated: 0.949256420135498  GigaBytes
Max Memory Allocated: 1.0890092849731445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.1041259765625  GigaBytes
Max Memory Allocated: 1.0890092849731445  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.9517207145690918  GigaBytes
Max Memory Allocated: 1.0890092849731445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.10252189636230469  GigaBytes
Max Memory Allocated: 1.0927677154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.9491133689880371  GigaBytes
Max Memory Allocated: 1.0927677154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.10336875915527344  GigaBytes
Max Memory Allocated: 1.0927677154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.9495949745178223  GigaBytes
Max Memory Allocated: 1.0927677154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.10331106185913086  GigaBytes
Max Memory Allocated: 1.0927677154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.949181079864502  GigaBytes
Max Memory Allocated: 1.0927677154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.10220479965209961  GigaBytes
Max Memory Allocated: 1.0927677154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.9482026100158691  GigaBytes
Max Memory Allocated: 1.0927677154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.10395240783691406  GigaBytes
Max Memory Allocated: 1.0927677154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.9495439529418945  GigaBytes
Max Memory Allocated: 1.0927677154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07179024815559387 |0.055867940187454224 |0.10039567947387695 |0.0001125037670135498 |0.01286017894744873 |0.0038890838623046875 |
----------------------------------------------------------pseudo_mini_loss sum 6.225508213043213
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3054784
Number of first layer input nodes during this epoch:  1297654
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.1384291648864746  GigaBytes
Max Memory Allocated: 1.0927677154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02287149429321289
range selection method range initialization spend 0.011582612991333008
time for parepare:  0.01681375503540039
local_output_nid generation:  0.0026521682739257812
local_in_edges_tensor generation:  0.008576154708862305
mini_batch_src_global generation:  0.00385284423828125
r_  generation:  0.0442204475402832
local_output_nid generation:  0.003096342086791992
local_in_edges_tensor generation:  0.0018570423126220703
mini_batch_src_global generation:  0.004965543746948242
r_  generation:  0.0444340705871582
local_output_nid generation:  0.0030858516693115234
local_in_edges_tensor generation:  0.001725912094116211
mini_batch_src_global generation:  0.003361225128173828
r_  generation:  0.044548988342285156
local_output_nid generation:  0.0031371116638183594
local_in_edges_tensor generation:  0.0017724037170410156
mini_batch_src_global generation:  0.003510713577270508
r_  generation:  0.04532051086425781
local_output_nid generation:  0.0030922889709472656
local_in_edges_tensor generation:  0.0017397403717041016
mini_batch_src_global generation:  0.0036585330963134766
r_  generation:  0.047306060791015625
local_output_nid generation:  0.0031414031982421875
local_in_edges_tensor generation:  0.0018177032470703125
mini_batch_src_global generation:  0.0039823055267333984
r_  generation:  0.04847908020019531
local_output_nid generation:  0.003207683563232422
local_in_edges_tensor generation:  0.0017480850219726562
mini_batch_src_global generation:  0.004008293151855469
r_  generation:  0.049031972885131836
local_output_nid generation:  0.0031194686889648438
local_in_edges_tensor generation:  0.0017561912536621094
mini_batch_src_global generation:  0.0040035247802734375
r_  generation:  0.047521352767944336
----------------------check_connections_block total spend ----------------------------- 0.5526332855224609
generate_one_block  0.0630655288696289
generate_one_block  0.06253242492675781
generate_one_block  0.06098151206970215
generate_one_block  0.0605769157409668
generate_one_block  0.06807708740234375
generate_one_block  0.06633305549621582
generate_one_block  0.0672297477722168
generate_one_block  0.06387877464294434
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05259299278259277
gen group dst list time:  0.017098665237426758
time for parepare:  0.0222470760345459
local_output_nid generation:  0.011207103729248047
local_in_edges_tensor generation:  0.04334616661071777
mini_batch_src_global generation:  0.035584449768066406
r_  generation:  0.36185693740844727
local_output_nid generation:  0.02111077308654785
local_in_edges_tensor generation:  0.033759117126464844
mini_batch_src_global generation:  0.04464316368103027
r_  generation:  0.3736708164215088
local_output_nid generation:  0.021443843841552734
local_in_edges_tensor generation:  0.02345418930053711
mini_batch_src_global generation:  0.04347872734069824
r_  generation:  0.37145042419433594
local_output_nid generation:  0.021646738052368164
local_in_edges_tensor generation:  0.026900529861450195
mini_batch_src_global generation:  0.044284820556640625
r_  generation:  0.37256765365600586
local_output_nid generation:  0.02236318588256836
local_in_edges_tensor generation:  0.02443718910217285
mini_batch_src_global generation:  0.04565834999084473
r_  generation:  0.37781500816345215
local_output_nid generation:  0.02246260643005371
local_in_edges_tensor generation:  0.02752971649169922
mini_batch_src_global generation:  0.04585909843444824
r_  generation:  0.38001251220703125
local_output_nid generation:  0.025423049926757812
local_in_edges_tensor generation:  0.028064966201782227
mini_batch_src_global generation:  0.04608893394470215
r_  generation:  0.3975648880004883
local_output_nid generation:  0.022641420364379883
local_in_edges_tensor generation:  0.025321483612060547
mini_batch_src_global generation:  0.048647403717041016
r_  generation:  0.39354372024536133
----------------------check_connections_block total spend ----------------------------- 4.434678792953491
generate_one_block  0.5079963207244873
generate_one_block  0.5127396583557129
generate_one_block  0.4890153408050537
generate_one_block  0.48824095726013184
generate_one_block  0.4909079074859619
generate_one_block  0.4896717071533203
generate_one_block  0.5083136558532715
generate_one_block  0.5339303016662598
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04589366912841797
gen group dst list time:  0.03722882270812988
time for parepare:  0.019130229949951172
local_output_nid generation:  0.025435209274291992
local_in_edges_tensor generation:  0.0733342170715332
mini_batch_src_global generation:  0.04747915267944336
r_  generation:  0.48280787467956543
local_output_nid generation:  0.03281664848327637
local_in_edges_tensor generation:  0.04894232749938965
mini_batch_src_global generation:  0.0572052001953125
r_  generation:  0.49012231826782227
local_output_nid generation:  0.03397798538208008
local_in_edges_tensor generation:  0.037186622619628906
mini_batch_src_global generation:  0.07423710823059082
r_  generation:  0.4956498146057129
local_output_nid generation:  0.03418278694152832
local_in_edges_tensor generation:  0.04240703582763672
mini_batch_src_global generation:  0.05528569221496582
r_  generation:  0.5165624618530273
local_output_nid generation:  0.03914952278137207
local_in_edges_tensor generation:  0.04857039451599121
mini_batch_src_global generation:  0.0592038631439209
r_  generation:  0.5052773952484131
local_output_nid generation:  0.03615736961364746
local_in_edges_tensor generation:  0.03867077827453613
mini_batch_src_global generation:  0.05541706085205078
r_  generation:  0.5041985511779785
local_output_nid generation:  0.03656125068664551
local_in_edges_tensor generation:  0.03517413139343262
mini_batch_src_global generation:  0.05615496635437012
r_  generation:  0.5091133117675781
local_output_nid generation:  0.036653757095336914
local_in_edges_tensor generation:  0.03715920448303223
mini_batch_src_global generation:  0.05658602714538574
r_  generation:  0.511338472366333
----------------------check_connections_block total spend ----------------------------- 6.0266735553741455
generate_one_block  0.6213641166687012
generate_one_block  0.6393845081329346
generate_one_block  0.6258447170257568
generate_one_block  0.6384646892547607
generate_one_block  0.6337637901306152
generate_one_block  0.6141149997711182
generate_one_block  0.6207151412963867
generate_one_block  0.6259427070617676
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.1384291648864746  GigaBytes
Max Memory Allocated: 1.0927677154541016  GigaBytes

connection checking time:  10.461352348327637
block generation total time  9.04041051864624
average batch blocks generation time:  1.13005131483078
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.10446548461914062  GigaBytes
Max Memory Allocated: 1.0927677154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9520010948181152  GigaBytes
Max Memory Allocated: 1.0927677154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10378408432006836  GigaBytes
Max Memory Allocated: 1.0928997993469238  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9503040313720703  GigaBytes
Max Memory Allocated: 1.0928997993469238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10492420196533203  GigaBytes
Max Memory Allocated: 1.0928997993469238  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.950838565826416  GigaBytes
Max Memory Allocated: 1.0928997993469238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10464000701904297  GigaBytes
Max Memory Allocated: 1.0928997993469238  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9452109336853027  GigaBytes
Max Memory Allocated: 1.0928997993469238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1048727035522461  GigaBytes
Max Memory Allocated: 1.0928997993469238  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9563894271850586  GigaBytes
Max Memory Allocated: 1.0928997993469238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10351228713989258  GigaBytes
Max Memory Allocated: 1.096989631652832  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9470629692077637  GigaBytes
Max Memory Allocated: 1.096989631652832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10507965087890625  GigaBytes
Max Memory Allocated: 1.096989631652832  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9534039497375488  GigaBytes
Max Memory Allocated: 1.096989631652832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10372591018676758  GigaBytes
Max Memory Allocated: 1.096989631652832  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9499216079711914  GigaBytes
Max Memory Allocated: 1.096989631652832  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07909372448921204 |0.01720327138900757 |0.0036181211471557617 |9.173154830932617e-05 |0.008676588535308838 |0.0017201900482177734 |
----------------------------------------------------------pseudo_mini_loss sum 3.240169048309326
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3054521
Number of first layer input nodes during this epoch:  1297599
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13713598251342773  GigaBytes
Max Memory Allocated: 1.096989631652832  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.030690908432006836
range selection method range initialization spend 0.012632608413696289
time for parepare:  0.017109394073486328
local_output_nid generation:  0.002791166305541992
local_in_edges_tensor generation:  0.007582187652587891
mini_batch_src_global generation:  0.0039103031158447266
r_  generation:  0.042273521423339844
local_output_nid generation:  0.0031909942626953125
local_in_edges_tensor generation:  0.0018169879913330078
mini_batch_src_global generation:  0.004777669906616211
r_  generation:  0.04474616050720215
local_output_nid generation:  0.003208160400390625
local_in_edges_tensor generation:  0.0017783641815185547
mini_batch_src_global generation:  0.0032491683959960938
r_  generation:  0.045583486557006836
local_output_nid generation:  0.0031859874725341797
local_in_edges_tensor generation:  0.0017123222351074219
mini_batch_src_global generation:  0.003343343734741211
r_  generation:  0.04522085189819336
local_output_nid generation:  0.003213167190551758
local_in_edges_tensor generation:  0.0018296241760253906
mini_batch_src_global generation:  0.0035123825073242188
r_  generation:  0.04766678810119629
local_output_nid generation:  0.0031669139862060547
local_in_edges_tensor generation:  0.001878499984741211
mini_batch_src_global generation:  0.003717660903930664
r_  generation:  0.04816699028015137
local_output_nid generation:  0.00318145751953125
local_in_edges_tensor generation:  0.0017468929290771484
mini_batch_src_global generation:  0.0037424564361572266
r_  generation:  0.04786849021911621
local_output_nid generation:  0.0032584667205810547
local_in_edges_tensor generation:  0.0018591880798339844
mini_batch_src_global generation:  0.0036869049072265625
r_  generation:  0.046607255935668945
----------------------check_connections_block total spend ----------------------------- 0.5404651165008545
generate_one_block  0.06438922882080078
generate_one_block  0.06585216522216797
generate_one_block  0.06171917915344238
generate_one_block  0.06071615219116211
generate_one_block  0.06196928024291992
generate_one_block  0.0628812313079834
generate_one_block  0.06421875953674316
generate_one_block  0.060651540756225586
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04206490516662598
gen group dst list time:  0.016048431396484375
time for parepare:  0.018967628479003906
local_output_nid generation:  0.011699199676513672
local_in_edges_tensor generation:  0.03255939483642578
mini_batch_src_global generation:  0.03718829154968262
r_  generation:  0.3633410930633545
local_output_nid generation:  0.018157005310058594
local_in_edges_tensor generation:  0.024641990661621094
mini_batch_src_global generation:  0.04708552360534668
r_  generation:  0.37334752082824707
local_output_nid generation:  0.018174409866333008
local_in_edges_tensor generation:  0.022414684295654297
mini_batch_src_global generation:  0.048810720443725586
r_  generation:  0.38388991355895996
local_output_nid generation:  0.017847061157226562
local_in_edges_tensor generation:  0.021059036254882812
mini_batch_src_global generation:  0.04540729522705078
r_  generation:  0.37353992462158203
local_output_nid generation:  0.0185697078704834
local_in_edges_tensor generation:  0.020427465438842773
mini_batch_src_global generation:  0.046441078186035156
r_  generation:  0.39346885681152344
local_output_nid generation:  0.018464326858520508
local_in_edges_tensor generation:  0.020087480545043945
mini_batch_src_global generation:  0.046645402908325195
r_  generation:  0.3860745429992676
local_output_nid generation:  0.018363237380981445
local_in_edges_tensor generation:  0.021740436553955078
mini_batch_src_global generation:  0.04634737968444824
r_  generation:  0.3825089931488037
local_output_nid generation:  0.0183868408203125
local_in_edges_tensor generation:  0.02039027214050293
mini_batch_src_global generation:  0.046082496643066406
r_  generation:  0.37551259994506836
----------------------check_connections_block total spend ----------------------------- 4.369678974151611
generate_one_block  0.49310779571533203
generate_one_block  0.49669837951660156
generate_one_block  0.4974081516265869
generate_one_block  0.4903440475463867
generate_one_block  0.503333330154419
generate_one_block  0.49822306632995605
generate_one_block  0.48684144020080566
generate_one_block  0.5100252628326416
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0324702262878418
gen group dst list time:  0.03924441337585449
time for parepare:  0.01898360252380371
local_output_nid generation:  0.0265805721282959
local_in_edges_tensor generation:  0.04191303253173828
mini_batch_src_global generation:  0.04618430137634277
r_  generation:  0.4850432872772217
local_output_nid generation:  0.03348708152770996
local_in_edges_tensor generation:  0.03788304328918457
mini_batch_src_global generation:  0.05496954917907715
r_  generation:  0.4892704486846924
local_output_nid generation:  0.03397822380065918
local_in_edges_tensor generation:  0.03479814529418945
mini_batch_src_global generation:  0.0574038028717041
r_  generation:  0.48913145065307617
local_output_nid generation:  0.0346522331237793
local_in_edges_tensor generation:  0.036455392837524414
mini_batch_src_global generation:  0.05273580551147461
r_  generation:  0.4998011589050293
local_output_nid generation:  0.0359349250793457
local_in_edges_tensor generation:  0.03333854675292969
mini_batch_src_global generation:  0.0552830696105957
r_  generation:  0.4960646629333496
local_output_nid generation:  0.03488326072692871
local_in_edges_tensor generation:  0.03734111785888672
mini_batch_src_global generation:  0.05404472351074219
r_  generation:  0.5009450912475586
local_output_nid generation:  0.03476977348327637
local_in_edges_tensor generation:  0.03275561332702637
mini_batch_src_global generation:  0.05324697494506836
r_  generation:  0.5019872188568115
local_output_nid generation:  0.03494524955749512
local_in_edges_tensor generation:  0.03531193733215332
mini_batch_src_global generation:  0.05747866630554199
r_  generation:  0.5189518928527832
----------------------check_connections_block total spend ----------------------------- 5.881879806518555
generate_one_block  0.6162056922912598
generate_one_block  0.6206953525543213
generate_one_block  0.6176197528839111
generate_one_block  0.6136879920959473
generate_one_block  0.6213531494140625
generate_one_block  0.6320044994354248
generate_one_block  0.6085047721862793
generate_one_block  0.629000186920166
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13713598251342773  GigaBytes
Max Memory Allocated: 1.096989631652832  GigaBytes

connection checking time:  10.251558780670166
block generation total time  8.935052871704102
average batch blocks generation time:  1.1168816089630127
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10509777069091797  GigaBytes
Max Memory Allocated: 1.096989631652832  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9535799026489258  GigaBytes
Max Memory Allocated: 1.096989631652832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10381889343261719  GigaBytes
Max Memory Allocated: 1.096989631652832  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9516787528991699  GigaBytes
Max Memory Allocated: 1.096989631652832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10516881942749023  GigaBytes
Max Memory Allocated: 1.096989631652832  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9528241157531738  GigaBytes
Max Memory Allocated: 1.096989631652832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10407304763793945  GigaBytes
Max Memory Allocated: 1.096989631652832  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9440288543701172  GigaBytes
Max Memory Allocated: 1.096989631652832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10506820678710938  GigaBytes
Max Memory Allocated: 1.096989631652832  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9596738815307617  GigaBytes
Max Memory Allocated: 1.096989631652832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10376453399658203  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9519095420837402  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10497903823852539  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.94793701171875  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1039738655090332  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9449553489685059  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08165368437767029 |0.01762568950653076 |0.005865693092346191 |9.307265281677246e-05 |0.0034958720207214355 |0.0013358592987060547 |
----------------------------------------------------------pseudo_mini_loss sum 2.609973430633545
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  3055380
Number of first layer input nodes during this epoch:  1297704
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13705825805664062  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020308971405029297
range selection method range initialization spend 0.012123584747314453
time for parepare:  0.016104698181152344
local_output_nid generation:  0.0027399063110351562
local_in_edges_tensor generation:  0.006910562515258789
mini_batch_src_global generation:  0.003904581069946289
r_  generation:  0.04176020622253418
local_output_nid generation:  0.0031898021697998047
local_in_edges_tensor generation:  0.0018398761749267578
mini_batch_src_global generation:  0.0047702789306640625
r_  generation:  0.0453801155090332
local_output_nid generation:  0.0031616687774658203
local_in_edges_tensor generation:  0.0018754005432128906
mini_batch_src_global generation:  0.003207683563232422
r_  generation:  0.04466891288757324
local_output_nid generation:  0.0032248497009277344
local_in_edges_tensor generation:  0.00191497802734375
mini_batch_src_global generation:  0.003247976303100586
r_  generation:  0.04583430290222168
local_output_nid generation:  0.0032987594604492188
local_in_edges_tensor generation:  0.0019431114196777344
mini_batch_src_global generation:  0.0035750865936279297
r_  generation:  0.048346519470214844
local_output_nid generation:  0.003223896026611328
local_in_edges_tensor generation:  0.0018715858459472656
mini_batch_src_global generation:  0.0037038326263427734
r_  generation:  0.04839301109313965
local_output_nid generation:  0.003328561782836914
local_in_edges_tensor generation:  0.0018563270568847656
mini_batch_src_global generation:  0.0037407875061035156
r_  generation:  0.04931926727294922
local_output_nid generation:  0.003309011459350586
local_in_edges_tensor generation:  0.0021402835845947266
mini_batch_src_global generation:  0.003760814666748047
r_  generation:  0.04764914512634277
----------------------check_connections_block total spend ----------------------------- 0.5432469844818115
generate_one_block  0.06057381629943848
generate_one_block  0.06203937530517578
generate_one_block  0.06134605407714844
generate_one_block  0.06102776527404785
generate_one_block  0.06279397010803223
generate_one_block  0.06304144859313965
generate_one_block  0.06519770622253418
generate_one_block  0.061917781829833984
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03760266304016113
gen group dst list time:  0.015789508819580078
time for parepare:  0.019230365753173828
local_output_nid generation:  0.011680841445922852
local_in_edges_tensor generation:  0.03930044174194336
mini_batch_src_global generation:  0.0377042293548584
r_  generation:  0.3608131408691406
local_output_nid generation:  0.018337249755859375
local_in_edges_tensor generation:  0.0252077579498291
mini_batch_src_global generation:  0.05637526512145996
r_  generation:  0.38284993171691895
local_output_nid generation:  0.019157886505126953
local_in_edges_tensor generation:  0.02551412582397461
mini_batch_src_global generation:  0.04369378089904785
r_  generation:  0.3726825714111328
local_output_nid generation:  0.018297910690307617
local_in_edges_tensor generation:  0.01950550079345703
mini_batch_src_global generation:  0.04494142532348633
r_  generation:  0.37814879417419434
local_output_nid generation:  0.01811051368713379
local_in_edges_tensor generation:  0.023493289947509766
mini_batch_src_global generation:  0.06419944763183594
r_  generation:  0.3977532386779785
local_output_nid generation:  0.02110886573791504
local_in_edges_tensor generation:  0.02172994613647461
mini_batch_src_global generation:  0.05016303062438965
r_  generation:  0.38953328132629395
local_output_nid generation:  0.018884658813476562
local_in_edges_tensor generation:  0.020586729049682617
mini_batch_src_global generation:  0.04631543159484863
r_  generation:  0.3811807632446289
local_output_nid generation:  0.018810749053955078
local_in_edges_tensor generation:  0.021546363830566406
mini_batch_src_global generation:  0.04697275161743164
r_  generation:  0.38561582565307617
----------------------check_connections_block total spend ----------------------------- 4.436495065689087
generate_one_block  0.48541688919067383
generate_one_block  0.5020241737365723
generate_one_block  0.48470091819763184
generate_one_block  0.4843614101409912
generate_one_block  0.4920065402984619
generate_one_block  0.49488186836242676
generate_one_block  0.4896535873413086
generate_one_block  0.5188863277435303
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.039487600326538086
gen group dst list time:  0.03864240646362305
time for parepare:  0.01897406578063965
local_output_nid generation:  0.026597261428833008
local_in_edges_tensor generation:  0.05022287368774414
mini_batch_src_global generation:  0.044373512268066406
r_  generation:  0.4808638095855713
local_output_nid generation:  0.03325963020324707
local_in_edges_tensor generation:  0.04167461395263672
mini_batch_src_global generation:  0.05644941329956055
r_  generation:  0.497844934463501
local_output_nid generation:  0.03411412239074707
local_in_edges_tensor generation:  0.03266310691833496
mini_batch_src_global generation:  0.05387592315673828
r_  generation:  0.4893002510070801
local_output_nid generation:  0.03438615798950195
local_in_edges_tensor generation:  0.03262805938720703
mini_batch_src_global generation:  0.05512285232543945
r_  generation:  0.5007498264312744
local_output_nid generation:  0.03465628623962402
local_in_edges_tensor generation:  0.03597760200500488
mini_batch_src_global generation:  0.05584406852722168
r_  generation:  0.4969947338104248
local_output_nid generation:  0.0345911979675293
local_in_edges_tensor generation:  0.035337209701538086
mini_batch_src_global generation:  0.053376197814941406
r_  generation:  0.5081415176391602
local_output_nid generation:  0.03509783744812012
local_in_edges_tensor generation:  0.03476738929748535
mini_batch_src_global generation:  0.05395221710205078
r_  generation:  0.505340576171875
local_output_nid generation:  0.03485417366027832
local_in_edges_tensor generation:  0.03523969650268555
mini_batch_src_global generation:  0.05430316925048828
r_  generation:  0.5119645595550537
----------------------check_connections_block total spend ----------------------------- 5.882745265960693
generate_one_block  0.6132667064666748
generate_one_block  0.6172928810119629
generate_one_block  0.6109075546264648
generate_one_block  0.6216392517089844
generate_one_block  0.62442946434021
generate_one_block  0.6213250160217285
generate_one_block  0.6225574016571045
generate_one_block  0.6162891387939453
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13705825805664062  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

connection checking time:  10.31924033164978
block generation total time  8.899639129638672
average batch blocks generation time:  1.112454891204834
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10481452941894531  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9503355026245117  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10486507415771484  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9510936737060547  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10362911224365234  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9458680152893066  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10487842559814453  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9497828483581543  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10500288009643555  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9571084976196289  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10513639450073242  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9522161483764648  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10492515563964844  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9522175788879395  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10404253005981445  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9492096900939941  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08482083678245544 |0.015162825584411621 |0.003462374210357666 |9.15825366973877e-05 |0.0034510791301727295 |0.0024423599243164062 |
----------------------------------------------------------pseudo_mini_loss sum 2.3582677841186523
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  3053529
Number of first layer input nodes during this epoch:  1297246
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13794374465942383  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024016141891479492
range selection method range initialization spend 0.012229681015014648
time for parepare:  0.015750885009765625
local_output_nid generation:  0.002627849578857422
local_in_edges_tensor generation:  0.004083871841430664
mini_batch_src_global generation:  0.003966093063354492
r_  generation:  0.0417017936706543
local_output_nid generation:  0.0031266212463378906
local_in_edges_tensor generation:  0.0017023086547851562
mini_batch_src_global generation:  0.004835367202758789
r_  generation:  0.04464411735534668
local_output_nid generation:  0.0031118392944335938
local_in_edges_tensor generation:  0.001718282699584961
mini_batch_src_global generation:  0.003231048583984375
r_  generation:  0.045590877532958984
local_output_nid generation:  0.003135204315185547
local_in_edges_tensor generation:  0.0018086433410644531
mini_batch_src_global generation:  0.003407716751098633
r_  generation:  0.04598832130432129
local_output_nid generation:  0.0032470226287841797
local_in_edges_tensor generation:  0.0017924308776855469
mini_batch_src_global generation:  0.0035686492919921875
r_  generation:  0.04767298698425293
local_output_nid generation:  0.0032150745391845703
local_in_edges_tensor generation:  0.0018308162689208984
mini_batch_src_global generation:  0.0038170814514160156
r_  generation:  0.04829072952270508
local_output_nid generation:  0.003216981887817383
local_in_edges_tensor generation:  0.0018680095672607422
mini_batch_src_global generation:  0.0037932395935058594
r_  generation:  0.04819822311401367
local_output_nid generation:  0.0032024383544921875
local_in_edges_tensor generation:  0.0018832683563232422
mini_batch_src_global generation:  0.003685474395751953
r_  generation:  0.04774951934814453
----------------------check_connections_block total spend ----------------------------- 0.5363674163818359
generate_one_block  0.06424665451049805
generate_one_block  0.06395602226257324
generate_one_block  0.062296390533447266
generate_one_block  0.06406450271606445
generate_one_block  0.06241464614868164
generate_one_block  0.06548380851745605
generate_one_block  0.06954526901245117
generate_one_block  0.06154298782348633
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.041106224060058594
gen group dst list time:  0.017261505126953125
time for parepare:  0.022220373153686523
local_output_nid generation:  0.011892557144165039
local_in_edges_tensor generation:  0.030758142471313477
mini_batch_src_global generation:  0.04096102714538574
r_  generation:  0.36192846298217773
local_output_nid generation:  0.01819920539855957
local_in_edges_tensor generation:  0.029294252395629883
mini_batch_src_global generation:  0.044762372970581055
r_  generation:  0.3673286437988281
local_output_nid generation:  0.018360614776611328
local_in_edges_tensor generation:  0.024411439895629883
mini_batch_src_global generation:  0.04438471794128418
r_  generation:  0.3754105567932129
local_output_nid generation:  0.01849961280822754
local_in_edges_tensor generation:  0.021141529083251953
mini_batch_src_global generation:  0.0452272891998291
r_  generation:  0.380190372467041
local_output_nid generation:  0.018766164779663086
local_in_edges_tensor generation:  0.0216522216796875
mini_batch_src_global generation:  0.046221256256103516
r_  generation:  0.3852524757385254
local_output_nid generation:  0.018741846084594727
local_in_edges_tensor generation:  0.021772384643554688
mini_batch_src_global generation:  0.04834151268005371
r_  generation:  0.39000892639160156
local_output_nid generation:  0.018921613693237305
local_in_edges_tensor generation:  0.02162337303161621
mini_batch_src_global generation:  0.04668688774108887
r_  generation:  0.38530421257019043
local_output_nid generation:  0.021420001983642578
local_in_edges_tensor generation:  0.02331829071044922
mini_batch_src_global generation:  0.0474095344543457
r_  generation:  0.3843719959259033
----------------------check_connections_block total spend ----------------------------- 4.390701770782471
generate_one_block  0.49686694145202637
generate_one_block  0.48264050483703613
generate_one_block  0.4863908290863037
generate_one_block  0.4957094192504883
generate_one_block  0.49976348876953125
generate_one_block  0.5000870227813721
generate_one_block  0.5026712417602539
generate_one_block  0.5318310260772705
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04340171813964844
gen group dst list time:  0.04383277893066406
time for parepare:  0.01891303062438965
local_output_nid generation:  0.02806568145751953
local_in_edges_tensor generation:  0.049088239669799805
mini_batch_src_global generation:  0.04707789421081543
r_  generation:  0.4940834045410156
local_output_nid generation:  0.035822391510009766
local_in_edges_tensor generation:  0.0456082820892334
mini_batch_src_global generation:  0.057205915451049805
r_  generation:  0.48930859565734863
local_output_nid generation:  0.03549599647521973
local_in_edges_tensor generation:  0.038388967514038086
mini_batch_src_global generation:  0.05989837646484375
r_  generation:  0.4894382953643799
local_output_nid generation:  0.03528332710266113
local_in_edges_tensor generation:  0.03376173973083496
mini_batch_src_global generation:  0.053403615951538086
r_  generation:  0.4945859909057617
local_output_nid generation:  0.0357365608215332
local_in_edges_tensor generation:  0.032770633697509766
mini_batch_src_global generation:  0.054017066955566406
r_  generation:  0.4947850704193115
local_output_nid generation:  0.03572797775268555
local_in_edges_tensor generation:  0.03280305862426758
mini_batch_src_global generation:  0.053734779357910156
r_  generation:  0.4999263286590576
local_output_nid generation:  0.03804469108581543
local_in_edges_tensor generation:  0.036722421646118164
mini_batch_src_global generation:  0.054239749908447266
r_  generation:  0.5147995948791504
local_output_nid generation:  0.03567647933959961
local_in_edges_tensor generation:  0.035219669342041016
mini_batch_src_global generation:  0.05517935752868652
r_  generation:  0.504443883895874
----------------------check_connections_block total spend ----------------------------- 5.898378849029541
generate_one_block  0.6355280876159668
generate_one_block  0.6285116672515869
generate_one_block  0.6233508586883545
generate_one_block  0.6207001209259033
generate_one_block  0.6273679733276367
generate_one_block  0.6362216472625732
generate_one_block  0.620579719543457
generate_one_block  0.6246943473815918
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13794374465942383  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

connection checking time:  10.289080619812012
block generation total time  9.012914896011353
average batch blocks generation time:  1.126614362001419
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10569000244140625  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9517946243286133  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1040964126586914  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9490618705749512  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10564517974853516  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9522171020507812  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10427665710449219  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9491515159606934  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10556221008300781  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9521379470825195  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10421228408813477  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9529504776000977  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1050877571105957  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.952690601348877  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10418224334716797  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9472675323486328  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08172976970672607 |0.019085198640823364 |0.0034814774990081787 |8.96751880645752e-05 |0.003359377384185791 |0.0017578601837158203 |
----------------------------------------------------------pseudo_mini_loss sum 2.0990476608276367
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  3054880
Number of first layer input nodes during this epoch:  1297540
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13747358322143555  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02287745475769043
range selection method range initialization spend 0.012196540832519531
time for parepare:  0.01784539222717285
local_output_nid generation:  0.002710580825805664
local_in_edges_tensor generation:  0.006890535354614258
mini_batch_src_global generation:  0.003626108169555664
r_  generation:  0.04431438446044922
local_output_nid generation:  0.003243684768676758
local_in_edges_tensor generation:  0.0018134117126464844
mini_batch_src_global generation:  0.004958152770996094
r_  generation:  0.04650568962097168
local_output_nid generation:  0.003216981887817383
local_in_edges_tensor generation:  0.0019254684448242188
mini_batch_src_global generation:  0.003362894058227539
r_  generation:  0.04673123359680176
local_output_nid generation:  0.0031633377075195312
local_in_edges_tensor generation:  0.0017926692962646484
mini_batch_src_global generation:  0.0033636093139648438
r_  generation:  0.04805564880371094
local_output_nid generation:  0.0032515525817871094
local_in_edges_tensor generation:  0.0018091201782226562
mini_batch_src_global generation:  0.00362396240234375
r_  generation:  0.047148942947387695
local_output_nid generation:  0.003236532211303711
local_in_edges_tensor generation:  0.0018284320831298828
mini_batch_src_global generation:  0.003734588623046875
r_  generation:  0.048387765884399414
local_output_nid generation:  0.003309011459350586
local_in_edges_tensor generation:  0.0017938613891601562
mini_batch_src_global generation:  0.003772735595703125
r_  generation:  0.04783916473388672
local_output_nid generation:  0.003232240676879883
local_in_edges_tensor generation:  0.0018396377563476562
mini_batch_src_global generation:  0.0037994384765625
r_  generation:  0.04834556579589844
----------------------check_connections_block total spend ----------------------------- 0.549635648727417
generate_one_block  0.06361007690429688
generate_one_block  0.062230825424194336
generate_one_block  0.06647586822509766
generate_one_block  0.062439680099487305
generate_one_block  0.06145930290222168
generate_one_block  0.06179547309875488
generate_one_block  0.06342554092407227
generate_one_block  0.06264162063598633
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03651070594787598
gen group dst list time:  0.015398263931274414
time for parepare:  0.019376516342163086
local_output_nid generation:  0.011824846267700195
local_in_edges_tensor generation:  0.030086278915405273
mini_batch_src_global generation:  0.03763222694396973
r_  generation:  0.36456823348999023
local_output_nid generation:  0.018301725387573242
local_in_edges_tensor generation:  0.024389266967773438
mini_batch_src_global generation:  0.04528236389160156
r_  generation:  0.37696385383605957
local_output_nid generation:  0.01841902732849121
local_in_edges_tensor generation:  0.01986837387084961
mini_batch_src_global generation:  0.04437971115112305
r_  generation:  0.3803102970123291
local_output_nid generation:  0.019211530685424805
local_in_edges_tensor generation:  0.021167993545532227
mini_batch_src_global generation:  0.045293569564819336
r_  generation:  0.3832063674926758
local_output_nid generation:  0.019315004348754883
local_in_edges_tensor generation:  0.021405696868896484
mini_batch_src_global generation:  0.04625296592712402
r_  generation:  0.3826901912689209
local_output_nid generation:  0.018578290939331055
local_in_edges_tensor generation:  0.020369768142700195
mini_batch_src_global generation:  0.046286582946777344
r_  generation:  0.38232851028442383
local_output_nid generation:  0.01841139793395996
local_in_edges_tensor generation:  0.0211789608001709
mini_batch_src_global generation:  0.045758962631225586
r_  generation:  0.38155221939086914
local_output_nid generation:  0.018607616424560547
local_in_edges_tensor generation:  0.020186185836791992
mini_batch_src_global generation:  0.0469515323638916
r_  generation:  0.3845517635345459
----------------------check_connections_block total spend ----------------------------- 4.369976997375488
generate_one_block  0.4903585910797119
generate_one_block  0.5060410499572754
generate_one_block  0.4988083839416504
generate_one_block  0.49652743339538574
generate_one_block  0.4932980537414551
generate_one_block  0.4888594150543213
generate_one_block  0.48467135429382324
generate_one_block  0.5185501575469971
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03155398368835449
gen group dst list time:  0.04060792922973633
time for parepare:  0.01883101463317871
local_output_nid generation:  0.026449203491210938
local_in_edges_tensor generation:  0.03840017318725586
mini_batch_src_global generation:  0.04342055320739746
r_  generation:  0.47902989387512207
local_output_nid generation:  0.03275752067565918
local_in_edges_tensor generation:  0.04149580001831055
mini_batch_src_global generation:  0.057088613510131836
r_  generation:  0.48776793479919434
local_output_nid generation:  0.033682823181152344
local_in_edges_tensor generation:  0.0379638671875
mini_batch_src_global generation:  0.05566263198852539
r_  generation:  0.4901309013366699
local_output_nid generation:  0.03412008285522461
local_in_edges_tensor generation:  0.031710147857666016
mini_batch_src_global generation:  0.052742719650268555
r_  generation:  0.5021491050720215
local_output_nid generation:  0.03452634811401367
local_in_edges_tensor generation:  0.04076075553894043
mini_batch_src_global generation:  0.054833412170410156
r_  generation:  0.5041177272796631
local_output_nid generation:  0.03562760353088379
local_in_edges_tensor generation:  0.03641223907470703
mini_batch_src_global generation:  0.053678035736083984
r_  generation:  0.5105850696563721
local_output_nid generation:  0.03467726707458496
local_in_edges_tensor generation:  0.03655600547790527
mini_batch_src_global generation:  0.053318023681640625
r_  generation:  0.5180766582489014
local_output_nid generation:  0.037893056869506836
local_in_edges_tensor generation:  0.036173105239868164
mini_batch_src_global generation:  0.06078171730041504
r_  generation:  0.5095653533935547
----------------------check_connections_block total spend ----------------------------- 5.909262657165527
generate_one_block  0.6229441165924072
generate_one_block  0.6178803443908691
generate_one_block  0.627422571182251
generate_one_block  0.6174707412719727
generate_one_block  0.6215956211090088
generate_one_block  0.6229946613311768
generate_one_block  0.6202113628387451
generate_one_block  0.6238923072814941
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13747358322143555  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

connection checking time:  10.279239654541016
block generation total time  8.951526165008545
average batch blocks generation time:  1.1189407706260681
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10493087768554688  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9493379592895508  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10508871078491211  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9536275863647461  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10514450073242188  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9550309181213379  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10496044158935547  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9491190910339355  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10426473617553711  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.950742244720459  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10520648956298828  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9485831260681152  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10383176803588867  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9444832801818848  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10502433776855469  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9528961181640625  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.084967702627182 |0.01654750108718872 |0.0035896003246307373 |9.247660636901855e-05 |0.003812551498413086 |0.0018811225891113281 |
----------------------------------------------------------pseudo_mini_loss sum 1.9570190906524658
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  3053730
Number of first layer input nodes during this epoch:  1297368
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13820505142211914  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024755239486694336
range selection method range initialization spend 0.012753725051879883
time for parepare:  0.017651081085205078
local_output_nid generation:  0.0028405189514160156
local_in_edges_tensor generation:  0.005677223205566406
mini_batch_src_global generation:  0.003715038299560547
r_  generation:  0.04280972480773926
local_output_nid generation:  0.0032639503479003906
local_in_edges_tensor generation:  0.0017940998077392578
mini_batch_src_global generation:  0.004827737808227539
r_  generation:  0.044693708419799805
local_output_nid generation:  0.0031652450561523438
local_in_edges_tensor generation:  0.001795053482055664
mini_batch_src_global generation:  0.0032291412353515625
r_  generation:  0.045412302017211914
local_output_nid generation:  0.0032434463500976562
local_in_edges_tensor generation:  0.0018346309661865234
mini_batch_src_global generation:  0.0033409595489501953
r_  generation:  0.046319007873535156
local_output_nid generation:  0.0032019615173339844
local_in_edges_tensor generation:  0.0018374919891357422
mini_batch_src_global generation:  0.003597736358642578
r_  generation:  0.047025442123413086
local_output_nid generation:  0.0032067298889160156
local_in_edges_tensor generation:  0.0021581649780273438
mini_batch_src_global generation:  0.0038156509399414062
r_  generation:  0.04830193519592285
local_output_nid generation:  0.0032346248626708984
local_in_edges_tensor generation:  0.0018177032470703125
mini_batch_src_global generation:  0.003845691680908203
r_  generation:  0.04851698875427246
local_output_nid generation:  0.0032320022583007812
local_in_edges_tensor generation:  0.0020046234130859375
mini_batch_src_global generation:  0.0037376880645751953
r_  generation:  0.04837465286254883
----------------------check_connections_block total spend ----------------------------- 0.5447516441345215
generate_one_block  0.06107187271118164
generate_one_block  0.060974836349487305
generate_one_block  0.06087374687194824
generate_one_block  0.06148171424865723
generate_one_block  0.06115984916687012
generate_one_block  0.06322717666625977
generate_one_block  0.0655210018157959
generate_one_block  0.06197690963745117
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03734397888183594
gen group dst list time:  0.01957988739013672
time for parepare:  0.02115941047668457
local_output_nid generation:  0.011873245239257812
local_in_edges_tensor generation:  0.03044295310974121
mini_batch_src_global generation:  0.036997318267822266
r_  generation:  0.35984158515930176
local_output_nid generation:  0.017665386199951172
local_in_edges_tensor generation:  0.025009632110595703
mini_batch_src_global generation:  0.04750394821166992
r_  generation:  0.3715388774871826
local_output_nid generation:  0.01880478858947754
local_in_edges_tensor generation:  0.02316737174987793
mini_batch_src_global generation:  0.049520254135131836
r_  generation:  0.37926793098449707
local_output_nid generation:  0.019132614135742188
local_in_edges_tensor generation:  0.02615809440612793
mini_batch_src_global generation:  0.04727506637573242
r_  generation:  0.3795795440673828
local_output_nid generation:  0.01914238929748535
local_in_edges_tensor generation:  0.019504785537719727
mini_batch_src_global generation:  0.046280860900878906
r_  generation:  0.37890076637268066
local_output_nid generation:  0.0183258056640625
local_in_edges_tensor generation:  0.019346952438354492
mini_batch_src_global generation:  0.048337459564208984
r_  generation:  0.3961679935455322
local_output_nid generation:  0.020835399627685547
local_in_edges_tensor generation:  0.022672176361083984
mini_batch_src_global generation:  0.04688549041748047
r_  generation:  0.38201475143432617
local_output_nid generation:  0.019182443618774414
local_in_edges_tensor generation:  0.0212709903717041
mini_batch_src_global generation:  0.04664158821105957
r_  generation:  0.3828613758087158
----------------------check_connections_block total spend ----------------------------- 4.38905668258667
generate_one_block  0.48905348777770996
generate_one_block  0.4868278503417969
generate_one_block  0.4892282485961914
generate_one_block  0.5021791458129883
generate_one_block  0.4879419803619385
generate_one_block  0.4964637756347656
generate_one_block  0.4909501075744629
generate_one_block  0.5161032676696777
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.031952857971191406
gen group dst list time:  0.03867840766906738
time for parepare:  0.018555879592895508
local_output_nid generation:  0.026806116104125977
local_in_edges_tensor generation:  0.04245328903198242
mini_batch_src_global generation:  0.04382586479187012
r_  generation:  0.4788210391998291
local_output_nid generation:  0.033159494400024414
local_in_edges_tensor generation:  0.03687095642089844
mini_batch_src_global generation:  0.054576873779296875
r_  generation:  0.4850597381591797
local_output_nid generation:  0.03446626663208008
local_in_edges_tensor generation:  0.03437447547912598
mini_batch_src_global generation:  0.06741738319396973
r_  generation:  0.4868640899658203
local_output_nid generation:  0.03424263000488281
local_in_edges_tensor generation:  0.032692670822143555
mini_batch_src_global generation:  0.056854963302612305
r_  generation:  0.4918506145477295
local_output_nid generation:  0.034291744232177734
local_in_edges_tensor generation:  0.03264188766479492
mini_batch_src_global generation:  0.05364108085632324
r_  generation:  0.49375295639038086
local_output_nid generation:  0.034497976303100586
local_in_edges_tensor generation:  0.0348513126373291
mini_batch_src_global generation:  0.05347919464111328
r_  generation:  0.4999701976776123
local_output_nid generation:  0.03479909896850586
local_in_edges_tensor generation:  0.039704084396362305
mini_batch_src_global generation:  0.05452299118041992
r_  generation:  0.4975705146789551
local_output_nid generation:  0.034952402114868164
local_in_edges_tensor generation:  0.037355899810791016
mini_batch_src_global generation:  0.05511593818664551
r_  generation:  0.5082249641418457
----------------------check_connections_block total spend ----------------------------- 5.839420557022095
generate_one_block  0.6105356216430664
generate_one_block  0.6138193607330322
generate_one_block  0.619525671005249
generate_one_block  0.616776704788208
generate_one_block  0.6112186908721924
generate_one_block  0.6181917190551758
generate_one_block  0.6253905296325684
generate_one_block  0.6222538948059082
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13820505142211914  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

connection checking time:  10.228477239608765
block generation total time  8.896460056304932
average batch blocks generation time:  1.1120575070381165
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10425424575805664  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.951357364654541  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1049652099609375  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9517779350280762  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10435771942138672  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9513335227966309  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10523605346679688  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9515295028686523  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10418939590454102  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.946281909942627  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1052408218383789  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9512238502502441  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10430002212524414  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9526071548461914  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10396528244018555  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9519596099853516  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0819675624370575 |0.012697726488113403 |0.00356292724609375 |9.28044319152832e-05 |0.0029835104942321777 |0.0015091896057128906 |
----------------------------------------------------------pseudo_mini_loss sum 1.8718994855880737
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  3055978
Number of first layer input nodes during this epoch:  1298090
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1371469497680664  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01873469352722168
range selection method range initialization spend 0.012188196182250977
time for parepare:  0.016208887100219727
local_output_nid generation:  0.002757549285888672
local_in_edges_tensor generation:  0.004018068313598633
mini_batch_src_global generation:  0.0035665035247802734
r_  generation:  0.04239845275878906
local_output_nid generation:  0.0031812191009521484
local_in_edges_tensor generation:  0.0017805099487304688
mini_batch_src_global generation:  0.0047533512115478516
r_  generation:  0.043947696685791016
local_output_nid generation:  0.003194093704223633
local_in_edges_tensor generation:  0.0017855167388916016
mini_batch_src_global generation:  0.003299713134765625
r_  generation:  0.04520225524902344
local_output_nid generation:  0.0032722949981689453
local_in_edges_tensor generation:  0.0018270015716552734
mini_batch_src_global generation:  0.0033295154571533203
r_  generation:  0.0471949577331543
local_output_nid generation:  0.0031931400299072266
local_in_edges_tensor generation:  0.0017881393432617188
mini_batch_src_global generation:  0.0036401748657226562
r_  generation:  0.04787635803222656
local_output_nid generation:  0.0032143592834472656
local_in_edges_tensor generation:  0.001821756362915039
mini_batch_src_global generation:  0.003858327865600586
r_  generation:  0.049040794372558594
local_output_nid generation:  0.0032095909118652344
local_in_edges_tensor generation:  0.0018303394317626953
mini_batch_src_global generation:  0.0038466453552246094
r_  generation:  0.048720359802246094
local_output_nid generation:  0.003220081329345703
local_in_edges_tensor generation:  0.0018336772918701172
mini_batch_src_global generation:  0.003719329833984375
r_  generation:  0.048303842544555664
----------------------check_connections_block total spend ----------------------------- 0.54142165184021
generate_one_block  0.05914711952209473
generate_one_block  0.060990333557128906
generate_one_block  0.060785770416259766
generate_one_block  0.06159067153930664
generate_one_block  0.06243419647216797
generate_one_block  0.06317377090454102
generate_one_block  0.06583523750305176
generate_one_block  0.06168937683105469
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03807806968688965
gen group dst list time:  0.017020225524902344
time for parepare:  0.0203855037689209
local_output_nid generation:  0.011747121810913086
local_in_edges_tensor generation:  0.02951836585998535
mini_batch_src_global generation:  0.03690814971923828
r_  generation:  0.3627028465270996
local_output_nid generation:  0.0181124210357666
local_in_edges_tensor generation:  0.024260520935058594
mini_batch_src_global generation:  0.04752635955810547
r_  generation:  0.36990880966186523
local_output_nid generation:  0.018798351287841797
local_in_edges_tensor generation:  0.02170872688293457
mini_batch_src_global generation:  0.043900251388549805
r_  generation:  0.3794984817504883
local_output_nid generation:  0.018814563751220703
local_in_edges_tensor generation:  0.02189159393310547
mini_batch_src_global generation:  0.045520782470703125
r_  generation:  0.3773031234741211
local_output_nid generation:  0.019649267196655273
local_in_edges_tensor generation:  0.023963212966918945
mini_batch_src_global generation:  0.04646611213684082
r_  generation:  0.38875460624694824
local_output_nid generation:  0.018442869186401367
local_in_edges_tensor generation:  0.022615909576416016
mini_batch_src_global generation:  0.04704141616821289
r_  generation:  0.3863706588745117
local_output_nid generation:  0.018717288970947266
local_in_edges_tensor generation:  0.020447254180908203
mini_batch_src_global generation:  0.04671740531921387
r_  generation:  0.3927457332611084
local_output_nid generation:  0.018449068069458008
local_in_edges_tensor generation:  0.020564794540405273
mini_batch_src_global generation:  0.046988725662231445
r_  generation:  0.3812999725341797
----------------------check_connections_block total spend ----------------------------- 4.385988235473633
generate_one_block  0.4910733699798584
generate_one_block  0.49252796173095703
generate_one_block  0.48546338081359863
generate_one_block  0.49155187606811523
generate_one_block  0.4973607063293457
generate_one_block  0.4971609115600586
generate_one_block  0.5007219314575195
generate_one_block  0.5242538452148438
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05210423469543457
gen group dst list time:  0.03900957107543945
time for parepare:  0.021521806716918945
local_output_nid generation:  0.0272061824798584
local_in_edges_tensor generation:  0.04377031326293945
mini_batch_src_global generation:  0.04605698585510254
r_  generation:  0.4886612892150879
local_output_nid generation:  0.033206939697265625
local_in_edges_tensor generation:  0.03660273551940918
mini_batch_src_global generation:  0.05518054962158203
r_  generation:  0.49011826515197754
local_output_nid generation:  0.033991098403930664
local_in_edges_tensor generation:  0.03443312644958496
mini_batch_src_global generation:  0.05497574806213379
r_  generation:  0.499481201171875
local_output_nid generation:  0.0346980094909668
local_in_edges_tensor generation:  0.03464531898498535
mini_batch_src_global generation:  0.05329728126525879
r_  generation:  0.4987185001373291
local_output_nid generation:  0.03471112251281738
local_in_edges_tensor generation:  0.039081573486328125
mini_batch_src_global generation:  0.05343437194824219
r_  generation:  0.49901652336120605
local_output_nid generation:  0.03475189208984375
local_in_edges_tensor generation:  0.033129215240478516
mini_batch_src_global generation:  0.054497718811035156
r_  generation:  0.5030312538146973
local_output_nid generation:  0.03514862060546875
local_in_edges_tensor generation:  0.033333778381347656
mini_batch_src_global generation:  0.05469822883605957
r_  generation:  0.5010805130004883
local_output_nid generation:  0.03510165214538574
local_in_edges_tensor generation:  0.04106879234313965
mini_batch_src_global generation:  0.05452775955200195
r_  generation:  0.5041093826293945
----------------------check_connections_block total spend ----------------------------- 5.885117053985596
generate_one_block  0.6208710670471191
generate_one_block  0.6246206760406494
generate_one_block  0.610898494720459
generate_one_block  0.6181392669677734
generate_one_block  0.630176305770874
generate_one_block  0.6113467216491699
generate_one_block  0.6248843669891357
generate_one_block  0.635786771774292
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1371469497680664  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

connection checking time:  10.271105289459229
block generation total time  8.95683765411377
average batch blocks generation time:  1.1196047067642212
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10499954223632812  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9520049095153809  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10438156127929688  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9468965530395508  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10484695434570312  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9477987289428711  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10421180725097656  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9505939483642578  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10518646240234375  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9514784812927246  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10426855087280273  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9516973495483398  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1042027473449707  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9541449546813965  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10492753982543945  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9525432586669922  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08645999431610107 |0.014776229858398438 |0.0035249292850494385 |8.785724639892578e-05 |0.003768831491470337 |0.001390218734741211 |
----------------------------------------------------------pseudo_mini_loss sum 1.789189338684082
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  3055102
Number of first layer input nodes during this epoch:  1297920
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13834095001220703  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021808862686157227
range selection method range initialization spend 0.011984109878540039
time for parepare:  0.01794743537902832
local_output_nid generation:  0.002742767333984375
local_in_edges_tensor generation:  0.0051233768463134766
mini_batch_src_global generation:  0.0037050247192382812
r_  generation:  0.0426943302154541
local_output_nid generation:  0.0031707286834716797
local_in_edges_tensor generation:  0.0017328262329101562
mini_batch_src_global generation:  0.00471186637878418
r_  generation:  0.044136762619018555
local_output_nid generation:  0.0031566619873046875
local_in_edges_tensor generation:  0.0018296241760253906
mini_batch_src_global generation:  0.0032989978790283203
r_  generation:  0.04587912559509277
local_output_nid generation:  0.003248453140258789
local_in_edges_tensor generation:  0.0017540454864501953
mini_batch_src_global generation:  0.00432586669921875
r_  generation:  0.0554652214050293
local_output_nid generation:  0.0038907527923583984
local_in_edges_tensor generation:  0.0020918846130371094
mini_batch_src_global generation:  0.00403594970703125
r_  generation:  0.04989147186279297
local_output_nid generation:  0.003911256790161133
local_in_edges_tensor generation:  0.0021016597747802734
mini_batch_src_global generation:  0.0041255950927734375
r_  generation:  0.05229306221008301
local_output_nid generation:  0.0038721561431884766
local_in_edges_tensor generation:  0.002180814743041992
mini_batch_src_global generation:  0.004057407379150391
r_  generation:  0.05096006393432617
local_output_nid generation:  0.003892660140991211
local_in_edges_tensor generation:  0.0021262168884277344
mini_batch_src_global generation:  0.004415035247802734
r_  generation:  0.052103519439697266
----------------------check_connections_block total spend ----------------------------- 0.5988326072692871
generate_one_block  0.06741070747375488
generate_one_block  0.0596923828125
generate_one_block  0.06210184097290039
generate_one_block  0.061786651611328125
generate_one_block  0.06049680709838867
generate_one_block  0.061725616455078125
generate_one_block  0.06413006782531738
generate_one_block  0.062422752380371094
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03829622268676758
gen group dst list time:  0.017696380615234375
time for parepare:  0.01926112174987793
local_output_nid generation:  0.011327743530273438
local_in_edges_tensor generation:  0.025454282760620117
mini_batch_src_global generation:  0.035184383392333984
r_  generation:  0.35611391067504883
local_output_nid generation:  0.01740407943725586
local_in_edges_tensor generation:  0.018303394317626953
mini_batch_src_global generation:  0.044243812561035156
r_  generation:  0.36351656913757324
local_output_nid generation:  0.017966747283935547
local_in_edges_tensor generation:  0.021198511123657227
mini_batch_src_global generation:  0.04488635063171387
r_  generation:  0.3798539638519287
local_output_nid generation:  0.01865530014038086
local_in_edges_tensor generation:  0.021027326583862305
mini_batch_src_global generation:  0.045301198959350586
r_  generation:  0.3740508556365967
local_output_nid generation:  0.017957448959350586
local_in_edges_tensor generation:  0.021214008331298828
mini_batch_src_global generation:  0.04560494422912598
r_  generation:  0.37918591499328613
local_output_nid generation:  0.017792940139770508
local_in_edges_tensor generation:  0.019826412200927734
mini_batch_src_global generation:  0.049379825592041016
r_  generation:  0.3810718059539795
local_output_nid generation:  0.017813444137573242
local_in_edges_tensor generation:  0.021819353103637695
mini_batch_src_global generation:  0.04653286933898926
r_  generation:  0.3773634433746338
local_output_nid generation:  0.018372774124145508
local_in_edges_tensor generation:  0.02127814292907715
mini_batch_src_global generation:  0.04764413833618164
r_  generation:  0.3855893611907959
----------------------check_connections_block total spend ----------------------------- 4.312918186187744
generate_one_block  0.4852726459503174
generate_one_block  0.4758872985839844
generate_one_block  0.48897886276245117
generate_one_block  0.47986721992492676
generate_one_block  0.4776473045349121
generate_one_block  0.4921402931213379
generate_one_block  0.483928918838501
generate_one_block  0.5222434997558594
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029616117477416992
gen group dst list time:  0.03874850273132324
time for parepare:  0.01841449737548828
local_output_nid generation:  0.026070117950439453
local_in_edges_tensor generation:  0.038027286529541016
mini_batch_src_global generation:  0.04388761520385742
r_  generation:  0.4773087501525879
local_output_nid generation:  0.034247398376464844
local_in_edges_tensor generation:  0.034972190856933594
mini_batch_src_global generation:  0.0564579963684082
r_  generation:  0.48534679412841797
local_output_nid generation:  0.03341054916381836
local_in_edges_tensor generation:  0.03347444534301758
mini_batch_src_global generation:  0.054785728454589844
r_  generation:  0.4872729778289795
local_output_nid generation:  0.03399014472961426
local_in_edges_tensor generation:  0.034820556640625
mini_batch_src_global generation:  0.05287647247314453
r_  generation:  0.49320268630981445
local_output_nid generation:  0.03397870063781738
local_in_edges_tensor generation:  0.031205177307128906
mini_batch_src_global generation:  0.055605411529541016
r_  generation:  0.492448091506958
local_output_nid generation:  0.03497147560119629
local_in_edges_tensor generation:  0.03472638130187988
mini_batch_src_global generation:  0.05406689643859863
r_  generation:  0.49916839599609375
local_output_nid generation:  0.033780574798583984
local_in_edges_tensor generation:  0.030998706817626953
mini_batch_src_global generation:  0.05398964881896973
r_  generation:  0.4972095489501953
local_output_nid generation:  0.03413558006286621
local_in_edges_tensor generation:  0.03166532516479492
mini_batch_src_global generation:  0.05423903465270996
r_  generation:  0.5012433528900146
----------------------check_connections_block total spend ----------------------------- 5.795003652572632
generate_one_block  0.6140618324279785
generate_one_block  0.6043236255645752
generate_one_block  0.619361162185669
generate_one_block  0.6132416725158691
generate_one_block  0.6066367626190186
generate_one_block  0.6102437973022461
generate_one_block  0.6125950813293457
generate_one_block  0.6243715286254883
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13834095001220703  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

connection checking time:  10.107921838760376
block generation total time  8.81080150604248
average batch blocks generation time:  1.10135018825531
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10417413711547852  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.947868824005127  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10473918914794922  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9466886520385742  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10433340072631836  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.953125  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10413408279418945  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9525928497314453  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10515117645263672  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9511528015136719  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10501575469970703  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9514679908752441  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10393428802490234  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9508543014526367  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10550880432128906  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9594120979309082  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08049318194389343 |0.015986859798431396 |0.003407031297683716 |8.96155834197998e-05 |0.0034246444702148438 |0.001402139663696289 |
----------------------------------------------------------pseudo_mini_loss sum 1.6974701881408691
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  3055347
Number of first layer input nodes during this epoch:  1297802
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1394948959350586  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020897626876831055
range selection method range initialization spend 0.01201772689819336
time for parepare:  0.01629352569580078
local_output_nid generation:  0.0026924610137939453
local_in_edges_tensor generation:  0.0040438175201416016
mini_batch_src_global generation:  0.003683328628540039
r_  generation:  0.04040980339050293
local_output_nid generation:  0.0032050609588623047
local_in_edges_tensor generation:  0.0017800331115722656
mini_batch_src_global generation:  0.005014181137084961
r_  generation:  0.04395890235900879
local_output_nid generation:  0.003172159194946289
local_in_edges_tensor generation:  0.0018205642700195312
mini_batch_src_global generation:  0.003265380859375
r_  generation:  0.04572129249572754
local_output_nid generation:  0.0034329891204833984
local_in_edges_tensor generation:  0.0019702911376953125
mini_batch_src_global generation:  0.0033719539642333984
r_  generation:  0.04604339599609375
local_output_nid generation:  0.003442049026489258
local_in_edges_tensor generation:  0.0018336772918701172
mini_batch_src_global generation:  0.003437042236328125
r_  generation:  0.0477452278137207
local_output_nid generation:  0.003442525863647461
local_in_edges_tensor generation:  0.002056598663330078
mini_batch_src_global generation:  0.0036966800689697266
r_  generation:  0.04761195182800293
local_output_nid generation:  0.003458261489868164
local_in_edges_tensor generation:  0.0018656253814697266
mini_batch_src_global generation:  0.0036437511444091797
r_  generation:  0.04680442810058594
local_output_nid generation:  0.0034942626953125
local_in_edges_tensor generation:  0.0019795894622802734
mini_batch_src_global generation:  0.0038213729858398438
r_  generation:  0.048069000244140625
----------------------check_connections_block total spend ----------------------------- 0.5397100448608398
generate_one_block  0.05917477607727051
generate_one_block  0.061125993728637695
generate_one_block  0.06127667427062988
generate_one_block  0.060622453689575195
generate_one_block  0.06105756759643555
generate_one_block  0.06154489517211914
generate_one_block  0.06376290321350098
generate_one_block  0.06207561492919922
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03921103477478027
gen group dst list time:  0.015683889389038086
time for parepare:  0.018845319747924805
local_output_nid generation:  0.011204242706298828
local_in_edges_tensor generation:  0.03758978843688965
mini_batch_src_global generation:  0.036573171615600586
r_  generation:  0.3545265197753906
local_output_nid generation:  0.017179489135742188
local_in_edges_tensor generation:  0.024694442749023438
mini_batch_src_global generation:  0.044557809829711914
r_  generation:  0.36710262298583984
local_output_nid generation:  0.01829051971435547
local_in_edges_tensor generation:  0.02039480209350586
mini_batch_src_global generation:  0.044051408767700195
r_  generation:  0.3720724582672119
local_output_nid generation:  0.018167972564697266
local_in_edges_tensor generation:  0.02058696746826172
mini_batch_src_global generation:  0.044841766357421875
r_  generation:  0.37229228019714355
local_output_nid generation:  0.01828289031982422
local_in_edges_tensor generation:  0.021077871322631836
mini_batch_src_global generation:  0.04568123817443848
r_  generation:  0.37723398208618164
local_output_nid generation:  0.017985820770263672
local_in_edges_tensor generation:  0.021474838256835938
mini_batch_src_global generation:  0.04905366897583008
r_  generation:  0.3780977725982666
local_output_nid generation:  0.018017292022705078
local_in_edges_tensor generation:  0.021380901336669922
mini_batch_src_global generation:  0.04565262794494629
r_  generation:  0.3765676021575928
local_output_nid generation:  0.018250703811645508
local_in_edges_tensor generation:  0.01980137825012207
mini_batch_src_global generation:  0.04681110382080078
r_  generation:  0.3801102638244629
----------------------check_connections_block total spend ----------------------------- 4.304825067520142
generate_one_block  0.4894747734069824
generate_one_block  0.4808928966522217
generate_one_block  0.4843738079071045
generate_one_block  0.4803330898284912
generate_one_block  0.48650097846984863
generate_one_block  0.4882235527038574
generate_one_block  0.48761940002441406
generate_one_block  0.5149319171905518
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029633045196533203
gen group dst list time:  0.03754091262817383
time for parepare:  0.01802515983581543
local_output_nid generation:  0.02564549446105957
local_in_edges_tensor generation:  0.036011457443237305
mini_batch_src_global generation:  0.047632455825805664
r_  generation:  0.47240352630615234
local_output_nid generation:  0.03264737129211426
local_in_edges_tensor generation:  0.037839412689208984
mini_batch_src_global generation:  0.05369877815246582
r_  generation:  0.47942066192626953
local_output_nid generation:  0.033220529556274414
local_in_edges_tensor generation:  0.033400535583496094
mini_batch_src_global generation:  0.05465245246887207
r_  generation:  0.479736328125
local_output_nid generation:  0.03624248504638672
local_in_edges_tensor generation:  0.030205726623535156
mini_batch_src_global generation:  0.052062273025512695
r_  generation:  0.4841604232788086
local_output_nid generation:  0.03393888473510742
local_in_edges_tensor generation:  0.03321433067321777
mini_batch_src_global generation:  0.05374884605407715
r_  generation:  0.4881730079650879
local_output_nid generation:  0.03448963165283203
local_in_edges_tensor generation:  0.031458139419555664
mini_batch_src_global generation:  0.0532987117767334
r_  generation:  0.4899895191192627
local_output_nid generation:  0.03413057327270508
local_in_edges_tensor generation:  0.03162431716918945
mini_batch_src_global generation:  0.05361056327819824
r_  generation:  0.4953896999359131
local_output_nid generation:  0.0340733528137207
local_in_edges_tensor generation:  0.030809879302978516
mini_batch_src_global generation:  0.05334210395812988
r_  generation:  0.5003743171691895
----------------------check_connections_block total spend ----------------------------- 5.724349498748779
generate_one_block  0.6090977191925049
generate_one_block  0.616351842880249
generate_one_block  0.6115446090698242
generate_one_block  0.6123268604278564
generate_one_block  0.6165430545806885
generate_one_block  0.6130037307739258
generate_one_block  0.6225903034210205
generate_one_block  0.6132688522338867
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1394948959350586  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

connection checking time:  10.029174566268921
block generation total time  8.827077388763428
average batch blocks generation time:  1.1033846735954285
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10397529602050781  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9502177238464355  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10519838333129883  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9470052719116211  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10415887832641602  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9502978324890137  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1051797866821289  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9515089988708496  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10435152053833008  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9519295692443848  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10529708862304688  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9525103569030762  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10422897338867188  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9516444206237793  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10525321960449219  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9530506134033203  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08572697639465332 |0.012582153081893921 |0.0035228431224823 |8.931756019592285e-05 |0.003830462694168091 |0.0029764175415039062 |
----------------------------------------------------------pseudo_mini_loss sum 1.631229043006897
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  3055039
Number of first layer input nodes during this epoch:  1297426
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13832378387451172  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021967411041259766
range selection method range initialization spend 0.012087106704711914
time for parepare:  0.018320322036743164
local_output_nid generation:  0.002789020538330078
local_in_edges_tensor generation:  0.00825357437133789
mini_batch_src_global generation:  0.0037949085235595703
r_  generation:  0.04251384735107422
local_output_nid generation:  0.0031495094299316406
local_in_edges_tensor generation:  0.0019154548645019531
mini_batch_src_global generation:  0.0053558349609375
r_  generation:  0.044812679290771484
local_output_nid generation:  0.003231525421142578
local_in_edges_tensor generation:  0.001790761947631836
mini_batch_src_global generation:  0.0033838748931884766
r_  generation:  0.044530391693115234
local_output_nid generation:  0.003152608871459961
local_in_edges_tensor generation:  0.0018117427825927734
mini_batch_src_global generation:  0.003415346145629883
r_  generation:  0.045070648193359375
local_output_nid generation:  0.003131389617919922
local_in_edges_tensor generation:  0.0020401477813720703
mini_batch_src_global generation:  0.0036215782165527344
r_  generation:  0.04686260223388672
local_output_nid generation:  0.0031549930572509766
local_in_edges_tensor generation:  0.0022149085998535156
mini_batch_src_global generation:  0.0037419795989990234
r_  generation:  0.047685861587524414
local_output_nid generation:  0.0032625198364257812
local_in_edges_tensor generation:  0.0021555423736572266
mini_batch_src_global generation:  0.00392460823059082
r_  generation:  0.048248291015625
local_output_nid generation:  0.0032088756561279297
local_in_edges_tensor generation:  0.0021581649780273438
mini_batch_src_global generation:  0.0038988590240478516
r_  generation:  0.04700422286987305
----------------------check_connections_block total spend ----------------------------- 0.5483870506286621
generate_one_block  0.06005740165710449
generate_one_block  0.06136202812194824
generate_one_block  0.0605311393737793
generate_one_block  0.060190677642822266
generate_one_block  0.0612940788269043
generate_one_block  0.06209516525268555
generate_one_block  0.06469988822937012
generate_one_block  0.060714006423950195
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04096055030822754
gen group dst list time:  0.015648365020751953
time for parepare:  0.020346403121948242
local_output_nid generation:  0.011438846588134766
local_in_edges_tensor generation:  0.03580307960510254
mini_batch_src_global generation:  0.042144060134887695
r_  generation:  0.3720724582672119
local_output_nid generation:  0.020183324813842773
local_in_edges_tensor generation:  0.025542020797729492
mini_batch_src_global generation:  0.04455399513244629
r_  generation:  0.3696613311767578
local_output_nid generation:  0.019205331802368164
local_in_edges_tensor generation:  0.020457029342651367
mini_batch_src_global generation:  0.044043779373168945
r_  generation:  0.3782210350036621
local_output_nid generation:  0.018985986709594727
local_in_edges_tensor generation:  0.02026963233947754
mini_batch_src_global generation:  0.04398798942565918
r_  generation:  0.36585307121276855
local_output_nid generation:  0.019262313842773438
local_in_edges_tensor generation:  0.021148681640625
mini_batch_src_global generation:  0.04513096809387207
r_  generation:  0.37934017181396484
local_output_nid generation:  0.018903017044067383
local_in_edges_tensor generation:  0.021591901779174805
mini_batch_src_global generation:  0.04608416557312012
r_  generation:  0.3812117576599121
local_output_nid generation:  0.01880669593811035
local_in_edges_tensor generation:  0.0230557918548584
mini_batch_src_global generation:  0.04798698425292969
r_  generation:  0.3808615207672119
local_output_nid generation:  0.018555164337158203
local_in_edges_tensor generation:  0.01959371566772461
mini_batch_src_global generation:  0.045412540435791016
r_  generation:  0.3739936351776123
----------------------check_connections_block total spend ----------------------------- 4.343852519989014
generate_one_block  0.48400211334228516
generate_one_block  0.49115562438964844
generate_one_block  0.4911069869995117
generate_one_block  0.479229211807251
generate_one_block  0.48906850814819336
generate_one_block  0.49185657501220703
generate_one_block  0.49021434783935547
generate_one_block  0.5028483867645264
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02991485595703125
gen group dst list time:  0.037962913513183594
time for parepare:  0.018424510955810547
local_output_nid generation:  0.025582313537597656
local_in_edges_tensor generation:  0.04256629943847656
mini_batch_src_global generation:  0.044152021408081055
r_  generation:  0.4742465019226074
local_output_nid generation:  0.03243136405944824
local_in_edges_tensor generation:  0.040612220764160156
mini_batch_src_global generation:  0.05543088912963867
r_  generation:  0.489457368850708
local_output_nid generation:  0.03320431709289551
local_in_edges_tensor generation:  0.03467202186584473
mini_batch_src_global generation:  0.05606245994567871
r_  generation:  0.48615121841430664
local_output_nid generation:  0.033403873443603516
local_in_edges_tensor generation:  0.03259873390197754
mini_batch_src_global generation:  0.05249309539794922
r_  generation:  0.4900991916656494
local_output_nid generation:  0.03357529640197754
local_in_edges_tensor generation:  0.03504538536071777
mini_batch_src_global generation:  0.05466294288635254
r_  generation:  0.4929778575897217
local_output_nid generation:  0.03453230857849121
local_in_edges_tensor generation:  0.035645246505737305
mini_batch_src_global generation:  0.05476069450378418
r_  generation:  0.49541640281677246
local_output_nid generation:  0.03410601615905762
local_in_edges_tensor generation:  0.03311634063720703
mini_batch_src_global generation:  0.056723833084106445
r_  generation:  0.4999728202819824
local_output_nid generation:  0.03413558006286621
local_in_edges_tensor generation:  0.03316521644592285
mini_batch_src_global generation:  0.0544435977935791
r_  generation:  0.49771809577941895
----------------------check_connections_block total spend ----------------------------- 5.795732021331787
generate_one_block  0.6068542003631592
generate_one_block  0.6094636917114258
generate_one_block  0.6082711219787598
generate_one_block  0.6119585037231445
generate_one_block  0.6188361644744873
generate_one_block  0.6156668663024902
generate_one_block  0.621375560760498
generate_one_block  0.6130626201629639
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13832378387451172  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

connection checking time:  10.1395845413208
block generation total time  8.824970483779907
average batch blocks generation time:  1.1031213104724884
block dataloader generation time/epoch 20.95248770713806
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10411691665649414  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9500350952148438  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10524606704711914  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9536919593811035  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10421276092529297  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9490189552307129  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10503101348876953  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9464154243469238  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1047220230102539  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9514017105102539  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10507678985595703  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9516110420227051  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10431718826293945  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9537506103515625  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10508346557617188  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9496026039123535  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08626893162727356 |0.012737929821014404 |0.0035249292850494385 |8.872151374816895e-05 |0.003827422857284546 |0.002930164337158203 |
----------------------------------------------------------pseudo_mini_loss sum 1.5905455350875854
Total (block generation + training)time/epoch 21.8779399394989
Training time/epoch 0.9251697063446045
Training time without block to device /epoch 0.8232662677764893
Training time without total dataloading part /epoch 0.06245875358581543
load block tensor time/epoch 0.6901514530181885
block to device time/epoch 0.10190343856811523
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  3055047
Number of first layer input nodes during this epoch:  1297876
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1388111114501953  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022187232971191406
range selection method range initialization spend 0.012239933013916016
time for parepare:  0.016518115997314453
local_output_nid generation:  0.002883434295654297
local_in_edges_tensor generation:  0.0048885345458984375
mini_batch_src_global generation:  0.0038373470306396484
r_  generation:  0.04221844673156738
local_output_nid generation:  0.0032999515533447266
local_in_edges_tensor generation:  0.0020012855529785156
mini_batch_src_global generation:  0.005024909973144531
r_  generation:  0.04537510871887207
local_output_nid generation:  0.0032606124877929688
local_in_edges_tensor generation:  0.001840829849243164
mini_batch_src_global generation:  0.003275632858276367
r_  generation:  0.04535055160522461
local_output_nid generation:  0.0032978057861328125
local_in_edges_tensor generation:  0.0018491744995117188
mini_batch_src_global generation:  0.003357410430908203
r_  generation:  0.045886993408203125
local_output_nid generation:  0.003210783004760742
local_in_edges_tensor generation:  0.0017948150634765625
mini_batch_src_global generation:  0.0036554336547851562
r_  generation:  0.04705929756164551
local_output_nid generation:  0.003164529800415039
local_in_edges_tensor generation:  0.0018146038055419922
mini_batch_src_global generation:  0.0038192272186279297
r_  generation:  0.046835899353027344
local_output_nid generation:  0.0032324790954589844
local_in_edges_tensor generation:  0.001795053482055664
mini_batch_src_global generation:  0.0036618709564208984
r_  generation:  0.04743218421936035
local_output_nid generation:  0.0032258033752441406
local_in_edges_tensor generation:  0.002187013626098633
mini_batch_src_global generation:  0.003706693649291992
r_  generation:  0.0478973388671875
----------------------check_connections_block total spend ----------------------------- 0.5403189659118652
generate_one_block  0.06013202667236328
generate_one_block  0.06162261962890625
generate_one_block  0.06332039833068848
generate_one_block  0.06295490264892578
generate_one_block  0.06374478340148926
generate_one_block  0.06310200691223145
generate_one_block  0.06357502937316895
generate_one_block  0.06160235404968262
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04129433631896973
gen group dst list time:  0.015573740005493164
time for parepare:  0.021322965621948242
local_output_nid generation:  0.011284112930297852
local_in_edges_tensor generation:  0.030576705932617188
mini_batch_src_global generation:  0.03692150115966797
r_  generation:  0.35500621795654297
local_output_nid generation:  0.017647743225097656
local_in_edges_tensor generation:  0.02332019805908203
mini_batch_src_global generation:  0.044541120529174805
r_  generation:  0.3684718608856201
local_output_nid generation:  0.01831340789794922
local_in_edges_tensor generation:  0.020821332931518555
mini_batch_src_global generation:  0.04378676414489746
r_  generation:  0.3765711784362793
local_output_nid generation:  0.018125057220458984
local_in_edges_tensor generation:  0.02185821533203125
mini_batch_src_global generation:  0.04473519325256348
r_  generation:  0.3714921474456787
local_output_nid generation:  0.0191042423248291
local_in_edges_tensor generation:  0.021187305450439453
mini_batch_src_global generation:  0.047873497009277344
r_  generation:  0.38124942779541016
local_output_nid generation:  0.017845630645751953
local_in_edges_tensor generation:  0.019749164581298828
mini_batch_src_global generation:  0.04603433609008789
r_  generation:  0.38114023208618164
local_output_nid generation:  0.018204689025878906
local_in_edges_tensor generation:  0.0214998722076416
mini_batch_src_global generation:  0.04579925537109375
r_  generation:  0.37373828887939453
local_output_nid generation:  0.01811814308166504
local_in_edges_tensor generation:  0.019447803497314453
mini_batch_src_global generation:  0.048078060150146484
r_  generation:  0.3770902156829834
----------------------check_connections_block total spend ----------------------------- 4.311707258224487
generate_one_block  0.48422670364379883
generate_one_block  0.491607666015625
generate_one_block  0.4859952926635742
generate_one_block  0.4836766719818115
generate_one_block  0.4891622066497803
generate_one_block  0.48590540885925293
generate_one_block  0.47867250442504883
generate_one_block  0.5138256549835205
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03150773048400879
gen group dst list time:  0.03841567039489746
time for parepare:  0.017930269241333008
local_output_nid generation:  0.025979995727539062
local_in_edges_tensor generation:  0.03795933723449707
mini_batch_src_global generation:  0.04369926452636719
r_  generation:  0.4755709171295166
local_output_nid generation:  0.0328526496887207
local_in_edges_tensor generation:  0.03536701202392578
mini_batch_src_global generation:  0.054077863693237305
r_  generation:  0.4795858860015869
local_output_nid generation:  0.03335094451904297
local_in_edges_tensor generation:  0.03424715995788574
mini_batch_src_global generation:  0.05375385284423828
r_  generation:  0.4799344539642334
local_output_nid generation:  0.03373908996582031
local_in_edges_tensor generation:  0.03718137741088867
mini_batch_src_global generation:  0.051874637603759766
r_  generation:  0.4933745861053467
local_output_nid generation:  0.03496599197387695
local_in_edges_tensor generation:  0.035251617431640625
mini_batch_src_global generation:  0.05515623092651367
r_  generation:  0.4870278835296631
local_output_nid generation:  0.03453850746154785
local_in_edges_tensor generation:  0.037517547607421875
mini_batch_src_global generation:  0.053346872329711914
r_  generation:  0.4913935661315918
local_output_nid generation:  0.034255266189575195
local_in_edges_tensor generation:  0.03492093086242676
mini_batch_src_global generation:  0.05392336845397949
r_  generation:  0.5101947784423828
local_output_nid generation:  0.03471660614013672
local_in_edges_tensor generation:  0.03466629981994629
mini_batch_src_global generation:  0.05478310585021973
r_  generation:  0.5025339126586914
----------------------check_connections_block total spend ----------------------------- 5.782195091247559
generate_one_block  0.6107168197631836
generate_one_block  0.608762264251709
generate_one_block  0.6123201847076416
generate_one_block  0.6161859035491943
generate_one_block  0.6216399669647217
generate_one_block  0.6106123924255371
generate_one_block  0.6120569705963135
generate_one_block  0.6106069087982178
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1388111114501953  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

connection checking time:  10.093902349472046
block generation total time  8.81597352027893
average batch blocks generation time:  1.1019966900348663
block dataloader generation time/epoch 20.933982968330383
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10574483871459961  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9519386291503906  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10408163070678711  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9489402770996094  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10494136810302734  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9484829902648926  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10435056686401367  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9495992660522461  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.105621337890625  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.953974723815918  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10361194610595703  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9485955238342285  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10507488250732422  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9488029479980469  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1046609878540039  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9509844779968262  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08584484457969666 |0.014275878667831421 |0.003512829542160034 |8.895993232727051e-05 |0.003721177577972412 |0.0017337799072265625 |
----------------------------------------------------------pseudo_mini_loss sum 1.5503555536270142
Total (block generation + training)time/epoch 21.86687660217285
Training time/epoch 0.9401462078094482
Training time without block to device /epoch 0.8259391784667969
Training time without total dataloading part /epoch 0.0603175163269043
load block tensor time/epoch 0.6867587566375732
block to device time/epoch 0.11420702934265137
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  3053075
Number of first layer input nodes during this epoch:  1297272
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1378469467163086  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02178335189819336
range selection method range initialization spend 0.012090206146240234
time for parepare:  0.01548910140991211
local_output_nid generation:  0.0027616024017333984
local_in_edges_tensor generation:  0.007756710052490234
mini_batch_src_global generation:  0.003765106201171875
r_  generation:  0.04304909706115723
local_output_nid generation:  0.003124237060546875
local_in_edges_tensor generation:  0.0017337799072265625
mini_batch_src_global generation:  0.004866600036621094
r_  generation:  0.045166969299316406
local_output_nid generation:  0.0031952857971191406
local_in_edges_tensor generation:  0.001725912094116211
mini_batch_src_global generation:  0.003319978713989258
r_  generation:  0.04519939422607422
local_output_nid generation:  0.0031859874725341797
local_in_edges_tensor generation:  0.0017437934875488281
mini_batch_src_global generation:  0.003327608108520508
r_  generation:  0.046525001525878906
local_output_nid generation:  0.00313568115234375
local_in_edges_tensor generation:  0.0017223358154296875
mini_batch_src_global generation:  0.0035400390625
r_  generation:  0.0469059944152832
local_output_nid generation:  0.0031943321228027344
local_in_edges_tensor generation:  0.001760244369506836
mini_batch_src_global generation:  0.003553152084350586
r_  generation:  0.047046661376953125
local_output_nid generation:  0.0032110214233398438
local_in_edges_tensor generation:  0.001836538314819336
mini_batch_src_global generation:  0.003698587417602539
r_  generation:  0.04787254333496094
local_output_nid generation:  0.0032401084899902344
local_in_edges_tensor generation:  0.0017843246459960938
mini_batch_src_global generation:  0.003683805465698242
r_  generation:  0.0476076602935791
----------------------check_connections_block total spend ----------------------------- 0.5399782657623291
generate_one_block  0.06339502334594727
generate_one_block  0.06134438514709473
generate_one_block  0.05963468551635742
generate_one_block  0.060709476470947266
generate_one_block  0.06051969528198242
generate_one_block  0.06006741523742676
generate_one_block  0.06348419189453125
generate_one_block  0.06109285354614258
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.035170555114746094
gen group dst list time:  0.01525568962097168
time for parepare:  0.019406557083129883
local_output_nid generation:  0.011312007904052734
local_in_edges_tensor generation:  0.034900665283203125
mini_batch_src_global generation:  0.0364534854888916
r_  generation:  0.3613741397857666
local_output_nid generation:  0.0176999568939209
local_in_edges_tensor generation:  0.022174358367919922
mini_batch_src_global generation:  0.0476987361907959
r_  generation:  0.3783080577850342
local_output_nid generation:  0.01765298843383789
local_in_edges_tensor generation:  0.025995969772338867
mini_batch_src_global generation:  0.048325538635253906
r_  generation:  0.368053674697876
local_output_nid generation:  0.018460512161254883
local_in_edges_tensor generation:  0.02633523941040039
mini_batch_src_global generation:  0.0442662239074707
r_  generation:  0.37355828285217285
local_output_nid generation:  0.018931150436401367
local_in_edges_tensor generation:  0.021579980850219727
mini_batch_src_global generation:  0.047370195388793945
r_  generation:  0.3741629123687744
local_output_nid generation:  0.018345355987548828
local_in_edges_tensor generation:  0.021027565002441406
mini_batch_src_global generation:  0.04562044143676758
r_  generation:  0.37855052947998047
local_output_nid generation:  0.018465280532836914
local_in_edges_tensor generation:  0.021404743194580078
mini_batch_src_global generation:  0.046007633209228516
r_  generation:  0.3779296875
local_output_nid generation:  0.0181882381439209
local_in_edges_tensor generation:  0.023273468017578125
mini_batch_src_global generation:  0.047756195068359375
r_  generation:  0.3791513442993164
----------------------check_connections_block total spend ----------------------------- 4.34737491607666
generate_one_block  0.4921703338623047
generate_one_block  0.49693918228149414
generate_one_block  0.4815635681152344
generate_one_block  0.48505640029907227
generate_one_block  0.4807322025299072
generate_one_block  0.4818875789642334
generate_one_block  0.491046667098999
generate_one_block  0.5111417770385742
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.033974647521972656
gen group dst list time:  0.03816103935241699
time for parepare:  0.019418954849243164
local_output_nid generation:  0.026078462600708008
local_in_edges_tensor generation:  0.045742034912109375
mini_batch_src_global generation:  0.04738116264343262
r_  generation:  0.4774007797241211
local_output_nid generation:  0.03245186805725098
local_in_edges_tensor generation:  0.04120755195617676
mini_batch_src_global generation:  0.05434060096740723
r_  generation:  0.48135972023010254
local_output_nid generation:  0.03298616409301758
local_in_edges_tensor generation:  0.033331871032714844
mini_batch_src_global generation:  0.05531740188598633
r_  generation:  0.48332691192626953
local_output_nid generation:  0.03459787368774414
local_in_edges_tensor generation:  0.03435111045837402
mini_batch_src_global generation:  0.052620887756347656
r_  generation:  0.48933959007263184
local_output_nid generation:  0.03432655334472656
local_in_edges_tensor generation:  0.03563046455383301
mini_batch_src_global generation:  0.053038597106933594
r_  generation:  0.49108409881591797
local_output_nid generation:  0.03393435478210449
local_in_edges_tensor generation:  0.037715911865234375
mini_batch_src_global generation:  0.05558013916015625
r_  generation:  0.49886083602905273
local_output_nid generation:  0.0339818000793457
local_in_edges_tensor generation:  0.03291749954223633
mini_batch_src_global generation:  0.05364274978637695
r_  generation:  0.4971456527709961
local_output_nid generation:  0.03412795066833496
local_in_edges_tensor generation:  0.03202223777770996
mini_batch_src_global generation:  0.053894996643066406
r_  generation:  0.4996771812438965
----------------------check_connections_block total spend ----------------------------- 5.789248943328857
generate_one_block  0.604834794998169
generate_one_block  0.6118612289428711
generate_one_block  0.6141705513000488
generate_one_block  0.610692024230957
generate_one_block  0.6113197803497314
generate_one_block  0.610748291015625
generate_one_block  0.6089136600494385
generate_one_block  0.6089193820953369
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1378469467163086  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

connection checking time:  10.136623859405518
block generation total time  8.801997423171997
average batch blocks generation time:  1.1002496778964996
block dataloader generation time/epoch 20.924563725789387
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10528373718261719  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9535365104675293  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1043701171875  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.958643913269043  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10479974746704102  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.949195384979248  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10438394546508789  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9498476982116699  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10523605346679688  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.948887825012207  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10407590866088867  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9546642303466797  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10535812377929688  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9506287574768066  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10463523864746094  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.948697566986084  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07925397157669067 |0.012956470251083374 |0.003527611494064331 |9.071826934814453e-05 |0.00976911187171936 |0.003068208694458008 |
----------------------------------------------------------pseudo_mini_loss sum 1.5157811641693115
Total (block generation + training)time/epoch 21.85357658068339
Training time/epoch 0.9209864139556885
Training time without block to device /epoch 0.8173346519470215
Training time without total dataloading part /epoch 0.1101677417755127
load block tensor time/epoch 0.6340317726135254
block to device time/epoch 0.10365176200866699
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  3055486
Number of first layer input nodes during this epoch:  1298073
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1373610496520996  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023068904876708984
range selection method range initialization spend 0.011979341506958008
time for parepare:  0.01601719856262207
local_output_nid generation:  0.0027124881744384766
local_in_edges_tensor generation:  0.00528407096862793
mini_batch_src_global generation:  0.0036301612854003906
r_  generation:  0.042037010192871094
local_output_nid generation:  0.0031201839447021484
local_in_edges_tensor generation:  0.0019376277923583984
mini_batch_src_global generation:  0.004814624786376953
r_  generation:  0.043973684310913086
local_output_nid generation:  0.0032126903533935547
local_in_edges_tensor generation:  0.0017893314361572266
mini_batch_src_global generation:  0.0033028125762939453
r_  generation:  0.04471635818481445
local_output_nid generation:  0.003196239471435547
local_in_edges_tensor generation:  0.0017895698547363281
mini_batch_src_global generation:  0.0034842491149902344
r_  generation:  0.046674251556396484
local_output_nid generation:  0.0031583309173583984
local_in_edges_tensor generation:  0.0018413066864013672
mini_batch_src_global generation:  0.0037796497344970703
r_  generation:  0.046904563903808594
local_output_nid generation:  0.0031969547271728516
local_in_edges_tensor generation:  0.0018284320831298828
mini_batch_src_global generation:  0.0037996768951416016
r_  generation:  0.0469059944152832
local_output_nid generation:  0.003156423568725586
local_in_edges_tensor generation:  0.0018143653869628906
mini_batch_src_global generation:  0.003909111022949219
r_  generation:  0.04748868942260742
local_output_nid generation:  0.0031898021697998047
local_in_edges_tensor generation:  0.0018048286437988281
mini_batch_src_global generation:  0.003832101821899414
r_  generation:  0.04730534553527832
----------------------check_connections_block total spend ----------------------------- 0.5350697040557861
generate_one_block  0.060039520263671875
generate_one_block  0.06018662452697754
generate_one_block  0.06011486053466797
generate_one_block  0.0616612434387207
generate_one_block  0.06261920928955078
generate_one_block  0.06199526786804199
generate_one_block  0.06456613540649414
generate_one_block  0.06255197525024414
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0345461368560791
gen group dst list time:  0.015923500061035156
time for parepare:  0.020972013473510742
local_output_nid generation:  0.011554479598999023
local_in_edges_tensor generation:  0.0258328914642334
mini_batch_src_global generation:  0.04063701629638672
r_  generation:  0.3548314571380615
local_output_nid generation:  0.01774740219116211
local_in_edges_tensor generation:  0.025350093841552734
mini_batch_src_global generation:  0.04692840576171875
r_  generation:  0.3667337894439697
local_output_nid generation:  0.018364429473876953
local_in_edges_tensor generation:  0.020303964614868164
mini_batch_src_global generation:  0.04392385482788086
r_  generation:  0.3713679313659668
local_output_nid generation:  0.018863677978515625
local_in_edges_tensor generation:  0.022625207901000977
mini_batch_src_global generation:  0.04850339889526367
r_  generation:  0.37897586822509766
local_output_nid generation:  0.01919078826904297
local_in_edges_tensor generation:  0.029479026794433594
mini_batch_src_global generation:  0.046337127685546875
r_  generation:  0.3839530944824219
local_output_nid generation:  0.01794719696044922
local_in_edges_tensor generation:  0.021165847778320312
mini_batch_src_global generation:  0.047560930252075195
r_  generation:  0.37563371658325195
local_output_nid generation:  0.018062353134155273
local_in_edges_tensor generation:  0.020012617111206055
mini_batch_src_global generation:  0.04690814018249512
r_  generation:  0.383009672164917
local_output_nid generation:  0.018224239349365234
local_in_edges_tensor generation:  0.020917415618896484
mini_batch_src_global generation:  0.04597306251525879
r_  generation:  0.3757181167602539
----------------------check_connections_block total spend ----------------------------- 4.332251787185669
generate_one_block  0.48554086685180664
generate_one_block  0.48283982276916504
generate_one_block  0.48059964179992676
generate_one_block  0.48690104484558105
generate_one_block  0.5028622150421143
generate_one_block  0.486053466796875
generate_one_block  0.4903583526611328
generate_one_block  0.509768009185791
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03033924102783203
gen group dst list time:  0.038796424865722656
time for parepare:  0.020050764083862305
local_output_nid generation:  0.026076555252075195
local_in_edges_tensor generation:  0.04297280311584473
mini_batch_src_global generation:  0.045584678649902344
r_  generation:  0.47603869438171387
local_output_nid generation:  0.03383445739746094
local_in_edges_tensor generation:  0.03661680221557617
mini_batch_src_global generation:  0.05459260940551758
r_  generation:  0.4819827079772949
local_output_nid generation:  0.03415560722351074
local_in_edges_tensor generation:  0.03346991539001465
mini_batch_src_global generation:  0.05466198921203613
r_  generation:  0.48644185066223145
local_output_nid generation:  0.03481626510620117
local_in_edges_tensor generation:  0.03279733657836914
mini_batch_src_global generation:  0.052992820739746094
r_  generation:  0.48991847038269043
local_output_nid generation:  0.034491777420043945
local_in_edges_tensor generation:  0.03758645057678223
mini_batch_src_global generation:  0.05343914031982422
r_  generation:  0.49018430709838867
local_output_nid generation:  0.033884286880493164
local_in_edges_tensor generation:  0.03409552574157715
mini_batch_src_global generation:  0.05322551727294922
r_  generation:  0.49062371253967285
local_output_nid generation:  0.03385043144226074
local_in_edges_tensor generation:  0.03454470634460449
mini_batch_src_global generation:  0.05377507209777832
r_  generation:  0.4942805767059326
local_output_nid generation:  0.03428387641906738
local_in_edges_tensor generation:  0.03538966178894043
mini_batch_src_global generation:  0.05684161186218262
r_  generation:  0.4924633502960205
----------------------check_connections_block total spend ----------------------------- 5.775007963180542
generate_one_block  0.6154706478118896
generate_one_block  0.610598087310791
generate_one_block  0.6103479862213135
generate_one_block  0.613269567489624
generate_one_block  0.6121494770050049
generate_one_block  0.6096467971801758
generate_one_block  0.6224651336669922
generate_one_block  0.6209707260131836
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1373610496520996  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

connection checking time:  10.107259750366211
block generation total time  8.839841842651367
average batch blocks generation time:  1.104980230331421
block dataloader generation time/epoch 20.91598069667816
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10480117797851562  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9482831954956055  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10419416427612305  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9518694877624512  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10497379302978516  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9471511840820312  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10418367385864258  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9511890411376953  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10512542724609375  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9514350891113281  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10406303405761719  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.94842529296875  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10503482818603516  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9519314765930176  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10416746139526367  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9510288238525391  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08141228556632996 |0.012846618890762329 |0.003424316644668579 |8.827447891235352e-05 |0.0031516551971435547 |0.0017611980438232422 |
----------------------------------------------------------pseudo_mini_loss sum 1.4802882671356201
Total (block generation + training)time/epoch 21.834985196590424
Training time/epoch 0.888709545135498
Training time without block to device /epoch 0.7859365940093994
Training time without total dataloading part /epoch 0.05507516860961914
load block tensor time/epoch 0.6512982845306396
block to device time/epoch 0.10277295112609863
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  3053200
Number of first layer input nodes during this epoch:  1297445
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13753509521484375  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019775390625
range selection method range initialization spend 0.012084722518920898
time for parepare:  0.01600503921508789
local_output_nid generation:  0.002814769744873047
local_in_edges_tensor generation:  0.004396915435791016
mini_batch_src_global generation:  0.0035903453826904297
r_  generation:  0.042077064514160156
local_output_nid generation:  0.0031147003173828125
local_in_edges_tensor generation:  0.0017740726470947266
mini_batch_src_global generation:  0.004738807678222656
r_  generation:  0.044152021408081055
local_output_nid generation:  0.003170490264892578
local_in_edges_tensor generation:  0.0017824172973632812
mini_batch_src_global generation:  0.0032927989959716797
r_  generation:  0.04578804969787598
local_output_nid generation:  0.003209829330444336
local_in_edges_tensor generation:  0.0018305778503417969
mini_batch_src_global generation:  0.0033195018768310547
r_  generation:  0.04578518867492676
local_output_nid generation:  0.003220081329345703
local_in_edges_tensor generation:  0.001817464828491211
mini_batch_src_global generation:  0.0036182403564453125
r_  generation:  0.04674530029296875
local_output_nid generation:  0.003201723098754883
local_in_edges_tensor generation:  0.001832723617553711
mini_batch_src_global generation:  0.00366973876953125
r_  generation:  0.04683995246887207
local_output_nid generation:  0.003284931182861328
local_in_edges_tensor generation:  0.0018305778503417969
mini_batch_src_global generation:  0.003681659698486328
r_  generation:  0.046373844146728516
local_output_nid generation:  0.003361225128173828
local_in_edges_tensor generation:  0.0017702579498291016
mini_batch_src_global generation:  0.0037755966186523438
r_  generation:  0.04769015312194824
----------------------check_connections_block total spend ----------------------------- 0.5324892997741699
generate_one_block  0.05919766426086426
generate_one_block  0.06053638458251953
generate_one_block  0.06103157997131348
generate_one_block  0.061228036880493164
generate_one_block  0.061171770095825195
generate_one_block  0.06094050407409668
generate_one_block  0.06309008598327637
generate_one_block  0.061873674392700195
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03374481201171875
gen group dst list time:  0.0156402587890625
time for parepare:  0.019090890884399414
local_output_nid generation:  0.011198043823242188
local_in_edges_tensor generation:  0.02773284912109375
mini_batch_src_global generation:  0.03709983825683594
r_  generation:  0.3561999797821045
local_output_nid generation:  0.017508745193481445
local_in_edges_tensor generation:  0.020043611526489258
mini_batch_src_global generation:  0.04413723945617676
r_  generation:  0.36799073219299316
local_output_nid generation:  0.018413782119750977
local_in_edges_tensor generation:  0.02026844024658203
mini_batch_src_global generation:  0.04409909248352051
r_  generation:  0.37344837188720703
local_output_nid generation:  0.018492937088012695
local_in_edges_tensor generation:  0.01975703239440918
mini_batch_src_global generation:  0.044533491134643555
r_  generation:  0.3726973533630371
local_output_nid generation:  0.018802404403686523
local_in_edges_tensor generation:  0.02089405059814453
mini_batch_src_global generation:  0.045549869537353516
r_  generation:  0.376023530960083
local_output_nid generation:  0.01793384552001953
local_in_edges_tensor generation:  0.019715309143066406
mini_batch_src_global generation:  0.04730677604675293
r_  generation:  0.3722267150878906
local_output_nid generation:  0.017598628997802734
local_in_edges_tensor generation:  0.01949906349182129
mini_batch_src_global generation:  0.04766201972961426
r_  generation:  0.37389469146728516
local_output_nid generation:  0.018059730529785156
local_in_edges_tensor generation:  0.020143985748291016
mini_batch_src_global generation:  0.0480198860168457
r_  generation:  0.3793034553527832
----------------------check_connections_block total spend ----------------------------- 4.281928777694702
generate_one_block  0.4814321994781494
generate_one_block  0.48737311363220215
generate_one_block  0.5013935565948486
generate_one_block  0.4825618267059326
generate_one_block  0.4932088851928711
generate_one_block  0.47759485244750977
generate_one_block  0.4828836917877197
generate_one_block  0.5198168754577637
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0271608829498291
gen group dst list time:  0.039122581481933594
time for parepare:  0.019205808639526367
local_output_nid generation:  0.02676105499267578
local_in_edges_tensor generation:  0.039192914962768555
mini_batch_src_global generation:  0.04396939277648926
r_  generation:  0.47489118576049805
local_output_nid generation:  0.03545022010803223
local_in_edges_tensor generation:  0.0346369743347168
mini_batch_src_global generation:  0.05468153953552246
r_  generation:  0.4812493324279785
local_output_nid generation:  0.036113739013671875
local_in_edges_tensor generation:  0.03296017646789551
mini_batch_src_global generation:  0.05478835105895996
r_  generation:  0.48615312576293945
local_output_nid generation:  0.036468505859375
local_in_edges_tensor generation:  0.0339353084564209
mini_batch_src_global generation:  0.05240035057067871
r_  generation:  0.4898405075073242
local_output_nid generation:  0.03645634651184082
local_in_edges_tensor generation:  0.031731605529785156
mini_batch_src_global generation:  0.05333089828491211
r_  generation:  0.49152445793151855
local_output_nid generation:  0.03690028190612793
local_in_edges_tensor generation:  0.03291058540344238
mini_batch_src_global generation:  0.05338454246520996
r_  generation:  0.4922151565551758
local_output_nid generation:  0.03708338737487793
local_in_edges_tensor generation:  0.03692436218261719
mini_batch_src_global generation:  0.053373098373413086
r_  generation:  0.4935016632080078
local_output_nid generation:  0.03702974319458008
local_in_edges_tensor generation:  0.03156304359436035
mini_batch_src_global generation:  0.05457592010498047
r_  generation:  0.4967684745788574
----------------------check_connections_block total spend ----------------------------- 5.771374464035034
generate_one_block  0.6046891212463379
generate_one_block  0.6105015277862549
generate_one_block  0.6051449775695801
generate_one_block  0.6065328121185303
generate_one_block  0.6061069965362549
generate_one_block  0.6122806072235107
generate_one_block  0.6124696731567383
generate_one_block  0.6129279136657715
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13753509521484375  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

connection checking time:  10.053303241729736
block generation total time  8.796918630599976
average batch blocks generation time:  1.099614828824997
block dataloader generation time/epoch 20.88854823112488
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10498332977294922  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9485797882080078  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10416173934936523  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.951136589050293  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10515117645263672  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9530673027038574  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10418844223022461  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.957089900970459  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10501337051391602  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9504604339599609  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10428857803344727  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9497585296630859  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10557365417480469  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9523568153381348  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10468196868896484  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9508395195007324  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08178672194480896 |0.017273396253585815 |0.003387957811355591 |8.374452590942383e-05 |0.003139019012451172 |0.001745462417602539 |
----------------------------------------------------------pseudo_mini_loss sum 1.4549713134765625
Total (block generation + training)time/epoch 21.808402967453002
Training time/epoch 0.923051118850708
Training time without block to device /epoch 0.7848639488220215
Training time without total dataloading part /epoch 0.05463123321533203
load block tensor time/epoch 0.6542937755584717
block to device time/epoch 0.13818717002868652
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  3055925
Number of first layer input nodes during this epoch:  1297674
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13747167587280273  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02653217315673828
range selection method range initialization spend 0.01179051399230957
time for parepare:  0.015739917755126953
local_output_nid generation:  0.002754688262939453
local_in_edges_tensor generation:  0.0049364566802978516
mini_batch_src_global generation:  0.0034456253051757812
r_  generation:  0.043007850646972656
local_output_nid generation:  0.0031075477600097656
local_in_edges_tensor generation:  0.001737833023071289
mini_batch_src_global generation:  0.0049631595611572266
r_  generation:  0.044455528259277344
local_output_nid generation:  0.0031435489654541016
local_in_edges_tensor generation:  0.0018115043640136719
mini_batch_src_global generation:  0.003382444381713867
r_  generation:  0.04422163963317871
local_output_nid generation:  0.003150463104248047
local_in_edges_tensor generation:  0.0019488334655761719
mini_batch_src_global generation:  0.003391742706298828
r_  generation:  0.04714250564575195
local_output_nid generation:  0.0032083988189697266
local_in_edges_tensor generation:  0.00177764892578125
mini_batch_src_global generation:  0.003697633743286133
r_  generation:  0.04751014709472656
local_output_nid generation:  0.0031414031982421875
local_in_edges_tensor generation:  0.0018074512481689453
mini_batch_src_global generation:  0.0037431716918945312
r_  generation:  0.04827713966369629
local_output_nid generation:  0.003245115280151367
local_in_edges_tensor generation:  0.0017976760864257812
mini_batch_src_global generation:  0.0039272308349609375
r_  generation:  0.04783034324645996
local_output_nid generation:  0.003173828125
local_in_edges_tensor generation:  0.0018432140350341797
mini_batch_src_global generation:  0.003777742385864258
r_  generation:  0.04783368110656738
----------------------check_connections_block total spend ----------------------------- 0.5381824970245361
generate_one_block  0.05828404426574707
generate_one_block  0.0597538948059082
generate_one_block  0.060375213623046875
generate_one_block  0.06096792221069336
generate_one_block  0.06228947639465332
generate_one_block  0.061745643615722656
generate_one_block  0.0651545524597168
generate_one_block  0.06139087677001953
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03432106971740723
gen group dst list time:  0.01632833480834961
time for parepare:  0.019021272659301758
local_output_nid generation:  0.011282205581665039
local_in_edges_tensor generation:  0.032503604888916016
mini_batch_src_global generation:  0.03766751289367676
r_  generation:  0.35497498512268066
local_output_nid generation:  0.017321109771728516
local_in_edges_tensor generation:  0.02191019058227539
mini_batch_src_global generation:  0.04425644874572754
r_  generation:  0.3690648078918457
local_output_nid generation:  0.01825118064880371
local_in_edges_tensor generation:  0.020738601684570312
mini_batch_src_global generation:  0.0455324649810791
r_  generation:  0.37076306343078613
local_output_nid generation:  0.018160343170166016
local_in_edges_tensor generation:  0.01905655860900879
mini_batch_src_global generation:  0.044936418533325195
r_  generation:  0.3773820400238037
local_output_nid generation:  0.01939868927001953
local_in_edges_tensor generation:  0.0238950252532959
mini_batch_src_global generation:  0.04724550247192383
r_  generation:  0.380659818649292
local_output_nid generation:  0.01903367042541504
local_in_edges_tensor generation:  0.01917743682861328
mini_batch_src_global generation:  0.04713106155395508
r_  generation:  0.3798527717590332
local_output_nid generation:  0.017891883850097656
local_in_edges_tensor generation:  0.01978468894958496
mini_batch_src_global generation:  0.048307180404663086
r_  generation:  0.37967562675476074
local_output_nid generation:  0.017809152603149414
local_in_edges_tensor generation:  0.020853281021118164
mini_batch_src_global generation:  0.046437978744506836
r_  generation:  0.3757760524749756
----------------------check_connections_block total spend ----------------------------- 4.3086206912994385
generate_one_block  0.4894101619720459
generate_one_block  0.486818790435791
generate_one_block  0.47716450691223145
generate_one_block  0.4940972328186035
generate_one_block  0.4913501739501953
generate_one_block  0.49122190475463867
generate_one_block  0.49030351638793945
generate_one_block  0.5062680244445801
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03437066078186035
gen group dst list time:  0.03859901428222656
time for parepare:  0.018378257751464844
local_output_nid generation:  0.02577376365661621
local_in_edges_tensor generation:  0.03756594657897949
mini_batch_src_global generation:  0.046009063720703125
r_  generation:  0.4720463752746582
local_output_nid generation:  0.032404422760009766
local_in_edges_tensor generation:  0.03499174118041992
mini_batch_src_global generation:  0.056825876235961914
r_  generation:  0.48087382316589355
local_output_nid generation:  0.033283233642578125
local_in_edges_tensor generation:  0.03206920623779297
mini_batch_src_global generation:  0.05427193641662598
r_  generation:  0.48688244819641113
local_output_nid generation:  0.033495426177978516
local_in_edges_tensor generation:  0.031186819076538086
mini_batch_src_global generation:  0.05179095268249512
r_  generation:  0.48513364791870117
local_output_nid generation:  0.03355598449707031
local_in_edges_tensor generation:  0.03554511070251465
mini_batch_src_global generation:  0.05307745933532715
r_  generation:  0.4950428009033203
local_output_nid generation:  0.03429698944091797
local_in_edges_tensor generation:  0.03406238555908203
mini_batch_src_global generation:  0.052843570709228516
r_  generation:  0.49456214904785156
local_output_nid generation:  0.03391003608703613
local_in_edges_tensor generation:  0.033640146255493164
mini_batch_src_global generation:  0.05362391471862793
r_  generation:  0.4936089515686035
local_output_nid generation:  0.034209489822387695
local_in_edges_tensor generation:  0.03173828125
mini_batch_src_global generation:  0.05448269844055176
r_  generation:  0.4988558292388916
----------------------check_connections_block total spend ----------------------------- 5.7567973136901855
generate_one_block  0.6030120849609375
generate_one_block  0.6119513511657715
generate_one_block  0.6058945655822754
generate_one_block  0.6078507900238037
generate_one_block  0.6079659461975098
generate_one_block  0.607266902923584
generate_one_block  0.6087582111358643
generate_one_block  0.6152241230010986
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13747167587280273  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

connection checking time:  10.065418004989624
block generation total time  8.79455828666687
average batch blocks generation time:  1.0993197858333588
block dataloader generation time/epoch 20.878092527389526
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10381126403808594  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9474482536315918  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10489082336425781  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9516658782958984  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10442447662353516  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9512882232666016  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10566043853759766  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9489870071411133  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10426759719848633  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9497966766357422  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1049642562866211  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9524240493774414  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.104217529296875  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9526991844177246  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10376930236816406  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9504284858703613  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0815175473690033 |0.015686720609664917 |0.0036481618881225586 |9.340047836303711e-05 |0.0036804676055908203 |0.003155231475830078 |
----------------------------------------------------------pseudo_mini_loss sum 1.4256139993667603
Total (block generation + training)time/epoch 21.796979506810505
Training time/epoch 0.9137444496154785
Training time without block to device /epoch 0.7882506847381592
Training time without total dataloading part /epoch 0.0625314712524414
load block tensor time/epoch 0.6521403789520264
block to device time/epoch 0.12549376487731934
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  3054479
Number of first layer input nodes during this epoch:  1297808
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13690996170043945  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0243985652923584
range selection method range initialization spend 0.012138843536376953
time for parepare:  0.01650261878967285
local_output_nid generation:  0.0027997493743896484
local_in_edges_tensor generation:  0.0049097537994384766
mini_batch_src_global generation:  0.003450155258178711
r_  generation:  0.04257655143737793
local_output_nid generation:  0.003155946731567383
local_in_edges_tensor generation:  0.0019066333770751953
mini_batch_src_global generation:  0.004959821701049805
r_  generation:  0.04471254348754883
local_output_nid generation:  0.0031626224517822266
local_in_edges_tensor generation:  0.0019023418426513672
mini_batch_src_global generation:  0.0035288333892822266
r_  generation:  0.04696536064147949
local_output_nid generation:  0.0032444000244140625
local_in_edges_tensor generation:  0.001786947250366211
mini_batch_src_global generation:  0.0035355091094970703
r_  generation:  0.04765725135803223
local_output_nid generation:  0.003153085708618164
local_in_edges_tensor generation:  0.0018467903137207031
mini_batch_src_global generation:  0.003915548324584961
r_  generation:  0.04840731620788574
local_output_nid generation:  0.003237485885620117
local_in_edges_tensor generation:  0.0018157958984375
mini_batch_src_global generation:  0.003779172897338867
r_  generation:  0.047124385833740234
local_output_nid generation:  0.0031585693359375
local_in_edges_tensor generation:  0.0018100738525390625
mini_batch_src_global generation:  0.003958702087402344
r_  generation:  0.05037641525268555
local_output_nid generation:  0.0031592845916748047
local_in_edges_tensor generation:  0.0018229484558105469
mini_batch_src_global generation:  0.003973960876464844
r_  generation:  0.05046844482421875
----------------------check_connections_block total spend ----------------------------- 0.550764799118042
generate_one_block  0.0593409538269043
generate_one_block  0.06361913681030273
generate_one_block  0.06144857406616211
generate_one_block  0.0627601146697998
generate_one_block  0.06471467018127441
generate_one_block  0.06122589111328125
generate_one_block  0.06690812110900879
generate_one_block  0.06897354125976562
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.09556174278259277
gen group dst list time:  0.01782989501953125
time for parepare:  0.021363496780395508
local_output_nid generation:  0.011749982833862305
local_in_edges_tensor generation:  0.029909372329711914
mini_batch_src_global generation:  0.04196977615356445
r_  generation:  0.35473084449768066
local_output_nid generation:  0.01777791976928711
local_in_edges_tensor generation:  0.025833606719970703
mini_batch_src_global generation:  0.0481874942779541
r_  generation:  0.37313151359558105
local_output_nid generation:  0.01880168914794922
local_in_edges_tensor generation:  0.028104305267333984
mini_batch_src_global generation:  0.04681658744812012
r_  generation:  0.3795166015625
local_output_nid generation:  0.02028822898864746
local_in_edges_tensor generation:  0.021297931671142578
mini_batch_src_global generation:  0.04539656639099121
r_  generation:  0.3813316822052002
local_output_nid generation:  0.019295930862426758
local_in_edges_tensor generation:  0.01921534538269043
mini_batch_src_global generation:  0.046512603759765625
r_  generation:  0.3829009532928467
local_output_nid generation:  0.01880669593811035
local_in_edges_tensor generation:  0.019335508346557617
mini_batch_src_global generation:  0.04622817039489746
r_  generation:  0.38046860694885254
local_output_nid generation:  0.018717288970947266
local_in_edges_tensor generation:  0.028940916061401367
mini_batch_src_global generation:  0.05064725875854492
r_  generation:  0.3871760368347168
local_output_nid generation:  0.01879405975341797
local_in_edges_tensor generation:  0.025894641876220703
mini_batch_src_global generation:  0.05121350288391113
r_  generation:  0.38782334327697754
----------------------check_connections_block total spend ----------------------------- 4.407217502593994
generate_one_block  0.5001635551452637
generate_one_block  0.5038878917694092
generate_one_block  0.4994685649871826
generate_one_block  0.5024776458740234
generate_one_block  0.5031628608703613
generate_one_block  0.4861180782318115
generate_one_block  0.5035622119903564
generate_one_block  0.5344219207763672
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03663301467895508
gen group dst list time:  0.03991556167602539
time for parepare:  0.018941640853881836
local_output_nid generation:  0.027316808700561523
local_in_edges_tensor generation:  0.05344080924987793
mini_batch_src_global generation:  0.05699348449707031
r_  generation:  0.49933552742004395
local_output_nid generation:  0.03316521644592285
local_in_edges_tensor generation:  0.04424452781677246
mini_batch_src_global generation:  0.05921769142150879
r_  generation:  0.5233228206634521
local_output_nid generation:  0.04147815704345703
local_in_edges_tensor generation:  0.03625059127807617
mini_batch_src_global generation:  0.0758213996887207
r_  generation:  0.5372524261474609
local_output_nid generation:  0.03585624694824219
local_in_edges_tensor generation:  0.040126800537109375
mini_batch_src_global generation:  0.059473514556884766
r_  generation:  0.5250976085662842
local_output_nid generation:  0.03628277778625488
local_in_edges_tensor generation:  0.03780817985534668
mini_batch_src_global generation:  0.06663799285888672
r_  generation:  0.5298690795898438
local_output_nid generation:  0.038019418716430664
local_in_edges_tensor generation:  0.04150748252868652
mini_batch_src_global generation:  0.059972524642944336
r_  generation:  0.5302848815917969
local_output_nid generation:  0.03693890571594238
local_in_edges_tensor generation:  0.03618288040161133
mini_batch_src_global generation:  0.05914926528930664
r_  generation:  0.5249450206756592
local_output_nid generation:  0.0363311767578125
local_in_edges_tensor generation:  0.03558206558227539
mini_batch_src_global generation:  0.05576348304748535
r_  generation:  0.5091381072998047
----------------------check_connections_block total spend ----------------------------- 6.301603317260742
generate_one_block  0.6294286251068115
generate_one_block  0.6278970241546631
generate_one_block  0.6303598880767822
generate_one_block  0.6491653919219971
generate_one_block  0.620037317276001
generate_one_block  0.6225545406341553
generate_one_block  0.6303920745849609
generate_one_block  0.6224822998046875
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13690996170043945  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

connection checking time:  10.708820819854736
block generation total time  9.065579891204834
average batch blocks generation time:  1.1331974864006042
block dataloader generation time/epoch 21.018491200038365
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10489273071289062  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9452872276306152  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10417318344116211  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9510335922241211  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1054239273071289  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9536466598510742  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10378170013427734  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9506793022155762  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1049346923828125  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.95147705078125  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10417556762695312  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9467110633850098  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10520458221435547  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9550337791442871  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10377216339111328  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9512696266174316  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08516794443130493 |0.018201351165771484 |0.0034904778003692627 |9.265542030334473e-05 |0.003799736499786377 |0.002819538116455078 |
----------------------------------------------------------pseudo_mini_loss sum 1.3980796337127686
Total (block generation + training)time/epoch 21.944000141961233
Training time/epoch 0.9649744033813477
Training time without block to device /epoch 0.8193635940551758
Training time without total dataloading part /epoch 0.06188249588012695
load block tensor time/epoch 0.6813435554504395
block to device time/epoch 0.14561080932617188
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  3054864
Number of first layer input nodes during this epoch:  1297816
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13720369338989258  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0241701602935791
range selection method range initialization spend 0.012154817581176758
time for parepare:  0.016306161880493164
local_output_nid generation:  0.002825498580932617
local_in_edges_tensor generation:  0.0049440860748291016
mini_batch_src_global generation:  0.0035276412963867188
r_  generation:  0.04385685920715332
local_output_nid generation:  0.003277301788330078
local_in_edges_tensor generation:  0.0017790794372558594
mini_batch_src_global generation:  0.005509376525878906
r_  generation:  0.05105400085449219
local_output_nid generation:  0.003862142562866211
local_in_edges_tensor generation:  0.0020940303802490234
mini_batch_src_global generation:  0.0045375823974609375
r_  generation:  0.050878047943115234
local_output_nid generation:  0.003985881805419922
local_in_edges_tensor generation:  0.0020859241485595703
mini_batch_src_global generation:  0.004319190979003906
r_  generation:  0.05070781707763672
local_output_nid generation:  0.0039250850677490234
local_in_edges_tensor generation:  0.0020787715911865234
mini_batch_src_global generation:  0.004818439483642578
r_  generation:  0.05255484580993652
local_output_nid generation:  0.0039331912994384766
local_in_edges_tensor generation:  0.0020627975463867188
mini_batch_src_global generation:  0.00486302375793457
r_  generation:  0.05263352394104004
local_output_nid generation:  0.003907442092895508
local_in_edges_tensor generation:  0.0020589828491210938
mini_batch_src_global generation:  0.007024526596069336
r_  generation:  0.05272197723388672
local_output_nid generation:  0.003941535949707031
local_in_edges_tensor generation:  0.0020987987518310547
mini_batch_src_global generation:  0.004337787628173828
r_  generation:  0.0516660213470459
----------------------check_connections_block total spend ----------------------------- 0.6169641017913818
generate_one_block  0.06462812423706055
generate_one_block  0.06441473960876465
generate_one_block  0.07196521759033203
generate_one_block  0.06354069709777832
generate_one_block  0.06228160858154297
generate_one_block  0.06229233741760254
generate_one_block  0.06499195098876953
generate_one_block  0.06239509582519531
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04190778732299805
gen group dst list time:  0.025363683700561523
time for parepare:  0.0274660587310791
local_output_nid generation:  0.011962890625
local_in_edges_tensor generation:  0.02595663070678711
mini_batch_src_global generation:  0.03774261474609375
r_  generation:  0.368497371673584
local_output_nid generation:  0.018041133880615234
local_in_edges_tensor generation:  0.023627042770385742
mini_batch_src_global generation:  0.04468536376953125
r_  generation:  0.37749242782592773
local_output_nid generation:  0.019073963165283203
local_in_edges_tensor generation:  0.023300647735595703
mini_batch_src_global generation:  0.044614315032958984
r_  generation:  0.38922667503356934
local_output_nid generation:  0.020526647567749023
local_in_edges_tensor generation:  0.02645587921142578
mini_batch_src_global generation:  0.04544329643249512
r_  generation:  0.39142346382141113
local_output_nid generation:  0.020743370056152344
local_in_edges_tensor generation:  0.031526803970336914
mini_batch_src_global generation:  0.05243515968322754
r_  generation:  0.3903539180755615
local_output_nid generation:  0.020502567291259766
local_in_edges_tensor generation:  0.027872085571289062
mini_batch_src_global generation:  0.04654741287231445
r_  generation:  0.3832051753997803
local_output_nid generation:  0.019216060638427734
local_in_edges_tensor generation:  0.021623611450195312
mini_batch_src_global generation:  0.04616808891296387
r_  generation:  0.3794443607330322
local_output_nid generation:  0.019176006317138672
local_in_edges_tensor generation:  0.020982980728149414
mini_batch_src_global generation:  0.04677462577819824
r_  generation:  0.3824751377105713
----------------------check_connections_block total spend ----------------------------- 4.4606969356536865
generate_one_block  0.49597597122192383
generate_one_block  0.49393272399902344
generate_one_block  0.5107319355010986
generate_one_block  0.4942615032196045
generate_one_block  0.5007390975952148
generate_one_block  0.4973440170288086
generate_one_block  0.5061850547790527
generate_one_block  0.5308539867401123
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03553271293640137
gen group dst list time:  0.04035449028015137
time for parepare:  0.020884037017822266
local_output_nid generation:  0.026813030242919922
local_in_edges_tensor generation:  0.04960036277770996
mini_batch_src_global generation:  0.044400691986083984
r_  generation:  0.47975587844848633
local_output_nid generation:  0.033374786376953125
local_in_edges_tensor generation:  0.040500640869140625
mini_batch_src_global generation:  0.05504798889160156
r_  generation:  0.4847722053527832
local_output_nid generation:  0.03391742706298828
local_in_edges_tensor generation:  0.034337759017944336
mini_batch_src_global generation:  0.05569863319396973
r_  generation:  0.4890255928039551
local_output_nid generation:  0.03454232215881348
local_in_edges_tensor generation:  0.034796714782714844
mini_batch_src_global generation:  0.05306553840637207
r_  generation:  0.49532365798950195
local_output_nid generation:  0.03471946716308594
local_in_edges_tensor generation:  0.03303933143615723
mini_batch_src_global generation:  0.0536649227142334
r_  generation:  0.4992802143096924
local_output_nid generation:  0.034928321838378906
local_in_edges_tensor generation:  0.03301739692687988
mini_batch_src_global generation:  0.059818267822265625
r_  generation:  0.5032122135162354
local_output_nid generation:  0.03494524955749512
local_in_edges_tensor generation:  0.03496074676513672
mini_batch_src_global generation:  0.054318904876708984
r_  generation:  0.5161862373352051
local_output_nid generation:  0.0353085994720459
local_in_edges_tensor generation:  0.03264427185058594
mini_batch_src_global generation:  0.054703474044799805
r_  generation:  0.5109410285949707
----------------------check_connections_block total spend ----------------------------- 5.8844568729400635
generate_one_block  0.6218829154968262
generate_one_block  0.6283619403839111
generate_one_block  0.6341331005096436
generate_one_block  0.6259036064147949
generate_one_block  0.63755202293396
generate_one_block  0.6276819705963135
generate_one_block  0.6240310668945312
generate_one_block  0.6218798160552979
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13720369338989258  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

connection checking time:  10.34515380859375
block generation total time  9.051450729370117
average batch blocks generation time:  1.1314313411712646
block dataloader generation time/epoch 21.087979286909103
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10503435134887695  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9522137641906738  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10408496856689453  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9503965377807617  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10546588897705078  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9522643089294434  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10404586791992188  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9497041702270508  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10552978515625  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9504947662353516  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10457324981689453  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9522271156311035  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10490036010742188  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.950261116027832  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10493278503417969  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9498214721679688  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07788076996803284 |0.019467562437057495 |0.0037837326526641846 |9.766221046447754e-05 |0.0035306215286254883 |0.0017788410186767578 |
----------------------------------------------------------pseudo_mini_loss sum 1.3731814622879028
Total (block generation + training)time/epoch 22.0123333632946
Training time/epoch 0.9160292148590088
Training time without block to device /epoch 0.7602887153625488
Training time without total dataloading part /epoch 0.06107497215270996
load block tensor time/epoch 0.6230461597442627
block to device time/epoch 0.15574049949645996
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  3054232
Number of first layer input nodes during this epoch:  1297629
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13796138763427734  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0306551456451416
range selection method range initialization spend 0.012351751327514648
time for parepare:  0.016776561737060547
local_output_nid generation:  0.002822399139404297
local_in_edges_tensor generation:  0.007616758346557617
mini_batch_src_global generation:  0.003307342529296875
r_  generation:  0.04400038719177246
local_output_nid generation:  0.0030927658081054688
local_in_edges_tensor generation:  0.0018000602722167969
mini_batch_src_global generation:  0.010515928268432617
r_  generation:  0.0458378791809082
local_output_nid generation:  0.003173351287841797
local_in_edges_tensor generation:  0.002088308334350586
mini_batch_src_global generation:  0.003675222396850586
r_  generation:  0.04654216766357422
local_output_nid generation:  0.003222942352294922
local_in_edges_tensor generation:  0.0018274784088134766
mini_batch_src_global generation:  0.0033779144287109375
r_  generation:  0.04606795310974121
local_output_nid generation:  0.0031752586364746094
local_in_edges_tensor generation:  0.0018475055694580078
mini_batch_src_global generation:  0.003700733184814453
r_  generation:  0.048168182373046875
local_output_nid generation:  0.0032389163970947266
local_in_edges_tensor generation:  0.0017969608306884766
mini_batch_src_global generation:  0.0038154125213623047
r_  generation:  0.04906725883483887
local_output_nid generation:  0.0031728744506835938
local_in_edges_tensor generation:  0.0018701553344726562
mini_batch_src_global generation:  0.003911495208740234
r_  generation:  0.04818105697631836
local_output_nid generation:  0.003175497055053711
local_in_edges_tensor generation:  0.001787424087524414
mini_batch_src_global generation:  0.0038080215454101562
r_  generation:  0.04892158508300781
----------------------check_connections_block total spend ----------------------------- 0.5572776794433594
generate_one_block  0.06696796417236328
generate_one_block  0.06107687950134277
generate_one_block  0.06218218803405762
generate_one_block  0.060539960861206055
generate_one_block  0.06169581413269043
generate_one_block  0.06251096725463867
generate_one_block  0.0645139217376709
generate_one_block  0.06189584732055664
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04048776626586914
gen group dst list time:  0.015312671661376953
time for parepare:  0.021224498748779297
local_output_nid generation:  0.011661529541015625
local_in_edges_tensor generation:  0.0312657356262207
mini_batch_src_global generation:  0.037584781646728516
r_  generation:  0.36127161979675293
local_output_nid generation:  0.017978429794311523
local_in_edges_tensor generation:  0.025159358978271484
mini_batch_src_global generation:  0.04833793640136719
r_  generation:  0.3788259029388428
local_output_nid generation:  0.019029855728149414
local_in_edges_tensor generation:  0.0209047794342041
mini_batch_src_global generation:  0.04467511177062988
r_  generation:  0.3879814147949219
local_output_nid generation:  0.019609689712524414
local_in_edges_tensor generation:  0.02794933319091797
mini_batch_src_global generation:  0.0494685173034668
r_  generation:  0.3948071002960205
local_output_nid generation:  0.020016908645629883
local_in_edges_tensor generation:  0.029078006744384766
mini_batch_src_global generation:  0.05708432197570801
r_  generation:  0.3808622360229492
local_output_nid generation:  0.021313905715942383
local_in_edges_tensor generation:  0.02387094497680664
mini_batch_src_global generation:  0.048490047454833984
r_  generation:  0.3843421936035156
local_output_nid generation:  0.019119739532470703
local_in_edges_tensor generation:  0.0202176570892334
mini_batch_src_global generation:  0.04635882377624512
r_  generation:  0.37927746772766113
local_output_nid generation:  0.019130945205688477
local_in_edges_tensor generation:  0.019866943359375
mini_batch_src_global generation:  0.046545982360839844
r_  generation:  0.38193583488464355
----------------------check_connections_block total spend ----------------------------- 4.4388251304626465
generate_one_block  0.4931216239929199
generate_one_block  0.5213298797607422
generate_one_block  0.5016727447509766
generate_one_block  0.4972569942474365
generate_one_block  0.49853992462158203
generate_one_block  0.5096642971038818
generate_one_block  0.4900333881378174
generate_one_block  0.5261361598968506
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03831744194030762
gen group dst list time:  0.0393519401550293
time for parepare:  0.020224332809448242
local_output_nid generation:  0.02743673324584961
local_in_edges_tensor generation:  0.053627967834472656
mini_batch_src_global generation:  0.046142578125
r_  generation:  0.4782583713531494
local_output_nid generation:  0.033867597579956055
local_in_edges_tensor generation:  0.04039478302001953
mini_batch_src_global generation:  0.05463433265686035
r_  generation:  0.48349690437316895
local_output_nid generation:  0.03419780731201172
local_in_edges_tensor generation:  0.03653764724731445
mini_batch_src_global generation:  0.05696678161621094
r_  generation:  0.4917018413543701
local_output_nid generation:  0.03500509262084961
local_in_edges_tensor generation:  0.03391075134277344
mini_batch_src_global generation:  0.053804874420166016
r_  generation:  0.49491095542907715
local_output_nid generation:  0.03438973426818848
local_in_edges_tensor generation:  0.0347590446472168
mini_batch_src_global generation:  0.05619645118713379
r_  generation:  0.5043234825134277
local_output_nid generation:  0.03474235534667969
local_in_edges_tensor generation:  0.03991985321044922
mini_batch_src_global generation:  0.054175615310668945
r_  generation:  0.5083222389221191
local_output_nid generation:  0.03500771522521973
local_in_edges_tensor generation:  0.033699989318847656
mini_batch_src_global generation:  0.054314613342285156
r_  generation:  0.5074214935302734
local_output_nid generation:  0.03628230094909668
local_in_edges_tensor generation:  0.03658342361450195
mini_batch_src_global generation:  0.055094003677368164
r_  generation:  0.5055820941925049
----------------------check_connections_block total spend ----------------------------- 5.90619683265686
generate_one_block  0.6311385631561279
generate_one_block  0.6392908096313477
generate_one_block  0.6448287963867188
generate_one_block  0.6199631690979004
generate_one_block  0.6266293525695801
generate_one_block  0.6296818256378174
generate_one_block  0.62481689453125
generate_one_block  0.6122801303863525
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13796138763427734  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

connection checking time:  10.345021963119507
block generation total time  9.066384553909302
average batch blocks generation time:  1.1332980692386627
block dataloader generation time/epoch 21.128676970799763
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10535049438476562  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9504704475402832  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10478019714355469  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9506039619445801  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10547256469726562  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9535636901855469  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1036372184753418  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9470024108886719  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10520744323730469  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9513330459594727  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10450172424316406  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.951265811920166  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10484790802001953  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9478211402893066  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10422992706298828  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9490795135498047  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08683916926383972 |0.016505390405654907 |0.0035467147827148438 |9.143352508544922e-05 |0.0038392245769500732 |0.0018837451934814453 |
----------------------------------------------------------pseudo_mini_loss sum 1.3560861349105835
Total (block generation + training)time/epoch 22.05734936396281
Training time/epoch 0.9630129337310791
Training time without block to device /epoch 0.8309698104858398
Training time without total dataloading part /epoch 0.061702728271484375
load block tensor time/epoch 0.6947133541107178
block to device time/epoch 0.13204312324523926
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  3053479
Number of first layer input nodes during this epoch:  1297910
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13736581802368164  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025902748107910156
range selection method range initialization spend 0.011864662170410156
time for parepare:  0.016130685806274414
local_output_nid generation:  0.002766132354736328
local_in_edges_tensor generation:  0.0070493221282958984
mini_batch_src_global generation:  0.00515294075012207
r_  generation:  0.04473447799682617
local_output_nid generation:  0.003179788589477539
local_in_edges_tensor generation:  0.001758575439453125
mini_batch_src_global generation:  0.004942655563354492
r_  generation:  0.04555511474609375
local_output_nid generation:  0.003203153610229492
local_in_edges_tensor generation:  0.0019648075103759766
mini_batch_src_global generation:  0.0034263134002685547
r_  generation:  0.04562067985534668
local_output_nid generation:  0.003207683563232422
local_in_edges_tensor generation:  0.0018792152404785156
mini_batch_src_global generation:  0.003470182418823242
r_  generation:  0.04706883430480957
local_output_nid generation:  0.003247976303100586
local_in_edges_tensor generation:  0.0018298625946044922
mini_batch_src_global generation:  0.0037446022033691406
r_  generation:  0.048697710037231445
local_output_nid generation:  0.003233671188354492
local_in_edges_tensor generation:  0.0019927024841308594
mini_batch_src_global generation:  0.0038025379180908203
r_  generation:  0.048964738845825195
local_output_nid generation:  0.0032470226287841797
local_in_edges_tensor generation:  0.001861572265625
mini_batch_src_global generation:  0.003912925720214844
r_  generation:  0.04795193672180176
local_output_nid generation:  0.0032777786254882812
local_in_edges_tensor generation:  0.0017938613891601562
mini_batch_src_global generation:  0.003743886947631836
r_  generation:  0.04833388328552246
----------------------check_connections_block total spend ----------------------------- 0.5514533519744873
generate_one_block  0.06424379348754883
generate_one_block  0.060683250427246094
generate_one_block  0.06009078025817871
generate_one_block  0.06127500534057617
generate_one_block  0.06170654296875
generate_one_block  0.06250691413879395
generate_one_block  0.064056396484375
generate_one_block  0.06139254570007324
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.038831233978271484
gen group dst list time:  0.015368461608886719
time for parepare:  0.019797086715698242
local_output_nid generation:  0.011758804321289062
local_in_edges_tensor generation:  0.03159761428833008
mini_batch_src_global generation:  0.03626275062561035
r_  generation:  0.36113715171813965
local_output_nid generation:  0.017949342727661133
local_in_edges_tensor generation:  0.0218813419342041
mini_batch_src_global generation:  0.045244693756103516
r_  generation:  0.37461042404174805
local_output_nid generation:  0.018468141555786133
local_in_edges_tensor generation:  0.018896102905273438
mini_batch_src_global generation:  0.045662641525268555
r_  generation:  0.37200498580932617
local_output_nid generation:  0.018772125244140625
local_in_edges_tensor generation:  0.018887758255004883
mini_batch_src_global generation:  0.046686410903930664
r_  generation:  0.3817563056945801
local_output_nid generation:  0.01924276351928711
local_in_edges_tensor generation:  0.019420385360717773
mini_batch_src_global generation:  0.046439170837402344
r_  generation:  0.37912416458129883
local_output_nid generation:  0.01928853988647461
local_in_edges_tensor generation:  0.02115654945373535
mini_batch_src_global generation:  0.04656505584716797
r_  generation:  0.3852682113647461
local_output_nid generation:  0.018132448196411133
local_in_edges_tensor generation:  0.019553422927856445
mini_batch_src_global generation:  0.04596257209777832
r_  generation:  0.3791694641113281
local_output_nid generation:  0.01830315589904785
local_in_edges_tensor generation:  0.02090311050415039
mini_batch_src_global generation:  0.04608511924743652
r_  generation:  0.38394665718078613
----------------------check_connections_block total spend ----------------------------- 4.340953588485718
generate_one_block  0.4914052486419678
generate_one_block  0.4904499053955078
generate_one_block  0.48519015312194824
generate_one_block  0.4920356273651123
generate_one_block  0.48841047286987305
generate_one_block  0.4975624084472656
generate_one_block  0.4875674247741699
generate_one_block  0.5275716781616211
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.033991336822509766
gen group dst list time:  0.03900337219238281
time for parepare:  0.02016592025756836
local_output_nid generation:  0.026656150817871094
local_in_edges_tensor generation:  0.04308128356933594
mini_batch_src_global generation:  0.05979776382446289
r_  generation:  0.48137402534484863
local_output_nid generation:  0.03278040885925293
local_in_edges_tensor generation:  0.03958868980407715
mini_batch_src_global generation:  0.07390713691711426
r_  generation:  0.4932568073272705
local_output_nid generation:  0.03368401527404785
local_in_edges_tensor generation:  0.03280472755432129
mini_batch_src_global generation:  0.061714887619018555
r_  generation:  0.49729228019714355
local_output_nid generation:  0.03421926498413086
local_in_edges_tensor generation:  0.031157732009887695
mini_batch_src_global generation:  0.056563377380371094
r_  generation:  0.5084795951843262
local_output_nid generation:  0.03501749038696289
local_in_edges_tensor generation:  0.04077506065368652
mini_batch_src_global generation:  0.058316707611083984
r_  generation:  0.5119295120239258
local_output_nid generation:  0.037659645080566406
local_in_edges_tensor generation:  0.031745195388793945
mini_batch_src_global generation:  0.05978131294250488
r_  generation:  0.5041003227233887
local_output_nid generation:  0.03564333915710449
local_in_edges_tensor generation:  0.03144216537475586
mini_batch_src_global generation:  0.05461931228637695
r_  generation:  0.5002720355987549
local_output_nid generation:  0.03581595420837402
local_in_edges_tensor generation:  0.0333249568939209
mini_batch_src_global generation:  0.061403751373291016
r_  generation:  0.535132646560669
----------------------check_connections_block total spend ----------------------------- 6.0241379737854
generate_one_block  0.6414804458618164
generate_one_block  0.6476016044616699
generate_one_block  0.6271524429321289
generate_one_block  0.6561660766601562
generate_one_block  0.6332721710205078
generate_one_block  0.6337871551513672
generate_one_block  0.6395101547241211
generate_one_block  0.6281847953796387
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13736581802368164  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

connection checking time:  10.365091562271118
block generation total time  9.067347764968872
average batch blocks generation time:  1.133418470621109
block dataloader generation time/epoch 21.160666394233704
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1049957275390625  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9531688690185547  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10364770889282227  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9488935470581055  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10485553741455078  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9500851631164551  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10507678985595703  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9528799057006836  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10368871688842773  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.948338508605957  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10519981384277344  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9521746635437012  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10403060913085938  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9477596282958984  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.105010986328125  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9517693519592285  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08421081304550171 |0.020495444536209106 |0.004188954830169678 |0.00010716915130615234 |0.0035365521907806396 |0.002992391586303711 |
----------------------------------------------------------pseudo_mini_loss sum 1.3428955078125
Total (block generation + training)time/epoch 22.094328236579894
Training time/epoch 0.9783246517181396
Training time without block to device /epoch 0.8143610954284668
Training time without total dataloading part /epoch 0.06565380096435547
load block tensor time/epoch 0.6736865043640137
block to device time/epoch 0.16396355628967285
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  3054143
Number of first layer input nodes during this epoch:  1297295
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13833856582641602  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025837182998657227
range selection method range initialization spend 0.012426376342773438
time for parepare:  0.01596689224243164
local_output_nid generation:  0.002721548080444336
local_in_edges_tensor generation:  0.00484156608581543
mini_batch_src_global generation:  0.0033113956451416016
r_  generation:  0.04465460777282715
local_output_nid generation:  0.0031757354736328125
local_in_edges_tensor generation:  0.0017714500427246094
mini_batch_src_global generation:  0.008033037185668945
r_  generation:  0.04891490936279297
local_output_nid generation:  0.0038247108459472656
local_in_edges_tensor generation:  0.002119302749633789
mini_batch_src_global generation:  0.00455927848815918
r_  generation:  0.05063629150390625
local_output_nid generation:  0.003958225250244141
local_in_edges_tensor generation:  0.002137899398803711
mini_batch_src_global generation:  0.003933906555175781
r_  generation:  0.049794912338256836
local_output_nid generation:  0.0038976669311523438
local_in_edges_tensor generation:  0.0021033287048339844
mini_batch_src_global generation:  0.003864765167236328
r_  generation:  0.049361228942871094
local_output_nid generation:  0.003866434097290039
local_in_edges_tensor generation:  0.002165555953979492
mini_batch_src_global generation:  0.004576444625854492
r_  generation:  0.05205368995666504
local_output_nid generation:  0.00700688362121582
local_in_edges_tensor generation:  0.0036063194274902344
mini_batch_src_global generation:  0.010187149047851562
r_  generation:  0.05173492431640625
local_output_nid generation:  0.0032422542572021484
local_in_edges_tensor generation:  0.001886129379272461
mini_batch_src_global generation:  0.0045719146728515625
r_  generation:  0.049722909927368164
----------------------check_connections_block total spend ----------------------------- 0.6086573600769043
generate_one_block  0.06682062149047852
generate_one_block  0.05968046188354492
generate_one_block  0.06220102310180664
generate_one_block  0.06127810478210449
generate_one_block  0.06084632873535156
generate_one_block  0.06257224082946777
generate_one_block  0.06537866592407227
generate_one_block  0.06307411193847656
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03779721260070801
gen group dst list time:  0.01871657371520996
time for parepare:  0.03437161445617676
local_output_nid generation:  0.014620780944824219
local_in_edges_tensor generation:  0.02582097053527832
mini_batch_src_global generation:  0.0381009578704834
r_  generation:  0.35991978645324707
local_output_nid generation:  0.0217287540435791
local_in_edges_tensor generation:  0.025523662567138672
mini_batch_src_global generation:  0.043982505798339844
r_  generation:  0.37862229347229004
local_output_nid generation:  0.02474665641784668
local_in_edges_tensor generation:  0.02155017852783203
mini_batch_src_global generation:  0.047265052795410156
r_  generation:  0.391326904296875
local_output_nid generation:  0.022938966751098633
local_in_edges_tensor generation:  0.030408143997192383
mini_batch_src_global generation:  0.04818987846374512
r_  generation:  0.4062049388885498
local_output_nid generation:  0.02524590492248535
local_in_edges_tensor generation:  0.026440858840942383
mini_batch_src_global generation:  0.0471491813659668
r_  generation:  0.38051891326904297
local_output_nid generation:  0.023651123046875
local_in_edges_tensor generation:  0.023594379425048828
mini_batch_src_global generation:  0.047057151794433594
r_  generation:  0.3942997455596924
local_output_nid generation:  0.0234527587890625
local_in_edges_tensor generation:  0.023325681686401367
mini_batch_src_global generation:  0.04750704765319824
r_  generation:  0.38965725898742676
local_output_nid generation:  0.026189327239990234
local_in_edges_tensor generation:  0.025093793869018555
mini_batch_src_global generation:  0.04849100112915039
r_  generation:  0.38611578941345215
----------------------check_connections_block total spend ----------------------------- 4.533998250961304
generate_one_block  0.5064647197723389
generate_one_block  0.4947543144226074
generate_one_block  0.4990518093109131
generate_one_block  0.49669647216796875
generate_one_block  0.48332643508911133
generate_one_block  0.49583983421325684
generate_one_block  0.4993305206298828
generate_one_block  0.522594690322876
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03550291061401367
gen group dst list time:  0.03913450241088867
time for parepare:  0.01862955093383789
local_output_nid generation:  0.026663780212402344
local_in_edges_tensor generation:  0.05184030532836914
mini_batch_src_global generation:  0.043581247329711914
r_  generation:  0.49091482162475586
local_output_nid generation:  0.03637385368347168
local_in_edges_tensor generation:  0.04009270668029785
mini_batch_src_global generation:  0.05765366554260254
r_  generation:  0.48920536041259766
local_output_nid generation:  0.03410649299621582
local_in_edges_tensor generation:  0.03383994102478027
mini_batch_src_global generation:  0.07049870491027832
r_  generation:  0.4944326877593994
local_output_nid generation:  0.03439974784851074
local_in_edges_tensor generation:  0.03762626647949219
mini_batch_src_global generation:  0.05362820625305176
r_  generation:  0.4928162097930908
local_output_nid generation:  0.03505349159240723
local_in_edges_tensor generation:  0.032389163970947266
mini_batch_src_global generation:  0.05443239212036133
r_  generation:  0.5021507740020752
local_output_nid generation:  0.03653097152709961
local_in_edges_tensor generation:  0.039615631103515625
mini_batch_src_global generation:  0.057005882263183594
r_  generation:  0.5065591335296631
local_output_nid generation:  0.03686261177062988
local_in_edges_tensor generation:  0.037020206451416016
mini_batch_src_global generation:  0.0550539493560791
r_  generation:  0.5165867805480957
local_output_nid generation:  0.03708648681640625
local_in_edges_tensor generation:  0.039644479751586914
mini_batch_src_global generation:  0.06340670585632324
r_  generation:  0.5038049221038818
----------------------check_connections_block total spend ----------------------------- 5.953417062759399
generate_one_block  0.6211357116699219
generate_one_block  0.6272435188293457
generate_one_block  0.6220376491546631
generate_one_block  0.6109728813171387
generate_one_block  0.6199600696563721
generate_one_block  0.6244654655456543
generate_one_block  0.6153445243835449
generate_one_block  0.6220734119415283
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13833856582641602  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

connection checking time:  10.487415313720703
block generation total time  8.961292028427124
average batch blocks generation time:  1.1201615035533905
block dataloader generation time/epoch 21.19863124327226
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10427045822143555  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9494633674621582  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10550975799560547  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.943610668182373  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10429763793945312  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9544014930725098  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10494518280029297  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9491333961486816  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1040349006652832  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9444599151611328  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10501241683959961  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9562511444091797  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10367965698242188  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9477963447570801  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10506820678710938  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9536337852478027  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0854654610157013 |0.01635006070137024 |0.0035258829593658447 |9.134411811828613e-05 |0.0038067996501922607 |0.001325845718383789 |
----------------------------------------------------------pseudo_mini_loss sum 1.3264904022216797
Total (block generation + training)time/epoch 22.133717927065764
Training time/epoch 0.9490640163421631
Training time without block to device /epoch 0.8182635307312012
Training time without total dataloading part /epoch 0.06071805953979492
load block tensor time/epoch 0.6837236881256104
block to device time/epoch 0.13080048561096191
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 20 |
Number of nodes for computation during this epoch:  3053229
Number of first layer input nodes during this epoch:  1297488
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1381845474243164  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021808624267578125
range selection method range initialization spend 0.014750003814697266
time for parepare:  0.018738508224487305
local_output_nid generation:  0.002747058868408203
local_in_edges_tensor generation:  0.007616996765136719
mini_batch_src_global generation:  0.00407719612121582
r_  generation:  0.04398703575134277
local_output_nid generation:  0.003137350082397461
local_in_edges_tensor generation:  0.001956939697265625
mini_batch_src_global generation:  0.007874011993408203
r_  generation:  0.04432487487792969
local_output_nid generation:  0.0031731128692626953
local_in_edges_tensor generation:  0.002015829086303711
mini_batch_src_global generation:  0.003381013870239258
r_  generation:  0.045987606048583984
local_output_nid generation:  0.0031862258911132812
local_in_edges_tensor generation:  0.0018107891082763672
mini_batch_src_global generation:  0.0035223960876464844
r_  generation:  0.04735589027404785
local_output_nid generation:  0.0031719207763671875
local_in_edges_tensor generation:  0.0017845630645751953
mini_batch_src_global generation:  0.0037469863891601562
r_  generation:  0.04999899864196777
local_output_nid generation:  0.0031976699829101562
local_in_edges_tensor generation:  0.0019359588623046875
mini_batch_src_global generation:  0.0037827491760253906
r_  generation:  0.0476834774017334
local_output_nid generation:  0.0031807422637939453
local_in_edges_tensor generation:  0.001786947250366211
mini_batch_src_global generation:  0.003926992416381836
r_  generation:  0.04833030700683594
local_output_nid generation:  0.0032007694244384766
local_in_edges_tensor generation:  0.0018420219421386719
mini_batch_src_global generation:  0.003660917282104492
r_  generation:  0.0498354434967041
----------------------check_connections_block total spend ----------------------------- 0.5563290119171143
generate_one_block  0.06771516799926758
generate_one_block  0.06093287467956543
generate_one_block  0.06277108192443848
generate_one_block  0.06193804740905762
generate_one_block  0.06245923042297363
generate_one_block  0.0633544921875
generate_one_block  0.06476306915283203
generate_one_block  0.06150960922241211
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04659438133239746
gen group dst list time:  0.015295743942260742
time for parepare:  0.02155470848083496
local_output_nid generation:  0.011841058731079102
local_in_edges_tensor generation:  0.027214765548706055
mini_batch_src_global generation:  0.03681755065917969
r_  generation:  0.36008644104003906
local_output_nid generation:  0.017666339874267578
local_in_edges_tensor generation:  0.025209665298461914
mini_batch_src_global generation:  0.04386734962463379
r_  generation:  0.3664360046386719
local_output_nid generation:  0.018552303314208984
local_in_edges_tensor generation:  0.02050948143005371
mini_batch_src_global generation:  0.0455622673034668
r_  generation:  0.37926578521728516
local_output_nid generation:  0.018465518951416016
local_in_edges_tensor generation:  0.021049976348876953
mini_batch_src_global generation:  0.04480123519897461
r_  generation:  0.38138794898986816
local_output_nid generation:  0.019405126571655273
local_in_edges_tensor generation:  0.020551443099975586
mini_batch_src_global generation:  0.0527040958404541
r_  generation:  0.3886749744415283
local_output_nid generation:  0.019260406494140625
local_in_edges_tensor generation:  0.019992589950561523
mini_batch_src_global generation:  0.04637718200683594
r_  generation:  0.38741302490234375
local_output_nid generation:  0.02175593376159668
local_in_edges_tensor generation:  0.020177364349365234
mini_batch_src_global generation:  0.050740957260131836
r_  generation:  0.3927435874938965
local_output_nid generation:  0.018679141998291016
local_in_edges_tensor generation:  0.024628639221191406
mini_batch_src_global generation:  0.04901695251464844
r_  generation:  0.38645195960998535
----------------------check_connections_block total spend ----------------------------- 4.398205518722534
generate_one_block  0.5016067028045654
generate_one_block  0.5064480304718018
generate_one_block  0.49299120903015137
generate_one_block  0.49248600006103516
generate_one_block  0.49891066551208496
generate_one_block  0.493206262588501
generate_one_block  0.49538731575012207
generate_one_block  0.5236060619354248
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03833198547363281
gen group dst list time:  0.03850150108337402
time for parepare:  0.019153594970703125
local_output_nid generation:  0.027157306671142578
local_in_edges_tensor generation:  0.05253267288208008
mini_batch_src_global generation:  0.04712343215942383
r_  generation:  0.49712300300598145
local_output_nid generation:  0.03304290771484375
local_in_edges_tensor generation:  0.03472495079040527
mini_batch_src_global generation:  0.05553936958312988
r_  generation:  0.48966026306152344
local_output_nid generation:  0.03471231460571289
local_in_edges_tensor generation:  0.03723931312561035
mini_batch_src_global generation:  0.05644869804382324
r_  generation:  0.49958205223083496
local_output_nid generation:  0.0342867374420166
local_in_edges_tensor generation:  0.03738689422607422
mini_batch_src_global generation:  0.05368399620056152
r_  generation:  0.5012228488922119
local_output_nid generation:  0.03454089164733887
local_in_edges_tensor generation:  0.036769866943359375
mini_batch_src_global generation:  0.05349540710449219
r_  generation:  0.5063235759735107
local_output_nid generation:  0.03500080108642578
local_in_edges_tensor generation:  0.038435935974121094
mini_batch_src_global generation:  0.05418086051940918
r_  generation:  0.504655122756958
local_output_nid generation:  0.03536653518676758
local_in_edges_tensor generation:  0.036782264709472656
mini_batch_src_global generation:  0.05533027648925781
r_  generation:  0.5243451595306396
local_output_nid generation:  0.03639340400695801
local_in_edges_tensor generation:  0.03907299041748047
mini_batch_src_global generation:  0.06087803840637207
r_  generation:  0.5109372138977051
----------------------check_connections_block total spend ----------------------------- 5.969292879104614
generate_one_block  0.6303122043609619
generate_one_block  0.6182115077972412
generate_one_block  0.6201696395874023
generate_one_block  0.62166428565979
generate_one_block  0.616070032119751
generate_one_block  0.6157982349395752
generate_one_block  0.6194283962249756
generate_one_block  0.6330628395080566
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1381845474243164  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

connection checking time:  10.367498397827148
block generation total time  8.97935938835144
average batch blocks generation time:  1.12241992354393
block dataloader generation time/epoch 21.21667406956355
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10418033599853516  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9510226249694824  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10505819320678711  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9491910934448242  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1044611930847168  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9497013092041016  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10519266128540039  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9503798484802246  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10439586639404297  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9498815536499023  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10503768920898438  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9482951164245605  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10431909561157227  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9534950256347656  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1044611930847168  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9525570869445801  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08718293905258179 |0.01643425226211548 |0.003532618284225464 |9.045004844665527e-05 |0.00379788875579834 |0.0029578208923339844 |
----------------------------------------------------------pseudo_mini_loss sum 1.3119871616363525
Total (block generation + training)time/epoch 22.15452382961909
Training time/epoch 0.9679908752441406
Training time without block to device /epoch 0.8365168571472168
Training time without total dataloading part /epoch 0.062325477600097656
load block tensor time/epoch 0.6974635124206543
block to device time/epoch 0.13147401809692383
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 21 |
Number of nodes for computation during this epoch:  3055008
Number of first layer input nodes during this epoch:  1297916
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13744258880615234  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02614879608154297
range selection method range initialization spend 0.012180805206298828
time for parepare:  0.016757965087890625
local_output_nid generation:  0.0027494430541992188
local_in_edges_tensor generation:  0.007587909698486328
mini_batch_src_global generation:  0.003443479537963867
r_  generation:  0.045248985290527344
local_output_nid generation:  0.003142833709716797
local_in_edges_tensor generation:  0.0018055438995361328
mini_batch_src_global generation:  0.005053997039794922
r_  generation:  0.04459977149963379
local_output_nid generation:  0.0031881332397460938
local_in_edges_tensor generation:  0.0018110275268554688
mini_batch_src_global generation:  0.0036084651947021484
r_  generation:  0.04700207710266113
local_output_nid generation:  0.0031957626342773438
local_in_edges_tensor generation:  0.0018646717071533203
mini_batch_src_global generation:  0.0036013126373291016
r_  generation:  0.04722428321838379
local_output_nid generation:  0.0032415390014648438
local_in_edges_tensor generation:  0.0017719268798828125
mini_batch_src_global generation:  0.003715038299560547
r_  generation:  0.047475576400756836
local_output_nid generation:  0.0031807422637939453
local_in_edges_tensor generation:  0.0018398761749267578
mini_batch_src_global generation:  0.0038068294525146484
r_  generation:  0.04813504219055176
local_output_nid generation:  0.0032715797424316406
local_in_edges_tensor generation:  0.0017900466918945312
mini_batch_src_global generation:  0.0040225982666015625
r_  generation:  0.04903078079223633
local_output_nid generation:  0.003203868865966797
local_in_edges_tensor generation:  0.0018880367279052734
mini_batch_src_global generation:  0.003866434097290039
r_  generation:  0.05088162422180176
----------------------check_connections_block total spend ----------------------------- 0.5541458129882812
generate_one_block  0.06194782257080078
generate_one_block  0.061725616455078125
generate_one_block  0.06255054473876953
generate_one_block  0.06213831901550293
generate_one_block  0.06162452697753906
generate_one_block  0.06224632263183594
generate_one_block  0.06556820869445801
generate_one_block  0.0626976490020752
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03740525245666504
gen group dst list time:  0.01558232307434082
time for parepare:  0.019222021102905273
local_output_nid generation:  0.011607885360717773
local_in_edges_tensor generation:  0.027910947799682617
mini_batch_src_global generation:  0.03608131408691406
r_  generation:  0.3667738437652588
local_output_nid generation:  0.017642974853515625
local_in_edges_tensor generation:  0.026433229446411133
mini_batch_src_global generation:  0.04571270942687988
r_  generation:  0.377333402633667
local_output_nid generation:  0.018794536590576172
local_in_edges_tensor generation:  0.021092891693115234
mini_batch_src_global generation:  0.04522871971130371
r_  generation:  0.38051724433898926
local_output_nid generation:  0.01847243309020996
local_in_edges_tensor generation:  0.02199554443359375
mini_batch_src_global generation:  0.04505014419555664
r_  generation:  0.37746334075927734
local_output_nid generation:  0.019182205200195312
local_in_edges_tensor generation:  0.021179676055908203
mini_batch_src_global generation:  0.04592394828796387
r_  generation:  0.3783090114593506
local_output_nid generation:  0.019177913665771484
local_in_edges_tensor generation:  0.02120828628540039
mini_batch_src_global generation:  0.046471595764160156
r_  generation:  0.3847208023071289
local_output_nid generation:  0.0183560848236084
local_in_edges_tensor generation:  0.021724700927734375
mini_batch_src_global generation:  0.04633212089538574
r_  generation:  0.3830745220184326
local_output_nid generation:  0.018505334854125977
local_in_edges_tensor generation:  0.023471593856811523
mini_batch_src_global generation:  0.047002553939819336
r_  generation:  0.38713788986206055
----------------------check_connections_block total spend ----------------------------- 4.375082731246948
generate_one_block  0.49303412437438965
generate_one_block  0.500572919845581
generate_one_block  0.49472856521606445
generate_one_block  0.48292112350463867
generate_one_block  0.48705387115478516
generate_one_block  0.4909536838531494
generate_one_block  0.48718690872192383
generate_one_block  0.5272777080535889
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03169870376586914
gen group dst list time:  0.038496971130371094
time for parepare:  0.020049333572387695
local_output_nid generation:  0.026543378829956055
local_in_edges_tensor generation:  0.045105934143066406
mini_batch_src_global generation:  0.04348278045654297
r_  generation:  0.4825167655944824
local_output_nid generation:  0.033989667892456055
local_in_edges_tensor generation:  0.03938698768615723
mini_batch_src_global generation:  0.05576372146606445
r_  generation:  0.4868652820587158
local_output_nid generation:  0.03404855728149414
local_in_edges_tensor generation:  0.0337522029876709
mini_batch_src_global generation:  0.05640697479248047
r_  generation:  0.49092769622802734
local_output_nid generation:  0.03457832336425781
local_in_edges_tensor generation:  0.03689074516296387
mini_batch_src_global generation:  0.05338263511657715
r_  generation:  0.49284791946411133
local_output_nid generation:  0.03476834297180176
local_in_edges_tensor generation:  0.03218793869018555
mini_batch_src_global generation:  0.05368757247924805
r_  generation:  0.4952704906463623
local_output_nid generation:  0.03488802909851074
local_in_edges_tensor generation:  0.032183170318603516
mini_batch_src_global generation:  0.05402350425720215
r_  generation:  0.4983055591583252
local_output_nid generation:  0.034358978271484375
local_in_edges_tensor generation:  0.034184932708740234
mini_batch_src_global generation:  0.054390668869018555
r_  generation:  0.5015397071838379
local_output_nid generation:  0.03456616401672363
local_in_edges_tensor generation:  0.03371787071228027
mini_batch_src_global generation:  0.05664491653442383
r_  generation:  0.5015072822570801
----------------------check_connections_block total spend ----------------------------- 5.830907344818115
generate_one_block  0.6214640140533447
generate_one_block  0.6187622547149658
generate_one_block  0.6129956245422363
generate_one_block  0.6148760318756104
generate_one_block  0.6156935691833496
generate_one_block  0.6202318668365479
generate_one_block  0.6145117282867432
generate_one_block  0.6169242858886719
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13744258880615234  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

connection checking time:  10.205990076065063
block generation total time  8.89918828010559
average batch blocks generation time:  1.1123985350131989
block dataloader generation time/epoch 21.20938405623803
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10424327850341797  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9531097412109375  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10387134552001953  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9520835876464844  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10530757904052734  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9557762145996094  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10356807708740234  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9468264579772949  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10485458374023438  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9464130401611328  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10410642623901367  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.950474739074707  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1054525375366211  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9490551948547363  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10422086715698242  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9515380859375  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08547207713127136 |0.013309001922607422 |0.0035398900508880615 |9.325146675109863e-05 |0.0038458704948425293 |0.0014293193817138672 |
----------------------------------------------------------pseudo_mini_loss sum 1.2966859340667725
Total (block generation + training)time/epoch 22.14664594943707
Training time/epoch 0.9299216270446777
Training time without block to device /epoch 0.8234496116638184
Training time without total dataloading part /epoch 0.06126141548156738
load block tensor time/epoch 0.6837766170501709
block to device time/epoch 0.10647201538085938
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 22 |
Number of nodes for computation during this epoch:  3054612
Number of first layer input nodes during this epoch:  1297175
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13741016387939453  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02085709571838379
range selection method range initialization spend 0.012094497680664062
time for parepare:  0.016298294067382812
local_output_nid generation:  0.0027599334716796875
local_in_edges_tensor generation:  0.004340648651123047
mini_batch_src_global generation:  0.0033736228942871094
r_  generation:  0.04565024375915527
local_output_nid generation:  0.003160715103149414
local_in_edges_tensor generation:  0.0017895698547363281
mini_batch_src_global generation:  0.005112648010253906
r_  generation:  0.046205759048461914
local_output_nid generation:  0.003243684768676758
local_in_edges_tensor generation:  0.0018422603607177734
mini_batch_src_global generation:  0.004889249801635742
r_  generation:  0.04654717445373535
local_output_nid generation:  0.0032019615173339844
local_in_edges_tensor generation:  0.0017812252044677734
mini_batch_src_global generation:  0.003496885299682617
r_  generation:  0.048622846603393555
local_output_nid generation:  0.003256559371948242
local_in_edges_tensor generation:  0.0017995834350585938
mini_batch_src_global generation:  0.0038046836853027344
r_  generation:  0.048024892807006836
local_output_nid generation:  0.003225564956665039
local_in_edges_tensor generation:  0.0018019676208496094
mini_batch_src_global generation:  0.003813505172729492
r_  generation:  0.04873824119567871
local_output_nid generation:  0.0032706260681152344
local_in_edges_tensor generation:  0.0018270015716552734
mini_batch_src_global generation:  0.0038983821868896484
r_  generation:  0.04816579818725586
local_output_nid generation:  0.003221273422241211
local_in_edges_tensor generation:  0.0018897056579589844
mini_batch_src_global generation:  0.0038695335388183594
r_  generation:  0.0487821102142334
----------------------check_connections_block total spend ----------------------------- 0.55251145362854
generate_one_block  0.06065201759338379
generate_one_block  0.06208205223083496
generate_one_block  0.06110954284667969
generate_one_block  0.060828208923339844
generate_one_block  0.06159663200378418
generate_one_block  0.06173586845397949
generate_one_block  0.0637812614440918
generate_one_block  0.06217050552368164
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03618168830871582
gen group dst list time:  0.015568733215332031
time for parepare:  0.019214630126953125
local_output_nid generation:  0.011907577514648438
local_in_edges_tensor generation:  0.025289535522460938
mini_batch_src_global generation:  0.036031246185302734
r_  generation:  0.36566972732543945
local_output_nid generation:  0.018256664276123047
local_in_edges_tensor generation:  0.020869970321655273
mini_batch_src_global generation:  0.045590877532958984
r_  generation:  0.3790566921234131
local_output_nid generation:  0.018894672393798828
local_in_edges_tensor generation:  0.02066826820373535
mini_batch_src_global generation:  0.044794559478759766
r_  generation:  0.37476158142089844
local_output_nid generation:  0.018720149993896484
local_in_edges_tensor generation:  0.0197904109954834
mini_batch_src_global generation:  0.04569053649902344
r_  generation:  0.3892645835876465
local_output_nid generation:  0.019279956817626953
local_in_edges_tensor generation:  0.019446372985839844
mini_batch_src_global generation:  0.04695892333984375
r_  generation:  0.3827402591705322
local_output_nid generation:  0.019579648971557617
local_in_edges_tensor generation:  0.020952463150024414
mini_batch_src_global generation:  0.0465083122253418
r_  generation:  0.3833591938018799
local_output_nid generation:  0.018166065216064453
local_in_edges_tensor generation:  0.020723342895507812
mini_batch_src_global generation:  0.0460667610168457
r_  generation:  0.3769230842590332
local_output_nid generation:  0.018525362014770508
local_in_edges_tensor generation:  0.021491289138793945
mini_batch_src_global generation:  0.046553850173950195
r_  generation:  0.38672542572021484
----------------------check_connections_block total spend ----------------------------- 4.361932039260864
generate_one_block  0.4913604259490967
generate_one_block  0.4968411922454834
generate_one_block  0.4889333248138428
generate_one_block  0.4895286560058594
generate_one_block  0.48853588104248047
generate_one_block  0.48774266242980957
generate_one_block  0.4788219928741455
generate_one_block  0.5168724060058594
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.033271074295043945
gen group dst list time:  0.03846001625061035
time for parepare:  0.018363475799560547
local_output_nid generation:  0.0267791748046875
local_in_edges_tensor generation:  0.03599286079406738
mini_batch_src_global generation:  0.04371380805969238
r_  generation:  0.48949527740478516
local_output_nid generation:  0.03375506401062012
local_in_edges_tensor generation:  0.03652691841125488
mini_batch_src_global generation:  0.0558772087097168
r_  generation:  0.48946309089660645
local_output_nid generation:  0.034685373306274414
local_in_edges_tensor generation:  0.03155922889709473
mini_batch_src_global generation:  0.05428266525268555
r_  generation:  0.5007531642913818
local_output_nid generation:  0.03574371337890625
local_in_edges_tensor generation:  0.03398704528808594
mini_batch_src_global generation:  0.053421735763549805
r_  generation:  0.4981851577758789
local_output_nid generation:  0.034905195236206055
local_in_edges_tensor generation:  0.033263444900512695
mini_batch_src_global generation:  0.053520917892456055
r_  generation:  0.5040056705474854
local_output_nid generation:  0.03485679626464844
local_in_edges_tensor generation:  0.037180185317993164
mini_batch_src_global generation:  0.05301523208618164
r_  generation:  0.5063815116882324
local_output_nid generation:  0.03484296798706055
local_in_edges_tensor generation:  0.03183150291442871
mini_batch_src_global generation:  0.05373740196228027
r_  generation:  0.5039970874786377
local_output_nid generation:  0.03477597236633301
local_in_edges_tensor generation:  0.03589510917663574
mini_batch_src_global generation:  0.05439400672912598
r_  generation:  0.5056524276733398
----------------------check_connections_block total spend ----------------------------- 5.868115186691284
generate_one_block  0.612008810043335
generate_one_block  0.6188502311706543
generate_one_block  0.6091353893280029
generate_one_block  0.6157219409942627
generate_one_block  0.6161601543426514
generate_one_block  0.6208949089050293
generate_one_block  0.6175837516784668
generate_one_block  0.6222114562988281
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13741016387939453  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

connection checking time:  10.230047225952148
block generation total time  8.871203184127808
average batch blocks generation time:  1.108900398015976
block dataloader generation time/epoch 21.200451493263245
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10495853424072266  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9524879455566406  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10430431365966797  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9527692794799805  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10396957397460938  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9453849792480469  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10523414611816406  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9517464637756348  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10451269149780273  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9486880302429199  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10567665100097656  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9510183334350586  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10429763793945312  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9464583396911621  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10496330261230469  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9519586563110352  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08133983612060547 |0.01735660433769226 |0.003844708204269409 |9.79006290435791e-05 |0.0035707950592041016 |0.002197742462158203 |
----------------------------------------------------------pseudo_mini_loss sum 1.2843211889266968
Total (block generation + training)time/epoch 22.13664424419403
Training time/epoch 0.9221670627593994
Training time without block to device /epoch 0.7833142280578613
Training time without total dataloading part /epoch 0.06230497360229492
load block tensor time/epoch 0.6507186889648438
block to device time/epoch 0.13885283470153809
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 23 |
Number of nodes for computation during this epoch:  3052744
Number of first layer input nodes during this epoch:  1297541
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1383981704711914  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02535104751586914
range selection method range initialization spend 0.012790203094482422
time for parepare:  0.018879175186157227
local_output_nid generation:  0.0027790069580078125
local_in_edges_tensor generation:  0.005253791809082031
mini_batch_src_global generation:  0.004247426986694336
r_  generation:  0.044671058654785156
local_output_nid generation:  0.003213644027709961
local_in_edges_tensor generation:  0.0034258365631103516
mini_batch_src_global generation:  0.005069732666015625
r_  generation:  0.04659008979797363
local_output_nid generation:  0.003160715103149414
local_in_edges_tensor generation:  0.001987457275390625
mini_batch_src_global generation:  0.0035941600799560547
r_  generation:  0.04656815528869629
local_output_nid generation:  0.003187417984008789
local_in_edges_tensor generation:  0.0018270015716552734
mini_batch_src_global generation:  0.0034673213958740234
r_  generation:  0.04725790023803711
local_output_nid generation:  0.003197193145751953
local_in_edges_tensor generation:  0.0018160343170166016
mini_batch_src_global generation:  0.0038328170776367188
r_  generation:  0.047492265701293945
local_output_nid generation:  0.0032014846801757812
local_in_edges_tensor generation:  0.0019099712371826172
mini_batch_src_global generation:  0.003774404525756836
r_  generation:  0.04880023002624512
local_output_nid generation:  0.003189563751220703
local_in_edges_tensor generation:  0.0018355846405029297
mini_batch_src_global generation:  0.003958225250244141
r_  generation:  0.04884505271911621
local_output_nid generation:  0.003204345703125
local_in_edges_tensor generation:  0.001867532730102539
mini_batch_src_global generation:  0.0038573741912841797
r_  generation:  0.04834151268005371
----------------------check_connections_block total spend ----------------------------- 0.5579602718353271
generate_one_block  0.06353306770324707
generate_one_block  0.06115531921386719
generate_one_block  0.060887813568115234
generate_one_block  0.06124305725097656
generate_one_block  0.06084179878234863
generate_one_block  0.06167459487915039
generate_one_block  0.06577682495117188
generate_one_block  0.06108593940734863
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.042665719985961914
gen group dst list time:  0.015444517135620117
time for parepare:  0.019320964813232422
local_output_nid generation:  0.011606216430664062
local_in_edges_tensor generation:  0.028485536575317383
mini_batch_src_global generation:  0.03792166709899902
r_  generation:  0.35532712936401367
local_output_nid generation:  0.01780414581298828
local_in_edges_tensor generation:  0.024680376052856445
mini_batch_src_global generation:  0.046515464782714844
r_  generation:  0.37561488151550293
local_output_nid generation:  0.018456459045410156
local_in_edges_tensor generation:  0.020364761352539062
mini_batch_src_global generation:  0.044379234313964844
r_  generation:  0.37475037574768066
local_output_nid generation:  0.018773555755615234
local_in_edges_tensor generation:  0.019676923751831055
mini_batch_src_global generation:  0.044936180114746094
r_  generation:  0.37787294387817383
local_output_nid generation:  0.019687414169311523
local_in_edges_tensor generation:  0.021038055419921875
mini_batch_src_global generation:  0.04617476463317871
r_  generation:  0.3837094306945801
local_output_nid generation:  0.019660472869873047
local_in_edges_tensor generation:  0.020737409591674805
mini_batch_src_global generation:  0.04609847068786621
r_  generation:  0.382737398147583
local_output_nid generation:  0.018819808959960938
local_in_edges_tensor generation:  0.02124619483947754
mini_batch_src_global generation:  0.04703378677368164
r_  generation:  0.38685011863708496
local_output_nid generation:  0.018411874771118164
local_in_edges_tensor generation:  0.0214846134185791
mini_batch_src_global generation:  0.048065900802612305
r_  generation:  0.3826134204864502
----------------------check_connections_block total spend ----------------------------- 4.355912923812866
generate_one_block  0.4936869144439697
generate_one_block  0.5025417804718018
generate_one_block  0.49413514137268066
generate_one_block  0.5058169364929199
generate_one_block  0.49697256088256836
generate_one_block  0.49100232124328613
generate_one_block  0.5015585422515869
generate_one_block  0.5215213298797607
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03631114959716797
gen group dst list time:  0.039412498474121094
time for parepare:  0.021215200424194336
local_output_nid generation:  0.027184247970581055
local_in_edges_tensor generation:  0.04848790168762207
mini_batch_src_global generation:  0.04354715347290039
r_  generation:  0.48583292961120605
local_output_nid generation:  0.03316783905029297
local_in_edges_tensor generation:  0.041434526443481445
mini_batch_src_global generation:  0.05600094795227051
r_  generation:  0.4866828918457031
local_output_nid generation:  0.03384828567504883
local_in_edges_tensor generation:  0.03567385673522949
mini_batch_src_global generation:  0.05700802803039551
r_  generation:  0.4935917854309082
local_output_nid generation:  0.034799814224243164
local_in_edges_tensor generation:  0.03714323043823242
mini_batch_src_global generation:  0.05471992492675781
r_  generation:  0.4972536563873291
local_output_nid generation:  0.03435087203979492
local_in_edges_tensor generation:  0.03603696823120117
mini_batch_src_global generation:  0.054390668869018555
r_  generation:  0.5015826225280762
local_output_nid generation:  0.03486323356628418
local_in_edges_tensor generation:  0.03651285171508789
mini_batch_src_global generation:  0.055299997329711914
r_  generation:  0.5038914680480957
local_output_nid generation:  0.03487420082092285
local_in_edges_tensor generation:  0.03645157814025879
mini_batch_src_global generation:  0.054747819900512695
r_  generation:  0.508497953414917
local_output_nid generation:  0.036267995834350586
local_in_edges_tensor generation:  0.04181861877441406
mini_batch_src_global generation:  0.05563664436340332
r_  generation:  0.5055868625640869
----------------------check_connections_block total spend ----------------------------- 5.920310735702515
generate_one_block  0.6310520172119141
generate_one_block  0.6250584125518799
generate_one_block  0.6186871528625488
generate_one_block  0.6192324161529541
generate_one_block  0.6154985427856445
generate_one_block  0.6173803806304932
generate_one_block  0.6206257343292236
generate_one_block  0.6232805252075195
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1383981704711914  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

connection checking time:  10.27622365951538
block generation total time  8.978050708770752
average batch blocks generation time:  1.122256338596344
block dataloader generation time/epoch 21.20528907775879
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10410547256469727  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9463200569152832  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10506629943847656  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9504141807556152  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10413360595703125  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.950188159942627  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1050567626953125  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9513287544250488  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10428190231323242  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9492158889770508  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1055593490600586  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9522027969360352  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10456228256225586  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9525532722473145  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10382556915283203  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9520711898803711  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08484917879104614 |0.016541242599487305 |0.003527909517288208 |9.059906005859375e-05 |0.003870725631713867 |0.0029113292694091797 |
----------------------------------------------------------pseudo_mini_loss sum 1.2680836915969849
Total (block generation + training)time/epoch 22.1422598361969
Training time/epoch 0.9475946426391602
Training time without block to device /epoch 0.8152647018432617
Training time without total dataloading part /epoch 0.06282520294189453
load block tensor time/epoch 0.6787934303283691
block to device time/epoch 0.13232994079589844
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 24 |
Number of nodes for computation during this epoch:  3054529
Number of first layer input nodes during this epoch:  1297825
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13695573806762695  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.029995441436767578
range selection method range initialization spend 0.012157201766967773
time for parepare:  0.017116308212280273
local_output_nid generation:  0.00276947021484375
local_in_edges_tensor generation:  0.007767677307128906
mini_batch_src_global generation:  0.003367900848388672
r_  generation:  0.04497194290161133
local_output_nid generation:  0.0032052993774414062
local_in_edges_tensor generation:  0.0017867088317871094
mini_batch_src_global generation:  0.005033016204833984
r_  generation:  0.047321319580078125
local_output_nid generation:  0.0031473636627197266
local_in_edges_tensor generation:  0.0017883777618408203
mini_batch_src_global generation:  0.003604412078857422
r_  generation:  0.046218156814575195
local_output_nid generation:  0.0031270980834960938
local_in_edges_tensor generation:  0.0018126964569091797
mini_batch_src_global generation:  0.0033736228942871094
r_  generation:  0.047692298889160156
local_output_nid generation:  0.003204345703125
local_in_edges_tensor generation:  0.0018029212951660156
mini_batch_src_global generation:  0.0037310123443603516
r_  generation:  0.04877281188964844
local_output_nid generation:  0.003188610076904297
local_in_edges_tensor generation:  0.0017933845520019531
mini_batch_src_global generation:  0.003784656524658203
r_  generation:  0.04989504814147949
local_output_nid generation:  0.0031659603118896484
local_in_edges_tensor generation:  0.001836538314819336
mini_batch_src_global generation:  0.003929853439331055
r_  generation:  0.04781484603881836
local_output_nid generation:  0.003205537796020508
local_in_edges_tensor generation:  0.001817941665649414
mini_batch_src_global generation:  0.003826141357421875
r_  generation:  0.04987597465515137
----------------------check_connections_block total spend ----------------------------- 0.5562169551849365
generate_one_block  0.05992484092712402
generate_one_block  0.0628211498260498
generate_one_block  0.06091022491455078
generate_one_block  0.06089639663696289
generate_one_block  0.06216263771057129
generate_one_block  0.062314510345458984
generate_one_block  0.06385302543640137
generate_one_block  0.062496185302734375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03688383102416992
gen group dst list time:  0.015485048294067383
time for parepare:  0.019881010055541992
local_output_nid generation:  0.01150655746459961
local_in_edges_tensor generation:  0.028898239135742188
mini_batch_src_global generation:  0.0366055965423584
r_  generation:  0.373795747756958
local_output_nid generation:  0.017786502838134766
local_in_edges_tensor generation:  0.022318363189697266
mini_batch_src_global generation:  0.04557013511657715
r_  generation:  0.38247251510620117
local_output_nid generation:  0.01844000816345215
local_in_edges_tensor generation:  0.022821664810180664
mini_batch_src_global generation:  0.04405546188354492
r_  generation:  0.37761735916137695
local_output_nid generation:  0.018775463104248047
local_in_edges_tensor generation:  0.019086599349975586
mini_batch_src_global generation:  0.044764041900634766
r_  generation:  0.3831033706665039
local_output_nid generation:  0.01950979232788086
local_in_edges_tensor generation:  0.019659757614135742
mini_batch_src_global generation:  0.04656195640563965
r_  generation:  0.3882412910461426
local_output_nid generation:  0.019353628158569336
local_in_edges_tensor generation:  0.02097940444946289
mini_batch_src_global generation:  0.04672956466674805
r_  generation:  0.3853609561920166
local_output_nid generation:  0.018128156661987305
local_in_edges_tensor generation:  0.020421504974365234
mini_batch_src_global generation:  0.046566009521484375
r_  generation:  0.3825669288635254
local_output_nid generation:  0.018399953842163086
local_in_edges_tensor generation:  0.02118682861328125
mini_batch_src_global generation:  0.046736955642700195
r_  generation:  0.38262224197387695
----------------------check_connections_block total spend ----------------------------- 4.38639235496521
generate_one_block  0.49128007888793945
generate_one_block  0.5012025833129883
generate_one_block  0.4809565544128418
generate_one_block  0.4889366626739502
generate_one_block  0.4971158504486084
generate_one_block  0.49008727073669434
generate_one_block  0.4878842830657959
generate_one_block  0.5155234336853027
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02771306037902832
gen group dst list time:  0.040009260177612305
time for parepare:  0.020521879196166992
local_output_nid generation:  0.026721715927124023
local_in_edges_tensor generation:  0.04219937324523926
mini_batch_src_global generation:  0.04604625701904297
r_  generation:  0.48531508445739746
local_output_nid generation:  0.033911705017089844
local_in_edges_tensor generation:  0.0384218692779541
mini_batch_src_global generation:  0.05749797821044922
r_  generation:  0.4858131408691406
local_output_nid generation:  0.03375887870788574
local_in_edges_tensor generation:  0.03203916549682617
mini_batch_src_global generation:  0.05722689628601074
r_  generation:  0.49285244941711426
local_output_nid generation:  0.03471112251281738
local_in_edges_tensor generation:  0.03485751152038574
mini_batch_src_global generation:  0.0528562068939209
r_  generation:  0.49582505226135254
local_output_nid generation:  0.03546738624572754
local_in_edges_tensor generation:  0.04141116142272949
mini_batch_src_global generation:  0.05412578582763672
r_  generation:  0.49965453147888184
local_output_nid generation:  0.03477883338928223
local_in_edges_tensor generation:  0.03668069839477539
mini_batch_src_global generation:  0.05394577980041504
r_  generation:  0.50614333152771
local_output_nid generation:  0.03511500358581543
local_in_edges_tensor generation:  0.03405046463012695
mini_batch_src_global generation:  0.05483293533325195
r_  generation:  0.5216550827026367
local_output_nid generation:  0.0381014347076416
local_in_edges_tensor generation:  0.03679084777832031
mini_batch_src_global generation:  0.059769630432128906
r_  generation:  0.5096044540405273
----------------------check_connections_block total spend ----------------------------- 5.912088394165039
generate_one_block  0.6137666702270508
generate_one_block  0.6210246086120605
generate_one_block  0.6137239933013916
generate_one_block  0.6150000095367432
generate_one_block  0.6187102794647217
generate_one_block  0.6160616874694824
generate_one_block  0.6160478591918945
generate_one_block  0.6221089363098145
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13695573806762695  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

connection checking time:  10.298480749130249
block generation total time  8.88943076133728
average batch blocks generation time:  1.11117884516716
block dataloader generation time/epoch 21.205134510993958
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10509300231933594  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9512553215026855  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10412836074829102  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9503946304321289  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10492753982543945  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9467320442199707  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10455894470214844  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9498944282531738  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10535764694213867  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9553780555725098  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1042327880859375  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9505395889282227  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10487556457519531  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9451718330383301  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10413312911987305  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9498977661132812  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08630013465881348 |0.015590161085128784 |0.0035451650619506836 |9.199976921081543e-05 |0.0037864744663238525 |0.001512289047241211 |
----------------------------------------------------------pseudo_mini_loss sum 1.2610232830047607
Total (block generation + training)time/epoch 22.14301723241806
Training time/epoch 0.9512925148010254
Training time without block to device /epoch 0.8265712261199951
Training time without total dataloading part /epoch 0.06090140342712402
load block tensor time/epoch 0.6904010772705078
block to device time/epoch 0.12472128868103027
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 25 |
Number of nodes for computation during this epoch:  3053383
Number of first layer input nodes during this epoch:  1297576
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13764572143554688  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024425506591796875
range selection method range initialization spend 0.01216268539428711
time for parepare:  0.016277313232421875
local_output_nid generation:  0.002735137939453125
local_in_edges_tensor generation:  0.008365392684936523
mini_batch_src_global generation:  0.0033545494079589844
r_  generation:  0.04451918601989746
local_output_nid generation:  0.0031108856201171875
local_in_edges_tensor generation:  0.0019750595092773438
mini_batch_src_global generation:  0.0053288936614990234
r_  generation:  0.04508256912231445
local_output_nid generation:  0.0031223297119140625
local_in_edges_tensor generation:  0.0018310546875
mini_batch_src_global generation:  0.003544330596923828
r_  generation:  0.045734405517578125
local_output_nid generation:  0.0031714439392089844
local_in_edges_tensor generation:  0.0018296241760253906
mini_batch_src_global generation:  0.0035257339477539062
r_  generation:  0.04688572883605957
local_output_nid generation:  0.0031769275665283203
local_in_edges_tensor generation:  0.0018088817596435547
mini_batch_src_global generation:  0.003718852996826172
r_  generation:  0.0477139949798584
local_output_nid generation:  0.0031538009643554688
local_in_edges_tensor generation:  0.0018301010131835938
mini_batch_src_global generation:  0.0038213729858398438
r_  generation:  0.04837346076965332
local_output_nid generation:  0.0031824111938476562
local_in_edges_tensor generation:  0.0018565654754638672
mini_batch_src_global generation:  0.003962993621826172
r_  generation:  0.047869205474853516
local_output_nid generation:  0.0031538009643554688
local_in_edges_tensor generation:  0.0018067359924316406
mini_batch_src_global generation:  0.0037488937377929688
r_  generation:  0.04773831367492676
----------------------check_connections_block total spend ----------------------------- 0.5477199554443359
generate_one_block  0.05976605415344238
generate_one_block  0.062227725982666016
generate_one_block  0.06117892265319824
generate_one_block  0.06211447715759277
generate_one_block  0.06188774108886719
generate_one_block  0.062368154525756836
generate_one_block  0.0644688606262207
generate_one_block  0.06152200698852539
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03673267364501953
gen group dst list time:  0.015312671661376953
time for parepare:  0.020193815231323242
local_output_nid generation:  0.01162266731262207
local_in_edges_tensor generation:  0.032171010971069336
mini_batch_src_global generation:  0.03657412528991699
r_  generation:  0.36168456077575684
local_output_nid generation:  0.01780223846435547
local_in_edges_tensor generation:  0.01966118812561035
mini_batch_src_global generation:  0.04493236541748047
r_  generation:  0.3735642433166504
local_output_nid generation:  0.0185091495513916
local_in_edges_tensor generation:  0.019353628158569336
mini_batch_src_global generation:  0.04508042335510254
r_  generation:  0.37639451026916504
local_output_nid generation:  0.01868462562561035
local_in_edges_tensor generation:  0.019064903259277344
mini_batch_src_global generation:  0.04574751853942871
r_  generation:  0.37985801696777344
local_output_nid generation:  0.019261837005615234
local_in_edges_tensor generation:  0.02035379409790039
mini_batch_src_global generation:  0.04699230194091797
r_  generation:  0.38414883613586426
local_output_nid generation:  0.019633054733276367
local_in_edges_tensor generation:  0.0214993953704834
mini_batch_src_global generation:  0.04696369171142578
r_  generation:  0.387758731842041
local_output_nid generation:  0.018321752548217773
local_in_edges_tensor generation:  0.019849061965942383
mini_batch_src_global generation:  0.04731130599975586
r_  generation:  0.38242030143737793
local_output_nid generation:  0.01831817626953125
local_in_edges_tensor generation:  0.019918203353881836
mini_batch_src_global generation:  0.04642748832702637
r_  generation:  0.37468886375427246
----------------------check_connections_block total spend ----------------------------- 4.346680402755737
generate_one_block  0.4926278591156006
generate_one_block  0.488753080368042
generate_one_block  0.48992371559143066
generate_one_block  0.4949679374694824
generate_one_block  0.4985086917877197
generate_one_block  0.49924802780151367
generate_one_block  0.49367475509643555
generate_one_block  0.5079708099365234
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030193328857421875
gen group dst list time:  0.03920388221740723
time for parepare:  0.01888561248779297
local_output_nid generation:  0.026042461395263672
local_in_edges_tensor generation:  0.0401616096496582
mini_batch_src_global generation:  0.04426717758178711
r_  generation:  0.4836466312408447
local_output_nid generation:  0.03310728073120117
local_in_edges_tensor generation:  0.03650665283203125
mini_batch_src_global generation:  0.05508112907409668
r_  generation:  0.4873661994934082
local_output_nid generation:  0.03391218185424805
local_in_edges_tensor generation:  0.03417491912841797
mini_batch_src_global generation:  0.05516505241394043
r_  generation:  0.49173974990844727
local_output_nid generation:  0.034393310546875
local_in_edges_tensor generation:  0.03413128852844238
mini_batch_src_global generation:  0.05335187911987305
r_  generation:  0.4975602626800537
local_output_nid generation:  0.03499555587768555
local_in_edges_tensor generation:  0.031807899475097656
mini_batch_src_global generation:  0.05409550666809082
r_  generation:  0.5003018379211426
local_output_nid generation:  0.0352168083190918
local_in_edges_tensor generation:  0.035446882247924805
mini_batch_src_global generation:  0.054292917251586914
r_  generation:  0.5013184547424316
local_output_nid generation:  0.03795003890991211
local_in_edges_tensor generation:  0.03181099891662598
mini_batch_src_global generation:  0.053931236267089844
r_  generation:  0.5051007270812988
local_output_nid generation:  0.03518962860107422
local_in_edges_tensor generation:  0.03237485885620117
mini_batch_src_global generation:  0.055118560791015625
r_  generation:  0.5022523403167725
----------------------check_connections_block total spend ----------------------------- 5.844608545303345
generate_one_block  0.6192233562469482
generate_one_block  0.6147534847259521
generate_one_block  0.622328519821167
generate_one_block  0.6142735481262207
generate_one_block  0.6278612613677979
generate_one_block  0.6410598754882812
generate_one_block  0.6170141696929932
generate_one_block  0.6131362915039062
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13764572143554688  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

connection checking time:  10.191288948059082
block generation total time  8.935325384140015
average batch blocks generation time:  1.1169156730175018
block dataloader generation time/epoch 21.200832352918738
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10516166687011719  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9512100219726562  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10447406768798828  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9503865242004395  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10510540008544922  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9514193534851074  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10443639755249023  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9496445655822754  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10521602630615234  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9527983665466309  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10438013076782227  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9530658721923828  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10507726669311523  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9514613151550293  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10427331924438477  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9491920471191406  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08586767315864563 |0.01503366231918335 |0.003447413444519043 |8.878111839294434e-05 |0.003744274377822876 |0.0023314952850341797 |
----------------------------------------------------------pseudo_mini_loss sum 1.2469168901443481
Total (block generation + training)time/epoch 22.138977625790766
Training time/epoch 0.9421749114990234
Training time without block to device /epoch 0.8219056129455566
Training time without total dataloading part /epoch 0.060575246810913086
load block tensor time/epoch 0.686941385269165
block to device time/epoch 0.1202692985534668
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 26 |
Number of nodes for computation during this epoch:  3055752
Number of first layer input nodes during this epoch:  1297870
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13785362243652344  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026461362838745117
range selection method range initialization spend 0.012605905532836914
time for parepare:  0.01622772216796875
local_output_nid generation:  0.0027413368225097656
local_in_edges_tensor generation:  0.0042307376861572266
mini_batch_src_global generation:  0.003270864486694336
r_  generation:  0.04446244239807129
local_output_nid generation:  0.003103017807006836
local_in_edges_tensor generation:  0.0017635822296142578
mini_batch_src_global generation:  0.0050258636474609375
r_  generation:  0.045224905014038086
local_output_nid generation:  0.003275156021118164
local_in_edges_tensor generation:  0.0018193721771240234
mini_batch_src_global generation:  0.0034041404724121094
r_  generation:  0.04687070846557617
local_output_nid generation:  0.0032112598419189453
local_in_edges_tensor generation:  0.0018270015716552734
mini_batch_src_global generation:  0.0035398006439208984
r_  generation:  0.0474703311920166
local_output_nid generation:  0.003205537796020508
local_in_edges_tensor generation:  0.001928567886352539
mini_batch_src_global generation:  0.0037703514099121094
r_  generation:  0.0473933219909668
local_output_nid generation:  0.003215789794921875
local_in_edges_tensor generation:  0.0018281936645507812
mini_batch_src_global generation:  0.0038139820098876953
r_  generation:  0.0486140251159668
local_output_nid generation:  0.003267526626586914
local_in_edges_tensor generation:  0.001832723617553711
mini_batch_src_global generation:  0.003984689712524414
r_  generation:  0.04921150207519531
local_output_nid generation:  0.0032508373260498047
local_in_edges_tensor generation:  0.0018475055694580078
mini_batch_src_global generation:  0.003844022750854492
r_  generation:  0.04764699935913086
----------------------check_connections_block total spend ----------------------------- 0.5468504428863525
generate_one_block  0.05973982810974121
generate_one_block  0.06149101257324219
generate_one_block  0.0617372989654541
generate_one_block  0.062216997146606445
generate_one_block  0.061620473861694336
generate_one_block  0.06221485137939453
generate_one_block  0.06615996360778809
generate_one_block  0.06124687194824219
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03661179542541504
gen group dst list time:  0.01512765884399414
time for parepare:  0.019449949264526367
local_output_nid generation:  0.01134037971496582
local_in_edges_tensor generation:  0.024779319763183594
mini_batch_src_global generation:  0.0376126766204834
r_  generation:  0.3582766056060791
local_output_nid generation:  0.01789116859436035
local_in_edges_tensor generation:  0.020380735397338867
mini_batch_src_global generation:  0.04530787467956543
r_  generation:  0.3740725517272949
local_output_nid generation:  0.018542766571044922
local_in_edges_tensor generation:  0.021585941314697266
mini_batch_src_global generation:  0.04477047920227051
r_  generation:  0.3760979175567627
local_output_nid generation:  0.018758296966552734
local_in_edges_tensor generation:  0.021619319915771484
mini_batch_src_global generation:  0.046392202377319336
r_  generation:  0.38615846633911133
local_output_nid generation:  0.01938796043395996
local_in_edges_tensor generation:  0.02249932289123535
mini_batch_src_global generation:  0.04671931266784668
r_  generation:  0.3814365863800049
local_output_nid generation:  0.019405841827392578
local_in_edges_tensor generation:  0.019658565521240234
mini_batch_src_global generation:  0.0467679500579834
r_  generation:  0.3816392421722412
local_output_nid generation:  0.019038915634155273
local_in_edges_tensor generation:  0.02181410789489746
mini_batch_src_global generation:  0.04744267463684082
r_  generation:  0.38878297805786133
local_output_nid generation:  0.018204450607299805
local_in_edges_tensor generation:  0.020491600036621094
mini_batch_src_global generation:  0.04624533653259277
r_  generation:  0.3750762939453125
----------------------check_connections_block total spend ----------------------------- 4.3491339683532715
generate_one_block  0.4831080436706543
generate_one_block  0.5015261173248291
generate_one_block  0.4874598979949951
generate_one_block  0.4945847988128662
generate_one_block  0.4909834861755371
generate_one_block  0.4902989864349365
generate_one_block  0.49745821952819824
generate_one_block  0.5098130702972412
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03250408172607422
gen group dst list time:  0.0391538143157959
time for parepare:  0.01871657371520996
local_output_nid generation:  0.02761101722717285
local_in_edges_tensor generation:  0.054502248764038086
mini_batch_src_global generation:  0.046228647232055664
r_  generation:  0.4789421558380127
local_output_nid generation:  0.03454709053039551
local_in_edges_tensor generation:  0.04027390480041504
mini_batch_src_global generation:  0.05545949935913086
r_  generation:  0.48368024826049805
local_output_nid generation:  0.03429889678955078
local_in_edges_tensor generation:  0.03166055679321289
mini_batch_src_global generation:  0.05460405349731445
r_  generation:  0.4883296489715576
local_output_nid generation:  0.03430795669555664
local_in_edges_tensor generation:  0.034676551818847656
mini_batch_src_global generation:  0.05610203742980957
r_  generation:  0.4929625988006592
local_output_nid generation:  0.03441333770751953
local_in_edges_tensor generation:  0.03460049629211426
mini_batch_src_global generation:  0.05464506149291992
r_  generation:  0.49655699729919434
local_output_nid generation:  0.03462672233581543
local_in_edges_tensor generation:  0.031160831451416016
mini_batch_src_global generation:  0.05434775352478027
r_  generation:  0.5031676292419434
local_output_nid generation:  0.034555673599243164
local_in_edges_tensor generation:  0.032315969467163086
mini_batch_src_global generation:  0.05518746376037598
r_  generation:  0.503201961517334
local_output_nid generation:  0.034685611724853516
local_in_edges_tensor generation:  0.034143924713134766
mini_batch_src_global generation:  0.05536842346191406
r_  generation:  0.5011136531829834
----------------------check_connections_block total spend ----------------------------- 5.849973678588867
generate_one_block  0.6206598281860352
generate_one_block  0.627561092376709
generate_one_block  0.6123058795928955
generate_one_block  0.6195023059844971
generate_one_block  0.6216161251068115
generate_one_block  0.6174423694610596
generate_one_block  0.6211183071136475
generate_one_block  0.6116940975189209
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13785362243652344  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

connection checking time:  10.199107646942139
block generation total time  8.907132625579834
average batch blocks generation time:  1.1133915781974792
block dataloader generation time/epoch 21.194056736098396
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10507440567016602  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9473466873168945  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10458660125732422  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9511799812316895  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1049346923828125  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9501233100891113  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1042637825012207  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9515705108642578  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10447263717651367  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9471864700317383  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10411643981933594  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9498696327209473  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10556983947753906  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9559359550476074  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10353469848632812  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9464268684387207  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08801931142807007 |0.01351255178451538 |0.003508448600769043 |9.000301361083984e-05 |0.003811269998550415 |0.0016808509826660156 |
----------------------------------------------------------pseudo_mini_loss sum 1.234240174293518
Total (block generation + training)time/epoch 22.132843759324814
Training time/epoch 0.949514627456665
Training time without block to device /epoch 0.841414213180542
Training time without total dataloading part /epoch 0.0609586238861084
load block tensor time/epoch 0.7041544914245605
block to device time/epoch 0.10810041427612305
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 27 |
Number of nodes for computation during this epoch:  3053165
Number of first layer input nodes during this epoch:  1297129
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1369948387145996  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.017358064651489258
range selection method range initialization spend 0.012436151504516602
time for parepare:  0.016906261444091797
local_output_nid generation:  0.002739429473876953
local_in_edges_tensor generation:  0.004071950912475586
mini_batch_src_global generation:  0.0034220218658447266
r_  generation:  0.044924020767211914
local_output_nid generation:  0.0031244754791259766
local_in_edges_tensor generation:  0.001779317855834961
mini_batch_src_global generation:  0.004912376403808594
r_  generation:  0.04465508460998535
local_output_nid generation:  0.003196239471435547
local_in_edges_tensor generation:  0.0018045902252197266
mini_batch_src_global generation:  0.0034880638122558594
r_  generation:  0.046183109283447266
local_output_nid generation:  0.003178834915161133
local_in_edges_tensor generation:  0.0018181800842285156
mini_batch_src_global generation:  0.0036246776580810547
r_  generation:  0.04837965965270996
local_output_nid generation:  0.003218412399291992
local_in_edges_tensor generation:  0.0018851757049560547
mini_batch_src_global generation:  0.0037479400634765625
r_  generation:  0.04768800735473633
local_output_nid generation:  0.0031995773315429688
local_in_edges_tensor generation:  0.0018286705017089844
mini_batch_src_global generation:  0.0038259029388427734
r_  generation:  0.04886031150817871
local_output_nid generation:  0.003221273422241211
local_in_edges_tensor generation:  0.00180816650390625
mini_batch_src_global generation:  0.003924846649169922
r_  generation:  0.04860353469848633
local_output_nid generation:  0.0032825469970703125
local_in_edges_tensor generation:  0.001852273941040039
mini_batch_src_global generation:  0.0037689208984375
r_  generation:  0.04756045341491699
----------------------check_connections_block total spend ----------------------------- 0.5476624965667725
generate_one_block  0.06002354621887207
generate_one_block  0.05990099906921387
generate_one_block  0.0619962215423584
generate_one_block  0.0639197826385498
generate_one_block  0.06154823303222656
generate_one_block  0.06207847595214844
generate_one_block  0.0648660659790039
generate_one_block  0.0610959529876709
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03453779220581055
gen group dst list time:  0.01526498794555664
time for parepare:  0.019193410873413086
local_output_nid generation:  0.011845588684082031
local_in_edges_tensor generation:  0.02878284454345703
mini_batch_src_global generation:  0.03793644905090332
r_  generation:  0.36240482330322266
local_output_nid generation:  0.017491817474365234
local_in_edges_tensor generation:  0.018435239791870117
mini_batch_src_global generation:  0.04448246955871582
r_  generation:  0.36431336402893066
local_output_nid generation:  0.018592357635498047
local_in_edges_tensor generation:  0.01898336410522461
mini_batch_src_global generation:  0.04468536376953125
r_  generation:  0.37542200088500977
local_output_nid generation:  0.018899917602539062
local_in_edges_tensor generation:  0.021049976348876953
mini_batch_src_global generation:  0.04530072212219238
r_  generation:  0.38312649726867676
local_output_nid generation:  0.01955246925354004
local_in_edges_tensor generation:  0.020969867706298828
mini_batch_src_global generation:  0.04761910438537598
r_  generation:  0.3816657066345215
local_output_nid generation:  0.019402742385864258
local_in_edges_tensor generation:  0.019455671310424805
mini_batch_src_global generation:  0.047109127044677734
r_  generation:  0.38366246223449707
local_output_nid generation:  0.01852107048034668
local_in_edges_tensor generation:  0.02084636688232422
mini_batch_src_global generation:  0.047347068786621094
r_  generation:  0.38216280937194824
local_output_nid generation:  0.018275737762451172
local_in_edges_tensor generation:  0.020152568817138672
mini_batch_src_global generation:  0.04648303985595703
r_  generation:  0.3813467025756836
----------------------check_connections_block total spend ----------------------------- 4.338534593582153
generate_one_block  0.49843645095825195
generate_one_block  0.48606228828430176
generate_one_block  0.4995138645172119
generate_one_block  0.4980483055114746
generate_one_block  0.49416065216064453
generate_one_block  0.4915275573730469
generate_one_block  0.4925405979156494
generate_one_block  0.5033626556396484
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.06842327117919922
gen group dst list time:  0.03919672966003418
time for parepare:  0.018864154815673828
local_output_nid generation:  0.027017593383789062
local_in_edges_tensor generation:  0.038953542709350586
mini_batch_src_global generation:  0.045300960540771484
r_  generation:  0.48488450050354004
local_output_nid generation:  0.034073829650878906
local_in_edges_tensor generation:  0.030963420867919922
mini_batch_src_global generation:  0.055963993072509766
r_  generation:  0.4858846664428711
local_output_nid generation:  0.03498411178588867
local_in_edges_tensor generation:  0.03172421455383301
mini_batch_src_global generation:  0.05593419075012207
r_  generation:  0.4894537925720215
local_output_nid generation:  0.03517603874206543
local_in_edges_tensor generation:  0.03519392013549805
mini_batch_src_global generation:  0.05382513999938965
r_  generation:  0.4953122138977051
local_output_nid generation:  0.0352330207824707
local_in_edges_tensor generation:  0.0324859619140625
mini_batch_src_global generation:  0.054102420806884766
r_  generation:  0.4941861629486084
local_output_nid generation:  0.03555154800415039
local_in_edges_tensor generation:  0.03186845779418945
mini_batch_src_global generation:  0.05453228950500488
r_  generation:  0.5003719329833984
local_output_nid generation:  0.0356898307800293
local_in_edges_tensor generation:  0.03182220458984375
mini_batch_src_global generation:  0.054897308349609375
r_  generation:  0.4994542598724365
local_output_nid generation:  0.03735756874084473
local_in_edges_tensor generation:  0.03234720230102539
mini_batch_src_global generation:  0.05731821060180664
r_  generation:  0.5050983428955078
----------------------check_connections_block total spend ----------------------------- 5.830335378646851
generate_one_block  0.6159682273864746
generate_one_block  0.6116466522216797
generate_one_block  0.6178178787231445
generate_one_block  0.6206810474395752
generate_one_block  0.6153056621551514
generate_one_block  0.6184756755828857
generate_one_block  0.6180500984191895
generate_one_block  0.618394136428833
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1369948387145996  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

connection checking time:  10.168869972229004
block generation total time  8.899991750717163
average batch blocks generation time:  1.1124989688396454
block dataloader generation time/epoch 21.18726276096545
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10531139373779297  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9534730911254883  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1040334701538086  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.943751335144043  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10552644729614258  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9500899314880371  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10462188720703125  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9543075561523438  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10503435134887695  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9519510269165039  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10424423217773438  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9510669708251953  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1051645278930664  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9521622657775879  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10395479202270508  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9499354362487793  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08048614859580994 |0.012695252895355225 |0.003322422504425049 |8.723139762878418e-05 |0.0031230151653289795 |0.0016303062438964844 |
----------------------------------------------------------pseudo_mini_loss sum 1.2273792028427124
Total (block generation + training)time/epoch 22.122678355166787
Training time/epoch 0.8745207786560059
Training time without block to device /epoch 0.7729587554931641
Training time without total dataloading part /epoch 0.053891658782958984
load block tensor time/epoch 0.6438891887664795
block to device time/epoch 0.1015620231628418
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 28 |
Number of nodes for computation during this epoch:  3055515
Number of first layer input nodes during this epoch:  1297780
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13742876052856445  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021299123764038086
range selection method range initialization spend 0.015598058700561523
time for parepare:  0.01647472381591797
local_output_nid generation:  0.0027093887329101562
local_in_edges_tensor generation:  0.004130840301513672
mini_batch_src_global generation:  0.004168987274169922
r_  generation:  0.04595136642456055
local_output_nid generation:  0.003106355667114258
local_in_edges_tensor generation:  0.0017697811126708984
mini_batch_src_global generation:  0.005021572113037109
r_  generation:  0.04452180862426758
local_output_nid generation:  0.0032095909118652344
local_in_edges_tensor generation:  0.001773834228515625
mini_batch_src_global generation:  0.0034084320068359375
r_  generation:  0.04526948928833008
local_output_nid generation:  0.0032548904418945312
local_in_edges_tensor generation:  0.0018122196197509766
mini_batch_src_global generation:  0.0036003589630126953
r_  generation:  0.04686403274536133
local_output_nid generation:  0.003167867660522461
local_in_edges_tensor generation:  0.0018019676208496094
mini_batch_src_global generation:  0.003766298294067383
r_  generation:  0.04831290245056152
local_output_nid generation:  0.003239870071411133
local_in_edges_tensor generation:  0.0018551349639892578
mini_batch_src_global generation:  0.0038123130798339844
r_  generation:  0.04776573181152344
local_output_nid generation:  0.0031960010528564453
local_in_edges_tensor generation:  0.0018329620361328125
mini_batch_src_global generation:  0.004018545150756836
r_  generation:  0.04853177070617676
local_output_nid generation:  0.0031964778900146484
local_in_edges_tensor generation:  0.0018181800842285156
mini_batch_src_global generation:  0.003801584243774414
r_  generation:  0.048200130462646484
----------------------check_connections_block total spend ----------------------------- 0.547360897064209
generate_one_block  0.06056046485900879
generate_one_block  0.060739994049072266
generate_one_block  0.06004214286804199
generate_one_block  0.06150627136230469
generate_one_block  0.061873674392700195
generate_one_block  0.06132912635803223
generate_one_block  0.06454324722290039
generate_one_block  0.06155276298522949
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0388031005859375
gen group dst list time:  0.014991998672485352
time for parepare:  0.019902467727661133
local_output_nid generation:  0.012003183364868164
local_in_edges_tensor generation:  0.025430679321289062
mini_batch_src_global generation:  0.036713600158691406
r_  generation:  0.36348390579223633
local_output_nid generation:  0.01779341697692871
local_in_edges_tensor generation:  0.019858121871948242
mini_batch_src_global generation:  0.04496645927429199
r_  generation:  0.3736257553100586
local_output_nid generation:  0.01827716827392578
local_in_edges_tensor generation:  0.02378058433532715
mini_batch_src_global generation:  0.043976545333862305
r_  generation:  0.370849609375
local_output_nid generation:  0.018804550170898438
local_in_edges_tensor generation:  0.020994901657104492
mini_batch_src_global generation:  0.045319318771362305
r_  generation:  0.3755667209625244
local_output_nid generation:  0.0194399356842041
local_in_edges_tensor generation:  0.02100348472595215
mini_batch_src_global generation:  0.046489715576171875
r_  generation:  0.3826768398284912
local_output_nid generation:  0.01971578598022461
local_in_edges_tensor generation:  0.0213315486907959
mini_batch_src_global generation:  0.04666280746459961
r_  generation:  0.3848423957824707
local_output_nid generation:  0.022319555282592773
local_in_edges_tensor generation:  0.02759838104248047
mini_batch_src_global generation:  0.04747462272644043
r_  generation:  0.38452672958374023
local_output_nid generation:  0.01870131492614746
local_in_edges_tensor generation:  0.025101900100708008
mini_batch_src_global generation:  0.047197580337524414
r_  generation:  0.38381123542785645
----------------------check_connections_block total spend ----------------------------- 4.36362099647522
generate_one_block  0.4937257766723633
generate_one_block  0.488983154296875
generate_one_block  0.48523402214050293
generate_one_block  0.487598180770874
generate_one_block  0.4922807216644287
generate_one_block  0.4913978576660156
generate_one_block  0.4910705089569092
generate_one_block  0.517681360244751
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.026919841766357422
gen group dst list time:  0.03918933868408203
time for parepare:  0.019072771072387695
local_output_nid generation:  0.02774786949157715
local_in_edges_tensor generation:  0.03806567192077637
mini_batch_src_global generation:  0.04321765899658203
r_  generation:  0.48679447174072266
local_output_nid generation:  0.03374028205871582
local_in_edges_tensor generation:  0.030739784240722656
mini_batch_src_global generation:  0.05505537986755371
r_  generation:  0.4902467727661133
local_output_nid generation:  0.03429841995239258
local_in_edges_tensor generation:  0.031491756439208984
mini_batch_src_global generation:  0.05484175682067871
r_  generation:  0.4936048984527588
local_output_nid generation:  0.035190582275390625
local_in_edges_tensor generation:  0.03603339195251465
mini_batch_src_global generation:  0.05496501922607422
r_  generation:  0.4993600845336914
local_output_nid generation:  0.03528237342834473
local_in_edges_tensor generation:  0.03404688835144043
mini_batch_src_global generation:  0.05436372756958008
r_  generation:  0.49759435653686523
local_output_nid generation:  0.035379886627197266
local_in_edges_tensor generation:  0.03235316276550293
mini_batch_src_global generation:  0.05436968803405762
r_  generation:  0.5044643878936768
local_output_nid generation:  0.03535175323486328
local_in_edges_tensor generation:  0.034358978271484375
mini_batch_src_global generation:  0.05470919609069824
r_  generation:  0.5050349235534668
local_output_nid generation:  0.03551912307739258
local_in_edges_tensor generation:  0.0321660041809082
mini_batch_src_global generation:  0.05517292022705078
r_  generation:  0.5050139427185059
----------------------check_connections_block total spend ----------------------------- 5.85167670249939
generate_one_block  0.6272518634796143
generate_one_block  0.6246955394744873
generate_one_block  0.6189289093017578
generate_one_block  0.6254510879516602
generate_one_block  0.6336441040039062
generate_one_block  0.6220171451568604
generate_one_block  0.6290915012359619
generate_one_block  0.6378846168518066
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13742876052856445  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

connection checking time:  10.21529769897461
block generation total time  8.966936349868774
average batch blocks generation time:  1.1208670437335968
block dataloader generation time/epoch 21.18478704690933
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10536003112792969  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.953984260559082  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1042170524597168  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9502182006835938  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10497426986694336  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9438204765319824  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10419225692749023  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9512777328491211  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10530853271484375  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9517431259155273  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10438919067382812  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9496512413024902  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10552120208740234  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9522280693054199  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10418987274169922  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9512147903442383  GigaBytes
Max Memory Allocated: 1.1027345657348633  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08607378602027893 |0.016461491584777832 |0.0034436285495758057 |8.502602577209473e-05 |0.003801405429840088 |0.001817941665649414 |
----------------------------------------------------------pseudo_mini_loss sum 1.2166924476623535
Total (block generation + training)time/epoch 22.12125608921051
Training time/epoch 0.9562759399414062
Training time without block to device /epoch 0.8245840072631836
Training time without total dataloading part /epoch 0.06045842170715332
load block tensor time/epoch 0.6885902881622314
block to device time/epoch 0.13169193267822266
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 29 |
Number of nodes for computation during this epoch:  3054600
Number of first layer input nodes during this epoch:  1297755
