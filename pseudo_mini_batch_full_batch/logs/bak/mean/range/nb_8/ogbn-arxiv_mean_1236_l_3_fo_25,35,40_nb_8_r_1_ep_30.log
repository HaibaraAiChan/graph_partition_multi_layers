Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1647767431.4621038
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024692296981811523
range selection method range initialization spend 0.012819051742553711
time for parepare:  0.018201828002929688
local_output_nid generation:  0.002676725387573242
local_in_edges_tensor generation:  0.0046231746673583984
mini_batch_src_global generation:  0.003242015838623047
r_  generation:  0.036695003509521484
local_output_nid generation:  0.002925395965576172
local_in_edges_tensor generation:  0.0016562938690185547
mini_batch_src_global generation:  0.003949165344238281
r_  generation:  0.03756380081176758
local_output_nid generation:  0.0030417442321777344
local_in_edges_tensor generation:  0.00164031982421875
mini_batch_src_global generation:  0.0027532577514648438
r_  generation:  0.03865242004394531
local_output_nid generation:  0.0031321048736572266
local_in_edges_tensor generation:  0.0016548633575439453
mini_batch_src_global generation:  0.0027627944946289062
r_  generation:  0.03930401802062988
local_output_nid generation:  0.003179788589477539
local_in_edges_tensor generation:  0.0015902519226074219
mini_batch_src_global generation:  0.0028553009033203125
r_  generation:  0.03924965858459473
local_output_nid generation:  0.003133058547973633
local_in_edges_tensor generation:  0.0016186237335205078
mini_batch_src_global generation:  0.0031583309173583984
r_  generation:  0.04048657417297363
local_output_nid generation:  0.003219127655029297
local_in_edges_tensor generation:  0.001661062240600586
mini_batch_src_global generation:  0.0030663013458251953
r_  generation:  0.04030418395996094
local_output_nid generation:  0.003104686737060547
local_in_edges_tensor generation:  0.0016655921936035156
mini_batch_src_global generation:  0.003047943115234375
r_  generation:  0.04011225700378418
----------------------check_connections_block total spend ----------------------------- 0.46119022369384766
generate_one_block  0.05552935600280762
generate_one_block  0.05428457260131836
generate_one_block  0.054579973220825195
generate_one_block  0.05390286445617676
generate_one_block  0.056650400161743164
generate_one_block  0.05534648895263672
generate_one_block  0.054730892181396484
generate_one_block  0.05504631996154785
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.041602373123168945
gen group dst list time:  0.015108823776245117
time for parepare:  0.02004837989807129
local_output_nid generation:  0.010951519012451172
local_in_edges_tensor generation:  0.029749155044555664
mini_batch_src_global generation:  0.027510404586791992
r_  generation:  0.2909278869628906
local_output_nid generation:  0.01840949058532715
local_in_edges_tensor generation:  0.02678990364074707
mini_batch_src_global generation:  0.0354917049407959
r_  generation:  0.2958567142486572
local_output_nid generation:  0.019589662551879883
local_in_edges_tensor generation:  0.023238658905029297
mini_batch_src_global generation:  0.03511977195739746
r_  generation:  0.30388307571411133
local_output_nid generation:  0.019734859466552734
local_in_edges_tensor generation:  0.023233652114868164
mini_batch_src_global generation:  0.03655385971069336
r_  generation:  0.3093087673187256
local_output_nid generation:  0.020336151123046875
local_in_edges_tensor generation:  0.02077031135559082
mini_batch_src_global generation:  0.0370783805847168
r_  generation:  0.3094015121459961
local_output_nid generation:  0.020590782165527344
local_in_edges_tensor generation:  0.023560047149658203
mini_batch_src_global generation:  0.03829169273376465
r_  generation:  0.31144261360168457
local_output_nid generation:  0.020457029342651367
local_in_edges_tensor generation:  0.018663644790649414
mini_batch_src_global generation:  0.03841090202331543
r_  generation:  0.3124990463256836
local_output_nid generation:  0.02053380012512207
local_in_edges_tensor generation:  0.021273136138916016
mini_batch_src_global generation:  0.03981781005859375
r_  generation:  0.30876946449279785
----------------------check_connections_block total spend ----------------------------- 3.6193649768829346
generate_one_block  0.40421199798583984
generate_one_block  0.39098358154296875
generate_one_block  0.40192365646362305
generate_one_block  0.4082448482513428
generate_one_block  0.39289355278015137
generate_one_block  0.4165632724761963
generate_one_block  0.400071382522583
generate_one_block  0.401339054107666
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.033982276916503906
gen group dst list time:  0.035588979721069336
time for parepare:  0.019771575927734375
local_output_nid generation:  0.025144100189208984
local_in_edges_tensor generation:  0.04109072685241699
mini_batch_src_global generation:  0.04786419868469238
r_  generation:  0.4690539836883545
local_output_nid generation:  0.03542923927307129
local_in_edges_tensor generation:  0.04767632484436035
mini_batch_src_global generation:  0.0556488037109375
r_  generation:  0.47947192192077637
local_output_nid generation:  0.03274822235107422
local_in_edges_tensor generation:  0.04393601417541504
mini_batch_src_global generation:  0.052069902420043945
r_  generation:  0.48854827880859375
local_output_nid generation:  0.03310561180114746
local_in_edges_tensor generation:  0.03744673728942871
mini_batch_src_global generation:  0.058591604232788086
r_  generation:  0.49118494987487793
local_output_nid generation:  0.03373074531555176
local_in_edges_tensor generation:  0.03193259239196777
mini_batch_src_global generation:  0.05448436737060547
r_  generation:  0.498323917388916
local_output_nid generation:  0.03381013870239258
local_in_edges_tensor generation:  0.03606224060058594
mini_batch_src_global generation:  0.059500694274902344
r_  generation:  0.4893074035644531
local_output_nid generation:  0.033499717712402344
local_in_edges_tensor generation:  0.03264117240905762
mini_batch_src_global generation:  0.054660797119140625
r_  generation:  0.5036687850952148
local_output_nid generation:  0.03370475769042969
local_in_edges_tensor generation:  0.03324389457702637
mini_batch_src_global generation:  0.05725455284118652
r_  generation:  0.4875938892364502
----------------------check_connections_block total spend ----------------------------- 5.795291185379028
generate_one_block  0.6109366416931152
generate_one_block  0.6234409809112549
generate_one_block  0.6261332035064697
generate_one_block  0.625288724899292
generate_one_block  0.608959436416626
generate_one_block  0.6193385124206543
generate_one_block  0.6276247501373291
generate_one_block  0.6041259765625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  9.414656162261963
block generation total time  8.162079572677612
average batch blocks generation time:  1.0202599465847015
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.09642696380615234  GigaBytes
Max Memory Allocated: 0.09642696380615234  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 0.9015111923217773  GigaBytes
Max Memory Allocated: 0.9622526168823242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8319091796875 GB
    Memory Allocated: 0.09946632385253906  GigaBytes
Max Memory Allocated: 1.0309185981750488  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3787841796875 GB
    Memory Allocated: 0.901578426361084  GigaBytes
Max Memory Allocated: 1.0309185981750488  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.09965276718139648  GigaBytes
Max Memory Allocated: 1.0309185981750488  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.9050440788269043  GigaBytes
Max Memory Allocated: 1.0309185981750488  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.0997157096862793  GigaBytes
Max Memory Allocated: 1.0346250534057617  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.9032793045043945  GigaBytes
Max Memory Allocated: 1.0346250534057617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.09972858428955078  GigaBytes
Max Memory Allocated: 1.0346250534057617  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.9015684127807617  GigaBytes
Max Memory Allocated: 1.0346250534057617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.09968233108520508  GigaBytes
Max Memory Allocated: 1.0346250534057617  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.9057550430297852  GigaBytes
Max Memory Allocated: 1.0346250534057617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.09961938858032227  GigaBytes
Max Memory Allocated: 1.0357050895690918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.9007306098937988  GigaBytes
Max Memory Allocated: 1.0357050895690918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.09946918487548828  GigaBytes
Max Memory Allocated: 1.0357050895690918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.9010834693908691  GigaBytes
Max Memory Allocated: 1.0357050895690918  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06371143460273743 |0.04498022794723511 |0.09360429644584656 |0.00011909008026123047 |0.013336807489395142 |0.004018545150756836 |
----------------------------------------------------------pseudo_mini_loss sum 6.208520889282227
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2957366
Number of first layer input nodes during this epoch:  1283997
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.12967586517333984  GigaBytes
Max Memory Allocated: 1.0357050895690918  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025395631790161133
range selection method range initialization spend 0.011246204376220703
time for parepare:  0.029747724533081055
local_output_nid generation:  0.003186941146850586
local_in_edges_tensor generation:  0.00475764274597168
mini_batch_src_global generation:  0.0033311843872070312
r_  generation:  0.03633260726928711
local_output_nid generation:  0.002904653549194336
local_in_edges_tensor generation:  0.0017168521881103516
mini_batch_src_global generation:  0.004041910171508789
r_  generation:  0.04138517379760742
local_output_nid generation:  0.003053903579711914
local_in_edges_tensor generation:  0.0016019344329833984
mini_batch_src_global generation:  0.0028302669525146484
r_  generation:  0.039147377014160156
local_output_nid generation:  0.0030608177185058594
local_in_edges_tensor generation:  0.0015752315521240234
mini_batch_src_global generation:  0.0029191970825195312
r_  generation:  0.04279780387878418
local_output_nid generation:  0.0033769607543945312
local_in_edges_tensor generation:  0.0023267269134521484
mini_batch_src_global generation:  0.005434751510620117
r_  generation:  0.040964365005493164
local_output_nid generation:  0.006360292434692383
local_in_edges_tensor generation:  0.002197742462158203
mini_batch_src_global generation:  0.004949331283569336
r_  generation:  0.0425875186920166
local_output_nid generation:  0.003618955612182617
local_in_edges_tensor generation:  0.002042055130004883
mini_batch_src_global generation:  0.0032117366790771484
r_  generation:  0.04410147666931152
local_output_nid generation:  0.0034384727478027344
local_in_edges_tensor generation:  0.002107381820678711
mini_batch_src_global generation:  0.0034110546112060547
r_  generation:  0.041822195053100586
----------------------check_connections_block total spend ----------------------------- 0.5145342350006104
generate_one_block  0.05503535270690918
generate_one_block  0.05740618705749512
generate_one_block  0.05435061454772949
generate_one_block  0.05543923377990723
generate_one_block  0.05518054962158203
generate_one_block  0.05705690383911133
generate_one_block  0.06088399887084961
generate_one_block  0.05681943893432617
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06380033493041992
gen group dst list time:  0.015086650848388672
time for parepare:  0.025173187255859375
local_output_nid generation:  0.01045989990234375
local_in_edges_tensor generation:  0.05092191696166992
mini_batch_src_global generation:  0.028368711471557617
r_  generation:  0.2988462448120117
local_output_nid generation:  0.01572895050048828
local_in_edges_tensor generation:  0.02825188636779785
mini_batch_src_global generation:  0.03580141067504883
r_  generation:  0.3003091812133789
local_output_nid generation:  0.015530586242675781
local_in_edges_tensor generation:  0.023508310317993164
mini_batch_src_global generation:  0.03496551513671875
r_  generation:  0.30457472801208496
local_output_nid generation:  0.015855789184570312
local_in_edges_tensor generation:  0.023445844650268555
mini_batch_src_global generation:  0.03607344627380371
r_  generation:  0.30507779121398926
local_output_nid generation:  0.016508102416992188
local_in_edges_tensor generation:  0.024358272552490234
mini_batch_src_global generation:  0.037577152252197266
r_  generation:  0.3101532459259033
local_output_nid generation:  0.01651310920715332
local_in_edges_tensor generation:  0.018825531005859375
mini_batch_src_global generation:  0.03766059875488281
r_  generation:  0.31128597259521484
local_output_nid generation:  0.01680302619934082
local_in_edges_tensor generation:  0.02175736427307129
mini_batch_src_global generation:  0.04066896438598633
r_  generation:  0.31886720657348633
local_output_nid generation:  0.016826391220092773
local_in_edges_tensor generation:  0.024339675903320312
mini_batch_src_global generation:  0.03861093521118164
r_  generation:  0.3145871162414551
----------------------check_connections_block total spend ----------------------------- 3.650614023208618
generate_one_block  0.40839624404907227
generate_one_block  0.40944385528564453
generate_one_block  0.4218766689300537
generate_one_block  0.3968026638031006
generate_one_block  0.39946889877319336
generate_one_block  0.42485833168029785
generate_one_block  0.4175534248352051
generate_one_block  0.4244999885559082
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04910564422607422
gen group dst list time:  0.03660845756530762
time for parepare:  0.019623279571533203
local_output_nid generation:  0.02520275115966797
local_in_edges_tensor generation:  0.05699920654296875
mini_batch_src_global generation:  0.048509836196899414
r_  generation:  0.47694969177246094
local_output_nid generation:  0.033135175704956055
local_in_edges_tensor generation:  0.055379390716552734
mini_batch_src_global generation:  0.055687904357910156
r_  generation:  0.48298192024230957
local_output_nid generation:  0.034104347229003906
local_in_edges_tensor generation:  0.043703556060791016
mini_batch_src_global generation:  0.0707392692565918
r_  generation:  0.49341845512390137
local_output_nid generation:  0.035181283950805664
local_in_edges_tensor generation:  0.04089021682739258
mini_batch_src_global generation:  0.0549626350402832
r_  generation:  0.48726868629455566
local_output_nid generation:  0.03449392318725586
local_in_edges_tensor generation:  0.05134010314941406
mini_batch_src_global generation:  0.054323673248291016
r_  generation:  0.5007505416870117
local_output_nid generation:  0.03507184982299805
local_in_edges_tensor generation:  0.03451108932495117
mini_batch_src_global generation:  0.056076765060424805
r_  generation:  0.4859769344329834
local_output_nid generation:  0.0346837043762207
local_in_edges_tensor generation:  0.039096832275390625
mini_batch_src_global generation:  0.0578007698059082
r_  generation:  0.5023987293243408
local_output_nid generation:  0.035504817962646484
local_in_edges_tensor generation:  0.03493142127990723
mini_batch_src_global generation:  0.056962013244628906
r_  generation:  0.49257755279541016
----------------------check_connections_block total spend ----------------------------- 5.910149335861206
generate_one_block  0.6338236331939697
generate_one_block  0.6089491844177246
generate_one_block  0.6201126575469971
generate_one_block  0.6146042346954346
generate_one_block  0.6354179382324219
generate_one_block  0.6124799251556396
generate_one_block  0.6190872192382812
generate_one_block  0.6132190227508545
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.12967586517333984  GigaBytes
Max Memory Allocated: 1.0357050895690918  GigaBytes

connection checking time:  9.560763359069824
block generation total time  8.260593891143799
average batch blocks generation time:  1.0325742363929749
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.1013631820678711  GigaBytes
Max Memory Allocated: 1.0357050895690918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.9047374725341797  GigaBytes
Max Memory Allocated: 1.0357050895690918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1011037826538086  GigaBytes
Max Memory Allocated: 1.0357050895690918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9040331840515137  GigaBytes
Max Memory Allocated: 1.0357050895690918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10109138488769531  GigaBytes
Max Memory Allocated: 1.0357050895690918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9027934074401855  GigaBytes
Max Memory Allocated: 1.0357050895690918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10106801986694336  GigaBytes
Max Memory Allocated: 1.0357050895690918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.8992729187011719  GigaBytes
Max Memory Allocated: 1.0357050895690918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10145854949951172  GigaBytes
Max Memory Allocated: 1.0357050895690918  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9072222709655762  GigaBytes
Max Memory Allocated: 1.0357050895690918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10091876983642578  GigaBytes
Max Memory Allocated: 1.036649227142334  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9020943641662598  GigaBytes
Max Memory Allocated: 1.036649227142334  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10146284103393555  GigaBytes
Max Memory Allocated: 1.036649227142334  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9071540832519531  GigaBytes
Max Memory Allocated: 1.036649227142334  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10122919082641602  GigaBytes
Max Memory Allocated: 1.0366711616516113  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.903475284576416  GigaBytes
Max Memory Allocated: 1.0366711616516113  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07755288481712341 |0.016071736812591553 |0.0037540793418884277 |9.629130363464355e-05 |0.00839918851852417 |0.001279592514038086 |
----------------------------------------------------------pseudo_mini_loss sum 3.2274796962738037
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2955506
Number of first layer input nodes during this epoch:  1283597
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12953710556030273  GigaBytes
Max Memory Allocated: 1.0366711616516113  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026275634765625
range selection method range initialization spend 0.012933492660522461
time for parepare:  0.01835775375366211
local_output_nid generation:  0.0027501583099365234
local_in_edges_tensor generation:  0.007092952728271484
mini_batch_src_global generation:  0.0035445690155029297
r_  generation:  0.03755450248718262
local_output_nid generation:  0.0031523704528808594
local_in_edges_tensor generation:  0.0016617774963378906
mini_batch_src_global generation:  0.004424333572387695
r_  generation:  0.04027414321899414
local_output_nid generation:  0.0032215118408203125
local_in_edges_tensor generation:  0.0016715526580810547
mini_batch_src_global generation:  0.002830028533935547
r_  generation:  0.04058694839477539
local_output_nid generation:  0.0032355785369873047
local_in_edges_tensor generation:  0.0017516613006591797
mini_batch_src_global generation:  0.003002166748046875
r_  generation:  0.04073810577392578
local_output_nid generation:  0.003166675567626953
local_in_edges_tensor generation:  0.0016846656799316406
mini_batch_src_global generation:  0.003057241439819336
r_  generation:  0.04192185401916504
local_output_nid generation:  0.003256559371948242
local_in_edges_tensor generation:  0.0016663074493408203
mini_batch_src_global generation:  0.0032863616943359375
r_  generation:  0.04333829879760742
local_output_nid generation:  0.003258228302001953
local_in_edges_tensor generation:  0.001657724380493164
mini_batch_src_global generation:  0.0032973289489746094
r_  generation:  0.04304790496826172
local_output_nid generation:  0.003211498260498047
local_in_edges_tensor generation:  0.0016319751739501953
mini_batch_src_global generation:  0.0032739639282226562
r_  generation:  0.0428624153137207
----------------------check_connections_block total spend ----------------------------- 0.4901609420776367
generate_one_block  0.05454254150390625
generate_one_block  0.05555558204650879
generate_one_block  0.05597710609436035
generate_one_block  0.0552518367767334
generate_one_block  0.05570578575134277
generate_one_block  0.05676412582397461
generate_one_block  0.05794572830200195
generate_one_block  0.05536675453186035
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04621696472167969
gen group dst list time:  0.015012741088867188
time for parepare:  0.019640445709228516
local_output_nid generation:  0.010710000991821289
local_in_edges_tensor generation:  0.02724909782409668
mini_batch_src_global generation:  0.03068995475769043
r_  generation:  0.2913212776184082
local_output_nid generation:  0.016182661056518555
local_in_edges_tensor generation:  0.023218870162963867
mini_batch_src_global generation:  0.036095619201660156
r_  generation:  0.30207133293151855
local_output_nid generation:  0.018822908401489258
local_in_edges_tensor generation:  0.018709421157836914
mini_batch_src_global generation:  0.03645181655883789
r_  generation:  0.31369686126708984
local_output_nid generation:  0.016449451446533203
local_in_edges_tensor generation:  0.017482757568359375
mini_batch_src_global generation:  0.03663158416748047
r_  generation:  0.3075540065765381
local_output_nid generation:  0.016706466674804688
local_in_edges_tensor generation:  0.017766475677490234
mini_batch_src_global generation:  0.03975415229797363
r_  generation:  0.32242894172668457
local_output_nid generation:  0.016976594924926758
local_in_edges_tensor generation:  0.026278018951416016
mini_batch_src_global generation:  0.05093884468078613
r_  generation:  0.32004284858703613
local_output_nid generation:  0.017921924591064453
local_in_edges_tensor generation:  0.02740478515625
mini_batch_src_global generation:  0.03910398483276367
r_  generation:  0.33428239822387695
local_output_nid generation:  0.020522356033325195
local_in_edges_tensor generation:  0.02225470542907715
mini_batch_src_global generation:  0.03831028938293457
r_  generation:  0.30884861946105957
----------------------check_connections_block total spend ----------------------------- 3.697234869003296
generate_one_block  0.4024074077606201
generate_one_block  0.3961522579193115
generate_one_block  0.3966548442840576
generate_one_block  0.39397430419921875
generate_one_block  0.3978383541107178
generate_one_block  0.41065502166748047
generate_one_block  0.4139528274536133
generate_one_block  0.42284631729125977
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04548954963684082
gen group dst list time:  0.039011478424072266
time for parepare:  0.019823312759399414
local_output_nid generation:  0.027393817901611328
local_in_edges_tensor generation:  0.06989550590515137
mini_batch_src_global generation:  0.047692298889160156
r_  generation:  0.47917795181274414
local_output_nid generation:  0.033184051513671875
local_in_edges_tensor generation:  0.04178905487060547
mini_batch_src_global generation:  0.059171199798583984
r_  generation:  0.5025756359100342
local_output_nid generation:  0.036348581314086914
local_in_edges_tensor generation:  0.037558555603027344
mini_batch_src_global generation:  0.05997824668884277
r_  generation:  0.4931166172027588
local_output_nid generation:  0.03405618667602539
local_in_edges_tensor generation:  0.039794921875
mini_batch_src_global generation:  0.05731797218322754
r_  generation:  0.483154296875
local_output_nid generation:  0.03486061096191406
local_in_edges_tensor generation:  0.03795266151428223
mini_batch_src_global generation:  0.0540313720703125
r_  generation:  0.49881792068481445
local_output_nid generation:  0.03484177589416504
local_in_edges_tensor generation:  0.037621498107910156
mini_batch_src_global generation:  0.05610084533691406
r_  generation:  0.48636412620544434
local_output_nid generation:  0.03489398956298828
local_in_edges_tensor generation:  0.03622746467590332
mini_batch_src_global generation:  0.05628681182861328
r_  generation:  0.5114288330078125
local_output_nid generation:  0.0347902774810791
local_in_edges_tensor generation:  0.033847808837890625
mini_batch_src_global generation:  0.05594491958618164
r_  generation:  0.4884650707244873
----------------------check_connections_block total spend ----------------------------- 5.8884851932525635
generate_one_block  0.6305112838745117
generate_one_block  0.6190760135650635
generate_one_block  0.6406960487365723
generate_one_block  0.6159477233886719
generate_one_block  0.6366000175476074
generate_one_block  0.618689775466919
generate_one_block  0.6083252429962158
generate_one_block  0.6131131649017334
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12953710556030273  GigaBytes
Max Memory Allocated: 1.0366711616516113  GigaBytes

connection checking time:  9.58572006225586
block generation total time  8.217440605163574
average batch blocks generation time:  1.0271800756454468
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10118770599365234  GigaBytes
Max Memory Allocated: 1.0366711616516113  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.906548023223877  GigaBytes
Max Memory Allocated: 1.0366711616516113  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10124063491821289  GigaBytes
Max Memory Allocated: 1.0366711616516113  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9047322273254395  GigaBytes
Max Memory Allocated: 1.0366711616516113  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10114097595214844  GigaBytes
Max Memory Allocated: 1.0366711616516113  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9059844017028809  GigaBytes
Max Memory Allocated: 1.0366711616516113  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10114812850952148  GigaBytes
Max Memory Allocated: 1.0366711616516113  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9013462066650391  GigaBytes
Max Memory Allocated: 1.0366711616516113  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10183477401733398  GigaBytes
Max Memory Allocated: 1.0366711616516113  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.910313606262207  GigaBytes
Max Memory Allocated: 1.0366711616516113  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10125064849853516  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9073858261108398  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10098838806152344  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9024820327758789  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10112619400024414  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9022073745727539  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08122336864471436 |0.018056660890579224 |0.003388136625289917 |9.426474571228027e-05 |0.0034537017345428467 |0.0032503604888916016 |
----------------------------------------------------------pseudo_mini_loss sum 2.6090383529663086
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  2958226
Number of first layer input nodes during this epoch:  1283873
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12949228286743164  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022326946258544922
range selection method range initialization spend 0.01239633560180664
time for parepare:  0.01803278923034668
local_output_nid generation:  0.0027620792388916016
local_in_edges_tensor generation:  0.006732940673828125
mini_batch_src_global generation:  0.003465890884399414
r_  generation:  0.03813481330871582
local_output_nid generation:  0.0032088756561279297
local_in_edges_tensor generation:  0.0016884803771972656
mini_batch_src_global generation:  0.004234790802001953
r_  generation:  0.04009842872619629
local_output_nid generation:  0.003167390823364258
local_in_edges_tensor generation:  0.001676797866821289
mini_batch_src_global generation:  0.0028533935546875
r_  generation:  0.039711952209472656
local_output_nid generation:  0.0031709671020507812
local_in_edges_tensor generation:  0.0017290115356445312
mini_batch_src_global generation:  0.0029981136322021484
r_  generation:  0.04086804389953613
local_output_nid generation:  0.0031757354736328125
local_in_edges_tensor generation:  0.001718282699584961
mini_batch_src_global generation:  0.003051280975341797
r_  generation:  0.0424344539642334
local_output_nid generation:  0.0032088756561279297
local_in_edges_tensor generation:  0.0017080307006835938
mini_batch_src_global generation:  0.003238677978515625
r_  generation:  0.04230213165283203
local_output_nid generation:  0.0031948089599609375
local_in_edges_tensor generation:  0.0017244815826416016
mini_batch_src_global generation:  0.003264188766479492
r_  generation:  0.0423886775970459
local_output_nid generation:  0.0032172203063964844
local_in_edges_tensor generation:  0.0017342567443847656
mini_batch_src_global generation:  0.003298044204711914
r_  generation:  0.042409658432006836
----------------------check_connections_block total spend ----------------------------- 0.48729610443115234
generate_one_block  0.053637027740478516
generate_one_block  0.054988861083984375
generate_one_block  0.05412435531616211
generate_one_block  0.0542449951171875
generate_one_block  0.05545353889465332
generate_one_block  0.055123090744018555
generate_one_block  0.05969572067260742
generate_one_block  0.0546717643737793
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.039254188537597656
gen group dst list time:  0.014539957046508789
time for parepare:  0.019448518753051758
local_output_nid generation:  0.01108694076538086
local_in_edges_tensor generation:  0.027229785919189453
mini_batch_src_global generation:  0.031066417694091797
r_  generation:  0.2958545684814453
local_output_nid generation:  0.016793012619018555
local_in_edges_tensor generation:  0.019574880599975586
mini_batch_src_global generation:  0.03776979446411133
r_  generation:  0.3056042194366455
local_output_nid generation:  0.0173189640045166
local_in_edges_tensor generation:  0.021861553192138672
mini_batch_src_global generation:  0.03693795204162598
r_  generation:  0.30556154251098633
local_output_nid generation:  0.01826167106628418
local_in_edges_tensor generation:  0.02524876594543457
mini_batch_src_global generation:  0.037580013275146484
r_  generation:  0.31542086601257324
local_output_nid generation:  0.017987728118896484
local_in_edges_tensor generation:  0.023984909057617188
mini_batch_src_global generation:  0.03876614570617676
r_  generation:  0.32235097885131836
local_output_nid generation:  0.01849985122680664
local_in_edges_tensor generation:  0.02153635025024414
mini_batch_src_global generation:  0.039612770080566406
r_  generation:  0.31247448921203613
local_output_nid generation:  0.01743769645690918
local_in_edges_tensor generation:  0.017781734466552734
mini_batch_src_global generation:  0.0375056266784668
r_  generation:  0.3139503002166748
local_output_nid generation:  0.01767253875732422
local_in_edges_tensor generation:  0.021260738372802734
mini_batch_src_global generation:  0.03772568702697754
r_  generation:  0.3140418529510498
----------------------check_connections_block total spend ----------------------------- 3.666482448577881
generate_one_block  0.4020411968231201
generate_one_block  0.395587682723999
generate_one_block  0.3819270133972168
generate_one_block  0.39774537086486816
generate_one_block  0.40056490898132324
generate_one_block  0.3972666263580322
generate_one_block  0.39839601516723633
generate_one_block  0.4386732578277588
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.044268131256103516
gen group dst list time:  0.03771018981933594
time for parepare:  0.022069692611694336
local_output_nid generation:  0.026395797729492188
local_in_edges_tensor generation:  0.05604243278503418
mini_batch_src_global generation:  0.044507741928100586
r_  generation:  0.47051429748535156
local_output_nid generation:  0.032965898513793945
local_in_edges_tensor generation:  0.041658878326416016
mini_batch_src_global generation:  0.056229352951049805
r_  generation:  0.47981786727905273
local_output_nid generation:  0.03343844413757324
local_in_edges_tensor generation:  0.03303647041320801
mini_batch_src_global generation:  0.05116629600524902
r_  generation:  0.49080920219421387
local_output_nid generation:  0.03357863426208496
local_in_edges_tensor generation:  0.03488588333129883
mini_batch_src_global generation:  0.054494619369506836
r_  generation:  0.4937748908996582
local_output_nid generation:  0.034369707107543945
local_in_edges_tensor generation:  0.038768768310546875
mini_batch_src_global generation:  0.05364584922790527
r_  generation:  0.5089702606201172
local_output_nid generation:  0.03442835807800293
local_in_edges_tensor generation:  0.03513288497924805
mini_batch_src_global generation:  0.05633425712585449
r_  generation:  0.5032191276550293
local_output_nid generation:  0.03431582450866699
local_in_edges_tensor generation:  0.03392314910888672
mini_batch_src_global generation:  0.0539240837097168
r_  generation:  0.5059688091278076
local_output_nid generation:  0.034287452697753906
local_in_edges_tensor generation:  0.03571176528930664
mini_batch_src_global generation:  0.05494952201843262
r_  generation:  0.4892871379852295
----------------------check_connections_block total spend ----------------------------- 5.83598518371582
generate_one_block  0.6166234016418457
generate_one_block  0.6050903797149658
generate_one_block  0.6047332286834717
generate_one_block  0.620642900466919
generate_one_block  0.6429247856140137
generate_one_block  0.6391487121582031
generate_one_block  0.6179788112640381
generate_one_block  0.6183371543884277
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12949228286743164  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

connection checking time:  9.502467632293701
block generation total time  8.17768144607544
average batch blocks generation time:  1.02221018075943
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1012721061706543  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9021549224853516  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1011652946472168  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9046058654785156  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10093307495117188  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9005947113037109  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10163450241088867  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9018044471740723  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10129594802856445  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.908048152923584  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10118436813354492  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9041810035705566  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10067462921142578  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9039583206176758  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10137319564819336  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9020328521728516  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0806799829006195 |0.018868982791900635 |0.003630131483078003 |9.617209434509277e-05 |0.0037759244441986084 |0.0015516281127929688 |
----------------------------------------------------------pseudo_mini_loss sum 2.367854356765747
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  2955604
Number of first layer input nodes during this epoch:  1283867
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12888145446777344  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022717714309692383
range selection method range initialization spend 0.013849258422851562
time for parepare:  0.01636528968811035
local_output_nid generation:  0.0026793479919433594
local_in_edges_tensor generation:  0.007556915283203125
mini_batch_src_global generation:  0.003686189651489258
r_  generation:  0.03789234161376953
local_output_nid generation:  0.0031287670135498047
local_in_edges_tensor generation:  0.0016646385192871094
mini_batch_src_global generation:  0.004323244094848633
r_  generation:  0.04016304016113281
local_output_nid generation:  0.0033156871795654297
local_in_edges_tensor generation:  0.0016865730285644531
mini_batch_src_global generation:  0.002995014190673828
r_  generation:  0.04112839698791504
local_output_nid generation:  0.003239870071411133
local_in_edges_tensor generation:  0.0017502307891845703
mini_batch_src_global generation:  0.0030748844146728516
r_  generation:  0.040958404541015625
local_output_nid generation:  0.0032587051391601562
local_in_edges_tensor generation:  0.0017752647399902344
mini_batch_src_global generation:  0.0031697750091552734
r_  generation:  0.04300975799560547
local_output_nid generation:  0.003289937973022461
local_in_edges_tensor generation:  0.001935720443725586
mini_batch_src_global generation:  0.003326892852783203
r_  generation:  0.0426638126373291
local_output_nid generation:  0.003397703170776367
local_in_edges_tensor generation:  0.0017514228820800781
mini_batch_src_global generation:  0.003216266632080078
r_  generation:  0.04289722442626953
local_output_nid generation:  0.003292083740234375
local_in_edges_tensor generation:  0.0017180442810058594
mini_batch_src_global generation:  0.0032608509063720703
r_  generation:  0.04221487045288086
----------------------check_connections_block total spend ----------------------------- 0.49035072326660156
generate_one_block  0.05327415466308594
generate_one_block  0.05396461486816406
generate_one_block  0.054982900619506836
generate_one_block  0.05509352684020996
generate_one_block  0.055959463119506836
generate_one_block  0.055658817291259766
generate_one_block  0.05780220031738281
generate_one_block  0.054924726486206055
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.13466811180114746
gen group dst list time:  0.016355276107788086
time for parepare:  0.019577503204345703
local_output_nid generation:  0.010740995407104492
local_in_edges_tensor generation:  0.026164531707763672
mini_batch_src_global generation:  0.031495094299316406
r_  generation:  0.34627366065979004
local_output_nid generation:  0.016351699829101562
local_in_edges_tensor generation:  0.023842334747314453
mini_batch_src_global generation:  0.041381120681762695
r_  generation:  0.31116557121276855
local_output_nid generation:  0.01712203025817871
local_in_edges_tensor generation:  0.018488645553588867
mini_batch_src_global generation:  0.04195427894592285
r_  generation:  0.3225412368774414
local_output_nid generation:  0.017639875411987305
local_in_edges_tensor generation:  0.026745319366455078
mini_batch_src_global generation:  0.0410466194152832
r_  generation:  0.32861971855163574
local_output_nid generation:  0.017159700393676758
local_in_edges_tensor generation:  0.024301528930664062
mini_batch_src_global generation:  0.042220354080200195
r_  generation:  0.3313181400299072
local_output_nid generation:  0.018538475036621094
local_in_edges_tensor generation:  0.019305944442749023
mini_batch_src_global generation:  0.040886640548706055
r_  generation:  0.32269954681396484
local_output_nid generation:  0.01756429672241211
local_in_edges_tensor generation:  0.017510652542114258
mini_batch_src_global generation:  0.042676448822021484
r_  generation:  0.33757805824279785
local_output_nid generation:  0.017627477645874023
local_in_edges_tensor generation:  0.01743006706237793
mini_batch_src_global generation:  0.04110836982727051
r_  generation:  0.31836748123168945
----------------------check_connections_block total spend ----------------------------- 3.8259525299072266
generate_one_block  0.40758585929870605
generate_one_block  0.39633965492248535
generate_one_block  0.39778828620910645
generate_one_block  0.40559840202331543
generate_one_block  0.3975489139556885
generate_one_block  0.3930215835571289
generate_one_block  0.39759039878845215
generate_one_block  0.4187958240509033
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04284095764160156
gen group dst list time:  0.03707098960876465
time for parepare:  0.020734548568725586
local_output_nid generation:  0.02655959129333496
local_in_edges_tensor generation:  0.049787044525146484
mini_batch_src_global generation:  0.06020069122314453
r_  generation:  0.4843447208404541
local_output_nid generation:  0.032158613204956055
local_in_edges_tensor generation:  0.03978300094604492
mini_batch_src_global generation:  0.056738853454589844
r_  generation:  0.5054183006286621
local_output_nid generation:  0.033664703369140625
local_in_edges_tensor generation:  0.03932595252990723
mini_batch_src_global generation:  0.055966854095458984
r_  generation:  0.5264163017272949
local_output_nid generation:  0.036844730377197266
local_in_edges_tensor generation:  0.04176068305969238
mini_batch_src_global generation:  0.05906176567077637
r_  generation:  0.5093038082122803
local_output_nid generation:  0.03672647476196289
local_in_edges_tensor generation:  0.0355525016784668
mini_batch_src_global generation:  0.05898618698120117
r_  generation:  0.5234744548797607
local_output_nid generation:  0.03477191925048828
local_in_edges_tensor generation:  0.03305315971374512
mini_batch_src_global generation:  0.05770277976989746
r_  generation:  0.5001251697540283
local_output_nid generation:  0.03505682945251465
local_in_edges_tensor generation:  0.03467988967895508
mini_batch_src_global generation:  0.060393571853637695
r_  generation:  0.5243179798126221
local_output_nid generation:  0.0352015495300293
local_in_edges_tensor generation:  0.03262186050415039
mini_batch_src_global generation:  0.058007001876831055
r_  generation:  0.5126986503601074
----------------------check_connections_block total spend ----------------------------- 6.123714447021484
generate_one_block  0.631427526473999
generate_one_block  0.6183180809020996
generate_one_block  0.6288414001464844
generate_one_block  0.6164367198944092
generate_one_block  0.6085433959960938
generate_one_block  0.6070129871368408
generate_one_block  0.6169857978820801
generate_one_block  0.6127972602844238
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12888145446777344  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

connection checking time:  9.949666976928711
block generation total time  8.154632091522217
average batch blocks generation time:  1.019329011440277
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10120487213134766  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9035148620605469  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10100984573364258  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9027962684631348  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10123777389526367  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9057621955871582  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10112380981445312  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9022035598754883  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10125494003295898  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9049830436706543  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10121488571166992  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9057784080505371  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1014394760131836  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9071493148803711  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10111761093139648  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.901578426361084  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08014979958534241 |0.01535564661026001 |0.0036299824714660645 |9.721517562866211e-05 |0.00362473726272583 |0.0012965202331542969 |
----------------------------------------------------------pseudo_mini_loss sum 2.0967841148376465
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  2957736
Number of first layer input nodes during this epoch:  1284331
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12964725494384766  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021100997924804688
range selection method range initialization spend 0.012505292892456055
time for parepare:  0.016264677047729492
local_output_nid generation:  0.002655029296875
local_in_edges_tensor generation:  0.007566928863525391
mini_batch_src_global generation:  0.003225564956665039
r_  generation:  0.036773681640625
local_output_nid generation:  0.003139019012451172
local_in_edges_tensor generation:  0.0016605854034423828
mini_batch_src_global generation:  0.0042057037353515625
r_  generation:  0.04031562805175781
local_output_nid generation:  0.003124237060546875
local_in_edges_tensor generation:  0.0018315315246582031
mini_batch_src_global generation:  0.002857208251953125
r_  generation:  0.0402374267578125
local_output_nid generation:  0.003171205520629883
local_in_edges_tensor generation:  0.0017483234405517578
mini_batch_src_global generation:  0.0030291080474853516
r_  generation:  0.04178428649902344
local_output_nid generation:  0.003186941146850586
local_in_edges_tensor generation:  0.0017728805541992188
mini_batch_src_global generation:  0.003108501434326172
r_  generation:  0.04158806800842285
local_output_nid generation:  0.003220081329345703
local_in_edges_tensor generation:  0.0017566680908203125
mini_batch_src_global generation:  0.0031440258026123047
r_  generation:  0.04199814796447754
local_output_nid generation:  0.0032501220703125
local_in_edges_tensor generation:  0.0017359256744384766
mini_batch_src_global generation:  0.003268003463745117
r_  generation:  0.041742563247680664
local_output_nid generation:  0.003179788589477539
local_in_edges_tensor generation:  0.001790761947631836
mini_batch_src_global generation:  0.0034494400024414062
r_  generation:  0.04231452941894531
----------------------check_connections_block total spend ----------------------------- 0.48429346084594727
generate_one_block  0.05274200439453125
generate_one_block  0.055077314376831055
generate_one_block  0.05538773536682129
generate_one_block  0.0556793212890625
generate_one_block  0.05431413650512695
generate_one_block  0.05470108985900879
generate_one_block  0.057219505310058594
generate_one_block  0.05537724494934082
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.033358097076416016
gen group dst list time:  0.01374959945678711
time for parepare:  0.019605398178100586
local_output_nid generation:  0.010470151901245117
local_in_edges_tensor generation:  0.025934934616088867
mini_batch_src_global generation:  0.02904987335205078
r_  generation:  0.2926950454711914
local_output_nid generation:  0.016904354095458984
local_in_edges_tensor generation:  0.018764734268188477
mini_batch_src_global generation:  0.03831362724304199
r_  generation:  0.30959653854370117
local_output_nid generation:  0.017343759536743164
local_in_edges_tensor generation:  0.02302861213684082
mini_batch_src_global generation:  0.03790855407714844
r_  generation:  0.32871317863464355
local_output_nid generation:  0.022347450256347656
local_in_edges_tensor generation:  0.02152729034423828
mini_batch_src_global generation:  0.03694772720336914
r_  generation:  0.30814552307128906
local_output_nid generation:  0.018563270568847656
local_in_edges_tensor generation:  0.019600629806518555
mini_batch_src_global generation:  0.03696799278259277
r_  generation:  0.3105442523956299
local_output_nid generation:  0.017403602600097656
local_in_edges_tensor generation:  0.018413066864013672
mini_batch_src_global generation:  0.0373532772064209
r_  generation:  0.30912137031555176
local_output_nid generation:  0.017476558685302734
local_in_edges_tensor generation:  0.01857781410217285
mini_batch_src_global generation:  0.03922557830810547
r_  generation:  0.3069608211517334
local_output_nid generation:  0.017989635467529297
local_in_edges_tensor generation:  0.01737833023071289
mini_batch_src_global generation:  0.037192344665527344
r_  generation:  0.31281399726867676
----------------------check_connections_block total spend ----------------------------- 3.625021457672119
generate_one_block  0.3885228633880615
generate_one_block  0.4006059169769287
generate_one_block  0.3981146812438965
generate_one_block  0.39367246627807617
generate_one_block  0.3949859142303467
generate_one_block  0.39249658584594727
generate_one_block  0.3911302089691162
generate_one_block  0.4224991798400879
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.033644676208496094
gen group dst list time:  0.03847336769104004
time for parepare:  0.019655227661132812
local_output_nid generation:  0.027076005935668945
local_in_edges_tensor generation:  0.055371761322021484
mini_batch_src_global generation:  0.04706072807312012
r_  generation:  0.47940850257873535
local_output_nid generation:  0.032555580139160156
local_in_edges_tensor generation:  0.04315924644470215
mini_batch_src_global generation:  0.058255672454833984
r_  generation:  0.5086066722869873
local_output_nid generation:  0.038135528564453125
local_in_edges_tensor generation:  0.04616260528564453
mini_batch_src_global generation:  0.058685302734375
r_  generation:  0.49859166145324707
local_output_nid generation:  0.03464508056640625
local_in_edges_tensor generation:  0.03584122657775879
mini_batch_src_global generation:  0.05414938926696777
r_  generation:  0.4879343509674072
local_output_nid generation:  0.03525590896606445
local_in_edges_tensor generation:  0.0326237678527832
mini_batch_src_global generation:  0.05293726921081543
r_  generation:  0.4995462894439697
local_output_nid generation:  0.03471636772155762
local_in_edges_tensor generation:  0.032343387603759766
mini_batch_src_global generation:  0.05544257164001465
r_  generation:  0.4912378787994385
local_output_nid generation:  0.03519749641418457
local_in_edges_tensor generation:  0.03682708740234375
mini_batch_src_global generation:  0.05331254005432129
r_  generation:  0.5138366222381592
local_output_nid generation:  0.03567910194396973
local_in_edges_tensor generation:  0.036696672439575195
mini_batch_src_global generation:  0.05616879463195801
r_  generation:  0.49297666549682617
----------------------check_connections_block total spend ----------------------------- 5.898102045059204
generate_one_block  0.618398904800415
generate_one_block  0.6154348850250244
generate_one_block  0.6189327239990234
generate_one_block  0.6205792427062988
generate_one_block  0.6343848705291748
generate_one_block  0.6162495613098145
generate_one_block  0.6079351902008057
generate_one_block  0.6175572872161865
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12964725494384766  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

connection checking time:  9.523123502731323
block generation total time  8.131500482559204
average batch blocks generation time:  1.0164375603199005
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10112571716308594  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9019293785095215  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10172605514526367  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9076189994812012  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10139274597167969  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9087228775024414  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10111474990844727  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9025464057922363  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10136032104492188  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9054269790649414  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10123300552368164  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9022998809814453  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10093975067138672  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9018607139587402  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10168981552124023  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9070820808410645  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08020344376564026 |0.018400877714157104 |0.0037168562412261963 |9.897351264953613e-05 |0.003593951463699341 |0.0027887821197509766 |
----------------------------------------------------------pseudo_mini_loss sum 1.94486665725708
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  2958171
Number of first layer input nodes during this epoch:  1284596
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12970876693725586  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027997493743896484
range selection method range initialization spend 0.01227116584777832
time for parepare:  0.01635289192199707
local_output_nid generation:  0.0027933120727539062
local_in_edges_tensor generation:  0.00780797004699707
mini_batch_src_global generation:  0.0033097267150878906
r_  generation:  0.03741860389709473
local_output_nid generation:  0.003282308578491211
local_in_edges_tensor generation:  0.0016956329345703125
mini_batch_src_global generation:  0.004137516021728516
r_  generation:  0.04020428657531738
local_output_nid generation:  0.003226041793823242
local_in_edges_tensor generation:  0.0017788410186767578
mini_batch_src_global generation:  0.0029206275939941406
r_  generation:  0.04006481170654297
local_output_nid generation:  0.0032629966735839844
local_in_edges_tensor generation:  0.0017542839050292969
mini_batch_src_global generation:  0.0029609203338623047
r_  generation:  0.04059195518493652
local_output_nid generation:  0.00327301025390625
local_in_edges_tensor generation:  0.0017652511596679688
mini_batch_src_global generation:  0.0030181407928466797
r_  generation:  0.0419921875
local_output_nid generation:  0.003233194351196289
local_in_edges_tensor generation:  0.0017085075378417969
mini_batch_src_global generation:  0.0032854080200195312
r_  generation:  0.042824745178222656
local_output_nid generation:  0.0031938552856445312
local_in_edges_tensor generation:  0.0017075538635253906
mini_batch_src_global generation:  0.0032329559326171875
r_  generation:  0.042204856872558594
local_output_nid generation:  0.003198385238647461
local_in_edges_tensor generation:  0.0017480850219726562
mini_batch_src_global generation:  0.003293752670288086
r_  generation:  0.042859554290771484
----------------------check_connections_block total spend ----------------------------- 0.4870634078979492
generate_one_block  0.05389833450317383
generate_one_block  0.054795265197753906
generate_one_block  0.05450439453125
generate_one_block  0.05481600761413574
generate_one_block  0.05425858497619629
generate_one_block  0.055382728576660156
generate_one_block  0.05775594711303711
generate_one_block  0.060891151428222656
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.034012794494628906
gen group dst list time:  0.014061450958251953
time for parepare:  0.01931595802307129
local_output_nid generation:  0.01058197021484375
local_in_edges_tensor generation:  0.022952556610107422
mini_batch_src_global generation:  0.029404878616333008
r_  generation:  0.28867530822753906
local_output_nid generation:  0.01645374298095703
local_in_edges_tensor generation:  0.020151376724243164
mini_batch_src_global generation:  0.03600144386291504
r_  generation:  0.30080580711364746
local_output_nid generation:  0.01857161521911621
local_in_edges_tensor generation:  0.017852783203125
mini_batch_src_global generation:  0.03532123565673828
r_  generation:  0.3062586784362793
local_output_nid generation:  0.019410133361816406
local_in_edges_tensor generation:  0.018399715423583984
mini_batch_src_global generation:  0.03790879249572754
r_  generation:  0.3157496452331543
local_output_nid generation:  0.018383026123046875
local_in_edges_tensor generation:  0.019601821899414062
mini_batch_src_global generation:  0.037276506423950195
r_  generation:  0.31679248809814453
local_output_nid generation:  0.017155885696411133
local_in_edges_tensor generation:  0.027927160263061523
mini_batch_src_global generation:  0.041474103927612305
r_  generation:  0.33242011070251465
local_output_nid generation:  0.01936650276184082
local_in_edges_tensor generation:  0.019931316375732422
mini_batch_src_global generation:  0.037819862365722656
r_  generation:  0.31201696395874023
local_output_nid generation:  0.017547607421875
local_in_edges_tensor generation:  0.01847529411315918
mini_batch_src_global generation:  0.03796505928039551
r_  generation:  0.31355857849121094
----------------------check_connections_block total spend ----------------------------- 3.6395559310913086
generate_one_block  0.3894815444946289
generate_one_block  0.38721132278442383
generate_one_block  0.3908400535583496
generate_one_block  0.3955399990081787
generate_one_block  0.39462757110595703
generate_one_block  0.41892385482788086
generate_one_block  0.39882659912109375
generate_one_block  0.42226314544677734
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0317378044128418
gen group dst list time:  0.03827071189880371
time for parepare:  0.02158069610595703
local_output_nid generation:  0.026978015899658203
local_in_edges_tensor generation:  0.05636429786682129
mini_batch_src_global generation:  0.047060251235961914
r_  generation:  0.4787626266479492
local_output_nid generation:  0.03268074989318848
local_in_edges_tensor generation:  0.0431668758392334
mini_batch_src_global generation:  0.05684256553649902
r_  generation:  0.5044801235198975
local_output_nid generation:  0.03690624237060547
local_in_edges_tensor generation:  0.041445255279541016
mini_batch_src_global generation:  0.055399179458618164
r_  generation:  0.4924640655517578
local_output_nid generation:  0.03485608100891113
local_in_edges_tensor generation:  0.034482479095458984
mini_batch_src_global generation:  0.05704498291015625
r_  generation:  0.4836564064025879
local_output_nid generation:  0.03500247001647949
local_in_edges_tensor generation:  0.03174591064453125
mini_batch_src_global generation:  0.05334830284118652
r_  generation:  0.49588918685913086
local_output_nid generation:  0.034731149673461914
local_in_edges_tensor generation:  0.03399515151977539
mini_batch_src_global generation:  0.05711698532104492
r_  generation:  0.4860503673553467
local_output_nid generation:  0.034819841384887695
local_in_edges_tensor generation:  0.033622026443481445
mini_batch_src_global generation:  0.05594921112060547
r_  generation:  0.5094757080078125
local_output_nid generation:  0.03547215461730957
local_in_edges_tensor generation:  0.03307938575744629
mini_batch_src_global generation:  0.05554342269897461
r_  generation:  0.488832950592041
----------------------check_connections_block total spend ----------------------------- 5.848938465118408
generate_one_block  0.6223719120025635
generate_one_block  0.6149733066558838
generate_one_block  0.6201648712158203
generate_one_block  0.6145823001861572
generate_one_block  0.6181390285491943
generate_one_block  0.6135644912719727
generate_one_block  0.6205463409423828
generate_one_block  0.6191549301147461
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12970876693725586  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

connection checking time:  9.488494396209717
block generation total time  8.14121127128601
average batch blocks generation time:  1.0176514089107513
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10114574432373047  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9037899971008301  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10111713409423828  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9052228927612305  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10125541687011719  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9042963981628418  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10120534896850586  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9037871360778809  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10094070434570312  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9018549919128418  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10131549835205078  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9052939414978027  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10201168060302734  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9068474769592285  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10121822357177734  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9064164161682129  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08034530282020569 |0.015827447175979614 |0.0035574138164520264 |9.563565254211426e-05 |0.0038005411624908447 |0.0015039443969726562 |
----------------------------------------------------------pseudo_mini_loss sum 1.8683289289474487
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  2957901
Number of first layer input nodes during this epoch:  1284082
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1297149658203125  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019226551055908203
range selection method range initialization spend 0.012440681457519531
time for parepare:  0.015807151794433594
local_output_nid generation:  0.002657175064086914
local_in_edges_tensor generation:  0.004701852798461914
mini_batch_src_global generation:  0.003370523452758789
r_  generation:  0.0368349552154541
local_output_nid generation:  0.003064870834350586
local_in_edges_tensor generation:  0.0016765594482421875
mini_batch_src_global generation:  0.004180192947387695
r_  generation:  0.03909611701965332
local_output_nid generation:  0.003174304962158203
local_in_edges_tensor generation:  0.0017695426940917969
mini_batch_src_global generation:  0.002833127975463867
r_  generation:  0.03983926773071289
local_output_nid generation:  0.003194570541381836
local_in_edges_tensor generation:  0.0017898082733154297
mini_batch_src_global generation:  0.002979278564453125
r_  generation:  0.04141879081726074
local_output_nid generation:  0.0032372474670410156
local_in_edges_tensor generation:  0.0017309188842773438
mini_batch_src_global generation:  0.003062009811401367
r_  generation:  0.04220914840698242
local_output_nid generation:  0.003237009048461914
local_in_edges_tensor generation:  0.001760244369506836
mini_batch_src_global generation:  0.0032296180725097656
r_  generation:  0.04250025749206543
local_output_nid generation:  0.0032143592834472656
local_in_edges_tensor generation:  0.0017380714416503906
mini_batch_src_global generation:  0.003221273422241211
r_  generation:  0.04236793518066406
local_output_nid generation:  0.0032646656036376953
local_in_edges_tensor generation:  0.0017025470733642578
mini_batch_src_global generation:  0.0032389163970947266
r_  generation:  0.04198145866394043
----------------------check_connections_block total spend ----------------------------- 0.4808964729309082
generate_one_block  0.05301237106323242
generate_one_block  0.05357074737548828
generate_one_block  0.05465579032897949
generate_one_block  0.05491328239440918
generate_one_block  0.05535125732421875
generate_one_block  0.0553131103515625
generate_one_block  0.05778074264526367
generate_one_block  0.05924344062805176
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.031130313873291016
gen group dst list time:  0.014127731323242188
time for parepare:  0.01956939697265625
local_output_nid generation:  0.010824441909790039
local_in_edges_tensor generation:  0.026454925537109375
mini_batch_src_global generation:  0.02948737144470215
r_  generation:  0.2876598834991455
local_output_nid generation:  0.0162198543548584
local_in_edges_tensor generation:  0.021384716033935547
mini_batch_src_global generation:  0.03774428367614746
r_  generation:  0.2987678050994873
local_output_nid generation:  0.017041444778442383
local_in_edges_tensor generation:  0.018126726150512695
mini_batch_src_global generation:  0.03656768798828125
r_  generation:  0.30318617820739746
local_output_nid generation:  0.01690840721130371
local_in_edges_tensor generation:  0.017193317413330078
mini_batch_src_global generation:  0.036038875579833984
r_  generation:  0.30826258659362793
local_output_nid generation:  0.017721891403198242
local_in_edges_tensor generation:  0.022053956985473633
mini_batch_src_global generation:  0.03861427307128906
r_  generation:  0.31433773040771484
local_output_nid generation:  0.01729869842529297
local_in_edges_tensor generation:  0.017282485961914062
mini_batch_src_global generation:  0.03844642639160156
r_  generation:  0.32135844230651855
local_output_nid generation:  0.017409563064575195
local_in_edges_tensor generation:  0.017993688583374023
mini_batch_src_global generation:  0.03768157958984375
r_  generation:  0.31595611572265625
local_output_nid generation:  0.017302751541137695
local_in_edges_tensor generation:  0.01749730110168457
mini_batch_src_global generation:  0.03779768943786621
r_  generation:  0.30934643745422363
----------------------check_connections_block total spend ----------------------------- 3.588249921798706
generate_one_block  0.3896315097808838
generate_one_block  0.3845386505126953
generate_one_block  0.3868546485900879
generate_one_block  0.3896050453186035
generate_one_block  0.39297056198120117
generate_one_block  0.395672082901001
generate_one_block  0.39417457580566406
generate_one_block  0.4102191925048828
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03431272506713867
gen group dst list time:  0.036749839782714844
time for parepare:  0.017983675003051758
local_output_nid generation:  0.02643299102783203
local_in_edges_tensor generation:  0.041307926177978516
mini_batch_src_global generation:  0.04450654983520508
r_  generation:  0.474170446395874
local_output_nid generation:  0.03282427787780762
local_in_edges_tensor generation:  0.03625297546386719
mini_batch_src_global generation:  0.05394601821899414
r_  generation:  0.48216676712036133
local_output_nid generation:  0.034505605697631836
local_in_edges_tensor generation:  0.03275489807128906
mini_batch_src_global generation:  0.05127763748168945
r_  generation:  0.49632906913757324
local_output_nid generation:  0.03341317176818848
local_in_edges_tensor generation:  0.03269600868225098
mini_batch_src_global generation:  0.05631518363952637
r_  generation:  0.4867696762084961
local_output_nid generation:  0.03362226486206055
local_in_edges_tensor generation:  0.03685617446899414
mini_batch_src_global generation:  0.05258679389953613
r_  generation:  0.4966437816619873
local_output_nid generation:  0.03377938270568848
local_in_edges_tensor generation:  0.0336759090423584
mini_batch_src_global generation:  0.05532646179199219
r_  generation:  0.48775148391723633
local_output_nid generation:  0.03369879722595215
local_in_edges_tensor generation:  0.033626556396484375
mini_batch_src_global generation:  0.05462074279785156
r_  generation:  0.5036716461181641
local_output_nid generation:  0.033957481384277344
local_in_edges_tensor generation:  0.035727500915527344
mini_batch_src_global generation:  0.0559077262878418
r_  generation:  0.49329161643981934
----------------------check_connections_block total spend ----------------------------- 5.780339956283569
generate_one_block  0.6102285385131836
generate_one_block  0.6125829219818115
generate_one_block  0.6062464714050293
generate_one_block  0.6188664436340332
generate_one_block  0.6320786476135254
generate_one_block  0.6154329776763916
generate_one_block  0.6102261543273926
generate_one_block  0.6158747673034668
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1297149658203125  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

connection checking time:  9.368589878082275
block generation total time  8.065203189849854
average batch blocks generation time:  1.0081503987312317
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1011953353881836  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9044189453125  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10101747512817383  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.90008544921875  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1011958122253418  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9022436141967773  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10142660140991211  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9035167694091797  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10123872756958008  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9044795036315918  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10117673873901367  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9060635566711426  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.101593017578125  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9065799713134766  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10147428512573242  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9071455001831055  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08032676577568054 |0.01518261432647705 |0.003553539514541626 |9.593367576599121e-05 |0.0037758946418762207 |0.0029175281524658203 |
----------------------------------------------------------pseudo_mini_loss sum 1.7856132984161377
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  2957629
Number of first layer input nodes during this epoch:  1284269
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12968873977661133  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02381277084350586
range selection method range initialization spend 0.012356996536254883
time for parepare:  0.01668238639831543
local_output_nid generation:  0.0027718544006347656
local_in_edges_tensor generation:  0.004735231399536133
mini_batch_src_global generation:  0.003362894058227539
r_  generation:  0.03736734390258789
local_output_nid generation:  0.0032062530517578125
local_in_edges_tensor generation:  0.0016999244689941406
mini_batch_src_global generation:  0.004136323928833008
r_  generation:  0.03862762451171875
local_output_nid generation:  0.003204345703125
local_in_edges_tensor generation:  0.0017235279083251953
mini_batch_src_global generation:  0.0028870105743408203
r_  generation:  0.04043841361999512
local_output_nid generation:  0.003232717514038086
local_in_edges_tensor generation:  0.0017170906066894531
mini_batch_src_global generation:  0.0029761791229248047
r_  generation:  0.041573286056518555
local_output_nid generation:  0.0032389163970947266
local_in_edges_tensor generation:  0.0017099380493164062
mini_batch_src_global generation:  0.003138303756713867
r_  generation:  0.041242361068725586
local_output_nid generation:  0.0032453536987304688
local_in_edges_tensor generation:  0.0017333030700683594
mini_batch_src_global generation:  0.0031926631927490234
r_  generation:  0.04210495948791504
local_output_nid generation:  0.003218412399291992
local_in_edges_tensor generation:  0.0017371177673339844
mini_batch_src_global generation:  0.0031845569610595703
r_  generation:  0.042078495025634766
local_output_nid generation:  0.0032203197479248047
local_in_edges_tensor generation:  0.0017099380493164062
mini_batch_src_global generation:  0.003283977508544922
r_  generation:  0.04256081581115723
----------------------check_connections_block total spend ----------------------------- 0.48262715339660645
generate_one_block  0.05306553840637207
generate_one_block  0.05406332015991211
generate_one_block  0.054999589920043945
generate_one_block  0.05576944351196289
generate_one_block  0.05457115173339844
generate_one_block  0.055097341537475586
generate_one_block  0.06031394004821777
generate_one_block  0.05928635597229004
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03478050231933594
gen group dst list time:  0.014161348342895508
time for parepare:  0.01944136619567871
local_output_nid generation:  0.010578155517578125
local_in_edges_tensor generation:  0.024382829666137695
mini_batch_src_global generation:  0.02946925163269043
r_  generation:  0.2904810905456543
local_output_nid generation:  0.016283035278320312
local_in_edges_tensor generation:  0.021553993225097656
mini_batch_src_global generation:  0.036836862564086914
r_  generation:  0.299163818359375
local_output_nid generation:  0.01712203025817871
local_in_edges_tensor generation:  0.018285274505615234
mini_batch_src_global generation:  0.03563213348388672
r_  generation:  0.3147244453430176
local_output_nid generation:  0.017705678939819336
local_in_edges_tensor generation:  0.020714521408081055
mini_batch_src_global generation:  0.04168128967285156
r_  generation:  0.3106255531311035
local_output_nid generation:  0.020071983337402344
local_in_edges_tensor generation:  0.020795106887817383
mini_batch_src_global generation:  0.03741788864135742
r_  generation:  0.3283662796020508
local_output_nid generation:  0.019275426864624023
local_in_edges_tensor generation:  0.027759075164794922
mini_batch_src_global generation:  0.0403902530670166
r_  generation:  0.31306982040405273
local_output_nid generation:  0.01745462417602539
local_in_edges_tensor generation:  0.018896102905273438
mini_batch_src_global generation:  0.038205862045288086
r_  generation:  0.31033849716186523
local_output_nid generation:  0.017655611038208008
local_in_edges_tensor generation:  0.019216299057006836
mini_batch_src_global generation:  0.03986215591430664
r_  generation:  0.31377339363098145
----------------------check_connections_block total spend ----------------------------- 3.6481051445007324
generate_one_block  0.3924124240875244
generate_one_block  0.39239954948425293
generate_one_block  0.4101438522338867
generate_one_block  0.4022250175476074
generate_one_block  0.3974590301513672
generate_one_block  0.3978447914123535
generate_one_block  0.39690160751342773
generate_one_block  0.44200563430786133
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03616142272949219
gen group dst list time:  0.03891897201538086
time for parepare:  0.020086288452148438
local_output_nid generation:  0.025977373123168945
local_in_edges_tensor generation:  0.04880261421203613
mini_batch_src_global generation:  0.04777979850769043
r_  generation:  0.47098541259765625
local_output_nid generation:  0.03562331199645996
local_in_edges_tensor generation:  0.040139198303222656
mini_batch_src_global generation:  0.05478262901306152
r_  generation:  0.4777967929840088
local_output_nid generation:  0.03310871124267578
local_in_edges_tensor generation:  0.03533506393432617
mini_batch_src_global generation:  0.05400204658508301
r_  generation:  0.4918479919433594
local_output_nid generation:  0.03318357467651367
local_in_edges_tensor generation:  0.034494638442993164
mini_batch_src_global generation:  0.05508780479431152
r_  generation:  0.4874386787414551
local_output_nid generation:  0.0335240364074707
local_in_edges_tensor generation:  0.033991336822509766
mini_batch_src_global generation:  0.054239749908447266
r_  generation:  0.4954228401184082
local_output_nid generation:  0.03488016128540039
local_in_edges_tensor generation:  0.03474545478820801
mini_batch_src_global generation:  0.05644345283508301
r_  generation:  0.4857463836669922
local_output_nid generation:  0.03361248970031738
local_in_edges_tensor generation:  0.0343172550201416
mini_batch_src_global generation:  0.056958675384521484
r_  generation:  0.4995889663696289
local_output_nid generation:  0.03520512580871582
local_in_edges_tensor generation:  0.040996551513671875
mini_batch_src_global generation:  0.058174848556518555
r_  generation:  0.491163969039917
----------------------check_connections_block total spend ----------------------------- 5.803292274475098
generate_one_block  0.6323196887969971
generate_one_block  0.6104047298431396
generate_one_block  0.6123237609863281
generate_one_block  0.6191260814666748
generate_one_block  0.6070542335510254
generate_one_block  0.6027417182922363
generate_one_block  0.6071250438690186
generate_one_block  0.6305961608886719
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12968873977661133  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

connection checking time:  9.45139741897583
block generation total time  8.153083324432373
average batch blocks generation time:  1.0191354155540466
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10100507736206055  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9014129638671875  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.101043701171875  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.900545597076416  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1019439697265625  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9063124656677246  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10143232345581055  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9063663482666016  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10109281539916992  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9031214714050293  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10119915008544922  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9039645195007324  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10114383697509766  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9028539657592773  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10135698318481445  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9104909896850586  GigaBytes
Max Memory Allocated: 1.0414433479309082  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08172038197517395 |0.014486253261566162 |0.0034669041633605957 |9.548664093017578e-05 |0.00375974178314209 |0.0016050338745117188 |
----------------------------------------------------------pseudo_mini_loss sum 1.6982015371322632
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  2956780
Number of first layer input nodes during this epoch:  1284188
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.13104009628295898  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02174067497253418
range selection method range initialization spend 0.012485265731811523
time for parepare:  0.016184329986572266
local_output_nid generation:  0.002852201461791992
local_in_edges_tensor generation:  0.005750179290771484
mini_batch_src_global generation:  0.0033354759216308594
r_  generation:  0.03686714172363281
local_output_nid generation:  0.003187417984008789
local_in_edges_tensor generation:  0.0016911029815673828
mini_batch_src_global generation:  0.004420280456542969
r_  generation:  0.03951454162597656
local_output_nid generation:  0.003243684768676758
local_in_edges_tensor generation:  0.001718282699584961
mini_batch_src_global generation:  0.0030248165130615234
r_  generation:  0.04063534736633301
local_output_nid generation:  0.0033164024353027344
local_in_edges_tensor generation:  0.0017304420471191406
mini_batch_src_global generation:  0.003057241439819336
r_  generation:  0.04111433029174805
local_output_nid generation:  0.0032689571380615234
local_in_edges_tensor generation:  0.0017223358154296875
mini_batch_src_global generation:  0.0030612945556640625
r_  generation:  0.041039466857910156
local_output_nid generation:  0.003251791000366211
local_in_edges_tensor generation:  0.0016999244689941406
mini_batch_src_global generation:  0.0032236576080322266
r_  generation:  0.04236865043640137
local_output_nid generation:  0.0032715797424316406
local_in_edges_tensor generation:  0.0017285346984863281
mini_batch_src_global generation:  0.0031747817993164062
r_  generation:  0.042551517486572266
local_output_nid generation:  0.003269195556640625
local_in_edges_tensor generation:  0.0017244815826416016
mini_batch_src_global generation:  0.0033092498779296875
r_  generation:  0.0427703857421875
----------------------check_connections_block total spend ----------------------------- 0.4845452308654785
generate_one_block  0.0530390739440918
generate_one_block  0.05505061149597168
generate_one_block  0.055228233337402344
generate_one_block  0.05493426322937012
generate_one_block  0.05463862419128418
generate_one_block  0.05541801452636719
generate_one_block  0.057823896408081055
generate_one_block  0.05560302734375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03453683853149414
gen group dst list time:  0.014308929443359375
time for parepare:  0.019675016403198242
local_output_nid generation:  0.010916709899902344
local_in_edges_tensor generation:  0.023132801055908203
mini_batch_src_global generation:  0.029567241668701172
r_  generation:  0.2889745235443115
local_output_nid generation:  0.016236543655395508
local_in_edges_tensor generation:  0.021433115005493164
mini_batch_src_global generation:  0.03718447685241699
r_  generation:  0.3001220226287842
local_output_nid generation:  0.01699209213256836
local_in_edges_tensor generation:  0.016268491744995117
mini_batch_src_global generation:  0.03546643257141113
r_  generation:  0.30882930755615234
local_output_nid generation:  0.01686859130859375
local_in_edges_tensor generation:  0.017246484756469727
mini_batch_src_global generation:  0.036794424057006836
r_  generation:  0.3103909492492676
local_output_nid generation:  0.017423391342163086
local_in_edges_tensor generation:  0.017200708389282227
mini_batch_src_global generation:  0.037274837493896484
r_  generation:  0.31174468994140625
local_output_nid generation:  0.016788005828857422
local_in_edges_tensor generation:  0.01846599578857422
mini_batch_src_global generation:  0.039469242095947266
r_  generation:  0.31075596809387207
local_output_nid generation:  0.017096519470214844
local_in_edges_tensor generation:  0.018402576446533203
mini_batch_src_global generation:  0.037664175033569336
r_  generation:  0.3116881847381592
local_output_nid generation:  0.01707625389099121
local_in_edges_tensor generation:  0.01877760887145996
mini_batch_src_global generation:  0.04152965545654297
r_  generation:  0.3124828338623047
----------------------check_connections_block total spend ----------------------------- 3.5782742500305176
generate_one_block  0.3865013122558594
generate_one_block  0.3864316940307617
generate_one_block  0.39457058906555176
generate_one_block  0.3912036418914795
generate_one_block  0.38559556007385254
generate_one_block  0.3948550224304199
generate_one_block  0.3919360637664795
generate_one_block  0.41901087760925293
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03202199935913086
gen group dst list time:  0.03704071044921875
time for parepare:  0.01862168312072754
local_output_nid generation:  0.026941537857055664
local_in_edges_tensor generation:  0.037471771240234375
mini_batch_src_global generation:  0.04404425621032715
r_  generation:  0.47194385528564453
local_output_nid generation:  0.033026933670043945
local_in_edges_tensor generation:  0.03901982307434082
mini_batch_src_global generation:  0.054587364196777344
r_  generation:  0.47679591178894043
local_output_nid generation:  0.03317737579345703
local_in_edges_tensor generation:  0.03310251235961914
mini_batch_src_global generation:  0.05200839042663574
r_  generation:  0.48937058448791504
local_output_nid generation:  0.03372335433959961
local_in_edges_tensor generation:  0.03130912780761719
mini_batch_src_global generation:  0.05839395523071289
r_  generation:  0.4816093444824219
local_output_nid generation:  0.0339353084564209
local_in_edges_tensor generation:  0.033664703369140625
mini_batch_src_global generation:  0.0627131462097168
r_  generation:  0.4944727420806885
local_output_nid generation:  0.034882545471191406
local_in_edges_tensor generation:  0.04269909858703613
mini_batch_src_global generation:  0.06634354591369629
r_  generation:  0.4883902072906494
local_output_nid generation:  0.036843061447143555
local_in_edges_tensor generation:  0.03597068786621094
mini_batch_src_global generation:  0.05523943901062012
r_  generation:  0.4980466365814209
local_output_nid generation:  0.034952402114868164
local_in_edges_tensor generation:  0.03645491600036621
mini_batch_src_global generation:  0.05611228942871094
r_  generation:  0.48604774475097656
----------------------check_connections_block total spend ----------------------------- 5.775033712387085
generate_one_block  0.6045992374420166
generate_one_block  0.6043994426727295
generate_one_block  0.6138546466827393
generate_one_block  0.6127884387969971
generate_one_block  0.6109929084777832
generate_one_block  0.6120162010192871
generate_one_block  0.6159603595733643
generate_one_block  0.6046130657196045
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.13104009628295898  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

connection checking time:  9.353307962417603
block generation total time  8.029329061508179
average batch blocks generation time:  1.0036661326885223
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1011204719543457  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9029207229614258  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1011800765991211  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9010958671569824  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10128164291381836  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9040861129760742  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10123348236083984  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9049892425537109  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10133600234985352  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9037718772888184  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10146903991699219  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9062314033508301  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10130834579467773  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9059062004089355  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10112810134887695  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9052491188049316  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0797722339630127 |0.014018416404724121 |0.003579258918762207 |9.360909461975098e-05 |0.003795713186264038 |0.0029730796813964844 |
----------------------------------------------------------pseudo_mini_loss sum 1.6379897594451904
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  2957792
Number of first layer input nodes during this epoch:  1284330
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12966108322143555  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021142005920410156
range selection method range initialization spend 0.012332677841186523
time for parepare:  0.01640009880065918
local_output_nid generation:  0.0028417110443115234
local_in_edges_tensor generation:  0.00835418701171875
mini_batch_src_global generation:  0.0034525394439697266
r_  generation:  0.03753304481506348
local_output_nid generation:  0.0032269954681396484
local_in_edges_tensor generation:  0.0017511844635009766
mini_batch_src_global generation:  0.004383087158203125
r_  generation:  0.039855003356933594
local_output_nid generation:  0.0031986236572265625
local_in_edges_tensor generation:  0.0017726421356201172
mini_batch_src_global generation:  0.002933502197265625
r_  generation:  0.03962540626525879
local_output_nid generation:  0.0032570362091064453
local_in_edges_tensor generation:  0.0017943382263183594
mini_batch_src_global generation:  0.0028700828552246094
r_  generation:  0.04079031944274902
local_output_nid generation:  0.0031774044036865234
local_in_edges_tensor generation:  0.00176239013671875
mini_batch_src_global generation:  0.0030143260955810547
r_  generation:  0.04220151901245117
local_output_nid generation:  0.0032470226287841797
local_in_edges_tensor generation:  0.0017850399017333984
mini_batch_src_global generation:  0.0031595230102539062
r_  generation:  0.0422663688659668
local_output_nid generation:  0.003203153610229492
local_in_edges_tensor generation:  0.0017616748809814453
mini_batch_src_global generation:  0.00322723388671875
r_  generation:  0.042420148849487305
local_output_nid generation:  0.0032110214233398438
local_in_edges_tensor generation:  0.001753091812133789
mini_batch_src_global generation:  0.003206014633178711
r_  generation:  0.042212724685668945
----------------------check_connections_block total spend ----------------------------- 0.49053192138671875
generate_one_block  0.053644657135009766
generate_one_block  0.056615352630615234
generate_one_block  0.05474138259887695
generate_one_block  0.05522322654724121
generate_one_block  0.055281877517700195
generate_one_block  0.05612969398498535
generate_one_block  0.058132171630859375
generate_one_block  0.054643869400024414
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03801870346069336
gen group dst list time:  0.014571189880371094
time for parepare:  0.0199429988861084
local_output_nid generation:  0.010933399200439453
local_in_edges_tensor generation:  0.02881002426147461
mini_batch_src_global generation:  0.02981710433959961
r_  generation:  0.2944471836090088
local_output_nid generation:  0.016644954681396484
local_in_edges_tensor generation:  0.022044897079467773
mini_batch_src_global generation:  0.04166769981384277
r_  generation:  0.3020625114440918
local_output_nid generation:  0.018130064010620117
local_in_edges_tensor generation:  0.019223451614379883
mini_batch_src_global generation:  0.03909754753112793
r_  generation:  0.3071002960205078
local_output_nid generation:  0.01708221435546875
local_in_edges_tensor generation:  0.021566152572631836
mini_batch_src_global generation:  0.03940105438232422
r_  generation:  0.31961536407470703
local_output_nid generation:  0.020142316818237305
local_in_edges_tensor generation:  0.017298221588134766
mini_batch_src_global generation:  0.03831171989440918
r_  generation:  0.3137543201446533
local_output_nid generation:  0.017590761184692383
local_in_edges_tensor generation:  0.020049333572387695
mini_batch_src_global generation:  0.038398027420043945
r_  generation:  0.311476469039917
local_output_nid generation:  0.0174252986907959
local_in_edges_tensor generation:  0.018976449966430664
mini_batch_src_global generation:  0.03853344917297363
r_  generation:  0.3161191940307617
local_output_nid generation:  0.017345905303955078
local_in_edges_tensor generation:  0.01785874366760254
mini_batch_src_global generation:  0.03781604766845703
r_  generation:  0.3086276054382324
----------------------check_connections_block total spend ----------------------------- 3.6334714889526367
generate_one_block  0.3907291889190674
generate_one_block  0.3939170837402344
generate_one_block  0.39136672019958496
generate_one_block  0.39046335220336914
generate_one_block  0.39449501037597656
generate_one_block  0.39371609687805176
generate_one_block  0.39421820640563965
generate_one_block  0.407759428024292
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0338900089263916
gen group dst list time:  0.03729581832885742
time for parepare:  0.019752025604248047
local_output_nid generation:  0.026619911193847656
local_in_edges_tensor generation:  0.04929208755493164
mini_batch_src_global generation:  0.046399593353271484
r_  generation:  0.4688224792480469
local_output_nid generation:  0.03296399116516113
local_in_edges_tensor generation:  0.03763914108276367
mini_batch_src_global generation:  0.05623650550842285
r_  generation:  0.47402000427246094
local_output_nid generation:  0.034857988357543945
local_in_edges_tensor generation:  0.033020734786987305
mini_batch_src_global generation:  0.05332159996032715
r_  generation:  0.4888150691986084
local_output_nid generation:  0.03367781639099121
local_in_edges_tensor generation:  0.03319740295410156
mini_batch_src_global generation:  0.05507040023803711
r_  generation:  0.4896886348724365
local_output_nid generation:  0.03394293785095215
local_in_edges_tensor generation:  0.036203861236572266
mini_batch_src_global generation:  0.054286956787109375
r_  generation:  0.5049223899841309
local_output_nid generation:  0.03381681442260742
local_in_edges_tensor generation:  0.036476850509643555
mini_batch_src_global generation:  0.0556180477142334
r_  generation:  0.48613643646240234
local_output_nid generation:  0.033715248107910156
local_in_edges_tensor generation:  0.03143000602722168
mini_batch_src_global generation:  0.05388808250427246
r_  generation:  0.5005738735198975
local_output_nid generation:  0.03418540954589844
local_in_edges_tensor generation:  0.031537771224975586
mini_batch_src_global generation:  0.055968523025512695
r_  generation:  0.4869801998138428
----------------------check_connections_block total spend ----------------------------- 5.770578145980835
generate_one_block  0.6062688827514648
generate_one_block  0.6083612442016602
generate_one_block  0.606860876083374
generate_one_block  0.6078915596008301
generate_one_block  0.6124036312103271
generate_one_block  0.6133108139038086
generate_one_block  0.6082282066345215
generate_one_block  0.6026294231414795
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12966108322143555  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

connection checking time:  9.404049634933472
block generation total time  8.022619724273682
average batch blocks generation time:  1.0028274655342102
block dataloader generation time/epoch 19.281902551651
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10107612609863281  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9029474258422852  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10119199752807617  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9047956466674805  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10119962692260742  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.902677059173584  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10123062133789062  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9023256301879883  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10124635696411133  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9060864448547363  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10129737854003906  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9036860466003418  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10118246078491211  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.90545654296875  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10126733779907227  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9020581245422363  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08092939853668213 |0.011527270078659058 |0.0035504400730133057 |9.271502494812012e-05 |0.003773987293243408 |0.0013709068298339844 |
----------------------------------------------------------pseudo_mini_loss sum 1.5891138315200806
Total (block generation + training)time/epoch 20.149711847305298
Training time/epoch 0.8675713539123535
Training time without block to device /epoch 0.775353193283081
Training time without total dataloading part /epoch 0.060708045959472656
load block tensor time/epoch 0.647435188293457
block to device time/epoch 0.09221816062927246
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  2956285
Number of first layer input nodes during this epoch:  1284026
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.13000965118408203  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019866943359375
range selection method range initialization spend 0.012113332748413086
time for parepare:  0.01665520668029785
local_output_nid generation:  0.0027799606323242188
local_in_edges_tensor generation:  0.003995656967163086
mini_batch_src_global generation:  0.0033791065216064453
r_  generation:  0.03704571723937988
local_output_nid generation:  0.0032782554626464844
local_in_edges_tensor generation:  0.0020062923431396484
mini_batch_src_global generation:  0.004220008850097656
r_  generation:  0.039899587631225586
local_output_nid generation:  0.0032019615173339844
local_in_edges_tensor generation:  0.00174713134765625
mini_batch_src_global generation:  0.002852201461791992
r_  generation:  0.04071521759033203
local_output_nid generation:  0.0032558441162109375
local_in_edges_tensor generation:  0.001741647720336914
mini_batch_src_global generation:  0.0029196739196777344
r_  generation:  0.041283369064331055
local_output_nid generation:  0.0032601356506347656
local_in_edges_tensor generation:  0.0017085075378417969
mini_batch_src_global generation:  0.0030689239501953125
r_  generation:  0.04180026054382324
local_output_nid generation:  0.003236532211303711
local_in_edges_tensor generation:  0.0017285346984863281
mini_batch_src_global generation:  0.0031845569610595703
r_  generation:  0.042109012603759766
local_output_nid generation:  0.0032444000244140625
local_in_edges_tensor generation:  0.0017185211181640625
mini_batch_src_global generation:  0.003192424774169922
r_  generation:  0.04193615913391113
local_output_nid generation:  0.0032460689544677734
local_in_edges_tensor generation:  0.0017142295837402344
mini_batch_src_global generation:  0.003238677978515625
r_  generation:  0.04202103614807129
----------------------check_connections_block total spend ----------------------------- 0.4826805591583252
generate_one_block  0.05299115180969238
generate_one_block  0.05473041534423828
generate_one_block  0.05460643768310547
generate_one_block  0.05499529838562012
generate_one_block  0.05467724800109863
generate_one_block  0.05483579635620117
generate_one_block  0.057439565658569336
generate_one_block  0.05506443977355957
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0348515510559082
gen group dst list time:  0.014588117599487305
time for parepare:  0.01981973648071289
local_output_nid generation:  0.010581731796264648
local_in_edges_tensor generation:  0.023021936416625977
mini_batch_src_global generation:  0.0302278995513916
r_  generation:  0.29414796829223633
local_output_nid generation:  0.016552448272705078
local_in_edges_tensor generation:  0.020435810089111328
mini_batch_src_global generation:  0.03594398498535156
r_  generation:  0.3021111488342285
local_output_nid generation:  0.01722240447998047
local_in_edges_tensor generation:  0.01713109016418457
mini_batch_src_global generation:  0.03620147705078125
r_  generation:  0.31514811515808105
local_output_nid generation:  0.017131328582763672
local_in_edges_tensor generation:  0.018732786178588867
mini_batch_src_global generation:  0.03679156303405762
r_  generation:  0.3139035701751709
local_output_nid generation:  0.017736196517944336
local_in_edges_tensor generation:  0.01772904396057129
mini_batch_src_global generation:  0.03813791275024414
r_  generation:  0.3141319751739502
local_output_nid generation:  0.016779422760009766
local_in_edges_tensor generation:  0.0174405574798584
mini_batch_src_global generation:  0.03802967071533203
r_  generation:  0.30902099609375
local_output_nid generation:  0.01691913604736328
local_in_edges_tensor generation:  0.017365217208862305
mini_batch_src_global generation:  0.03994607925415039
r_  generation:  0.3095734119415283
local_output_nid generation:  0.016977787017822266
local_in_edges_tensor generation:  0.01772451400756836
mini_batch_src_global generation:  0.03782987594604492
r_  generation:  0.3128941059112549
----------------------check_connections_block total spend ----------------------------- 3.592750310897827
generate_one_block  0.39067721366882324
generate_one_block  0.39090895652770996
generate_one_block  0.39278745651245117
generate_one_block  0.3923184871673584
generate_one_block  0.39525890350341797
generate_one_block  0.3882019519805908
generate_one_block  0.3907787799835205
generate_one_block  0.4132559299468994
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030702829360961914
gen group dst list time:  0.03761124610900879
time for parepare:  0.0193023681640625
local_output_nid generation:  0.025966405868530273
local_in_edges_tensor generation:  0.03789067268371582
mini_batch_src_global generation:  0.04415750503540039
r_  generation:  0.47339725494384766
local_output_nid generation:  0.032752275466918945
local_in_edges_tensor generation:  0.031052827835083008
mini_batch_src_global generation:  0.05488848686218262
r_  generation:  0.4833090305328369
local_output_nid generation:  0.03394126892089844
local_in_edges_tensor generation:  0.030629873275756836
mini_batch_src_global generation:  0.05204653739929199
r_  generation:  0.49341535568237305
local_output_nid generation:  0.033888816833496094
local_in_edges_tensor generation:  0.03152155876159668
mini_batch_src_global generation:  0.056527137756347656
r_  generation:  0.48371362686157227
local_output_nid generation:  0.033524513244628906
local_in_edges_tensor generation:  0.034857988357543945
mini_batch_src_global generation:  0.054763078689575195
r_  generation:  0.5055274963378906
local_output_nid generation:  0.03393244743347168
local_in_edges_tensor generation:  0.031568050384521484
mini_batch_src_global generation:  0.055989742279052734
r_  generation:  0.48429250717163086
local_output_nid generation:  0.03397107124328613
local_in_edges_tensor generation:  0.031104087829589844
mini_batch_src_global generation:  0.05365324020385742
r_  generation:  0.49909353256225586
local_output_nid generation:  0.034319400787353516
local_in_edges_tensor generation:  0.0308988094329834
mini_batch_src_global generation:  0.05592513084411621
r_  generation:  0.4888880252838135
----------------------check_connections_block total spend ----------------------------- 5.74060320854187
generate_one_block  0.5992932319641113
generate_one_block  0.6031150817871094
generate_one_block  0.6038894653320312
generate_one_block  0.6102521419525146
generate_one_block  0.6131637096405029
generate_one_block  0.604015588760376
generate_one_block  0.6065609455108643
generate_one_block  0.6151490211486816
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.13000965118408203  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

connection checking time:  9.333353519439697
block generation total time  8.009626865386963
average batch blocks generation time:  1.0012033581733704
block dataloader generation time/epoch 19.22683823108673
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1017160415649414  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9064865112304688  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1010446548461914  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.903231143951416  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10104894638061523  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9035029411315918  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10129308700561523  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9034833908081055  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10137796401977539  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9068622589111328  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10120201110839844  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9022855758666992  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10142183303833008  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9010777473449707  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10129308700561523  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9029169082641602  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.080841064453125 |0.01229172945022583 |0.003465116024017334 |9.289383888244629e-05 |0.003738224506378174 |0.0015790462493896484 |
----------------------------------------------------------pseudo_mini_loss sum 1.5510988235473633
Total (block generation + training)time/epoch 20.098899483680725
Training time/epoch 0.8761069774627686
Training time without block to device /epoch 0.7777731418609619
Training time without total dataloading part /epoch 0.05994892120361328
load block tensor time/epoch 0.646728515625
block to device time/epoch 0.09833383560180664
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  2956649
Number of first layer input nodes during this epoch:  1284085
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12974834442138672  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020607948303222656
range selection method range initialization spend 0.012169361114501953
time for parepare:  0.01669931411743164
local_output_nid generation:  0.002730131149291992
local_in_edges_tensor generation:  0.0038428306579589844
mini_batch_src_global generation:  0.0034017562866210938
r_  generation:  0.03851056098937988
local_output_nid generation:  0.003289937973022461
local_in_edges_tensor generation:  0.0017504692077636719
mini_batch_src_global generation:  0.004301309585571289
r_  generation:  0.04024386405944824
local_output_nid generation:  0.003194093704223633
local_in_edges_tensor generation:  0.0018155574798583984
mini_batch_src_global generation:  0.0029387474060058594
r_  generation:  0.040581703186035156
local_output_nid generation:  0.003220796585083008
local_in_edges_tensor generation:  0.0017464160919189453
mini_batch_src_global generation:  0.002994537353515625
r_  generation:  0.04090070724487305
local_output_nid generation:  0.0032913684844970703
local_in_edges_tensor generation:  0.001741647720336914
mini_batch_src_global generation:  0.0030634403228759766
r_  generation:  0.042362213134765625
local_output_nid generation:  0.0031936168670654297
local_in_edges_tensor generation:  0.0018227100372314453
mini_batch_src_global generation:  0.0031692981719970703
r_  generation:  0.04190802574157715
local_output_nid generation:  0.0031633377075195312
local_in_edges_tensor generation:  0.0017654895782470703
mini_batch_src_global generation:  0.003221750259399414
r_  generation:  0.04268670082092285
local_output_nid generation:  0.0032079219818115234
local_in_edges_tensor generation:  0.0017440319061279297
mini_batch_src_global generation:  0.0032417774200439453
r_  generation:  0.04223060607910156
----------------------check_connections_block total spend ----------------------------- 0.4855194091796875
generate_one_block  0.0537869930267334
generate_one_block  0.055013179779052734
generate_one_block  0.05420875549316406
generate_one_block  0.05478096008300781
generate_one_block  0.05461287498474121
generate_one_block  0.05464911460876465
generate_one_block  0.05849432945251465
generate_one_block  0.0551605224609375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.033751487731933594
gen group dst list time:  0.014500617980957031
time for parepare:  0.020397186279296875
local_output_nid generation:  0.010967254638671875
local_in_edges_tensor generation:  0.02419900894165039
mini_batch_src_global generation:  0.03444027900695801
r_  generation:  0.2957324981689453
local_output_nid generation:  0.016799449920654297
local_in_edges_tensor generation:  0.019118070602416992
mini_batch_src_global generation:  0.04181408882141113
r_  generation:  0.3053443431854248
local_output_nid generation:  0.01711440086364746
local_in_edges_tensor generation:  0.018470048904418945
mini_batch_src_global generation:  0.04389834403991699
r_  generation:  0.3037445545196533
local_output_nid generation:  0.01691889762878418
local_in_edges_tensor generation:  0.020427227020263672
mini_batch_src_global generation:  0.049079179763793945
r_  generation:  0.3073461055755615
local_output_nid generation:  0.019530773162841797
local_in_edges_tensor generation:  0.018547534942626953
mini_batch_src_global generation:  0.038733720779418945
r_  generation:  0.31130218505859375
local_output_nid generation:  0.017760038375854492
local_in_edges_tensor generation:  0.01816701889038086
mini_batch_src_global generation:  0.037291526794433594
r_  generation:  0.30779528617858887
local_output_nid generation:  0.017498254776000977
local_in_edges_tensor generation:  0.01862502098083496
mini_batch_src_global generation:  0.03776979446411133
r_  generation:  0.3073256015777588
local_output_nid generation:  0.017551898956298828
local_in_edges_tensor generation:  0.018793106079101562
mini_batch_src_global generation:  0.0375978946685791
r_  generation:  0.30818963050842285
----------------------check_connections_block total spend ----------------------------- 3.6107535362243652
generate_one_block  0.3972601890563965
generate_one_block  0.3979809284210205
generate_one_block  0.388749361038208
generate_one_block  0.3951845169067383
generate_one_block  0.3891875743865967
generate_one_block  0.38704752922058105
generate_one_block  0.38852763175964355
generate_one_block  0.4141871929168701
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03303027153015137
gen group dst list time:  0.037781476974487305
time for parepare:  0.019379377365112305
local_output_nid generation:  0.025216341018676758
local_in_edges_tensor generation:  0.04726576805114746
mini_batch_src_global generation:  0.044457197189331055
r_  generation:  0.47076940536499023
local_output_nid generation:  0.03293800354003906
local_in_edges_tensor generation:  0.03989768028259277
mini_batch_src_global generation:  0.05733799934387207
r_  generation:  0.47884273529052734
local_output_nid generation:  0.03287959098815918
local_in_edges_tensor generation:  0.03261852264404297
mini_batch_src_global generation:  0.053061485290527344
r_  generation:  0.4887733459472656
local_output_nid generation:  0.03324627876281738
local_in_edges_tensor generation:  0.03120279312133789
mini_batch_src_global generation:  0.05511188507080078
r_  generation:  0.47998642921447754
local_output_nid generation:  0.033609628677368164
local_in_edges_tensor generation:  0.03125739097595215
mini_batch_src_global generation:  0.05409097671508789
r_  generation:  0.49541211128234863
local_output_nid generation:  0.033655405044555664
local_in_edges_tensor generation:  0.030968427658081055
mini_batch_src_global generation:  0.05751657485961914
r_  generation:  0.48482227325439453
local_output_nid generation:  0.03363037109375
local_in_edges_tensor generation:  0.035616159439086914
mini_batch_src_global generation:  0.05389237403869629
r_  generation:  0.49890923500061035
local_output_nid generation:  0.0342860221862793
local_in_edges_tensor generation:  0.03025960922241211
mini_batch_src_global generation:  0.05622506141662598
r_  generation:  0.48250722885131836
----------------------check_connections_block total spend ----------------------------- 5.73015570640564
generate_one_block  0.6082334518432617
generate_one_block  0.6120872497558594
generate_one_block  0.6091291904449463
generate_one_block  0.6061830520629883
generate_one_block  0.6071431636810303
generate_one_block  0.6099412441253662
generate_one_block  0.6079189777374268
generate_one_block  0.6128818988800049
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12974834442138672  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

connection checking time:  9.340909242630005
block generation total time  8.031643152236938
average batch blocks generation time:  1.0039553940296173
block dataloader generation time/epoch 19.210396607716877
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10139131546020508  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9073047637939453  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10157299041748047  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9113063812255859  GigaBytes
Max Memory Allocated: 1.0416045188903809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1010284423828125  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9035177230834961  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10125398635864258  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9023690223693848  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10103702545166016  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9031944274902344  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10136938095092773  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9044733047485352  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10113906860351562  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9019784927368164  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10109472274780273  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9024500846862793  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07440516352653503 |0.011367231607437134 |0.0037955939769744873 |9.310245513916016e-05 |0.009239345788955688 |0.0016660690307617188 |
----------------------------------------------------------pseudo_mini_loss sum 1.5166746377944946
Total (block generation + training)time/epoch 20.079569657643635
Training time/epoch 0.8631241321563721
Training time without block to device /epoch 0.772186279296875
Training time without total dataloading part /epoch 0.1066904067993164
load block tensor time/epoch 0.5952413082122803
block to device time/epoch 0.09093785285949707
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  2956880
Number of first layer input nodes during this epoch:  1284166
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12953472137451172  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03338503837585449
range selection method range initialization spend 0.012418270111083984
time for parepare:  0.016168594360351562
local_output_nid generation:  0.0027015209197998047
local_in_edges_tensor generation:  0.012307167053222656
mini_batch_src_global generation:  0.0032622814178466797
r_  generation:  0.0387568473815918
local_output_nid generation:  0.003204345703125
local_in_edges_tensor generation:  0.0018372535705566406
mini_batch_src_global generation:  0.004340648651123047
r_  generation:  0.040349721908569336
local_output_nid generation:  0.003209352493286133
local_in_edges_tensor generation:  0.0019347667694091797
mini_batch_src_global generation:  0.002957582473754883
r_  generation:  0.04167771339416504
local_output_nid generation:  0.0032668113708496094
local_in_edges_tensor generation:  0.00182342529296875
mini_batch_src_global generation:  0.0032355785369873047
r_  generation:  0.0420832633972168
local_output_nid generation:  0.003211498260498047
local_in_edges_tensor generation:  0.0017323493957519531
mini_batch_src_global generation:  0.0031783580780029297
r_  generation:  0.0421290397644043
local_output_nid generation:  0.003226757049560547
local_in_edges_tensor generation:  0.0017697811126708984
mini_batch_src_global generation:  0.0032782554626464844
r_  generation:  0.042635440826416016
local_output_nid generation:  0.003261089324951172
local_in_edges_tensor generation:  0.0019299983978271484
mini_batch_src_global generation:  0.0032689571380615234
r_  generation:  0.0421903133392334
local_output_nid generation:  0.0032689571380615234
local_in_edges_tensor generation:  0.0018000602722167969
mini_batch_src_global generation:  0.0032684803009033203
r_  generation:  0.04223155975341797
----------------------check_connections_block total spend ----------------------------- 0.5025477409362793
generate_one_block  0.05475568771362305
generate_one_block  0.05496859550476074
generate_one_block  0.05428028106689453
generate_one_block  0.05568838119506836
generate_one_block  0.05532383918762207
generate_one_block  0.055231332778930664
generate_one_block  0.057906389236450195
generate_one_block  0.05562639236450195
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03657841682434082
gen group dst list time:  0.014251708984375
time for parepare:  0.020440101623535156
local_output_nid generation:  0.01122140884399414
local_in_edges_tensor generation:  0.02507925033569336
mini_batch_src_global generation:  0.030304908752441406
r_  generation:  0.29349255561828613
local_output_nid generation:  0.017001867294311523
local_in_edges_tensor generation:  0.021727561950683594
mini_batch_src_global generation:  0.0369107723236084
r_  generation:  0.3024718761444092
local_output_nid generation:  0.01709604263305664
local_in_edges_tensor generation:  0.017849206924438477
mini_batch_src_global generation:  0.03542804718017578
r_  generation:  0.302234411239624
local_output_nid generation:  0.016783714294433594
local_in_edges_tensor generation:  0.020763158798217773
mini_batch_src_global generation:  0.03764820098876953
r_  generation:  0.3089747428894043
local_output_nid generation:  0.018166542053222656
local_in_edges_tensor generation:  0.018796443939208984
mini_batch_src_global generation:  0.03836250305175781
r_  generation:  0.31638216972351074
local_output_nid generation:  0.017413616180419922
local_in_edges_tensor generation:  0.017548084259033203
mini_batch_src_global generation:  0.037888526916503906
r_  generation:  0.3108704090118408
local_output_nid generation:  0.017021656036376953
local_in_edges_tensor generation:  0.025565385818481445
mini_batch_src_global generation:  0.04033946990966797
r_  generation:  0.3143348693847656
local_output_nid generation:  0.017232418060302734
local_in_edges_tensor generation:  0.0194854736328125
mini_batch_src_global generation:  0.03821134567260742
r_  generation:  0.31247901916503906
----------------------check_connections_block total spend ----------------------------- 3.6071577072143555
generate_one_block  0.38797855377197266
generate_one_block  0.3879721164703369
generate_one_block  0.3878641128540039
generate_one_block  0.3960444927215576
generate_one_block  0.39696836471557617
generate_one_block  0.3893864154815674
generate_one_block  0.39612388610839844
generate_one_block  0.40982604026794434
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0374598503112793
gen group dst list time:  0.03867483139038086
time for parepare:  0.018613100051879883
local_output_nid generation:  0.02637791633605957
local_in_edges_tensor generation:  0.04070472717285156
mini_batch_src_global generation:  0.04607725143432617
r_  generation:  0.48568248748779297
local_output_nid generation:  0.03561711311340332
local_in_edges_tensor generation:  0.03825807571411133
mini_batch_src_global generation:  0.05546283721923828
r_  generation:  0.4789712429046631
local_output_nid generation:  0.03423452377319336
local_in_edges_tensor generation:  0.03281068801879883
mini_batch_src_global generation:  0.05178093910217285
r_  generation:  0.4869089126586914
local_output_nid generation:  0.035018205642700195
local_in_edges_tensor generation:  0.032645463943481445
mini_batch_src_global generation:  0.055037736892700195
r_  generation:  0.4865603446960449
local_output_nid generation:  0.03433680534362793
local_in_edges_tensor generation:  0.03765869140625
mini_batch_src_global generation:  0.05395817756652832
r_  generation:  0.49706268310546875
local_output_nid generation:  0.03449392318725586
local_in_edges_tensor generation:  0.03331589698791504
mini_batch_src_global generation:  0.05544114112854004
r_  generation:  0.4866189956665039
local_output_nid generation:  0.035080909729003906
local_in_edges_tensor generation:  0.03321385383605957
mini_batch_src_global generation:  0.05490756034851074
r_  generation:  0.5009548664093018
local_output_nid generation:  0.03602743148803711
local_in_edges_tensor generation:  0.03239560127258301
mini_batch_src_global generation:  0.05630850791931152
r_  generation:  0.48905396461486816
----------------------check_connections_block total spend ----------------------------- 5.778728723526001
generate_one_block  0.6129417419433594
generate_one_block  0.6117491722106934
generate_one_block  0.6047227382659912
generate_one_block  0.6102991104125977
generate_one_block  0.6142308712005615
generate_one_block  0.6016445159912109
generate_one_block  0.6170172691345215
generate_one_block  0.6215837001800537
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12953472137451172  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

connection checking time:  9.385886430740356
block generation total time  8.046353101730347
average batch blocks generation time:  1.0057941377162933
block dataloader generation time/epoch 19.230030298233032
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10119009017944336  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9025864601135254  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10126447677612305  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9056620597839355  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10100984573364258  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9014277458190918  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10177087783813477  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.905092716217041  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10135364532470703  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9043259620666504  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10106849670410156  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9023251533508301  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10119771957397461  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9045724868774414  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10115718841552734  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9038128852844238  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07907024025917053 |0.01137050986289978 |0.003566563129425049 |9.256601333618164e-05 |0.0037994980812072754 |0.0027649402618408203 |
----------------------------------------------------------pseudo_mini_loss sum 1.4771047830581665
Total (block generation + training)time/epoch 20.09487235546112
Training time/epoch 0.8516640663146973
Training time without block to device /epoch 0.760699987411499
Training time without total dataloading part /epoch 0.06243395805358887
load block tensor time/epoch 0.6325619220733643
block to device time/epoch 0.09096407890319824
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  2956172
Number of first layer input nodes during this epoch:  1284018
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1297297477722168  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020822763442993164
range selection method range initialization spend 0.012787342071533203
time for parepare:  0.016466379165649414
local_output_nid generation:  0.002874135971069336
local_in_edges_tensor generation:  0.004670858383178711
mini_batch_src_global generation:  0.003161907196044922
r_  generation:  0.038266658782958984
local_output_nid generation:  0.003165006637573242
local_in_edges_tensor generation:  0.001773834228515625
mini_batch_src_global generation:  0.004329204559326172
r_  generation:  0.03993868827819824
local_output_nid generation:  0.003187894821166992
local_in_edges_tensor generation:  0.0017116069793701172
mini_batch_src_global generation:  0.002908468246459961
r_  generation:  0.04046034812927246
local_output_nid generation:  0.0032613277435302734
local_in_edges_tensor generation:  0.0017702579498291016
mini_batch_src_global generation:  0.0030252933502197266
r_  generation:  0.04115939140319824
local_output_nid generation:  0.0032427310943603516
local_in_edges_tensor generation:  0.0017514228820800781
mini_batch_src_global generation:  0.003175497055053711
r_  generation:  0.04170966148376465
local_output_nid generation:  0.003209352493286133
local_in_edges_tensor generation:  0.0017435550689697266
mini_batch_src_global generation:  0.003294229507446289
r_  generation:  0.04195666313171387
local_output_nid generation:  0.003256082534790039
local_in_edges_tensor generation:  0.0016980171203613281
mini_batch_src_global generation:  0.0032575130462646484
r_  generation:  0.041517019271850586
local_output_nid generation:  0.0032444000244140625
local_in_edges_tensor generation:  0.0017855167388916016
mini_batch_src_global generation:  0.003271341323852539
r_  generation:  0.042292118072509766
----------------------check_connections_block total spend ----------------------------- 0.4840846061706543
generate_one_block  0.053093671798706055
generate_one_block  0.054840803146362305
generate_one_block  0.054943084716796875
generate_one_block  0.05565381050109863
generate_one_block  0.05534958839416504
generate_one_block  0.05520129203796387
generate_one_block  0.05721163749694824
generate_one_block  0.05542755126953125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.031751155853271484
gen group dst list time:  0.014459371566772461
time for parepare:  0.01984262466430664
local_output_nid generation:  0.010984182357788086
local_in_edges_tensor generation:  0.02199244499206543
mini_batch_src_global generation:  0.029688119888305664
r_  generation:  0.29108142852783203
local_output_nid generation:  0.016841888427734375
local_in_edges_tensor generation:  0.02056574821472168
mini_batch_src_global generation:  0.03721761703491211
r_  generation:  0.30480384826660156
local_output_nid generation:  0.01732945442199707
local_in_edges_tensor generation:  0.020467758178710938
mini_batch_src_global generation:  0.03803062438964844
r_  generation:  0.31128573417663574
local_output_nid generation:  0.017749309539794922
local_in_edges_tensor generation:  0.016994714736938477
mini_batch_src_global generation:  0.03715944290161133
r_  generation:  0.3142561912536621
local_output_nid generation:  0.01792120933532715
local_in_edges_tensor generation:  0.017502784729003906
mini_batch_src_global generation:  0.03824019432067871
r_  generation:  0.31372666358947754
local_output_nid generation:  0.017233610153198242
local_in_edges_tensor generation:  0.017000675201416016
mini_batch_src_global generation:  0.0379481315612793
r_  generation:  0.30989980697631836
local_output_nid generation:  0.016692161560058594
local_in_edges_tensor generation:  0.01677870750427246
mini_batch_src_global generation:  0.03801107406616211
r_  generation:  0.31043481826782227
local_output_nid generation:  0.01705026626586914
local_in_edges_tensor generation:  0.01787877082824707
mini_batch_src_global generation:  0.03783082962036133
r_  generation:  0.313873291015625
----------------------check_connections_block total spend ----------------------------- 3.5966265201568604
generate_one_block  0.39087843894958496
generate_one_block  0.39118218421936035
generate_one_block  0.3923931121826172
generate_one_block  0.3886685371398926
generate_one_block  0.3921513557434082
generate_one_block  0.3936116695404053
generate_one_block  0.38800787925720215
generate_one_block  0.41574549674987793
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.026658058166503906
gen group dst list time:  0.03764200210571289
time for parepare:  0.018982648849487305
local_output_nid generation:  0.025556325912475586
local_in_edges_tensor generation:  0.04436039924621582
mini_batch_src_global generation:  0.04415273666381836
r_  generation:  0.46958327293395996
local_output_nid generation:  0.03240656852722168
local_in_edges_tensor generation:  0.032602787017822266
mini_batch_src_global generation:  0.05430316925048828
r_  generation:  0.48734378814697266
local_output_nid generation:  0.03344106674194336
local_in_edges_tensor generation:  0.03288722038269043
mini_batch_src_global generation:  0.051049232482910156
r_  generation:  0.48977160453796387
local_output_nid generation:  0.033792734146118164
local_in_edges_tensor generation:  0.030438661575317383
mini_batch_src_global generation:  0.05408453941345215
r_  generation:  0.4817512035369873
local_output_nid generation:  0.033646583557128906
local_in_edges_tensor generation:  0.03159785270690918
mini_batch_src_global generation:  0.05305600166320801
r_  generation:  0.49448657035827637
local_output_nid generation:  0.0334782600402832
local_in_edges_tensor generation:  0.032980918884277344
mini_batch_src_global generation:  0.05524277687072754
r_  generation:  0.4833974838256836
local_output_nid generation:  0.03376460075378418
local_in_edges_tensor generation:  0.032831668853759766
mini_batch_src_global generation:  0.05591416358947754
r_  generation:  0.49923110008239746
local_output_nid generation:  0.03403472900390625
local_in_edges_tensor generation:  0.03144097328186035
mini_batch_src_global generation:  0.055977821350097656
r_  generation:  0.4848177433013916
----------------------check_connections_block total spend ----------------------------- 5.722663402557373
generate_one_block  0.6032965183258057
generate_one_block  0.6111068725585938
generate_one_block  0.6075053215026855
generate_one_block  0.60740065574646
generate_one_block  0.600459098815918
generate_one_block  0.6155598163604736
generate_one_block  0.6104598045349121
generate_one_block  0.6156303882598877
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1297297477722168  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

connection checking time:  9.319289922714233
block generation total time  8.024057149887085
average batch blocks generation time:  1.0030071437358856
block dataloader generation time/epoch 19.21463007926941
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1012415885925293  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9025731086730957  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10137462615966797  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9058833122253418  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10111761093139648  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.905003547668457  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10117912292480469  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9079985618591309  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10103225708007812  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9034085273742676  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10129499435424805  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9029965400695801  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1012263298034668  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9051599502563477  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10111093521118164  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9038734436035156  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08117631077766418 |0.011203795671463013 |0.003506481647491455 |8.96751880645752e-05 |0.003736168146133423 |0.0012104511260986328 |
----------------------------------------------------------pseudo_mini_loss sum 1.4517292976379395
Total (block generation + training)time/epoch 20.08187065124512
Training time/epoch 0.8766248226165771
Training time without block to device /epoch 0.786994457244873
Training time without total dataloading part /epoch 0.05986905097961426
load block tensor time/epoch 0.6494104862213135
block to device time/epoch 0.0896303653717041
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  2957738
Number of first layer input nodes during this epoch:  1283717
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12963628768920898  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.016167640686035156
range selection method range initialization spend 0.01194143295288086
time for parepare:  0.016521692276000977
local_output_nid generation:  0.0028057098388671875
local_in_edges_tensor generation:  0.0037965774536132812
mini_batch_src_global generation:  0.0030188560485839844
r_  generation:  0.037824153900146484
local_output_nid generation:  0.0032961368560791016
local_in_edges_tensor generation:  0.0017669200897216797
mini_batch_src_global generation:  0.004360675811767578
r_  generation:  0.03891801834106445
local_output_nid generation:  0.003219127655029297
local_in_edges_tensor generation:  0.0017561912536621094
mini_batch_src_global generation:  0.002931356430053711
r_  generation:  0.03983807563781738
local_output_nid generation:  0.003255605697631836
local_in_edges_tensor generation:  0.0017292499542236328
mini_batch_src_global generation:  0.0029265880584716797
r_  generation:  0.04089474678039551
local_output_nid generation:  0.003184080123901367
local_in_edges_tensor generation:  0.0017151832580566406
mini_batch_src_global generation:  0.0031507015228271484
r_  generation:  0.04228043556213379
local_output_nid generation:  0.0032029151916503906
local_in_edges_tensor generation:  0.0017070770263671875
mini_batch_src_global generation:  0.003268003463745117
r_  generation:  0.04269671440124512
local_output_nid generation:  0.003225564956665039
local_in_edges_tensor generation:  0.0017178058624267578
mini_batch_src_global generation:  0.0032265186309814453
r_  generation:  0.04243659973144531
local_output_nid generation:  0.003258943557739258
local_in_edges_tensor generation:  0.0017113685607910156
mini_batch_src_global generation:  0.0032792091369628906
r_  generation:  0.04237794876098633
----------------------check_connections_block total spend ----------------------------- 0.4827876091003418
generate_one_block  0.05260872840881348
generate_one_block  0.054427385330200195
generate_one_block  0.053354740142822266
generate_one_block  0.05806326866149902
generate_one_block  0.0561213493347168
generate_one_block  0.05526280403137207
generate_one_block  0.05781912803649902
generate_one_block  0.0557401180267334
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02945852279663086
gen group dst list time:  0.014791011810302734
time for parepare:  0.01957416534423828
local_output_nid generation:  0.010675191879272461
local_in_edges_tensor generation:  0.01964545249938965
mini_batch_src_global generation:  0.02910470962524414
r_  generation:  0.28720784187316895
local_output_nid generation:  0.016554594039916992
local_in_edges_tensor generation:  0.016167640686035156
mini_batch_src_global generation:  0.035680294036865234
r_  generation:  0.3022890090942383
local_output_nid generation:  0.0171663761138916
local_in_edges_tensor generation:  0.016906261444091797
mini_batch_src_global generation:  0.03591156005859375
r_  generation:  0.30279111862182617
local_output_nid generation:  0.017059326171875
local_in_edges_tensor generation:  0.01733565330505371
mini_batch_src_global generation:  0.036835670471191406
r_  generation:  0.3098905086517334
local_output_nid generation:  0.018091201782226562
local_in_edges_tensor generation:  0.017152070999145508
mini_batch_src_global generation:  0.03822016716003418
r_  generation:  0.31777310371398926
local_output_nid generation:  0.018736839294433594
local_in_edges_tensor generation:  0.020348548889160156
mini_batch_src_global generation:  0.03810715675354004
r_  generation:  0.3180248737335205
local_output_nid generation:  0.01728510856628418
local_in_edges_tensor generation:  0.017533063888549805
mini_batch_src_global generation:  0.03846001625061035
r_  generation:  0.31165456771850586
local_output_nid generation:  0.017264366149902344
local_in_edges_tensor generation:  0.01735830307006836
mini_batch_src_global generation:  0.03791356086730957
r_  generation:  0.3095254898071289
----------------------check_connections_block total spend ----------------------------- 3.5742533206939697
generate_one_block  0.388275146484375
generate_one_block  0.39550161361694336
generate_one_block  0.38834547996520996
generate_one_block  0.3898940086364746
generate_one_block  0.39265918731689453
generate_one_block  0.3920464515686035
generate_one_block  0.3888392448425293
generate_one_block  0.4166553020477295
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0324702262878418
gen group dst list time:  0.03870129585266113
time for parepare:  0.018911123275756836
local_output_nid generation:  0.02634716033935547
local_in_edges_tensor generation:  0.03759956359863281
mini_batch_src_global generation:  0.043890953063964844
r_  generation:  0.4763939380645752
local_output_nid generation:  0.03265094757080078
local_in_edges_tensor generation:  0.037072181701660156
mini_batch_src_global generation:  0.05515098571777344
r_  generation:  0.4857196807861328
local_output_nid generation:  0.03397059440612793
local_in_edges_tensor generation:  0.030895709991455078
mini_batch_src_global generation:  0.051746368408203125
r_  generation:  0.5003180503845215
local_output_nid generation:  0.033516645431518555
local_in_edges_tensor generation:  0.03056502342224121
mini_batch_src_global generation:  0.05482363700866699
r_  generation:  0.48555970191955566
local_output_nid generation:  0.0336461067199707
local_in_edges_tensor generation:  0.03164839744567871
mini_batch_src_global generation:  0.05303072929382324
r_  generation:  0.497922420501709
local_output_nid generation:  0.03379702568054199
local_in_edges_tensor generation:  0.030932188034057617
mini_batch_src_global generation:  0.05575251579284668
r_  generation:  0.4914689064025879
local_output_nid generation:  0.033451080322265625
local_in_edges_tensor generation:  0.03110218048095703
mini_batch_src_global generation:  0.05651235580444336
r_  generation:  0.5085010528564453
local_output_nid generation:  0.03389620780944824
local_in_edges_tensor generation:  0.031830549240112305
mini_batch_src_global generation:  0.056169748306274414
r_  generation:  0.49054908752441406
----------------------check_connections_block total spend ----------------------------- 5.7688889503479
generate_one_block  0.611274242401123
generate_one_block  0.6146860122680664
generate_one_block  0.6066231727600098
generate_one_block  0.6031420230865479
generate_one_block  0.6036126613616943
generate_one_block  0.614912748336792
generate_one_block  0.6317856311798096
generate_one_block  0.6120219230651855
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12963628768920898  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

connection checking time:  9.34314227104187
block generation total time  8.050274848937988
average batch blocks generation time:  1.0062843561172485
block dataloader generation time/epoch 19.208307147026062
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10104656219482422  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9011688232421875  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10128641128540039  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9047889709472656  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10109615325927734  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9028358459472656  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10124540328979492  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9022722244262695  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10134124755859375  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9043107032775879  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1012415885925293  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9071130752563477  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10116958618164062  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9051518440246582  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1011662483215332  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9044346809387207  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08060422539710999 |0.014739662408828735 |0.003474622964859009 |9.009242057800293e-05 |0.0037063658237457275 |0.002822399139404297 |
----------------------------------------------------------pseudo_mini_loss sum 1.4205657243728638
Total (block generation + training)time/epoch 20.079325874646504
Training time/epoch 0.8896994590759277
Training time without block to device /epoch 0.7717821598052979
Training time without total dataloading part /epoch 0.06099104881286621
load block tensor time/epoch 0.6448338031768799
block to device time/epoch 0.11791729927062988
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  2957227
Number of first layer input nodes during this epoch:  1284077
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12971210479736328  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024126291275024414
range selection method range initialization spend 0.012433528900146484
time for parepare:  0.016145706176757812
local_output_nid generation:  0.0027687549591064453
local_in_edges_tensor generation:  0.0038025379180908203
mini_batch_src_global generation:  0.002959012985229492
r_  generation:  0.0389404296875
local_output_nid generation:  0.0031900405883789062
local_in_edges_tensor generation:  0.0018367767333984375
mini_batch_src_global generation:  0.004173994064331055
r_  generation:  0.03934812545776367
local_output_nid generation:  0.0032072067260742188
local_in_edges_tensor generation:  0.0017628669738769531
mini_batch_src_global generation:  0.003001689910888672
r_  generation:  0.04035210609436035
local_output_nid generation:  0.003175497055053711
local_in_edges_tensor generation:  0.0017244815826416016
mini_batch_src_global generation:  0.0029811859130859375
r_  generation:  0.041545867919921875
local_output_nid generation:  0.0032815933227539062
local_in_edges_tensor generation:  0.0017325878143310547
mini_batch_src_global generation:  0.003241300582885742
r_  generation:  0.04166054725646973
local_output_nid generation:  0.0032312870025634766
local_in_edges_tensor generation:  0.0017745494842529297
mini_batch_src_global generation:  0.0031795501708984375
r_  generation:  0.041815757751464844
local_output_nid generation:  0.003208637237548828
local_in_edges_tensor generation:  0.0017123222351074219
mini_batch_src_global generation:  0.003324270248413086
r_  generation:  0.042792320251464844
local_output_nid generation:  0.0032329559326171875
local_in_edges_tensor generation:  0.0017173290252685547
mini_batch_src_global generation:  0.0033953189849853516
r_  generation:  0.04240751266479492
----------------------check_connections_block total spend ----------------------------- 0.48438501358032227
generate_one_block  0.05272245407104492
generate_one_block  0.05410599708557129
generate_one_block  0.055010318756103516
generate_one_block  0.05539584159851074
generate_one_block  0.054802656173706055
generate_one_block  0.054781436920166016
generate_one_block  0.05798912048339844
generate_one_block  0.05523037910461426
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03641843795776367
gen group dst list time:  0.014011859893798828
time for parepare:  0.02100515365600586
local_output_nid generation:  0.010703802108764648
local_in_edges_tensor generation:  0.02076101303100586
mini_batch_src_global generation:  0.030041217803955078
r_  generation:  0.28303098678588867
local_output_nid generation:  0.019260406494140625
local_in_edges_tensor generation:  0.024104595184326172
mini_batch_src_global generation:  0.03587770462036133
r_  generation:  0.30287766456604004
local_output_nid generation:  0.017121076583862305
local_in_edges_tensor generation:  0.019151926040649414
mini_batch_src_global generation:  0.0360872745513916
r_  generation:  0.3064091205596924
local_output_nid generation:  0.016801834106445312
local_in_edges_tensor generation:  0.018128633499145508
mini_batch_src_global generation:  0.03688859939575195
r_  generation:  0.3087925910949707
local_output_nid generation:  0.017784595489501953
local_in_edges_tensor generation:  0.016946077346801758
mini_batch_src_global generation:  0.03791689872741699
r_  generation:  0.3078739643096924
local_output_nid generation:  0.01786208152770996
local_in_edges_tensor generation:  0.018186569213867188
mini_batch_src_global generation:  0.03773784637451172
r_  generation:  0.3057210445404053
local_output_nid generation:  0.01712942123413086
local_in_edges_tensor generation:  0.01859307289123535
mini_batch_src_global generation:  0.03889298439025879
r_  generation:  0.31896185874938965
local_output_nid generation:  0.018673419952392578
local_in_edges_tensor generation:  0.01851797103881836
mini_batch_src_global generation:  0.03830718994140625
r_  generation:  0.3112761974334717
----------------------check_connections_block total spend ----------------------------- 3.5897510051727295
generate_one_block  0.3871004581451416
generate_one_block  0.39083027839660645
generate_one_block  0.3943502902984619
generate_one_block  0.3963942527770996
generate_one_block  0.390733003616333
generate_one_block  0.3889636993408203
generate_one_block  0.39676785469055176
generate_one_block  0.42261648178100586
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03356480598449707
gen group dst list time:  0.03779458999633789
time for parepare:  0.01889944076538086
local_output_nid generation:  0.026704788208007812
local_in_edges_tensor generation:  0.04468202590942383
mini_batch_src_global generation:  0.04472780227661133
r_  generation:  0.4738762378692627
local_output_nid generation:  0.0334322452545166
local_in_edges_tensor generation:  0.03455924987792969
mini_batch_src_global generation:  0.055138587951660156
r_  generation:  0.4746723175048828
local_output_nid generation:  0.03328275680541992
local_in_edges_tensor generation:  0.032302141189575195
mini_batch_src_global generation:  0.05172467231750488
r_  generation:  0.48713040351867676
local_output_nid generation:  0.033896446228027344
local_in_edges_tensor generation:  0.03130006790161133
mini_batch_src_global generation:  0.05514049530029297
r_  generation:  0.480013370513916
local_output_nid generation:  0.033994197845458984
local_in_edges_tensor generation:  0.030646562576293945
mini_batch_src_global generation:  0.05315208435058594
r_  generation:  0.49309873580932617
local_output_nid generation:  0.03417158126831055
local_in_edges_tensor generation:  0.0302121639251709
mini_batch_src_global generation:  0.05597710609436035
r_  generation:  0.4823281764984131
local_output_nid generation:  0.03440427780151367
local_in_edges_tensor generation:  0.030510663986206055
mini_batch_src_global generation:  0.05417013168334961
r_  generation:  0.49873876571655273
local_output_nid generation:  0.034245967864990234
local_in_edges_tensor generation:  0.033275604248046875
mini_batch_src_global generation:  0.05607438087463379
r_  generation:  0.4818391799926758
----------------------check_connections_block total spend ----------------------------- 5.709968328475952
generate_one_block  0.6046617031097412
generate_one_block  0.6070106029510498
generate_one_block  0.6092021465301514
generate_one_block  0.6076407432556152
generate_one_block  0.6009485721588135
generate_one_block  0.60205078125
generate_one_block  0.6081187725067139
generate_one_block  0.6030466556549072
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12971210479736328  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

connection checking time:  9.299719333648682
block generation total time  8.010436296463013
average batch blocks generation time:  1.0013045370578766
block dataloader generation time/epoch 19.19813220841544
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10097599029541016  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9017767906188965  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10175800323486328  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9047975540161133  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10124778747558594  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9065747261047363  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10132503509521484  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.905817985534668  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1013493537902832  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9033451080322266  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10094165802001953  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9019436836242676  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10147905349731445  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9074950218200684  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10114908218383789  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9048357009887695  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08153891563415527 |0.011214405298233032 |0.00354921817779541 |9.182095527648926e-05 |0.003765702247619629 |0.0028629302978515625 |
----------------------------------------------------------pseudo_mini_loss sum 1.3893730640411377
Total (block generation + training)time/epoch 20.0690301827022
Training time/epoch 0.8699126243591309
Training time without block to device /epoch 0.7801973819732666
Training time without total dataloading part /epoch 0.06211686134338379
load block tensor time/epoch 0.6523113250732422
block to device time/epoch 0.08971524238586426
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  2957184
Number of first layer input nodes during this epoch:  1283968
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1296992301940918  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.017511606216430664
range selection method range initialization spend 0.01201939582824707
time for parepare:  0.01725912094116211
local_output_nid generation:  0.0027723312377929688
local_in_edges_tensor generation:  0.0038268566131591797
mini_batch_src_global generation:  0.003008127212524414
r_  generation:  0.03899502754211426
local_output_nid generation:  0.0032765865325927734
local_in_edges_tensor generation:  0.0017273426055908203
mini_batch_src_global generation:  0.004312038421630859
r_  generation:  0.03964066505432129
local_output_nid generation:  0.003209829330444336
local_in_edges_tensor generation:  0.0017609596252441406
mini_batch_src_global generation:  0.002945423126220703
r_  generation:  0.04066729545593262
local_output_nid generation:  0.0031931400299072266
local_in_edges_tensor generation:  0.0017354488372802734
mini_batch_src_global generation:  0.002975940704345703
r_  generation:  0.04118776321411133
local_output_nid generation:  0.0032300949096679688
local_in_edges_tensor generation:  0.0017633438110351562
mini_batch_src_global generation:  0.0031218528747558594
r_  generation:  0.04166603088378906
local_output_nid generation:  0.0032165050506591797
local_in_edges_tensor generation:  0.0017485618591308594
mini_batch_src_global generation:  0.0031926631927490234
r_  generation:  0.04215669631958008
local_output_nid generation:  0.003167390823364258
local_in_edges_tensor generation:  0.0016968250274658203
mini_batch_src_global generation:  0.0032596588134765625
r_  generation:  0.042763471603393555
local_output_nid generation:  0.003174304962158203
local_in_edges_tensor generation:  0.0017423629760742188
mini_batch_src_global generation:  0.003246784210205078
r_  generation:  0.04285430908203125
----------------------check_connections_block total spend ----------------------------- 0.4863553047180176
generate_one_block  0.053922176361083984
generate_one_block  0.05465340614318848
generate_one_block  0.0549166202545166
generate_one_block  0.0545649528503418
generate_one_block  0.05479574203491211
generate_one_block  0.054566383361816406
generate_one_block  0.05776858329772949
generate_one_block  0.05531644821166992
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029440879821777344
gen group dst list time:  0.014240741729736328
time for parepare:  0.019731998443603516
local_output_nid generation:  0.010625362396240234
local_in_edges_tensor generation:  0.021999597549438477
mini_batch_src_global generation:  0.03172445297241211
r_  generation:  0.2899022102355957
local_output_nid generation:  0.01642012596130371
local_in_edges_tensor generation:  0.01843404769897461
mini_batch_src_global generation:  0.03752279281616211
r_  generation:  0.29967665672302246
local_output_nid generation:  0.01716017723083496
local_in_edges_tensor generation:  0.016386032104492188
mini_batch_src_global generation:  0.038031578063964844
r_  generation:  0.3103618621826172
local_output_nid generation:  0.016820907592773438
local_in_edges_tensor generation:  0.01676011085510254
mini_batch_src_global generation:  0.03676939010620117
r_  generation:  0.306713342666626
local_output_nid generation:  0.017558574676513672
local_in_edges_tensor generation:  0.016408443450927734
mini_batch_src_global generation:  0.040082693099975586
r_  generation:  0.30972933769226074
local_output_nid generation:  0.017719507217407227
local_in_edges_tensor generation:  0.01656174659729004
mini_batch_src_global generation:  0.038254499435424805
r_  generation:  0.31221699714660645
local_output_nid generation:  0.016677379608154297
local_in_edges_tensor generation:  0.01711869239807129
mini_batch_src_global generation:  0.038579702377319336
r_  generation:  0.31033873558044434
local_output_nid generation:  0.01674485206604004
local_in_edges_tensor generation:  0.016964435577392578
mini_batch_src_global generation:  0.03825712203979492
r_  generation:  0.3138291835784912
----------------------check_connections_block total spend ----------------------------- 3.570007801055908
generate_one_block  0.3933074474334717
generate_one_block  0.3878746032714844
generate_one_block  0.3934319019317627
generate_one_block  0.38684964179992676
generate_one_block  0.39637160301208496
generate_one_block  0.39092373847961426
generate_one_block  0.3882324695587158
generate_one_block  0.41457152366638184
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029570579528808594
gen group dst list time:  0.037586212158203125
time for parepare:  0.019102096557617188
local_output_nid generation:  0.02560257911682129
local_in_edges_tensor generation:  0.03489398956298828
mini_batch_src_global generation:  0.04601097106933594
r_  generation:  0.46976661682128906
local_output_nid generation:  0.03406357765197754
local_in_edges_tensor generation:  0.03421282768249512
mini_batch_src_global generation:  0.054776906967163086
r_  generation:  0.4804394245147705
local_output_nid generation:  0.03483748435974121
local_in_edges_tensor generation:  0.03266477584838867
mini_batch_src_global generation:  0.05164194107055664
r_  generation:  0.49069666862487793
local_output_nid generation:  0.03502941131591797
local_in_edges_tensor generation:  0.031034231185913086
mini_batch_src_global generation:  0.05474138259887695
r_  generation:  0.4811742305755615
local_output_nid generation:  0.03510403633117676
local_in_edges_tensor generation:  0.030658721923828125
mini_batch_src_global generation:  0.05221223831176758
r_  generation:  0.4926297664642334
local_output_nid generation:  0.035134077072143555
local_in_edges_tensor generation:  0.03142833709716797
mini_batch_src_global generation:  0.0565493106842041
r_  generation:  0.4866468906402588
local_output_nid generation:  0.03518843650817871
local_in_edges_tensor generation:  0.03151965141296387
mini_batch_src_global generation:  0.05334162712097168
r_  generation:  0.5027384757995605
local_output_nid generation:  0.03549051284790039
local_in_edges_tensor generation:  0.030756235122680664
mini_batch_src_global generation:  0.05549001693725586
r_  generation:  0.4843730926513672
----------------------check_connections_block total spend ----------------------------- 5.719513654708862
generate_one_block  0.6087188720703125
generate_one_block  0.6073546409606934
generate_one_block  0.6099550724029541
generate_one_block  0.6060664653778076
generate_one_block  0.6132066249847412
generate_one_block  0.6098082065582275
generate_one_block  0.6047616004943848
generate_one_block  0.6101725101470947
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1296992301940918  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

connection checking time:  9.28952145576477
block generation total time  8.021606922149658
average batch blocks generation time:  1.0027008652687073
block dataloader generation time/epoch 19.186515510082245
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10115432739257812  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9046554565429688  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.101043701171875  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9025363922119141  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10144662857055664  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9052572250366211  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10104179382324219  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9018220901489258  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10113382339477539  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9030122756958008  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10123205184936523  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9052834510803223  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1010441780090332  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9023199081420898  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10115337371826172  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9031515121459961  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07469761371612549 |0.012467920780181885 |0.003412395715713501 |9.205937385559082e-05 |0.0032629966735839844 |0.0012023448944091797 |
----------------------------------------------------------pseudo_mini_loss sum 1.3640999794006348
Total (block generation + training)time/epoch 20.051674902439117
Training time/epoch 0.8247721195220947
Training time without block to device /epoch 0.7250287532806396
Training time without total dataloading part /epoch 0.05534195899963379
load block tensor time/epoch 0.5975809097290039
block to device time/epoch 0.09974336624145508
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  2955681
Number of first layer input nodes during this epoch:  1283739
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12974262237548828  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023621797561645508
range selection method range initialization spend 0.012389659881591797
time for parepare:  0.016520023345947266
local_output_nid generation:  0.0027780532836914062
local_in_edges_tensor generation:  0.0037224292755126953
mini_batch_src_global generation:  0.003223419189453125
r_  generation:  0.037783145904541016
local_output_nid generation:  0.0032753944396972656
local_in_edges_tensor generation:  0.0017199516296386719
mini_batch_src_global generation:  0.004182100296020508
r_  generation:  0.03898143768310547
local_output_nid generation:  0.003282308578491211
local_in_edges_tensor generation:  0.0017480850219726562
mini_batch_src_global generation:  0.0029485225677490234
r_  generation:  0.04062151908874512
local_output_nid generation:  0.003320455551147461
local_in_edges_tensor generation:  0.0017285346984863281
mini_batch_src_global generation:  0.002921581268310547
r_  generation:  0.039911508560180664
local_output_nid generation:  0.0031938552856445312
local_in_edges_tensor generation:  0.0017783641815185547
mini_batch_src_global generation:  0.003099203109741211
r_  generation:  0.041638851165771484
local_output_nid generation:  0.0032837390899658203
local_in_edges_tensor generation:  0.0017342567443847656
mini_batch_src_global generation:  0.0031621456146240234
r_  generation:  0.04253411293029785
local_output_nid generation:  0.0032639503479003906
local_in_edges_tensor generation:  0.0017476081848144531
mini_batch_src_global generation:  0.0032663345336914062
r_  generation:  0.042090654373168945
local_output_nid generation:  0.0033159255981445312
local_in_edges_tensor generation:  0.0017039775848388672
mini_batch_src_global generation:  0.003307342529296875
r_  generation:  0.04242396354675293
----------------------check_connections_block total spend ----------------------------- 0.48152637481689453
generate_one_block  0.053922414779663086
generate_one_block  0.05412149429321289
generate_one_block  0.05531930923461914
generate_one_block  0.05430006980895996
generate_one_block  0.05519604682922363
generate_one_block  0.05555009841918945
generate_one_block  0.057909488677978516
generate_one_block  0.05710959434509277
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028987646102905273
gen group dst list time:  0.014492511749267578
time for parepare:  0.019701004028320312
local_output_nid generation:  0.010950326919555664
local_in_edges_tensor generation:  0.021384000778198242
mini_batch_src_global generation:  0.0305478572845459
r_  generation:  0.29070591926574707
local_output_nid generation:  0.016343355178833008
local_in_edges_tensor generation:  0.0175478458404541
mini_batch_src_global generation:  0.03572869300842285
r_  generation:  0.30098938941955566
local_output_nid generation:  0.017127513885498047
local_in_edges_tensor generation:  0.016585826873779297
mini_batch_src_global generation:  0.03554844856262207
r_  generation:  0.30486369132995605
local_output_nid generation:  0.016677379608154297
local_in_edges_tensor generation:  0.016997575759887695
mini_batch_src_global generation:  0.03598952293395996
r_  generation:  0.30411243438720703
local_output_nid generation:  0.017826557159423828
local_in_edges_tensor generation:  0.01840996742248535
mini_batch_src_global generation:  0.03805232048034668
r_  generation:  0.3116626739501953
local_output_nid generation:  0.017287492752075195
local_in_edges_tensor generation:  0.024512290954589844
mini_batch_src_global generation:  0.03858208656311035
r_  generation:  0.3126842975616455
local_output_nid generation:  0.016981124877929688
local_in_edges_tensor generation:  0.01727294921875
mini_batch_src_global generation:  0.03783774375915527
r_  generation:  0.30898523330688477
local_output_nid generation:  0.016907453536987305
local_in_edges_tensor generation:  0.0169522762298584
mini_batch_src_global generation:  0.037656545639038086
r_  generation:  0.3120839595794678
----------------------check_connections_block total spend ----------------------------- 3.5648977756500244
generate_one_block  0.388317346572876
generate_one_block  0.39092230796813965
generate_one_block  0.3955357074737549
generate_one_block  0.3856792449951172
generate_one_block  0.3884432315826416
generate_one_block  0.3912086486816406
generate_one_block  0.3897881507873535
generate_one_block  0.41109442710876465
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03313469886779785
gen group dst list time:  0.037653446197509766
time for parepare:  0.022434711456298828
local_output_nid generation:  0.026099681854248047
local_in_edges_tensor generation:  0.037831783294677734
mini_batch_src_global generation:  0.04622006416320801
r_  generation:  0.467820405960083
local_output_nid generation:  0.03211355209350586
local_in_edges_tensor generation:  0.039389610290527344
mini_batch_src_global generation:  0.055948734283447266
r_  generation:  0.4751560688018799
local_output_nid generation:  0.03246426582336426
local_in_edges_tensor generation:  0.035312652587890625
mini_batch_src_global generation:  0.05132722854614258
r_  generation:  0.4899013042449951
local_output_nid generation:  0.03319907188415527
local_in_edges_tensor generation:  0.031668663024902344
mini_batch_src_global generation:  0.05478239059448242
r_  generation:  0.47938013076782227
local_output_nid generation:  0.033197641372680664
local_in_edges_tensor generation:  0.030458450317382812
mini_batch_src_global generation:  0.05260896682739258
r_  generation:  0.4942781925201416
local_output_nid generation:  0.03320884704589844
local_in_edges_tensor generation:  0.0355837345123291
mini_batch_src_global generation:  0.056789398193359375
r_  generation:  0.4839756488800049
local_output_nid generation:  0.033786773681640625
local_in_edges_tensor generation:  0.0316472053527832
mini_batch_src_global generation:  0.05340003967285156
r_  generation:  0.5164556503295898
local_output_nid generation:  0.037101030349731445
local_in_edges_tensor generation:  0.031553030014038086
mini_batch_src_global generation:  0.05698418617248535
r_  generation:  0.4849395751953125
----------------------check_connections_block total spend ----------------------------- 5.735692262649536
generate_one_block  0.6015636920928955
generate_one_block  0.6092531681060791
generate_one_block  0.6176633834838867
generate_one_block  0.6023762226104736
generate_one_block  0.6065795421600342
generate_one_block  0.6155006885528564
generate_one_block  0.6060757637023926
generate_one_block  0.6091158390045166
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12974262237548828  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

connection checking time:  9.30059003829956
block generation total time  8.009117364883423
average batch blocks generation time:  1.0011396706104279
block dataloader generation time/epoch 19.17768594953749
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1011347770690918  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9031887054443359  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10117387771606445  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.904670238494873  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1012563705444336  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9061522483825684  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1013188362121582  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.901982307434082  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10170555114746094  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9029970169067383  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10133171081542969  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9049839973449707  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1013340950012207  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9018387794494629  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10116147994995117  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9039936065673828  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08107432723045349 |0.012570440769195557 |0.003492802381515503 |8.988380432128906e-05 |0.003768622875213623 |0.0013034343719482422 |
----------------------------------------------------------pseudo_mini_loss sum 1.3525986671447754
Total (block generation + training)time/epoch 20.044631719589233
Training time/epoch 0.8809795379638672
Training time without block to device /epoch 0.7804160118103027
Training time without total dataloading part /epoch 0.06011390686035156
load block tensor time/epoch 0.6485946178436279
block to device time/epoch 0.10056352615356445
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  2956693
Number of first layer input nodes during this epoch:  1284838
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12966537475585938  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.014734745025634766
range selection method range initialization spend 0.012021780014038086
time for parepare:  0.01648569107055664
local_output_nid generation:  0.00279998779296875
local_in_edges_tensor generation:  0.0048313140869140625
mini_batch_src_global generation:  0.0032198429107666016
r_  generation:  0.03891611099243164
local_output_nid generation:  0.0031898021697998047
local_in_edges_tensor generation:  0.001711130142211914
mini_batch_src_global generation:  0.004346370697021484
r_  generation:  0.039919376373291016
local_output_nid generation:  0.0032825469970703125
local_in_edges_tensor generation:  0.001749277114868164
mini_batch_src_global generation:  0.002958059310913086
r_  generation:  0.040242910385131836
local_output_nid generation:  0.0033063888549804688
local_in_edges_tensor generation:  0.0017576217651367188
mini_batch_src_global generation:  0.002954244613647461
r_  generation:  0.04134368896484375
local_output_nid generation:  0.0033223628997802734
local_in_edges_tensor generation:  0.0017113685607910156
mini_batch_src_global generation:  0.003193378448486328
r_  generation:  0.04259061813354492
local_output_nid generation:  0.0032999515533447266
local_in_edges_tensor generation:  0.0016930103302001953
mini_batch_src_global generation:  0.0032629966735839844
r_  generation:  0.04303741455078125
local_output_nid generation:  0.003312826156616211
local_in_edges_tensor generation:  0.0017256736755371094
mini_batch_src_global generation:  0.003377199172973633
r_  generation:  0.04236412048339844
local_output_nid generation:  0.003232717514038086
local_in_edges_tensor generation:  0.0018029212951660156
mini_batch_src_global generation:  0.003193378448486328
r_  generation:  0.0423426628112793
----------------------check_connections_block total spend ----------------------------- 0.48815369606018066
generate_one_block  0.05397796630859375
generate_one_block  0.05460309982299805
generate_one_block  0.054106950759887695
generate_one_block  0.054906606674194336
generate_one_block  0.05524492263793945
generate_one_block  0.05600380897521973
generate_one_block  0.05767083168029785
generate_one_block  0.05482220649719238
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03271126747131348
gen group dst list time:  0.014163494110107422
time for parepare:  0.019770383834838867
local_output_nid generation:  0.010875463485717773
local_in_edges_tensor generation:  0.03461647033691406
mini_batch_src_global generation:  0.030919551849365234
r_  generation:  0.2941923141479492
local_output_nid generation:  0.016503334045410156
local_in_edges_tensor generation:  0.017639636993408203
mini_batch_src_global generation:  0.035936594009399414
r_  generation:  0.30310916900634766
local_output_nid generation:  0.016881942749023438
local_in_edges_tensor generation:  0.01661515235900879
mini_batch_src_global generation:  0.035848140716552734
r_  generation:  0.3064255714416504
local_output_nid generation:  0.016989707946777344
local_in_edges_tensor generation:  0.018443584442138672
mini_batch_src_global generation:  0.03656172752380371
r_  generation:  0.31096386909484863
local_output_nid generation:  0.01798272132873535
local_in_edges_tensor generation:  0.017589569091796875
mini_batch_src_global generation:  0.03836321830749512
r_  generation:  0.31563639640808105
local_output_nid generation:  0.017592430114746094
local_in_edges_tensor generation:  0.018605947494506836
mini_batch_src_global generation:  0.039182424545288086
r_  generation:  0.31505322456359863
local_output_nid generation:  0.01724529266357422
local_in_edges_tensor generation:  0.01735091209411621
mini_batch_src_global generation:  0.041289567947387695
r_  generation:  0.31415438652038574
local_output_nid generation:  0.01686716079711914
local_in_edges_tensor generation:  0.018340587615966797
mini_batch_src_global generation:  0.03930521011352539
r_  generation:  0.31247615814208984
----------------------check_connections_block total spend ----------------------------- 3.606496572494507
generate_one_block  0.3981587886810303
generate_one_block  0.38798022270202637
generate_one_block  0.38503146171569824
generate_one_block  0.393216609954834
generate_one_block  0.39008164405822754
generate_one_block  0.39972734451293945
generate_one_block  0.3878512382507324
generate_one_block  0.417799711227417
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03287363052368164
gen group dst list time:  0.03785991668701172
time for parepare:  0.018780231475830078
local_output_nid generation:  0.025590181350708008
local_in_edges_tensor generation:  0.0435032844543457
mini_batch_src_global generation:  0.04444694519042969
r_  generation:  0.4734079837799072
local_output_nid generation:  0.03234267234802246
local_in_edges_tensor generation:  0.03577542304992676
mini_batch_src_global generation:  0.054503679275512695
r_  generation:  0.4778258800506592
local_output_nid generation:  0.03320479393005371
local_in_edges_tensor generation:  0.03265261650085449
mini_batch_src_global generation:  0.052129268646240234
r_  generation:  0.4924330711364746
local_output_nid generation:  0.03323173522949219
local_in_edges_tensor generation:  0.03407168388366699
mini_batch_src_global generation:  0.05500149726867676
r_  generation:  0.48206591606140137
local_output_nid generation:  0.03307843208312988
local_in_edges_tensor generation:  0.033362627029418945
mini_batch_src_global generation:  0.053311824798583984
r_  generation:  0.4985480308532715
local_output_nid generation:  0.03360772132873535
local_in_edges_tensor generation:  0.0333552360534668
mini_batch_src_global generation:  0.05722212791442871
r_  generation:  0.49137353897094727
local_output_nid generation:  0.03361630439758301
local_in_edges_tensor generation:  0.031868696212768555
mini_batch_src_global generation:  0.05411386489868164
r_  generation:  0.5005218982696533
local_output_nid generation:  0.033541202545166016
local_in_edges_tensor generation:  0.03173089027404785
mini_batch_src_global generation:  0.05633068084716797
r_  generation:  0.48804521560668945
----------------------check_connections_block total spend ----------------------------- 5.744805812835693
generate_one_block  0.6058666706085205
generate_one_block  0.6047301292419434
generate_one_block  0.6080200672149658
generate_one_block  0.6026840209960938
generate_one_block  0.6032073497772217
generate_one_block  0.6062257289886475
generate_one_block  0.6028180122375488
generate_one_block  0.6004719734191895
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12966537475585938  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

connection checking time:  9.3513023853302
block generation total time  7.993870973587036
average batch blocks generation time:  0.9992338716983795
block dataloader generation time/epoch 19.174794411659242
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1012415885925293  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9052281379699707  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10177946090698242  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9033336639404297  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10095882415771484  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9017291069030762  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10132932662963867  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9058737754821777  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10115814208984375  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9032049179077148  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10120725631713867  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9063167572021484  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1010904312133789  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9017505645751953  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10110759735107422  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9034271240234375  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07630300521850586 |0.011198610067367554 |0.0034302473068237305 |9.232759475708008e-05 |0.0033748745918273926 |0.0016970634460449219 |
----------------------------------------------------------pseudo_mini_loss sum 1.3408589363098145
Total (block generation + training)time/epoch 20.037627840042113
Training time/epoch 0.8256313800811768
Training time without block to device /epoch 0.7360424995422363
Training time without total dataloading part /epoch 0.05687665939331055
load block tensor time/epoch 0.6104240417480469
block to device time/epoch 0.08958888053894043
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  2955472
Number of first layer input nodes during this epoch:  1283252
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1295022964477539  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.015253067016601562
range selection method range initialization spend 0.01202082633972168
time for parepare:  0.016440629959106445
local_output_nid generation:  0.0028274059295654297
local_in_edges_tensor generation:  0.0038695335388183594
mini_batch_src_global generation:  0.002981901168823242
r_  generation:  0.03845071792602539
local_output_nid generation:  0.0032296180725097656
local_in_edges_tensor generation:  0.0017011165618896484
mini_batch_src_global generation:  0.004271030426025391
r_  generation:  0.03827404975891113
local_output_nid generation:  0.003244161605834961
local_in_edges_tensor generation:  0.0017209053039550781
mini_batch_src_global generation:  0.003021240234375
r_  generation:  0.04032492637634277
local_output_nid generation:  0.0032885074615478516
local_in_edges_tensor generation:  0.001726388931274414
mini_batch_src_global generation:  0.003000497817993164
r_  generation:  0.04125618934631348
local_output_nid generation:  0.0033113956451416016
local_in_edges_tensor generation:  0.0017228126525878906
mini_batch_src_global generation:  0.003187417984008789
r_  generation:  0.04161190986633301
local_output_nid generation:  0.0032663345336914062
local_in_edges_tensor generation:  0.0017197132110595703
mini_batch_src_global generation:  0.003245830535888672
r_  generation:  0.0420680046081543
local_output_nid generation:  0.003340005874633789
local_in_edges_tensor generation:  0.0017180442810058594
mini_batch_src_global generation:  0.003305673599243164
r_  generation:  0.04236888885498047
local_output_nid generation:  0.0033156871795654297
local_in_edges_tensor generation:  0.0017216205596923828
mini_batch_src_global generation:  0.0033121109008789062
r_  generation:  0.042684316635131836
----------------------check_connections_block total spend ----------------------------- 0.48319363594055176
generate_one_block  0.05342268943786621
generate_one_block  0.05276846885681152
generate_one_block  0.05502581596374512
generate_one_block  0.05465054512023926
generate_one_block  0.054448843002319336
generate_one_block  0.054941415786743164
generate_one_block  0.058655500411987305
generate_one_block  0.055460214614868164
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028482675552368164
gen group dst list time:  0.013985157012939453
time for parepare:  0.019681215286254883
local_output_nid generation:  0.010761499404907227
local_in_edges_tensor generation:  0.01921534538269043
mini_batch_src_global generation:  0.02921748161315918
r_  generation:  0.2873728275299072
local_output_nid generation:  0.018531322479248047
local_in_edges_tensor generation:  0.015752077102661133
mini_batch_src_global generation:  0.03536081314086914
r_  generation:  0.29199934005737305
local_output_nid generation:  0.01894068717956543
local_in_edges_tensor generation:  0.01818108558654785
mini_batch_src_global generation:  0.03599214553833008
r_  generation:  0.30594491958618164
local_output_nid generation:  0.018425941467285156
local_in_edges_tensor generation:  0.016932010650634766
mini_batch_src_global generation:  0.036538124084472656
r_  generation:  0.30547046661376953
local_output_nid generation:  0.019420862197875977
local_in_edges_tensor generation:  0.017150163650512695
mini_batch_src_global generation:  0.037644386291503906
r_  generation:  0.3041870594024658
local_output_nid generation:  0.020015239715576172
local_in_edges_tensor generation:  0.01708054542541504
mini_batch_src_global generation:  0.038259267807006836
r_  generation:  0.31140685081481934
local_output_nid generation:  0.018560409545898438
local_in_edges_tensor generation:  0.016765832901000977
mini_batch_src_global generation:  0.04106426239013672
r_  generation:  0.3099520206451416
local_output_nid generation:  0.019290447235107422
local_in_edges_tensor generation:  0.023595809936523438
mini_batch_src_global generation:  0.03810453414916992
r_  generation:  0.310988187789917
----------------------check_connections_block total spend ----------------------------- 3.562007427215576
generate_one_block  0.3917245864868164
generate_one_block  0.3820381164550781
generate_one_block  0.39440369606018066
generate_one_block  0.39391422271728516
generate_one_block  0.38518691062927246
generate_one_block  0.39235901832580566
generate_one_block  0.3915395736694336
generate_one_block  0.4110748767852783
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.031084060668945312
gen group dst list time:  0.03806900978088379
time for parepare:  0.01969122886657715
local_output_nid generation:  0.026452302932739258
local_in_edges_tensor generation:  0.03595113754272461
mini_batch_src_global generation:  0.04370999336242676
r_  generation:  0.4757039546966553
local_output_nid generation:  0.034576416015625
local_in_edges_tensor generation:  0.03023076057434082
mini_batch_src_global generation:  0.05498766899108887
r_  generation:  0.4837517738342285
local_output_nid generation:  0.035508155822753906
local_in_edges_tensor generation:  0.03106093406677246
mini_batch_src_global generation:  0.0520017147064209
r_  generation:  0.4915342330932617
local_output_nid generation:  0.035768985748291016
local_in_edges_tensor generation:  0.031905174255371094
mini_batch_src_global generation:  0.05507016181945801
r_  generation:  0.4836399555206299
local_output_nid generation:  0.03564715385437012
local_in_edges_tensor generation:  0.030674219131469727
mini_batch_src_global generation:  0.05314970016479492
r_  generation:  0.4960451126098633
local_output_nid generation:  0.035860300064086914
local_in_edges_tensor generation:  0.03070354461669922
mini_batch_src_global generation:  0.055787086486816406
r_  generation:  0.4856686592102051
local_output_nid generation:  0.03656888008117676
local_in_edges_tensor generation:  0.031184673309326172
mini_batch_src_global generation:  0.05461883544921875
r_  generation:  0.4947035312652588
local_output_nid generation:  0.03654336929321289
local_in_edges_tensor generation:  0.03109431266784668
mini_batch_src_global generation:  0.056104183197021484
r_  generation:  0.4891204833984375
----------------------check_connections_block total spend ----------------------------- 5.731444835662842
generate_one_block  0.6046340465545654
generate_one_block  0.6043000221252441
generate_one_block  0.6132378578186035
generate_one_block  0.6105258464813232
generate_one_block  0.6091415882110596
generate_one_block  0.6140420436859131
generate_one_block  0.6057672500610352
generate_one_block  0.6150970458984375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1295022964477539  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

connection checking time:  9.293452262878418
block generation total time  8.018986701965332
average batch blocks generation time:  1.0023733377456665
block dataloader generation time/epoch 19.166750756177034
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10110044479370117  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9018821716308594  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10109281539916992  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.8977346420288086  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10120964050292969  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9070243835449219  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10107851028442383  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9034380912780762  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10099506378173828  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9006280899047852  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10137557983398438  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9073653221130371  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.101043701171875  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9027481079101562  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10117673873901367  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9057574272155762  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08063101768493652 |0.01455119252204895 |0.0034397542476654053 |8.943676948547363e-05 |0.003714144229888916 |0.0027484893798828125 |
----------------------------------------------------------pseudo_mini_loss sum 1.3277509212493896
Total (block generation + training)time/epoch 20.03180811621926
Training time/epoch 0.8870868682861328
Training time without block to device /epoch 0.7706773281097412
Training time without total dataloading part /epoch 0.06069517135620117
load block tensor time/epoch 0.6450481414794922
block to device time/epoch 0.1164095401763916
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 20 |
Number of nodes for computation during this epoch:  2955007
Number of first layer input nodes during this epoch:  1283637
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1296396255493164  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.017892122268676758
range selection method range initialization spend 0.012183904647827148
time for parepare:  0.016680240631103516
local_output_nid generation:  0.0028142929077148438
local_in_edges_tensor generation:  0.0039730072021484375
mini_batch_src_global generation:  0.002885580062866211
r_  generation:  0.03889799118041992
local_output_nid generation:  0.003216266632080078
local_in_edges_tensor generation:  0.0017390251159667969
mini_batch_src_global generation:  0.0044057369232177734
r_  generation:  0.04009127616882324
local_output_nid generation:  0.0032634735107421875
local_in_edges_tensor generation:  0.0017528533935546875
mini_batch_src_global generation:  0.003062725067138672
r_  generation:  0.040480852127075195
local_output_nid generation:  0.0033299922943115234
local_in_edges_tensor generation:  0.0017528533935546875
mini_batch_src_global generation:  0.0029854774475097656
r_  generation:  0.04151749610900879
local_output_nid generation:  0.003304004669189453
local_in_edges_tensor generation:  0.0018880367279052734
mini_batch_src_global generation:  0.003199338912963867
r_  generation:  0.042371511459350586
local_output_nid generation:  0.0033216476440429688
local_in_edges_tensor generation:  0.0017609596252441406
mini_batch_src_global generation:  0.0033185482025146484
r_  generation:  0.04197406768798828
local_output_nid generation:  0.0033006668090820312
local_in_edges_tensor generation:  0.0017724037170410156
mini_batch_src_global generation:  0.0033347606658935547
r_  generation:  0.04220128059387207
local_output_nid generation:  0.0032889842987060547
local_in_edges_tensor generation:  0.0017549991607666016
mini_batch_src_global generation:  0.0033385753631591797
r_  generation:  0.04217100143432617
----------------------check_connections_block total spend ----------------------------- 0.4869499206542969
generate_one_block  0.052883148193359375
generate_one_block  0.05787062644958496
generate_one_block  0.05417227745056152
generate_one_block  0.05516695976257324
generate_one_block  0.05565786361694336
generate_one_block  0.054476022720336914
generate_one_block  0.057892799377441406
generate_one_block  0.05459094047546387
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.036360979080200195
gen group dst list time:  0.013972043991088867
time for parepare:  0.020057201385498047
local_output_nid generation:  0.01085042953491211
local_in_edges_tensor generation:  0.02110123634338379
mini_batch_src_global generation:  0.030843734741210938
r_  generation:  0.289661169052124
local_output_nid generation:  0.018028736114501953
local_in_edges_tensor generation:  0.020043611526489258
mini_batch_src_global generation:  0.03558969497680664
r_  generation:  0.2975594997406006
local_output_nid generation:  0.018923044204711914
local_in_edges_tensor generation:  0.017992734909057617
mini_batch_src_global generation:  0.03625154495239258
r_  generation:  0.306286096572876
local_output_nid generation:  0.018785953521728516
local_in_edges_tensor generation:  0.016866683959960938
mini_batch_src_global generation:  0.036271095275878906
r_  generation:  0.31070923805236816
local_output_nid generation:  0.02001643180847168
local_in_edges_tensor generation:  0.020714521408081055
mini_batch_src_global generation:  0.03827166557312012
r_  generation:  0.3366107940673828
local_output_nid generation:  0.022541046142578125
local_in_edges_tensor generation:  0.017250537872314453
mini_batch_src_global generation:  0.03803539276123047
r_  generation:  0.31322693824768066
local_output_nid generation:  0.01956653594970703
local_in_edges_tensor generation:  0.017536163330078125
mini_batch_src_global generation:  0.03866147994995117
r_  generation:  0.32087206840515137
local_output_nid generation:  0.01969742774963379
local_in_edges_tensor generation:  0.017887592315673828
mini_batch_src_global generation:  0.037754058837890625
r_  generation:  0.30928468704223633
----------------------check_connections_block total spend ----------------------------- 3.624811887741089
generate_one_block  0.3901636600494385
generate_one_block  0.3912999629974365
generate_one_block  0.3900148868560791
generate_one_block  0.3931307792663574
generate_one_block  0.3954019546508789
generate_one_block  0.3870418071746826
generate_one_block  0.39565229415893555
generate_one_block  0.4126591682434082
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03143000602722168
gen group dst list time:  0.03808927536010742
time for parepare:  0.01966238021850586
local_output_nid generation:  0.026256799697875977
local_in_edges_tensor generation:  0.04107952117919922
mini_batch_src_global generation:  0.044405460357666016
r_  generation:  0.4716355800628662
local_output_nid generation:  0.03448748588562012
local_in_edges_tensor generation:  0.03884291648864746
mini_batch_src_global generation:  0.05543971061706543
r_  generation:  0.4788978099822998
local_output_nid generation:  0.03550386428833008
local_in_edges_tensor generation:  0.03095531463623047
mini_batch_src_global generation:  0.054830312728881836
r_  generation:  0.48960208892822266
local_output_nid generation:  0.03530716896057129
local_in_edges_tensor generation:  0.031052589416503906
mini_batch_src_global generation:  0.05474567413330078
r_  generation:  0.47980833053588867
local_output_nid generation:  0.036080121994018555
local_in_edges_tensor generation:  0.03159022331237793
mini_batch_src_global generation:  0.05306077003479004
r_  generation:  0.4936811923980713
local_output_nid generation:  0.0363311767578125
local_in_edges_tensor generation:  0.0337367057800293
mini_batch_src_global generation:  0.055388689041137695
r_  generation:  0.48373913764953613
local_output_nid generation:  0.036402225494384766
local_in_edges_tensor generation:  0.03353118896484375
mini_batch_src_global generation:  0.05618786811828613
r_  generation:  0.5074963569641113
local_output_nid generation:  0.03626132011413574
local_in_edges_tensor generation:  0.031599998474121094
mini_batch_src_global generation:  0.05612325668334961
r_  generation:  0.48354196548461914
----------------------check_connections_block total spend ----------------------------- 5.747671842575073
generate_one_block  0.6086854934692383
generate_one_block  0.609060525894165
generate_one_block  0.6100692749023438
generate_one_block  0.6076679229736328
generate_one_block  0.6054065227508545
generate_one_block  0.6063191890716553
generate_one_block  0.6131525039672852
generate_one_block  0.6054267883300781
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1296396255493164  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

connection checking time:  9.372483730316162
block generation total time  8.02115273475647
average batch blocks generation time:  1.0026440918445587
block dataloader generation time/epoch 19.169137219587963
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10117149353027344  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9035553932189941  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10107278823852539  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9025983810424805  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1012721061706543  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9033198356628418  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.101104736328125  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9038610458374023  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10123586654663086  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9050140380859375  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10190820693969727  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9012279510498047  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10190343856811523  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9065055847167969  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10119295120239258  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9059600830078125  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08123168349266052 |0.011207997798919678 |0.003489285707473755 |9.229779243469238e-05 |0.003817915916442871 |0.0018658638000488281 |
----------------------------------------------------------pseudo_mini_loss sum 1.305988073348999
Total (block generation + training)time/epoch 20.034912526607513
Training time/epoch 0.873450756072998
Training time without block to device /epoch 0.7837867736816406
Training time without total dataloading part /epoch 0.061061859130859375
load block tensor time/epoch 0.6498534679412842
block to device time/epoch 0.08966398239135742
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 21 |
Number of nodes for computation during this epoch:  2956408
Number of first layer input nodes during this epoch:  1284129
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12958288192749023  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0173642635345459
range selection method range initialization spend 0.012166738510131836
time for parepare:  0.016818523406982422
local_output_nid generation:  0.002760171890258789
local_in_edges_tensor generation:  0.004262685775756836
mini_batch_src_global generation:  0.004655361175537109
r_  generation:  0.03922700881958008
local_output_nid generation:  0.003259897232055664
local_in_edges_tensor generation:  0.001748800277709961
mini_batch_src_global generation:  0.004241466522216797
r_  generation:  0.03907012939453125
local_output_nid generation:  0.003265857696533203
local_in_edges_tensor generation:  0.0017206668853759766
mini_batch_src_global generation:  0.0030357837677001953
r_  generation:  0.04018092155456543
local_output_nid generation:  0.0033578872680664062
local_in_edges_tensor generation:  0.001703500747680664
mini_batch_src_global generation:  0.003016233444213867
r_  generation:  0.040500640869140625
local_output_nid generation:  0.0032820701599121094
local_in_edges_tensor generation:  0.0017218589782714844
mini_batch_src_global generation:  0.003174304962158203
r_  generation:  0.04095339775085449
local_output_nid generation:  0.0032863616943359375
local_in_edges_tensor generation:  0.0017304420471191406
mini_batch_src_global generation:  0.003172636032104492
r_  generation:  0.04187273979187012
local_output_nid generation:  0.0033812522888183594
local_in_edges_tensor generation:  0.0017123222351074219
mini_batch_src_global generation:  0.0033104419708251953
r_  generation:  0.042054176330566406
local_output_nid generation:  0.0032722949981689453
local_in_edges_tensor generation:  0.0017621517181396484
mini_batch_src_global generation:  0.0032486915588378906
r_  generation:  0.04152512550354004
----------------------check_connections_block total spend ----------------------------- 0.48349428176879883
generate_one_block  0.053412437438964844
generate_one_block  0.0541691780090332
generate_one_block  0.05505537986755371
generate_one_block  0.05441594123840332
generate_one_block  0.05405449867248535
generate_one_block  0.05486249923706055
generate_one_block  0.058099985122680664
generate_one_block  0.05461597442626953
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029385089874267578
gen group dst list time:  0.014402389526367188
time for parepare:  0.019496440887451172
local_output_nid generation:  0.010831356048583984
local_in_edges_tensor generation:  0.021626949310302734
mini_batch_src_global generation:  0.030694961547851562
r_  generation:  0.2877054214477539
local_output_nid generation:  0.01790595054626465
local_in_edges_tensor generation:  0.017365694046020508
mini_batch_src_global generation:  0.0361781120300293
r_  generation:  0.3001582622528076
local_output_nid generation:  0.01899099349975586
local_in_edges_tensor generation:  0.016950368881225586
mini_batch_src_global generation:  0.03676033020019531
r_  generation:  0.3072774410247803
local_output_nid generation:  0.019382238388061523
local_in_edges_tensor generation:  0.016678333282470703
mini_batch_src_global generation:  0.0363011360168457
r_  generation:  0.30223894119262695
local_output_nid generation:  0.019199371337890625
local_in_edges_tensor generation:  0.016518592834472656
mini_batch_src_global generation:  0.0377047061920166
r_  generation:  0.30411219596862793
local_output_nid generation:  0.02008509635925293
local_in_edges_tensor generation:  0.018196582794189453
mini_batch_src_global generation:  0.03807997703552246
r_  generation:  0.3106985092163086
local_output_nid generation:  0.018755197525024414
local_in_edges_tensor generation:  0.01727771759033203
mini_batch_src_global generation:  0.03837776184082031
r_  generation:  0.30977463722229004
local_output_nid generation:  0.018739938735961914
local_in_edges_tensor generation:  0.01726222038269043
mini_batch_src_global generation:  0.039797306060791016
r_  generation:  0.3089413642883301
----------------------check_connections_block total spend ----------------------------- 3.5568439960479736
generate_one_block  0.3916192054748535
generate_one_block  0.3904881477355957
generate_one_block  0.3910672664642334
generate_one_block  0.38455939292907715
generate_one_block  0.3817412853240967
generate_one_block  0.39270448684692383
generate_one_block  0.38970375061035156
generate_one_block  0.4087791442871094
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028483867645263672
gen group dst list time:  0.037430524826049805
time for parepare:  0.01898646354675293
local_output_nid generation:  0.02514481544494629
local_in_edges_tensor generation:  0.036846160888671875
mini_batch_src_global generation:  0.04377865791320801
r_  generation:  0.4670233726501465
local_output_nid generation:  0.03178095817565918
local_in_edges_tensor generation:  0.03134965896606445
mini_batch_src_global generation:  0.05455970764160156
r_  generation:  0.4728832244873047
local_output_nid generation:  0.03244328498840332
local_in_edges_tensor generation:  0.031595706939697266
mini_batch_src_global generation:  0.05282306671142578
r_  generation:  0.4858818054199219
local_output_nid generation:  0.03241467475891113
local_in_edges_tensor generation:  0.03219199180603027
mini_batch_src_global generation:  0.055077314376831055
r_  generation:  0.47747087478637695
local_output_nid generation:  0.03305864334106445
local_in_edges_tensor generation:  0.032628774642944336
mini_batch_src_global generation:  0.05500197410583496
r_  generation:  0.49317502975463867
local_output_nid generation:  0.0334012508392334
local_in_edges_tensor generation:  0.03225445747375488
mini_batch_src_global generation:  0.06023287773132324
r_  generation:  0.4853847026824951
local_output_nid generation:  0.03439164161682129
local_in_edges_tensor generation:  0.03204798698425293
mini_batch_src_global generation:  0.05310416221618652
r_  generation:  0.4965846538543701
local_output_nid generation:  0.03409147262573242
local_in_edges_tensor generation:  0.0322265625
mini_batch_src_global generation:  0.05642867088317871
r_  generation:  0.48340463638305664
----------------------check_connections_block total spend ----------------------------- 5.690181732177734
generate_one_block  0.6005387306213379
generate_one_block  0.5996701717376709
generate_one_block  0.6043972969055176
generate_one_block  0.5993671417236328
generate_one_block  0.5983445644378662
generate_one_block  0.6125717163085938
generate_one_block  0.6070258617401123
generate_one_block  0.612886905670166
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12958288192749023  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

connection checking time:  9.247025728225708
block generation total time  7.965465068817139
average batch blocks generation time:  0.9956831336021423
block dataloader generation time/epoch 19.155809292426476
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10124492645263672  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9071922302246094  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10132980346679688  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9055881500244141  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10130739212036133  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9081730842590332  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10101127624511719  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9015932083129883  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10135030746459961  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9004778861999512  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1012277603149414  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9063925743103027  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10111570358276367  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9030356407165527  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10114812850952148  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9041786193847656  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07731384038925171 |0.014852076768875122 |0.00336650013923645 |9.194016456604004e-05 |0.00356215238571167 |0.0011868476867675781 |
----------------------------------------------------------pseudo_mini_loss sum 1.2905888557434082
Total (block generation + training)time/epoch 20.021399534665623
Training time/epoch 0.8631625175476074
Training time without block to device /epoch 0.7443459033966064
Training time without total dataloading part /epoch 0.05735158920288086
load block tensor time/epoch 0.6185107231140137
block to device time/epoch 0.11881661415100098
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 22 |
Number of nodes for computation during this epoch:  2957176
Number of first layer input nodes during this epoch:  1283862
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12993860244750977  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.032416582107543945
range selection method range initialization spend 0.012463569641113281
time for parepare:  0.016175270080566406
local_output_nid generation:  0.0027704238891601562
local_in_edges_tensor generation:  0.004179239273071289
mini_batch_src_global generation:  0.0029952526092529297
r_  generation:  0.03967928886413574
local_output_nid generation:  0.003172159194946289
local_in_edges_tensor generation:  0.001684427261352539
mini_batch_src_global generation:  0.00429844856262207
r_  generation:  0.04017233848571777
local_output_nid generation:  0.003301382064819336
local_in_edges_tensor generation:  0.001699686050415039
mini_batch_src_global generation:  0.0030705928802490234
r_  generation:  0.04066061973571777
local_output_nid generation:  0.003252267837524414
local_in_edges_tensor generation:  0.0017383098602294922
mini_batch_src_global generation:  0.0029304027557373047
r_  generation:  0.04035639762878418
local_output_nid generation:  0.003213167190551758
local_in_edges_tensor generation:  0.0017244815826416016
mini_batch_src_global generation:  0.003194093704223633
r_  generation:  0.0411229133605957
local_output_nid generation:  0.0032308101654052734
local_in_edges_tensor generation:  0.0016796588897705078
mini_batch_src_global generation:  0.0031888484954833984
r_  generation:  0.04165387153625488
local_output_nid generation:  0.003248453140258789
local_in_edges_tensor generation:  0.0017402172088623047
mini_batch_src_global generation:  0.003326892852783203
r_  generation:  0.041588544845581055
local_output_nid generation:  0.0032503604888916016
local_in_edges_tensor generation:  0.0017101764678955078
mini_batch_src_global generation:  0.0032501220703125
r_  generation:  0.04140162467956543
----------------------check_connections_block total spend ----------------------------- 0.48172545433044434
generate_one_block  0.052939414978027344
generate_one_block  0.05498051643371582
generate_one_block  0.0541234016418457
generate_one_block  0.05374956130981445
generate_one_block  0.05406498908996582
generate_one_block  0.054637908935546875
generate_one_block  0.0563654899597168
generate_one_block  0.05422782897949219
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.031440019607543945
gen group dst list time:  0.014063358306884766
time for parepare:  0.019798994064331055
local_output_nid generation:  0.010598182678222656
local_in_edges_tensor generation:  0.023229598999023438
mini_batch_src_global generation:  0.030337095260620117
r_  generation:  0.28884387016296387
local_output_nid generation:  0.016325712203979492
local_in_edges_tensor generation:  0.018859148025512695
mini_batch_src_global generation:  0.036026954650878906
r_  generation:  0.3041095733642578
local_output_nid generation:  0.01696038246154785
local_in_edges_tensor generation:  0.017902135848999023
mini_batch_src_global generation:  0.0359342098236084
r_  generation:  0.3015584945678711
local_output_nid generation:  0.01672983169555664
local_in_edges_tensor generation:  0.0182802677154541
mini_batch_src_global generation:  0.036583900451660156
r_  generation:  0.3058938980102539
local_output_nid generation:  0.017632246017456055
local_in_edges_tensor generation:  0.016874313354492188
mini_batch_src_global generation:  0.03780484199523926
r_  generation:  0.3088357448577881
local_output_nid generation:  0.017786026000976562
local_in_edges_tensor generation:  0.017498254776000977
mini_batch_src_global generation:  0.03770947456359863
r_  generation:  0.30732131004333496
local_output_nid generation:  0.01674342155456543
local_in_edges_tensor generation:  0.016416549682617188
mini_batch_src_global generation:  0.037683963775634766
r_  generation:  0.3062856197357178
local_output_nid generation:  0.016658544540405273
local_in_edges_tensor generation:  0.02002859115600586
mini_batch_src_global generation:  0.03943014144897461
r_  generation:  0.3049933910369873
----------------------check_connections_block total spend ----------------------------- 3.5443081855773926
generate_one_block  0.3898742198944092
generate_one_block  0.39828062057495117
generate_one_block  0.3883705139160156
generate_one_block  0.3921945095062256
generate_one_block  0.399242639541626
generate_one_block  0.38906145095825195
generate_one_block  0.3830714225769043
generate_one_block  0.4166066646575928
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03229975700378418
gen group dst list time:  0.03749537467956543
time for parepare:  0.01865673065185547
local_output_nid generation:  0.02615809440612793
local_in_edges_tensor generation:  0.0437164306640625
mini_batch_src_global generation:  0.04699087142944336
r_  generation:  0.47108960151672363
local_output_nid generation:  0.03199458122253418
local_in_edges_tensor generation:  0.03843522071838379
mini_batch_src_global generation:  0.055196523666381836
r_  generation:  0.478071928024292
local_output_nid generation:  0.03305459022521973
local_in_edges_tensor generation:  0.031700849533081055
mini_batch_src_global generation:  0.05170750617980957
r_  generation:  0.48598361015319824
local_output_nid generation:  0.03312492370605469
local_in_edges_tensor generation:  0.03267645835876465
mini_batch_src_global generation:  0.05514097213745117
r_  generation:  0.4778141975402832
local_output_nid generation:  0.032918691635131836
local_in_edges_tensor generation:  0.034265756607055664
mini_batch_src_global generation:  0.05335569381713867
r_  generation:  0.4964172840118408
local_output_nid generation:  0.03343677520751953
local_in_edges_tensor generation:  0.03188729286193848
mini_batch_src_global generation:  0.055782318115234375
r_  generation:  0.47975897789001465
local_output_nid generation:  0.03328347206115723
local_in_edges_tensor generation:  0.031494140625
mini_batch_src_global generation:  0.05350947380065918
r_  generation:  0.4937267303466797
local_output_nid generation:  0.03395342826843262
local_in_edges_tensor generation:  0.03223705291748047
mini_batch_src_global generation:  0.05765724182128906
r_  generation:  0.48221611976623535
----------------------check_connections_block total spend ----------------------------- 5.710090637207031
generate_one_block  0.6065704822540283
generate_one_block  0.6089799404144287
generate_one_block  0.5997824668884277
generate_one_block  0.5987341403961182
generate_one_block  0.6017560958862305
generate_one_block  0.6062052249908447
generate_one_block  0.6083102226257324
generate_one_block  0.6139757633209229
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12993860244750977  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

connection checking time:  9.254398822784424
block generation total time  8.00101637840271
average batch blocks generation time:  1.0001270473003387
block dataloader generation time/epoch 19.14933201244899
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10143804550170898  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9047331809997559  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1013798713684082  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9055018424987793  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10097026824951172  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9012761116027832  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10117101669311523  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9053554534912109  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10109233856201172  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9021615982055664  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10129308700561523  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9036040306091309  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10093307495117188  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9005203247070312  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10153007507324219  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9053869247436523  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07963773608207703 |0.01120448112487793 |0.0034814774990081787 |9.056925773620605e-05 |0.0036136209964752197 |0.0031604766845703125 |
----------------------------------------------------------pseudo_mini_loss sum 1.279292345046997
Total (block generation + training)time/epoch 20.014212403978622
Training time/epoch 0.8554470539093018
Training time without block to device /epoch 0.7658112049102783
Training time without total dataloading part /epoch 0.06064581871032715
load block tensor time/epoch 0.6371018886566162
block to device time/epoch 0.08963584899902344
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 23 |
Number of nodes for computation during this epoch:  2955056
Number of first layer input nodes during this epoch:  1283851
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12974309921264648  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01630687713623047
range selection method range initialization spend 0.011934041976928711
time for parepare:  0.01624131202697754
local_output_nid generation:  0.0027344226837158203
local_in_edges_tensor generation:  0.004400014877319336
mini_batch_src_global generation:  0.0029993057250976562
r_  generation:  0.03912520408630371
local_output_nid generation:  0.003164529800415039
local_in_edges_tensor generation:  0.0016837120056152344
mini_batch_src_global generation:  0.004342794418334961
r_  generation:  0.039719343185424805
local_output_nid generation:  0.003171682357788086
local_in_edges_tensor generation:  0.0016798973083496094
mini_batch_src_global generation:  0.0030601024627685547
r_  generation:  0.040266990661621094
local_output_nid generation:  0.003143310546875
local_in_edges_tensor generation:  0.001683950424194336
mini_batch_src_global generation:  0.0029938220977783203
r_  generation:  0.04095101356506348
local_output_nid generation:  0.0032792091369628906
local_in_edges_tensor generation:  0.001712799072265625
mini_batch_src_global generation:  0.0032525062561035156
r_  generation:  0.04140591621398926
local_output_nid generation:  0.0031821727752685547
local_in_edges_tensor generation:  0.0017371177673339844
mini_batch_src_global generation:  0.003250598907470703
r_  generation:  0.04205441474914551
local_output_nid generation:  0.003159761428833008
local_in_edges_tensor generation:  0.0016913414001464844
mini_batch_src_global generation:  0.0033333301544189453
r_  generation:  0.04198193550109863
local_output_nid generation:  0.0031654834747314453
local_in_edges_tensor generation:  0.0017125606536865234
mini_batch_src_global generation:  0.003271341323852539
r_  generation:  0.0415349006652832
----------------------check_connections_block total spend ----------------------------- 0.4825568199157715
generate_one_block  0.05278778076171875
generate_one_block  0.05423593521118164
generate_one_block  0.054215192794799805
generate_one_block  0.054532766342163086
generate_one_block  0.05405068397521973
generate_one_block  0.05469846725463867
generate_one_block  0.057024240493774414
generate_one_block  0.05465579032897949
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029933452606201172
gen group dst list time:  0.01395106315612793
time for parepare:  0.020811080932617188
local_output_nid generation:  0.010449647903442383
local_in_edges_tensor generation:  0.023608922958374023
mini_batch_src_global generation:  0.030237197875976562
r_  generation:  0.28391504287719727
local_output_nid generation:  0.016134023666381836
local_in_edges_tensor generation:  0.019702672958374023
mini_batch_src_global generation:  0.03594183921813965
r_  generation:  0.2977437973022461
local_output_nid generation:  0.0169525146484375
local_in_edges_tensor generation:  0.016695261001586914
mini_batch_src_global generation:  0.037929534912109375
r_  generation:  0.30130505561828613
local_output_nid generation:  0.016641855239868164
local_in_edges_tensor generation:  0.016771316528320312
mini_batch_src_global generation:  0.03615593910217285
r_  generation:  0.3053004741668701
local_output_nid generation:  0.017559528350830078
local_in_edges_tensor generation:  0.017992019653320312
mini_batch_src_global generation:  0.03989434242248535
r_  generation:  0.3067443370819092
local_output_nid generation:  0.017825841903686523
local_in_edges_tensor generation:  0.017403364181518555
mini_batch_src_global generation:  0.038095951080322266
r_  generation:  0.30869388580322266
local_output_nid generation:  0.017161846160888672
local_in_edges_tensor generation:  0.016667842864990234
mini_batch_src_global generation:  0.038582801818847656
r_  generation:  0.3083775043487549
local_output_nid generation:  0.016761302947998047
local_in_edges_tensor generation:  0.019091129302978516
mini_batch_src_global generation:  0.03833889961242676
r_  generation:  0.31195068359375
----------------------check_connections_block total spend ----------------------------- 3.546436071395874
generate_one_block  0.3874685764312744
generate_one_block  0.39374709129333496
generate_one_block  0.3883223533630371
generate_one_block  0.39060449600219727
generate_one_block  0.3897740840911865
generate_one_block  0.38748812675476074
generate_one_block  0.39461255073547363
generate_one_block  0.41248178482055664
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.032532691955566406
gen group dst list time:  0.037578582763671875
time for parepare:  0.020835399627685547
local_output_nid generation:  0.026162147521972656
local_in_edges_tensor generation:  0.03762483596801758
mini_batch_src_global generation:  0.043749094009399414
r_  generation:  0.4680929183959961
local_output_nid generation:  0.03277397155761719
local_in_edges_tensor generation:  0.03185462951660156
mini_batch_src_global generation:  0.056571245193481445
r_  generation:  0.47176313400268555
local_output_nid generation:  0.03302145004272461
local_in_edges_tensor generation:  0.03494405746459961
mini_batch_src_global generation:  0.05688929557800293
r_  generation:  0.4867689609527588
local_output_nid generation:  0.03338980674743652
local_in_edges_tensor generation:  0.03520941734313965
mini_batch_src_global generation:  0.05594968795776367
r_  generation:  0.4756791591644287
local_output_nid generation:  0.033370256423950195
local_in_edges_tensor generation:  0.03223371505737305
mini_batch_src_global generation:  0.05330467224121094
r_  generation:  0.4900391101837158
local_output_nid generation:  0.0335690975189209
local_in_edges_tensor generation:  0.03271222114562988
mini_batch_src_global generation:  0.05538034439086914
r_  generation:  0.48027801513671875
local_output_nid generation:  0.03361821174621582
local_in_edges_tensor generation:  0.0353090763092041
mini_batch_src_global generation:  0.057260751724243164
r_  generation:  0.49416613578796387
local_output_nid generation:  0.034149169921875
local_in_edges_tensor generation:  0.03588271141052246
mini_batch_src_global generation:  0.058832645416259766
r_  generation:  0.49357175827026367
----------------------check_connections_block total spend ----------------------------- 5.7186384201049805
generate_one_block  0.6089723110198975
generate_one_block  0.6038246154785156
generate_one_block  0.6128675937652588
generate_one_block  0.6088964939117432
generate_one_block  0.6038954257965088
generate_one_block  0.6096358299255371
generate_one_block  0.6096665859222412
generate_one_block  0.6040468215942383
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12974309921264648  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

connection checking time:  9.265074491500854
block generation total time  8.006304740905762
average batch blocks generation time:  1.0007880926132202
block dataloader generation time/epoch 19.144333950678508
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10122156143188477  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9005188941955566  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10118484497070312  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.903656005859375  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10129404067993164  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9048328399658203  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10200691223144531  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9030461311340332  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10104084014892578  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9017486572265625  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10120820999145508  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9062023162841797  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1012716293334961  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9054017066955566  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10182571411132812  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9056029319763184  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07635465264320374 |0.013950556516647339 |0.0034322142601013184 |9.03010368347168e-05 |0.0028788745403289795 |0.0029506683349609375 |
----------------------------------------------------------pseudo_mini_loss sum 1.2624735832214355
Total (block generation + training)time/epoch 20.008106406529745
Training time/epoch 0.848029613494873
Training time without block to device /epoch 0.7364251613616943
Training time without total dataloading part /epoch 0.054161787033081055
load block tensor time/epoch 0.6108372211456299
block to device time/epoch 0.11160445213317871
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 24 |
Number of nodes for computation during this epoch:  2956129
Number of first layer input nodes during this epoch:  1283958
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12953424453735352  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.017220497131347656
range selection method range initialization spend 0.012316226959228516
time for parepare:  0.017264366149902344
local_output_nid generation:  0.0027701854705810547
local_in_edges_tensor generation:  0.010066747665405273
mini_batch_src_global generation:  0.002943754196166992
r_  generation:  0.03948187828063965
local_output_nid generation:  0.003164529800415039
local_in_edges_tensor generation:  0.0018496513366699219
mini_batch_src_global generation:  0.0044651031494140625
r_  generation:  0.03972434997558594
local_output_nid generation:  0.0032379627227783203
local_in_edges_tensor generation:  0.0017261505126953125
mini_batch_src_global generation:  0.003086090087890625
r_  generation:  0.04023933410644531
local_output_nid generation:  0.003253459930419922
local_in_edges_tensor generation:  0.001745462417602539
mini_batch_src_global generation:  0.0029685497283935547
r_  generation:  0.04079627990722656
local_output_nid generation:  0.0031425952911376953
local_in_edges_tensor generation:  0.0017156600952148438
mini_batch_src_global generation:  0.0032041072845458984
r_  generation:  0.04131507873535156
local_output_nid generation:  0.0032286643981933594
local_in_edges_tensor generation:  0.0017518997192382812
mini_batch_src_global generation:  0.0032482147216796875
r_  generation:  0.0418550968170166
local_output_nid generation:  0.003192424774169922
local_in_edges_tensor generation:  0.0017244815826416016
mini_batch_src_global generation:  0.0032777786254882812
r_  generation:  0.04125714302062988
local_output_nid generation:  0.003210306167602539
local_in_edges_tensor generation:  0.0017366409301757812
mini_batch_src_global generation:  0.003267049789428711
r_  generation:  0.0418398380279541
----------------------check_connections_block total spend ----------------------------- 0.4891369342803955
generate_one_block  0.053337812423706055
generate_one_block  0.05513596534729004
generate_one_block  0.05435800552368164
generate_one_block  0.053969621658325195
generate_one_block  0.054567813873291016
generate_one_block  0.05530905723571777
generate_one_block  0.05713367462158203
generate_one_block  0.054825544357299805
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03713703155517578
gen group dst list time:  0.01392817497253418
time for parepare:  0.019739627838134766
local_output_nid generation:  0.010504007339477539
local_in_edges_tensor generation:  0.02752089500427246
mini_batch_src_global generation:  0.028928756713867188
r_  generation:  0.2875699996948242
local_output_nid generation:  0.016112327575683594
local_in_edges_tensor generation:  0.01938319206237793
mini_batch_src_global generation:  0.0376582145690918
r_  generation:  0.2989671230316162
local_output_nid generation:  0.016729116439819336
local_in_edges_tensor generation:  0.01679396629333496
mini_batch_src_global generation:  0.035803794860839844
r_  generation:  0.2984771728515625
local_output_nid generation:  0.016635894775390625
local_in_edges_tensor generation:  0.017052173614501953
mini_batch_src_global generation:  0.03994035720825195
r_  generation:  0.30104708671569824
local_output_nid generation:  0.01785135269165039
local_in_edges_tensor generation:  0.017181873321533203
mini_batch_src_global generation:  0.03811025619506836
r_  generation:  0.3112051486968994
local_output_nid generation:  0.017994165420532227
local_in_edges_tensor generation:  0.01774144172668457
mini_batch_src_global generation:  0.03784584999084473
r_  generation:  0.30789828300476074
local_output_nid generation:  0.016709089279174805
local_in_edges_tensor generation:  0.018110036849975586
mini_batch_src_global generation:  0.03827524185180664
r_  generation:  0.3060932159423828
local_output_nid generation:  0.016789913177490234
local_in_edges_tensor generation:  0.018537044525146484
mini_batch_src_global generation:  0.037661075592041016
r_  generation:  0.3081636428833008
----------------------check_connections_block total spend ----------------------------- 3.5421133041381836
generate_one_block  0.3916451930999756
generate_one_block  0.3986368179321289
generate_one_block  0.38265419006347656
generate_one_block  0.38443636894226074
generate_one_block  0.3905320167541504
generate_one_block  0.3877871036529541
generate_one_block  0.38581252098083496
generate_one_block  0.4077568054199219
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03487801551818848
gen group dst list time:  0.0374293327331543
time for parepare:  0.01831531524658203
local_output_nid generation:  0.025499582290649414
local_in_edges_tensor generation:  0.03716444969177246
mini_batch_src_global generation:  0.04353594779968262
r_  generation:  0.4693734645843506
local_output_nid generation:  0.032082319259643555
local_in_edges_tensor generation:  0.03563117980957031
mini_batch_src_global generation:  0.05530047416687012
r_  generation:  0.47342419624328613
local_output_nid generation:  0.03306388854980469
local_in_edges_tensor generation:  0.03181958198547363
mini_batch_src_global generation:  0.051398515701293945
r_  generation:  0.48531293869018555
local_output_nid generation:  0.03291058540344238
local_in_edges_tensor generation:  0.0334935188293457
mini_batch_src_global generation:  0.055161476135253906
r_  generation:  0.47823143005371094
local_output_nid generation:  0.03328204154968262
local_in_edges_tensor generation:  0.03284001350402832
mini_batch_src_global generation:  0.05317831039428711
r_  generation:  0.4952054023742676
local_output_nid generation:  0.033492088317871094
local_in_edges_tensor generation:  0.03220009803771973
mini_batch_src_global generation:  0.055742740631103516
r_  generation:  0.4784719944000244
local_output_nid generation:  0.0332033634185791
local_in_edges_tensor generation:  0.031577110290527344
mini_batch_src_global generation:  0.05340838432312012
r_  generation:  0.4946322441101074
local_output_nid generation:  0.03356671333312988
local_in_edges_tensor generation:  0.03412342071533203
mini_batch_src_global generation:  0.05598855018615723
r_  generation:  0.4904439449310303
----------------------check_connections_block total spend ----------------------------- 5.692417621612549
generate_one_block  0.6002175807952881
generate_one_block  0.6062202453613281
generate_one_block  0.6020019054412842
generate_one_block  0.6036715507507324
generate_one_block  0.6066524982452393
generate_one_block  0.6053380966186523
generate_one_block  0.6128520965576172
generate_one_block  0.603358268737793
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12953424453735352  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

connection checking time:  9.234530925750732
block generation total time  7.969573259353638
average batch blocks generation time:  0.9961966574192047
block dataloader generation time/epoch 19.136660531163216
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10114574432373047  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9038963317871094  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10130929946899414  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9037747383117676  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1009817123413086  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9016847610473633  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10146141052246094  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9024696350097656  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10142087936401367  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9070758819580078  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10128498077392578  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9043388366699219  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10096931457519531  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9009461402893066  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10105323791503906  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9028582572937012  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07920768857002258 |0.011015325784683228 |0.003434479236602783 |8.878111839294434e-05 |0.00359538197517395 |0.0013837814331054688 |
----------------------------------------------------------pseudo_mini_loss sum 1.2544829845428467
Total (block generation + training)time/epoch 19.999405205249786
Training time/epoch 0.8471207618713379
Training time without block to device /epoch 0.7589981555938721
Training time without total dataloading part /epoch 0.05833292007446289
load block tensor time/epoch 0.6336615085601807
block to device time/epoch 0.08812260627746582
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 25 |
Number of nodes for computation during this epoch:  2954946
Number of first layer input nodes during this epoch:  1283559
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12988567352294922  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.016963958740234375
range selection method range initialization spend 0.011875391006469727
time for parepare:  0.0166323184967041
local_output_nid generation:  0.002802133560180664
local_in_edges_tensor generation:  0.004105329513549805
mini_batch_src_global generation:  0.0030221939086914062
r_  generation:  0.03809618949890137
local_output_nid generation:  0.003172159194946289
local_in_edges_tensor generation:  0.0017147064208984375
mini_batch_src_global generation:  0.0043468475341796875
r_  generation:  0.03981471061706543
local_output_nid generation:  0.0031898021697998047
local_in_edges_tensor generation:  0.0017015933990478516
mini_batch_src_global generation:  0.003065824508666992
r_  generation:  0.03975987434387207
local_output_nid generation:  0.0032498836517333984
local_in_edges_tensor generation:  0.001737356185913086
mini_batch_src_global generation:  0.0029282569885253906
r_  generation:  0.041049957275390625
local_output_nid generation:  0.003203868865966797
local_in_edges_tensor generation:  0.0017249584197998047
mini_batch_src_global generation:  0.0031969547271728516
r_  generation:  0.04151415824890137
local_output_nid generation:  0.003206014633178711
local_in_edges_tensor generation:  0.0016987323760986328
mini_batch_src_global generation:  0.003200054168701172
r_  generation:  0.041684627532958984
local_output_nid generation:  0.0032460689544677734
local_in_edges_tensor generation:  0.001741170883178711
mini_batch_src_global generation:  0.003265380859375
r_  generation:  0.041695594787597656
local_output_nid generation:  0.003202676773071289
local_in_edges_tensor generation:  0.0016870498657226562
mini_batch_src_global generation:  0.003217935562133789
r_  generation:  0.04201817512512207
----------------------check_connections_block total spend ----------------------------- 0.48128676414489746
generate_one_block  0.05314064025878906
generate_one_block  0.05454444885253906
generate_one_block  0.053812265396118164
generate_one_block  0.05402398109436035
generate_one_block  0.05407357215881348
generate_one_block  0.05440068244934082
generate_one_block  0.05658316612243652
generate_one_block  0.05417609214782715
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0295255184173584
gen group dst list time:  0.01418614387512207
time for parepare:  0.01934337615966797
local_output_nid generation:  0.01029658317565918
local_in_edges_tensor generation:  0.022681713104248047
mini_batch_src_global generation:  0.02990555763244629
r_  generation:  0.28481483459472656
local_output_nid generation:  0.016372203826904297
local_in_edges_tensor generation:  0.015923261642456055
mini_batch_src_global generation:  0.0360407829284668
r_  generation:  0.29926061630249023
local_output_nid generation:  0.016770124435424805
local_in_edges_tensor generation:  0.016234159469604492
mini_batch_src_global generation:  0.03562641143798828
r_  generation:  0.2981123924255371
local_output_nid generation:  0.01660442352294922
local_in_edges_tensor generation:  0.017764806747436523
mini_batch_src_global generation:  0.03651237487792969
r_  generation:  0.30434536933898926
local_output_nid generation:  0.017409324645996094
local_in_edges_tensor generation:  0.017312049865722656
mini_batch_src_global generation:  0.03752255439758301
r_  generation:  0.3083837032318115
local_output_nid generation:  0.017545223236083984
local_in_edges_tensor generation:  0.017258405685424805
mini_batch_src_global generation:  0.03808856010437012
r_  generation:  0.3133993148803711
local_output_nid generation:  0.016767501831054688
local_in_edges_tensor generation:  0.016901493072509766
mini_batch_src_global generation:  0.038083791732788086
r_  generation:  0.3074381351470947
local_output_nid generation:  0.01668381690979004
local_in_edges_tensor generation:  0.01704120635986328
mini_batch_src_global generation:  0.037572622299194336
r_  generation:  0.3068089485168457
----------------------check_connections_block total spend ----------------------------- 3.5272364616394043
generate_one_block  0.38520145416259766
generate_one_block  0.387988805770874
generate_one_block  0.38535189628601074
generate_one_block  0.38959503173828125
generate_one_block  0.3904719352722168
generate_one_block  0.39501380920410156
generate_one_block  0.388441801071167
generate_one_block  0.40575337409973145
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.026195287704467773
gen group dst list time:  0.03749656677246094
time for parepare:  0.018906831741333008
local_output_nid generation:  0.025776386260986328
local_in_edges_tensor generation:  0.03632974624633789
mini_batch_src_global generation:  0.043970584869384766
r_  generation:  0.47304463386535645
local_output_nid generation:  0.03260993957519531
local_in_edges_tensor generation:  0.03058934211730957
mini_batch_src_global generation:  0.05523109436035156
r_  generation:  0.4743359088897705
local_output_nid generation:  0.032994985580444336
local_in_edges_tensor generation:  0.03238248825073242
mini_batch_src_global generation:  0.05240464210510254
r_  generation:  0.4856727123260498
local_output_nid generation:  0.03317880630493164
local_in_edges_tensor generation:  0.031482696533203125
mini_batch_src_global generation:  0.055359601974487305
r_  generation:  0.4803812503814697
local_output_nid generation:  0.033295392990112305
local_in_edges_tensor generation:  0.03316068649291992
mini_batch_src_global generation:  0.05765509605407715
r_  generation:  0.49370288848876953
local_output_nid generation:  0.03477621078491211
local_in_edges_tensor generation:  0.03452277183532715
mini_batch_src_global generation:  0.05621170997619629
r_  generation:  0.48752307891845703
local_output_nid generation:  0.03374290466308594
local_in_edges_tensor generation:  0.03220319747924805
mini_batch_src_global generation:  0.05468010902404785
r_  generation:  0.4943506717681885
local_output_nid generation:  0.03373289108276367
local_in_edges_tensor generation:  0.032538652420043945
mini_batch_src_global generation:  0.0560302734375
r_  generation:  0.49239230155944824
----------------------check_connections_block total spend ----------------------------- 5.7147839069366455
generate_one_block  0.6030287742614746
generate_one_block  0.6105751991271973
generate_one_block  0.6084089279174805
generate_one_block  0.6125540733337402
generate_one_block  0.6141602993011475
generate_one_block  0.6251964569091797
generate_one_block  0.6091856956481934
generate_one_block  0.6026675701141357
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12988567352294922  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

connection checking time:  9.24202036857605
block generation total time  8.01359510421753
average batch blocks generation time:  1.0016993880271912
block dataloader generation time/epoch 19.129788679235123
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1011056900024414  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9031147956848145  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10114717483520508  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9037342071533203  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10128450393676758  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9032316207885742  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10106468200683594  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9029231071472168  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10126686096191406  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9066123962402344  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10137748718261719  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9068441390991211  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.101226806640625  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9067111015319824  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10109281539916992  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9026908874511719  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08115708827972412 |0.015176355838775635 |0.003484010696411133 |9.042024612426758e-05 |0.003757655620574951 |0.001222372055053711 |
----------------------------------------------------------pseudo_mini_loss sum 1.2407679557800293
Total (block generation + training)time/epoch 19.99491248411291
Training time/epoch 0.9029676914215088
Training time without block to device /epoch 0.7815568447113037
Training time without total dataloading part /epoch 0.05987906455993652
load block tensor time/epoch 0.649256706237793
block to device time/epoch 0.12141084671020508
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 26 |
Number of nodes for computation during this epoch:  2958748
Number of first layer input nodes during this epoch:  1284416
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12947893142700195  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019217729568481445
range selection method range initialization spend 0.012557744979858398
time for parepare:  0.01757216453552246
local_output_nid generation:  0.002710103988647461
local_in_edges_tensor generation:  0.004952430725097656
mini_batch_src_global generation:  0.0036847591400146484
r_  generation:  0.0385129451751709
local_output_nid generation:  0.0031735897064208984
local_in_edges_tensor generation:  0.0018222332000732422
mini_batch_src_global generation:  0.0043756961822509766
r_  generation:  0.039119720458984375
local_output_nid generation:  0.003237009048461914
local_in_edges_tensor generation:  0.0017271041870117188
mini_batch_src_global generation:  0.0030279159545898438
r_  generation:  0.040230751037597656
local_output_nid generation:  0.0032079219818115234
local_in_edges_tensor generation:  0.0017251968383789062
mini_batch_src_global generation:  0.0030498504638671875
r_  generation:  0.04095101356506348
local_output_nid generation:  0.0033059120178222656
local_in_edges_tensor generation:  0.001735687255859375
mini_batch_src_global generation:  0.0031948089599609375
r_  generation:  0.04123520851135254
local_output_nid generation:  0.003232717514038086
local_in_edges_tensor generation:  0.0017986297607421875
mini_batch_src_global generation:  0.003261566162109375
r_  generation:  0.041745901107788086
local_output_nid generation:  0.0031909942626953125
local_in_edges_tensor generation:  0.0017232894897460938
mini_batch_src_global generation:  0.0033702850341796875
r_  generation:  0.04275012016296387
local_output_nid generation:  0.0032401084899902344
local_in_edges_tensor generation:  0.0016870498657226562
mini_batch_src_global generation:  0.0033111572265625
r_  generation:  0.04182124137878418
----------------------check_connections_block total spend ----------------------------- 0.48517560958862305
generate_one_block  0.05326104164123535
generate_one_block  0.054248809814453125
generate_one_block  0.05420947074890137
generate_one_block  0.05505704879760742
generate_one_block  0.0541532039642334
generate_one_block  0.05452775955200195
generate_one_block  0.05797696113586426
generate_one_block  0.05415225028991699
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029912948608398438
gen group dst list time:  0.013808012008666992
time for parepare:  0.01948380470275879
local_output_nid generation:  0.010511398315429688
local_in_edges_tensor generation:  0.0234377384185791
mini_batch_src_global generation:  0.032510995864868164
r_  generation:  0.2838618755340576
local_output_nid generation:  0.016392946243286133
local_in_edges_tensor generation:  0.020340442657470703
mini_batch_src_global generation:  0.03565573692321777
r_  generation:  0.29912304878234863
local_output_nid generation:  0.0168302059173584
local_in_edges_tensor generation:  0.01788043975830078
mini_batch_src_global generation:  0.03554892539978027
r_  generation:  0.29964566230773926
local_output_nid generation:  0.01679515838623047
local_in_edges_tensor generation:  0.0180511474609375
mini_batch_src_global generation:  0.039843082427978516
r_  generation:  0.30528736114501953
local_output_nid generation:  0.017451047897338867
local_in_edges_tensor generation:  0.016959190368652344
mini_batch_src_global generation:  0.03741788864135742
r_  generation:  0.3083171844482422
local_output_nid generation:  0.01772022247314453
local_in_edges_tensor generation:  0.01825737953186035
mini_batch_src_global generation:  0.03780794143676758
r_  generation:  0.3056764602661133
local_output_nid generation:  0.01732659339904785
local_in_edges_tensor generation:  0.018204212188720703
mini_batch_src_global generation:  0.038483381271362305
r_  generation:  0.31216001510620117
local_output_nid generation:  0.01680922508239746
local_in_edges_tensor generation:  0.017023086547851562
mini_batch_src_global generation:  0.03733062744140625
r_  generation:  0.30350542068481445
----------------------check_connections_block total spend ----------------------------- 3.537490129470825
generate_one_block  0.3852658271789551
generate_one_block  0.392411470413208
generate_one_block  0.3929903507232666
generate_one_block  0.38901543617248535
generate_one_block  0.3918471336364746
generate_one_block  0.38454627990722656
generate_one_block  0.39409828186035156
generate_one_block  0.40392589569091797
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03235268592834473
gen group dst list time:  0.03748798370361328
time for parepare:  0.018718957901000977
local_output_nid generation:  0.02506875991821289
local_in_edges_tensor generation:  0.03586602210998535
mini_batch_src_global generation:  0.04366612434387207
r_  generation:  0.4697096347808838
local_output_nid generation:  0.03274726867675781
local_in_edges_tensor generation:  0.03559732437133789
mini_batch_src_global generation:  0.055252790451049805
r_  generation:  0.475888729095459
local_output_nid generation:  0.03275418281555176
local_in_edges_tensor generation:  0.03235602378845215
mini_batch_src_global generation:  0.0513458251953125
r_  generation:  0.4852478504180908
local_output_nid generation:  0.032922983169555664
local_in_edges_tensor generation:  0.03193378448486328
mini_batch_src_global generation:  0.05646824836730957
r_  generation:  0.47983622550964355
local_output_nid generation:  0.032889366149902344
local_in_edges_tensor generation:  0.031179428100585938
mini_batch_src_global generation:  0.05315208435058594
r_  generation:  0.4875788688659668
local_output_nid generation:  0.03294706344604492
local_in_edges_tensor generation:  0.030252456665039062
mini_batch_src_global generation:  0.055677175521850586
r_  generation:  0.4807720184326172
local_output_nid generation:  0.03380107879638672
local_in_edges_tensor generation:  0.032006025314331055
mini_batch_src_global generation:  0.05388021469116211
r_  generation:  0.49630188941955566
local_output_nid generation:  0.03345847129821777
local_in_edges_tensor generation:  0.033023834228515625
mini_batch_src_global generation:  0.05597734451293945
r_  generation:  0.48171114921569824
----------------------check_connections_block total spend ----------------------------- 5.680447816848755
generate_one_block  0.598696231842041
generate_one_block  0.6005303859710693
generate_one_block  0.6050448417663574
generate_one_block  0.6090855598449707
generate_one_block  0.599902868270874
generate_one_block  0.6016972064971924
generate_one_block  0.6091470718383789
generate_one_block  0.6020781993865967
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12947893142700195  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

connection checking time:  9.21793794631958
block generation total time  7.960283041000366
average batch blocks generation time:  0.9950353801250458
block dataloader generation time/epoch 19.122406641642254
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1012120246887207  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9016475677490234  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1011967658996582  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9038619995117188  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10117912292480469  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9025816917419434  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1013803482055664  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9066638946533203  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10131025314331055  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9021363258361816  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10113525390625  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9025969505310059  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10152769088745117  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9109811782836914  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1010279655456543  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9017682075500488  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07548239827156067 |0.010909467935562134 |0.0034304261207580566 |8.994340896606445e-05 |0.003289461135864258 |0.002887725830078125 |
----------------------------------------------------------pseudo_mini_loss sum 1.2333859205245972
Total (block generation + training)time/epoch 19.984960012965733
Training time/epoch 0.8186705112457275
Training time without block to device /epoch 0.7313947677612305
Training time without total dataloading part /epoch 0.057366371154785156
load block tensor time/epoch 0.6038591861724854
block to device time/epoch 0.08727574348449707
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 27 |
Number of nodes for computation during this epoch:  2956291
Number of first layer input nodes during this epoch:  1284210
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.13013839721679688  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.016632556915283203
range selection method range initialization spend 0.012151479721069336
time for parepare:  0.01649022102355957
local_output_nid generation:  0.0027561187744140625
local_in_edges_tensor generation:  0.0039598941802978516
mini_batch_src_global generation:  0.003049135208129883
r_  generation:  0.039231061935424805
local_output_nid generation:  0.0031599998474121094
local_in_edges_tensor generation:  0.0017104148864746094
mini_batch_src_global generation:  0.004300832748413086
r_  generation:  0.03820085525512695
local_output_nid generation:  0.003176450729370117
local_in_edges_tensor generation:  0.0017285346984863281
mini_batch_src_global generation:  0.003021240234375
r_  generation:  0.04051995277404785
local_output_nid generation:  0.0031943321228027344
local_in_edges_tensor generation:  0.0017247200012207031
mini_batch_src_global generation:  0.002996206283569336
r_  generation:  0.040946006774902344
local_output_nid generation:  0.003164052963256836
local_in_edges_tensor generation:  0.0017383098602294922
mini_batch_src_global generation:  0.003191709518432617
r_  generation:  0.04176139831542969
local_output_nid generation:  0.0031387805938720703
local_in_edges_tensor generation:  0.0017032623291015625
mini_batch_src_global generation:  0.0032684803009033203
r_  generation:  0.0419161319732666
local_output_nid generation:  0.0031709671020507812
local_in_edges_tensor generation:  0.0016934871673583984
mini_batch_src_global generation:  0.0033288002014160156
r_  generation:  0.04250502586364746
local_output_nid generation:  0.003201007843017578
local_in_edges_tensor generation:  0.0017309188842773438
mini_batch_src_global generation:  0.003228902816772461
r_  generation:  0.04132390022277832
----------------------check_connections_block total spend ----------------------------- 0.481229305267334
generate_one_block  0.05323004722595215
generate_one_block  0.05290508270263672
generate_one_block  0.054392099380493164
generate_one_block  0.05509305000305176
generate_one_block  0.05462312698364258
generate_one_block  0.05486416816711426
generate_one_block  0.0572965145111084
generate_one_block  0.05406594276428223
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02623295783996582
gen group dst list time:  0.013947248458862305
time for parepare:  0.01938772201538086
local_output_nid generation:  0.010715007781982422
local_in_edges_tensor generation:  0.022991180419921875
mini_batch_src_global generation:  0.03028702735900879
r_  generation:  0.287569522857666
local_output_nid generation:  0.01601433753967285
local_in_edges_tensor generation:  0.01712512969970703
mini_batch_src_global generation:  0.03663969039916992
r_  generation:  0.2908637523651123
local_output_nid generation:  0.016718387603759766
local_in_edges_tensor generation:  0.018071413040161133
mini_batch_src_global generation:  0.03572702407836914
r_  generation:  0.30329275131225586
local_output_nid generation:  0.01663374900817871
local_in_edges_tensor generation:  0.016726255416870117
mini_batch_src_global generation:  0.03643989562988281
r_  generation:  0.3068881034851074
local_output_nid generation:  0.017823457717895508
local_in_edges_tensor generation:  0.01953125
mini_batch_src_global generation:  0.037566184997558594
r_  generation:  0.3052856922149658
local_output_nid generation:  0.017683029174804688
local_in_edges_tensor generation:  0.016809940338134766
mini_batch_src_global generation:  0.03770756721496582
r_  generation:  0.31255578994750977
local_output_nid generation:  0.01742410659790039
local_in_edges_tensor generation:  0.017795324325561523
mini_batch_src_global generation:  0.038489341735839844
r_  generation:  0.3067128658294678
local_output_nid generation:  0.016546010971069336
local_in_edges_tensor generation:  0.017502307891845703
mini_batch_src_global generation:  0.03748774528503418
r_  generation:  0.299532413482666
----------------------check_connections_block total spend ----------------------------- 3.523723602294922
generate_one_block  0.3926575183868408
generate_one_block  0.3799400329589844
generate_one_block  0.3879373073577881
generate_one_block  0.389925479888916
generate_one_block  0.3859682083129883
generate_one_block  0.3920938968658447
generate_one_block  0.393873929977417
generate_one_block  0.4054067134857178
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028302907943725586
gen group dst list time:  0.03773999214172363
time for parepare:  0.02035355567932129
local_output_nid generation:  0.025638103485107422
local_in_edges_tensor generation:  0.04191946983337402
mini_batch_src_global generation:  0.045618534088134766
r_  generation:  0.47146058082580566
local_output_nid generation:  0.032076120376586914
local_in_edges_tensor generation:  0.030286550521850586
mini_batch_src_global generation:  0.05482363700866699
r_  generation:  0.4735753536224365
local_output_nid generation:  0.03296160697937012
local_in_edges_tensor generation:  0.03044605255126953
mini_batch_src_global generation:  0.051599740982055664
r_  generation:  0.4984874725341797
local_output_nid generation:  0.03376054763793945
local_in_edges_tensor generation:  0.03173041343688965
mini_batch_src_global generation:  0.0554194450378418
r_  generation:  0.48703670501708984
local_output_nid generation:  0.033556222915649414
local_in_edges_tensor generation:  0.033043861389160156
mini_batch_src_global generation:  0.0536806583404541
r_  generation:  0.49355196952819824
local_output_nid generation:  0.033624887466430664
local_in_edges_tensor generation:  0.030612707138061523
mini_batch_src_global generation:  0.05591559410095215
r_  generation:  0.4834916591644287
local_output_nid generation:  0.03362894058227539
local_in_edges_tensor generation:  0.030908584594726562
mini_batch_src_global generation:  0.05386972427368164
r_  generation:  0.4946892261505127
local_output_nid generation:  0.03409886360168457
local_in_edges_tensor generation:  0.03095221519470215
mini_batch_src_global generation:  0.05571246147155762
r_  generation:  0.48125314712524414
----------------------check_connections_block total spend ----------------------------- 5.710547924041748
generate_one_block  0.5979766845703125
generate_one_block  0.5971767902374268
generate_one_block  0.5945496559143066
generate_one_block  0.6043729782104492
generate_one_block  0.597808837890625
generate_one_block  0.6012890338897705
generate_one_block  0.600914716720581
generate_one_block  0.5988852977752686
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.13013839721679688  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

connection checking time:  9.23427152633667
block generation total time  7.920777082443237
average batch blocks generation time:  0.9900971353054047
block dataloader generation time/epoch 19.111132132379634
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10171222686767578  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9076271057128906  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10107755661010742  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.8985400199890137  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10106563568115234  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9033856391906738  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10127544403076172  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9059562683105469  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10127639770507812  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9037880897521973  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10119390487670898  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9043221473693848  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10126399993896484  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9056820869445801  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1016244888305664  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9031491279602051  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07688865065574646 |0.013841241598129272 |0.0033862292766571045 |9.068846702575684e-05 |0.003293156623840332 |0.002678394317626953 |
----------------------------------------------------------pseudo_mini_loss sum 1.2164932489395142
Total (block generation + training)time/epoch 19.973112307096784
Training time/epoch 0.8514959812164307
Training time without block to device /epoch 0.7407660484313965
Training time without total dataloading part /epoch 0.0568389892578125
load block tensor time/epoch 0.6151092052459717
block to device time/epoch 0.11072993278503418
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 28 |
Number of nodes for computation during this epoch:  2957569
Number of first layer input nodes during this epoch:  1284072
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12915897369384766  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023498058319091797
range selection method range initialization spend 0.012120723724365234
time for parepare:  0.01633477210998535
local_output_nid generation:  0.002804994583129883
local_in_edges_tensor generation:  0.004030466079711914
mini_batch_src_global generation:  0.0029747486114501953
r_  generation:  0.03948068618774414
local_output_nid generation:  0.0032007694244384766
local_in_edges_tensor generation:  0.0016851425170898438
mini_batch_src_global generation:  0.0043413639068603516
r_  generation:  0.03919553756713867
local_output_nid generation:  0.003242015838623047
local_in_edges_tensor generation:  0.0017099380493164062
mini_batch_src_global generation:  0.0029506683349609375
r_  generation:  0.03999161720275879
local_output_nid generation:  0.0032715797424316406
local_in_edges_tensor generation:  0.0017018318176269531
mini_batch_src_global generation:  0.002980470657348633
r_  generation:  0.04107069969177246
local_output_nid generation:  0.0032453536987304688
local_in_edges_tensor generation:  0.0017223358154296875
mini_batch_src_global generation:  0.003170490264892578
r_  generation:  0.04195523262023926
local_output_nid generation:  0.0032415390014648438
local_in_edges_tensor generation:  0.001726388931274414
mini_batch_src_global generation:  0.0032258033752441406
r_  generation:  0.042023420333862305
local_output_nid generation:  0.0032253265380859375
local_in_edges_tensor generation:  0.001711130142211914
mini_batch_src_global generation:  0.003247976303100586
r_  generation:  0.04159092903137207
local_output_nid generation:  0.003221750259399414
local_in_edges_tensor generation:  0.001718759536743164
mini_batch_src_global generation:  0.0032210350036621094
r_  generation:  0.04196357727050781
----------------------check_connections_block total spend ----------------------------- 0.4824843406677246
generate_one_block  0.05395698547363281
generate_one_block  0.05410957336425781
generate_one_block  0.053705453872680664
generate_one_block  0.054656267166137695
generate_one_block  0.05489826202392578
generate_one_block  0.05424094200134277
generate_one_block  0.057273149490356445
generate_one_block  0.05505251884460449
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03094315528869629
gen group dst list time:  0.014003515243530273
time for parepare:  0.01916050910949707
local_output_nid generation:  0.010489702224731445
local_in_edges_tensor generation:  0.024272918701171875
mini_batch_src_global generation:  0.028852462768554688
r_  generation:  0.28772497177124023
local_output_nid generation:  0.016046524047851562
local_in_edges_tensor generation:  0.01765608787536621
mini_batch_src_global generation:  0.03718686103820801
r_  generation:  0.2999453544616699
local_output_nid generation:  0.01758718490600586
local_in_edges_tensor generation:  0.020386457443237305
mini_batch_src_global generation:  0.03522229194641113
r_  generation:  0.2972869873046875
local_output_nid generation:  0.01690506935119629
local_in_edges_tensor generation:  0.017737865447998047
mini_batch_src_global generation:  0.03770732879638672
r_  generation:  0.30826711654663086
local_output_nid generation:  0.017657041549682617
local_in_edges_tensor generation:  0.019308090209960938
mini_batch_src_global generation:  0.03761458396911621
r_  generation:  0.3073716163635254
local_output_nid generation:  0.017740488052368164
local_in_edges_tensor generation:  0.01699352264404297
mini_batch_src_global generation:  0.038513898849487305
r_  generation:  0.30898380279541016
local_output_nid generation:  0.017096281051635742
local_in_edges_tensor generation:  0.018105506896972656
mini_batch_src_global generation:  0.039542436599731445
r_  generation:  0.3123893737792969
local_output_nid generation:  0.016835689544677734
local_in_edges_tensor generation:  0.018387317657470703
mini_batch_src_global generation:  0.04093146324157715
r_  generation:  0.31040453910827637
----------------------check_connections_block total spend ----------------------------- 3.56123685836792
generate_one_block  0.3895900249481201
generate_one_block  0.38451695442199707
generate_one_block  0.379335880279541
generate_one_block  0.39049482345581055
generate_one_block  0.39263081550598145
generate_one_block  0.3906290531158447
generate_one_block  0.392794132232666
generate_one_block  0.4217231273651123
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02825641632080078
gen group dst list time:  0.03721213340759277
time for parepare:  0.018636226654052734
local_output_nid generation:  0.0259554386138916
local_in_edges_tensor generation:  0.05035114288330078
mini_batch_src_global generation:  0.04683327674865723
r_  generation:  0.4662299156188965
local_output_nid generation:  0.03224968910217285
local_in_edges_tensor generation:  0.03770852088928223
mini_batch_src_global generation:  0.05492091178894043
r_  generation:  0.47570013999938965
local_output_nid generation:  0.0328524112701416
local_in_edges_tensor generation:  0.031006574630737305
mini_batch_src_global generation:  0.05168628692626953
r_  generation:  0.4838411808013916
local_output_nid generation:  0.033490896224975586
local_in_edges_tensor generation:  0.03284311294555664
mini_batch_src_global generation:  0.05459713935852051
r_  generation:  0.47827839851379395
local_output_nid generation:  0.03318977355957031
local_in_edges_tensor generation:  0.03607964515686035
mini_batch_src_global generation:  0.05317211151123047
r_  generation:  0.4951601028442383
local_output_nid generation:  0.03343033790588379
local_in_edges_tensor generation:  0.03083324432373047
mini_batch_src_global generation:  0.05560469627380371
r_  generation:  0.4830327033996582
local_output_nid generation:  0.03356337547302246
local_in_edges_tensor generation:  0.03246712684631348
mini_batch_src_global generation:  0.05421924591064453
r_  generation:  0.4935770034790039
local_output_nid generation:  0.03383946418762207
local_in_edges_tensor generation:  0.03533792495727539
mini_batch_src_global generation:  0.055967092514038086
r_  generation:  0.48111629486083984
----------------------check_connections_block total spend ----------------------------- 5.715710163116455
generate_one_block  0.6088342666625977
generate_one_block  0.6121079921722412
generate_one_block  0.5985012054443359
generate_one_block  0.6004128456115723
generate_one_block  0.6027898788452148
generate_one_block  0.6032271385192871
generate_one_block  0.6016836166381836
generate_one_block  0.6074953079223633
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.12915897369384766  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

connection checking time:  9.276947021484375
block generation total time  7.976767063140869
average batch blocks generation time:  0.9970958828926086
block dataloader generation time/epoch 19.10774017572403
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10125350952148438  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9077067375183105  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10132360458374023  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9029889106750488  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1011037826538086  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.8992538452148438  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10143375396728516  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9060745239257812  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10120201110839844  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9041118621826172  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10116767883300781  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9030399322509766  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10130167007446289  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9038586616516113  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10115671157836914  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9044790267944336  GigaBytes
Max Memory Allocated: 1.042494773864746  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0813894271850586 |0.011149436235427856 |0.003477156162261963 |9.28640365600586e-05 |0.003719836473464966 |0.0014889240264892578 |
----------------------------------------------------------pseudo_mini_loss sum 1.2071460485458374
Total (block generation + training)time/epoch 19.97025865316391
Training time/epoch 0.8724856376647949
Training time without block to device /epoch 0.7832901477813721
Training time without total dataloading part /epoch 0.059807777404785156
load block tensor time/epoch 0.6511154174804688
block to device time/epoch 0.08919548988342285
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 29 |
Number of nodes for computation during this epoch:  2957422
Number of first layer input nodes during this epoch:  1284229
