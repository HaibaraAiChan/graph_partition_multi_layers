Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1647771238.2749734
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02713465690612793
range selection method range initialization spend 0.01316976547241211
time for parepare:  0.017746448516845703
local_output_nid generation:  0.002624034881591797
local_in_edges_tensor generation:  0.004794597625732422
mini_batch_src_global generation:  0.0037381649017333984
r_  generation:  0.04116034507751465
local_output_nid generation:  0.002960205078125
local_in_edges_tensor generation:  0.001706838607788086
mini_batch_src_global generation:  0.004753589630126953
r_  generation:  0.04208731651306152
local_output_nid generation:  0.003059864044189453
local_in_edges_tensor generation:  0.001725912094116211
mini_batch_src_global generation:  0.0030670166015625
r_  generation:  0.04298543930053711
local_output_nid generation:  0.0031347274780273438
local_in_edges_tensor generation:  0.0017285346984863281
mini_batch_src_global generation:  0.0031800270080566406
r_  generation:  0.044222354888916016
local_output_nid generation:  0.003077983856201172
local_in_edges_tensor generation:  0.0017042160034179688
mini_batch_src_global generation:  0.0034682750701904297
r_  generation:  0.045248985290527344
local_output_nid generation:  0.003098726272583008
local_in_edges_tensor generation:  0.0017194747924804688
mini_batch_src_global generation:  0.0036156177520751953
r_  generation:  0.047013044357299805
local_output_nid generation:  0.003140687942504883
local_in_edges_tensor generation:  0.001695871353149414
mini_batch_src_global generation:  0.0036907196044921875
r_  generation:  0.04675459861755371
local_output_nid generation:  0.0031027793884277344
local_in_edges_tensor generation:  0.0017251968383789062
mini_batch_src_global generation:  0.003637552261352539
r_  generation:  0.04619479179382324
----------------------check_connections_block total spend ----------------------------- 0.5186550617218018
generate_one_block  0.06137514114379883
generate_one_block  0.061083316802978516
generate_one_block  0.061934709548950195
generate_one_block  0.06132984161376953
generate_one_block  0.06376838684082031
generate_one_block  0.06176114082336426
generate_one_block  0.061318397521972656
generate_one_block  0.06249356269836426
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.040235042572021484
gen group dst list time:  0.01613163948059082
time for parepare:  0.019006013870239258
local_output_nid generation:  0.011130571365356445
local_in_edges_tensor generation:  0.02968430519104004
mini_batch_src_global generation:  0.029894590377807617
r_  generation:  0.31533074378967285
local_output_nid generation:  0.01668548583984375
local_in_edges_tensor generation:  0.028141260147094727
mini_batch_src_global generation:  0.037938833236694336
r_  generation:  0.31949567794799805
local_output_nid generation:  0.01726698875427246
local_in_edges_tensor generation:  0.023300886154174805
mini_batch_src_global generation:  0.0411069393157959
r_  generation:  0.33051109313964844
local_output_nid generation:  0.017557382583618164
local_in_edges_tensor generation:  0.024374961853027344
mini_batch_src_global generation:  0.039174795150756836
r_  generation:  0.3341681957244873
local_output_nid generation:  0.01764988899230957
local_in_edges_tensor generation:  0.01854395866394043
mini_batch_src_global generation:  0.039780378341674805
r_  generation:  0.33150362968444824
local_output_nid generation:  0.017889976501464844
local_in_edges_tensor generation:  0.02167987823486328
mini_batch_src_global generation:  0.04044079780578613
r_  generation:  0.333127498626709
local_output_nid generation:  0.017885684967041016
local_in_edges_tensor generation:  0.02441549301147461
mini_batch_src_global generation:  0.039716482162475586
r_  generation:  0.33100247383117676
local_output_nid generation:  0.017970800399780273
local_in_edges_tensor generation:  0.021995067596435547
mini_batch_src_global generation:  0.04141879081726074
r_  generation:  0.3348088264465332
----------------------check_connections_block total spend ----------------------------- 3.8541812896728516
generate_one_block  0.4363694190979004
generate_one_block  0.4313936233520508
generate_one_block  0.4337759017944336
generate_one_block  0.4401988983154297
generate_one_block  0.42626047134399414
generate_one_block  0.4502382278442383
generate_one_block  0.43856000900268555
generate_one_block  0.43510937690734863
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03227734565734863
gen group dst list time:  0.03605937957763672
time for parepare:  0.01857280731201172
local_output_nid generation:  0.02512049674987793
local_in_edges_tensor generation:  0.04062032699584961
mini_batch_src_global generation:  0.04738020896911621
r_  generation:  0.4733850955963135
local_output_nid generation:  0.032073974609375
local_in_edges_tensor generation:  0.04908609390258789
mini_batch_src_global generation:  0.05367851257324219
r_  generation:  0.4725675582885742
local_output_nid generation:  0.03282427787780762
local_in_edges_tensor generation:  0.04266476631164551
mini_batch_src_global generation:  0.053388118743896484
r_  generation:  0.48691606521606445
local_output_nid generation:  0.03415846824645996
local_in_edges_tensor generation:  0.04715538024902344
mini_batch_src_global generation:  0.08113265037536621
r_  generation:  0.49111461639404297
local_output_nid generation:  0.033403873443603516
local_in_edges_tensor generation:  0.03405618667602539
mini_batch_src_global generation:  0.05338621139526367
r_  generation:  0.4887073040008545
local_output_nid generation:  0.03367948532104492
local_in_edges_tensor generation:  0.03964376449584961
mini_batch_src_global generation:  0.05473446846008301
r_  generation:  0.4885525703430176
local_output_nid generation:  0.0338282585144043
local_in_edges_tensor generation:  0.04029369354248047
mini_batch_src_global generation:  0.053411006927490234
r_  generation:  0.4976663589477539
local_output_nid generation:  0.033902645111083984
local_in_edges_tensor generation:  0.04486870765686035
mini_batch_src_global generation:  0.05432748794555664
r_  generation:  0.4846324920654297
----------------------check_connections_block total spend ----------------------------- 5.831022500991821
generate_one_block  0.6464605331420898
generate_one_block  0.6291360855102539
generate_one_block  0.6169102191925049
generate_one_block  0.6187605857849121
generate_one_block  0.6328310966491699
generate_one_block  0.6048862934112549
generate_one_block  0.6345326900482178
generate_one_block  0.619387149810791
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  9.685203790664673
block generation total time  8.494810581207275
average batch blocks generation time:  1.0618513226509094
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.09805107116699219  GigaBytes
Max Memory Allocated: 0.09805107116699219  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4510498046875 GB
    Memory Allocated: 0.9354310035705566  GigaBytes
Max Memory Allocated: 1.0014586448669434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.10062170028686523  GigaBytes
Max Memory Allocated: 1.075948715209961  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9343380928039551  GigaBytes
Max Memory Allocated: 1.075948715209961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9510498046875 GB
    Memory Allocated: 0.10105323791503906  GigaBytes
Max Memory Allocated: 1.075948715209961  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9510498046875 GB
    Memory Allocated: 0.9375710487365723  GigaBytes
Max Memory Allocated: 1.075948715209961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9510498046875 GB
    Memory Allocated: 0.10016632080078125  GigaBytes
Max Memory Allocated: 1.0780229568481445  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9510498046875 GB
    Memory Allocated: 0.9354243278503418  GigaBytes
Max Memory Allocated: 1.0780229568481445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9510498046875 GB
    Memory Allocated: 0.10083770751953125  GigaBytes
Max Memory Allocated: 1.0780229568481445  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9510498046875 GB
    Memory Allocated: 0.9344496726989746  GigaBytes
Max Memory Allocated: 1.0780229568481445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9510498046875 GB
    Memory Allocated: 0.10090160369873047  GigaBytes
Max Memory Allocated: 1.0780229568481445  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9510498046875 GB
    Memory Allocated: 0.9357037544250488  GigaBytes
Max Memory Allocated: 1.0780229568481445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9510498046875 GB
    Memory Allocated: 0.10059261322021484  GigaBytes
Max Memory Allocated: 1.0780229568481445  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9510498046875 GB
    Memory Allocated: 0.9346671104431152  GigaBytes
Max Memory Allocated: 1.0780229568481445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9510498046875 GB
    Memory Allocated: 0.1009664535522461  GigaBytes
Max Memory Allocated: 1.0780229568481445  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9510498046875 GB
    Memory Allocated: 0.9355010986328125  GigaBytes
Max Memory Allocated: 1.0780229568481445  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07402616739273071 |0.054295361042022705 |0.10014823079109192 |0.00010016560554504395 |0.013033360242843628 |0.003681182861328125 |
----------------------------------------------------------pseudo_mini_loss sum 6.238853454589844
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3020141
Number of first layer input nodes during this epoch:  1287423
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9510498046875 GB
    Memory Allocated: 0.13333988189697266  GigaBytes
Max Memory Allocated: 1.0780229568481445  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02643752098083496
range selection method range initialization spend 0.010980844497680664
time for parepare:  0.01691293716430664
local_output_nid generation:  0.0026361942291259766
local_in_edges_tensor generation:  0.005746126174926758
mini_batch_src_global generation:  0.003797292709350586
r_  generation:  0.04102206230163574
local_output_nid generation:  0.002958059310913086
local_in_edges_tensor generation:  0.0017006397247314453
mini_batch_src_global generation:  0.0046198368072509766
r_  generation:  0.043868303298950195
local_output_nid generation:  0.0030624866485595703
local_in_edges_tensor generation:  0.001791238784790039
mini_batch_src_global generation:  0.003257274627685547
r_  generation:  0.04404497146606445
local_output_nid generation:  0.003122568130493164
local_in_edges_tensor generation:  0.001689910888671875
mini_batch_src_global generation:  0.003327608108520508
r_  generation:  0.04471302032470703
local_output_nid generation:  0.0030870437622070312
local_in_edges_tensor generation:  0.0017206668853759766
mini_batch_src_global generation:  0.0033769607543945312
r_  generation:  0.04491162300109863
local_output_nid generation:  0.003125429153442383
local_in_edges_tensor generation:  0.0017118453979492188
mini_batch_src_global generation:  0.003601551055908203
r_  generation:  0.04647254943847656
local_output_nid generation:  0.0031027793884277344
local_in_edges_tensor generation:  0.0017795562744140625
mini_batch_src_global generation:  0.00365447998046875
r_  generation:  0.04699873924255371
local_output_nid generation:  0.003126382827758789
local_in_edges_tensor generation:  0.0017819404602050781
mini_batch_src_global generation:  0.0035915374755859375
r_  generation:  0.046440839767456055
----------------------check_connections_block total spend ----------------------------- 0.5213696956634521
generate_one_block  0.06483960151672363
generate_one_block  0.06214761734008789
generate_one_block  0.06097698211669922
generate_one_block  0.06037092208862305
generate_one_block  0.061486244201660156
generate_one_block  0.06222271919250488
generate_one_block  0.06540036201477051
generate_one_block  0.06227374076843262
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04063272476196289
gen group dst list time:  0.01791238784790039
time for parepare:  0.022582530975341797
local_output_nid generation:  0.011647224426269531
local_in_edges_tensor generation:  0.058937788009643555
mini_batch_src_global generation:  0.040186166763305664
r_  generation:  0.3272082805633545
local_output_nid generation:  0.018510103225708008
local_in_edges_tensor generation:  0.03126406669616699
mini_batch_src_global generation:  0.0385890007019043
r_  generation:  0.33217692375183105
local_output_nid generation:  0.01769280433654785
local_in_edges_tensor generation:  0.022725820541381836
mini_batch_src_global generation:  0.04381275177001953
r_  generation:  0.32818150520324707
local_output_nid generation:  0.017820358276367188
local_in_edges_tensor generation:  0.025175094604492188
mini_batch_src_global generation:  0.042827606201171875
r_  generation:  0.328718900680542
local_output_nid generation:  0.01836848258972168
local_in_edges_tensor generation:  0.02299642562866211
mini_batch_src_global generation:  0.044747352600097656
r_  generation:  0.33971714973449707
local_output_nid generation:  0.018335342407226562
local_in_edges_tensor generation:  0.02558445930480957
mini_batch_src_global generation:  0.0409395694732666
r_  generation:  0.3370792865753174
local_output_nid generation:  0.018688678741455078
local_in_edges_tensor generation:  0.026442289352416992
mini_batch_src_global generation:  0.04137587547302246
r_  generation:  0.3369140625
local_output_nid generation:  0.01851367950439453
local_in_edges_tensor generation:  0.02616095542907715
mini_batch_src_global generation:  0.04076123237609863
r_  generation:  0.3369476795196533
----------------------check_connections_block total spend ----------------------------- 3.9992518424987793
generate_one_block  0.4498860836029053
generate_one_block  0.43497323989868164
generate_one_block  0.42697668075561523
generate_one_block  0.4304318428039551
generate_one_block  0.4304983615875244
generate_one_block  0.43071675300598145
generate_one_block  0.4385404586791992
generate_one_block  0.46238160133361816
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.043289899826049805
gen group dst list time:  0.03630685806274414
time for parepare:  0.019017457962036133
local_output_nid generation:  0.024592161178588867
local_in_edges_tensor generation:  0.04919242858886719
mini_batch_src_global generation:  0.04698896408081055
r_  generation:  0.4754784107208252
local_output_nid generation:  0.03182721138000488
local_in_edges_tensor generation:  0.04648590087890625
mini_batch_src_global generation:  0.053781986236572266
r_  generation:  0.47722721099853516
local_output_nid generation:  0.03285622596740723
local_in_edges_tensor generation:  0.03593039512634277
mini_batch_src_global generation:  0.05160713195800781
r_  generation:  0.4930853843688965
local_output_nid generation:  0.03306913375854492
local_in_edges_tensor generation:  0.03470444679260254
mini_batch_src_global generation:  0.053153038024902344
r_  generation:  0.48718881607055664
local_output_nid generation:  0.033376216888427734
local_in_edges_tensor generation:  0.04400134086608887
mini_batch_src_global generation:  0.05778932571411133
r_  generation:  0.4969038963317871
local_output_nid generation:  0.03311777114868164
local_in_edges_tensor generation:  0.03166031837463379
mini_batch_src_global generation:  0.0542912483215332
r_  generation:  0.4905686378479004
local_output_nid generation:  0.03375411033630371
local_in_edges_tensor generation:  0.03150796890258789
mini_batch_src_global generation:  0.05346989631652832
r_  generation:  0.5027725696563721
local_output_nid generation:  0.033530473709106445
local_in_edges_tensor generation:  0.0399322509765625
mini_batch_src_global generation:  0.054280757904052734
r_  generation:  0.4943084716796875
----------------------check_connections_block total spend ----------------------------- 5.781935930252075
generate_one_block  0.6109592914581299
generate_one_block  0.6130828857421875
generate_one_block  0.6061549186706543
generate_one_block  0.6153969764709473
generate_one_block  0.6265823841094971
generate_one_block  0.6084294319152832
generate_one_block  0.6382017135620117
generate_one_block  0.6148531436920166
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9510498046875 GB
    Memory Allocated: 0.13333988189697266  GigaBytes
Max Memory Allocated: 1.0780229568481445  GigaBytes

connection checking time:  9.781187772750854
block generation total time  8.438065767288208
average batch blocks generation time:  1.054758220911026
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9510498046875 GB
    Memory Allocated: 0.10251235961914062  GigaBytes
Max Memory Allocated: 1.0780229568481445  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.9395108222961426  GigaBytes
Max Memory Allocated: 1.0780229568481445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.10169219970703125  GigaBytes
Max Memory Allocated: 1.080179214477539  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.9374098777770996  GigaBytes
Max Memory Allocated: 1.080179214477539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.10215044021606445  GigaBytes
Max Memory Allocated: 1.080179214477539  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.9362421035766602  GigaBytes
Max Memory Allocated: 1.080179214477539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.10241460800170898  GigaBytes
Max Memory Allocated: 1.080179214477539  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.9323115348815918  GigaBytes
Max Memory Allocated: 1.080179214477539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.10283660888671875  GigaBytes
Max Memory Allocated: 1.080179214477539  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.9383912086486816  GigaBytes
Max Memory Allocated: 1.080179214477539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.10146856307983398  GigaBytes
Max Memory Allocated: 1.080179214477539  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.9326572418212891  GigaBytes
Max Memory Allocated: 1.080179214477539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.10232210159301758  GigaBytes
Max Memory Allocated: 1.080179214477539  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.9388175010681152  GigaBytes
Max Memory Allocated: 1.080179214477539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.1021575927734375  GigaBytes
Max Memory Allocated: 1.080179214477539  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.9374833106994629  GigaBytes
Max Memory Allocated: 1.080179214477539  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07681456208229065 |0.018853336572647095 |0.0064352452754974365 |9.360909461975098e-05 |0.008472561836242676 |0.0014309883117675781 |
----------------------------------------------------------pseudo_mini_loss sum 3.2276721000671387
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3018408
Number of first layer input nodes during this epoch:  1286552
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.13324308395385742  GigaBytes
Max Memory Allocated: 1.080179214477539  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03139138221740723
range selection method range initialization spend 0.012513875961303711
time for parepare:  0.01737046241760254
local_output_nid generation:  0.00276947021484375
local_in_edges_tensor generation:  0.010287046432495117
mini_batch_src_global generation:  0.0038709640502929688
r_  generation:  0.04234886169433594
local_output_nid generation:  0.0031762123107910156
local_in_edges_tensor generation:  0.0017557144165039062
mini_batch_src_global generation:  0.0047664642333984375
r_  generation:  0.04534649848937988
local_output_nid generation:  0.0030972957611083984
local_in_edges_tensor generation:  0.0017435550689697266
mini_batch_src_global generation:  0.003225088119506836
r_  generation:  0.045569419860839844
local_output_nid generation:  0.0031228065490722656
local_in_edges_tensor generation:  0.0017113685607910156
mini_batch_src_global generation:  0.003350496292114258
r_  generation:  0.04505038261413574
local_output_nid generation:  0.0030813217163085938
local_in_edges_tensor generation:  0.0017595291137695312
mini_batch_src_global generation:  0.003638744354248047
r_  generation:  0.0475311279296875
local_output_nid generation:  0.003205537796020508
local_in_edges_tensor generation:  0.0017881393432617188
mini_batch_src_global generation:  0.0037267208099365234
r_  generation:  0.04811835289001465
local_output_nid generation:  0.003250598907470703
local_in_edges_tensor generation:  0.0018684864044189453
mini_batch_src_global generation:  0.0037484169006347656
r_  generation:  0.04767036437988281
local_output_nid generation:  0.0031266212463378906
local_in_edges_tensor generation:  0.0017366409301757812
mini_batch_src_global generation:  0.003657102584838867
r_  generation:  0.04631352424621582
----------------------check_connections_block total spend ----------------------------- 0.5423026084899902
generate_one_block  0.07623505592346191
generate_one_block  0.061556339263916016
generate_one_block  0.061571598052978516
generate_one_block  0.06028461456298828
generate_one_block  0.06171989440917969
generate_one_block  0.062494754791259766
generate_one_block  0.06423425674438477
generate_one_block  0.060800790786743164
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04444575309753418
gen group dst list time:  0.01592230796813965
time for parepare:  0.018842697143554688
local_output_nid generation:  0.011655807495117188
local_in_edges_tensor generation:  0.03146672248840332
mini_batch_src_global generation:  0.03220248222351074
r_  generation:  0.3181788921356201
local_output_nid generation:  0.01768326759338379
local_in_edges_tensor generation:  0.02448129653930664
mini_batch_src_global generation:  0.0410921573638916
r_  generation:  0.32936930656433105
local_output_nid generation:  0.018079757690429688
local_in_edges_tensor generation:  0.020832061767578125
mini_batch_src_global generation:  0.041298627853393555
r_  generation:  0.3354065418243408
local_output_nid generation:  0.018082141876220703
local_in_edges_tensor generation:  0.021432161331176758
mini_batch_src_global generation:  0.03926539421081543
r_  generation:  0.3323218822479248
local_output_nid generation:  0.01839590072631836
local_in_edges_tensor generation:  0.021509885787963867
mini_batch_src_global generation:  0.040754079818725586
r_  generation:  0.34627532958984375
local_output_nid generation:  0.018152952194213867
local_in_edges_tensor generation:  0.023894071578979492
mini_batch_src_global generation:  0.04339313507080078
r_  generation:  0.3439517021179199
local_output_nid generation:  0.018275022506713867
local_in_edges_tensor generation:  0.02393817901611328
mini_batch_src_global generation:  0.040468454360961914
r_  generation:  0.3361189365386963
local_output_nid generation:  0.018027305603027344
local_in_edges_tensor generation:  0.029874324798583984
mini_batch_src_global generation:  0.0400393009185791
r_  generation:  0.337918758392334
----------------------check_connections_block total spend ----------------------------- 3.9228665828704834
generate_one_block  0.4328320026397705
generate_one_block  0.4404258728027344
generate_one_block  0.4349343776702881
generate_one_block  0.4236438274383545
generate_one_block  0.4347951412200928
generate_one_block  0.43132948875427246
generate_one_block  0.4271817207336426
generate_one_block  0.44725584983825684
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0348358154296875
gen group dst list time:  0.03666543960571289
time for parepare:  0.01996469497680664
local_output_nid generation:  0.025326967239379883
local_in_edges_tensor generation:  0.04427647590637207
mini_batch_src_global generation:  0.04565596580505371
r_  generation:  0.4725344181060791
local_output_nid generation:  0.03278398513793945
local_in_edges_tensor generation:  0.038248538970947266
mini_batch_src_global generation:  0.05427956581115723
r_  generation:  0.4767434597015381
local_output_nid generation:  0.03295159339904785
local_in_edges_tensor generation:  0.034879207611083984
mini_batch_src_global generation:  0.05055880546569824
r_  generation:  0.49432802200317383
local_output_nid generation:  0.03341221809387207
local_in_edges_tensor generation:  0.03413748741149902
mini_batch_src_global generation:  0.053725242614746094
r_  generation:  0.48058581352233887
local_output_nid generation:  0.03349757194519043
local_in_edges_tensor generation:  0.03310513496398926
mini_batch_src_global generation:  0.05187106132507324
r_  generation:  0.49649596214294434
local_output_nid generation:  0.03380632400512695
local_in_edges_tensor generation:  0.03643965721130371
mini_batch_src_global generation:  0.05438661575317383
r_  generation:  0.4899709224700928
local_output_nid generation:  0.033934831619262695
local_in_edges_tensor generation:  0.03517603874206543
mini_batch_src_global generation:  0.05513310432434082
r_  generation:  0.4996495246887207
local_output_nid generation:  0.03427720069885254
local_in_edges_tensor generation:  0.03967857360839844
mini_batch_src_global generation:  0.054175376892089844
r_  generation:  0.4867086410522461
----------------------check_connections_block total spend ----------------------------- 5.74766731262207
generate_one_block  0.6156487464904785
generate_one_block  0.6221139430999756
generate_one_block  0.6074504852294922
generate_one_block  0.6095857620239258
generate_one_block  0.6198258399963379
generate_one_block  0.6285851001739502
generate_one_block  0.6074891090393066
generate_one_block  0.6102361679077148
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.13324308395385742  GigaBytes
Max Memory Allocated: 1.080179214477539  GigaBytes

connection checking time:  9.670533895492554
block generation total time  8.393333435058594
average batch blocks generation time:  1.0491666793823242
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.10251569747924805  GigaBytes
Max Memory Allocated: 1.080179214477539  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.9397644996643066  GigaBytes
Max Memory Allocated: 1.080179214477539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.10175704956054688  GigaBytes
Max Memory Allocated: 1.080453872680664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.938807487487793  GigaBytes
Max Memory Allocated: 1.080453872680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.10223960876464844  GigaBytes
Max Memory Allocated: 1.080453872680664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.9386434555053711  GigaBytes
Max Memory Allocated: 1.080453872680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.10213422775268555  GigaBytes
Max Memory Allocated: 1.080453872680664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.932194709777832  GigaBytes
Max Memory Allocated: 1.080453872680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.10288095474243164  GigaBytes
Max Memory Allocated: 1.080453872680664  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.9453139305114746  GigaBytes
Max Memory Allocated: 1.080453872680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.10175561904907227  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.9393754005432129  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.1021113395690918  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.9357633590698242  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.10237789154052734  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.9314994812011719  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07556608319282532 |0.016011983156204224 |0.008547395467758179 |9.056925773620605e-05 |0.003339529037475586 |0.002834320068359375 |
----------------------------------------------------------pseudo_mini_loss sum 2.6065006256103516
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  3020440
Number of first layer input nodes during this epoch:  1286870
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.13341760635375977  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0253293514251709
range selection method range initialization spend 0.013368606567382812
time for parepare:  0.018195629119873047
local_output_nid generation:  0.002908468246459961
local_in_edges_tensor generation:  0.0040967464447021484
mini_batch_src_global generation:  0.003999948501586914
r_  generation:  0.04179668426513672
local_output_nid generation:  0.003176450729370117
local_in_edges_tensor generation:  0.0019371509552001953
mini_batch_src_global generation:  0.004651784896850586
r_  generation:  0.045801401138305664
local_output_nid generation:  0.003264904022216797
local_in_edges_tensor generation:  0.0018031597137451172
mini_batch_src_global generation:  0.0031633377075195312
r_  generation:  0.04469180107116699
local_output_nid generation:  0.0032660961151123047
local_in_edges_tensor generation:  0.0017802715301513672
mini_batch_src_global generation:  0.003236055374145508
r_  generation:  0.045932769775390625
local_output_nid generation:  0.003264904022216797
local_in_edges_tensor generation:  0.0017986297607421875
mini_batch_src_global generation:  0.0034246444702148438
r_  generation:  0.04741239547729492
local_output_nid generation:  0.0032503604888916016
local_in_edges_tensor generation:  0.0018074512481689453
mini_batch_src_global generation:  0.0037093162536621094
r_  generation:  0.04779839515686035
local_output_nid generation:  0.0032334327697753906
local_in_edges_tensor generation:  0.0017833709716796875
mini_batch_src_global generation:  0.0036187171936035156
r_  generation:  0.04761767387390137
local_output_nid generation:  0.0032227039337158203
local_in_edges_tensor generation:  0.0018308162689208984
mini_batch_src_global generation:  0.003755331039428711
r_  generation:  0.0477755069732666
----------------------check_connections_block total spend ----------------------------- 0.5364794731140137
generate_one_block  0.05922198295593262
generate_one_block  0.06131267547607422
generate_one_block  0.05996346473693848
generate_one_block  0.06052374839782715
generate_one_block  0.06209683418273926
generate_one_block  0.0619809627532959
generate_one_block  0.06480216979980469
generate_one_block  0.061116695404052734
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04642796516418457
gen group dst list time:  0.015470504760742188
time for parepare:  0.01871633529663086
local_output_nid generation:  0.011357784271240234
local_in_edges_tensor generation:  0.02535533905029297
mini_batch_src_global generation:  0.0312957763671875
r_  generation:  0.31623387336730957
local_output_nid generation:  0.017936229705810547
local_in_edges_tensor generation:  0.021516084671020508
mini_batch_src_global generation:  0.03884458541870117
r_  generation:  0.3320035934448242
local_output_nid generation:  0.018337011337280273
local_in_edges_tensor generation:  0.019712448120117188
mini_batch_src_global generation:  0.037856101989746094
r_  generation:  0.32628512382507324
local_output_nid generation:  0.018042325973510742
local_in_edges_tensor generation:  0.019571542739868164
mini_batch_src_global generation:  0.038565635681152344
r_  generation:  0.3282496929168701
local_output_nid generation:  0.018162965774536133
local_in_edges_tensor generation:  0.024037837982177734
mini_batch_src_global generation:  0.04015374183654785
r_  generation:  0.3367950916290283
local_output_nid generation:  0.018424510955810547
local_in_edges_tensor generation:  0.019986391067504883
mini_batch_src_global generation:  0.04226088523864746
r_  generation:  0.3565053939819336
local_output_nid generation:  0.02076435089111328
local_in_edges_tensor generation:  0.019604206085205078
mini_batch_src_global generation:  0.0411074161529541
r_  generation:  0.3391692638397217
local_output_nid generation:  0.018886089324951172
local_in_edges_tensor generation:  0.021097660064697266
mini_batch_src_global generation:  0.04017186164855957
r_  generation:  0.3341081142425537
----------------------check_connections_block total spend ----------------------------- 3.8751440048217773
generate_one_block  0.4211761951446533
generate_one_block  0.43157291412353516
generate_one_block  0.4202909469604492
generate_one_block  0.4258849620819092
generate_one_block  0.429781436920166
generate_one_block  0.43565917015075684
generate_one_block  0.42980265617370605
generate_one_block  0.44892001152038574
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05341982841491699
gen group dst list time:  0.03665804862976074
time for parepare:  0.01944589614868164
local_output_nid generation:  0.026490211486816406
local_in_edges_tensor generation:  0.04136013984680176
mini_batch_src_global generation:  0.043427228927612305
r_  generation:  0.47075915336608887
local_output_nid generation:  0.03204178810119629
local_in_edges_tensor generation:  0.03637886047363281
mini_batch_src_global generation:  0.05601191520690918
r_  generation:  0.4797658920288086
local_output_nid generation:  0.03327775001525879
local_in_edges_tensor generation:  0.032206058502197266
mini_batch_src_global generation:  0.05104875564575195
r_  generation:  0.49052858352661133
local_output_nid generation:  0.033458709716796875
local_in_edges_tensor generation:  0.033185720443725586
mini_batch_src_global generation:  0.055583953857421875
r_  generation:  0.4863917827606201
local_output_nid generation:  0.0337519645690918
local_in_edges_tensor generation:  0.03556323051452637
mini_batch_src_global generation:  0.052974700927734375
r_  generation:  0.49562716484069824
local_output_nid generation:  0.03385734558105469
local_in_edges_tensor generation:  0.03363513946533203
mini_batch_src_global generation:  0.05412697792053223
r_  generation:  0.4870491027832031
local_output_nid generation:  0.03393888473510742
local_in_edges_tensor generation:  0.035660743713378906
mini_batch_src_global generation:  0.05319952964782715
r_  generation:  0.4990828037261963
local_output_nid generation:  0.03398323059082031
local_in_edges_tensor generation:  0.03204011917114258
mini_batch_src_global generation:  0.05419445037841797
r_  generation:  0.488818883895874
----------------------check_connections_block total spend ----------------------------- 5.7308220863342285
generate_one_block  0.6112320423126221
generate_one_block  0.6011924743652344
generate_one_block  0.6056289672851562
generate_one_block  0.6045033931732178
generate_one_block  0.6098151206970215
generate_one_block  0.6183762550354004
generate_one_block  0.6120541095733643
generate_one_block  0.605698823928833
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.13341760635375977  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

connection checking time:  9.605966091156006
block generation total time  8.311589479446411
average batch blocks generation time:  1.0389486849308014
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.10270309448242188  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.935399055480957  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.10265684127807617  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.9385151863098145  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.10149908065795898  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.9341187477111816  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.10207033157348633  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.9351115226745605  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.10273456573486328  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5076904296875 GB
    Memory Allocated: 0.9397749900817871  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1025238037109375  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9387807846069336  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10181760787963867  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9387950897216797  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1020822525024414  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9352898597717285  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07860419154167175 |0.01196599006652832 |0.0037209689617156982 |8.925795555114746e-05 |0.008649080991744995 |0.0017993450164794922 |
----------------------------------------------------------pseudo_mini_loss sum 2.357416868209839
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  3018848
Number of first layer input nodes during this epoch:  1286983
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13286209106445312  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020351171493530273
range selection method range initialization spend 0.012180566787719727
time for parepare:  0.016660451889038086
local_output_nid generation:  0.002679109573364258
local_in_edges_tensor generation:  0.004263877868652344
mini_batch_src_global generation:  0.003930568695068359
r_  generation:  0.04189014434814453
local_output_nid generation:  0.003175497055053711
local_in_edges_tensor generation:  0.0017447471618652344
mini_batch_src_global generation:  0.004794120788574219
r_  generation:  0.04391050338745117
local_output_nid generation:  0.0032279491424560547
local_in_edges_tensor generation:  0.0017704963684082031
mini_batch_src_global generation:  0.003229856491088867
r_  generation:  0.04572010040283203
local_output_nid generation:  0.0032439231872558594
local_in_edges_tensor generation:  0.001810312271118164
mini_batch_src_global generation:  0.0033462047576904297
r_  generation:  0.04632210731506348
local_output_nid generation:  0.0032265186309814453
local_in_edges_tensor generation:  0.001806020736694336
mini_batch_src_global generation:  0.0035772323608398438
r_  generation:  0.04753446578979492
local_output_nid generation:  0.003231048583984375
local_in_edges_tensor generation:  0.0018296241760253906
mini_batch_src_global generation:  0.0037870407104492188
r_  generation:  0.04799675941467285
local_output_nid generation:  0.003244161605834961
local_in_edges_tensor generation:  0.0018799304962158203
mini_batch_src_global generation:  0.0036950111389160156
r_  generation:  0.04751920700073242
local_output_nid generation:  0.0031943321228027344
local_in_edges_tensor generation:  0.0018420219421386719
mini_batch_src_global generation:  0.0036745071411132812
r_  generation:  0.04747200012207031
----------------------check_connections_block total spend ----------------------------- 0.5355937480926514
generate_one_block  0.0594630241394043
generate_one_block  0.06025099754333496
generate_one_block  0.06129288673400879
generate_one_block  0.060404300689697266
generate_one_block  0.06176257133483887
generate_one_block  0.06213521957397461
generate_one_block  0.06434869766235352
generate_one_block  0.06080508232116699
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02912139892578125
gen group dst list time:  0.015320539474487305
time for parepare:  0.01883983612060547
local_output_nid generation:  0.011508703231811523
local_in_edges_tensor generation:  0.02985668182373047
mini_batch_src_global generation:  0.03165888786315918
r_  generation:  0.31500935554504395
local_output_nid generation:  0.017597198486328125
local_in_edges_tensor generation:  0.018747329711914062
mini_batch_src_global generation:  0.03858184814453125
r_  generation:  0.32489752769470215
local_output_nid generation:  0.0186159610748291
local_in_edges_tensor generation:  0.01803302764892578
mini_batch_src_global generation:  0.03912353515625
r_  generation:  0.331864595413208
local_output_nid generation:  0.018093109130859375
local_in_edges_tensor generation:  0.01859569549560547
mini_batch_src_global generation:  0.0393986701965332
r_  generation:  0.33237504959106445
local_output_nid generation:  0.018061399459838867
local_in_edges_tensor generation:  0.01829385757446289
mini_batch_src_global generation:  0.040358543395996094
r_  generation:  0.33689403533935547
local_output_nid generation:  0.0181124210357666
local_in_edges_tensor generation:  0.01973438262939453
mini_batch_src_global generation:  0.04071784019470215
r_  generation:  0.33621835708618164
local_output_nid generation:  0.018182992935180664
local_in_edges_tensor generation:  0.019560575485229492
mini_batch_src_global generation:  0.04052138328552246
r_  generation:  0.34055495262145996
local_output_nid generation:  0.018060684204101562
local_in_edges_tensor generation:  0.018480539321899414
mini_batch_src_global generation:  0.040827274322509766
r_  generation:  0.3373227119445801
----------------------check_connections_block total spend ----------------------------- 3.852121114730835
generate_one_block  0.4254720211029053
generate_one_block  0.4198627471923828
generate_one_block  0.4226064682006836
generate_one_block  0.42664456367492676
generate_one_block  0.42722392082214355
generate_one_block  0.4249558448791504
generate_one_block  0.4254136085510254
generate_one_block  0.4447159767150879
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.027043581008911133
gen group dst list time:  0.03688979148864746
time for parepare:  0.017873287200927734
local_output_nid generation:  0.025982379913330078
local_in_edges_tensor generation:  0.035601139068603516
mini_batch_src_global generation:  0.04369091987609863
r_  generation:  0.4770355224609375
local_output_nid generation:  0.032944440841674805
local_in_edges_tensor generation:  0.03395247459411621
mini_batch_src_global generation:  0.0544893741607666
r_  generation:  0.47745466232299805
local_output_nid generation:  0.03325009346008301
local_in_edges_tensor generation:  0.03289341926574707
mini_batch_src_global generation:  0.051030874252319336
r_  generation:  0.49183082580566406
local_output_nid generation:  0.03374910354614258
local_in_edges_tensor generation:  0.03383755683898926
mini_batch_src_global generation:  0.05386543273925781
r_  generation:  0.49155449867248535
local_output_nid generation:  0.033597707748413086
local_in_edges_tensor generation:  0.03165936470031738
mini_batch_src_global generation:  0.052848100662231445
r_  generation:  0.5009541511535645
local_output_nid generation:  0.03393983840942383
local_in_edges_tensor generation:  0.031243085861206055
mini_batch_src_global generation:  0.07789921760559082
r_  generation:  0.48532772064208984
local_output_nid generation:  0.034084320068359375
local_in_edges_tensor generation:  0.03129315376281738
mini_batch_src_global generation:  0.05453896522521973
r_  generation:  0.5011658668518066
local_output_nid generation:  0.03413128852844238
local_in_edges_tensor generation:  0.03232121467590332
mini_batch_src_global generation:  0.055970191955566406
r_  generation:  0.48619532585144043
----------------------check_connections_block total spend ----------------------------- 5.7581987380981445
generate_one_block  0.6082251071929932
generate_one_block  0.6075804233551025
generate_one_block  0.6197633743286133
generate_one_block  0.6096584796905518
generate_one_block  0.6052322387695312
generate_one_block  0.6069221496582031
generate_one_block  0.6131613254547119
generate_one_block  0.6115553379058838
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13286209106445312  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

connection checking time:  9.61031985282898
block generation total time  8.298993587493896
average batch blocks generation time:  1.037374198436737
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1027231216430664  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9375114440917969  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10212373733520508  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9359211921691895  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1026163101196289  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9372496604919434  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10237312316894531  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9368596076965332  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1026606559753418  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9384927749633789  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10183477401733398  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9394040107727051  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10232925415039062  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9383058547973633  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10230684280395508  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9357061386108398  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0832805335521698 |0.01438981294631958 |0.0034921765327453613 |8.636713027954102e-05 |0.0037370622158050537 |0.002664804458618164 |
----------------------------------------------------------pseudo_mini_loss sum 2.1027274131774902
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  3020975
Number of first layer input nodes during this epoch:  1287573
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13369274139404297  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021167993545532227
range selection method range initialization spend 0.013083696365356445
time for parepare:  0.015429496765136719
local_output_nid generation:  0.0026416778564453125
local_in_edges_tensor generation:  0.004126548767089844
mini_batch_src_global generation:  0.003710508346557617
r_  generation:  0.04142475128173828
local_output_nid generation:  0.0031049251556396484
local_in_edges_tensor generation:  0.00171661376953125
mini_batch_src_global generation:  0.004888057708740234
r_  generation:  0.04575538635253906
local_output_nid generation:  0.00315093994140625
local_in_edges_tensor generation:  0.0017349720001220703
mini_batch_src_global generation:  0.003242015838623047
r_  generation:  0.045319557189941406
local_output_nid generation:  0.0031430721282958984
local_in_edges_tensor generation:  0.0017426013946533203
mini_batch_src_global generation:  0.0034186840057373047
r_  generation:  0.04703354835510254
local_output_nid generation:  0.0032052993774414062
local_in_edges_tensor generation:  0.0018436908721923828
mini_batch_src_global generation:  0.003579378128051758
r_  generation:  0.04682350158691406
local_output_nid generation:  0.0032126903533935547
local_in_edges_tensor generation:  0.0017688274383544922
mini_batch_src_global generation:  0.0037114620208740234
r_  generation:  0.04761314392089844
local_output_nid generation:  0.003245830535888672
local_in_edges_tensor generation:  0.0017905235290527344
mini_batch_src_global generation:  0.0036725997924804688
r_  generation:  0.04684185981750488
local_output_nid generation:  0.003244638442993164
local_in_edges_tensor generation:  0.0018374919891357422
mini_batch_src_global generation:  0.0037529468536376953
r_  generation:  0.04784822463989258
----------------------check_connections_block total spend ----------------------------- 0.5337920188903809
generate_one_block  0.0590360164642334
generate_one_block  0.06219029426574707
generate_one_block  0.06177258491516113
generate_one_block  0.0623779296875
generate_one_block  0.06051135063171387
generate_one_block  0.061219215393066406
generate_one_block  0.0631113052368164
generate_one_block  0.06174898147583008
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.035951852798461914
gen group dst list time:  0.015216827392578125
time for parepare:  0.01899862289428711
local_output_nid generation:  0.011453628540039062
local_in_edges_tensor generation:  0.0235748291015625
mini_batch_src_global generation:  0.03134727478027344
r_  generation:  0.31301188468933105
local_output_nid generation:  0.017869234085083008
local_in_edges_tensor generation:  0.020932674407958984
mini_batch_src_global generation:  0.039206743240356445
r_  generation:  0.3408482074737549
local_output_nid generation:  0.018706083297729492
local_in_edges_tensor generation:  0.019545555114746094
mini_batch_src_global generation:  0.04022955894470215
r_  generation:  0.3349156379699707
local_output_nid generation:  0.018344402313232422
local_in_edges_tensor generation:  0.018424272537231445
mini_batch_src_global generation:  0.039771080017089844
r_  generation:  0.33246779441833496
local_output_nid generation:  0.018749713897705078
local_in_edges_tensor generation:  0.02030658721923828
mini_batch_src_global generation:  0.0400393009185791
r_  generation:  0.3354074954986572
local_output_nid generation:  0.01822948455810547
local_in_edges_tensor generation:  0.01819467544555664
mini_batch_src_global generation:  0.0404818058013916
r_  generation:  0.33304715156555176
local_output_nid generation:  0.01823735237121582
local_in_edges_tensor generation:  0.018367528915405273
mini_batch_src_global generation:  0.03990530967712402
r_  generation:  0.3364396095275879
local_output_nid generation:  0.018352508544921875
local_in_edges_tensor generation:  0.021541595458984375
mini_batch_src_global generation:  0.04080343246459961
r_  generation:  0.34180283546447754
----------------------check_connections_block total spend ----------------------------- 3.8658862113952637
generate_one_block  0.42316651344299316
generate_one_block  0.4334883689880371
generate_one_block  0.4339120388031006
generate_one_block  0.43484973907470703
generate_one_block  0.4252793788909912
generate_one_block  0.4246516227722168
generate_one_block  0.4241006374359131
generate_one_block  0.4525911808013916
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.032199859619140625
gen group dst list time:  0.03677630424499512
time for parepare:  0.018704652786254883
local_output_nid generation:  0.025444984436035156
local_in_edges_tensor generation:  0.03798103332519531
mini_batch_src_global generation:  0.04528546333312988
r_  generation:  0.47617197036743164
local_output_nid generation:  0.03281211853027344
local_in_edges_tensor generation:  0.03626394271850586
mini_batch_src_global generation:  0.055791616439819336
r_  generation:  0.481447696685791
local_output_nid generation:  0.03343963623046875
local_in_edges_tensor generation:  0.037001609802246094
mini_batch_src_global generation:  0.05313992500305176
r_  generation:  0.49063897132873535
local_output_nid generation:  0.033583879470825195
local_in_edges_tensor generation:  0.031450748443603516
mini_batch_src_global generation:  0.05335664749145508
r_  generation:  0.5022766590118408
local_output_nid generation:  0.03453874588012695
local_in_edges_tensor generation:  0.031588077545166016
mini_batch_src_global generation:  0.05399894714355469
r_  generation:  0.49567103385925293
local_output_nid generation:  0.034163475036621094
local_in_edges_tensor generation:  0.031246662139892578
mini_batch_src_global generation:  0.05464458465576172
r_  generation:  0.48970627784729004
local_output_nid generation:  0.03392481803894043
local_in_edges_tensor generation:  0.031134605407714844
mini_batch_src_global generation:  0.053504228591918945
r_  generation:  0.4972035884857178
local_output_nid generation:  0.03413987159729004
local_in_edges_tensor generation:  0.037389278411865234
mini_batch_src_global generation:  0.062270164489746094
r_  generation:  0.49211573600769043
----------------------check_connections_block total spend ----------------------------- 5.7668540477752686
generate_one_block  0.6028304100036621
generate_one_block  0.606673002243042
generate_one_block  0.6211197376251221
generate_one_block  0.604459285736084
generate_one_block  0.6087331771850586
generate_one_block  0.606464147567749
generate_one_block  0.6065661907196045
generate_one_block  0.610466718673706
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13369274139404297  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

connection checking time:  9.632740259170532
block generation total time  8.319352149963379
average batch blocks generation time:  1.0399190187454224
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10291099548339844  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9352536201477051  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10277032852172852  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9406824111938477  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10195255279541016  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9412679672241211  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10217142105102539  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9367465972900391  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10248565673828125  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9365386962890625  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10261678695678711  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9357233047485352  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10227727890014648  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9324231147766113  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10283565521240234  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.937680721282959  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0853184163570404 |0.012547612190246582 |0.0035776495933532715 |8.979439735412598e-05 |0.0037454068660736084 |0.0013353824615478516 |
----------------------------------------------------------pseudo_mini_loss sum 1.9527831077575684
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  3019894
Number of first layer input nodes during this epoch:  1287351
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1332416534423828  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022007465362548828
range selection method range initialization spend 0.012089967727661133
time for parepare:  0.016211986541748047
local_output_nid generation:  0.002753019332885742
local_in_edges_tensor generation:  0.005771636962890625
mini_batch_src_global generation:  0.0036818981170654297
r_  generation:  0.042322397232055664
local_output_nid generation:  0.003259897232055664
local_in_edges_tensor generation:  0.001773834228515625
mini_batch_src_global generation:  0.0073394775390625
r_  generation:  0.044339895248413086
local_output_nid generation:  0.0032553672790527344
local_in_edges_tensor generation:  0.0017673969268798828
mini_batch_src_global generation:  0.003353118896484375
r_  generation:  0.044983625411987305
local_output_nid generation:  0.003287792205810547
local_in_edges_tensor generation:  0.0018298625946044922
mini_batch_src_global generation:  0.0034334659576416016
r_  generation:  0.04619932174682617
local_output_nid generation:  0.003245830535888672
local_in_edges_tensor generation:  0.0018246173858642578
mini_batch_src_global generation:  0.0036432743072509766
r_  generation:  0.04646873474121094
local_output_nid generation:  0.0032668113708496094
local_in_edges_tensor generation:  0.0018107891082763672
mini_batch_src_global generation:  0.0038034915924072266
r_  generation:  0.048084259033203125
local_output_nid generation:  0.0032515525817871094
local_in_edges_tensor generation:  0.001842498779296875
mini_batch_src_global generation:  0.003856658935546875
r_  generation:  0.04764366149902344
local_output_nid generation:  0.0032329559326171875
local_in_edges_tensor generation:  0.0018112659454345703
mini_batch_src_global generation:  0.003746509552001953
r_  generation:  0.04820728302001953
----------------------check_connections_block total spend ----------------------------- 0.5442116260528564
generate_one_block  0.06431031227111816
generate_one_block  0.061263084411621094
generate_one_block  0.06082558631896973
generate_one_block  0.061745405197143555
generate_one_block  0.061418771743774414
generate_one_block  0.06274271011352539
generate_one_block  0.06513094902038574
generate_one_block  0.06195831298828125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03369593620300293
gen group dst list time:  0.015515804290771484
time for parepare:  0.018913984298706055
local_output_nid generation:  0.011579275131225586
local_in_edges_tensor generation:  0.024293184280395508
mini_batch_src_global generation:  0.033997297286987305
r_  generation:  0.3181629180908203
local_output_nid generation:  0.018521547317504883
local_in_edges_tensor generation:  0.019100427627563477
mini_batch_src_global generation:  0.039067745208740234
r_  generation:  0.32710933685302734
local_output_nid generation:  0.01904153823852539
local_in_edges_tensor generation:  0.018302440643310547
mini_batch_src_global generation:  0.03805255889892578
r_  generation:  0.33047962188720703
local_output_nid generation:  0.01900196075439453
local_in_edges_tensor generation:  0.01814746856689453
mini_batch_src_global generation:  0.0390477180480957
r_  generation:  0.3347012996673584
local_output_nid generation:  0.019266843795776367
local_in_edges_tensor generation:  0.01936030387878418
mini_batch_src_global generation:  0.039713144302368164
r_  generation:  0.3378565311431885
local_output_nid generation:  0.01849675178527832
local_in_edges_tensor generation:  0.019046545028686523
mini_batch_src_global generation:  0.044014692306518555
r_  generation:  0.33871912956237793
local_output_nid generation:  0.01946878433227539
local_in_edges_tensor generation:  0.023378849029541016
mini_batch_src_global generation:  0.04100298881530762
r_  generation:  0.34090352058410645
local_output_nid generation:  0.018936872482299805
local_in_edges_tensor generation:  0.02677464485168457
mini_batch_src_global generation:  0.04001331329345703
r_  generation:  0.3371560573577881
----------------------check_connections_block total spend ----------------------------- 3.877890110015869
generate_one_block  0.42757081985473633
generate_one_block  0.4375019073486328
generate_one_block  0.427004337310791
generate_one_block  0.43414759635925293
generate_one_block  0.4265303611755371
generate_one_block  0.42938661575317383
generate_one_block  0.430145263671875
generate_one_block  0.4512667655944824
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02881312370300293
gen group dst list time:  0.03731942176818848
time for parepare:  0.018634319305419922
local_output_nid generation:  0.02567577362060547
local_in_edges_tensor generation:  0.042571306228637695
mini_batch_src_global generation:  0.04291868209838867
r_  generation:  0.4767146110534668
local_output_nid generation:  0.03370261192321777
local_in_edges_tensor generation:  0.038748741149902344
mini_batch_src_global generation:  0.05345296859741211
r_  generation:  0.47864818572998047
local_output_nid generation:  0.03407478332519531
local_in_edges_tensor generation:  0.036232948303222656
mini_batch_src_global generation:  0.05090594291687012
r_  generation:  0.4903373718261719
local_output_nid generation:  0.03335714340209961
local_in_edges_tensor generation:  0.033853769302368164
mini_batch_src_global generation:  0.05508732795715332
r_  generation:  0.48707151412963867
local_output_nid generation:  0.03409147262573242
local_in_edges_tensor generation:  0.03742098808288574
mini_batch_src_global generation:  0.0539088249206543
r_  generation:  0.495800256729126
local_output_nid generation:  0.03377270698547363
local_in_edges_tensor generation:  0.032644033432006836
mini_batch_src_global generation:  0.054147958755493164
r_  generation:  0.485750675201416
local_output_nid generation:  0.033907413482666016
local_in_edges_tensor generation:  0.03584718704223633
mini_batch_src_global generation:  0.05562710762023926
r_  generation:  0.4972860813140869
local_output_nid generation:  0.03955197334289551
local_in_edges_tensor generation:  0.03345298767089844
mini_batch_src_global generation:  0.06695961952209473
r_  generation:  0.48859500885009766
----------------------check_connections_block total spend ----------------------------- 5.768997669219971
generate_one_block  0.6048271656036377
generate_one_block  0.6069505214691162
generate_one_block  0.6072998046875
generate_one_block  0.6189966201782227
generate_one_block  0.6058433055877686
generate_one_block  0.6062102317810059
generate_one_block  0.6218297481536865
generate_one_block  0.6212959289550781
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1332416534423828  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

connection checking time:  9.64688777923584
block generation total time  8.356806993484497
average batch blocks generation time:  1.0446008741855621
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10239505767822266  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9381351470947266  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.102325439453125  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9378809928894043  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10245132446289062  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9374942779541016  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10256576538085938  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9371328353881836  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10229635238647461  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9324321746826172  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10269641876220703  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9373879432678223  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10246515274047852  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9382190704345703  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1023721694946289  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9384169578552246  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08395057916641235 |0.013203144073486328 |0.0035448968410491943 |8.845329284667969e-05 |0.003719836473464966 |0.0012843608856201172 |
----------------------------------------------------------pseudo_mini_loss sum 1.864753246307373
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  3021869
Number of first layer input nodes during this epoch:  1288104
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13328933715820312  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0250241756439209
range selection method range initialization spend 0.011964559555053711
time for parepare:  0.01627326011657715
local_output_nid generation:  0.0027437210083007812
local_in_edges_tensor generation:  0.0050106048583984375
mini_batch_src_global generation:  0.0037055015563964844
r_  generation:  0.0420384407043457
local_output_nid generation:  0.003222227096557617
local_in_edges_tensor generation:  0.0018084049224853516
mini_batch_src_global generation:  0.0046269893646240234
r_  generation:  0.04335379600524902
local_output_nid generation:  0.0031957626342773438
local_in_edges_tensor generation:  0.0017955303192138672
mini_batch_src_global generation:  0.0031757354736328125
r_  generation:  0.04491853713989258
local_output_nid generation:  0.0032227039337158203
local_in_edges_tensor generation:  0.0017986297607421875
mini_batch_src_global generation:  0.0033125877380371094
r_  generation:  0.04667067527770996
local_output_nid generation:  0.0032019615173339844
local_in_edges_tensor generation:  0.0018241405487060547
mini_batch_src_global generation:  0.0036029815673828125
r_  generation:  0.04745841026306152
local_output_nid generation:  0.003191232681274414
local_in_edges_tensor generation:  0.0017709732055664062
mini_batch_src_global generation:  0.0037245750427246094
r_  generation:  0.048165082931518555
local_output_nid generation:  0.003214597702026367
local_in_edges_tensor generation:  0.0018537044525146484
mini_batch_src_global generation:  0.0037941932678222656
r_  generation:  0.04828906059265137
local_output_nid generation:  0.0032210350036621094
local_in_edges_tensor generation:  0.0018672943115234375
mini_batch_src_global generation:  0.003809690475463867
r_  generation:  0.04804587364196777
----------------------check_connections_block total spend ----------------------------- 0.537236213684082
generate_one_block  0.05934596061706543
generate_one_block  0.06022906303405762
generate_one_block  0.06038856506347656
generate_one_block  0.06166577339172363
generate_one_block  0.0629730224609375
generate_one_block  0.062406063079833984
generate_one_block  0.06499910354614258
generate_one_block  0.0695502758026123
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04135608673095703
gen group dst list time:  0.015679121017456055
time for parepare:  0.018922805786132812
local_output_nid generation:  0.011525630950927734
local_in_edges_tensor generation:  0.02601933479309082
mini_batch_src_global generation:  0.03165864944458008
r_  generation:  0.3137969970703125
local_output_nid generation:  0.017603397369384766
local_in_edges_tensor generation:  0.023213624954223633
mini_batch_src_global generation:  0.039495229721069336
r_  generation:  0.32577991485595703
local_output_nid generation:  0.018300294876098633
local_in_edges_tensor generation:  0.01917576789855957
mini_batch_src_global generation:  0.037938594818115234
r_  generation:  0.32866597175598145
local_output_nid generation:  0.018606185913085938
local_in_edges_tensor generation:  0.018206357955932617
mini_batch_src_global generation:  0.04046893119812012
r_  generation:  0.33172011375427246
local_output_nid generation:  0.0188753604888916
local_in_edges_tensor generation:  0.018492460250854492
mini_batch_src_global generation:  0.040387868881225586
r_  generation:  0.3389320373535156
local_output_nid generation:  0.018203258514404297
local_in_edges_tensor generation:  0.018696308135986328
mini_batch_src_global generation:  0.04313063621520996
r_  generation:  0.34075188636779785
local_output_nid generation:  0.018370389938354492
local_in_edges_tensor generation:  0.01883721351623535
mini_batch_src_global generation:  0.04052233695983887
r_  generation:  0.33904147148132324
local_output_nid generation:  0.018350839614868164
local_in_edges_tensor generation:  0.020170211791992188
mini_batch_src_global generation:  0.04231739044189453
r_  generation:  0.34033870697021484
----------------------check_connections_block total spend ----------------------------- 3.8623406887054443
generate_one_block  0.42182374000549316
generate_one_block  0.4207019805908203
generate_one_block  0.42452239990234375
generate_one_block  0.42850637435913086
generate_one_block  0.43202733993530273
generate_one_block  0.43462300300598145
generate_one_block  0.43157529830932617
generate_one_block  0.45100951194763184
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02954697608947754
gen group dst list time:  0.03747820854187012
time for parepare:  0.019598960876464844
local_output_nid generation:  0.026194095611572266
local_in_edges_tensor generation:  0.03740859031677246
mini_batch_src_global generation:  0.04328155517578125
r_  generation:  0.4689006805419922
local_output_nid generation:  0.03217625617980957
local_in_edges_tensor generation:  0.033501386642456055
mini_batch_src_global generation:  0.055657148361206055
r_  generation:  0.47786498069763184
local_output_nid generation:  0.03312182426452637
local_in_edges_tensor generation:  0.032700538635253906
mini_batch_src_global generation:  0.05062389373779297
r_  generation:  0.4874420166015625
local_output_nid generation:  0.03380632400512695
local_in_edges_tensor generation:  0.033574819564819336
mini_batch_src_global generation:  0.05364632606506348
r_  generation:  0.4853806495666504
local_output_nid generation:  0.03412580490112305
local_in_edges_tensor generation:  0.034036874771118164
mini_batch_src_global generation:  0.05217432975769043
r_  generation:  0.49785852432250977
local_output_nid generation:  0.034255027770996094
local_in_edges_tensor generation:  0.03395652770996094
mini_batch_src_global generation:  0.054527997970581055
r_  generation:  0.487720251083374
local_output_nid generation:  0.03450751304626465
local_in_edges_tensor generation:  0.039246320724487305
mini_batch_src_global generation:  0.055054664611816406
r_  generation:  0.4993739128112793
local_output_nid generation:  0.03417396545410156
local_in_edges_tensor generation:  0.03169512748718262
mini_batch_src_global generation:  0.05498170852661133
r_  generation:  0.49184751510620117
----------------------check_connections_block total spend ----------------------------- 5.737296104431152
generate_one_block  0.6036975383758545
generate_one_block  0.6094498634338379
generate_one_block  0.606107234954834
generate_one_block  0.6084465980529785
generate_one_block  0.6082909107208252
generate_one_block  0.6095218658447266
generate_one_block  0.610184907913208
generate_one_block  0.6177635192871094
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13328933715820312  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

connection checking time:  9.599636793136597
block generation total time  8.318252086639404
average batch blocks generation time:  1.0397815108299255
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1023554801940918  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9373817443847656  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10238838195800781  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9325952529907227  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10259294509887695  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9346799850463867  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10260200500488281  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.937159538269043  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10248851776123047  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9381132125854492  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10224771499633789  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9391922950744629  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10178184509277344  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9409289360046387  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1022944450378418  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9372701644897461  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08175143599510193 |0.01635599136352539 |0.003544420003890991 |8.863210678100586e-05 |0.0037741661071777344 |0.0015406608581542969 |
----------------------------------------------------------pseudo_mini_loss sum 1.7914814949035645
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  3020171
Number of first layer input nodes during this epoch:  1287115
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13295745849609375  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020824909210205078
range selection method range initialization spend 0.012250900268554688
time for parepare:  0.01658320426940918
local_output_nid generation:  0.002786874771118164
local_in_edges_tensor generation:  0.00405573844909668
mini_batch_src_global generation:  0.0034477710723876953
r_  generation:  0.04269123077392578
local_output_nid generation:  0.0032532215118408203
local_in_edges_tensor generation:  0.0018019676208496094
mini_batch_src_global generation:  0.0047512054443359375
r_  generation:  0.043979644775390625
local_output_nid generation:  0.003290891647338867
local_in_edges_tensor generation:  0.001764535903930664
mini_batch_src_global generation:  0.0033180713653564453
r_  generation:  0.04589486122131348
local_output_nid generation:  0.003263235092163086
local_in_edges_tensor generation:  0.0017774105072021484
mini_batch_src_global generation:  0.0033240318298339844
r_  generation:  0.04691958427429199
local_output_nid generation:  0.0032312870025634766
local_in_edges_tensor generation:  0.0018298625946044922
mini_batch_src_global generation:  0.0036170482635498047
r_  generation:  0.04660367965698242
local_output_nid generation:  0.003213644027709961
local_in_edges_tensor generation:  0.0017910003662109375
mini_batch_src_global generation:  0.0036742687225341797
r_  generation:  0.04732346534729004
local_output_nid generation:  0.0032029151916503906
local_in_edges_tensor generation:  0.001783132553100586
mini_batch_src_global generation:  0.0037772655487060547
r_  generation:  0.04762864112854004
local_output_nid generation:  0.003217935562133789
local_in_edges_tensor generation:  0.0018389225006103516
mini_batch_src_global generation:  0.0038743019104003906
r_  generation:  0.048482418060302734
----------------------check_connections_block total spend ----------------------------- 0.5374875068664551
generate_one_block  0.05951952934265137
generate_one_block  0.06018972396850586
generate_one_block  0.06278538703918457
generate_one_block  0.061662912368774414
generate_one_block  0.060861825942993164
generate_one_block  0.06217312812805176
generate_one_block  0.0662848949432373
generate_one_block  0.062464237213134766
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03758955001831055
gen group dst list time:  0.016721487045288086
time for parepare:  0.019089460372924805
local_output_nid generation:  0.01139211654663086
local_in_edges_tensor generation:  0.031434059143066406
mini_batch_src_global generation:  0.03146052360534668
r_  generation:  0.3134193420410156
local_output_nid generation:  0.0177309513092041
local_in_edges_tensor generation:  0.021676063537597656
mini_batch_src_global generation:  0.03814125061035156
r_  generation:  0.3225979804992676
local_output_nid generation:  0.018785715103149414
local_in_edges_tensor generation:  0.020122766494750977
mini_batch_src_global generation:  0.03873586654663086
r_  generation:  0.3372523784637451
local_output_nid generation:  0.018836259841918945
local_in_edges_tensor generation:  0.01898360252380371
mini_batch_src_global generation:  0.039542436599731445
r_  generation:  0.33509230613708496
local_output_nid generation:  0.019076824188232422
local_in_edges_tensor generation:  0.02037835121154785
mini_batch_src_global generation:  0.04150271415710449
r_  generation:  0.3360564708709717
local_output_nid generation:  0.018237590789794922
local_in_edges_tensor generation:  0.019251108169555664
mini_batch_src_global generation:  0.0420985221862793
r_  generation:  0.3406093120574951
local_output_nid generation:  0.01816248893737793
local_in_edges_tensor generation:  0.020815372467041016
mini_batch_src_global generation:  0.04070544242858887
r_  generation:  0.3374502658843994
local_output_nid generation:  0.018561601638793945
local_in_edges_tensor generation:  0.020973920822143555
mini_batch_src_global generation:  0.04155111312866211
r_  generation:  0.34403467178344727
----------------------check_connections_block total spend ----------------------------- 3.8800816535949707
generate_one_block  0.4298083782196045
generate_one_block  0.42069482803344727
generate_one_block  0.4338042736053467
generate_one_block  0.42953991889953613
generate_one_block  0.4235663414001465
generate_one_block  0.4303417205810547
generate_one_block  0.4315071105957031
generate_one_block  0.46059513092041016
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029689550399780273
gen group dst list time:  0.03709125518798828
time for parepare:  0.019315719604492188
local_output_nid generation:  0.025771379470825195
local_in_edges_tensor generation:  0.037209510803222656
mini_batch_src_global generation:  0.042778968811035156
r_  generation:  0.46983981132507324
local_output_nid generation:  0.03256845474243164
local_in_edges_tensor generation:  0.03768730163574219
mini_batch_src_global generation:  0.0531916618347168
r_  generation:  0.47641658782958984
local_output_nid generation:  0.03347635269165039
local_in_edges_tensor generation:  0.037094831466674805
mini_batch_src_global generation:  0.050200462341308594
r_  generation:  0.48742246627807617
local_output_nid generation:  0.03366494178771973
local_in_edges_tensor generation:  0.034357309341430664
mini_batch_src_global generation:  0.05330514907836914
r_  generation:  0.48325467109680176
local_output_nid generation:  0.03396153450012207
local_in_edges_tensor generation:  0.03303265571594238
mini_batch_src_global generation:  0.0526425838470459
r_  generation:  0.49447202682495117
local_output_nid generation:  0.03393745422363281
local_in_edges_tensor generation:  0.035584211349487305
mini_batch_src_global generation:  0.05370616912841797
r_  generation:  0.48538684844970703
local_output_nid generation:  0.03385162353515625
local_in_edges_tensor generation:  0.03499865531921387
mini_batch_src_global generation:  0.0527191162109375
r_  generation:  0.4960322380065918
local_output_nid generation:  0.0339818000793457
local_in_edges_tensor generation:  0.0383601188659668
mini_batch_src_global generation:  0.05840635299682617
r_  generation:  0.4899275302886963
----------------------check_connections_block total spend ----------------------------- 5.720696449279785
generate_one_block  0.6052825450897217
generate_one_block  0.6022403240203857
generate_one_block  0.6049752235412598
generate_one_block  0.6028203964233398
generate_one_block  0.6127655506134033
generate_one_block  0.6088128089904785
generate_one_block  0.6070246696472168
generate_one_block  0.6120119094848633
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13295745849609375  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

connection checking time:  9.600778102874756
block generation total time  8.315791130065918
average batch blocks generation time:  1.0394738912582397
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10231781005859375  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9356536865234375  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10242605209350586  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9331569671630859  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10287952423095703  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9400291442871094  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10170841217041016  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9368762969970703  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10240364074707031  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9359159469604492  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10265779495239258  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9384493827819824  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10172796249389648  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9366612434387207  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10272789001464844  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9415054321289062  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07951951026916504 |0.014343023300170898 |0.00351598858833313 |9.02414321899414e-05 |0.003117173910140991 |0.001417398452758789 |
----------------------------------------------------------pseudo_mini_loss sum 1.7024165391921997
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  3019715
Number of first layer input nodes during this epoch:  1286968
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13338470458984375  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023606300354003906
range selection method range initialization spend 0.011825799942016602
time for parepare:  0.015989065170288086
local_output_nid generation:  0.002704143524169922
local_in_edges_tensor generation:  0.004290103912353516
mini_batch_src_global generation:  0.003677845001220703
r_  generation:  0.04177522659301758
local_output_nid generation:  0.003098011016845703
local_in_edges_tensor generation:  0.0017685890197753906
mini_batch_src_global generation:  0.004815340042114258
r_  generation:  0.04485726356506348
local_output_nid generation:  0.0031859874725341797
local_in_edges_tensor generation:  0.0017750263214111328
mini_batch_src_global generation:  0.003233671188354492
r_  generation:  0.04581928253173828
local_output_nid generation:  0.0032088756561279297
local_in_edges_tensor generation:  0.0018312931060791016
mini_batch_src_global generation:  0.0033791065216064453
r_  generation:  0.046381235122680664
local_output_nid generation:  0.0032033920288085938
local_in_edges_tensor generation:  0.0018405914306640625
mini_batch_src_global generation:  0.0034322738647460938
r_  generation:  0.04694056510925293
local_output_nid generation:  0.003186464309692383
local_in_edges_tensor generation:  0.0018091201782226562
mini_batch_src_global generation:  0.0037055015563964844
r_  generation:  0.047496795654296875
local_output_nid generation:  0.003212451934814453
local_in_edges_tensor generation:  0.0017936229705810547
mini_batch_src_global generation:  0.003708362579345703
r_  generation:  0.0475306510925293
local_output_nid generation:  0.003193378448486328
local_in_edges_tensor generation:  0.0018033981323242188
mini_batch_src_global generation:  0.0037720203399658203
r_  generation:  0.04798531532287598
----------------------check_connections_block total spend ----------------------------- 0.5346753597259521
generate_one_block  0.05860018730163574
generate_one_block  0.06140923500061035
generate_one_block  0.06164121627807617
generate_one_block  0.0613245964050293
generate_one_block  0.060700416564941406
generate_one_block  0.061905860900878906
generate_one_block  0.06390190124511719
generate_one_block  0.06261301040649414
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02734971046447754
gen group dst list time:  0.015878677368164062
time for parepare:  0.018970251083374023
local_output_nid generation:  0.011542797088623047
local_in_edges_tensor generation:  0.031650543212890625
mini_batch_src_global generation:  0.045900583267211914
r_  generation:  0.3203408718109131
local_output_nid generation:  0.017915725708007812
local_in_edges_tensor generation:  0.023270368576049805
mini_batch_src_global generation:  0.042388916015625
r_  generation:  0.32787179946899414
local_output_nid generation:  0.018822669982910156
local_in_edges_tensor generation:  0.022182226181030273
mini_batch_src_global generation:  0.045212507247924805
r_  generation:  0.3327827453613281
local_output_nid generation:  0.019338369369506836
local_in_edges_tensor generation:  0.019763946533203125
mini_batch_src_global generation:  0.039679527282714844
r_  generation:  0.33289122581481934
local_output_nid generation:  0.020412921905517578
local_in_edges_tensor generation:  0.019817590713500977
mini_batch_src_global generation:  0.040831565856933594
r_  generation:  0.33591794967651367
local_output_nid generation:  0.01884913444519043
local_in_edges_tensor generation:  0.020512819290161133
mini_batch_src_global generation:  0.041934967041015625
r_  generation:  0.33783483505249023
local_output_nid generation:  0.018895864486694336
local_in_edges_tensor generation:  0.018847227096557617
mini_batch_src_global generation:  0.04373335838317871
r_  generation:  0.3340795040130615
local_output_nid generation:  0.01920175552368164
local_in_edges_tensor generation:  0.019872426986694336
mini_batch_src_global generation:  0.04194521903991699
r_  generation:  0.3419532775878906
----------------------check_connections_block total spend ----------------------------- 3.915113925933838
generate_one_block  0.43199682235717773
generate_one_block  0.42235684394836426
generate_one_block  0.42616748809814453
generate_one_block  0.4287726879119873
generate_one_block  0.4256293773651123
generate_one_block  0.4290351867675781
generate_one_block  0.42850708961486816
generate_one_block  0.4537241458892822
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03720688819885254
gen group dst list time:  0.03698539733886719
time for parepare:  0.018236875534057617
local_output_nid generation:  0.02570033073425293
local_in_edges_tensor generation:  0.04124903678894043
mini_batch_src_global generation:  0.04325747489929199
r_  generation:  0.4725031852722168
local_output_nid generation:  0.03243732452392578
local_in_edges_tensor generation:  0.04255986213684082
mini_batch_src_global generation:  0.053725242614746094
r_  generation:  0.48009276390075684
local_output_nid generation:  0.034835100173950195
local_in_edges_tensor generation:  0.033330440521240234
mini_batch_src_global generation:  0.051340579986572266
r_  generation:  0.48719239234924316
local_output_nid generation:  0.03395986557006836
local_in_edges_tensor generation:  0.03666973114013672
mini_batch_src_global generation:  0.053235530853271484
r_  generation:  0.4872555732727051
local_output_nid generation:  0.0337224006652832
local_in_edges_tensor generation:  0.034827470779418945
mini_batch_src_global generation:  0.05702948570251465
r_  generation:  0.4940650463104248
local_output_nid generation:  0.0341954231262207
local_in_edges_tensor generation:  0.03543972969055176
mini_batch_src_global generation:  0.05523180961608887
r_  generation:  0.490246057510376
local_output_nid generation:  0.03391838073730469
local_in_edges_tensor generation:  0.03077244758605957
mini_batch_src_global generation:  0.05407977104187012
r_  generation:  0.4963862895965576
local_output_nid generation:  0.03395366668701172
local_in_edges_tensor generation:  0.031205177307128906
mini_batch_src_global generation:  0.05515456199645996
r_  generation:  0.4896078109741211
----------------------check_connections_block total spend ----------------------------- 5.745639085769653
generate_one_block  0.6054592132568359
generate_one_block  0.605372428894043
generate_one_block  0.6111524105072021
generate_one_block  0.6124594211578369
generate_one_block  0.616471529006958
generate_one_block  0.6062474250793457
generate_one_block  0.6063101291656494
generate_one_block  0.6023685932159424
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13338470458984375  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

connection checking time:  9.660753011703491
block generation total time  8.312030792236328
average batch blocks generation time:  1.039003849029541
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10154390335083008  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9358434677124023  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1021728515625  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9350190162658691  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10268831253051758  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9367203712463379  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10257101058959961  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9375801086425781  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10248422622680664  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9375495910644531  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1025991439819336  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9386153221130371  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10175371170043945  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9370064735412598  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10249805450439453  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.939633846282959  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08343091607093811 |0.011899679899215698 |0.0035542547702789307 |9.077787399291992e-05 |0.0037835240364074707 |0.0016145706176757812 |
----------------------------------------------------------pseudo_mini_loss sum 1.6371939182281494
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  3020446
Number of first layer input nodes during this epoch:  1287230
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1331768035888672  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023780107498168945
range selection method range initialization spend 0.012208938598632812
time for parepare:  0.015977144241333008
local_output_nid generation:  0.002733469009399414
local_in_edges_tensor generation:  0.004207134246826172
mini_batch_src_global generation:  0.0035495758056640625
r_  generation:  0.04276466369628906
local_output_nid generation:  0.0031633377075195312
local_in_edges_tensor generation:  0.001950979232788086
mini_batch_src_global generation:  0.004894733428955078
r_  generation:  0.045215606689453125
local_output_nid generation:  0.0032279491424560547
local_in_edges_tensor generation:  0.0017910003662109375
mini_batch_src_global generation:  0.0033550262451171875
r_  generation:  0.04453682899475098
local_output_nid generation:  0.003278493881225586
local_in_edges_tensor generation:  0.0018584728240966797
mini_batch_src_global generation:  0.003248453140258789
r_  generation:  0.04561161994934082
local_output_nid generation:  0.003240346908569336
local_in_edges_tensor generation:  0.0018088817596435547
mini_batch_src_global generation:  0.0035974979400634766
r_  generation:  0.04729175567626953
local_output_nid generation:  0.0032279491424560547
local_in_edges_tensor generation:  0.0018658638000488281
mini_batch_src_global generation:  0.0036885738372802734
r_  generation:  0.04797768592834473
local_output_nid generation:  0.003219127655029297
local_in_edges_tensor generation:  0.0018229484558105469
mini_batch_src_global generation:  0.003737926483154297
r_  generation:  0.04850125312805176
local_output_nid generation:  0.003263235092163086
local_in_edges_tensor generation:  0.0018832683563232422
mini_batch_src_global generation:  0.0037109851837158203
r_  generation:  0.047353267669677734
----------------------check_connections_block total spend ----------------------------- 0.5363554954528809
generate_one_block  0.05953574180603027
generate_one_block  0.06200742721557617
generate_one_block  0.06048464775085449
generate_one_block  0.06026768684387207
generate_one_block  0.06284832954406738
generate_one_block  0.06228303909301758
generate_one_block  0.0651092529296875
generate_one_block  0.06229805946350098
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03319978713989258
gen group dst list time:  0.016461849212646484
time for parepare:  0.0196382999420166
local_output_nid generation:  0.011691093444824219
local_in_edges_tensor generation:  0.020957231521606445
mini_batch_src_global generation:  0.03046703338623047
r_  generation:  0.3221149444580078
local_output_nid generation:  0.019628047943115234
local_in_edges_tensor generation:  0.024864912033081055
mini_batch_src_global generation:  0.04375481605529785
r_  generation:  0.3303258419036865
local_output_nid generation:  0.01876068115234375
local_in_edges_tensor generation:  0.021869182586669922
mini_batch_src_global generation:  0.038564205169677734
r_  generation:  0.33501458168029785
local_output_nid generation:  0.01862955093383789
local_in_edges_tensor generation:  0.01790165901184082
mini_batch_src_global generation:  0.03887319564819336
r_  generation:  0.328601598739624
local_output_nid generation:  0.019782304763793945
local_in_edges_tensor generation:  0.02007150650024414
mini_batch_src_global generation:  0.04173111915588379
r_  generation:  0.3391709327697754
local_output_nid generation:  0.018492937088012695
local_in_edges_tensor generation:  0.021989107131958008
mini_batch_src_global generation:  0.04257631301879883
r_  generation:  0.34184813499450684
local_output_nid generation:  0.01847100257873535
local_in_edges_tensor generation:  0.02112865447998047
mini_batch_src_global generation:  0.04041457176208496
r_  generation:  0.3417527675628662
local_output_nid generation:  0.018317699432373047
local_in_edges_tensor generation:  0.0189516544342041
mini_batch_src_global generation:  0.04929542541503906
r_  generation:  0.3384852409362793
----------------------check_connections_block total spend ----------------------------- 3.908008575439453
generate_one_block  0.4297349452972412
generate_one_block  0.4391200542449951
generate_one_block  0.4304227828979492
generate_one_block  0.418626070022583
generate_one_block  0.42960023880004883
generate_one_block  0.44089269638061523
generate_one_block  0.4319489002227783
generate_one_block  0.44745516777038574
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03626227378845215
gen group dst list time:  0.0371088981628418
time for parepare:  0.019248008728027344
local_output_nid generation:  0.025875329971313477
local_in_edges_tensor generation:  0.053890228271484375
mini_batch_src_global generation:  0.04383230209350586
r_  generation:  0.4705979824066162
local_output_nid generation:  0.03305530548095703
local_in_edges_tensor generation:  0.040735721588134766
mini_batch_src_global generation:  0.05620384216308594
r_  generation:  0.4777336120605469
local_output_nid generation:  0.0348052978515625
local_in_edges_tensor generation:  0.032547712326049805
mini_batch_src_global generation:  0.051070213317871094
r_  generation:  0.48854684829711914
local_output_nid generation:  0.03383922576904297
local_in_edges_tensor generation:  0.03192925453186035
mini_batch_src_global generation:  0.05299782752990723
r_  generation:  0.48482346534729004
local_output_nid generation:  0.033968448638916016
local_in_edges_tensor generation:  0.03848695755004883
mini_batch_src_global generation:  0.05504775047302246
r_  generation:  0.49565553665161133
local_output_nid generation:  0.03373599052429199
local_in_edges_tensor generation:  0.03696393966674805
mini_batch_src_global generation:  0.05524873733520508
r_  generation:  0.4876077175140381
local_output_nid generation:  0.033797264099121094
local_in_edges_tensor generation:  0.03655433654785156
mini_batch_src_global generation:  0.058431148529052734
r_  generation:  0.4979360103607178
local_output_nid generation:  0.034362077713012695
local_in_edges_tensor generation:  0.03272271156311035
mini_batch_src_global generation:  0.05527758598327637
r_  generation:  0.49006175994873047
----------------------check_connections_block total spend ----------------------------- 5.767789602279663
generate_one_block  0.6087203025817871
generate_one_block  0.606799840927124
generate_one_block  0.6020016670227051
generate_one_block  0.603630542755127
generate_one_block  0.6196990013122559
generate_one_block  0.6110877990722656
generate_one_block  0.612257719039917
generate_one_block  0.6103317737579346
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1331768035888672  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

connection checking time:  9.675798177719116
block generation total time  8.342329502105713
average batch blocks generation time:  1.0427911877632141
block dataloader generation time/epoch 19.954656839370728
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10169076919555664  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9364309310913086  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1022791862487793  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9388809204101562  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10227680206298828  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9360823631286621  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1026144027709961  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9337658882141113  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10279273986816406  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9375638961791992  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10232257843017578  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9386653900146484  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10184669494628906  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9401273727416992  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10223531723022461  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9349608421325684  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08458879590034485 |0.012297183275222778 |0.0035614967346191406 |9.09268856048584e-05 |0.0037650465965270996 |0.0013058185577392578 |
----------------------------------------------------------pseudo_mini_loss sum 1.5910059213638306
Total (block generation + training)time/epoch 20.86329936981201
Training time/epoch 0.9083549976348877
Training time without block to device /epoch 0.8099775314331055
Training time without total dataloading part /epoch 0.06064558029174805
load block tensor time/epoch 0.6767103672027588
block to device time/epoch 0.09837746620178223
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  3019612
Number of first layer input nodes during this epoch:  1287222
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1330275535583496  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022020578384399414
range selection method range initialization spend 0.012228727340698242
time for parepare:  0.015837907791137695
local_output_nid generation:  0.0027463436126708984
local_in_edges_tensor generation:  0.004029512405395508
mini_batch_src_global generation:  0.0036568641662597656
r_  generation:  0.04239487648010254
local_output_nid generation:  0.0031614303588867188
local_in_edges_tensor generation:  0.0017833709716796875
mini_batch_src_global generation:  0.004814624786376953
r_  generation:  0.04426002502441406
local_output_nid generation:  0.0032308101654052734
local_in_edges_tensor generation:  0.0018470287322998047
mini_batch_src_global generation:  0.0032498836517333984
r_  generation:  0.045481204986572266
local_output_nid generation:  0.003221750259399414
local_in_edges_tensor generation:  0.001827239990234375
mini_batch_src_global generation:  0.0033495426177978516
r_  generation:  0.04591822624206543
local_output_nid generation:  0.0032253265380859375
local_in_edges_tensor generation:  0.0018198490142822266
mini_batch_src_global generation:  0.0036191940307617188
r_  generation:  0.04696393013000488
local_output_nid generation:  0.0032100677490234375
local_in_edges_tensor generation:  0.001833200454711914
mini_batch_src_global generation:  0.0036630630493164062
r_  generation:  0.047055721282958984
local_output_nid generation:  0.0032477378845214844
local_in_edges_tensor generation:  0.001842498779296875
mini_batch_src_global generation:  0.0036118030548095703
r_  generation:  0.047126054763793945
local_output_nid generation:  0.003239154815673828
local_in_edges_tensor generation:  0.0017969608306884766
mini_batch_src_global generation:  0.003804922103881836
r_  generation:  0.0478212833404541
----------------------check_connections_block total spend ----------------------------- 0.5333430767059326
generate_one_block  0.05980825424194336
generate_one_block  0.0611879825592041
generate_one_block  0.06134486198425293
generate_one_block  0.06110215187072754
generate_one_block  0.062050580978393555
generate_one_block  0.060990333557128906
generate_one_block  0.06380081176757812
generate_one_block  0.06167435646057129
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.031996965408325195
gen group dst list time:  0.015955448150634766
time for parepare:  0.018924236297607422
local_output_nid generation:  0.011499404907226562
local_in_edges_tensor generation:  0.021932125091552734
mini_batch_src_global generation:  0.030392169952392578
r_  generation:  0.3128335475921631
local_output_nid generation:  0.017880678176879883
local_in_edges_tensor generation:  0.02172398567199707
mini_batch_src_global generation:  0.038565874099731445
r_  generation:  0.3298673629760742
local_output_nid generation:  0.01866436004638672
local_in_edges_tensor generation:  0.019449472427368164
mini_batch_src_global generation:  0.03802967071533203
r_  generation:  0.3323957920074463
local_output_nid generation:  0.018424272537231445
local_in_edges_tensor generation:  0.01824331283569336
mini_batch_src_global generation:  0.03884410858154297
r_  generation:  0.3316078186035156
local_output_nid generation:  0.018874168395996094
local_in_edges_tensor generation:  0.02009439468383789
mini_batch_src_global generation:  0.04001045227050781
r_  generation:  0.3414175510406494
local_output_nid generation:  0.019215822219848633
local_in_edges_tensor generation:  0.022854328155517578
mini_batch_src_global generation:  0.04033946990966797
r_  generation:  0.33354949951171875
local_output_nid generation:  0.018268108367919922
local_in_edges_tensor generation:  0.020444393157958984
mini_batch_src_global generation:  0.0392613410949707
r_  generation:  0.3324315547943115
local_output_nid generation:  0.018365144729614258
local_in_edges_tensor generation:  0.018509387969970703
mini_batch_src_global generation:  0.042197227478027344
r_  generation:  0.3362088203430176
----------------------check_connections_block total spend ----------------------------- 3.85260009765625
generate_one_block  0.42779064178466797
generate_one_block  0.4293982982635498
generate_one_block  0.4267430305480957
generate_one_block  0.4353609085083008
generate_one_block  0.42980051040649414
generate_one_block  0.42272400856018066
generate_one_block  0.4235966205596924
generate_one_block  0.45280885696411133
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03224802017211914
gen group dst list time:  0.03746795654296875
time for parepare:  0.02073979377746582
local_output_nid generation:  0.02628302574157715
local_in_edges_tensor generation:  0.03642702102661133
mini_batch_src_global generation:  0.04335784912109375
r_  generation:  0.47036194801330566
local_output_nid generation:  0.032562971115112305
local_in_edges_tensor generation:  0.03430366516113281
mini_batch_src_global generation:  0.05338478088378906
r_  generation:  0.4792776107788086
local_output_nid generation:  0.033379316329956055
local_in_edges_tensor generation:  0.03178095817565918
mini_batch_src_global generation:  0.049932241439819336
r_  generation:  0.48654985427856445
local_output_nid generation:  0.0334775447845459
local_in_edges_tensor generation:  0.03172945976257324
mini_batch_src_global generation:  0.05295395851135254
r_  generation:  0.48274707794189453
local_output_nid generation:  0.033646583557128906
local_in_edges_tensor generation:  0.031572580337524414
mini_batch_src_global generation:  0.05196499824523926
r_  generation:  0.49611473083496094
local_output_nid generation:  0.034047603607177734
local_in_edges_tensor generation:  0.031522274017333984
mini_batch_src_global generation:  0.05333852767944336
r_  generation:  0.49085330963134766
local_output_nid generation:  0.03451347351074219
local_in_edges_tensor generation:  0.03325796127319336
mini_batch_src_global generation:  0.05216693878173828
r_  generation:  0.4977598190307617
local_output_nid generation:  0.034346580505371094
local_in_edges_tensor generation:  0.032036781311035156
mini_batch_src_global generation:  0.05482363700866699
r_  generation:  0.4912710189819336
----------------------check_connections_block total spend ----------------------------- 5.709667444229126
generate_one_block  0.6105225086212158
generate_one_block  0.6153578758239746
generate_one_block  0.6036615371704102
generate_one_block  0.6063776016235352
generate_one_block  0.6190845966339111
generate_one_block  0.6103971004486084
generate_one_block  0.6077487468719482
generate_one_block  0.6084544658660889
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1330275535583496  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

connection checking time:  9.562267541885376
block generation total time  8.329827308654785
average batch blocks generation time:  1.0412284135818481
block dataloader generation time/epoch 19.895120859146118
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10260295867919922  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9375  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10213327407836914  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9372043609619141  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1024169921875  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.933403491973877  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10258197784423828  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9366259574890137  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10267066955566406  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9397072792053223  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1016535758972168  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9351968765258789  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10215377807617188  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9349255561828613  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10274791717529297  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9372701644897461  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08551710844039917 |0.017074406147003174 |0.003489077091217041 |8.609890937805176e-05 |0.003743380308151245 |0.001649618148803711 |
----------------------------------------------------------pseudo_mini_loss sum 1.5504379272460938
Total (block generation + training)time/epoch 20.82475507259369
Training time/epoch 0.9503958225250244
Training time without block to device /epoch 0.813800573348999
Training time without total dataloading part /epoch 0.060198068618774414
load block tensor time/epoch 0.6841368675231934
block to device time/epoch 0.1365952491760254
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  3018243
Number of first layer input nodes during this epoch:  1286832
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13339710235595703  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021055936813354492
range selection method range initialization spend 0.011989116668701172
time for parepare:  0.018103599548339844
local_output_nid generation:  0.0027799606323242188
local_in_edges_tensor generation:  0.005024909973144531
mini_batch_src_global generation:  0.004062175750732422
r_  generation:  0.042695045471191406
local_output_nid generation:  0.0031833648681640625
local_in_edges_tensor generation:  0.0017850399017333984
mini_batch_src_global generation:  0.00481414794921875
r_  generation:  0.04632449150085449
local_output_nid generation:  0.0032014846801757812
local_in_edges_tensor generation:  0.0017559528350830078
mini_batch_src_global generation:  0.0032393932342529297
r_  generation:  0.044762372970581055
local_output_nid generation:  0.003192901611328125
local_in_edges_tensor generation:  0.001772165298461914
mini_batch_src_global generation:  0.003350973129272461
r_  generation:  0.04711461067199707
local_output_nid generation:  0.0032417774200439453
local_in_edges_tensor generation:  0.001821279525756836
mini_batch_src_global generation:  0.0035140514373779297
r_  generation:  0.04662942886352539
local_output_nid generation:  0.0032258033752441406
local_in_edges_tensor generation:  0.0018091201782226562
mini_batch_src_global generation:  0.0036284923553466797
r_  generation:  0.04775238037109375
local_output_nid generation:  0.0032842159271240234
local_in_edges_tensor generation:  0.0018401145935058594
mini_batch_src_global generation:  0.0036177635192871094
r_  generation:  0.049199581146240234
local_output_nid generation:  0.0033359527587890625
local_in_edges_tensor generation:  0.0018291473388671875
mini_batch_src_global generation:  0.003797769546508789
r_  generation:  0.04859209060668945
----------------------check_connections_block total spend ----------------------------- 0.5430436134338379
generate_one_block  0.060082197189331055
generate_one_block  0.06266450881958008
generate_one_block  0.060472726821899414
generate_one_block  0.06134986877441406
generate_one_block  0.06087636947631836
generate_one_block  0.0691065788269043
generate_one_block  0.06459736824035645
generate_one_block  0.06187033653259277
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03217315673828125
gen group dst list time:  0.015835285186767578
time for parepare:  0.019478559494018555
local_output_nid generation:  0.011612415313720703
local_in_edges_tensor generation:  0.02583765983581543
mini_batch_src_global generation:  0.0343935489654541
r_  generation:  0.3229382038116455
local_output_nid generation:  0.018375396728515625
local_in_edges_tensor generation:  0.022103548049926758
mini_batch_src_global generation:  0.03888702392578125
r_  generation:  0.3325376510620117
local_output_nid generation:  0.018802881240844727
local_in_edges_tensor generation:  0.01927947998046875
mini_batch_src_global generation:  0.040231943130493164
r_  generation:  0.3292396068572998
local_output_nid generation:  0.01889348030090332
local_in_edges_tensor generation:  0.0193939208984375
mini_batch_src_global generation:  0.04035520553588867
r_  generation:  0.33301281929016113
local_output_nid generation:  0.018889427185058594
local_in_edges_tensor generation:  0.018230438232421875
mini_batch_src_global generation:  0.03967928886413574
r_  generation:  0.33384108543395996
local_output_nid generation:  0.018181562423706055
local_in_edges_tensor generation:  0.019376754760742188
mini_batch_src_global generation:  0.04111194610595703
r_  generation:  0.3338167667388916
local_output_nid generation:  0.01835012435913086
local_in_edges_tensor generation:  0.019956588745117188
mini_batch_src_global generation:  0.040040016174316406
r_  generation:  0.33468174934387207
local_output_nid generation:  0.018404722213745117
local_in_edges_tensor generation:  0.021662473678588867
mini_batch_src_global generation:  0.040769338607788086
r_  generation:  0.33916187286376953
----------------------check_connections_block total spend ----------------------------- 3.865999937057495
generate_one_block  0.43434834480285645
generate_one_block  0.4389991760253906
generate_one_block  0.42557263374328613
generate_one_block  0.4277222156524658
generate_one_block  0.4264066219329834
generate_one_block  0.4291248321533203
generate_one_block  0.4283607006072998
generate_one_block  0.4502525329589844
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028083086013793945
gen group dst list time:  0.03814244270324707
time for parepare:  0.019400596618652344
local_output_nid generation:  0.026285886764526367
local_in_edges_tensor generation:  0.04622077941894531
mini_batch_src_global generation:  0.04369401931762695
r_  generation:  0.4713616371154785
local_output_nid generation:  0.03240799903869629
local_in_edges_tensor generation:  0.04458475112915039
mini_batch_src_global generation:  0.05330038070678711
r_  generation:  0.47984838485717773
local_output_nid generation:  0.03319597244262695
local_in_edges_tensor generation:  0.0322718620300293
mini_batch_src_global generation:  0.050009965896606445
r_  generation:  0.4879496097564697
local_output_nid generation:  0.03437614440917969
local_in_edges_tensor generation:  0.03408026695251465
mini_batch_src_global generation:  0.05530548095703125
r_  generation:  0.48262500762939453
local_output_nid generation:  0.03348040580749512
local_in_edges_tensor generation:  0.03239607810974121
mini_batch_src_global generation:  0.05291867256164551
r_  generation:  0.49799108505249023
local_output_nid generation:  0.03354144096374512
local_in_edges_tensor generation:  0.03416109085083008
mini_batch_src_global generation:  0.05605602264404297
r_  generation:  0.5027651786804199
local_output_nid generation:  0.03503680229187012
local_in_edges_tensor generation:  0.033679962158203125
mini_batch_src_global generation:  0.05359697341918945
r_  generation:  0.4965183734893799
local_output_nid generation:  0.03394579887390137
local_in_edges_tensor generation:  0.03396487236022949
mini_batch_src_global generation:  0.05436444282531738
r_  generation:  0.48702383041381836
----------------------check_connections_block total spend ----------------------------- 5.758666038513184
generate_one_block  0.6121699810028076
generate_one_block  0.6108744144439697
generate_one_block  0.6049175262451172
generate_one_block  0.6128792762756348
generate_one_block  0.6131589412689209
generate_one_block  0.6116392612457275
generate_one_block  0.6079163551330566
generate_one_block  0.6019213199615479
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13339710235595703  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

connection checking time:  9.624665975570679
block generation total time  8.33626413345337
average batch blocks generation time:  1.0420330166816711
block dataloader generation time/epoch 19.902312517166138
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10258817672729492  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9386477470397949  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10201740264892578  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9431881904602051  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10211753845214844  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9357681274414062  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10253763198852539  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9366755485534668  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10245656967163086  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9359140396118164  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10253286361694336  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9364156723022461  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10252046585083008  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9360871315002441  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10250329971313477  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9363899230957031  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.079679936170578 |0.013111740350723267 |0.0036179423332214355 |9.086728096008301e-05 |0.00902053713798523 |0.0018436908721923828 |
----------------------------------------------------------pseudo_mini_loss sum 1.5169036388397217
Total (block generation + training)time/epoch 20.826899846394856
Training time/epoch 0.914297342300415
Training time without block to device /epoch 0.8094034194946289
Training time without total dataloading part /epoch 0.10367846488952637
load block tensor time/epoch 0.637439489364624
block to device time/epoch 0.10489392280578613
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  3020648
Number of first layer input nodes during this epoch:  1287408
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13329076766967773  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022065401077270508
range selection method range initialization spend 0.012276172637939453
time for parepare:  0.016498088836669922
local_output_nid generation:  0.0028107166290283203
local_in_edges_tensor generation:  0.007199287414550781
mini_batch_src_global generation:  0.0037729740142822266
r_  generation:  0.04219555854797363
local_output_nid generation:  0.003153085708618164
local_in_edges_tensor generation:  0.0017833709716796875
mini_batch_src_global generation:  0.004783153533935547
r_  generation:  0.04455709457397461
local_output_nid generation:  0.003219127655029297
local_in_edges_tensor generation:  0.0018749237060546875
mini_batch_src_global generation:  0.003207683563232422
r_  generation:  0.044875144958496094
local_output_nid generation:  0.0031981468200683594
local_in_edges_tensor generation:  0.0018663406372070312
mini_batch_src_global generation:  0.0033655166625976562
r_  generation:  0.046988725662231445
local_output_nid generation:  0.003226757049560547
local_in_edges_tensor generation:  0.0018155574798583984
mini_batch_src_global generation:  0.0036728382110595703
r_  generation:  0.04774665832519531
local_output_nid generation:  0.0032265186309814453
local_in_edges_tensor generation:  0.0018427371978759766
mini_batch_src_global generation:  0.003750324249267578
r_  generation:  0.04751253128051758
local_output_nid generation:  0.0032486915588378906
local_in_edges_tensor generation:  0.001874685287475586
mini_batch_src_global generation:  0.0038089752197265625
r_  generation:  0.04819059371948242
local_output_nid generation:  0.0031998157501220703
local_in_edges_tensor generation:  0.0018157958984375
mini_batch_src_global generation:  0.0037758350372314453
r_  generation:  0.04822587966918945
----------------------check_connections_block total spend ----------------------------- 0.5427379608154297
generate_one_block  0.059923410415649414
generate_one_block  0.06061816215515137
generate_one_block  0.060898542404174805
generate_one_block  0.07074499130249023
generate_one_block  0.06260180473327637
generate_one_block  0.06478309631347656
generate_one_block  0.0652461051940918
generate_one_block  0.06212115287780762
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.032891035079956055
gen group dst list time:  0.01585078239440918
time for parepare:  0.020040273666381836
local_output_nid generation:  0.011615514755249023
local_in_edges_tensor generation:  0.026017189025878906
mini_batch_src_global generation:  0.03069472312927246
r_  generation:  0.3138582706451416
local_output_nid generation:  0.01752161979675293
local_in_edges_tensor generation:  0.02381300926208496
mini_batch_src_global generation:  0.04005169868469238
r_  generation:  0.33463311195373535
local_output_nid generation:  0.01856851577758789
local_in_edges_tensor generation:  0.018024682998657227
mini_batch_src_global generation:  0.03798079490661621
r_  generation:  0.3366565704345703
local_output_nid generation:  0.01865983009338379
local_in_edges_tensor generation:  0.027695655822753906
mini_batch_src_global generation:  0.041584014892578125
r_  generation:  0.3449435234069824
local_output_nid generation:  0.019784927368164062
local_in_edges_tensor generation:  0.022111177444458008
mini_batch_src_global generation:  0.04634594917297363
r_  generation:  0.3493337631225586
local_output_nid generation:  0.018244504928588867
local_in_edges_tensor generation:  0.025777339935302734
mini_batch_src_global generation:  0.04607963562011719
r_  generation:  0.35538768768310547
local_output_nid generation:  0.020722627639770508
local_in_edges_tensor generation:  0.020906448364257812
mini_batch_src_global generation:  0.040842533111572266
r_  generation:  0.3428630828857422
local_output_nid generation:  0.018998146057128906
local_in_edges_tensor generation:  0.020548343658447266
mini_batch_src_global generation:  0.040944814682006836
r_  generation:  0.3446509838104248
----------------------check_connections_block total spend ----------------------------- 3.9736504554748535
generate_one_block  0.4262220859527588
generate_one_block  0.4277005195617676
generate_one_block  0.4254477024078369
generate_one_block  0.4467453956604004
generate_one_block  0.4500579833984375
generate_one_block  0.44142580032348633
generate_one_block  0.4457271099090576
generate_one_block  0.4651913642883301
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03506302833557129
gen group dst list time:  0.043782949447631836
time for parepare:  0.021374940872192383
local_output_nid generation:  0.02729320526123047
local_in_edges_tensor generation:  0.0479741096496582
mini_batch_src_global generation:  0.04474973678588867
r_  generation:  0.47571730613708496
local_output_nid generation:  0.03382539749145508
local_in_edges_tensor generation:  0.03845834732055664
mini_batch_src_global generation:  0.05689859390258789
r_  generation:  0.48448657989501953
local_output_nid generation:  0.034143924713134766
local_in_edges_tensor generation:  0.03206586837768555
mini_batch_src_global generation:  0.05105447769165039
r_  generation:  0.4880862236022949
local_output_nid generation:  0.03464674949645996
local_in_edges_tensor generation:  0.034844160079956055
mini_batch_src_global generation:  0.05656170845031738
r_  generation:  0.487642765045166
local_output_nid generation:  0.03492307662963867
local_in_edges_tensor generation:  0.034304141998291016
mini_batch_src_global generation:  0.055214643478393555
r_  generation:  0.5064232349395752
local_output_nid generation:  0.034929752349853516
local_in_edges_tensor generation:  0.033228158950805664
mini_batch_src_global generation:  0.05498957633972168
r_  generation:  0.49388885498046875
local_output_nid generation:  0.03487348556518555
local_in_edges_tensor generation:  0.03406810760498047
mini_batch_src_global generation:  0.05757284164428711
r_  generation:  0.49755430221557617
local_output_nid generation:  0.03508257865905762
local_in_edges_tensor generation:  0.032878875732421875
mini_batch_src_global generation:  0.05496072769165039
r_  generation:  0.48904871940612793
----------------------check_connections_block total spend ----------------------------- 5.817341566085815
generate_one_block  0.6114363670349121
generate_one_block  0.6048698425292969
generate_one_block  0.617257833480835
generate_one_block  0.6189987659454346
generate_one_block  0.6217966079711914
generate_one_block  0.6259591579437256
generate_one_block  0.6333799362182617
generate_one_block  0.6093182563781738
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13329076766967773  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

connection checking time:  9.790992021560669
block generation total time  8.471534729003906
average batch blocks generation time:  1.0589418411254883
block dataloader generation time/epoch 19.99361777305603
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1023721694946289  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9351091384887695  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10259437561035156  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9370732307434082  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10226774215698242  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9339442253112793  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10275602340698242  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9373612403869629  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10239934921264648  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9387683868408203  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10163021087646484  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9357514381408691  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1022491455078125  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9379234313964844  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10243415832519531  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9372382164001465  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08380520343780518 |0.017693012952804565 |0.00358465313911438 |9.188055992126465e-05 |0.0038230717182159424 |0.0013284683227539062 |
----------------------------------------------------------pseudo_mini_loss sum 1.483689785003662
Total (block generation + training)time/epoch 20.923880994319916
Training time/epoch 0.9470748901367188
Training time without block to device /epoch 0.8055307865142822
Training time without total dataloading part /epoch 0.0613253116607666
load block tensor time/epoch 0.6704416275024414
block to device time/epoch 0.14154410362243652
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  3018391
Number of first layer input nodes during this epoch:  1286923
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13324737548828125  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025143146514892578
range selection method range initialization spend 0.012357234954833984
time for parepare:  0.016900300979614258
local_output_nid generation:  0.0027768611907958984
local_in_edges_tensor generation:  0.004973411560058594
mini_batch_src_global generation:  0.003681182861328125
r_  generation:  0.042522430419921875
local_output_nid generation:  0.0031669139862060547
local_in_edges_tensor generation:  0.0017771720886230469
mini_batch_src_global generation:  0.004771232604980469
r_  generation:  0.04419112205505371
local_output_nid generation:  0.0032227039337158203
local_in_edges_tensor generation:  0.001789093017578125
mini_batch_src_global generation:  0.003283977508544922
r_  generation:  0.04604506492614746
local_output_nid generation:  0.003179788589477539
local_in_edges_tensor generation:  0.0018393993377685547
mini_batch_src_global generation:  0.003369569778442383
r_  generation:  0.0460665225982666
local_output_nid generation:  0.0032155513763427734
local_in_edges_tensor generation:  0.0018362998962402344
mini_batch_src_global generation:  0.003564119338989258
r_  generation:  0.0475916862487793
local_output_nid generation:  0.0031752586364746094
local_in_edges_tensor generation:  0.0018341541290283203
mini_batch_src_global generation:  0.00366973876953125
r_  generation:  0.04728198051452637
local_output_nid generation:  0.003214597702026367
local_in_edges_tensor generation:  0.0018215179443359375
mini_batch_src_global generation:  0.0037250518798828125
r_  generation:  0.04726362228393555
local_output_nid generation:  0.0032346248626708984
local_in_edges_tensor generation:  0.0018281936645507812
mini_batch_src_global generation:  0.0037522315979003906
r_  generation:  0.04858207702636719
----------------------check_connections_block total spend ----------------------------- 0.5385599136352539
generate_one_block  0.05977463722229004
generate_one_block  0.061163902282714844
generate_one_block  0.06205940246582031
generate_one_block  0.061837196350097656
generate_one_block  0.06166529655456543
generate_one_block  0.06116366386413574
generate_one_block  0.06371808052062988
generate_one_block  0.06973385810852051
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030683279037475586
gen group dst list time:  0.015889406204223633
time for parepare:  0.019155502319335938
local_output_nid generation:  0.011557340621948242
local_in_edges_tensor generation:  0.026044607162475586
mini_batch_src_global generation:  0.031793832778930664
r_  generation:  0.31570887565612793
local_output_nid generation:  0.017844438552856445
local_in_edges_tensor generation:  0.020029306411743164
mini_batch_src_global generation:  0.03850388526916504
r_  generation:  0.3294637203216553
local_output_nid generation:  0.01877617835998535
local_in_edges_tensor generation:  0.019701004028320312
mini_batch_src_global generation:  0.038686513900756836
r_  generation:  0.33463501930236816
local_output_nid generation:  0.018779516220092773
local_in_edges_tensor generation:  0.01942920684814453
mini_batch_src_global generation:  0.03889203071594238
r_  generation:  0.33472776412963867
local_output_nid generation:  0.018953561782836914
local_in_edges_tensor generation:  0.018076419830322266
mini_batch_src_global generation:  0.04068708419799805
r_  generation:  0.3378632068634033
local_output_nid generation:  0.01805734634399414
local_in_edges_tensor generation:  0.01849079132080078
mini_batch_src_global generation:  0.040175437927246094
r_  generation:  0.3349614143371582
local_output_nid generation:  0.018032312393188477
local_in_edges_tensor generation:  0.01852893829345703
mini_batch_src_global generation:  0.04214930534362793
r_  generation:  0.3347477912902832
local_output_nid generation:  0.018275737762451172
local_in_edges_tensor generation:  0.020351886749267578
mini_batch_src_global generation:  0.04272174835205078
r_  generation:  0.34215807914733887
----------------------check_connections_block total spend ----------------------------- 3.86545467376709
generate_one_block  0.42466044425964355
generate_one_block  0.43383336067199707
generate_one_block  0.43134498596191406
generate_one_block  0.4284055233001709
generate_one_block  0.4280059337615967
generate_one_block  0.4239647388458252
generate_one_block  0.421140193939209
generate_one_block  0.457322359085083
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030080795288085938
gen group dst list time:  0.03779745101928711
time for parepare:  0.0193634033203125
local_output_nid generation:  0.025287866592407227
local_in_edges_tensor generation:  0.0370786190032959
mini_batch_src_global generation:  0.04350161552429199
r_  generation:  0.4741818904876709
local_output_nid generation:  0.03290247917175293
local_in_edges_tensor generation:  0.03545069694519043
mini_batch_src_global generation:  0.053629159927368164
r_  generation:  0.4799184799194336
local_output_nid generation:  0.033808231353759766
local_in_edges_tensor generation:  0.03309917449951172
mini_batch_src_global generation:  0.051787614822387695
r_  generation:  0.493166446685791
local_output_nid generation:  0.03363776206970215
local_in_edges_tensor generation:  0.03144979476928711
mini_batch_src_global generation:  0.059834957122802734
r_  generation:  0.48312854766845703
local_output_nid generation:  0.03497958183288574
local_in_edges_tensor generation:  0.03096914291381836
mini_batch_src_global generation:  0.052622318267822266
r_  generation:  0.49946045875549316
local_output_nid generation:  0.03405570983886719
local_in_edges_tensor generation:  0.03501009941101074
mini_batch_src_global generation:  0.054897308349609375
r_  generation:  0.486328125
local_output_nid generation:  0.03436732292175293
local_in_edges_tensor generation:  0.03110527992248535
mini_batch_src_global generation:  0.05364823341369629
r_  generation:  0.5013623237609863
local_output_nid generation:  0.034441471099853516
local_in_edges_tensor generation:  0.037558794021606445
mini_batch_src_global generation:  0.0551145076751709
r_  generation:  0.4882955551147461
----------------------check_connections_block total spend ----------------------------- 5.740776777267456
generate_one_block  0.6133971214294434
generate_one_block  0.6021444797515869
generate_one_block  0.6162452697753906
generate_one_block  0.6176731586456299
generate_one_block  0.6140036582946777
generate_one_block  0.6202514171600342
generate_one_block  0.6163792610168457
generate_one_block  0.6156749725341797
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13324737548828125  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

connection checking time:  9.606231451034546
block generation total time  8.364446878433228
average batch blocks generation time:  1.0455558598041534
block dataloader generation time/epoch 19.983012104034422
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10233116149902344  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9361600875854492  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10259056091308594  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.937159538269043  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10242176055908203  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9397730827331543  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1017913818359375  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9395813941955566  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10243082046508789  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9375119209289551  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10236835479736328  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9361095428466797  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10262918472290039  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.936274528503418  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10247087478637695  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9378962516784668  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08156710863113403 |0.01715359091758728 |0.0038132071495056152 |9.620189666748047e-05 |0.0036506056785583496 |0.0014717578887939453 |
----------------------------------------------------------pseudo_mini_loss sum 1.4596831798553467
Total (block generation + training)time/epoch 20.912149333953856
Training time/epoch 0.924450159072876
Training time without block to device /epoch 0.7872214317321777
Training time without total dataloading part /epoch 0.06195187568664551
load block tensor time/epoch 0.6525368690490723
block to device time/epoch 0.13722872734069824
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  3021247
Number of first layer input nodes during this epoch:  1287132
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13325071334838867  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02273702621459961
range selection method range initialization spend 0.012461662292480469
time for parepare:  0.01609492301940918
local_output_nid generation:  0.0027010440826416016
local_in_edges_tensor generation:  0.005002498626708984
mini_batch_src_global generation:  0.003564119338989258
r_  generation:  0.04187655448913574
local_output_nid generation:  0.0031883716583251953
local_in_edges_tensor generation:  0.0018084049224853516
mini_batch_src_global generation:  0.004854679107666016
r_  generation:  0.04449033737182617
local_output_nid generation:  0.0032041072845458984
local_in_edges_tensor generation:  0.0018239021301269531
mini_batch_src_global generation:  0.003289461135864258
r_  generation:  0.044503211975097656
local_output_nid generation:  0.0032148361206054688
local_in_edges_tensor generation:  0.0018608570098876953
mini_batch_src_global generation:  0.003347635269165039
r_  generation:  0.046849966049194336
local_output_nid generation:  0.0032091140747070312
local_in_edges_tensor generation:  0.0018472671508789062
mini_batch_src_global generation:  0.0036177635192871094
r_  generation:  0.048134565353393555
local_output_nid generation:  0.0032265186309814453
local_in_edges_tensor generation:  0.0018765926361083984
mini_batch_src_global generation:  0.0037546157836914062
r_  generation:  0.04808402061462402
local_output_nid generation:  0.0031981468200683594
local_in_edges_tensor generation:  0.001836538314819336
mini_batch_src_global generation:  0.0038297176361083984
r_  generation:  0.04828929901123047
local_output_nid generation:  0.003271341323852539
local_in_edges_tensor generation:  0.001863241195678711
mini_batch_src_global generation:  0.003782510757446289
r_  generation:  0.04877138137817383
----------------------check_connections_block total spend ----------------------------- 0.5401942729949951
generate_one_block  0.0592198371887207
generate_one_block  0.06090283393859863
generate_one_block  0.060517311096191406
generate_one_block  0.06194806098937988
generate_one_block  0.06283760070800781
generate_one_block  0.06270051002502441
generate_one_block  0.06495189666748047
generate_one_block  0.062087297439575195
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.042310237884521484
gen group dst list time:  0.015653610229492188
time for parepare:  0.019169330596923828
local_output_nid generation:  0.011681079864501953
local_in_edges_tensor generation:  0.027034997940063477
mini_batch_src_global generation:  0.03241872787475586
r_  generation:  0.31583333015441895
local_output_nid generation:  0.017622709274291992
local_in_edges_tensor generation:  0.023145198822021484
mini_batch_src_global generation:  0.0386347770690918
r_  generation:  0.331127405166626
local_output_nid generation:  0.01857590675354004
local_in_edges_tensor generation:  0.018076419830322266
mini_batch_src_global generation:  0.03837776184082031
r_  generation:  0.3367340564727783
local_output_nid generation:  0.018604040145874023
local_in_edges_tensor generation:  0.01853036880493164
mini_batch_src_global generation:  0.04096174240112305
r_  generation:  0.3420093059539795
local_output_nid generation:  0.01949453353881836
local_in_edges_tensor generation:  0.019686222076416016
mini_batch_src_global generation:  0.0420839786529541
r_  generation:  0.34164905548095703
local_output_nid generation:  0.018323659896850586
local_in_edges_tensor generation:  0.01905345916748047
mini_batch_src_global generation:  0.040831565856933594
r_  generation:  0.3462214469909668
local_output_nid generation:  0.018350601196289062
local_in_edges_tensor generation:  0.018676042556762695
mini_batch_src_global generation:  0.041060447692871094
r_  generation:  0.3431835174560547
local_output_nid generation:  0.018432140350341797
local_in_edges_tensor generation:  0.020221710205078125
mini_batch_src_global generation:  0.04436516761779785
r_  generation:  0.3547816276550293
----------------------check_connections_block total spend ----------------------------- 3.927844285964966
generate_one_block  0.45418882369995117
generate_one_block  0.44029664993286133
generate_one_block  0.4273526668548584
generate_one_block  0.4320259094238281
generate_one_block  0.43184781074523926
generate_one_block  0.43277573585510254
generate_one_block  0.43196654319763184
generate_one_block  0.46380138397216797
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03322267532348633
gen group dst list time:  0.03775668144226074
time for parepare:  0.019617319107055664
local_output_nid generation:  0.026538372039794922
local_in_edges_tensor generation:  0.06137824058532715
mini_batch_src_global generation:  0.04578566551208496
r_  generation:  0.48211669921875
local_output_nid generation:  0.0338435173034668
local_in_edges_tensor generation:  0.04221034049987793
mini_batch_src_global generation:  0.057220458984375
r_  generation:  0.48372864723205566
local_output_nid generation:  0.03500175476074219
local_in_edges_tensor generation:  0.04103493690490723
mini_batch_src_global generation:  0.05486106872558594
r_  generation:  0.517615556716919
local_output_nid generation:  0.03728771209716797
local_in_edges_tensor generation:  0.04266619682312012
mini_batch_src_global generation:  0.059729576110839844
r_  generation:  0.4846189022064209
local_output_nid generation:  0.03548169136047363
local_in_edges_tensor generation:  0.03750181198120117
mini_batch_src_global generation:  0.05633115768432617
r_  generation:  0.5014252662658691
local_output_nid generation:  0.035722970962524414
local_in_edges_tensor generation:  0.03852987289428711
mini_batch_src_global generation:  0.054981231689453125
r_  generation:  0.4914886951446533
local_output_nid generation:  0.035581350326538086
local_in_edges_tensor generation:  0.033606767654418945
mini_batch_src_global generation:  0.05379033088684082
r_  generation:  0.5062527656555176
local_output_nid generation:  0.0376279354095459
local_in_edges_tensor generation:  0.036884307861328125
mini_batch_src_global generation:  0.05529332160949707
r_  generation:  0.5014233589172363
----------------------check_connections_block total spend ----------------------------- 5.917388439178467
generate_one_block  0.619438648223877
generate_one_block  0.602726936340332
generate_one_block  0.6133689880371094
generate_one_block  0.6026079654693604
generate_one_block  0.6110897064208984
generate_one_block  0.6174740791320801
generate_one_block  0.6185548305511475
generate_one_block  0.6327111721038818
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13325071334838867  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

connection checking time:  9.845232725143433
block generation total time  8.432227849960327
average batch blocks generation time:  1.054028481245041
block dataloader generation time/epoch 20.030237078666687
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10222721099853516  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9358386993408203  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10267066955566406  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9364614486694336  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10255956649780273  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9359827041625977  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10254335403442383  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9333734512329102  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10270261764526367  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9379444122314453  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10230064392089844  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9380679130554199  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10232114791870117  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9388580322265625  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10168075561523438  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.937047004699707  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08586645126342773 |0.01969650387763977 |0.00370180606842041 |9.626150131225586e-05 |0.0037905871868133545 |0.0028679370880126953 |
----------------------------------------------------------pseudo_mini_loss sum 1.431723713874817
Total (block generation + training)time/epoch 20.96740718682607
Training time/epoch 0.9771363735198975
Training time without block to device /epoch 0.8195643424987793
Training time without total dataloading part /epoch 0.06357717514038086
load block tensor time/epoch 0.6869316101074219
block to device time/epoch 0.15757203102111816
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  3019750
Number of first layer input nodes during this epoch:  1287456
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13273334503173828  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026533842086791992
range selection method range initialization spend 0.011848211288452148
time for parepare:  0.017763376235961914
local_output_nid generation:  0.0027892589569091797
local_in_edges_tensor generation:  0.005022764205932617
mini_batch_src_global generation:  0.0038979053497314453
r_  generation:  0.042020559310913086
local_output_nid generation:  0.0031681060791015625
local_in_edges_tensor generation:  0.0017881393432617188
mini_batch_src_global generation:  0.004824399948120117
r_  generation:  0.04354572296142578
local_output_nid generation:  0.0031905174255371094
local_in_edges_tensor generation:  0.0017938613891601562
mini_batch_src_global generation:  0.0032672882080078125
r_  generation:  0.04561448097229004
local_output_nid generation:  0.0032532215118408203
local_in_edges_tensor generation:  0.0017964839935302734
mini_batch_src_global generation:  0.003362417221069336
r_  generation:  0.047110557556152344
local_output_nid generation:  0.003156423568725586
local_in_edges_tensor generation:  0.0018508434295654297
mini_batch_src_global generation:  0.0036759376525878906
r_  generation:  0.04712104797363281
local_output_nid generation:  0.0032243728637695312
local_in_edges_tensor generation:  0.0018575191497802734
mini_batch_src_global generation:  0.003700733184814453
r_  generation:  0.04655790328979492
local_output_nid generation:  0.0032052993774414062
local_in_edges_tensor generation:  0.0018169879913330078
mini_batch_src_global generation:  0.0038454532623291016
r_  generation:  0.048367977142333984
local_output_nid generation:  0.0032095909118652344
local_in_edges_tensor generation:  0.0018353462219238281
mini_batch_src_global generation:  0.003843069076538086
r_  generation:  0.04868602752685547
----------------------check_connections_block total spend ----------------------------- 0.5408637523651123
generate_one_block  0.05882692337036133
generate_one_block  0.0604252815246582
generate_one_block  0.06096363067626953
generate_one_block  0.0617070198059082
generate_one_block  0.06163501739501953
generate_one_block  0.06073164939880371
generate_one_block  0.06510782241821289
generate_one_block  0.0621945858001709
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03131985664367676
gen group dst list time:  0.015648365020751953
time for parepare:  0.0191037654876709
local_output_nid generation:  0.011294841766357422
local_in_edges_tensor generation:  0.024254798889160156
mini_batch_src_global generation:  0.03147125244140625
r_  generation:  0.3111441135406494
local_output_nid generation:  0.01774907112121582
local_in_edges_tensor generation:  0.023584842681884766
mini_batch_src_global generation:  0.043150901794433594
r_  generation:  0.3276386260986328
local_output_nid generation:  0.018980979919433594
local_in_edges_tensor generation:  0.019613265991210938
mini_batch_src_global generation:  0.038475990295410156
r_  generation:  0.33803558349609375
local_output_nid generation:  0.01891803741455078
local_in_edges_tensor generation:  0.0184023380279541
mini_batch_src_global generation:  0.03932690620422363
r_  generation:  0.33516573905944824
local_output_nid generation:  0.01935720443725586
local_in_edges_tensor generation:  0.018846988677978516
mini_batch_src_global generation:  0.03972578048706055
r_  generation:  0.3374903202056885
local_output_nid generation:  0.01814436912536621
local_in_edges_tensor generation:  0.01880335807800293
mini_batch_src_global generation:  0.04011678695678711
r_  generation:  0.3335576057434082
local_output_nid generation:  0.018629074096679688
local_in_edges_tensor generation:  0.021676301956176758
mini_batch_src_global generation:  0.040956974029541016
r_  generation:  0.3424079418182373
local_output_nid generation:  0.02024054527282715
local_in_edges_tensor generation:  0.01851367950439453
mini_batch_src_global generation:  0.041604042053222656
r_  generation:  0.34294557571411133
----------------------check_connections_block total spend ----------------------------- 3.876218557357788
generate_one_block  0.42858028411865234
generate_one_block  0.4286308288574219
generate_one_block  0.4366588592529297
generate_one_block  0.43989014625549316
generate_one_block  0.4360325336456299
generate_one_block  0.4333837032318115
generate_one_block  0.4434483051300049
generate_one_block  0.4811289310455322
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030544042587280273
gen group dst list time:  0.04181861877441406
time for parepare:  0.021207809448242188
local_output_nid generation:  0.026635169982910156
local_in_edges_tensor generation:  0.047917842864990234
mini_batch_src_global generation:  0.04369521141052246
r_  generation:  0.4734632968902588
local_output_nid generation:  0.033086538314819336
local_in_edges_tensor generation:  0.04301047325134277
mini_batch_src_global generation:  0.05628180503845215
r_  generation:  0.48021411895751953
local_output_nid generation:  0.033678293228149414
local_in_edges_tensor generation:  0.0370330810546875
mini_batch_src_global generation:  0.0553441047668457
r_  generation:  0.4925966262817383
local_output_nid generation:  0.034099578857421875
local_in_edges_tensor generation:  0.03210139274597168
mini_batch_src_global generation:  0.056096792221069336
r_  generation:  0.4876739978790283
local_output_nid generation:  0.033865928649902344
local_in_edges_tensor generation:  0.03258800506591797
mini_batch_src_global generation:  0.05297231674194336
r_  generation:  0.4982607364654541
local_output_nid generation:  0.04558587074279785
local_in_edges_tensor generation:  0.0319974422454834
mini_batch_src_global generation:  0.055228233337402344
r_  generation:  0.49071621894836426
local_output_nid generation:  0.03475832939147949
local_in_edges_tensor generation:  0.03643012046813965
mini_batch_src_global generation:  0.05553913116455078
r_  generation:  0.5044200420379639
local_output_nid generation:  0.03435206413269043
local_in_edges_tensor generation:  0.03813600540161133
mini_batch_src_global generation:  0.05563616752624512
r_  generation:  0.4930877685546875
----------------------check_connections_block total spend ----------------------------- 5.806286573410034
generate_one_block  0.6173458099365234
generate_one_block  0.6172747611999512
generate_one_block  0.6146950721740723
generate_one_block  0.6139438152313232
generate_one_block  0.6164426803588867
generate_one_block  0.6069586277008057
generate_one_block  0.6260292530059814
generate_one_block  0.6325106620788574
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13273334503173828  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

connection checking time:  9.682505130767822
block generation total time  8.472954273223877
average batch blocks generation time:  1.0591192841529846
block dataloader generation time/epoch 20.046336242130824
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1022481918334961  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9322152137756348  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1027984619140625  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9366254806518555  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1028437614440918  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9394512176513672  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10180425643920898  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9375834465026855  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10224008560180664  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9371914863586426  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10223579406738281  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9340219497680664  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10280799865722656  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9404387474060059  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10178136825561523  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9396052360534668  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08383098244667053 |0.016016662120819092 |0.00356447696685791 |9.000301361083984e-05 |0.0037112534046173096 |0.0013020038604736328 |
----------------------------------------------------------pseudo_mini_loss sum 1.39565908908844
Total (block generation + training)time/epoch 20.982889788491384
Training time/epoch 0.9326536655426025
Training time without block to device /epoch 0.8045203685760498
Training time without total dataloading part /epoch 0.06022787094116211
load block tensor time/epoch 0.6706478595733643
block to device time/epoch 0.12813329696655273
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  3020602
Number of first layer input nodes during this epoch:  1287460
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1331944465637207  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02570056915283203
range selection method range initialization spend 0.012313127517700195
time for parepare:  0.017000198364257812
local_output_nid generation:  0.0027513504028320312
local_in_edges_tensor generation:  0.008015871047973633
mini_batch_src_global generation:  0.0036444664001464844
r_  generation:  0.04273176193237305
local_output_nid generation:  0.003206491470336914
local_in_edges_tensor generation:  0.0017960071563720703
mini_batch_src_global generation:  0.0048062801361083984
r_  generation:  0.04520225524902344
local_output_nid generation:  0.0031557083129882812
local_in_edges_tensor generation:  0.0018095970153808594
mini_batch_src_global generation:  0.0032501220703125
r_  generation:  0.04502058029174805
local_output_nid generation:  0.003215789794921875
local_in_edges_tensor generation:  0.0017943382263183594
mini_batch_src_global generation:  0.003319263458251953
r_  generation:  0.045476436614990234
local_output_nid generation:  0.0032205581665039062
local_in_edges_tensor generation:  0.001817941665649414
mini_batch_src_global generation:  0.0035943984985351562
r_  generation:  0.046512603759765625
local_output_nid generation:  0.003173351287841797
local_in_edges_tensor generation:  0.0019466876983642578
mini_batch_src_global generation:  0.0036423206329345703
r_  generation:  0.04780268669128418
local_output_nid generation:  0.003239870071411133
local_in_edges_tensor generation:  0.0018291473388671875
mini_batch_src_global generation:  0.003638029098510742
r_  generation:  0.0472261905670166
local_output_nid generation:  0.0032172203063964844
local_in_edges_tensor generation:  0.0018393993377685547
mini_batch_src_global generation:  0.0037796497344970703
r_  generation:  0.05033397674560547
----------------------check_connections_block total spend ----------------------------- 0.5420029163360596
generate_one_block  0.06137967109680176
generate_one_block  0.060994863510131836
generate_one_block  0.061161041259765625
generate_one_block  0.061417579650878906
generate_one_block  0.06110954284667969
generate_one_block  0.061631202697753906
generate_one_block  0.06449103355407715
generate_one_block  0.06150054931640625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.034160614013671875
gen group dst list time:  0.016063213348388672
time for parepare:  0.018997669219970703
local_output_nid generation:  0.011727333068847656
local_in_edges_tensor generation:  0.024265766143798828
mini_batch_src_global generation:  0.030665159225463867
r_  generation:  0.3195943832397461
local_output_nid generation:  0.018302202224731445
local_in_edges_tensor generation:  0.018801450729370117
mini_batch_src_global generation:  0.03910470008850098
r_  generation:  0.32431459426879883
local_output_nid generation:  0.018433809280395508
local_in_edges_tensor generation:  0.01805710792541504
mini_batch_src_global generation:  0.0386507511138916
r_  generation:  0.33596134185791016
local_output_nid generation:  0.01873183250427246
local_in_edges_tensor generation:  0.023505210876464844
mini_batch_src_global generation:  0.04053854942321777
r_  generation:  0.33013200759887695
local_output_nid generation:  0.019194364547729492
local_in_edges_tensor generation:  0.01929616928100586
mini_batch_src_global generation:  0.04194450378417969
r_  generation:  0.3362612724304199
local_output_nid generation:  0.01807546615600586
local_in_edges_tensor generation:  0.0188291072845459
mini_batch_src_global generation:  0.04071307182312012
r_  generation:  0.33709216117858887
local_output_nid generation:  0.01797318458557129
local_in_edges_tensor generation:  0.018873214721679688
mini_batch_src_global generation:  0.04042315483093262
r_  generation:  0.3342430591583252
local_output_nid generation:  0.01807379722595215
local_in_edges_tensor generation:  0.019751310348510742
mini_batch_src_global generation:  0.04230833053588867
r_  generation:  0.33940935134887695
----------------------check_connections_block total spend ----------------------------- 3.865112066268921
generate_one_block  0.4313979148864746
generate_one_block  0.4285886287689209
generate_one_block  0.4343140125274658
generate_one_block  0.42284178733825684
generate_one_block  0.42985057830810547
generate_one_block  0.43034791946411133
generate_one_block  0.4375028610229492
generate_one_block  0.46338558197021484
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.041754961013793945
gen group dst list time:  0.03782367706298828
time for parepare:  0.019628286361694336
local_output_nid generation:  0.02739238739013672
local_in_edges_tensor generation:  0.04965949058532715
mini_batch_src_global generation:  0.04445028305053711
r_  generation:  0.47361063957214355
local_output_nid generation:  0.033077239990234375
local_in_edges_tensor generation:  0.03995323181152344
mini_batch_src_global generation:  0.05495715141296387
r_  generation:  0.48215460777282715
local_output_nid generation:  0.03348803520202637
local_in_edges_tensor generation:  0.03433418273925781
mini_batch_src_global generation:  0.050229549407958984
r_  generation:  0.49253392219543457
local_output_nid generation:  0.03347468376159668
local_in_edges_tensor generation:  0.03233456611633301
mini_batch_src_global generation:  0.05320453643798828
r_  generation:  0.490541934967041
local_output_nid generation:  0.03380751609802246
local_in_edges_tensor generation:  0.03384757041931152
mini_batch_src_global generation:  0.052509307861328125
r_  generation:  0.49989795684814453
local_output_nid generation:  0.03415060043334961
local_in_edges_tensor generation:  0.03640007972717285
mini_batch_src_global generation:  0.05539274215698242
r_  generation:  0.49352598190307617
local_output_nid generation:  0.03368115425109863
local_in_edges_tensor generation:  0.03223395347595215
mini_batch_src_global generation:  0.05376100540161133
r_  generation:  0.501206636428833
local_output_nid generation:  0.033763885498046875
local_in_edges_tensor generation:  0.032303810119628906
mini_batch_src_global generation:  0.05770254135131836
r_  generation:  0.4919414520263672
----------------------check_connections_block total spend ----------------------------- 5.781331300735474
generate_one_block  0.6033029556274414
generate_one_block  0.611365556716919
generate_one_block  0.6197865009307861
generate_one_block  0.6118781566619873
generate_one_block  0.6168327331542969
generate_one_block  0.6119961738586426
generate_one_block  0.6035702228546143
generate_one_block  0.6121735572814941
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1331944465637207  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

connection checking time:  9.646443367004395
block generation total time  8.36913514137268
average batch blocks generation time:  1.046141892671585
block dataloader generation time/epoch 20.04090791940689
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10225152969360352  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9379606246948242  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10231828689575195  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9359450340270996  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10259437561035156  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9376258850097656  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1021127700805664  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9360957145690918  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10254240036010742  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9365706443786621  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10270261764526367  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.938560962677002  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10213756561279297  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9362330436706543  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10259675979614258  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9363789558410645  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08467736840248108 |0.013456910848617554 |0.003554731607437134 |9.053945541381836e-05 |0.0037658512592315674 |0.0013039112091064453 |
----------------------------------------------------------pseudo_mini_loss sum 1.3739426136016846
Total (block generation + training)time/epoch 20.974697202444077
Training time/epoch 0.9142475128173828
Training time without block to device /epoch 0.8065922260284424
Training time without total dataloading part /epoch 0.0605928897857666
load block tensor time/epoch 0.6774189472198486
block to device time/epoch 0.10765528678894043
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  3019368
Number of first layer input nodes during this epoch:  1287061
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13367414474487305  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023951053619384766
range selection method range initialization spend 0.012259483337402344
time for parepare:  0.016680240631103516
local_output_nid generation:  0.002765655517578125
local_in_edges_tensor generation:  0.004066944122314453
mini_batch_src_global generation:  0.003498554229736328
r_  generation:  0.04291987419128418
local_output_nid generation:  0.0031926631927490234
local_in_edges_tensor generation:  0.0017886161804199219
mini_batch_src_global generation:  0.004889726638793945
r_  generation:  0.04514193534851074
local_output_nid generation:  0.003185749053955078
local_in_edges_tensor generation:  0.0018131732940673828
mini_batch_src_global generation:  0.003367900848388672
r_  generation:  0.04645872116088867
local_output_nid generation:  0.0032699108123779297
local_in_edges_tensor generation:  0.0017855167388916016
mini_batch_src_global generation:  0.0033223628997802734
r_  generation:  0.04589438438415527
local_output_nid generation:  0.003228425979614258
local_in_edges_tensor generation:  0.001821756362915039
mini_batch_src_global generation:  0.003614664077758789
r_  generation:  0.047476768493652344
local_output_nid generation:  0.0031969547271728516
local_in_edges_tensor generation:  0.0018284320831298828
mini_batch_src_global generation:  0.003720998764038086
r_  generation:  0.04874610900878906
local_output_nid generation:  0.0031976699829101562
local_in_edges_tensor generation:  0.001821279525756836
mini_batch_src_global generation:  0.0037987232208251953
r_  generation:  0.04753875732421875
local_output_nid generation:  0.003223419189453125
local_in_edges_tensor generation:  0.0019073486328125
mini_batch_src_global generation:  0.0037784576416015625
r_  generation:  0.049082040786743164
----------------------check_connections_block total spend ----------------------------- 0.5419535636901855
generate_one_block  0.05963897705078125
generate_one_block  0.06095266342163086
generate_one_block  0.062218666076660156
generate_one_block  0.06055259704589844
generate_one_block  0.06161832809448242
generate_one_block  0.06245565414428711
generate_one_block  0.06423568725585938
generate_one_block  0.061887264251708984
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03232884407043457
gen group dst list time:  0.015557289123535156
time for parepare:  0.01950669288635254
local_output_nid generation:  0.011362552642822266
local_in_edges_tensor generation:  0.021646976470947266
mini_batch_src_global generation:  0.031998634338378906
r_  generation:  0.315340518951416
local_output_nid generation:  0.01763916015625
local_in_edges_tensor generation:  0.02326798439025879
mini_batch_src_global generation:  0.040186405181884766
r_  generation:  0.32836294174194336
local_output_nid generation:  0.018731117248535156
local_in_edges_tensor generation:  0.020262479782104492
mini_batch_src_global generation:  0.03841686248779297
r_  generation:  0.33423376083374023
local_output_nid generation:  0.018659591674804688
local_in_edges_tensor generation:  0.01882195472717285
mini_batch_src_global generation:  0.03939104080200195
r_  generation:  0.33191990852355957
local_output_nid generation:  0.02056717872619629
local_in_edges_tensor generation:  0.01848292350769043
mini_batch_src_global generation:  0.040074825286865234
r_  generation:  0.33712220191955566
local_output_nid generation:  0.0187222957611084
local_in_edges_tensor generation:  0.018293142318725586
mini_batch_src_global generation:  0.04031682014465332
r_  generation:  0.3403146266937256
local_output_nid generation:  0.018082380294799805
local_in_edges_tensor generation:  0.018792390823364258
mini_batch_src_global generation:  0.04039406776428223
r_  generation:  0.33521485328674316
local_output_nid generation:  0.018328189849853516
local_in_edges_tensor generation:  0.018842220306396484
mini_batch_src_global generation:  0.04101204872131348
r_  generation:  0.34061408042907715
----------------------check_connections_block total spend ----------------------------- 3.861194372177124
generate_one_block  0.4236905574798584
generate_one_block  0.4272801876068115
generate_one_block  0.4298110008239746
generate_one_block  0.4214901924133301
generate_one_block  0.42651939392089844
generate_one_block  0.43126749992370605
generate_one_block  0.42543745040893555
generate_one_block  0.4537339210510254
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03483128547668457
gen group dst list time:  0.037857770919799805
time for parepare:  0.01894664764404297
local_output_nid generation:  0.025774717330932617
local_in_edges_tensor generation:  0.03656458854675293
mini_batch_src_global generation:  0.04330778121948242
r_  generation:  0.47370052337646484
local_output_nid generation:  0.03296995162963867
local_in_edges_tensor generation:  0.034288644790649414
mini_batch_src_global generation:  0.055901527404785156
r_  generation:  0.4796910285949707
local_output_nid generation:  0.033368825912475586
local_in_edges_tensor generation:  0.03198075294494629
mini_batch_src_global generation:  0.05056047439575195
r_  generation:  0.49126219749450684
local_output_nid generation:  0.03393268585205078
local_in_edges_tensor generation:  0.03527188301086426
mini_batch_src_global generation:  0.053826093673706055
r_  generation:  0.4844515323638916
local_output_nid generation:  0.03408408164978027
local_in_edges_tensor generation:  0.031182289123535156
mini_batch_src_global generation:  0.05265021324157715
r_  generation:  0.49329066276550293
local_output_nid generation:  0.034168243408203125
local_in_edges_tensor generation:  0.03303670883178711
mini_batch_src_global generation:  0.05463218688964844
r_  generation:  0.4908590316772461
local_output_nid generation:  0.03442263603210449
local_in_edges_tensor generation:  0.03176093101501465
mini_batch_src_global generation:  0.05317258834838867
r_  generation:  0.4979746341705322
local_output_nid generation:  0.03484463691711426
local_in_edges_tensor generation:  0.0321812629699707
mini_batch_src_global generation:  0.05473780632019043
r_  generation:  0.4869198799133301
----------------------check_connections_block total spend ----------------------------- 5.730060577392578
generate_one_block  0.6064858436584473
generate_one_block  0.6057512760162354
generate_one_block  0.6127023696899414
generate_one_block  0.6065244674682617
generate_one_block  0.6038434505462646
generate_one_block  0.6087357997894287
generate_one_block  0.6051928997039795
generate_one_block  0.605806827545166
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13367414474487305  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

connection checking time:  9.591254949569702
block generation total time  8.294273138046265
average batch blocks generation time:  1.036784142255783
block dataloader generation time/epoch 20.018647140926785
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10269498825073242  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9358248710632324  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10261917114257812  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9366202354431152  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10280609130859375  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9397258758544922  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10167264938354492  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9348020553588867  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10228872299194336  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9367117881774902  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10264253616333008  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9375619888305664  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10216522216796875  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9342212677001953  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10269355773925781  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9370846748352051  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08259645104408264 |0.01578599214553833 |0.003486037254333496 |8.705258369445801e-05 |0.00375974178314209 |0.0013873577117919922 |
----------------------------------------------------------pseudo_mini_loss sum 1.3537722826004028
Total (block generation + training)time/epoch 20.950963682598537
Training time/epoch 0.9204072952270508
Training time without block to device /epoch 0.7941193580627441
Training time without total dataloading part /epoch 0.060050010681152344
load block tensor time/epoch 0.6607716083526611
block to device time/epoch 0.12628793716430664
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  3019083
Number of first layer input nodes during this epoch:  1287805
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13332271575927734  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03206038475036621
range selection method range initialization spend 0.012361764907836914
time for parepare:  0.015865087509155273
local_output_nid generation:  0.0027840137481689453
local_in_edges_tensor generation:  0.004213094711303711
mini_batch_src_global generation:  0.0036165714263916016
r_  generation:  0.04320383071899414
local_output_nid generation:  0.0031659603118896484
local_in_edges_tensor generation:  0.0017938613891601562
mini_batch_src_global generation:  0.004836082458496094
r_  generation:  0.045011281967163086
local_output_nid generation:  0.0031893253326416016
local_in_edges_tensor generation:  0.0018050670623779297
mini_batch_src_global generation:  0.003238201141357422
r_  generation:  0.044568538665771484
local_output_nid generation:  0.003177165985107422
local_in_edges_tensor generation:  0.0018358230590820312
mini_batch_src_global generation:  0.0033168792724609375
r_  generation:  0.04660367965698242
local_output_nid generation:  0.0031812191009521484
local_in_edges_tensor generation:  0.0018048286437988281
mini_batch_src_global generation:  0.0036547183990478516
r_  generation:  0.047338247299194336
local_output_nid generation:  0.0031995773315429688
local_in_edges_tensor generation:  0.0019681453704833984
mini_batch_src_global generation:  0.003789663314819336
r_  generation:  0.050961971282958984
local_output_nid generation:  0.0034186840057373047
local_in_edges_tensor generation:  0.002017974853515625
mini_batch_src_global generation:  0.003836393356323242
r_  generation:  0.04739880561828613
local_output_nid generation:  0.0034017562866210938
local_in_edges_tensor generation:  0.0019457340240478516
mini_batch_src_global generation:  0.003779888153076172
r_  generation:  0.04789018630981445
----------------------check_connections_block total spend ----------------------------- 0.5465638637542725
generate_one_block  0.061290740966796875
generate_one_block  0.060840606689453125
generate_one_block  0.060240983963012695
generate_one_block  0.06140542030334473
generate_one_block  0.061722755432128906
generate_one_block  0.062264204025268555
generate_one_block  0.0643165111541748
generate_one_block  0.06129813194274902
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03299522399902344
gen group dst list time:  0.015777587890625
time for parepare:  0.019206762313842773
local_output_nid generation:  0.011689901351928711
local_in_edges_tensor generation:  0.02850818634033203
mini_batch_src_global generation:  0.032462120056152344
r_  generation:  0.31690406799316406
local_output_nid generation:  0.0175931453704834
local_in_edges_tensor generation:  0.02386474609375
mini_batch_src_global generation:  0.03915524482727051
r_  generation:  0.3293190002441406
local_output_nid generation:  0.01832723617553711
local_in_edges_tensor generation:  0.01836848258972168
mini_batch_src_global generation:  0.03849053382873535
r_  generation:  0.3269832134246826
local_output_nid generation:  0.018559932708740234
local_in_edges_tensor generation:  0.020061492919921875
mini_batch_src_global generation:  0.04085683822631836
r_  generation:  0.33513545989990234
local_output_nid generation:  0.01917099952697754
local_in_edges_tensor generation:  0.020291566848754883
mini_batch_src_global generation:  0.04076123237609863
r_  generation:  0.33477115631103516
local_output_nid generation:  0.018511295318603516
local_in_edges_tensor generation:  0.020489215850830078
mini_batch_src_global generation:  0.04294896125793457
r_  generation:  0.33907532691955566
local_output_nid generation:  0.01803898811340332
local_in_edges_tensor generation:  0.018598556518554688
mini_batch_src_global generation:  0.04062604904174805
r_  generation:  0.33389782905578613
local_output_nid generation:  0.01826620101928711
local_in_edges_tensor generation:  0.019802093505859375
mini_batch_src_global generation:  0.0410308837890625
r_  generation:  0.337282657623291
----------------------check_connections_block total spend ----------------------------- 3.864593744277954
generate_one_block  0.4309675693511963
generate_one_block  0.43035101890563965
generate_one_block  0.42180800437927246
generate_one_block  0.429901123046875
generate_one_block  0.4294700622558594
generate_one_block  0.43052124977111816
generate_one_block  0.4257090091705322
generate_one_block  0.45034074783325195
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029469728469848633
gen group dst list time:  0.03770637512207031
time for parepare:  0.018442153930664062
local_output_nid generation:  0.025751113891601562
local_in_edges_tensor generation:  0.03657793998718262
mini_batch_src_global generation:  0.045102834701538086
r_  generation:  0.47460222244262695
local_output_nid generation:  0.032131195068359375
local_in_edges_tensor generation:  0.03850746154785156
mini_batch_src_global generation:  0.05396127700805664
r_  generation:  0.47947001457214355
local_output_nid generation:  0.03339505195617676
local_in_edges_tensor generation:  0.0341336727142334
mini_batch_src_global generation:  0.05104804039001465
r_  generation:  0.4932131767272949
local_output_nid generation:  0.03387117385864258
local_in_edges_tensor generation:  0.03422260284423828
mini_batch_src_global generation:  0.053751468658447266
r_  generation:  0.4892845153808594
local_output_nid generation:  0.03412437438964844
local_in_edges_tensor generation:  0.03396797180175781
mini_batch_src_global generation:  0.052677154541015625
r_  generation:  0.4964761734008789
local_output_nid generation:  0.034453630447387695
local_in_edges_tensor generation:  0.03103780746459961
mini_batch_src_global generation:  0.05527162551879883
r_  generation:  0.4849259853363037
local_output_nid generation:  0.03423571586608887
local_in_edges_tensor generation:  0.03193807601928711
mini_batch_src_global generation:  0.0533447265625
r_  generation:  0.501596212387085
local_output_nid generation:  0.034407615661621094
local_in_edges_tensor generation:  0.03282618522644043
mini_batch_src_global generation:  0.05697298049926758
r_  generation:  0.48806190490722656
----------------------check_connections_block total spend ----------------------------- 5.7510435581207275
generate_one_block  0.6078824996948242
generate_one_block  0.6095833778381348
generate_one_block  0.6115748882293701
generate_one_block  0.6084527969360352
generate_one_block  0.6053593158721924
generate_one_block  0.6132667064666748
generate_one_block  0.6031103134155273
generate_one_block  0.6095335483551025
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13332271575927734  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

connection checking time:  9.615637302398682
block generation total time  8.317832231521606
average batch blocks generation time:  1.0397290289402008
block dataloader generation time/epoch 20.0046808719635
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10253715515136719  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9393148422241211  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10165071487426758  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9371089935302734  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10220146179199219  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9356989860534668  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10269308090209961  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9387087821960449  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10152626037597656  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9332685470581055  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10267257690429688  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9376969337463379  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10221147537231445  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9355959892272949  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1026010513305664  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9370207786560059  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08300092816352844 |0.011673450469970703 |0.003631889820098877 |9.140372276306152e-05 |0.0037526190280914307 |0.0029430389404296875 |
----------------------------------------------------------pseudo_mini_loss sum 1.3348561525344849
Total (block generation + training)time/epoch 20.93398106098175
Training time/epoch 0.9018783569335938
Training time without block to device /epoch 0.8084907531738281
Training time without total dataloading part /epoch 0.06275033950805664
load block tensor time/epoch 0.6640074253082275
block to device time/epoch 0.09338760375976562
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  3018366
Number of first layer input nodes during this epoch:  1286468
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13326358795166016  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019278764724731445
range selection method range initialization spend 0.011849403381347656
time for parepare:  0.016379594802856445
local_output_nid generation:  0.002694845199584961
local_in_edges_tensor generation:  0.004153013229370117
mini_batch_src_global generation:  0.0035572052001953125
r_  generation:  0.043587684631347656
local_output_nid generation:  0.003150463104248047
local_in_edges_tensor generation:  0.0017671585083007812
mini_batch_src_global generation:  0.004788875579833984
r_  generation:  0.043243408203125
local_output_nid generation:  0.0032231807708740234
local_in_edges_tensor generation:  0.001949310302734375
mini_batch_src_global generation:  0.003394603729248047
r_  generation:  0.046279191970825195
local_output_nid generation:  0.0031867027282714844
local_in_edges_tensor generation:  0.0017969608306884766
mini_batch_src_global generation:  0.0034313201904296875
r_  generation:  0.04647207260131836
local_output_nid generation:  0.003271818161010742
local_in_edges_tensor generation:  0.0018067359924316406
mini_batch_src_global generation:  0.003622293472290039
r_  generation:  0.04673027992248535
local_output_nid generation:  0.0031697750091552734
local_in_edges_tensor generation:  0.0018384456634521484
mini_batch_src_global generation:  0.0037331581115722656
r_  generation:  0.048067331314086914
local_output_nid generation:  0.0032944679260253906
local_in_edges_tensor generation:  0.0018117427825927734
mini_batch_src_global generation:  0.0038175582885742188
r_  generation:  0.048456430435180664
local_output_nid generation:  0.0032737255096435547
local_in_edges_tensor generation:  0.0018200874328613281
mini_batch_src_global generation:  0.0038099288940429688
r_  generation:  0.04906320571899414
----------------------check_connections_block total spend ----------------------------- 0.540717363357544
generate_one_block  0.05951428413391113
generate_one_block  0.05908346176147461
generate_one_block  0.0614314079284668
generate_one_block  0.0611724853515625
generate_one_block  0.06052756309509277
generate_one_block  0.062177419662475586
generate_one_block  0.06455373764038086
generate_one_block  0.062325239181518555
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02738189697265625
gen group dst list time:  0.015373945236206055
time for parepare:  0.0201108455657959
local_output_nid generation:  0.011715888977050781
local_in_edges_tensor generation:  0.023256540298461914
mini_batch_src_global generation:  0.03058171272277832
r_  generation:  0.31241774559020996
local_output_nid generation:  0.018968582153320312
local_in_edges_tensor generation:  0.02356696128845215
mini_batch_src_global generation:  0.03948473930358887
r_  generation:  0.3207871913909912
local_output_nid generation:  0.02028346061706543
local_in_edges_tensor generation:  0.02081894874572754
mini_batch_src_global generation:  0.03876185417175293
r_  generation:  0.33470749855041504
local_output_nid generation:  0.020421743392944336
local_in_edges_tensor generation:  0.018839597702026367
mini_batch_src_global generation:  0.039618492126464844
r_  generation:  0.3362092971801758
local_output_nid generation:  0.020745277404785156
local_in_edges_tensor generation:  0.01880192756652832
mini_batch_src_global generation:  0.0398411750793457
r_  generation:  0.331789493560791
local_output_nid generation:  0.02099776268005371
local_in_edges_tensor generation:  0.020418167114257812
mini_batch_src_global generation:  0.04083585739135742
r_  generation:  0.34509825706481934
local_output_nid generation:  0.019983768463134766
local_in_edges_tensor generation:  0.019269704818725586
mini_batch_src_global generation:  0.04077792167663574
r_  generation:  0.339968204498291
local_output_nid generation:  0.020055294036865234
local_in_edges_tensor generation:  0.019181251525878906
mini_batch_src_global generation:  0.04028511047363281
r_  generation:  0.33887743949890137
----------------------check_connections_block total spend ----------------------------- 3.871337652206421
generate_one_block  0.4238765239715576
generate_one_block  0.4164865016937256
generate_one_block  0.43026113510131836
generate_one_block  0.4273080825805664
generate_one_block  0.42159056663513184
generate_one_block  0.4327507019042969
generate_one_block  0.42644214630126953
generate_one_block  0.44844961166381836
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02391195297241211
gen group dst list time:  0.037975311279296875
time for parepare:  0.018471717834472656
local_output_nid generation:  0.02619647979736328
local_in_edges_tensor generation:  0.03627514839172363
mini_batch_src_global generation:  0.04450082778930664
r_  generation:  0.47649312019348145
local_output_nid generation:  0.03431057929992676
local_in_edges_tensor generation:  0.032918691635131836
mini_batch_src_global generation:  0.0536196231842041
r_  generation:  0.4772012233734131
local_output_nid generation:  0.03543257713317871
local_in_edges_tensor generation:  0.0351405143737793
mini_batch_src_global generation:  0.05021786689758301
r_  generation:  0.49691176414489746
local_output_nid generation:  0.036151885986328125
local_in_edges_tensor generation:  0.030566692352294922
mini_batch_src_global generation:  0.05331540107727051
r_  generation:  0.4913463592529297
local_output_nid generation:  0.0364985466003418
local_in_edges_tensor generation:  0.03377676010131836
mini_batch_src_global generation:  0.05492138862609863
r_  generation:  0.4990425109863281
local_output_nid generation:  0.0360872745513916
local_in_edges_tensor generation:  0.03601670265197754
mini_batch_src_global generation:  0.05441856384277344
r_  generation:  0.4892263412475586
local_output_nid generation:  0.03577685356140137
local_in_edges_tensor generation:  0.030920028686523438
mini_batch_src_global generation:  0.05240154266357422
r_  generation:  0.5051069259643555
local_output_nid generation:  0.03630661964416504
local_in_edges_tensor generation:  0.031351327896118164
mini_batch_src_global generation:  0.05456113815307617
r_  generation:  0.4887685775756836
----------------------check_connections_block total spend ----------------------------- 5.7596423625946045
generate_one_block  0.6029798984527588
generate_one_block  0.6087384223937988
generate_one_block  0.610135555267334
generate_one_block  0.6049070358276367
generate_one_block  0.6047663688659668
generate_one_block  0.6068954467773438
generate_one_block  0.6103971004486084
generate_one_block  0.6060130596160889
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13326358795166016  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

connection checking time:  9.630980014801025
block generation total time  8.28199815750122
average batch blocks generation time:  1.0352497696876526
block dataloader generation time/epoch 19.987831939350475
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10238265991210938  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9356203079223633  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.102325439453125  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9296917915344238  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10242700576782227  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9402709007263184  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10157060623168945  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9361701011657715  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10207128524780273  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9315872192382812  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10296249389648438  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9413666725158691  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1016240119934082  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9364500045776367  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10265016555786133  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9397692680358887  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08124357461929321 |0.014205873012542725 |0.003761202096939087 |9.578466415405273e-05 |0.003461211919784546 |0.001232147216796875 |
----------------------------------------------------------pseudo_mini_loss sum 1.3307607173919678
Total (block generation + training)time/epoch 20.913754138079558
Training time/epoch 0.8919253349304199
Training time without block to device /epoch 0.7782783508300781
Training time without total dataloading part /epoch 0.05977773666381836
load block tensor time/epoch 0.6499485969543457
block to device time/epoch 0.1136469841003418
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 20 |
Number of nodes for computation during this epoch:  3017215
Number of first layer input nodes during this epoch:  1286633
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13313722610473633  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026843786239624023
range selection method range initialization spend 0.013839244842529297
time for parepare:  0.018260955810546875
local_output_nid generation:  0.002794027328491211
local_in_edges_tensor generation:  0.007945060729980469
mini_batch_src_global generation:  0.004087924957275391
r_  generation:  0.04581642150878906
local_output_nid generation:  0.0031578540802001953
local_in_edges_tensor generation:  0.0020470619201660156
mini_batch_src_global generation:  0.004979848861694336
r_  generation:  0.044291019439697266
local_output_nid generation:  0.0031976699829101562
local_in_edges_tensor generation:  0.0018091201782226562
mini_batch_src_global generation:  0.0032999515533447266
r_  generation:  0.04557394981384277
local_output_nid generation:  0.0032167434692382812
local_in_edges_tensor generation:  0.00180816650390625
mini_batch_src_global generation:  0.0033681392669677734
r_  generation:  0.04755806922912598
local_output_nid generation:  0.003236055374145508
local_in_edges_tensor generation:  0.001981973648071289
mini_batch_src_global generation:  0.0037355422973632812
r_  generation:  0.048099517822265625
local_output_nid generation:  0.003247976303100586
local_in_edges_tensor generation:  0.0018243789672851562
mini_batch_src_global generation:  0.007768392562866211
r_  generation:  0.047739267349243164
local_output_nid generation:  0.0032198429107666016
local_in_edges_tensor generation:  0.0018842220306396484
mini_batch_src_global generation:  0.0038993358612060547
r_  generation:  0.04822659492492676
local_output_nid generation:  0.003258228302001953
local_in_edges_tensor generation:  0.0018939971923828125
mini_batch_src_global generation:  0.0037860870361328125
r_  generation:  0.047914743423461914
----------------------check_connections_block total spend ----------------------------- 0.5556948184967041
generate_one_block  0.0605921745300293
generate_one_block  0.06152153015136719
generate_one_block  0.061167240142822266
generate_one_block  0.0623166561126709
generate_one_block  0.0634775161743164
generate_one_block  0.06184053421020508
generate_one_block  0.06489777565002441
generate_one_block  0.06168532371520996
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03389549255371094
gen group dst list time:  0.01533365249633789
time for parepare:  0.019165515899658203
local_output_nid generation:  0.011556148529052734
local_in_edges_tensor generation:  0.027962207794189453
mini_batch_src_global generation:  0.03254556655883789
r_  generation:  0.3169901371002197
local_output_nid generation:  0.017685413360595703
local_in_edges_tensor generation:  0.024600982666015625
mini_batch_src_global generation:  0.03851580619812012
r_  generation:  0.3261740207672119
local_output_nid generation:  0.018494606018066406
local_in_edges_tensor generation:  0.019598007202148438
mini_batch_src_global generation:  0.03876233100891113
r_  generation:  0.33350205421447754
local_output_nid generation:  0.018415212631225586
local_in_edges_tensor generation:  0.019327878952026367
mini_batch_src_global generation:  0.03953385353088379
r_  generation:  0.33462953567504883
local_output_nid generation:  0.019397974014282227
local_in_edges_tensor generation:  0.01822376251220703
mini_batch_src_global generation:  0.04072713851928711
r_  generation:  0.34272289276123047
local_output_nid generation:  0.018375873565673828
local_in_edges_tensor generation:  0.020121335983276367
mini_batch_src_global generation:  0.041578054428100586
r_  generation:  0.3425607681274414
local_output_nid generation:  0.0182492733001709
local_in_edges_tensor generation:  0.018779754638671875
mini_batch_src_global generation:  0.041126251220703125
r_  generation:  0.3424720764160156
local_output_nid generation:  0.018291950225830078
local_in_edges_tensor generation:  0.021090269088745117
mini_batch_src_global generation:  0.041126251220703125
r_  generation:  0.3387596607208252
----------------------check_connections_block total spend ----------------------------- 3.8891172409057617
generate_one_block  0.43727755546569824
generate_one_block  0.43018317222595215
generate_one_block  0.44075560569763184
generate_one_block  0.439403772354126
generate_one_block  0.44194531440734863
generate_one_block  0.44234704971313477
generate_one_block  0.4454641342163086
generate_one_block  0.46197509765625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0424349308013916
gen group dst list time:  0.038665771484375
time for parepare:  0.020067453384399414
local_output_nid generation:  0.026643753051757812
local_in_edges_tensor generation:  0.052266836166381836
mini_batch_src_global generation:  0.04544377326965332
r_  generation:  0.474285364151001
local_output_nid generation:  0.03300929069519043
local_in_edges_tensor generation:  0.03965926170349121
mini_batch_src_global generation:  0.05419468879699707
r_  generation:  0.4794750213623047
local_output_nid generation:  0.03372693061828613
local_in_edges_tensor generation:  0.03459286689758301
mini_batch_src_global generation:  0.05089449882507324
r_  generation:  0.4987761974334717
local_output_nid generation:  0.03397798538208008
local_in_edges_tensor generation:  0.03408074378967285
mini_batch_src_global generation:  0.05377674102783203
r_  generation:  0.4967632293701172
local_output_nid generation:  0.034566402435302734
local_in_edges_tensor generation:  0.03387951850891113
mini_batch_src_global generation:  0.05187034606933594
r_  generation:  0.5050129890441895
local_output_nid generation:  0.03423929214477539
local_in_edges_tensor generation:  0.034061431884765625
mini_batch_src_global generation:  0.054280996322631836
r_  generation:  0.49556946754455566
local_output_nid generation:  0.03495526313781738
local_in_edges_tensor generation:  0.040392160415649414
mini_batch_src_global generation:  0.055722951889038086
r_  generation:  0.5070383548736572
local_output_nid generation:  0.035727500915527344
local_in_edges_tensor generation:  0.03954029083251953
mini_batch_src_global generation:  0.055370330810546875
r_  generation:  0.49675965309143066
----------------------check_connections_block total spend ----------------------------- 5.850567817687988
generate_one_block  0.6268315315246582
generate_one_block  0.6347360610961914
generate_one_block  0.6153552532196045
generate_one_block  0.6115303039550781
generate_one_block  0.6131925582885742
generate_one_block  0.6166696548461914
generate_one_block  0.6220216751098633
generate_one_block  0.6151077747344971
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13313722610473633  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

connection checking time:  9.73968505859375
block generation total time  8.494796514511108
average batch blocks generation time:  1.0618495643138885
block dataloader generation time/epoch 20.008910695711773
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10172224044799805  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9366030693054199  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10244560241699219  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9357538223266602  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1025705337524414  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.936518669128418  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10257625579833984  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9371762275695801  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10243892669677734  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9369125366210938  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1023397445678711  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9356307983398438  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10276269912719727  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9390010833740234  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10248565673828125  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9376139640808105  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0840296745300293 |0.01536610722541809 |0.0035969913005828857 |9.080767631530762e-05 |0.003760814666748047 |0.0016269683837890625 |
----------------------------------------------------------pseudo_mini_loss sum 1.308454155921936
Total (block generation + training)time/epoch 20.93522862593333
Training time/epoch 0.9304804801940918
Training time without block to device /epoch 0.8075516223907471
Training time without total dataloading part /epoch 0.061215877532958984
load block tensor time/epoch 0.6722373962402344
block to device time/epoch 0.12292885780334473
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 21 |
Number of nodes for computation during this epoch:  3018988
Number of first layer input nodes during this epoch:  1286800
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13319635391235352  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03208208084106445
range selection method range initialization spend 0.011905431747436523
time for parepare:  0.01625990867614746
local_output_nid generation:  0.0028541088104248047
local_in_edges_tensor generation:  0.007385730743408203
mini_batch_src_global generation:  0.0035414695739746094
r_  generation:  0.04456138610839844
local_output_nid generation:  0.0031516551971435547
local_in_edges_tensor generation:  0.0017910003662109375
mini_batch_src_global generation:  0.004927396774291992
r_  generation:  0.04474949836730957
local_output_nid generation:  0.003165721893310547
local_in_edges_tensor generation:  0.001804351806640625
mini_batch_src_global generation:  0.004233598709106445
r_  generation:  0.04888319969177246
local_output_nid generation:  0.0031845569610595703
local_in_edges_tensor generation:  0.0018153190612792969
mini_batch_src_global generation:  0.004074573516845703
r_  generation:  0.046279191970825195
local_output_nid generation:  0.0032129287719726562
local_in_edges_tensor generation:  0.0017931461334228516
mini_batch_src_global generation:  0.0036773681640625
r_  generation:  0.04654717445373535
local_output_nid generation:  0.0031914710998535156
local_in_edges_tensor generation:  0.0017631053924560547
mini_batch_src_global generation:  0.0036780834197998047
r_  generation:  0.04720187187194824
local_output_nid generation:  0.003200531005859375
local_in_edges_tensor generation:  0.0018322467803955078
mini_batch_src_global generation:  0.005354404449462891
r_  generation:  0.0480959415435791
local_output_nid generation:  0.0031952857971191406
local_in_edges_tensor generation:  0.0018317699432373047
mini_batch_src_global generation:  0.003809213638305664
r_  generation:  0.04739260673522949
----------------------check_connections_block total spend ----------------------------- 0.5542500019073486
generate_one_block  0.06348013877868652
generate_one_block  0.06077075004577637
generate_one_block  0.06155085563659668
generate_one_block  0.06109309196472168
generate_one_block  0.06106138229370117
generate_one_block  0.06149768829345703
generate_one_block  0.06466102600097656
generate_one_block  0.06140446662902832
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0378260612487793
gen group dst list time:  0.015432596206665039
time for parepare:  0.01905989646911621
local_output_nid generation:  0.01157522201538086
local_in_edges_tensor generation:  0.030625343322753906
mini_batch_src_global generation:  0.03275346755981445
r_  generation:  0.32087206840515137
local_output_nid generation:  0.01788163185119629
local_in_edges_tensor generation:  0.024354934692382812
mini_batch_src_global generation:  0.038934946060180664
r_  generation:  0.33033180236816406
local_output_nid generation:  0.018686294555664062
local_in_edges_tensor generation:  0.021170854568481445
mini_batch_src_global generation:  0.04024767875671387
r_  generation:  0.3377556800842285
local_output_nid generation:  0.018726110458374023
local_in_edges_tensor generation:  0.019482851028442383
mini_batch_src_global generation:  0.03918051719665527
r_  generation:  0.3316829204559326
local_output_nid generation:  0.019054174423217773
local_in_edges_tensor generation:  0.019242525100708008
mini_batch_src_global generation:  0.03963756561279297
r_  generation:  0.33441925048828125
local_output_nid generation:  0.018687009811401367
local_in_edges_tensor generation:  0.019596099853515625
mini_batch_src_global generation:  0.040459394454956055
r_  generation:  0.33605003356933594
local_output_nid generation:  0.018204927444458008
local_in_edges_tensor generation:  0.01918959617614746
mini_batch_src_global generation:  0.040503740310668945
r_  generation:  0.3412775993347168
local_output_nid generation:  0.018332242965698242
local_in_edges_tensor generation:  0.022957563400268555
mini_batch_src_global generation:  0.041025400161743164
r_  generation:  0.3360774517059326
----------------------check_connections_block total spend ----------------------------- 3.8892810344696045
generate_one_block  0.42772531509399414
generate_one_block  0.4237091541290283
generate_one_block  0.4345722198486328
generate_one_block  0.41849565505981445
generate_one_block  0.42269325256347656
generate_one_block  0.42761874198913574
generate_one_block  0.42583417892456055
generate_one_block  0.45263075828552246
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03433346748352051
gen group dst list time:  0.03844046592712402
time for parepare:  0.019633054733276367
local_output_nid generation:  0.026601791381835938
local_in_edges_tensor generation:  0.04031729698181152
mini_batch_src_global generation:  0.04358959197998047
r_  generation:  0.47971153259277344
local_output_nid generation:  0.03571128845214844
local_in_edges_tensor generation:  0.038915395736694336
mini_batch_src_global generation:  0.054355621337890625
r_  generation:  0.47761011123657227
local_output_nid generation:  0.03369784355163574
local_in_edges_tensor generation:  0.03678703308105469
mini_batch_src_global generation:  0.05462384223937988
r_  generation:  0.49712443351745605
local_output_nid generation:  0.03422880172729492
local_in_edges_tensor generation:  0.033440589904785156
mini_batch_src_global generation:  0.05361151695251465
r_  generation:  0.4833981990814209
local_output_nid generation:  0.03375720977783203
local_in_edges_tensor generation:  0.03104090690612793
mini_batch_src_global generation:  0.05304431915283203
r_  generation:  0.5006873607635498
local_output_nid generation:  0.03499031066894531
local_in_edges_tensor generation:  0.035778045654296875
mini_batch_src_global generation:  0.057030439376831055
r_  generation:  0.48875951766967773
local_output_nid generation:  0.03432774543762207
local_in_edges_tensor generation:  0.03606462478637695
mini_batch_src_global generation:  0.05695676803588867
r_  generation:  0.5037245750427246
local_output_nid generation:  0.0348057746887207
local_in_edges_tensor generation:  0.03736233711242676
mini_batch_src_global generation:  0.054841041564941406
r_  generation:  0.4886631965637207
----------------------check_connections_block total spend ----------------------------- 5.788594484329224
generate_one_block  0.6065428256988525
generate_one_block  0.6157698631286621
generate_one_block  0.6101329326629639
generate_one_block  0.6096394062042236
generate_one_block  0.6065196990966797
generate_one_block  0.6065702438354492
generate_one_block  0.6076309680938721
generate_one_block  0.6123800277709961
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13319635391235352  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

connection checking time:  9.677875518798828
block generation total time  8.308465242385864
average batch blocks generation time:  1.038558155298233
block dataloader generation time/epoch 20.008408693166878
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10238313674926758  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9394869804382324  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10250425338745117  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9371209144592285  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10269355773925781  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9410591125488281  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10220909118652344  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9356884956359863  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10230827331542969  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9327220916748047  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10270261764526367  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9361276626586914  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10269689559936523  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.93658447265625  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10268497467041016  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9380221366882324  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08466556668281555 |0.015339672565460205 |0.0035581886768341064 |9.033083915710449e-05 |0.003725975751876831 |0.0019121170043945312 |
----------------------------------------------------------pseudo_mini_loss sum 1.2933542728424072
Total (block generation + training)time/epoch 20.935510103519146
Training time/epoch 0.936237096786499
Training time without block to device /epoch 0.8135197162628174
Training time without total dataloading part /epoch 0.06090807914733887
load block tensor time/epoch 0.6773245334625244
block to device time/epoch 0.12271738052368164
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 22 |
Number of nodes for computation during this epoch:  3021017
Number of first layer input nodes during this epoch:  1287438
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1332540512084961  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.029020071029663086
range selection method range initialization spend 0.011945962905883789
time for parepare:  0.016423940658569336
local_output_nid generation:  0.002711772918701172
local_in_edges_tensor generation:  0.007697582244873047
mini_batch_src_global generation:  0.0034940242767333984
r_  generation:  0.043840885162353516
local_output_nid generation:  0.003201723098754883
local_in_edges_tensor generation:  0.0019788742065429688
mini_batch_src_global generation:  0.005048274993896484
r_  generation:  0.045588016510009766
local_output_nid generation:  0.003195524215698242
local_in_edges_tensor generation:  0.0017757415771484375
mini_batch_src_global generation:  0.0034837722778320312
r_  generation:  0.04574108123779297
local_output_nid generation:  0.003259420394897461
local_in_edges_tensor generation:  0.0017938613891601562
mini_batch_src_global generation:  0.003335237503051758
r_  generation:  0.045918941497802734
local_output_nid generation:  0.003218412399291992
local_in_edges_tensor generation:  0.0018227100372314453
mini_batch_src_global generation:  0.003699064254760742
r_  generation:  0.04704403877258301
local_output_nid generation:  0.003195524215698242
local_in_edges_tensor generation:  0.001821279525756836
mini_batch_src_global generation:  0.003660440444946289
r_  generation:  0.04738903045654297
local_output_nid generation:  0.0032317638397216797
local_in_edges_tensor generation:  0.0018284320831298828
mini_batch_src_global generation:  0.0037124156951904297
r_  generation:  0.04672551155090332
local_output_nid generation:  0.003211498260498047
local_in_edges_tensor generation:  0.0018010139465332031
mini_batch_src_global generation:  0.0037178993225097656
r_  generation:  0.048427581787109375
----------------------check_connections_block total spend ----------------------------- 0.5425064563751221
generate_one_block  0.06349730491638184
generate_one_block  0.06178903579711914
generate_one_block  0.06137537956237793
generate_one_block  0.06066489219665527
generate_one_block  0.06112217903137207
generate_one_block  0.06164813041687012
generate_one_block  0.06385135650634766
generate_one_block  0.061980247497558594
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.036566734313964844
gen group dst list time:  0.015474081039428711
time for parepare:  0.019194602966308594
local_output_nid generation:  0.011631965637207031
local_in_edges_tensor generation:  0.029285907745361328
mini_batch_src_global generation:  0.03259587287902832
r_  generation:  0.31826281547546387
local_output_nid generation:  0.017949342727661133
local_in_edges_tensor generation:  0.023989200592041016
mini_batch_src_global generation:  0.04033398628234863
r_  generation:  0.3312199115753174
local_output_nid generation:  0.018655776977539062
local_in_edges_tensor generation:  0.01880669593811035
mini_batch_src_global generation:  0.0398557186126709
r_  generation:  0.33129286766052246
local_output_nid generation:  0.018557071685791016
local_in_edges_tensor generation:  0.019875526428222656
mini_batch_src_global generation:  0.03929638862609863
r_  generation:  0.3341517448425293
local_output_nid generation:  0.01918935775756836
local_in_edges_tensor generation:  0.02022099494934082
mini_batch_src_global generation:  0.040457725524902344
r_  generation:  0.33788251876831055
local_output_nid generation:  0.018915891647338867
local_in_edges_tensor generation:  0.018782377243041992
mini_batch_src_global generation:  0.04029273986816406
r_  generation:  0.3375217914581299
local_output_nid generation:  0.017926454544067383
local_in_edges_tensor generation:  0.018688201904296875
mini_batch_src_global generation:  0.03961586952209473
r_  generation:  0.33506107330322266
local_output_nid generation:  0.01834845542907715
local_in_edges_tensor generation:  0.0190126895904541
mini_batch_src_global generation:  0.04090142250061035
r_  generation:  0.3371729850769043
----------------------check_connections_block total spend ----------------------------- 3.8721115589141846
generate_one_block  0.42728614807128906
generate_one_block  0.42849040031433105
generate_one_block  0.42369842529296875
generate_one_block  0.4252164363861084
generate_one_block  0.42629003524780273
generate_one_block  0.4262423515319824
generate_one_block  0.41826915740966797
generate_one_block  0.45216870307922363
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03220033645629883
gen group dst list time:  0.037454843521118164
time for parepare:  0.021422624588012695
local_output_nid generation:  0.026295900344848633
local_in_edges_tensor generation:  0.03762412071228027
mini_batch_src_global generation:  0.04358100891113281
r_  generation:  0.4728097915649414
local_output_nid generation:  0.03321552276611328
local_in_edges_tensor generation:  0.03525280952453613
mini_batch_src_global generation:  0.05637383460998535
r_  generation:  0.47712182998657227
local_output_nid generation:  0.03371000289916992
local_in_edges_tensor generation:  0.03216409683227539
mini_batch_src_global generation:  0.05054616928100586
r_  generation:  0.4876554012298584
local_output_nid generation:  0.034560441970825195
local_in_edges_tensor generation:  0.03213167190551758
mini_batch_src_global generation:  0.055013179779052734
r_  generation:  0.4854559898376465
local_output_nid generation:  0.03404402732849121
local_in_edges_tensor generation:  0.0322115421295166
mini_batch_src_global generation:  0.05270957946777344
r_  generation:  0.5001294612884521
local_output_nid generation:  0.034624338150024414
local_in_edges_tensor generation:  0.03242158889770508
mini_batch_src_global generation:  0.054613351821899414
r_  generation:  0.4856548309326172
local_output_nid generation:  0.03463029861450195
local_in_edges_tensor generation:  0.032451629638671875
mini_batch_src_global generation:  0.05318021774291992
r_  generation:  0.5036697387695312
local_output_nid generation:  0.034881591796875
local_in_edges_tensor generation:  0.03900742530822754
mini_batch_src_global generation:  0.05474209785461426
r_  generation:  0.4921081066131592
----------------------check_connections_block total spend ----------------------------- 5.74761176109314
generate_one_block  0.6039648056030273
generate_one_block  0.6096160411834717
generate_one_block  0.6049776077270508
generate_one_block  0.6099226474761963
generate_one_block  0.6050832271575928
generate_one_block  0.6126902103424072
generate_one_block  0.6125192642211914
generate_one_block  0.6164829730987549
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1332540512084961  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

connection checking time:  9.619723320007324
block generation total time  8.302918434143066
average batch blocks generation time:  1.0378648042678833
block dataloader generation time/epoch 19.999799830572947
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10239934921264648  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.938014030456543  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10245227813720703  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.940300464630127  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10151481628417969  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9309587478637695  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10225057601928711  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9364733695983887  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10242986679077148  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9349751472473145  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10256147384643555  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9366159439086914  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1023111343383789  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9329776763916016  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1027379035949707  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9376430511474609  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08393141627311707 |0.014193803071975708 |0.0032912492752075195 |8.693337440490723e-05 |0.0037377476692199707 |0.001748800277709961 |
----------------------------------------------------------pseudo_mini_loss sum 1.2783081531524658
Total (block generation + training)time/epoch 20.926269837788173
Training time/epoch 0.9181299209594727
Training time without block to device /epoch 0.804579496383667
Training time without total dataloading part /epoch 0.05867624282836914
load block tensor time/epoch 0.6714513301849365
block to device time/epoch 0.11355042457580566
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 23 |
Number of nodes for computation during this epoch:  3018038
Number of first layer input nodes during this epoch:  1287037
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13316583633422852  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024580955505371094
range selection method range initialization spend 0.01203465461730957
time for parepare:  0.01714801788330078
local_output_nid generation:  0.0027196407318115234
local_in_edges_tensor generation:  0.004924297332763672
mini_batch_src_global generation:  0.004132747650146484
r_  generation:  0.04460883140563965
local_output_nid generation:  0.0031099319458007812
local_in_edges_tensor generation:  0.0017576217651367188
mini_batch_src_global generation:  0.005011320114135742
r_  generation:  0.04568004608154297
local_output_nid generation:  0.0031778812408447266
local_in_edges_tensor generation:  0.0017821788787841797
mini_batch_src_global generation:  0.003526449203491211
r_  generation:  0.04600787162780762
local_output_nid generation:  0.0032036304473876953
local_in_edges_tensor generation:  0.0017848014831542969
mini_batch_src_global generation:  0.0033926963806152344
r_  generation:  0.046875715255737305
local_output_nid generation:  0.0032088756561279297
local_in_edges_tensor generation:  0.001800537109375
mini_batch_src_global generation:  0.0037429332733154297
r_  generation:  0.047269582748413086
local_output_nid generation:  0.003214597702026367
local_in_edges_tensor generation:  0.0018320083618164062
mini_batch_src_global generation:  0.0037674903869628906
r_  generation:  0.04845476150512695
local_output_nid generation:  0.003225564956665039
local_in_edges_tensor generation:  0.0018126964569091797
mini_batch_src_global generation:  0.003983497619628906
r_  generation:  0.048547983169555664
local_output_nid generation:  0.0032160282135009766
local_in_edges_tensor generation:  0.001829385757446289
mini_batch_src_global generation:  0.003870248794555664
r_  generation:  0.04771614074707031
----------------------check_connections_block total spend ----------------------------- 0.5471596717834473
generate_one_block  0.05964231491088867
generate_one_block  0.061181068420410156
generate_one_block  0.060849666595458984
generate_one_block  0.06161355972290039
generate_one_block  0.0610499382019043
generate_one_block  0.0618290901184082
generate_one_block  0.06523323059082031
generate_one_block  0.061188697814941406
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.036440134048461914
gen group dst list time:  0.015100240707397461
time for parepare:  0.019074201583862305
local_output_nid generation:  0.011455535888671875
local_in_edges_tensor generation:  0.025655269622802734
mini_batch_src_global generation:  0.03248763084411621
r_  generation:  0.3124821186065674
local_output_nid generation:  0.017981290817260742
local_in_edges_tensor generation:  0.0233001708984375
mini_batch_src_global generation:  0.038707733154296875
r_  generation:  0.33113837242126465
local_output_nid generation:  0.018654346466064453
local_in_edges_tensor generation:  0.019491195678710938
mini_batch_src_global generation:  0.03826022148132324
r_  generation:  0.3372464179992676
local_output_nid generation:  0.0186917781829834
local_in_edges_tensor generation:  0.018523216247558594
mini_batch_src_global generation:  0.04148721694946289
r_  generation:  0.33818888664245605
local_output_nid generation:  0.019102811813354492
local_in_edges_tensor generation:  0.019446372985839844
mini_batch_src_global generation:  0.04040074348449707
r_  generation:  0.33940863609313965
local_output_nid generation:  0.019453048706054688
local_in_edges_tensor generation:  0.019367694854736328
mini_batch_src_global generation:  0.040401458740234375
r_  generation:  0.34437990188598633
local_output_nid generation:  0.018829822540283203
local_in_edges_tensor generation:  0.021938323974609375
mini_batch_src_global generation:  0.046945810317993164
r_  generation:  0.3484983444213867
local_output_nid generation:  0.02220320701599121
local_in_edges_tensor generation:  0.024155616760253906
mini_batch_src_global generation:  0.042290687561035156
r_  generation:  0.36296820640563965
----------------------check_connections_block total spend ----------------------------- 3.948768138885498
generate_one_block  0.4465312957763672
generate_one_block  0.44479966163635254
generate_one_block  0.4356198310852051
generate_one_block  0.43748998641967773
generate_one_block  0.4342968463897705
generate_one_block  0.4346771240234375
generate_one_block  0.4517221450805664
generate_one_block  0.4672067165374756
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03235197067260742
gen group dst list time:  0.03902745246887207
time for parepare:  0.020746231079101562
local_output_nid generation:  0.02657461166381836
local_in_edges_tensor generation:  0.05133962631225586
mini_batch_src_global generation:  0.043647050857543945
r_  generation:  0.479900598526001
local_output_nid generation:  0.03287792205810547
local_in_edges_tensor generation:  0.040888309478759766
mini_batch_src_global generation:  0.05628180503845215
r_  generation:  0.5038437843322754
local_output_nid generation:  0.03423571586608887
local_in_edges_tensor generation:  0.03661179542541504
mini_batch_src_global generation:  0.05465817451477051
r_  generation:  0.49690723419189453
local_output_nid generation:  0.03435778617858887
local_in_edges_tensor generation:  0.03531289100646973
mini_batch_src_global generation:  0.05420064926147461
r_  generation:  0.4914867877960205
local_output_nid generation:  0.034391164779663086
local_in_edges_tensor generation:  0.037386417388916016
mini_batch_src_global generation:  0.05498695373535156
r_  generation:  0.5041863918304443
local_output_nid generation:  0.035506248474121094
local_in_edges_tensor generation:  0.03856492042541504
mini_batch_src_global generation:  0.05475497245788574
r_  generation:  0.49301791191101074
local_output_nid generation:  0.03705310821533203
local_in_edges_tensor generation:  0.04190254211425781
mini_batch_src_global generation:  0.053058624267578125
r_  generation:  0.5045759677886963
local_output_nid generation:  0.035005807876586914
local_in_edges_tensor generation:  0.038881778717041016
mini_batch_src_global generation:  0.06783485412597656
r_  generation:  0.4951481819152832
----------------------check_connections_block total spend ----------------------------- 5.88954496383667
generate_one_block  0.6263666152954102
generate_one_block  0.6140563488006592
generate_one_block  0.6114027500152588
generate_one_block  0.6116368770599365
generate_one_block  0.6277017593383789
generate_one_block  0.6180422306060791
generate_one_block  0.6420502662658691
generate_one_block  0.6204872131347656
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13316583633422852  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

connection checking time:  9.838313102722168
block generation total time  8.52408766746521
average batch blocks generation time:  1.0655109584331512
block dataloader generation time/epoch 20.028154691060383
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10216569900512695  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.933657169342041  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10264062881469727  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9371175765991211  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10234546661376953  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9375219345092773  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1024618148803711  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9368314743041992  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10238218307495117  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9352335929870605  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10259199142456055  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9367499351501465  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10259532928466797  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9393043518066406  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10177803039550781  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9374451637268066  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08471435308456421 |0.016039669513702393 |0.0035999417304992676 |9.149312973022461e-05 |0.0037686824798583984 |0.0016021728515625 |
----------------------------------------------------------pseudo_mini_loss sum 1.2714238166809082
Total (block generation + training)time/epoch 20.955535554885863
Training time/epoch 0.9398934841156006
Training time without block to device /epoch 0.8115761280059814
Training time without total dataloading part /epoch 0.061283111572265625
load block tensor time/epoch 0.6777148246765137
block to device time/epoch 0.12831735610961914
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 24 |
Number of nodes for computation during this epoch:  3019388
Number of first layer input nodes during this epoch:  1287210
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13269853591918945  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0255892276763916
range selection method range initialization spend 0.012449264526367188
time for parepare:  0.01601862907409668
local_output_nid generation:  0.0026831626892089844
local_in_edges_tensor generation:  0.0071222782135009766
mini_batch_src_global generation:  0.0033330917358398438
r_  generation:  0.04403352737426758
local_output_nid generation:  0.0031316280364990234
local_in_edges_tensor generation:  0.0017757415771484375
mini_batch_src_global generation:  0.004859447479248047
r_  generation:  0.04563117027282715
local_output_nid generation:  0.003152608871459961
local_in_edges_tensor generation:  0.0017960071563720703
mini_batch_src_global generation:  0.003401517868041992
r_  generation:  0.04515552520751953
local_output_nid generation:  0.0032279491424560547
local_in_edges_tensor generation:  0.001821756362915039
mini_batch_src_global generation:  0.0033414363861083984
r_  generation:  0.046529531478881836
local_output_nid generation:  0.0031697750091552734
local_in_edges_tensor generation:  0.002420186996459961
mini_batch_src_global generation:  0.003976345062255859
r_  generation:  0.04778289794921875
local_output_nid generation:  0.003206014633178711
local_in_edges_tensor generation:  0.0019805431365966797
mini_batch_src_global generation:  0.0039653778076171875
r_  generation:  0.048486948013305664
local_output_nid generation:  0.0031995773315429688
local_in_edges_tensor generation:  0.002208232879638672
mini_batch_src_global generation:  0.0038068294525146484
r_  generation:  0.04732918739318848
local_output_nid generation:  0.0032405853271484375
local_in_edges_tensor generation:  0.0019989013671875
mini_batch_src_global generation:  0.0038299560546875
r_  generation:  0.04819035530090332
----------------------check_connections_block total spend ----------------------------- 0.5463120937347412
generate_one_block  0.06082868576049805
generate_one_block  0.06144404411315918
generate_one_block  0.0611114501953125
generate_one_block  0.06091618537902832
generate_one_block  0.061969757080078125
generate_one_block  0.06290268898010254
generate_one_block  0.06422209739685059
generate_one_block  0.06149601936340332
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03149223327636719
gen group dst list time:  0.015268564224243164
time for parepare:  0.0191495418548584
local_output_nid generation:  0.011565923690795898
local_in_edges_tensor generation:  0.027384042739868164
mini_batch_src_global generation:  0.03278660774230957
r_  generation:  0.3218343257904053
local_output_nid generation:  0.017565011978149414
local_in_edges_tensor generation:  0.02423882484436035
mini_batch_src_global generation:  0.03894352912902832
r_  generation:  0.33094358444213867
local_output_nid generation:  0.018275737762451172
local_in_edges_tensor generation:  0.018938779830932617
mini_batch_src_global generation:  0.04114794731140137
r_  generation:  0.32799386978149414
local_output_nid generation:  0.019277572631835938
local_in_edges_tensor generation:  0.0184783935546875
mini_batch_src_global generation:  0.03822517395019531
r_  generation:  0.33098864555358887
local_output_nid generation:  0.01932382583618164
local_in_edges_tensor generation:  0.02159261703491211
mini_batch_src_global generation:  0.04035234451293945
r_  generation:  0.3428511619567871
local_output_nid generation:  0.01927638053894043
local_in_edges_tensor generation:  0.019210100173950195
mini_batch_src_global generation:  0.04052901268005371
r_  generation:  0.3446485996246338
local_output_nid generation:  0.0203857421875
local_in_edges_tensor generation:  0.01953268051147461
mini_batch_src_global generation:  0.04015755653381348
r_  generation:  0.33278441429138184
local_output_nid generation:  0.0187528133392334
local_in_edges_tensor generation:  0.02036881446838379
mini_batch_src_global generation:  0.040593862533569336
r_  generation:  0.3406345844268799
----------------------check_connections_block total spend ----------------------------- 3.8949151039123535
generate_one_block  0.43116307258605957
generate_one_block  0.4339621067047119
generate_one_block  0.4212791919708252
generate_one_block  0.4231297969818115
generate_one_block  0.43673157691955566
generate_one_block  0.4283618927001953
generate_one_block  0.424238920211792
generate_one_block  0.4539909362792969
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.031424522399902344
gen group dst list time:  0.03743696212768555
time for parepare:  0.0186922550201416
local_output_nid generation:  0.025900840759277344
local_in_edges_tensor generation:  0.04883384704589844
mini_batch_src_global generation:  0.04393196105957031
r_  generation:  0.4770054817199707
local_output_nid generation:  0.0328068733215332
local_in_edges_tensor generation:  0.03897857666015625
mini_batch_src_global generation:  0.05365777015686035
r_  generation:  0.4851667881011963
local_output_nid generation:  0.03366231918334961
local_in_edges_tensor generation:  0.03235340118408203
mini_batch_src_global generation:  0.05043840408325195
r_  generation:  0.49339914321899414
local_output_nid generation:  0.034279823303222656
local_in_edges_tensor generation:  0.032039642333984375
mini_batch_src_global generation:  0.05672907829284668
r_  generation:  0.48914504051208496
local_output_nid generation:  0.03418779373168945
local_in_edges_tensor generation:  0.037572622299194336
mini_batch_src_global generation:  0.053655147552490234
r_  generation:  0.5027039051055908
local_output_nid generation:  0.03425002098083496
local_in_edges_tensor generation:  0.03179121017456055
mini_batch_src_global generation:  0.05541062355041504
r_  generation:  0.4928901195526123
local_output_nid generation:  0.03440070152282715
local_in_edges_tensor generation:  0.03205561637878418
mini_batch_src_global generation:  0.05302548408508301
r_  generation:  0.5035526752471924
local_output_nid generation:  0.03452634811401367
local_in_edges_tensor generation:  0.03143167495727539
mini_batch_src_global generation:  0.05539369583129883
r_  generation:  0.493685245513916
----------------------check_connections_block total spend ----------------------------- 5.790513753890991
generate_one_block  0.6152105331420898
generate_one_block  0.6159994602203369
generate_one_block  0.6068122386932373
generate_one_block  0.6082220077514648
generate_one_block  0.6180515289306641
generate_one_block  0.6065664291381836
generate_one_block  0.6156296730041504
generate_one_block  0.611743688583374
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13269853591918945  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

connection checking time:  9.685428857803345
block generation total time  8.351093053817749
average batch blocks generation time:  1.0438866317272186
block dataloader generation time/epoch 20.02745160460472
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1024022102355957  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9386096000671387  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10170269012451172  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9366474151611328  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1023702621459961  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9337329864501953  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10266733169555664  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9356179237365723  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1027073860168457  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9412388801574707  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10247993469238281  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9377264976501465  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10210561752319336  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9319052696228027  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10270881652832031  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9367876052856445  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08109220862388611 |0.01213034987449646 |0.0035185515880584717 |9.146332740783691e-05 |0.0033096373081207275 |0.0013682842254638672 |
----------------------------------------------------------pseudo_mini_loss sum 1.259077787399292
Total (block generation + training)time/epoch 20.951324746012688
Training time/epoch 0.8710379600524902
Training time without block to device /epoch 0.7739951610565186
Training time without total dataloading part /epoch 0.056725502014160156
load block tensor time/epoch 0.6487376689910889
block to device time/epoch 0.09704279899597168
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 25 |
Number of nodes for computation during this epoch:  3017832
Number of first layer input nodes during this epoch:  1286768
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13332748413085938  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024227142333984375
range selection method range initialization spend 0.015490055084228516
time for parepare:  0.016180753707885742
local_output_nid generation:  0.0027010440826416016
local_in_edges_tensor generation:  0.004300832748413086
mini_batch_src_global generation:  0.004186868667602539
r_  generation:  0.04545402526855469
local_output_nid generation:  0.003162860870361328
local_in_edges_tensor generation:  0.0017659664154052734
mini_batch_src_global generation:  0.005035877227783203
r_  generation:  0.04551839828491211
local_output_nid generation:  0.0032219886779785156
local_in_edges_tensor generation:  0.0018072128295898438
mini_batch_src_global generation:  0.003540515899658203
r_  generation:  0.04604792594909668
local_output_nid generation:  0.003215312957763672
local_in_edges_tensor generation:  0.0018658638000488281
mini_batch_src_global generation:  0.0034656524658203125
r_  generation:  0.047829389572143555
local_output_nid generation:  0.003237485885620117
local_in_edges_tensor generation:  0.002178668975830078
mini_batch_src_global generation:  0.0037479400634765625
r_  generation:  0.05016016960144043
local_output_nid generation:  0.0032024383544921875
local_in_edges_tensor generation:  0.0021517276763916016
mini_batch_src_global generation:  0.0038242340087890625
r_  generation:  0.04880714416503906
local_output_nid generation:  0.003253459930419922
local_in_edges_tensor generation:  0.002165555953979492
mini_batch_src_global generation:  0.003996849060058594
r_  generation:  0.04895591735839844
local_output_nid generation:  0.003471851348876953
local_in_edges_tensor generation:  0.002523660659790039
mini_batch_src_global generation:  0.003732919692993164
r_  generation:  0.05096697807312012
----------------------check_connections_block total spend ----------------------------- 0.5636997222900391
generate_one_block  0.06113791465759277
generate_one_block  0.06209874153137207
generate_one_block  0.060901641845703125
generate_one_block  0.06413531303405762
generate_one_block  0.0653529167175293
generate_one_block  0.06255125999450684
generate_one_block  0.06564879417419434
generate_one_block  0.06442594528198242
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04203057289123535
gen group dst list time:  0.015677690505981445
time for parepare:  0.020681142807006836
local_output_nid generation:  0.01223897933959961
local_in_edges_tensor generation:  0.03435540199279785
mini_batch_src_global generation:  0.032531023025512695
r_  generation:  0.3296241760253906
local_output_nid generation:  0.019973039627075195
local_in_edges_tensor generation:  0.023985624313354492
mini_batch_src_global generation:  0.038908958435058594
r_  generation:  0.3321192264556885
local_output_nid generation:  0.019461870193481445
local_in_edges_tensor generation:  0.019706010818481445
mini_batch_src_global generation:  0.03884172439575195
r_  generation:  0.33311891555786133
local_output_nid generation:  0.019583940505981445
local_in_edges_tensor generation:  0.019934415817260742
mini_batch_src_global generation:  0.04086184501647949
r_  generation:  0.33850860595703125
local_output_nid generation:  0.02014636993408203
local_in_edges_tensor generation:  0.02145981788635254
mini_batch_src_global generation:  0.04156064987182617
r_  generation:  0.34600400924682617
local_output_nid generation:  0.02010655403137207
local_in_edges_tensor generation:  0.02034473419189453
mini_batch_src_global generation:  0.04180455207824707
r_  generation:  0.3491957187652588
local_output_nid generation:  0.0200498104095459
local_in_edges_tensor generation:  0.021645307540893555
mini_batch_src_global generation:  0.04097747802734375
r_  generation:  0.3405160903930664
local_output_nid generation:  0.022650957107543945
local_in_edges_tensor generation:  0.024398326873779297
mini_batch_src_global generation:  0.040670156478881836
r_  generation:  0.3377094268798828
----------------------check_connections_block total spend ----------------------------- 3.9714736938476562
generate_one_block  0.4529836177825928
generate_one_block  0.43454527854919434
generate_one_block  0.4280104637145996
generate_one_block  0.43376851081848145
generate_one_block  0.4532651901245117
generate_one_block  0.43743038177490234
generate_one_block  0.4307382106781006
generate_one_block  0.4578971862792969
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.037717580795288086
gen group dst list time:  0.038109540939331055
time for parepare:  0.02044224739074707
local_output_nid generation:  0.026490211486816406
local_in_edges_tensor generation:  0.047924041748046875
mini_batch_src_global generation:  0.04767632484436035
r_  generation:  0.47592759132385254
local_output_nid generation:  0.032912254333496094
local_in_edges_tensor generation:  0.03746819496154785
mini_batch_src_global generation:  0.0541839599609375
r_  generation:  0.48427581787109375
local_output_nid generation:  0.03350663185119629
local_in_edges_tensor generation:  0.039278268814086914
mini_batch_src_global generation:  0.05146050453186035
r_  generation:  0.5004496574401855
local_output_nid generation:  0.034596920013427734
local_in_edges_tensor generation:  0.040337324142456055
mini_batch_src_global generation:  0.054021358489990234
r_  generation:  0.5047392845153809
local_output_nid generation:  0.037039756774902344
local_in_edges_tensor generation:  0.03770875930786133
mini_batch_src_global generation:  0.05782818794250488
r_  generation:  0.4983375072479248
local_output_nid generation:  0.035454750061035156
local_in_edges_tensor generation:  0.033032894134521484
mini_batch_src_global generation:  0.05484199523925781
r_  generation:  0.49159669876098633
local_output_nid generation:  0.03522777557373047
local_in_edges_tensor generation:  0.03409123420715332
mini_batch_src_global generation:  0.05294370651245117
r_  generation:  0.49985432624816895
local_output_nid generation:  0.035172462463378906
local_in_edges_tensor generation:  0.03530311584472656
mini_batch_src_global generation:  0.05517387390136719
r_  generation:  0.49129724502563477
----------------------check_connections_block total spend ----------------------------- 5.8466150760650635
generate_one_block  0.6152470111846924
generate_one_block  0.6206774711608887
generate_one_block  0.6104490756988525
generate_one_block  0.6164414882659912
generate_one_block  0.6141607761383057
generate_one_block  0.6196057796478271
generate_one_block  0.615959644317627
generate_one_block  0.6058604717254639
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13332748413085938  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

connection checking time:  9.81808876991272
block generation total time  8.447040557861328
average batch blocks generation time:  1.055880069732666
block dataloader generation time/epoch 20.04559759532704
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10248804092407227  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9371194839477539  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10249137878417969  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9367499351501465  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10256576538085938  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9367837905883789  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10251426696777344  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9368982315063477  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1026148796081543  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9382138252258301  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1025395393371582  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9397568702697754  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10245084762573242  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9368376731872559  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10249662399291992  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9360284805297852  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08468323945999146 |0.015349000692367554 |0.0035843849182128906 |9.083747863769531e-05 |0.0037697255611419678 |0.0013053417205810547 |
----------------------------------------------------------pseudo_mini_loss sum 1.243399739265442
Total (block generation + training)time/epoch 20.97012790511636
Training time/epoch 0.934767484664917
Training time without block to device /epoch 0.8119754791259766
Training time without total dataloading part /epoch 0.060864925384521484
load block tensor time/epoch 0.6774659156799316
block to device time/epoch 0.12279200553894043
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 26 |
Number of nodes for computation during this epoch:  3021831
Number of first layer input nodes during this epoch:  1288065
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13331317901611328  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026598215103149414
range selection method range initialization spend 0.012033939361572266
time for parepare:  0.01611924171447754
local_output_nid generation:  0.002794981002807617
local_in_edges_tensor generation:  0.009139299392700195
mini_batch_src_global generation:  0.0033369064331054688
r_  generation:  0.04431962966918945
local_output_nid generation:  0.0031769275665283203
local_in_edges_tensor generation:  0.0018115043640136719
mini_batch_src_global generation:  0.005053520202636719
r_  generation:  0.0451970100402832
local_output_nid generation:  0.0032279491424560547
local_in_edges_tensor generation:  0.001832723617553711
mini_batch_src_global generation:  0.0034592151641845703
r_  generation:  0.04612612724304199
local_output_nid generation:  0.003187417984008789
local_in_edges_tensor generation:  0.001817941665649414
mini_batch_src_global generation:  0.0034465789794921875
r_  generation:  0.047360897064208984
local_output_nid generation:  0.0032019615173339844
local_in_edges_tensor generation:  0.0018503665924072266
mini_batch_src_global generation:  0.0037407875061035156
r_  generation:  0.04686236381530762
local_output_nid generation:  0.0032155513763427734
local_in_edges_tensor generation:  0.0018420219421386719
mini_batch_src_global generation:  0.0037953853607177734
r_  generation:  0.048413991928100586
local_output_nid generation:  0.0032072067260742188
local_in_edges_tensor generation:  0.001837015151977539
mini_batch_src_global generation:  0.003953695297241211
r_  generation:  0.04884624481201172
local_output_nid generation:  0.003217935562133789
local_in_edges_tensor generation:  0.0018434524536132812
mini_batch_src_global generation:  0.003782510757446289
r_  generation:  0.04752612113952637
----------------------check_connections_block total spend ----------------------------- 0.5494692325592041
generate_one_block  0.05988025665283203
generate_one_block  0.06199312210083008
generate_one_block  0.06180906295776367
generate_one_block  0.06220722198486328
generate_one_block  0.06176471710205078
generate_one_block  0.061841726303100586
generate_one_block  0.0658576488494873
generate_one_block  0.06070089340209961
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04133439064025879
gen group dst list time:  0.015362262725830078
time for parepare:  0.019893407821655273
local_output_nid generation:  0.011333227157592773
local_in_edges_tensor generation:  0.02913975715637207
mini_batch_src_global generation:  0.03587841987609863
r_  generation:  0.3129253387451172
local_output_nid generation:  0.01776885986328125
local_in_edges_tensor generation:  0.029743671417236328
mini_batch_src_global generation:  0.047334909439086914
r_  generation:  0.3324453830718994
local_output_nid generation:  0.019106149673461914
local_in_edges_tensor generation:  0.020905256271362305
mini_batch_src_global generation:  0.0454866886138916
r_  generation:  0.33318471908569336
local_output_nid generation:  0.020192861557006836
local_in_edges_tensor generation:  0.0215303897857666
mini_batch_src_global generation:  0.039723873138427734
r_  generation:  0.3382229804992676
local_output_nid generation:  0.0197446346282959
local_in_edges_tensor generation:  0.01876664161682129
mini_batch_src_global generation:  0.04074263572692871
r_  generation:  0.3387570381164551
local_output_nid generation:  0.020070791244506836
local_in_edges_tensor generation:  0.019103050231933594
mini_batch_src_global generation:  0.040319204330444336
r_  generation:  0.33687901496887207
local_output_nid generation:  0.01925182342529297
local_in_edges_tensor generation:  0.02117919921875
mini_batch_src_global generation:  0.04269671440124512
r_  generation:  0.34299492835998535
local_output_nid generation:  0.018804073333740234
local_in_edges_tensor generation:  0.018802404403686523
mini_batch_src_global generation:  0.0407710075378418
r_  generation:  0.3314661979675293
----------------------check_connections_block total spend ----------------------------- 3.9120731353759766
generate_one_block  0.4195683002471924
generate_one_block  0.4284336566925049
generate_one_block  0.43386054039001465
generate_one_block  0.43108582496643066
generate_one_block  0.4286341667175293
generate_one_block  0.4328272342681885
generate_one_block  0.4344336986541748
generate_one_block  0.4437251091003418
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.035188913345336914
gen group dst list time:  0.03774833679199219
time for parepare:  0.019863605499267578
local_output_nid generation:  0.025948047637939453
local_in_edges_tensor generation:  0.040169477462768555
mini_batch_src_global generation:  0.04570770263671875
r_  generation:  0.4806172847747803
local_output_nid generation:  0.03268718719482422
local_in_edges_tensor generation:  0.03949999809265137
mini_batch_src_global generation:  0.05476212501525879
r_  generation:  0.4800760746002197
local_output_nid generation:  0.03307199478149414
local_in_edges_tensor generation:  0.03288531303405762
mini_batch_src_global generation:  0.05218863487243652
r_  generation:  0.49599432945251465
local_output_nid generation:  0.033448219299316406
local_in_edges_tensor generation:  0.03073906898498535
mini_batch_src_global generation:  0.0565488338470459
r_  generation:  0.48789310455322266
local_output_nid generation:  0.03352165222167969
local_in_edges_tensor generation:  0.032340049743652344
mini_batch_src_global generation:  0.052587270736694336
r_  generation:  0.5097141265869141
local_output_nid generation:  0.03396892547607422
local_in_edges_tensor generation:  0.03151297569274902
mini_batch_src_global generation:  0.05685925483703613
r_  generation:  0.4889397621154785
local_output_nid generation:  0.03460526466369629
local_in_edges_tensor generation:  0.03206205368041992
mini_batch_src_global generation:  0.052442312240600586
r_  generation:  0.5075283050537109
local_output_nid generation:  0.034172773361206055
local_in_edges_tensor generation:  0.03251171112060547
mini_batch_src_global generation:  0.05454564094543457
r_  generation:  0.4886918067932129
----------------------check_connections_block total spend ----------------------------- 5.781266927719116
generate_one_block  0.6137652397155762
generate_one_block  0.616539478302002
generate_one_block  0.6101679801940918
generate_one_block  0.6147513389587402
generate_one_block  0.6050505638122559
generate_one_block  0.6113061904907227
generate_one_block  0.6226546764373779
generate_one_block  0.6065011024475098
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13331317901611328  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

connection checking time:  9.693340063095093
block generation total time  8.353305101394653
average batch blocks generation time:  1.0441631376743317
block dataloader generation time/epoch 20.045328908496433
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10244035720825195  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9348430633544922  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10271692276000977  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9374356269836426  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10232830047607422  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9374403953552246  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10253095626831055  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9385523796081543  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10165929794311523  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9351162910461426  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10223865509033203  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.936307430267334  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10277795791625977  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9415984153747559  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1022348403930664  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9329771995544434  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0827079713344574 |0.012799501419067383 |0.0041141510009765625 |0.00010886788368225098 |0.003671109676361084 |0.003184795379638672 |
----------------------------------------------------------pseudo_mini_loss sum 1.2300034761428833
Total (block generation + training)time/epoch 20.968493779500324
Training time/epoch 0.8996889591217041
Training time without block to device /epoch 0.797292947769165
Training time without total dataloading part /epoch 0.06633782386779785
load block tensor time/epoch 0.6616637706756592
block to device time/epoch 0.10239601135253906
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 27 |
Number of nodes for computation during this epoch:  3019374
Number of first layer input nodes during this epoch:  1287504
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13338518142700195  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0231170654296875
range selection method range initialization spend 0.012222766876220703
time for parepare:  0.01823902130126953
local_output_nid generation:  0.0026979446411132812
local_in_edges_tensor generation:  0.004280567169189453
mini_batch_src_global generation:  0.003443002700805664
r_  generation:  0.04500222206115723
local_output_nid generation:  0.0030684471130371094
local_in_edges_tensor generation:  0.0017249584197998047
mini_batch_src_global generation:  0.004923582077026367
r_  generation:  0.04298210144042969
local_output_nid generation:  0.0031938552856445312
local_in_edges_tensor generation:  0.001811981201171875
mini_batch_src_global generation:  0.003418445587158203
r_  generation:  0.0486297607421875
local_output_nid generation:  0.003213644027709961
local_in_edges_tensor generation:  0.0018017292022705078
mini_batch_src_global generation:  0.003594636917114258
r_  generation:  0.04761099815368652
local_output_nid generation:  0.0032291412353515625
local_in_edges_tensor generation:  0.0018324851989746094
mini_batch_src_global generation:  0.003704071044921875
r_  generation:  0.047479867935180664
local_output_nid generation:  0.003393888473510742
local_in_edges_tensor generation:  0.0017917156219482422
mini_batch_src_global generation:  0.020103931427001953
r_  generation:  0.04910445213317871
local_output_nid generation:  0.0034143924713134766
local_in_edges_tensor generation:  0.0019526481628417969
mini_batch_src_global generation:  0.00474858283996582
r_  generation:  0.0494840145111084
local_output_nid generation:  0.003384113311767578
local_in_edges_tensor generation:  0.0019426345825195312
mini_batch_src_global generation:  0.0037207603454589844
r_  generation:  0.04615354537963867
----------------------check_connections_block total spend ----------------------------- 0.6060924530029297
generate_one_block  0.06051349639892578
generate_one_block  0.05931496620178223
generate_one_block  0.061049461364746094
generate_one_block  0.06196999549865723
generate_one_block  0.06125497817993164
generate_one_block  0.06154584884643555
generate_one_block  0.06458783149719238
generate_one_block  0.06028485298156738
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03560352325439453
gen group dst list time:  0.01506662368774414
time for parepare:  0.01945948600769043
local_output_nid generation:  0.01143026351928711
local_in_edges_tensor generation:  0.026739835739135742
mini_batch_src_global generation:  0.03238868713378906
r_  generation:  0.31735992431640625
local_output_nid generation:  0.01750922203063965
local_in_edges_tensor generation:  0.02149033546447754
mini_batch_src_global generation:  0.03835248947143555
r_  generation:  0.32339930534362793
local_output_nid generation:  0.018481969833374023
local_in_edges_tensor generation:  0.019417285919189453
mini_batch_src_global generation:  0.039900779724121094
r_  generation:  0.33083200454711914
local_output_nid generation:  0.018736600875854492
local_in_edges_tensor generation:  0.022021055221557617
mini_batch_src_global generation:  0.03945183753967285
r_  generation:  0.3367643356323242
local_output_nid generation:  0.019255876541137695
local_in_edges_tensor generation:  0.021224021911621094
mini_batch_src_global generation:  0.045995473861694336
r_  generation:  0.3383631706237793
local_output_nid generation:  0.019388198852539062
local_in_edges_tensor generation:  0.01972818374633789
mini_batch_src_global generation:  0.042534828186035156
r_  generation:  0.3433079719543457
local_output_nid generation:  0.018432140350341797
local_in_edges_tensor generation:  0.01997208595275879
mini_batch_src_global generation:  0.04066348075866699
r_  generation:  0.33959174156188965
local_output_nid generation:  0.01801753044128418
local_in_edges_tensor generation:  0.018441438674926758
mini_batch_src_global generation:  0.0477595329284668
r_  generation:  0.33890223503112793
----------------------check_connections_block total spend ----------------------------- 3.892458438873291
generate_one_block  0.4390382766723633
generate_one_block  0.42942285537719727
generate_one_block  0.43959808349609375
generate_one_block  0.4423999786376953
generate_one_block  0.44184160232543945
generate_one_block  0.4390881061553955
generate_one_block  0.4333913326263428
generate_one_block  0.45642566680908203
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03401970863342285
gen group dst list time:  0.038056373596191406
time for parepare:  0.021220922470092773
local_output_nid generation:  0.026823997497558594
local_in_edges_tensor generation:  0.0576326847076416
mini_batch_src_global generation:  0.04373002052307129
r_  generation:  0.48476481437683105
local_output_nid generation:  0.033350229263305664
local_in_edges_tensor generation:  0.03931093215942383
mini_batch_src_global generation:  0.05402231216430664
r_  generation:  0.4815642833709717
local_output_nid generation:  0.03324079513549805
local_in_edges_tensor generation:  0.03413724899291992
mini_batch_src_global generation:  0.05157732963562012
r_  generation:  0.5108554363250732
local_output_nid generation:  0.03410625457763672
local_in_edges_tensor generation:  0.03699374198913574
mini_batch_src_global generation:  0.0561068058013916
r_  generation:  0.49939560890197754
local_output_nid generation:  0.03448796272277832
local_in_edges_tensor generation:  0.03549599647521973
mini_batch_src_global generation:  0.052221059799194336
r_  generation:  0.5094916820526123
local_output_nid generation:  0.03456234931945801
local_in_edges_tensor generation:  0.041591644287109375
mini_batch_src_global generation:  0.05484819412231445
r_  generation:  0.4935784339904785
local_output_nid generation:  0.035629987716674805
local_in_edges_tensor generation:  0.039495229721069336
mini_batch_src_global generation:  0.05364227294921875
r_  generation:  0.5108499526977539
local_output_nid generation:  0.03490948677062988
local_in_edges_tensor generation:  0.03518509864807129
mini_batch_src_global generation:  0.05598640441894531
r_  generation:  0.5001449584960938
----------------------check_connections_block total spend ----------------------------- 5.894449472427368
generate_one_block  0.6371920108795166
generate_one_block  0.6198625564575195
generate_one_block  0.6144235134124756
generate_one_block  0.6179823875427246
generate_one_block  0.6164202690124512
generate_one_block  0.6102566719055176
generate_one_block  0.6062114238739014
generate_one_block  0.6178946495056152
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13338518142700195  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

connection checking time:  9.78690791130066
block generation total time  8.461449384689331
average batch blocks generation time:  1.0576811730861664
block dataloader generation time/epoch 20.059322206597578
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10268211364746094  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.938755989074707  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1014556884765625  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9320626258850098  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1020660400390625  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9365530014038086  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10268783569335938  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9402227401733398  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10179281234741211  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9373703002929688  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1023106575012207  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9375672340393066  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10251522064208984  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9384989738464355  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10147428512573242  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9351997375488281  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08383738994598389 |0.015209376811981201 |0.003571629524230957 |9.235739707946777e-05 |0.0037853121757507324 |0.0019121170043945312 |
----------------------------------------------------------pseudo_mini_loss sum 1.2227716445922852
Total (block generation + training)time/epoch 20.982925465232448
Training time/epoch 0.9312124252319336
Training time without block to device /epoch 0.809537410736084
Training time without total dataloading part /epoch 0.06150650978088379
load block tensor time/epoch 0.6706991195678711
block to device time/epoch 0.12167501449584961
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 28 |
Number of nodes for computation during this epoch:  3018845
Number of first layer input nodes during this epoch:  1286486
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13300800323486328  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023214340209960938
range selection method range initialization spend 0.012177467346191406
time for parepare:  0.016762971878051758
local_output_nid generation:  0.0027379989624023438
local_in_edges_tensor generation:  0.0075931549072265625
mini_batch_src_global generation:  0.0034067630767822266
r_  generation:  0.04521322250366211
local_output_nid generation:  0.0031642913818359375
local_in_edges_tensor generation:  0.0018122196197509766
mini_batch_src_global generation:  0.004958152770996094
r_  generation:  0.0446772575378418
local_output_nid generation:  0.003216981887817383
local_in_edges_tensor generation:  0.0017766952514648438
mini_batch_src_global generation:  0.0034508705139160156
r_  generation:  0.04513263702392578
local_output_nid generation:  0.003215312957763672
local_in_edges_tensor generation:  0.0018024444580078125
mini_batch_src_global generation:  0.003481626510620117
r_  generation:  0.04681396484375
local_output_nid generation:  0.0031921863555908203
local_in_edges_tensor generation:  0.001990079879760742
mini_batch_src_global generation:  0.003787994384765625
r_  generation:  0.048111915588378906
local_output_nid generation:  0.0032024383544921875
local_in_edges_tensor generation:  0.0018923282623291016
mini_batch_src_global generation:  0.0038666725158691406
r_  generation:  0.04801034927368164
local_output_nid generation:  0.0032231807708740234
local_in_edges_tensor generation:  0.0018587112426757812
mini_batch_src_global generation:  0.003892183303833008
r_  generation:  0.04823732376098633
local_output_nid generation:  0.003220081329345703
local_in_edges_tensor generation:  0.001859426498413086
mini_batch_src_global generation:  0.0038182735443115234
r_  generation:  0.04981255531311035
----------------------check_connections_block total spend ----------------------------- 0.5494129657745361
generate_one_block  0.0642099380493164
generate_one_block  0.06077456474304199
generate_one_block  0.06017136573791504
generate_one_block  0.061170339584350586
generate_one_block  0.06136584281921387
generate_one_block  0.061731576919555664
generate_one_block  0.06502699851989746
generate_one_block  0.061522722244262695
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03464818000793457
gen group dst list time:  0.015137434005737305
time for parepare:  0.01938915252685547
local_output_nid generation:  0.011805057525634766
local_in_edges_tensor generation:  0.02880692481994629
mini_batch_src_global generation:  0.03267240524291992
r_  generation:  0.3226737976074219
local_output_nid generation:  0.0181276798248291
local_in_edges_tensor generation:  0.022969484329223633
mini_batch_src_global generation:  0.03909897804260254
r_  generation:  0.3291049003601074
local_output_nid generation:  0.018552064895629883
local_in_edges_tensor generation:  0.01919245719909668
mini_batch_src_global generation:  0.039192914962768555
r_  generation:  0.3279712200164795
local_output_nid generation:  0.01893758773803711
local_in_edges_tensor generation:  0.0195465087890625
mini_batch_src_global generation:  0.039350271224975586
r_  generation:  0.3356645107269287
local_output_nid generation:  0.01952338218688965
local_in_edges_tensor generation:  0.01852893829345703
mini_batch_src_global generation:  0.04055285453796387
r_  generation:  0.34135890007019043
local_output_nid generation:  0.01966381072998047
local_in_edges_tensor generation:  0.01976323127746582
mini_batch_src_global generation:  0.04052138328552246
r_  generation:  0.33962130546569824
local_output_nid generation:  0.018769025802612305
local_in_edges_tensor generation:  0.018390655517578125
mini_batch_src_global generation:  0.04129934310913086
r_  generation:  0.34194254875183105
local_output_nid generation:  0.01855945587158203
local_in_edges_tensor generation:  0.01853322982788086
mini_batch_src_global generation:  0.04324960708618164
r_  generation:  0.33933472633361816
----------------------check_connections_block total spend ----------------------------- 3.8895423412323
generate_one_block  0.4323303699493408
generate_one_block  0.42555880546569824
generate_one_block  0.42313170433044434
generate_one_block  0.42981719970703125
generate_one_block  0.43280649185180664
generate_one_block  0.429645299911499
generate_one_block  0.4404447078704834
generate_one_block  0.45864152908325195
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03125166893005371
gen group dst list time:  0.04144906997680664
time for parepare:  0.01881241798400879
local_output_nid generation:  0.026462078094482422
local_in_edges_tensor generation:  0.04344367980957031
mini_batch_src_global generation:  0.04702019691467285
r_  generation:  0.47577977180480957
local_output_nid generation:  0.032932281494140625
local_in_edges_tensor generation:  0.04189038276672363
mini_batch_src_global generation:  0.054578542709350586
r_  generation:  0.4832773208618164
local_output_nid generation:  0.03419995307922363
local_in_edges_tensor generation:  0.03347921371459961
mini_batch_src_global generation:  0.050934553146362305
r_  generation:  0.4938058853149414
local_output_nid generation:  0.034353017807006836
local_in_edges_tensor generation:  0.03658580780029297
mini_batch_src_global generation:  0.05612540245056152
r_  generation:  0.48973989486694336
local_output_nid generation:  0.03433966636657715
local_in_edges_tensor generation:  0.04035615921020508
mini_batch_src_global generation:  0.05241751670837402
r_  generation:  0.5015091896057129
local_output_nid generation:  0.03564643859863281
local_in_edges_tensor generation:  0.03909945487976074
mini_batch_src_global generation:  0.05443620681762695
r_  generation:  0.49469900131225586
local_output_nid generation:  0.03437519073486328
local_in_edges_tensor generation:  0.04115152359008789
mini_batch_src_global generation:  0.055407047271728516
r_  generation:  0.5065619945526123
local_output_nid generation:  0.03494000434875488
local_in_edges_tensor generation:  0.03440356254577637
mini_batch_src_global generation:  0.05507707595825195
r_  generation:  0.5085306167602539
----------------------check_connections_block total spend ----------------------------- 5.8502044677734375
generate_one_block  0.6147706508636475
generate_one_block  0.6182341575622559
generate_one_block  0.6221978664398193
generate_one_block  0.6166219711303711
generate_one_block  0.61322021484375
generate_one_block  0.6151442527770996
generate_one_block  0.6123828887939453
generate_one_block  0.6305975914001465
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13300800323486328  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

connection checking time:  9.739746809005737
block generation total time  8.41554570198059
average batch blocks generation time:  1.0519432127475739
block dataloader generation time/epoch 20.063119399547578
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1022653579711914  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9399795532226562  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1022639274597168  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9369597434997559  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10231876373291016  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9312710762023926  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10289716720581055  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.936851978302002  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10253000259399414  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9372296333312988  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10244417190551758  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9361906051635742  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10290288925170898  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9381632804870605  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10222768783569336  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9379096031188965  GigaBytes
Max Memory Allocated: 1.0879297256469727  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07907593250274658 |0.015245437622070312 |0.0035019218921661377 |9.059906005859375e-05 |0.003307431936264038 |0.0013246536254882812 |
----------------------------------------------------------pseudo_mini_loss sum 1.2127845287322998
Total (block generation + training)time/epoch 20.984890747070313
Training time/epoch 0.8867716789245605
Training time without block to device /epoch 0.764808177947998
Training time without total dataloading part /epoch 0.05652427673339844
load block tensor time/epoch 0.6326074600219727
block to device time/epoch 0.1219635009765625
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 29 |
Number of nodes for computation during this epoch:  3019847
Number of first layer input nodes during this epoch:  1287276
