Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1647779495.672898
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027405261993408203
range selection method range initialization spend 0.013681888580322266
time for parepare:  0.018186569213867188
local_output_nid generation:  0.0026493072509765625
local_in_edges_tensor generation:  0.004856586456298828
mini_batch_src_global generation:  0.0037758350372314453
r_  generation:  0.04262828826904297
local_output_nid generation:  0.0030486583709716797
local_in_edges_tensor generation:  0.0016980171203613281
mini_batch_src_global generation:  0.004802703857421875
r_  generation:  0.04276895523071289
local_output_nid generation:  0.003080129623413086
local_in_edges_tensor generation:  0.001783132553100586
mini_batch_src_global generation:  0.003226041793823242
r_  generation:  0.04438948631286621
local_output_nid generation:  0.0031723976135253906
local_in_edges_tensor generation:  0.0017430782318115234
mini_batch_src_global generation:  0.003325223922729492
r_  generation:  0.04519796371459961
local_output_nid generation:  0.0032122135162353516
local_in_edges_tensor generation:  0.0017669200897216797
mini_batch_src_global generation:  0.0034177303314208984
r_  generation:  0.045896291732788086
local_output_nid generation:  0.0031986236572265625
local_in_edges_tensor generation:  0.0017006397247314453
mini_batch_src_global generation:  0.0036973953247070312
r_  generation:  0.04737710952758789
local_output_nid generation:  0.0031647682189941406
local_in_edges_tensor generation:  0.0017001628875732422
mini_batch_src_global generation:  0.003803253173828125
r_  generation:  0.046797990798950195
local_output_nid generation:  0.003174304962158203
local_in_edges_tensor generation:  0.001753091812133789
mini_batch_src_global generation:  0.0038688182830810547
r_  generation:  0.047736167907714844
----------------------check_connections_block total spend ----------------------------- 0.5283753871917725
generate_one_block  0.06189680099487305
generate_one_block  0.06115555763244629
generate_one_block  0.06197857856750488
generate_one_block  0.06129002571105957
generate_one_block  0.06373071670532227
generate_one_block  0.061723947525024414
generate_one_block  0.06167316436767578
generate_one_block  0.06181168556213379
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04346013069152832
gen group dst list time:  0.016192913055419922
time for parepare:  0.019997358322143555
local_output_nid generation:  0.011429071426391602
local_in_edges_tensor generation:  0.032619476318359375
mini_batch_src_global generation:  0.034867286682128906
r_  generation:  0.35782670974731445
local_output_nid generation:  0.01953744888305664
local_in_edges_tensor generation:  0.03357410430908203
mini_batch_src_global generation:  0.0479583740234375
r_  generation:  0.36500024795532227
local_output_nid generation:  0.020731687545776367
local_in_edges_tensor generation:  0.026679277420043945
mini_batch_src_global generation:  0.04345846176147461
r_  generation:  0.37226295471191406
local_output_nid generation:  0.02155900001525879
local_in_edges_tensor generation:  0.028102636337280273
mini_batch_src_global generation:  0.04585409164428711
r_  generation:  0.37754392623901367
local_output_nid generation:  0.02158832550048828
local_in_edges_tensor generation:  0.023658037185668945
mini_batch_src_global generation:  0.04572105407714844
r_  generation:  0.3762500286102295
local_output_nid generation:  0.021871089935302734
local_in_edges_tensor generation:  0.02793717384338379
mini_batch_src_global generation:  0.05227828025817871
r_  generation:  0.3824727535247803
local_output_nid generation:  0.021836042404174805
local_in_edges_tensor generation:  0.02390456199645996
mini_batch_src_global generation:  0.0468449592590332
r_  generation:  0.38768839836120605
local_output_nid generation:  0.022058963775634766
local_in_edges_tensor generation:  0.023914098739624023
mini_batch_src_global generation:  0.049927711486816406
r_  generation:  0.38066792488098145
----------------------check_connections_block total spend ----------------------------- 4.4039130210876465
generate_one_block  0.5128364562988281
generate_one_block  0.49697256088256836
generate_one_block  0.4919149875640869
generate_one_block  0.49980783462524414
generate_one_block  0.48984766006469727
generate_one_block  0.5119578838348389
generate_one_block  0.4869704246520996
generate_one_block  0.4954535961151123
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03762006759643555
gen group dst list time:  0.03732442855834961
time for parepare:  0.022095918655395508
local_output_nid generation:  0.025952577590942383
local_in_edges_tensor generation:  0.04461979866027832
mini_batch_src_global generation:  0.05629682540893555
r_  generation:  0.541844367980957
local_output_nid generation:  0.032822608947753906
local_in_edges_tensor generation:  0.05460309982299805
mini_batch_src_global generation:  0.06386828422546387
r_  generation:  0.5540459156036377
local_output_nid generation:  0.03335690498352051
local_in_edges_tensor generation:  0.050119638442993164
mini_batch_src_global generation:  0.06108880043029785
r_  generation:  0.5570039749145508
local_output_nid generation:  0.03443741798400879
local_in_edges_tensor generation:  0.04656815528869629
mini_batch_src_global generation:  0.06424212455749512
r_  generation:  0.5572061538696289
local_output_nid generation:  0.034073591232299805
local_in_edges_tensor generation:  0.045107126235961914
mini_batch_src_global generation:  0.06158185005187988
r_  generation:  0.5666475296020508
local_output_nid generation:  0.03490281105041504
local_in_edges_tensor generation:  0.04608464241027832
mini_batch_src_global generation:  0.06377553939819336
r_  generation:  0.5689911842346191
local_output_nid generation:  0.03481292724609375
local_in_edges_tensor generation:  0.04661202430725098
mini_batch_src_global generation:  0.06335783004760742
r_  generation:  0.5671727657318115
local_output_nid generation:  0.03562521934509277
local_in_edges_tensor generation:  0.03402447700500488
mini_batch_src_global generation:  0.06690049171447754
r_  generation:  0.5843067169189453
----------------------check_connections_block total spend ----------------------------- 6.643520355224609
generate_one_block  0.7447266578674316
generate_one_block  0.7161149978637695
generate_one_block  0.7183501720428467
generate_one_block  0.7187097072601318
generate_one_block  0.7183849811553955
generate_one_block  0.6997349262237549
generate_one_block  0.7398083209991455
generate_one_block  0.7241625785827637
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  11.047433376312256
block generation total time  9.765753746032715
average batch blocks generation time:  1.2207192182540894
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.10235023498535156  GigaBytes
Max Memory Allocated: 0.10235023498535156  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4979248046875 GB
    Memory Allocated: 0.9523601531982422  GigaBytes
Max Memory Allocated: 1.0184636116027832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8709716796875 GB
    Memory Allocated: 0.1045527458190918  GigaBytes
Max Memory Allocated: 1.0929293632507324  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8709716796875 GB
    Memory Allocated: 0.9512014389038086  GigaBytes
Max Memory Allocated: 1.0929293632507324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.10562944412231445  GigaBytes
Max Memory Allocated: 1.0929293632507324  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.9560379981994629  GigaBytes
Max Memory Allocated: 1.0929293632507324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.1043252944946289  GigaBytes
Max Memory Allocated: 1.0962872505187988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.9534773826599121  GigaBytes
Max Memory Allocated: 1.0962872505187988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.10531425476074219  GigaBytes
Max Memory Allocated: 1.0962872505187988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.9529070854187012  GigaBytes
Max Memory Allocated: 1.0962872505187988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.10500621795654297  GigaBytes
Max Memory Allocated: 1.0962872505187988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.9530696868896484  GigaBytes
Max Memory Allocated: 1.0962872505187988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.10522651672363281  GigaBytes
Max Memory Allocated: 1.0962872505187988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.9522438049316406  GigaBytes
Max Memory Allocated: 1.0962872505187988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.10499238967895508  GigaBytes
Max Memory Allocated: 1.0962872505187988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.9525890350341797  GigaBytes
Max Memory Allocated: 1.0962872505187988  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07203078269958496 |0.05553716421127319 |0.10267189145088196 |0.00010606646537780762 |0.012703031301498413 |0.001852273941040039 |
----------------------------------------------------------pseudo_mini_loss sum 6.2350358963012695
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3058003
Number of first layer input nodes during this epoch:  1301032
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.14156341552734375  GigaBytes
Max Memory Allocated: 1.0962872505187988  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03899717330932617
range selection method range initialization spend 0.012771368026733398
time for parepare:  0.01703810691833496
local_output_nid generation:  0.0027189254760742188
local_in_edges_tensor generation:  0.014697074890136719
mini_batch_src_global generation:  0.003958940505981445
r_  generation:  0.044313907623291016
local_output_nid generation:  0.0031943321228027344
local_in_edges_tensor generation:  0.0018579959869384766
mini_batch_src_global generation:  0.004851579666137695
r_  generation:  0.04439091682434082
local_output_nid generation:  0.0031845569610595703
local_in_edges_tensor generation:  0.0017948150634765625
mini_batch_src_global generation:  0.0033113956451416016
r_  generation:  0.045737504959106445
local_output_nid generation:  0.003251314163208008
local_in_edges_tensor generation:  0.0017828941345214844
mini_batch_src_global generation:  0.0033292770385742188
r_  generation:  0.04530501365661621
local_output_nid generation:  0.0032901763916015625
local_in_edges_tensor generation:  0.0016872882843017578
mini_batch_src_global generation:  0.003585338592529297
r_  generation:  0.04630541801452637
local_output_nid generation:  0.003190279006958008
local_in_edges_tensor generation:  0.0018672943115234375
mini_batch_src_global generation:  0.003864288330078125
r_  generation:  0.047782182693481445
local_output_nid generation:  0.003165006637573242
local_in_edges_tensor generation:  0.0017151832580566406
mini_batch_src_global generation:  0.0038940906524658203
r_  generation:  0.04798579216003418
local_output_nid generation:  0.0031142234802246094
local_in_edges_tensor generation:  0.0017833709716796875
mini_batch_src_global generation:  0.00377655029296875
r_  generation:  0.04833483695983887
----------------------check_connections_block total spend ----------------------------- 0.5477080345153809
generate_one_block  0.06414222717285156
generate_one_block  0.06174731254577637
generate_one_block  0.06439208984375
generate_one_block  0.06010174751281738
generate_one_block  0.06139850616455078
generate_one_block  0.06180095672607422
generate_one_block  0.0650322437286377
generate_one_block  0.0620572566986084
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.059485435485839844
gen group dst list time:  0.016374588012695312
time for parepare:  0.018919944763183594
local_output_nid generation:  0.011002063751220703
local_in_edges_tensor generation:  0.043380022048950195
mini_batch_src_global generation:  0.036104440689086914
r_  generation:  0.35926103591918945
local_output_nid generation:  0.017444372177124023
local_in_edges_tensor generation:  0.034268856048583984
mini_batch_src_global generation:  0.04496598243713379
r_  generation:  0.3759331703186035
local_output_nid generation:  0.017241716384887695
local_in_edges_tensor generation:  0.026073932647705078
mini_batch_src_global generation:  0.04366135597229004
r_  generation:  0.38196682929992676
local_output_nid generation:  0.017641067504882812
local_in_edges_tensor generation:  0.02294445037841797
mini_batch_src_global generation:  0.04551362991333008
r_  generation:  0.3729064464569092
local_output_nid generation:  0.018040895462036133
local_in_edges_tensor generation:  0.02698993682861328
mini_batch_src_global generation:  0.04844164848327637
r_  generation:  0.40282154083251953
local_output_nid generation:  0.02212977409362793
local_in_edges_tensor generation:  0.03529500961303711
mini_batch_src_global generation:  0.05026078224182129
r_  generation:  0.38071322441101074
local_output_nid generation:  0.01905059814453125
local_in_edges_tensor generation:  0.02718973159790039
mini_batch_src_global generation:  0.04981565475463867
r_  generation:  0.39519643783569336
local_output_nid generation:  0.01911163330078125
local_in_edges_tensor generation:  0.024746179580688477
mini_batch_src_global generation:  0.04742622375488281
r_  generation:  0.3827998638153076
----------------------check_connections_block total spend ----------------------------- 4.463857412338257
generate_one_block  0.5241279602050781
generate_one_block  0.5052316188812256
generate_one_block  0.49971699714660645
generate_one_block  0.49213457107543945
generate_one_block  0.5015397071838379
generate_one_block  0.4988393783569336
generate_one_block  0.5309369564056396
generate_one_block  0.5565581321716309
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05632209777832031
gen group dst list time:  0.04090571403503418
time for parepare:  0.019115447998046875
local_output_nid generation:  0.025482654571533203
local_in_edges_tensor generation:  0.06253194808959961
mini_batch_src_global generation:  0.05219888687133789
r_  generation:  0.5422661304473877
local_output_nid generation:  0.03327035903930664
local_in_edges_tensor generation:  0.05476093292236328
mini_batch_src_global generation:  0.0638570785522461
r_  generation:  0.5491187572479248
local_output_nid generation:  0.03336310386657715
local_in_edges_tensor generation:  0.04099917411804199
mini_batch_src_global generation:  0.06687188148498535
r_  generation:  0.567258358001709
local_output_nid generation:  0.033774375915527344
local_in_edges_tensor generation:  0.03700876235961914
mini_batch_src_global generation:  0.06293296813964844
r_  generation:  0.5689213275909424
local_output_nid generation:  0.03536391258239746
local_in_edges_tensor generation:  0.05261063575744629
mini_batch_src_global generation:  0.07487821578979492
r_  generation:  0.5893042087554932
local_output_nid generation:  0.03772759437561035
local_in_edges_tensor generation:  0.0451204776763916
mini_batch_src_global generation:  0.06999015808105469
r_  generation:  0.5678379535675049
local_output_nid generation:  0.03573346138000488
local_in_edges_tensor generation:  0.04485893249511719
mini_batch_src_global generation:  0.06277632713317871
r_  generation:  0.5747425556182861
local_output_nid generation:  0.03631401062011719
local_in_edges_tensor generation:  0.051177263259887695
mini_batch_src_global generation:  0.0628354549407959
r_  generation:  0.5872795581817627
----------------------check_connections_block total spend ----------------------------- 6.755611419677734
generate_one_block  0.7374234199523926
generate_one_block  0.7408061027526855
generate_one_block  0.7199325561523438
generate_one_block  0.70566725730896
generate_one_block  0.7233595848083496
generate_one_block  0.7121684551239014
generate_one_block  0.7225561141967773
generate_one_block  0.7156581878662109
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.14156341552734375  GigaBytes
Max Memory Allocated: 1.0962872505187988  GigaBytes

connection checking time:  11.219468832015991
block generation total time  9.886656999588013
average batch blocks generation time:  1.2358321249485016
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.10720157623291016  GigaBytes
Max Memory Allocated: 1.0962872505187988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9566783905029297  GigaBytes
Max Memory Allocated: 1.0962872505187988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10585784912109375  GigaBytes
Max Memory Allocated: 1.0976686477661133  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9541821479797363  GigaBytes
Max Memory Allocated: 1.0976686477661133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1067647933959961  GigaBytes
Max Memory Allocated: 1.0976686477661133  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9545087814331055  GigaBytes
Max Memory Allocated: 1.0976686477661133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10651254653930664  GigaBytes
Max Memory Allocated: 1.0976686477661133  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9484472274780273  GigaBytes
Max Memory Allocated: 1.0976686477661133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10684585571289062  GigaBytes
Max Memory Allocated: 1.0976686477661133  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9573945999145508  GigaBytes
Max Memory Allocated: 1.0976686477661133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10627079010009766  GigaBytes
Max Memory Allocated: 1.098067283630371  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9516658782958984  GigaBytes
Max Memory Allocated: 1.098067283630371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10705852508544922  GigaBytes
Max Memory Allocated: 1.098067283630371  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.956761360168457  GigaBytes
Max Memory Allocated: 1.098067283630371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10582208633422852  GigaBytes
Max Memory Allocated: 1.098067283630371  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9534592628479004  GigaBytes
Max Memory Allocated: 1.098067283630371  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07707703113555908 |0.017817586660385132 |0.0034863650798797607 |8.958578109741211e-05 |0.008410364389419556 |0.0015878677368164062 |
----------------------------------------------------------pseudo_mini_loss sum 3.2452399730682373
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3057570
Number of first layer input nodes during this epoch:  1300872
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1408982276916504  GigaBytes
Max Memory Allocated: 1.098067283630371  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.029187917709350586
range selection method range initialization spend 0.01204824447631836
time for parepare:  0.017259836196899414
local_output_nid generation:  0.002723217010498047
local_in_edges_tensor generation:  0.007096052169799805
mini_batch_src_global generation:  0.003869771957397461
r_  generation:  0.041879892349243164
local_output_nid generation:  0.0031931400299072266
local_in_edges_tensor generation:  0.0018494129180908203
mini_batch_src_global generation:  0.004849910736083984
r_  generation:  0.04557299613952637
local_output_nid generation:  0.003166675567626953
local_in_edges_tensor generation:  0.0018532276153564453
mini_batch_src_global generation:  0.0032181739807128906
r_  generation:  0.04580044746398926
local_output_nid generation:  0.003259897232055664
local_in_edges_tensor generation:  0.0017840862274169922
mini_batch_src_global generation:  0.0033559799194335938
r_  generation:  0.04573202133178711
local_output_nid generation:  0.0031824111938476562
local_in_edges_tensor generation:  0.0018393993377685547
mini_batch_src_global generation:  0.0035240650177001953
r_  generation:  0.047638654708862305
local_output_nid generation:  0.003172159194946289
local_in_edges_tensor generation:  0.0018646717071533203
mini_batch_src_global generation:  0.0037851333618164062
r_  generation:  0.048345327377319336
local_output_nid generation:  0.003185272216796875
local_in_edges_tensor generation:  0.0017614364624023438
mini_batch_src_global generation:  0.0037484169006347656
r_  generation:  0.04762864112854004
local_output_nid generation:  0.0032372474670410156
local_in_edges_tensor generation:  0.0017900466918945312
mini_batch_src_global generation:  0.0036497116088867188
r_  generation:  0.047036170959472656
----------------------check_connections_block total spend ----------------------------- 0.541602611541748
generate_one_block  0.060329437255859375
generate_one_block  0.062091827392578125
generate_one_block  0.06245565414428711
generate_one_block  0.06139826774597168
generate_one_block  0.0630335807800293
generate_one_block  0.06302285194396973
generate_one_block  0.06470274925231934
generate_one_block  0.06258416175842285
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.050737619400024414
gen group dst list time:  0.01642155647277832
time for parepare:  0.02078700065612793
local_output_nid generation:  0.011829137802124023
local_in_edges_tensor generation:  0.032607078552246094
mini_batch_src_global generation:  0.03775668144226074
r_  generation:  0.3708202838897705
local_output_nid generation:  0.018166065216064453
local_in_edges_tensor generation:  0.025465011596679688
mini_batch_src_global generation:  0.04499220848083496
r_  generation:  0.37825512886047363
local_output_nid generation:  0.01847076416015625
local_in_edges_tensor generation:  0.021480798721313477
mini_batch_src_global generation:  0.0468904972076416
r_  generation:  0.38836145401000977
local_output_nid generation:  0.02175283432006836
local_in_edges_tensor generation:  0.02106928825378418
mini_batch_src_global generation:  0.04971790313720703
r_  generation:  0.3729264736175537
local_output_nid generation:  0.018636226654052734
local_in_edges_tensor generation:  0.02244257926940918
mini_batch_src_global generation:  0.0476841926574707
r_  generation:  0.3990769386291504
local_output_nid generation:  0.021008729934692383
local_in_edges_tensor generation:  0.022185564041137695
mini_batch_src_global generation:  0.04697155952453613
r_  generation:  0.38609790802001953
local_output_nid generation:  0.018972158432006836
local_in_edges_tensor generation:  0.020922422409057617
mini_batch_src_global generation:  0.04607272148132324
r_  generation:  0.3869187831878662
local_output_nid generation:  0.01868748664855957
local_in_edges_tensor generation:  0.02189350128173828
mini_batch_src_global generation:  0.0455477237701416
r_  generation:  0.37389063835144043
----------------------check_connections_block total spend ----------------------------- 4.409069538116455
generate_one_block  0.49129176139831543
generate_one_block  0.49118518829345703
generate_one_block  0.4923219680786133
generate_one_block  0.48435544967651367
generate_one_block  0.49847888946533203
generate_one_block  0.495525598526001
generate_one_block  0.48493313789367676
generate_one_block  0.52089524269104
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.047753334045410156
gen group dst list time:  0.037824392318725586
time for parepare:  0.020807743072509766
local_output_nid generation:  0.025858163833618164
local_in_edges_tensor generation:  0.051445722579956055
mini_batch_src_global generation:  0.05192160606384277
r_  generation:  0.5395016670227051
local_output_nid generation:  0.03260040283203125
local_in_edges_tensor generation:  0.04226064682006836
mini_batch_src_global generation:  0.0637977123260498
r_  generation:  0.553929328918457
local_output_nid generation:  0.033867597579956055
local_in_edges_tensor generation:  0.03609108924865723
mini_batch_src_global generation:  0.06773567199707031
r_  generation:  0.5580494403839111
local_output_nid generation:  0.03354763984680176
local_in_edges_tensor generation:  0.03667402267456055
mini_batch_src_global generation:  0.062198638916015625
r_  generation:  0.559516191482544
local_output_nid generation:  0.03424477577209473
local_in_edges_tensor generation:  0.03375077247619629
mini_batch_src_global generation:  0.06086397171020508
r_  generation:  0.5627107620239258
local_output_nid generation:  0.03530383110046387
local_in_edges_tensor generation:  0.03521585464477539
mini_batch_src_global generation:  0.0617375373840332
r_  generation:  0.5663859844207764
local_output_nid generation:  0.03455996513366699
local_in_edges_tensor generation:  0.04235649108886719
mini_batch_src_global generation:  0.07170295715332031
r_  generation:  0.5701382160186768
local_output_nid generation:  0.0347437858581543
local_in_edges_tensor generation:  0.0425105094909668
mini_batch_src_global generation:  0.06543874740600586
r_  generation:  0.5672132968902588
----------------------check_connections_block total spend ----------------------------- 6.581273794174194
generate_one_block  0.7085592746734619
generate_one_block  0.7182183265686035
generate_one_block  0.7139077186584473
generate_one_block  0.6996884346008301
generate_one_block  0.7014358043670654
generate_one_block  0.7233853340148926
generate_one_block  0.7100808620452881
generate_one_block  0.7170255184173584
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1408982276916504  GigaBytes
Max Memory Allocated: 1.098067283630371  GigaBytes

connection checking time:  10.99034333229065
block generation total time  9.651288509368896
average batch blocks generation time:  1.206411063671112
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1069340705871582  GigaBytes
Max Memory Allocated: 1.098067283630371  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9578237533569336  GigaBytes
Max Memory Allocated: 1.098067283630371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10594415664672852  GigaBytes
Max Memory Allocated: 1.0990195274353027  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9565572738647461  GigaBytes
Max Memory Allocated: 1.0990195274353027  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10697460174560547  GigaBytes
Max Memory Allocated: 1.0990195274353027  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9566774368286133  GigaBytes
Max Memory Allocated: 1.0990195274353027  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10563278198242188  GigaBytes
Max Memory Allocated: 1.0990195274353027  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9477171897888184  GigaBytes
Max Memory Allocated: 1.0990195274353027  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10703659057617188  GigaBytes
Max Memory Allocated: 1.0990195274353027  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9593229293823242  GigaBytes
Max Memory Allocated: 1.0990195274353027  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10590744018554688  GigaBytes
Max Memory Allocated: 1.101325511932373  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9570317268371582  GigaBytes
Max Memory Allocated: 1.101325511932373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10678386688232422  GigaBytes
Max Memory Allocated: 1.101325511932373  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9533824920654297  GigaBytes
Max Memory Allocated: 1.101325511932373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1064310073852539  GigaBytes
Max Memory Allocated: 1.101325511932373  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9492826461791992  GigaBytes
Max Memory Allocated: 1.101325511932373  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0813751220703125 |0.021275222301483154 |0.00880846381187439 |9.229779243469238e-05 |0.0038353800773620605 |0.001338958740234375 |
----------------------------------------------------------pseudo_mini_loss sum 2.6091525554656982
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  3058852
Number of first layer input nodes during this epoch:  1300982
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1414966583251953  GigaBytes
Max Memory Allocated: 1.101325511932373  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02348637580871582
range selection method range initialization spend 0.01214289665222168
time for parepare:  0.019280195236206055
local_output_nid generation:  0.0027742385864257812
local_in_edges_tensor generation:  0.006215095520019531
mini_batch_src_global generation:  0.00403141975402832
r_  generation:  0.04255390167236328
local_output_nid generation:  0.0031890869140625
local_in_edges_tensor generation:  0.0017423629760742188
mini_batch_src_global generation:  0.0047838687896728516
r_  generation:  0.044953107833862305
local_output_nid generation:  0.003188610076904297
local_in_edges_tensor generation:  0.0017757415771484375
mini_batch_src_global generation:  0.0032148361206054688
r_  generation:  0.0450131893157959
local_output_nid generation:  0.0032646656036376953
local_in_edges_tensor generation:  0.0018651485443115234
mini_batch_src_global generation:  0.0032782554626464844
r_  generation:  0.04550480842590332
local_output_nid generation:  0.003245115280151367
local_in_edges_tensor generation:  0.001821279525756836
mini_batch_src_global generation:  0.0035097599029541016
r_  generation:  0.048071861267089844
local_output_nid generation:  0.0032231807708740234
local_in_edges_tensor generation:  0.0018134117126464844
mini_batch_src_global generation:  0.0037682056427001953
r_  generation:  0.047747135162353516
local_output_nid generation:  0.0033011436462402344
local_in_edges_tensor generation:  0.0018072128295898438
mini_batch_src_global generation:  0.0037605762481689453
r_  generation:  0.04857301712036133
local_output_nid generation:  0.003241300582885742
local_in_edges_tensor generation:  0.0018503665924072266
mini_batch_src_global generation:  0.0037207603454589844
r_  generation:  0.04747176170349121
----------------------check_connections_block total spend ----------------------------- 0.5426242351531982
generate_one_block  0.06052994728088379
generate_one_block  0.06232953071594238
generate_one_block  0.06107664108276367
generate_one_block  0.060981035232543945
generate_one_block  0.06256914138793945
generate_one_block  0.06236672401428223
generate_one_block  0.06504297256469727
generate_one_block  0.061649322509765625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03861427307128906
gen group dst list time:  0.01575326919555664
time for parepare:  0.019065380096435547
local_output_nid generation:  0.011637449264526367
local_in_edges_tensor generation:  0.02429342269897461
mini_batch_src_global generation:  0.035178184509277344
r_  generation:  0.3578832149505615
local_output_nid generation:  0.017978191375732422
local_in_edges_tensor generation:  0.021246910095214844
mini_batch_src_global generation:  0.04562520980834961
r_  generation:  0.378753662109375
local_output_nid generation:  0.018491268157958984
local_in_edges_tensor generation:  0.019345521926879883
mini_batch_src_global generation:  0.04707908630371094
r_  generation:  0.37524890899658203
local_output_nid generation:  0.018596410751342773
local_in_edges_tensor generation:  0.021406173706054688
mini_batch_src_global generation:  0.0452885627746582
r_  generation:  0.37820911407470703
local_output_nid generation:  0.01820850372314453
local_in_edges_tensor generation:  0.024216651916503906
mini_batch_src_global generation:  0.046518802642822266
r_  generation:  0.38787102699279785
local_output_nid generation:  0.018311023712158203
local_in_edges_tensor generation:  0.023389339447021484
mini_batch_src_global generation:  0.046968936920166016
r_  generation:  0.39145898818969727
local_output_nid generation:  0.018590211868286133
local_in_edges_tensor generation:  0.019612550735473633
mini_batch_src_global generation:  0.04695916175842285
r_  generation:  0.38628649711608887
local_output_nid generation:  0.019030094146728516
local_in_edges_tensor generation:  0.024300813674926758
mini_batch_src_global generation:  0.046682119369506836
r_  generation:  0.3841984272003174
----------------------check_connections_block total spend ----------------------------- 4.376118898391724
generate_one_block  0.5127406120300293
generate_one_block  0.5027782917022705
generate_one_block  0.49082469940185547
generate_one_block  0.497727632522583
generate_one_block  0.49248361587524414
generate_one_block  0.5033042430877686
generate_one_block  0.5026426315307617
generate_one_block  0.5185003280639648
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.042336463928222656
gen group dst list time:  0.03787684440612793
time for parepare:  0.01930999755859375
local_output_nid generation:  0.026284217834472656
local_in_edges_tensor generation:  0.055652618408203125
mini_batch_src_global generation:  0.05168604850769043
r_  generation:  0.5596582889556885
local_output_nid generation:  0.03313136100769043
local_in_edges_tensor generation:  0.047484636306762695
mini_batch_src_global generation:  0.06491923332214355
r_  generation:  0.5523898601531982
local_output_nid generation:  0.035210609436035156
local_in_edges_tensor generation:  0.035491943359375
mini_batch_src_global generation:  0.06143975257873535
r_  generation:  0.5626280307769775
local_output_nid generation:  0.03531956672668457
local_in_edges_tensor generation:  0.03925275802612305
mini_batch_src_global generation:  0.06256866455078125
r_  generation:  0.5619215965270996
local_output_nid generation:  0.03531336784362793
local_in_edges_tensor generation:  0.036374568939208984
mini_batch_src_global generation:  0.06184840202331543
r_  generation:  0.5747740268707275
local_output_nid generation:  0.03502655029296875
local_in_edges_tensor generation:  0.04860734939575195
mini_batch_src_global generation:  0.06295514106750488
r_  generation:  0.5705301761627197
local_output_nid generation:  0.035286903381347656
local_in_edges_tensor generation:  0.04208707809448242
mini_batch_src_global generation:  0.06312870979309082
r_  generation:  0.5896503925323486
local_output_nid generation:  0.03850579261779785
local_in_edges_tensor generation:  0.03734230995178223
mini_batch_src_global generation:  0.06798171997070312
r_  generation:  0.5684597492218018
----------------------check_connections_block total spend ----------------------------- 6.664419889450073
generate_one_block  0.7115445137023926
generate_one_block  0.7178049087524414
generate_one_block  0.7018682956695557
generate_one_block  0.707538366317749
generate_one_block  0.7128705978393555
generate_one_block  0.71956467628479
generate_one_block  0.728844165802002
generate_one_block  0.6972451210021973
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1414966583251953  GigaBytes
Max Memory Allocated: 1.101325511932373  GigaBytes

connection checking time:  11.040538787841797
block generation total time  9.718282699584961
average batch blocks generation time:  1.2147853374481201
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10730361938476562  GigaBytes
Max Memory Allocated: 1.101325511932373  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9528884887695312  GigaBytes
Max Memory Allocated: 1.101325511932373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10664939880371094  GigaBytes
Max Memory Allocated: 1.101325511932373  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9546070098876953  GigaBytes
Max Memory Allocated: 1.101325511932373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10670185089111328  GigaBytes
Max Memory Allocated: 1.101325511932373  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9512743949890137  GigaBytes
Max Memory Allocated: 1.101325511932373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10625219345092773  GigaBytes
Max Memory Allocated: 1.101325511932373  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9529972076416016  GigaBytes
Max Memory Allocated: 1.101325511932373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10727691650390625  GigaBytes
Max Memory Allocated: 1.101325511932373  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9626097679138184  GigaBytes
Max Memory Allocated: 1.101325511932373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10596609115600586  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9551281929016113  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10689830780029297  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9562172889709473  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1056513786315918  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9517717361450195  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0811358094215393 |0.01816248893737793 |0.003580719232559204 |9.068846702575684e-05 |0.008828073740005493 |0.00305938720703125 |
----------------------------------------------------------pseudo_mini_loss sum 2.3706016540527344
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  3056625
Number of first layer input nodes during this epoch:  1300479
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14059114456176758  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02554464340209961
range selection method range initialization spend 0.011772394180297852
time for parepare:  0.017024755477905273
local_output_nid generation:  0.00269317626953125
local_in_edges_tensor generation:  0.007358074188232422
mini_batch_src_global generation:  0.00393223762512207
r_  generation:  0.04124736785888672
local_output_nid generation:  0.003113985061645508
local_in_edges_tensor generation:  0.0017321109771728516
mini_batch_src_global generation:  0.00457763671875
r_  generation:  0.04446077346801758
local_output_nid generation:  0.0031740665435791016
local_in_edges_tensor generation:  0.0017590522766113281
mini_batch_src_global generation:  0.0031943321228027344
r_  generation:  0.04479527473449707
local_output_nid generation:  0.003184795379638672
local_in_edges_tensor generation:  0.001840829849243164
mini_batch_src_global generation:  0.003302335739135742
r_  generation:  0.045682430267333984
local_output_nid generation:  0.003217458724975586
local_in_edges_tensor generation:  0.0018808841705322266
mini_batch_src_global generation:  0.003568410873413086
r_  generation:  0.04728221893310547
local_output_nid generation:  0.0032286643981933594
local_in_edges_tensor generation:  0.0018358230590820312
mini_batch_src_global generation:  0.0037848949432373047
r_  generation:  0.04757046699523926
local_output_nid generation:  0.0031974315643310547
local_in_edges_tensor generation:  0.0018911361694335938
mini_batch_src_global generation:  0.0036399364471435547
r_  generation:  0.04707694053649902
local_output_nid generation:  0.0032558441162109375
local_in_edges_tensor generation:  0.0018475055694580078
mini_batch_src_global generation:  0.0036513805389404297
r_  generation:  0.04679608345031738
----------------------check_connections_block total spend ----------------------------- 0.5369143486022949
generate_one_block  0.060788869857788086
generate_one_block  0.06004023551940918
generate_one_block  0.061186790466308594
generate_one_block  0.06056928634643555
generate_one_block  0.0616917610168457
generate_one_block  0.061797142028808594
generate_one_block  0.06415820121765137
generate_one_block  0.06071972846984863
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.049767494201660156
gen group dst list time:  0.015511274337768555
time for parepare:  0.020396947860717773
local_output_nid generation:  0.011871337890625
local_in_edges_tensor generation:  0.033138275146484375
mini_batch_src_global generation:  0.03551363945007324
r_  generation:  0.3574488162994385
local_output_nid generation:  0.020572662353515625
local_in_edges_tensor generation:  0.028855323791503906
mini_batch_src_global generation:  0.04629683494567871
r_  generation:  0.3642752170562744
local_output_nid generation:  0.018395662307739258
local_in_edges_tensor generation:  0.020215749740600586
mini_batch_src_global generation:  0.04397773742675781
r_  generation:  0.37252330780029297
local_output_nid generation:  0.017911195755004883
local_in_edges_tensor generation:  0.0210416316986084
mini_batch_src_global generation:  0.04503273963928223
r_  generation:  0.3750336170196533
local_output_nid generation:  0.01790475845336914
local_in_edges_tensor generation:  0.023142576217651367
mini_batch_src_global generation:  0.05507016181945801
r_  generation:  0.3796849250793457
local_output_nid generation:  0.019518136978149414
local_in_edges_tensor generation:  0.020819664001464844
mini_batch_src_global generation:  0.04812431335449219
r_  generation:  0.38132739067077637
local_output_nid generation:  0.018961429595947266
local_in_edges_tensor generation:  0.019881010055541992
mini_batch_src_global generation:  0.04620003700256348
r_  generation:  0.3795609474182129
local_output_nid generation:  0.019191980361938477
local_in_edges_tensor generation:  0.021047592163085938
mini_batch_src_global generation:  0.04690361022949219
r_  generation:  0.3772766590118408
----------------------check_connections_block total spend ----------------------------- 4.3407981395721436
generate_one_block  0.4865376949310303
generate_one_block  0.48369550704956055
generate_one_block  0.4842984676361084
generate_one_block  0.489147424697876
generate_one_block  0.49253153800964355
generate_one_block  0.4905996322631836
generate_one_block  0.48595404624938965
generate_one_block  0.5123155117034912
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.037238359451293945
gen group dst list time:  0.036956071853637695
time for parepare:  0.018203020095825195
local_output_nid generation:  0.025873184204101562
local_in_edges_tensor generation:  0.05176806449890137
mini_batch_src_global generation:  0.05161285400390625
r_  generation:  0.534947395324707
local_output_nid generation:  0.032680511474609375
local_in_edges_tensor generation:  0.04003572463989258
mini_batch_src_global generation:  0.06374430656433105
r_  generation:  0.5472931861877441
local_output_nid generation:  0.03378176689147949
local_in_edges_tensor generation:  0.03713536262512207
mini_batch_src_global generation:  0.06369280815124512
r_  generation:  0.5498721599578857
local_output_nid generation:  0.033867597579956055
local_in_edges_tensor generation:  0.03930830955505371
mini_batch_src_global generation:  0.06152844429016113
r_  generation:  0.5561854839324951
local_output_nid generation:  0.03432011604309082
local_in_edges_tensor generation:  0.03536725044250488
mini_batch_src_global generation:  0.061264991760253906
r_  generation:  0.5604636669158936
local_output_nid generation:  0.03456592559814453
local_in_edges_tensor generation:  0.041185855865478516
mini_batch_src_global generation:  0.06722688674926758
r_  generation:  0.5648455619812012
local_output_nid generation:  0.03450775146484375
local_in_edges_tensor generation:  0.03511977195739746
mini_batch_src_global generation:  0.06287884712219238
r_  generation:  0.5646004676818848
local_output_nid generation:  0.034693241119384766
local_in_edges_tensor generation:  0.03612160682678223
mini_batch_src_global generation:  0.06375432014465332
r_  generation:  0.566044807434082
----------------------check_connections_block total spend ----------------------------- 6.522943735122681
generate_one_block  0.6975781917572021
generate_one_block  0.7070598602294922
generate_one_block  0.7173042297363281
generate_one_block  0.6978635787963867
generate_one_block  0.6991252899169922
generate_one_block  0.7022569179534912
generate_one_block  0.703761100769043
generate_one_block  0.6935937404632568
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14059114456176758  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

connection checking time:  10.863741874694824
block generation total time  9.543622732162476
average batch blocks generation time:  1.1929528415203094
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1069493293762207  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9559297561645508  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10621452331542969  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9534845352172852  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10719680786132812  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9559216499328613  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10640668869018555  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9535579681396484  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10725688934326172  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9561853408813477  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10596942901611328  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9568343162536621  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10704660415649414  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9562153816223145  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1057891845703125  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9511394500732422  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08557009696960449 |0.013690024614334106 |0.0034927725791931152 |8.851289749145508e-05 |0.00377848744392395 |0.002843618392944336 |
----------------------------------------------------------pseudo_mini_loss sum 2.1043126583099365
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  3058893
Number of first layer input nodes during this epoch:  1301243
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14077520370483398  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02151179313659668
range selection method range initialization spend 0.011859655380249023
time for parepare:  0.016138076782226562
local_output_nid generation:  0.002791881561279297
local_in_edges_tensor generation:  0.004038810729980469
mini_batch_src_global generation:  0.003826618194580078
r_  generation:  0.04118084907531738
local_output_nid generation:  0.003136157989501953
local_in_edges_tensor generation:  0.0021202564239501953
mini_batch_src_global generation:  0.004831552505493164
r_  generation:  0.04536771774291992
local_output_nid generation:  0.0032732486724853516
local_in_edges_tensor generation:  0.0017895698547363281
mini_batch_src_global generation:  0.0032465457916259766
r_  generation:  0.04538774490356445
local_output_nid generation:  0.0031614303588867188
local_in_edges_tensor generation:  0.0017600059509277344
mini_batch_src_global generation:  0.0034008026123046875
r_  generation:  0.04684567451477051
local_output_nid generation:  0.0032262802124023438
local_in_edges_tensor generation:  0.0018320083618164062
mini_batch_src_global generation:  0.003528594970703125
r_  generation:  0.04628920555114746
local_output_nid generation:  0.0033111572265625
local_in_edges_tensor generation:  0.0018279552459716797
mini_batch_src_global generation:  0.003683328628540039
r_  generation:  0.04723954200744629
local_output_nid generation:  0.0032720565795898438
local_in_edges_tensor generation:  0.001779794692993164
mini_batch_src_global generation:  0.0036661624908447266
r_  generation:  0.046756744384765625
local_output_nid generation:  0.0033111572265625
local_in_edges_tensor generation:  0.0018248558044433594
mini_batch_src_global generation:  0.003795146942138672
r_  generation:  0.047760963439941406
----------------------check_connections_block total spend ----------------------------- 0.5334141254425049
generate_one_block  0.0588376522064209
generate_one_block  0.061699867248535156
generate_one_block  0.06165647506713867
generate_one_block  0.06193232536315918
generate_one_block  0.060764312744140625
generate_one_block  0.06153726577758789
generate_one_block  0.06288409233093262
generate_one_block  0.06180548667907715
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03807663917541504
gen group dst list time:  0.015263557434082031
time for parepare:  0.019043684005737305
local_output_nid generation:  0.011253595352172852
local_in_edges_tensor generation:  0.028534650802612305
mini_batch_src_global generation:  0.03641963005065918
r_  generation:  0.3575596809387207
local_output_nid generation:  0.017974376678466797
local_in_edges_tensor generation:  0.026122331619262695
mini_batch_src_global generation:  0.047095298767089844
r_  generation:  0.3762037754058838
local_output_nid generation:  0.018622636795043945
local_in_edges_tensor generation:  0.02624988555908203
mini_batch_src_global generation:  0.04432868957519531
r_  generation:  0.3818488121032715
local_output_nid generation:  0.01960587501525879
local_in_edges_tensor generation:  0.021631717681884766
mini_batch_src_global generation:  0.04829144477844238
r_  generation:  0.3782343864440918
local_output_nid generation:  0.018418550491333008
local_in_edges_tensor generation:  0.01963520050048828
mini_batch_src_global generation:  0.047924041748046875
r_  generation:  0.38086867332458496
local_output_nid generation:  0.018575668334960938
local_in_edges_tensor generation:  0.023113489151000977
mini_batch_src_global generation:  0.04601001739501953
r_  generation:  0.3766520023345947
local_output_nid generation:  0.0182192325592041
local_in_edges_tensor generation:  0.020815610885620117
mini_batch_src_global generation:  0.047695159912109375
r_  generation:  0.375521183013916
local_output_nid generation:  0.0186464786529541
local_in_edges_tensor generation:  0.021220684051513672
mini_batch_src_global generation:  0.0487515926361084
r_  generation:  0.37885189056396484
----------------------check_connections_block total spend ----------------------------- 4.355525255203247
generate_one_block  0.492997407913208
generate_one_block  0.4964597225189209
generate_one_block  0.4947361946105957
generate_one_block  0.49123454093933105
generate_one_block  0.48993730545043945
generate_one_block  0.4879574775695801
generate_one_block  0.4825100898742676
generate_one_block  0.5138626098632812
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.042704105377197266
gen group dst list time:  0.037780046463012695
time for parepare:  0.018956661224365234
local_output_nid generation:  0.025984764099121094
local_in_edges_tensor generation:  0.03738260269165039
mini_batch_src_global generation:  0.051450252532958984
r_  generation:  0.538787841796875
local_output_nid generation:  0.03302645683288574
local_in_edges_tensor generation:  0.03998517990112305
mini_batch_src_global generation:  0.07076501846313477
r_  generation:  0.5492565631866455
local_output_nid generation:  0.03507804870605469
local_in_edges_tensor generation:  0.0435490608215332
mini_batch_src_global generation:  0.06072664260864258
r_  generation:  0.5513808727264404
local_output_nid generation:  0.03488016128540039
local_in_edges_tensor generation:  0.033659934997558594
mini_batch_src_global generation:  0.06073784828186035
r_  generation:  0.5533585548400879
local_output_nid generation:  0.03537249565124512
local_in_edges_tensor generation:  0.03356194496154785
mini_batch_src_global generation:  0.06172299385070801
r_  generation:  0.5565977096557617
local_output_nid generation:  0.03519845008850098
local_in_edges_tensor generation:  0.033728837966918945
mini_batch_src_global generation:  0.06203031539916992
r_  generation:  0.5561361312866211
local_output_nid generation:  0.035040855407714844
local_in_edges_tensor generation:  0.033098697662353516
mini_batch_src_global generation:  0.062027931213378906
r_  generation:  0.562462568283081
local_output_nid generation:  0.035422563552856445
local_in_edges_tensor generation:  0.04001283645629883
mini_batch_src_global generation:  0.06287860870361328
r_  generation:  0.5633676052093506
----------------------check_connections_block total spend ----------------------------- 6.494612455368042
generate_one_block  0.6992502212524414
generate_one_block  0.7009811401367188
generate_one_block  0.7011387348175049
generate_one_block  0.69024658203125
generate_one_block  0.7013857364654541
generate_one_block  0.6980922222137451
generate_one_block  0.699251651763916
generate_one_block  0.7215416431427002
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14077520370483398  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

connection checking time:  10.850137710571289
block generation total time  9.561583280563354
average batch blocks generation time:  1.1951979100704193
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10683059692382812  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.953155517578125  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10680437088012695  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9582762718200684  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10653162002563477  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9596414566040039  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10621500015258789  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9526224136352539  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10684585571289062  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9552679061889648  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10648918151855469  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9527173042297363  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10703849792480469  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.949188232421875  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1064748764038086  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9564709663391113  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08161449432373047 |0.014375150203704834 |0.0034218132495880127 |8.863210678100586e-05 |0.0028897225856781006 |0.0016384124755859375 |
----------------------------------------------------------pseudo_mini_loss sum 1.9555871486663818
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  3058562
Number of first layer input nodes during this epoch:  1301302
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1414318084716797  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028066396713256836
range selection method range initialization spend 0.011971235275268555
time for parepare:  0.01613593101501465
local_output_nid generation:  0.0027294158935546875
local_in_edges_tensor generation:  0.004987001419067383
mini_batch_src_global generation:  0.003951311111450195
r_  generation:  0.04169201850891113
local_output_nid generation:  0.0032167434692382812
local_in_edges_tensor generation:  0.0019347667694091797
mini_batch_src_global generation:  0.00482630729675293
r_  generation:  0.04461073875427246
local_output_nid generation:  0.0032868385314941406
local_in_edges_tensor generation:  0.0017924308776855469
mini_batch_src_global generation:  0.003129243850708008
r_  generation:  0.044211387634277344
local_output_nid generation:  0.0033173561096191406
local_in_edges_tensor generation:  0.0018074512481689453
mini_batch_src_global generation:  0.0032808780670166016
r_  generation:  0.04577493667602539
local_output_nid generation:  0.0032355785369873047
local_in_edges_tensor generation:  0.0017979145050048828
mini_batch_src_global generation:  0.003400564193725586
r_  generation:  0.0462183952331543
local_output_nid generation:  0.003206014633178711
local_in_edges_tensor generation:  0.0017969608306884766
mini_batch_src_global generation:  0.0037424564361572266
r_  generation:  0.04785466194152832
local_output_nid generation:  0.0032837390899658203
local_in_edges_tensor generation:  0.0018153190612792969
mini_batch_src_global generation:  0.0036652088165283203
r_  generation:  0.0475621223449707
local_output_nid generation:  0.0032339096069335938
local_in_edges_tensor generation:  0.0017960071563720703
mini_batch_src_global generation:  0.003710508346557617
r_  generation:  0.048212528228759766
----------------------check_connections_block total spend ----------------------------- 0.5340750217437744
generate_one_block  0.05949735641479492
generate_one_block  0.06062030792236328
generate_one_block  0.060189008712768555
generate_one_block  0.06076169013977051
generate_one_block  0.06097841262817383
generate_one_block  0.06205177307128906
generate_one_block  0.06428718566894531
generate_one_block  0.061241865158081055
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03494882583618164
gen group dst list time:  0.015618562698364258
time for parepare:  0.019098997116088867
local_output_nid generation:  0.011507511138916016
local_in_edges_tensor generation:  0.03229808807373047
mini_batch_src_global generation:  0.044534921646118164
r_  generation:  0.3631002902984619
local_output_nid generation:  0.017729759216308594
local_in_edges_tensor generation:  0.021724224090576172
mini_batch_src_global generation:  0.04514908790588379
r_  generation:  0.3700556755065918
local_output_nid generation:  0.018708229064941406
local_in_edges_tensor generation:  0.01874232292175293
mini_batch_src_global generation:  0.04543638229370117
r_  generation:  0.38243675231933594
local_output_nid generation:  0.018428325653076172
local_in_edges_tensor generation:  0.022875070571899414
mini_batch_src_global generation:  0.04495096206665039
r_  generation:  0.3826282024383545
local_output_nid generation:  0.01829218864440918
local_in_edges_tensor generation:  0.019214630126953125
mini_batch_src_global generation:  0.047814130783081055
r_  generation:  0.3848583698272705
local_output_nid generation:  0.018155574798583984
local_in_edges_tensor generation:  0.01973581314086914
mini_batch_src_global generation:  0.04959869384765625
r_  generation:  0.38666725158691406
local_output_nid generation:  0.018305301666259766
local_in_edges_tensor generation:  0.02653193473815918
mini_batch_src_global generation:  0.04640078544616699
r_  generation:  0.385845422744751
local_output_nid generation:  0.018414020538330078
local_in_edges_tensor generation:  0.02082228660583496
mini_batch_src_global generation:  0.04914426803588867
r_  generation:  0.3795013427734375
----------------------check_connections_block total spend ----------------------------- 4.380057096481323
generate_one_block  0.48526453971862793
generate_one_block  0.49404311180114746
generate_one_block  0.4901268482208252
generate_one_block  0.4912090301513672
generate_one_block  0.48586297035217285
generate_one_block  0.4885866641998291
generate_one_block  0.49239063262939453
generate_one_block  0.5184495449066162
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03619074821472168
gen group dst list time:  0.03858828544616699
time for parepare:  0.020699501037597656
local_output_nid generation:  0.026634693145751953
local_in_edges_tensor generation:  0.04924917221069336
mini_batch_src_global generation:  0.05161237716674805
r_  generation:  0.5343513488769531
local_output_nid generation:  0.03304338455200195
local_in_edges_tensor generation:  0.041605234146118164
mini_batch_src_global generation:  0.06334662437438965
r_  generation:  0.5449748039245605
local_output_nid generation:  0.03356814384460449
local_in_edges_tensor generation:  0.03939318656921387
mini_batch_src_global generation:  0.06107306480407715
r_  generation:  0.5511813163757324
local_output_nid generation:  0.033986806869506836
local_in_edges_tensor generation:  0.03689408302307129
mini_batch_src_global generation:  0.060350656509399414
r_  generation:  0.5533478260040283
local_output_nid generation:  0.03423738479614258
local_in_edges_tensor generation:  0.034136295318603516
mini_batch_src_global generation:  0.060804128646850586
r_  generation:  0.5569896697998047
local_output_nid generation:  0.03417825698852539
local_in_edges_tensor generation:  0.04033613204956055
mini_batch_src_global generation:  0.06152987480163574
r_  generation:  0.5643229484558105
local_output_nid generation:  0.03413128852844238
local_in_edges_tensor generation:  0.03657197952270508
mini_batch_src_global generation:  0.06537079811096191
r_  generation:  0.5601518154144287
local_output_nid generation:  0.034047842025756836
local_in_edges_tensor generation:  0.03926992416381836
mini_batch_src_global generation:  0.06261062622070312
r_  generation:  0.5705535411834717
----------------------check_connections_block total spend ----------------------------- 6.49812388420105
generate_one_block  0.7029848098754883
generate_one_block  0.7072854042053223
generate_one_block  0.7029731273651123
generate_one_block  0.710515022277832
generate_one_block  0.6954631805419922
generate_one_block  0.699268102645874
generate_one_block  0.7288906574249268
generate_one_block  0.7175779342651367
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1414318084716797  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

connection checking time:  10.878180980682373
block generation total time  9.610891580581665
average batch blocks generation time:  1.2013614475727081
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10688114166259766  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9556169509887695  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10638713836669922  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9551229476928711  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10703277587890625  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9552373886108398  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10664176940917969  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9549789428710938  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10698699951171875  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9512791633605957  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10651636123657227  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9544825553894043  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10691452026367188  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9569916725158691  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10631370544433594  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9561066627502441  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08729907870292664 |0.016747474670410156 |0.003480583429336548 |8.609890937805176e-05 |0.0037588775157928467 |0.0017781257629394531 |
----------------------------------------------------------pseudo_mini_loss sum 1.8729466199874878
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  3059233
Number of first layer input nodes during this epoch:  1301141
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14142274856567383  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02417159080505371
range selection method range initialization spend 0.01194143295288086
time for parepare:  0.01594376564025879
local_output_nid generation:  0.002830982208251953
local_in_edges_tensor generation:  0.005332231521606445
mini_batch_src_global generation:  0.0039463043212890625
r_  generation:  0.04144024848937988
local_output_nid generation:  0.0032112598419189453
local_in_edges_tensor generation:  0.0023381710052490234
mini_batch_src_global generation:  0.0046465396881103516
r_  generation:  0.04368448257446289
local_output_nid generation:  0.003305673599243164
local_in_edges_tensor generation:  0.0017883777618408203
mini_batch_src_global generation:  0.003167390823364258
r_  generation:  0.0446317195892334
local_output_nid generation:  0.003297567367553711
local_in_edges_tensor generation:  0.0017857551574707031
mini_batch_src_global generation:  0.0033271312713623047
r_  generation:  0.04611945152282715
local_output_nid generation:  0.003206491470336914
local_in_edges_tensor generation:  0.0018134117126464844
mini_batch_src_global generation:  0.003543376922607422
r_  generation:  0.046765804290771484
local_output_nid generation:  0.0032231807708740234
local_in_edges_tensor generation:  0.0018427371978759766
mini_batch_src_global generation:  0.0036840438842773438
r_  generation:  0.04769706726074219
local_output_nid generation:  0.003231048583984375
local_in_edges_tensor generation:  0.0018084049224853516
mini_batch_src_global generation:  0.0036454200744628906
r_  generation:  0.04796314239501953
local_output_nid generation:  0.003226757049560547
local_in_edges_tensor generation:  0.0018520355224609375
mini_batch_src_global generation:  0.0036749839782714844
r_  generation:  0.04737973213195801
----------------------check_connections_block total spend ----------------------------- 0.534278154373169
generate_one_block  0.058897972106933594
generate_one_block  0.05991363525390625
generate_one_block  0.06034398078918457
generate_one_block  0.061577558517456055
generate_one_block  0.06216096878051758
generate_one_block  0.06247973442077637
generate_one_block  0.06474065780639648
generate_one_block  0.06120800971984863
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03455686569213867
gen group dst list time:  0.015362977981567383
time for parepare:  0.018799304962158203
local_output_nid generation:  0.011646747589111328
local_in_edges_tensor generation:  0.029572725296020508
mini_batch_src_global generation:  0.03642106056213379
r_  generation:  0.3568577766418457
local_output_nid generation:  0.01795363426208496
local_in_edges_tensor generation:  0.023032188415527344
mini_batch_src_global generation:  0.04384803771972656
r_  generation:  0.3658924102783203
local_output_nid generation:  0.01903057098388672
local_in_edges_tensor generation:  0.020469188690185547
mini_batch_src_global generation:  0.04375100135803223
r_  generation:  0.3689157962799072
local_output_nid generation:  0.01824784278869629
local_in_edges_tensor generation:  0.020716190338134766
mini_batch_src_global generation:  0.04430508613586426
r_  generation:  0.37372732162475586
local_output_nid generation:  0.018359661102294922
local_in_edges_tensor generation:  0.021483421325683594
mini_batch_src_global generation:  0.04570913314819336
r_  generation:  0.3804337978363037
local_output_nid generation:  0.018587827682495117
local_in_edges_tensor generation:  0.019802093505859375
mini_batch_src_global generation:  0.048573970794677734
r_  generation:  0.38101816177368164
local_output_nid generation:  0.01853489875793457
local_in_edges_tensor generation:  0.0200045108795166
mini_batch_src_global generation:  0.046698570251464844
r_  generation:  0.3887765407562256
local_output_nid generation:  0.01832747459411621
local_in_edges_tensor generation:  0.01987171173095703
mini_batch_src_global generation:  0.0465388298034668
r_  generation:  0.3758370876312256
----------------------check_connections_block total spend ----------------------------- 4.314384937286377
generate_one_block  0.4916188716888428
generate_one_block  0.48232340812683105
generate_one_block  0.4747345447540283
generate_one_block  0.48140716552734375
generate_one_block  0.4899628162384033
generate_one_block  0.49227142333984375
generate_one_block  0.48626160621643066
generate_one_block  0.502108097076416
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.039566993713378906
gen group dst list time:  0.03766965866088867
time for parepare:  0.018495798110961914
local_output_nid generation:  0.026027917861938477
local_in_edges_tensor generation:  0.039170026779174805
mini_batch_src_global generation:  0.05246400833129883
r_  generation:  0.5355985164642334
local_output_nid generation:  0.033136606216430664
local_in_edges_tensor generation:  0.03683209419250488
mini_batch_src_global generation:  0.06403088569641113
r_  generation:  0.5430600643157959
local_output_nid generation:  0.033954620361328125
local_in_edges_tensor generation:  0.03537154197692871
mini_batch_src_global generation:  0.06175112724304199
r_  generation:  0.5491585731506348
local_output_nid generation:  0.03381061553955078
local_in_edges_tensor generation:  0.04182744026184082
mini_batch_src_global generation:  0.06246161460876465
r_  generation:  0.5517973899841309
local_output_nid generation:  0.03440046310424805
local_in_edges_tensor generation:  0.035275936126708984
mini_batch_src_global generation:  0.0626986026763916
r_  generation:  0.5616104602813721
local_output_nid generation:  0.034364938735961914
local_in_edges_tensor generation:  0.03417563438415527
mini_batch_src_global generation:  0.061860084533691406
r_  generation:  0.5588805675506592
local_output_nid generation:  0.03461289405822754
local_in_edges_tensor generation:  0.03476691246032715
mini_batch_src_global generation:  0.06468486785888672
r_  generation:  0.5664994716644287
local_output_nid generation:  0.03477668762207031
local_in_edges_tensor generation:  0.03688192367553711
mini_batch_src_global generation:  0.06384873390197754
r_  generation:  0.5604565143585205
----------------------check_connections_block total spend ----------------------------- 6.474042654037476
generate_one_block  0.6945042610168457
generate_one_block  0.6976773738861084
generate_one_block  0.6953554153442383
generate_one_block  0.7005376815795898
generate_one_block  0.7017576694488525
generate_one_block  0.6968221664428711
generate_one_block  0.7058906555175781
generate_one_block  0.6998648643493652
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14142274856567383  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

connection checking time:  10.788427591323853
block generation total time  9.493098020553589
average batch blocks generation time:  1.1866372525691986
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10696220397949219  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9553050994873047  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10648298263549805  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9501256942749023  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10675716400146484  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9508743286132812  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1064453125  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9548707008361816  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10705089569091797  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9554133415222168  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10633420944213867  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9549813270568848  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10652685165405273  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9604229927062988  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10670280456542969  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9550590515136719  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08655434846878052 |0.014332890510559082 |0.003445357084274292 |8.764863014221191e-05 |0.0038518905639648438 |0.0028853416442871094 |
----------------------------------------------------------pseudo_mini_loss sum 1.788084626197815
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  3058365
Number of first layer input nodes during this epoch:  1301379
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14111566543579102  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.07810688018798828
range selection method range initialization spend 0.011645317077636719
time for parepare:  0.018986940383911133
local_output_nid generation:  0.002930879592895508
local_in_edges_tensor generation:  0.00475764274597168
mini_batch_src_global generation:  0.003800630569458008
r_  generation:  0.041248321533203125
local_output_nid generation:  0.0035424232482910156
local_in_edges_tensor generation:  0.001990795135498047
mini_batch_src_global generation:  0.00457000732421875
r_  generation:  0.04303765296936035
local_output_nid generation:  0.0038132667541503906
local_in_edges_tensor generation:  0.0022542476654052734
mini_batch_src_global generation:  0.003159761428833008
r_  generation:  0.04601168632507324
local_output_nid generation:  0.004061460494995117
local_in_edges_tensor generation:  0.0021708011627197266
mini_batch_src_global generation:  0.0031883716583251953
r_  generation:  0.046502113342285156
local_output_nid generation:  0.0040130615234375
local_in_edges_tensor generation:  0.002106189727783203
mini_batch_src_global generation:  0.0034987926483154297
r_  generation:  0.047023773193359375
local_output_nid generation:  0.004057884216308594
local_in_edges_tensor generation:  0.0021355152130126953
mini_batch_src_global generation:  0.0036344528198242188
r_  generation:  0.048126935958862305
local_output_nid generation:  0.004065752029418945
local_in_edges_tensor generation:  0.0021228790283203125
mini_batch_src_global generation:  0.0037097930908203125
r_  generation:  0.04751753807067871
local_output_nid generation:  0.0040438175201416016
local_in_edges_tensor generation:  0.002177000045776367
mini_batch_src_global generation:  0.0038101673126220703
r_  generation:  0.0489957332611084
----------------------check_connections_block total spend ----------------------------- 0.5458576679229736
generate_one_block  0.0644526481628418
generate_one_block  0.06279778480529785
generate_one_block  0.06913256645202637
generate_one_block  0.06780219078063965
generate_one_block  0.06187605857849121
generate_one_block  0.062273502349853516
generate_one_block  0.06496095657348633
generate_one_block  0.06367135047912598
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03535008430480957
gen group dst list time:  0.015881776809692383
time for parepare:  0.029934167861938477
local_output_nid generation:  0.014633893966674805
local_in_edges_tensor generation:  0.023324966430664062
mini_batch_src_global generation:  0.03604388236999512
r_  generation:  0.35634350776672363
local_output_nid generation:  0.02062535285949707
local_in_edges_tensor generation:  0.01831817626953125
mini_batch_src_global generation:  0.04416346549987793
r_  generation:  0.36490607261657715
local_output_nid generation:  0.021587610244750977
local_in_edges_tensor generation:  0.019300222396850586
mini_batch_src_global generation:  0.0445253849029541
r_  generation:  0.3805673122406006
local_output_nid generation:  0.021800518035888672
local_in_edges_tensor generation:  0.019364118576049805
mini_batch_src_global generation:  0.04515790939331055
r_  generation:  0.3830409049987793
local_output_nid generation:  0.02192544937133789
local_in_edges_tensor generation:  0.0243380069732666
mini_batch_src_global generation:  0.05433917045593262
r_  generation:  0.4044210910797119
local_output_nid generation:  0.027537822723388672
local_in_edges_tensor generation:  0.030261516571044922
mini_batch_src_global generation:  0.049025774002075195
r_  generation:  0.38614630699157715
local_output_nid generation:  0.02219700813293457
local_in_edges_tensor generation:  0.022908926010131836
mini_batch_src_global generation:  0.049950361251831055
r_  generation:  0.38597583770751953
local_output_nid generation:  0.022671222686767578
local_in_edges_tensor generation:  0.021694421768188477
mini_batch_src_global generation:  0.04770159721374512
r_  generation:  0.389423131942749
----------------------check_connections_block total spend ----------------------------- 4.446619987487793
generate_one_block  0.4963696002960205
generate_one_block  0.48140573501586914
generate_one_block  0.5055084228515625
generate_one_block  0.49671268463134766
generate_one_block  0.48760533332824707
generate_one_block  0.5069375038146973
generate_one_block  0.5103943347930908
generate_one_block  0.5343074798583984
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03986525535583496
gen group dst list time:  0.039064884185791016
time for parepare:  0.020537137985229492
local_output_nid generation:  0.027051925659179688
local_in_edges_tensor generation:  0.042502641677856445
mini_batch_src_global generation:  0.054236650466918945
r_  generation:  0.5471608638763428
local_output_nid generation:  0.033444881439208984
local_in_edges_tensor generation:  0.04456448554992676
mini_batch_src_global generation:  0.06404352188110352
r_  generation:  0.567415714263916
local_output_nid generation:  0.03387093544006348
local_in_edges_tensor generation:  0.03535795211791992
mini_batch_src_global generation:  0.06352853775024414
r_  generation:  0.5648620128631592
local_output_nid generation:  0.0345306396484375
local_in_edges_tensor generation:  0.04057431221008301
mini_batch_src_global generation:  0.06029200553894043
r_  generation:  0.5640339851379395
local_output_nid generation:  0.03452587127685547
local_in_edges_tensor generation:  0.03522944450378418
mini_batch_src_global generation:  0.08175086975097656
r_  generation:  0.6375524997711182
local_output_nid generation:  0.03527569770812988
local_in_edges_tensor generation:  0.0389862060546875
mini_batch_src_global generation:  0.06604743003845215
r_  generation:  0.6008076667785645
local_output_nid generation:  0.039225101470947266
local_in_edges_tensor generation:  0.050020694732666016
mini_batch_src_global generation:  0.06928443908691406
r_  generation:  0.5675663948059082
local_output_nid generation:  0.035925865173339844
local_in_edges_tensor generation:  0.038880109786987305
mini_batch_src_global generation:  0.0630636215209961
r_  generation:  0.5763435363769531
----------------------check_connections_block total spend ----------------------------- 6.798871994018555
generate_one_block  0.7275898456573486
generate_one_block  0.7131543159484863
generate_one_block  0.732785701751709
generate_one_block  0.719977617263794
generate_one_block  0.7107317447662354
generate_one_block  0.6990315914154053
generate_one_block  0.7103054523468018
generate_one_block  0.724313497543335
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14111566543579102  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

connection checking time:  11.245491981506348
block generation total time  9.757130861282349
average batch blocks generation time:  1.2196413576602936
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10705089569091797  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9511590003967285  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10617208480834961  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9512171745300293  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10747003555297852  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9580764770507812  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10587787628173828  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9547257423400879  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1070241928100586  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9539036750793457  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10674715042114258  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9553494453430176  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10644960403442383  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9541487693786621  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10669755935668945  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9632763862609863  GigaBytes
Max Memory Allocated: 1.1030240058898926  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08161962032318115 |0.019032984972000122 |0.006014913320541382 |9.176135063171387e-05 |0.003381967544555664 |0.0030574798583984375 |
----------------------------------------------------------pseudo_mini_loss sum 1.6992747783660889
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  3058044
Number of first layer input nodes during this epoch:  1300692
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14272022247314453  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.029901981353759766
range selection method range initialization spend 0.012321233749389648
time for parepare:  0.01611185073852539
local_output_nid generation:  0.002688884735107422
local_in_edges_tensor generation:  0.007926464080810547
mini_batch_src_global generation:  0.003526449203491211
r_  generation:  0.04159712791442871
local_output_nid generation:  0.003216981887817383
local_in_edges_tensor generation:  0.0017871856689453125
mini_batch_src_global generation:  0.00495600700378418
r_  generation:  0.04467058181762695
local_output_nid generation:  0.0032351016998291016
local_in_edges_tensor generation:  0.0018100738525390625
mini_batch_src_global generation:  0.0033512115478515625
r_  generation:  0.04623556137084961
local_output_nid generation:  0.0032308101654052734
local_in_edges_tensor generation:  0.0018465518951416016
mini_batch_src_global generation:  0.003392934799194336
r_  generation:  0.04662322998046875
local_output_nid generation:  0.003275156021118164
local_in_edges_tensor generation:  0.0018351078033447266
mini_batch_src_global generation:  0.0035698413848876953
r_  generation:  0.047040700912475586
local_output_nid generation:  0.0031926631927490234
local_in_edges_tensor generation:  0.0018076896667480469
mini_batch_src_global generation:  0.003667593002319336
r_  generation:  0.04847598075866699
local_output_nid generation:  0.0034079551696777344
local_in_edges_tensor generation:  0.0018773078918457031
mini_batch_src_global generation:  0.0037970542907714844
r_  generation:  0.04799604415893555
local_output_nid generation:  0.003195524215698242
local_in_edges_tensor generation:  0.0018644332885742188
mini_batch_src_global generation:  0.003946781158447266
r_  generation:  0.04870271682739258
----------------------check_connections_block total spend ----------------------------- 0.5445308685302734
generate_one_block  0.05903172492980957
generate_one_block  0.06145453453063965
generate_one_block  0.06229257583618164
generate_one_block  0.061853647232055664
generate_one_block  0.06165480613708496
generate_one_block  0.06186318397521973
generate_one_block  0.06485128402709961
generate_one_block  0.06252384185791016
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03690648078918457
gen group dst list time:  0.015319585800170898
time for parepare:  0.020418882369995117
local_output_nid generation:  0.011582374572753906
local_in_edges_tensor generation:  0.03149127960205078
mini_batch_src_global generation:  0.03655195236206055
r_  generation:  0.3583693504333496
local_output_nid generation:  0.01780533790588379
local_in_edges_tensor generation:  0.025341510772705078
mini_batch_src_global generation:  0.044573068618774414
r_  generation:  0.3708360195159912
local_output_nid generation:  0.018871307373046875
local_in_edges_tensor generation:  0.020385026931762695
mini_batch_src_global generation:  0.04426693916320801
r_  generation:  0.37770581245422363
local_output_nid generation:  0.018655061721801758
local_in_edges_tensor generation:  0.021506786346435547
mini_batch_src_global generation:  0.04534506797790527
r_  generation:  0.37976527214050293
local_output_nid generation:  0.01895594596862793
local_in_edges_tensor generation:  0.022383689880371094
mini_batch_src_global generation:  0.04594254493713379
r_  generation:  0.3848307132720947
local_output_nid generation:  0.01862478256225586
local_in_edges_tensor generation:  0.021220922470092773
mini_batch_src_global generation:  0.04671883583068848
r_  generation:  0.39522361755371094
local_output_nid generation:  0.018297672271728516
local_in_edges_tensor generation:  0.02566385269165039
mini_batch_src_global generation:  0.04689168930053711
r_  generation:  0.3928406238555908
local_output_nid generation:  0.021205902099609375
local_in_edges_tensor generation:  0.021825551986694336
mini_batch_src_global generation:  0.04970550537109375
r_  generation:  0.3845851421356201
----------------------check_connections_block total spend ----------------------------- 4.394154071807861
generate_one_block  0.4850497245788574
generate_one_block  0.4853477478027344
generate_one_block  0.4881465435028076
generate_one_block  0.48776936531066895
generate_one_block  0.4900360107421875
generate_one_block  0.4942662715911865
generate_one_block  0.492215633392334
generate_one_block  0.5202810764312744
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03585052490234375
gen group dst list time:  0.03750896453857422
time for parepare:  0.018117189407348633
local_output_nid generation:  0.0263822078704834
local_in_edges_tensor generation:  0.045130252838134766
mini_batch_src_global generation:  0.0533299446105957
r_  generation:  0.5432770252227783
local_output_nid generation:  0.0335237979888916
local_in_edges_tensor generation:  0.03717660903930664
mini_batch_src_global generation:  0.06376385688781738
r_  generation:  0.5480849742889404
local_output_nid generation:  0.0339818000793457
local_in_edges_tensor generation:  0.038053035736083984
mini_batch_src_global generation:  0.06386327743530273
r_  generation:  0.5568735599517822
local_output_nid generation:  0.03434109687805176
local_in_edges_tensor generation:  0.03850674629211426
mini_batch_src_global generation:  0.06018209457397461
r_  generation:  0.5595748424530029
local_output_nid generation:  0.03469133377075195
local_in_edges_tensor generation:  0.03839397430419922
mini_batch_src_global generation:  0.06103348731994629
r_  generation:  0.5613842010498047
local_output_nid generation:  0.034844398498535156
local_in_edges_tensor generation:  0.03331613540649414
mini_batch_src_global generation:  0.062487125396728516
r_  generation:  0.5638864040374756
local_output_nid generation:  0.03500723838806152
local_in_edges_tensor generation:  0.037979841232299805
mini_batch_src_global generation:  0.06507229804992676
r_  generation:  0.5666546821594238
local_output_nid generation:  0.03512454032897949
local_in_edges_tensor generation:  0.03406667709350586
mini_batch_src_global generation:  0.06360268592834473
r_  generation:  0.5712642669677734
----------------------check_connections_block total spend ----------------------------- 6.545780658721924
generate_one_block  0.7037863731384277
generate_one_block  0.7029194831848145
generate_one_block  0.7161738872528076
generate_one_block  0.7184398174285889
generate_one_block  0.7089669704437256
generate_one_block  0.7128515243530273
generate_one_block  0.708808183670044
generate_one_block  0.7008688449859619
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14272022247314453  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

connection checking time:  10.939934730529785
block generation total time  9.615927457809448
average batch blocks generation time:  1.201990932226181
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10638952255249023  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9534807205200195  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1065669059753418  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9506707191467285  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10694503784179688  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9551734924316406  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10647439956665039  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9549403190612793  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10703849792480469  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9553971290588379  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10663652420043945  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9555950164794922  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10687732696533203  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9563169479370117  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10650444030761719  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.955836296081543  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08619284629821777 |0.016263723373413086 |0.0035523176193237305 |9.077787399291992e-05 |0.003800719976425171 |0.0016789436340332031 |
----------------------------------------------------------pseudo_mini_loss sum 1.6361886262893677
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  3058440
Number of first layer input nodes during this epoch:  1300983
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1414356231689453  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024383068084716797
range selection method range initialization spend 0.01203155517578125
time for parepare:  0.01623678207397461
local_output_nid generation:  0.002704143524169922
local_in_edges_tensor generation:  0.0041103363037109375
mini_batch_src_global generation:  0.0036385059356689453
r_  generation:  0.04243135452270508
local_output_nid generation:  0.003174304962158203
local_in_edges_tensor generation:  0.0020999908447265625
mini_batch_src_global generation:  0.0048673152923583984
r_  generation:  0.04515385627746582
local_output_nid generation:  0.003176450729370117
local_in_edges_tensor generation:  0.0018277168273925781
mini_batch_src_global generation:  0.0032558441162109375
r_  generation:  0.045099496841430664
local_output_nid generation:  0.003195524215698242
local_in_edges_tensor generation:  0.0018033981323242188
mini_batch_src_global generation:  0.0032606124877929688
r_  generation:  0.04626345634460449
local_output_nid generation:  0.0031926631927490234
local_in_edges_tensor generation:  0.0018208026885986328
mini_batch_src_global generation:  0.0036067962646484375
r_  generation:  0.04764270782470703
local_output_nid generation:  0.0032033920288085938
local_in_edges_tensor generation:  0.0018134117126464844
mini_batch_src_global generation:  0.0037577152252197266
r_  generation:  0.04919242858886719
local_output_nid generation:  0.0032033920288085938
local_in_edges_tensor generation:  0.001976490020751953
mini_batch_src_global generation:  0.0038073062896728516
r_  generation:  0.04853701591491699
local_output_nid generation:  0.0032320022583007812
local_in_edges_tensor generation:  0.0018916130065917969
mini_batch_src_global generation:  0.0038034915924072266
r_  generation:  0.04793357849121094
----------------------check_connections_block total spend ----------------------------- 0.540360689163208
generate_one_block  0.059798240661621094
generate_one_block  0.062354326248168945
generate_one_block  0.06181979179382324
generate_one_block  0.0603792667388916
generate_one_block  0.06195473670959473
generate_one_block  0.06266236305236816
generate_one_block  0.06640291213989258
generate_one_block  0.06198525428771973
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0386807918548584
gen group dst list time:  0.016245126724243164
time for parepare:  0.01981639862060547
local_output_nid generation:  0.011839866638183594
local_in_edges_tensor generation:  0.029635190963745117
mini_batch_src_global generation:  0.0369412899017334
r_  generation:  0.357877254486084
local_output_nid generation:  0.017873287200927734
local_in_edges_tensor generation:  0.02484583854675293
mini_batch_src_global generation:  0.047035932540893555
r_  generation:  0.37766551971435547
local_output_nid generation:  0.01854729652404785
local_in_edges_tensor generation:  0.020634174346923828
mini_batch_src_global generation:  0.04448366165161133
r_  generation:  0.38071441650390625
local_output_nid generation:  0.018561124801635742
local_in_edges_tensor generation:  0.019488096237182617
mini_batch_src_global generation:  0.045362234115600586
r_  generation:  0.37784457206726074
local_output_nid generation:  0.019324541091918945
local_in_edges_tensor generation:  0.019806385040283203
mini_batch_src_global generation:  0.047620296478271484
r_  generation:  0.3849754333496094
local_output_nid generation:  0.018376827239990234
local_in_edges_tensor generation:  0.021592140197753906
mini_batch_src_global generation:  0.046887874603271484
r_  generation:  0.39119839668273926
local_output_nid generation:  0.018507957458496094
local_in_edges_tensor generation:  0.021705150604248047
mini_batch_src_global generation:  0.04724860191345215
r_  generation:  0.38500356674194336
local_output_nid generation:  0.018258333206176758
local_in_edges_tensor generation:  0.021280288696289062
mini_batch_src_global generation:  0.04678916931152344
r_  generation:  0.38097047805786133
----------------------check_connections_block total spend ----------------------------- 4.373538970947266
generate_one_block  0.4894576072692871
generate_one_block  0.49771690368652344
generate_one_block  0.49167394638061523
generate_one_block  0.47946619987487793
generate_one_block  0.4892232418060303
generate_one_block  0.4999048709869385
generate_one_block  0.49181556701660156
generate_one_block  0.5064911842346191
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0342254638671875
gen group dst list time:  0.037644386291503906
time for parepare:  0.0187528133392334
local_output_nid generation:  0.026908159255981445
local_in_edges_tensor generation:  0.04003262519836426
mini_batch_src_global generation:  0.054717063903808594
r_  generation:  0.5417540073394775
local_output_nid generation:  0.03416895866394043
local_in_edges_tensor generation:  0.044142961502075195
mini_batch_src_global generation:  0.06317472457885742
r_  generation:  0.5519797801971436
local_output_nid generation:  0.03436088562011719
local_in_edges_tensor generation:  0.03632354736328125
mini_batch_src_global generation:  0.06225752830505371
r_  generation:  0.5600543022155762
local_output_nid generation:  0.035109758377075195
local_in_edges_tensor generation:  0.0357666015625
mini_batch_src_global generation:  0.06289362907409668
r_  generation:  0.565575122833252
local_output_nid generation:  0.03524637222290039
local_in_edges_tensor generation:  0.03642416000366211
mini_batch_src_global generation:  0.06434416770935059
r_  generation:  0.5689034461975098
local_output_nid generation:  0.03522825241088867
local_in_edges_tensor generation:  0.03838491439819336
mini_batch_src_global generation:  0.06147313117980957
r_  generation:  0.5687530040740967
local_output_nid generation:  0.03665566444396973
local_in_edges_tensor generation:  0.03413867950439453
mini_batch_src_global generation:  0.06197094917297363
r_  generation:  0.5742816925048828
local_output_nid generation:  0.035230398178100586
local_in_edges_tensor generation:  0.03874564170837402
mini_batch_src_global generation:  0.0637967586517334
r_  generation:  0.5729262828826904
----------------------check_connections_block total spend ----------------------------- 6.584528923034668
generate_one_block  0.700136661529541
generate_one_block  0.6996605396270752
generate_one_block  0.7064979076385498
generate_one_block  0.7028055191040039
generate_one_block  0.7060286998748779
generate_one_block  0.702772855758667
generate_one_block  0.7102973461151123
generate_one_block  0.7072625160217285
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1414356231689453  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

connection checking time:  10.958067893981934
block generation total time  9.581211566925049
average batch blocks generation time:  1.197651445865631
block dataloader generation time/epoch 22.554819107055664
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10641670227050781  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9532394409179688  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10638856887817383  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.956392765045166  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10643720626831055  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9529328346252441  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10613632202148438  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9514074325561523  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10734415054321289  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9559512138366699  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10637712478637695  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9546217918395996  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10696792602539062  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.95751953125  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1058206558227539  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.952519416809082  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08586081862449646 |0.013932883739471436 |0.003541797399520874 |9.062886238098145e-05 |0.003850281238555908 |0.002852916717529297 |
----------------------------------------------------------pseudo_mini_loss sum 1.590802788734436
Total (block generation + training)time/epoch 23.49228310585022
Training time/epoch 0.9372570514678955
Training time without block to device /epoch 0.825793981552124
Training time without total dataloading part /epoch 0.0627145767211914
load block tensor time/epoch 0.6868865489959717
block to device time/epoch 0.11146306991577148
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  3057826
Number of first layer input nodes during this epoch:  1300986
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1406998634338379  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021783113479614258
range selection method range initialization spend 0.011892318725585938
time for parepare:  0.01625537872314453
local_output_nid generation:  0.002816438674926758
local_in_edges_tensor generation:  0.004288911819458008
mini_batch_src_global generation:  0.0036306381225585938
r_  generation:  0.042656660079956055
local_output_nid generation:  0.003200531005859375
local_in_edges_tensor generation:  0.0017833709716796875
mini_batch_src_global generation:  0.0048182010650634766
r_  generation:  0.044770002365112305
local_output_nid generation:  0.0031807422637939453
local_in_edges_tensor generation:  0.001764535903930664
mini_batch_src_global generation:  0.00328826904296875
r_  generation:  0.045645713806152344
local_output_nid generation:  0.003222942352294922
local_in_edges_tensor generation:  0.0018451213836669922
mini_batch_src_global generation:  0.0032982826232910156
r_  generation:  0.04652595520019531
local_output_nid generation:  0.003214120864868164
local_in_edges_tensor generation:  0.0018165111541748047
mini_batch_src_global generation:  0.0036880970001220703
r_  generation:  0.04781174659729004
local_output_nid generation:  0.003174304962158203
local_in_edges_tensor generation:  0.0018343925476074219
mini_batch_src_global generation:  0.003759622573852539
r_  generation:  0.04761314392089844
local_output_nid generation:  0.003172159194946289
local_in_edges_tensor generation:  0.0018248558044433594
mini_batch_src_global generation:  0.0036728382110595703
r_  generation:  0.04747891426086426
local_output_nid generation:  0.003162384033203125
local_in_edges_tensor generation:  0.0017850399017333984
mini_batch_src_global generation:  0.0037336349487304688
r_  generation:  0.04814910888671875
----------------------check_connections_block total spend ----------------------------- 0.5378949642181396
generate_one_block  0.05965423583984375
generate_one_block  0.06104087829589844
generate_one_block  0.06446957588195801
generate_one_block  0.06217503547668457
generate_one_block  0.062088966369628906
generate_one_block  0.06083822250366211
generate_one_block  0.06384515762329102
generate_one_block  0.06216144561767578
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03404498100280762
gen group dst list time:  0.015703201293945312
time for parepare:  0.019076108932495117
local_output_nid generation:  0.011764049530029297
local_in_edges_tensor generation:  0.026555538177490234
mini_batch_src_global generation:  0.03650045394897461
r_  generation:  0.3584558963775635
local_output_nid generation:  0.018021821975708008
local_in_edges_tensor generation:  0.023358583450317383
mini_batch_src_global generation:  0.0462033748626709
r_  generation:  0.3719804286956787
local_output_nid generation:  0.018712282180786133
local_in_edges_tensor generation:  0.018889904022216797
mini_batch_src_global generation:  0.04425454139709473
r_  generation:  0.37580060958862305
local_output_nid generation:  0.019800186157226562
local_in_edges_tensor generation:  0.0215909481048584
mini_batch_src_global generation:  0.04497718811035156
r_  generation:  0.37762022018432617
local_output_nid generation:  0.019570589065551758
local_in_edges_tensor generation:  0.019865036010742188
mini_batch_src_global generation:  0.04774212837219238
r_  generation:  0.3848235607147217
local_output_nid generation:  0.018334388732910156
local_in_edges_tensor generation:  0.01987147331237793
mini_batch_src_global generation:  0.04614853858947754
r_  generation:  0.38126516342163086
local_output_nid generation:  0.018329858779907227
local_in_edges_tensor generation:  0.021428823471069336
mini_batch_src_global generation:  0.04497981071472168
r_  generation:  0.3760981559753418
local_output_nid generation:  0.01852869987487793
local_in_edges_tensor generation:  0.01961827278137207
mini_batch_src_global generation:  0.04613637924194336
r_  generation:  0.3808596134185791
----------------------check_connections_block total spend ----------------------------- 4.330126762390137
generate_one_block  0.487074613571167
generate_one_block  0.4874744415283203
generate_one_block  0.48815321922302246
generate_one_block  0.487105131149292
generate_one_block  0.4907572269439697
generate_one_block  0.47956204414367676
generate_one_block  0.4853949546813965
generate_one_block  0.5173985958099365
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03425288200378418
gen group dst list time:  0.03772091865539551
time for parepare:  0.019774436950683594
local_output_nid generation:  0.026781082153320312
local_in_edges_tensor generation:  0.03891634941101074
mini_batch_src_global generation:  0.05269432067871094
r_  generation:  0.5440614223480225
local_output_nid generation:  0.036867380142211914
local_in_edges_tensor generation:  0.043474435806274414
mini_batch_src_global generation:  0.06473040580749512
r_  generation:  0.5506551265716553
local_output_nid generation:  0.03442215919494629
local_in_edges_tensor generation:  0.03492450714111328
mini_batch_src_global generation:  0.06215023994445801
r_  generation:  0.5589780807495117
local_output_nid generation:  0.03759598731994629
local_in_edges_tensor generation:  0.036153554916381836
mini_batch_src_global generation:  0.061129093170166016
r_  generation:  0.5650818347930908
local_output_nid generation:  0.035471439361572266
local_in_edges_tensor generation:  0.03639674186706543
mini_batch_src_global generation:  0.06172513961791992
r_  generation:  0.5682120323181152
local_output_nid generation:  0.03559708595275879
local_in_edges_tensor generation:  0.03926348686218262
mini_batch_src_global generation:  0.06318545341491699
r_  generation:  0.5638067722320557
local_output_nid generation:  0.03524494171142578
local_in_edges_tensor generation:  0.03905963897705078
mini_batch_src_global generation:  0.06270384788513184
r_  generation:  0.5813076496124268
local_output_nid generation:  0.036423683166503906
local_in_edges_tensor generation:  0.04064297676086426
mini_batch_src_global generation:  0.06890535354614258
r_  generation:  0.5699772834777832
----------------------check_connections_block total spend ----------------------------- 6.604191064834595
generate_one_block  0.7131838798522949
generate_one_block  0.7067515850067139
generate_one_block  0.7103433609008789
generate_one_block  0.7116601467132568
generate_one_block  0.71647047996521
generate_one_block  0.7051777839660645
generate_one_block  0.7090713977813721
generate_one_block  0.7116456031799316
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1406998634338379  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

connection checking time:  10.934317827224731
block generation total time  9.607224464416504
average batch blocks generation time:  1.200903058052063
block dataloader generation time/epoch 22.551074743270874
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10690975189208984  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9559154510498047  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10626935958862305  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9528570175170898  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10688591003417969  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.953425407409668  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10645484924316406  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9531488418579102  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10730504989624023  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9583044052124023  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10587644577026367  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9525547027587891  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10709190368652344  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9514689445495605  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10681390762329102  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9548435211181641  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08234667778015137 |0.015494942665100098 |0.0034470558166503906 |9.006261825561523e-05 |0.003293156623840332 |0.0019338130950927734 |
----------------------------------------------------------pseudo_mini_loss sum 1.5502300262451172
Total (block generation + training)time/epoch 23.476999402046204
Training time/epoch 0.9141926765441895
Training time without block to device /epoch 0.7902331352233887
Training time without total dataloading part /epoch 0.05657601356506348
load block tensor time/epoch 0.6587734222412109
block to device time/epoch 0.12395954132080078
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  3056965
Number of first layer input nodes during this epoch:  1301252
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14161443710327148  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024206876754760742
range selection method range initialization spend 0.011901140213012695
time for parepare:  0.01662421226501465
local_output_nid generation:  0.0027403831481933594
local_in_edges_tensor generation:  0.004937410354614258
mini_batch_src_global generation:  0.0037844181060791016
r_  generation:  0.044123172760009766
local_output_nid generation:  0.003154277801513672
local_in_edges_tensor generation:  0.0019898414611816406
mini_batch_src_global generation:  0.004954338073730469
r_  generation:  0.04521346092224121
local_output_nid generation:  0.0031824111938476562
local_in_edges_tensor generation:  0.0018126964569091797
mini_batch_src_global generation:  0.0033910274505615234
r_  generation:  0.04608273506164551
local_output_nid generation:  0.0032837390899658203
local_in_edges_tensor generation:  0.0018262863159179688
mini_batch_src_global generation:  0.003395557403564453
r_  generation:  0.047171831130981445
local_output_nid generation:  0.003292083740234375
local_in_edges_tensor generation:  0.0018155574798583984
mini_batch_src_global generation:  0.003561258316040039
r_  generation:  0.048117637634277344
local_output_nid generation:  0.0032129287719726562
local_in_edges_tensor generation:  0.0018510818481445312
mini_batch_src_global generation:  0.0037572383880615234
r_  generation:  0.047991037368774414
local_output_nid generation:  0.003211498260498047
local_in_edges_tensor generation:  0.0018482208251953125
mini_batch_src_global generation:  0.0037832260131835938
r_  generation:  0.04866170883178711
local_output_nid generation:  0.003191232681274414
local_in_edges_tensor generation:  0.0017881393432617188
mini_batch_src_global generation:  0.0037610530853271484
r_  generation:  0.048631906509399414
----------------------check_connections_block total spend ----------------------------- 0.5460388660430908
generate_one_block  0.0674138069152832
generate_one_block  0.061913251876831055
generate_one_block  0.060516357421875
generate_one_block  0.06126070022583008
generate_one_block  0.061037302017211914
generate_one_block  0.06089067459106445
generate_one_block  0.06449151039123535
generate_one_block  0.06200075149536133
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04061436653137207
gen group dst list time:  0.015654563903808594
time for parepare:  0.019070148468017578
local_output_nid generation:  0.011692047119140625
local_in_edges_tensor generation:  0.029669523239135742
mini_batch_src_global generation:  0.03763318061828613
r_  generation:  0.37024831771850586
local_output_nid generation:  0.0179135799407959
local_in_edges_tensor generation:  0.023647546768188477
mini_batch_src_global generation:  0.04550576210021973
r_  generation:  0.38114333152770996
local_output_nid generation:  0.018604755401611328
local_in_edges_tensor generation:  0.02600550651550293
mini_batch_src_global generation:  0.043984413146972656
r_  generation:  0.3728199005126953
local_output_nid generation:  0.018566608428955078
local_in_edges_tensor generation:  0.019767045974731445
mini_batch_src_global generation:  0.044899702072143555
r_  generation:  0.38104963302612305
local_output_nid generation:  0.01933884620666504
local_in_edges_tensor generation:  0.019809484481811523
mini_batch_src_global generation:  0.04591631889343262
r_  generation:  0.3781001567840576
local_output_nid generation:  0.01857304573059082
local_in_edges_tensor generation:  0.020258188247680664
mini_batch_src_global generation:  0.04575777053833008
r_  generation:  0.3813893795013428
local_output_nid generation:  0.018281936645507812
local_in_edges_tensor generation:  0.021248579025268555
mini_batch_src_global generation:  0.04589581489562988
r_  generation:  0.37982177734375
local_output_nid generation:  0.018334388732910156
local_in_edges_tensor generation:  0.0212705135345459
mini_batch_src_global generation:  0.04609513282775879
r_  generation:  0.3838310241699219
----------------------check_connections_block total spend ----------------------------- 4.3569114208221436
generate_one_block  0.4955465793609619
generate_one_block  0.49937939643859863
generate_one_block  0.4824180603027344
generate_one_block  0.4896516799926758
generate_one_block  0.4850890636444092
generate_one_block  0.4849088191986084
generate_one_block  0.48212218284606934
generate_one_block  0.5120429992675781
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03389692306518555
gen group dst list time:  0.038048744201660156
time for parepare:  0.01878190040588379
local_output_nid generation:  0.02662181854248047
local_in_edges_tensor generation:  0.03786325454711914
mini_batch_src_global generation:  0.05049443244934082
r_  generation:  0.5426912307739258
local_output_nid generation:  0.033762216567993164
local_in_edges_tensor generation:  0.042610883712768555
mini_batch_src_global generation:  0.06364226341247559
r_  generation:  0.5478825569152832
local_output_nid generation:  0.0344843864440918
local_in_edges_tensor generation:  0.03380846977233887
mini_batch_src_global generation:  0.06064128875732422
r_  generation:  0.5535976886749268
local_output_nid generation:  0.0349268913269043
local_in_edges_tensor generation:  0.03338742256164551
mini_batch_src_global generation:  0.06063365936279297
r_  generation:  0.5596928596496582
local_output_nid generation:  0.03667926788330078
local_in_edges_tensor generation:  0.03362679481506348
mini_batch_src_global generation:  0.062319278717041016
r_  generation:  0.5716090202331543
local_output_nid generation:  0.035233497619628906
local_in_edges_tensor generation:  0.03347492218017578
mini_batch_src_global generation:  0.06477093696594238
r_  generation:  0.5683259963989258
local_output_nid generation:  0.035005807876586914
local_in_edges_tensor generation:  0.03662371635437012
mini_batch_src_global generation:  0.06353306770324707
r_  generation:  0.573014497756958
local_output_nid generation:  0.03520393371582031
local_in_edges_tensor generation:  0.032958984375
mini_batch_src_global generation:  0.06415653228759766
r_  generation:  0.5739169120788574
----------------------check_connections_block total spend ----------------------------- 6.539313554763794
generate_one_block  0.7014591693878174
generate_one_block  0.7116930484771729
generate_one_block  0.70162034034729
generate_one_block  0.7043616771697998
generate_one_block  0.7059657573699951
generate_one_block  0.7033870220184326
generate_one_block  0.7026512622833252
generate_one_block  0.7065219879150391
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14161443710327148  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

connection checking time:  10.896224975585938
block generation total time  9.568819046020508
average batch blocks generation time:  1.1961023807525635
block dataloader generation time/epoch 22.524854103724163
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1073007583618164  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9571108818054199  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1064915657043457  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9625382423400879  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10633325576782227  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9527626037597656  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10631895065307617  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9538168907165527  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10704374313354492  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9520473480224609  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10628509521484375  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9585475921630859  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10708856582641602  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9540467262268066  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10656452178955078  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9524259567260742  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07513010501861572 |0.01539379358291626 |0.0033608973026275635 |8.746981620788574e-05 |0.009203106164932251 |0.0016186237335205078 |
----------------------------------------------------------pseudo_mini_loss sum 1.5204951763153076
Total (block generation + training)time/epoch 23.44364086786906
Training time/epoch 0.9043567180633545
Training time without block to device /epoch 0.7812063694000244
Training time without total dataloading part /epoch 0.10283041000366211
load block tensor time/epoch 0.6010408401489258
block to device time/epoch 0.12315034866333008
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  3058492
Number of first layer input nodes during this epoch:  1301038
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14122629165649414  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025012969970703125
range selection method range initialization spend 0.011981964111328125
time for parepare:  0.016053199768066406
local_output_nid generation:  0.002796173095703125
local_in_edges_tensor generation:  0.004852294921875
mini_batch_src_global generation:  0.0034885406494140625
r_  generation:  0.04268169403076172
local_output_nid generation:  0.003176450729370117
local_in_edges_tensor generation:  0.001752614974975586
mini_batch_src_global generation:  0.0047664642333984375
r_  generation:  0.04348301887512207
local_output_nid generation:  0.0031621456146240234
local_in_edges_tensor generation:  0.0018014907836914062
mini_batch_src_global generation:  0.0032958984375
r_  generation:  0.04422712326049805
local_output_nid generation:  0.003159046173095703
local_in_edges_tensor generation:  0.0017786026000976562
mini_batch_src_global generation:  0.00336456298828125
r_  generation:  0.046181440353393555
local_output_nid generation:  0.003197908401489258
local_in_edges_tensor generation:  0.0018329620361328125
mini_batch_src_global generation:  0.0035729408264160156
r_  generation:  0.0469815731048584
local_output_nid generation:  0.003204822540283203
local_in_edges_tensor generation:  0.0018355846405029297
mini_batch_src_global generation:  0.0036878585815429688
r_  generation:  0.04664897918701172
local_output_nid generation:  0.003195524215698242
local_in_edges_tensor generation:  0.001844644546508789
mini_batch_src_global generation:  0.0038156509399414062
r_  generation:  0.04724287986755371
local_output_nid generation:  0.0032510757446289062
local_in_edges_tensor generation:  0.0017960071563720703
mini_batch_src_global generation:  0.0036935806274414062
r_  generation:  0.04723668098449707
----------------------check_connections_block total spend ----------------------------- 0.532097578048706
generate_one_block  0.062143564224243164
generate_one_block  0.06022977828979492
generate_one_block  0.06313014030456543
generate_one_block  0.06168079376220703
generate_one_block  0.06158137321472168
generate_one_block  0.061348676681518555
generate_one_block  0.06453990936279297
generate_one_block  0.060860633850097656
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03531670570373535
gen group dst list time:  0.015429019927978516
time for parepare:  0.023363113403320312
local_output_nid generation:  0.011575937271118164
local_in_edges_tensor generation:  0.02439570426940918
mini_batch_src_global generation:  0.036554813385009766
r_  generation:  0.3609452247619629
local_output_nid generation:  0.02173900604248047
local_in_edges_tensor generation:  0.030440807342529297
mini_batch_src_global generation:  0.05129861831665039
r_  generation:  0.3716573715209961
local_output_nid generation:  0.019849538803100586
local_in_edges_tensor generation:  0.020660877227783203
mini_batch_src_global generation:  0.04339408874511719
r_  generation:  0.36988282203674316
local_output_nid generation:  0.019374370574951172
local_in_edges_tensor generation:  0.023015260696411133
mini_batch_src_global generation:  0.04435253143310547
r_  generation:  0.37451934814453125
local_output_nid generation:  0.01963949203491211
local_in_edges_tensor generation:  0.024759769439697266
mini_batch_src_global generation:  0.04782509803771973
r_  generation:  0.3855631351470947
local_output_nid generation:  0.018654823303222656
local_in_edges_tensor generation:  0.01993584632873535
mini_batch_src_global generation:  0.045777320861816406
r_  generation:  0.3784492015838623
local_output_nid generation:  0.018806934356689453
local_in_edges_tensor generation:  0.01970195770263672
mini_batch_src_global generation:  0.045928955078125
r_  generation:  0.38421201705932617
local_output_nid generation:  0.018697500228881836
local_in_edges_tensor generation:  0.021144628524780273
mini_batch_src_global generation:  0.04700779914855957
r_  generation:  0.3787057399749756
----------------------check_connections_block total spend ----------------------------- 4.355128526687622
generate_one_block  0.49235963821411133
generate_one_block  0.4881598949432373
generate_one_block  0.48095059394836426
generate_one_block  0.48735690116882324
generate_one_block  0.4945054054260254
generate_one_block  0.49799513816833496
generate_one_block  0.49573516845703125
generate_one_block  0.5190134048461914
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04367709159851074
gen group dst list time:  0.039133548736572266
time for parepare:  0.02124190330505371
local_output_nid generation:  0.02779412269592285
local_in_edges_tensor generation:  0.055396318435668945
mini_batch_src_global generation:  0.05230259895324707
r_  generation:  0.5455048084259033
local_output_nid generation:  0.034852027893066406
local_in_edges_tensor generation:  0.046537160873413086
mini_batch_src_global generation:  0.07026863098144531
r_  generation:  0.5435042381286621
local_output_nid generation:  0.0355527400970459
local_in_edges_tensor generation:  0.03660464286804199
mini_batch_src_global generation:  0.06076192855834961
r_  generation:  0.5512630939483643
local_output_nid generation:  0.03532576560974121
local_in_edges_tensor generation:  0.03484988212585449
mini_batch_src_global generation:  0.06303548812866211
r_  generation:  0.5532522201538086
local_output_nid generation:  0.03533005714416504
local_in_edges_tensor generation:  0.03710651397705078
mini_batch_src_global generation:  0.061153411865234375
r_  generation:  0.5572035312652588
local_output_nid generation:  0.035386085510253906
local_in_edges_tensor generation:  0.03530478477478027
mini_batch_src_global generation:  0.06295275688171387
r_  generation:  0.5598390102386475
local_output_nid generation:  0.03538966178894043
local_in_edges_tensor generation:  0.037270545959472656
mini_batch_src_global generation:  0.06348776817321777
r_  generation:  0.5635287761688232
local_output_nid generation:  0.035405635833740234
local_in_edges_tensor generation:  0.03367972373962402
mini_batch_src_global generation:  0.06603550910949707
r_  generation:  0.5617828369140625
----------------------check_connections_block total spend ----------------------------- 6.535226583480835
generate_one_block  0.716442346572876
generate_one_block  0.7054383754730225
generate_one_block  0.6979444026947021
generate_one_block  0.7012712955474854
generate_one_block  0.7086319923400879
generate_one_block  0.704216480255127
generate_one_block  0.7118802070617676
generate_one_block  0.7098937034606934
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14122629165649414  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

connection checking time:  10.890355110168457
block generation total time  9.61179494857788
average batch blocks generation time:  1.201474368572235
block dataloader generation time/epoch 22.52876764535904
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10675811767578125  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9514760971069336  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10630226135253906  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9557547569274902  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10697603225708008  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9510822296142578  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10677385330200195  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9550890922546387  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10713672637939453  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9561238288879395  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10579299926757812  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9526004791259766  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10700702667236328  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9564995765686035  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10589742660522461  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9546351432800293  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08340179920196533 |0.020290881395339966 |0.0034871697425842285 |9.104609489440918e-05 |0.003424704074859619 |0.0013201236724853516 |
----------------------------------------------------------pseudo_mini_loss sum 1.4800539016723633
Total (block generation + training)time/epoch 23.45960909128189
Training time/epoch 0.9667372703552246
Training time without block to device /epoch 0.8044102191925049
Training time without total dataloading part /epoch 0.057343482971191406
load block tensor time/epoch 0.6672143936157227
block to device time/epoch 0.16232705116271973
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  3057838
Number of first layer input nodes during this epoch:  1301054
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14089298248291016  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04864668846130371
range selection method range initialization spend 0.011900663375854492
time for parepare:  0.016939401626586914
local_output_nid generation:  0.0028116703033447266
local_in_edges_tensor generation:  0.00794219970703125
mini_batch_src_global generation:  0.0035674571990966797
r_  generation:  0.04400444030761719
local_output_nid generation:  0.003257274627685547
local_in_edges_tensor generation:  0.0018317699432373047
mini_batch_src_global generation:  0.0047185420989990234
r_  generation:  0.043616294860839844
local_output_nid generation:  0.003224611282348633
local_in_edges_tensor generation:  0.0018131732940673828
mini_batch_src_global generation:  0.0032548904418945312
r_  generation:  0.045336246490478516
local_output_nid generation:  0.0032591819763183594
local_in_edges_tensor generation:  0.0018322467803955078
mini_batch_src_global generation:  0.0032968521118164062
r_  generation:  0.04581952095031738
local_output_nid generation:  0.0031914710998535156
local_in_edges_tensor generation:  0.001810312271118164
mini_batch_src_global generation:  0.003605365753173828
r_  generation:  0.04770255088806152
local_output_nid generation:  0.003225564956665039
local_in_edges_tensor generation:  0.0018219947814941406
mini_batch_src_global generation:  0.0037899017333984375
r_  generation:  0.0468907356262207
local_output_nid generation:  0.003181934356689453
local_in_edges_tensor generation:  0.001814126968383789
mini_batch_src_global generation:  0.003736257553100586
r_  generation:  0.04677438735961914
local_output_nid generation:  0.0032095909118652344
local_in_edges_tensor generation:  0.001863241195678711
mini_batch_src_global generation:  0.003753662109375
r_  generation:  0.047759056091308594
----------------------check_connections_block total spend ----------------------------- 0.5394737720489502
generate_one_block  0.06311893463134766
generate_one_block  0.06046485900878906
generate_one_block  0.061147212982177734
generate_one_block  0.06051754951477051
generate_one_block  0.06135392189025879
generate_one_block  0.06299591064453125
generate_one_block  0.06340765953063965
generate_one_block  0.0619359016418457
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03831934928894043
gen group dst list time:  0.016046762466430664
time for parepare:  0.01902174949645996
local_output_nid generation:  0.011357784271240234
local_in_edges_tensor generation:  0.02613520622253418
mini_batch_src_global generation:  0.03724098205566406
r_  generation:  0.3552842140197754
local_output_nid generation:  0.017734527587890625
local_in_edges_tensor generation:  0.02489757537841797
mini_batch_src_global generation:  0.04582524299621582
r_  generation:  0.3690493106842041
local_output_nid generation:  0.018664836883544922
local_in_edges_tensor generation:  0.020833730697631836
mini_batch_src_global generation:  0.045766592025756836
r_  generation:  0.3769493103027344
local_output_nid generation:  0.01892876625061035
local_in_edges_tensor generation:  0.019473552703857422
mini_batch_src_global generation:  0.044512271881103516
r_  generation:  0.3796875476837158
local_output_nid generation:  0.01924586296081543
local_in_edges_tensor generation:  0.019643306732177734
mini_batch_src_global generation:  0.04776620864868164
r_  generation:  0.38152456283569336
local_output_nid generation:  0.01806020736694336
local_in_edges_tensor generation:  0.021065950393676758
mini_batch_src_global generation:  0.04756903648376465
r_  generation:  0.37798261642456055
local_output_nid generation:  0.018456220626831055
local_in_edges_tensor generation:  0.021211862564086914
mini_batch_src_global generation:  0.04873228073120117
r_  generation:  0.3809671401977539
local_output_nid generation:  0.018359661102294922
local_in_edges_tensor generation:  0.02074909210205078
mini_batch_src_global generation:  0.04787731170654297
r_  generation:  0.3813912868499756
----------------------check_connections_block total spend ----------------------------- 4.331433057785034
generate_one_block  0.4851694107055664
generate_one_block  0.49147796630859375
generate_one_block  0.49307775497436523
generate_one_block  0.4899942874908447
generate_one_block  0.48325514793395996
generate_one_block  0.486314058303833
generate_one_block  0.48667407035827637
generate_one_block  0.5239965915679932
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.038613319396972656
gen group dst list time:  0.03943276405334473
time for parepare:  0.019312620162963867
local_output_nid generation:  0.026604890823364258
local_in_edges_tensor generation:  0.04377150535583496
mini_batch_src_global generation:  0.050864458084106445
r_  generation:  0.5453951358795166
local_output_nid generation:  0.03353691101074219
local_in_edges_tensor generation:  0.04367685317993164
mini_batch_src_global generation:  0.06547164916992188
r_  generation:  0.5428304672241211
local_output_nid generation:  0.03398942947387695
local_in_edges_tensor generation:  0.04098320007324219
mini_batch_src_global generation:  0.060605764389038086
r_  generation:  0.5632736682891846
local_output_nid generation:  0.03498959541320801
local_in_edges_tensor generation:  0.040021657943725586
mini_batch_src_global generation:  0.05947518348693848
r_  generation:  0.5575613975524902
local_output_nid generation:  0.036759138107299805
local_in_edges_tensor generation:  0.03721165657043457
mini_batch_src_global generation:  0.06081700325012207
r_  generation:  0.5662920475006104
local_output_nid generation:  0.03578472137451172
local_in_edges_tensor generation:  0.0348966121673584
mini_batch_src_global generation:  0.060709476470947266
r_  generation:  0.5604937076568604
local_output_nid generation:  0.035810232162475586
local_in_edges_tensor generation:  0.03423309326171875
mini_batch_src_global generation:  0.06449198722839355
r_  generation:  0.5670318603515625
local_output_nid generation:  0.035427093505859375
local_in_edges_tensor generation:  0.036451101303100586
mini_batch_src_global generation:  0.06228923797607422
r_  generation:  0.5632450580596924
----------------------check_connections_block total spend ----------------------------- 6.5714099407196045
generate_one_block  0.7019059658050537
generate_one_block  0.6954774856567383
generate_one_block  0.7079260349273682
generate_one_block  0.7023344039916992
generate_one_block  0.6969888210296631
generate_one_block  0.7097427845001221
generate_one_block  0.7007772922515869
generate_one_block  0.7001562118530273
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14089298248291016  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

connection checking time:  10.902842998504639
block generation total time  9.555268287658691
average batch blocks generation time:  1.1944085359573364
block dataloader generation time/epoch 22.52166805267334
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10685157775878906  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9532089233398438  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10663414001464844  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9550361633300781  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10717296600341797  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9573421478271484  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10591411590576172  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9588065147399902  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10687828063964844  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.954561710357666  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10640192031860352  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.95404052734375  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10715579986572266  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9556479454040527  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10662460327148438  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9546256065368652  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08096832036972046 |0.016074389219284058 |0.003471463918685913 |8.96155834197998e-05 |0.003647923469543457 |0.0029456615447998047 |
----------------------------------------------------------pseudo_mini_loss sum 1.4485399723052979
Total (block generation + training)time/epoch 23.448156547546386
Training time/epoch 0.9088742733001709
Training time without block to device /epoch 0.7802791595458984
Training time without total dataloading part /epoch 0.060617685317993164
load block tensor time/epoch 0.6477465629577637
block to device time/epoch 0.12859511375427246
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  3059446
Number of first layer input nodes during this epoch:  1300904
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1414804458618164  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02655029296875
range selection method range initialization spend 0.012191295623779297
time for parepare:  0.015815019607543945
local_output_nid generation:  0.0027489662170410156
local_in_edges_tensor generation:  0.007111310958862305
mini_batch_src_global generation:  0.003537416458129883
r_  generation:  0.04120063781738281
local_output_nid generation:  0.003195047378540039
local_in_edges_tensor generation:  0.0017256736755371094
mini_batch_src_global generation:  0.004810333251953125
r_  generation:  0.04407072067260742
local_output_nid generation:  0.003203153610229492
local_in_edges_tensor generation:  0.0018126964569091797
mini_batch_src_global generation:  0.003286600112915039
r_  generation:  0.04408097267150879
local_output_nid generation:  0.0031766891479492188
local_in_edges_tensor generation:  0.0017952919006347656
mini_batch_src_global generation:  0.0033092498779296875
r_  generation:  0.04633522033691406
local_output_nid generation:  0.0032663345336914062
local_in_edges_tensor generation:  0.0019953250885009766
mini_batch_src_global generation:  0.0038182735443115234
r_  generation:  0.047310829162597656
local_output_nid generation:  0.0032396316528320312
local_in_edges_tensor generation:  0.0018460750579833984
mini_batch_src_global generation:  0.003725290298461914
r_  generation:  0.047574758529663086
local_output_nid generation:  0.0033071041107177734
local_in_edges_tensor generation:  0.0018572807312011719
mini_batch_src_global generation:  0.0037927627563476562
r_  generation:  0.04726529121398926
local_output_nid generation:  0.003184795379638672
local_in_edges_tensor generation:  0.001850128173828125
mini_batch_src_global generation:  0.0037758350372314453
r_  generation:  0.04789471626281738
----------------------check_connections_block total spend ----------------------------- 0.5387046337127686
generate_one_block  0.05884218215942383
generate_one_block  0.059957027435302734
generate_one_block  0.05984210968017578
generate_one_block  0.06122589111328125
generate_one_block  0.06238818168640137
generate_one_block  0.06263041496276855
generate_one_block  0.06461977958679199
generate_one_block  0.06222271919250488
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03872990608215332
gen group dst list time:  0.01586604118347168
time for parepare:  0.01904153823852539
local_output_nid generation:  0.011606454849243164
local_in_edges_tensor generation:  0.031086444854736328
mini_batch_src_global generation:  0.03765535354614258
r_  generation:  0.35503244400024414
local_output_nid generation:  0.017880678176879883
local_in_edges_tensor generation:  0.024883031845092773
mini_batch_src_global generation:  0.048830509185791016
r_  generation:  0.3670954704284668
local_output_nid generation:  0.018389463424682617
local_in_edges_tensor generation:  0.02231144905090332
mini_batch_src_global generation:  0.04426288604736328
r_  generation:  0.3707571029663086
local_output_nid generation:  0.018590927124023438
local_in_edges_tensor generation:  0.020845651626586914
mini_batch_src_global generation:  0.04635286331176758
r_  generation:  0.3771803379058838
local_output_nid generation:  0.019252300262451172
local_in_edges_tensor generation:  0.02064681053161621
mini_batch_src_global generation:  0.04917430877685547
r_  generation:  0.3824920654296875
local_output_nid generation:  0.018951892852783203
local_in_edges_tensor generation:  0.020701169967651367
mini_batch_src_global generation:  0.046074628829956055
r_  generation:  0.37841153144836426
local_output_nid generation:  0.018340349197387695
local_in_edges_tensor generation:  0.021211862564086914
mini_batch_src_global generation:  0.04692435264587402
r_  generation:  0.38358211517333984
local_output_nid generation:  0.01857781410217285
local_in_edges_tensor generation:  0.019909143447875977
mini_batch_src_global generation:  0.04803323745727539
r_  generation:  0.3804788589477539
----------------------check_connections_block total spend ----------------------------- 4.334772348403931
generate_one_block  0.48319053649902344
generate_one_block  0.4849250316619873
generate_one_block  0.4813864231109619
generate_one_block  0.491987943649292
generate_one_block  0.4892385005950928
generate_one_block  0.49037718772888184
generate_one_block  0.4895758628845215
generate_one_block  0.509274959564209
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03837442398071289
gen group dst list time:  0.03864264488220215
time for parepare:  0.01906561851501465
local_output_nid generation:  0.026120424270629883
local_in_edges_tensor generation:  0.0423436164855957
mini_batch_src_global generation:  0.055348873138427734
r_  generation:  0.5436670780181885
local_output_nid generation:  0.03283286094665527
local_in_edges_tensor generation:  0.0441133975982666
mini_batch_src_global generation:  0.0630950927734375
r_  generation:  0.5423734188079834
local_output_nid generation:  0.03365182876586914
local_in_edges_tensor generation:  0.03613018989562988
mini_batch_src_global generation:  0.0611417293548584
r_  generation:  0.5560762882232666
local_output_nid generation:  0.03395223617553711
local_in_edges_tensor generation:  0.03481912612915039
mini_batch_src_global generation:  0.05978536605834961
r_  generation:  0.5517780780792236
local_output_nid generation:  0.034002065658569336
local_in_edges_tensor generation:  0.035886287689208984
mini_batch_src_global generation:  0.06108975410461426
r_  generation:  0.5624747276306152
local_output_nid generation:  0.0347135066986084
local_in_edges_tensor generation:  0.037386417388916016
mini_batch_src_global generation:  0.06417393684387207
r_  generation:  0.5586166381835938
local_output_nid generation:  0.03498721122741699
local_in_edges_tensor generation:  0.03897285461425781
mini_batch_src_global generation:  0.08162879943847656
r_  generation:  0.5752294063568115
local_output_nid generation:  0.037153005599975586
local_in_edges_tensor generation:  0.03369593620300293
mini_batch_src_global generation:  0.06320714950561523
r_  generation:  0.565432071685791
----------------------check_connections_block total spend ----------------------------- 6.542403221130371
generate_one_block  0.6971731185913086
generate_one_block  0.7023735046386719
generate_one_block  0.7099521160125732
generate_one_block  0.692223310470581
generate_one_block  0.6975815296173096
generate_one_block  0.7010517120361328
generate_one_block  0.7024819850921631
generate_one_block  0.696619987487793
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1414804458618164  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

connection checking time:  10.877175569534302
block generation total time  9.519413709640503
average batch blocks generation time:  1.1899267137050629
block dataloader generation time/epoch 22.500956813494366
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1068124771118164  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.951897144317627  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10632610321044922  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9546704292297363  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10701227188110352  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9545016288757324  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10660696029663086  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9510765075683594  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10721302032470703  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9551305770874023  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10630035400390625  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9552936553955078  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10708999633789062  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9572477340698242  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10579586029052734  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9539494514465332  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08259814977645874 |0.015635937452316284 |0.0034116804599761963 |9.083747863769531e-05 |0.0032341182231903076 |0.0013172626495361328 |
----------------------------------------------------------pseudo_mini_loss sum 1.4298655986785889
Total (block generation + training)time/epoch 23.425962805747986
Training time/epoch 0.9173624515533447
Training time without block to device /epoch 0.7922749519348145
Training time without total dataloading part /epoch 0.05521035194396973
load block tensor time/epoch 0.6607851982116699
block to device time/epoch 0.12508749961853027
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  3057571
Number of first layer input nodes during this epoch:  1300902
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14075660705566406  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020137310028076172
range selection method range initialization spend 0.011760234832763672
time for parepare:  0.01595616340637207
local_output_nid generation:  0.0027282238006591797
local_in_edges_tensor generation:  0.007898330688476562
mini_batch_src_global generation:  0.0035240650177001953
r_  generation:  0.04190826416015625
local_output_nid generation:  0.0031599998474121094
local_in_edges_tensor generation:  0.0017628669738769531
mini_batch_src_global generation:  0.007028341293334961
r_  generation:  0.04392886161804199
local_output_nid generation:  0.0032265186309814453
local_in_edges_tensor generation:  0.0017681121826171875
mini_batch_src_global generation:  0.003264904022216797
r_  generation:  0.045203208923339844
local_output_nid generation:  0.003195524215698242
local_in_edges_tensor generation:  0.001967191696166992
mini_batch_src_global generation:  0.003390789031982422
r_  generation:  0.04686570167541504
local_output_nid generation:  0.003217458724975586
local_in_edges_tensor generation:  0.001856088638305664
mini_batch_src_global generation:  0.0036356449127197266
r_  generation:  0.046492815017700195
local_output_nid generation:  0.0032377243041992188
local_in_edges_tensor generation:  0.0018153190612792969
mini_batch_src_global generation:  0.0037026405334472656
r_  generation:  0.04616832733154297
local_output_nid generation:  0.003191232681274414
local_in_edges_tensor generation:  0.0018177032470703125
mini_batch_src_global generation:  0.0038149356842041016
r_  generation:  0.048094987869262695
local_output_nid generation:  0.003223419189453125
local_in_edges_tensor generation:  0.0018258094787597656
mini_batch_src_global generation:  0.003758668899536133
r_  generation:  0.04814004898071289
----------------------check_connections_block total spend ----------------------------- 0.5399928092956543
generate_one_block  0.058014869689941406
generate_one_block  0.059575557708740234
generate_one_block  0.060948848724365234
generate_one_block  0.06145453453063965
generate_one_block  0.06126117706298828
generate_one_block  0.06011509895324707
generate_one_block  0.06428146362304688
generate_one_block  0.06226396560668945
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03771638870239258
gen group dst list time:  0.015724897384643555
time for parepare:  0.01906418800354004
local_output_nid generation:  0.011129617691040039
local_in_edges_tensor generation:  0.025182485580444336
mini_batch_src_global generation:  0.03701424598693848
r_  generation:  0.35360097885131836
local_output_nid generation:  0.0175018310546875
local_in_edges_tensor generation:  0.02265620231628418
mini_batch_src_global generation:  0.04654407501220703
r_  generation:  0.3752932548522949
local_output_nid generation:  0.018728256225585938
local_in_edges_tensor generation:  0.024222850799560547
mini_batch_src_global generation:  0.04775738716125488
r_  generation:  0.38145017623901367
local_output_nid generation:  0.018441438674926758
local_in_edges_tensor generation:  0.023123741149902344
mini_batch_src_global generation:  0.045278310775756836
r_  generation:  0.37859416007995605
local_output_nid generation:  0.019298315048217773
local_in_edges_tensor generation:  0.022304773330688477
mini_batch_src_global generation:  0.04626297950744629
r_  generation:  0.3777596950531006
local_output_nid generation:  0.018007755279541016
local_in_edges_tensor generation:  0.019251346588134766
mini_batch_src_global generation:  0.04556131362915039
r_  generation:  0.37400078773498535
local_output_nid generation:  0.018102645874023438
local_in_edges_tensor generation:  0.02317953109741211
mini_batch_src_global generation:  0.0497281551361084
r_  generation:  0.3851912021636963
local_output_nid generation:  0.019428014755249023
local_in_edges_tensor generation:  0.025466203689575195
mini_batch_src_global generation:  0.04704403877258301
r_  generation:  0.3811924457550049
----------------------check_connections_block total spend ----------------------------- 4.347057342529297
generate_one_block  0.47525572776794434
generate_one_block  0.48401498794555664
generate_one_block  0.4970707893371582
generate_one_block  0.4889824390411377
generate_one_block  0.48195624351501465
generate_one_block  0.47696805000305176
generate_one_block  0.49442338943481445
generate_one_block  0.5190718173980713
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03499722480773926
gen group dst list time:  0.03851509094238281
time for parepare:  0.018033504486083984
local_output_nid generation:  0.025784730911254883
local_in_edges_tensor generation:  0.040293216705322266
mini_batch_src_global generation:  0.050867557525634766
r_  generation:  0.5323882102966309
local_output_nid generation:  0.03252601623535156
local_in_edges_tensor generation:  0.04274439811706543
mini_batch_src_global generation:  0.0641331672668457
r_  generation:  0.5415897369384766
local_output_nid generation:  0.033097267150878906
local_in_edges_tensor generation:  0.03856086730957031
mini_batch_src_global generation:  0.061164140701293945
r_  generation:  0.5518314838409424
local_output_nid generation:  0.0352325439453125
local_in_edges_tensor generation:  0.03522324562072754
mini_batch_src_global generation:  0.05994701385498047
r_  generation:  0.5553147792816162
local_output_nid generation:  0.03422141075134277
local_in_edges_tensor generation:  0.03694725036621094
mini_batch_src_global generation:  0.06018400192260742
r_  generation:  0.5621821880340576
local_output_nid generation:  0.03369951248168945
local_in_edges_tensor generation:  0.04568982124328613
mini_batch_src_global generation:  0.0662541389465332
r_  generation:  0.5592987537384033
local_output_nid generation:  0.03403639793395996
local_in_edges_tensor generation:  0.0342252254486084
mini_batch_src_global generation:  0.06220054626464844
r_  generation:  0.566643476486206
local_output_nid generation:  0.033901214599609375
local_in_edges_tensor generation:  0.039029836654663086
mini_batch_src_global generation:  0.0626678466796875
r_  generation:  0.5667879581451416
----------------------check_connections_block total spend ----------------------------- 6.499971389770508
generate_one_block  0.6951444149017334
generate_one_block  0.6995282173156738
generate_one_block  0.7048466205596924
generate_one_block  0.6925215721130371
generate_one_block  0.6962671279907227
generate_one_block  0.70086669921875
generate_one_block  0.7048425674438477
generate_one_block  0.6962778568267822
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14075660705566406  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

connection checking time:  10.847028732299805
block generation total time  9.508038520812988
average batch blocks generation time:  1.1885048151016235
block dataloader generation time/epoch 22.477528401783534
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10670328140258789  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9495043754577637  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10684442520141602  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9545974731445312  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10721826553344727  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9567804336547852  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10593652725219727  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9547123908996582  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10692024230957031  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.955482006072998  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1062769889831543  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9498610496520996  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.107147216796875  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9581522941589355  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10587549209594727  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9548125267028809  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0851123034954071 |0.018670350313186646 |0.003441721200942993 |8.597970008850098e-05 |0.003814697265625 |0.001589059829711914 |
----------------------------------------------------------pseudo_mini_loss sum 1.3978344202041626
Total (block generation + training)time/epoch 23.408910002027238
Training time/epoch 0.9693958759307861
Training time without block to device /epoch 0.820033073425293
Training time without total dataloading part /epoch 0.06032824516296387
load block tensor time/epoch 0.6808984279632568
block to device time/epoch 0.14936280250549316
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  3057641
Number of first layer input nodes during this epoch:  1300982
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14101457595825195  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04270744323730469
range selection method range initialization spend 0.015560388565063477
time for parepare:  0.01733684539794922
local_output_nid generation:  0.002674579620361328
local_in_edges_tensor generation:  0.00529170036315918
mini_batch_src_global generation:  0.004938602447509766
r_  generation:  0.04517245292663574
local_output_nid generation:  0.0031371116638183594
local_in_edges_tensor generation:  0.0021195411682128906
mini_batch_src_global generation:  0.00575709342956543
r_  generation:  0.046645402908325195
local_output_nid generation:  0.0032434463500976562
local_in_edges_tensor generation:  0.0018367767333984375
mini_batch_src_global generation:  0.0037736892700195312
r_  generation:  0.04546356201171875
local_output_nid generation:  0.003216266632080078
local_in_edges_tensor generation:  0.0018208026885986328
mini_batch_src_global generation:  0.003378629684448242
r_  generation:  0.04652237892150879
local_output_nid generation:  0.0031752586364746094
local_in_edges_tensor generation:  0.0018334388732910156
mini_batch_src_global generation:  0.003587007522583008
r_  generation:  0.04683184623718262
local_output_nid generation:  0.0033025741577148438
local_in_edges_tensor generation:  0.0017902851104736328
mini_batch_src_global generation:  0.003749370574951172
r_  generation:  0.048056840896606445
local_output_nid generation:  0.003246784210205078
local_in_edges_tensor generation:  0.0018167495727539062
mini_batch_src_global generation:  0.0037603378295898438
r_  generation:  0.0476222038269043
local_output_nid generation:  0.003237485885620117
local_in_edges_tensor generation:  0.0018050670623779297
mini_batch_src_global generation:  0.0037946701049804688
r_  generation:  0.04845166206359863
----------------------check_connections_block total spend ----------------------------- 0.5518989562988281
generate_one_block  0.06063985824584961
generate_one_block  0.06123471260070801
generate_one_block  0.06133723258972168
generate_one_block  0.06099414825439453
generate_one_block  0.0613255500793457
generate_one_block  0.061411142349243164
generate_one_block  0.06380438804626465
generate_one_block  0.06220078468322754
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03572583198547363
gen group dst list time:  0.015362977981567383
time for parepare:  0.019343137741088867
local_output_nid generation:  0.01166844367980957
local_in_edges_tensor generation:  0.023656368255615234
mini_batch_src_global generation:  0.03827357292175293
r_  generation:  0.36562681198120117
local_output_nid generation:  0.017781972885131836
local_in_edges_tensor generation:  0.023821592330932617
mini_batch_src_global generation:  0.04506945610046387
r_  generation:  0.37537646293640137
local_output_nid generation:  0.018573999404907227
local_in_edges_tensor generation:  0.01933765411376953
mini_batch_src_global generation:  0.04518842697143555
r_  generation:  0.3809490203857422
local_output_nid generation:  0.018680095672607422
local_in_edges_tensor generation:  0.019189119338989258
mini_batch_src_global generation:  0.045101165771484375
r_  generation:  0.3771791458129883
local_output_nid generation:  0.019392013549804688
local_in_edges_tensor generation:  0.021288633346557617
mini_batch_src_global generation:  0.046874046325683594
r_  generation:  0.3925497531890869
local_output_nid generation:  0.018991470336914062
local_in_edges_tensor generation:  0.01976299285888672
mini_batch_src_global generation:  0.046462297439575195
r_  generation:  0.3842465877532959
local_output_nid generation:  0.018679141998291016
local_in_edges_tensor generation:  0.019596576690673828
mini_batch_src_global generation:  0.04703497886657715
r_  generation:  0.38026976585388184
local_output_nid generation:  0.018329620361328125
local_in_edges_tensor generation:  0.01977992057800293
mini_batch_src_global generation:  0.047435760498046875
r_  generation:  0.38670945167541504
----------------------check_connections_block total spend ----------------------------- 4.367317199707031
generate_one_block  0.4951345920562744
generate_one_block  0.49184608459472656
generate_one_block  0.49110937118530273
generate_one_block  0.48274707794189453
generate_one_block  0.4878826141357422
generate_one_block  0.4922144412994385
generate_one_block  0.4930698871612549
generate_one_block  0.5195884704589844
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03623771667480469
gen group dst list time:  0.03912997245788574
time for parepare:  0.019966840744018555
local_output_nid generation:  0.02669501304626465
local_in_edges_tensor generation:  0.04106712341308594
mini_batch_src_global generation:  0.05171704292297363
r_  generation:  0.5433187484741211
local_output_nid generation:  0.03380298614501953
local_in_edges_tensor generation:  0.04273843765258789
mini_batch_src_global generation:  0.06398367881774902
r_  generation:  0.5489006042480469
local_output_nid generation:  0.03437185287475586
local_in_edges_tensor generation:  0.03552842140197754
mini_batch_src_global generation:  0.06135082244873047
r_  generation:  0.5540816783905029
local_output_nid generation:  0.03445792198181152
local_in_edges_tensor generation:  0.03324460983276367
mini_batch_src_global generation:  0.0595242977142334
r_  generation:  0.5586316585540771
local_output_nid generation:  0.03476548194885254
local_in_edges_tensor generation:  0.0356295108795166
mini_batch_src_global generation:  0.06344890594482422
r_  generation:  0.5648953914642334
local_output_nid generation:  0.034863948822021484
local_in_edges_tensor generation:  0.0333404541015625
mini_batch_src_global generation:  0.06191897392272949
r_  generation:  0.5636250972747803
local_output_nid generation:  0.03505730628967285
local_in_edges_tensor generation:  0.034647226333618164
mini_batch_src_global generation:  0.0619962215423584
r_  generation:  0.5703320503234863
local_output_nid generation:  0.0350193977355957
local_in_edges_tensor generation:  0.03577160835266113
mini_batch_src_global generation:  0.06338286399841309
r_  generation:  0.568202018737793
----------------------check_connections_block total spend ----------------------------- 6.525527715682983
generate_one_block  0.7011892795562744
generate_one_block  0.7052474021911621
generate_one_block  0.7026689052581787
generate_one_block  0.7038223743438721
generate_one_block  0.7019774913787842
generate_one_block  0.6999225616455078
generate_one_block  0.7026627063751221
generate_one_block  0.7063086032867432
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14101457595825195  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

connection checking time:  10.892844915390015
block generation total time  9.577391862869263
average batch blocks generation time:  1.1971739828586578
block dataloader generation time/epoch 22.477699667215347
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10687780380249023  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9562888145446777  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10577630996704102  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.953498363494873  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10692644119262695  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9558539390563965  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10576248168945312  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9524374008178711  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10689401626586914  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9536323547363281  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10666656494140625  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9575128555297852  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10641956329345703  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9527549743652344  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10668802261352539  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9533848762512207  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08176305890083313 |0.013480722904205322 |0.0035009682178497314 |8.928775787353516e-05 |0.003153979778289795 |0.002866983413696289 |
----------------------------------------------------------pseudo_mini_loss sum 1.3711206912994385
Total (block generation + training)time/epoch 23.404332160949707
Training time/epoch 0.8931949138641357
Training time without block to device /epoch 0.7853491306304932
Training time without total dataloading part /epoch 0.05682086944580078
load block tensor time/epoch 0.654104471206665
block to device time/epoch 0.10784578323364258
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  3057720
Number of first layer input nodes during this epoch:  1301075
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14199209213256836  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022066593170166016
range selection method range initialization spend 0.011793851852416992
time for parepare:  0.016156435012817383
local_output_nid generation:  0.002770662307739258
local_in_edges_tensor generation:  0.004189252853393555
mini_batch_src_global generation:  0.003597736358642578
r_  generation:  0.04331851005554199
local_output_nid generation:  0.003225088119506836
local_in_edges_tensor generation:  0.001749277114868164
mini_batch_src_global generation:  0.004825115203857422
r_  generation:  0.044740915298461914
local_output_nid generation:  0.0032477378845214844
local_in_edges_tensor generation:  0.0018057823181152344
mini_batch_src_global generation:  0.0033943653106689453
r_  generation:  0.04676103591918945
local_output_nid generation:  0.003276824951171875
local_in_edges_tensor generation:  0.0018143653869628906
mini_batch_src_global generation:  0.0033919811248779297
r_  generation:  0.04541754722595215
local_output_nid generation:  0.0032224655151367188
local_in_edges_tensor generation:  0.0018086433410644531
mini_batch_src_global generation:  0.0035886764526367188
r_  generation:  0.04783201217651367
local_output_nid generation:  0.0032379627227783203
local_in_edges_tensor generation:  0.0018017292022705078
mini_batch_src_global generation:  0.0037534236907958984
r_  generation:  0.0488739013671875
local_output_nid generation:  0.003249645233154297
local_in_edges_tensor generation:  0.0018393993377685547
mini_batch_src_global generation:  0.0038475990295410156
r_  generation:  0.04791522026062012
local_output_nid generation:  0.003265380859375
local_in_edges_tensor generation:  0.0018177032470703125
mini_batch_src_global generation:  0.003768444061279297
r_  generation:  0.048395633697509766
----------------------check_connections_block total spend ----------------------------- 0.5418336391448975
generate_one_block  0.059038639068603516
generate_one_block  0.06057333946228027
generate_one_block  0.06186795234680176
generate_one_block  0.05988264083862305
generate_one_block  0.06122112274169922
generate_one_block  0.06203436851501465
generate_one_block  0.06400537490844727
generate_one_block  0.06175041198730469
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03004622459411621
gen group dst list time:  0.015614748001098633
time for parepare:  0.01917433738708496
local_output_nid generation:  0.011437177658081055
local_in_edges_tensor generation:  0.022531747817993164
mini_batch_src_global generation:  0.03611350059509277
r_  generation:  0.35804057121276855
local_output_nid generation:  0.01745295524597168
local_in_edges_tensor generation:  0.02183389663696289
mini_batch_src_global generation:  0.0449376106262207
r_  generation:  0.3719606399536133
local_output_nid generation:  0.018700599670410156
local_in_edges_tensor generation:  0.01848459243774414
mini_batch_src_global generation:  0.04495596885681152
r_  generation:  0.3788948059082031
local_output_nid generation:  0.018279314041137695
local_in_edges_tensor generation:  0.01947188377380371
mini_batch_src_global generation:  0.04467511177062988
r_  generation:  0.37410807609558105
local_output_nid generation:  0.019063472747802734
local_in_edges_tensor generation:  0.019781112670898438
mini_batch_src_global generation:  0.046758413314819336
r_  generation:  0.3810107707977295
local_output_nid generation:  0.01836252212524414
local_in_edges_tensor generation:  0.020894527435302734
mini_batch_src_global generation:  0.04709792137145996
r_  generation:  0.386033296585083
local_output_nid generation:  0.01841425895690918
local_in_edges_tensor generation:  0.01960468292236328
mini_batch_src_global generation:  0.04991030693054199
r_  generation:  0.3849806785583496
local_output_nid generation:  0.018521785736083984
local_in_edges_tensor generation:  0.026284217834472656
mini_batch_src_global generation:  0.04803776741027832
r_  generation:  0.38681983947753906
----------------------check_connections_block total spend ----------------------------- 4.3437535762786865
generate_one_block  0.4921748638153076
generate_one_block  0.48926353454589844
generate_one_block  0.4949934482574463
generate_one_block  0.4863409996032715
generate_one_block  0.4902210235595703
generate_one_block  0.49102139472961426
generate_one_block  0.48306846618652344
generate_one_block  0.5159502029418945
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03132271766662598
gen group dst list time:  0.03917860984802246
time for parepare:  0.01922440528869629
local_output_nid generation:  0.026627779006958008
local_in_edges_tensor generation:  0.044254302978515625
mini_batch_src_global generation:  0.0517878532409668
r_  generation:  0.5469326972961426
local_output_nid generation:  0.03347921371459961
local_in_edges_tensor generation:  0.03366804122924805
mini_batch_src_global generation:  0.06558513641357422
r_  generation:  0.5500373840332031
local_output_nid generation:  0.03443002700805664
local_in_edges_tensor generation:  0.03377795219421387
mini_batch_src_global generation:  0.06139183044433594
r_  generation:  0.5697386264801025
local_output_nid generation:  0.0345149040222168
local_in_edges_tensor generation:  0.03690290451049805
mini_batch_src_global generation:  0.06077313423156738
r_  generation:  0.5602333545684814
local_output_nid generation:  0.03464174270629883
local_in_edges_tensor generation:  0.03445601463317871
mini_batch_src_global generation:  0.061830997467041016
r_  generation:  0.5736565589904785
local_output_nid generation:  0.03513360023498535
local_in_edges_tensor generation:  0.03865957260131836
mini_batch_src_global generation:  0.0618891716003418
r_  generation:  0.5626952648162842
local_output_nid generation:  0.03483176231384277
local_in_edges_tensor generation:  0.03972220420837402
mini_batch_src_global generation:  0.06281352043151855
r_  generation:  0.5769100189208984
local_output_nid generation:  0.03476762771606445
local_in_edges_tensor generation:  0.03393387794494629
mini_batch_src_global generation:  0.06292152404785156
r_  generation:  0.5705211162567139
----------------------check_connections_block total spend ----------------------------- 6.567920207977295
generate_one_block  0.7064132690429688
generate_one_block  0.7032957077026367
generate_one_block  0.716526985168457
generate_one_block  0.7114791870117188
generate_one_block  0.7001008987426758
generate_one_block  0.702486515045166
generate_one_block  0.7036864757537842
generate_one_block  0.7057862281799316
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14199209213256836  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

connection checking time:  10.911673784255981
block generation total time  9.592809200286865
average batch blocks generation time:  1.1991011500358582
block dataloader generation time/epoch 22.477161089579266
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1073598861694336  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9539098739624023  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10666370391845703  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9547691345214844  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10738468170166016  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9575552940368652  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1057729721069336  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9516568183898926  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1069331169128418  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9551820755004883  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10665369033813477  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9551529884338379  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10683059692382812  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9511537551879883  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10643959045410156  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.95306396484375  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08114895224571228 |0.018058866262435913 |0.0033970773220062256 |8.592009544372559e-05 |0.0032828152179718018 |0.002899646759033203 |
----------------------------------------------------------pseudo_mini_loss sum 1.3544114828109741
Total (block generation + training)time/epoch 23.403778235117596
Training time/epoch 0.9263706207275391
Training time without block to device /epoch 0.7818996906280518
Training time without total dataloading part /epoch 0.05702614784240723
load block tensor time/epoch 0.6491916179656982
block to device time/epoch 0.1444709300994873
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  3056987
Number of first layer input nodes during this epoch:  1301429
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14127826690673828  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025134563446044922
range selection method range initialization spend 0.011927366256713867
time for parepare:  0.017413616180419922
local_output_nid generation:  0.002709627151489258
local_in_edges_tensor generation:  0.008635282516479492
mini_batch_src_global generation:  0.004098415374755859
r_  generation:  0.04422569274902344
local_output_nid generation:  0.003223896026611328
local_in_edges_tensor generation:  0.0018956661224365234
mini_batch_src_global generation:  0.004925966262817383
r_  generation:  0.044944047927856445
local_output_nid generation:  0.003110647201538086
local_in_edges_tensor generation:  0.001739501953125
mini_batch_src_global generation:  0.003324270248413086
r_  generation:  0.04513716697692871
local_output_nid generation:  0.003230571746826172
local_in_edges_tensor generation:  0.0019068717956542969
mini_batch_src_global generation:  0.0033233165740966797
r_  generation:  0.04632210731506348
local_output_nid generation:  0.0031626224517822266
local_in_edges_tensor generation:  0.0019047260284423828
mini_batch_src_global generation:  0.003652334213256836
r_  generation:  0.048483848571777344
local_output_nid generation:  0.0032052993774414062
local_in_edges_tensor generation:  0.0018181800842285156
mini_batch_src_global generation:  0.0037453174591064453
r_  generation:  0.04836273193359375
local_output_nid generation:  0.0032308101654052734
local_in_edges_tensor generation:  0.0018472671508789062
mini_batch_src_global generation:  0.003835439682006836
r_  generation:  0.0486140251159668
local_output_nid generation:  0.003175497055053711
local_in_edges_tensor generation:  0.0018568038940429688
mini_batch_src_global generation:  0.00380706787109375
r_  generation:  0.04811811447143555
----------------------check_connections_block total spend ----------------------------- 0.5485622882843018
generate_one_block  0.06023836135864258
generate_one_block  0.061029672622680664
generate_one_block  0.060135602951049805
generate_one_block  0.061342477798461914
generate_one_block  0.061696529388427734
generate_one_block  0.06207847595214844
generate_one_block  0.06428694725036621
generate_one_block  0.06142020225524902
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03917217254638672
gen group dst list time:  0.01548910140991211
time for parepare:  0.019601821899414062
local_output_nid generation:  0.011697530746459961
local_in_edges_tensor generation:  0.03299903869628906
mini_batch_src_global generation:  0.038369178771972656
r_  generation:  0.3656930923461914
local_output_nid generation:  0.017989158630371094
local_in_edges_tensor generation:  0.023371458053588867
mini_batch_src_global generation:  0.045411109924316406
r_  generation:  0.37964725494384766
local_output_nid generation:  0.01859307289123535
local_in_edges_tensor generation:  0.02024221420288086
mini_batch_src_global generation:  0.045175790786743164
r_  generation:  0.37385129928588867
local_output_nid generation:  0.018918275833129883
local_in_edges_tensor generation:  0.01900458335876465
mini_batch_src_global generation:  0.045148372650146484
r_  generation:  0.38634443283081055
local_output_nid generation:  0.019356250762939453
local_in_edges_tensor generation:  0.01977682113647461
mini_batch_src_global generation:  0.04713702201843262
r_  generation:  0.3818488121032715
local_output_nid generation:  0.018957853317260742
local_in_edges_tensor generation:  0.023869991302490234
mini_batch_src_global generation:  0.04711270332336426
r_  generation:  0.3888254165649414
local_output_nid generation:  0.018612146377563477
local_in_edges_tensor generation:  0.019864320755004883
mini_batch_src_global generation:  0.04764866828918457
r_  generation:  0.3798811435699463
local_output_nid generation:  0.018431901931762695
local_in_edges_tensor generation:  0.019845247268676758
mini_batch_src_global generation:  0.046729087829589844
r_  generation:  0.3857412338256836
----------------------check_connections_block total spend ----------------------------- 4.37864875793457
generate_one_block  0.49289512634277344
generate_one_block  0.49528980255126953
generate_one_block  0.48328423500061035
generate_one_block  0.4889962673187256
generate_one_block  0.48276472091674805
generate_one_block  0.4931304454803467
generate_one_block  0.48711490631103516
generate_one_block  0.5144550800323486
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04555535316467285
gen group dst list time:  0.03899383544921875
time for parepare:  0.020142078399658203
local_output_nid generation:  0.025525808334350586
local_in_edges_tensor generation:  0.04489636421203613
mini_batch_src_global generation:  0.05269289016723633
r_  generation:  0.5400564670562744
local_output_nid generation:  0.03276419639587402
local_in_edges_tensor generation:  0.04384493827819824
mini_batch_src_global generation:  0.06426262855529785
r_  generation:  0.5450773239135742
local_output_nid generation:  0.03365492820739746
local_in_edges_tensor generation:  0.037874698638916016
mini_batch_src_global generation:  0.06215929985046387
r_  generation:  0.5558784008026123
local_output_nid generation:  0.034279823303222656
local_in_edges_tensor generation:  0.034453630447387695
mini_batch_src_global generation:  0.059745073318481445
r_  generation:  0.5624086856842041
local_output_nid generation:  0.03435111045837402
local_in_edges_tensor generation:  0.03388643264770508
mini_batch_src_global generation:  0.06156492233276367
r_  generation:  0.5610146522521973
local_output_nid generation:  0.03457808494567871
local_in_edges_tensor generation:  0.03671121597290039
mini_batch_src_global generation:  0.0612025260925293
r_  generation:  0.5649454593658447
local_output_nid generation:  0.03449082374572754
local_in_edges_tensor generation:  0.03620600700378418
mini_batch_src_global generation:  0.06236600875854492
r_  generation:  0.5667781829833984
local_output_nid generation:  0.03445315361022949
local_in_edges_tensor generation:  0.036417484283447266
mini_batch_src_global generation:  0.0629117488861084
r_  generation:  0.5686135292053223
----------------------check_connections_block total spend ----------------------------- 6.523705244064331
generate_one_block  0.7008757591247559
generate_one_block  0.7048215866088867
generate_one_block  0.704535722732544
generate_one_block  0.7032363414764404
generate_one_block  0.6978528499603271
generate_one_block  0.7018628120422363
generate_one_block  0.7014997005462646
generate_one_block  0.7011616230010986
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14127826690673828  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

connection checking time:  10.902354001998901
block generation total time  9.553776979446411
average batch blocks generation time:  1.1942221224308014
block dataloader generation time/epoch 22.474891710281373
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10693550109863281  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9569211006164551  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10578536987304688  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9532747268676758  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10672569274902344  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9531731605529785  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10676765441894531  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9566926956176758  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1064448356628418  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9522662162780762  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10655403137207031  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.955167293548584  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1069173812866211  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9518699645996094  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10640335083007812  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9549808502197266  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08105000853538513 |0.013513684272766113 |0.0034727752208709717 |9.188055992126465e-05 |0.0030594170093536377 |0.0013470649719238281 |
----------------------------------------------------------pseudo_mini_loss sum 1.3403162956237793
Total (block generation + training)time/epoch 23.397656965255738
Training time/epoch 0.8878674507141113
Training time without block to device /epoch 0.7797579765319824
Training time without total dataloading part /epoch 0.05433964729309082
load block tensor time/epoch 0.648400068283081
block to device time/epoch 0.1081094741821289
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  3057312
Number of first layer input nodes during this epoch:  1300443
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14142799377441406  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019600391387939453
range selection method range initialization spend 0.011921167373657227
time for parepare:  0.016135215759277344
local_output_nid generation:  0.0027713775634765625
local_in_edges_tensor generation:  0.004116058349609375
mini_batch_src_global generation:  0.003383159637451172
r_  generation:  0.04345226287841797
local_output_nid generation:  0.0032219886779785156
local_in_edges_tensor generation:  0.0017666816711425781
mini_batch_src_global generation:  0.0047054290771484375
r_  generation:  0.042932748794555664
local_output_nid generation:  0.0032236576080322266
local_in_edges_tensor generation:  0.0018312931060791016
mini_batch_src_global generation:  0.0034368038177490234
r_  generation:  0.04662609100341797
local_output_nid generation:  0.0033140182495117188
local_in_edges_tensor generation:  0.0018448829650878906
mini_batch_src_global generation:  0.0034165382385253906
r_  generation:  0.04703068733215332
local_output_nid generation:  0.003226041793823242
local_in_edges_tensor generation:  0.0018360614776611328
mini_batch_src_global generation:  0.0035905838012695312
r_  generation:  0.04718518257141113
local_output_nid generation:  0.003232240676879883
local_in_edges_tensor generation:  0.0018858909606933594
mini_batch_src_global generation:  0.003893613815307617
r_  generation:  0.04878091812133789
local_output_nid generation:  0.0032300949096679688
local_in_edges_tensor generation:  0.0018193721771240234
mini_batch_src_global generation:  0.0038242340087890625
r_  generation:  0.04822683334350586
local_output_nid generation:  0.0032994747161865234
local_in_edges_tensor generation:  0.0017962455749511719
mini_batch_src_global generation:  0.00394129753112793
r_  generation:  0.04948258399963379
----------------------check_connections_block total spend ----------------------------- 0.5424251556396484
generate_one_block  0.05966353416442871
generate_one_block  0.05930662155151367
generate_one_block  0.062391042709350586
generate_one_block  0.061090707778930664
generate_one_block  0.06076312065124512
generate_one_block  0.062267303466796875
generate_one_block  0.06482911109924316
generate_one_block  0.06345367431640625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03634071350097656
gen group dst list time:  0.016019821166992188
time for parepare:  0.019292354583740234
local_output_nid generation:  0.011686086654663086
local_in_edges_tensor generation:  0.022122621536254883
mini_batch_src_global generation:  0.0410008430480957
r_  generation:  0.35767269134521484
local_output_nid generation:  0.017391681671142578
local_in_edges_tensor generation:  0.02178478240966797
mini_batch_src_global generation:  0.0442357063293457
r_  generation:  0.36470651626586914
local_output_nid generation:  0.01899123191833496
local_in_edges_tensor generation:  0.020743608474731445
mini_batch_src_global generation:  0.04535627365112305
r_  generation:  0.3792293071746826
local_output_nid generation:  0.018570661544799805
local_in_edges_tensor generation:  0.019620418548583984
mini_batch_src_global generation:  0.04559803009033203
r_  generation:  0.37812328338623047
local_output_nid generation:  0.019115447998046875
local_in_edges_tensor generation:  0.019228458404541016
mini_batch_src_global generation:  0.048363447189331055
r_  generation:  0.38226962089538574
local_output_nid generation:  0.019218921661376953
local_in_edges_tensor generation:  0.02237081527709961
mini_batch_src_global generation:  0.04712843894958496
r_  generation:  0.3890810012817383
local_output_nid generation:  0.01849675178527832
local_in_edges_tensor generation:  0.02169179916381836
mini_batch_src_global generation:  0.047708749771118164
r_  generation:  0.3869495391845703
local_output_nid generation:  0.018196582794189453
local_in_edges_tensor generation:  0.021206140518188477
mini_batch_src_global generation:  0.04720783233642578
r_  generation:  0.38431596755981445
----------------------check_connections_block total spend ----------------------------- 4.353949069976807
generate_one_block  0.486133337020874
generate_one_block  0.47662997245788574
generate_one_block  0.4960005283355713
generate_one_block  0.4936482906341553
generate_one_block  0.4816262722015381
generate_one_block  0.4934213161468506
generate_one_block  0.49503111839294434
generate_one_block  0.521630048751831
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04155111312866211
gen group dst list time:  0.03910231590270996
time for parepare:  0.020106792449951172
local_output_nid generation:  0.026947021484375
local_in_edges_tensor generation:  0.0411067008972168
mini_batch_src_global generation:  0.05342507362365723
r_  generation:  0.5458579063415527
local_output_nid generation:  0.03323936462402344
local_in_edges_tensor generation:  0.03786492347717285
mini_batch_src_global generation:  0.06407356262207031
r_  generation:  0.5454757213592529
local_output_nid generation:  0.03414750099182129
local_in_edges_tensor generation:  0.03325057029724121
mini_batch_src_global generation:  0.06168055534362793
r_  generation:  0.5593135356903076
local_output_nid generation:  0.03429865837097168
local_in_edges_tensor generation:  0.03612184524536133
mini_batch_src_global generation:  0.05957794189453125
r_  generation:  0.5542707443237305
local_output_nid generation:  0.034418344497680664
local_in_edges_tensor generation:  0.041359901428222656
mini_batch_src_global generation:  0.06131577491760254
r_  generation:  0.5641140937805176
local_output_nid generation:  0.034627437591552734
local_in_edges_tensor generation:  0.038846731185913086
mini_batch_src_global generation:  0.06186985969543457
r_  generation:  0.5820441246032715
local_output_nid generation:  0.03646445274353027
local_in_edges_tensor generation:  0.03435921669006348
mini_batch_src_global generation:  0.06578850746154785
r_  generation:  0.5663149356842041
local_output_nid generation:  0.03476428985595703
local_in_edges_tensor generation:  0.034073591232299805
mini_batch_src_global generation:  0.06183433532714844
r_  generation:  0.5639698505401611
----------------------check_connections_block total spend ----------------------------- 6.550145864486694
generate_one_block  0.6982603073120117
generate_one_block  0.7068557739257812
generate_one_block  0.7052688598632812
generate_one_block  0.7020628452301025
generate_one_block  0.7123982906341553
generate_one_block  0.7098493576049805
generate_one_block  0.698279619216919
generate_one_block  0.6974256038665771
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14142799377441406  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

connection checking time:  10.904094934463501
block generation total time  9.574521541595459
average batch blocks generation time:  1.1968151926994324
block dataloader generation time/epoch 22.47369315407493
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1069488525390625  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9536128044128418  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10634231567382812  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9463043212890625  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10703849792480469  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.958402156829834  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10575675964355469  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9520697593688965  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10671281814575195  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9496078491210938  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10697507858276367  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9591045379638672  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10648155212402344  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9522929191589355  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10646677017211914  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9569311141967773  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08140754699707031 |0.01517951488494873 |0.003428131341934204 |8.687376976013184e-05 |0.003278076648712158 |0.0013535022735595703 |
----------------------------------------------------------pseudo_mini_loss sum 1.3271129131317139
Total (block generation + training)time/epoch 23.39551147547635
Training time/epoch 0.9121255874633789
Training time without block to device /epoch 0.7906894683837891
Training time without total dataloading part /epoch 0.05569815635681152
load block tensor time/epoch 0.6512603759765625
block to device time/epoch 0.12143611907958984
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 20 |
Number of nodes for computation during this epoch:  3055833
Number of first layer input nodes during this epoch:  1300493
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1413121223449707  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022805213928222656
range selection method range initialization spend 0.012110233306884766
time for parepare:  0.01613759994506836
local_output_nid generation:  0.00270843505859375
local_in_edges_tensor generation:  0.007139682769775391
mini_batch_src_global generation:  0.003297090530395508
r_  generation:  0.044058799743652344
local_output_nid generation:  0.003141641616821289
local_in_edges_tensor generation:  0.0017740726470947266
mini_batch_src_global generation:  0.0049648284912109375
r_  generation:  0.04496407508850098
local_output_nid generation:  0.003153562545776367
local_in_edges_tensor generation:  0.0017735958099365234
mini_batch_src_global generation:  0.003385305404663086
r_  generation:  0.04579472541809082
local_output_nid generation:  0.003214120864868164
local_in_edges_tensor generation:  0.0018146038055419922
mini_batch_src_global generation:  0.003506183624267578
r_  generation:  0.0474543571472168
local_output_nid generation:  0.003266572952270508
local_in_edges_tensor generation:  0.0018520355224609375
mini_batch_src_global generation:  0.003793478012084961
r_  generation:  0.04803967475891113
local_output_nid generation:  0.0032448768615722656
local_in_edges_tensor generation:  0.0018575191497802734
mini_batch_src_global generation:  0.0037870407104492188
r_  generation:  0.047393798828125
local_output_nid generation:  0.0032472610473632812
local_in_edges_tensor generation:  0.001842498779296875
mini_batch_src_global generation:  0.0038890838623046875
r_  generation:  0.04821610450744629
local_output_nid generation:  0.003251314163208008
local_in_edges_tensor generation:  0.0018148422241210938
mini_batch_src_global generation:  0.003827333450317383
r_  generation:  0.048012733459472656
----------------------check_connections_block total spend ----------------------------- 0.5455889701843262
generate_one_block  0.059331417083740234
generate_one_block  0.06047773361206055
generate_one_block  0.06091880798339844
generate_one_block  0.06174111366271973
generate_one_block  0.06223773956298828
generate_one_block  0.06546282768249512
generate_one_block  0.06826424598693848
generate_one_block  0.06135082244873047
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0354311466217041
gen group dst list time:  0.01668095588684082
time for parepare:  0.01911449432373047
local_output_nid generation:  0.011562585830688477
local_in_edges_tensor generation:  0.029770612716674805
mini_batch_src_global generation:  0.037927865982055664
r_  generation:  0.3639547824859619
local_output_nid generation:  0.01744675636291504
local_in_edges_tensor generation:  0.021964311599731445
mini_batch_src_global generation:  0.04465651512145996
r_  generation:  0.3693513870239258
local_output_nid generation:  0.01804327964782715
local_in_edges_tensor generation:  0.018796920776367188
mini_batch_src_global generation:  0.04687333106994629
r_  generation:  0.3738365173339844
local_output_nid generation:  0.018547534942626953
local_in_edges_tensor generation:  0.019543886184692383
mini_batch_src_global generation:  0.04478859901428223
r_  generation:  0.3791773319244385
local_output_nid generation:  0.019108295440673828
local_in_edges_tensor generation:  0.01910853385925293
mini_batch_src_global generation:  0.04702496528625488
r_  generation:  0.3836832046508789
local_output_nid generation:  0.018782615661621094
local_in_edges_tensor generation:  0.01977825164794922
mini_batch_src_global generation:  0.04830479621887207
r_  generation:  0.37988758087158203
local_output_nid generation:  0.01803112030029297
local_in_edges_tensor generation:  0.021713733673095703
mini_batch_src_global generation:  0.04897332191467285
r_  generation:  0.38335561752319336
local_output_nid generation:  0.01827239990234375
local_in_edges_tensor generation:  0.019789457321166992
mini_batch_src_global generation:  0.0465550422668457
r_  generation:  0.38068413734436035
----------------------check_connections_block total spend ----------------------------- 4.336897850036621
generate_one_block  0.4910292625427246
generate_one_block  0.48859143257141113
generate_one_block  0.4919087886810303
generate_one_block  0.4898645877838135
generate_one_block  0.49404239654541016
generate_one_block  0.48732423782348633
generate_one_block  0.497056245803833
generate_one_block  0.5107526779174805
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03282976150512695
gen group dst list time:  0.038984060287475586
time for parepare:  0.019458293914794922
local_output_nid generation:  0.02590656280517578
local_in_edges_tensor generation:  0.036036014556884766
mini_batch_src_global generation:  0.05338263511657715
r_  generation:  0.5439140796661377
local_output_nid generation:  0.033006906509399414
local_in_edges_tensor generation:  0.03972268104553223
mini_batch_src_global generation:  0.06334805488586426
r_  generation:  0.5471017360687256
local_output_nid generation:  0.03417205810546875
local_in_edges_tensor generation:  0.03571200370788574
mini_batch_src_global generation:  0.06288957595825195
r_  generation:  0.556544303894043
local_output_nid generation:  0.034287214279174805
local_in_edges_tensor generation:  0.03377079963684082
mini_batch_src_global generation:  0.05936837196350098
r_  generation:  0.5594074726104736
local_output_nid generation:  0.03411293029785156
local_in_edges_tensor generation:  0.035125732421875
mini_batch_src_global generation:  0.06074070930480957
r_  generation:  0.5630433559417725
local_output_nid generation:  0.034101009368896484
local_in_edges_tensor generation:  0.03384280204772949
mini_batch_src_global generation:  0.0614778995513916
r_  generation:  0.5640163421630859
local_output_nid generation:  0.03441905975341797
local_in_edges_tensor generation:  0.035744667053222656
mini_batch_src_global generation:  0.06394529342651367
r_  generation:  0.5830180644989014
local_output_nid generation:  0.03462791442871094
local_in_edges_tensor generation:  0.03418779373168945
mini_batch_src_global generation:  0.06281447410583496
r_  generation:  0.5721378326416016
----------------------check_connections_block total spend ----------------------------- 6.530196666717529
generate_one_block  0.703385591506958
generate_one_block  0.7094404697418213
generate_one_block  0.7011685371398926
generate_one_block  0.6986942291259766
generate_one_block  0.7014353275299072
generate_one_block  0.7062258720397949
generate_one_block  0.7128341197967529
generate_one_block  0.7228353023529053
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1413121223449707  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

connection checking time:  10.86709451675415
block generation total time  9.606589078903198
average batch blocks generation time:  1.2008236348628998
block dataloader generation time/epoch 22.471947928269703
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10644340515136719  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9548430442810059  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10611677169799805  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9533133506774902  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10718679428100586  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.954164981842041  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1065053939819336  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.953700065612793  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10714340209960938  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9547319412231445  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1062932014465332  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9516081809997559  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1069478988647461  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9576177597045898  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10593843460083008  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9558525085449219  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08430469036102295 |0.014099061489105225 |0.003504812717437744 |8.887052536010742e-05 |0.0037490427494049072 |0.0012960433959960938 |
----------------------------------------------------------pseudo_mini_loss sum 1.31135094165802
Total (block generation + training)time/epoch 23.394057134787243
Training time/epoch 0.9251570701599121
Training time without block to device /epoch 0.8123645782470703
Training time without total dataloading part /epoch 0.060037851333618164
load block tensor time/epoch 0.6744375228881836
block to device time/epoch 0.1127924919128418
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 21 |
Number of nodes for computation during this epoch:  3058067
Number of first layer input nodes during this epoch:  1301040
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14084911346435547  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02161264419555664
range selection method range initialization spend 0.012026786804199219
time for parepare:  0.017039060592651367
local_output_nid generation:  0.0027692317962646484
local_in_edges_tensor generation:  0.00417780876159668
mini_batch_src_global generation:  0.003404855728149414
r_  generation:  0.04416847229003906
local_output_nid generation:  0.003256559371948242
local_in_edges_tensor generation:  0.0018017292022705078
mini_batch_src_global generation:  0.004955768585205078
r_  generation:  0.04459333419799805
local_output_nid generation:  0.003226041793823242
local_in_edges_tensor generation:  0.0018124580383300781
mini_batch_src_global generation:  0.003467082977294922
r_  generation:  0.04653310775756836
local_output_nid generation:  0.003230571746826172
local_in_edges_tensor generation:  0.0018448829650878906
mini_batch_src_global generation:  0.003411531448364258
r_  generation:  0.04674553871154785
local_output_nid generation:  0.003269672393798828
local_in_edges_tensor generation:  0.0017817020416259766
mini_batch_src_global generation:  0.0036373138427734375
r_  generation:  0.04655194282531738
local_output_nid generation:  0.0032262802124023438
local_in_edges_tensor generation:  0.0018351078033447266
mini_batch_src_global generation:  0.003698110580444336
r_  generation:  0.04790472984313965
local_output_nid generation:  0.0032083988189697266
local_in_edges_tensor generation:  0.0017747879028320312
mini_batch_src_global generation:  0.003915309906005859
r_  generation:  0.04834342002868652
local_output_nid generation:  0.0032660961151123047
local_in_edges_tensor generation:  0.0017895698547363281
mini_batch_src_global generation:  0.003742218017578125
r_  generation:  0.04808306694030762
----------------------check_connections_block total spend ----------------------------- 0.5426452159881592
generate_one_block  0.06303167343139648
generate_one_block  0.060803890228271484
generate_one_block  0.06154656410217285
generate_one_block  0.06090259552001953
generate_one_block  0.06071758270263672
generate_one_block  0.061162710189819336
generate_one_block  0.0645151138305664
generate_one_block  0.06092715263366699
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03523564338684082
gen group dst list time:  0.01550912857055664
time for parepare:  0.019244909286499023
local_output_nid generation:  0.01174616813659668
local_in_edges_tensor generation:  0.02769017219543457
mini_batch_src_global generation:  0.03658580780029297
r_  generation:  0.3709285259246826
local_output_nid generation:  0.01795816421508789
local_in_edges_tensor generation:  0.021502017974853516
mini_batch_src_global generation:  0.04553413391113281
r_  generation:  0.3753378391265869
local_output_nid generation:  0.018991947174072266
local_in_edges_tensor generation:  0.019153118133544922
mini_batch_src_global generation:  0.04544782638549805
r_  generation:  0.38746070861816406
local_output_nid generation:  0.019124984741210938
local_in_edges_tensor generation:  0.021034955978393555
mini_batch_src_global generation:  0.04469037055969238
r_  generation:  0.37529826164245605
local_output_nid generation:  0.01934647560119629
local_in_edges_tensor generation:  0.019312381744384766
mini_batch_src_global generation:  0.04640054702758789
r_  generation:  0.3818061351776123
local_output_nid generation:  0.018880128860473633
local_in_edges_tensor generation:  0.019651174545288086
mini_batch_src_global generation:  0.04631662368774414
r_  generation:  0.38181328773498535
local_output_nid generation:  0.01833963394165039
local_in_edges_tensor generation:  0.019387245178222656
mini_batch_src_global generation:  0.04686236381530762
r_  generation:  0.3856334686279297
local_output_nid generation:  0.018502235412597656
local_in_edges_tensor generation:  0.022792816162109375
mini_batch_src_global generation:  0.04698300361633301
r_  generation:  0.38265442848205566
----------------------check_connections_block total spend ----------------------------- 4.367578983306885
generate_one_block  0.49133729934692383
generate_one_block  0.49171996116638184
generate_one_block  0.4929056167602539
generate_one_block  0.48786163330078125
generate_one_block  0.4814903736114502
generate_one_block  0.4845917224884033
generate_one_block  0.48775172233581543
generate_one_block  0.5121402740478516
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025885820388793945
gen group dst list time:  0.04237198829650879
time for parepare:  0.020349740982055664
local_output_nid generation:  0.026770830154418945
local_in_edges_tensor generation:  0.03940892219543457
mini_batch_src_global generation:  0.05150651931762695
r_  generation:  0.5433056354522705
local_output_nid generation:  0.0340733528137207
local_in_edges_tensor generation:  0.03791069984436035
mini_batch_src_global generation:  0.06329774856567383
r_  generation:  0.5448205471038818
local_output_nid generation:  0.034696340560913086
local_in_edges_tensor generation:  0.03329157829284668
mini_batch_src_global generation:  0.06126976013183594
r_  generation:  0.560570478439331
local_output_nid generation:  0.03509402275085449
local_in_edges_tensor generation:  0.03920578956604004
mini_batch_src_global generation:  0.06309366226196289
r_  generation:  0.5585606098175049
local_output_nid generation:  0.035103797912597656
local_in_edges_tensor generation:  0.03689455986022949
mini_batch_src_global generation:  0.062250614166259766
r_  generation:  0.5641932487487793
local_output_nid generation:  0.03483390808105469
local_in_edges_tensor generation:  0.03401541709899902
mini_batch_src_global generation:  0.06271648406982422
r_  generation:  0.5702781677246094
local_output_nid generation:  0.03621268272399902
local_in_edges_tensor generation:  0.03415274620056152
mini_batch_src_global generation:  0.06309151649475098
r_  generation:  0.5636491775512695
local_output_nid generation:  0.03533673286437988
local_in_edges_tensor generation:  0.03745555877685547
mini_batch_src_global generation:  0.06345987319946289
r_  generation:  0.5661628246307373
----------------------check_connections_block total spend ----------------------------- 6.535740375518799
generate_one_block  0.7106709480285645
generate_one_block  0.7077922821044922
generate_one_block  0.7077608108520508
generate_one_block  0.7045555114746094
generate_one_block  0.7054522037506104
generate_one_block  0.7071149349212646
generate_one_block  0.7154409885406494
generate_one_block  0.7075386047363281
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14084911346435547  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

connection checking time:  10.903319358825684
block generation total time  9.59612488746643
average batch blocks generation time:  1.1995156109333038
block dataloader generation time/epoch 22.473640038416935
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1069631576538086  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9574761390686035  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10597944259643555  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9548330307006836  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10697126388549805  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9595069885253906  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10577201843261719  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9513063430786133  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1067361831665039  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9504694938659668  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10677337646484375  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9539146423339844  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10718250274658203  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9537644386291504  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10664224624633789  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9555625915527344  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08314934372901917 |0.014909923076629639 |0.0034503936767578125 |8.690357208251953e-05 |0.0035934150218963623 |0.0028553009033203125 |
----------------------------------------------------------pseudo_mini_loss sum 1.2950180768966675
Total (block generation + training)time/epoch 23.39553556075463
Training time/epoch 0.9191150665283203
Training time without block to device /epoch 0.7998356819152832
Training time without total dataloading part /epoch 0.05990099906921387
load block tensor time/epoch 0.6651947498321533
block to device time/epoch 0.11927938461303711
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 22 |
Number of nodes for computation during this epoch:  3058803
Number of first layer input nodes during this epoch:  1301239
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14148473739624023  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025899410247802734
range selection method range initialization spend 0.01566028594970703
time for parepare:  0.016154766082763672
local_output_nid generation:  0.002754688262939453
local_in_edges_tensor generation:  0.007369041442871094
mini_batch_src_global generation:  0.004147052764892578
r_  generation:  0.04694056510925293
local_output_nid generation:  0.0031778812408447266
local_in_edges_tensor generation:  0.001943826675415039
mini_batch_src_global generation:  0.005968809127807617
r_  generation:  0.04831528663635254
local_output_nid generation:  0.0031952857971191406
local_in_edges_tensor generation:  0.001814126968383789
mini_batch_src_global generation:  0.004183530807495117
r_  generation:  0.04575753211975098
local_output_nid generation:  0.003195524215698242
local_in_edges_tensor generation:  0.0018312931060791016
mini_batch_src_global generation:  0.0034329891204833984
r_  generation:  0.0460047721862793
local_output_nid generation:  0.003288745880126953
local_in_edges_tensor generation:  0.0018324851989746094
mini_batch_src_global generation:  0.003682851791381836
r_  generation:  0.04756736755371094
local_output_nid generation:  0.0032033920288085938
local_in_edges_tensor generation:  0.0018241405487060547
mini_batch_src_global generation:  0.0036840438842773438
r_  generation:  0.04770946502685547
local_output_nid generation:  0.0032646656036376953
local_in_edges_tensor generation:  0.0018215179443359375
mini_batch_src_global generation:  0.0037648677825927734
r_  generation:  0.04713177680969238
local_output_nid generation:  0.0032219886779785156
local_in_edges_tensor generation:  0.001825571060180664
mini_batch_src_global generation:  0.003742694854736328
r_  generation:  0.047736406326293945
----------------------check_connections_block total spend ----------------------------- 0.5553269386291504
generate_one_block  0.06018948554992676
generate_one_block  0.0621035099029541
generate_one_block  0.061521053314208984
generate_one_block  0.06118631362915039
generate_one_block  0.061681509017944336
generate_one_block  0.0620274543762207
generate_one_block  0.0637824535369873
generate_one_block  0.06176185607910156
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03472089767456055
gen group dst list time:  0.015376567840576172
time for parepare:  0.020407915115356445
local_output_nid generation:  0.011710166931152344
local_in_edges_tensor generation:  0.03031444549560547
mini_batch_src_global generation:  0.03867292404174805
r_  generation:  0.3647284507751465
local_output_nid generation:  0.018201828002929688
local_in_edges_tensor generation:  0.024496078491210938
mini_batch_src_global generation:  0.04546236991882324
r_  generation:  0.37399911880493164
local_output_nid generation:  0.018679141998291016
local_in_edges_tensor generation:  0.01926112174987793
mini_batch_src_global generation:  0.04489636421203613
r_  generation:  0.3800313472747803
local_output_nid generation:  0.01857900619506836
local_in_edges_tensor generation:  0.02081584930419922
mini_batch_src_global generation:  0.04530739784240723
r_  generation:  0.38132166862487793
local_output_nid generation:  0.019219636917114258
local_in_edges_tensor generation:  0.019688844680786133
mini_batch_src_global generation:  0.04682183265686035
r_  generation:  0.38280606269836426
local_output_nid generation:  0.019357919692993164
local_in_edges_tensor generation:  0.019595861434936523
mini_batch_src_global generation:  0.04611039161682129
r_  generation:  0.3860783576965332
local_output_nid generation:  0.018121004104614258
local_in_edges_tensor generation:  0.019974231719970703
mini_batch_src_global generation:  0.046044111251831055
r_  generation:  0.378803014755249
local_output_nid generation:  0.018492698669433594
local_in_edges_tensor generation:  0.021588563919067383
mini_batch_src_global generation:  0.04636240005493164
r_  generation:  0.38730597496032715
----------------------check_connections_block total spend ----------------------------- 4.361377954483032
generate_one_block  0.4958326816558838
generate_one_block  0.49509334564208984
generate_one_block  0.48543548583984375
generate_one_block  0.4910163879394531
generate_one_block  0.48855090141296387
generate_one_block  0.49146080017089844
generate_one_block  0.48380494117736816
generate_one_block  0.520627498626709
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0386505126953125
gen group dst list time:  0.03903913497924805
time for parepare:  0.019106626510620117
local_output_nid generation:  0.02722334861755371
local_in_edges_tensor generation:  0.038057804107666016
mini_batch_src_global generation:  0.05394458770751953
r_  generation:  0.5502142906188965
local_output_nid generation:  0.03387165069580078
local_in_edges_tensor generation:  0.03968191146850586
mini_batch_src_global generation:  0.06391620635986328
r_  generation:  0.5545451641082764
local_output_nid generation:  0.03472638130187988
local_in_edges_tensor generation:  0.0323793888092041
mini_batch_src_global generation:  0.06160426139831543
r_  generation:  0.5629022121429443
local_output_nid generation:  0.03530526161193848
local_in_edges_tensor generation:  0.03577399253845215
mini_batch_src_global generation:  0.060866594314575195
r_  generation:  0.5631959438323975
local_output_nid generation:  0.03554797172546387
local_in_edges_tensor generation:  0.03382301330566406
mini_batch_src_global generation:  0.06187725067138672
r_  generation:  0.5695970058441162
local_output_nid generation:  0.03532576560974121
local_in_edges_tensor generation:  0.0339503288269043
mini_batch_src_global generation:  0.06383633613586426
r_  generation:  0.5673599243164062
local_output_nid generation:  0.03557586669921875
local_in_edges_tensor generation:  0.03323101997375488
mini_batch_src_global generation:  0.06262969970703125
r_  generation:  0.5715286731719971
local_output_nid generation:  0.035707712173461914
local_in_edges_tensor generation:  0.03488349914550781
mini_batch_src_global generation:  0.0630483627319336
r_  generation:  0.5712065696716309
----------------------check_connections_block total spend ----------------------------- 6.557779312133789
generate_one_block  0.6995322704315186
generate_one_block  0.7049906253814697
generate_one_block  0.7057411670684814
generate_one_block  0.7073383331298828
generate_one_block  0.7078156471252441
generate_one_block  0.705157995223999
generate_one_block  0.7038800716400146
generate_one_block  0.7015500068664551
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14148473739624023  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

connection checking time:  10.919157266616821
block generation total time  9.587828159332275
average batch blocks generation time:  1.1984785199165344
block dataloader generation time/epoch 22.476257256099156
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1069631576538086  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9560046195983887  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10651969909667969  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9569635391235352  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10636186599731445  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9491109848022461  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10636329650878906  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9551982879638672  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1071467399597168  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9529743194580078  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10658502578735352  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9541811943054199  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10691070556640625  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9496040344238281  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1063838005065918  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9555249214172363  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08477276563644409 |0.013691037893295288 |0.003500908613204956 |8.997321128845215e-05 |0.0037924349308013916 |0.0015387535095214844 |
----------------------------------------------------------pseudo_mini_loss sum 1.2810564041137695
Total (block generation + training)time/epoch 23.39835979257311
Training time/epoch 0.9245743751525879
Training time without block to device /epoch 0.8150460720062256
Training time without total dataloading part /epoch 0.06060528755187988
load block tensor time/epoch 0.6781821250915527
block to device time/epoch 0.1095283031463623
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 23 |
Number of nodes for computation during this epoch:  3056727
Number of first layer input nodes during this epoch:  1300984
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14138078689575195  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024247407913208008
range selection method range initialization spend 0.012064933776855469
time for parepare:  0.01695704460144043
local_output_nid generation:  0.0027246475219726562
local_in_edges_tensor generation:  0.004480600357055664
mini_batch_src_global generation:  0.003345012664794922
r_  generation:  0.044425010681152344
local_output_nid generation:  0.003142118453979492
local_in_edges_tensor generation:  0.0019800662994384766
mini_batch_src_global generation:  0.0050199031829833984
r_  generation:  0.04626607894897461
local_output_nid generation:  0.0031921863555908203
local_in_edges_tensor generation:  0.0019478797912597656
mini_batch_src_global generation:  0.0035135746002197266
r_  generation:  0.04625844955444336
local_output_nid generation:  0.0031938552856445312
local_in_edges_tensor generation:  0.0018351078033447266
mini_batch_src_global generation:  0.0034236907958984375
r_  generation:  0.047388553619384766
local_output_nid generation:  0.0032444000244140625
local_in_edges_tensor generation:  0.0017833709716796875
mini_batch_src_global generation:  0.003671407699584961
r_  generation:  0.04745078086853027
local_output_nid generation:  0.003214597702026367
local_in_edges_tensor generation:  0.0018198490142822266
mini_batch_src_global generation:  0.00380706787109375
r_  generation:  0.04842829704284668
local_output_nid generation:  0.003209829330444336
local_in_edges_tensor generation:  0.0017991065979003906
mini_batch_src_global generation:  0.0039370059967041016
r_  generation:  0.0484623908996582
local_output_nid generation:  0.0032422542572021484
local_in_edges_tensor generation:  0.0018351078033447266
mini_batch_src_global generation:  0.003804445266723633
r_  generation:  0.04820418357849121
----------------------check_connections_block total spend ----------------------------- 0.5475313663482666
generate_one_block  0.05980086326599121
generate_one_block  0.0610804557800293
generate_one_block  0.061611175537109375
generate_one_block  0.06163191795349121
generate_one_block  0.06106209754943848
generate_one_block  0.06163430213928223
generate_one_block  0.06495356559753418
generate_one_block  0.06168031692504883
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.039190053939819336
gen group dst list time:  0.015377998352050781
time for parepare:  0.019493818283081055
local_output_nid generation:  0.011877298355102539
local_in_edges_tensor generation:  0.025347471237182617
mini_batch_src_global generation:  0.038360595703125
r_  generation:  0.3609592914581299
local_output_nid generation:  0.01784515380859375
local_in_edges_tensor generation:  0.020320653915405273
mini_batch_src_global generation:  0.04737138748168945
r_  generation:  0.37172698974609375
local_output_nid generation:  0.0190885066986084
local_in_edges_tensor generation:  0.019064664840698242
mini_batch_src_global generation:  0.04544496536254883
r_  generation:  0.37747979164123535
local_output_nid generation:  0.018640518188476562
local_in_edges_tensor generation:  0.01894545555114746
mini_batch_src_global generation:  0.04520130157470703
r_  generation:  0.3752918243408203
local_output_nid generation:  0.01926708221435547
local_in_edges_tensor generation:  0.019826412200927734
mini_batch_src_global generation:  0.04736471176147461
r_  generation:  0.3845975399017334
local_output_nid generation:  0.019541025161743164
local_in_edges_tensor generation:  0.021138668060302734
mini_batch_src_global generation:  0.062418222427368164
r_  generation:  0.3845992088317871
local_output_nid generation:  0.01857900619506836
local_in_edges_tensor generation:  0.02604198455810547
mini_batch_src_global generation:  0.04755258560180664
r_  generation:  0.39246344566345215
local_output_nid generation:  0.01846027374267578
local_in_edges_tensor generation:  0.023427963256835938
mini_batch_src_global generation:  0.04665946960449219
r_  generation:  0.3846163749694824
----------------------check_connections_block total spend ----------------------------- 4.379334926605225
generate_one_block  0.49106550216674805
generate_one_block  0.5098536014556885
generate_one_block  0.49042820930480957
generate_one_block  0.48889851570129395
generate_one_block  0.4863760471343994
generate_one_block  0.4910893440246582
generate_one_block  0.4978368282318115
generate_one_block  0.5192146301269531
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.038060665130615234
gen group dst list time:  0.039319753646850586
time for parepare:  0.017989397048950195
local_output_nid generation:  0.02645111083984375
local_in_edges_tensor generation:  0.0442349910736084
mini_batch_src_global generation:  0.05214357376098633
r_  generation:  0.5443754196166992
local_output_nid generation:  0.033151865005493164
local_in_edges_tensor generation:  0.0375974178314209
mini_batch_src_global generation:  0.06564998626708984
r_  generation:  0.5507509708404541
local_output_nid generation:  0.03399801254272461
local_in_edges_tensor generation:  0.03670167922973633
mini_batch_src_global generation:  0.06417083740234375
r_  generation:  0.5596747398376465
local_output_nid generation:  0.03444051742553711
local_in_edges_tensor generation:  0.03308248519897461
mini_batch_src_global generation:  0.06058168411254883
r_  generation:  0.5590758323669434
local_output_nid generation:  0.034546852111816406
local_in_edges_tensor generation:  0.035895586013793945
mini_batch_src_global generation:  0.061527252197265625
r_  generation:  0.5631282329559326
local_output_nid generation:  0.034712791442871094
local_in_edges_tensor generation:  0.03628373146057129
mini_batch_src_global generation:  0.06178092956542969
r_  generation:  0.562300443649292
local_output_nid generation:  0.03465700149536133
local_in_edges_tensor generation:  0.038228511810302734
mini_batch_src_global generation:  0.06330299377441406
r_  generation:  0.5722384452819824
local_output_nid generation:  0.03503584861755371
local_in_edges_tensor generation:  0.03644990921020508
mini_batch_src_global generation:  0.0649118423461914
r_  generation:  0.570854902267456
----------------------check_connections_block total spend ----------------------------- 6.546650171279907
generate_one_block  0.7093663215637207
generate_one_block  0.7059793472290039
generate_one_block  0.7073397636413574
generate_one_block  0.7012829780578613
generate_one_block  0.7035787105560303
generate_one_block  0.7025806903839111
generate_one_block  0.7052979469299316
generate_one_block  0.7107570171356201
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14138078689575195  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

connection checking time:  10.925985097885132
block generation total time  9.620945453643799
average batch blocks generation time:  1.2026181817054749
block dataloader generation time/epoch 22.48056681950887
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10686969757080078  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9496726989746094  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10638713836669922  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9536795616149902  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10683917999267578  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9549288749694824  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10651540756225586  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9544515609741211  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1070246696472168  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9526257514953613  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10666561126708984  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9556093215942383  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1072092056274414  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9570116996765137  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10593271255493164  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9561944007873535  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08147209882736206 |0.013499170541763306 |0.003509700298309326 |8.943676948547363e-05 |0.0031183362007141113 |0.0013048648834228516 |
----------------------------------------------------------pseudo_mini_loss sum 1.2677717208862305
Total (block generation + training)time/epoch 23.40076665878296
Training time/epoch 0.8933756351470947
Training time without block to device /epoch 0.7853822708129883
Training time without total dataloading part /epoch 0.05504465103149414
load block tensor time/epoch 0.6517767906188965
block to device time/epoch 0.10799336433410645
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 24 |
Number of nodes for computation during this epoch:  3057448
Number of first layer input nodes during this epoch:  1300792
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14141082763671875  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023277997970581055
range selection method range initialization spend 0.011748075485229492
time for parepare:  0.01681971549987793
local_output_nid generation:  0.002789735794067383
local_in_edges_tensor generation:  0.004368782043457031
mini_batch_src_global generation:  0.003375530242919922
r_  generation:  0.04465174674987793
local_output_nid generation:  0.0030825138092041016
local_in_edges_tensor generation:  0.0017523765563964844
mini_batch_src_global generation:  0.00494074821472168
r_  generation:  0.04518008232116699
local_output_nid generation:  0.003133058547973633
local_in_edges_tensor generation:  0.0017800331115722656
mini_batch_src_global generation:  0.003502368927001953
r_  generation:  0.04552030563354492
local_output_nid generation:  0.003144502639770508
local_in_edges_tensor generation:  0.0017962455749511719
mini_batch_src_global generation:  0.0034284591674804688
r_  generation:  0.04665207862854004
local_output_nid generation:  0.003216981887817383
local_in_edges_tensor generation:  0.0018563270568847656
mini_batch_src_global generation:  0.003750324249267578
r_  generation:  0.04750204086303711
local_output_nid generation:  0.0032248497009277344
local_in_edges_tensor generation:  0.0019626617431640625
mini_batch_src_global generation:  0.003813028335571289
r_  generation:  0.04840087890625
local_output_nid generation:  0.003223896026611328
local_in_edges_tensor generation:  0.0018374919891357422
mini_batch_src_global generation:  0.003957986831665039
r_  generation:  0.0473332405090332
local_output_nid generation:  0.003220081329345703
local_in_edges_tensor generation:  0.0018146038055419922
mini_batch_src_global generation:  0.003793001174926758
r_  generation:  0.04816031455993652
----------------------check_connections_block total spend ----------------------------- 0.5428206920623779
generate_one_block  0.0598299503326416
generate_one_block  0.06129741668701172
generate_one_block  0.06094169616699219
generate_one_block  0.061219215393066406
generate_one_block  0.06223607063293457
generate_one_block  0.06190609931945801
generate_one_block  0.06352686882019043
generate_one_block  0.06193280220031738
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03244280815124512
gen group dst list time:  0.014969587326049805
time for parepare:  0.01967597007751465
local_output_nid generation:  0.0115966796875
local_in_edges_tensor generation:  0.027455806732177734
mini_batch_src_global generation:  0.03708529472351074
r_  generation:  0.363053560256958
local_output_nid generation:  0.01772928237915039
local_in_edges_tensor generation:  0.022794246673583984
mini_batch_src_global generation:  0.04533863067626953
r_  generation:  0.375978946685791
local_output_nid generation:  0.01857757568359375
local_in_edges_tensor generation:  0.019591093063354492
mini_batch_src_global generation:  0.04466104507446289
r_  generation:  0.3709709644317627
local_output_nid generation:  0.01836705207824707
local_in_edges_tensor generation:  0.020560264587402344
mini_batch_src_global generation:  0.045003414154052734
r_  generation:  0.3766622543334961
local_output_nid generation:  0.01952338218688965
local_in_edges_tensor generation:  0.020569324493408203
mini_batch_src_global generation:  0.04796767234802246
r_  generation:  0.3872535228729248
local_output_nid generation:  0.019424915313720703
local_in_edges_tensor generation:  0.020676136016845703
mini_batch_src_global generation:  0.04710817337036133
r_  generation:  0.385570764541626
local_output_nid generation:  0.018390893936157227
local_in_edges_tensor generation:  0.020295381546020508
mini_batch_src_global generation:  0.0473020076751709
r_  generation:  0.37749624252319336
local_output_nid generation:  0.01837944984436035
local_in_edges_tensor generation:  0.022630691528320312
mini_batch_src_global generation:  0.04878091812133789
r_  generation:  0.38608455657958984
----------------------check_connections_block total spend ----------------------------- 4.356698274612427
generate_one_block  0.49396729469299316
generate_one_block  0.49356818199157715
generate_one_block  0.47994232177734375
generate_one_block  0.4893207550048828
generate_one_block  0.496030330657959
generate_one_block  0.4957277774810791
generate_one_block  0.48348093032836914
generate_one_block  0.5206620693206787
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03281402587890625
gen group dst list time:  0.03927969932556152
time for parepare:  0.01829051971435547
local_output_nid generation:  0.026410341262817383
local_in_edges_tensor generation:  0.0382380485534668
mini_batch_src_global generation:  0.051111459732055664
r_  generation:  0.5436294078826904
local_output_nid generation:  0.03327226638793945
local_in_edges_tensor generation:  0.039191484451293945
mini_batch_src_global generation:  0.06357479095458984
r_  generation:  0.550121545791626
local_output_nid generation:  0.03423190116882324
local_in_edges_tensor generation:  0.03656172752380371
mini_batch_src_global generation:  0.060919761657714844
r_  generation:  0.5596878528594971
local_output_nid generation:  0.03450441360473633
local_in_edges_tensor generation:  0.03654336929321289
mini_batch_src_global generation:  0.05954170227050781
r_  generation:  0.5642397403717041
local_output_nid generation:  0.03493809700012207
local_in_edges_tensor generation:  0.041707515716552734
mini_batch_src_global generation:  0.060189247131347656
r_  generation:  0.5680515766143799
local_output_nid generation:  0.03484463691711426
local_in_edges_tensor generation:  0.03682279586791992
mini_batch_src_global generation:  0.06110429763793945
r_  generation:  0.5696902275085449
local_output_nid generation:  0.03506207466125488
local_in_edges_tensor generation:  0.03428792953491211
mini_batch_src_global generation:  0.062322378158569336
r_  generation:  0.572643518447876
local_output_nid generation:  0.03507375717163086
local_in_edges_tensor generation:  0.03499650955200195
mini_batch_src_global generation:  0.06277322769165039
r_  generation:  0.5702300071716309
----------------------check_connections_block total spend ----------------------------- 6.554670810699463
generate_one_block  0.700692892074585
generate_one_block  0.7110514640808105
generate_one_block  0.7013297080993652
generate_one_block  0.7005360126495361
generate_one_block  0.708209753036499
generate_one_block  0.7067842483520508
generate_one_block  0.7134630680084229
generate_one_block  0.7022464275360107
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14141082763671875  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

connection checking time:  10.91136908531189
block generation total time  9.597013235092163
average batch blocks generation time:  1.1996266543865204
block dataloader generation time/epoch 22.48075906932354
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10706615447998047  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9553298950195312  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10590219497680664  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9542813301086426  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10704231262207031  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9519023895263672  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10669851303100586  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9538140296936035  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10730457305908203  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9601950645446777  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10595703125  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9546713829040527  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.106689453125  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9489874839782715  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10631418228149414  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9532575607299805  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07922723889350891 |0.01577216386795044 |0.0033900439739227295 |8.672475814819336e-05 |0.0034367740154266357 |0.0026421546936035156 |
----------------------------------------------------------pseudo_mini_loss sum 1.2577959299087524
Total (block generation + training)time/epoch 23.399417221546173
Training time/epoch 0.8952987194061279
Training time without block to device /epoch 0.7691214084625244
Training time without total dataloading part /epoch 0.057950496673583984
load block tensor time/epoch 0.6338179111480713
block to device time/epoch 0.12617731094360352
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 25 |
Number of nodes for computation during this epoch:  3057142
Number of first layer input nodes during this epoch:  1301178
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14134550094604492  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023908376693725586
range selection method range initialization spend 0.012136220932006836
time for parepare:  0.017104148864746094
local_output_nid generation:  0.0027158260345458984
local_in_edges_tensor generation:  0.004117488861083984
mini_batch_src_global generation:  0.003317594528198242
r_  generation:  0.0443878173828125
local_output_nid generation:  0.0031735897064208984
local_in_edges_tensor generation:  0.0018584728240966797
mini_batch_src_global generation:  0.005037546157836914
r_  generation:  0.045709848403930664
local_output_nid generation:  0.003209352493286133
local_in_edges_tensor generation:  0.0018391609191894531
mini_batch_src_global generation:  0.003459453582763672
r_  generation:  0.045871734619140625
local_output_nid generation:  0.003228425979614258
local_in_edges_tensor generation:  0.001832723617553711
mini_batch_src_global generation:  0.0034236907958984375
r_  generation:  0.046898841857910156
local_output_nid generation:  0.0032613277435302734
local_in_edges_tensor generation:  0.0018084049224853516
mini_batch_src_global generation:  0.0037000179290771484
r_  generation:  0.04752540588378906
local_output_nid generation:  0.00319671630859375
local_in_edges_tensor generation:  0.0018270015716552734
mini_batch_src_global generation:  0.003722667694091797
r_  generation:  0.04814577102661133
local_output_nid generation:  0.003238677978515625
local_in_edges_tensor generation:  0.0018200874328613281
mini_batch_src_global generation:  0.0038039684295654297
r_  generation:  0.04801511764526367
local_output_nid generation:  0.003190755844116211
local_in_edges_tensor generation:  0.001825094223022461
mini_batch_src_global generation:  0.0036258697509765625
r_  generation:  0.047650814056396484
----------------------check_connections_block total spend ----------------------------- 0.5436601638793945
generate_one_block  0.0599515438079834
generate_one_block  0.06180429458618164
generate_one_block  0.06152057647705078
generate_one_block  0.06201648712158203
generate_one_block  0.061875104904174805
generate_one_block  0.06282854080200195
generate_one_block  0.06463289260864258
generate_one_block  0.06144905090332031
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.039804697036743164
gen group dst list time:  0.015300989151000977
time for parepare:  0.019591093063354492
local_output_nid generation:  0.011515617370605469
local_in_edges_tensor generation:  0.027300357818603516
mini_batch_src_global generation:  0.03665781021118164
r_  generation:  0.36402416229248047
local_output_nid generation:  0.017836809158325195
local_in_edges_tensor generation:  0.0237123966217041
mini_batch_src_global generation:  0.04445362091064453
r_  generation:  0.3686089515686035
local_output_nid generation:  0.018617630004882812
local_in_edges_tensor generation:  0.01848292350769043
mini_batch_src_global generation:  0.0451970100402832
r_  generation:  0.37748074531555176
local_output_nid generation:  0.01862168312072754
local_in_edges_tensor generation:  0.01891469955444336
mini_batch_src_global generation:  0.04689502716064453
r_  generation:  0.37698984146118164
local_output_nid generation:  0.01948857307434082
local_in_edges_tensor generation:  0.019483566284179688
mini_batch_src_global generation:  0.04696154594421387
r_  generation:  0.38619017601013184
local_output_nid generation:  0.019609928131103516
local_in_edges_tensor generation:  0.020887136459350586
mini_batch_src_global generation:  0.04660344123840332
r_  generation:  0.38530588150024414
local_output_nid generation:  0.0182034969329834
local_in_edges_tensor generation:  0.01983928680419922
mini_batch_src_global generation:  0.04772782325744629
r_  generation:  0.38775181770324707
local_output_nid generation:  0.018589258193969727
local_in_edges_tensor generation:  0.01949620246887207
mini_batch_src_global generation:  0.04595041275024414
r_  generation:  0.375058650970459
----------------------check_connections_block total spend ----------------------------- 4.346001148223877
generate_one_block  0.4905388355255127
generate_one_block  0.4862222671508789
generate_one_block  0.4855046272277832
generate_one_block  0.4848310947418213
generate_one_block  0.48777008056640625
generate_one_block  0.4977700710296631
generate_one_block  0.48746490478515625
generate_one_block  0.5067577362060547
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.038216590881347656
gen group dst list time:  0.03971505165100098
time for parepare:  0.018838882446289062
local_output_nid generation:  0.0261380672454834
local_in_edges_tensor generation:  0.03766059875488281
mini_batch_src_global generation:  0.055118560791015625
r_  generation:  0.5461361408233643
local_output_nid generation:  0.033266305923461914
local_in_edges_tensor generation:  0.035935163497924805
mini_batch_src_global generation:  0.06356668472290039
r_  generation:  0.5468900203704834
local_output_nid generation:  0.034006595611572266
local_in_edges_tensor generation:  0.03608417510986328
mini_batch_src_global generation:  0.06833958625793457
r_  generation:  0.5540661811828613
local_output_nid generation:  0.03428077697753906
local_in_edges_tensor generation:  0.03759765625
mini_batch_src_global generation:  0.05984854698181152
r_  generation:  0.5615215301513672
local_output_nid generation:  0.03536558151245117
local_in_edges_tensor generation:  0.03872418403625488
mini_batch_src_global generation:  0.06385254859924316
r_  generation:  0.5616629123687744
local_output_nid generation:  0.03448820114135742
local_in_edges_tensor generation:  0.035955190658569336
mini_batch_src_global generation:  0.0617222785949707
r_  generation:  0.564201831817627
local_output_nid generation:  0.034809112548828125
local_in_edges_tensor generation:  0.03596210479736328
mini_batch_src_global generation:  0.06292343139648438
r_  generation:  0.5861401557922363
local_output_nid generation:  0.03623080253601074
local_in_edges_tensor generation:  0.037087202072143555
mini_batch_src_global generation:  0.06715178489685059
r_  generation:  0.5669255256652832
----------------------check_connections_block total spend ----------------------------- 6.560794353485107
generate_one_block  0.7090775966644287
generate_one_block  0.7050871849060059
generate_one_block  0.7138442993164062
generate_one_block  0.7056787014007568
generate_one_block  0.7155046463012695
generate_one_block  0.718756914138794
generate_one_block  0.7073605060577393
generate_one_block  0.7009279727935791
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14134550094604492  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

connection checking time:  10.906795501708984
block generation total time  9.603097438812256
average batch blocks generation time:  1.200387179851532
block dataloader generation time/epoch 22.481737529530246
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10687065124511719  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9548606872558594  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1065068244934082  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9542312622070312  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10702228546142578  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.955169677734375  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1065359115600586  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.953794002532959  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10711479187011719  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9566760063171387  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1061396598815918  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9576759338378906  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10722637176513672  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9548759460449219  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10640478134155273  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9535112380981445  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08249834179878235 |0.015918076038360596 |0.0034585893154144287 |8.96751880645752e-05 |0.0033044815063476562 |0.0027632713317871094 |
----------------------------------------------------------pseudo_mini_loss sum 1.2478413581848145
Total (block generation + training)time/epoch 23.40056347846985
Training time/epoch 0.9212262630462646
Training time without block to device /epoch 0.7938816547393799
Training time without total dataloading part /epoch 0.05758523941040039
load block tensor time/epoch 0.6599867343902588
block to device time/epoch 0.12734460830688477
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 26 |
Number of nodes for computation during this epoch:  3059575
Number of first layer input nodes during this epoch:  1301358
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14133548736572266  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02517533302307129
range selection method range initialization spend 0.011942625045776367
time for parepare:  0.01622152328491211
local_output_nid generation:  0.002767324447631836
local_in_edges_tensor generation:  0.0049571990966796875
mini_batch_src_global generation:  0.003286123275756836
r_  generation:  0.043853044509887695
local_output_nid generation:  0.0031812191009521484
local_in_edges_tensor generation:  0.0018100738525390625
mini_batch_src_global generation:  0.00497746467590332
r_  generation:  0.04494047164916992
local_output_nid generation:  0.0032529830932617188
local_in_edges_tensor generation:  0.0017971992492675781
mini_batch_src_global generation:  0.003432035446166992
r_  generation:  0.04632425308227539
local_output_nid generation:  0.003254413604736328
local_in_edges_tensor generation:  0.001833200454711914
mini_batch_src_global generation:  0.003410816192626953
r_  generation:  0.046975135803222656
local_output_nid generation:  0.003200531005859375
local_in_edges_tensor generation:  0.00186920166015625
mini_batch_src_global generation:  0.0037572383880615234
r_  generation:  0.04703497886657715
local_output_nid generation:  0.0032575130462646484
local_in_edges_tensor generation:  0.0018274784088134766
mini_batch_src_global generation:  0.0037546157836914062
r_  generation:  0.04819369316101074
local_output_nid generation:  0.0032377243041992188
local_in_edges_tensor generation:  0.0021042823791503906
mini_batch_src_global generation:  0.003949165344238281
r_  generation:  0.04916548728942871
local_output_nid generation:  0.0032758712768554688
local_in_edges_tensor generation:  0.0018892288208007812
mini_batch_src_global generation:  0.0038123130798339844
r_  generation:  0.04773592948913574
----------------------check_connections_block total spend ----------------------------- 0.5447912216186523
generate_one_block  0.06286787986755371
generate_one_block  0.06259775161743164
generate_one_block  0.06140279769897461
generate_one_block  0.06146359443664551
generate_one_block  0.060892581939697266
generate_one_block  0.061533451080322266
generate_one_block  0.06539559364318848
generate_one_block  0.06071782112121582
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.032330989837646484
gen group dst list time:  0.015222311019897461
time for parepare:  0.01941227912902832
local_output_nid generation:  0.011616945266723633
local_in_edges_tensor generation:  0.025020837783813477
mini_batch_src_global generation:  0.03812766075134277
r_  generation:  0.35469579696655273
local_output_nid generation:  0.01815509796142578
local_in_edges_tensor generation:  0.022117137908935547
mini_batch_src_global generation:  0.04540824890136719
r_  generation:  0.3728764057159424
local_output_nid generation:  0.018662452697753906
local_in_edges_tensor generation:  0.019663572311401367
mini_batch_src_global generation:  0.04512429237365723
r_  generation:  0.3758096694946289
local_output_nid generation:  0.018755674362182617
local_in_edges_tensor generation:  0.021631479263305664
mini_batch_src_global generation:  0.045070648193359375
r_  generation:  0.3797035217285156
local_output_nid generation:  0.019191265106201172
local_in_edges_tensor generation:  0.020090818405151367
mini_batch_src_global generation:  0.04684185981750488
r_  generation:  0.379469633102417
local_output_nid generation:  0.01929450035095215
local_in_edges_tensor generation:  0.021982669830322266
mini_batch_src_global generation:  0.046033382415771484
r_  generation:  0.37847208976745605
local_output_nid generation:  0.018702030181884766
local_in_edges_tensor generation:  0.0206143856048584
mini_batch_src_global generation:  0.04748702049255371
r_  generation:  0.3886072635650635
local_output_nid generation:  0.018374204635620117
local_in_edges_tensor generation:  0.020701169967651367
mini_batch_src_global generation:  0.04588150978088379
r_  generation:  0.37989354133605957
----------------------check_connections_block total spend ----------------------------- 4.334740400314331
generate_one_block  0.48291754722595215
generate_one_block  0.4911324977874756
generate_one_block  0.4890751838684082
generate_one_block  0.49634432792663574
generate_one_block  0.4905362129211426
generate_one_block  0.4860973358154297
generate_one_block  0.49639320373535156
generate_one_block  0.5071494579315186
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.033399105072021484
gen group dst list time:  0.03943920135498047
time for parepare:  0.018355846405029297
local_output_nid generation:  0.027572154998779297
local_in_edges_tensor generation:  0.038421630859375
mini_batch_src_global generation:  0.0511019229888916
r_  generation:  0.5474884510040283
local_output_nid generation:  0.03307318687438965
local_in_edges_tensor generation:  0.03827714920043945
mini_batch_src_global generation:  0.06350564956665039
r_  generation:  0.5486414432525635
local_output_nid generation:  0.03407478332519531
local_in_edges_tensor generation:  0.03529047966003418
mini_batch_src_global generation:  0.06345510482788086
r_  generation:  0.5597949028015137
local_output_nid generation:  0.03438115119934082
local_in_edges_tensor generation:  0.0334627628326416
mini_batch_src_global generation:  0.05975651741027832
r_  generation:  0.5642974376678467
local_output_nid generation:  0.03437232971191406
local_in_edges_tensor generation:  0.03344297409057617
mini_batch_src_global generation:  0.061536312103271484
r_  generation:  0.5648345947265625
local_output_nid generation:  0.03449273109436035
local_in_edges_tensor generation:  0.03449511528015137
mini_batch_src_global generation:  0.06109929084777832
r_  generation:  0.5701608657836914
local_output_nid generation:  0.03478693962097168
local_in_edges_tensor generation:  0.0343630313873291
mini_batch_src_global generation:  0.06357693672180176
r_  generation:  0.5728456974029541
local_output_nid generation:  0.03499960899353027
local_in_edges_tensor generation:  0.03390145301818848
mini_batch_src_global generation:  0.06232309341430664
r_  generation:  0.5763471126556396
----------------------check_connections_block total spend ----------------------------- 6.539384365081787
generate_one_block  0.703993558883667
generate_one_block  0.7083859443664551
generate_one_block  0.7002606391906738
generate_one_block  0.7108638286590576
generate_one_block  0.7026870250701904
generate_one_block  0.699474573135376
generate_one_block  0.7062163352966309
generate_one_block  0.6981556415557861
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14133548736572266  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

connection checking time:  10.874124765396118
block generation total time  9.569683313369751
average batch blocks generation time:  1.1962104141712189
block dataloader generation time/epoch 22.478335791163975
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10705423355102539  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9532985687255859  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10673093795776367  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9551792144775391  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10689735412597656  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9539451599121094  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10638713836669922  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9556870460510254  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10682106018066406  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9520835876464844  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10623598098754883  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9538211822509766  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10734128952026367  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9602603912353516  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10579919815063477  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9506978988647461  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08532577753067017 |0.013511866331100464 |0.0034730732440948486 |8.878111839294434e-05 |0.003801316022872925 |0.0015869140625 |
----------------------------------------------------------pseudo_mini_loss sum 1.2355960607528687
Total (block generation + training)time/epoch 23.39759177631802
Training time/epoch 0.9263982772827148
Training time without block to device /epoch 0.8183033466339111
Training time without total dataloading part /epoch 0.06049227714538574
load block tensor time/epoch 0.6826062202453613
block to device time/epoch 0.10809493064880371
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 27 |
Number of nodes for computation during this epoch:  3057620
Number of first layer input nodes during this epoch:  1301090
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1409149169921875  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02207660675048828
range selection method range initialization spend 0.013520479202270508
time for parepare:  0.01680922508239746
local_output_nid generation:  0.0027878284454345703
local_in_edges_tensor generation:  0.004069328308105469
mini_batch_src_global generation:  0.0033164024353027344
r_  generation:  0.04504251480102539
local_output_nid generation:  0.0032117366790771484
local_in_edges_tensor generation:  0.0018002986907958984
mini_batch_src_global generation:  0.00487971305847168
r_  generation:  0.043622732162475586
local_output_nid generation:  0.0032546520233154297
local_in_edges_tensor generation:  0.0017695426940917969
mini_batch_src_global generation:  0.0034868717193603516
r_  generation:  0.046378374099731445
local_output_nid generation:  0.003240823745727539
local_in_edges_tensor generation:  0.0018038749694824219
mini_batch_src_global generation:  0.0035424232482910156
r_  generation:  0.04775810241699219
local_output_nid generation:  0.003269195556640625
local_in_edges_tensor generation:  0.00183868408203125
mini_batch_src_global generation:  0.003834247589111328
r_  generation:  0.047945499420166016
local_output_nid generation:  0.0032842159271240234
local_in_edges_tensor generation:  0.0017895698547363281
mini_batch_src_global generation:  0.003810405731201172
r_  generation:  0.04834461212158203
local_output_nid generation:  0.0032744407653808594
local_in_edges_tensor generation:  0.001821279525756836
mini_batch_src_global generation:  0.003956317901611328
r_  generation:  0.04862236976623535
local_output_nid generation:  0.0032541751861572266
local_in_edges_tensor generation:  0.001874685287475586
mini_batch_src_global generation:  0.003803730010986328
r_  generation:  0.047186851501464844
----------------------check_connections_block total spend ----------------------------- 0.5455574989318848
generate_one_block  0.060276031494140625
generate_one_block  0.059861183166503906
generate_one_block  0.06146883964538574
generate_one_block  0.06206798553466797
generate_one_block  0.06145024299621582
generate_one_block  0.06203460693359375
generate_one_block  0.06484699249267578
generate_one_block  0.06080126762390137
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.032323360443115234
gen group dst list time:  0.015288591384887695
time for parepare:  0.020642995834350586
local_output_nid generation:  0.012010812759399414
local_in_edges_tensor generation:  0.023539304733276367
mini_batch_src_global generation:  0.03813958168029785
r_  generation:  0.3642697334289551
local_output_nid generation:  0.01784825325012207
local_in_edges_tensor generation:  0.02011847496032715
mini_batch_src_global generation:  0.04461073875427246
r_  generation:  0.37860941886901855
local_output_nid generation:  0.020816802978515625
local_in_edges_tensor generation:  0.029741764068603516
mini_batch_src_global generation:  0.04533076286315918
r_  generation:  0.3954460620880127
local_output_nid generation:  0.019230127334594727
local_in_edges_tensor generation:  0.029703140258789062
mini_batch_src_global generation:  0.046259164810180664
r_  generation:  0.4005746841430664
local_output_nid generation:  0.021176815032958984
local_in_edges_tensor generation:  0.023091554641723633
mini_batch_src_global generation:  0.04804730415344238
r_  generation:  0.38585400581359863
local_output_nid generation:  0.0203096866607666
local_in_edges_tensor generation:  0.019581317901611328
mini_batch_src_global generation:  0.04716372489929199
r_  generation:  0.38924288749694824
local_output_nid generation:  0.01940441131591797
local_in_edges_tensor generation:  0.02306842803955078
mini_batch_src_global generation:  0.04798078536987305
r_  generation:  0.38605260848999023
local_output_nid generation:  0.018598556518554688
local_in_edges_tensor generation:  0.023854494094848633
mini_batch_src_global generation:  0.046599388122558594
r_  generation:  0.3778228759765625
----------------------check_connections_block total spend ----------------------------- 4.4599995613098145
generate_one_block  0.5072464942932129
generate_one_block  0.4858205318450928
generate_one_block  0.49584388732910156
generate_one_block  0.5022616386413574
generate_one_block  0.4957718849182129
generate_one_block  0.5007009506225586
generate_one_block  0.5026373863220215
generate_one_block  0.5239384174346924
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0416264533996582
gen group dst list time:  0.04064631462097168
time for parepare:  0.02139878273010254
local_output_nid generation:  0.030086278915405273
local_in_edges_tensor generation:  0.05249309539794922
mini_batch_src_global generation:  0.05540895462036133
r_  generation:  0.5491845607757568
local_output_nid generation:  0.03567957878112793
local_in_edges_tensor generation:  0.044094085693359375
mini_batch_src_global generation:  0.06772756576538086
r_  generation:  0.5707731246948242
local_output_nid generation:  0.0369565486907959
local_in_edges_tensor generation:  0.03790473937988281
mini_batch_src_global generation:  0.061875343322753906
r_  generation:  0.5644824504852295
local_output_nid generation:  0.036620140075683594
local_in_edges_tensor generation:  0.0356447696685791
mini_batch_src_global generation:  0.06396722793579102
r_  generation:  0.5641860961914062
local_output_nid generation:  0.03666210174560547
local_in_edges_tensor generation:  0.03984189033508301
mini_batch_src_global generation:  0.060516357421875
r_  generation:  0.5702807903289795
local_output_nid generation:  0.03689861297607422
local_in_edges_tensor generation:  0.037793874740600586
mini_batch_src_global generation:  0.06462502479553223
r_  generation:  0.5684261322021484
local_output_nid generation:  0.036721229553222656
local_in_edges_tensor generation:  0.03546428680419922
mini_batch_src_global generation:  0.07303643226623535
r_  generation:  0.574655294418335
local_output_nid generation:  0.03660106658935547
local_in_edges_tensor generation:  0.0407559871673584
mini_batch_src_global generation:  0.06503438949584961
r_  generation:  0.5730915069580078
----------------------check_connections_block total spend ----------------------------- 6.692344427108765
generate_one_block  0.7289736270904541
generate_one_block  0.7160160541534424
generate_one_block  0.7215313911437988
generate_one_block  0.7234854698181152
generate_one_block  0.734478235244751
generate_one_block  0.7166683673858643
generate_one_block  0.7170464992523193
generate_one_block  0.7192230224609375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1409149169921875  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

connection checking time:  11.152343988418579
block generation total time  9.791643857955933
average batch blocks generation time:  1.2239554822444916
block dataloader generation time/epoch 22.505916532717254
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10739421844482422  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9569802284240723  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1057281494140625  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.947413444519043  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10746908187866211  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9530725479125977  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10652732849121094  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9582147598266602  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10645341873168945  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9549236297607422  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10634851455688477  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9548578262329102  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10715961456298828  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9561295509338379  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10568428039550781  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9533653259277344  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08468747138977051 |0.018149614334106445 |0.0035926103591918945 |9.059906005859375e-05 |0.003146260976791382 |0.0016255378723144531 |
----------------------------------------------------------pseudo_mini_loss sum 1.22465980052948
Total (block generation + training)time/epoch 23.427076327173335
Training time/epoch 0.9551560878753662
Training time without block to device /epoch 0.8099591732025146
Training time without total dataloading part /epoch 0.056261301040649414
load block tensor time/epoch 0.6774997711181641
block to device time/epoch 0.14519691467285156
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 28 |
Number of nodes for computation during this epoch:  3058553
Number of first layer input nodes during this epoch:  1301132
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14039325714111328  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023545503616333008
range selection method range initialization spend 0.011801719665527344
time for parepare:  0.016612768173217773
local_output_nid generation:  0.0027856826782226562
local_in_edges_tensor generation:  0.008702993392944336
mini_batch_src_global generation:  0.0034263134002685547
r_  generation:  0.045133352279663086
local_output_nid generation:  0.0031735897064208984
local_in_edges_tensor generation:  0.0019185543060302734
mini_batch_src_global generation:  0.005018472671508789
r_  generation:  0.04423260688781738
local_output_nid generation:  0.003221273422241211
local_in_edges_tensor generation:  0.0019922256469726562
mini_batch_src_global generation:  0.003413677215576172
r_  generation:  0.04674887657165527
local_output_nid generation:  0.003256559371948242
local_in_edges_tensor generation:  0.0018842220306396484
mini_batch_src_global generation:  0.0034546852111816406
r_  generation:  0.04718613624572754
local_output_nid generation:  0.003206491470336914
local_in_edges_tensor generation:  0.0018944740295410156
mini_batch_src_global generation:  0.0037431716918945312
r_  generation:  0.04967617988586426
local_output_nid generation:  0.003210306167602539
local_in_edges_tensor generation:  0.0019071102142333984
mini_batch_src_global generation:  0.0038156509399414062
r_  generation:  0.048026084899902344
local_output_nid generation:  0.0032806396484375
local_in_edges_tensor generation:  0.0018322467803955078
mini_batch_src_global generation:  0.003946542739868164
r_  generation:  0.04881739616394043
local_output_nid generation:  0.0032067298889160156
local_in_edges_tensor generation:  0.0018804073333740234
mini_batch_src_global generation:  0.0038290023803710938
r_  generation:  0.04997134208679199
----------------------check_connections_block total spend ----------------------------- 0.558135986328125
generate_one_block  0.06470727920532227
generate_one_block  0.06113839149475098
generate_one_block  0.06006765365600586
generate_one_block  0.061444759368896484
generate_one_block  0.062273502349853516
generate_one_block  0.06198000907897949
generate_one_block  0.06559038162231445
generate_one_block  0.06216263771057129
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03737521171569824
gen group dst list time:  0.015309810638427734
time for parepare:  0.01943063735961914
local_output_nid generation:  0.011793136596679688
local_in_edges_tensor generation:  0.026258468627929688
mini_batch_src_global generation:  0.037139892578125
r_  generation:  0.3655869960784912
local_output_nid generation:  0.017807483673095703
local_in_edges_tensor generation:  0.021552085876464844
mini_batch_src_global generation:  0.04605364799499512
r_  generation:  0.37270355224609375
local_output_nid generation:  0.018169403076171875
local_in_edges_tensor generation:  0.01914525032043457
mini_batch_src_global generation:  0.044403791427612305
r_  generation:  0.37029123306274414
local_output_nid generation:  0.018590450286865234
local_in_edges_tensor generation:  0.02277350425720215
mini_batch_src_global generation:  0.04517507553100586
r_  generation:  0.3844029903411865
local_output_nid generation:  0.01955437660217285
local_in_edges_tensor generation:  0.021025657653808594
mini_batch_src_global generation:  0.049513816833496094
r_  generation:  0.39551806449890137
local_output_nid generation:  0.02048206329345703
local_in_edges_tensor generation:  0.0199887752532959
mini_batch_src_global generation:  0.05048084259033203
r_  generation:  0.3946394920349121
local_output_nid generation:  0.018570899963378906
local_in_edges_tensor generation:  0.039290666580200195
mini_batch_src_global generation:  0.05990171432495117
r_  generation:  0.3890502452850342
local_output_nid generation:  0.02004265785217285
local_in_edges_tensor generation:  0.02396416664123535
mini_batch_src_global generation:  0.049579620361328125
r_  generation:  0.3835132122039795
----------------------check_connections_block total spend ----------------------------- 4.446428537368774
generate_one_block  0.5068435668945312
generate_one_block  0.48992252349853516
generate_one_block  0.4916086196899414
generate_one_block  0.49344658851623535
generate_one_block  0.4967491626739502
generate_one_block  0.5074641704559326
generate_one_block  0.508042573928833
generate_one_block  0.5388526916503906
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04707789421081543
gen group dst list time:  0.04495382308959961
time for parepare:  0.0219268798828125
local_output_nid generation:  0.0276796817779541
local_in_edges_tensor generation:  0.052275657653808594
mini_batch_src_global generation:  0.055434465408325195
r_  generation:  0.5459825992584229
local_output_nid generation:  0.03381991386413574
local_in_edges_tensor generation:  0.0449831485748291
mini_batch_src_global generation:  0.06412744522094727
r_  generation:  0.5518202781677246
local_output_nid generation:  0.0346677303314209
local_in_edges_tensor generation:  0.038513898849487305
mini_batch_src_global generation:  0.06197357177734375
r_  generation:  0.5584135055541992
local_output_nid generation:  0.034882307052612305
local_in_edges_tensor generation:  0.037795066833496094
mini_batch_src_global generation:  0.06300020217895508
r_  generation:  0.5771055221557617
local_output_nid generation:  0.03522062301635742
local_in_edges_tensor generation:  0.04137778282165527
mini_batch_src_global generation:  0.06255388259887695
r_  generation:  0.5764532089233398
local_output_nid generation:  0.03599953651428223
local_in_edges_tensor generation:  0.0430150032043457
mini_batch_src_global generation:  0.09057259559631348
r_  generation:  0.5976581573486328
local_output_nid generation:  0.039936065673828125
local_in_edges_tensor generation:  0.04720497131347656
mini_batch_src_global generation:  0.07392644882202148
r_  generation:  0.571681022644043
local_output_nid generation:  0.036100149154663086
local_in_edges_tensor generation:  0.04459524154663086
mini_batch_src_global generation:  0.06572985649108887
r_  generation:  0.5697076320648193
----------------------check_connections_block total spend ----------------------------- 6.750413417816162
generate_one_block  0.7157847881317139
generate_one_block  0.7313897609710693
generate_one_block  0.7256596088409424
generate_one_block  0.7250945568084717
generate_one_block  0.7409098148345947
generate_one_block  0.7166934013366699
generate_one_block  0.7140095233917236
generate_one_block  0.7149555683135986
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14039325714111328  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

connection checking time:  11.196841955184937
block generation total time  9.817426919937134
average batch blocks generation time:  1.2271783649921417
block dataloader generation time/epoch 22.5376034617424
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10707902908325195  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.957916259765625  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10582733154296875  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9532599449157715  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10669565200805664  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.948214054107666  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10633611679077148  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9549970626831055  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10715961456298828  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9556550979614258  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1064920425415039  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9543333053588867  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1072230339050293  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9564032554626465  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10629892349243164  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9554200172424316  GigaBytes
Max Memory Allocated: 1.1063289642333984  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08713048696517944 |0.020103126764297485 |0.0035583972930908203 |9.15825366973877e-05 |0.003806859254837036 |0.001363515853881836 |
----------------------------------------------------------pseudo_mini_loss sum 1.2134603261947632
Total (block generation + training)time/epoch 23.46263505220413
Training time/epoch 0.9983203411102295
Training time without block to device /epoch 0.8374953269958496
Training time without total dataloading part /epoch 0.06101822853088379
load block tensor time/epoch 0.6970438957214355
block to device time/epoch 0.16082501411437988
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 29 |
Number of nodes for computation during this epoch:  3058333
Number of first layer input nodes during this epoch:  1301027
