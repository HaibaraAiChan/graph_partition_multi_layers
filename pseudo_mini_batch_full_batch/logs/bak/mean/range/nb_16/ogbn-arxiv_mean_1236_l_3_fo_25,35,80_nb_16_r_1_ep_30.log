Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1647771875.517467
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027052879333496094
range selection method range initialization spend 0.013071060180664062
time for parepare:  0.017766952514648438
local_output_nid generation:  0.001352548599243164
local_in_edges_tensor generation:  0.0041828155517578125
mini_batch_src_global generation:  0.0018854141235351562
r_  generation:  0.019173622131347656
local_output_nid generation:  0.0013856887817382812
local_in_edges_tensor generation:  0.0009367465972900391
mini_batch_src_global generation:  0.002391815185546875
r_  generation:  0.02000594139099121
local_output_nid generation:  0.001453399658203125
local_in_edges_tensor generation:  0.0009050369262695312
mini_batch_src_global generation:  0.0015451908111572266
r_  generation:  0.01881551742553711
local_output_nid generation:  0.0014910697937011719
local_in_edges_tensor generation:  0.0008714199066162109
mini_batch_src_global generation:  0.0014655590057373047
r_  generation:  0.01969599723815918
local_output_nid generation:  0.0014801025390625
local_in_edges_tensor generation:  0.0008685588836669922
mini_batch_src_global generation:  0.0015628337860107422
r_  generation:  0.020025253295898438
local_output_nid generation:  0.0014865398406982422
local_in_edges_tensor generation:  0.0008747577667236328
mini_batch_src_global generation:  0.0014638900756835938
r_  generation:  0.020021438598632812
local_output_nid generation:  0.0014829635620117188
local_in_edges_tensor generation:  0.0008814334869384766
mini_batch_src_global generation:  0.0015769004821777344
r_  generation:  0.02052760124206543
local_output_nid generation:  0.0014748573303222656
local_in_edges_tensor generation:  0.000873565673828125
mini_batch_src_global generation:  0.0015261173248291016
r_  generation:  0.019530296325683594
local_output_nid generation:  0.0014836788177490234
local_in_edges_tensor generation:  0.0008709430694580078
mini_batch_src_global generation:  0.0015447139739990234
r_  generation:  0.020751953125
local_output_nid generation:  0.0015289783477783203
local_in_edges_tensor generation:  0.00086212158203125
mini_batch_src_global generation:  0.001611948013305664
r_  generation:  0.020252704620361328
local_output_nid generation:  0.0014917850494384766
local_in_edges_tensor generation:  0.0008502006530761719
mini_batch_src_global generation:  0.0016968250274658203
r_  generation:  0.021027326583862305
local_output_nid generation:  0.0015254020690917969
local_in_edges_tensor generation:  0.0008466243743896484
mini_batch_src_global generation:  0.0016682147979736328
r_  generation:  0.02104330062866211
local_output_nid generation:  0.0014595985412597656
local_in_edges_tensor generation:  0.0008709430694580078
mini_batch_src_global generation:  0.0015647411346435547
r_  generation:  0.020809173583984375
local_output_nid generation:  0.0014634132385253906
local_in_edges_tensor generation:  0.0008590221405029297
mini_batch_src_global generation:  0.0016591548919677734
r_  generation:  0.020730018615722656
local_output_nid generation:  0.001466989517211914
local_in_edges_tensor generation:  0.00086212158203125
mini_batch_src_global generation:  0.0016679763793945312
r_  generation:  0.0212252140045166
local_output_nid generation:  0.0015501976013183594
local_in_edges_tensor generation:  0.0009207725524902344
mini_batch_src_global generation:  0.0017390251159667969
r_  generation:  0.02116537094116211
----------------------check_connections_block total spend ----------------------------- 0.48221588134765625
generate_one_block  0.029890060424804688
generate_one_block  0.03129076957702637
generate_one_block  0.031281232833862305
generate_one_block  0.030730009078979492
generate_one_block  0.03037405014038086
generate_one_block  0.030930519104003906
generate_one_block  0.0313112735748291
generate_one_block  0.029744625091552734
generate_one_block  0.03090691566467285
generate_one_block  0.030517101287841797
generate_one_block  0.031025409698486328
generate_one_block  0.03177952766418457
generate_one_block  0.03136467933654785
generate_one_block  0.030619382858276367
generate_one_block  0.031245708465576172
generate_one_block  0.031838417053222656
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03949570655822754
gen group dst list time:  0.020441293716430664
time for parepare:  0.01934361457824707
local_output_nid generation:  0.007467031478881836
local_in_edges_tensor generation:  0.019861936569213867
mini_batch_src_global generation:  0.021314620971679688
r_  generation:  0.2114095687866211
local_output_nid generation:  0.011283159255981445
local_in_edges_tensor generation:  0.021833419799804688
mini_batch_src_global generation:  0.029118776321411133
r_  generation:  0.22568392753601074
local_output_nid generation:  0.011277198791503906
local_in_edges_tensor generation:  0.01755499839782715
mini_batch_src_global generation:  0.025719165802001953
r_  generation:  0.2169957160949707
local_output_nid generation:  0.011616945266723633
local_in_edges_tensor generation:  0.015569686889648438
mini_batch_src_global generation:  0.028595447540283203
r_  generation:  0.22716927528381348
local_output_nid generation:  0.012057781219482422
local_in_edges_tensor generation:  0.01624011993408203
mini_batch_src_global generation:  0.029578447341918945
r_  generation:  0.22579693794250488
local_output_nid generation:  0.01212620735168457
local_in_edges_tensor generation:  0.016193389892578125
mini_batch_src_global generation:  0.029093265533447266
r_  generation:  0.2310631275177002
local_output_nid generation:  0.012306928634643555
local_in_edges_tensor generation:  0.021793603897094727
mini_batch_src_global generation:  0.029003143310546875
r_  generation:  0.23431134223937988
local_output_nid generation:  0.012129068374633789
local_in_edges_tensor generation:  0.01404881477355957
mini_batch_src_global generation:  0.02911067008972168
r_  generation:  0.22538042068481445
local_output_nid generation:  0.01216268539428711
local_in_edges_tensor generation:  0.016276121139526367
mini_batch_src_global generation:  0.028960227966308594
r_  generation:  0.23228788375854492
local_output_nid generation:  0.012340784072875977
local_in_edges_tensor generation:  0.018291950225830078
mini_batch_src_global generation:  0.028241634368896484
r_  generation:  0.226823091506958
local_output_nid generation:  0.012367963790893555
local_in_edges_tensor generation:  0.01870584487915039
mini_batch_src_global generation:  0.028748035430908203
r_  generation:  0.23260021209716797
local_output_nid generation:  0.012575387954711914
local_in_edges_tensor generation:  0.021393299102783203
mini_batch_src_global generation:  0.030023813247680664
r_  generation:  0.23711681365966797
local_output_nid generation:  0.012441873550415039
local_in_edges_tensor generation:  0.01919698715209961
mini_batch_src_global generation:  0.02937769889831543
r_  generation:  0.23307037353515625
local_output_nid generation:  0.012352705001831055
local_in_edges_tensor generation:  0.014961481094360352
mini_batch_src_global generation:  0.029784679412841797
r_  generation:  0.2309415340423584
local_output_nid generation:  0.01578688621520996
local_in_edges_tensor generation:  0.01659536361694336
mini_batch_src_global generation:  0.029510498046875
r_  generation:  0.2341289520263672
local_output_nid generation:  0.012514829635620117
local_in_edges_tensor generation:  0.020534276962280273
mini_batch_src_global generation:  0.030097484588623047
r_  generation:  0.23500919342041016
----------------------check_connections_block total spend ----------------------------- 5.431551933288574
generate_one_block  0.304915189743042
generate_one_block  0.30957913398742676
generate_one_block  0.2907369136810303
generate_one_block  0.29640698432922363
generate_one_block  0.31519508361816406
generate_one_block  0.30121660232543945
generate_one_block  0.31612706184387207
generate_one_block  0.29119396209716797
generate_one_block  0.2979252338409424
generate_one_block  0.29982519149780273
generate_one_block  0.3053007125854492
generate_one_block  0.30942368507385254
generate_one_block  0.30834150314331055
generate_one_block  0.2973015308380127
generate_one_block  0.310133695602417
generate_one_block  0.3125789165496826
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0386505126953125
gen group dst list time:  0.062018632888793945
time for parepare:  0.01880812644958496
local_output_nid generation:  0.024550199508666992
local_in_edges_tensor generation:  0.03510880470275879
mini_batch_src_global generation:  0.04404902458190918
r_  generation:  0.444077730178833
local_output_nid generation:  0.030580759048461914
local_in_edges_tensor generation:  0.05136752128601074
mini_batch_src_global generation:  0.053685665130615234
r_  generation:  0.4416525363922119
local_output_nid generation:  0.0308535099029541
local_in_edges_tensor generation:  0.03490495681762695
mini_batch_src_global generation:  0.05091714859008789
r_  generation:  0.4503939151763916
local_output_nid generation:  0.031372785568237305
local_in_edges_tensor generation:  0.03451704978942871
mini_batch_src_global generation:  0.05179643630981445
r_  generation:  0.45860815048217773
local_output_nid generation:  0.030771255493164062
local_in_edges_tensor generation:  0.04642653465270996
mini_batch_src_global generation:  0.05892300605773926
r_  generation:  0.47005248069763184
local_output_nid generation:  0.033417701721191406
local_in_edges_tensor generation:  0.03234076499938965
mini_batch_src_global generation:  0.05477404594421387
r_  generation:  0.4493691921234131
local_output_nid generation:  0.03154277801513672
local_in_edges_tensor generation:  0.03183341026306152
mini_batch_src_global generation:  0.05262160301208496
r_  generation:  0.4582788944244385
local_output_nid generation:  0.03156232833862305
local_in_edges_tensor generation:  0.03273129463195801
mini_batch_src_global generation:  0.05347728729248047
r_  generation:  0.4544212818145752
local_output_nid generation:  0.03133201599121094
local_in_edges_tensor generation:  0.028980255126953125
mini_batch_src_global generation:  0.05283641815185547
r_  generation:  0.4573795795440674
local_output_nid generation:  0.03151845932006836
local_in_edges_tensor generation:  0.03243660926818848
mini_batch_src_global generation:  0.05617213249206543
r_  generation:  0.45371270179748535
local_output_nid generation:  0.03133344650268555
local_in_edges_tensor generation:  0.04063534736633301
mini_batch_src_global generation:  0.05239105224609375
r_  generation:  0.46005773544311523
local_output_nid generation:  0.031453609466552734
local_in_edges_tensor generation:  0.0474848747253418
mini_batch_src_global generation:  0.05628371238708496
r_  generation:  0.4580514430999756
local_output_nid generation:  0.03131222724914551
local_in_edges_tensor generation:  0.028761625289916992
mini_batch_src_global generation:  0.05228471755981445
r_  generation:  0.46897435188293457
local_output_nid generation:  0.031690120697021484
local_in_edges_tensor generation:  0.028146028518676758
mini_batch_src_global generation:  0.053917646408081055
r_  generation:  0.4524495601654053
local_output_nid generation:  0.031533002853393555
local_in_edges_tensor generation:  0.033240556716918945
mini_batch_src_global generation:  0.05218982696533203
r_  generation:  0.4647178649902344
local_output_nid generation:  0.031786203384399414
local_in_edges_tensor generation:  0.04393267631530762
mini_batch_src_global generation:  0.053110361099243164
r_  generation:  0.45710134506225586
----------------------check_connections_block total spend ----------------------------- 10.840569972991943
generate_one_block  0.587568998336792
generate_one_block  0.5872809886932373
generate_one_block  0.5753567218780518
generate_one_block  0.6039950847625732
generate_one_block  0.5947401523590088
generate_one_block  0.5746967792510986
generate_one_block  0.6410038471221924
generate_one_block  0.5743129253387451
generate_one_block  0.5753839015960693
generate_one_block  0.6081130504608154
generate_one_block  0.588200569152832
generate_one_block  0.5843462944030762
generate_one_block  0.5676181316375732
generate_one_block  0.5737922191619873
generate_one_block  0.5758969783782959
generate_one_block  0.5862491130828857
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  16.272121906280518
block generation total time  14.26475715637207
average batch blocks generation time:  0.8915473222732544
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.09144258499145508  GigaBytes
Max Memory Allocated: 0.09144258499145508  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.7436251640319824  GigaBytes
Max Memory Allocated: 0.7849011421203613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4881591796875 GB
    Memory Allocated: 0.0929250717163086  GigaBytes
Max Memory Allocated: 0.8303813934326172  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4881591796875 GB
    Memory Allocated: 0.7481546401977539  GigaBytes
Max Memory Allocated: 0.8303813934326172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.09296131134033203  GigaBytes
Max Memory Allocated: 0.8371114730834961  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7384252548217773  GigaBytes
Max Memory Allocated: 0.8371114730834961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.09276103973388672  GigaBytes
Max Memory Allocated: 0.8371114730834961  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7415046691894531  GigaBytes
Max Memory Allocated: 0.8371114730834961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.0931081771850586  GigaBytes
Max Memory Allocated: 0.8371114730834961  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0916748046875 GB
    Memory Allocated: 0.7470612525939941  GigaBytes
Max Memory Allocated: 0.8371114730834961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2147216796875 GB
    Memory Allocated: 0.09277677536010742  GigaBytes
Max Memory Allocated: 0.8371114730834961  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2147216796875 GB
    Memory Allocated: 0.7431778907775879  GigaBytes
Max Memory Allocated: 0.8371114730834961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2147216796875 GB
    Memory Allocated: 0.09328174591064453  GigaBytes
Max Memory Allocated: 0.8371114730834961  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2147216796875 GB
    Memory Allocated: 0.7494974136352539  GigaBytes
Max Memory Allocated: 0.8371114730834961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2147216796875 GB
    Memory Allocated: 0.09252691268920898  GigaBytes
Max Memory Allocated: 0.8382472991943359  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2147216796875 GB
    Memory Allocated: 0.7388458251953125  GigaBytes
Max Memory Allocated: 0.8382472991943359  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2147216796875 GB
    Memory Allocated: 0.09305953979492188  GigaBytes
Max Memory Allocated: 0.8382472991943359  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2147216796875 GB
    Memory Allocated: 0.7419853210449219  GigaBytes
Max Memory Allocated: 0.8382472991943359  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2147216796875 GB
    Memory Allocated: 0.09286737442016602  GigaBytes
Max Memory Allocated: 0.8382472991943359  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2147216796875 GB
    Memory Allocated: 0.7421431541442871  GigaBytes
Max Memory Allocated: 0.8382472991943359  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2147216796875 GB
    Memory Allocated: 0.09313678741455078  GigaBytes
Max Memory Allocated: 0.8382472991943359  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2147216796875 GB
    Memory Allocated: 0.7425765991210938  GigaBytes
Max Memory Allocated: 0.8382472991943359  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2147216796875 GB
    Memory Allocated: 0.09280872344970703  GigaBytes
Max Memory Allocated: 0.8382472991943359  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2147216796875 GB
    Memory Allocated: 0.7457265853881836  GigaBytes
Max Memory Allocated: 0.8382472991943359  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2147216796875 GB
    Memory Allocated: 0.09314250946044922  GigaBytes
Max Memory Allocated: 0.8382472991943359  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2147216796875 GB
    Memory Allocated: 0.7423224449157715  GigaBytes
Max Memory Allocated: 0.8382472991943359  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2147216796875 GB
    Memory Allocated: 0.09278249740600586  GigaBytes
Max Memory Allocated: 0.8382472991943359  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2147216796875 GB
    Memory Allocated: 0.7420692443847656  GigaBytes
Max Memory Allocated: 0.8382472991943359  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2147216796875 GB
    Memory Allocated: 0.0931386947631836  GigaBytes
Max Memory Allocated: 0.8382472991943359  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2147216796875 GB
    Memory Allocated: 0.743842601776123  GigaBytes
Max Memory Allocated: 0.8382472991943359  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2147216796875 GB
    Memory Allocated: 0.09282684326171875  GigaBytes
Max Memory Allocated: 0.8382472991943359  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2147216796875 GB
    Memory Allocated: 0.7429962158203125  GigaBytes
Max Memory Allocated: 0.8382472991943359  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06221906840801239 |0.03138481080532074 |0.04817752540111542 |9.271502494812012e-05 |0.007145136594772339 |0.004297971725463867 |
----------------------------------------------------------pseudo_mini_loss sum 6.27772331237793
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5207179
Number of first layer input nodes during this epoch:  2480061
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.2166748046875 GB
    Memory Allocated: 0.11800909042358398  GigaBytes
Max Memory Allocated: 0.8382472991943359  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022099018096923828
range selection method range initialization spend 0.01524806022644043
time for parepare:  0.016251087188720703
local_output_nid generation:  0.0013713836669921875
local_in_edges_tensor generation:  0.00540924072265625
mini_batch_src_global generation:  0.002427816390991211
r_  generation:  0.019904136657714844
local_output_nid generation:  0.0015292167663574219
local_in_edges_tensor generation:  0.0009884834289550781
mini_batch_src_global generation:  0.002355813980102539
r_  generation:  0.021396398544311523
local_output_nid generation:  0.0015647411346435547
local_in_edges_tensor generation:  0.0008900165557861328
mini_batch_src_global generation:  0.0015726089477539062
r_  generation:  0.02136540412902832
local_output_nid generation:  0.0015120506286621094
local_in_edges_tensor generation:  0.0008990764617919922
mini_batch_src_global generation:  0.001544952392578125
r_  generation:  0.020537614822387695
local_output_nid generation:  0.0015215873718261719
local_in_edges_tensor generation:  0.0008871555328369141
mini_batch_src_global generation:  0.0015573501586914062
r_  generation:  0.02098536491394043
local_output_nid generation:  0.0015425682067871094
local_in_edges_tensor generation:  0.0008494853973388672
mini_batch_src_global generation:  0.0016074180603027344
r_  generation:  0.02134227752685547
local_output_nid generation:  0.0015439987182617188
local_in_edges_tensor generation:  0.0008869171142578125
mini_batch_src_global generation:  0.0016283988952636719
r_  generation:  0.022032499313354492
local_output_nid generation:  0.0015552043914794922
local_in_edges_tensor generation:  0.0008807182312011719
mini_batch_src_global generation:  0.0016231536865234375
r_  generation:  0.021162986755371094
local_output_nid generation:  0.0015769004821777344
local_in_edges_tensor generation:  0.0008804798126220703
mini_batch_src_global generation:  0.0015892982482910156
r_  generation:  0.021486759185791016
local_output_nid generation:  0.001583099365234375
local_in_edges_tensor generation:  0.0008878707885742188
mini_batch_src_global generation:  0.001667022705078125
r_  generation:  0.02221369743347168
local_output_nid generation:  0.0015769004821777344
local_in_edges_tensor generation:  0.0009202957153320312
mini_batch_src_global generation:  0.0016734600067138672
r_  generation:  0.021690845489501953
local_output_nid generation:  0.0015628337860107422
local_in_edges_tensor generation:  0.0009000301361083984
mini_batch_src_global generation:  0.0016949176788330078
r_  generation:  0.022043704986572266
local_output_nid generation:  0.0015535354614257812
local_in_edges_tensor generation:  0.0008950233459472656
mini_batch_src_global generation:  0.0016982555389404297
r_  generation:  0.02222132682800293
local_output_nid generation:  0.001531839370727539
local_in_edges_tensor generation:  0.0009067058563232422
mini_batch_src_global generation:  0.0017342567443847656
r_  generation:  0.022363662719726562
local_output_nid generation:  0.0015375614166259766
local_in_edges_tensor generation:  0.0008597373962402344
mini_batch_src_global generation:  0.0017414093017578125
r_  generation:  0.022382020950317383
local_output_nid generation:  0.00152587890625
local_in_edges_tensor generation:  0.0009081363677978516
mini_batch_src_global generation:  0.0017201900482177734
r_  generation:  0.02203536033630371
----------------------check_connections_block total spend ----------------------------- 0.5103869438171387
generate_one_block  0.030368328094482422
generate_one_block  0.031908512115478516
generate_one_block  0.03195524215698242
generate_one_block  0.03085780143737793
generate_one_block  0.03091573715209961
generate_one_block  0.03594255447387695
generate_one_block  0.03148341178894043
generate_one_block  0.03000950813293457
generate_one_block  0.0336306095123291
generate_one_block  0.0317234992980957
generate_one_block  0.030524492263793945
generate_one_block  0.031629085540771484
generate_one_block  0.03205370903015137
generate_one_block  0.032305002212524414
generate_one_block  0.031256914138793945
generate_one_block  0.0316007137298584
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03743433952331543
gen group dst list time:  0.01934528350830078
time for parepare:  0.02597332000732422
local_output_nid generation:  0.007804155349731445
local_in_edges_tensor generation:  0.0257413387298584
mini_batch_src_global generation:  0.023891210556030273
r_  generation:  0.22742652893066406
local_output_nid generation:  0.013006210327148438
local_in_edges_tensor generation:  0.023138999938964844
mini_batch_src_global generation:  0.027503013610839844
r_  generation:  0.2221384048461914
local_output_nid generation:  0.012381553649902344
local_in_edges_tensor generation:  0.02301812171936035
mini_batch_src_global generation:  0.026717424392700195
r_  generation:  0.231156587600708
local_output_nid generation:  0.012906789779663086
local_in_edges_tensor generation:  0.015302896499633789
mini_batch_src_global generation:  0.027184247970581055
r_  generation:  0.23074722290039062
local_output_nid generation:  0.012756109237670898
local_in_edges_tensor generation:  0.01570749282836914
mini_batch_src_global generation:  0.02801227569580078
r_  generation:  0.2299175262451172
local_output_nid generation:  0.012659311294555664
local_in_edges_tensor generation:  0.017935752868652344
mini_batch_src_global generation:  0.04163384437561035
r_  generation:  0.23419690132141113
local_output_nid generation:  0.012633800506591797
local_in_edges_tensor generation:  0.014016389846801758
mini_batch_src_global generation:  0.02905750274658203
r_  generation:  0.23707342147827148
local_output_nid generation:  0.012295246124267578
local_in_edges_tensor generation:  0.017373085021972656
mini_batch_src_global generation:  0.02832174301147461
r_  generation:  0.22877240180969238
local_output_nid generation:  0.012788534164428711
local_in_edges_tensor generation:  0.018039464950561523
mini_batch_src_global generation:  0.028661012649536133
r_  generation:  0.24799013137817383
local_output_nid generation:  0.014678239822387695
local_in_edges_tensor generation:  0.0301821231842041
mini_batch_src_global generation:  0.030595779418945312
r_  generation:  0.24025821685791016
local_output_nid generation:  0.013155221939086914
local_in_edges_tensor generation:  0.016379356384277344
mini_batch_src_global generation:  0.028722524642944336
r_  generation:  0.22893905639648438
local_output_nid generation:  0.012761116027832031
local_in_edges_tensor generation:  0.018991708755493164
mini_batch_src_global generation:  0.031632184982299805
r_  generation:  0.2344369888305664
local_output_nid generation:  0.01308131217956543
local_in_edges_tensor generation:  0.020387649536132812
mini_batch_src_global generation:  0.02984476089477539
r_  generation:  0.2392745018005371
local_output_nid generation:  0.01284480094909668
local_in_edges_tensor generation:  0.014369726181030273
mini_batch_src_global generation:  0.029765605926513672
r_  generation:  0.24007678031921387
local_output_nid generation:  0.013005971908569336
local_in_edges_tensor generation:  0.018360376358032227
mini_batch_src_global generation:  0.029672622680664062
r_  generation:  0.2384657859802246
local_output_nid generation:  0.012941360473632812
local_in_edges_tensor generation:  0.014238595962524414
mini_batch_src_global generation:  0.03004312515258789
r_  generation:  0.23595809936523438
----------------------check_connections_block total spend ----------------------------- 5.5912394523620605
generate_one_block  0.3191077709197998
generate_one_block  0.30490875244140625
generate_one_block  0.31163477897644043
generate_one_block  0.30854058265686035
generate_one_block  0.3074338436126709
generate_one_block  0.3014187812805176
generate_one_block  0.33498430252075195
generate_one_block  0.2898545265197754
generate_one_block  0.29409337043762207
generate_one_block  0.31311511993408203
generate_one_block  0.295058012008667
generate_one_block  0.3050854206085205
generate_one_block  0.3173098564147949
generate_one_block  0.3121795654296875
generate_one_block  0.30642271041870117
generate_one_block  0.29631924629211426
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03457307815551758
gen group dst list time:  0.060956716537475586
time for parepare:  0.01773381233215332
local_output_nid generation:  0.026700973510742188
local_in_edges_tensor generation:  0.0536351203918457
mini_batch_src_global generation:  0.041893959045410156
r_  generation:  0.4432835578918457
local_output_nid generation:  0.028792381286621094
local_in_edges_tensor generation:  0.04710721969604492
mini_batch_src_global generation:  0.051197052001953125
r_  generation:  0.4469316005706787
local_output_nid generation:  0.029253482818603516
local_in_edges_tensor generation:  0.0354151725769043
mini_batch_src_global generation:  0.05018806457519531
r_  generation:  0.4564940929412842
local_output_nid generation:  0.029918432235717773
local_in_edges_tensor generation:  0.034766435623168945
mini_batch_src_global generation:  0.05214333534240723
r_  generation:  0.45470237731933594
local_output_nid generation:  0.030444622039794922
local_in_edges_tensor generation:  0.0764162540435791
mini_batch_src_global generation:  0.054433345794677734
r_  generation:  0.46103739738464355
local_output_nid generation:  0.030372142791748047
local_in_edges_tensor generation:  0.03185772895812988
mini_batch_src_global generation:  0.0528717041015625
r_  generation:  0.45348501205444336
local_output_nid generation:  0.03209972381591797
local_in_edges_tensor generation:  0.04343533515930176
mini_batch_src_global generation:  0.05286765098571777
r_  generation:  0.46039557456970215
local_output_nid generation:  0.031090259552001953
local_in_edges_tensor generation:  0.03504467010498047
mini_batch_src_global generation:  0.05263686180114746
r_  generation:  0.4553971290588379
local_output_nid generation:  0.03083348274230957
local_in_edges_tensor generation:  0.046091556549072266
mini_batch_src_global generation:  0.051142215728759766
r_  generation:  0.4711015224456787
local_output_nid generation:  0.03126835823059082
local_in_edges_tensor generation:  0.04743051528930664
mini_batch_src_global generation:  0.06514668464660645
r_  generation:  0.4611473083496094
local_output_nid generation:  0.03343915939331055
local_in_edges_tensor generation:  0.03718066215515137
mini_batch_src_global generation:  0.05162310600280762
r_  generation:  0.46146368980407715
local_output_nid generation:  0.03149247169494629
local_in_edges_tensor generation:  0.03471732139587402
mini_batch_src_global generation:  0.052342891693115234
r_  generation:  0.4581937789916992
local_output_nid generation:  0.03233504295349121
local_in_edges_tensor generation:  0.03567004203796387
mini_batch_src_global generation:  0.05220651626586914
r_  generation:  0.4642772674560547
local_output_nid generation:  0.03202939033508301
local_in_edges_tensor generation:  0.03615593910217285
mini_batch_src_global generation:  0.05307579040527344
r_  generation:  0.4627547264099121
local_output_nid generation:  0.032000064849853516
local_in_edges_tensor generation:  0.03144955635070801
mini_batch_src_global generation:  0.0696108341217041
r_  generation:  0.4686124324798584
local_output_nid generation:  0.03229784965515137
local_in_edges_tensor generation:  0.035408973693847656
mini_batch_src_global generation:  0.052987098693847656
r_  generation:  0.4600200653076172
----------------------check_connections_block total spend ----------------------------- 10.965075254440308
generate_one_block  0.588653564453125
generate_one_block  0.5960540771484375
generate_one_block  0.5773491859436035
generate_one_block  0.5855364799499512
generate_one_block  0.5928068161010742
generate_one_block  0.5847361087799072
generate_one_block  0.5931622982025146
generate_one_block  0.5789220333099365
generate_one_block  0.6328990459442139
generate_one_block  0.6059238910675049
generate_one_block  0.5739502906799316
generate_one_block  0.5767607688903809
generate_one_block  0.6006252765655518
generate_one_block  0.5955390930175781
generate_one_block  0.5860447883605957
generate_one_block  0.5877087116241455
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.2166748046875 GB
    Memory Allocated: 0.11800909042358398  GigaBytes
Max Memory Allocated: 0.8382472991943359  GigaBytes

connection checking time:  16.556314706802368
block generation total time  14.374139070510864
average batch blocks generation time:  0.898383691906929
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2166748046875 GB
    Memory Allocated: 0.09488058090209961  GigaBytes
Max Memory Allocated: 0.8382472991943359  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2166748046875 GB
    Memory Allocated: 0.7501111030578613  GigaBytes
Max Memory Allocated: 0.8382472991943359  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2166748046875 GB
    Memory Allocated: 0.09451436996459961  GigaBytes
Max Memory Allocated: 0.838841438293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7452592849731445  GigaBytes
Max Memory Allocated: 0.838841438293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09488391876220703  GigaBytes
Max Memory Allocated: 0.838841438293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.749016284942627  GigaBytes
Max Memory Allocated: 0.838841438293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09439229965209961  GigaBytes
Max Memory Allocated: 0.838841438293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7431578636169434  GigaBytes
Max Memory Allocated: 0.838841438293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09471607208251953  GigaBytes
Max Memory Allocated: 0.838841438293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7458901405334473  GigaBytes
Max Memory Allocated: 0.838841438293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09429407119750977  GigaBytes
Max Memory Allocated: 0.838841438293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7424912452697754  GigaBytes
Max Memory Allocated: 0.838841438293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09473800659179688  GigaBytes
Max Memory Allocated: 0.838841438293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7432842254638672  GigaBytes
Max Memory Allocated: 0.838841438293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0942845344543457  GigaBytes
Max Memory Allocated: 0.838841438293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7388653755187988  GigaBytes
Max Memory Allocated: 0.838841438293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09464836120605469  GigaBytes
Max Memory Allocated: 0.838841438293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7426137924194336  GigaBytes
Max Memory Allocated: 0.838841438293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09476757049560547  GigaBytes
Max Memory Allocated: 0.838841438293457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7537050247192383  GigaBytes
Max Memory Allocated: 0.838841438293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09456539154052734  GigaBytes
Max Memory Allocated: 0.8426589965820312  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7398180961608887  GigaBytes
Max Memory Allocated: 0.8426589965820312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09435081481933594  GigaBytes
Max Memory Allocated: 0.8426589965820312  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7458720207214355  GigaBytes
Max Memory Allocated: 0.8426589965820312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09492683410644531  GigaBytes
Max Memory Allocated: 0.8426589965820312  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7535281181335449  GigaBytes
Max Memory Allocated: 0.8426589965820312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09445619583129883  GigaBytes
Max Memory Allocated: 0.8426589965820312  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7449831962585449  GigaBytes
Max Memory Allocated: 0.8426589965820312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09482479095458984  GigaBytes
Max Memory Allocated: 0.8426589965820312  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7454285621643066  GigaBytes
Max Memory Allocated: 0.8426589965820312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09434890747070312  GigaBytes
Max Memory Allocated: 0.8426589965820312  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7425827980041504  GigaBytes
Max Memory Allocated: 0.8426589965820312  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06326596438884735 |0.014013916254043579 |0.003735944628715515 |9.065866470336914e-05 |0.005399256944656372 |0.0029718875885009766 |
----------------------------------------------------------pseudo_mini_loss sum 3.255972385406494
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5207622
Number of first layer input nodes during this epoch:  2479924
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11771440505981445  GigaBytes
Max Memory Allocated: 0.8426589965820312  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02496051788330078
range selection method range initialization spend 0.012614250183105469
time for parepare:  0.017075061798095703
local_output_nid generation:  0.0013897418975830078
local_in_edges_tensor generation:  0.006234407424926758
mini_batch_src_global generation:  0.0017888545989990234
r_  generation:  0.02174234390258789
local_output_nid generation:  0.001577615737915039
local_in_edges_tensor generation:  0.0009827613830566406
mini_batch_src_global generation:  0.0024573802947998047
r_  generation:  0.02163243293762207
local_output_nid generation:  0.001600027084350586
local_in_edges_tensor generation:  0.0009429454803466797
mini_batch_src_global generation:  0.0016107559204101562
r_  generation:  0.021291732788085938
local_output_nid generation:  0.0016317367553710938
local_in_edges_tensor generation:  0.0009613037109375
mini_batch_src_global generation:  0.0015826225280761719
r_  generation:  0.021602153778076172
local_output_nid generation:  0.0015816688537597656
local_in_edges_tensor generation:  0.0009157657623291016
mini_batch_src_global generation:  0.0016973018646240234
r_  generation:  0.02204442024230957
local_output_nid generation:  0.0015861988067626953
local_in_edges_tensor generation:  0.0009591579437255859
mini_batch_src_global generation:  0.0016660690307617188
r_  generation:  0.021944522857666016
local_output_nid generation:  0.001596689224243164
local_in_edges_tensor generation:  0.0009613037109375
mini_batch_src_global generation:  0.0017096996307373047
r_  generation:  0.02172255516052246
local_output_nid generation:  0.0015938282012939453
local_in_edges_tensor generation:  0.0009369850158691406
mini_batch_src_global generation:  0.0016100406646728516
r_  generation:  0.02154254913330078
local_output_nid generation:  0.0015783309936523438
local_in_edges_tensor generation:  0.0009591579437255859
mini_batch_src_global generation:  0.0017101764678955078
r_  generation:  0.022408008575439453
local_output_nid generation:  0.00159454345703125
local_in_edges_tensor generation:  0.000934600830078125
mini_batch_src_global generation:  0.0016849040985107422
r_  generation:  0.022207975387573242
local_output_nid generation:  0.0015897750854492188
local_in_edges_tensor generation:  0.0009720325469970703
mini_batch_src_global generation:  0.0017118453979492188
r_  generation:  0.02262282371520996
local_output_nid generation:  0.0015971660614013672
local_in_edges_tensor generation:  0.0009279251098632812
mini_batch_src_global generation:  0.0017862319946289062
r_  generation:  0.02261662483215332
local_output_nid generation:  0.001575469970703125
local_in_edges_tensor generation:  0.000942230224609375
mini_batch_src_global generation:  0.001760721206665039
r_  generation:  0.022088289260864258
local_output_nid generation:  0.0015685558319091797
local_in_edges_tensor generation:  0.0009675025939941406
mini_batch_src_global generation:  0.0017426013946533203
r_  generation:  0.022431612014770508
local_output_nid generation:  0.0015752315521240234
local_in_edges_tensor generation:  0.0009517669677734375
mini_batch_src_global generation:  0.0017170906066894531
r_  generation:  0.021981000900268555
local_output_nid generation:  0.0015749931335449219
local_in_edges_tensor generation:  0.0009479522705078125
mini_batch_src_global generation:  0.0017163753509521484
r_  generation:  0.021742820739746094
----------------------check_connections_block total spend ----------------------------- 0.5217673778533936
generate_one_block  0.03456711769104004
generate_one_block  0.031719207763671875
generate_one_block  0.03117966651916504
generate_one_block  0.03194689750671387
generate_one_block  0.03221750259399414
generate_one_block  0.03328132629394531
generate_one_block  0.030690670013427734
generate_one_block  0.03073287010192871
generate_one_block  0.03191661834716797
generate_one_block  0.031325340270996094
generate_one_block  0.031159639358520508
generate_one_block  0.03207850456237793
generate_one_block  0.03110337257385254
generate_one_block  0.03164792060852051
generate_one_block  0.030866622924804688
generate_one_block  0.030936479568481445
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.10474658012390137
gen group dst list time:  0.022088289260864258
time for parepare:  0.019084453582763672
local_output_nid generation:  0.007393836975097656
local_in_edges_tensor generation:  0.02040719985961914
mini_batch_src_global generation:  0.021914005279541016
r_  generation:  0.2203369140625
local_output_nid generation:  0.011247634887695312
local_in_edges_tensor generation:  0.014482498168945312
mini_batch_src_global generation:  0.028867006301879883
r_  generation:  0.22591733932495117
local_output_nid generation:  0.011563301086425781
local_in_edges_tensor generation:  0.018059730529785156
mini_batch_src_global generation:  0.027492761611938477
r_  generation:  0.22539806365966797
local_output_nid generation:  0.012581586837768555
local_in_edges_tensor generation:  0.016937971115112305
mini_batch_src_global generation:  0.028720617294311523
r_  generation:  0.23405933380126953
local_output_nid generation:  0.012725830078125
local_in_edges_tensor generation:  0.013962030410766602
mini_batch_src_global generation:  0.029421091079711914
r_  generation:  0.23535895347595215
local_output_nid generation:  0.012653350830078125
local_in_edges_tensor generation:  0.016326904296875
mini_batch_src_global generation:  0.028794288635253906
r_  generation:  0.23650193214416504
local_output_nid generation:  0.01277780532836914
local_in_edges_tensor generation:  0.014189481735229492
mini_batch_src_global generation:  0.02873969078063965
r_  generation:  0.23270845413208008
local_output_nid generation:  0.01278066635131836
local_in_edges_tensor generation:  0.012591361999511719
mini_batch_src_global generation:  0.02855539321899414
r_  generation:  0.22861027717590332
local_output_nid generation:  0.012929439544677734
local_in_edges_tensor generation:  0.014824151992797852
mini_batch_src_global generation:  0.029446840286254883
r_  generation:  0.23742127418518066
local_output_nid generation:  0.012588024139404297
local_in_edges_tensor generation:  0.01413726806640625
mini_batch_src_global generation:  0.029032230377197266
r_  generation:  0.2370591163635254
local_output_nid generation:  0.012522697448730469
local_in_edges_tensor generation:  0.01386260986328125
mini_batch_src_global generation:  0.028970956802368164
r_  generation:  0.2346506118774414
local_output_nid generation:  0.012730598449707031
local_in_edges_tensor generation:  0.014716148376464844
mini_batch_src_global generation:  0.030036449432373047
r_  generation:  0.240342378616333
local_output_nid generation:  0.012257575988769531
local_in_edges_tensor generation:  0.012912988662719727
mini_batch_src_global generation:  0.03108692169189453
r_  generation:  0.23238849639892578
local_output_nid generation:  0.013322591781616211
local_in_edges_tensor generation:  0.013325691223144531
mini_batch_src_global generation:  0.033904314041137695
r_  generation:  0.2360858917236328
local_output_nid generation:  0.012277364730834961
local_in_edges_tensor generation:  0.014843940734863281
mini_batch_src_global generation:  0.03289484977722168
r_  generation:  0.23133063316345215
local_output_nid generation:  0.01244807243347168
local_in_edges_tensor generation:  0.013936519622802734
mini_batch_src_global generation:  0.02860236167907715
r_  generation:  0.2318592071533203
----------------------check_connections_block total spend ----------------------------- 5.459680557250977
generate_one_block  0.30319690704345703
generate_one_block  0.30153560638427734
generate_one_block  0.2966940402984619
generate_one_block  0.30440664291381836
generate_one_block  0.3068974018096924
generate_one_block  0.30530285835266113
generate_one_block  0.3289306163787842
generate_one_block  0.29141736030578613
generate_one_block  0.30315446853637695
generate_one_block  0.30791449546813965
generate_one_block  0.30002307891845703
generate_one_block  0.3059206008911133
generate_one_block  0.29500675201416016
generate_one_block  0.2995016574859619
generate_one_block  0.29053544998168945
generate_one_block  0.2933461666107178
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04250526428222656
gen group dst list time:  0.06412768363952637
time for parepare:  0.01894402503967285
local_output_nid generation:  0.024729013442993164
local_in_edges_tensor generation:  0.05227804183959961
mini_batch_src_global generation:  0.04131364822387695
r_  generation:  0.4406754970550537
local_output_nid generation:  0.029782533645629883
local_in_edges_tensor generation:  0.036354780197143555
mini_batch_src_global generation:  0.051908254623413086
r_  generation:  0.44774675369262695
local_output_nid generation:  0.03005671501159668
local_in_edges_tensor generation:  0.033876895904541016
mini_batch_src_global generation:  0.04955434799194336
r_  generation:  0.4530527591705322
local_output_nid generation:  0.030222654342651367
local_in_edges_tensor generation:  0.03389286994934082
mini_batch_src_global generation:  0.05401730537414551
r_  generation:  0.45278072357177734
local_output_nid generation:  0.031564950942993164
local_in_edges_tensor generation:  0.07913827896118164
mini_batch_src_global generation:  0.05157971382141113
r_  generation:  0.4599332809448242
local_output_nid generation:  0.03056812286376953
local_in_edges_tensor generation:  0.03224372863769531
mini_batch_src_global generation:  0.05297970771789551
r_  generation:  0.45934319496154785
local_output_nid generation:  0.0305633544921875
local_in_edges_tensor generation:  0.030164480209350586
mini_batch_src_global generation:  0.05133843421936035
r_  generation:  0.4622337818145752
local_output_nid generation:  0.03063821792602539
local_in_edges_tensor generation:  0.03249859809875488
mini_batch_src_global generation:  0.05315756797790527
r_  generation:  0.45377087593078613
local_output_nid generation:  0.031409263610839844
local_in_edges_tensor generation:  0.030408859252929688
mini_batch_src_global generation:  0.05129861831665039
r_  generation:  0.4608914852142334
local_output_nid generation:  0.030961036682128906
local_in_edges_tensor generation:  0.03343772888183594
mini_batch_src_global generation:  0.05283856391906738
r_  generation:  0.4599487781524658
local_output_nid generation:  0.031402587890625
local_in_edges_tensor generation:  0.033854007720947266
mini_batch_src_global generation:  0.05161237716674805
r_  generation:  0.4604067802429199
local_output_nid generation:  0.03148198127746582
local_in_edges_tensor generation:  0.030098915100097656
mini_batch_src_global generation:  0.05514335632324219
r_  generation:  0.45989418029785156
local_output_nid generation:  0.031069040298461914
local_in_edges_tensor generation:  0.03267407417297363
mini_batch_src_global generation:  0.05139040946960449
r_  generation:  0.47740745544433594
local_output_nid generation:  0.03214573860168457
local_in_edges_tensor generation:  0.02946329116821289
mini_batch_src_global generation:  0.05367875099182129
r_  generation:  0.4598827362060547
local_output_nid generation:  0.031156539916992188
local_in_edges_tensor generation:  0.030518293380737305
mini_batch_src_global generation:  0.05118417739868164
r_  generation:  0.4644289016723633
local_output_nid generation:  0.03115224838256836
local_in_edges_tensor generation:  0.03247666358947754
mini_batch_src_global generation:  0.05235934257507324
r_  generation:  0.46491432189941406
----------------------check_connections_block total spend ----------------------------- 10.843965291976929
generate_one_block  0.5698072910308838
generate_one_block  0.5932176113128662
generate_one_block  0.5677971839904785
generate_one_block  0.5941329002380371
generate_one_block  0.5785214900970459
generate_one_block  0.5748276710510254
generate_one_block  0.5768966674804688
generate_one_block  0.5725233554840088
generate_one_block  0.6443803310394287
generate_one_block  0.5831453800201416
generate_one_block  0.5775058269500732
generate_one_block  0.5929310321807861
generate_one_block  0.574744701385498
generate_one_block  0.5668783187866211
generate_one_block  0.5756509304046631
generate_one_block  0.5733764171600342
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11771440505981445  GigaBytes
Max Memory Allocated: 0.8426589965820312  GigaBytes

connection checking time:  16.303645849227905
block generation total time  14.150121212005615
average batch blocks generation time:  0.884382575750351
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09481191635131836  GigaBytes
Max Memory Allocated: 0.8426589965820312  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7452149391174316  GigaBytes
Max Memory Allocated: 0.8426589965820312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09456729888916016  GigaBytes
Max Memory Allocated: 0.8426589965820312  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7496600151062012  GigaBytes
Max Memory Allocated: 0.8426589965820312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0946950912475586  GigaBytes
Max Memory Allocated: 0.8426589965820312  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7435483932495117  GigaBytes
Max Memory Allocated: 0.8426589965820312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09470462799072266  GigaBytes
Max Memory Allocated: 0.8426589965820312  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.750823974609375  GigaBytes
Max Memory Allocated: 0.8426589965820312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09485912322998047  GigaBytes
Max Memory Allocated: 0.8426589965820312  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7504205703735352  GigaBytes
Max Memory Allocated: 0.8426589965820312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09443807601928711  GigaBytes
Max Memory Allocated: 0.8426589965820312  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.743657112121582  GigaBytes
Max Memory Allocated: 0.8426589965820312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09467601776123047  GigaBytes
Max Memory Allocated: 0.8426589965820312  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7412290573120117  GigaBytes
Max Memory Allocated: 0.8426589965820312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09417343139648438  GigaBytes
Max Memory Allocated: 0.8426589965820312  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7393131256103516  GigaBytes
Max Memory Allocated: 0.8426589965820312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09487628936767578  GigaBytes
Max Memory Allocated: 0.8426589965820312  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7512884140014648  GigaBytes
Max Memory Allocated: 0.8426589965820312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09458303451538086  GigaBytes
Max Memory Allocated: 0.8426589965820312  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7508111000061035  GigaBytes
Max Memory Allocated: 0.8426589965820312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0947256088256836  GigaBytes
Max Memory Allocated: 0.8426589965820312  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7441544532775879  GigaBytes
Max Memory Allocated: 0.8426589965820312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09471559524536133  GigaBytes
Max Memory Allocated: 0.8426589965820312  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7541661262512207  GigaBytes
Max Memory Allocated: 0.8426589965820312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09461593627929688  GigaBytes
Max Memory Allocated: 0.8432750701904297  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7412924766540527  GigaBytes
Max Memory Allocated: 0.8432750701904297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09429311752319336  GigaBytes
Max Memory Allocated: 0.8432750701904297  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7449326515197754  GigaBytes
Max Memory Allocated: 0.8432750701904297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09458255767822266  GigaBytes
Max Memory Allocated: 0.8432750701904297  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7407240867614746  GigaBytes
Max Memory Allocated: 0.8432750701904297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09427452087402344  GigaBytes
Max Memory Allocated: 0.8432750701904297  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7398276329040527  GigaBytes
Max Memory Allocated: 0.8432750701904297  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.060760676860809326 |0.014413326978683472 |0.003434121608734131 |8.779764175415039e-05 |0.0034302175045013428 |0.0018963813781738281 |
----------------------------------------------------------pseudo_mini_loss sum 2.611398220062256
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  5206961
Number of first layer input nodes during this epoch:  2479654
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.1174168586730957  GigaBytes
Max Memory Allocated: 0.8432750701904297  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.029718875885009766
range selection method range initialization spend 0.012514352798461914
time for parepare:  0.01599597930908203
local_output_nid generation:  0.0013988018035888672
local_in_edges_tensor generation:  0.006423473358154297
mini_batch_src_global generation:  0.0016717910766601562
r_  generation:  0.020090818405151367
local_output_nid generation:  0.001583099365234375
local_in_edges_tensor generation:  0.0009796619415283203
mini_batch_src_global generation:  0.001986265182495117
r_  generation:  0.022549152374267578
local_output_nid generation:  0.0016014575958251953
local_in_edges_tensor generation:  0.0009179115295410156
mini_batch_src_global generation:  0.0016336441040039062
r_  generation:  0.02120184898376465
local_output_nid generation:  0.0015997886657714844
local_in_edges_tensor generation:  0.0009133815765380859
mini_batch_src_global generation:  0.0016791820526123047
r_  generation:  0.02190542221069336
local_output_nid generation:  0.0016057491302490234
local_in_edges_tensor generation:  0.0010154247283935547
mini_batch_src_global generation:  0.0016906261444091797
r_  generation:  0.020980358123779297
local_output_nid generation:  0.0015604496002197266
local_in_edges_tensor generation:  0.0011382102966308594
mini_batch_src_global generation:  0.0016684532165527344
r_  generation:  0.021682024002075195
local_output_nid generation:  0.0016086101531982422
local_in_edges_tensor generation:  0.0012068748474121094
mini_batch_src_global generation:  0.001672506332397461
r_  generation:  0.0212557315826416
local_output_nid generation:  0.0015921592712402344
local_in_edges_tensor generation:  0.0012254714965820312
mini_batch_src_global generation:  0.0016946792602539062
r_  generation:  0.021793365478515625
local_output_nid generation:  0.0016062259674072266
local_in_edges_tensor generation:  0.0012056827545166016
mini_batch_src_global generation:  0.001692056655883789
r_  generation:  0.021773815155029297
local_output_nid generation:  0.001598358154296875
local_in_edges_tensor generation:  0.0012090206146240234
mini_batch_src_global generation:  0.0016970634460449219
r_  generation:  0.022740602493286133
local_output_nid generation:  0.001611948013305664
local_in_edges_tensor generation:  0.0010080337524414062
mini_batch_src_global generation:  0.0017828941345214844
r_  generation:  0.02259659767150879
local_output_nid generation:  0.0016341209411621094
local_in_edges_tensor generation:  0.0009996891021728516
mini_batch_src_global generation:  0.0017540454864501953
r_  generation:  0.02205348014831543
local_output_nid generation:  0.0015883445739746094
local_in_edges_tensor generation:  0.0009918212890625
mini_batch_src_global generation:  0.0017116069793701172
r_  generation:  0.02203512191772461
local_output_nid generation:  0.001596212387084961
local_in_edges_tensor generation:  0.0010128021240234375
mini_batch_src_global generation:  0.001741647720336914
r_  generation:  0.022200822830200195
local_output_nid generation:  0.0015790462493896484
local_in_edges_tensor generation:  0.0010023117065429688
mini_batch_src_global generation:  0.0017719268798828125
r_  generation:  0.021819353103637695
local_output_nid generation:  0.0015921592712402344
local_in_edges_tensor generation:  0.0010080337524414062
mini_batch_src_global generation:  0.0017347335815429688
r_  generation:  0.021982192993164062
----------------------check_connections_block total spend ----------------------------- 0.5219066143035889
generate_one_block  0.03083038330078125
generate_one_block  0.031166553497314453
generate_one_block  0.030968904495239258
generate_one_block  0.031917572021484375
generate_one_block  0.03067469596862793
generate_one_block  0.03252077102661133
generate_one_block  0.030280351638793945
generate_one_block  0.03084397315979004
generate_one_block  0.0310213565826416
generate_one_block  0.03229022026062012
generate_one_block  0.032704830169677734
generate_one_block  0.03163623809814453
generate_one_block  0.031537771224975586
generate_one_block  0.03164482116699219
generate_one_block  0.03104877471923828
generate_one_block  0.0320889949798584
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.07323956489562988
gen group dst list time:  0.020425796508789062
time for parepare:  0.01952528953552246
local_output_nid generation:  0.007399559020996094
local_in_edges_tensor generation:  0.027698278427124023
mini_batch_src_global generation:  0.021767139434814453
r_  generation:  0.2101154327392578
local_output_nid generation:  0.011277914047241211
local_in_edges_tensor generation:  0.015598773956298828
mini_batch_src_global generation:  0.028176546096801758
r_  generation:  0.2220160961151123
local_output_nid generation:  0.011633157730102539
local_in_edges_tensor generation:  0.013285160064697266
mini_batch_src_global generation:  0.02616572380065918
r_  generation:  0.22693777084350586
local_output_nid generation:  0.012555837631225586
local_in_edges_tensor generation:  0.012556076049804688
mini_batch_src_global generation:  0.02777886390686035
r_  generation:  0.23562192916870117
local_output_nid generation:  0.012168645858764648
local_in_edges_tensor generation:  0.011922597885131836
mini_batch_src_global generation:  0.027740478515625
r_  generation:  0.22447538375854492
local_output_nid generation:  0.012808561325073242
local_in_edges_tensor generation:  0.01262211799621582
mini_batch_src_global generation:  0.02829575538635254
r_  generation:  0.22957253456115723
local_output_nid generation:  0.012771368026733398
local_in_edges_tensor generation:  0.01205134391784668
mini_batch_src_global generation:  0.03041672706604004
r_  generation:  0.22799468040466309
local_output_nid generation:  0.012992382049560547
local_in_edges_tensor generation:  0.012552738189697266
mini_batch_src_global generation:  0.033307790756225586
r_  generation:  0.2307741641998291
local_output_nid generation:  0.013091564178466797
local_in_edges_tensor generation:  0.012946844100952148
mini_batch_src_global generation:  0.0318150520324707
r_  generation:  0.23224949836730957
local_output_nid generation:  0.013222694396972656
local_in_edges_tensor generation:  0.017130374908447266
mini_batch_src_global generation:  0.030707597732543945
r_  generation:  0.23804020881652832
local_output_nid generation:  0.012723684310913086
local_in_edges_tensor generation:  0.014392852783203125
mini_batch_src_global generation:  0.029758930206298828
r_  generation:  0.2384653091430664
local_output_nid generation:  0.012433528900146484
local_in_edges_tensor generation:  0.013703346252441406
mini_batch_src_global generation:  0.029955148696899414
r_  generation:  0.23575949668884277
local_output_nid generation:  0.01254129409790039
local_in_edges_tensor generation:  0.013082265853881836
mini_batch_src_global generation:  0.0295412540435791
r_  generation:  0.2383124828338623
local_output_nid generation:  0.012483596801757812
local_in_edges_tensor generation:  0.014196634292602539
mini_batch_src_global generation:  0.03067755699157715
r_  generation:  0.23832249641418457
local_output_nid generation:  0.012418031692504883
local_in_edges_tensor generation:  0.0128326416015625
mini_batch_src_global generation:  0.030188560485839844
r_  generation:  0.23546409606933594
local_output_nid generation:  0.012351036071777344
local_in_edges_tensor generation:  0.01263737678527832
mini_batch_src_global generation:  0.02954840660095215
r_  generation:  0.23224282264709473
----------------------check_connections_block total spend ----------------------------- 5.414666175842285
generate_one_block  0.297879695892334
generate_one_block  0.2960207462310791
generate_one_block  0.29740262031555176
generate_one_block  0.30667543411254883
generate_one_block  0.2931349277496338
generate_one_block  0.29341578483581543
generate_one_block  0.31327199935913086
generate_one_block  0.2946808338165283
generate_one_block  0.29877233505249023
generate_one_block  0.30635857582092285
generate_one_block  0.30536603927612305
generate_one_block  0.3039577007293701
generate_one_block  0.305600643157959
generate_one_block  0.3005034923553467
generate_one_block  0.2982821464538574
generate_one_block  0.29612112045288086
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04318404197692871
gen group dst list time:  0.06095409393310547
time for parepare:  0.018450260162353516
local_output_nid generation:  0.02393198013305664
local_in_edges_tensor generation:  0.03711271286010742
mini_batch_src_global generation:  0.04913210868835449
r_  generation:  0.4419829845428467
local_output_nid generation:  0.029697179794311523
local_in_edges_tensor generation:  0.036267757415771484
mini_batch_src_global generation:  0.052008867263793945
r_  generation:  0.44502925872802734
local_output_nid generation:  0.02997565269470215
local_in_edges_tensor generation:  0.03186225891113281
mini_batch_src_global generation:  0.054261207580566406
r_  generation:  0.4592761993408203
local_output_nid generation:  0.0305325984954834
local_in_edges_tensor generation:  0.0316009521484375
mini_batch_src_global generation:  0.05313706398010254
r_  generation:  0.45073485374450684
local_output_nid generation:  0.030788421630859375
local_in_edges_tensor generation:  0.07145428657531738
mini_batch_src_global generation:  0.05122733116149902
r_  generation:  0.45485424995422363
local_output_nid generation:  0.030927658081054688
local_in_edges_tensor generation:  0.029248476028442383
mini_batch_src_global generation:  0.05303359031677246
r_  generation:  0.4534022808074951
local_output_nid generation:  0.03128528594970703
local_in_edges_tensor generation:  0.03298330307006836
mini_batch_src_global generation:  0.05608367919921875
r_  generation:  0.4602057933807373
local_output_nid generation:  0.030896425247192383
local_in_edges_tensor generation:  0.02968621253967285
mini_batch_src_global generation:  0.05286836624145508
r_  generation:  0.453873872756958
local_output_nid generation:  0.031203746795654297
local_in_edges_tensor generation:  0.032680511474609375
mini_batch_src_global generation:  0.052286386489868164
r_  generation:  0.4636523723602295
local_output_nid generation:  0.031169891357421875
local_in_edges_tensor generation:  0.03397822380065918
mini_batch_src_global generation:  0.05547976493835449
r_  generation:  0.45592236518859863
local_output_nid generation:  0.031227827072143555
local_in_edges_tensor generation:  0.031424760818481445
mini_batch_src_global generation:  0.05430030822753906
r_  generation:  0.4611971378326416
local_output_nid generation:  0.03116154670715332
local_in_edges_tensor generation:  0.029425859451293945
mini_batch_src_global generation:  0.05352950096130371
r_  generation:  0.45763325691223145
local_output_nid generation:  0.03127121925354004
local_in_edges_tensor generation:  0.029234647750854492
mini_batch_src_global generation:  0.05204057693481445
r_  generation:  0.46233701705932617
local_output_nid generation:  0.03134775161743164
local_in_edges_tensor generation:  0.034651756286621094
mini_batch_src_global generation:  0.05351972579956055
r_  generation:  0.45911693572998047
local_output_nid generation:  0.0313262939453125
local_in_edges_tensor generation:  0.03027033805847168
mini_batch_src_global generation:  0.0524137020111084
r_  generation:  0.4606139659881592
local_output_nid generation:  0.031084299087524414
local_in_edges_tensor generation:  0.03122234344482422
mini_batch_src_global generation:  0.05341982841491699
r_  generation:  0.4524955749511719
----------------------check_connections_block total spend ----------------------------- 10.786685943603516
generate_one_block  0.572751522064209
generate_one_block  0.5753874778747559
generate_one_block  0.5760185718536377
generate_one_block  0.573030948638916
generate_one_block  0.5672523975372314
generate_one_block  0.5679759979248047
generate_one_block  0.5773019790649414
generate_one_block  0.5726873874664307
generate_one_block  0.6112067699432373
generate_one_block  0.5808417797088623
generate_one_block  0.5793428421020508
generate_one_block  0.5743298530578613
generate_one_block  0.5758795738220215
generate_one_block  0.5810134410858154
generate_one_block  0.5691251754760742
generate_one_block  0.5697498321533203
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.1174168586730957  GigaBytes
Max Memory Allocated: 0.8432750701904297  GigaBytes

connection checking time:  16.2013521194458
block generation total time  14.031339645385742
average batch blocks generation time:  0.8769587278366089
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09461069107055664  GigaBytes
Max Memory Allocated: 0.8432750701904297  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7402143478393555  GigaBytes
Max Memory Allocated: 0.8432750701904297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09451961517333984  GigaBytes
Max Memory Allocated: 0.8432750701904297  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7483944892883301  GigaBytes
Max Memory Allocated: 0.8432750701904297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09479141235351562  GigaBytes
Max Memory Allocated: 0.8432750701904297  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7450447082519531  GigaBytes
Max Memory Allocated: 0.8432750701904297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.094696044921875  GigaBytes
Max Memory Allocated: 0.8432750701904297  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.753425121307373  GigaBytes
Max Memory Allocated: 0.8432750701904297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09449958801269531  GigaBytes
Max Memory Allocated: 0.8432750701904297  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.738558292388916  GigaBytes
Max Memory Allocated: 0.8432750701904297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0944209098815918  GigaBytes
Max Memory Allocated: 0.8432750701904297  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7435188293457031  GigaBytes
Max Memory Allocated: 0.8432750701904297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09462928771972656  GigaBytes
Max Memory Allocated: 0.8432750701904297  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7437930107116699  GigaBytes
Max Memory Allocated: 0.8432750701904297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09422445297241211  GigaBytes
Max Memory Allocated: 0.8432750701904297  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7422685623168945  GigaBytes
Max Memory Allocated: 0.8432750701904297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09470176696777344  GigaBytes
Max Memory Allocated: 0.8432750701904297  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7474370002746582  GigaBytes
Max Memory Allocated: 0.8432750701904297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0947566032409668  GigaBytes
Max Memory Allocated: 0.8432750701904297  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7550816535949707  GigaBytes
Max Memory Allocated: 0.8432750701904297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09486675262451172  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7476372718811035  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09457015991210938  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7455110549926758  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09486770629882812  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7523488998413086  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09459733963012695  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7469630241394043  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09476470947265625  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7439050674438477  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09418153762817383  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7421760559082031  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06014145910739899 |0.011265724897384644 |0.003593936562538147 |8.730590343475342e-05 |0.005137592554092407 |0.002958059310913086 |
----------------------------------------------------------pseudo_mini_loss sum 2.360327959060669
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  5209656
Number of first layer input nodes during this epoch:  2480444
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.1175374984741211  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022834062576293945
range selection method range initialization spend 0.012093782424926758
time for parepare:  0.0169985294342041
local_output_nid generation:  0.0013926029205322266
local_in_edges_tensor generation:  0.0033807754516601562
mini_batch_src_global generation:  0.0017499923706054688
r_  generation:  0.021742582321166992
local_output_nid generation:  0.0015761852264404297
local_in_edges_tensor generation:  0.001024484634399414
mini_batch_src_global generation:  0.0019965171813964844
r_  generation:  0.022420167922973633
local_output_nid generation:  0.0018167495727539062
local_in_edges_tensor generation:  0.001055002212524414
mini_batch_src_global generation:  0.001932382583618164
r_  generation:  0.022615671157836914
local_output_nid generation:  0.0017178058624267578
local_in_edges_tensor generation:  0.0011277198791503906
mini_batch_src_global generation:  0.001653432846069336
r_  generation:  0.02097344398498535
local_output_nid generation:  0.00164794921875
local_in_edges_tensor generation:  0.0011250972747802734
mini_batch_src_global generation:  0.0018701553344726562
r_  generation:  0.02195596694946289
local_output_nid generation:  0.0016283988952636719
local_in_edges_tensor generation:  0.0010483264923095703
mini_batch_src_global generation:  0.0017442703247070312
r_  generation:  0.04027438163757324
local_output_nid generation:  0.0021276473999023438
local_in_edges_tensor generation:  0.0012972354888916016
mini_batch_src_global generation:  0.019845962524414062
r_  generation:  0.025206327438354492
local_output_nid generation:  0.002033233642578125
local_in_edges_tensor generation:  0.0011768341064453125
mini_batch_src_global generation:  0.003708362579345703
r_  generation:  0.022441625595092773
local_output_nid generation:  0.002043485641479492
local_in_edges_tensor generation:  0.0011591911315917969
mini_batch_src_global generation:  0.007034778594970703
r_  generation:  0.022373676300048828
local_output_nid generation:  0.002015352249145508
local_in_edges_tensor generation:  0.0011353492736816406
mini_batch_src_global generation:  0.017661094665527344
r_  generation:  0.021670818328857422
local_output_nid generation:  0.0019960403442382812
local_in_edges_tensor generation:  0.0011663436889648438
mini_batch_src_global generation:  0.001773834228515625
r_  generation:  0.021918058395385742
local_output_nid generation:  0.0019199848175048828
local_in_edges_tensor generation:  0.0012404918670654297
mini_batch_src_global generation:  0.0017991065979003906
r_  generation:  0.022020578384399414
local_output_nid generation:  0.0019278526306152344
local_in_edges_tensor generation:  0.001094818115234375
mini_batch_src_global generation:  0.0017921924591064453
r_  generation:  0.02138829231262207
local_output_nid generation:  0.0019259452819824219
local_in_edges_tensor generation:  0.0011439323425292969
mini_batch_src_global generation:  0.0017895698547363281
r_  generation:  0.02172994613647461
local_output_nid generation:  0.0019147396087646484
local_in_edges_tensor generation:  0.0011107921600341797
mini_batch_src_global generation:  0.0017685890197753906
r_  generation:  0.02152848243713379
local_output_nid generation:  0.002086639404296875
local_in_edges_tensor generation:  0.0011551380157470703
mini_batch_src_global generation:  0.001794576644897461
r_  generation:  0.022025346755981445
----------------------check_connections_block total spend ----------------------------- 0.6140365600585938
generate_one_block  0.03455400466918945
generate_one_block  0.032239437103271484
generate_one_block  0.03237724304199219
generate_one_block  0.031010150909423828
generate_one_block  0.032514095306396484
generate_one_block  0.034444570541381836
generate_one_block  0.03250432014465332
generate_one_block  0.0323638916015625
generate_one_block  0.03727912902832031
generate_one_block  0.04332470893859863
generate_one_block  0.03227496147155762
generate_one_block  0.03256630897521973
generate_one_block  0.031392812728881836
generate_one_block  0.03257322311401367
generate_one_block  0.031646013259887695
generate_one_block  0.03250575065612793
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04043936729431152
gen group dst list time:  0.02970600128173828
time for parepare:  0.02207779884338379
local_output_nid generation:  0.008703231811523438
local_in_edges_tensor generation:  0.028790712356567383
mini_batch_src_global generation:  0.024001121520996094
r_  generation:  0.22278761863708496
local_output_nid generation:  0.014314651489257812
local_in_edges_tensor generation:  0.017942428588867188
mini_batch_src_global generation:  0.034334659576416016
r_  generation:  0.24543499946594238
local_output_nid generation:  0.016878604888916016
local_in_edges_tensor generation:  0.017306804656982422
mini_batch_src_global generation:  0.03178691864013672
r_  generation:  0.24739789962768555
local_output_nid generation:  0.015604734420776367
local_in_edges_tensor generation:  0.01480722427368164
mini_batch_src_global generation:  0.029337644577026367
r_  generation:  0.24291014671325684
local_output_nid generation:  0.015773296356201172
local_in_edges_tensor generation:  0.018761634826660156
mini_batch_src_global generation:  0.03950381278991699
r_  generation:  0.25696563720703125
local_output_nid generation:  0.018299102783203125
local_in_edges_tensor generation:  0.01930379867553711
mini_batch_src_global generation:  0.032598018646240234
r_  generation:  0.25600576400756836
local_output_nid generation:  0.015908241271972656
local_in_edges_tensor generation:  0.01861405372619629
mini_batch_src_global generation:  0.0361180305480957
r_  generation:  0.25720739364624023
local_output_nid generation:  0.017283201217651367
local_in_edges_tensor generation:  0.01705193519592285
mini_batch_src_global generation:  0.03313446044921875
r_  generation:  0.25829124450683594
local_output_nid generation:  0.01648259162902832
local_in_edges_tensor generation:  0.021323204040527344
mini_batch_src_global generation:  0.03930950164794922
r_  generation:  0.26363658905029297
local_output_nid generation:  0.018700838088989258
local_in_edges_tensor generation:  0.01522374153137207
mini_batch_src_global generation:  0.043425798416137695
r_  generation:  0.2543952465057373
local_output_nid generation:  0.016462087631225586
local_in_edges_tensor generation:  0.014541149139404297
mini_batch_src_global generation:  0.03546142578125
r_  generation:  0.2718491554260254
local_output_nid generation:  0.016914844512939453
local_in_edges_tensor generation:  0.016059398651123047
mini_batch_src_global generation:  0.03397822380065918
r_  generation:  0.2639594078063965
local_output_nid generation:  0.017159700393676758
local_in_edges_tensor generation:  0.020561933517456055
mini_batch_src_global generation:  0.03441619873046875
r_  generation:  0.25669002532958984
local_output_nid generation:  0.016994953155517578
local_in_edges_tensor generation:  0.01850605010986328
mini_batch_src_global generation:  0.03735017776489258
r_  generation:  0.27795958518981934
local_output_nid generation:  0.015836715698242188
local_in_edges_tensor generation:  0.014991044998168945
mini_batch_src_global generation:  0.034535884857177734
r_  generation:  0.24057245254516602
local_output_nid generation:  0.01715850830078125
local_in_edges_tensor generation:  0.015768051147460938
mini_batch_src_global generation:  0.029747486114501953
r_  generation:  0.2384493350982666
----------------------check_connections_block total spend ----------------------------- 6.132532596588135
generate_one_block  0.31534504890441895
generate_one_block  0.2982757091522217
generate_one_block  0.3009169101715088
generate_one_block  0.2947821617126465
generate_one_block  0.3047146797180176
generate_one_block  0.31069278717041016
generate_one_block  0.34072399139404297
generate_one_block  0.3095564842224121
generate_one_block  0.30941319465637207
generate_one_block  0.3043529987335205
generate_one_block  0.3015742301940918
generate_one_block  0.3136465549468994
generate_one_block  0.30199575424194336
generate_one_block  0.31820201873779297
generate_one_block  0.30159759521484375
generate_one_block  0.3037593364715576
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.038256168365478516
gen group dst list time:  0.07238030433654785
time for parepare:  0.018350839614868164
local_output_nid generation:  0.025074481964111328
local_in_edges_tensor generation:  0.06576108932495117
mini_batch_src_global generation:  0.04286003112792969
r_  generation:  0.4491713047027588
local_output_nid generation:  0.02983880043029785
local_in_edges_tensor generation:  0.037830352783203125
mini_batch_src_global generation:  0.05192255973815918
r_  generation:  0.4539222717285156
local_output_nid generation:  0.03061532974243164
local_in_edges_tensor generation:  0.03173232078552246
mini_batch_src_global generation:  0.050771236419677734
r_  generation:  0.46015357971191406
local_output_nid generation:  0.030228137969970703
local_in_edges_tensor generation:  0.03435873985290527
mini_batch_src_global generation:  0.05351376533508301
r_  generation:  0.4568493366241455
local_output_nid generation:  0.031237125396728516
local_in_edges_tensor generation:  0.07707905769348145
mini_batch_src_global generation:  0.05171656608581543
r_  generation:  0.4692261219024658
local_output_nid generation:  0.031362295150756836
local_in_edges_tensor generation:  0.041173696517944336
mini_batch_src_global generation:  0.053075313568115234
r_  generation:  0.46092700958251953
local_output_nid generation:  0.03237175941467285
local_in_edges_tensor generation:  0.03352832794189453
mini_batch_src_global generation:  0.05347704887390137
r_  generation:  0.4657471179962158
local_output_nid generation:  0.031610727310180664
local_in_edges_tensor generation:  0.031613826751708984
mini_batch_src_global generation:  0.055426597595214844
r_  generation:  0.4578719139099121
local_output_nid generation:  0.03136038780212402
local_in_edges_tensor generation:  0.03231930732727051
mini_batch_src_global generation:  0.052631378173828125
r_  generation:  0.480396032333374
local_output_nid generation:  0.034725189208984375
local_in_edges_tensor generation:  0.02983880043029785
mini_batch_src_global generation:  0.05768537521362305
r_  generation:  0.4570047855377197
local_output_nid generation:  0.032536983489990234
local_in_edges_tensor generation:  0.032555341720581055
mini_batch_src_global generation:  0.07347869873046875
r_  generation:  0.469043493270874
local_output_nid generation:  0.032569169998168945
local_in_edges_tensor generation:  0.03179311752319336
mini_batch_src_global generation:  0.053450822830200195
r_  generation:  0.45567965507507324
local_output_nid generation:  0.032436370849609375
local_in_edges_tensor generation:  0.0341029167175293
mini_batch_src_global generation:  0.05231785774230957
r_  generation:  0.4653477668762207
local_output_nid generation:  0.0325016975402832
local_in_edges_tensor generation:  0.03177905082702637
mini_batch_src_global generation:  0.05574679374694824
r_  generation:  0.4577908515930176
local_output_nid generation:  0.032387495040893555
local_in_edges_tensor generation:  0.03134942054748535
mini_batch_src_global generation:  0.05258798599243164
r_  generation:  0.4637274742126465
local_output_nid generation:  0.0322721004486084
local_in_edges_tensor generation:  0.029735565185546875
mini_batch_src_global generation:  0.0541529655456543
r_  generation:  0.45833873748779297
----------------------check_connections_block total spend ----------------------------- 10.991084098815918
generate_one_block  0.5848517417907715
generate_one_block  0.5764834880828857
generate_one_block  0.5876758098602295
generate_one_block  0.5880365371704102
generate_one_block  0.5817053318023682
generate_one_block  0.5776619911193848
generate_one_block  0.5854039192199707
generate_one_block  0.5808515548706055
generate_one_block  0.6494061946868896
generate_one_block  0.5778863430023193
generate_one_block  0.5893378257751465
generate_one_block  0.5846805572509766
generate_one_block  0.5763514041900635
generate_one_block  0.59031081199646
generate_one_block  0.59039306640625
generate_one_block  0.5776939392089844
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.1175374984741211  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

connection checking time:  17.123616695404053
block generation total time  14.328279972076416
average batch blocks generation time:  0.895517498254776
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09487104415893555  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7506370544433594  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0945734977722168  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7443599700927734  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09478378295898438  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7501778602600098  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09418058395385742  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7388243675231934  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09480857849121094  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7474322319030762  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09434127807617188  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7434115409851074  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09473896026611328  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7434520721435547  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09447050094604492  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7439055442810059  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.094879150390625  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7501993179321289  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09446430206298828  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7436509132385254  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09473228454589844  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7474212646484375  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09462261199951172  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7515416145324707  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0946340560913086  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7421331405639648  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09477710723876953  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.754636287689209  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0947265625  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7448081970214844  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09439516067504883  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7430472373962402  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06459839642047882 |0.014278620481491089 |0.0035711824893951416 |8.952617645263672e-05 |0.0037572383880615234 |0.0028243064880371094 |
----------------------------------------------------------pseudo_mini_loss sum 2.0954415798187256
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  5210959
Number of first layer input nodes during this epoch:  2481077
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11789798736572266  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025353670120239258
range selection method range initialization spend 0.012269735336303711
time for parepare:  0.018541336059570312
local_output_nid generation:  0.001413106918334961
local_in_edges_tensor generation:  0.04569268226623535
mini_batch_src_global generation:  0.0017197132110595703
r_  generation:  0.020212411880493164
local_output_nid generation:  0.0016286373138427734
local_in_edges_tensor generation:  0.0009884834289550781
mini_batch_src_global generation:  0.0020346641540527344
r_  generation:  0.02410435676574707
local_output_nid generation:  0.0016264915466308594
local_in_edges_tensor generation:  0.0009436607360839844
mini_batch_src_global generation:  0.0020911693572998047
r_  generation:  0.02403855323791504
local_output_nid generation:  0.0015819072723388672
local_in_edges_tensor generation:  0.0009610652923583984
mini_batch_src_global generation:  0.002050161361694336
r_  generation:  0.02170729637145996
local_output_nid generation:  0.0015828609466552734
local_in_edges_tensor generation:  0.0009229183197021484
mini_batch_src_global generation:  0.0016832351684570312
r_  generation:  0.021442413330078125
local_output_nid generation:  0.0015976428985595703
local_in_edges_tensor generation:  0.0009551048278808594
mini_batch_src_global generation:  0.0017135143280029297
r_  generation:  0.0221710205078125
local_output_nid generation:  0.001603841781616211
local_in_edges_tensor generation:  0.0009217262268066406
mini_batch_src_global generation:  0.0017354488372802734
r_  generation:  0.02216196060180664
local_output_nid generation:  0.001585245132446289
local_in_edges_tensor generation:  0.0009095668792724609
mini_batch_src_global generation:  0.0017666816711425781
r_  generation:  0.022530078887939453
local_output_nid generation:  0.0015835762023925781
local_in_edges_tensor generation:  0.0009391307830810547
mini_batch_src_global generation:  0.0017218589782714844
r_  generation:  0.021857023239135742
local_output_nid generation:  0.0015995502471923828
local_in_edges_tensor generation:  0.0009520053863525391
mini_batch_src_global generation:  0.0016927719116210938
r_  generation:  0.02152109146118164
local_output_nid generation:  0.0015909671783447266
local_in_edges_tensor generation:  0.0009114742279052734
mini_batch_src_global generation:  0.0017209053039550781
r_  generation:  0.0219881534576416
local_output_nid generation:  0.0015921592712402344
local_in_edges_tensor generation:  0.0009119510650634766
mini_batch_src_global generation:  0.0016813278198242188
r_  generation:  0.02172994613647461
local_output_nid generation:  0.0015888214111328125
local_in_edges_tensor generation:  0.0009620189666748047
mini_batch_src_global generation:  0.009165048599243164
r_  generation:  0.02138066291809082
local_output_nid generation:  0.0015921592712402344
local_in_edges_tensor generation:  0.0008804798126220703
mini_batch_src_global generation:  0.0016832351684570312
r_  generation:  0.02169179916381836
local_output_nid generation:  0.0015773773193359375
local_in_edges_tensor generation:  0.0010035037994384766
mini_batch_src_global generation:  0.0017435550689697266
r_  generation:  0.022214174270629883
local_output_nid generation:  0.001592874526977539
local_in_edges_tensor generation:  0.0009310245513916016
mini_batch_src_global generation:  0.0016970634460449219
r_  generation:  0.021811485290527344
----------------------check_connections_block total spend ----------------------------- 0.569556713104248
generate_one_block  0.0293729305267334
generate_one_block  0.03143763542175293
generate_one_block  0.03168821334838867
generate_one_block  0.030849933624267578
generate_one_block  0.03084087371826172
generate_one_block  0.03334951400756836
generate_one_block  0.03128242492675781
generate_one_block  0.03144383430480957
generate_one_block  0.03076624870300293
generate_one_block  0.03060770034790039
generate_one_block  0.031132221221923828
generate_one_block  0.0308988094329834
generate_one_block  0.030698060989379883
generate_one_block  0.030722856521606445
generate_one_block  0.031484127044677734
generate_one_block  0.03134918212890625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03560948371887207
gen group dst list time:  0.021707773208618164
time for parepare:  0.01874995231628418
local_output_nid generation:  0.007160663604736328
local_in_edges_tensor generation:  0.023786306381225586
mini_batch_src_global generation:  0.02147078514099121
r_  generation:  0.21209216117858887
local_output_nid generation:  0.011029243469238281
local_in_edges_tensor generation:  0.013716697692871094
mini_batch_src_global generation:  0.027992963790893555
r_  generation:  0.22324395179748535
local_output_nid generation:  0.011633157730102539
local_in_edges_tensor generation:  0.01635265350341797
mini_batch_src_global generation:  0.034021854400634766
r_  generation:  0.2299785614013672
local_output_nid generation:  0.012377023696899414
local_in_edges_tensor generation:  0.012462139129638672
mini_batch_src_global generation:  0.02991199493408203
r_  generation:  0.22871184349060059
local_output_nid generation:  0.014573812484741211
local_in_edges_tensor generation:  0.012492656707763672
mini_batch_src_global generation:  0.028077363967895508
r_  generation:  0.2302095890045166
local_output_nid generation:  0.012852907180786133
local_in_edges_tensor generation:  0.013916015625
mini_batch_src_global generation:  0.028897762298583984
r_  generation:  0.23712420463562012
local_output_nid generation:  0.012866020202636719
local_in_edges_tensor generation:  0.012654781341552734
mini_batch_src_global generation:  0.028830528259277344
r_  generation:  0.23173165321350098
local_output_nid generation:  0.013117313385009766
local_in_edges_tensor generation:  0.012805461883544922
mini_batch_src_global generation:  0.02955150604248047
r_  generation:  0.2365727424621582
local_output_nid generation:  0.013067960739135742
local_in_edges_tensor generation:  0.01621866226196289
mini_batch_src_global generation:  0.029300212860107422
r_  generation:  0.23589348793029785
local_output_nid generation:  0.012926340103149414
local_in_edges_tensor generation:  0.014272689819335938
mini_batch_src_global generation:  0.029002666473388672
r_  generation:  0.23105382919311523
local_output_nid generation:  0.012911558151245117
local_in_edges_tensor generation:  0.01292276382446289
mini_batch_src_global generation:  0.029269933700561523
r_  generation:  0.23325514793395996
local_output_nid generation:  0.012905359268188477
local_in_edges_tensor generation:  0.01256871223449707
mini_batch_src_global generation:  0.028790950775146484
r_  generation:  0.23093175888061523
local_output_nid generation:  0.01233220100402832
local_in_edges_tensor generation:  0.013370037078857422
mini_batch_src_global generation:  0.02843165397644043
r_  generation:  0.2254352569580078
local_output_nid generation:  0.012278556823730469
local_in_edges_tensor generation:  0.013034343719482422
mini_batch_src_global generation:  0.028851747512817383
r_  generation:  0.2331230640411377
local_output_nid generation:  0.012416601181030273
local_in_edges_tensor generation:  0.013715028762817383
mini_batch_src_global generation:  0.03043532371520996
r_  generation:  0.2353050708770752
local_output_nid generation:  0.012307405471801758
local_in_edges_tensor generation:  0.014731407165527344
mini_batch_src_global generation:  0.029248952865600586
r_  generation:  0.2334897518157959
----------------------check_connections_block total spend ----------------------------- 5.40207839012146
generate_one_block  0.29732656478881836
generate_one_block  0.29849791526794434
generate_one_block  0.308699369430542
generate_one_block  0.29486727714538574
generate_one_block  0.29445457458496094
generate_one_block  0.3016355037689209
generate_one_block  0.32071924209594727
generate_one_block  0.30910277366638184
generate_one_block  0.3007173538208008
generate_one_block  0.29526734352111816
generate_one_block  0.29702115058898926
generate_one_block  0.2935903072357178
generate_one_block  0.2867560386657715
generate_one_block  0.2925136089324951
generate_one_block  0.3001368045806885
generate_one_block  0.29532384872436523
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03357577323913574
gen group dst list time:  0.061199188232421875
time for parepare:  0.017334461212158203
local_output_nid generation:  0.024289846420288086
local_in_edges_tensor generation:  0.035356998443603516
mini_batch_src_global generation:  0.04034161567687988
r_  generation:  0.43915319442749023
local_output_nid generation:  0.029848098754882812
local_in_edges_tensor generation:  0.03553605079650879
mini_batch_src_global generation:  0.0538785457611084
r_  generation:  0.44394803047180176
local_output_nid generation:  0.03027796745300293
local_in_edges_tensor generation:  0.03184819221496582
mini_batch_src_global generation:  0.05082130432128906
r_  generation:  0.4538884162902832
local_output_nid generation:  0.030453920364379883
local_in_edges_tensor generation:  0.02875971794128418
mini_batch_src_global generation:  0.05241966247558594
r_  generation:  0.45101404190063477
local_output_nid generation:  0.030795574188232422
local_in_edges_tensor generation:  0.0728294849395752
mini_batch_src_global generation:  0.053113698959350586
r_  generation:  0.4585902690887451
local_output_nid generation:  0.030679702758789062
local_in_edges_tensor generation:  0.028151512145996094
mini_batch_src_global generation:  0.054245710372924805
r_  generation:  0.45789337158203125
local_output_nid generation:  0.03067302703857422
local_in_edges_tensor generation:  0.033209800720214844
mini_batch_src_global generation:  0.051340579986572266
r_  generation:  0.46149778366088867
local_output_nid generation:  0.030829429626464844
local_in_edges_tensor generation:  0.03138113021850586
mini_batch_src_global generation:  0.052950143814086914
r_  generation:  0.4546234607696533
local_output_nid generation:  0.03101491928100586
local_in_edges_tensor generation:  0.03451991081237793
mini_batch_src_global generation:  0.05116128921508789
r_  generation:  0.45740389823913574
local_output_nid generation:  0.031037092208862305
local_in_edges_tensor generation:  0.030100345611572266
mini_batch_src_global generation:  0.05477714538574219
r_  generation:  0.45326805114746094
local_output_nid generation:  0.03112030029296875
local_in_edges_tensor generation:  0.03058028221130371
mini_batch_src_global generation:  0.05181717872619629
r_  generation:  0.4626576900482178
local_output_nid generation:  0.031912803649902344
local_in_edges_tensor generation:  0.033031463623046875
mini_batch_src_global generation:  0.05273914337158203
r_  generation:  0.45118117332458496
local_output_nid generation:  0.030829191207885742
local_in_edges_tensor generation:  0.031411170959472656
mini_batch_src_global generation:  0.05112910270690918
r_  generation:  0.46018552780151367
local_output_nid generation:  0.031006813049316406
local_in_edges_tensor generation:  0.032470703125
mini_batch_src_global generation:  0.053243160247802734
r_  generation:  0.4516608715057373
local_output_nid generation:  0.03132486343383789
local_in_edges_tensor generation:  0.030271291732788086
mini_batch_src_global generation:  0.05164027214050293
r_  generation:  0.45981502532958984
local_output_nid generation:  0.031231164932250977
local_in_edges_tensor generation:  0.0335695743560791
mini_batch_src_global generation:  0.055132389068603516
r_  generation:  0.4524803161621094
----------------------check_connections_block total spend ----------------------------- 10.749400615692139
generate_one_block  0.5727527141571045
generate_one_block  0.5833346843719482
generate_one_block  0.5816617012023926
generate_one_block  0.57236647605896
generate_one_block  0.5833806991577148
generate_one_block  0.5795984268188477
generate_one_block  0.5732078552246094
generate_one_block  0.5907599925994873
generate_one_block  0.6088275909423828
generate_one_block  0.5749466419219971
generate_one_block  0.5742743015289307
generate_one_block  0.571669340133667
generate_one_block  0.5699338912963867
generate_one_block  0.5791187286376953
generate_one_block  0.5859019756317139
generate_one_block  0.5706663131713867
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11789798736572266  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

connection checking time:  16.1514790058136
block generation total time  14.059031009674072
average batch blocks generation time:  0.8786894381046295
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09458017349243164  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7392268180847168  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0945882797241211  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7463960647583008  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09496402740478516  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7528295516967773  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0946497917175293  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7472238540649414  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09476375579833984  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7454748153686523  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09470891952514648  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7528581619262695  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0947265625  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7438101768493652  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09458065032958984  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.751307487487793  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09479522705078125  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7443718910217285  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09437131881713867  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7443299293518066  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09473514556884766  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7446093559265137  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09427642822265625  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7414212226867676  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09447956085205078  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7392640113830566  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09427165985107422  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7425045967102051  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09482622146606445  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7530217170715332  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09471321105957031  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7427706718444824  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06451933085918427 |0.01238030195236206 |0.0036381036043167114 |8.819997310638428e-05 |0.0037421435117721558 |0.001705169677734375 |
----------------------------------------------------------pseudo_mini_loss sum 1.9534345865249634
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  5207212
Number of first layer input nodes during this epoch:  2480158
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11807870864868164  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02170729637145996
range selection method range initialization spend 0.012306928634643555
time for parepare:  0.016686677932739258
local_output_nid generation:  0.001417398452758789
local_in_edges_tensor generation:  0.006712436676025391
mini_batch_src_global generation:  0.0017485618591308594
r_  generation:  0.020720720291137695
local_output_nid generation:  0.0015828609466552734
local_in_edges_tensor generation:  0.0009949207305908203
mini_batch_src_global generation:  0.0020494461059570312
r_  generation:  0.022125244140625
local_output_nid generation:  0.0015730857849121094
local_in_edges_tensor generation:  0.0009329319000244141
mini_batch_src_global generation:  0.0016741752624511719
r_  generation:  0.02143096923828125
local_output_nid generation:  0.0015969276428222656
local_in_edges_tensor generation:  0.0009510517120361328
mini_batch_src_global generation:  0.0016798973083496094
r_  generation:  0.021046161651611328
local_output_nid generation:  0.0016262531280517578
local_in_edges_tensor generation:  0.0009219646453857422
mini_batch_src_global generation:  0.0016551017761230469
r_  generation:  0.02107548713684082
local_output_nid generation:  0.001596212387084961
local_in_edges_tensor generation:  0.0009407997131347656
mini_batch_src_global generation:  0.001657724380493164
r_  generation:  0.02149820327758789
local_output_nid generation:  0.0015909671783447266
local_in_edges_tensor generation:  0.0010056495666503906
mini_batch_src_global generation:  0.0016751289367675781
r_  generation:  0.021639108657836914
local_output_nid generation:  0.001589059829711914
local_in_edges_tensor generation:  0.000919342041015625
mini_batch_src_global generation:  0.0017139911651611328
r_  generation:  0.021712064743041992
local_output_nid generation:  0.0015878677368164062
local_in_edges_tensor generation:  0.0009601116180419922
mini_batch_src_global generation:  0.0017361640930175781
r_  generation:  0.021929025650024414
local_output_nid generation:  0.0015819072723388672
local_in_edges_tensor generation:  0.00096893310546875
mini_batch_src_global generation:  0.0017249584197998047
r_  generation:  0.02134394645690918
local_output_nid generation:  0.0016031265258789062
local_in_edges_tensor generation:  0.0009326934814453125
mini_batch_src_global generation:  0.0017774105072021484
r_  generation:  0.022338390350341797
local_output_nid generation:  0.0015833377838134766
local_in_edges_tensor generation:  0.0009279251098632812
mini_batch_src_global generation:  0.0017254352569580078
r_  generation:  0.021900653839111328
local_output_nid generation:  0.001581430435180664
local_in_edges_tensor generation:  0.0009744167327880859
mini_batch_src_global generation:  0.0017499923706054688
r_  generation:  0.021898269653320312
local_output_nid generation:  0.0016009807586669922
local_in_edges_tensor generation:  0.0009343624114990234
mini_batch_src_global generation:  0.0017240047454833984
r_  generation:  0.021976470947265625
local_output_nid generation:  0.0015783309936523438
local_in_edges_tensor generation:  0.0009114742279052734
mini_batch_src_global generation:  0.0017657279968261719
r_  generation:  0.022055387496948242
local_output_nid generation:  0.0015637874603271484
local_in_edges_tensor generation:  0.0009527206420898438
mini_batch_src_global generation:  0.0017323493957519531
r_  generation:  0.021811485290527344
----------------------check_connections_block total spend ----------------------------- 0.5129499435424805
generate_one_block  0.030286788940429688
generate_one_block  0.0312800407409668
generate_one_block  0.031188249588012695
generate_one_block  0.030933380126953125
generate_one_block  0.030898571014404297
generate_one_block  0.0326235294342041
generate_one_block  0.030742645263671875
generate_one_block  0.030870676040649414
generate_one_block  0.031446218490600586
generate_one_block  0.03045034408569336
generate_one_block  0.03169584274291992
generate_one_block  0.030950069427490234
generate_one_block  0.03112506866455078
generate_one_block  0.03085017204284668
generate_one_block  0.031360626220703125
generate_one_block  0.0313262939453125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.058706045150756836
gen group dst list time:  0.020677566528320312
time for parepare:  0.018778085708618164
local_output_nid generation:  0.007160186767578125
local_in_edges_tensor generation:  0.022246122360229492
mini_batch_src_global generation:  0.020917177200317383
r_  generation:  0.21056199073791504
local_output_nid generation:  0.011049270629882812
local_in_edges_tensor generation:  0.01581406593322754
mini_batch_src_global generation:  0.027792692184448242
r_  generation:  0.22493505477905273
local_output_nid generation:  0.011329174041748047
local_in_edges_tensor generation:  0.011985063552856445
mini_batch_src_global generation:  0.029474735260009766
r_  generation:  0.22386479377746582
local_output_nid generation:  0.01233053207397461
local_in_edges_tensor generation:  0.015439748764038086
mini_batch_src_global generation:  0.027388334274291992
r_  generation:  0.22692131996154785
local_output_nid generation:  0.012500762939453125
local_in_edges_tensor generation:  0.012386560440063477
mini_batch_src_global generation:  0.02822089195251465
r_  generation:  0.22914409637451172
local_output_nid generation:  0.012461423873901367
local_in_edges_tensor generation:  0.012602806091308594
mini_batch_src_global generation:  0.029788732528686523
r_  generation:  0.23023676872253418
local_output_nid generation:  0.01264190673828125
local_in_edges_tensor generation:  0.012737274169921875
mini_batch_src_global generation:  0.028699398040771484
r_  generation:  0.23109698295593262
local_output_nid generation:  0.01292729377746582
local_in_edges_tensor generation:  0.013636350631713867
mini_batch_src_global generation:  0.028894901275634766
r_  generation:  0.2317180633544922
local_output_nid generation:  0.012853860855102539
local_in_edges_tensor generation:  0.015484333038330078
mini_batch_src_global generation:  0.029171466827392578
r_  generation:  0.23412203788757324
local_output_nid generation:  0.01262044906616211
local_in_edges_tensor generation:  0.014079093933105469
mini_batch_src_global generation:  0.029407501220703125
r_  generation:  0.2281639575958252
local_output_nid generation:  0.013131141662597656
local_in_edges_tensor generation:  0.01320505142211914
mini_batch_src_global generation:  0.029565095901489258
r_  generation:  0.23626089096069336
local_output_nid generation:  0.012837409973144531
local_in_edges_tensor generation:  0.01250910758972168
mini_batch_src_global generation:  0.029387712478637695
r_  generation:  0.23319649696350098
local_output_nid generation:  0.01239466667175293
local_in_edges_tensor generation:  0.01372981071472168
mini_batch_src_global generation:  0.030496597290039062
r_  generation:  0.23573994636535645
local_output_nid generation:  0.012363672256469727
local_in_edges_tensor generation:  0.012954950332641602
mini_batch_src_global generation:  0.029297351837158203
r_  generation:  0.23098230361938477
local_output_nid generation:  0.012595653533935547
local_in_edges_tensor generation:  0.013190269470214844
mini_batch_src_global generation:  0.029474258422851562
r_  generation:  0.2363431453704834
local_output_nid generation:  0.01218414306640625
local_in_edges_tensor generation:  0.012687921524047852
mini_batch_src_global generation:  0.029978036880493164
r_  generation:  0.22910785675048828
----------------------check_connections_block total spend ----------------------------- 5.373143672943115
generate_one_block  0.2920365333557129
generate_one_block  0.30074024200439453
generate_one_block  0.2962310314178467
generate_one_block  0.2971067428588867
generate_one_block  0.2932770252227783
generate_one_block  0.2955343723297119
generate_one_block  0.3203902244567871
generate_one_block  0.29689478874206543
generate_one_block  0.3025970458984375
generate_one_block  0.2889394760131836
generate_one_block  0.29885435104370117
generate_one_block  0.2951622009277344
generate_one_block  0.30178284645080566
generate_one_block  0.29704952239990234
generate_one_block  0.29883623123168945
generate_one_block  0.2964363098144531
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.031031370162963867
gen group dst list time:  0.06227755546569824
time for parepare:  0.017026424407958984
local_output_nid generation:  0.02414727210998535
local_in_edges_tensor generation:  0.03793764114379883
mini_batch_src_global generation:  0.04080367088317871
r_  generation:  0.4383358955383301
local_output_nid generation:  0.029015779495239258
local_in_edges_tensor generation:  0.0342862606048584
mini_batch_src_global generation:  0.05165743827819824
r_  generation:  0.4451315402984619
local_output_nid generation:  0.029683351516723633
local_in_edges_tensor generation:  0.030477046966552734
mini_batch_src_global generation:  0.0505681037902832
r_  generation:  0.4545145034790039
local_output_nid generation:  0.030066490173339844
local_in_edges_tensor generation:  0.02930450439453125
mini_batch_src_global generation:  0.05171680450439453
r_  generation:  0.4480412006378174
local_output_nid generation:  0.029998302459716797
local_in_edges_tensor generation:  0.07359552383422852
mini_batch_src_global generation:  0.05116748809814453
r_  generation:  0.4548804759979248
local_output_nid generation:  0.030376672744750977
local_in_edges_tensor generation:  0.02980184555053711
mini_batch_src_global generation:  0.05477595329284668
r_  generation:  0.45407652854919434
local_output_nid generation:  0.030701637268066406
local_in_edges_tensor generation:  0.03166007995605469
mini_batch_src_global generation:  0.051846981048583984
r_  generation:  0.4557030200958252
local_output_nid generation:  0.030578136444091797
local_in_edges_tensor generation:  0.031293630599975586
mini_batch_src_global generation:  0.05425524711608887
r_  generation:  0.4514963626861572
local_output_nid generation:  0.0306546688079834
local_in_edges_tensor generation:  0.031461238861083984
mini_batch_src_global generation:  0.0515744686126709
r_  generation:  0.4584789276123047
local_output_nid generation:  0.03052067756652832
local_in_edges_tensor generation:  0.02923130989074707
mini_batch_src_global generation:  0.05261421203613281
r_  generation:  0.45601916313171387
local_output_nid generation:  0.0306243896484375
local_in_edges_tensor generation:  0.030974388122558594
mini_batch_src_global generation:  0.05126833915710449
r_  generation:  0.4601261615753174
local_output_nid generation:  0.03025221824645996
local_in_edges_tensor generation:  0.03115105628967285
mini_batch_src_global generation:  0.05292916297912598
r_  generation:  0.45617222785949707
local_output_nid generation:  0.030893325805664062
local_in_edges_tensor generation:  0.03193092346191406
mini_batch_src_global generation:  0.0521848201751709
r_  generation:  0.46064305305480957
local_output_nid generation:  0.030083417892456055
local_in_edges_tensor generation:  0.029454708099365234
mini_batch_src_global generation:  0.05307817459106445
r_  generation:  0.4555938243865967
local_output_nid generation:  0.030640602111816406
local_in_edges_tensor generation:  0.03189277648925781
mini_batch_src_global generation:  0.05491065979003906
r_  generation:  0.4616262912750244
local_output_nid generation:  0.030848264694213867
local_in_edges_tensor generation:  0.03304004669189453
mini_batch_src_global generation:  0.056557655334472656
r_  generation:  0.4526667594909668
----------------------check_connections_block total spend ----------------------------- 10.725579261779785
generate_one_block  0.5695271492004395
generate_one_block  0.5671770572662354
generate_one_block  0.5709936618804932
generate_one_block  0.5756409168243408
generate_one_block  0.5683763027191162
generate_one_block  0.5810742378234863
generate_one_block  0.5740258693695068
generate_one_block  0.5796897411346436
generate_one_block  0.6220707893371582
generate_one_block  0.5791614055633545
generate_one_block  0.5932724475860596
generate_one_block  0.5665204524993896
generate_one_block  0.5859508514404297
generate_one_block  0.5734872817993164
generate_one_block  0.5819249153137207
generate_one_block  0.5734858512878418
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11807870864868164  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

connection checking time:  16.0987229347229
block generation total time  14.034247875213623
average batch blocks generation time:  0.8771404922008514
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09438657760620117  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7430219650268555  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09482955932617188  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7499628067016602  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09450769424438477  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7457141876220703  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09476661682128906  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7472014427185059  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09438610076904297  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7430987358093262  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09473991394042969  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7464995384216309  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09448909759521484  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7435131072998047  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0947713851928711  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7446107864379883  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09436941146850586  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7442927360534668  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09456253051757812  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.739509105682373  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09451055526733398  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7483630180358887  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09475326538085938  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.744713306427002  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09467267990112305  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7520294189453125  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09471702575683594  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7438373565673828  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0947103500366211  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7522540092468262  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09465599060058594  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7442121505737305  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06456206738948822 |0.012736499309539795 |0.003493085503578186 |8.524954319000244e-05 |0.0037042200565338135 |0.002844095230102539 |
----------------------------------------------------------pseudo_mini_loss sum 1.8702921867370605
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  5211190
Number of first layer input nodes during this epoch:  2481524
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11788606643676758  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020125865936279297
range selection method range initialization spend 0.012300968170166016
time for parepare:  0.01760554313659668
local_output_nid generation:  0.001383066177368164
local_in_edges_tensor generation:  0.006447792053222656
mini_batch_src_global generation:  0.002141237258911133
r_  generation:  0.020683765411376953
local_output_nid generation:  0.001605987548828125
local_in_edges_tensor generation:  0.0009591579437255859
mini_batch_src_global generation:  0.0022258758544921875
r_  generation:  0.021627426147460938
local_output_nid generation:  0.0016400814056396484
local_in_edges_tensor generation:  0.0009262561798095703
mini_batch_src_global generation:  0.0016398429870605469
r_  generation:  0.02119731903076172
local_output_nid generation:  0.0016787052154541016
local_in_edges_tensor generation:  0.0009360313415527344
mini_batch_src_global generation:  0.0016825199127197266
r_  generation:  0.020457983016967773
local_output_nid generation:  0.001636505126953125
local_in_edges_tensor generation:  0.0009472370147705078
mini_batch_src_global generation:  0.001636505126953125
r_  generation:  0.02161574363708496
local_output_nid generation:  0.0016286373138427734
local_in_edges_tensor generation:  0.0009412765502929688
mini_batch_src_global generation:  0.0016858577728271484
r_  generation:  0.021098852157592773
local_output_nid generation:  0.0016412734985351562
local_in_edges_tensor generation:  0.0009114742279052734
mini_batch_src_global generation:  0.0017242431640625
r_  generation:  0.022244930267333984
local_output_nid generation:  0.0016274452209472656
local_in_edges_tensor generation:  0.0008976459503173828
mini_batch_src_global generation:  0.00168609619140625
r_  generation:  0.021810531616210938
local_output_nid generation:  0.0016331672668457031
local_in_edges_tensor generation:  0.0008866786956787109
mini_batch_src_global generation:  0.001741170883178711
r_  generation:  0.02292609214782715
local_output_nid generation:  0.0016357898712158203
local_in_edges_tensor generation:  0.0011396408081054688
mini_batch_src_global generation:  0.0017423629760742188
r_  generation:  0.022025108337402344
local_output_nid generation:  0.001667022705078125
local_in_edges_tensor generation:  0.0009052753448486328
mini_batch_src_global generation:  0.0017480850219726562
r_  generation:  0.022244691848754883
local_output_nid generation:  0.0016498565673828125
local_in_edges_tensor generation:  0.000919342041015625
mini_batch_src_global generation:  0.001689910888671875
r_  generation:  0.021749258041381836
local_output_nid generation:  0.001661062240600586
local_in_edges_tensor generation:  0.0008959770202636719
mini_batch_src_global generation:  0.0017249584197998047
r_  generation:  0.02195882797241211
local_output_nid generation:  0.0016536712646484375
local_in_edges_tensor generation:  0.0009055137634277344
mini_batch_src_global generation:  0.0017063617706298828
r_  generation:  0.022088050842285156
local_output_nid generation:  0.001657247543334961
local_in_edges_tensor generation:  0.0009520053863525391
mini_batch_src_global generation:  0.0017228126525878906
r_  generation:  0.0214688777923584
local_output_nid generation:  0.0016369819641113281
local_in_edges_tensor generation:  0.0009188652038574219
mini_batch_src_global generation:  0.001725912094116211
r_  generation:  0.0220794677734375
----------------------check_connections_block total spend ----------------------------- 0.5160348415374756
generate_one_block  0.030657529830932617
generate_one_block  0.03082561492919922
generate_one_block  0.031031131744384766
generate_one_block  0.030040502548217773
generate_one_block  0.031070470809936523
generate_one_block  0.03207540512084961
generate_one_block  0.03131914138793945
generate_one_block  0.031009197235107422
generate_one_block  0.03185701370239258
generate_one_block  0.03110671043395996
generate_one_block  0.031542062759399414
generate_one_block  0.030805349349975586
generate_one_block  0.031249523162841797
generate_one_block  0.03156113624572754
generate_one_block  0.03069019317626953
generate_one_block  0.03189373016357422
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03147697448730469
gen group dst list time:  0.01830601692199707
time for parepare:  0.0186765193939209
local_output_nid generation:  0.007222414016723633
local_in_edges_tensor generation:  0.0211026668548584
mini_batch_src_global generation:  0.02104020118713379
r_  generation:  0.21226739883422852
local_output_nid generation:  0.01071476936340332
local_in_edges_tensor generation:  0.015365123748779297
mini_batch_src_global generation:  0.02756810188293457
r_  generation:  0.2169334888458252
local_output_nid generation:  0.011364459991455078
local_in_edges_tensor generation:  0.01172947883605957
mini_batch_src_global generation:  0.026124000549316406
r_  generation:  0.2246851921081543
local_output_nid generation:  0.012054204940795898
local_in_edges_tensor generation:  0.01189732551574707
mini_batch_src_global generation:  0.03011608123779297
r_  generation:  0.22179412841796875
local_output_nid generation:  0.012290000915527344
local_in_edges_tensor generation:  0.01172494888305664
mini_batch_src_global generation:  0.03022313117980957
r_  generation:  0.23095083236694336
local_output_nid generation:  0.012176513671875
local_in_edges_tensor generation:  0.012060880661010742
mini_batch_src_global generation:  0.028325796127319336
r_  generation:  0.22745323181152344
local_output_nid generation:  0.012961864471435547
local_in_edges_tensor generation:  0.01646113395690918
mini_batch_src_global generation:  0.03004932403564453
r_  generation:  0.23299050331115723
local_output_nid generation:  0.012691974639892578
local_in_edges_tensor generation:  0.012167215347290039
mini_batch_src_global generation:  0.028575658798217773
r_  generation:  0.227217435836792
local_output_nid generation:  0.012997865676879883
local_in_edges_tensor generation:  0.012788534164428711
mini_batch_src_global generation:  0.029491662979125977
r_  generation:  0.23517966270446777
local_output_nid generation:  0.012937068939208984
local_in_edges_tensor generation:  0.013423919677734375
mini_batch_src_global generation:  0.029308080673217773
r_  generation:  0.2345125675201416
local_output_nid generation:  0.013177156448364258
local_in_edges_tensor generation:  0.01475381851196289
mini_batch_src_global generation:  0.030877113342285156
r_  generation:  0.239654541015625
local_output_nid generation:  0.012772798538208008
local_in_edges_tensor generation:  0.012807130813598633
mini_batch_src_global generation:  0.02956676483154297
r_  generation:  0.23392200469970703
local_output_nid generation:  0.01324152946472168
local_in_edges_tensor generation:  0.01321864128112793
mini_batch_src_global generation:  0.0298464298248291
r_  generation:  0.23588871955871582
local_output_nid generation:  0.012436628341674805
local_in_edges_tensor generation:  0.013002157211303711
mini_batch_src_global generation:  0.029464244842529297
r_  generation:  0.23459434509277344
local_output_nid generation:  0.012121915817260742
local_in_edges_tensor generation:  0.013283014297485352
mini_batch_src_global generation:  0.028596162796020508
r_  generation:  0.22844505310058594
local_output_nid generation:  0.012341022491455078
local_in_edges_tensor generation:  0.013710498809814453
mini_batch_src_global generation:  0.029562711715698242
r_  generation:  0.23769021034240723
----------------------check_connections_block total spend ----------------------------- 5.367433786392212
generate_one_block  0.3037605285644531
generate_one_block  0.29102325439453125
generate_one_block  0.29509449005126953
generate_one_block  0.2894918918609619
generate_one_block  0.29547667503356934
generate_one_block  0.29220128059387207
generate_one_block  0.32468461990356445
generate_one_block  0.28890228271484375
generate_one_block  0.3070347309112549
generate_one_block  0.29731249809265137
generate_one_block  0.30558085441589355
generate_one_block  0.29724669456481934
generate_one_block  0.30217981338500977
generate_one_block  0.3013122081756592
generate_one_block  0.29505181312561035
generate_one_block  0.3007345199584961
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0312347412109375
gen group dst list time:  0.06066274642944336
time for parepare:  0.01776909828186035
local_output_nid generation:  0.024911880493164062
local_in_edges_tensor generation:  0.035830020904541016
mini_batch_src_global generation:  0.04151344299316406
r_  generation:  0.4408853054046631
local_output_nid generation:  0.030156373977661133
local_in_edges_tensor generation:  0.03282594680786133
mini_batch_src_global generation:  0.05383586883544922
r_  generation:  0.4392867088317871
local_output_nid generation:  0.030208349227905273
local_in_edges_tensor generation:  0.02816009521484375
mini_batch_src_global generation:  0.04992318153381348
r_  generation:  0.4501030445098877
local_output_nid generation:  0.03042459487915039
local_in_edges_tensor generation:  0.029561758041381836
mini_batch_src_global generation:  0.05206131935119629
r_  generation:  0.4434835910797119
local_output_nid generation:  0.03065633773803711
local_in_edges_tensor generation:  0.06936931610107422
mini_batch_src_global generation:  0.05283927917480469
r_  generation:  0.4538075923919678
local_output_nid generation:  0.030911922454833984
local_in_edges_tensor generation:  0.029900312423706055
mini_batch_src_global generation:  0.054601430892944336
r_  generation:  0.45027923583984375
local_output_nid generation:  0.030971288681030273
local_in_edges_tensor generation:  0.029703855514526367
mini_batch_src_global generation:  0.0522761344909668
r_  generation:  0.45758557319641113
local_output_nid generation:  0.030866146087646484
local_in_edges_tensor generation:  0.029624223709106445
mini_batch_src_global generation:  0.054779052734375
r_  generation:  0.45110177993774414
local_output_nid generation:  0.0307009220123291
local_in_edges_tensor generation:  0.02851700782775879
mini_batch_src_global generation:  0.051779985427856445
r_  generation:  0.45686912536621094
local_output_nid generation:  0.03085494041442871
local_in_edges_tensor generation:  0.028708219528198242
mini_batch_src_global generation:  0.05280613899230957
r_  generation:  0.4507925510406494
local_output_nid generation:  0.031202316284179688
local_in_edges_tensor generation:  0.03071117401123047
mini_batch_src_global generation:  0.05276823043823242
r_  generation:  0.4606449604034424
local_output_nid generation:  0.03131723403930664
local_in_edges_tensor generation:  0.02864861488342285
mini_batch_src_global generation:  0.05296587944030762
r_  generation:  0.45099425315856934
local_output_nid generation:  0.03110027313232422
local_in_edges_tensor generation:  0.030185699462890625
mini_batch_src_global generation:  0.05211496353149414
r_  generation:  0.46096110343933105
local_output_nid generation:  0.0311281681060791
local_in_edges_tensor generation:  0.02988910675048828
mini_batch_src_global generation:  0.05294060707092285
r_  generation:  0.45137715339660645
local_output_nid generation:  0.031013011932373047
local_in_edges_tensor generation:  0.030424833297729492
mini_batch_src_global generation:  0.05200529098510742
r_  generation:  0.4563608169555664
local_output_nid generation:  0.03151345252990723
local_in_edges_tensor generation:  0.02882242202758789
mini_batch_src_global generation:  0.052170753479003906
r_  generation:  0.4565916061401367
----------------------check_connections_block total spend ----------------------------- 10.667516708374023
generate_one_block  0.5698354244232178
generate_one_block  0.5677545070648193
generate_one_block  0.5708661079406738
generate_one_block  0.5741474628448486
generate_one_block  0.5721068382263184
generate_one_block  0.5737521648406982
generate_one_block  0.5770692825317383
generate_one_block  0.57578444480896
generate_one_block  0.599358081817627
generate_one_block  0.5738391876220703
generate_one_block  0.588798999786377
generate_one_block  0.5730416774749756
generate_one_block  0.5762207508087158
generate_one_block  0.5749003887176514
generate_one_block  0.5685622692108154
generate_one_block  0.5801410675048828
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11788606643676758  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

connection checking time:  16.034950494766235
block generation total time  14.00326681137085
average batch blocks generation time:  0.8752041757106781
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09446859359741211  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7455625534057617  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09462833404541016  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7423563003540039  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0943608283996582  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.742699146270752  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09459877014160156  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7401809692382812  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09429407119750977  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7440686225891113  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09468460083007812  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7416305541992188  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09452676773071289  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7494487762451172  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0946197509765625  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7452874183654785  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0944523811340332  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7480592727661133  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09477710723876953  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7447080612182617  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09468698501586914  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7536911964416504  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09477901458740234  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7440032958984375  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09459829330444336  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7520761489868164  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09483051300048828  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7502069473266602  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09421920776367188  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.740837574005127  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0948486328125  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7511739730834961  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06486429274082184 |0.011482089757919312 |0.00354611873626709 |8.895993232727051e-05 |0.0037774741649627686 |0.002821207046508789 |
----------------------------------------------------------pseudo_mini_loss sum 1.7907136678695679
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  5206704
Number of first layer input nodes during this epoch:  2478900
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11846208572387695  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024129629135131836
range selection method range initialization spend 0.012518882751464844
time for parepare:  0.01834869384765625
local_output_nid generation:  0.0014231204986572266
local_in_edges_tensor generation:  0.0033249855041503906
mini_batch_src_global generation:  0.001706838607788086
r_  generation:  0.020444154739379883
local_output_nid generation:  0.0015606880187988281
local_in_edges_tensor generation:  0.0010151863098144531
mini_batch_src_global generation:  0.0019979476928710938
r_  generation:  0.023027896881103516
local_output_nid generation:  0.0015752315521240234
local_in_edges_tensor generation:  0.0010023117065429688
mini_batch_src_global generation:  0.0016505718231201172
r_  generation:  0.021198749542236328
local_output_nid generation:  0.0016388893127441406
local_in_edges_tensor generation:  0.0009665489196777344
mini_batch_src_global generation:  0.001683950424194336
r_  generation:  0.021968364715576172
local_output_nid generation:  0.0015747547149658203
local_in_edges_tensor generation:  0.0009794235229492188
mini_batch_src_global generation:  0.001752614974975586
r_  generation:  0.022295236587524414
local_output_nid generation:  0.0015850067138671875
local_in_edges_tensor generation:  0.001016378402709961
mini_batch_src_global generation:  0.0017843246459960938
r_  generation:  0.02260589599609375
local_output_nid generation:  0.0016124248504638672
local_in_edges_tensor generation:  0.0009493827819824219
mini_batch_src_global generation:  0.0018024444580078125
r_  generation:  0.022545814514160156
local_output_nid generation:  0.0015821456909179688
local_in_edges_tensor generation:  0.0009634494781494141
mini_batch_src_global generation:  0.001786947250366211
r_  generation:  0.02259516716003418
local_output_nid generation:  0.0015850067138671875
local_in_edges_tensor generation:  0.0009937286376953125
mini_batch_src_global generation:  0.0017764568328857422
r_  generation:  0.022203445434570312
local_output_nid generation:  0.0015766620635986328
local_in_edges_tensor generation:  0.0009913444519042969
mini_batch_src_global generation:  0.0017080307006835938
r_  generation:  0.022164106369018555
local_output_nid generation:  0.0015952587127685547
local_in_edges_tensor generation:  0.0009963512420654297
mini_batch_src_global generation:  0.0017609596252441406
r_  generation:  0.022368192672729492
local_output_nid generation:  0.001577615737915039
local_in_edges_tensor generation:  0.000957489013671875
mini_batch_src_global generation:  0.0017936229705810547
r_  generation:  0.022740840911865234
local_output_nid generation:  0.0015947818756103516
local_in_edges_tensor generation:  0.0009860992431640625
mini_batch_src_global generation:  0.0017533302307128906
r_  generation:  0.02195453643798828
local_output_nid generation:  0.001554727554321289
local_in_edges_tensor generation:  0.0009801387786865234
mini_batch_src_global generation:  0.0017523765563964844
r_  generation:  0.022673368453979492
local_output_nid generation:  0.0016002655029296875
local_in_edges_tensor generation:  0.0010650157928466797
mini_batch_src_global generation:  0.0018308162689208984
r_  generation:  0.022722959518432617
local_output_nid generation:  0.0015799999237060547
local_in_edges_tensor generation:  0.001010894775390625
mini_batch_src_global generation:  0.0017671585083007812
r_  generation:  0.022769927978515625
----------------------check_connections_block total spend ----------------------------- 0.5276389122009277
generate_one_block  0.030470848083496094
generate_one_block  0.03269767761230469
generate_one_block  0.030679941177368164
generate_one_block  0.03099679946899414
generate_one_block  0.031581878662109375
generate_one_block  0.03421211242675781
generate_one_block  0.03212285041809082
generate_one_block  0.03133654594421387
generate_one_block  0.03092193603515625
generate_one_block  0.030651569366455078
generate_one_block  0.031243324279785156
generate_one_block  0.03189897537231445
generate_one_block  0.031133174896240234
generate_one_block  0.03165125846862793
generate_one_block  0.03212928771972656
generate_one_block  0.03186321258544922
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.09126138687133789
gen group dst list time:  0.023457765579223633
time for parepare:  0.02060675621032715
local_output_nid generation:  0.0075833797454833984
local_in_edges_tensor generation:  0.027168989181518555
mini_batch_src_global generation:  0.021901369094848633
r_  generation:  0.21435117721557617
local_output_nid generation:  0.011422157287597656
local_in_edges_tensor generation:  0.014765024185180664
mini_batch_src_global generation:  0.02892780303955078
r_  generation:  0.22504115104675293
local_output_nid generation:  0.011544227600097656
local_in_edges_tensor generation:  0.012556791305541992
mini_batch_src_global generation:  0.0256497859954834
r_  generation:  0.22066831588745117
local_output_nid generation:  0.01252436637878418
local_in_edges_tensor generation:  0.01475214958190918
mini_batch_src_global generation:  0.027207136154174805
r_  generation:  0.22829246520996094
local_output_nid generation:  0.0129547119140625
local_in_edges_tensor generation:  0.016391515731811523
mini_batch_src_global generation:  0.02951526641845703
r_  generation:  0.2373368740081787
local_output_nid generation:  0.013039827346801758
local_in_edges_tensor generation:  0.016449689865112305
mini_batch_src_global generation:  0.03024744987487793
r_  generation:  0.23784089088439941
local_output_nid generation:  0.013183355331420898
local_in_edges_tensor generation:  0.013169050216674805
mini_batch_src_global generation:  0.02942204475402832
r_  generation:  0.2385547161102295
local_output_nid generation:  0.013220071792602539
local_in_edges_tensor generation:  0.01274871826171875
mini_batch_src_global generation:  0.0293886661529541
r_  generation:  0.2337946891784668
local_output_nid generation:  0.013136148452758789
local_in_edges_tensor generation:  0.012438535690307617
mini_batch_src_global generation:  0.02948784828186035
r_  generation:  0.23578333854675293
local_output_nid generation:  0.013031482696533203
local_in_edges_tensor generation:  0.012595891952514648
mini_batch_src_global generation:  0.02929401397705078
r_  generation:  0.2337493896484375
local_output_nid generation:  0.013167142868041992
local_in_edges_tensor generation:  0.012304306030273438
mini_batch_src_global generation:  0.029006242752075195
r_  generation:  0.23885226249694824
local_output_nid generation:  0.013320684432983398
local_in_edges_tensor generation:  0.012819528579711914
mini_batch_src_global generation:  0.030009746551513672
r_  generation:  0.24121785163879395
local_output_nid generation:  0.013365745544433594
local_in_edges_tensor generation:  0.012560129165649414
mini_batch_src_global generation:  0.02921891212463379
r_  generation:  0.23831582069396973
local_output_nid generation:  0.01298213005065918
local_in_edges_tensor generation:  0.012925863265991211
mini_batch_src_global generation:  0.029709577560424805
r_  generation:  0.23984098434448242
local_output_nid generation:  0.012858867645263672
local_in_edges_tensor generation:  0.01451253890991211
mini_batch_src_global generation:  0.030997276306152344
r_  generation:  0.2445831298828125
local_output_nid generation:  0.012761831283569336
local_in_edges_tensor generation:  0.015119552612304688
mini_batch_src_global generation:  0.03003692626953125
r_  generation:  0.24217796325683594
----------------------check_connections_block total spend ----------------------------- 5.478899955749512
generate_one_block  0.2993171215057373
generate_one_block  0.3004035949707031
generate_one_block  0.28708934783935547
generate_one_block  0.29631900787353516
generate_one_block  0.30222630500793457
generate_one_block  0.3058042526245117
generate_one_block  0.3213016986846924
generate_one_block  0.296001672744751
generate_one_block  0.29822683334350586
generate_one_block  0.29505252838134766
generate_one_block  0.30229687690734863
generate_one_block  0.30730748176574707
generate_one_block  0.296924352645874
generate_one_block  0.3028390407562256
generate_one_block  0.3109407424926758
generate_one_block  0.3059566020965576
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0360414981842041
gen group dst list time:  0.062467098236083984
time for parepare:  0.01785874366760254
local_output_nid generation:  0.02512049674987793
local_in_edges_tensor generation:  0.03821086883544922
mini_batch_src_global generation:  0.0409090518951416
r_  generation:  0.4445044994354248
local_output_nid generation:  0.030259370803833008
local_in_edges_tensor generation:  0.03645825386047363
mini_batch_src_global generation:  0.057035207748413086
r_  generation:  0.4455232620239258
local_output_nid generation:  0.030952930450439453
local_in_edges_tensor generation:  0.029529094696044922
mini_batch_src_global generation:  0.050711870193481445
r_  generation:  0.45595574378967285
local_output_nid generation:  0.030999183654785156
local_in_edges_tensor generation:  0.02906513214111328
mini_batch_src_global generation:  0.05539417266845703
r_  generation:  0.4519228935241699
local_output_nid generation:  0.03226351737976074
local_in_edges_tensor generation:  0.07309317588806152
mini_batch_src_global generation:  0.05877065658569336
r_  generation:  0.4650599956512451
local_output_nid generation:  0.03141331672668457
local_in_edges_tensor generation:  0.031233787536621094
mini_batch_src_global generation:  0.053183555603027344
r_  generation:  0.4602377414703369
local_output_nid generation:  0.03197884559631348
local_in_edges_tensor generation:  0.03148698806762695
mini_batch_src_global generation:  0.053087711334228516
r_  generation:  0.46288013458251953
local_output_nid generation:  0.03156280517578125
local_in_edges_tensor generation:  0.02912592887878418
mini_batch_src_global generation:  0.0550534725189209
r_  generation:  0.45718979835510254
local_output_nid generation:  0.03172016143798828
local_in_edges_tensor generation:  0.03316664695739746
mini_batch_src_global generation:  0.051839590072631836
r_  generation:  0.4667019844055176
local_output_nid generation:  0.03168940544128418
local_in_edges_tensor generation:  0.03202557563781738
mini_batch_src_global generation:  0.056305885314941406
r_  generation:  0.45888352394104004
local_output_nid generation:  0.03148484230041504
local_in_edges_tensor generation:  0.03232908248901367
mini_batch_src_global generation:  0.06598329544067383
r_  generation:  0.46615028381347656
local_output_nid generation:  0.03208208084106445
local_in_edges_tensor generation:  0.03583168983459473
mini_batch_src_global generation:  0.05373430252075195
r_  generation:  0.46021223068237305
local_output_nid generation:  0.0319676399230957
local_in_edges_tensor generation:  0.036921024322509766
mini_batch_src_global generation:  0.07468199729919434
r_  generation:  0.46981215476989746
local_output_nid generation:  0.03389239311218262
local_in_edges_tensor generation:  0.03411602973937988
mini_batch_src_global generation:  0.05391287803649902
r_  generation:  0.46044397354125977
local_output_nid generation:  0.03312110900878906
local_in_edges_tensor generation:  0.033989667892456055
mini_batch_src_global generation:  0.05322837829589844
r_  generation:  0.4681110382080078
local_output_nid generation:  0.032776832580566406
local_in_edges_tensor generation:  0.030983924865722656
mini_batch_src_global generation:  0.05559682846069336
r_  generation:  0.4584619998931885
----------------------check_connections_block total spend ----------------------------- 10.93711256980896
generate_one_block  0.5797083377838135
generate_one_block  0.5793709754943848
generate_one_block  0.5779633522033691
generate_one_block  0.5799257755279541
generate_one_block  0.5932512283325195
generate_one_block  0.5860593318939209
generate_one_block  0.5800707340240479
generate_one_block  0.5802795886993408
generate_one_block  0.6524209976196289
generate_one_block  0.5910789966583252
generate_one_block  0.5822968482971191
generate_one_block  0.5865755081176758
generate_one_block  0.5780482292175293
generate_one_block  0.5862884521484375
generate_one_block  0.5857264995574951
generate_one_block  0.5934903621673584
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11846208572387695  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

connection checking time:  16.41601252555847
block generation total time  14.240562677383423
average batch blocks generation time:  0.8900351673364639
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09424066543579102  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7400321960449219  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09481048583984375  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7478628158569336  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09430170059204102  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7397174835205078  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09466266632080078  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.742154598236084  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09474563598632812  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7538332939147949  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0948953628540039  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.748713493347168  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09439420700073242  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7442560195922852  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09472084045410156  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7452335357666016  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09452009201049805  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7452945709228516  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09458160400390625  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7414288520812988  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09451627731323242  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7444696426391602  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09486770629882812  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7475743293762207  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09456539154052734  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7449755668640137  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09485149383544922  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7459716796875  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09476995468139648  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7549142837524414  GigaBytes
Max Memory Allocated: 0.8440852165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09491634368896484  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7522482872009277  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06556068360805511 |0.012396425008773804 |0.003602072596549988 |8.952617645263672e-05 |0.0037075430154800415 |0.0030465126037597656 |
----------------------------------------------------------pseudo_mini_loss sum 1.6992331743240356
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  5212084
Number of first layer input nodes during this epoch:  2481693
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11961221694946289  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022794485092163086
range selection method range initialization spend 0.012328147888183594
time for parepare:  0.01720428466796875
local_output_nid generation:  0.0014157295227050781
local_in_edges_tensor generation:  0.005522727966308594
mini_batch_src_global generation:  0.001828908920288086
r_  generation:  0.02046990394592285
local_output_nid generation:  0.0015685558319091797
local_in_edges_tensor generation:  0.0009925365447998047
mini_batch_src_global generation:  0.001967191696166992
r_  generation:  0.021617650985717773
local_output_nid generation:  0.0015668869018554688
local_in_edges_tensor generation:  0.0009627342224121094
mini_batch_src_global generation:  0.0016567707061767578
r_  generation:  0.02135181427001953
local_output_nid generation:  0.0016198158264160156
local_in_edges_tensor generation:  0.0009534358978271484
mini_batch_src_global generation:  0.0017490386962890625
r_  generation:  0.021805286407470703
local_output_nid generation:  0.0015697479248046875
local_in_edges_tensor generation:  0.00090789794921875
mini_batch_src_global generation:  0.0017747879028320312
r_  generation:  0.02231884002685547
local_output_nid generation:  0.0016040802001953125
local_in_edges_tensor generation:  0.0009975433349609375
mini_batch_src_global generation:  0.0017795562744140625
r_  generation:  0.022068262100219727
local_output_nid generation:  0.0016164779663085938
local_in_edges_tensor generation:  0.0009760856628417969
mini_batch_src_global generation:  0.0017917156219482422
r_  generation:  0.022562026977539062
local_output_nid generation:  0.0016169548034667969
local_in_edges_tensor generation:  0.0009512901306152344
mini_batch_src_global generation:  0.001779317855834961
r_  generation:  0.02217698097229004
local_output_nid generation:  0.001634836196899414
local_in_edges_tensor generation:  0.0012462139129638672
mini_batch_src_global generation:  0.0017175674438476562
r_  generation:  0.021782398223876953
local_output_nid generation:  0.0015935897827148438
local_in_edges_tensor generation:  0.001009225845336914
mini_batch_src_global generation:  0.001753091812133789
r_  generation:  0.02231311798095703
local_output_nid generation:  0.0015866756439208984
local_in_edges_tensor generation:  0.0010335445404052734
mini_batch_src_global generation:  0.0017511844635009766
r_  generation:  0.0221860408782959
local_output_nid generation:  0.0015821456909179688
local_in_edges_tensor generation:  0.0010523796081542969
mini_batch_src_global generation:  0.0017781257629394531
r_  generation:  0.02266979217529297
local_output_nid generation:  0.0015740394592285156
local_in_edges_tensor generation:  0.0010864734649658203
mini_batch_src_global generation:  0.0017578601837158203
r_  generation:  0.022332191467285156
local_output_nid generation:  0.0015637874603271484
local_in_edges_tensor generation:  0.0011167526245117188
mini_batch_src_global generation:  0.0017423629760742188
r_  generation:  0.02183079719543457
local_output_nid generation:  0.0015513896942138672
local_in_edges_tensor generation:  0.0011174678802490234
mini_batch_src_global generation:  0.001775503158569336
r_  generation:  0.02232646942138672
local_output_nid generation:  0.0015561580657958984
local_in_edges_tensor generation:  0.001140594482421875
mini_batch_src_global generation:  0.0019061565399169922
r_  generation:  0.022818565368652344
----------------------check_connections_block total spend ----------------------------- 0.5230555534362793
generate_one_block  0.03293156623840332
generate_one_block  0.031122446060180664
generate_one_block  0.031071186065673828
generate_one_block  0.03184986114501953
generate_one_block  0.03418135643005371
generate_one_block  0.03320717811584473
generate_one_block  0.031911611557006836
generate_one_block  0.031024694442749023
generate_one_block  0.030658245086669922
generate_one_block  0.03176617622375488
generate_one_block  0.030843257904052734
generate_one_block  0.03230118751525879
generate_one_block  0.03221273422241211
generate_one_block  0.031230926513671875
generate_one_block  0.03159761428833008
generate_one_block  0.03232002258300781
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03273653984069824
gen group dst list time:  0.018239974975585938
time for parepare:  0.019307613372802734
local_output_nid generation:  0.007639884948730469
local_in_edges_tensor generation:  0.023067235946655273
mini_batch_src_global generation:  0.02376556396484375
r_  generation:  0.21834397315979004
local_output_nid generation:  0.011310338973999023
local_in_edges_tensor generation:  0.018306255340576172
mini_batch_src_global generation:  0.03097224235534668
r_  generation:  0.22417163848876953
local_output_nid generation:  0.012058258056640625
local_in_edges_tensor generation:  0.018026113510131836
mini_batch_src_global generation:  0.027216196060180664
r_  generation:  0.24219059944152832
local_output_nid generation:  0.016223669052124023
local_in_edges_tensor generation:  0.01605224609375
mini_batch_src_global generation:  0.028586626052856445
r_  generation:  0.22996044158935547
local_output_nid generation:  0.012720823287963867
local_in_edges_tensor generation:  0.015937328338623047
mini_batch_src_global generation:  0.02977275848388672
r_  generation:  0.23571419715881348
local_output_nid generation:  0.012860774993896484
local_in_edges_tensor generation:  0.012850761413574219
mini_batch_src_global generation:  0.028473615646362305
r_  generation:  0.23149681091308594
local_output_nid generation:  0.013506650924682617
local_in_edges_tensor generation:  0.012586832046508789
mini_batch_src_global generation:  0.029358863830566406
r_  generation:  0.2386937141418457
local_output_nid generation:  0.013434410095214844
local_in_edges_tensor generation:  0.012461662292480469
mini_batch_src_global generation:  0.0289764404296875
r_  generation:  0.23406767845153809
local_output_nid generation:  0.013455390930175781
local_in_edges_tensor generation:  0.01276707649230957
mini_batch_src_global generation:  0.028716087341308594
r_  generation:  0.2335507869720459
local_output_nid generation:  0.01370096206665039
local_in_edges_tensor generation:  0.012598037719726562
mini_batch_src_global generation:  0.0291135311126709
r_  generation:  0.23894381523132324
local_output_nid generation:  0.01371455192565918
local_in_edges_tensor generation:  0.01559591293334961
mini_batch_src_global generation:  0.029031753540039062
r_  generation:  0.23651504516601562
local_output_nid generation:  0.013916254043579102
local_in_edges_tensor generation:  0.01472616195678711
mini_batch_src_global generation:  0.03074479103088379
r_  generation:  0.24491095542907715
local_output_nid generation:  0.013719558715820312
local_in_edges_tensor generation:  0.013291358947753906
mini_batch_src_global generation:  0.02993035316467285
r_  generation:  0.24066734313964844
local_output_nid generation:  0.015051603317260742
local_in_edges_tensor generation:  0.013092756271362305
mini_batch_src_global generation:  0.029262065887451172
r_  generation:  0.2372889518737793
local_output_nid generation:  0.013108253479003906
local_in_edges_tensor generation:  0.013371706008911133
mini_batch_src_global generation:  0.030913114547729492
r_  generation:  0.24242186546325684
local_output_nid generation:  0.013286352157592773
local_in_edges_tensor generation:  0.015253067016601562
mini_batch_src_global generation:  0.02964186668395996
r_  generation:  0.2415001392364502
----------------------check_connections_block total spend ----------------------------- 5.5281195640563965
generate_one_block  0.3111104965209961
generate_one_block  0.29912638664245605
generate_one_block  0.3021416664123535
generate_one_block  0.30802488327026367
generate_one_block  0.309528112411499
generate_one_block  0.2979459762573242
generate_one_block  0.33520960807800293
generate_one_block  0.3024427890777588
generate_one_block  0.30225205421447754
generate_one_block  0.306868314743042
generate_one_block  0.2999575138092041
generate_one_block  0.3097848892211914
generate_one_block  0.3066737651824951
generate_one_block  0.29805874824523926
generate_one_block  0.30493712425231934
generate_one_block  0.3105788230895996
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03414201736450195
gen group dst list time:  0.06747889518737793
time for parepare:  0.019568681716918945
local_output_nid generation:  0.025646686553955078
local_in_edges_tensor generation:  0.04832911491394043
mini_batch_src_global generation:  0.042222023010253906
r_  generation:  0.4603757858276367
local_output_nid generation:  0.03039383888244629
local_in_edges_tensor generation:  0.03224349021911621
mini_batch_src_global generation:  0.0537877082824707
r_  generation:  0.4551506042480469
local_output_nid generation:  0.030783653259277344
local_in_edges_tensor generation:  0.03057384490966797
mini_batch_src_global generation:  0.06553912162780762
r_  generation:  0.4622187614440918
local_output_nid generation:  0.032056570053100586
local_in_edges_tensor generation:  0.030655384063720703
mini_batch_src_global generation:  0.052937984466552734
r_  generation:  0.4576137065887451
local_output_nid generation:  0.03186488151550293
local_in_edges_tensor generation:  0.07856106758117676
mini_batch_src_global generation:  0.05233120918273926
r_  generation:  0.4676353931427002
local_output_nid generation:  0.032790422439575195
local_in_edges_tensor generation:  0.03639650344848633
mini_batch_src_global generation:  0.053902387619018555
r_  generation:  0.45883655548095703
local_output_nid generation:  0.03187823295593262
local_in_edges_tensor generation:  0.031392574310302734
mini_batch_src_global generation:  0.05224108695983887
r_  generation:  0.47109222412109375
local_output_nid generation:  0.031595706939697266
local_in_edges_tensor generation:  0.036065101623535156
mini_batch_src_global generation:  0.05368685722351074
r_  generation:  0.45981502532958984
local_output_nid generation:  0.03317070007324219
local_in_edges_tensor generation:  0.03127884864807129
mini_batch_src_global generation:  0.05326557159423828
r_  generation:  0.4626765251159668
local_output_nid generation:  0.031629085540771484
local_in_edges_tensor generation:  0.029962778091430664
mini_batch_src_global generation:  0.053967952728271484
r_  generation:  0.4721050262451172
local_output_nid generation:  0.03402876853942871
local_in_edges_tensor generation:  0.03336143493652344
mini_batch_src_global generation:  0.05358600616455078
r_  generation:  0.46053194999694824
local_output_nid generation:  0.03275609016418457
local_in_edges_tensor generation:  0.031569719314575195
mini_batch_src_global generation:  0.0611269474029541
r_  generation:  0.4569668769836426
local_output_nid generation:  0.03252077102661133
local_in_edges_tensor generation:  0.02854442596435547
mini_batch_src_global generation:  0.05264544486999512
r_  generation:  0.4644896984100342
local_output_nid generation:  0.03278470039367676
local_in_edges_tensor generation:  0.03065204620361328
mini_batch_src_global generation:  0.056063175201416016
r_  generation:  0.46224021911621094
local_output_nid generation:  0.03273296356201172
local_in_edges_tensor generation:  0.02962970733642578
mini_batch_src_global generation:  0.0548403263092041
r_  generation:  0.4695875644683838
local_output_nid generation:  0.03248429298400879
local_in_edges_tensor generation:  0.03105902671813965
mini_batch_src_global generation:  0.05884194374084473
r_  generation:  0.46782732009887695
----------------------check_connections_block total spend ----------------------------- 10.997045755386353
generate_one_block  0.5893383026123047
generate_one_block  0.5866119861602783
generate_one_block  0.5829176902770996
generate_one_block  0.5831859111785889
generate_one_block  0.588813304901123
generate_one_block  0.5820856094360352
generate_one_block  0.5925912857055664
generate_one_block  0.5902388095855713
generate_one_block  0.6167230606079102
generate_one_block  0.5883700847625732
generate_one_block  0.5836973190307617
generate_one_block  0.5936307907104492
generate_one_block  0.5820920467376709
generate_one_block  0.5884103775024414
generate_one_block  0.5922949314117432
generate_one_block  0.5922250747680664
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11961221694946289  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

connection checking time:  16.52516531944275
block generation total time  14.337867736816406
average batch blocks generation time:  0.8961167335510254
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09428644180297852  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7413902282714844  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.094635009765625  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7456064224243164  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09436559677124023  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7418675422668457  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09474754333496094  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7438712120056152  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09459733963012695  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7480525970458984  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09463787078857422  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7421236038208008  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09451818466186523  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7481441497802734  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0946950912475586  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7448911666870117  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09439611434936523  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7417540550231934  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09482097625732422  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7482914924621582  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09441852569580078  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.742952823638916  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09492874145507812  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7523250579833984  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.094451904296875  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7448000907897949  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09468936920166016  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7454910278320312  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09466171264648438  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7525029182434082  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09484481811523438  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7485361099243164  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06512294709682465 |0.014944672584533691 |0.0036295056343078613 |9.199976921081543e-05 |0.0037309378385543823 |0.0016872882843017578 |
----------------------------------------------------------pseudo_mini_loss sum 1.6326309442520142
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  5209507
Number of first layer input nodes during this epoch:  2480605
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11847352981567383  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02358531951904297
range selection method range initialization spend 0.012310028076171875
time for parepare:  0.016467809677124023
local_output_nid generation:  0.0014407634735107422
local_in_edges_tensor generation:  0.004231452941894531
mini_batch_src_global generation:  0.0017380714416503906
r_  generation:  0.02173638343811035
local_output_nid generation:  0.001535177230834961
local_in_edges_tensor generation:  0.0009908676147460938
mini_batch_src_global generation:  0.002061128616333008
r_  generation:  0.022121667861938477
local_output_nid generation:  0.0015408992767333984
local_in_edges_tensor generation:  0.0009350776672363281
mini_batch_src_global generation:  0.0017497539520263672
r_  generation:  0.02237081527709961
local_output_nid generation:  0.0016138553619384766
local_in_edges_tensor generation:  0.0009512901306152344
mini_batch_src_global generation:  0.0018124580383300781
r_  generation:  0.02218484878540039
local_output_nid generation:  0.0015895366668701172
local_in_edges_tensor generation:  0.0009608268737792969
mini_batch_src_global generation:  0.0017194747924804688
r_  generation:  0.021535634994506836
local_output_nid generation:  0.0016074180603027344
local_in_edges_tensor generation:  0.000942230224609375
mini_batch_src_global generation:  0.0017271041870117188
r_  generation:  0.021964311599731445
local_output_nid generation:  0.0016024112701416016
local_in_edges_tensor generation:  0.0009331703186035156
mini_batch_src_global generation:  0.0017368793487548828
r_  generation:  0.02224421501159668
local_output_nid generation:  0.0015919208526611328
local_in_edges_tensor generation:  0.0009512901306152344
mini_batch_src_global generation:  0.0017278194427490234
r_  generation:  0.02167487144470215
local_output_nid generation:  0.0016219615936279297
local_in_edges_tensor generation:  0.0010528564453125
mini_batch_src_global generation:  0.0017702579498291016
r_  generation:  0.022319316864013672
local_output_nid generation:  0.0016660690307617188
local_in_edges_tensor generation:  0.0009655952453613281
mini_batch_src_global generation:  0.0017805099487304688
r_  generation:  0.02250075340270996
local_output_nid generation:  0.0015931129455566406
local_in_edges_tensor generation:  0.0009369850158691406
mini_batch_src_global generation:  0.0017833709716796875
r_  generation:  0.022259235382080078
local_output_nid generation:  0.001583099365234375
local_in_edges_tensor generation:  0.0009477138519287109
mini_batch_src_global generation:  0.001814126968383789
r_  generation:  0.022676467895507812
local_output_nid generation:  0.0015864372253417969
local_in_edges_tensor generation:  0.0009369850158691406
mini_batch_src_global generation:  0.0017817020416259766
r_  generation:  0.022370100021362305
local_output_nid generation:  0.0016322135925292969
local_in_edges_tensor generation:  0.0009822845458984375
mini_batch_src_global generation:  0.0018074512481689453
r_  generation:  0.022913455963134766
local_output_nid generation:  0.0015971660614013672
local_in_edges_tensor generation:  0.0009839534759521484
mini_batch_src_global generation:  0.0017726421356201172
r_  generation:  0.021921396255493164
local_output_nid generation:  0.0016088485717773438
local_in_edges_tensor generation:  0.0009665489196777344
mini_batch_src_global generation:  0.0017578601837158203
r_  generation:  0.022203683853149414
----------------------check_connections_block total spend ----------------------------- 0.5230467319488525
generate_one_block  0.03858590126037598
generate_one_block  0.03137397766113281
generate_one_block  0.031925201416015625
generate_one_block  0.031369686126708984
generate_one_block  0.030892133712768555
generate_one_block  0.0328826904296875
generate_one_block  0.03127861022949219
generate_one_block  0.030222415924072266
generate_one_block  0.031153440475463867
generate_one_block  0.031053781509399414
generate_one_block  0.03118419647216797
generate_one_block  0.03207826614379883
generate_one_block  0.03149557113647461
generate_one_block  0.0318295955657959
generate_one_block  0.030799150466918945
generate_one_block  0.03176093101501465
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06529998779296875
gen group dst list time:  0.018002748489379883
time for parepare:  0.019289493560791016
local_output_nid generation:  0.007485866546630859
local_in_edges_tensor generation:  0.020109891891479492
mini_batch_src_global generation:  0.024199485778808594
r_  generation:  0.21706914901733398
local_output_nid generation:  0.010946273803710938
local_in_edges_tensor generation:  0.013170480728149414
mini_batch_src_global generation:  0.027104854583740234
r_  generation:  0.22607922554016113
local_output_nid generation:  0.011670589447021484
local_in_edges_tensor generation:  0.012940406799316406
mini_batch_src_global generation:  0.027570247650146484
r_  generation:  0.2316279411315918
local_output_nid generation:  0.012217521667480469
local_in_edges_tensor generation:  0.014229536056518555
mini_batch_src_global generation:  0.027422666549682617
r_  generation:  0.23464322090148926
local_output_nid generation:  0.012149810791015625
local_in_edges_tensor generation:  0.01255345344543457
mini_batch_src_global generation:  0.02854776382446289
r_  generation:  0.23479533195495605
local_output_nid generation:  0.012304067611694336
local_in_edges_tensor generation:  0.012588739395141602
mini_batch_src_global generation:  0.030083417892456055
r_  generation:  0.2382369041442871
local_output_nid generation:  0.012807607650756836
local_in_edges_tensor generation:  0.014407873153686523
mini_batch_src_global generation:  0.028861284255981445
r_  generation:  0.234710693359375
local_output_nid generation:  0.012703895568847656
local_in_edges_tensor generation:  0.015097618103027344
mini_batch_src_global generation:  0.029316425323486328
r_  generation:  0.22854971885681152
local_output_nid generation:  0.013191699981689453
local_in_edges_tensor generation:  0.0126190185546875
mini_batch_src_global generation:  0.029345989227294922
r_  generation:  0.23698687553405762
local_output_nid generation:  0.013033390045166016
local_in_edges_tensor generation:  0.014517068862915039
mini_batch_src_global generation:  0.029318571090698242
r_  generation:  0.23754668235778809
local_output_nid generation:  0.01316976547241211
local_in_edges_tensor generation:  0.013583183288574219
mini_batch_src_global generation:  0.029563426971435547
r_  generation:  0.2387220859527588
local_output_nid generation:  0.013276815414428711
local_in_edges_tensor generation:  0.012923479080200195
mini_batch_src_global generation:  0.03024125099182129
r_  generation:  0.23996901512145996
local_output_nid generation:  0.013080835342407227
local_in_edges_tensor generation:  0.012651205062866211
mini_batch_src_global generation:  0.029429197311401367
r_  generation:  0.23703765869140625
local_output_nid generation:  0.013273239135742188
local_in_edges_tensor generation:  0.012909412384033203
mini_batch_src_global generation:  0.03105926513671875
r_  generation:  0.24268865585327148
local_output_nid generation:  0.012248992919921875
local_in_edges_tensor generation:  0.014827251434326172
mini_batch_src_global generation:  0.029274702072143555
r_  generation:  0.23584675788879395
local_output_nid generation:  0.012288570404052734
local_in_edges_tensor generation:  0.013725757598876953
mini_batch_src_global generation:  0.029692649841308594
r_  generation:  0.23714065551757812
----------------------check_connections_block total spend ----------------------------- 5.466309070587158
generate_one_block  0.29932141304016113
generate_one_block  0.30024003982543945
generate_one_block  0.30190134048461914
generate_one_block  0.3040955066680908
generate_one_block  0.29865431785583496
generate_one_block  0.3008246421813965
generate_one_block  0.3235812187194824
generate_one_block  0.29132723808288574
generate_one_block  0.3004763126373291
generate_one_block  0.3078289031982422
generate_one_block  0.3031179904937744
generate_one_block  0.3086543083190918
generate_one_block  0.3017854690551758
generate_one_block  0.30991029739379883
generate_one_block  0.30367541313171387
generate_one_block  0.3013193607330322
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03101515769958496
gen group dst list time:  0.06431078910827637
time for parepare:  0.01831531524658203
local_output_nid generation:  0.025280237197875977
local_in_edges_tensor generation:  0.04129910469055176
mini_batch_src_global generation:  0.04046010971069336
r_  generation:  0.4482991695404053
local_output_nid generation:  0.029601097106933594
local_in_edges_tensor generation:  0.03407764434814453
mini_batch_src_global generation:  0.052510976791381836
r_  generation:  0.45253467559814453
local_output_nid generation:  0.030744552612304688
local_in_edges_tensor generation:  0.030457735061645508
mini_batch_src_global generation:  0.05146169662475586
r_  generation:  0.4555943012237549
local_output_nid generation:  0.030212879180908203
local_in_edges_tensor generation:  0.030468225479125977
mini_batch_src_global generation:  0.054842472076416016
r_  generation:  0.4565889835357666
local_output_nid generation:  0.030753135681152344
local_in_edges_tensor generation:  0.07271480560302734
mini_batch_src_global generation:  0.05149674415588379
r_  generation:  0.4612412452697754
local_output_nid generation:  0.030924558639526367
local_in_edges_tensor generation:  0.030821800231933594
mini_batch_src_global generation:  0.05517768859863281
r_  generation:  0.4566638469696045
local_output_nid generation:  0.030522584915161133
local_in_edges_tensor generation:  0.03144049644470215
mini_batch_src_global generation:  0.051819562911987305
r_  generation:  0.4626164436340332
local_output_nid generation:  0.03101658821105957
local_in_edges_tensor generation:  0.03349590301513672
mini_batch_src_global generation:  0.05339527130126953
r_  generation:  0.4614129066467285
local_output_nid generation:  0.03118586540222168
local_in_edges_tensor generation:  0.031238794326782227
mini_batch_src_global generation:  0.052918434143066406
r_  generation:  0.48004722595214844
local_output_nid generation:  0.03099203109741211
local_in_edges_tensor generation:  0.032472848892211914
mini_batch_src_global generation:  0.05514240264892578
r_  generation:  0.4594578742980957
local_output_nid generation:  0.031018972396850586
local_in_edges_tensor generation:  0.030422687530517578
mini_batch_src_global generation:  0.05405712127685547
r_  generation:  0.4672694206237793
local_output_nid generation:  0.0313420295715332
local_in_edges_tensor generation:  0.030115604400634766
mini_batch_src_global generation:  0.05346941947937012
r_  generation:  0.4595785140991211
local_output_nid generation:  0.031591176986694336
local_in_edges_tensor generation:  0.028704404830932617
mini_batch_src_global generation:  0.051958322525024414
r_  generation:  0.4643890857696533
local_output_nid generation:  0.030947446823120117
local_in_edges_tensor generation:  0.030526399612426758
mini_batch_src_global generation:  0.05360603332519531
r_  generation:  0.46260786056518555
local_output_nid generation:  0.030923843383789062
local_in_edges_tensor generation:  0.030489683151245117
mini_batch_src_global generation:  0.05644822120666504
r_  generation:  0.46348094940185547
local_output_nid generation:  0.031229257583618164
local_in_edges_tensor generation:  0.03584909439086914
mini_batch_src_global generation:  0.05327963829040527
r_  generation:  0.4747610092163086
----------------------check_connections_block total spend ----------------------------- 10.892853260040283
generate_one_block  0.5803685188293457
generate_one_block  0.5779311656951904
generate_one_block  0.5870752334594727
generate_one_block  0.5821976661682129
generate_one_block  0.5759167671203613
generate_one_block  0.5879960060119629
generate_one_block  0.5741510391235352
generate_one_block  0.5810699462890625
generate_one_block  0.652778148651123
generate_one_block  0.5878877639770508
generate_one_block  0.5778031349182129
generate_one_block  0.5987482070922852
generate_one_block  0.5808320045471191
generate_one_block  0.5851304531097412
generate_one_block  0.5721499919891357
generate_one_block  0.5877254009246826
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11847352981567383  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

connection checking time:  16.35916233062744
block generation total time  14.246475219726562
average batch blocks generation time:  0.8904047012329102
block dataloader generation time/epoch 32.750258684158325
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0945587158203125  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7469387054443359  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09472274780273438  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7428445816040039  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0945425033569336  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7497282028198242  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09481525421142578  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7475690841674805  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0943603515625  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7410988807678223  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09478759765625  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7462239265441895  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0942387580871582  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7423343658447266  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09451484680175781  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7400598526000977  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09454202651977539  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7478055953979492  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0948019027709961  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7463240623474121  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09438610076904297  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7443380355834961  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09489154815673828  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7511487007141113  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09450578689575195  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7445082664489746  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09496212005615234  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7540631294250488  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09435033798217773  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7406916618347168  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0947713851928711  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7463645935058594  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06430938839912415 |0.012085005640983582 |0.0035734623670578003 |8.861720561981201e-05 |0.003750428557395935 |0.0013303756713867188 |
----------------------------------------------------------pseudo_mini_loss sum 1.5891081094741821
Total (block generation + training)time/epoch 34.15481185913086
Training time/epoch 1.4042692184448242
Training time without block to device /epoch 1.210909128189087
Training time without total dataloading part /epoch 0.11993050575256348
load block tensor time/epoch 1.0289502143859863
block to device time/epoch 0.1933600902557373
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  5209904
Number of first layer input nodes during this epoch:  2480844
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11823701858520508  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02524566650390625
range selection method range initialization spend 0.01254415512084961
time for parepare:  0.016486406326293945
local_output_nid generation:  0.0014286041259765625
local_in_edges_tensor generation:  0.006641864776611328
mini_batch_src_global generation:  0.0017514228820800781
r_  generation:  0.0207977294921875
local_output_nid generation:  0.0015516281127929688
local_in_edges_tensor generation:  0.0009968280792236328
mini_batch_src_global generation:  0.002022981643676758
r_  generation:  0.02247166633605957
local_output_nid generation:  0.0015475749969482422
local_in_edges_tensor generation:  0.0009584426879882812
mini_batch_src_global generation:  0.0017206668853759766
r_  generation:  0.022092580795288086
local_output_nid generation:  0.0015811920166015625
local_in_edges_tensor generation:  0.0009639263153076172
mini_batch_src_global generation:  0.001699686050415039
r_  generation:  0.021560192108154297
local_output_nid generation:  0.001573324203491211
local_in_edges_tensor generation:  0.0009479522705078125
mini_batch_src_global generation:  0.0017693042755126953
r_  generation:  0.02191019058227539
local_output_nid generation:  0.0016083717346191406
local_in_edges_tensor generation:  0.0009174346923828125
mini_batch_src_global generation:  0.0017271041870117188
r_  generation:  0.022332429885864258
local_output_nid generation:  0.0015625953674316406
local_in_edges_tensor generation:  0.0009419918060302734
mini_batch_src_global generation:  0.0017735958099365234
r_  generation:  0.022533655166625977
local_output_nid generation:  0.0015571117401123047
local_in_edges_tensor generation:  0.0009918212890625
mini_batch_src_global generation:  0.0017466545104980469
r_  generation:  0.021949052810668945
local_output_nid generation:  0.0015883445739746094
local_in_edges_tensor generation:  0.0009663105010986328
mini_batch_src_global generation:  0.0017914772033691406
r_  generation:  0.022480249404907227
local_output_nid generation:  0.0015866756439208984
local_in_edges_tensor generation:  0.0009362697601318359
mini_batch_src_global generation:  0.0017273426055908203
r_  generation:  0.0220949649810791
local_output_nid generation:  0.0015838146209716797
local_in_edges_tensor generation:  0.0009484291076660156
mini_batch_src_global generation:  0.0017237663269042969
r_  generation:  0.022562742233276367
local_output_nid generation:  0.0016238689422607422
local_in_edges_tensor generation:  0.0009529590606689453
mini_batch_src_global generation:  0.001708984375
r_  generation:  0.021862506866455078
local_output_nid generation:  0.0015735626220703125
local_in_edges_tensor generation:  0.0009286403656005859
mini_batch_src_global generation:  0.001712799072265625
r_  generation:  0.021875858306884766
local_output_nid generation:  0.0016400814056396484
local_in_edges_tensor generation:  0.0008885860443115234
mini_batch_src_global generation:  0.0017323493957519531
r_  generation:  0.02229142189025879
local_output_nid generation:  0.0015361309051513672
local_in_edges_tensor generation:  0.0009713172912597656
mini_batch_src_global generation:  0.00179290771484375
r_  generation:  0.02273106575012207
local_output_nid generation:  0.0015838146209716797
local_in_edges_tensor generation:  0.0010135173797607422
mini_batch_src_global generation:  0.0017442703247070312
r_  generation:  0.022118568420410156
----------------------check_connections_block total spend ----------------------------- 0.5218305587768555
generate_one_block  0.03046560287475586
generate_one_block  0.031490325927734375
generate_one_block  0.03151893615722656
generate_one_block  0.031098127365112305
generate_one_block  0.031244277954101562
generate_one_block  0.03362131118774414
generate_one_block  0.031500816345214844
generate_one_block  0.030702590942382812
generate_one_block  0.03173661231994629
generate_one_block  0.031485557556152344
generate_one_block  0.03159737586975098
generate_one_block  0.03051161766052246
generate_one_block  0.0307009220123291
generate_one_block  0.03070235252380371
generate_one_block  0.03179001808166504
generate_one_block  0.031197071075439453
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.031198501586914062
gen group dst list time:  0.018004894256591797
time for parepare:  0.01942896842956543
local_output_nid generation:  0.007308244705200195
local_in_edges_tensor generation:  0.023026466369628906
mini_batch_src_global generation:  0.02251458168029785
r_  generation:  0.21559906005859375
local_output_nid generation:  0.011351823806762695
local_in_edges_tensor generation:  0.015596151351928711
mini_batch_src_global generation:  0.027878761291503906
r_  generation:  0.22240591049194336
local_output_nid generation:  0.011855125427246094
local_in_edges_tensor generation:  0.013965368270874023
mini_batch_src_global generation:  0.029599905014038086
r_  generation:  0.22903156280517578
local_output_nid generation:  0.01248621940612793
local_in_edges_tensor generation:  0.01613783836364746
mini_batch_src_global generation:  0.0271909236907959
r_  generation:  0.2275402545928955
local_output_nid generation:  0.012296199798583984
local_in_edges_tensor generation:  0.014347076416015625
mini_batch_src_global generation:  0.02864241600036621
r_  generation:  0.23398709297180176
local_output_nid generation:  0.012871742248535156
local_in_edges_tensor generation:  0.012367963790893555
mini_batch_src_global generation:  0.028783082962036133
r_  generation:  0.23522233963012695
local_output_nid generation:  0.013089418411254883
local_in_edges_tensor generation:  0.016208648681640625
mini_batch_src_global generation:  0.030553340911865234
r_  generation:  0.24317574501037598
local_output_nid generation:  0.012996196746826172
local_in_edges_tensor generation:  0.01624774932861328
mini_batch_src_global generation:  0.029616117477416992
r_  generation:  0.23094463348388672
local_output_nid generation:  0.013282299041748047
local_in_edges_tensor generation:  0.012731075286865234
mini_batch_src_global generation:  0.02976393699645996
r_  generation:  0.24166226387023926
local_output_nid generation:  0.013366937637329102
local_in_edges_tensor generation:  0.0129547119140625
mini_batch_src_global generation:  0.02958369255065918
r_  generation:  0.2372298240661621
local_output_nid generation:  0.013423919677734375
local_in_edges_tensor generation:  0.013529539108276367
mini_batch_src_global generation:  0.029637813568115234
r_  generation:  0.23864197731018066
local_output_nid generation:  0.013017654418945312
local_in_edges_tensor generation:  0.013527870178222656
mini_batch_src_global generation:  0.029465675354003906
r_  generation:  0.23065638542175293
local_output_nid generation:  0.013332128524780273
local_in_edges_tensor generation:  0.01498723030090332
mini_batch_src_global generation:  0.02880692481994629
r_  generation:  0.23379850387573242
local_output_nid generation:  0.013097524642944336
local_in_edges_tensor generation:  0.013716459274291992
mini_batch_src_global generation:  0.02910447120666504
r_  generation:  0.23295927047729492
local_output_nid generation:  0.012756824493408203
local_in_edges_tensor generation:  0.013292074203491211
mini_batch_src_global generation:  0.029917478561401367
r_  generation:  0.23934412002563477
local_output_nid generation:  0.012696981430053711
local_in_edges_tensor generation:  0.013301610946655273
mini_batch_src_global generation:  0.029207706451416016
r_  generation:  0.23499536514282227
----------------------check_connections_block total spend ----------------------------- 5.4596686363220215
generate_one_block  0.3025658130645752
generate_one_block  0.298492431640625
generate_one_block  0.3043856620788574
generate_one_block  0.29923391342163086
generate_one_block  0.303098201751709
generate_one_block  0.3013932704925537
generate_one_block  0.33257102966308594
generate_one_block  0.29453468322753906
generate_one_block  0.3035557270050049
generate_one_block  0.3033909797668457
generate_one_block  0.30333662033081055
generate_one_block  0.2954580783843994
generate_one_block  0.29358744621276855
generate_one_block  0.2947382926940918
generate_one_block  0.30417633056640625
generate_one_block  0.29648518562316895
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03438425064086914
gen group dst list time:  0.0622560977935791
time for parepare:  0.017488956451416016
local_output_nid generation:  0.02493453025817871
local_in_edges_tensor generation:  0.03970170021057129
mini_batch_src_global generation:  0.04223823547363281
r_  generation:  0.44611620903015137
local_output_nid generation:  0.0299832820892334
local_in_edges_tensor generation:  0.03391885757446289
mini_batch_src_global generation:  0.051924943923950195
r_  generation:  0.44609904289245605
local_output_nid generation:  0.030266284942626953
local_in_edges_tensor generation:  0.03027176856994629
mini_batch_src_global generation:  0.050798654556274414
r_  generation:  0.4553203582763672
local_output_nid generation:  0.030552387237548828
local_in_edges_tensor generation:  0.03021073341369629
mini_batch_src_global generation:  0.05214548110961914
r_  generation:  0.4487040042877197
local_output_nid generation:  0.033655643463134766
local_in_edges_tensor generation:  0.0735929012298584
mini_batch_src_global generation:  0.05137491226196289
r_  generation:  0.46001195907592773
local_output_nid generation:  0.031113386154174805
local_in_edges_tensor generation:  0.0305178165435791
mini_batch_src_global generation:  0.05291152000427246
r_  generation:  0.455883264541626
local_output_nid generation:  0.03083205223083496
local_in_edges_tensor generation:  0.029210329055786133
mini_batch_src_global generation:  0.05212688446044922
r_  generation:  0.4649057388305664
local_output_nid generation:  0.031198501586914062
local_in_edges_tensor generation:  0.03437161445617676
mini_batch_src_global generation:  0.05375385284423828
r_  generation:  0.4571676254272461
local_output_nid generation:  0.03123950958251953
local_in_edges_tensor generation:  0.03088521957397461
mini_batch_src_global generation:  0.05224967002868652
r_  generation:  0.46581387519836426
local_output_nid generation:  0.031235694885253906
local_in_edges_tensor generation:  0.032891273498535156
mini_batch_src_global generation:  0.05395674705505371
r_  generation:  0.4566464424133301
local_output_nid generation:  0.03117656707763672
local_in_edges_tensor generation:  0.029042720794677734
mini_batch_src_global generation:  0.053604841232299805
r_  generation:  0.46362805366516113
local_output_nid generation:  0.031087398529052734
local_in_edges_tensor generation:  0.029937744140625
mini_batch_src_global generation:  0.05361485481262207
r_  generation:  0.4523448944091797
local_output_nid generation:  0.031021833419799805
local_in_edges_tensor generation:  0.030735492706298828
mini_batch_src_global generation:  0.05176591873168945
r_  generation:  0.4610457420349121
local_output_nid generation:  0.031111478805541992
local_in_edges_tensor generation:  0.03034520149230957
mini_batch_src_global generation:  0.05368304252624512
r_  generation:  0.457838773727417
local_output_nid generation:  0.030968904495239258
local_in_edges_tensor generation:  0.03114795684814453
mini_batch_src_global generation:  0.051657676696777344
r_  generation:  0.4607982635498047
local_output_nid generation:  0.03149676322937012
local_in_edges_tensor generation:  0.030298471450805664
mini_batch_src_global generation:  0.05355238914489746
r_  generation:  0.45366835594177246
----------------------check_connections_block total spend ----------------------------- 10.79133152961731
generate_one_block  0.5788569450378418
generate_one_block  0.5866661071777344
generate_one_block  0.5803747177124023
generate_one_block  0.5873801708221436
generate_one_block  0.5753440856933594
generate_one_block  0.5811138153076172
generate_one_block  0.5800459384918213
generate_one_block  0.5779688358306885
generate_one_block  0.6151256561279297
generate_one_block  0.5821976661682129
generate_one_block  0.582252025604248
generate_one_block  0.5708575248718262
generate_one_block  0.5753109455108643
generate_one_block  0.5860404968261719
generate_one_block  0.5819931030273438
generate_one_block  0.5782713890075684
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11823701858520508  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

connection checking time:  16.25100016593933
block generation total time  14.150803089141846
average batch blocks generation time:  0.8844251930713654
block dataloader generation time/epoch 32.62865960597992
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09443998336791992  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7445158958435059  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09470272064208984  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7471857070922852  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09452247619628906  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7482366561889648  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09471321105957031  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7427616119384766  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09445810317993164  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7436766624450684  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09479141235351562  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7451233863830566  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09454011917114258  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7460131645202637  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09459877014160156  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7424192428588867  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09458398818969727  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7511868476867676  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09482383728027344  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7483701705932617  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0946969985961914  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7467641830444336  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09455299377441406  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7400679588317871  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09455108642578125  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7440128326416016  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09467506408691406  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7428765296936035  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09457206726074219  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7458353042602539  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09468364715576172  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7432327270507812  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06114371120929718 |0.010612696409225464 |0.00348450243473053 |8.927285671234131e-05 |0.0031733810901641846 |0.0028281211853027344 |
----------------------------------------------------------pseudo_mini_loss sum 1.5537434816360474
Total (block generation + training)time/epoch 33.990522623062134
Training time/epoch 1.3188860416412354
Training time without block to device /epoch 1.149082899093628
Training time without total dataloading part /epoch 0.11078262329101562
load block tensor time/epoch 0.9782993793487549
block to device time/epoch 0.16980314254760742
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  5208266
Number of first layer input nodes during this epoch:  2480596
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11799478530883789  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02513742446899414
range selection method range initialization spend 0.012331962585449219
time for parepare:  0.01893019676208496
local_output_nid generation:  0.0014390945434570312
local_in_edges_tensor generation:  0.0073244571685791016
mini_batch_src_global generation:  0.0018262863159179688
r_  generation:  0.021988391876220703
local_output_nid generation:  0.0015683174133300781
local_in_edges_tensor generation:  0.0009844303131103516
mini_batch_src_global generation:  0.002058267593383789
r_  generation:  0.023027420043945312
local_output_nid generation:  0.0016057491302490234
local_in_edges_tensor generation:  0.0009558200836181641
mini_batch_src_global generation:  0.0017669200897216797
r_  generation:  0.02215409278869629
local_output_nid generation:  0.0016491413116455078
local_in_edges_tensor generation:  0.0009932518005371094
mini_batch_src_global generation:  0.0017712116241455078
r_  generation:  0.021941184997558594
local_output_nid generation:  0.0016052722930908203
local_in_edges_tensor generation:  0.001135110855102539
mini_batch_src_global generation:  0.001706838607788086
r_  generation:  0.021585702896118164
local_output_nid generation:  0.0017044544219970703
local_in_edges_tensor generation:  0.0009601116180419922
mini_batch_src_global generation:  0.0017096996307373047
r_  generation:  0.02195429801940918
local_output_nid generation:  0.001725912094116211
local_in_edges_tensor generation:  0.0009377002716064453
mini_batch_src_global generation:  0.0017666816711425781
r_  generation:  0.022361278533935547
local_output_nid generation:  0.0015716552734375
local_in_edges_tensor generation:  0.0009489059448242188
mini_batch_src_global generation:  0.0017495155334472656
r_  generation:  0.022559642791748047
local_output_nid generation:  0.0015878677368164062
local_in_edges_tensor generation:  0.0009517669677734375
mini_batch_src_global generation:  0.0017735958099365234
r_  generation:  0.022255659103393555
local_output_nid generation:  0.0015726089477539062
local_in_edges_tensor generation:  0.0009610652923583984
mini_batch_src_global generation:  0.0017409324645996094
r_  generation:  0.022171735763549805
local_output_nid generation:  0.0015835762023925781
local_in_edges_tensor generation:  0.0009670257568359375
mini_batch_src_global generation:  0.0017719268798828125
r_  generation:  0.02228856086730957
local_output_nid generation:  0.001562356948852539
local_in_edges_tensor generation:  0.0009372234344482422
mini_batch_src_global generation:  0.0017402172088623047
r_  generation:  0.021942138671875
local_output_nid generation:  0.0015773773193359375
local_in_edges_tensor generation:  0.0009756088256835938
mini_batch_src_global generation:  0.0016984939575195312
r_  generation:  0.021750450134277344
local_output_nid generation:  0.001583099365234375
local_in_edges_tensor generation:  0.0009632110595703125
mini_batch_src_global generation:  0.001779794692993164
r_  generation:  0.022657394409179688
local_output_nid generation:  0.001558542251586914
local_in_edges_tensor generation:  0.0009567737579345703
mini_batch_src_global generation:  0.001772165298461914
r_  generation:  0.02224254608154297
local_output_nid generation:  0.0015528202056884766
local_in_edges_tensor generation:  0.0009531974792480469
mini_batch_src_global generation:  0.0017857551574707031
r_  generation:  0.022376537322998047
----------------------check_connections_block total spend ----------------------------- 0.5267601013183594
generate_one_block  0.031682491302490234
generate_one_block  0.031748056411743164
generate_one_block  0.03210568428039551
generate_one_block  0.031149864196777344
generate_one_block  0.030930757522583008
generate_one_block  0.032759666442871094
generate_one_block  0.03198838233947754
generate_one_block  0.031510114669799805
generate_one_block  0.031590938568115234
generate_one_block  0.03069138526916504
generate_one_block  0.032033443450927734
generate_one_block  0.030965805053710938
generate_one_block  0.031029701232910156
generate_one_block  0.03151512145996094
generate_one_block  0.03190350532531738
generate_one_block  0.03243207931518555
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03465437889099121
gen group dst list time:  0.018910884857177734
time for parepare:  0.020229578018188477
local_output_nid generation:  0.00783085823059082
local_in_edges_tensor generation:  0.02950906753540039
mini_batch_src_global generation:  0.02345728874206543
r_  generation:  0.22170329093933105
local_output_nid generation:  0.011873006820678711
local_in_edges_tensor generation:  0.015777111053466797
mini_batch_src_global generation:  0.03148531913757324
r_  generation:  0.22463726997375488
local_output_nid generation:  0.01198720932006836
local_in_edges_tensor generation:  0.01580190658569336
mini_batch_src_global generation:  0.027264118194580078
r_  generation:  0.23238348960876465
local_output_nid generation:  0.012618780136108398
local_in_edges_tensor generation:  0.014402627944946289
mini_batch_src_global generation:  0.029126405715942383
r_  generation:  0.23319029808044434
local_output_nid generation:  0.012709856033325195
local_in_edges_tensor generation:  0.014409780502319336
mini_batch_src_global generation:  0.03076767921447754
r_  generation:  0.23334050178527832
local_output_nid generation:  0.012593507766723633
local_in_edges_tensor generation:  0.013484954833984375
mini_batch_src_global generation:  0.030672311782836914
r_  generation:  0.23324251174926758
local_output_nid generation:  0.012999773025512695
local_in_edges_tensor generation:  0.0145721435546875
mini_batch_src_global generation:  0.029287099838256836
r_  generation:  0.23707294464111328
local_output_nid generation:  0.013023614883422852
local_in_edges_tensor generation:  0.013150215148925781
mini_batch_src_global generation:  0.03363466262817383
r_  generation:  0.23554491996765137
local_output_nid generation:  0.013399124145507812
local_in_edges_tensor generation:  0.01312255859375
mini_batch_src_global generation:  0.03087162971496582
r_  generation:  0.2363121509552002
local_output_nid generation:  0.013017892837524414
local_in_edges_tensor generation:  0.014922380447387695
mini_batch_src_global generation:  0.03152132034301758
r_  generation:  0.23116731643676758
local_output_nid generation:  0.013233184814453125
local_in_edges_tensor generation:  0.012828826904296875
mini_batch_src_global generation:  0.029572725296020508
r_  generation:  0.23537921905517578
local_output_nid generation:  0.01318979263305664
local_in_edges_tensor generation:  0.012628555297851562
mini_batch_src_global generation:  0.028839588165283203
r_  generation:  0.2304987907409668
local_output_nid generation:  0.01316213607788086
local_in_edges_tensor generation:  0.013873577117919922
mini_batch_src_global generation:  0.03019571304321289
r_  generation:  0.2340099811553955
local_output_nid generation:  0.013158798217773438
local_in_edges_tensor generation:  0.013425350189208984
mini_batch_src_global generation:  0.037552595138549805
r_  generation:  0.23846793174743652
local_output_nid generation:  0.014535665512084961
local_in_edges_tensor generation:  0.014728784561157227
mini_batch_src_global generation:  0.03151130676269531
r_  generation:  0.23942804336547852
local_output_nid generation:  0.012838363647460938
local_in_edges_tensor generation:  0.0142364501953125
mini_batch_src_global generation:  0.029062986373901367
r_  generation:  0.2351243495941162
----------------------check_connections_block total spend ----------------------------- 5.496650695800781
generate_one_block  0.3173995018005371
generate_one_block  0.30465245246887207
generate_one_block  0.31339502334594727
generate_one_block  0.3047769069671631
generate_one_block  0.29895591735839844
generate_one_block  0.29698801040649414
generate_one_block  0.33112335205078125
generate_one_block  0.29886817932128906
generate_one_block  0.30485010147094727
generate_one_block  0.2948150634765625
generate_one_block  0.29946112632751465
generate_one_block  0.2928640842437744
generate_one_block  0.29779887199401855
generate_one_block  0.30295586585998535
generate_one_block  0.3080005645751953
generate_one_block  0.2993621826171875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03589653968811035
gen group dst list time:  0.06261777877807617
time for parepare:  0.017963647842407227
local_output_nid generation:  0.024698257446289062
local_in_edges_tensor generation:  0.04074573516845703
mini_batch_src_global generation:  0.0417935848236084
r_  generation:  0.4515979290008545
local_output_nid generation:  0.02962517738342285
local_in_edges_tensor generation:  0.037123918533325195
mini_batch_src_global generation:  0.053267478942871094
r_  generation:  0.44506239891052246
local_output_nid generation:  0.030431032180786133
local_in_edges_tensor generation:  0.029865264892578125
mini_batch_src_global generation:  0.05066251754760742
r_  generation:  0.4575631618499756
local_output_nid generation:  0.03387331962585449
local_in_edges_tensor generation:  0.030938148498535156
mini_batch_src_global generation:  0.05270099639892578
r_  generation:  0.45040225982666016
local_output_nid generation:  0.030938148498535156
local_in_edges_tensor generation:  0.07223153114318848
mini_batch_src_global generation:  0.05150890350341797
r_  generation:  0.46100378036499023
local_output_nid generation:  0.030799388885498047
local_in_edges_tensor generation:  0.03328824043273926
mini_batch_src_global generation:  0.060343027114868164
r_  generation:  0.45438170433044434
local_output_nid generation:  0.034186363220214844
local_in_edges_tensor generation:  0.03352642059326172
mini_batch_src_global generation:  0.07012271881103516
r_  generation:  0.4716336727142334
local_output_nid generation:  0.03119039535522461
local_in_edges_tensor generation:  0.029126882553100586
mini_batch_src_global generation:  0.054762840270996094
r_  generation:  0.4575040340423584
local_output_nid generation:  0.031118392944335938
local_in_edges_tensor generation:  0.034183502197265625
mini_batch_src_global generation:  0.052361249923706055
r_  generation:  0.46697306632995605
local_output_nid generation:  0.031585693359375
local_in_edges_tensor generation:  0.03382229804992676
mini_batch_src_global generation:  0.053888559341430664
r_  generation:  0.45885658264160156
local_output_nid generation:  0.03364443778991699
local_in_edges_tensor generation:  0.03879356384277344
mini_batch_src_global generation:  0.055854082107543945
r_  generation:  0.4996068477630615
local_output_nid generation:  0.03452301025390625
local_in_edges_tensor generation:  0.03129315376281738
mini_batch_src_global generation:  0.056609153747558594
r_  generation:  0.45450448989868164
local_output_nid generation:  0.032163381576538086
local_in_edges_tensor generation:  0.028856992721557617
mini_batch_src_global generation:  0.0523381233215332
r_  generation:  0.4650585651397705
local_output_nid generation:  0.03250002861022949
local_in_edges_tensor generation:  0.03262639045715332
mini_batch_src_global generation:  0.0534510612487793
r_  generation:  0.4564085006713867
local_output_nid generation:  0.03234243392944336
local_in_edges_tensor generation:  0.03139996528625488
mini_batch_src_global generation:  0.0563509464263916
r_  generation:  0.48547840118408203
local_output_nid generation:  0.03249335289001465
local_in_edges_tensor generation:  0.03402209281921387
mini_batch_src_global generation:  0.054377079010009766
r_  generation:  0.4561271667480469
----------------------check_connections_block total spend ----------------------------- 10.98349642753601
generate_one_block  0.5984911918640137
generate_one_block  0.5898325443267822
generate_one_block  0.5932154655456543
generate_one_block  0.594268798828125
generate_one_block  0.5893988609313965
generate_one_block  0.5798327922821045
generate_one_block  0.5872631072998047
generate_one_block  0.5915524959564209
generate_one_block  0.6827452182769775
generate_one_block  0.5807116031646729
generate_one_block  0.5912730693817139
generate_one_block  0.589806079864502
generate_one_block  0.5901107788085938
generate_one_block  0.587670087814331
generate_one_block  0.5939855575561523
generate_one_block  0.584836483001709
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11799478530883789  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

connection checking time:  16.480147123336792
block generation total time  14.391261339187622
average batch blocks generation time:  0.8994538336992264
block dataloader generation time/epoch 32.75147247314453
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09464073181152344  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7496352195739746  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09478187561035156  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7459864616394043  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09478044509887695  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7543163299560547  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09480953216552734  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7479400634765625  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09441566467285156  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7463817596435547  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09464645385742188  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.741793155670166  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09453916549682617  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7452597618103027  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09470176696777344  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7446160316467285  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09461498260498047  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7509007453918457  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09454822540283203  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7356390953063965  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09453439712524414  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7482395172119141  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0945882797241211  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7413640022277832  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09454965591430664  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.744016170501709  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0947723388671875  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7444143295288086  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09440803527832031  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7450985908508301  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0947256088256836  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7442455291748047  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06561082601547241 |0.016323700547218323 |0.003579378128051758 |9.073317050933838e-05 |0.00374390184879303 |0.0018198490142822266 |
----------------------------------------------------------pseudo_mini_loss sum 1.5208886861801147
Total (block generation + training)time/epoch 34.157370249430336
Training time/epoch 1.4936935901641846
Training time without block to device /epoch 1.2325143814086914
Training time without total dataloading part /epoch 0.12044405937194824
load block tensor time/epoch 1.0497732162475586
block to device time/epoch 0.26117920875549316
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  5211130
Number of first layer input nodes during this epoch:  2481793
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11812257766723633  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027052640914916992
range selection method range initialization spend 0.012328863143920898
time for parepare:  0.016915082931518555
local_output_nid generation:  0.0014393329620361328
local_in_edges_tensor generation:  0.0050106048583984375
mini_batch_src_global generation:  0.001794576644897461
r_  generation:  0.02059793472290039
local_output_nid generation:  0.0015528202056884766
local_in_edges_tensor generation:  0.0010199546813964844
mini_batch_src_global generation:  0.002130746841430664
r_  generation:  0.02283167839050293
local_output_nid generation:  0.0015668869018554688
local_in_edges_tensor generation:  0.0009448528289794922
mini_batch_src_global generation:  0.001730203628540039
r_  generation:  0.021311044692993164
local_output_nid generation:  0.001642465591430664
local_in_edges_tensor generation:  0.0009696483612060547
mini_batch_src_global generation:  0.0018048286437988281
r_  generation:  0.021724224090576172
local_output_nid generation:  0.0015745162963867188
local_in_edges_tensor generation:  0.0009644031524658203
mini_batch_src_global generation:  0.0018100738525390625
r_  generation:  0.02167654037475586
local_output_nid generation:  0.0015590190887451172
local_in_edges_tensor generation:  0.0009653568267822266
mini_batch_src_global generation:  0.0017535686492919922
r_  generation:  0.022034883499145508
local_output_nid generation:  0.0015704631805419922
local_in_edges_tensor generation:  0.0010123252868652344
mini_batch_src_global generation:  0.0018460750579833984
r_  generation:  0.023095130920410156
local_output_nid generation:  0.0016121864318847656
local_in_edges_tensor generation:  0.0009613037109375
mini_batch_src_global generation:  0.0018055438995361328
r_  generation:  0.02212071418762207
local_output_nid generation:  0.0015664100646972656
local_in_edges_tensor generation:  0.0009646415710449219
mini_batch_src_global generation:  0.0018296241760253906
r_  generation:  0.022369861602783203
local_output_nid generation:  0.0015544891357421875
local_in_edges_tensor generation:  0.000946044921875
mini_batch_src_global generation:  0.0017542839050292969
r_  generation:  0.022427082061767578
local_output_nid generation:  0.0015714168548583984
local_in_edges_tensor generation:  0.0009527206420898438
mini_batch_src_global generation:  0.0018134117126464844
r_  generation:  0.022413253784179688
local_output_nid generation:  0.0015716552734375
local_in_edges_tensor generation:  0.0009212493896484375
mini_batch_src_global generation:  0.0017666816711425781
r_  generation:  0.024107694625854492
local_output_nid generation:  0.001674652099609375
local_in_edges_tensor generation:  0.0009696483612060547
mini_batch_src_global generation:  0.021436452865600586
r_  generation:  0.024624347686767578
local_output_nid generation:  0.0017702579498291016
local_in_edges_tensor generation:  0.0009613037109375
mini_batch_src_global generation:  0.0021467208862304688
r_  generation:  0.023084402084350586
local_output_nid generation:  0.0017466545104980469
local_in_edges_tensor generation:  0.0011737346649169922
mini_batch_src_global generation:  0.007855415344238281
r_  generation:  0.022057533264160156
local_output_nid generation:  0.0017151832580566406
local_in_edges_tensor generation:  0.0009562969207763672
mini_batch_src_global generation:  0.0017898082733154297
r_  generation:  0.022589445114135742
----------------------check_connections_block total spend ----------------------------- 0.5593955516815186
generate_one_block  0.03057408332824707
generate_one_block  0.03204202651977539
generate_one_block  0.030637741088867188
generate_one_block  0.03100728988647461
generate_one_block  0.030978679656982422
generate_one_block  0.03340458869934082
generate_one_block  0.03245711326599121
generate_one_block  0.030931711196899414
generate_one_block  0.0315704345703125
generate_one_block  0.031599998474121094
generate_one_block  0.03153181076049805
generate_one_block  0.03129911422729492
generate_one_block  0.03158140182495117
generate_one_block  0.03124547004699707
generate_one_block  0.03118109703063965
generate_one_block  0.0321650505065918
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.035772085189819336
gen group dst list time:  0.01873469352722168
time for parepare:  0.019217491149902344
local_output_nid generation:  0.00733494758605957
local_in_edges_tensor generation:  0.021842002868652344
mini_batch_src_global generation:  0.022363662719726562
r_  generation:  0.20861315727233887
local_output_nid generation:  0.011241674423217773
local_in_edges_tensor generation:  0.013457775115966797
mini_batch_src_global generation:  0.03310060501098633
r_  generation:  0.22507762908935547
local_output_nid generation:  0.011888980865478516
local_in_edges_tensor generation:  0.012109518051147461
mini_batch_src_global generation:  0.027318239212036133
r_  generation:  0.22531580924987793
local_output_nid generation:  0.01208186149597168
local_in_edges_tensor generation:  0.012817621231079102
mini_batch_src_global generation:  0.027051925659179688
r_  generation:  0.2289409637451172
local_output_nid generation:  0.011945009231567383
local_in_edges_tensor generation:  0.012328863143920898
mini_batch_src_global generation:  0.028445005416870117
r_  generation:  0.2311704158782959
local_output_nid generation:  0.012491703033447266
local_in_edges_tensor generation:  0.012092351913452148
mini_batch_src_global generation:  0.028751850128173828
r_  generation:  0.23160386085510254
local_output_nid generation:  0.013063192367553711
local_in_edges_tensor generation:  0.016561031341552734
mini_batch_src_global generation:  0.03057265281677246
r_  generation:  0.23946690559387207
local_output_nid generation:  0.01293325424194336
local_in_edges_tensor generation:  0.012417316436767578
mini_batch_src_global generation:  0.029446840286254883
r_  generation:  0.23094582557678223
local_output_nid generation:  0.013319969177246094
local_in_edges_tensor generation:  0.014668941497802734
mini_batch_src_global generation:  0.033265113830566406
r_  generation:  0.2402803897857666
local_output_nid generation:  0.01314687728881836
local_in_edges_tensor generation:  0.015313386917114258
mini_batch_src_global generation:  0.03192615509033203
r_  generation:  0.24188804626464844
local_output_nid generation:  0.013038158416748047
local_in_edges_tensor generation:  0.01229548454284668
mini_batch_src_global generation:  0.029427289962768555
r_  generation:  0.23752117156982422
local_output_nid generation:  0.013045072555541992
local_in_edges_tensor generation:  0.013095617294311523
mini_batch_src_global generation:  0.02927565574645996
r_  generation:  0.23270273208618164
local_output_nid generation:  0.013333559036254883
local_in_edges_tensor generation:  0.013275861740112305
mini_batch_src_global generation:  0.030078887939453125
r_  generation:  0.24112296104431152
local_output_nid generation:  0.013216257095336914
local_in_edges_tensor generation:  0.013791322708129883
mini_batch_src_global generation:  0.0299990177154541
r_  generation:  0.2378687858581543
local_output_nid generation:  0.013298511505126953
local_in_edges_tensor generation:  0.01274418830871582
mini_batch_src_global generation:  0.030315160751342773
r_  generation:  0.23818325996398926
local_output_nid generation:  0.012668132781982422
local_in_edges_tensor generation:  0.012545108795166016
mini_batch_src_global generation:  0.030016422271728516
r_  generation:  0.23736572265625
----------------------check_connections_block total spend ----------------------------- 5.455642938613892
generate_one_block  0.30219483375549316
generate_one_block  0.3029918670654297
generate_one_block  0.29439592361450195
generate_one_block  0.30290985107421875
generate_one_block  0.2948143482208252
generate_one_block  0.299224853515625
generate_one_block  0.33026123046875
generate_one_block  0.2950310707092285
generate_one_block  0.3130614757537842
generate_one_block  0.30588245391845703
generate_one_block  0.3040156364440918
generate_one_block  0.3016963005065918
generate_one_block  0.3058497905731201
generate_one_block  0.3096656799316406
generate_one_block  0.30349040031433105
generate_one_block  0.3013782501220703
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.031162023544311523
gen group dst list time:  0.06681156158447266
time for parepare:  0.02073502540588379
local_output_nid generation:  0.025656700134277344
local_in_edges_tensor generation:  0.04379153251647949
mini_batch_src_global generation:  0.041921377182006836
r_  generation:  0.44747233390808105
local_output_nid generation:  0.030579805374145508
local_in_edges_tensor generation:  0.03681540489196777
mini_batch_src_global generation:  0.056509971618652344
r_  generation:  0.4470224380493164
local_output_nid generation:  0.03098297119140625
local_in_edges_tensor generation:  0.03126692771911621
mini_batch_src_global generation:  0.053757667541503906
r_  generation:  0.45892810821533203
local_output_nid generation:  0.03150653839111328
local_in_edges_tensor generation:  0.03387784957885742
mini_batch_src_global generation:  0.05241894721984863
r_  generation:  0.4561145305633545
local_output_nid generation:  0.031768083572387695
local_in_edges_tensor generation:  0.07326817512512207
mini_batch_src_global generation:  0.05480647087097168
r_  generation:  0.464214563369751
local_output_nid generation:  0.03116917610168457
local_in_edges_tensor generation:  0.029440879821777344
mini_batch_src_global generation:  0.05443596839904785
r_  generation:  0.4541592597961426
local_output_nid generation:  0.03179764747619629
local_in_edges_tensor generation:  0.031577348709106445
mini_batch_src_global generation:  0.05393815040588379
r_  generation:  0.46495890617370605
local_output_nid generation:  0.03152751922607422
local_in_edges_tensor generation:  0.03452730178833008
mini_batch_src_global generation:  0.053914785385131836
r_  generation:  0.4592163562774658
local_output_nid generation:  0.03171086311340332
local_in_edges_tensor generation:  0.0339663028717041
mini_batch_src_global generation:  0.05307793617248535
r_  generation:  0.4696333408355713
local_output_nid generation:  0.03223228454589844
local_in_edges_tensor generation:  0.0356898307800293
mini_batch_src_global generation:  0.05423712730407715
r_  generation:  0.461517333984375
local_output_nid generation:  0.03186798095703125
local_in_edges_tensor generation:  0.02994084358215332
mini_batch_src_global generation:  0.05244278907775879
r_  generation:  0.47832632064819336
local_output_nid generation:  0.0328216552734375
local_in_edges_tensor generation:  0.029830217361450195
mini_batch_src_global generation:  0.0538935661315918
r_  generation:  0.4611537456512451
local_output_nid generation:  0.03426337242126465
local_in_edges_tensor generation:  0.030918121337890625
mini_batch_src_global generation:  0.055037736892700195
r_  generation:  0.4690897464752197
local_output_nid generation:  0.03264975547790527
local_in_edges_tensor generation:  0.030534982681274414
mini_batch_src_global generation:  0.058135271072387695
r_  generation:  0.4573054313659668
local_output_nid generation:  0.032984018325805664
local_in_edges_tensor generation:  0.02964305877685547
mini_batch_src_global generation:  0.05173492431640625
r_  generation:  0.4657759666442871
local_output_nid generation:  0.03316998481750488
local_in_edges_tensor generation:  0.031636953353881836
mini_batch_src_global generation:  0.05550122261047363
r_  generation:  0.4589662551879883
----------------------check_connections_block total spend ----------------------------- 10.932287454605103
generate_one_block  0.5826823711395264
generate_one_block  0.5835492610931396
generate_one_block  0.5878903865814209
generate_one_block  0.5879194736480713
generate_one_block  0.5806536674499512
generate_one_block  0.5793311595916748
generate_one_block  0.5845084190368652
generate_one_block  0.5898721218109131
generate_one_block  0.6183590888977051
generate_one_block  0.5854885578155518
generate_one_block  0.5825464725494385
generate_one_block  0.5789878368377686
generate_one_block  0.5859251022338867
generate_one_block  0.5854127407073975
generate_one_block  0.5863709449768066
generate_one_block  0.590686559677124
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11812257766723633  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

connection checking time:  16.387930393218994
block generation total time  14.2570481300354
average batch blocks generation time:  0.8910655081272125
block dataloader generation time/epoch 32.76462650299072
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0940256118774414  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7359566688537598  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09476566314697266  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7450675964355469  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09433937072753906  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7425241470336914  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09471797943115234  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7452397346496582  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09425878524780273  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7417745590209961  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09463977813720703  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7383670806884766  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09465360641479492  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7510809898376465  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0946512222290039  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7442288398742676  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09464406967163086  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7508702278137207  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09486198425292969  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7472438812255859  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09439754486083984  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7431545257568359  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09467411041259766  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7434744834899902  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09454727172851562  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7478160858154297  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09483623504638672  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7468175888061523  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09449386596679688  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7446398735046387  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09477901458740234  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7453575134277344  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06514906883239746 |0.012402042746543884 |0.0036368370056152344 |9.156763553619385e-05 |0.0037238597869873047 |0.001466512680053711 |
----------------------------------------------------------pseudo_mini_loss sum 1.4847946166992188
Total (block generation + training)time/epoch 34.17465543746948
Training time/epoch 1.4221696853637695
Training time without block to device /epoch 1.2237370014190674
Training time without total dataloading part /epoch 0.12070274353027344
load block tensor time/epoch 1.0423851013183594
block to device time/epoch 0.19843268394470215
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  5204605
Number of first layer input nodes during this epoch:  2479347
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11826848983764648  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02296590805053711
range selection method range initialization spend 0.012311935424804688
time for parepare:  0.0168917179107666
local_output_nid generation:  0.0014824867248535156
local_in_edges_tensor generation:  0.007814645767211914
mini_batch_src_global generation:  0.001764535903930664
r_  generation:  0.021239757537841797
local_output_nid generation:  0.0015454292297363281
local_in_edges_tensor generation:  0.0009667873382568359
mini_batch_src_global generation:  0.002050161361694336
r_  generation:  0.021896839141845703
local_output_nid generation:  0.0016837120056152344
local_in_edges_tensor generation:  0.0010657310485839844
mini_batch_src_global generation:  0.0016753673553466797
r_  generation:  0.021446704864501953
local_output_nid generation:  0.0016198158264160156
local_in_edges_tensor generation:  0.0009658336639404297
mini_batch_src_global generation:  0.001779794692993164
r_  generation:  0.021709918975830078
local_output_nid generation:  0.0015349388122558594
local_in_edges_tensor generation:  0.0009312629699707031
mini_batch_src_global generation:  0.0018019676208496094
r_  generation:  0.022155046463012695
local_output_nid generation:  0.001535654067993164
local_in_edges_tensor generation:  0.0009489059448242188
mini_batch_src_global generation:  0.0017833709716796875
r_  generation:  0.02205824851989746
local_output_nid generation:  0.0015573501586914062
local_in_edges_tensor generation:  0.0009360313415527344
mini_batch_src_global generation:  0.0018010139465332031
r_  generation:  0.02257704734802246
local_output_nid generation:  0.0015869140625
local_in_edges_tensor generation:  0.0009837150573730469
mini_batch_src_global generation:  0.0017795562744140625
r_  generation:  0.021785259246826172
local_output_nid generation:  0.0016541481018066406
local_in_edges_tensor generation:  0.0009622573852539062
mini_batch_src_global generation:  0.0017650127410888672
r_  generation:  0.021958351135253906
local_output_nid generation:  0.0015380382537841797
local_in_edges_tensor generation:  0.0009629726409912109
mini_batch_src_global generation:  0.0018048286437988281
r_  generation:  0.022387266159057617
local_output_nid generation:  0.0015540122985839844
local_in_edges_tensor generation:  0.0009648799896240234
mini_batch_src_global generation:  0.0018262863159179688
r_  generation:  0.022304296493530273
local_output_nid generation:  0.0015573501586914062
local_in_edges_tensor generation:  0.0009393692016601562
mini_batch_src_global generation:  0.0017595291137695312
r_  generation:  0.021726608276367188
local_output_nid generation:  0.001561880111694336
local_in_edges_tensor generation:  0.001062154769897461
mini_batch_src_global generation:  0.0017223358154296875
r_  generation:  0.021677494049072266
local_output_nid generation:  0.0015537738800048828
local_in_edges_tensor generation:  0.0009496212005615234
mini_batch_src_global generation:  0.0017249584197998047
r_  generation:  0.021838665008544922
local_output_nid generation:  0.0015645027160644531
local_in_edges_tensor generation:  0.0009522438049316406
mini_batch_src_global generation:  0.001800537109375
r_  generation:  0.022352933883666992
local_output_nid generation:  0.0015604496002197266
local_in_edges_tensor generation:  0.0009508132934570312
mini_batch_src_global generation:  0.0017852783203125
r_  generation:  0.02264094352722168
----------------------check_connections_block total spend ----------------------------- 0.5222506523132324
generate_one_block  0.03084111213684082
generate_one_block  0.031156063079833984
generate_one_block  0.031017303466796875
generate_one_block  0.0314176082611084
generate_one_block  0.0312962532043457
generate_one_block  0.03306865692138672
generate_one_block  0.031905174255371094
generate_one_block  0.03099370002746582
generate_one_block  0.032799720764160156
generate_one_block  0.03150486946105957
generate_one_block  0.031525611877441406
generate_one_block  0.031455039978027344
generate_one_block  0.030597686767578125
generate_one_block  0.031032562255859375
generate_one_block  0.031187772750854492
generate_one_block  0.03261160850524902
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03498339653015137
gen group dst list time:  0.017816543579101562
time for parepare:  0.019726991653442383
local_output_nid generation:  0.007825374603271484
local_in_edges_tensor generation:  0.024309396743774414
mini_batch_src_global generation:  0.02295851707458496
r_  generation:  0.21657562255859375
local_output_nid generation:  0.011144161224365234
local_in_edges_tensor generation:  0.015481948852539062
mini_batch_src_global generation:  0.02801656723022461
r_  generation:  0.22209739685058594
local_output_nid generation:  0.01152181625366211
local_in_edges_tensor generation:  0.012230157852172852
mini_batch_src_global generation:  0.027497053146362305
r_  generation:  0.22779369354248047
local_output_nid generation:  0.012308597564697266
local_in_edges_tensor generation:  0.012819766998291016
mini_batch_src_global generation:  0.02883434295654297
r_  generation:  0.23622560501098633
local_output_nid generation:  0.012894868850708008
local_in_edges_tensor generation:  0.01655411720275879
mini_batch_src_global generation:  0.029016733169555664
r_  generation:  0.23799681663513184
local_output_nid generation:  0.01291656494140625
local_in_edges_tensor generation:  0.013562917709350586
mini_batch_src_global generation:  0.02914881706237793
r_  generation:  0.23667049407958984
local_output_nid generation:  0.013447046279907227
local_in_edges_tensor generation:  0.012911796569824219
mini_batch_src_global generation:  0.029932022094726562
r_  generation:  0.24048829078674316
local_output_nid generation:  0.012982368469238281
local_in_edges_tensor generation:  0.012681007385253906
mini_batch_src_global generation:  0.029549121856689453
r_  generation:  0.23134398460388184
local_output_nid generation:  0.01315164566040039
local_in_edges_tensor generation:  0.013105154037475586
mini_batch_src_global generation:  0.029363632202148438
r_  generation:  0.23910117149353027
local_output_nid generation:  0.013356208801269531
local_in_edges_tensor generation:  0.015254020690917969
mini_batch_src_global generation:  0.029293298721313477
r_  generation:  0.24049949645996094
local_output_nid generation:  0.013124465942382812
local_in_edges_tensor generation:  0.013926982879638672
mini_batch_src_global generation:  0.029534101486206055
r_  generation:  0.23931431770324707
local_output_nid generation:  0.013432979583740234
local_in_edges_tensor generation:  0.01296377182006836
mini_batch_src_global generation:  0.029154062271118164
r_  generation:  0.23538851737976074
local_output_nid generation:  0.013214588165283203
local_in_edges_tensor generation:  0.012747764587402344
mini_batch_src_global generation:  0.028941869735717773
r_  generation:  0.2333989143371582
local_output_nid generation:  0.013297557830810547
local_in_edges_tensor generation:  0.013832807540893555
mini_batch_src_global generation:  0.029187440872192383
r_  generation:  0.23927545547485352
local_output_nid generation:  0.013360738754272461
local_in_edges_tensor generation:  0.013928890228271484
mini_batch_src_global generation:  0.030712604522705078
r_  generation:  0.24126529693603516
local_output_nid generation:  0.013020992279052734
local_in_edges_tensor generation:  0.015782833099365234
mini_batch_src_global generation:  0.031160593032836914
r_  generation:  0.24371051788330078
----------------------check_connections_block total spend ----------------------------- 5.493098735809326
generate_one_block  0.3030405044555664
generate_one_block  0.29557204246520996
generate_one_block  0.30178141593933105
generate_one_block  0.3080122470855713
generate_one_block  0.3068666458129883
generate_one_block  0.3016166687011719
generate_one_block  0.33032751083374023
generate_one_block  0.29740023612976074
generate_one_block  0.30013084411621094
generate_one_block  0.30571627616882324
generate_one_block  0.3049178123474121
generate_one_block  0.3005087375640869
generate_one_block  0.2932875156402588
generate_one_block  0.30049610137939453
generate_one_block  0.3012571334838867
generate_one_block  0.3129739761352539
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030214548110961914
gen group dst list time:  0.06835699081420898
time for parepare:  0.017579078674316406
local_output_nid generation:  0.02595233917236328
local_in_edges_tensor generation:  0.04681873321533203
mini_batch_src_global generation:  0.04059147834777832
r_  generation:  0.45023226737976074
local_output_nid generation:  0.02977585792541504
local_in_edges_tensor generation:  0.03480696678161621
mini_batch_src_global generation:  0.05187034606933594
r_  generation:  0.4482417106628418
local_output_nid generation:  0.031093835830688477
local_in_edges_tensor generation:  0.030737876892089844
mini_batch_src_global generation:  0.05143332481384277
r_  generation:  0.46467041969299316
local_output_nid generation:  0.03104114532470703
local_in_edges_tensor generation:  0.03109884262084961
mini_batch_src_global generation:  0.05514693260192871
r_  generation:  0.45841503143310547
local_output_nid generation:  0.03144693374633789
local_in_edges_tensor generation:  0.07337284088134766
mini_batch_src_global generation:  0.05117964744567871
r_  generation:  0.4673464298248291
local_output_nid generation:  0.03106403350830078
local_in_edges_tensor generation:  0.031091690063476562
mini_batch_src_global generation:  0.05309176445007324
r_  generation:  0.4556128978729248
local_output_nid generation:  0.031167984008789062
local_in_edges_tensor generation:  0.0313570499420166
mini_batch_src_global generation:  0.05133771896362305
r_  generation:  0.4673612117767334
local_output_nid generation:  0.03151106834411621
local_in_edges_tensor generation:  0.03139352798461914
mini_batch_src_global generation:  0.05271792411804199
r_  generation:  0.4542667865753174
local_output_nid generation:  0.03125
local_in_edges_tensor generation:  0.03153872489929199
mini_batch_src_global generation:  0.0517733097076416
r_  generation:  0.4632294178009033
local_output_nid generation:  0.03121042251586914
local_in_edges_tensor generation:  0.029951095581054688
mini_batch_src_global generation:  0.05313253402709961
r_  generation:  0.45803403854370117
local_output_nid generation:  0.031524658203125
local_in_edges_tensor generation:  0.032958030700683594
mini_batch_src_global generation:  0.052126407623291016
r_  generation:  0.46510791778564453
local_output_nid generation:  0.0314791202545166
local_in_edges_tensor generation:  0.03086113929748535
mini_batch_src_global generation:  0.054917097091674805
r_  generation:  0.45902109146118164
local_output_nid generation:  0.0315399169921875
local_in_edges_tensor generation:  0.029308795928955078
mini_batch_src_global generation:  0.05165410041809082
r_  generation:  0.4647645950317383
local_output_nid generation:  0.031566619873046875
local_in_edges_tensor generation:  0.03130912780761719
mini_batch_src_global generation:  0.05283498764038086
r_  generation:  0.45688819885253906
local_output_nid generation:  0.03145790100097656
local_in_edges_tensor generation:  0.02943730354309082
mini_batch_src_global generation:  0.05276131629943848
r_  generation:  0.46426868438720703
local_output_nid generation:  0.03160881996154785
local_in_edges_tensor generation:  0.03166007995605469
mini_batch_src_global generation:  0.05308222770690918
r_  generation:  0.4584364891052246
----------------------check_connections_block total spend ----------------------------- 10.8574059009552
generate_one_block  0.5850629806518555
generate_one_block  0.5753238201141357
generate_one_block  0.590897798538208
generate_one_block  0.582392692565918
generate_one_block  0.5814080238342285
generate_one_block  0.5777308940887451
generate_one_block  0.5863666534423828
generate_one_block  0.5736477375030518
generate_one_block  0.6317698955535889
generate_one_block  0.5822815895080566
generate_one_block  0.5817673206329346
generate_one_block  0.5763046741485596
generate_one_block  0.581944465637207
generate_one_block  0.5877320766448975
generate_one_block  0.5755569934844971
generate_one_block  0.5892229080200195
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11826848983764648  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

connection checking time:  16.350504636764526
block generation total time  14.223316192626953
average batch blocks generation time:  0.8889572620391846
block dataloader generation time/epoch 32.74448528289795
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09458160400390625  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7513580322265625  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09461402893066406  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7367076873779297  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09452295303344727  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7467164993286133  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0948629379272461  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.747197151184082  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.094573974609375  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7525653839111328  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09478759765625  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7453737258911133  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0947260856628418  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.753108024597168  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09459495544433594  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7414450645446777  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09429073333740234  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.742793083190918  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09481239318847656  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7472114562988281  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0944967269897461  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7442998886108398  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09463691711425781  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7423548698425293  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0944356918334961  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.743718147277832  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0947732925415039  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7436485290527344  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09439992904663086  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7435369491577148  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09492683410644531  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7517433166503906  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06519588828086853 |0.010364919900894165 |0.0035974979400634766 |9.235739707946777e-05 |0.003736823797225952 |0.0017786026000976562 |
----------------------------------------------------------pseudo_mini_loss sum 1.4603843688964844
Total (block generation + training)time/epoch 34.150928544998166
Training time/epoch 1.391801357269287
Training time without block to device /epoch 1.2259626388549805
Training time without total dataloading part /epoch 0.12060546875
load block tensor time/epoch 1.0431342124938965
block to device time/epoch 0.16583871841430664
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  5210288
Number of first layer input nodes during this epoch:  2480779
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11964750289916992  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021896839141845703
range selection method range initialization spend 0.012579679489135742
time for parepare:  0.016908884048461914
local_output_nid generation:  0.0015077590942382812
local_in_edges_tensor generation:  0.0032799243927001953
mini_batch_src_global generation:  0.001684427261352539
r_  generation:  0.020690202713012695
local_output_nid generation:  0.0015773773193359375
local_in_edges_tensor generation:  0.0009970664978027344
mini_batch_src_global generation:  0.00199127197265625
r_  generation:  0.021961212158203125
local_output_nid generation:  0.0015892982482910156
local_in_edges_tensor generation:  0.0010554790496826172
mini_batch_src_global generation:  0.0016326904296875
r_  generation:  0.020990371704101562
local_output_nid generation:  0.0016529560089111328
local_in_edges_tensor generation:  0.0009615421295166016
mini_batch_src_global generation:  0.0017406940460205078
r_  generation:  0.022094011306762695
local_output_nid generation:  0.0015704631805419922
local_in_edges_tensor generation:  0.0009553432464599609
mini_batch_src_global generation:  0.0017330646514892578
r_  generation:  0.021306514739990234
local_output_nid generation:  0.0015769004821777344
local_in_edges_tensor generation:  0.0009417533874511719
mini_batch_src_global generation:  0.0017042160034179688
r_  generation:  0.02185344696044922
local_output_nid generation:  0.001592397689819336
local_in_edges_tensor generation:  0.0009512901306152344
mini_batch_src_global generation:  0.0017428398132324219
r_  generation:  0.0219118595123291
local_output_nid generation:  0.0015780925750732422
local_in_edges_tensor generation:  0.0009438991546630859
mini_batch_src_global generation:  0.001806020736694336
r_  generation:  0.02295994758605957
local_output_nid generation:  0.0015857219696044922
local_in_edges_tensor generation:  0.0009479522705078125
mini_batch_src_global generation:  0.0018362998962402344
r_  generation:  0.022512197494506836
local_output_nid generation:  0.0015861988067626953
local_in_edges_tensor generation:  0.0009720325469970703
mini_batch_src_global generation:  0.0018198490142822266
r_  generation:  0.023014545440673828
local_output_nid generation:  0.0016248226165771484
local_in_edges_tensor generation:  0.000993490219116211
mini_batch_src_global generation:  0.001767873764038086
r_  generation:  0.02214956283569336
local_output_nid generation:  0.0016393661499023438
local_in_edges_tensor generation:  0.0009417533874511719
mini_batch_src_global generation:  0.0017824172973632812
r_  generation:  0.02286696434020996
local_output_nid generation:  0.0016105175018310547
local_in_edges_tensor generation:  0.0009598731994628906
mini_batch_src_global generation:  0.0017971992492675781
r_  generation:  0.022613048553466797
local_output_nid generation:  0.001600503921508789
local_in_edges_tensor generation:  0.0009546279907226562
mini_batch_src_global generation:  0.0017735958099365234
r_  generation:  0.02216625213623047
local_output_nid generation:  0.0016067028045654297
local_in_edges_tensor generation:  0.0009584426879882812
mini_batch_src_global generation:  0.0017321109771728516
r_  generation:  0.022017955780029297
local_output_nid generation:  0.0016264915466308594
local_in_edges_tensor generation:  0.0009753704071044922
mini_batch_src_global generation:  0.0017728805541992188
r_  generation:  0.0228424072265625
----------------------check_connections_block total spend ----------------------------- 0.5208008289337158
generate_one_block  0.03019547462463379
generate_one_block  0.031434059143066406
generate_one_block  0.030663251876831055
generate_one_block  0.03165268898010254
generate_one_block  0.03073573112487793
generate_one_block  0.03261852264404297
generate_one_block  0.030899524688720703
generate_one_block  0.032514333724975586
generate_one_block  0.03162980079650879
generate_one_block  0.0318913459777832
generate_one_block  0.03091120719909668
generate_one_block  0.03212332725524902
generate_one_block  0.03188610076904297
generate_one_block  0.03108358383178711
generate_one_block  0.030829429626464844
generate_one_block  0.03248476982116699
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030383586883544922
gen group dst list time:  0.0176389217376709
time for parepare:  0.019366979598999023
local_output_nid generation:  0.00751805305480957
local_in_edges_tensor generation:  0.017423152923583984
mini_batch_src_global generation:  0.022040843963623047
r_  generation:  0.21598124504089355
local_output_nid generation:  0.011232614517211914
local_in_edges_tensor generation:  0.011524200439453125
mini_batch_src_global generation:  0.0282595157623291
r_  generation:  0.2263484001159668
local_output_nid generation:  0.011665582656860352
local_in_edges_tensor generation:  0.01584625244140625
mini_batch_src_global generation:  0.02731466293334961
r_  generation:  0.23622775077819824
local_output_nid generation:  0.01611614227294922
local_in_edges_tensor generation:  0.01652240753173828
mini_batch_src_global generation:  0.028563737869262695
r_  generation:  0.23706340789794922
local_output_nid generation:  0.012403726577758789
local_in_edges_tensor generation:  0.015752553939819336
mini_batch_src_global generation:  0.029414653778076172
r_  generation:  0.23637700080871582
local_output_nid generation:  0.012855291366577148
local_in_edges_tensor generation:  0.016252756118774414
mini_batch_src_global generation:  0.03191852569580078
r_  generation:  0.23853492736816406
local_output_nid generation:  0.012961387634277344
local_in_edges_tensor generation:  0.021389484405517578
mini_batch_src_global generation:  0.02922987937927246
r_  generation:  0.2510991096496582
local_output_nid generation:  0.015568256378173828
local_in_edges_tensor generation:  0.0169980525970459
mini_batch_src_global generation:  0.03121209144592285
r_  generation:  0.2425243854522705
local_output_nid generation:  0.013571023941040039
local_in_edges_tensor generation:  0.012807369232177734
mini_batch_src_global generation:  0.0301666259765625
r_  generation:  0.2386763095855713
local_output_nid generation:  0.01371455192565918
local_in_edges_tensor generation:  0.013352632522583008
mini_batch_src_global generation:  0.030598163604736328
r_  generation:  0.2411327362060547
local_output_nid generation:  0.012993574142456055
local_in_edges_tensor generation:  0.013150215148925781
mini_batch_src_global generation:  0.02983832359313965
r_  generation:  0.2369060516357422
local_output_nid generation:  0.013753890991210938
local_in_edges_tensor generation:  0.014974832534790039
mini_batch_src_global generation:  0.03012561798095703
r_  generation:  0.24280047416687012
local_output_nid generation:  0.013868331909179688
local_in_edges_tensor generation:  0.01319432258605957
mini_batch_src_global generation:  0.03037238121032715
r_  generation:  0.24070286750793457
local_output_nid generation:  0.013657808303833008
local_in_edges_tensor generation:  0.01322793960571289
mini_batch_src_global generation:  0.029681682586669922
r_  generation:  0.24221014976501465
local_output_nid generation:  0.013586759567260742
local_in_edges_tensor generation:  0.013286828994750977
mini_batch_src_global generation:  0.029589414596557617
r_  generation:  0.23686981201171875
local_output_nid generation:  0.014906167984008789
local_in_edges_tensor generation:  0.013349056243896484
mini_batch_src_global generation:  0.031037569046020508
r_  generation:  0.24378275871276855
----------------------check_connections_block total spend ----------------------------- 5.571052551269531
generate_one_block  0.3105466365814209
generate_one_block  0.3019430637359619
generate_one_block  0.2976670265197754
generate_one_block  0.3068807125091553
generate_one_block  0.30103039741516113
generate_one_block  0.3076314926147461
generate_one_block  0.3321261405944824
generate_one_block  0.31618452072143555
generate_one_block  0.30458998680114746
generate_one_block  0.30715107917785645
generate_one_block  0.3033432960510254
generate_one_block  0.314164400100708
generate_one_block  0.31445813179016113
generate_one_block  0.3020298480987549
generate_one_block  0.3014969825744629
generate_one_block  0.31295251846313477
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04369664192199707
gen group dst list time:  0.0709986686706543
time for parepare:  0.019184589385986328
local_output_nid generation:  0.02600860595703125
local_in_edges_tensor generation:  0.045633554458618164
mini_batch_src_global generation:  0.04198908805847168
r_  generation:  0.4478628635406494
local_output_nid generation:  0.03035569190979004
local_in_edges_tensor generation:  0.03793215751647949
mini_batch_src_global generation:  0.054393768310546875
r_  generation:  0.4506645202636719
local_output_nid generation:  0.03102564811706543
local_in_edges_tensor generation:  0.029545307159423828
mini_batch_src_global generation:  0.05123758316040039
r_  generation:  0.45832371711730957
local_output_nid generation:  0.030742883682250977
local_in_edges_tensor generation:  0.032190799713134766
mini_batch_src_global generation:  0.05483722686767578
r_  generation:  0.45498085021972656
local_output_nid generation:  0.031016826629638672
local_in_edges_tensor generation:  0.07176637649536133
mini_batch_src_global generation:  0.05136847496032715
r_  generation:  0.46391987800598145
local_output_nid generation:  0.031441450119018555
local_in_edges_tensor generation:  0.03315472602844238
mini_batch_src_global generation:  0.05891227722167969
r_  generation:  0.4605977535247803
local_output_nid generation:  0.03123021125793457
local_in_edges_tensor generation:  0.03251171112060547
mini_batch_src_global generation:  0.053218841552734375
r_  generation:  0.4678456783294678
local_output_nid generation:  0.03164839744567871
local_in_edges_tensor generation:  0.03454995155334473
mini_batch_src_global generation:  0.05295562744140625
r_  generation:  0.46382761001586914
local_output_nid generation:  0.03206324577331543
local_in_edges_tensor generation:  0.031707048416137695
mini_batch_src_global generation:  0.052603721618652344
r_  generation:  0.47350549697875977
local_output_nid generation:  0.031984567642211914
local_in_edges_tensor generation:  0.03542375564575195
mini_batch_src_global generation:  0.05455636978149414
r_  generation:  0.466400146484375
local_output_nid generation:  0.03147101402282715
local_in_edges_tensor generation:  0.03232717514038086
mini_batch_src_global generation:  0.051550865173339844
r_  generation:  0.46973681449890137
local_output_nid generation:  0.03170013427734375
local_in_edges_tensor generation:  0.03745079040527344
mini_batch_src_global generation:  0.05576634407043457
r_  generation:  0.46576571464538574
local_output_nid generation:  0.031951904296875
local_in_edges_tensor generation:  0.033646345138549805
mini_batch_src_global generation:  0.05262565612792969
r_  generation:  0.4798731803894043
local_output_nid generation:  0.03425312042236328
local_in_edges_tensor generation:  0.03473234176635742
mini_batch_src_global generation:  0.05280137062072754
r_  generation:  0.4601314067840576
local_output_nid generation:  0.0323941707611084
local_in_edges_tensor generation:  0.03697633743286133
mini_batch_src_global generation:  0.05212235450744629
r_  generation:  0.4662172794342041
local_output_nid generation:  0.0323638916015625
local_in_edges_tensor generation:  0.03047966957092285
mini_batch_src_global generation:  0.054769277572631836
r_  generation:  0.4598383903503418
----------------------check_connections_block total spend ----------------------------- 10.991086959838867
generate_one_block  0.5891108512878418
generate_one_block  0.5842928886413574
generate_one_block  0.576930046081543
generate_one_block  0.5868911743164062
generate_one_block  0.5772216320037842
generate_one_block  0.5867719650268555
generate_one_block  0.5857460498809814
generate_one_block  0.6040399074554443
generate_one_block  0.6225795745849609
generate_one_block  0.5846033096313477
generate_one_block  0.5851569175720215
generate_one_block  0.591052770614624
generate_one_block  0.5835492610931396
generate_one_block  0.5915822982788086
generate_one_block  0.5827412605285645
generate_one_block  0.605712890625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11964750289916992  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

connection checking time:  16.5621395111084
block generation total time  14.37217903137207
average batch blocks generation time:  0.8982611894607544
block dataloader generation time/epoch 32.80232028166453
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09438514709472656  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7407784461975098  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09472942352294922  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7430806159973145  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09443140029907227  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7418365478515625  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09486103057861328  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.749915599822998  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09444189071655273  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7410211563110352  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09466838836669922  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7454061508178711  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09433460235595703  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7401885986328125  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09492969512939453  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7498774528503418  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0943751335144043  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.746821403503418  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0948324203491211  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.749608039855957  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09434843063354492  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7421584129333496  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09490203857421875  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7544350624084473  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09461641311645508  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7505226135253906  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09476184844970703  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.746027946472168  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09433698654174805  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7443041801452637  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0949249267578125  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.753352165222168  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06541512906551361 |0.012912735342979431 |0.0035898536443710327 |8.983910083770752e-05 |0.003740563988685608 |0.0013718605041503906 |
----------------------------------------------------------pseudo_mini_loss sum 1.4286041259765625
Total (block generation + training)time/epoch 34.21356316407522
Training time/epoch 1.4350485801696777
Training time without block to device /epoch 1.2284448146820068
Training time without total dataloading part /epoch 0.12009596824645996
load block tensor time/epoch 1.0466420650482178
block to device time/epoch 0.2066037654876709
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  5210459
Number of first layer input nodes during this epoch:  2480791
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.1196436882019043  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02594447135925293
range selection method range initialization spend 0.012355566024780273
time for parepare:  0.01720261573791504
local_output_nid generation:  0.0015320777893066406
local_in_edges_tensor generation:  0.006745338439941406
mini_batch_src_global generation:  0.0017004013061523438
r_  generation:  0.020380020141601562
local_output_nid generation:  0.0015325546264648438
local_in_edges_tensor generation:  0.0009989738464355469
mini_batch_src_global generation:  0.001988649368286133
r_  generation:  0.022116422653198242
local_output_nid generation:  0.0016443729400634766
local_in_edges_tensor generation:  0.0009543895721435547
mini_batch_src_global generation:  0.0017857551574707031
r_  generation:  0.021137237548828125
local_output_nid generation:  0.0016040802001953125
local_in_edges_tensor generation:  0.0009434223175048828
mini_batch_src_global generation:  0.0017025470733642578
r_  generation:  0.02159738540649414
local_output_nid generation:  0.0015463829040527344
local_in_edges_tensor generation:  0.000942230224609375
mini_batch_src_global generation:  0.0017070770263671875
r_  generation:  0.021756887435913086
local_output_nid generation:  0.0016467571258544922
local_in_edges_tensor generation:  0.0009603500366210938
mini_batch_src_global generation:  0.0017960071563720703
r_  generation:  0.022443771362304688
local_output_nid generation:  0.0015823841094970703
local_in_edges_tensor generation:  0.0010421276092529297
mini_batch_src_global generation:  0.0017845630645751953
r_  generation:  0.022602081298828125
local_output_nid generation:  0.0015878677368164062
local_in_edges_tensor generation:  0.0009429454803466797
mini_batch_src_global generation:  0.0018062591552734375
r_  generation:  0.024733304977416992
local_output_nid generation:  0.0015757083892822266
local_in_edges_tensor generation:  0.0010440349578857422
mini_batch_src_global generation:  0.0017642974853515625
r_  generation:  0.021602630615234375
local_output_nid generation:  0.0016088485717773438
local_in_edges_tensor generation:  0.0009670257568359375
mini_batch_src_global generation:  0.01680779457092285
r_  generation:  0.022780895233154297
local_output_nid generation:  0.0016186237335205078
local_in_edges_tensor generation:  0.00096893310546875
mini_batch_src_global generation:  0.0017559528350830078
r_  generation:  0.022118568420410156
local_output_nid generation:  0.0016055107116699219
local_in_edges_tensor generation:  0.0009610652923583984
mini_batch_src_global generation:  0.001737356185913086
r_  generation:  0.032558441162109375
local_output_nid generation:  0.002617359161376953
local_in_edges_tensor generation:  0.0012464523315429688
mini_batch_src_global generation:  0.0020112991333007812
r_  generation:  0.023193836212158203
local_output_nid generation:  0.0019779205322265625
local_in_edges_tensor generation:  0.0011394023895263672
mini_batch_src_global generation:  0.0019118785858154297
r_  generation:  0.022510290145874023
local_output_nid generation:  0.0018949508666992188
local_in_edges_tensor generation:  0.0010764598846435547
mini_batch_src_global generation:  0.0018718242645263672
r_  generation:  0.022621870040893555
local_output_nid generation:  0.0018835067749023438
local_in_edges_tensor generation:  0.0010819435119628906
mini_batch_src_global generation:  0.001931905746459961
r_  generation:  0.02194976806640625
----------------------check_connections_block total spend ----------------------------- 0.5861568450927734
generate_one_block  0.032448768615722656
generate_one_block  0.032135963439941406
generate_one_block  0.03148794174194336
generate_one_block  0.032280683517456055
generate_one_block  0.03220701217651367
generate_one_block  0.035552024841308594
generate_one_block  0.032758235931396484
generate_one_block  0.032822370529174805
generate_one_block  0.032431840896606445
generate_one_block  0.032196998596191406
generate_one_block  0.031958818435668945
generate_one_block  0.03179788589477539
generate_one_block  0.033616065979003906
generate_one_block  0.0323028564453125
generate_one_block  0.034268856048583984
generate_one_block  0.032914161682128906
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04792451858520508
gen group dst list time:  0.022061824798583984
time for parepare:  0.0211026668548584
local_output_nid generation:  0.008803606033325195
local_in_edges_tensor generation:  0.022940397262573242
mini_batch_src_global generation:  0.025007247924804688
r_  generation:  0.21622943878173828
local_output_nid generation:  0.014601469039916992
local_in_edges_tensor generation:  0.020781278610229492
mini_batch_src_global generation:  0.03395581245422363
r_  generation:  0.24657917022705078
local_output_nid generation:  0.018759727478027344
local_in_edges_tensor generation:  0.013990402221679688
mini_batch_src_global generation:  0.027931690216064453
r_  generation:  0.23590826988220215
local_output_nid generation:  0.015694141387939453
local_in_edges_tensor generation:  0.015072345733642578
mini_batch_src_global generation:  0.03160715103149414
r_  generation:  0.2434675693511963
local_output_nid generation:  0.015665531158447266
local_in_edges_tensor generation:  0.01624608039855957
mini_batch_src_global generation:  0.03109455108642578
r_  generation:  0.24823784828186035
local_output_nid generation:  0.015559196472167969
local_in_edges_tensor generation:  0.014919519424438477
mini_batch_src_global generation:  0.032309532165527344
r_  generation:  0.24773812294006348
local_output_nid generation:  0.01597142219543457
local_in_edges_tensor generation:  0.014578819274902344
mini_batch_src_global generation:  0.033808231353759766
r_  generation:  0.2533717155456543
local_output_nid generation:  0.01603555679321289
local_in_edges_tensor generation:  0.013638019561767578
mini_batch_src_global generation:  0.033344268798828125
r_  generation:  0.24870944023132324
local_output_nid generation:  0.016005754470825195
local_in_edges_tensor generation:  0.016160011291503906
mini_batch_src_global generation:  0.03300642967224121
r_  generation:  0.2519247531890869
local_output_nid generation:  0.016115188598632812
local_in_edges_tensor generation:  0.01374506950378418
mini_batch_src_global generation:  0.03220963478088379
r_  generation:  0.25211524963378906
local_output_nid generation:  0.015358209609985352
local_in_edges_tensor generation:  0.013733148574829102
mini_batch_src_global generation:  0.03173971176147461
r_  generation:  0.2471315860748291
local_output_nid generation:  0.0158689022064209
local_in_edges_tensor generation:  0.013555765151977539
mini_batch_src_global generation:  0.032688140869140625
r_  generation:  0.24951601028442383
local_output_nid generation:  0.016436338424682617
local_in_edges_tensor generation:  0.01820850372314453
mini_batch_src_global generation:  0.03448963165283203
r_  generation:  0.25763702392578125
local_output_nid generation:  0.016111373901367188
local_in_edges_tensor generation:  0.014976263046264648
mini_batch_src_global generation:  0.03365206718444824
r_  generation:  0.2505002021789551
local_output_nid generation:  0.015935182571411133
local_in_edges_tensor generation:  0.015128850936889648
mini_batch_src_global generation:  0.03416705131530762
r_  generation:  0.26192784309387207
local_output_nid generation:  0.015647411346435547
local_in_edges_tensor generation:  0.015206575393676758
mini_batch_src_global generation:  0.03389239311218262
r_  generation:  0.2545192241668701
----------------------check_connections_block total spend ----------------------------- 5.909711122512817
generate_one_block  0.30556297302246094
generate_one_block  0.3045825958251953
generate_one_block  0.3029048442840576
generate_one_block  0.31037306785583496
generate_one_block  0.30887651443481445
generate_one_block  0.306868314743042
generate_one_block  0.3525047302246094
generate_one_block  0.3034055233001709
generate_one_block  0.3012502193450928
generate_one_block  0.3023104667663574
generate_one_block  0.2982494831085205
generate_one_block  0.2982819080352783
generate_one_block  0.31060791015625
generate_one_block  0.3057117462158203
generate_one_block  0.31620311737060547
generate_one_block  0.3058345317840576
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.036211252212524414
gen group dst list time:  0.06377863883972168
time for parepare:  0.01961517333984375
local_output_nid generation:  0.025899648666381836
local_in_edges_tensor generation:  0.04439663887023926
mini_batch_src_global generation:  0.04169511795043945
r_  generation:  0.4657166004180908
local_output_nid generation:  0.030179262161254883
local_in_edges_tensor generation:  0.038072824478149414
mini_batch_src_global generation:  0.05421328544616699
r_  generation:  0.4510612487792969
local_output_nid generation:  0.030458927154541016
local_in_edges_tensor generation:  0.03443741798400879
mini_batch_src_global generation:  0.050762176513671875
r_  generation:  0.46219491958618164
local_output_nid generation:  0.030937671661376953
local_in_edges_tensor generation:  0.03133559226989746
mini_batch_src_global generation:  0.05270195007324219
r_  generation:  0.45389771461486816
local_output_nid generation:  0.03383684158325195
local_in_edges_tensor generation:  0.07550740242004395
mini_batch_src_global generation:  0.05371856689453125
r_  generation:  0.4668757915496826
local_output_nid generation:  0.03138232231140137
local_in_edges_tensor generation:  0.03505969047546387
mini_batch_src_global generation:  0.05538129806518555
r_  generation:  0.46266674995422363
local_output_nid generation:  0.032297372817993164
local_in_edges_tensor generation:  0.03322315216064453
mini_batch_src_global generation:  0.05820465087890625
r_  generation:  0.47002220153808594
local_output_nid generation:  0.03162121772766113
local_in_edges_tensor generation:  0.03740262985229492
mini_batch_src_global generation:  0.05351543426513672
r_  generation:  0.4653346538543701
local_output_nid generation:  0.031556129455566406
local_in_edges_tensor generation:  0.03484177589416504
mini_batch_src_global generation:  0.05457043647766113
r_  generation:  0.4788806438446045
local_output_nid generation:  0.03283953666687012
local_in_edges_tensor generation:  0.033507585525512695
mini_batch_src_global generation:  0.05485939979553223
r_  generation:  0.46136045455932617
local_output_nid generation:  0.03273582458496094
local_in_edges_tensor generation:  0.03285646438598633
mini_batch_src_global generation:  0.05207490921020508
r_  generation:  0.4653496742248535
local_output_nid generation:  0.031832218170166016
local_in_edges_tensor generation:  0.02849721908569336
mini_batch_src_global generation:  0.05315136909484863
r_  generation:  0.4576694965362549
local_output_nid generation:  0.03197288513183594
local_in_edges_tensor generation:  0.030963659286499023
mini_batch_src_global generation:  0.05504608154296875
r_  generation:  0.4671041965484619
local_output_nid generation:  0.03230714797973633
local_in_edges_tensor generation:  0.03321647644042969
mini_batch_src_global generation:  0.05353808403015137
r_  generation:  0.46084094047546387
local_output_nid generation:  0.03258776664733887
local_in_edges_tensor generation:  0.03256559371948242
mini_batch_src_global generation:  0.05250072479248047
r_  generation:  0.46799588203430176
local_output_nid generation:  0.032126665115356445
local_in_edges_tensor generation:  0.029328584671020508
mini_batch_src_global generation:  0.05341696739196777
r_  generation:  0.4668886661529541
----------------------check_connections_block total spend ----------------------------- 10.993606805801392
generate_one_block  0.58516526222229
generate_one_block  0.5840528011322021
generate_one_block  0.5905835628509521
generate_one_block  0.5883786678314209
generate_one_block  0.5899507999420166
generate_one_block  0.5903897285461426
generate_one_block  0.5884490013122559
generate_one_block  0.5872688293457031
generate_one_block  0.6452372074127197
generate_one_block  0.5876002311706543
generate_one_block  0.5789330005645752
generate_one_block  0.5853915214538574
generate_one_block  0.5893547534942627
generate_one_block  0.5886030197143555
generate_one_block  0.5905976295471191
generate_one_block  0.5869424343109131
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.1196436882019043  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

connection checking time:  16.90331792831421
block generation total time  14.390426397323608
average batch blocks generation time:  0.8994016498327255
block dataloader generation time/epoch 32.90634291512625
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09419870376586914  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7393264770507812  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09469890594482422  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7426528930664062  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09440803527832031  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7419986724853516  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09480953216552734  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.745966911315918  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09456014633178711  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7463116645812988  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09482574462890625  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7509479522705078  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09453058242797852  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7471427917480469  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09479618072509766  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7472662925720215  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09436178207397461  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7441263198852539  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09470844268798828  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7455682754516602  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09407281875610352  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7388396263122559  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09467601776123047  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.742459774017334  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09458208084106445  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7503237724304199  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09476947784423828  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7463645935058594  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09482240676879883  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7544870376586914  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09473323822021484  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.744560718536377  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06166204810142517 |0.014163807034492493 |0.0035348981618881226 |9.080767631530762e-05 |0.0030982941389083862 |0.0013701915740966797 |
----------------------------------------------------------pseudo_mini_loss sum 1.3983272314071655
Total (block generation + training)time/epoch 34.32600702558245
Training time/epoch 1.4700026512145996
Training time without block to device /epoch 1.2433817386627197
Training time without total dataloading part /epoch 0.10895419120788574
load block tensor time/epoch 0.9865927696228027
block to device time/epoch 0.22662091255187988
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  5208116
Number of first layer input nodes during this epoch:  2479803
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11815881729125977  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021414518356323242
range selection method range initialization spend 0.012178182601928711
time for parepare:  0.017063617706298828
local_output_nid generation:  0.0014405250549316406
local_in_edges_tensor generation:  0.008666753768920898
mini_batch_src_global generation:  0.0017633438110351562
r_  generation:  0.020867586135864258
local_output_nid generation:  0.001644134521484375
local_in_edges_tensor generation:  0.0010199546813964844
mini_batch_src_global generation:  0.0020825862884521484
r_  generation:  0.023113727569580078
local_output_nid generation:  0.0016944408416748047
local_in_edges_tensor generation:  0.0009412765502929688
mini_batch_src_global generation:  0.0016977787017822266
r_  generation:  0.021839141845703125
local_output_nid generation:  0.0016112327575683594
local_in_edges_tensor generation:  0.0009794235229492188
mini_batch_src_global generation:  0.0017294883728027344
r_  generation:  0.02171945571899414
local_output_nid generation:  0.001636505126953125
local_in_edges_tensor generation:  0.0009648799896240234
mini_batch_src_global generation:  0.0017504692077636719
r_  generation:  0.021968364715576172
local_output_nid generation:  0.0016188621520996094
local_in_edges_tensor generation:  0.0009348392486572266
mini_batch_src_global generation:  0.00171661376953125
r_  generation:  0.022173166275024414
local_output_nid generation:  0.0016083717346191406
local_in_edges_tensor generation:  0.0009493827819824219
mini_batch_src_global generation:  0.0018115043640136719
r_  generation:  0.022477388381958008
local_output_nid generation:  0.0016400814056396484
local_in_edges_tensor generation:  0.001003265380859375
mini_batch_src_global generation:  0.0018393993377685547
r_  generation:  0.02218461036682129
local_output_nid generation:  0.0016641616821289062
local_in_edges_tensor generation:  0.0009324550628662109
mini_batch_src_global generation:  0.001810312271118164
r_  generation:  0.022371768951416016
local_output_nid generation:  0.0015950202941894531
local_in_edges_tensor generation:  0.0009565353393554688
mini_batch_src_global generation:  0.0018074512481689453
r_  generation:  0.02207326889038086
local_output_nid generation:  0.001600027084350586
local_in_edges_tensor generation:  0.0009427070617675781
mini_batch_src_global generation:  0.0018091201782226562
r_  generation:  0.022147655487060547
local_output_nid generation:  0.0016198158264160156
local_in_edges_tensor generation:  0.0009360313415527344
mini_batch_src_global generation:  0.0017516613006591797
r_  generation:  0.022095203399658203
local_output_nid generation:  0.001661539077758789
local_in_edges_tensor generation:  0.0009441375732421875
mini_batch_src_global generation:  0.0017173290252685547
r_  generation:  0.022259950637817383
local_output_nid generation:  0.0015993118286132812
local_in_edges_tensor generation:  0.0009610652923583984
mini_batch_src_global generation:  0.0016939640045166016
r_  generation:  0.02209305763244629
local_output_nid generation:  0.0016243457794189453
local_in_edges_tensor generation:  0.0009632110595703125
mini_batch_src_global generation:  0.001745462417602539
r_  generation:  0.022441387176513672
local_output_nid generation:  0.0015957355499267578
local_in_edges_tensor generation:  0.0009126663208007812
mini_batch_src_global generation:  0.0017216205596923828
r_  generation:  0.022303342819213867
----------------------check_connections_block total spend ----------------------------- 0.526249885559082
generate_one_block  0.03041386604309082
generate_one_block  0.03211832046508789
generate_one_block  0.031497955322265625
generate_one_block  0.03100132942199707
generate_one_block  0.03101348876953125
generate_one_block  0.03527069091796875
generate_one_block  0.03128695487976074
generate_one_block  0.030712604522705078
generate_one_block  0.03107452392578125
generate_one_block  0.030960559844970703
generate_one_block  0.03116321563720703
generate_one_block  0.031162738800048828
generate_one_block  0.03109431266784668
generate_one_block  0.030805349349975586
generate_one_block  0.031237125396728516
generate_one_block  0.03166794776916504
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.037178754806518555
gen group dst list time:  0.021586179733276367
time for parepare:  0.019632577896118164
local_output_nid generation:  0.007666826248168945
local_in_edges_tensor generation:  0.022740602493286133
mini_batch_src_global generation:  0.02283501625061035
r_  generation:  0.21971917152404785
local_output_nid generation:  0.011310815811157227
local_in_edges_tensor generation:  0.01572895050048828
mini_batch_src_global generation:  0.029111862182617188
r_  generation:  0.22984862327575684
local_output_nid generation:  0.011672496795654297
local_in_edges_tensor generation:  0.012063264846801758
mini_batch_src_global generation:  0.027010679244995117
r_  generation:  0.22684526443481445
local_output_nid generation:  0.012445926666259766
local_in_edges_tensor generation:  0.015871763229370117
mini_batch_src_global generation:  0.028865575790405273
r_  generation:  0.23096323013305664
local_output_nid generation:  0.012633085250854492
local_in_edges_tensor generation:  0.012654542922973633
mini_batch_src_global generation:  0.028918981552124023
r_  generation:  0.2348015308380127
local_output_nid generation:  0.012782096862792969
local_in_edges_tensor generation:  0.012723207473754883
mini_batch_src_global generation:  0.028879404067993164
r_  generation:  0.23511576652526855
local_output_nid generation:  0.012974977493286133
local_in_edges_tensor generation:  0.012858152389526367
mini_batch_src_global generation:  0.029607772827148438
r_  generation:  0.23459148406982422
local_output_nid generation:  0.012833833694458008
local_in_edges_tensor generation:  0.015354394912719727
mini_batch_src_global generation:  0.028937816619873047
r_  generation:  0.23030829429626465
local_output_nid generation:  0.013031721115112305
local_in_edges_tensor generation:  0.013077497482299805
mini_batch_src_global generation:  0.029885292053222656
r_  generation:  0.23461270332336426
local_output_nid generation:  0.012939214706420898
local_in_edges_tensor generation:  0.013693809509277344
mini_batch_src_global generation:  0.0291595458984375
r_  generation:  0.23594427108764648
local_output_nid generation:  0.012937784194946289
local_in_edges_tensor generation:  0.012646198272705078
mini_batch_src_global generation:  0.029711246490478516
r_  generation:  0.23509883880615234
local_output_nid generation:  0.013036012649536133
local_in_edges_tensor generation:  0.013489961624145508
mini_batch_src_global generation:  0.029242277145385742
r_  generation:  0.23578763008117676
local_output_nid generation:  0.013100862503051758
local_in_edges_tensor generation:  0.013103008270263672
mini_batch_src_global generation:  0.03014540672302246
r_  generation:  0.23476099967956543
local_output_nid generation:  0.013125181198120117
local_in_edges_tensor generation:  0.014514923095703125
mini_batch_src_global generation:  0.029700040817260742
r_  generation:  0.23456192016601562
local_output_nid generation:  0.01344919204711914
local_in_edges_tensor generation:  0.012886524200439453
mini_batch_src_global generation:  0.030905961990356445
r_  generation:  0.23986530303955078
local_output_nid generation:  0.012275457382202148
local_in_edges_tensor generation:  0.014727115631103516
mini_batch_src_global generation:  0.03224921226501465
r_  generation:  0.23872852325439453
----------------------check_connections_block total spend ----------------------------- 5.457806587219238
generate_one_block  0.3047449588775635
generate_one_block  0.3070793151855469
generate_one_block  0.30075669288635254
generate_one_block  0.29875802993774414
generate_one_block  0.3028833866119385
generate_one_block  0.303210973739624
generate_one_block  0.32416605949401855
generate_one_block  0.29568982124328613
generate_one_block  0.30074214935302734
generate_one_block  0.2996978759765625
generate_one_block  0.3009524345397949
generate_one_block  0.30411863327026367
generate_one_block  0.30086398124694824
generate_one_block  0.2977259159088135
generate_one_block  0.3086059093475342
generate_one_block  0.29953527450561523
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03772449493408203
gen group dst list time:  0.06335806846618652
time for parepare:  0.017644882202148438
local_output_nid generation:  0.02585124969482422
local_in_edges_tensor generation:  0.04198145866394043
mini_batch_src_global generation:  0.04292893409729004
r_  generation:  0.45179271697998047
local_output_nid generation:  0.030457496643066406
local_in_edges_tensor generation:  0.03556537628173828
mini_batch_src_global generation:  0.05293154716491699
r_  generation:  0.4491879940032959
local_output_nid generation:  0.0304262638092041
local_in_edges_tensor generation:  0.030118703842163086
mini_batch_src_global generation:  0.051362037658691406
r_  generation:  0.45980167388916016
local_output_nid generation:  0.030963420867919922
local_in_edges_tensor generation:  0.030894041061401367
mini_batch_src_global generation:  0.052953481674194336
r_  generation:  0.45055651664733887
local_output_nid generation:  0.030939579010009766
local_in_edges_tensor generation:  0.07268691062927246
mini_batch_src_global generation:  0.05390191078186035
r_  generation:  0.46659398078918457
local_output_nid generation:  0.030951976776123047
local_in_edges_tensor generation:  0.030043601989746094
mini_batch_src_global generation:  0.05372929573059082
r_  generation:  0.4557161331176758
local_output_nid generation:  0.030941247940063477
local_in_edges_tensor generation:  0.029522418975830078
mini_batch_src_global generation:  0.05185532569885254
r_  generation:  0.4715259075164795
local_output_nid generation:  0.03105640411376953
local_in_edges_tensor generation:  0.02995467185974121
mini_batch_src_global generation:  0.05587339401245117
r_  generation:  0.45838189125061035
local_output_nid generation:  0.03133821487426758
local_in_edges_tensor generation:  0.031391143798828125
mini_batch_src_global generation:  0.05225515365600586
r_  generation:  0.46611595153808594
local_output_nid generation:  0.03131365776062012
local_in_edges_tensor generation:  0.02869582176208496
mini_batch_src_global generation:  0.053572654724121094
r_  generation:  0.45511388778686523
local_output_nid generation:  0.03147578239440918
local_in_edges_tensor generation:  0.03022623062133789
mini_batch_src_global generation:  0.05246472358703613
r_  generation:  0.47409558296203613
local_output_nid generation:  0.03143715858459473
local_in_edges_tensor generation:  0.029871225357055664
mini_batch_src_global generation:  0.05385184288024902
r_  generation:  0.4583761692047119
local_output_nid generation:  0.031439781188964844
local_in_edges_tensor generation:  0.030802011489868164
mini_batch_src_global generation:  0.052819252014160156
r_  generation:  0.4728569984436035
local_output_nid generation:  0.03168439865112305
local_in_edges_tensor generation:  0.03327631950378418
mini_batch_src_global generation:  0.053797245025634766
r_  generation:  0.4563934803009033
local_output_nid generation:  0.03208208084106445
local_in_edges_tensor generation:  0.03315305709838867
mini_batch_src_global generation:  0.05237889289855957
r_  generation:  0.47252941131591797
local_output_nid generation:  0.031484127044677734
local_in_edges_tensor generation:  0.031144142150878906
mini_batch_src_global generation:  0.05576610565185547
r_  generation:  0.4616389274597168
----------------------check_connections_block total spend ----------------------------- 10.889783143997192
generate_one_block  0.576366662979126
generate_one_block  0.5836083889007568
generate_one_block  0.5814743041992188
generate_one_block  0.5792312622070312
generate_one_block  0.5787265300750732
generate_one_block  0.5753166675567627
generate_one_block  0.5796728134155273
generate_one_block  0.5806789398193359
generate_one_block  0.6117269992828369
generate_one_block  0.5791745185852051
generate_one_block  0.5809624195098877
generate_one_block  0.584726095199585
generate_one_block  0.5879402160644531
generate_one_block  0.5838057994842529
generate_one_block  0.584294319152832
generate_one_block  0.5901443958282471
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11815881729125977  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

connection checking time:  16.34758973121643
block generation total time  14.187381744384766
average batch blocks generation time:  0.8867113590240479
block dataloader generation time/epoch 32.874023258686066
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09441328048706055  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7455840110778809  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09490203857421875  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7525267601013184  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0945596694946289  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7467827796936035  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09474754333496094  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7436738014221191  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0944981575012207  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7460436820983887  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09478378295898438  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.747100830078125  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09440422058105469  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7447619438171387  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0945882797241211  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.741264820098877  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09446907043457031  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7458028793334961  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09468650817871094  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7430171966552734  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09457159042358398  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7485737800598145  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09473896026611328  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7437748908996582  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09419822692871094  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7416019439697266  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0946493148803711  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7436995506286621  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0946345329284668  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.747230052947998  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09473133087158203  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7423563003540039  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06577683985233307 |0.01436375081539154 |0.0035608112812042236 |9.082257747650146e-05 |0.002434074878692627 |0.0013043880462646484 |
----------------------------------------------------------pseudo_mini_loss sum 1.3757070302963257
Total (block generation + training)time/epoch 34.29675203561783
Training time/epoch 1.4439890384674072
Training time without block to device /epoch 1.2141690254211426
Training time without total dataloading part /epoch 0.09867572784423828
load block tensor time/epoch 1.052429437637329
block to device time/epoch 0.22982001304626465
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  5208022
Number of first layer input nodes during this epoch:  2479855
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11813020706176758  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02636098861694336
range selection method range initialization spend 0.012711763381958008
time for parepare:  0.017918109893798828
local_output_nid generation:  0.0013823509216308594
local_in_edges_tensor generation:  0.00559234619140625
mini_batch_src_global generation:  0.002141237258911133
r_  generation:  0.020963430404663086
local_output_nid generation:  0.0014955997467041016
local_in_edges_tensor generation:  0.0010123252868652344
mini_batch_src_global generation:  0.0023717880249023438
r_  generation:  0.022400856018066406
local_output_nid generation:  0.0015742778778076172
local_in_edges_tensor generation:  0.0009520053863525391
mini_batch_src_global generation:  0.0017364025115966797
r_  generation:  0.021194934844970703
local_output_nid generation:  0.0016679763793945312
local_in_edges_tensor generation:  0.0009622573852539062
mini_batch_src_global generation:  0.0017838478088378906
r_  generation:  0.021500587463378906
local_output_nid generation:  0.0016541481018066406
local_in_edges_tensor generation:  0.0009586811065673828
mini_batch_src_global generation:  0.0017695426940917969
r_  generation:  0.022008419036865234
local_output_nid generation:  0.001615285873413086
local_in_edges_tensor generation:  0.0009524822235107422
mini_batch_src_global generation:  0.0017743110656738281
r_  generation:  0.022583484649658203
local_output_nid generation:  0.0015714168548583984
local_in_edges_tensor generation:  0.0009677410125732422
mini_batch_src_global generation:  0.0017621517181396484
r_  generation:  0.021745920181274414
local_output_nid generation:  0.0015804767608642578
local_in_edges_tensor generation:  0.0009391307830810547
mini_batch_src_global generation:  0.0016696453094482422
r_  generation:  0.02169036865234375
local_output_nid generation:  0.001577615737915039
local_in_edges_tensor generation:  0.0009527206420898438
mini_batch_src_global generation:  0.0017499923706054688
r_  generation:  0.02242565155029297
local_output_nid generation:  0.001573801040649414
local_in_edges_tensor generation:  0.0009317398071289062
mini_batch_src_global generation:  0.0017833709716796875
r_  generation:  0.02207016944885254
local_output_nid generation:  0.0015833377838134766
local_in_edges_tensor generation:  0.0009510517120361328
mini_batch_src_global generation:  0.0017924308776855469
r_  generation:  0.023082256317138672
local_output_nid generation:  0.0016028881072998047
local_in_edges_tensor generation:  0.0009467601776123047
mini_batch_src_global generation:  0.001773834228515625
r_  generation:  0.022086143493652344
local_output_nid generation:  0.0015723705291748047
local_in_edges_tensor generation:  0.0009980201721191406
mini_batch_src_global generation:  0.0017061233520507812
r_  generation:  0.021733760833740234
local_output_nid generation:  0.0015723705291748047
local_in_edges_tensor generation:  0.0010190010070800781
mini_batch_src_global generation:  0.0017390251159667969
r_  generation:  0.022217988967895508
local_output_nid generation:  0.0016078948974609375
local_in_edges_tensor generation:  0.0009360313415527344
mini_batch_src_global generation:  0.0017733573913574219
r_  generation:  0.02242588996887207
local_output_nid generation:  0.0015974044799804688
local_in_edges_tensor generation:  0.0009431838989257812
mini_batch_src_global generation:  0.00179290771484375
r_  generation:  0.0218963623046875
----------------------check_connections_block total spend ----------------------------- 0.522883415222168
generate_one_block  0.030210256576538086
generate_one_block  0.03179645538330078
generate_one_block  0.031048297882080078
generate_one_block  0.031224727630615234
generate_one_block  0.03166079521179199
generate_one_block  0.03354191780090332
generate_one_block  0.0306549072265625
generate_one_block  0.030493736267089844
generate_one_block  0.03186488151550293
generate_one_block  0.030938148498535156
generate_one_block  0.03227567672729492
generate_one_block  0.03073716163635254
generate_one_block  0.030597925186157227
generate_one_block  0.031382083892822266
generate_one_block  0.03200817108154297
generate_one_block  0.031992197036743164
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.032988786697387695
gen group dst list time:  0.018382549285888672
time for parepare:  0.019263029098510742
local_output_nid generation:  0.007277488708496094
local_in_edges_tensor generation:  0.02137446403503418
mini_batch_src_global generation:  0.022963285446166992
r_  generation:  0.2151656150817871
local_output_nid generation:  0.011120080947875977
local_in_edges_tensor generation:  0.015623807907104492
mini_batch_src_global generation:  0.02901172637939453
r_  generation:  0.22449851036071777
local_output_nid generation:  0.011687040328979492
local_in_edges_tensor generation:  0.015732288360595703
mini_batch_src_global generation:  0.027037858963012695
r_  generation:  0.22539424896240234
local_output_nid generation:  0.012052297592163086
local_in_edges_tensor generation:  0.013912677764892578
mini_batch_src_global generation:  0.029178857803344727
r_  generation:  0.2281053066253662
local_output_nid generation:  0.012590408325195312
local_in_edges_tensor generation:  0.012802839279174805
mini_batch_src_global generation:  0.029400110244750977
r_  generation:  0.23148012161254883
local_output_nid generation:  0.012428522109985352
local_in_edges_tensor generation:  0.012758731842041016
mini_batch_src_global generation:  0.030129432678222656
r_  generation:  0.2331223487854004
local_output_nid generation:  0.012447118759155273
local_in_edges_tensor generation:  0.015105009078979492
mini_batch_src_global generation:  0.029709577560424805
r_  generation:  0.22944974899291992
local_output_nid generation:  0.012557744979858398
local_in_edges_tensor generation:  0.012099742889404297
mini_batch_src_global generation:  0.029659509658813477
r_  generation:  0.22707819938659668
local_output_nid generation:  0.012819290161132812
local_in_edges_tensor generation:  0.01340341567993164
mini_batch_src_global generation:  0.030861854553222656
r_  generation:  0.23410820960998535
local_output_nid generation:  0.012542963027954102
local_in_edges_tensor generation:  0.014031648635864258
mini_batch_src_global generation:  0.029401779174804688
r_  generation:  0.23131322860717773
local_output_nid generation:  0.012852668762207031
local_in_edges_tensor generation:  0.013903141021728516
mini_batch_src_global generation:  0.03400373458862305
r_  generation:  0.2383408546447754
local_output_nid generation:  0.01292276382446289
local_in_edges_tensor generation:  0.013059616088867188
mini_batch_src_global generation:  0.0317380428314209
r_  generation:  0.2339935302734375
local_output_nid generation:  0.012981176376342773
local_in_edges_tensor generation:  0.012525081634521484
mini_batch_src_global generation:  0.029092073440551758
r_  generation:  0.2309403419494629
local_output_nid generation:  0.013038873672485352
local_in_edges_tensor generation:  0.012694358825683594
mini_batch_src_global generation:  0.02934408187866211
r_  generation:  0.233048677444458
local_output_nid generation:  0.013226747512817383
local_in_edges_tensor generation:  0.012842655181884766
mini_batch_src_global generation:  0.03102898597717285
r_  generation:  0.23831939697265625
local_output_nid generation:  0.012782812118530273
local_in_edges_tensor generation:  0.013202428817749023
mini_batch_src_global generation:  0.029452085494995117
r_  generation:  0.2344357967376709
----------------------check_connections_block total spend ----------------------------- 5.407353639602661
generate_one_block  0.30072665214538574
generate_one_block  0.3037254810333252
generate_one_block  0.30157017707824707
generate_one_block  0.2984044551849365
generate_one_block  0.3022470474243164
generate_one_block  0.29908108711242676
generate_one_block  0.319155216217041
generate_one_block  0.2917459011077881
generate_one_block  0.30181169509887695
generate_one_block  0.29450464248657227
generate_one_block  0.31172966957092285
generate_one_block  0.296173095703125
generate_one_block  0.2953062057495117
generate_one_block  0.29887914657592773
generate_one_block  0.30794286727905273
generate_one_block  0.2990086078643799
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03346514701843262
gen group dst list time:  0.06299734115600586
time for parepare:  0.017474889755249023
local_output_nid generation:  0.024736404418945312
local_in_edges_tensor generation:  0.038724422454833984
mini_batch_src_global generation:  0.0406489372253418
r_  generation:  0.44134950637817383
local_output_nid generation:  0.029998064041137695
local_in_edges_tensor generation:  0.030396223068237305
mini_batch_src_global generation:  0.05166983604431152
r_  generation:  0.44309186935424805
local_output_nid generation:  0.02978825569152832
local_in_edges_tensor generation:  0.030112266540527344
mini_batch_src_global generation:  0.05036759376525879
r_  generation:  0.4528493881225586
local_output_nid generation:  0.030466794967651367
local_in_edges_tensor generation:  0.030977487564086914
mini_batch_src_global generation:  0.05202054977416992
r_  generation:  0.4487795829772949
local_output_nid generation:  0.030585050582885742
local_in_edges_tensor generation:  0.07327461242675781
mini_batch_src_global generation:  0.050603389739990234
r_  generation:  0.4578216075897217
local_output_nid generation:  0.031023502349853516
local_in_edges_tensor generation:  0.03372836112976074
mini_batch_src_global generation:  0.05327916145324707
r_  generation:  0.45298004150390625
local_output_nid generation:  0.03075551986694336
local_in_edges_tensor generation:  0.02794647216796875
mini_batch_src_global generation:  0.05356645584106445
r_  generation:  0.4580073356628418
local_output_nid generation:  0.03090834617614746
local_in_edges_tensor generation:  0.02891063690185547
mini_batch_src_global generation:  0.05241894721984863
r_  generation:  0.45235562324523926
local_output_nid generation:  0.030927419662475586
local_in_edges_tensor generation:  0.03094172477722168
mini_batch_src_global generation:  0.055301666259765625
r_  generation:  0.4634575843811035
local_output_nid generation:  0.030948877334594727
local_in_edges_tensor generation:  0.02868962287902832
mini_batch_src_global generation:  0.05461406707763672
r_  generation:  0.4524240493774414
local_output_nid generation:  0.031401872634887695
local_in_edges_tensor generation:  0.028427839279174805
mini_batch_src_global generation:  0.05147981643676758
r_  generation:  0.4579200744628906
local_output_nid generation:  0.03118896484375
local_in_edges_tensor generation:  0.027685880661010742
mini_batch_src_global generation:  0.05279254913330078
r_  generation:  0.45691609382629395
local_output_nid generation:  0.030834436416625977
local_in_edges_tensor generation:  0.031151294708251953
mini_batch_src_global generation:  0.05263853073120117
r_  generation:  0.45737671852111816
local_output_nid generation:  0.03113555908203125
local_in_edges_tensor generation:  0.028458356857299805
mini_batch_src_global generation:  0.05263805389404297
r_  generation:  0.45218729972839355
local_output_nid generation:  0.030544519424438477
local_in_edges_tensor generation:  0.028792858123779297
mini_batch_src_global generation:  0.050977468490600586
r_  generation:  0.46125006675720215
local_output_nid generation:  0.03115558624267578
local_in_edges_tensor generation:  0.038683414459228516
mini_batch_src_global generation:  0.05269265174865723
r_  generation:  0.45253992080688477
----------------------check_connections_block total spend ----------------------------- 10.713672876358032
generate_one_block  0.5700485706329346
generate_one_block  0.5769333839416504
generate_one_block  0.5803229808807373
generate_one_block  0.5780785083770752
generate_one_block  0.5775549411773682
generate_one_block  0.5803735256195068
generate_one_block  0.5774242877960205
generate_one_block  0.5786004066467285
generate_one_block  0.6316630840301514
generate_one_block  0.5844137668609619
generate_one_block  0.5848174095153809
generate_one_block  0.5719175338745117
generate_one_block  0.5755510330200195
generate_one_block  0.5771865844726562
generate_one_block  0.5779314041137695
generate_one_block  0.58548903465271
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11813020706176758  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

connection checking time:  16.121026515960693
block generation total time  14.130318403244019
average batch blocks generation time:  0.8831449002027512
block dataloader generation time/epoch 32.81624608569675
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0942525863647461  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7406139373779297  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09483718872070312  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7497930526733398  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09442567825317383  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7436890602111816  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0948019027709961  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7476382255554199  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09448623657226562  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.747438907623291  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09479141235351562  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7511982917785645  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09435462951660156  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7415218353271484  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09461498260498047  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7439980506896973  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09442853927612305  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7492156028747559  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09467220306396484  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7413973808288574  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09462881088256836  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7524089813232422  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0946950912475586  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.741877555847168  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09432744979858398  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7411632537841797  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09470558166503906  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7427859306335449  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09445047378540039  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7452530860900879  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09476661682128906  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7472014427185059  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06518219411373138 |0.014210253953933716 |0.003523990511894226 |8.7738037109375e-05 |0.0037350356578826904 |0.0013120174407958984 |
----------------------------------------------------------pseudo_mini_loss sum 1.3580454587936401
Total (block generation + training)time/epoch 34.24211287498474
Training time/epoch 1.4506962299346924
Training time without block to device /epoch 1.223332166671753
Training time without total dataloading part /epoch 0.11886024475097656
load block tensor time/epoch 1.0429151058197021
block to device time/epoch 0.22736406326293945
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  5207099
Number of first layer input nodes during this epoch:  2480068
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11822175979614258  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.034909963607788086
range selection method range initialization spend 0.012382745742797852
time for parepare:  0.017993688583374023
local_output_nid generation:  0.001485586166381836
local_in_edges_tensor generation:  0.0037174224853515625
mini_batch_src_global generation:  0.0018010139465332031
r_  generation:  0.02153158187866211
local_output_nid generation:  0.001714944839477539
local_in_edges_tensor generation:  0.0009870529174804688
mini_batch_src_global generation:  0.002061605453491211
r_  generation:  0.022406339645385742
local_output_nid generation:  0.0017559528350830078
local_in_edges_tensor generation:  0.0009510517120361328
mini_batch_src_global generation:  0.0016028881072998047
r_  generation:  0.021001338958740234
local_output_nid generation:  0.0018286705017089844
local_in_edges_tensor generation:  0.0009448528289794922
mini_batch_src_global generation:  0.0017292499542236328
r_  generation:  0.021433115005493164
local_output_nid generation:  0.0017843246459960938
local_in_edges_tensor generation:  0.0009453296661376953
mini_batch_src_global generation:  0.0017161369323730469
r_  generation:  0.02143073081970215
local_output_nid generation:  0.0017938613891601562
local_in_edges_tensor generation:  0.0009319782257080078
mini_batch_src_global generation:  0.0016484260559082031
r_  generation:  0.020883798599243164
local_output_nid generation:  0.0018639564514160156
local_in_edges_tensor generation:  0.0009200572967529297
mini_batch_src_global generation:  0.0016620159149169922
r_  generation:  0.02144765853881836
local_output_nid generation:  0.0017571449279785156
local_in_edges_tensor generation:  0.0009641647338867188
mini_batch_src_global generation:  0.0017232894897460938
r_  generation:  0.022101879119873047
local_output_nid generation:  0.0017981529235839844
local_in_edges_tensor generation:  0.0009412765502929688
mini_batch_src_global generation:  0.0017337799072265625
r_  generation:  0.02181100845336914
local_output_nid generation:  0.0018537044525146484
local_in_edges_tensor generation:  0.0009448528289794922
mini_batch_src_global generation:  0.0017850399017333984
r_  generation:  0.022044658660888672
local_output_nid generation:  0.0018002986907958984
local_in_edges_tensor generation:  0.0009245872497558594
mini_batch_src_global generation:  0.0018901824951171875
r_  generation:  0.024132728576660156
local_output_nid generation:  0.0019214153289794922
local_in_edges_tensor generation:  0.0009918212890625
mini_batch_src_global generation:  0.0017943382263183594
r_  generation:  0.021908283233642578
local_output_nid generation:  0.0020253658294677734
local_in_edges_tensor generation:  0.0009484291076660156
mini_batch_src_global generation:  0.0016937255859375
r_  generation:  0.021495819091796875
local_output_nid generation:  0.0019314289093017578
local_in_edges_tensor generation:  0.0009677410125732422
mini_batch_src_global generation:  0.0017642974853515625
r_  generation:  0.022017717361450195
local_output_nid generation:  0.0019648075103759766
local_in_edges_tensor generation:  0.0009348392486572266
mini_batch_src_global generation:  0.0017178058624267578
r_  generation:  0.021600723266601562
local_output_nid generation:  0.0018877983093261719
local_in_edges_tensor generation:  0.0009522438049316406
mini_batch_src_global generation:  0.0017535686492919922
r_  generation:  0.022093772888183594
----------------------check_connections_block total spend ----------------------------- 0.520667314529419
generate_one_block  0.03153204917907715
generate_one_block  0.03271675109863281
generate_one_block  0.030814170837402344
generate_one_block  0.031415700912475586
generate_one_block  0.031081438064575195
generate_one_block  0.031972408294677734
generate_one_block  0.03077244758605957
generate_one_block  0.031375885009765625
generate_one_block  0.03106975555419922
generate_one_block  0.03159809112548828
generate_one_block  0.031874656677246094
generate_one_block  0.03085470199584961
generate_one_block  0.03041672706604004
generate_one_block  0.03129220008850098
generate_one_block  0.030923128128051758
generate_one_block  0.03207659721374512
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03329110145568848
gen group dst list time:  0.01897573471069336
time for parepare:  0.019567489624023438
local_output_nid generation:  0.007733583450317383
local_in_edges_tensor generation:  0.025351285934448242
mini_batch_src_global generation:  0.023557424545288086
r_  generation:  0.21842074394226074
local_output_nid generation:  0.012715816497802734
local_in_edges_tensor generation:  0.015470027923583984
mini_batch_src_global generation:  0.028578519821166992
r_  generation:  0.22446250915527344
local_output_nid generation:  0.013347148895263672
local_in_edges_tensor generation:  0.01163625717163086
mini_batch_src_global generation:  0.02644062042236328
r_  generation:  0.22551679611206055
local_output_nid generation:  0.014398813247680664
local_in_edges_tensor generation:  0.016316890716552734
mini_batch_src_global generation:  0.028633832931518555
r_  generation:  0.23373770713806152
local_output_nid generation:  0.014352083206176758
local_in_edges_tensor generation:  0.013157844543457031
mini_batch_src_global generation:  0.029414653778076172
r_  generation:  0.23375821113586426
local_output_nid generation:  0.014250993728637695
local_in_edges_tensor generation:  0.012446165084838867
mini_batch_src_global generation:  0.028277158737182617
r_  generation:  0.22714519500732422
local_output_nid generation:  0.015004158020019531
local_in_edges_tensor generation:  0.014186620712280273
mini_batch_src_global generation:  0.028705596923828125
r_  generation:  0.23097968101501465
local_output_nid generation:  0.01492762565612793
local_in_edges_tensor generation:  0.012501001358032227
mini_batch_src_global generation:  0.029566287994384766
r_  generation:  0.2382206916809082
local_output_nid generation:  0.01486659049987793
local_in_edges_tensor generation:  0.012608528137207031
mini_batch_src_global generation:  0.030314207077026367
r_  generation:  0.23320651054382324
local_output_nid generation:  0.015134334564208984
local_in_edges_tensor generation:  0.01253652572631836
mini_batch_src_global generation:  0.03139209747314453
r_  generation:  0.23943710327148438
local_output_nid generation:  0.014860153198242188
local_in_edges_tensor generation:  0.014148473739624023
mini_batch_src_global generation:  0.031659841537475586
r_  generation:  0.23804831504821777
local_output_nid generation:  0.015102148056030273
local_in_edges_tensor generation:  0.012398004531860352
mini_batch_src_global generation:  0.02954697608947754
r_  generation:  0.23381471633911133
local_output_nid generation:  0.015012502670288086
local_in_edges_tensor generation:  0.01258707046508789
mini_batch_src_global generation:  0.029619455337524414
r_  generation:  0.22821354866027832
local_output_nid generation:  0.015207529067993164
local_in_edges_tensor generation:  0.013099908828735352
mini_batch_src_global generation:  0.02960515022277832
r_  generation:  0.23657512664794922
local_output_nid generation:  0.014950037002563477
local_in_edges_tensor generation:  0.012604475021362305
mini_batch_src_global generation:  0.029912471771240234
r_  generation:  0.2298593521118164
local_output_nid generation:  0.014734745025634766
local_in_edges_tensor generation:  0.013046503067016602
mini_batch_src_global generation:  0.029999971389770508
r_  generation:  0.2407073974609375
----------------------check_connections_block total spend ----------------------------- 5.457229137420654
generate_one_block  0.3126389980316162
generate_one_block  0.2939186096191406
generate_one_block  0.294971227645874
generate_one_block  0.29955077171325684
generate_one_block  0.29976487159729004
generate_one_block  0.28867340087890625
generate_one_block  0.32187795639038086
generate_one_block  0.30263662338256836
generate_one_block  0.29540252685546875
generate_one_block  0.3010218143463135
generate_one_block  0.3077125549316406
generate_one_block  0.2995784282684326
generate_one_block  0.29123520851135254
generate_one_block  0.3054025173187256
generate_one_block  0.2940335273742676
generate_one_block  0.30449604988098145
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030157089233398438
gen group dst list time:  0.061971426010131836
time for parepare:  0.017757415771484375
local_output_nid generation:  0.02429342269897461
local_in_edges_tensor generation:  0.04010152816772461
mini_batch_src_global generation:  0.04000234603881836
r_  generation:  0.4427177906036377
local_output_nid generation:  0.030116796493530273
local_in_edges_tensor generation:  0.028678178787231445
mini_batch_src_global generation:  0.05182194709777832
r_  generation:  0.44376182556152344
local_output_nid generation:  0.02987527847290039
local_in_edges_tensor generation:  0.028838396072387695
mini_batch_src_global generation:  0.05038332939147949
r_  generation:  0.45598649978637695
local_output_nid generation:  0.030397653579711914
local_in_edges_tensor generation:  0.02870655059814453
mini_batch_src_global generation:  0.05206727981567383
r_  generation:  0.4471902847290039
local_output_nid generation:  0.030829906463623047
local_in_edges_tensor generation:  0.0730752944946289
mini_batch_src_global generation:  0.051622629165649414
r_  generation:  0.45626235008239746
local_output_nid generation:  0.030356645584106445
local_in_edges_tensor generation:  0.02948451042175293
mini_batch_src_global generation:  0.05307173728942871
r_  generation:  0.4538278579711914
local_output_nid generation:  0.030605554580688477
local_in_edges_tensor generation:  0.028546571731567383
mini_batch_src_global generation:  0.05318474769592285
r_  generation:  0.45638203620910645
local_output_nid generation:  0.03074789047241211
local_in_edges_tensor generation:  0.03394627571105957
mini_batch_src_global generation:  0.05317068099975586
r_  generation:  0.4524261951446533
local_output_nid generation:  0.030622482299804688
local_in_edges_tensor generation:  0.029315710067749023
mini_batch_src_global generation:  0.05170774459838867
r_  generation:  0.4565415382385254
local_output_nid generation:  0.03117656707763672
local_in_edges_tensor generation:  0.029483795166015625
mini_batch_src_global generation:  0.05307793617248535
r_  generation:  0.45228052139282227
local_output_nid generation:  0.031205177307128906
local_in_edges_tensor generation:  0.029771804809570312
mini_batch_src_global generation:  0.05211138725280762
r_  generation:  0.4611623287200928
local_output_nid generation:  0.03104424476623535
local_in_edges_tensor generation:  0.03003239631652832
mini_batch_src_global generation:  0.05317354202270508
r_  generation:  0.45391058921813965
local_output_nid generation:  0.030728816986083984
local_in_edges_tensor generation:  0.029012203216552734
mini_batch_src_global generation:  0.05139422416687012
r_  generation:  0.4543764591217041
local_output_nid generation:  0.0312802791595459
local_in_edges_tensor generation:  0.0288543701171875
mini_batch_src_global generation:  0.055168867111206055
r_  generation:  0.45278000831604004
local_output_nid generation:  0.030816316604614258
local_in_edges_tensor generation:  0.02917790412902832
mini_batch_src_global generation:  0.051603078842163086
r_  generation:  0.4605979919433594
local_output_nid generation:  0.03359246253967285
local_in_edges_tensor generation:  0.02996540069580078
mini_batch_src_global generation:  0.0556180477142334
r_  generation:  0.45549845695495605
----------------------check_connections_block total spend ----------------------------- 10.704212427139282
generate_one_block  0.5749199390411377
generate_one_block  0.5806536674499512
generate_one_block  0.5754516124725342
generate_one_block  0.5813045501708984
generate_one_block  0.5819900035858154
generate_one_block  0.5693798065185547
generate_one_block  0.5798180103302002
generate_one_block  0.5798244476318359
generate_one_block  0.5989236831665039
generate_one_block  0.5793240070343018
generate_one_block  0.5815703868865967
generate_one_block  0.5724012851715088
generate_one_block  0.5704543590545654
generate_one_block  0.5801570415496826
generate_one_block  0.5689465999603271
generate_one_block  0.5828025341033936
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11822175979614258  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

connection checking time:  16.161441564559937
block generation total time  14.070837020874023
average batch blocks generation time:  0.8794273138046265
block dataloader generation time/epoch 32.76918525695801
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09471273422241211  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7534565925598145  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09470462799072266  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7457103729248047  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09410238265991211  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7414331436157227  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09481620788574219  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7486944198608398  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09449005126953125  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7464003562927246  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09449577331542969  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7395730018615723  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09447383880615234  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7459235191345215  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09486770629882812  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7478885650634766  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09403705596923828  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7370548248291016  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09481525421142578  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7508573532104492  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09462690353393555  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.751945972442627  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09474658966064453  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7441072463989258  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09415578842163086  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7395901679992676  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09485149383544922  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7478723526000977  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09432744979858398  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7409348487854004  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0948648452758789  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7511401176452637  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0645548552274704 |0.011396363377571106 |0.003562629222869873 |9.025633335113525e-05 |0.0037171542644500732 |0.0015265941619873047 |
----------------------------------------------------------pseudo_mini_loss sum 1.338972806930542
Total (block generation + training)time/epoch 34.19210841655731
Training time/epoch 1.396153450012207
Training time without block to device /epoch 1.2138116359710693
Training time without total dataloading part /epoch 0.11944723129272461
load block tensor time/epoch 1.0328776836395264
block to device time/epoch 0.1823418140411377
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  5207276
Number of first layer input nodes during this epoch:  2479446
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11851644515991211  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022234201431274414
range selection method range initialization spend 0.012970209121704102
time for parepare:  0.01649308204650879
local_output_nid generation:  0.001421213150024414
local_in_edges_tensor generation:  0.003361225128173828
mini_batch_src_global generation:  0.0017805099487304688
r_  generation:  0.0213930606842041
local_output_nid generation:  0.0015573501586914062
local_in_edges_tensor generation:  0.0009944438934326172
mini_batch_src_global generation:  0.002010822296142578
r_  generation:  0.02183222770690918
local_output_nid generation:  0.0016560554504394531
local_in_edges_tensor generation:  0.0009489059448242188
mini_batch_src_global generation:  0.0016295909881591797
r_  generation:  0.02067112922668457
local_output_nid generation:  0.0016314983367919922
local_in_edges_tensor generation:  0.0009551048278808594
mini_batch_src_global generation:  0.001617431640625
r_  generation:  0.020502328872680664
local_output_nid generation:  0.0015757083892822266
local_in_edges_tensor generation:  0.0009319782257080078
mini_batch_src_global generation:  0.0016779899597167969
r_  generation:  0.021408796310424805
local_output_nid generation:  0.0015842914581298828
local_in_edges_tensor generation:  0.0009491443634033203
mini_batch_src_global generation:  0.0017905235290527344
r_  generation:  0.022554636001586914
local_output_nid generation:  0.0015914440155029297
local_in_edges_tensor generation:  0.0009210109710693359
mini_batch_src_global generation:  0.0017893314361572266
r_  generation:  0.022233963012695312
local_output_nid generation:  0.0015904903411865234
local_in_edges_tensor generation:  0.0009293556213378906
mini_batch_src_global generation:  0.001733541488647461
r_  generation:  0.021544218063354492
local_output_nid generation:  0.0015850067138671875
local_in_edges_tensor generation:  0.0009543895721435547
mini_batch_src_global generation:  0.0016705989837646484
r_  generation:  0.021356582641601562
local_output_nid generation:  0.001584768295288086
local_in_edges_tensor generation:  0.0009427070617675781
mini_batch_src_global generation:  0.0016968250274658203
r_  generation:  0.021703004837036133
local_output_nid generation:  0.0015778541564941406
local_in_edges_tensor generation:  0.0009264945983886719
mini_batch_src_global generation:  0.0017020702362060547
r_  generation:  0.02213764190673828
local_output_nid generation:  0.0015714168548583984
local_in_edges_tensor generation:  0.0009357929229736328
mini_batch_src_global generation:  0.001758575439453125
r_  generation:  0.02219247817993164
local_output_nid generation:  0.0015490055084228516
local_in_edges_tensor generation:  0.0009605884552001953
mini_batch_src_global generation:  0.0017209053039550781
r_  generation:  0.02173328399658203
local_output_nid generation:  0.001554727554321289
local_in_edges_tensor generation:  0.000946044921875
mini_batch_src_global generation:  0.001730203628540039
r_  generation:  0.02240920066833496
local_output_nid generation:  0.001537322998046875
local_in_edges_tensor generation:  0.0009419918060302734
mini_batch_src_global generation:  0.0017108917236328125
r_  generation:  0.021895408630371094
local_output_nid generation:  0.0016009807586669922
local_in_edges_tensor generation:  0.0009694099426269531
mini_batch_src_global generation:  0.0017821788787841797
r_  generation:  0.022603988647460938
----------------------check_connections_block total spend ----------------------------- 0.5112805366516113
generate_one_block  0.030644893646240234
generate_one_block  0.031108856201171875
generate_one_block  0.0301516056060791
generate_one_block  0.029851675033569336
generate_one_block  0.03113722801208496
generate_one_block  0.03412270545959473
generate_one_block  0.0314631462097168
generate_one_block  0.030488967895507812
generate_one_block  0.030607223510742188
generate_one_block  0.030826330184936523
generate_one_block  0.0314483642578125
generate_one_block  0.03184199333190918
generate_one_block  0.03072214126586914
generate_one_block  0.03129172325134277
generate_one_block  0.030848264694213867
generate_one_block  0.03270292282104492
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03188133239746094
gen group dst list time:  0.017812490463256836
time for parepare:  0.01914358139038086
local_output_nid generation:  0.007368803024291992
local_in_edges_tensor generation:  0.015290498733520508
mini_batch_src_global generation:  0.02232646942138672
r_  generation:  0.21289515495300293
local_output_nid generation:  0.010894775390625
local_in_edges_tensor generation:  0.01362466812133789
mini_batch_src_global generation:  0.03096771240234375
r_  generation:  0.22567272186279297
local_output_nid generation:  0.011105537414550781
local_in_edges_tensor generation:  0.01671004295349121
mini_batch_src_global generation:  0.026944398880004883
r_  generation:  0.22409510612487793
local_output_nid generation:  0.011751651763916016
local_in_edges_tensor generation:  0.012140989303588867
mini_batch_src_global generation:  0.029549837112426758
r_  generation:  0.22473907470703125
local_output_nid generation:  0.012415170669555664
local_in_edges_tensor generation:  0.014570236206054688
mini_batch_src_global generation:  0.03295707702636719
r_  generation:  0.23110604286193848
local_output_nid generation:  0.012600421905517578
local_in_edges_tensor generation:  0.016889572143554688
mini_batch_src_global generation:  0.03365945816040039
r_  generation:  0.2382822036743164
local_output_nid generation:  0.0135955810546875
local_in_edges_tensor generation:  0.019123077392578125
mini_batch_src_global generation:  0.029865741729736328
r_  generation:  0.2361302375793457
local_output_nid generation:  0.012574195861816406
local_in_edges_tensor generation:  0.012828350067138672
mini_batch_src_global generation:  0.029179096221923828
r_  generation:  0.22808194160461426
local_output_nid generation:  0.012542724609375
local_in_edges_tensor generation:  0.012789249420166016
mini_batch_src_global generation:  0.02860116958618164
r_  generation:  0.2292804718017578
local_output_nid generation:  0.012792825698852539
local_in_edges_tensor generation:  0.013700485229492188
mini_batch_src_global generation:  0.03001236915588379
r_  generation:  0.2309885025024414
local_output_nid generation:  0.01249384880065918
local_in_edges_tensor generation:  0.013207435607910156
mini_batch_src_global generation:  0.029883384704589844
r_  generation:  0.23522210121154785
local_output_nid generation:  0.013139009475708008
local_in_edges_tensor generation:  0.013442754745483398
mini_batch_src_global generation:  0.030994415283203125
r_  generation:  0.23909568786621094
local_output_nid generation:  0.015743017196655273
local_in_edges_tensor generation:  0.013636350631713867
mini_batch_src_global generation:  0.030660629272460938
r_  generation:  0.2328624725341797
local_output_nid generation:  0.013103485107421875
local_in_edges_tensor generation:  0.013176202774047852
mini_batch_src_global generation:  0.03000020980834961
r_  generation:  0.23758411407470703
local_output_nid generation:  0.012941122055053711
local_in_edges_tensor generation:  0.013238191604614258
mini_batch_src_global generation:  0.02978229522705078
r_  generation:  0.23374438285827637
local_output_nid generation:  0.012566328048706055
local_in_edges_tensor generation:  0.013526201248168945
mini_batch_src_global generation:  0.029896259307861328
r_  generation:  0.23688793182373047
----------------------check_connections_block total spend ----------------------------- 5.4247095584869385
generate_one_block  0.2960212230682373
generate_one_block  0.2948763370513916
generate_one_block  0.3010568618774414
generate_one_block  0.2879467010498047
generate_one_block  0.2959737777709961
generate_one_block  0.30849337577819824
generate_one_block  0.3328707218170166
generate_one_block  0.29404616355895996
generate_one_block  0.29070425033569336
generate_one_block  0.29584741592407227
generate_one_block  0.2999858856201172
generate_one_block  0.3071632385253906
generate_one_block  0.2978382110595703
generate_one_block  0.30699992179870605
generate_one_block  0.3007771968841553
generate_one_block  0.30522871017456055
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.031507253646850586
gen group dst list time:  0.06327629089355469
time for parepare:  0.01772928237915039
local_output_nid generation:  0.024234533309936523
local_in_edges_tensor generation:  0.050542593002319336
mini_batch_src_global generation:  0.040029048919677734
r_  generation:  0.444835901260376
local_output_nid generation:  0.029473066329956055
local_in_edges_tensor generation:  0.037912607192993164
mini_batch_src_global generation:  0.05397605895996094
r_  generation:  0.4411957263946533
local_output_nid generation:  0.029685258865356445
local_in_edges_tensor generation:  0.02952885627746582
mini_batch_src_global generation:  0.05271792411804199
r_  generation:  0.45040082931518555
local_output_nid generation:  0.02997612953186035
local_in_edges_tensor generation:  0.0293729305267334
mini_batch_src_global generation:  0.052514076232910156
r_  generation:  0.4443538188934326
local_output_nid generation:  0.03010869026184082
local_in_edges_tensor generation:  0.07065629959106445
mini_batch_src_global generation:  0.0531613826751709
r_  generation:  0.4558539390563965
local_output_nid generation:  0.03036975860595703
local_in_edges_tensor generation:  0.0313868522644043
mini_batch_src_global generation:  0.05317330360412598
r_  generation:  0.4516103267669678
local_output_nid generation:  0.03026413917541504
local_in_edges_tensor generation:  0.03366971015930176
mini_batch_src_global generation:  0.05157470703125
r_  generation:  0.4614579677581787
local_output_nid generation:  0.030746936798095703
local_in_edges_tensor generation:  0.030112504959106445
mini_batch_src_global generation:  0.053371429443359375
r_  generation:  0.4522688388824463
local_output_nid generation:  0.03053593635559082
local_in_edges_tensor generation:  0.03174877166748047
mini_batch_src_global generation:  0.05142378807067871
r_  generation:  0.4594264030456543
local_output_nid generation:  0.030489444732666016
local_in_edges_tensor generation:  0.029335975646972656
mini_batch_src_global generation:  0.05269145965576172
r_  generation:  0.4544494152069092
local_output_nid generation:  0.03055596351623535
local_in_edges_tensor generation:  0.03157401084899902
mini_batch_src_global generation:  0.05161166191101074
r_  generation:  0.4601633548736572
local_output_nid generation:  0.031129121780395508
local_in_edges_tensor generation:  0.034470319747924805
mini_batch_src_global generation:  0.05366253852844238
r_  generation:  0.45404601097106934
local_output_nid generation:  0.030588865280151367
local_in_edges_tensor generation:  0.029709339141845703
mini_batch_src_global generation:  0.05143547058105469
r_  generation:  0.46147727966308594
local_output_nid generation:  0.030714035034179688
local_in_edges_tensor generation:  0.03180575370788574
mini_batch_src_global generation:  0.05305361747741699
r_  generation:  0.4548792839050293
local_output_nid generation:  0.030756235122680664
local_in_edges_tensor generation:  0.029975175857543945
mini_batch_src_global generation:  0.051937103271484375
r_  generation:  0.4614272117614746
local_output_nid generation:  0.030767440795898438
local_in_edges_tensor generation:  0.034169912338256836
mini_batch_src_global generation:  0.0532686710357666
r_  generation:  0.45513272285461426
----------------------check_connections_block total spend ----------------------------- 10.736148834228516
generate_one_block  0.5698788166046143
generate_one_block  0.5702462196350098
generate_one_block  0.5762262344360352
generate_one_block  0.5717329978942871
generate_one_block  0.577359676361084
generate_one_block  0.5766549110412598
generate_one_block  0.5768065452575684
generate_one_block  0.5725598335266113
generate_one_block  0.6270163059234619
generate_one_block  0.573192834854126
generate_one_block  0.5766892433166504
generate_one_block  0.5847370624542236
generate_one_block  0.5705726146697998
generate_one_block  0.5842299461364746
generate_one_block  0.5737879276275635
generate_one_block  0.5847659111022949
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11851644515991211  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

connection checking time:  16.160858392715454
block generation total time  14.082287073135376
average batch blocks generation time:  0.880142942070961
block dataloader generation time/epoch 32.727312261408024
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09449291229248047  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7433733940124512  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09468936920166016  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.742426872253418  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09430074691772461  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.740203857421875  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09454154968261719  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7385144233703613  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09444332122802734  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7434988021850586  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0949411392211914  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7542996406555176  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09447860717773438  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7485990524291992  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09459400177001953  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7409553527832031  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09443140029907227  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7404966354370117  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09467411041259766  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.742279052734375  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09461688995361328  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7496180534362793  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09493160247802734  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7535624504089355  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09430980682373047  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7422580718994141  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09486865997314453  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7465076446533203  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09436321258544922  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7443890571594238  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09486961364746094  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7516894340515137  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0651138424873352 |0.009852781891822815 |0.0035284459590911865 |8.876621723175049e-05 |0.003705441951751709 |0.003115415573120117 |
----------------------------------------------------------pseudo_mini_loss sum 1.33329176902771
Total (block generation + training)time/epoch 34.14629023725336
Training time/epoch 1.3792526721954346
Training time without block to device /epoch 1.2216081619262695
Training time without total dataloading part /epoch 0.12027788162231445
load block tensor time/epoch 1.0418214797973633
block to device time/epoch 0.15764451026916504
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 20 |
Number of nodes for computation during this epoch:  5206510
Number of first layer input nodes during this epoch:  2480115
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11855459213256836  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022847414016723633
range selection method range initialization spend 0.013802528381347656
time for parepare:  0.017685651779174805
local_output_nid generation:  0.0014660358428955078
local_in_edges_tensor generation:  0.0034329891204833984
mini_batch_src_global generation:  0.0018198490142822266
r_  generation:  0.02178215980529785
local_output_nid generation:  0.0016102790832519531
local_in_edges_tensor generation:  0.001010894775390625
mini_batch_src_global generation:  0.002027273178100586
r_  generation:  0.021866798400878906
local_output_nid generation:  0.0015833377838134766
local_in_edges_tensor generation:  0.0010094642639160156
mini_batch_src_global generation:  0.0017275810241699219
r_  generation:  0.0218660831451416
local_output_nid generation:  0.0016658306121826172
local_in_edges_tensor generation:  0.0009918212890625
mini_batch_src_global generation:  0.0017273426055908203
r_  generation:  0.02133774757385254
local_output_nid generation:  0.0016262531280517578
local_in_edges_tensor generation:  0.0009806156158447266
mini_batch_src_global generation:  0.0017244815826416016
r_  generation:  0.02181220054626465
local_output_nid generation:  0.0015957355499267578
local_in_edges_tensor generation:  0.0009653568267822266
mini_batch_src_global generation:  0.0017406940460205078
r_  generation:  0.022090673446655273
local_output_nid generation:  0.001575469970703125
local_in_edges_tensor generation:  0.0009434223175048828
mini_batch_src_global generation:  0.0017237663269042969
r_  generation:  0.022165298461914062
local_output_nid generation:  0.0015666484832763672
local_in_edges_tensor generation:  0.0009467601776123047
mini_batch_src_global generation:  0.0017688274383544922
r_  generation:  0.022496700286865234
local_output_nid generation:  0.0015835762023925781
local_in_edges_tensor generation:  0.0009286403656005859
mini_batch_src_global generation:  0.0017554759979248047
r_  generation:  0.022724390029907227
local_output_nid generation:  0.0016591548919677734
local_in_edges_tensor generation:  0.0009548664093017578
mini_batch_src_global generation:  0.0017788410186767578
r_  generation:  0.022268056869506836
local_output_nid generation:  0.001577138900756836
local_in_edges_tensor generation:  0.0009744167327880859
mini_batch_src_global generation:  0.0017118453979492188
r_  generation:  0.021888017654418945
local_output_nid generation:  0.0015730857849121094
local_in_edges_tensor generation:  0.0009293556213378906
mini_batch_src_global generation:  0.0017511844635009766
r_  generation:  0.022249937057495117
local_output_nid generation:  0.0015718936920166016
local_in_edges_tensor generation:  0.0009253025054931641
mini_batch_src_global generation:  0.0017502307891845703
r_  generation:  0.02219867706298828
local_output_nid generation:  0.001567840576171875
local_in_edges_tensor generation:  0.0009601116180419922
mini_batch_src_global generation:  0.0017485618591308594
r_  generation:  0.022108793258666992
local_output_nid generation:  0.0015707015991210938
local_in_edges_tensor generation:  0.0009541511535644531
mini_batch_src_global generation:  0.0017011165618896484
r_  generation:  0.022053003311157227
local_output_nid generation:  0.0015628337860107422
local_in_edges_tensor generation:  0.0009670257568359375
mini_batch_src_global generation:  0.0017359256744384766
r_  generation:  0.02205038070678711
----------------------check_connections_block total spend ----------------------------- 0.5195586681365967
generate_one_block  0.030708789825439453
generate_one_block  0.03100895881652832
generate_one_block  0.031276702880859375
generate_one_block  0.030538082122802734
generate_one_block  0.03086709976196289
generate_one_block  0.03252387046813965
generate_one_block  0.031085491180419922
generate_one_block  0.03180336952209473
generate_one_block  0.03213858604431152
generate_one_block  0.030882835388183594
generate_one_block  0.03063488006591797
generate_one_block  0.031172990798950195
generate_one_block  0.03157758712768555
generate_one_block  0.03131699562072754
generate_one_block  0.03107428550720215
generate_one_block  0.03150534629821777
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.034362077713012695
gen group dst list time:  0.01753711700439453
time for parepare:  0.019423961639404297
local_output_nid generation:  0.007609844207763672
local_in_edges_tensor generation:  0.018263816833496094
mini_batch_src_global generation:  0.024122953414916992
r_  generation:  0.22294998168945312
local_output_nid generation:  0.011028051376342773
local_in_edges_tensor generation:  0.013280391693115234
mini_batch_src_global generation:  0.02810811996459961
r_  generation:  0.22875213623046875
local_output_nid generation:  0.011448144912719727
local_in_edges_tensor generation:  0.014159917831420898
mini_batch_src_global generation:  0.03143644332885742
r_  generation:  0.23061180114746094
local_output_nid generation:  0.012876749038696289
local_in_edges_tensor generation:  0.013208389282226562
mini_batch_src_global generation:  0.027948617935180664
r_  generation:  0.22675681114196777
local_output_nid generation:  0.012788772583007812
local_in_edges_tensor generation:  0.012553930282592773
mini_batch_src_global generation:  0.029169797897338867
r_  generation:  0.24066925048828125
local_output_nid generation:  0.012673377990722656
local_in_edges_tensor generation:  0.015268802642822266
mini_batch_src_global generation:  0.03297257423400879
r_  generation:  0.23781418800354004
local_output_nid generation:  0.012883901596069336
local_in_edges_tensor generation:  0.01714634895324707
mini_batch_src_global generation:  0.03142404556274414
r_  generation:  0.2376244068145752
local_output_nid generation:  0.01527714729309082
local_in_edges_tensor generation:  0.01709914207458496
mini_batch_src_global generation:  0.03210043907165527
r_  generation:  0.23854756355285645
local_output_nid generation:  0.013449907302856445
local_in_edges_tensor generation:  0.016977787017822266
mini_batch_src_global generation:  0.0313107967376709
r_  generation:  0.24337434768676758
local_output_nid generation:  0.013425827026367188
local_in_edges_tensor generation:  0.013310432434082031
mini_batch_src_global generation:  0.029484987258911133
r_  generation:  0.23614144325256348
local_output_nid generation:  0.012866973876953125
local_in_edges_tensor generation:  0.013615131378173828
mini_batch_src_global generation:  0.029371976852416992
r_  generation:  0.23572063446044922
local_output_nid generation:  0.013487100601196289
local_in_edges_tensor generation:  0.013003110885620117
mini_batch_src_global generation:  0.029587745666503906
r_  generation:  0.23726248741149902
local_output_nid generation:  0.01370692253112793
local_in_edges_tensor generation:  0.012825489044189453
mini_batch_src_global generation:  0.030487060546875
r_  generation:  0.24328851699829102
local_output_nid generation:  0.013681650161743164
local_in_edges_tensor generation:  0.013164281845092773
mini_batch_src_global generation:  0.029457807540893555
r_  generation:  0.2383432388305664
local_output_nid generation:  0.013532638549804688
local_in_edges_tensor generation:  0.012757539749145508
mini_batch_src_global generation:  0.029615402221679688
r_  generation:  0.24165844917297363
local_output_nid generation:  0.013538837432861328
local_in_edges_tensor generation:  0.013061046600341797
mini_batch_src_global generation:  0.029651165008544922
r_  generation:  0.24163341522216797
----------------------check_connections_block total spend ----------------------------- 5.540903329849243
generate_one_block  0.3175656795501709
generate_one_block  0.3014240264892578
generate_one_block  0.3037140369415283
generate_one_block  0.2939574718475342
generate_one_block  0.30944061279296875
generate_one_block  0.30495405197143555
generate_one_block  0.3292267322540283
generate_one_block  0.31075501441955566
generate_one_block  0.31244421005249023
generate_one_block  0.3029048442840576
generate_one_block  0.3004748821258545
generate_one_block  0.3029024600982666
generate_one_block  0.3139057159423828
generate_one_block  0.30386900901794434
generate_one_block  0.2997322082519531
generate_one_block  0.3002314567565918
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03879094123840332
gen group dst list time:  0.06990289688110352
time for parepare:  0.018857240676879883
local_output_nid generation:  0.025681257247924805
local_in_edges_tensor generation:  0.05244731903076172
mini_batch_src_global generation:  0.04205465316772461
r_  generation:  0.45111727714538574
local_output_nid generation:  0.029977083206176758
local_in_edges_tensor generation:  0.0367581844329834
mini_batch_src_global generation:  0.05239701271057129
r_  generation:  0.4508638381958008
local_output_nid generation:  0.03037548065185547
local_in_edges_tensor generation:  0.031624794006347656
mini_batch_src_global generation:  0.05149197578430176
r_  generation:  0.45907068252563477
local_output_nid generation:  0.03243279457092285
local_in_edges_tensor generation:  0.03116011619567871
mini_batch_src_global generation:  0.053128957748413086
r_  generation:  0.46704792976379395
local_output_nid generation:  0.030750513076782227
local_in_edges_tensor generation:  0.07476449012756348
mini_batch_src_global generation:  0.054878950119018555
r_  generation:  0.4648919105529785
local_output_nid generation:  0.031792402267456055
local_in_edges_tensor generation:  0.03015732765197754
mini_batch_src_global generation:  0.05312824249267578
r_  generation:  0.4638066291809082
local_output_nid generation:  0.030925512313842773
local_in_edges_tensor generation:  0.0320897102355957
mini_batch_src_global generation:  0.05194425582885742
r_  generation:  0.4644808769226074
local_output_nid generation:  0.03123760223388672
local_in_edges_tensor generation:  0.030611515045166016
mini_batch_src_global generation:  0.055548667907714844
r_  generation:  0.4614994525909424
local_output_nid generation:  0.031374216079711914
local_in_edges_tensor generation:  0.03386211395263672
mini_batch_src_global generation:  0.052855730056762695
r_  generation:  0.4656708240509033
local_output_nid generation:  0.031336069107055664
local_in_edges_tensor generation:  0.031744956970214844
mini_batch_src_global generation:  0.05599570274353027
r_  generation:  0.4616355895996094
local_output_nid generation:  0.0314784049987793
local_in_edges_tensor generation:  0.03675532341003418
mini_batch_src_global generation:  0.05646204948425293
r_  generation:  0.4645237922668457
local_output_nid generation:  0.03135538101196289
local_in_edges_tensor generation:  0.036850690841674805
mini_batch_src_global generation:  0.0534515380859375
r_  generation:  0.47953033447265625
local_output_nid generation:  0.03405261039733887
local_in_edges_tensor generation:  0.03239941596984863
mini_batch_src_global generation:  0.0552978515625
r_  generation:  0.4681210517883301
local_output_nid generation:  0.032970428466796875
local_in_edges_tensor generation:  0.03594803810119629
mini_batch_src_global generation:  0.053961992263793945
r_  generation:  0.46166276931762695
local_output_nid generation:  0.03235578536987305
local_in_edges_tensor generation:  0.030110836029052734
mini_batch_src_global generation:  0.051891326904296875
r_  generation:  0.46159839630126953
local_output_nid generation:  0.03251290321350098
local_in_edges_tensor generation:  0.03162264823913574
mini_batch_src_global generation:  0.053559303283691406
r_  generation:  0.4580862522125244
----------------------check_connections_block total spend ----------------------------- 10.962252140045166
generate_one_block  0.5904431343078613
generate_one_block  0.5905048847198486
generate_one_block  0.583139181137085
generate_one_block  0.5821139812469482
generate_one_block  0.587317943572998
generate_one_block  0.583803653717041
generate_one_block  0.5934581756591797
generate_one_block  0.5846109390258789
generate_one_block  0.6244957447052002
generate_one_block  0.581984281539917
generate_one_block  0.581817626953125
generate_one_block  0.5822978019714355
generate_one_block  0.5896484851837158
generate_one_block  0.5797319412231445
generate_one_block  0.5769472122192383
generate_one_block  0.5886621475219727
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11855459213256836  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

connection checking time:  16.50315546989441
block generation total time  14.30847954750061
average batch blocks generation time:  0.8942799717187881
block dataloader generation time/epoch 32.749054888884224
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0947103500366211  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7521653175354004  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09463882446289062  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7413744926452637  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09433841705322266  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7455334663391113  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09457874298095703  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7413811683654785  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09455585479736328  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7466263771057129  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09467220306396484  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7426185607910156  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0942697525024414  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.742882251739502  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09481430053710938  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7458491325378418  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09456014633178711  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7490687370300293  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09470558166503906  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7430925369262695  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09436750411987305  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7417087554931641  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0947427749633789  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7436184883117676  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09471702575683594  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7533907890319824  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09476089477539062  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7475347518920898  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09448957443237305  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7452921867370605  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09472179412841797  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.748197078704834  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06554882228374481 |0.01266525685787201 |0.003565654158592224 |9.03010368347168e-05 |0.0037527084350585938 |0.0028231143951416016 |
----------------------------------------------------------pseudo_mini_loss sum 1.3145837783813477
Total (block generation + training)time/epoch 34.16940303643545
Training time/epoch 1.4351832866668701
Training time without block to device /epoch 1.232539176940918
Training time without total dataloading part /epoch 0.12136173248291016
load block tensor time/epoch 1.048781156539917
block to device time/epoch 0.20264410972595215
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 21 |
Number of nodes for computation during this epoch:  5208947
Number of first layer input nodes during this epoch:  2480493
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11811304092407227  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.06420397758483887
range selection method range initialization spend 0.01223897933959961
time for parepare:  0.017126083374023438
local_output_nid generation:  0.0014033317565917969
local_in_edges_tensor generation:  0.006519794464111328
mini_batch_src_global generation:  0.0018548965454101562
r_  generation:  0.02185678482055664
local_output_nid generation:  0.0015811920166015625
local_in_edges_tensor generation:  0.0009903907775878906
mini_batch_src_global generation:  0.0020978450775146484
r_  generation:  0.02211737632751465
local_output_nid generation:  0.0016570091247558594
local_in_edges_tensor generation:  0.0009481906890869141
mini_batch_src_global generation:  0.001649618148803711
r_  generation:  0.02122330665588379
local_output_nid generation:  0.0016183853149414062
local_in_edges_tensor generation:  0.0009562969207763672
mini_batch_src_global generation:  0.0016925334930419922
r_  generation:  0.02160954475402832
local_output_nid generation:  0.0015909671783447266
local_in_edges_tensor generation:  0.0009474754333496094
mini_batch_src_global generation:  0.0017006397247314453
r_  generation:  0.02162027359008789
local_output_nid generation:  0.0015842914581298828
local_in_edges_tensor generation:  0.0009484291076660156
mini_batch_src_global generation:  0.0017592906951904297
r_  generation:  0.02243971824645996
local_output_nid generation:  0.0016124248504638672
local_in_edges_tensor generation:  0.0009620189666748047
mini_batch_src_global generation:  0.0017595291137695312
r_  generation:  0.022135257720947266
local_output_nid generation:  0.0015757083892822266
local_in_edges_tensor generation:  0.0009591579437255859
mini_batch_src_global generation:  0.0017247200012207031
r_  generation:  0.02210545539855957
local_output_nid generation:  0.001583099365234375
local_in_edges_tensor generation:  0.0009312629699707031
mini_batch_src_global generation:  0.0017557144165039062
r_  generation:  0.022217750549316406
local_output_nid generation:  0.0016553401947021484
local_in_edges_tensor generation:  0.0009248256683349609
mini_batch_src_global generation:  0.0017061233520507812
r_  generation:  0.02104043960571289
local_output_nid generation:  0.001581430435180664
local_in_edges_tensor generation:  0.0009517669677734375
mini_batch_src_global generation:  0.0017287731170654297
r_  generation:  0.022236108779907227
local_output_nid generation:  0.0015821456909179688
local_in_edges_tensor generation:  0.0009479522705078125
mini_batch_src_global generation:  0.0017364025115966797
r_  generation:  0.021928071975708008
local_output_nid generation:  0.0016798973083496094
local_in_edges_tensor generation:  0.0009715557098388672
mini_batch_src_global generation:  0.0017597675323486328
r_  generation:  0.02242112159729004
local_output_nid generation:  0.0016312599182128906
local_in_edges_tensor generation:  0.0009236335754394531
mini_batch_src_global generation:  0.0017430782318115234
r_  generation:  0.022121667861938477
local_output_nid generation:  0.0015866756439208984
local_in_edges_tensor generation:  0.0009541511535644531
mini_batch_src_global generation:  0.0017063617706298828
r_  generation:  0.021815061569213867
local_output_nid generation:  0.0015974044799804688
local_in_edges_tensor generation:  0.0009486675262451172
mini_batch_src_global generation:  0.0017197132110595703
r_  generation:  0.022279739379882812
----------------------check_connections_block total spend ----------------------------- 0.5202515125274658
generate_one_block  0.031332969665527344
generate_one_block  0.03148245811462402
generate_one_block  0.030665874481201172
generate_one_block  0.03102874755859375
generate_one_block  0.03109002113342285
generate_one_block  0.03360414505004883
generate_one_block  0.031224489212036133
generate_one_block  0.03081488609313965
generate_one_block  0.031445980072021484
generate_one_block  0.029876232147216797
generate_one_block  0.03127551078796387
generate_one_block  0.031193971633911133
generate_one_block  0.032120466232299805
generate_one_block  0.031037330627441406
generate_one_block  0.030480384826660156
generate_one_block  0.03175663948059082
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0357363224029541
gen group dst list time:  0.017481327056884766
time for parepare:  0.019493818283081055
local_output_nid generation:  0.007622718811035156
local_in_edges_tensor generation:  0.021477937698364258
mini_batch_src_global generation:  0.023920297622680664
r_  generation:  0.22061610221862793
local_output_nid generation:  0.011259794235229492
local_in_edges_tensor generation:  0.014724493026733398
mini_batch_src_global generation:  0.02769327163696289
r_  generation:  0.22565865516662598
local_output_nid generation:  0.011640071868896484
local_in_edges_tensor generation:  0.013143777847290039
mini_batch_src_global generation:  0.02699899673461914
r_  generation:  0.22874855995178223
local_output_nid generation:  0.012521505355834961
local_in_edges_tensor generation:  0.014406919479370117
mini_batch_src_global generation:  0.027798891067504883
r_  generation:  0.23386216163635254
local_output_nid generation:  0.012777090072631836
local_in_edges_tensor generation:  0.015587568283081055
mini_batch_src_global generation:  0.029080629348754883
r_  generation:  0.2359321117401123
local_output_nid generation:  0.012830972671508789
local_in_edges_tensor generation:  0.016007661819458008
mini_batch_src_global generation:  0.030692100524902344
r_  generation:  0.24170279502868652
local_output_nid generation:  0.013045310974121094
local_in_edges_tensor generation:  0.01485300064086914
mini_batch_src_global generation:  0.029699087142944336
r_  generation:  0.24907565116882324
local_output_nid generation:  0.015311717987060547
local_in_edges_tensor generation:  0.016659259796142578
mini_batch_src_global generation:  0.030058860778808594
r_  generation:  0.2326524257659912
local_output_nid generation:  0.013673067092895508
local_in_edges_tensor generation:  0.012545585632324219
mini_batch_src_global generation:  0.030276060104370117
r_  generation:  0.24010467529296875
local_output_nid generation:  0.012971639633178711
local_in_edges_tensor generation:  0.01543879508972168
mini_batch_src_global generation:  0.029606342315673828
r_  generation:  0.22678494453430176
local_output_nid generation:  0.012960672378540039
local_in_edges_tensor generation:  0.013326168060302734
mini_batch_src_global generation:  0.030173540115356445
r_  generation:  0.23920416831970215
local_output_nid generation:  0.013469219207763672
local_in_edges_tensor generation:  0.013144731521606445
mini_batch_src_global generation:  0.02983689308166504
r_  generation:  0.23553943634033203
local_output_nid generation:  0.013695955276489258
local_in_edges_tensor generation:  0.013203620910644531
mini_batch_src_global generation:  0.030603647232055664
r_  generation:  0.23830652236938477
local_output_nid generation:  0.013512134552001953
local_in_edges_tensor generation:  0.015767574310302734
mini_batch_src_global generation:  0.0294950008392334
r_  generation:  0.23623037338256836
local_output_nid generation:  0.013395071029663086
local_in_edges_tensor generation:  0.01336979866027832
mini_batch_src_global generation:  0.03045964241027832
r_  generation:  0.23647236824035645
local_output_nid generation:  0.013317346572875977
local_in_edges_tensor generation:  0.014325380325317383
mini_batch_src_global generation:  0.031158924102783203
r_  generation:  0.2413780689239502
----------------------check_connections_block total spend ----------------------------- 5.508247137069702
generate_one_block  0.30963611602783203
generate_one_block  0.2979581356048584
generate_one_block  0.30545949935913086
generate_one_block  0.30231308937072754
generate_one_block  0.3002793788909912
generate_one_block  0.30576515197753906
generate_one_block  0.32605838775634766
generate_one_block  0.29680681228637695
generate_one_block  0.3007321357727051
generate_one_block  0.2882075309753418
generate_one_block  0.30324459075927734
generate_one_block  0.30066752433776855
generate_one_block  0.3028073310852051
generate_one_block  0.3036231994628906
generate_one_block  0.2984578609466553
generate_one_block  0.31025242805480957
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03269767761230469
gen group dst list time:  0.06302785873413086
time for parepare:  0.017882585525512695
local_output_nid generation:  0.025490522384643555
local_in_edges_tensor generation:  0.04387211799621582
mini_batch_src_global generation:  0.04103279113769531
r_  generation:  0.4531238079071045
local_output_nid generation:  0.03063225746154785
local_in_edges_tensor generation:  0.03673696517944336
mini_batch_src_global generation:  0.05264544486999512
r_  generation:  0.447573184967041
local_output_nid generation:  0.03091883659362793
local_in_edges_tensor generation:  0.030922412872314453
mini_batch_src_global generation:  0.05082273483276367
r_  generation:  0.46151018142700195
local_output_nid generation:  0.03277015686035156
local_in_edges_tensor generation:  0.03229641914367676
mini_batch_src_global generation:  0.0547184944152832
r_  generation:  0.4526381492614746
local_output_nid generation:  0.03134965896606445
local_in_edges_tensor generation:  0.07294464111328125
mini_batch_src_global generation:  0.053449153900146484
r_  generation:  0.46215343475341797
local_output_nid generation:  0.03141641616821289
local_in_edges_tensor generation:  0.032007694244384766
mini_batch_src_global generation:  0.058506011962890625
r_  generation:  0.4565861225128174
local_output_nid generation:  0.0314946174621582
local_in_edges_tensor generation:  0.0294797420501709
mini_batch_src_global generation:  0.05223369598388672
r_  generation:  0.4625563621520996
local_output_nid generation:  0.03144717216491699
local_in_edges_tensor generation:  0.02965855598449707
mini_batch_src_global generation:  0.05309033393859863
r_  generation:  0.4529573917388916
local_output_nid generation:  0.03173828125
local_in_edges_tensor generation:  0.02945685386657715
mini_batch_src_global generation:  0.05257678031921387
r_  generation:  0.46489453315734863
local_output_nid generation:  0.0310361385345459
local_in_edges_tensor generation:  0.03250622749328613
mini_batch_src_global generation:  0.05348014831542969
r_  generation:  0.45177650451660156
local_output_nid generation:  0.03182029724121094
local_in_edges_tensor generation:  0.029822111129760742
mini_batch_src_global generation:  0.05209946632385254
r_  generation:  0.4708256721496582
local_output_nid generation:  0.032503366470336914
local_in_edges_tensor generation:  0.03429555892944336
mini_batch_src_global generation:  0.0534517765045166
r_  generation:  0.45661258697509766
local_output_nid generation:  0.03217911720275879
local_in_edges_tensor generation:  0.032761573791503906
mini_batch_src_global generation:  0.053975820541381836
r_  generation:  0.47007250785827637
local_output_nid generation:  0.03198862075805664
local_in_edges_tensor generation:  0.029570817947387695
mini_batch_src_global generation:  0.053527116775512695
r_  generation:  0.4576117992401123
local_output_nid generation:  0.03207993507385254
local_in_edges_tensor generation:  0.036459922790527344
mini_batch_src_global generation:  0.052165985107421875
r_  generation:  0.4729771614074707
local_output_nid generation:  0.03246784210205078
local_in_edges_tensor generation:  0.034795522689819336
mini_batch_src_global generation:  0.05398273468017578
r_  generation:  0.4599175453186035
----------------------check_connections_block total spend ----------------------------- 10.882912635803223
generate_one_block  0.5780594348907471
generate_one_block  0.5827350616455078
generate_one_block  0.5810225009918213
generate_one_block  0.585949182510376
generate_one_block  0.5880777835845947
generate_one_block  0.5851707458496094
generate_one_block  0.5809011459350586
generate_one_block  0.5816929340362549
generate_one_block  0.6464602947235107
generate_one_block  0.5903325080871582
generate_one_block  0.5867729187011719
generate_one_block  0.5832605361938477
generate_one_block  0.588381290435791
generate_one_block  0.578685998916626
generate_one_block  0.5867552757263184
generate_one_block  0.5934250354766846
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11811304092407227  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

connection checking time:  16.391159772872925
block generation total time  14.269951820373535
average batch blocks generation time:  0.891871988773346
block dataloader generation time/epoch 32.75485829206613
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09480667114257812  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7547292709350586  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09473609924316406  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7434449195861816  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09459400177001953  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7433176040649414  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09482765197753906  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7479648590087891  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09458494186401367  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7479438781738281  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09492778778076172  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7529239654541016  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09435272216796875  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7436308860778809  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09464740753173828  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7424511909484863  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09467220306396484  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7494382858276367  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0944061279296875  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7325224876403809  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0946049690246582  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7467823028564453  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09469127655029297  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7418432235717773  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09448385238647461  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7496681213378906  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09472179412841797  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7431111335754395  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09434127807617188  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7424864768981934  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09490489959716797  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7536211013793945  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06396806240081787 |0.014387309551239014 |0.0039397478103637695 |9.958446025848389e-05 |0.0036053061485290527 |0.0025835037231445312 |
----------------------------------------------------------pseudo_mini_loss sum 1.2962961196899414
Total (block generation + training)time/epoch 34.17673501601586
Training time/epoch 1.439958095550537
Training time without block to device /epoch 1.209761142730713
Training time without total dataloading part /epoch 0.12489771842956543
load block tensor time/epoch 1.023488998413086
block to device time/epoch 0.23019695281982422
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 22 |
Number of nodes for computation during this epoch:  5209884
Number of first layer input nodes during this epoch:  2480545
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11960124969482422  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024521350860595703
range selection method range initialization spend 0.012691497802734375
time for parepare:  0.01748037338256836
local_output_nid generation:  0.0014388561248779297
local_in_edges_tensor generation:  0.006590366363525391
mini_batch_src_global generation:  0.001753091812133789
r_  generation:  0.02127361297607422
local_output_nid generation:  0.001535654067993164
local_in_edges_tensor generation:  0.0010001659393310547
mini_batch_src_global generation:  0.002118349075317383
r_  generation:  0.025542736053466797
local_output_nid generation:  0.0015652179718017578
local_in_edges_tensor generation:  0.0009613037109375
mini_batch_src_global generation:  0.001692056655883789
r_  generation:  0.021844863891601562
local_output_nid generation:  0.001617431640625
local_in_edges_tensor generation:  0.0010728836059570312
mini_batch_src_global generation:  0.0017633438110351562
r_  generation:  0.022059202194213867
local_output_nid generation:  0.0015740394592285156
local_in_edges_tensor generation:  0.000982522964477539
mini_batch_src_global generation:  0.0017757415771484375
r_  generation:  0.023345947265625
local_output_nid generation:  0.0015940666198730469
local_in_edges_tensor generation:  0.001058340072631836
mini_batch_src_global generation:  0.001734018325805664
r_  generation:  0.02190566062927246
local_output_nid generation:  0.001664876937866211
local_in_edges_tensor generation:  0.0010399818420410156
mini_batch_src_global generation:  0.0017504692077636719
r_  generation:  0.021910905838012695
local_output_nid generation:  0.0015921592712402344
local_in_edges_tensor generation:  0.0009615421295166016
mini_batch_src_global generation:  0.0017724037170410156
r_  generation:  0.02225518226623535
local_output_nid generation:  0.0015833377838134766
local_in_edges_tensor generation:  0.0009675025939941406
mini_batch_src_global generation:  0.0017917156219482422
r_  generation:  0.02199864387512207
local_output_nid generation:  0.0016469955444335938
local_in_edges_tensor generation:  0.0010221004486083984
mini_batch_src_global generation:  0.001798868179321289
r_  generation:  0.02255725860595703
local_output_nid generation:  0.0016050338745117188
local_in_edges_tensor generation:  0.0009453296661376953
mini_batch_src_global generation:  0.0017790794372558594
r_  generation:  0.02187061309814453
local_output_nid generation:  0.001608133316040039
local_in_edges_tensor generation:  0.000965118408203125
mini_batch_src_global generation:  0.0017766952514648438
r_  generation:  0.025032997131347656
local_output_nid generation:  0.0015888214111328125
local_in_edges_tensor generation:  0.0009543895721435547
mini_batch_src_global generation:  0.0021500587463378906
r_  generation:  0.022119760513305664
local_output_nid generation:  0.0016112327575683594
local_in_edges_tensor generation:  0.0010149478912353516
mini_batch_src_global generation:  0.0017118453979492188
r_  generation:  0.021533489227294922
local_output_nid generation:  0.0016655921936035156
local_in_edges_tensor generation:  0.0009920597076416016
mini_batch_src_global generation:  0.0017552375793457031
r_  generation:  0.024811983108520508
local_output_nid generation:  0.0015981197357177734
local_in_edges_tensor generation:  0.0011441707611083984
mini_batch_src_global generation:  0.0017762184143066406
r_  generation:  0.022432565689086914
----------------------check_connections_block total spend ----------------------------- 0.5408720970153809
generate_one_block  0.03554868698120117
generate_one_block  0.0317842960357666
generate_one_block  0.031961917877197266
generate_one_block  0.03220486640930176
generate_one_block  0.03190422058105469
generate_one_block  0.03524446487426758
generate_one_block  0.03107476234436035
generate_one_block  0.0316777229309082
generate_one_block  0.031247854232788086
generate_one_block  0.03168487548828125
generate_one_block  0.03079676628112793
generate_one_block  0.03197669982910156
generate_one_block  0.03133106231689453
generate_one_block  0.03072214126586914
generate_one_block  0.032740116119384766
generate_one_block  0.03228306770324707
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03435039520263672
gen group dst list time:  0.02125716209411621
time for parepare:  0.021657228469848633
local_output_nid generation:  0.007491588592529297
local_in_edges_tensor generation:  0.02364039421081543
mini_batch_src_global generation:  0.023886919021606445
r_  generation:  0.220200777053833
local_output_nid generation:  0.011384725570678711
local_in_edges_tensor generation:  0.01655721664428711
mini_batch_src_global generation:  0.031970977783203125
r_  generation:  0.23133563995361328
local_output_nid generation:  0.012113332748413086
local_in_edges_tensor generation:  0.012349843978881836
mini_batch_src_global generation:  0.028676986694335938
r_  generation:  0.2337474822998047
local_output_nid generation:  0.014462947845458984
local_in_edges_tensor generation:  0.016465187072753906
mini_batch_src_global generation:  0.029366254806518555
r_  generation:  0.23922014236450195
local_output_nid generation:  0.012610197067260742
local_in_edges_tensor generation:  0.013375520706176758
mini_batch_src_global generation:  0.029535293579101562
r_  generation:  0.2364044189453125
local_output_nid generation:  0.01251077651977539
local_in_edges_tensor generation:  0.01623225212097168
mini_batch_src_global generation:  0.030027151107788086
r_  generation:  0.23423004150390625
local_output_nid generation:  0.012927532196044922
local_in_edges_tensor generation:  0.017435312271118164
mini_batch_src_global generation:  0.02954864501953125
r_  generation:  0.2371206283569336
local_output_nid generation:  0.013216257095336914
local_in_edges_tensor generation:  0.012427330017089844
mini_batch_src_global generation:  0.029989242553710938
r_  generation:  0.24062871932983398
local_output_nid generation:  0.013869762420654297
local_in_edges_tensor generation:  0.01761341094970703
mini_batch_src_global generation:  0.030209064483642578
r_  generation:  0.23775672912597656
local_output_nid generation:  0.015113115310668945
local_in_edges_tensor generation:  0.012734413146972656
mini_batch_src_global generation:  0.03143787384033203
r_  generation:  0.2457275390625
local_output_nid generation:  0.012535810470581055
local_in_edges_tensor generation:  0.014925718307495117
mini_batch_src_global generation:  0.030977964401245117
r_  generation:  0.23579025268554688
local_output_nid generation:  0.013392210006713867
local_in_edges_tensor generation:  0.013992071151733398
mini_batch_src_global generation:  0.03152298927307129
r_  generation:  0.24357843399047852
local_output_nid generation:  0.013255119323730469
local_in_edges_tensor generation:  0.015788555145263672
mini_batch_src_global generation:  0.03108525276184082
r_  generation:  0.23649954795837402
local_output_nid generation:  0.01320648193359375
local_in_edges_tensor generation:  0.015361309051513672
mini_batch_src_global generation:  0.030503511428833008
r_  generation:  0.23137307167053223
local_output_nid generation:  0.013425827026367188
local_in_edges_tensor generation:  0.017865896224975586
mini_batch_src_global generation:  0.030270099639892578
r_  generation:  0.25603771209716797
local_output_nid generation:  0.01537179946899414
local_in_edges_tensor generation:  0.01724410057067871
mini_batch_src_global generation:  0.029839515686035156
r_  generation:  0.23868012428283691
----------------------check_connections_block total spend ----------------------------- 5.586669921875
generate_one_block  0.3157215118408203
generate_one_block  0.307661771774292
generate_one_block  0.3121483325958252
generate_one_block  0.31203174591064453
generate_one_block  0.30205559730529785
generate_one_block  0.2993929386138916
generate_one_block  0.32631993293762207
generate_one_block  0.30447912216186523
generate_one_block  0.3078346252441406
generate_one_block  0.3078784942626953
generate_one_block  0.300325870513916
generate_one_block  0.31109118461608887
generate_one_block  0.3009371757507324
generate_one_block  0.2929267883300781
generate_one_block  0.30716466903686523
generate_one_block  0.3110005855560303
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03469443321228027
gen group dst list time:  0.06606221199035645
time for parepare:  0.019404888153076172
local_output_nid generation:  0.025204181671142578
local_in_edges_tensor generation:  0.04570174217224121
mini_batch_src_global generation:  0.041898250579833984
r_  generation:  0.4490537643432617
local_output_nid generation:  0.030403614044189453
local_in_edges_tensor generation:  0.0362398624420166
mini_batch_src_global generation:  0.054555654525756836
r_  generation:  0.45111584663391113
local_output_nid generation:  0.0326080322265625
local_in_edges_tensor generation:  0.031410932540893555
mini_batch_src_global generation:  0.05306839942932129
r_  generation:  0.46109509468078613
local_output_nid generation:  0.030671358108520508
local_in_edges_tensor generation:  0.03347277641296387
mini_batch_src_global generation:  0.05509161949157715
r_  generation:  0.45912790298461914
local_output_nid generation:  0.03078150749206543
local_in_edges_tensor generation:  0.07514500617980957
mini_batch_src_global generation:  0.05263185501098633
r_  generation:  0.47977781295776367
local_output_nid generation:  0.03218722343444824
local_in_edges_tensor generation:  0.0396573543548584
mini_batch_src_global generation:  0.055403709411621094
r_  generation:  0.4676930904388428
local_output_nid generation:  0.03247833251953125
local_in_edges_tensor generation:  0.030986785888671875
mini_batch_src_global generation:  0.053434133529663086
r_  generation:  0.4674227237701416
local_output_nid generation:  0.031836748123168945
local_in_edges_tensor generation:  0.0331273078918457
mini_batch_src_global generation:  0.0534358024597168
r_  generation:  0.45787954330444336
local_output_nid generation:  0.031786441802978516
local_in_edges_tensor generation:  0.031049489974975586
mini_batch_src_global generation:  0.05237460136413574
r_  generation:  0.46419382095336914
local_output_nid generation:  0.03191065788269043
local_in_edges_tensor generation:  0.029774904251098633
mini_batch_src_global generation:  0.05373501777648926
r_  generation:  0.4592928886413574
local_output_nid generation:  0.03197121620178223
local_in_edges_tensor generation:  0.03132271766662598
mini_batch_src_global generation:  0.05265045166015625
r_  generation:  0.46817612648010254
local_output_nid generation:  0.031995296478271484
local_in_edges_tensor generation:  0.03088521957397461
mini_batch_src_global generation:  0.053934574127197266
r_  generation:  0.45821094512939453
local_output_nid generation:  0.03137707710266113
local_in_edges_tensor generation:  0.03081488609313965
mini_batch_src_global generation:  0.05285978317260742
r_  generation:  0.46218276023864746
local_output_nid generation:  0.0315403938293457
local_in_edges_tensor generation:  0.029031991958618164
mini_batch_src_global generation:  0.05368518829345703
r_  generation:  0.45383667945861816
local_output_nid generation:  0.03207683563232422
local_in_edges_tensor generation:  0.02889418601989746
mini_batch_src_global generation:  0.05448627471923828
r_  generation:  0.46442651748657227
local_output_nid generation:  0.03204798698425293
local_in_edges_tensor generation:  0.030402183532714844
mini_batch_src_global generation:  0.05400347709655762
r_  generation:  0.4593086242675781
----------------------check_connections_block total spend ----------------------------- 10.931413888931274
generate_one_block  0.5960562229156494
generate_one_block  0.5869629383087158
generate_one_block  0.5848598480224609
generate_one_block  0.58168625831604
generate_one_block  0.5852711200714111
generate_one_block  0.5806477069854736
generate_one_block  0.5851752758026123
generate_one_block  0.5877532958984375
generate_one_block  0.6141297817230225
generate_one_block  0.5820860862731934
generate_one_block  0.5798239707946777
generate_one_block  0.5917155742645264
generate_one_block  0.5815737247467041
generate_one_block  0.5812506675720215
generate_one_block  0.593726396560669
generate_one_block  0.5851864814758301
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11960124969482422  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

connection checking time:  16.518083810806274
block generation total time  14.316875696182251
average batch blocks generation time:  0.8948047310113907
block dataloader generation time/epoch 32.775011675698416
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09440040588378906  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.748171329498291  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09478282928466797  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7469768524169922  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09450101852416992  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7495131492614746  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09490489959716797  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7527074813842773  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09430694580078125  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7435479164123535  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09465503692626953  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7417683601379395  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0943751335144043  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.741692066192627  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09483051300048828  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7483639717102051  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09425687789916992  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7412171363830566  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09485340118408203  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7454471588134766  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09416770935058594  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7418780326843262  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09486579895019531  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7509284019470215  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09415817260742188  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7418117523193359  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0944814682006836  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7398648262023926  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09460783004760742  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.748469352722168  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09479808807373047  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7477669715881348  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06201179325580597 |0.014834940433502197 |0.003620922565460205 |9.171664714813232e-05 |0.003256857395172119 |0.002980470657348633 |
----------------------------------------------------------pseudo_mini_loss sum 1.2835307121276855
Total (block generation + training)time/epoch 34.195599045072285
Training time/epoch 1.4035563468933105
Training time without block to device /epoch 1.1661972999572754
Training time without total dataloading part /epoch 0.11449241638183594
load block tensor time/epoch 0.9921886920928955
block to device time/epoch 0.23735904693603516
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 23 |
Number of nodes for computation during this epoch:  5207002
Number of first layer input nodes during this epoch:  2479262
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11832571029663086  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02153325080871582
range selection method range initialization spend 0.01270914077758789
time for parepare:  0.01803445816040039
local_output_nid generation:  0.0014412403106689453
local_in_edges_tensor generation:  0.004083871841430664
mini_batch_src_global generation:  0.0021729469299316406
r_  generation:  0.021296024322509766
local_output_nid generation:  0.0016150474548339844
local_in_edges_tensor generation:  0.0010232925415039062
mini_batch_src_global generation:  0.0023589134216308594
r_  generation:  0.022249221801757812
local_output_nid generation:  0.0015246868133544922
local_in_edges_tensor generation:  0.0009763240814208984
mini_batch_src_global generation:  0.0016868114471435547
r_  generation:  0.021307706832885742
local_output_nid generation:  0.0016565322875976562
local_in_edges_tensor generation:  0.0009198188781738281
mini_batch_src_global generation:  0.0018680095672607422
r_  generation:  0.022046566009521484
local_output_nid generation:  0.0015594959259033203
local_in_edges_tensor generation:  0.0009150505065917969
mini_batch_src_global generation:  0.0017507076263427734
r_  generation:  0.021686077117919922
local_output_nid generation:  0.001573801040649414
local_in_edges_tensor generation:  0.0009553432464599609
mini_batch_src_global generation:  0.001791238784790039
r_  generation:  0.021990060806274414
local_output_nid generation:  0.00154876708984375
local_in_edges_tensor generation:  0.0009613037109375
mini_batch_src_global generation:  0.0017635822296142578
r_  generation:  0.022200345993041992
local_output_nid generation:  0.0015442371368408203
local_in_edges_tensor generation:  0.0009160041809082031
mini_batch_src_global generation:  0.001794576644897461
r_  generation:  0.0223391056060791
local_output_nid generation:  0.0015676021575927734
local_in_edges_tensor generation:  0.0009450912475585938
mini_batch_src_global generation:  0.0017440319061279297
r_  generation:  0.021503448486328125
local_output_nid generation:  0.0016431808471679688
local_in_edges_tensor generation:  0.0009474754333496094
mini_batch_src_global generation:  0.0017659664154052734
r_  generation:  0.022119998931884766
local_output_nid generation:  0.0015764236450195312
local_in_edges_tensor generation:  0.0009467601776123047
mini_batch_src_global generation:  0.0017638206481933594
r_  generation:  0.021712064743041992
local_output_nid generation:  0.0015516281127929688
local_in_edges_tensor generation:  0.0009200572967529297
mini_batch_src_global generation:  0.0018074512481689453
r_  generation:  0.022634506225585938
local_output_nid generation:  0.0015289783477783203
local_in_edges_tensor generation:  0.0009300708770751953
mini_batch_src_global generation:  0.0018334388732910156
r_  generation:  0.022778749465942383
local_output_nid generation:  0.0015549659729003906
local_in_edges_tensor generation:  0.0009670257568359375
mini_batch_src_global generation:  0.0017747879028320312
r_  generation:  0.021805763244628906
local_output_nid generation:  0.0015652179718017578
local_in_edges_tensor generation:  0.0009431838989257812
mini_batch_src_global generation:  0.001781463623046875
r_  generation:  0.022229433059692383
local_output_nid generation:  0.001562356948852539
local_in_edges_tensor generation:  0.0009527206420898438
mini_batch_src_global generation:  0.0017616748809814453
r_  generation:  0.02158355712890625
----------------------check_connections_block total spend ----------------------------- 0.5201394557952881
generate_one_block  0.030248165130615234
generate_one_block  0.03186821937561035
generate_one_block  0.03367495536804199
generate_one_block  0.039818525314331055
generate_one_block  0.03271675109863281
generate_one_block  0.034941673278808594
generate_one_block  0.04207444190979004
generate_one_block  0.03174257278442383
generate_one_block  0.030477046966552734
generate_one_block  0.031220674514770508
generate_one_block  0.03058171272277832
generate_one_block  0.03153085708618164
generate_one_block  0.03215765953063965
generate_one_block  0.0310366153717041
generate_one_block  0.031349897384643555
generate_one_block  0.0311281681060791
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06342172622680664
gen group dst list time:  0.02090287208557129
time for parepare:  0.019656896591186523
local_output_nid generation:  0.0073664188385009766
local_in_edges_tensor generation:  0.019758224487304688
mini_batch_src_global generation:  0.0244295597076416
r_  generation:  0.2154679298400879
local_output_nid generation:  0.011466264724731445
local_in_edges_tensor generation:  0.016993999481201172
mini_batch_src_global generation:  0.03156113624572754
r_  generation:  0.23067426681518555
local_output_nid generation:  0.011475801467895508
local_in_edges_tensor generation:  0.012265443801879883
mini_batch_src_global generation:  0.027204275131225586
r_  generation:  0.22835779190063477
local_output_nid generation:  0.012335062026977539
local_in_edges_tensor generation:  0.014404296875
mini_batch_src_global generation:  0.03071141242980957
r_  generation:  0.23675751686096191
local_output_nid generation:  0.0124359130859375
local_in_edges_tensor generation:  0.012698173522949219
mini_batch_src_global generation:  0.029742956161499023
r_  generation:  0.23473811149597168
local_output_nid generation:  0.01294851303100586
local_in_edges_tensor generation:  0.013490676879882812
mini_batch_src_global generation:  0.029058456420898438
r_  generation:  0.23778367042541504
local_output_nid generation:  0.012742042541503906
local_in_edges_tensor generation:  0.013671159744262695
mini_batch_src_global generation:  0.03116583824157715
r_  generation:  0.23220276832580566
local_output_nid generation:  0.013201236724853516
local_in_edges_tensor generation:  0.014478445053100586
mini_batch_src_global generation:  0.029393672943115234
r_  generation:  0.2392876148223877
local_output_nid generation:  0.012875556945800781
local_in_edges_tensor generation:  0.013710260391235352
mini_batch_src_global generation:  0.0297396183013916
r_  generation:  0.23749780654907227
local_output_nid generation:  0.013062238693237305
local_in_edges_tensor generation:  0.014862298965454102
mini_batch_src_global generation:  0.0320734977722168
r_  generation:  0.24010610580444336
local_output_nid generation:  0.013477087020874023
local_in_edges_tensor generation:  0.014569997787475586
mini_batch_src_global generation:  0.029575347900390625
r_  generation:  0.23529505729675293
local_output_nid generation:  0.013398170471191406
local_in_edges_tensor generation:  0.014944076538085938
mini_batch_src_global generation:  0.029917001724243164
r_  generation:  0.24247002601623535
local_output_nid generation:  0.013692140579223633
local_in_edges_tensor generation:  0.015392065048217773
mini_batch_src_global generation:  0.030986547470092773
r_  generation:  0.24861431121826172
local_output_nid generation:  0.013276338577270508
local_in_edges_tensor generation:  0.013628005981445312
mini_batch_src_global generation:  0.0304410457611084
r_  generation:  0.23785948753356934
local_output_nid generation:  0.013661384582519531
local_in_edges_tensor generation:  0.015993833541870117
mini_batch_src_global generation:  0.03134298324584961
r_  generation:  0.24200105667114258
local_output_nid generation:  0.013084888458251953
local_in_edges_tensor generation:  0.018172025680541992
mini_batch_src_global generation:  0.029972553253173828
r_  generation:  0.23637676239013672
----------------------check_connections_block total spend ----------------------------- 5.53996729850769
generate_one_block  0.3110225200653076
generate_one_block  0.3069953918457031
generate_one_block  0.29950857162475586
generate_one_block  0.31037282943725586
generate_one_block  0.3065171241760254
generate_one_block  0.3054490089416504
generate_one_block  0.3383066654205322
generate_one_block  0.31076550483703613
generate_one_block  0.29795408248901367
generate_one_block  0.3048384189605713
generate_one_block  0.29531145095825195
generate_one_block  0.3126411437988281
generate_one_block  0.31798338890075684
generate_one_block  0.30290865898132324
generate_one_block  0.30652713775634766
generate_one_block  0.29963040351867676
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03658318519592285
gen group dst list time:  0.0681760311126709
time for parepare:  0.01784992218017578
local_output_nid generation:  0.027278900146484375
local_in_edges_tensor generation:  0.05006122589111328
mini_batch_src_global generation:  0.04027199745178223
r_  generation:  0.4494059085845947
local_output_nid generation:  0.029842138290405273
local_in_edges_tensor generation:  0.0386812686920166
mini_batch_src_global generation:  0.0533449649810791
r_  generation:  0.44977784156799316
local_output_nid generation:  0.030269145965576172
local_in_edges_tensor generation:  0.03990483283996582
mini_batch_src_global generation:  0.05331063270568848
r_  generation:  0.4599144458770752
local_output_nid generation:  0.03279590606689453
local_in_edges_tensor generation:  0.042842864990234375
mini_batch_src_global generation:  0.05509519577026367
r_  generation:  0.4682655334472656
local_output_nid generation:  0.0327610969543457
local_in_edges_tensor generation:  0.08334159851074219
mini_batch_src_global generation:  0.05619931221008301
r_  generation:  0.4634432792663574
local_output_nid generation:  0.0322265625
local_in_edges_tensor generation:  0.03484225273132324
mini_batch_src_global generation:  0.05513572692871094
r_  generation:  0.4549906253814697
local_output_nid generation:  0.0322728157043457
local_in_edges_tensor generation:  0.03701496124267578
mini_batch_src_global generation:  0.052599430084228516
r_  generation:  0.4654715061187744
local_output_nid generation:  0.03221535682678223
local_in_edges_tensor generation:  0.03275489807128906
mini_batch_src_global generation:  0.053060293197631836
r_  generation:  0.46886467933654785
local_output_nid generation:  0.032128334045410156
local_in_edges_tensor generation:  0.032853126525878906
mini_batch_src_global generation:  0.052475690841674805
r_  generation:  0.4749867916107178
local_output_nid generation:  0.03209257125854492
local_in_edges_tensor generation:  0.03237605094909668
mini_batch_src_global generation:  0.05383133888244629
r_  generation:  0.46579933166503906
local_output_nid generation:  0.03513622283935547
local_in_edges_tensor generation:  0.03506755828857422
mini_batch_src_global generation:  0.05253720283508301
r_  generation:  0.46378064155578613
local_output_nid generation:  0.03217816352844238
local_in_edges_tensor generation:  0.0346674919128418
mini_batch_src_global generation:  0.055570125579833984
r_  generation:  0.4600236415863037
local_output_nid generation:  0.03225851058959961
local_in_edges_tensor generation:  0.038651227951049805
mini_batch_src_global generation:  0.05318808555603027
r_  generation:  0.47020411491394043
local_output_nid generation:  0.03307771682739258
local_in_edges_tensor generation:  0.035807132720947266
mini_batch_src_global generation:  0.053891897201538086
r_  generation:  0.4679691791534424
local_output_nid generation:  0.03248000144958496
local_in_edges_tensor generation:  0.03285074234008789
mini_batch_src_global generation:  0.053139448165893555
r_  generation:  0.46836423873901367
local_output_nid generation:  0.03234243392944336
local_in_edges_tensor generation:  0.034142255783081055
mini_batch_src_global generation:  0.053971052169799805
r_  generation:  0.46413230895996094
----------------------check_connections_block total spend ----------------------------- 11.041683912277222
generate_one_block  0.5931603908538818
generate_one_block  0.584545373916626
generate_one_block  0.5884058475494385
generate_one_block  0.5872585773468018
generate_one_block  0.5800719261169434
generate_one_block  0.5924301147460938
generate_one_block  0.5781352519989014
generate_one_block  0.5893423557281494
generate_one_block  0.6489636898040771
generate_one_block  0.5900650024414062
generate_one_block  0.5991184711456299
generate_one_block  0.590416669845581
generate_one_block  0.5918102264404297
generate_one_block  0.5868527889251709
generate_one_block  0.6064169406890869
generate_one_block  0.5876381397247314
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11832571029663086  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

connection checking time:  16.581651210784912
block generation total time  14.421364068984985
average batch blocks generation time:  0.9013352543115616
block dataloader generation time/epoch 32.80825034777323
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09423637390136719  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7400970458984375  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0948019027709961  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7436637878417969  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09437179565429688  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7428512573242188  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09492111206054688  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7529768943786621  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09445619583129883  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7442512512207031  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0947713851928711  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7473716735839844  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09427595138549805  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7421388626098633  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09483814239501953  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7476358413696289  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09415483474731445  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7396087646484375  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09475231170654297  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7463431358337402  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09438800811767578  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7408018112182617  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09487247467041016  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.752199649810791  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09486150741577148  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7547092437744141  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09466361999511719  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7427024841308594  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09483575820922852  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7535271644592285  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0946664810180664  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7442269325256348  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06576301157474518 |0.013645261526107788 |0.003598228096961975 |9.079277515411377e-05 |0.0037077516317367554 |0.003124237060546875 |
----------------------------------------------------------pseudo_mini_loss sum 1.2720637321472168
Total (block generation + training)time/epoch 34.2310355981191
Training time/epoch 1.4532763957977295
Training time without block to device /epoch 1.2349522113800049
Training time without total dataloading part /epoch 0.12147259712219238
load block tensor time/epoch 1.0522081851959229
block to device time/epoch 0.2183241844177246
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 24 |
Number of nodes for computation during this epoch:  5210145
Number of first layer input nodes during this epoch:  2481028
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11792230606079102  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02095627784729004
range selection method range initialization spend 0.012616157531738281
time for parepare:  0.016306638717651367
local_output_nid generation:  0.001417398452758789
local_in_edges_tensor generation:  0.005654096603393555
mini_batch_src_global generation:  0.0017368793487548828
r_  generation:  0.021123886108398438
local_output_nid generation:  0.0015418529510498047
local_in_edges_tensor generation:  0.0009932518005371094
mini_batch_src_global generation:  0.002150297164916992
r_  generation:  0.02353644371032715
local_output_nid generation:  0.0015859603881835938
local_in_edges_tensor generation:  0.0009276866912841797
mini_batch_src_global generation:  0.0017147064208984375
r_  generation:  0.022136211395263672
local_output_nid generation:  0.0016329288482666016
local_in_edges_tensor generation:  0.0009691715240478516
mini_batch_src_global generation:  0.001760721206665039
r_  generation:  0.02196645736694336
local_output_nid generation:  0.0015938282012939453
local_in_edges_tensor generation:  0.0009465217590332031
mini_batch_src_global generation:  0.0017337799072265625
r_  generation:  0.0216219425201416
local_output_nid generation:  0.0015649795532226562
local_in_edges_tensor generation:  0.000942230224609375
mini_batch_src_global generation:  0.0017080307006835938
r_  generation:  0.022254467010498047
local_output_nid generation:  0.0015447139739990234
local_in_edges_tensor generation:  0.001043081283569336
mini_batch_src_global generation:  0.001733541488647461
r_  generation:  0.02209019660949707
local_output_nid generation:  0.001585245132446289
local_in_edges_tensor generation:  0.0012578964233398438
mini_batch_src_global generation:  0.00189208984375
r_  generation:  0.022523880004882812
local_output_nid generation:  0.0015952587127685547
local_in_edges_tensor generation:  0.0011277198791503906
mini_batch_src_global generation:  0.0017507076263427734
r_  generation:  0.02246880531311035
local_output_nid generation:  0.0015745162963867188
local_in_edges_tensor generation:  0.0010411739349365234
mini_batch_src_global generation:  0.0017790794372558594
r_  generation:  0.023055076599121094
local_output_nid generation:  0.00156402587890625
local_in_edges_tensor generation:  0.0009942054748535156
mini_batch_src_global generation:  0.001852273941040039
r_  generation:  0.022825002670288086
local_output_nid generation:  0.0017688274383544922
local_in_edges_tensor generation:  0.0009961128234863281
mini_batch_src_global generation:  0.0017914772033691406
r_  generation:  0.022713899612426758
local_output_nid generation:  0.0016062259674072266
local_in_edges_tensor generation:  0.0011262893676757812
mini_batch_src_global generation:  0.0017707347869873047
r_  generation:  0.021910429000854492
local_output_nid generation:  0.0016202926635742188
local_in_edges_tensor generation:  0.0009522438049316406
mini_batch_src_global generation:  0.0018396377563476562
r_  generation:  0.022168397903442383
local_output_nid generation:  0.0016791820526123047
local_in_edges_tensor generation:  0.00107574462890625
mini_batch_src_global generation:  0.0017917156219482422
r_  generation:  0.022810935974121094
local_output_nid generation:  0.0016465187072753906
local_in_edges_tensor generation:  0.0012586116790771484
mini_batch_src_global generation:  0.00396418571472168
r_  generation:  0.0227203369140625
----------------------check_connections_block total spend ----------------------------- 0.531325101852417
generate_one_block  0.03128695487976074
generate_one_block  0.033184051513671875
generate_one_block  0.03244900703430176
generate_one_block  0.03158283233642578
generate_one_block  0.03077220916748047
generate_one_block  0.03310894966125488
generate_one_block  0.03140091896057129
generate_one_block  0.0313868522644043
generate_one_block  0.031647443771362305
generate_one_block  0.03148245811462402
generate_one_block  0.03231239318847656
generate_one_block  0.031841278076171875
generate_one_block  0.030964374542236328
generate_one_block  0.03102874755859375
generate_one_block  0.03227639198303223
generate_one_block  0.03170657157897949
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.036435604095458984
gen group dst list time:  0.017537593841552734
time for parepare:  0.02059149742126465
local_output_nid generation:  0.007756471633911133
local_in_edges_tensor generation:  0.02136683464050293
mini_batch_src_global generation:  0.026118040084838867
r_  generation:  0.21614980697631836
local_output_nid generation:  0.011482477188110352
local_in_edges_tensor generation:  0.01630544662475586
mini_batch_src_global generation:  0.029112577438354492
r_  generation:  0.2309122085571289
local_output_nid generation:  0.012105464935302734
local_in_edges_tensor generation:  0.014264583587646484
mini_batch_src_global generation:  0.032332658767700195
r_  generation:  0.23442363739013672
local_output_nid generation:  0.012591838836669922
local_in_edges_tensor generation:  0.014577150344848633
mini_batch_src_global generation:  0.027981996536254883
r_  generation:  0.23268699645996094
local_output_nid generation:  0.012100696563720703
local_in_edges_tensor generation:  0.016275405883789062
mini_batch_src_global generation:  0.029660701751708984
r_  generation:  0.23050975799560547
local_output_nid generation:  0.012675046920776367
local_in_edges_tensor generation:  0.016547441482543945
mini_batch_src_global generation:  0.028467893600463867
r_  generation:  0.23175048828125
local_output_nid generation:  0.01284170150756836
local_in_edges_tensor generation:  0.013591289520263672
mini_batch_src_global generation:  0.028955936431884766
r_  generation:  0.2349700927734375
local_output_nid generation:  0.012865543365478516
local_in_edges_tensor generation:  0.014940261840820312
mini_batch_src_global generation:  0.02915215492248535
r_  generation:  0.23397541046142578
local_output_nid generation:  0.013148069381713867
local_in_edges_tensor generation:  0.014220714569091797
mini_batch_src_global generation:  0.029999971389770508
r_  generation:  0.2405376434326172
local_output_nid generation:  0.013211727142333984
local_in_edges_tensor generation:  0.013669490814208984
mini_batch_src_global generation:  0.029790639877319336
r_  generation:  0.24083566665649414
local_output_nid generation:  0.012637138366699219
local_in_edges_tensor generation:  0.014136075973510742
mini_batch_src_global generation:  0.03170299530029297
r_  generation:  0.2404313087463379
local_output_nid generation:  0.013169288635253906
local_in_edges_tensor generation:  0.01302957534790039
mini_batch_src_global generation:  0.029693603515625
r_  generation:  0.23833537101745605
local_output_nid generation:  0.012905359268188477
local_in_edges_tensor generation:  0.012941360473632812
mini_batch_src_global generation:  0.02946925163269043
r_  generation:  0.23404836654663086
local_output_nid generation:  0.013144254684448242
local_in_edges_tensor generation:  0.01247549057006836
mini_batch_src_global generation:  0.02890920639038086
r_  generation:  0.2322392463684082
local_output_nid generation:  0.013342142105102539
local_in_edges_tensor generation:  0.013347387313842773
mini_batch_src_global generation:  0.03068399429321289
r_  generation:  0.24372124671936035
local_output_nid generation:  0.013294696807861328
local_in_edges_tensor generation:  0.012823104858398438
mini_batch_src_global generation:  0.030146121978759766
r_  generation:  0.23754310607910156
----------------------check_connections_block total spend ----------------------------- 5.499858140945435
generate_one_block  0.30519962310791016
generate_one_block  0.31373143196105957
generate_one_block  0.30986976623535156
generate_one_block  0.3030514717102051
generate_one_block  0.29634833335876465
generate_one_block  0.3070712089538574
generate_one_block  0.3242924213409424
generate_one_block  0.3004264831542969
generate_one_block  0.31073999404907227
generate_one_block  0.3071584701538086
generate_one_block  0.3092806339263916
generate_one_block  0.3047490119934082
generate_one_block  0.2956867218017578
generate_one_block  0.2978227138519287
generate_one_block  0.30827903747558594
generate_one_block  0.3016343116760254
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04229879379272461
gen group dst list time:  0.06387996673583984
time for parepare:  0.018314123153686523
local_output_nid generation:  0.02463841438293457
local_in_edges_tensor generation:  0.04861044883728027
mini_batch_src_global generation:  0.04200911521911621
r_  generation:  0.4510617256164551
local_output_nid generation:  0.03054499626159668
local_in_edges_tensor generation:  0.03591108322143555
mini_batch_src_global generation:  0.054496049880981445
r_  generation:  0.45077991485595703
local_output_nid generation:  0.030395030975341797
local_in_edges_tensor generation:  0.03077101707458496
mini_batch_src_global generation:  0.051183223724365234
r_  generation:  0.4631211757659912
local_output_nid generation:  0.030704259872436523
local_in_edges_tensor generation:  0.030803203582763672
mini_batch_src_global generation:  0.05314135551452637
r_  generation:  0.45469164848327637
local_output_nid generation:  0.03046560287475586
local_in_edges_tensor generation:  0.07178616523742676
mini_batch_src_global generation:  0.05186796188354492
r_  generation:  0.46634769439697266
local_output_nid generation:  0.030910491943359375
local_in_edges_tensor generation:  0.029249191284179688
mini_batch_src_global generation:  0.05530595779418945
r_  generation:  0.4573831558227539
local_output_nid generation:  0.031229734420776367
local_in_edges_tensor generation:  0.03102707862854004
mini_batch_src_global generation:  0.05146598815917969
r_  generation:  0.46644139289855957
local_output_nid generation:  0.03085470199584961
local_in_edges_tensor generation:  0.03040933609008789
mini_batch_src_global generation:  0.05345606803894043
r_  generation:  0.45560622215270996
local_output_nid generation:  0.03130197525024414
local_in_edges_tensor generation:  0.03193020820617676
mini_batch_src_global generation:  0.051895856857299805
r_  generation:  0.47020840644836426
local_output_nid generation:  0.03128361701965332
local_in_edges_tensor generation:  0.03127288818359375
mini_batch_src_global generation:  0.05407595634460449
r_  generation:  0.45821356773376465
local_output_nid generation:  0.03154706954956055
local_in_edges_tensor generation:  0.028748750686645508
mini_batch_src_global generation:  0.051981449127197266
r_  generation:  0.4671926498413086
local_output_nid generation:  0.03146958351135254
local_in_edges_tensor generation:  0.03108668327331543
mini_batch_src_global generation:  0.05382895469665527
r_  generation:  0.46050333976745605
local_output_nid generation:  0.031159162521362305
local_in_edges_tensor generation:  0.029563188552856445
mini_batch_src_global generation:  0.05166769027709961
r_  generation:  0.4631922245025635
local_output_nid generation:  0.031325578689575195
local_in_edges_tensor generation:  0.0309293270111084
mini_batch_src_global generation:  0.05337214469909668
r_  generation:  0.45748090744018555
local_output_nid generation:  0.03160691261291504
local_in_edges_tensor generation:  0.03087162971496582
mini_batch_src_global generation:  0.05268573760986328
r_  generation:  0.4656815528869629
local_output_nid generation:  0.03307628631591797
local_in_edges_tensor generation:  0.03171110153198242
mini_batch_src_global generation:  0.05543208122253418
r_  generation:  0.45756053924560547
----------------------check_connections_block total spend ----------------------------- 10.874977588653564
generate_one_block  0.5847718715667725
generate_one_block  0.5849595069885254
generate_one_block  0.5807051658630371
generate_one_block  0.5795977115631104
generate_one_block  0.5809569358825684
generate_one_block  0.5828678607940674
generate_one_block  0.5850579738616943
generate_one_block  0.583564281463623
generate_one_block  0.6198439598083496
generate_one_block  0.5877676010131836
generate_one_block  0.5779428482055664
generate_one_block  0.5790586471557617
generate_one_block  0.5781509876251221
generate_one_block  0.5821936130523682
generate_one_block  0.5855803489685059
generate_one_block  0.5819027423858643
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11792230606079102  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

connection checking time:  16.374835729599
block generation total time  14.250263690948486
average batch blocks generation time:  0.8906414806842804
block dataloader generation time/epoch 32.80544500052929
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09453773498535156  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7440176010131836  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09489631652832031  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7522201538085938  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09464740753173828  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7515377998352051  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09476089477539062  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7416839599609375  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09419822692871094  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7397623062133789  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09462738037109375  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7444496154785156  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09448099136352539  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7438993453979492  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09470176696777344  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7431640625  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09471273422241211  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7528443336486816  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09479999542236328  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7482542991638184  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09451436996459961  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7496156692504883  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09473896026611328  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7439484596252441  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0941166877746582  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7349200248718262  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09460163116455078  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.741241455078125  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09456396102905273  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7485475540161133  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0946950912475586  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7430524826049805  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06491623818874359 |0.010008841753005981 |0.003582105040550232 |9.261071681976318e-05 |0.003733500838279724 |0.0012977123260498047 |
----------------------------------------------------------pseudo_mini_loss sum 1.262214183807373
Total (block generation + training)time/epoch 34.22554004192352
Training time/epoch 1.3795075416564941
Training time without block to device /epoch 1.2193660736083984
Training time without total dataloading part /epoch 0.11982917785644531
load block tensor time/epoch 1.0386598110198975
block to device time/epoch 0.1601414680480957
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 25 |
Number of nodes for computation during this epoch:  5206468
Number of first layer input nodes during this epoch:  2480997
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11802148818969727  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023439884185791016
range selection method range initialization spend 0.01221919059753418
time for parepare:  0.017638444900512695
local_output_nid generation:  0.0014636516571044922
local_in_edges_tensor generation:  0.0032241344451904297
mini_batch_src_global generation:  0.0018224716186523438
r_  generation:  0.021409988403320312
local_output_nid generation:  0.0016021728515625
local_in_edges_tensor generation:  0.0009725093841552734
mini_batch_src_global generation:  0.002061605453491211
r_  generation:  0.022383689880371094
local_output_nid generation:  0.0016415119171142578
local_in_edges_tensor generation:  0.000989675521850586
mini_batch_src_global generation:  0.0017578601837158203
r_  generation:  0.021716833114624023
local_output_nid generation:  0.0016126632690429688
local_in_edges_tensor generation:  0.0009720325469970703
mini_batch_src_global generation:  0.0017802715301513672
r_  generation:  0.021993637084960938
local_output_nid generation:  0.0015976428985595703
local_in_edges_tensor generation:  0.0009338855743408203
mini_batch_src_global generation:  0.0017788410186767578
r_  generation:  0.02160334587097168
local_output_nid generation:  0.0016856193542480469
local_in_edges_tensor generation:  0.0009725093841552734
mini_batch_src_global generation:  0.0017390251159667969
r_  generation:  0.02181243896484375
local_output_nid generation:  0.0016231536865234375
local_in_edges_tensor generation:  0.0009758472442626953
mini_batch_src_global generation:  0.001779317855834961
r_  generation:  0.022557973861694336
local_output_nid generation:  0.0018010139465332031
local_in_edges_tensor generation:  0.0009551048278808594
mini_batch_src_global generation:  0.0017673969268798828
r_  generation:  0.022222042083740234
local_output_nid generation:  0.0016112327575683594
local_in_edges_tensor generation:  0.001195669174194336
mini_batch_src_global generation:  0.0017757415771484375
r_  generation:  0.02158832550048828
local_output_nid generation:  0.0016415119171142578
local_in_edges_tensor generation:  0.0010488033294677734
mini_batch_src_global generation:  0.0021677017211914062
r_  generation:  0.022811412811279297
local_output_nid generation:  0.0016150474548339844
local_in_edges_tensor generation:  0.0009412765502929688
mini_batch_src_global generation:  0.0018024444580078125
r_  generation:  0.02213764190673828
local_output_nid generation:  0.0016243457794189453
local_in_edges_tensor generation:  0.0010943412780761719
mini_batch_src_global generation:  0.0018279552459716797
r_  generation:  0.022505760192871094
local_output_nid generation:  0.001630544662475586
local_in_edges_tensor generation:  0.0009572505950927734
mini_batch_src_global generation:  0.0018010139465332031
r_  generation:  0.02207803726196289
local_output_nid generation:  0.0016109943389892578
local_in_edges_tensor generation:  0.0009462833404541016
mini_batch_src_global generation:  0.0017170906066894531
r_  generation:  0.021996498107910156
local_output_nid generation:  0.0016205310821533203
local_in_edges_tensor generation:  0.0009293556213378906
mini_batch_src_global generation:  0.001758575439453125
r_  generation:  0.022449016571044922
local_output_nid generation:  0.0016100406646728516
local_in_edges_tensor generation:  0.0009479522705078125
mini_batch_src_global generation:  0.001750946044921875
r_  generation:  0.021431922912597656
----------------------check_connections_block total spend ----------------------------- 0.5246822834014893
generate_one_block  0.031029701232910156
generate_one_block  0.0315091609954834
generate_one_block  0.031540632247924805
generate_one_block  0.03183460235595703
generate_one_block  0.03110527992248535
generate_one_block  0.03289008140563965
generate_one_block  0.03175759315490723
generate_one_block  0.03104567527770996
generate_one_block  0.03042459487915039
generate_one_block  0.03196525573730469
generate_one_block  0.031101226806640625
generate_one_block  0.03170156478881836
generate_one_block  0.03147006034851074
generate_one_block  0.030797958374023438
generate_one_block  0.03167271614074707
generate_one_block  0.03084564208984375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03799247741699219
gen group dst list time:  0.018167495727539062
time for parepare:  0.019639253616333008
local_output_nid generation:  0.007824182510375977
local_in_edges_tensor generation:  0.024434328079223633
mini_batch_src_global generation:  0.02371072769165039
r_  generation:  0.22050237655639648
local_output_nid generation:  0.011199951171875
local_in_edges_tensor generation:  0.015773296356201172
mini_batch_src_global generation:  0.02893376350402832
r_  generation:  0.22117376327514648
local_output_nid generation:  0.011417150497436523
local_in_edges_tensor generation:  0.01494908332824707
mini_batch_src_global generation:  0.027599096298217773
r_  generation:  0.23065471649169922
local_output_nid generation:  0.012537240982055664
local_in_edges_tensor generation:  0.014426231384277344
mini_batch_src_global generation:  0.027634382247924805
r_  generation:  0.23346662521362305
local_output_nid generation:  0.012915849685668945
local_in_edges_tensor generation:  0.01385951042175293
mini_batch_src_global generation:  0.029442548751831055
r_  generation:  0.23657965660095215
local_output_nid generation:  0.01257181167602539
local_in_edges_tensor generation:  0.013120651245117188
mini_batch_src_global generation:  0.029317617416381836
r_  generation:  0.233428955078125
local_output_nid generation:  0.01296544075012207
local_in_edges_tensor generation:  0.013230085372924805
mini_batch_src_global generation:  0.02999091148376465
r_  generation:  0.23997139930725098
local_output_nid generation:  0.01295161247253418
local_in_edges_tensor generation:  0.015100717544555664
mini_batch_src_global generation:  0.02963566780090332
r_  generation:  0.23405098915100098
local_output_nid generation:  0.012691497802734375
local_in_edges_tensor generation:  0.01300954818725586
mini_batch_src_global generation:  0.02986598014831543
r_  generation:  0.23079681396484375
local_output_nid generation:  0.013153076171875
local_in_edges_tensor generation:  0.013549089431762695
mini_batch_src_global generation:  0.03019261360168457
r_  generation:  0.2416985034942627
local_output_nid generation:  0.012656688690185547
local_in_edges_tensor generation:  0.0162656307220459
mini_batch_src_global generation:  0.03035283088684082
r_  generation:  0.23849081993103027
local_output_nid generation:  0.01325082778930664
local_in_edges_tensor generation:  0.014569997787475586
mini_batch_src_global generation:  0.03019881248474121
r_  generation:  0.2413938045501709
local_output_nid generation:  0.013336658477783203
local_in_edges_tensor generation:  0.014524459838867188
mini_batch_src_global generation:  0.029843568801879883
r_  generation:  0.23699045181274414
local_output_nid generation:  0.013046503067016602
local_in_edges_tensor generation:  0.016717910766601562
mini_batch_src_global generation:  0.029628276824951172
r_  generation:  0.2365550994873047
local_output_nid generation:  0.01328897476196289
local_in_edges_tensor generation:  0.015339136123657227
mini_batch_src_global generation:  0.030324697494506836
r_  generation:  0.24015259742736816
local_output_nid generation:  0.012943267822265625
local_in_edges_tensor generation:  0.013218402862548828
mini_batch_src_global generation:  0.031167030334472656
r_  generation:  0.23318171501159668
----------------------check_connections_block total spend ----------------------------- 5.496521711349487
generate_one_block  0.3101322650909424
generate_one_block  0.2977170944213867
generate_one_block  0.3022329807281494
generate_one_block  0.3053598403930664
generate_one_block  0.30104494094848633
generate_one_block  0.3014211654663086
generate_one_block  0.3299703598022461
generate_one_block  0.30357885360717773
generate_one_block  0.29422950744628906
generate_one_block  0.3088226318359375
generate_one_block  0.30713391304016113
generate_one_block  0.3090388774871826
generate_one_block  0.307079553604126
generate_one_block  0.30379152297973633
generate_one_block  0.3084735870361328
generate_one_block  0.2916901111602783
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0371394157409668
gen group dst list time:  0.06436371803283691
time for parepare:  0.01814126968383789
local_output_nid generation:  0.024723529815673828
local_in_edges_tensor generation:  0.0470585823059082
mini_batch_src_global generation:  0.04058551788330078
r_  generation:  0.4555082321166992
local_output_nid generation:  0.030123472213745117
local_in_edges_tensor generation:  0.032156944274902344
mini_batch_src_global generation:  0.053696393966674805
r_  generation:  0.45756959915161133
local_output_nid generation:  0.03374624252319336
local_in_edges_tensor generation:  0.030176639556884766
mini_batch_src_global generation:  0.0539250373840332
r_  generation:  0.4582796096801758
local_output_nid generation:  0.03178739547729492
local_in_edges_tensor generation:  0.03341937065124512
mini_batch_src_global generation:  0.05304551124572754
r_  generation:  0.4506099224090576
local_output_nid generation:  0.03159618377685547
local_in_edges_tensor generation:  0.08295083045959473
mini_batch_src_global generation:  0.05404925346374512
r_  generation:  0.4645874500274658
local_output_nid generation:  0.03079962730407715
local_in_edges_tensor generation:  0.02965402603149414
mini_batch_src_global generation:  0.0537722110748291
r_  generation:  0.4539930820465088
local_output_nid generation:  0.030857086181640625
local_in_edges_tensor generation:  0.03026604652404785
mini_batch_src_global generation:  0.05378842353820801
r_  generation:  0.46322011947631836
local_output_nid generation:  0.031084299087524414
local_in_edges_tensor generation:  0.03006148338317871
mini_batch_src_global generation:  0.05345582962036133
r_  generation:  0.4572010040283203
local_output_nid generation:  0.03090691566467285
local_in_edges_tensor generation:  0.031957387924194336
mini_batch_src_global generation:  0.05425620079040527
r_  generation:  0.4653346538543701
local_output_nid generation:  0.03075861930847168
local_in_edges_tensor generation:  0.033771514892578125
mini_batch_src_global generation:  0.05375027656555176
r_  generation:  0.46056675910949707
local_output_nid generation:  0.03098320960998535
local_in_edges_tensor generation:  0.03626108169555664
mini_batch_src_global generation:  0.05207180976867676
r_  generation:  0.4668302536010742
local_output_nid generation:  0.03122544288635254
local_in_edges_tensor generation:  0.032645225524902344
mini_batch_src_global generation:  0.0609586238861084
r_  generation:  0.45960378646850586
local_output_nid generation:  0.031069278717041016
local_in_edges_tensor generation:  0.02972579002380371
mini_batch_src_global generation:  0.0516965389251709
r_  generation:  0.46579790115356445
local_output_nid generation:  0.031072139739990234
local_in_edges_tensor generation:  0.029654741287231445
mini_batch_src_global generation:  0.05347418785095215
r_  generation:  0.45856666564941406
local_output_nid generation:  0.0316166877746582
local_in_edges_tensor generation:  0.030239105224609375
mini_batch_src_global generation:  0.05138063430786133
r_  generation:  0.4651057720184326
local_output_nid generation:  0.031395912170410156
local_in_edges_tensor generation:  0.030332565307617188
mini_batch_src_global generation:  0.052886009216308594
r_  generation:  0.4537179470062256
----------------------check_connections_block total spend ----------------------------- 10.887755632400513
generate_one_block  0.5878074169158936
generate_one_block  0.5799455642700195
generate_one_block  0.582317590713501
generate_one_block  0.5824263095855713
generate_one_block  0.5844135284423828
generate_one_block  0.5765764713287354
generate_one_block  0.5819532871246338
generate_one_block  0.5844721794128418
generate_one_block  0.6387231349945068
generate_one_block  0.5875229835510254
generate_one_block  0.590435266494751
generate_one_block  0.591925859451294
generate_one_block  0.582442045211792
generate_one_block  0.5826904773712158
generate_one_block  0.5901036262512207
generate_one_block  0.5798466205596924
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11802148818969727  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

connection checking time:  16.38427734375
block generation total time  14.285319566726685
average batch blocks generation time:  0.8928324729204178
block dataloader generation time/epoch 32.80257649982677
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09461116790771484  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7521529197692871  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0946197509765625  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7407240867614746  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09453392028808594  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7475829124450684  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09478950500488281  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7455568313598633  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09453201293945312  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.746976375579834  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0946645736694336  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.742711067199707  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09442472457885742  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7453775405883789  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09472274780273438  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7432460784912109  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09430170059204102  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7427997589111328  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0949392318725586  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7530326843261719  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09461832046508789  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7450346946716309  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0949106216430664  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7544116973876953  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09454488754272461  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7469024658203125  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09473896026611328  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7428598403930664  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09463644027709961  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7525715827941895  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09447479248046875  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7357864379882812  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06511981785297394 |0.010072797536849976 |0.003601446747779846 |9.131431579589844e-05 |0.003744453191757202 |0.0016527175903320312 |
----------------------------------------------------------pseudo_mini_loss sum 1.2453185319900513
Total (block generation + training)time/epoch 34.22067415013033
Training time/epoch 1.3858575820922852
Training time without block to device /epoch 1.2246928215026855
Training time without total dataloading part /epoch 0.12064814567565918
load block tensor time/epoch 1.041917085647583
block to device time/epoch 0.1611647605895996
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 26 |
Number of nodes for computation during this epoch:  5210942
Number of first layer input nodes during this epoch:  2481070
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11740922927856445  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02060556411743164
range selection method range initialization spend 0.012401103973388672
time for parepare:  0.016365766525268555
local_output_nid generation:  0.0014562606811523438
local_in_edges_tensor generation:  0.006527423858642578
mini_batch_src_global generation:  0.0017724037170410156
r_  generation:  0.020668506622314453
local_output_nid generation:  0.0016257762908935547
local_in_edges_tensor generation:  0.0010595321655273438
mini_batch_src_global generation:  0.00202178955078125
r_  generation:  0.022505998611450195
local_output_nid generation:  0.0016083717346191406
local_in_edges_tensor generation:  0.0009684562683105469
mini_batch_src_global generation:  0.016167163848876953
r_  generation:  0.02345895767211914
local_output_nid generation:  0.001644134521484375
local_in_edges_tensor generation:  0.0009458065032958984
mini_batch_src_global generation:  0.0021414756774902344
r_  generation:  0.024192094802856445
local_output_nid generation:  0.0016355514526367188
local_in_edges_tensor generation:  0.0009312629699707031
mini_batch_src_global generation:  0.0021293163299560547
r_  generation:  0.023360252380371094
local_output_nid generation:  0.0016057491302490234
local_in_edges_tensor generation:  0.0009458065032958984
mini_batch_src_global generation:  0.0021829605102539062
r_  generation:  0.022853612899780273
local_output_nid generation:  0.0016047954559326172
local_in_edges_tensor generation:  0.0009753704071044922
mini_batch_src_global generation:  0.0017747879028320312
r_  generation:  0.022574663162231445
local_output_nid generation:  0.0015940666198730469
local_in_edges_tensor generation:  0.0009443759918212891
mini_batch_src_global generation:  0.0017936229705810547
r_  generation:  0.02237868309020996
local_output_nid generation:  0.0016002655029296875
local_in_edges_tensor generation:  0.0009586811065673828
mini_batch_src_global generation:  0.0017552375793457031
r_  generation:  0.034429311752319336
local_output_nid generation:  0.0027408599853515625
local_in_edges_tensor generation:  0.0015528202056884766
mini_batch_src_global generation:  0.0021331310272216797
r_  generation:  0.022457361221313477
local_output_nid generation:  0.001973867416381836
local_in_edges_tensor generation:  0.001134634017944336
mini_batch_src_global generation:  0.0018911361694335938
r_  generation:  0.021866798400878906
local_output_nid generation:  0.0019376277923583984
local_in_edges_tensor generation:  0.0010824203491210938
mini_batch_src_global generation:  0.0019130706787109375
r_  generation:  0.022378206253051758
local_output_nid generation:  0.00193023681640625
local_in_edges_tensor generation:  0.0010552406311035156
mini_batch_src_global generation:  0.0018992424011230469
r_  generation:  0.022789955139160156
local_output_nid generation:  0.0021390914916992188
local_in_edges_tensor generation:  0.0010790824890136719
mini_batch_src_global generation:  0.0033464431762695312
r_  generation:  0.025557518005371094
local_output_nid generation:  0.0016713142395019531
local_in_edges_tensor generation:  0.0009653568267822266
mini_batch_src_global generation:  0.002160787582397461
r_  generation:  0.02278447151184082
local_output_nid generation:  0.00164031982421875
local_in_edges_tensor generation:  0.0009138584136962891
mini_batch_src_global generation:  0.0017690658569335938
r_  generation:  0.021918058395385742
----------------------check_connections_block total spend ----------------------------- 0.5790483951568604
generate_one_block  0.030242204666137695
generate_one_block  0.031395673751831055
generate_one_block  0.03184914588928223
generate_one_block  0.03209400177001953
generate_one_block  0.031523704528808594
generate_one_block  0.034108638763427734
generate_one_block  0.03193807601928711
generate_one_block  0.03137040138244629
generate_one_block  0.031158924102783203
generate_one_block  0.03133201599121094
generate_one_block  0.031002283096313477
generate_one_block  0.031467437744140625
generate_one_block  0.03187394142150879
generate_one_block  0.0321502685546875
generate_one_block  0.0312039852142334
generate_one_block  0.03129291534423828
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.033315181732177734
gen group dst list time:  0.017612218856811523
time for parepare:  0.01951766014099121
local_output_nid generation:  0.00728917121887207
local_in_edges_tensor generation:  0.01861119270324707
mini_batch_src_global generation:  0.022204875946044922
r_  generation:  0.2123568058013916
local_output_nid generation:  0.011426448822021484
local_in_edges_tensor generation:  0.012585878372192383
mini_batch_src_global generation:  0.028839826583862305
r_  generation:  0.23134922981262207
local_output_nid generation:  0.012248039245605469
local_in_edges_tensor generation:  0.01723480224609375
mini_batch_src_global generation:  0.028226852416992188
r_  generation:  0.2362067699432373
local_output_nid generation:  0.013552665710449219
local_in_edges_tensor generation:  0.014846324920654297
mini_batch_src_global generation:  0.027818679809570312
r_  generation:  0.23982000350952148
local_output_nid generation:  0.012451648712158203
local_in_edges_tensor generation:  0.017772197723388672
mini_batch_src_global generation:  0.03510284423828125
r_  generation:  0.23600292205810547
local_output_nid generation:  0.013179779052734375
local_in_edges_tensor generation:  0.017794132232666016
mini_batch_src_global generation:  0.029677152633666992
r_  generation:  0.25101661682128906
local_output_nid generation:  0.015588521957397461
local_in_edges_tensor generation:  0.015799283981323242
mini_batch_src_global generation:  0.03021383285522461
r_  generation:  0.24343585968017578
local_output_nid generation:  0.01666116714477539
local_in_edges_tensor generation:  0.014313697814941406
mini_batch_src_global generation:  0.02975630760192871
r_  generation:  0.2367410659790039
local_output_nid generation:  0.013563394546508789
local_in_edges_tensor generation:  0.013074159622192383
mini_batch_src_global generation:  0.034564971923828125
r_  generation:  0.23465919494628906
local_output_nid generation:  0.013581275939941406
local_in_edges_tensor generation:  0.012415885925292969
mini_batch_src_global generation:  0.03315329551696777
r_  generation:  0.237715482711792
local_output_nid generation:  0.01331949234008789
local_in_edges_tensor generation:  0.012527942657470703
mini_batch_src_global generation:  0.029729604721069336
r_  generation:  0.23691606521606445
local_output_nid generation:  0.013761043548583984
local_in_edges_tensor generation:  0.013737201690673828
mini_batch_src_global generation:  0.03238701820373535
r_  generation:  0.24094223976135254
local_output_nid generation:  0.014211416244506836
local_in_edges_tensor generation:  0.01515650749206543
mini_batch_src_global generation:  0.03056502342224121
r_  generation:  0.24814581871032715
local_output_nid generation:  0.013830900192260742
local_in_edges_tensor generation:  0.013714075088500977
mini_batch_src_global generation:  0.030292987823486328
r_  generation:  0.2443404197692871
local_output_nid generation:  0.013683319091796875
local_in_edges_tensor generation:  0.015084266662597656
mini_batch_src_global generation:  0.03201150894165039
r_  generation:  0.2373671531677246
local_output_nid generation:  0.013654470443725586
local_in_edges_tensor generation:  0.01757979393005371
mini_batch_src_global generation:  0.029437541961669922
r_  generation:  0.2374250888824463
----------------------check_connections_block total spend ----------------------------- 5.593534708023071
generate_one_block  0.3094162940979004
generate_one_block  0.30498766899108887
generate_one_block  0.30802321434020996
generate_one_block  0.31310081481933594
generate_one_block  0.3043041229248047
generate_one_block  0.3178842067718506
generate_one_block  0.342632532119751
generate_one_block  0.3065214157104492
generate_one_block  0.301943302154541
generate_one_block  0.30153369903564453
generate_one_block  0.29824304580688477
generate_one_block  0.3052356243133545
generate_one_block  0.3140292167663574
generate_one_block  0.308957576751709
generate_one_block  0.30706191062927246
generate_one_block  0.29901123046875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.037639617919921875
gen group dst list time:  0.06481814384460449
time for parepare:  0.019764423370361328
local_output_nid generation:  0.025568008422851562
local_in_edges_tensor generation:  0.046555280685424805
mini_batch_src_global generation:  0.05120372772216797
r_  generation:  0.44720029830932617
local_output_nid generation:  0.0304262638092041
local_in_edges_tensor generation:  0.0346522331237793
mini_batch_src_global generation:  0.05781126022338867
r_  generation:  0.4502263069152832
local_output_nid generation:  0.03058767318725586
local_in_edges_tensor generation:  0.03081798553466797
mini_batch_src_global generation:  0.05383610725402832
r_  generation:  0.4623696804046631
local_output_nid generation:  0.03089761734008789
local_in_edges_tensor generation:  0.03610801696777344
mini_batch_src_global generation:  0.05721306800842285
r_  generation:  0.459475040435791
local_output_nid generation:  0.030734539031982422
local_in_edges_tensor generation:  0.07992219924926758
mini_batch_src_global generation:  0.05167198181152344
r_  generation:  0.46204304695129395
local_output_nid generation:  0.0316624641418457
local_in_edges_tensor generation:  0.030680418014526367
mini_batch_src_global generation:  0.055467844009399414
r_  generation:  0.45822763442993164
local_output_nid generation:  0.03097224235534668
local_in_edges_tensor generation:  0.03492569923400879
mini_batch_src_global generation:  0.054537057876586914
r_  generation:  0.4659864902496338
local_output_nid generation:  0.031072139739990234
local_in_edges_tensor generation:  0.03301262855529785
mini_batch_src_global generation:  0.05314970016479492
r_  generation:  0.4608173370361328
local_output_nid generation:  0.031759023666381836
local_in_edges_tensor generation:  0.035346031188964844
mini_batch_src_global generation:  0.053191423416137695
r_  generation:  0.46941256523132324
local_output_nid generation:  0.031137466430664062
local_in_edges_tensor generation:  0.03490781784057617
mini_batch_src_global generation:  0.06357336044311523
r_  generation:  0.4596059322357178
local_output_nid generation:  0.03326988220214844
local_in_edges_tensor generation:  0.029010772705078125
mini_batch_src_global generation:  0.05210733413696289
r_  generation:  0.46326279640197754
local_output_nid generation:  0.03196001052856445
local_in_edges_tensor generation:  0.03228259086608887
mini_batch_src_global generation:  0.05411982536315918
r_  generation:  0.4592444896697998
local_output_nid generation:  0.032459259033203125
local_in_edges_tensor generation:  0.02930903434753418
mini_batch_src_global generation:  0.052170753479003906
r_  generation:  0.46885037422180176
local_output_nid generation:  0.03216886520385742
local_in_edges_tensor generation:  0.03342866897583008
mini_batch_src_global generation:  0.05393528938293457
r_  generation:  0.46270060539245605
local_output_nid generation:  0.03218364715576172
local_in_edges_tensor generation:  0.029048442840576172
mini_batch_src_global generation:  0.052726030349731445
r_  generation:  0.4694836139678955
local_output_nid generation:  0.03234529495239258
local_in_edges_tensor generation:  0.031115293502807617
mini_batch_src_global generation:  0.053342580795288086
r_  generation:  0.461944580078125
----------------------check_connections_block total spend ----------------------------- 10.960244417190552
generate_one_block  0.5915465354919434
generate_one_block  0.6020755767822266
generate_one_block  0.591721773147583
generate_one_block  0.5932703018188477
generate_one_block  0.5825629234313965
generate_one_block  0.5859301090240479
generate_one_block  0.5936939716339111
generate_one_block  0.5768642425537109
generate_one_block  0.6177773475646973
generate_one_block  0.5814568996429443
generate_one_block  0.5793678760528564
generate_one_block  0.580542802810669
generate_one_block  0.5950777530670166
generate_one_block  0.5858221054077148
generate_one_block  0.5789368152618408
generate_one_block  0.582561731338501
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11740922927856445  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

connection checking time:  16.553779125213623
block generation total time  14.362094640731812
average batch blocks generation time:  0.8976309150457382
block dataloader generation time/epoch 32.81831838024987
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09424161911010742  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7410478591918945  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09468555450439453  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7433576583862305  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09447050094604492  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7443151473999023  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09486961364746094  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7520642280578613  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09422731399536133  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7418885231018066  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09489631652832031  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7512669563293457  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0945596694946289  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7505369186401367  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.094818115234375  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7449264526367188  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09445714950561523  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7424459457397461  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09470462799072266  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7422671318054199  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09449434280395508  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7425236701965332  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09479618072509766  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7470064163208008  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09480953216552734  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7550268173217773  GigaBytes
Max Memory Allocated: 0.844214916229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09483623504638672  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7506403923034668  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09425640106201172  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7402281761169434  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09464454650878906  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7453036308288574  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06527456641197205 |0.014166191220283508 |0.0035678595304489136 |8.980929851531982e-05 |0.0037336647510528564 |0.0014605522155761719 |
----------------------------------------------------------pseudo_mini_loss sum 1.2407361268997192
Total (block generation + training)time/epoch 34.23831771479713
Training time/epoch 1.4520540237426758
Training time without block to device /epoch 1.2253949642181396
Training time without total dataloading part /epoch 0.11972188949584961
load block tensor time/epoch 1.0443930625915527
block to device time/epoch 0.22665905952453613
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 27 |
Number of nodes for computation during this epoch:  5209445
Number of first layer input nodes during this epoch:  2480528
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11788129806518555  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02120375633239746
range selection method range initialization spend 0.012670755386352539
time for parepare:  0.0182192325592041
local_output_nid generation:  0.0014493465423583984
local_in_edges_tensor generation:  0.007458686828613281
mini_batch_src_global generation:  0.0017848014831542969
r_  generation:  0.021093130111694336
local_output_nid generation:  0.001577615737915039
local_in_edges_tensor generation:  0.0009748935699462891
mini_batch_src_global generation:  0.002155780792236328
r_  generation:  0.02346205711364746
local_output_nid generation:  0.0016014575958251953
local_in_edges_tensor generation:  0.0009539127349853516
mini_batch_src_global generation:  0.0016896724700927734
r_  generation:  0.02112102508544922
local_output_nid generation:  0.0016336441040039062
local_in_edges_tensor generation:  0.0010364055633544922
mini_batch_src_global generation:  0.0016434192657470703
r_  generation:  0.021109580993652344
local_output_nid generation:  0.0016520023345947266
local_in_edges_tensor generation:  0.0009279251098632812
mini_batch_src_global generation:  0.001775503158569336
r_  generation:  0.02228999137878418
local_output_nid generation:  0.0016107559204101562
local_in_edges_tensor generation:  0.0009350776672363281
mini_batch_src_global generation:  0.0017435550689697266
r_  generation:  0.022323131561279297
local_output_nid generation:  0.0016052722930908203
local_in_edges_tensor generation:  0.0009448528289794922
mini_batch_src_global generation:  0.0018193721771240234
r_  generation:  0.02260446548461914
local_output_nid generation:  0.0015773773193359375
local_in_edges_tensor generation:  0.0009808540344238281
mini_batch_src_global generation:  0.0017766952514648438
r_  generation:  0.022423267364501953
local_output_nid generation:  0.0016055107116699219
local_in_edges_tensor generation:  0.0009644031524658203
mini_batch_src_global generation:  0.0017724037170410156
r_  generation:  0.021933794021606445
local_output_nid generation:  0.001608133316040039
local_in_edges_tensor generation:  0.0009601116180419922
mini_batch_src_global generation:  0.001817464828491211
r_  generation:  0.02285146713256836
local_output_nid generation:  0.0017468929290771484
local_in_edges_tensor generation:  0.001018524169921875
mini_batch_src_global generation:  0.001897573471069336
r_  generation:  0.022768259048461914
local_output_nid generation:  0.001705169677734375
local_in_edges_tensor generation:  0.0010035037994384766
mini_batch_src_global generation:  0.0017895698547363281
r_  generation:  0.022760629653930664
local_output_nid generation:  0.0016672611236572266
local_in_edges_tensor generation:  0.0009677410125732422
mini_batch_src_global generation:  0.0017511844635009766
r_  generation:  0.021889209747314453
local_output_nid generation:  0.0016608238220214844
local_in_edges_tensor generation:  0.0009713172912597656
mini_batch_src_global generation:  0.0019104480743408203
r_  generation:  0.023204326629638672
local_output_nid generation:  0.0017046928405761719
local_in_edges_tensor generation:  0.0009431838989257812
mini_batch_src_global generation:  0.0017924308776855469
r_  generation:  0.022241830825805664
local_output_nid generation:  0.0016541481018066406
local_in_edges_tensor generation:  0.0009815692901611328
mini_batch_src_global generation:  0.0017359256744384766
r_  generation:  0.021872758865356445
----------------------check_connections_block total spend ----------------------------- 0.5290353298187256
generate_one_block  0.03398489952087402
generate_one_block  0.0322723388671875
generate_one_block  0.03032517433166504
generate_one_block  0.030136585235595703
generate_one_block  0.031606197357177734
generate_one_block  0.03379249572753906
generate_one_block  0.03230023384094238
generate_one_block  0.0313875675201416
generate_one_block  0.03083515167236328
generate_one_block  0.03192138671875
generate_one_block  0.03185844421386719
generate_one_block  0.03151273727416992
generate_one_block  0.030977487564086914
generate_one_block  0.03193783760070801
generate_one_block  0.031166553497314453
generate_one_block  0.031052350997924805
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03479194641113281
gen group dst list time:  0.021474361419677734
time for parepare:  0.02021479606628418
local_output_nid generation:  0.00764775276184082
local_in_edges_tensor generation:  0.020196199417114258
mini_batch_src_global generation:  0.02346348762512207
r_  generation:  0.21794819831848145
local_output_nid generation:  0.011687517166137695
local_in_edges_tensor generation:  0.015868186950683594
mini_batch_src_global generation:  0.02917933464050293
r_  generation:  0.22523117065429688
local_output_nid generation:  0.011260509490966797
local_in_edges_tensor generation:  0.01393437385559082
mini_batch_src_global generation:  0.027696847915649414
r_  generation:  0.22460389137268066
local_output_nid generation:  0.011742353439331055
local_in_edges_tensor generation:  0.012779951095581055
mini_batch_src_global generation:  0.02684807777404785
r_  generation:  0.223433256149292
local_output_nid generation:  0.012860536575317383
local_in_edges_tensor generation:  0.015372514724731445
mini_batch_src_global generation:  0.030626296997070312
r_  generation:  0.23956656455993652
local_output_nid generation:  0.012642145156860352
local_in_edges_tensor generation:  0.012318611145019531
mini_batch_src_global generation:  0.029027700424194336
r_  generation:  0.23007941246032715
local_output_nid generation:  0.013100862503051758
local_in_edges_tensor generation:  0.012898445129394531
mini_batch_src_global generation:  0.030381202697753906
r_  generation:  0.24151110649108887
local_output_nid generation:  0.013138055801391602
local_in_edges_tensor generation:  0.012623071670532227
mini_batch_src_global generation:  0.030076026916503906
r_  generation:  0.2372729778289795
local_output_nid generation:  0.013078927993774414
local_in_edges_tensor generation:  0.012680768966674805
mini_batch_src_global generation:  0.029654979705810547
r_  generation:  0.23752450942993164
local_output_nid generation:  0.013370990753173828
local_in_edges_tensor generation:  0.013701677322387695
mini_batch_src_global generation:  0.031247615814208984
r_  generation:  0.24167299270629883
local_output_nid generation:  0.013301849365234375
local_in_edges_tensor generation:  0.01400446891784668
mini_batch_src_global generation:  0.030683517456054688
r_  generation:  0.24425172805786133
local_output_nid generation:  0.013064861297607422
local_in_edges_tensor generation:  0.012881755828857422
mini_batch_src_global generation:  0.03019428253173828
r_  generation:  0.2381901741027832
local_output_nid generation:  0.013266801834106445
local_in_edges_tensor generation:  0.012775182723999023
mini_batch_src_global generation:  0.029942750930786133
r_  generation:  0.24025273323059082
local_output_nid generation:  0.013328075408935547
local_in_edges_tensor generation:  0.013144969940185547
mini_batch_src_global generation:  0.030156373977661133
r_  generation:  0.240830659866333
local_output_nid generation:  0.01324009895324707
local_in_edges_tensor generation:  0.012941122055053711
mini_batch_src_global generation:  0.030081987380981445
r_  generation:  0.23842382431030273
local_output_nid generation:  0.013000726699829102
local_in_edges_tensor generation:  0.012557029724121094
mini_batch_src_global generation:  0.028985023498535156
r_  generation:  0.23219752311706543
----------------------check_connections_block total spend ----------------------------- 5.4783148765563965
generate_one_block  0.3091459274291992
generate_one_block  0.3054802417755127
generate_one_block  0.2949683666229248
generate_one_block  0.29279541969299316
generate_one_block  0.31258678436279297
generate_one_block  0.2934393882751465
generate_one_block  0.32974791526794434
generate_one_block  0.30443429946899414
generate_one_block  0.29970359802246094
generate_one_block  0.30560827255249023
generate_one_block  0.3080904483795166
generate_one_block  0.300856351852417
generate_one_block  0.3015453815460205
generate_one_block  0.30660367012023926
generate_one_block  0.2978036403656006
generate_one_block  0.29412317276000977
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028594017028808594
gen group dst list time:  0.06302714347839355
time for parepare:  0.017629623413085938
local_output_nid generation:  0.02480006217956543
local_in_edges_tensor generation:  0.03536272048950195
mini_batch_src_global generation:  0.04182267189025879
r_  generation:  0.4491260051727295
local_output_nid generation:  0.0298764705657959
local_in_edges_tensor generation:  0.034987449645996094
mini_batch_src_global generation:  0.051766395568847656
r_  generation:  0.4458303451538086
local_output_nid generation:  0.030626535415649414
local_in_edges_tensor generation:  0.030521154403686523
mini_batch_src_global generation:  0.05277252197265625
r_  generation:  0.45922327041625977
local_output_nid generation:  0.03081965446472168
local_in_edges_tensor generation:  0.028490543365478516
mini_batch_src_global generation:  0.05198168754577637
r_  generation:  0.45436573028564453
local_output_nid generation:  0.03098154067993164
local_in_edges_tensor generation:  0.0726926326751709
mini_batch_src_global generation:  0.05155014991760254
r_  generation:  0.4648714065551758
local_output_nid generation:  0.03106522560119629
local_in_edges_tensor generation:  0.030917644500732422
mini_batch_src_global generation:  0.05256962776184082
r_  generation:  0.45672607421875
local_output_nid generation:  0.0317537784576416
local_in_edges_tensor generation:  0.030405759811401367
mini_batch_src_global generation:  0.05480003356933594
r_  generation:  0.46738362312316895
local_output_nid generation:  0.031572818756103516
local_in_edges_tensor generation:  0.029532909393310547
mini_batch_src_global generation:  0.05314922332763672
r_  generation:  0.45983433723449707
local_output_nid generation:  0.031130552291870117
local_in_edges_tensor generation:  0.030606985092163086
mini_batch_src_global generation:  0.0530240535736084
r_  generation:  0.4647343158721924
local_output_nid generation:  0.03176426887512207
local_in_edges_tensor generation:  0.031010866165161133
mini_batch_src_global generation:  0.05446004867553711
r_  generation:  0.4567444324493408
local_output_nid generation:  0.03162789344787598
local_in_edges_tensor generation:  0.03062915802001953
mini_batch_src_global generation:  0.0536198616027832
r_  generation:  0.4683356285095215
local_output_nid generation:  0.03154611587524414
local_in_edges_tensor generation:  0.029317140579223633
mini_batch_src_global generation:  0.054505109786987305
r_  generation:  0.45618677139282227
local_output_nid generation:  0.03134918212890625
local_in_edges_tensor generation:  0.0283811092376709
mini_batch_src_global generation:  0.05296659469604492
r_  generation:  0.4614222049713135
local_output_nid generation:  0.03154754638671875
local_in_edges_tensor generation:  0.030430316925048828
mini_batch_src_global generation:  0.0563664436340332
r_  generation:  0.45802760124206543
local_output_nid generation:  0.031586408615112305
local_in_edges_tensor generation:  0.02864360809326172
mini_batch_src_global generation:  0.05253481864929199
r_  generation:  0.466886043548584
local_output_nid generation:  0.03138399124145508
local_in_edges_tensor generation:  0.030053377151489258
mini_batch_src_global generation:  0.05411267280578613
r_  generation:  0.46038222312927246
----------------------check_connections_block total spend ----------------------------- 10.843791007995605
generate_one_block  0.578132152557373
generate_one_block  0.5820930004119873
generate_one_block  0.5858407020568848
generate_one_block  0.5841071605682373
generate_one_block  0.5873839855194092
generate_one_block  0.5866191387176514
generate_one_block  0.5876784324645996
generate_one_block  0.5901086330413818
generate_one_block  0.6367976665496826
generate_one_block  0.5863950252532959
generate_one_block  0.587822437286377
generate_one_block  0.5957639217376709
generate_one_block  0.5828733444213867
generate_one_block  0.5878403186798096
generate_one_block  0.5852470397949219
generate_one_block  0.5881061553955078
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11788129806518555  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

connection checking time:  16.322105884552002
block generation total time  14.28974199295044
average batch blocks generation time:  0.8931088745594025
block dataloader generation time/epoch 32.814525980698434
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09455108642578125  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7476019859313965  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09479331970214844  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7460284233093262  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09428215026855469  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7395610809326172  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09454917907714844  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.739229679107666  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09455013275146484  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.749596118927002  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09461021423339844  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7421221733093262  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09461307525634766  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7516865730285645  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09479236602783203  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7473282814025879  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09437942504882812  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7425036430358887  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09486770629882812  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7508301734924316  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09469747543334961  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7483549118041992  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0947580337524414  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7435836791992188  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09452152252197266  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7438511848449707  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09484386444091797  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7506570816040039  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09447622299194336  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7463021278381348  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0945425033569336  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7417101860046387  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06530231237411499 |0.01325465738773346 |0.0035781264305114746 |8.971989154815674e-05 |0.0037891268730163574 |0.0017442703247070312 |
----------------------------------------------------------pseudo_mini_loss sum 1.228554129600525
Total (block generation + training)time/epoch 34.235596317993966
Training time/epoch 1.4400708675384521
Training time without block to device /epoch 1.2279963493347168
Training time without total dataloading part /epoch 0.12105584144592285
load block tensor time/epoch 1.0448369979858398
block to device time/epoch 0.21207451820373535
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 28 |
Number of nodes for computation during this epoch:  5210297
Number of first layer input nodes during this epoch:  2481223
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11756467819213867  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02404642105102539
range selection method range initialization spend 0.012144804000854492
time for parepare:  0.01638007164001465
local_output_nid generation:  0.0014851093292236328
local_in_edges_tensor generation:  0.0040323734283447266
mini_batch_src_global generation:  0.0018427371978759766
r_  generation:  0.02133917808532715
local_output_nid generation:  0.0016384124755859375
local_in_edges_tensor generation:  0.0009946823120117188
mini_batch_src_global generation:  0.002112865447998047
r_  generation:  0.022992849349975586
local_output_nid generation:  0.0016012191772460938
local_in_edges_tensor generation:  0.0009500980377197266
mini_batch_src_global generation:  0.001722097396850586
r_  generation:  0.021404027938842773
local_output_nid generation:  0.0016314983367919922
local_in_edges_tensor generation:  0.0009627342224121094
mini_batch_src_global generation:  0.001844167709350586
r_  generation:  0.02185368537902832
local_output_nid generation:  0.0016148090362548828
local_in_edges_tensor generation:  0.0009438991546630859
mini_batch_src_global generation:  0.0017387866973876953
r_  generation:  0.02133035659790039
local_output_nid generation:  0.0016186237335205078
local_in_edges_tensor generation:  0.0009400844573974609
mini_batch_src_global generation:  0.0018036365509033203
r_  generation:  0.021916866302490234
local_output_nid generation:  0.001619577407836914
local_in_edges_tensor generation:  0.0009369850158691406
mini_batch_src_global generation:  0.0018362998962402344
r_  generation:  0.022989988327026367
local_output_nid generation:  0.001619577407836914
local_in_edges_tensor generation:  0.0009627342224121094
mini_batch_src_global generation:  0.0018246173858642578
r_  generation:  0.021993398666381836
local_output_nid generation:  0.0016326904296875
local_in_edges_tensor generation:  0.0009462833404541016
mini_batch_src_global generation:  0.0018465518951416016
r_  generation:  0.02248358726501465
local_output_nid generation:  0.0016245841979980469
local_in_edges_tensor generation:  0.0009417533874511719
mini_batch_src_global generation:  0.0018641948699951172
r_  generation:  0.022377729415893555
local_output_nid generation:  0.0016112327575683594
local_in_edges_tensor generation:  0.0009918212890625
mini_batch_src_global generation:  0.0018587112426757812
r_  generation:  0.022207021713256836
local_output_nid generation:  0.001661062240600586
local_in_edges_tensor generation:  0.0009427070617675781
mini_batch_src_global generation:  0.0018057823181152344
r_  generation:  0.022088050842285156
local_output_nid generation:  0.0016753673553466797
local_in_edges_tensor generation:  0.0009593963623046875
mini_batch_src_global generation:  0.0017714500427246094
r_  generation:  0.02216958999633789
local_output_nid generation:  0.0015974044799804688
local_in_edges_tensor generation:  0.0009322166442871094
mini_batch_src_global generation:  0.0018355846405029297
r_  generation:  0.02266693115234375
local_output_nid generation:  0.0016701221466064453
local_in_edges_tensor generation:  0.0009517669677734375
mini_batch_src_global generation:  0.0018029212951660156
r_  generation:  0.021956920623779297
local_output_nid generation:  0.0015981197357177734
local_in_edges_tensor generation:  0.0009381771087646484
mini_batch_src_global generation:  0.001786947250366211
r_  generation:  0.02294301986694336
----------------------check_connections_block total spend ----------------------------- 0.522705078125
generate_one_block  0.031084775924682617
generate_one_block  0.031944990158081055
generate_one_block  0.030741453170776367
generate_one_block  0.031499385833740234
generate_one_block  0.03059077262878418
generate_one_block  0.03307080268859863
generate_one_block  0.0320439338684082
generate_one_block  0.030915021896362305
generate_one_block  0.031683921813964844
generate_one_block  0.03146100044250488
generate_one_block  0.03139233589172363
generate_one_block  0.031058311462402344
generate_one_block  0.031151771545410156
generate_one_block  0.03201127052307129
generate_one_block  0.03111886978149414
generate_one_block  0.03248262405395508
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.042531728744506836
gen group dst list time:  0.01773810386657715
time for parepare:  0.019651174545288086
local_output_nid generation:  0.007565736770629883
local_in_edges_tensor generation:  0.018483400344848633
mini_batch_src_global generation:  0.027699947357177734
r_  generation:  0.22136616706848145
local_output_nid generation:  0.012558460235595703
local_in_edges_tensor generation:  0.015900135040283203
mini_batch_src_global generation:  0.03465723991394043
r_  generation:  0.23041892051696777
local_output_nid generation:  0.011927127838134766
local_in_edges_tensor generation:  0.015105962753295898
mini_batch_src_global generation:  0.02697134017944336
r_  generation:  0.22543573379516602
local_output_nid generation:  0.012933492660522461
local_in_edges_tensor generation:  0.012549161911010742
mini_batch_src_global generation:  0.02773761749267578
r_  generation:  0.23464155197143555
local_output_nid generation:  0.012628555297851562
local_in_edges_tensor generation:  0.0123748779296875
mini_batch_src_global generation:  0.028439760208129883
r_  generation:  0.22658658027648926
local_output_nid generation:  0.01291346549987793
local_in_edges_tensor generation:  0.012555837631225586
mini_batch_src_global generation:  0.030057191848754883
r_  generation:  0.23368525505065918
local_output_nid generation:  0.013390541076660156
local_in_edges_tensor generation:  0.015654802322387695
mini_batch_src_global generation:  0.029723644256591797
r_  generation:  0.23842215538024902
local_output_nid generation:  0.013148069381713867
local_in_edges_tensor generation:  0.012821197509765625
mini_batch_src_global generation:  0.029529571533203125
r_  generation:  0.23226451873779297
local_output_nid generation:  0.013479948043823242
local_in_edges_tensor generation:  0.012791633605957031
mini_batch_src_global generation:  0.031705617904663086
r_  generation:  0.23971986770629883
local_output_nid generation:  0.01337575912475586
local_in_edges_tensor generation:  0.012805938720703125
mini_batch_src_global generation:  0.02948141098022461
r_  generation:  0.2359943389892578
local_output_nid generation:  0.013016939163208008
local_in_edges_tensor generation:  0.013757944107055664
mini_batch_src_global generation:  0.03107929229736328
r_  generation:  0.23784708976745605
local_output_nid generation:  0.013398408889770508
local_in_edges_tensor generation:  0.012882232666015625
mini_batch_src_global generation:  0.029635906219482422
r_  generation:  0.23825693130493164
local_output_nid generation:  0.01360321044921875
local_in_edges_tensor generation:  0.013746023178100586
mini_batch_src_global generation:  0.031070232391357422
r_  generation:  0.2405109405517578
local_output_nid generation:  0.013735532760620117
local_in_edges_tensor generation:  0.013133049011230469
mini_batch_src_global generation:  0.03022313117980957
r_  generation:  0.2411363124847412
local_output_nid generation:  0.013494014739990234
local_in_edges_tensor generation:  0.013178586959838867
mini_batch_src_global generation:  0.030029773712158203
r_  generation:  0.23369407653808594
local_output_nid generation:  0.013736486434936523
local_in_edges_tensor generation:  0.013497352600097656
mini_batch_src_global generation:  0.030537128448486328
r_  generation:  0.24220800399780273
----------------------check_connections_block total spend ----------------------------- 5.497804641723633
generate_one_block  0.3078601360321045
generate_one_block  0.3072793483734131
generate_one_block  0.2959024906158447
generate_one_block  0.3011319637298584
generate_one_block  0.288921594619751
generate_one_block  0.29794883728027344
generate_one_block  0.3308396339416504
generate_one_block  0.29784536361694336
generate_one_block  0.3050870895385742
generate_one_block  0.3003816604614258
generate_one_block  0.30056285858154297
generate_one_block  0.3045969009399414
generate_one_block  0.30479860305786133
generate_one_block  0.313244104385376
generate_one_block  0.29677581787109375
generate_one_block  0.310314416885376
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03346681594848633
gen group dst list time:  0.06352019309997559
time for parepare:  0.01819443702697754
local_output_nid generation:  0.02508068084716797
local_in_edges_tensor generation:  0.04166054725646973
mini_batch_src_global generation:  0.04308438301086426
r_  generation:  0.4516003131866455
local_output_nid generation:  0.029921293258666992
local_in_edges_tensor generation:  0.039216041564941406
mini_batch_src_global generation:  0.054326534271240234
r_  generation:  0.4483623504638672
local_output_nid generation:  0.030379295349121094
local_in_edges_tensor generation:  0.03319501876831055
mini_batch_src_global generation:  0.05342411994934082
r_  generation:  0.45972561836242676
local_output_nid generation:  0.030991315841674805
local_in_edges_tensor generation:  0.03537154197692871
mini_batch_src_global generation:  0.05227327346801758
r_  generation:  0.45392560958862305
local_output_nid generation:  0.0311586856842041
local_in_edges_tensor generation:  0.07612061500549316
mini_batch_src_global generation:  0.05163860321044922
r_  generation:  0.46080899238586426
local_output_nid generation:  0.03093576431274414
local_in_edges_tensor generation:  0.03413987159729004
mini_batch_src_global generation:  0.0547335147857666
r_  generation:  0.4567859172821045
local_output_nid generation:  0.03136134147644043
local_in_edges_tensor generation:  0.03418111801147461
mini_batch_src_global generation:  0.054666757583618164
r_  generation:  0.47237110137939453
local_output_nid generation:  0.03135418891906738
local_in_edges_tensor generation:  0.03398299217224121
mini_batch_src_global generation:  0.05394315719604492
r_  generation:  0.45633649826049805
local_output_nid generation:  0.03139185905456543
local_in_edges_tensor generation:  0.03261685371398926
mini_batch_src_global generation:  0.052199602127075195
r_  generation:  0.4642159938812256
local_output_nid generation:  0.03149819374084473
local_in_edges_tensor generation:  0.03432130813598633
mini_batch_src_global generation:  0.05363011360168457
r_  generation:  0.46134209632873535
local_output_nid generation:  0.03152203559875488
local_in_edges_tensor generation:  0.036832571029663086
mini_batch_src_global generation:  0.05182003974914551
r_  generation:  0.4655890464782715
local_output_nid generation:  0.031374216079711914
local_in_edges_tensor generation:  0.03642463684082031
mini_batch_src_global generation:  0.05307483673095703
r_  generation:  0.46057891845703125
local_output_nid generation:  0.03189969062805176
local_in_edges_tensor generation:  0.03594374656677246
mini_batch_src_global generation:  0.05235433578491211
r_  generation:  0.471951961517334
local_output_nid generation:  0.03186535835266113
local_in_edges_tensor generation:  0.03408956527709961
mini_batch_src_global generation:  0.053481101989746094
r_  generation:  0.4619109630584717
local_output_nid generation:  0.031384944915771484
local_in_edges_tensor generation:  0.032157182693481445
mini_batch_src_global generation:  0.05353212356567383
r_  generation:  0.46465539932250977
local_output_nid generation:  0.031839847564697266
local_in_edges_tensor generation:  0.032714128494262695
mini_batch_src_global generation:  0.05586123466491699
r_  generation:  0.4648585319519043
----------------------check_connections_block total spend ----------------------------- 10.941314458847046
generate_one_block  0.5804274082183838
generate_one_block  0.5830996036529541
generate_one_block  0.5766177177429199
generate_one_block  0.586249828338623
generate_one_block  0.576143741607666
generate_one_block  0.5792617797851562
generate_one_block  0.5853745937347412
generate_one_block  0.5763740539550781
generate_one_block  0.6147191524505615
generate_one_block  0.5882399082183838
generate_one_block  0.5897176265716553
generate_one_block  0.5863900184631348
generate_one_block  0.5860888957977295
generate_one_block  0.6034910678863525
generate_one_block  0.583472728729248
generate_one_block  0.591754674911499
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.11756467819213867  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

connection checking time:  16.43911910057068
block generation total time  14.250913619995117
average batch blocks generation time:  0.8906821012496948
block dataloader generation time/epoch 32.81473898887634
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09455108642578125  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7504568099975586  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09486770629882812  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7484188079833984  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09423208236694336  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.740015983581543  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09483814239501953  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7486295700073242  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09412240982055664  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7378964424133301  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09469985961914062  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7433133125305176  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.0946817398071289  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7513699531555176  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09463310241699219  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7410550117492676  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09452247619628906  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7459306716918945  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09473133087158203  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7456455230712891  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09447050094604492  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7465534210205078  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09475326538085938  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7433462142944336  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09449911117553711  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7464842796325684  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09492301940917969  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7529239654541016  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09421920776367188  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7415051460266113  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.09493064880371094  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.7517342567443848  GigaBytes
Max Memory Allocated: 0.8442668914794922  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06566523015499115 |0.012758880853652954 |0.0035898685455322266 |9.065866470336914e-05 |0.0037405192852020264 |0.0030689239501953125 |
----------------------------------------------------------pseudo_mini_loss sum 1.2168503999710083
Total (block generation + training)time/epoch 34.23668862581253
Training time/epoch 1.4384222030639648
Training time without block to device /epoch 1.2342801094055176
Training time without total dataloading part /epoch 0.12180566787719727
load block tensor time/epoch 1.0506436824798584
block to device time/epoch 0.20414209365844727
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 29 |
Number of nodes for computation during this epoch:  5208433
Number of first layer input nodes during this epoch:  2480375
