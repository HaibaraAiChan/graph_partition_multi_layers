Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1647775884.565201
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02767205238342285
range selection method range initialization spend 0.013453960418701172
time for parepare:  0.01829981803894043
local_output_nid generation:  0.0013401508331298828
local_in_edges_tensor generation:  0.0041196346282958984
mini_batch_src_global generation:  0.0019516944885253906
r_  generation:  0.020493030548095703
local_output_nid generation:  0.001434326171875
local_in_edges_tensor generation:  0.0009551048278808594
mini_batch_src_global generation:  0.002459287643432617
r_  generation:  0.02097010612487793
local_output_nid generation:  0.001468658447265625
local_in_edges_tensor generation:  0.0008974075317382812
mini_batch_src_global generation:  0.0015685558319091797
r_  generation:  0.019821643829345703
local_output_nid generation:  0.0015420913696289062
local_in_edges_tensor generation:  0.0008492469787597656
mini_batch_src_global generation:  0.0015645027160644531
r_  generation:  0.020364046096801758
local_output_nid generation:  0.0014941692352294922
local_in_edges_tensor generation:  0.0008625984191894531
mini_batch_src_global generation:  0.0016148090362548828
r_  generation:  0.020859479904174805
local_output_nid generation:  0.0014834403991699219
local_in_edges_tensor generation:  0.0008883476257324219
mini_batch_src_global generation:  0.0016295909881591797
r_  generation:  0.021401405334472656
local_output_nid generation:  0.001493692398071289
local_in_edges_tensor generation:  0.0009002685546875
mini_batch_src_global generation:  0.0017132759094238281
r_  generation:  0.02179241180419922
local_output_nid generation:  0.0015053749084472656
local_in_edges_tensor generation:  0.0008792877197265625
mini_batch_src_global generation:  0.0016677379608154297
r_  generation:  0.020832538604736328
local_output_nid generation:  0.0015223026275634766
local_in_edges_tensor generation:  0.0008544921875
mini_batch_src_global generation:  0.0016453266143798828
r_  generation:  0.021579742431640625
local_output_nid generation:  0.0015213489532470703
local_in_edges_tensor generation:  0.0008981227874755859
mini_batch_src_global generation:  0.0017137527465820312
r_  generation:  0.02108025550842285
local_output_nid generation:  0.0015075206756591797
local_in_edges_tensor generation:  0.0008602142333984375
mini_batch_src_global generation:  0.0016961097717285156
r_  generation:  0.021515607833862305
local_output_nid generation:  0.0015273094177246094
local_in_edges_tensor generation:  0.000885009765625
mini_batch_src_global generation:  0.0017275810241699219
r_  generation:  0.02180624008178711
local_output_nid generation:  0.0015347003936767578
local_in_edges_tensor generation:  0.0008838176727294922
mini_batch_src_global generation:  0.0017292499542236328
r_  generation:  0.021710872650146484
local_output_nid generation:  0.0015099048614501953
local_in_edges_tensor generation:  0.0008471012115478516
mini_batch_src_global generation:  0.001775503158569336
r_  generation:  0.021533727645874023
local_output_nid generation:  0.0015177726745605469
local_in_edges_tensor generation:  0.0008935928344726562
mini_batch_src_global generation:  0.0017247200012207031
r_  generation:  0.021964311599731445
local_output_nid generation:  0.0015399456024169922
local_in_edges_tensor generation:  0.0008802413940429688
mini_batch_src_global generation:  0.0016627311706542969
r_  generation:  0.021869897842407227
----------------------check_connections_block total spend ----------------------------- 0.5015630722045898
generate_one_block  0.030362844467163086
generate_one_block  0.031740665435791016
generate_one_block  0.03181648254394531
generate_one_block  0.031164169311523438
generate_one_block  0.031713008880615234
generate_one_block  0.03144359588623047
generate_one_block  0.03163313865661621
generate_one_block  0.030328750610351562
generate_one_block  0.03154277801513672
generate_one_block  0.031235218048095703
generate_one_block  0.03140401840209961
generate_one_block  0.031995296478271484
generate_one_block  0.031455039978027344
generate_one_block  0.03155994415283203
generate_one_block  0.03206467628479004
generate_one_block  0.03192138671875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04269576072692871
gen group dst list time:  0.020601987838745117
time for parepare:  0.020252227783203125
local_output_nid generation:  0.007544755935668945
local_in_edges_tensor generation:  0.01970386505126953
mini_batch_src_global generation:  0.025246858596801758
r_  generation:  0.2557961940765381
local_output_nid generation:  0.014084339141845703
local_in_edges_tensor generation:  0.02302241325378418
mini_batch_src_global generation:  0.032788991928100586
r_  generation:  0.27116990089416504
local_output_nid generation:  0.014341354370117188
local_in_edges_tensor generation:  0.015850305557250977
mini_batch_src_global generation:  0.031134843826293945
r_  generation:  0.26460695266723633
local_output_nid generation:  0.01499485969543457
local_in_edges_tensor generation:  0.015801668167114258
mini_batch_src_global generation:  0.03191804885864258
r_  generation:  0.2674715518951416
local_output_nid generation:  0.015297889709472656
local_in_edges_tensor generation:  0.018786907196044922
mini_batch_src_global generation:  0.03347945213317871
r_  generation:  0.2749521732330322
local_output_nid generation:  0.015472173690795898
local_in_edges_tensor generation:  0.01877760887145996
mini_batch_src_global generation:  0.034027099609375
r_  generation:  0.27297186851501465
local_output_nid generation:  0.015642881393432617
local_in_edges_tensor generation:  0.01452779769897461
mini_batch_src_global generation:  0.03479933738708496
r_  generation:  0.27590298652648926
local_output_nid generation:  0.015563726425170898
local_in_edges_tensor generation:  0.015696287155151367
mini_batch_src_global generation:  0.03768491744995117
r_  generation:  0.27197742462158203
local_output_nid generation:  0.015428304672241211
local_in_edges_tensor generation:  0.019187211990356445
mini_batch_src_global generation:  0.03365898132324219
r_  generation:  0.2705988883972168
local_output_nid generation:  0.015620231628417969
local_in_edges_tensor generation:  0.014592170715332031
mini_batch_src_global generation:  0.03395223617553711
r_  generation:  0.2771735191345215
local_output_nid generation:  0.01600170135498047
local_in_edges_tensor generation:  0.016991138458251953
mini_batch_src_global generation:  0.03433036804199219
r_  generation:  0.27329540252685547
local_output_nid generation:  0.016082286834716797
local_in_edges_tensor generation:  0.019247055053710938
mini_batch_src_global generation:  0.03481459617614746
r_  generation:  0.2860531806945801
local_output_nid generation:  0.015930652618408203
local_in_edges_tensor generation:  0.017338037490844727
mini_batch_src_global generation:  0.034909963607788086
r_  generation:  0.2756011486053467
local_output_nid generation:  0.016071796417236328
local_in_edges_tensor generation:  0.016506433486938477
mini_batch_src_global generation:  0.03512740135192871
r_  generation:  0.2814781665802002
local_output_nid generation:  0.016356706619262695
local_in_edges_tensor generation:  0.01938152313232422
mini_batch_src_global generation:  0.03492259979248047
r_  generation:  0.2771337032318115
local_output_nid generation:  0.016103506088256836
local_in_edges_tensor generation:  0.01900196075439453
mini_batch_src_global generation:  0.03497886657714844
r_  generation:  0.28024768829345703
----------------------check_connections_block total spend ----------------------------- 6.381981611251831
generate_one_block  0.35922813415527344
generate_one_block  0.37012314796447754
generate_one_block  0.3481433391571045
generate_one_block  0.34900522232055664
generate_one_block  0.3661384582519531
generate_one_block  0.3562338352203369
generate_one_block  0.36368894577026367
generate_one_block  0.3465287685394287
generate_one_block  0.34798264503479004
generate_one_block  0.35272717475891113
generate_one_block  0.36168813705444336
generate_one_block  0.36240506172180176
generate_one_block  0.36106395721435547
generate_one_block  0.350954532623291
generate_one_block  0.3658764362335205
generate_one_block  0.3684539794921875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.055525779724121094
gen group dst list time:  0.0692451000213623
time for parepare:  0.02389669418334961
local_output_nid generation:  0.02537822723388672
local_in_edges_tensor generation:  0.06257081031799316
mini_batch_src_global generation:  0.04410815238952637
r_  generation:  0.46906423568725586
local_output_nid generation:  0.031679630279541016
local_in_edges_tensor generation:  0.0467228889465332
mini_batch_src_global generation:  0.055684804916381836
r_  generation:  0.48374247550964355
local_output_nid generation:  0.033823490142822266
local_in_edges_tensor generation:  0.03793931007385254
mini_batch_src_global generation:  0.05431842803955078
r_  generation:  0.48177003860473633
local_output_nid generation:  0.03254199028015137
local_in_edges_tensor generation:  0.03529667854309082
mini_batch_src_global generation:  0.05188488960266113
r_  generation:  0.47369909286499023
local_output_nid generation:  0.03247332572937012
local_in_edges_tensor generation:  0.04340648651123047
mini_batch_src_global generation:  0.055068016052246094
r_  generation:  0.47692394256591797
local_output_nid generation:  0.03256344795227051
local_in_edges_tensor generation:  0.03161954879760742
mini_batch_src_global generation:  0.05307412147521973
r_  generation:  0.4757561683654785
local_output_nid generation:  0.03274393081665039
local_in_edges_tensor generation:  0.031006574630737305
mini_batch_src_global generation:  0.053960561752319336
r_  generation:  0.4805741310119629
local_output_nid generation:  0.03273916244506836
local_in_edges_tensor generation:  0.03179669380187988
mini_batch_src_global generation:  0.06509184837341309
r_  generation:  0.48424220085144043
local_output_nid generation:  0.0326387882232666
local_in_edges_tensor generation:  0.03535914421081543
mini_batch_src_global generation:  0.05282735824584961
r_  generation:  0.4814901351928711
local_output_nid generation:  0.03398847579956055
local_in_edges_tensor generation:  0.04162931442260742
mini_batch_src_global generation:  0.05510210990905762
r_  generation:  0.4832141399383545
local_output_nid generation:  0.03313875198364258
local_in_edges_tensor generation:  0.03974461555480957
mini_batch_src_global generation:  0.05359196662902832
r_  generation:  0.4864954948425293
local_output_nid generation:  0.03309464454650879
local_in_edges_tensor generation:  0.03544807434082031
mini_batch_src_global generation:  0.05712103843688965
r_  generation:  0.48059678077697754
local_output_nid generation:  0.03280520439147949
local_in_edges_tensor generation:  0.03771471977233887
mini_batch_src_global generation:  0.057322025299072266
r_  generation:  0.4802253246307373
local_output_nid generation:  0.0330357551574707
local_in_edges_tensor generation:  0.030954599380493164
mini_batch_src_global generation:  0.05442380905151367
r_  generation:  0.5059113502502441
local_output_nid generation:  0.03382420539855957
local_in_edges_tensor generation:  0.04267716407775879
mini_batch_src_global generation:  0.05768132209777832
r_  generation:  0.48695874214172363
local_output_nid generation:  0.03314805030822754
local_in_edges_tensor generation:  0.0402376651763916
mini_batch_src_global generation:  0.05396556854248047
r_  generation:  0.48624515533447266
----------------------check_connections_block total spend ----------------------------- 11.483566045761108
generate_one_block  0.6007297039031982
generate_one_block  0.6022040843963623
generate_one_block  0.600604772567749
generate_one_block  0.5970098972320557
generate_one_block  0.6042530536651611
generate_one_block  0.5929644107818604
generate_one_block  0.6585862636566162
generate_one_block  0.6011314392089844
generate_one_block  0.6191389560699463
generate_one_block  0.5968427658081055
generate_one_block  0.5952343940734863
generate_one_block  0.5956284999847412
generate_one_block  0.5965425968170166
generate_one_block  0.5989134311676025
generate_one_block  0.5967342853546143
generate_one_block  0.5964796543121338
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  17.86554765701294
block generation total time  15.383239984512329
average batch blocks generation time:  0.9614524990320206
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09330511093139648  GigaBytes
Max Memory Allocated: 0.09330511093139648  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2244873046875 GB
    Memory Allocated: 0.7631268501281738  GigaBytes
Max Memory Allocated: 0.8043599128723145  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5311279296875 GB
    Memory Allocated: 0.09592723846435547  GigaBytes
Max Memory Allocated: 0.8497967720031738  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5311279296875 GB
    Memory Allocated: 0.7693853378295898  GigaBytes
Max Memory Allocated: 0.8497967720031738  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6561279296875 GB
    Memory Allocated: 0.09575462341308594  GigaBytes
Max Memory Allocated: 0.8583717346191406  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6561279296875 GB
    Memory Allocated: 0.761293888092041  GigaBytes
Max Memory Allocated: 0.8583717346191406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6561279296875 GB
    Memory Allocated: 0.09580278396606445  GigaBytes
Max Memory Allocated: 0.8583717346191406  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.7677426338195801  GigaBytes
Max Memory Allocated: 0.8583717346191406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.09600114822387695  GigaBytes
Max Memory Allocated: 0.8583717346191406  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.7707309722900391  GigaBytes
Max Memory Allocated: 0.8583717346191406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.09582662582397461  GigaBytes
Max Memory Allocated: 0.8583717346191406  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.7661256790161133  GigaBytes
Max Memory Allocated: 0.8583717346191406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.09601879119873047  GigaBytes
Max Memory Allocated: 0.8583717346191406  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.7699923515319824  GigaBytes
Max Memory Allocated: 0.8583717346191406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.09556007385253906  GigaBytes
Max Memory Allocated: 0.8587675094604492  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.7607364654541016  GigaBytes
Max Memory Allocated: 0.8587675094604492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.09569883346557617  GigaBytes
Max Memory Allocated: 0.8587675094604492  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.7641720771789551  GigaBytes
Max Memory Allocated: 0.8587675094604492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.09582281112670898  GigaBytes
Max Memory Allocated: 0.8587675094604492  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.7665977478027344  GigaBytes
Max Memory Allocated: 0.8587675094604492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.09578514099121094  GigaBytes
Max Memory Allocated: 0.8587675094604492  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.7649688720703125  GigaBytes
Max Memory Allocated: 0.8587675094604492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.09581947326660156  GigaBytes
Max Memory Allocated: 0.8587675094604492  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.7672958374023438  GigaBytes
Max Memory Allocated: 0.8587675094604492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.09581327438354492  GigaBytes
Max Memory Allocated: 0.8587675094604492  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.7635955810546875  GigaBytes
Max Memory Allocated: 0.8587675094604492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.09575414657592773  GigaBytes
Max Memory Allocated: 0.8587675094604492  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.7643275260925293  GigaBytes
Max Memory Allocated: 0.8587675094604492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.09588861465454102  GigaBytes
Max Memory Allocated: 0.8587675094604492  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.7668647766113281  GigaBytes
Max Memory Allocated: 0.8587675094604492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.09579229354858398  GigaBytes
Max Memory Allocated: 0.8587675094604492  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.7652678489685059  GigaBytes
Max Memory Allocated: 0.8587675094604492  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.060606226325035095 |0.03373301029205322 |0.05072563886642456 |0.00010412931442260742 |0.008859917521476746 |0.0020859241485595703 |
----------------------------------------------------------pseudo_mini_loss sum 6.290231704711914
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5317543
Number of first layer input nodes during this epoch:  2509103
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.12333202362060547  GigaBytes
Max Memory Allocated: 0.8587675094604492  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02607870101928711
range selection method range initialization spend 0.011434793472290039
time for parepare:  0.0169374942779541
local_output_nid generation:  0.0013840198516845703
local_in_edges_tensor generation:  0.006360530853271484
mini_batch_src_global generation:  0.002005338668823242
r_  generation:  0.02308821678161621
local_output_nid generation:  0.0014934539794921875
local_in_edges_tensor generation:  0.0009794235229492188
mini_batch_src_global generation:  0.002395153045654297
r_  generation:  0.021288156509399414
local_output_nid generation:  0.0015363693237304688
local_in_edges_tensor generation:  0.0009479522705078125
mini_batch_src_global generation:  0.0016281604766845703
r_  generation:  0.021518707275390625
local_output_nid generation:  0.0015411376953125
local_in_edges_tensor generation:  0.0008919239044189453
mini_batch_src_global generation:  0.0016021728515625
r_  generation:  0.02089715003967285
local_output_nid generation:  0.001544952392578125
local_in_edges_tensor generation:  0.0008866786956787109
mini_batch_src_global generation:  0.0016326904296875
r_  generation:  0.02127695083618164
local_output_nid generation:  0.0014848709106445312
local_in_edges_tensor generation:  0.0008592605590820312
mini_batch_src_global generation:  0.001664876937866211
r_  generation:  0.021605253219604492
local_output_nid generation:  0.0015146732330322266
local_in_edges_tensor generation:  0.0008699893951416016
mini_batch_src_global generation:  0.0016138553619384766
r_  generation:  0.02239513397216797
local_output_nid generation:  0.0015478134155273438
local_in_edges_tensor generation:  0.0008988380432128906
mini_batch_src_global generation:  0.0016236305236816406
r_  generation:  0.021152734756469727
local_output_nid generation:  0.0015537738800048828
local_in_edges_tensor generation:  0.0008838176727294922
mini_batch_src_global generation:  0.0016033649444580078
r_  generation:  0.021739721298217773
local_output_nid generation:  0.0015401840209960938
local_in_edges_tensor generation:  0.0008952617645263672
mini_batch_src_global generation:  0.0016977787017822266
r_  generation:  0.022362947463989258
local_output_nid generation:  0.0015382766723632812
local_in_edges_tensor generation:  0.000873565673828125
mini_batch_src_global generation:  0.001695871353149414
r_  generation:  0.024387121200561523
local_output_nid generation:  0.0015609264373779297
local_in_edges_tensor generation:  0.0009405612945556641
mini_batch_src_global generation:  0.0017132759094238281
r_  generation:  0.023018836975097656
local_output_nid generation:  0.0015821456909179688
local_in_edges_tensor generation:  0.0008747577667236328
mini_batch_src_global generation:  0.0016970634460449219
r_  generation:  0.022445201873779297
local_output_nid generation:  0.0015132427215576172
local_in_edges_tensor generation:  0.0009226799011230469
mini_batch_src_global generation:  0.0017275810241699219
r_  generation:  0.0230257511138916
local_output_nid generation:  0.0016222000122070312
local_in_edges_tensor generation:  0.0009367465972900391
mini_batch_src_global generation:  0.0017819404602050781
r_  generation:  0.022532939910888672
local_output_nid generation:  0.0015273094177246094
local_in_edges_tensor generation:  0.0008780956268310547
mini_batch_src_global generation:  0.0017175674438476562
r_  generation:  0.022563457489013672
----------------------check_connections_block total spend ----------------------------- 0.5274062156677246
generate_one_block  0.030896902084350586
generate_one_block  0.03418540954589844
generate_one_block  0.031818389892578125
generate_one_block  0.030814409255981445
generate_one_block  0.035616397857666016
generate_one_block  0.034464359283447266
generate_one_block  0.03189730644226074
generate_one_block  0.03157782554626465
generate_one_block  0.03456759452819824
generate_one_block  0.034383535385131836
generate_one_block  0.0334782600402832
generate_one_block  0.03415727615356445
generate_one_block  0.03251147270202637
generate_one_block  0.032311201095581055
generate_one_block  0.03174018859863281
generate_one_block  0.03218531608581543
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06083965301513672
gen group dst list time:  0.027956485748291016
time for parepare:  0.030738353729248047
local_output_nid generation:  0.007504940032958984
local_in_edges_tensor generation:  0.0333704948425293
mini_batch_src_global generation:  0.029358625411987305
r_  generation:  0.26573753356933594
local_output_nid generation:  0.013039827346801758
local_in_edges_tensor generation:  0.02308201789855957
mini_batch_src_global generation:  0.034362077713012695
r_  generation:  0.26982831954956055
local_output_nid generation:  0.0120849609375
local_in_edges_tensor generation:  0.021138906478881836
mini_batch_src_global generation:  0.03646278381347656
r_  generation:  0.2800419330596924
local_output_nid generation:  0.012431144714355469
local_in_edges_tensor generation:  0.01853489875793457
mini_batch_src_global generation:  0.03675103187561035
r_  generation:  0.29457736015319824
local_output_nid generation:  0.015778779983520508
local_in_edges_tensor generation:  0.02530074119567871
mini_batch_src_global generation:  0.037863731384277344
r_  generation:  0.29189538955688477
local_output_nid generation:  0.012727975845336914
local_in_edges_tensor generation:  0.0204317569732666
mini_batch_src_global generation:  0.03776955604553223
r_  generation:  0.2848489284515381
local_output_nid generation:  0.012754678726196289
local_in_edges_tensor generation:  0.019466876983642578
mini_batch_src_global generation:  0.035888671875
r_  generation:  0.2816176414489746
local_output_nid generation:  0.012552976608276367
local_in_edges_tensor generation:  0.014381170272827148
mini_batch_src_global generation:  0.03347492218017578
r_  generation:  0.2780320644378662
local_output_nid generation:  0.013960599899291992
local_in_edges_tensor generation:  0.03366231918334961
mini_batch_src_global generation:  0.03503131866455078
r_  generation:  0.2930288314819336
local_output_nid generation:  0.015076160430908203
local_in_edges_tensor generation:  0.01924920082092285
mini_batch_src_global generation:  0.03636622428894043
r_  generation:  0.2815525531768799
local_output_nid generation:  0.012747049331665039
local_in_edges_tensor generation:  0.01469111442565918
mini_batch_src_global generation:  0.03372907638549805
r_  generation:  0.28429627418518066
local_output_nid generation:  0.013102531433105469
local_in_edges_tensor generation:  0.01846909523010254
mini_batch_src_global generation:  0.036554574966430664
r_  generation:  0.2841370105743408
local_output_nid generation:  0.013172626495361328
local_in_edges_tensor generation:  0.0186767578125
mini_batch_src_global generation:  0.03504514694213867
r_  generation:  0.28587985038757324
local_output_nid generation:  0.013173103332519531
local_in_edges_tensor generation:  0.018738746643066406
mini_batch_src_global generation:  0.03444552421569824
r_  generation:  0.2824552059173584
local_output_nid generation:  0.013060331344604492
local_in_edges_tensor generation:  0.016028404235839844
mini_batch_src_global generation:  0.03514671325683594
r_  generation:  0.288496732711792
local_output_nid generation:  0.013975381851196289
local_in_edges_tensor generation:  0.013442277908325195
mini_batch_src_global generation:  0.03490924835205078
r_  generation:  0.2799417972564697
----------------------check_connections_block total spend ----------------------------- 6.596280574798584
generate_one_block  0.37270522117614746
generate_one_block  0.3601222038269043
generate_one_block  0.3627307415008545
generate_one_block  0.345294713973999
generate_one_block  0.35256004333496094
generate_one_block  0.3554108142852783
generate_one_block  0.39205026626586914
generate_one_block  0.34453630447387695
generate_one_block  0.3573648929595947
generate_one_block  0.3587193489074707
generate_one_block  0.34183263778686523
generate_one_block  0.35711145401000977
generate_one_block  0.36809420585632324
generate_one_block  0.3541879653930664
generate_one_block  0.36089134216308594
generate_one_block  0.35132718086242676
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.046506404876708984
gen group dst list time:  0.06348872184753418
time for parepare:  0.018420934677124023
local_output_nid generation:  0.026287317276000977
local_in_edges_tensor generation:  0.05770468711853027
mini_batch_src_global generation:  0.04321885108947754
r_  generation:  0.46124768257141113
local_output_nid generation:  0.03200984001159668
local_in_edges_tensor generation:  0.04622387886047363
mini_batch_src_global generation:  0.05237936973571777
r_  generation:  0.4653162956237793
local_output_nid generation:  0.03142380714416504
local_in_edges_tensor generation:  0.034389495849609375
mini_batch_src_global generation:  0.05063033103942871
r_  generation:  0.47299766540527344
local_output_nid generation:  0.03288769721984863
local_in_edges_tensor generation:  0.0348358154296875
mini_batch_src_global generation:  0.051401376724243164
r_  generation:  0.4720273017883301
local_output_nid generation:  0.03289055824279785
local_in_edges_tensor generation:  0.09405732154846191
mini_batch_src_global generation:  0.05603504180908203
r_  generation:  0.47800660133361816
local_output_nid generation:  0.033249616622924805
local_in_edges_tensor generation:  0.03743314743041992
mini_batch_src_global generation:  0.053067684173583984
r_  generation:  0.48872947692871094
local_output_nid generation:  0.03438067436218262
local_in_edges_tensor generation:  0.03207111358642578
mini_batch_src_global generation:  0.0538482666015625
r_  generation:  0.4865610599517822
local_output_nid generation:  0.03349614143371582
local_in_edges_tensor generation:  0.03630828857421875
mini_batch_src_global generation:  0.07213234901428223
r_  generation:  0.4805459976196289
local_output_nid generation:  0.03484845161437988
local_in_edges_tensor generation:  0.039907217025756836
mini_batch_src_global generation:  0.05310177803039551
r_  generation:  0.4882683753967285
local_output_nid generation:  0.03333306312561035
local_in_edges_tensor generation:  0.04000997543334961
mini_batch_src_global generation:  0.056617021560668945
r_  generation:  0.4820215702056885
local_output_nid generation:  0.03289628028869629
local_in_edges_tensor generation:  0.034734249114990234
mini_batch_src_global generation:  0.052700042724609375
r_  generation:  0.4932713508605957
local_output_nid generation:  0.03284955024719238
local_in_edges_tensor generation:  0.031182050704956055
mini_batch_src_global generation:  0.05370473861694336
r_  generation:  0.48482465744018555
local_output_nid generation:  0.032880306243896484
local_in_edges_tensor generation:  0.0353541374206543
mini_batch_src_global generation:  0.056307077407836914
r_  generation:  0.48522353172302246
local_output_nid generation:  0.03581953048706055
local_in_edges_tensor generation:  0.03976941108703613
mini_batch_src_global generation:  0.05336332321166992
r_  generation:  0.4788475036621094
local_output_nid generation:  0.03270387649536133
local_in_edges_tensor generation:  0.031160354614257812
mini_batch_src_global generation:  0.053592681884765625
r_  generation:  0.48642635345458984
local_output_nid generation:  0.032852888107299805
local_in_edges_tensor generation:  0.03470206260681152
mini_batch_src_global generation:  0.05373692512512207
r_  generation:  0.48272275924682617
----------------------check_connections_block total spend ----------------------------- 11.455488443374634
generate_one_block  0.5954406261444092
generate_one_block  0.5974216461181641
generate_one_block  0.5889582633972168
generate_one_block  0.6037421226501465
generate_one_block  0.6037564277648926
generate_one_block  0.585132360458374
generate_one_block  0.587226152420044
generate_one_block  0.5975871086120605
generate_one_block  0.6214470863342285
generate_one_block  0.6156635284423828
generate_one_block  0.5856428146362305
generate_one_block  0.585026741027832
generate_one_block  0.6270334720611572
generate_one_block  0.5949361324310303
generate_one_block  0.5974998474121094
generate_one_block  0.5966014862060547
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.12333202362060547  GigaBytes
Max Memory Allocated: 0.8587675094604492  GigaBytes

connection checking time:  18.051769018173218
block generation total time  15.318055152893066
average batch blocks generation time:  0.9573784470558167
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.09758710861206055  GigaBytes
Max Memory Allocated: 0.8587675094604492  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.771306037902832  GigaBytes
Max Memory Allocated: 0.8587675094604492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09749126434326172  GigaBytes
Max Memory Allocated: 0.8599915504455566  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7671222686767578  GigaBytes
Max Memory Allocated: 0.8599915504455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09749221801757812  GigaBytes
Max Memory Allocated: 0.8599915504455566  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7703742980957031  GigaBytes
Max Memory Allocated: 0.8599915504455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09742116928100586  GigaBytes
Max Memory Allocated: 0.8599915504455566  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7659964561462402  GigaBytes
Max Memory Allocated: 0.8599915504455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09758710861206055  GigaBytes
Max Memory Allocated: 0.8599915504455566  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7702770233154297  GigaBytes
Max Memory Allocated: 0.8599915504455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09732675552368164  GigaBytes
Max Memory Allocated: 0.8599915504455566  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7640328407287598  GigaBytes
Max Memory Allocated: 0.8599915504455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09737730026245117  GigaBytes
Max Memory Allocated: 0.8599915504455566  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.764674186706543  GigaBytes
Max Memory Allocated: 0.8599915504455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09734582901000977  GigaBytes
Max Memory Allocated: 0.8599915504455566  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7617254257202148  GigaBytes
Max Memory Allocated: 0.8599915504455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09739971160888672  GigaBytes
Max Memory Allocated: 0.8599915504455566  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7649450302124023  GigaBytes
Max Memory Allocated: 0.8599915504455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.0977163314819336  GigaBytes
Max Memory Allocated: 0.8599915504455566  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7753429412841797  GigaBytes
Max Memory Allocated: 0.8599915504455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09722280502319336  GigaBytes
Max Memory Allocated: 0.8642892837524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7614707946777344  GigaBytes
Max Memory Allocated: 0.8642892837524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09737491607666016  GigaBytes
Max Memory Allocated: 0.8642892837524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7685112953186035  GigaBytes
Max Memory Allocated: 0.8642892837524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09773445129394531  GigaBytes
Max Memory Allocated: 0.8642892837524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7751965522766113  GigaBytes
Max Memory Allocated: 0.8642892837524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09748983383178711  GigaBytes
Max Memory Allocated: 0.8642892837524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7674565315246582  GigaBytes
Max Memory Allocated: 0.8642892837524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09746599197387695  GigaBytes
Max Memory Allocated: 0.8642892837524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7672452926635742  GigaBytes
Max Memory Allocated: 0.8642892837524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09739160537719727  GigaBytes
Max Memory Allocated: 0.8642892837524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7656292915344238  GigaBytes
Max Memory Allocated: 0.8642892837524414  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06237415969371796 |0.014580771327018738 |0.003638625144958496 |9.040534496307373e-05 |0.005229741334915161 |0.0027849674224853516 |
----------------------------------------------------------pseudo_mini_loss sum 3.2340588569641113
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5317777
Number of first layer input nodes during this epoch:  2509589
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.12311840057373047  GigaBytes
Max Memory Allocated: 0.8642892837524414  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.031117677688598633
range selection method range initialization spend 0.012393474578857422
time for parepare:  0.018497705459594727
local_output_nid generation:  0.0015056133270263672
local_in_edges_tensor generation:  0.006460666656494141
mini_batch_src_global generation:  0.002139568328857422
r_  generation:  0.02134251594543457
local_output_nid generation:  0.0016317367553710938
local_in_edges_tensor generation:  0.0009894371032714844
mini_batch_src_global generation:  0.002405405044555664
r_  generation:  0.02163386344909668
local_output_nid generation:  0.0032694339752197266
local_in_edges_tensor generation:  0.0010540485382080078
mini_batch_src_global generation:  0.0016217231750488281
r_  generation:  0.021463632583618164
local_output_nid generation:  0.0016505718231201172
local_in_edges_tensor generation:  0.0010378360748291016
mini_batch_src_global generation:  0.0016024112701416016
r_  generation:  0.021879196166992188
local_output_nid generation:  0.001650094985961914
local_in_edges_tensor generation:  0.0009789466857910156
mini_batch_src_global generation:  0.0016484260559082031
r_  generation:  0.022096872329711914
local_output_nid generation:  0.0016775131225585938
local_in_edges_tensor generation:  0.0009064674377441406
mini_batch_src_global generation:  0.0016498565673828125
r_  generation:  0.023239850997924805
local_output_nid generation:  0.0016391277313232422
local_in_edges_tensor generation:  0.0009393692016601562
mini_batch_src_global generation:  0.001703500747680664
r_  generation:  0.021970748901367188
local_output_nid generation:  0.0016493797302246094
local_in_edges_tensor generation:  0.0009484291076660156
mini_batch_src_global generation:  0.0016317367553710938
r_  generation:  0.021454811096191406
local_output_nid generation:  0.0016033649444580078
local_in_edges_tensor generation:  0.0009357929229736328
mini_batch_src_global generation:  0.0017130374908447266
r_  generation:  0.02234673500061035
local_output_nid generation:  0.0016269683837890625
local_in_edges_tensor generation:  0.0009198188781738281
mini_batch_src_global generation:  0.0016946792602539062
r_  generation:  0.022152423858642578
local_output_nid generation:  0.0016186237335205078
local_in_edges_tensor generation:  0.0009620189666748047
mini_batch_src_global generation:  0.0016939640045166016
r_  generation:  0.022334814071655273
local_output_nid generation:  0.0015888214111328125
local_in_edges_tensor generation:  0.0009083747863769531
mini_batch_src_global generation:  0.001772165298461914
r_  generation:  0.02293705940246582
local_output_nid generation:  0.0016055107116699219
local_in_edges_tensor generation:  0.0009429454803466797
mini_batch_src_global generation:  0.0017061233520507812
r_  generation:  0.022034168243408203
local_output_nid generation:  0.0016014575958251953
local_in_edges_tensor generation:  0.0009710788726806641
mini_batch_src_global generation:  0.0017154216766357422
r_  generation:  0.022202730178833008
local_output_nid generation:  0.0016605854034423828
local_in_edges_tensor generation:  0.0009875297546386719
mini_batch_src_global generation:  0.0017275810241699219
r_  generation:  0.02244400978088379
local_output_nid generation:  0.0017375946044921875
local_in_edges_tensor generation:  0.0009894371032714844
mini_batch_src_global generation:  0.0017206668853759766
r_  generation:  0.021814823150634766
----------------------check_connections_block total spend ----------------------------- 0.527545690536499
generate_one_block  0.034925222396850586
generate_one_block  0.031606435775756836
generate_one_block  0.030890941619873047
generate_one_block  0.031888723373413086
generate_one_block  0.03193545341491699
generate_one_block  0.033215999603271484
generate_one_block  0.03060770034790039
generate_one_block  0.030430078506469727
generate_one_block  0.031558990478515625
generate_one_block  0.031392574310302734
generate_one_block  0.03171062469482422
generate_one_block  0.0323488712310791
generate_one_block  0.030904054641723633
generate_one_block  0.031487226486206055
generate_one_block  0.030878305435180664
generate_one_block  0.03127312660217285
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05968499183654785
gen group dst list time:  0.02130603790283203
time for parepare:  0.019982576370239258
local_output_nid generation:  0.007470846176147461
local_in_edges_tensor generation:  0.021328449249267578
mini_batch_src_global generation:  0.028000593185424805
r_  generation:  0.2635207176208496
local_output_nid generation:  0.011246681213378906
local_in_edges_tensor generation:  0.021003007888793945
mini_batch_src_global generation:  0.03192543983459473
r_  generation:  0.27147483825683594
local_output_nid generation:  0.01275181770324707
local_in_edges_tensor generation:  0.02923583984375
mini_batch_src_global generation:  0.031540632247924805
r_  generation:  0.28357625007629395
local_output_nid generation:  0.014057636260986328
local_in_edges_tensor generation:  0.015592336654663086
mini_batch_src_global generation:  0.038814544677734375
r_  generation:  0.27546262741088867
local_output_nid generation:  0.012893199920654297
local_in_edges_tensor generation:  0.01680731773376465
mini_batch_src_global generation:  0.03356528282165527
r_  generation:  0.2794485092163086
local_output_nid generation:  0.012795448303222656
local_in_edges_tensor generation:  0.014868021011352539
mini_batch_src_global generation:  0.03384661674499512
r_  generation:  0.29337644577026367
local_output_nid generation:  0.013341426849365234
local_in_edges_tensor generation:  0.015247344970703125
mini_batch_src_global generation:  0.03365588188171387
r_  generation:  0.27602219581604004
local_output_nid generation:  0.014988183975219727
local_in_edges_tensor generation:  0.019116878509521484
mini_batch_src_global generation:  0.03403663635253906
r_  generation:  0.26856136322021484
local_output_nid generation:  0.013326168060302734
local_in_edges_tensor generation:  0.02423238754272461
mini_batch_src_global generation:  0.03417158126831055
r_  generation:  0.28191399574279785
local_output_nid generation:  0.012969017028808594
local_in_edges_tensor generation:  0.01604938507080078
mini_batch_src_global generation:  0.036580562591552734
r_  generation:  0.2856454849243164
local_output_nid generation:  0.01275324821472168
local_in_edges_tensor generation:  0.018101215362548828
mini_batch_src_global generation:  0.033846139907836914
r_  generation:  0.2775290012359619
local_output_nid generation:  0.014104843139648438
local_in_edges_tensor generation:  0.015264034271240234
mini_batch_src_global generation:  0.03830742835998535
r_  generation:  0.28313708305358887
local_output_nid generation:  0.012840747833251953
local_in_edges_tensor generation:  0.01361536979675293
mini_batch_src_global generation:  0.047310590744018555
r_  generation:  0.2701597213745117
local_output_nid generation:  0.013729095458984375
local_in_edges_tensor generation:  0.015481710433959961
mini_batch_src_global generation:  0.03405618667602539
r_  generation:  0.2752645015716553
local_output_nid generation:  0.012662887573242188
local_in_edges_tensor generation:  0.013749122619628906
mini_batch_src_global generation:  0.033956289291381836
r_  generation:  0.2729349136352539
local_output_nid generation:  0.012609004974365234
local_in_edges_tensor generation:  0.014394521713256836
mini_batch_src_global generation:  0.03718900680541992
r_  generation:  0.27275633811950684
----------------------check_connections_block total spend ----------------------------- 6.43250584602356
generate_one_block  0.3639538288116455
generate_one_block  0.36328625679016113
generate_one_block  0.3653850555419922
generate_one_block  0.3574068546295166
generate_one_block  0.35637378692626953
generate_one_block  0.3536539077758789
generate_one_block  0.37934160232543945
generate_one_block  0.3409268856048584
generate_one_block  0.35750675201416016
generate_one_block  0.3552570343017578
generate_one_block  0.35079169273376465
generate_one_block  0.36283445358276367
generate_one_block  0.34324145317077637
generate_one_block  0.34923648834228516
generate_one_block  0.34675145149230957
generate_one_block  0.34746861457824707
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03499913215637207
gen group dst list time:  0.06549692153930664
time for parepare:  0.01947474479675293
local_output_nid generation:  0.025786399841308594
local_in_edges_tensor generation:  0.053046464920043945
mini_batch_src_global generation:  0.04253530502319336
r_  generation:  0.4729790687561035
local_output_nid generation:  0.034116506576538086
local_in_edges_tensor generation:  0.0386202335357666
mini_batch_src_global generation:  0.052957773208618164
r_  generation:  0.47006940841674805
local_output_nid generation:  0.032588958740234375
local_in_edges_tensor generation:  0.03452897071838379
mini_batch_src_global generation:  0.05105996131896973
r_  generation:  0.47316741943359375
local_output_nid generation:  0.03242349624633789
local_in_edges_tensor generation:  0.03483295440673828
mini_batch_src_global generation:  0.051851511001586914
r_  generation:  0.4766523838043213
local_output_nid generation:  0.0325162410736084
local_in_edges_tensor generation:  0.08388590812683105
mini_batch_src_global generation:  0.058103322982788086
r_  generation:  0.47620511054992676
local_output_nid generation:  0.03175759315490723
local_in_edges_tensor generation:  0.031256675720214844
mini_batch_src_global generation:  0.05404376983642578
r_  generation:  0.4736952781677246
local_output_nid generation:  0.032006263732910156
local_in_edges_tensor generation:  0.03361630439758301
mini_batch_src_global generation:  0.05326223373413086
r_  generation:  0.4796421527862549
local_output_nid generation:  0.03227710723876953
local_in_edges_tensor generation:  0.03711080551147461
mini_batch_src_global generation:  0.053665876388549805
r_  generation:  0.47605252265930176
local_output_nid generation:  0.0324857234954834
local_in_edges_tensor generation:  0.04207801818847656
mini_batch_src_global generation:  0.05315876007080078
r_  generation:  0.47846269607543945
local_output_nid generation:  0.03227543830871582
local_in_edges_tensor generation:  0.037354469299316406
mini_batch_src_global generation:  0.053664207458496094
r_  generation:  0.4765951633453369
local_output_nid generation:  0.03401970863342285
local_in_edges_tensor generation:  0.03819727897644043
mini_batch_src_global generation:  0.05347466468811035
r_  generation:  0.4811534881591797
local_output_nid generation:  0.032479047775268555
local_in_edges_tensor generation:  0.034078359603881836
mini_batch_src_global generation:  0.061127424240112305
r_  generation:  0.4830291271209717
local_output_nid generation:  0.0325007438659668
local_in_edges_tensor generation:  0.0314486026763916
mini_batch_src_global generation:  0.05296826362609863
r_  generation:  0.48185181617736816
local_output_nid generation:  0.03197360038757324
local_in_edges_tensor generation:  0.03398323059082031
mini_batch_src_global generation:  0.05882430076599121
r_  generation:  0.48960232734680176
local_output_nid generation:  0.03313136100769043
local_in_edges_tensor generation:  0.033847808837890625
mini_batch_src_global generation:  0.05385327339172363
r_  generation:  0.48308634757995605
local_output_nid generation:  0.03250384330749512
local_in_edges_tensor generation:  0.03377246856689453
mini_batch_src_global generation:  0.0539243221282959
r_  generation:  0.48012351989746094
----------------------check_connections_block total spend ----------------------------- 11.358182907104492
generate_one_block  0.5966987609863281
generate_one_block  0.600184440612793
generate_one_block  0.5980851650238037
generate_one_block  0.605459451675415
generate_one_block  0.5926332473754883
generate_one_block  0.5828924179077148
generate_one_block  0.5961647033691406
generate_one_block  0.5810563564300537
generate_one_block  0.6668558120727539
generate_one_block  0.6138074398040771
generate_one_block  0.5827741622924805
generate_one_block  0.6369807720184326
generate_one_block  0.5834879875183105
generate_one_block  0.5829508304595947
generate_one_block  0.586637020111084
generate_one_block  0.5905492305755615
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.12311840057373047  GigaBytes
Max Memory Allocated: 0.8642892837524414  GigaBytes

connection checking time:  17.79068875312805
block generation total time  15.290633916854858
average batch blocks generation time:  0.9556646198034286
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09741592407226562  GigaBytes
Max Memory Allocated: 0.8642892837524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7666935920715332  GigaBytes
Max Memory Allocated: 0.8642892837524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09757280349731445  GigaBytes
Max Memory Allocated: 0.8642892837524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7744317054748535  GigaBytes
Max Memory Allocated: 0.8642892837524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09737253189086914  GigaBytes
Max Memory Allocated: 0.8642892837524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7660574913024902  GigaBytes
Max Memory Allocated: 0.8642892837524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.0977015495300293  GigaBytes
Max Memory Allocated: 0.8642892837524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7747645378112793  GigaBytes
Max Memory Allocated: 0.8642892837524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09756183624267578  GigaBytes
Max Memory Allocated: 0.8642892837524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7723321914672852  GigaBytes
Max Memory Allocated: 0.8642892837524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09747076034545898  GigaBytes
Max Memory Allocated: 0.8642892837524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7659358978271484  GigaBytes
Max Memory Allocated: 0.8642892837524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09728050231933594  GigaBytes
Max Memory Allocated: 0.8642892837524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7628946304321289  GigaBytes
Max Memory Allocated: 0.8642892837524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09724140167236328  GigaBytes
Max Memory Allocated: 0.8642892837524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7616348266601562  GigaBytes
Max Memory Allocated: 0.8642892837524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09763813018798828  GigaBytes
Max Memory Allocated: 0.8642892837524414  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7754602432250977  GigaBytes
Max Memory Allocated: 0.8642892837524414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09755945205688477  GigaBytes
Max Memory Allocated: 0.864555835723877  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7745065689086914  GigaBytes
Max Memory Allocated: 0.864555835723877  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09742116928100586  GigaBytes
Max Memory Allocated: 0.864555835723877  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7665152549743652  GigaBytes
Max Memory Allocated: 0.864555835723877  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09774541854858398  GigaBytes
Max Memory Allocated: 0.864555835723877  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.775822639465332  GigaBytes
Max Memory Allocated: 0.864555835723877  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09721612930297852  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7624731063842773  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09734058380126953  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7675237655639648  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09731578826904297  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7630424499511719  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09734725952148438  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7622642517089844  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06317242980003357 |0.014910787343978882 |0.0036953985691070557 |9.472668170928955e-05 |0.0033818185329437256 |0.0018687248229980469 |
----------------------------------------------------------pseudo_mini_loss sum 2.599487543106079
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  5317727
Number of first layer input nodes during this epoch:  2509431
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.1229257583618164  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.036452293395996094
range selection method range initialization spend 0.012724876403808594
time for parepare:  0.018088817596435547
local_output_nid generation:  0.0014595985412597656
local_in_edges_tensor generation:  0.00690150260925293
mini_batch_src_global generation:  0.0017120838165283203
r_  generation:  0.020932435989379883
local_output_nid generation:  0.0016219615936279297
local_in_edges_tensor generation:  0.0011150836944580078
mini_batch_src_global generation:  0.002193450927734375
r_  generation:  0.022298336029052734
local_output_nid generation:  0.0016160011291503906
local_in_edges_tensor generation:  0.0009412765502929688
mini_batch_src_global generation:  0.001657247543334961
r_  generation:  0.02178502082824707
local_output_nid generation:  0.0016672611236572266
local_in_edges_tensor generation:  0.0009441375732421875
mini_batch_src_global generation:  0.0017380714416503906
r_  generation:  0.022054433822631836
local_output_nid generation:  0.0016062259674072266
local_in_edges_tensor generation:  0.0009584426879882812
mini_batch_src_global generation:  0.0017039775848388672
r_  generation:  0.02159428596496582
local_output_nid generation:  0.0016293525695800781
local_in_edges_tensor generation:  0.0009610652923583984
mini_batch_src_global generation:  0.0017406940460205078
r_  generation:  0.02219367027282715
local_output_nid generation:  0.0015857219696044922
local_in_edges_tensor generation:  0.0009429454803466797
mini_batch_src_global generation:  0.001737833023071289
r_  generation:  0.022220134735107422
local_output_nid generation:  0.0016052722930908203
local_in_edges_tensor generation:  0.0008966922760009766
mini_batch_src_global generation:  0.001737356185913086
r_  generation:  0.022378921508789062
local_output_nid generation:  0.0015950202941894531
local_in_edges_tensor generation:  0.001001596450805664
mini_batch_src_global generation:  0.0016973018646240234
r_  generation:  0.022324085235595703
local_output_nid generation:  0.0015704631805419922
local_in_edges_tensor generation:  0.0010280609130859375
mini_batch_src_global generation:  0.0017621517181396484
r_  generation:  0.023160696029663086
local_output_nid generation:  0.0015845298767089844
local_in_edges_tensor generation:  0.0009200572967529297
mini_batch_src_global generation:  0.001798868179321289
r_  generation:  0.022867918014526367
local_output_nid generation:  0.0016138553619384766
local_in_edges_tensor generation:  0.0009264945983886719
mini_batch_src_global generation:  0.0017535686492919922
r_  generation:  0.02233266830444336
local_output_nid generation:  0.0016171932220458984
local_in_edges_tensor generation:  0.0009005069732666016
mini_batch_src_global generation:  0.0017426013946533203
r_  generation:  0.02261185646057129
local_output_nid generation:  0.0015857219696044922
local_in_edges_tensor generation:  0.0009484291076660156
mini_batch_src_global generation:  0.001767873764038086
r_  generation:  0.023188114166259766
local_output_nid generation:  0.0015931129455566406
local_in_edges_tensor generation:  0.0010025501251220703
mini_batch_src_global generation:  0.0018393993377685547
r_  generation:  0.02227020263671875
local_output_nid generation:  0.0016002655029296875
local_in_edges_tensor generation:  0.0009167194366455078
mini_batch_src_global generation:  0.0017242431640625
r_  generation:  0.022302865982055664
----------------------check_connections_block total spend ----------------------------- 0.53639817237854
generate_one_block  0.030354738235473633
generate_one_block  0.0321040153503418
generate_one_block  0.03137087821960449
generate_one_block  0.03205418586730957
generate_one_block  0.030426740646362305
generate_one_block  0.0330197811126709
generate_one_block  0.030656814575195312
generate_one_block  0.03134322166442871
generate_one_block  0.03152894973754883
generate_one_block  0.03229236602783203
generate_one_block  0.03183770179748535
generate_one_block  0.03161168098449707
generate_one_block  0.03183746337890625
generate_one_block  0.03185009956359863
generate_one_block  0.031012296676635742
generate_one_block  0.031805992126464844
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04570913314819336
gen group dst list time:  0.019045114517211914
time for parepare:  0.020228862762451172
local_output_nid generation:  0.007650136947631836
local_in_edges_tensor generation:  0.03189992904663086
mini_batch_src_global generation:  0.0257871150970459
r_  generation:  0.2699594497680664
local_output_nid generation:  0.01278066635131836
local_in_edges_tensor generation:  0.02124953269958496
mini_batch_src_global generation:  0.03469991683959961
r_  generation:  0.2858085632324219
local_output_nid generation:  0.013986349105834961
local_in_edges_tensor generation:  0.02065730094909668
mini_batch_src_global generation:  0.032456398010253906
r_  generation:  0.2747073173522949
local_output_nid generation:  0.012690067291259766
local_in_edges_tensor generation:  0.015684127807617188
mini_batch_src_global generation:  0.033844947814941406
r_  generation:  0.28014612197875977
local_output_nid generation:  0.012623786926269531
local_in_edges_tensor generation:  0.014913082122802734
mini_batch_src_global generation:  0.032640933990478516
r_  generation:  0.27065277099609375
local_output_nid generation:  0.013523578643798828
local_in_edges_tensor generation:  0.013950586318969727
mini_batch_src_global generation:  0.033396244049072266
r_  generation:  0.2733912467956543
local_output_nid generation:  0.013224124908447266
local_in_edges_tensor generation:  0.013731956481933594
mini_batch_src_global generation:  0.033570289611816406
r_  generation:  0.2761838436126709
local_output_nid generation:  0.013438701629638672
local_in_edges_tensor generation:  0.015654802322387695
mini_batch_src_global generation:  0.039507150650024414
r_  generation:  0.27866601943969727
local_output_nid generation:  0.013538360595703125
local_in_edges_tensor generation:  0.015146970748901367
mini_batch_src_global generation:  0.034125566482543945
r_  generation:  0.2802455425262451
local_output_nid generation:  0.013494491577148438
local_in_edges_tensor generation:  0.01590728759765625
mini_batch_src_global generation:  0.03464627265930176
r_  generation:  0.28876781463623047
local_output_nid generation:  0.013137340545654297
local_in_edges_tensor generation:  0.0160062313079834
mini_batch_src_global generation:  0.0348048210144043
r_  generation:  0.28942227363586426
local_output_nid generation:  0.013010740280151367
local_in_edges_tensor generation:  0.01680755615234375
mini_batch_src_global generation:  0.03467607498168945
r_  generation:  0.28833866119384766
local_output_nid generation:  0.013132572174072266
local_in_edges_tensor generation:  0.015805482864379883
mini_batch_src_global generation:  0.0347294807434082
r_  generation:  0.28928279876708984
local_output_nid generation:  0.013117790222167969
local_in_edges_tensor generation:  0.01579737663269043
mini_batch_src_global generation:  0.03430747985839844
r_  generation:  0.290541410446167
local_output_nid generation:  0.012981176376342773
local_in_edges_tensor generation:  0.01989912986755371
mini_batch_src_global generation:  0.03519630432128906
r_  generation:  0.294414758682251
local_output_nid generation:  0.01296854019165039
local_in_edges_tensor generation:  0.015492916107177734
mini_batch_src_global generation:  0.03478837013244629
r_  generation:  0.287611722946167
----------------------check_connections_block total spend ----------------------------- 6.498313665390015
generate_one_block  0.36934971809387207
generate_one_block  0.35868334770202637
generate_one_block  0.36010169982910156
generate_one_block  0.37099599838256836
generate_one_block  0.34551429748535156
generate_one_block  0.3693532943725586
generate_one_block  0.38025951385498047
generate_one_block  0.3496105670928955
generate_one_block  0.34743690490722656
generate_one_block  0.3672053813934326
generate_one_block  0.3614833354949951
generate_one_block  0.3789970874786377
generate_one_block  0.36516880989074707
generate_one_block  0.3575410842895508
generate_one_block  0.35849857330322266
generate_one_block  0.3559391498565674
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03391695022583008
gen group dst list time:  0.07211422920227051
time for parepare:  0.019857406616210938
local_output_nid generation:  0.026796340942382812
local_in_edges_tensor generation:  0.051718711853027344
mini_batch_src_global generation:  0.04363417625427246
r_  generation:  0.46367621421813965
local_output_nid generation:  0.03129291534423828
local_in_edges_tensor generation:  0.04235100746154785
mini_batch_src_global generation:  0.05312633514404297
r_  generation:  0.471588134765625
local_output_nid generation:  0.03134632110595703
local_in_edges_tensor generation:  0.03373265266418457
mini_batch_src_global generation:  0.05080366134643555
r_  generation:  0.48669934272766113
local_output_nid generation:  0.032006263732910156
local_in_edges_tensor generation:  0.03833436965942383
mini_batch_src_global generation:  0.052224159240722656
r_  generation:  0.49410271644592285
local_output_nid generation:  0.03185272216796875
local_in_edges_tensor generation:  0.07790303230285645
mini_batch_src_global generation:  0.05356264114379883
r_  generation:  0.4861569404602051
local_output_nid generation:  0.034491539001464844
local_in_edges_tensor generation:  0.03369903564453125
mini_batch_src_global generation:  0.05567765235900879
r_  generation:  0.48249292373657227
local_output_nid generation:  0.032741546630859375
local_in_edges_tensor generation:  0.03622722625732422
mini_batch_src_global generation:  0.05301666259765625
r_  generation:  0.4953494071960449
local_output_nid generation:  0.03494453430175781
local_in_edges_tensor generation:  0.04562187194824219
mini_batch_src_global generation:  0.05579257011413574
r_  generation:  0.5066494941711426
local_output_nid generation:  0.03584909439086914
local_in_edges_tensor generation:  0.03505849838256836
mini_batch_src_global generation:  0.05701732635498047
r_  generation:  0.4948301315307617
local_output_nid generation:  0.033707380294799805
local_in_edges_tensor generation:  0.03768134117126465
mini_batch_src_global generation:  0.05407071113586426
r_  generation:  0.49007511138916016
local_output_nid generation:  0.0335693359375
local_in_edges_tensor generation:  0.03164982795715332
mini_batch_src_global generation:  0.05256819725036621
r_  generation:  0.5062987804412842
local_output_nid generation:  0.03415870666503906
local_in_edges_tensor generation:  0.03183889389038086
mini_batch_src_global generation:  0.05345439910888672
r_  generation:  0.4881727695465088
local_output_nid generation:  0.03371834754943848
local_in_edges_tensor generation:  0.03493165969848633
mini_batch_src_global generation:  0.05494213104248047
r_  generation:  0.48940515518188477
local_output_nid generation:  0.03465127944946289
local_in_edges_tensor generation:  0.03345370292663574
mini_batch_src_global generation:  0.054848670959472656
r_  generation:  0.48326873779296875
local_output_nid generation:  0.033751726150512695
local_in_edges_tensor generation:  0.03390860557556152
mini_batch_src_global generation:  0.052811384201049805
r_  generation:  0.49172496795654297
local_output_nid generation:  0.0336453914642334
local_in_edges_tensor generation:  0.036756277084350586
mini_batch_src_global generation:  0.052822113037109375
r_  generation:  0.48462367057800293
----------------------check_connections_block total spend ----------------------------- 11.539011001586914
generate_one_block  0.611722469329834
generate_one_block  0.6020941734313965
generate_one_block  0.6077609062194824
generate_one_block  0.5965006351470947
generate_one_block  0.5911216735839844
generate_one_block  0.5923161506652832
generate_one_block  0.6022293567657471
generate_one_block  0.6010749340057373
generate_one_block  0.6370377540588379
generate_one_block  0.6106536388397217
generate_one_block  0.6003696918487549
generate_one_block  0.5937919616699219
generate_one_block  0.6030340194702148
generate_one_block  0.6027367115020752
generate_one_block  0.5965559482574463
generate_one_block  0.6060991287231445
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.1229257583618164  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

connection checking time:  18.03732466697693
block generation total time  15.451237916946411
average batch blocks generation time:  0.9657023698091507
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09727668762207031  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7609987258911133  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09748554229736328  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7742166519165039  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09742259979248047  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7666916847229004  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.0977015495300293  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7753720283508301  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09714698791503906  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.759730339050293  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09744691848754883  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7660183906555176  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.0973958969116211  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7677726745605469  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09726142883300781  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.763826847076416  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09752845764160156  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.770817756652832  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.097747802734375  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7758316993713379  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09743785858154297  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7712717056274414  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09758949279785156  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7680416107177734  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09761285781860352  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7748799324035645  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09753608703613281  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.76824951171875  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09738874435424805  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.765927791595459  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09719324111938477  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7636971473693848  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0612337589263916 |0.015041470527648926 |0.003977105021476746 |9.991228580474854e-05 |0.004880502820014954 |0.002943277359008789 |
----------------------------------------------------------pseudo_mini_loss sum 2.356398344039917
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  5318589
Number of first layer input nodes during this epoch:  2509028
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.12292003631591797  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0256655216217041
range selection method range initialization spend 0.012337207794189453
time for parepare:  0.0187833309173584
local_output_nid generation:  0.0014252662658691406
local_in_edges_tensor generation:  0.004162788391113281
mini_batch_src_global generation:  0.002197742462158203
r_  generation:  0.02197575569152832
local_output_nid generation:  0.0016443729400634766
local_in_edges_tensor generation:  0.0010178089141845703
mini_batch_src_global generation:  0.002243518829345703
r_  generation:  0.02247142791748047
local_output_nid generation:  0.0016117095947265625
local_in_edges_tensor generation:  0.0009856224060058594
mini_batch_src_global generation:  0.0016994476318359375
r_  generation:  0.02206110954284668
local_output_nid generation:  0.0016322135925292969
local_in_edges_tensor generation:  0.0010402202606201172
mini_batch_src_global generation:  0.0016417503356933594
r_  generation:  0.021594762802124023
local_output_nid generation:  0.00157928466796875
local_in_edges_tensor generation:  0.00095367431640625
mini_batch_src_global generation:  0.0017561912536621094
r_  generation:  0.022456884384155273
local_output_nid generation:  0.00159454345703125
local_in_edges_tensor generation:  0.0009183883666992188
mini_batch_src_global generation:  0.0017838478088378906
r_  generation:  0.022747516632080078
local_output_nid generation:  0.0016243457794189453
local_in_edges_tensor generation:  0.0009598731994628906
mini_batch_src_global generation:  0.001825094223022461
r_  generation:  0.022444963455200195
local_output_nid generation:  0.0016434192657470703
local_in_edges_tensor generation:  0.000972747802734375
mini_batch_src_global generation:  0.0017368793487548828
r_  generation:  0.02265334129333496
local_output_nid generation:  0.0016779899597167969
local_in_edges_tensor generation:  0.0009348392486572266
mini_batch_src_global generation:  0.001794576644897461
r_  generation:  0.022838115692138672
local_output_nid generation:  0.0016291141510009766
local_in_edges_tensor generation:  0.0009531974792480469
mini_batch_src_global generation:  0.0017807483673095703
r_  generation:  0.023128032684326172
local_output_nid generation:  0.0016295909881591797
local_in_edges_tensor generation:  0.0009641647338867188
mini_batch_src_global generation:  0.0017666816711425781
r_  generation:  0.02260303497314453
local_output_nid generation:  0.0015938282012939453
local_in_edges_tensor generation:  0.0009212493896484375
mini_batch_src_global generation:  0.0017573833465576172
r_  generation:  0.02318596839904785
local_output_nid generation:  0.00159454345703125
local_in_edges_tensor generation:  0.0009539127349853516
mini_batch_src_global generation:  0.0017838478088378906
r_  generation:  0.022312641143798828
local_output_nid generation:  0.0016584396362304688
local_in_edges_tensor generation:  0.0010209083557128906
mini_batch_src_global generation:  0.0018019676208496094
r_  generation:  0.023181676864624023
local_output_nid generation:  0.0016536712646484375
local_in_edges_tensor generation:  0.0009696483612060547
mini_batch_src_global generation:  0.0017578601837158203
r_  generation:  0.02214813232421875
local_output_nid generation:  0.0015990734100341797
local_in_edges_tensor generation:  0.0009200572967529297
mini_batch_src_global generation:  0.001773834228515625
r_  generation:  0.02298569679260254
----------------------check_connections_block total spend ----------------------------- 0.536750078201294
generate_one_block  0.039281606674194336
generate_one_block  0.031477928161621094
generate_one_block  0.03159928321838379
generate_one_block  0.03052806854248047
generate_one_block  0.031644344329833984
generate_one_block  0.03279519081115723
generate_one_block  0.031218767166137695
generate_one_block  0.03133869171142578
generate_one_block  0.03231024742126465
generate_one_block  0.031078338623046875
generate_one_block  0.030816316604614258
generate_one_block  0.03172135353088379
generate_one_block  0.031102657318115234
generate_one_block  0.03187704086303711
generate_one_block  0.030872583389282227
generate_one_block  0.031707763671875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03919410705566406
gen group dst list time:  0.018166542053222656
time for parepare:  0.019566059112548828
local_output_nid generation:  0.007859230041503906
local_in_edges_tensor generation:  0.030246973037719727
mini_batch_src_global generation:  0.028831005096435547
r_  generation:  0.261303186416626
local_output_nid generation:  0.011537551879882812
local_in_edges_tensor generation:  0.01738429069519043
mini_batch_src_global generation:  0.033437252044677734
r_  generation:  0.26711416244506836
local_output_nid generation:  0.011707544326782227
local_in_edges_tensor generation:  0.019620418548583984
mini_batch_src_global generation:  0.03266644477844238
r_  generation:  0.271575927734375
local_output_nid generation:  0.011650323867797852
local_in_edges_tensor generation:  0.015662431716918945
mini_batch_src_global generation:  0.03496861457824707
r_  generation:  0.2645704746246338
local_output_nid generation:  0.012721061706542969
local_in_edges_tensor generation:  0.014769792556762695
mini_batch_src_global generation:  0.033203840255737305
r_  generation:  0.2789011001586914
local_output_nid generation:  0.012724876403808594
local_in_edges_tensor generation:  0.01506948471069336
mini_batch_src_global generation:  0.036638736724853516
r_  generation:  0.27295637130737305
local_output_nid generation:  0.012900829315185547
local_in_edges_tensor generation:  0.019335031509399414
mini_batch_src_global generation:  0.033693552017211914
r_  generation:  0.2760043144226074
local_output_nid generation:  0.013025045394897461
local_in_edges_tensor generation:  0.013822317123413086
mini_batch_src_global generation:  0.03408026695251465
r_  generation:  0.31833529472351074
local_output_nid generation:  0.01705169677734375
local_in_edges_tensor generation:  0.017780780792236328
mini_batch_src_global generation:  0.04044914245605469
r_  generation:  0.28655266761779785
local_output_nid generation:  0.013109445571899414
local_in_edges_tensor generation:  0.015143632888793945
mini_batch_src_global generation:  0.03626084327697754
r_  generation:  0.2823679447174072
local_output_nid generation:  0.012896299362182617
local_in_edges_tensor generation:  0.01589488983154297
mini_batch_src_global generation:  0.036885976791381836
r_  generation:  0.2821238040924072
local_output_nid generation:  0.012664318084716797
local_in_edges_tensor generation:  0.020711183547973633
mini_batch_src_global generation:  0.0448765754699707
r_  generation:  0.2872164249420166
local_output_nid generation:  0.015053987503051758
local_in_edges_tensor generation:  0.014435052871704102
mini_batch_src_global generation:  0.03523588180541992
r_  generation:  0.2755744457244873
local_output_nid generation:  0.013134002685546875
local_in_edges_tensor generation:  0.013964653015136719
mini_batch_src_global generation:  0.039423227310180664
r_  generation:  0.28827524185180664
local_output_nid generation:  0.012929677963256836
local_in_edges_tensor generation:  0.015073060989379883
mini_batch_src_global generation:  0.03458094596862793
r_  generation:  0.29665517807006836
local_output_nid generation:  0.013028860092163086
local_in_edges_tensor generation:  0.014247894287109375
mini_batch_src_global generation:  0.034568071365356445
r_  generation:  0.28777074813842773
----------------------check_connections_block total spend ----------------------------- 6.498765468597412
generate_one_block  0.372847318649292
generate_one_block  0.3537464141845703
generate_one_block  0.3640751838684082
generate_one_block  0.3514997959136963
generate_one_block  0.36112403869628906
generate_one_block  0.35258913040161133
generate_one_block  0.3852198123931885
generate_one_block  0.3556864261627197
generate_one_block  0.35584592819213867
generate_one_block  0.34906840324401855
generate_one_block  0.3469855785369873
generate_one_block  0.35552167892456055
generate_one_block  0.34497785568237305
generate_one_block  0.36913037300109863
generate_one_block  0.3572988510131836
generate_one_block  0.3559081554412842
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04720473289489746
gen group dst list time:  0.06439971923828125
time for parepare:  0.019112348556518555
local_output_nid generation:  0.026088237762451172
local_in_edges_tensor generation:  0.0535130500793457
mini_batch_src_global generation:  0.04170656204223633
r_  generation:  0.471998929977417
local_output_nid generation:  0.03140568733215332
local_in_edges_tensor generation:  0.045630455017089844
mini_batch_src_global generation:  0.05338931083679199
r_  generation:  0.47344970703125
local_output_nid generation:  0.03171205520629883
local_in_edges_tensor generation:  0.034572601318359375
mini_batch_src_global generation:  0.06347322463989258
r_  generation:  0.4843270778656006
local_output_nid generation:  0.0325777530670166
local_in_edges_tensor generation:  0.03192925453186035
mini_batch_src_global generation:  0.05143022537231445
r_  generation:  0.47611117362976074
local_output_nid generation:  0.03208303451538086
local_in_edges_tensor generation:  0.08119487762451172
mini_batch_src_global generation:  0.054802894592285156
r_  generation:  0.48632359504699707
local_output_nid generation:  0.03282356262207031
local_in_edges_tensor generation:  0.036203861236572266
mini_batch_src_global generation:  0.055109500885009766
r_  generation:  0.48161792755126953
local_output_nid generation:  0.03182029724121094
local_in_edges_tensor generation:  0.033298492431640625
mini_batch_src_global generation:  0.05499911308288574
r_  generation:  0.49774646759033203
local_output_nid generation:  0.03520989418029785
local_in_edges_tensor generation:  0.039882659912109375
mini_batch_src_global generation:  0.05584406852722168
r_  generation:  0.4803903102874756
local_output_nid generation:  0.03448963165283203
local_in_edges_tensor generation:  0.03145265579223633
mini_batch_src_global generation:  0.05251264572143555
r_  generation:  0.4845154285430908
local_output_nid generation:  0.03290390968322754
local_in_edges_tensor generation:  0.032178640365600586
mini_batch_src_global generation:  0.05580925941467285
r_  generation:  0.4809412956237793
local_output_nid generation:  0.03306746482849121
local_in_edges_tensor generation:  0.03154468536376953
mini_batch_src_global generation:  0.05356144905090332
r_  generation:  0.4870467185974121
local_output_nid generation:  0.03318166732788086
local_in_edges_tensor generation:  0.03400015830993652
mini_batch_src_global generation:  0.05406332015991211
r_  generation:  0.483121395111084
local_output_nid generation:  0.03310823440551758
local_in_edges_tensor generation:  0.03094768524169922
mini_batch_src_global generation:  0.05330514907836914
r_  generation:  0.4853200912475586
local_output_nid generation:  0.03338265419006348
local_in_edges_tensor generation:  0.030513525009155273
mini_batch_src_global generation:  0.057248592376708984
r_  generation:  0.4850747585296631
local_output_nid generation:  0.03321194648742676
local_in_edges_tensor generation:  0.03684568405151367
mini_batch_src_global generation:  0.05286669731140137
r_  generation:  0.4888467788696289
local_output_nid generation:  0.03291797637939453
local_in_edges_tensor generation:  0.03041863441467285
mini_batch_src_global generation:  0.054167747497558594
r_  generation:  0.5018820762634277
----------------------check_connections_block total spend ----------------------------- 11.465510368347168
generate_one_block  0.6010739803314209
generate_one_block  0.5998873710632324
generate_one_block  0.5948376655578613
generate_one_block  0.5925593376159668
generate_one_block  0.6029236316680908
generate_one_block  0.5984780788421631
generate_one_block  0.5994901657104492
generate_one_block  0.6289341449737549
generate_one_block  0.6693320274353027
generate_one_block  0.5993602275848389
generate_one_block  0.6091980934143066
generate_one_block  0.5964086055755615
generate_one_block  0.5915312767028809
generate_one_block  0.602942943572998
generate_one_block  0.6008396148681641
generate_one_block  0.5920634269714355
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.12292003631591797  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

connection checking time:  17.96427583694458
block generation total time  15.411385536193848
average batch blocks generation time:  0.9632115960121155
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09764766693115234  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7749409675598145  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09752225875854492  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7686796188354492  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09751701354980469  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7712516784667969  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0971364974975586  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7605710029602051  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09748029708862305  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7704672813415527  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09724617004394531  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7647075653076172  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09746789932250977  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7655057907104492  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09748077392578125  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7667412757873535  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09752941131591797  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7710585594177246  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09743881225585938  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7658567428588867  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09750223159790039  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7703647613525391  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09760093688964844  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7719793319702148  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09728670120239258  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7638540267944336  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09777116775512695  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.775658130645752  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09743642807006836  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7690896987915039  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09736776351928711  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7642927169799805  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06346000730991364 |0.018183350563049316 |0.00353790819644928 |9.393692016601562e-05 |0.003569662570953369 |0.002007722854614258 |
----------------------------------------------------------pseudo_mini_loss sum 2.0933737754821777
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  5319110
Number of first layer input nodes during this epoch:  2509693
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12322139739990234  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0240020751953125
range selection method range initialization spend 0.012578964233398438
time for parepare:  0.018758296966552734
local_output_nid generation:  0.0014238357543945312
local_in_edges_tensor generation:  0.0070760250091552734
mini_batch_src_global generation:  0.0020208358764648438
r_  generation:  0.02032637596130371
local_output_nid generation:  0.0016503334045410156
local_in_edges_tensor generation:  0.0011935234069824219
mini_batch_src_global generation:  0.002291440963745117
r_  generation:  0.02240133285522461
local_output_nid generation:  0.0016169548034667969
local_in_edges_tensor generation:  0.0010366439819335938
mini_batch_src_global generation:  0.0017685890197753906
r_  generation:  0.022657394409179688
local_output_nid generation:  0.0016543865203857422
local_in_edges_tensor generation:  0.0009620189666748047
mini_batch_src_global generation:  0.0017490386962890625
r_  generation:  0.021955013275146484
local_output_nid generation:  0.0016317367553710938
local_in_edges_tensor generation:  0.0009412765502929688
mini_batch_src_global generation:  0.0017545223236083984
r_  generation:  0.022414207458496094
local_output_nid generation:  0.0016145706176757812
local_in_edges_tensor generation:  0.0009655952453613281
mini_batch_src_global generation:  0.0017371177673339844
r_  generation:  0.022932767868041992
local_output_nid generation:  0.0016369819641113281
local_in_edges_tensor generation:  0.0009334087371826172
mini_batch_src_global generation:  0.0017821788787841797
r_  generation:  0.022920608520507812
local_output_nid generation:  0.001638650894165039
local_in_edges_tensor generation:  0.0009562969207763672
mini_batch_src_global generation:  0.0017998218536376953
r_  generation:  0.022930622100830078
local_output_nid generation:  0.0016827583312988281
local_in_edges_tensor generation:  0.0009779930114746094
mini_batch_src_global generation:  0.001804351806640625
r_  generation:  0.022550582885742188
local_output_nid generation:  0.0016665458679199219
local_in_edges_tensor generation:  0.0009622573852539062
mini_batch_src_global generation:  0.0017819404602050781
r_  generation:  0.02204751968383789
local_output_nid generation:  0.0016274452209472656
local_in_edges_tensor generation:  0.0009493827819824219
mini_batch_src_global generation:  0.0017747879028320312
r_  generation:  0.02259683609008789
local_output_nid generation:  0.0016565322875976562
local_in_edges_tensor generation:  0.0009388923645019531
mini_batch_src_global generation:  0.0017359256744384766
r_  generation:  0.02223682403564453
local_output_nid generation:  0.0016431808471679688
local_in_edges_tensor generation:  0.0009410381317138672
mini_batch_src_global generation:  0.0017063617706298828
r_  generation:  0.02219223976135254
local_output_nid generation:  0.0016436576843261719
local_in_edges_tensor generation:  0.0009167194366455078
mini_batch_src_global generation:  0.0017096996307373047
r_  generation:  0.02211928367614746
local_output_nid generation:  0.0016164779663085938
local_in_edges_tensor generation:  0.0009109973907470703
mini_batch_src_global generation:  0.0017848014831542969
r_  generation:  0.023031949996948242
local_output_nid generation:  0.0016407966613769531
local_in_edges_tensor generation:  0.0009114742279052734
mini_batch_src_global generation:  0.0017910003662109375
r_  generation:  0.02249622344970703
----------------------check_connections_block total spend ----------------------------- 0.5317232608795166
generate_one_block  0.02990126609802246
generate_one_block  0.0314936637878418
generate_one_block  0.03188633918762207
generate_one_block  0.031160354614257812
generate_one_block  0.03130316734313965
generate_one_block  0.03399229049682617
generate_one_block  0.03151679039001465
generate_one_block  0.03184008598327637
generate_one_block  0.031235933303833008
generate_one_block  0.030991315841674805
generate_one_block  0.03152608871459961
generate_one_block  0.030888795852661133
generate_one_block  0.030541181564331055
generate_one_block  0.030621767044067383
generate_one_block  0.031764984130859375
generate_one_block  0.0319523811340332
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04872441291809082
gen group dst list time:  0.01798844337463379
time for parepare:  0.020441532135009766
local_output_nid generation:  0.007307291030883789
local_in_edges_tensor generation:  0.02466893196105957
mini_batch_src_global generation:  0.025796175003051758
r_  generation:  0.2505192756652832
local_output_nid generation:  0.011214733123779297
local_in_edges_tensor generation:  0.017459630966186523
mini_batch_src_global generation:  0.0332639217376709
r_  generation:  0.26920485496520996
local_output_nid generation:  0.011893510818481445
local_in_edges_tensor generation:  0.0171353816986084
mini_batch_src_global generation:  0.03375053405761719
r_  generation:  0.27741312980651855
local_output_nid generation:  0.012630224227905273
local_in_edges_tensor generation:  0.015040159225463867
mini_batch_src_global generation:  0.03242135047912598
r_  generation:  0.2742621898651123
local_output_nid generation:  0.01290440559387207
local_in_edges_tensor generation:  0.015074968338012695
mini_batch_src_global generation:  0.032866716384887695
r_  generation:  0.27742552757263184
local_output_nid generation:  0.0129241943359375
local_in_edges_tensor generation:  0.013889789581298828
mini_batch_src_global generation:  0.03756904602050781
r_  generation:  0.2890152931213379
local_output_nid generation:  0.013948917388916016
local_in_edges_tensor generation:  0.02010059356689453
mini_batch_src_global generation:  0.034450531005859375
r_  generation:  0.2782905101776123
local_output_nid generation:  0.01348423957824707
local_in_edges_tensor generation:  0.016449928283691406
mini_batch_src_global generation:  0.03592419624328613
r_  generation:  0.28525781631469727
local_output_nid generation:  0.015311479568481445
local_in_edges_tensor generation:  0.020439624786376953
mini_batch_src_global generation:  0.035771846771240234
r_  generation:  0.2974977493286133
local_output_nid generation:  0.017921924591064453
local_in_edges_tensor generation:  0.017676830291748047
mini_batch_src_global generation:  0.03451848030090332
r_  generation:  0.2754788398742676
local_output_nid generation:  0.013282299041748047
local_in_edges_tensor generation:  0.015930891036987305
mini_batch_src_global generation:  0.034586191177368164
r_  generation:  0.28681254386901855
local_output_nid generation:  0.013134956359863281
local_in_edges_tensor generation:  0.018967151641845703
mini_batch_src_global generation:  0.03435468673706055
r_  generation:  0.2794368267059326
local_output_nid generation:  0.012682199478149414
local_in_edges_tensor generation:  0.018199920654296875
mini_batch_src_global generation:  0.03809809684753418
r_  generation:  0.2693023681640625
local_output_nid generation:  0.013589620590209961
local_in_edges_tensor generation:  0.019474029541015625
mini_batch_src_global generation:  0.03560161590576172
r_  generation:  0.2761874198913574
local_output_nid generation:  0.013059854507446289
local_in_edges_tensor generation:  0.017302274703979492
mini_batch_src_global generation:  0.035713911056518555
r_  generation:  0.2793123722076416
local_output_nid generation:  0.012848854064941406
local_in_edges_tensor generation:  0.016309738159179688
mini_batch_src_global generation:  0.03450822830200195
r_  generation:  0.2780478000640869
----------------------check_connections_block total spend ----------------------------- 6.4455931186676025
generate_one_block  0.3606984615325928
generate_one_block  0.3626117706298828
generate_one_block  0.3663768768310547
generate_one_block  0.3542032241821289
generate_one_block  0.3508932590484619
generate_one_block  0.35894012451171875
generate_one_block  0.37937402725219727
generate_one_block  0.36313343048095703
generate_one_block  0.36919498443603516
generate_one_block  0.348651647567749
generate_one_block  0.3546333312988281
generate_one_block  0.35655879974365234
generate_one_block  0.3412930965423584
generate_one_block  0.34973955154418945
generate_one_block  0.36159300804138184
generate_one_block  0.35237693786621094
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0340728759765625
gen group dst list time:  0.06626677513122559
time for parepare:  0.0196688175201416
local_output_nid generation:  0.026545047760009766
local_in_edges_tensor generation:  0.05485248565673828
mini_batch_src_global generation:  0.04361915588378906
r_  generation:  0.4652702808380127
local_output_nid generation:  0.031101703643798828
local_in_edges_tensor generation:  0.03872084617614746
mini_batch_src_global generation:  0.05335688591003418
r_  generation:  0.4730226993560791
local_output_nid generation:  0.031496286392211914
local_in_edges_tensor generation:  0.03451228141784668
mini_batch_src_global generation:  0.05060839653015137
r_  generation:  0.47919368743896484
local_output_nid generation:  0.03202509880065918
local_in_edges_tensor generation:  0.04459977149963379
mini_batch_src_global generation:  0.05176210403442383
r_  generation:  0.4776017665863037
local_output_nid generation:  0.03259778022766113
local_in_edges_tensor generation:  0.07907938957214355
mini_batch_src_global generation:  0.05378842353820801
r_  generation:  0.5008459091186523
local_output_nid generation:  0.03495144844055176
local_in_edges_tensor generation:  0.03273630142211914
mini_batch_src_global generation:  0.05657696723937988
r_  generation:  0.48836851119995117
local_output_nid generation:  0.03289604187011719
local_in_edges_tensor generation:  0.031996726989746094
mini_batch_src_global generation:  0.05322146415710449
r_  generation:  0.47936296463012695
local_output_nid generation:  0.03326082229614258
local_in_edges_tensor generation:  0.03076791763305664
mini_batch_src_global generation:  0.05436968803405762
r_  generation:  0.48192882537841797
local_output_nid generation:  0.032912492752075195
local_in_edges_tensor generation:  0.034757375717163086
mini_batch_src_global generation:  0.053740739822387695
r_  generation:  0.48492908477783203
local_output_nid generation:  0.033199310302734375
local_in_edges_tensor generation:  0.03275871276855469
mini_batch_src_global generation:  0.05469942092895508
r_  generation:  0.4856681823730469
local_output_nid generation:  0.0331881046295166
local_in_edges_tensor generation:  0.03338813781738281
mini_batch_src_global generation:  0.054418087005615234
r_  generation:  0.486957311630249
local_output_nid generation:  0.033089399337768555
local_in_edges_tensor generation:  0.03041362762451172
mini_batch_src_global generation:  0.05420398712158203
r_  generation:  0.49453163146972656
local_output_nid generation:  0.03317403793334961
local_in_edges_tensor generation:  0.030961990356445312
mini_batch_src_global generation:  0.053656578063964844
r_  generation:  0.4844789505004883
local_output_nid generation:  0.03308844566345215
local_in_edges_tensor generation:  0.03251457214355469
mini_batch_src_global generation:  0.05653119087219238
r_  generation:  0.4839928150177002
local_output_nid generation:  0.03334355354309082
local_in_edges_tensor generation:  0.0345611572265625
mini_batch_src_global generation:  0.05383801460266113
r_  generation:  0.48943543434143066
local_output_nid generation:  0.03331589698791504
local_in_edges_tensor generation:  0.03567910194396973
mini_batch_src_global generation:  0.05392932891845703
r_  generation:  0.4877474308013916
----------------------check_connections_block total spend ----------------------------- 11.444949865341187
generate_one_block  0.5977799892425537
generate_one_block  0.6019694805145264
generate_one_block  0.6112198829650879
generate_one_block  0.5923459529876709
generate_one_block  0.6000795364379883
generate_one_block  0.5970337390899658
generate_one_block  0.5890564918518066
generate_one_block  0.6014325618743896
generate_one_block  0.631941556930542
generate_one_block  0.6017091274261475
generate_one_block  0.5939018726348877
generate_one_block  0.6057271957397461
generate_one_block  0.6130514144897461
generate_one_block  0.6035053730010986
generate_one_block  0.6006026268005371
generate_one_block  0.5959770679473877
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12322139739990234  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

connection checking time:  17.89054298400879
block generation total time  15.367606401443481
average batch blocks generation time:  0.9604754000902176
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09719610214233398  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7598171234130859  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09758806228637695  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7683181762695312  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09766721725463867  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7755255699157715  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09761285781860352  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7718081474304199  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09733009338378906  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7676577568054199  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09777164459228516  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7754244804382324  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09740972518920898  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7653284072875977  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09761857986450195  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7744846343994141  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09748697280883789  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7655329704284668  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09738683700561523  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7687511444091797  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09740924835205078  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7672953605651855  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09734106063842773  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7627544403076172  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09710550308227539  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7611522674560547  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09736204147338867  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7657675743103027  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09782028198242188  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7750463485717773  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09737634658813477  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.764376163482666  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06550325453281403 |0.018092095851898193 |0.0036314278841018677 |9.268522262573242e-05 |0.003695562481880188 |0.001760721206665039 |
----------------------------------------------------------pseudo_mini_loss sum 1.954155683517456
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  5318297
Number of first layer input nodes during this epoch:  2509991
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12306880950927734  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02341604232788086
range selection method range initialization spend 0.013493537902832031
time for parepare:  0.018301010131835938
local_output_nid generation:  0.0013968944549560547
local_in_edges_tensor generation:  0.006856679916381836
mini_batch_src_global generation:  0.001965761184692383
r_  generation:  0.02998518943786621
local_output_nid generation:  0.0020275115966796875
local_in_edges_tensor generation:  0.0012078285217285156
mini_batch_src_global generation:  0.0024344921112060547
r_  generation:  0.022667646408081055
local_output_nid generation:  0.0020148754119873047
local_in_edges_tensor generation:  0.0011684894561767578
mini_batch_src_global generation:  0.001743316650390625
r_  generation:  0.021127700805664062
local_output_nid generation:  0.0020728111267089844
local_in_edges_tensor generation:  0.00109100341796875
mini_batch_src_global generation:  0.0017125606536865234
r_  generation:  0.020598649978637695
local_output_nid generation:  0.001867532730102539
local_in_edges_tensor generation:  0.0010786056518554688
mini_batch_src_global generation:  0.0016875267028808594
r_  generation:  0.021190404891967773
local_output_nid generation:  0.0019080638885498047
local_in_edges_tensor generation:  0.0010225772857666016
mini_batch_src_global generation:  0.0039370059967041016
r_  generation:  0.020971298217773438
local_output_nid generation:  0.0018455982208251953
local_in_edges_tensor generation:  0.0010366439819335938
mini_batch_src_global generation:  0.0017216205596923828
r_  generation:  0.021743059158325195
local_output_nid generation:  0.0018775463104248047
local_in_edges_tensor generation:  0.0010221004486083984
mini_batch_src_global generation:  0.0017306804656982422
r_  generation:  0.021528959274291992
local_output_nid generation:  0.0018284320831298828
local_in_edges_tensor generation:  0.001087188720703125
mini_batch_src_global generation:  0.0018353462219238281
r_  generation:  0.022493600845336914
local_output_nid generation:  0.0018830299377441406
local_in_edges_tensor generation:  0.0010781288146972656
mini_batch_src_global generation:  0.0018067359924316406
r_  generation:  0.021587848663330078
local_output_nid generation:  0.0018756389617919922
local_in_edges_tensor generation:  0.0010900497436523438
mini_batch_src_global generation:  0.0017843246459960938
r_  generation:  0.022869586944580078
local_output_nid generation:  0.0019080638885498047
local_in_edges_tensor generation:  0.00103759765625
mini_batch_src_global generation:  0.0018634796142578125
r_  generation:  0.0220944881439209
local_output_nid generation:  0.001833200454711914
local_in_edges_tensor generation:  0.0010423660278320312
mini_batch_src_global generation:  0.001832723617553711
r_  generation:  0.022939443588256836
local_output_nid generation:  0.0019211769104003906
local_in_edges_tensor generation:  0.0010864734649658203
mini_batch_src_global generation:  0.004002094268798828
r_  generation:  0.021851301193237305
local_output_nid generation:  0.0018811225891113281
local_in_edges_tensor generation:  0.0010280609130859375
mini_batch_src_global generation:  0.0018317699432373047
r_  generation:  0.022662639617919922
local_output_nid generation:  0.0018773078918457031
local_in_edges_tensor generation:  0.001074075698852539
mini_batch_src_global generation:  0.001829385757446289
r_  generation:  0.02213430404663086
----------------------check_connections_block total spend ----------------------------- 0.5480144023895264
generate_one_block  0.04135560989379883
generate_one_block  0.03397536277770996
generate_one_block  0.03144025802612305
generate_one_block  0.03146719932556152
generate_one_block  0.031177997589111328
generate_one_block  0.03478693962097168
generate_one_block  0.03413891792297363
generate_one_block  0.03230762481689453
generate_one_block  0.03260469436645508
generate_one_block  0.03137779235839844
generate_one_block  0.03653287887573242
generate_one_block  0.031890869140625
generate_one_block  0.03220200538635254
generate_one_block  0.033178091049194336
generate_one_block  0.03260231018066406
generate_one_block  0.04905819892883301
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.043138980865478516
gen group dst list time:  0.019344091415405273
time for parepare:  0.01914381980895996
local_output_nid generation:  0.0075185298919677734
local_in_edges_tensor generation:  0.024451255798339844
mini_batch_src_global generation:  0.02606511116027832
r_  generation:  0.2588493824005127
local_output_nid generation:  0.011217594146728516
local_in_edges_tensor generation:  0.017496585845947266
mini_batch_src_global generation:  0.03501081466674805
r_  generation:  0.2703893184661865
local_output_nid generation:  0.01199197769165039
local_in_edges_tensor generation:  0.015002965927124023
mini_batch_src_global generation:  0.032303810119628906
r_  generation:  0.2723090648651123
local_output_nid generation:  0.01235818862915039
local_in_edges_tensor generation:  0.018181562423706055
mini_batch_src_global generation:  0.03433561325073242
r_  generation:  0.2861459255218506
local_output_nid generation:  0.01421976089477539
local_in_edges_tensor generation:  0.014896154403686523
mini_batch_src_global generation:  0.033197641372680664
r_  generation:  0.2733340263366699
local_output_nid generation:  0.013112306594848633
local_in_edges_tensor generation:  0.014845132827758789
mini_batch_src_global generation:  0.03363800048828125
r_  generation:  0.288895845413208
local_output_nid generation:  0.013333320617675781
local_in_edges_tensor generation:  0.014569282531738281
mini_batch_src_global generation:  0.03516793251037598
r_  generation:  0.2787516117095947
local_output_nid generation:  0.01355600357055664
local_in_edges_tensor generation:  0.014492273330688477
mini_batch_src_global generation:  0.034598350524902344
r_  generation:  0.2802152633666992
local_output_nid generation:  0.013462305068969727
local_in_edges_tensor generation:  0.019300460815429688
mini_batch_src_global generation:  0.03691554069519043
r_  generation:  0.28313136100769043
local_output_nid generation:  0.013303279876708984
local_in_edges_tensor generation:  0.018102407455444336
mini_batch_src_global generation:  0.035004615783691406
r_  generation:  0.2722806930541992
local_output_nid generation:  0.013488054275512695
local_in_edges_tensor generation:  0.01775217056274414
mini_batch_src_global generation:  0.03466510772705078
r_  generation:  0.2834787368774414
local_output_nid generation:  0.014383316040039062
local_in_edges_tensor generation:  0.01856541633605957
mini_batch_src_global generation:  0.034503936767578125
r_  generation:  0.2781703472137451
local_output_nid generation:  0.013026714324951172
local_in_edges_tensor generation:  0.016263246536254883
mini_batch_src_global generation:  0.03625845909118652
r_  generation:  0.292560338973999
local_output_nid generation:  0.014816522598266602
local_in_edges_tensor generation:  0.013765096664428711
mini_batch_src_global generation:  0.03519105911254883
r_  generation:  0.27312350273132324
local_output_nid generation:  0.01295018196105957
local_in_edges_tensor generation:  0.014121294021606445
mini_batch_src_global generation:  0.03624153137207031
r_  generation:  0.27852630615234375
local_output_nid generation:  0.012819051742553711
local_in_edges_tensor generation:  0.013909101486206055
mini_batch_src_global generation:  0.03426957130432129
r_  generation:  0.2703220844268799
----------------------check_connections_block total spend ----------------------------- 6.420686483383179
generate_one_block  0.35984325408935547
generate_one_block  0.3580000400543213
generate_one_block  0.3486483097076416
generate_one_block  0.3530900478363037
generate_one_block  0.3494422435760498
generate_one_block  0.34708356857299805
generate_one_block  0.3811345100402832
generate_one_block  0.3565657138824463
generate_one_block  0.35997915267944336
generate_one_block  0.3484339714050293
generate_one_block  0.3616323471069336
generate_one_block  0.35332322120666504
generate_one_block  0.3545236587524414
generate_one_block  0.3506922721862793
generate_one_block  0.3563971519470215
generate_one_block  0.34586524963378906
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03477740287780762
gen group dst list time:  0.07061338424682617
time for parepare:  0.019597291946411133
local_output_nid generation:  0.0263516902923584
local_in_edges_tensor generation:  0.053264617919921875
mini_batch_src_global generation:  0.0442960262298584
r_  generation:  0.4715862274169922
local_output_nid generation:  0.032113075256347656
local_in_edges_tensor generation:  0.037461280822753906
mini_batch_src_global generation:  0.05428886413574219
r_  generation:  0.4770348072052002
local_output_nid generation:  0.032501220703125
local_in_edges_tensor generation:  0.0315699577331543
mini_batch_src_global generation:  0.052093505859375
r_  generation:  0.48141956329345703
local_output_nid generation:  0.03284502029418945
local_in_edges_tensor generation:  0.029766082763671875
mini_batch_src_global generation:  0.05169844627380371
r_  generation:  0.48438000679016113
local_output_nid generation:  0.0322721004486084
local_in_edges_tensor generation:  0.07449126243591309
mini_batch_src_global generation:  0.06597280502319336
r_  generation:  0.48739194869995117
local_output_nid generation:  0.03234434127807617
local_in_edges_tensor generation:  0.030170917510986328
mini_batch_src_global generation:  0.055052757263183594
r_  generation:  0.4878349304199219
local_output_nid generation:  0.03216075897216797
local_in_edges_tensor generation:  0.02963995933532715
mini_batch_src_global generation:  0.053314924240112305
r_  generation:  0.4886648654937744
local_output_nid generation:  0.033132076263427734
local_in_edges_tensor generation:  0.03033304214477539
mini_batch_src_global generation:  0.05395913124084473
r_  generation:  0.49170470237731934
local_output_nid generation:  0.03258943557739258
local_in_edges_tensor generation:  0.03432655334472656
mini_batch_src_global generation:  0.05503344535827637
r_  generation:  0.4902317523956299
local_output_nid generation:  0.03262019157409668
local_in_edges_tensor generation:  0.029956340789794922
mini_batch_src_global generation:  0.05657196044921875
r_  generation:  0.4934680461883545
local_output_nid generation:  0.032830238342285156
local_in_edges_tensor generation:  0.03842568397521973
mini_batch_src_global generation:  0.05617713928222656
r_  generation:  0.4890007972717285
local_output_nid generation:  0.03267097473144531
local_in_edges_tensor generation:  0.030504465103149414
mini_batch_src_global generation:  0.055136680603027344
r_  generation:  0.49483823776245117
local_output_nid generation:  0.03261256217956543
local_in_edges_tensor generation:  0.03265881538391113
mini_batch_src_global generation:  0.060353755950927734
r_  generation:  0.493546724319458
local_output_nid generation:  0.03313302993774414
local_in_edges_tensor generation:  0.037631988525390625
mini_batch_src_global generation:  0.05350995063781738
r_  generation:  0.491426944732666
local_output_nid generation:  0.0328524112701416
local_in_edges_tensor generation:  0.03596758842468262
mini_batch_src_global generation:  0.05399274826049805
r_  generation:  0.48952198028564453
local_output_nid generation:  0.03283381462097168
local_in_edges_tensor generation:  0.03200268745422363
mini_batch_src_global generation:  0.055074214935302734
r_  generation:  0.49095582962036133
----------------------check_connections_block total spend ----------------------------- 11.508936882019043
generate_one_block  0.6022887229919434
generate_one_block  0.5978939533233643
generate_one_block  0.605353832244873
generate_one_block  0.597642183303833
generate_one_block  0.5931448936462402
generate_one_block  0.5920026302337646
generate_one_block  0.5990359783172607
generate_one_block  0.6024718284606934
generate_one_block  0.6840438842773438
generate_one_block  0.5956454277038574
generate_one_block  0.5997447967529297
generate_one_block  0.5948877334594727
generate_one_block  0.5987322330474854
generate_one_block  0.596811056137085
generate_one_block  0.6011512279510498
generate_one_block  0.5958831310272217
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12306880950927734  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

connection checking time:  17.92962336540222
block generation total time  15.34138822555542
average batch blocks generation time:  0.9588367640972137
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0973820686340332  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7649965286254883  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09753131866455078  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7708234786987305  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09747743606567383  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7672009468078613  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09751129150390625  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7710528373718262  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09736442565917969  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7658843994140625  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09743452072143555  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7699761390686035  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09749364852905273  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7656750679016113  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09749031066894531  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7662105560302734  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09743547439575195  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7661423683166504  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09725332260131836  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7619137763977051  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09751605987548828  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7706904411315918  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0975332260131836  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.767113208770752  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09759712219238281  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7745475769042969  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09752130508422852  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7656426429748535  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09766864776611328  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7748856544494629  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09735488891601562  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7683329582214355  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0630851686000824 |0.014410123229026794 |0.003729194402694702 |9.335577487945557e-05 |0.0033522993326187134 |0.0030999183654785156 |
----------------------------------------------------------pseudo_mini_loss sum 1.8711527585983276
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  5319427
Number of first layer input nodes during this epoch:  2510178
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.1229410171508789  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023699522018432617
range selection method range initialization spend 0.01209712028503418
time for parepare:  0.019929885864257812
local_output_nid generation:  0.0013930797576904297
local_in_edges_tensor generation:  0.008446931838989258
mini_batch_src_global generation:  0.0020186901092529297
r_  generation:  0.023532390594482422
local_output_nid generation:  0.0016512870788574219
local_in_edges_tensor generation:  0.0010318756103515625
mini_batch_src_global generation:  0.002424478530883789
r_  generation:  0.022669076919555664
local_output_nid generation:  0.0016715526580810547
local_in_edges_tensor generation:  0.0009708404541015625
mini_batch_src_global generation:  0.0016853809356689453
r_  generation:  0.02170705795288086
local_output_nid generation:  0.001688241958618164
local_in_edges_tensor generation:  0.0009443759918212891
mini_batch_src_global generation:  0.0017156600952148438
r_  generation:  0.021860361099243164
local_output_nid generation:  0.0016639232635498047
local_in_edges_tensor generation:  0.001148223876953125
mini_batch_src_global generation:  0.0017745494842529297
r_  generation:  0.02213764190673828
local_output_nid generation:  0.0016286373138427734
local_in_edges_tensor generation:  0.0009391307830810547
mini_batch_src_global generation:  0.0017294883728027344
r_  generation:  0.021742582321166992
local_output_nid generation:  0.0016295909881591797
local_in_edges_tensor generation:  0.0009512901306152344
mini_batch_src_global generation:  0.0017843246459960938
r_  generation:  0.02276468276977539
local_output_nid generation:  0.0016510486602783203
local_in_edges_tensor generation:  0.0009660720825195312
mini_batch_src_global generation:  0.001798868179321289
r_  generation:  0.02232193946838379
local_output_nid generation:  0.001695394515991211
local_in_edges_tensor generation:  0.0009338855743408203
mini_batch_src_global generation:  0.0019843578338623047
r_  generation:  0.022905826568603516
local_output_nid generation:  0.001646280288696289
local_in_edges_tensor generation:  0.000949859619140625
mini_batch_src_global generation:  0.0018477439880371094
r_  generation:  0.022582292556762695
local_output_nid generation:  0.0016353130340576172
local_in_edges_tensor generation:  0.0009403228759765625
mini_batch_src_global generation:  0.00188446044921875
r_  generation:  0.023122072219848633
local_output_nid generation:  0.0016469955444335938
local_in_edges_tensor generation:  0.0009522438049316406
mini_batch_src_global generation:  0.0018053054809570312
r_  generation:  0.022426366806030273
local_output_nid generation:  0.0016427040100097656
local_in_edges_tensor generation:  0.0009012222290039062
mini_batch_src_global generation:  0.0017707347869873047
r_  generation:  0.022645235061645508
local_output_nid generation:  0.0016689300537109375
local_in_edges_tensor generation:  0.0008864402770996094
mini_batch_src_global generation:  0.001750946044921875
r_  generation:  0.022561073303222656
local_output_nid generation:  0.0016634464263916016
local_in_edges_tensor generation:  0.0009353160858154297
mini_batch_src_global generation:  0.0017638206481933594
r_  generation:  0.02205634117126465
local_output_nid generation:  0.0016314983367919922
local_in_edges_tensor generation:  0.0010607242584228516
mini_batch_src_global generation:  0.0017445087432861328
r_  generation:  0.022862672805786133
----------------------check_connections_block total spend ----------------------------- 0.5370988845825195
generate_one_block  0.031143665313720703
generate_one_block  0.0312197208404541
generate_one_block  0.030976057052612305
generate_one_block  0.030518770217895508
generate_one_block  0.031083106994628906
generate_one_block  0.03244304656982422
generate_one_block  0.03230857849121094
generate_one_block  0.031288862228393555
generate_one_block  0.03216958045959473
generate_one_block  0.03130340576171875
generate_one_block  0.03230404853820801
generate_one_block  0.03169608116149902
generate_one_block  0.031434059143066406
generate_one_block  0.031642913818359375
generate_one_block  0.0307614803314209
generate_one_block  0.032210588455200195
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04293680191040039
gen group dst list time:  0.0184476375579834
time for parepare:  0.02089524269104004
local_output_nid generation:  0.007415056228637695
local_in_edges_tensor generation:  0.02741551399230957
mini_batch_src_global generation:  0.026301145553588867
r_  generation:  0.25817227363586426
local_output_nid generation:  0.011255264282226562
local_in_edges_tensor generation:  0.01702570915222168
mini_batch_src_global generation:  0.033138275146484375
r_  generation:  0.2598381042480469
local_output_nid generation:  0.011639833450317383
local_in_edges_tensor generation:  0.013230085372924805
mini_batch_src_global generation:  0.032390594482421875
r_  generation:  0.26815080642700195
local_output_nid generation:  0.012313127517700195
local_in_edges_tensor generation:  0.0130462646484375
mini_batch_src_global generation:  0.03294181823730469
r_  generation:  0.2657768726348877
local_output_nid generation:  0.014433622360229492
local_in_edges_tensor generation:  0.015033721923828125
mini_batch_src_global generation:  0.03301405906677246
r_  generation:  0.2749350070953369
local_output_nid generation:  0.012612104415893555
local_in_edges_tensor generation:  0.015281915664672852
mini_batch_src_global generation:  0.033627986907958984
r_  generation:  0.2799561023712158
local_output_nid generation:  0.013409137725830078
local_in_edges_tensor generation:  0.014999866485595703
mini_batch_src_global generation:  0.03688383102416992
r_  generation:  0.28362154960632324
local_output_nid generation:  0.013238191604614258
local_in_edges_tensor generation:  0.0169832706451416
mini_batch_src_global generation:  0.03469038009643555
r_  generation:  0.2720150947570801
local_output_nid generation:  0.013413190841674805
local_in_edges_tensor generation:  0.013706684112548828
mini_batch_src_global generation:  0.034383535385131836
r_  generation:  0.28666019439697266
local_output_nid generation:  0.01326298713684082
local_in_edges_tensor generation:  0.014055013656616211
mini_batch_src_global generation:  0.03437185287475586
r_  generation:  0.2845029830932617
local_output_nid generation:  0.014323949813842773
local_in_edges_tensor generation:  0.016559123992919922
mini_batch_src_global generation:  0.03716111183166504
r_  generation:  0.28940320014953613
local_output_nid generation:  0.01334238052368164
local_in_edges_tensor generation:  0.014092206954956055
mini_batch_src_global generation:  0.03451228141784668
r_  generation:  0.2805347442626953
local_output_nid generation:  0.013482332229614258
local_in_edges_tensor generation:  0.014426231384277344
mini_batch_src_global generation:  0.03585243225097656
r_  generation:  0.285430908203125
local_output_nid generation:  0.012865543365478516
local_in_edges_tensor generation:  0.019669771194458008
mini_batch_src_global generation:  0.034964799880981445
r_  generation:  0.28360915184020996
local_output_nid generation:  0.012470722198486328
local_in_edges_tensor generation:  0.018434762954711914
mini_batch_src_global generation:  0.034357309341430664
r_  generation:  0.2771620750427246
local_output_nid generation:  0.012796878814697266
local_in_edges_tensor generation:  0.015275955200195312
mini_batch_src_global generation:  0.03489232063293457
r_  generation:  0.2928938865661621
----------------------check_connections_block total spend ----------------------------- 6.411074876785278
generate_one_block  0.36700916290283203
generate_one_block  0.3465616703033447
generate_one_block  0.353226900100708
generate_one_block  0.3442528247833252
generate_one_block  0.3474709987640381
generate_one_block  0.34732937812805176
generate_one_block  0.3841257095336914
generate_one_block  0.34415411949157715
generate_one_block  0.3645904064178467
generate_one_block  0.36850643157958984
generate_one_block  0.36298584938049316
generate_one_block  0.35506558418273926
generate_one_block  0.35289764404296875
generate_one_block  0.3551449775695801
generate_one_block  0.3475768566131592
generate_one_block  0.3553040027618408
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03474617004394531
gen group dst list time:  0.06680417060852051
time for parepare:  0.01804065704345703
local_output_nid generation:  0.026598215103149414
local_in_edges_tensor generation:  0.050106048583984375
mini_batch_src_global generation:  0.04190778732299805
r_  generation:  0.47267961502075195
local_output_nid generation:  0.03082895278930664
local_in_edges_tensor generation:  0.03870344161987305
mini_batch_src_global generation:  0.05252957344055176
r_  generation:  0.4721505641937256
local_output_nid generation:  0.03205537796020508
local_in_edges_tensor generation:  0.03213810920715332
mini_batch_src_global generation:  0.05281329154968262
r_  generation:  0.486483097076416
local_output_nid generation:  0.031656742095947266
local_in_edges_tensor generation:  0.035854339599609375
mini_batch_src_global generation:  0.051683902740478516
r_  generation:  0.47704386711120605
local_output_nid generation:  0.031970977783203125
local_in_edges_tensor generation:  0.08130192756652832
mini_batch_src_global generation:  0.058754682540893555
r_  generation:  0.4933149814605713
local_output_nid generation:  0.03193473815917969
local_in_edges_tensor generation:  0.03522896766662598
mini_batch_src_global generation:  0.05555987358093262
r_  generation:  0.4893507957458496
local_output_nid generation:  0.03404116630554199
local_in_edges_tensor generation:  0.0315701961517334
mini_batch_src_global generation:  0.05275130271911621
r_  generation:  0.4908316135406494
local_output_nid generation:  0.03308892250061035
local_in_edges_tensor generation:  0.03700733184814453
mini_batch_src_global generation:  0.0535433292388916
r_  generation:  0.4839611053466797
local_output_nid generation:  0.032857656478881836
local_in_edges_tensor generation:  0.03174424171447754
mini_batch_src_global generation:  0.05269670486450195
r_  generation:  0.48867321014404297
local_output_nid generation:  0.03324294090270996
local_in_edges_tensor generation:  0.03070807456970215
mini_batch_src_global generation:  0.053659915924072266
r_  generation:  0.48038291931152344
local_output_nid generation:  0.033342599868774414
local_in_edges_tensor generation:  0.03369474411010742
mini_batch_src_global generation:  0.05453372001647949
r_  generation:  0.4895956516265869
local_output_nid generation:  0.033235788345336914
local_in_edges_tensor generation:  0.03120732307434082
mini_batch_src_global generation:  0.059705495834350586
r_  generation:  0.4807627201080322
local_output_nid generation:  0.03338479995727539
local_in_edges_tensor generation:  0.033350229263305664
mini_batch_src_global generation:  0.05472397804260254
r_  generation:  0.48991990089416504
local_output_nid generation:  0.03331327438354492
local_in_edges_tensor generation:  0.03174638748168945
mini_batch_src_global generation:  0.0561525821685791
r_  generation:  0.48557543754577637
local_output_nid generation:  0.03325700759887695
local_in_edges_tensor generation:  0.03400611877441406
mini_batch_src_global generation:  0.05386710166931152
r_  generation:  0.48961496353149414
local_output_nid generation:  0.03344917297363281
local_in_edges_tensor generation:  0.03313732147216797
mini_batch_src_global generation:  0.056555986404418945
r_  generation:  0.4814121723175049
----------------------check_connections_block total spend ----------------------------- 11.458988666534424
generate_one_block  0.6033179759979248
generate_one_block  0.5989806652069092
generate_one_block  0.5917882919311523
generate_one_block  0.5966250896453857
generate_one_block  0.5971801280975342
generate_one_block  0.5983278751373291
generate_one_block  0.601395845413208
generate_one_block  0.6060383319854736
generate_one_block  0.6261510848999023
generate_one_block  0.6064136028289795
generate_one_block  0.6070544719696045
generate_one_block  0.5992224216461182
generate_one_block  0.615023136138916
generate_one_block  0.5999877452850342
generate_one_block  0.5998773574829102
generate_one_block  0.616774320602417
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.1229410171508789  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

connection checking time:  17.870063543319702
block generation total time  15.360360860824585
average batch blocks generation time:  0.9600225538015366
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09747743606567383  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7676200866699219  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09745645523071289  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7650928497314453  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09742593765258789  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7643170356750488  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09723854064941406  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.762049674987793  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09733009338378906  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7660884857177734  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0973196029663086  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7629203796386719  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09756231307983398  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.771090030670166  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09732723236083984  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7696733474731445  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09758472442626953  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7711000442504883  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09753179550170898  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7664680480957031  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09772920608520508  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7756919860839844  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09742307662963867  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7660942077636719  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09756755828857422  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7748966217041016  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09745073318481445  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7712640762329102  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09731245040893555  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.763209342956543  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0975184440612793  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7744283676147461  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06630538403987885 |0.01612800359725952 |0.003673255443572998 |9.526312351226807e-05 |0.0037110596895217896 |0.0029294490814208984 |
----------------------------------------------------------pseudo_mini_loss sum 1.791858434677124
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  5318028
Number of first layer input nodes during this epoch:  2509101
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12347888946533203  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02349233627319336
range selection method range initialization spend 0.012440681457519531
time for parepare:  0.017505645751953125
local_output_nid generation:  0.0014045238494873047
local_in_edges_tensor generation:  0.006926536560058594
mini_batch_src_global generation:  0.0017018318176269531
r_  generation:  0.02093672752380371
local_output_nid generation:  0.001583099365234375
local_in_edges_tensor generation:  0.000990152359008789
mini_batch_src_global generation:  0.0020627975463867188
r_  generation:  0.022643327713012695
local_output_nid generation:  0.0015735626220703125
local_in_edges_tensor generation:  0.0009634494781494141
mini_batch_src_global generation:  0.001699209213256836
r_  generation:  0.02125263214111328
local_output_nid generation:  0.0016257762908935547
local_in_edges_tensor generation:  0.0009572505950927734
mini_batch_src_global generation:  0.0017158985137939453
r_  generation:  0.021809816360473633
local_output_nid generation:  0.0015628337860107422
local_in_edges_tensor generation:  0.000949859619140625
mini_batch_src_global generation:  0.0017862319946289062
r_  generation:  0.022607088088989258
local_output_nid generation:  0.0015926361083984375
local_in_edges_tensor generation:  0.0010404586791992188
mini_batch_src_global generation:  0.0017769336700439453
r_  generation:  0.022524595260620117
local_output_nid generation:  0.0015807151794433594
local_in_edges_tensor generation:  0.0009496212005615234
mini_batch_src_global generation:  0.0018074512481689453
r_  generation:  0.02301192283630371
local_output_nid generation:  0.0016047954559326172
local_in_edges_tensor generation:  0.000997781753540039
mini_batch_src_global generation:  0.0018301010131835938
r_  generation:  0.0227663516998291
local_output_nid generation:  0.0016279220581054688
local_in_edges_tensor generation:  0.0009505748748779297
mini_batch_src_global generation:  0.001783132553100586
r_  generation:  0.022317171096801758
local_output_nid generation:  0.001584768295288086
local_in_edges_tensor generation:  0.0009644031524658203
mini_batch_src_global generation:  0.0017254352569580078
r_  generation:  0.022202491760253906
local_output_nid generation:  0.0015671253204345703
local_in_edges_tensor generation:  0.0009083747863769531
mini_batch_src_global generation:  0.0017218589782714844
r_  generation:  0.022592782974243164
local_output_nid generation:  0.001583099365234375
local_in_edges_tensor generation:  0.0009577274322509766
mini_batch_src_global generation:  0.0018038749694824219
r_  generation:  0.022869110107421875
local_output_nid generation:  0.0015883445739746094
local_in_edges_tensor generation:  0.0009496212005615234
mini_batch_src_global generation:  0.001767873764038086
r_  generation:  0.022219181060791016
local_output_nid generation:  0.0015664100646972656
local_in_edges_tensor generation:  0.000926971435546875
mini_batch_src_global generation:  0.0017580986022949219
r_  generation:  0.02263808250427246
local_output_nid generation:  0.0015933513641357422
local_in_edges_tensor generation:  0.0009028911590576172
mini_batch_src_global generation:  0.0018160343170166016
r_  generation:  0.023115873336791992
local_output_nid generation:  0.0016036033630371094
local_in_edges_tensor generation:  0.0009372234344482422
mini_batch_src_global generation:  0.0017833709716796875
r_  generation:  0.02298116683959961
----------------------check_connections_block total spend ----------------------------- 0.5290687084197998
generate_one_block  0.030080795288085938
generate_one_block  0.032190561294555664
generate_one_block  0.034522294998168945
generate_one_block  0.0311431884765625
generate_one_block  0.03165125846862793
generate_one_block  0.03351426124572754
generate_one_block  0.03189897537231445
generate_one_block  0.03145885467529297
generate_one_block  0.030997753143310547
generate_one_block  0.030892133712768555
generate_one_block  0.03164362907409668
generate_one_block  0.03187441825866699
generate_one_block  0.031296491622924805
generate_one_block  0.0353541374206543
generate_one_block  0.03238534927368164
generate_one_block  0.03177952766418457
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.13529419898986816
gen group dst list time:  0.020575284957885742
time for parepare:  0.01939558982849121
local_output_nid generation:  0.007323503494262695
local_in_edges_tensor generation:  0.021594762802124023
mini_batch_src_global generation:  0.02618885040283203
r_  generation:  0.26878929138183594
local_output_nid generation:  0.01127004623413086
local_in_edges_tensor generation:  0.017356157302856445
mini_batch_src_global generation:  0.03585243225097656
r_  generation:  0.2715425491333008
local_output_nid generation:  0.011227846145629883
local_in_edges_tensor generation:  0.016876220703125
mini_batch_src_global generation:  0.047025203704833984
r_  generation:  0.26618456840515137
local_output_nid generation:  0.012261152267456055
local_in_edges_tensor generation:  0.01414632797241211
mini_batch_src_global generation:  0.0364995002746582
r_  generation:  0.2801661491394043
local_output_nid generation:  0.013764381408691406
local_in_edges_tensor generation:  0.02110457420349121
mini_batch_src_global generation:  0.04035496711730957
r_  generation:  0.2869687080383301
local_output_nid generation:  0.01298069953918457
local_in_edges_tensor generation:  0.018078327178955078
mini_batch_src_global generation:  0.04724550247192383
r_  generation:  0.28919148445129395
local_output_nid generation:  0.013216018676757812
local_in_edges_tensor generation:  0.016998767852783203
mini_batch_src_global generation:  0.038581132888793945
r_  generation:  0.29168248176574707
local_output_nid generation:  0.01548624038696289
local_in_edges_tensor generation:  0.020050525665283203
mini_batch_src_global generation:  0.03412961959838867
r_  generation:  0.2789578437805176
local_output_nid generation:  0.013475418090820312
local_in_edges_tensor generation:  0.014755487442016602
mini_batch_src_global generation:  0.058063507080078125
r_  generation:  0.282001256942749
local_output_nid generation:  0.013535261154174805
local_in_edges_tensor generation:  0.0167691707611084
mini_batch_src_global generation:  0.039144039154052734
r_  generation:  0.2758767604827881
local_output_nid generation:  0.0137176513671875
local_in_edges_tensor generation:  0.020784378051757812
mini_batch_src_global generation:  0.034718990325927734
r_  generation:  0.28600287437438965
local_output_nid generation:  0.014478921890258789
local_in_edges_tensor generation:  0.01728081703186035
mini_batch_src_global generation:  0.03756070137023926
r_  generation:  0.2911210060119629
local_output_nid generation:  0.013752460479736328
local_in_edges_tensor generation:  0.01745462417602539
mini_batch_src_global generation:  0.03615140914916992
r_  generation:  0.2804393768310547
local_output_nid generation:  0.0135345458984375
local_in_edges_tensor generation:  0.014790534973144531
mini_batch_src_global generation:  0.03874611854553223
r_  generation:  0.28751564025878906
local_output_nid generation:  0.013526201248168945
local_in_edges_tensor generation:  0.018999814987182617
mini_batch_src_global generation:  0.03816962242126465
r_  generation:  0.28714513778686523
local_output_nid generation:  0.01318979263305664
local_in_edges_tensor generation:  0.014771699905395508
mini_batch_src_global generation:  0.047704219818115234
r_  generation:  0.28574395179748535
----------------------check_connections_block total spend ----------------------------- 6.605960845947266
generate_one_block  0.3540475368499756
generate_one_block  0.3495063781738281
generate_one_block  0.34052157402038574
generate_one_block  0.35053133964538574
generate_one_block  0.373366117477417
generate_one_block  0.36435604095458984
generate_one_block  0.3836963176727295
generate_one_block  0.3562610149383545
generate_one_block  0.353851318359375
generate_one_block  0.3444511890411377
generate_one_block  0.3560457229614258
generate_one_block  0.36158227920532227
generate_one_block  0.3488903045654297
generate_one_block  0.3602628707885742
generate_one_block  0.3651878833770752
generate_one_block  0.3665769100189209
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03375959396362305
gen group dst list time:  0.06718301773071289
time for parepare:  0.019503355026245117
local_output_nid generation:  0.02616405487060547
local_in_edges_tensor generation:  0.06079912185668945
mini_batch_src_global generation:  0.04521369934082031
r_  generation:  0.49214887619018555
local_output_nid generation:  0.034210920333862305
local_in_edges_tensor generation:  0.043164968490600586
mini_batch_src_global generation:  0.05583047866821289
r_  generation:  0.47332191467285156
local_output_nid generation:  0.032663583755493164
local_in_edges_tensor generation:  0.029242515563964844
mini_batch_src_global generation:  0.05115532875061035
r_  generation:  0.4983501434326172
local_output_nid generation:  0.03274822235107422
local_in_edges_tensor generation:  0.030820846557617188
mini_batch_src_global generation:  0.05188584327697754
r_  generation:  0.48394274711608887
local_output_nid generation:  0.034365177154541016
local_in_edges_tensor generation:  0.08596634864807129
mini_batch_src_global generation:  0.05221748352050781
r_  generation:  0.49268388748168945
local_output_nid generation:  0.032930850982666016
local_in_edges_tensor generation:  0.04011940956115723
mini_batch_src_global generation:  0.0533747673034668
r_  generation:  0.48784852027893066
local_output_nid generation:  0.03296327590942383
local_in_edges_tensor generation:  0.03550529479980469
mini_batch_src_global generation:  0.05635380744934082
r_  generation:  0.4932384490966797
local_output_nid generation:  0.03282308578491211
local_in_edges_tensor generation:  0.0343630313873291
mini_batch_src_global generation:  0.0540471076965332
r_  generation:  0.49439454078674316
local_output_nid generation:  0.034576416015625
local_in_edges_tensor generation:  0.03631234169006348
mini_batch_src_global generation:  0.05335402488708496
r_  generation:  0.488889217376709
local_output_nid generation:  0.03364086151123047
local_in_edges_tensor generation:  0.03338623046875
mini_batch_src_global generation:  0.053802490234375
r_  generation:  0.4877338409423828
local_output_nid generation:  0.03342771530151367
local_in_edges_tensor generation:  0.029371023178100586
mini_batch_src_global generation:  0.05346417427062988
r_  generation:  0.510488748550415
local_output_nid generation:  0.033537864685058594
local_in_edges_tensor generation:  0.031560659408569336
mini_batch_src_global generation:  0.055748939514160156
r_  generation:  0.49150657653808594
local_output_nid generation:  0.03620648384094238
local_in_edges_tensor generation:  0.03220868110656738
mini_batch_src_global generation:  0.05508732795715332
r_  generation:  0.49068570137023926
local_output_nid generation:  0.0337519645690918
local_in_edges_tensor generation:  0.029691457748413086
mini_batch_src_global generation:  0.05797219276428223
r_  generation:  0.4925079345703125
local_output_nid generation:  0.03371787071228027
local_in_edges_tensor generation:  0.035864830017089844
mini_batch_src_global generation:  0.05475282669067383
r_  generation:  0.493182897567749
local_output_nid generation:  0.03343391418457031
local_in_edges_tensor generation:  0.03361082077026367
mini_batch_src_global generation:  0.054567813873291016
r_  generation:  0.4908308982849121
----------------------check_connections_block total spend ----------------------------- 11.625402450561523
generate_one_block  0.6047782897949219
generate_one_block  0.5950424671173096
generate_one_block  0.6040019989013672
generate_one_block  0.5918896198272705
generate_one_block  0.6178901195526123
generate_one_block  0.604306697845459
generate_one_block  0.5931038856506348
generate_one_block  0.5979640483856201
generate_one_block  0.6749467849731445
generate_one_block  0.5999433994293213
generate_one_block  0.6013295650482178
generate_one_block  0.6065683364868164
generate_one_block  0.6046185493469238
generate_one_block  0.6019394397735596
generate_one_block  0.6126346588134766
generate_one_block  0.6176440715789795
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12347888946533203  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

connection checking time:  18.23136329650879
block generation total time  15.457736730575562
average batch blocks generation time:  0.9661085456609726
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09724617004394531  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7611904144287109  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09746980667114258  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7689337730407715  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09723520278930664  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7627291679382324  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09726810455322266  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7634387016296387  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09763431549072266  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7750349044799805  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09770345687866211  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7718296051025391  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09733772277832031  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7664327621459961  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09741973876953125  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7661013603210449  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09745931625366211  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7692651748657227  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09722423553466797  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7640976905822754  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09749317169189453  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7657361030578613  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0975790023803711  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7723026275634766  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09748458862304688  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7662653923034668  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09755849838256836  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7677836418151855  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09770870208740234  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.775881290435791  GigaBytes
Max Memory Allocated: 0.8649606704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09770059585571289  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.775026798248291  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06211349368095398 |0.013769537210464478 |0.003582969307899475 |9.316205978393555e-05 |0.003435492515563965 |0.001987934112548828 |
----------------------------------------------------------pseudo_mini_loss sum 1.6982512474060059
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  5318618
Number of first layer input nodes during this epoch:  2509649
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.1238546371459961  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025804519653320312
range selection method range initialization spend 0.012177705764770508
time for parepare:  0.01793956756591797
local_output_nid generation:  0.0014455318450927734
local_in_edges_tensor generation:  0.007735013961791992
mini_batch_src_global generation:  0.003304004669189453
r_  generation:  0.027319908142089844
local_output_nid generation:  0.00202178955078125
local_in_edges_tensor generation:  0.0011317729949951172
mini_batch_src_global generation:  0.002383708953857422
r_  generation:  0.022703886032104492
local_output_nid generation:  0.002005338668823242
local_in_edges_tensor generation:  0.0010726451873779297
mini_batch_src_global generation:  0.0017459392547607422
r_  generation:  0.021387100219726562
local_output_nid generation:  0.0019860267639160156
local_in_edges_tensor generation:  0.001055002212524414
mini_batch_src_global generation:  0.0017724037170410156
r_  generation:  0.022012710571289062
local_output_nid generation:  0.0019252300262451172
local_in_edges_tensor generation:  0.0010232925415039062
mini_batch_src_global generation:  0.0018949508666992188
r_  generation:  0.02200913429260254
local_output_nid generation:  0.0019326210021972656
local_in_edges_tensor generation:  0.001020669937133789
mini_batch_src_global generation:  0.0018451213836669922
r_  generation:  0.022258520126342773
local_output_nid generation:  0.0020694732666015625
local_in_edges_tensor generation:  0.001013040542602539
mini_batch_src_global generation:  0.0018889904022216797
r_  generation:  0.022917985916137695
local_output_nid generation:  0.001918792724609375
local_in_edges_tensor generation:  0.001041412353515625
mini_batch_src_global generation:  0.0018367767333984375
r_  generation:  0.02222585678100586
local_output_nid generation:  0.0018968582153320312
local_in_edges_tensor generation:  0.0009784698486328125
mini_batch_src_global generation:  0.0017664432525634766
r_  generation:  0.021811246871948242
local_output_nid generation:  0.0019104480743408203
local_in_edges_tensor generation:  0.0009989738464355469
mini_batch_src_global generation:  0.0017590522766113281
r_  generation:  0.02272796630859375
local_output_nid generation:  0.001917123794555664
local_in_edges_tensor generation:  0.0010159015655517578
mini_batch_src_global generation:  0.0017464160919189453
r_  generation:  0.022249937057495117
local_output_nid generation:  0.0018947124481201172
local_in_edges_tensor generation:  0.0011327266693115234
mini_batch_src_global generation:  0.0018770694732666016
r_  generation:  0.023008108139038086
local_output_nid generation:  0.0018901824951171875
local_in_edges_tensor generation:  0.0010132789611816406
mini_batch_src_global generation:  0.0018379688262939453
r_  generation:  0.022833824157714844
local_output_nid generation:  0.0019044876098632812
local_in_edges_tensor generation:  0.0009770393371582031
mini_batch_src_global generation:  0.001752614974975586
r_  generation:  0.022056102752685547
local_output_nid generation:  0.001912832260131836
local_in_edges_tensor generation:  0.0010178089141845703
mini_batch_src_global generation:  0.0019533634185791016
r_  generation:  0.022936582565307617
local_output_nid generation:  0.0018165111541748047
local_in_edges_tensor generation:  0.0009951591491699219
mini_batch_src_global generation:  0.0018990039825439453
r_  generation:  0.02314162254333496
----------------------check_connections_block total spend ----------------------------- 0.5513510704040527
generate_one_block  0.04355335235595703
generate_one_block  0.033289194107055664
generate_one_block  0.03886675834655762
generate_one_block  0.035498619079589844
generate_one_block  0.052510976791381836
generate_one_block  0.03774690628051758
generate_one_block  0.043863773345947266
generate_one_block  0.03457927703857422
generate_one_block  0.031331777572631836
generate_one_block  0.03264021873474121
generate_one_block  0.034485578536987305
generate_one_block  0.03321266174316406
generate_one_block  0.03659462928771973
generate_one_block  0.032335519790649414
generate_one_block  0.03204536437988281
generate_one_block  0.03372502326965332
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.044580936431884766
gen group dst list time:  0.017853498458862305
time for parepare:  0.021287202835083008
local_output_nid generation:  0.010009288787841797
local_in_edges_tensor generation:  0.023735761642456055
mini_batch_src_global generation:  0.02581048011779785
r_  generation:  0.25827860832214355
local_output_nid generation:  0.011297941207885742
local_in_edges_tensor generation:  0.01941394805908203
mini_batch_src_global generation:  0.04410982131958008
r_  generation:  0.2689530849456787
local_output_nid generation:  0.013051271438598633
local_in_edges_tensor generation:  0.017168045043945312
mini_batch_src_global generation:  0.032266855239868164
r_  generation:  0.27490973472595215
local_output_nid generation:  0.012875080108642578
local_in_edges_tensor generation:  0.015441656112670898
mini_batch_src_global generation:  0.03463411331176758
r_  generation:  0.27396273612976074
local_output_nid generation:  0.012810945510864258
local_in_edges_tensor generation:  0.014594078063964844
mini_batch_src_global generation:  0.03344607353210449
r_  generation:  0.2829601764678955
local_output_nid generation:  0.013068675994873047
local_in_edges_tensor generation:  0.01324319839477539
mini_batch_src_global generation:  0.03344154357910156
r_  generation:  0.2754545211791992
local_output_nid generation:  0.013532161712646484
local_in_edges_tensor generation:  0.013690471649169922
mini_batch_src_global generation:  0.03422379493713379
r_  generation:  0.2812221050262451
local_output_nid generation:  0.013334274291992188
local_in_edges_tensor generation:  0.013223886489868164
mini_batch_src_global generation:  0.03339505195617676
r_  generation:  0.2753744125366211
local_output_nid generation:  0.013478517532348633
local_in_edges_tensor generation:  0.01336979866027832
mini_batch_src_global generation:  0.033477783203125
r_  generation:  0.27498364448547363
local_output_nid generation:  0.01369929313659668
local_in_edges_tensor generation:  0.016109228134155273
mini_batch_src_global generation:  0.0354764461517334
r_  generation:  0.2813987731933594
local_output_nid generation:  0.016144990921020508
local_in_edges_tensor generation:  0.01441335678100586
mini_batch_src_global generation:  0.033945560455322266
r_  generation:  0.27763819694519043
local_output_nid generation:  0.01377248764038086
local_in_edges_tensor generation:  0.023250341415405273
mini_batch_src_global generation:  0.03615450859069824
r_  generation:  0.2856638431549072
local_output_nid generation:  0.013700485229492188
local_in_edges_tensor generation:  0.018285274505615234
mini_batch_src_global generation:  0.03530144691467285
r_  generation:  0.2866706848144531
local_output_nid generation:  0.013549089431762695
local_in_edges_tensor generation:  0.018289804458618164
mini_batch_src_global generation:  0.03569650650024414
r_  generation:  0.27752065658569336
local_output_nid generation:  0.013102293014526367
local_in_edges_tensor generation:  0.014794111251831055
mini_batch_src_global generation:  0.03738689422607422
r_  generation:  0.28748106956481934
local_output_nid generation:  0.013138294219970703
local_in_edges_tensor generation:  0.015883207321166992
mini_batch_src_global generation:  0.037661075592041016
r_  generation:  0.2841372489929199
----------------------check_connections_block total spend ----------------------------- 6.430477619171143
generate_one_block  0.3655362129211426
generate_one_block  0.3477458953857422
generate_one_block  0.3514242172241211
generate_one_block  0.35739707946777344
generate_one_block  0.3643367290496826
generate_one_block  0.3590221405029297
generate_one_block  0.39152097702026367
generate_one_block  0.352445125579834
generate_one_block  0.34732508659362793
generate_one_block  0.3583378791809082
generate_one_block  0.35361671447753906
generate_one_block  0.36903810501098633
generate_one_block  0.35958337783813477
generate_one_block  0.3484988212585449
generate_one_block  0.359116792678833
generate_one_block  0.36010313034057617
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.08331894874572754
gen group dst list time:  0.06871175765991211
time for parepare:  0.019779443740844727
local_output_nid generation:  0.026515722274780273
local_in_edges_tensor generation:  0.05160808563232422
mini_batch_src_global generation:  0.044017791748046875
r_  generation:  0.4737844467163086
local_output_nid generation:  0.030827760696411133
local_in_edges_tensor generation:  0.03768754005432129
mini_batch_src_global generation:  0.05488920211791992
r_  generation:  0.47336268424987793
local_output_nid generation:  0.03092217445373535
local_in_edges_tensor generation:  0.031493186950683594
mini_batch_src_global generation:  0.0517580509185791
r_  generation:  0.49734067916870117
local_output_nid generation:  0.035794734954833984
local_in_edges_tensor generation:  0.03172659873962402
mini_batch_src_global generation:  0.05463981628417969
r_  generation:  0.47460389137268066
local_output_nid generation:  0.03258228302001953
local_in_edges_tensor generation:  0.08559727668762207
mini_batch_src_global generation:  0.05164051055908203
r_  generation:  0.48653244972229004
local_output_nid generation:  0.031770944595336914
local_in_edges_tensor generation:  0.033571720123291016
mini_batch_src_global generation:  0.053731441497802734
r_  generation:  0.48154592514038086
local_output_nid generation:  0.03154802322387695
local_in_edges_tensor generation:  0.029393672943115234
mini_batch_src_global generation:  0.052480220794677734
r_  generation:  0.49611902236938477
local_output_nid generation:  0.0319826602935791
local_in_edges_tensor generation:  0.03232383728027344
mini_batch_src_global generation:  0.053368330001831055
r_  generation:  0.48212265968322754
local_output_nid generation:  0.03168487548828125
local_in_edges_tensor generation:  0.03263044357299805
mini_batch_src_global generation:  0.05258631706237793
r_  generation:  0.4836912155151367
local_output_nid generation:  0.03184247016906738
local_in_edges_tensor generation:  0.03249955177307129
mini_batch_src_global generation:  0.054093122482299805
r_  generation:  0.4829268455505371
local_output_nid generation:  0.03184819221496582
local_in_edges_tensor generation:  0.034937381744384766
mini_batch_src_global generation:  0.05301260948181152
r_  generation:  0.4852111339569092
local_output_nid generation:  0.03201460838317871
local_in_edges_tensor generation:  0.03676891326904297
mini_batch_src_global generation:  0.05353713035583496
r_  generation:  0.4810049533843994
local_output_nid generation:  0.03319430351257324
local_in_edges_tensor generation:  0.03374743461608887
mini_batch_src_global generation:  0.05278372764587402
r_  generation:  0.49043846130371094
local_output_nid generation:  0.03229117393493652
local_in_edges_tensor generation:  0.029924631118774414
mini_batch_src_global generation:  0.0542597770690918
r_  generation:  0.4863743782043457
local_output_nid generation:  0.032370805740356445
local_in_edges_tensor generation:  0.032404422760009766
mini_batch_src_global generation:  0.05540156364440918
r_  generation:  0.488400936126709
local_output_nid generation:  0.0320591926574707
local_in_edges_tensor generation:  0.03708696365356445
mini_batch_src_global generation:  0.054132699966430664
r_  generation:  0.4819011688232422
----------------------check_connections_block total spend ----------------------------- 11.416293621063232
generate_one_block  0.6082115173339844
generate_one_block  0.5968825817108154
generate_one_block  0.5942153930664062
generate_one_block  0.5900313854217529
generate_one_block  0.5954015254974365
generate_one_block  0.5904989242553711
generate_one_block  0.5916910171508789
generate_one_block  0.5936412811279297
generate_one_block  0.6284284591674805
generate_one_block  0.5996737480163574
generate_one_block  0.596837043762207
generate_one_block  0.6025211811065674
generate_one_block  0.6025450229644775
generate_one_block  0.6087934970855713
generate_one_block  0.6057209968566895
generate_one_block  0.5946516990661621
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.1238546371459961  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

connection checking time:  17.846771240234375
block generation total time  15.344793558120728
average batch blocks generation time:  0.9590495973825455
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09729766845703125  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7645282745361328  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09743404388427734  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.769258975982666  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09735584259033203  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.763801097869873  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09736204147338867  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7651495933532715  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09758472442626953  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7723312377929688  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09729528427124023  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7638530731201172  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09753131866455078  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7710442543029785  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09738826751708984  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7662315368652344  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09734869003295898  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7649364471435547  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09756612777709961  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7743821144104004  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09741735458374023  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7653889656066895  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09758758544921875  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7750983238220215  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09741020202636719  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7672791481018066  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09749698638916016  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7693567276000977  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09757661819458008  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7748613357543945  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09735488891601562  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7695455551147461  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06754843890666962 |0.013395577669143677 |0.003434911370277405 |8.977949619293213e-05 |0.003731474280357361 |0.0015714168548583984 |
----------------------------------------------------------pseudo_mini_loss sum 1.6375612020492554
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  5318934
Number of first layer input nodes during this epoch:  2508923
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12332963943481445  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.06253314018249512
range selection method range initialization spend 0.015658140182495117
time for parepare:  0.01809835433959961
local_output_nid generation:  0.0014209747314453125
local_in_edges_tensor generation:  0.006104230880737305
mini_batch_src_global generation:  0.0020999908447265625
r_  generation:  0.023624897003173828
local_output_nid generation:  0.0016095638275146484
local_in_edges_tensor generation:  0.0009694099426269531
mini_batch_src_global generation:  0.0024077892303466797
r_  generation:  0.024663925170898438
local_output_nid generation:  0.001641988754272461
local_in_edges_tensor generation:  0.0009531974792480469
mini_batch_src_global generation:  0.0020492076873779297
r_  generation:  0.024476051330566406
local_output_nid generation:  0.0016705989837646484
local_in_edges_tensor generation:  0.0009443759918212891
mini_batch_src_global generation:  0.0021085739135742188
r_  generation:  0.024497509002685547
local_output_nid generation:  0.0016455650329589844
local_in_edges_tensor generation:  0.0009341239929199219
mini_batch_src_global generation:  0.0020787715911865234
r_  generation:  0.023702621459960938
local_output_nid generation:  0.0016057491302490234
local_in_edges_tensor generation:  0.0009424686431884766
mini_batch_src_global generation:  0.006791830062866211
r_  generation:  0.03199648857116699
local_output_nid generation:  0.002092123031616211
local_in_edges_tensor generation:  0.0011615753173828125
mini_batch_src_global generation:  0.0017871856689453125
r_  generation:  0.02144646644592285
local_output_nid generation:  0.0019252300262451172
local_in_edges_tensor generation:  0.0012242794036865234
mini_batch_src_global generation:  0.001756906509399414
r_  generation:  0.020765066146850586
local_output_nid generation:  0.006065845489501953
local_in_edges_tensor generation:  0.0020439624786376953
mini_batch_src_global generation:  0.007765769958496094
r_  generation:  0.02713155746459961
local_output_nid generation:  0.0018541812896728516
local_in_edges_tensor generation:  0.0009620189666748047
mini_batch_src_global generation:  0.003309011459350586
r_  generation:  0.030831098556518555
local_output_nid generation:  0.0018529891967773438
local_in_edges_tensor generation:  0.0011036396026611328
mini_batch_src_global generation:  0.0018069744110107422
r_  generation:  0.021472692489624023
local_output_nid generation:  0.0018281936645507812
local_in_edges_tensor generation:  0.0010776519775390625
mini_batch_src_global generation:  0.010260820388793945
r_  generation:  0.021644115447998047
local_output_nid generation:  0.0017940998077392578
local_in_edges_tensor generation:  0.0010492801666259766
mini_batch_src_global generation:  0.0018012523651123047
r_  generation:  0.021419048309326172
local_output_nid generation:  0.001766204833984375
local_in_edges_tensor generation:  0.0010573863983154297
mini_batch_src_global generation:  0.0019145011901855469
r_  generation:  0.021991729736328125
local_output_nid generation:  0.00180816650390625
local_in_edges_tensor generation:  0.0010743141174316406
mini_batch_src_global generation:  0.00180816650390625
r_  generation:  0.021030902862548828
local_output_nid generation:  0.0017266273498535156
local_in_edges_tensor generation:  0.0010523796081542969
mini_batch_src_global generation:  0.0017256736755371094
r_  generation:  0.02109694480895996
----------------------check_connections_block total spend ----------------------------- 0.6083540916442871
generate_one_block  0.037566423416137695
generate_one_block  0.031009435653686523
generate_one_block  0.03157615661621094
generate_one_block  0.03483223915100098
generate_one_block  0.0303494930267334
generate_one_block  0.03358864784240723
generate_one_block  0.032353878021240234
generate_one_block  0.03275799751281738
generate_one_block  0.031846046447753906
generate_one_block  0.0349886417388916
generate_one_block  0.0315403938293457
generate_one_block  0.04003453254699707
generate_one_block  0.037723541259765625
generate_one_block  0.03424525260925293
generate_one_block  0.033972740173339844
generate_one_block  0.033380746841430664
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03760218620300293
gen group dst list time:  0.021219253540039062
time for parepare:  0.020610809326171875
local_output_nid generation:  0.007712125778198242
local_in_edges_tensor generation:  0.02819514274597168
mini_batch_src_global generation:  0.026262760162353516
r_  generation:  0.2557194232940674
local_output_nid generation:  0.01124119758605957
local_in_edges_tensor generation:  0.017461061477661133
mini_batch_src_global generation:  0.03213310241699219
r_  generation:  0.2650144100189209
local_output_nid generation:  0.011834383010864258
local_in_edges_tensor generation:  0.015520572662353516
mini_batch_src_global generation:  0.03141903877258301
r_  generation:  0.26949167251586914
local_output_nid generation:  0.012410879135131836
local_in_edges_tensor generation:  0.014358758926391602
mini_batch_src_global generation:  0.03243446350097656
r_  generation:  0.2720627784729004
local_output_nid generation:  0.012673377990722656
local_in_edges_tensor generation:  0.01307821273803711
mini_batch_src_global generation:  0.033417701721191406
r_  generation:  0.2739570140838623
local_output_nid generation:  0.012780189514160156
local_in_edges_tensor generation:  0.014482498168945312
mini_batch_src_global generation:  0.03388166427612305
r_  generation:  0.2781956195831299
local_output_nid generation:  0.01283121109008789
local_in_edges_tensor generation:  0.01573944091796875
mini_batch_src_global generation:  0.03377366065979004
r_  generation:  0.2769465446472168
local_output_nid generation:  0.012742757797241211
local_in_edges_tensor generation:  0.016776084899902344
mini_batch_src_global generation:  0.03437304496765137
r_  generation:  0.27261924743652344
local_output_nid generation:  0.013152837753295898
local_in_edges_tensor generation:  0.013420581817626953
mini_batch_src_global generation:  0.03430366516113281
r_  generation:  0.28038501739501953
local_output_nid generation:  0.013177156448364258
local_in_edges_tensor generation:  0.014675140380859375
mini_batch_src_global generation:  0.035516977310180664
r_  generation:  0.3284018039703369
local_output_nid generation:  0.016334056854248047
local_in_edges_tensor generation:  0.01331472396850586
mini_batch_src_global generation:  0.0378108024597168
r_  generation:  0.28598952293395996
local_output_nid generation:  0.013270378112792969
local_in_edges_tensor generation:  0.015243291854858398
mini_batch_src_global generation:  0.0387725830078125
r_  generation:  0.28808093070983887
local_output_nid generation:  0.014230966567993164
local_in_edges_tensor generation:  0.016347646713256836
mini_batch_src_global generation:  0.03557848930358887
r_  generation:  0.2869758605957031
local_output_nid generation:  0.013753652572631836
local_in_edges_tensor generation:  0.019565582275390625
mini_batch_src_global generation:  0.03826761245727539
r_  generation:  0.2910029888153076
local_output_nid generation:  0.01286935806274414
local_in_edges_tensor generation:  0.02337026596069336
mini_batch_src_global generation:  0.0345158576965332
r_  generation:  0.29076433181762695
local_output_nid generation:  0.01511526107788086
local_in_edges_tensor generation:  0.015288114547729492
mini_batch_src_global generation:  0.0359346866607666
r_  generation:  0.27579164505004883
----------------------check_connections_block total spend ----------------------------- 6.474011421203613
generate_one_block  0.36455464363098145
generate_one_block  0.37998223304748535
generate_one_block  0.35817933082580566
generate_one_block  0.3587954044342041
generate_one_block  0.3545544147491455
generate_one_block  0.35749197006225586
generate_one_block  0.38811659812927246
generate_one_block  0.34661078453063965
generate_one_block  0.358325719833374
generate_one_block  0.36751627922058105
generate_one_block  0.3522031307220459
generate_one_block  0.3614990711212158
generate_one_block  0.34998369216918945
generate_one_block  0.36060023307800293
generate_one_block  0.34609127044677734
generate_one_block  0.3511929512023926
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03272247314453125
gen group dst list time:  0.07034087181091309
time for parepare:  0.019504308700561523
local_output_nid generation:  0.026674985885620117
local_in_edges_tensor generation:  0.04570746421813965
mini_batch_src_global generation:  0.043318748474121094
r_  generation:  0.4830183982849121
local_output_nid generation:  0.03110527992248535
local_in_edges_tensor generation:  0.039496660232543945
mini_batch_src_global generation:  0.05377912521362305
r_  generation:  0.4879179000854492
local_output_nid generation:  0.03225541114807129
local_in_edges_tensor generation:  0.03191208839416504
mini_batch_src_global generation:  0.051454782485961914
r_  generation:  0.48413991928100586
local_output_nid generation:  0.03234124183654785
local_in_edges_tensor generation:  0.03230428695678711
mini_batch_src_global generation:  0.05605721473693848
r_  generation:  0.4884064197540283
local_output_nid generation:  0.03337383270263672
local_in_edges_tensor generation:  0.07784891128540039
mini_batch_src_global generation:  0.05236506462097168
r_  generation:  0.4867978096008301
local_output_nid generation:  0.032501935958862305
local_in_edges_tensor generation:  0.03673958778381348
mini_batch_src_global generation:  0.05427074432373047
r_  generation:  0.48853421211242676
local_output_nid generation:  0.03235626220703125
local_in_edges_tensor generation:  0.032465219497680664
mini_batch_src_global generation:  0.05300760269165039
r_  generation:  0.48965001106262207
local_output_nid generation:  0.03271913528442383
local_in_edges_tensor generation:  0.03623199462890625
mini_batch_src_global generation:  0.056626319885253906
r_  generation:  0.4841654300689697
local_output_nid generation:  0.03250741958618164
local_in_edges_tensor generation:  0.030115365982055664
mini_batch_src_global generation:  0.05288267135620117
r_  generation:  0.4915783405303955
local_output_nid generation:  0.03287220001220703
local_in_edges_tensor generation:  0.032234907150268555
mini_batch_src_global generation:  0.058483123779296875
r_  generation:  0.5039808750152588
local_output_nid generation:  0.03580164909362793
local_in_edges_tensor generation:  0.032170772552490234
mini_batch_src_global generation:  0.057214975357055664
r_  generation:  0.49198412895202637
local_output_nid generation:  0.034740447998046875
local_in_edges_tensor generation:  0.03422379493713379
mini_batch_src_global generation:  0.056632280349731445
r_  generation:  0.48607850074768066
local_output_nid generation:  0.03391909599304199
local_in_edges_tensor generation:  0.030935287475585938
mini_batch_src_global generation:  0.05330371856689453
r_  generation:  0.4885401725769043
local_output_nid generation:  0.0338594913482666
local_in_edges_tensor generation:  0.0319364070892334
mini_batch_src_global generation:  0.056183576583862305
r_  generation:  0.48296141624450684
local_output_nid generation:  0.03366589546203613
local_in_edges_tensor generation:  0.030582666397094727
mini_batch_src_global generation:  0.0531463623046875
r_  generation:  0.48807692527770996
local_output_nid generation:  0.03363847732543945
local_in_edges_tensor generation:  0.031883955001831055
mini_batch_src_global generation:  0.07042407989501953
r_  generation:  0.49336719512939453
----------------------check_connections_block total spend ----------------------------- 11.53211784362793
generate_one_block  0.6040778160095215
generate_one_block  0.5968458652496338
generate_one_block  0.6046521663665771
generate_one_block  0.6043384075164795
generate_one_block  0.602893590927124
generate_one_block  0.6017141342163086
generate_one_block  0.5980913639068604
generate_one_block  0.5968422889709473
generate_one_block  0.6718733310699463
generate_one_block  0.6058082580566406
generate_one_block  0.5940818786621094
generate_one_block  0.5969300270080566
generate_one_block  0.5987122058868408
generate_one_block  0.599877119064331
generate_one_block  0.5901243686676025
generate_one_block  0.6034915447235107
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12332963943481445  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

connection checking time:  18.006129264831543
block generation total time  15.42605209350586
average batch blocks generation time:  0.9641282558441162
block dataloader generation time/epoch 35.883771896362305
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09752464294433594  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7718343734741211  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09743356704711914  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7653727531433105  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09741544723510742  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7714686393737793  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09754276275634766  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7717819213867188  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09736251831054688  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7628817558288574  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09740495681762695  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.767179012298584  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09722661972045898  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7642378807067871  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09714794158935547  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7628231048583984  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09746360778808594  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7717142105102539  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0975503921508789  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.768092155456543  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09733819961547852  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7669272422790527  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09747886657714844  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.771294116973877  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09746646881103516  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7673215866088867  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09773015975952148  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7759652137756348  GigaBytes
Max Memory Allocated: 0.8650698661804199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09734964370727539  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7626514434814453  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09748077392578125  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7668757438659668  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06298413872718811 |0.015246450901031494 |0.0035097748041152954 |9.235739707946777e-05 |0.0032604336738586426 |0.0015583038330078125 |
----------------------------------------------------------pseudo_mini_loss sum 1.5911064147949219
Total (block generation + training)time/epoch 37.31628108024597
Training time/epoch 1.4323077201843262
Training time without block to device /epoch 1.1883645057678223
Training time without total dataloading part /epoch 0.1113593578338623
load block tensor time/epoch 1.0077462196350098
block to device time/epoch 0.2439432144165039
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  5317844
Number of first layer input nodes during this epoch:  2508340
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12327337265014648  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02372455596923828
range selection method range initialization spend 0.012301206588745117
time for parepare:  0.02015066146850586
local_output_nid generation:  0.0014295578002929688
local_in_edges_tensor generation:  0.007511138916015625
mini_batch_src_global generation:  0.002175569534301758
r_  generation:  0.021225452423095703
local_output_nid generation:  0.0017516613006591797
local_in_edges_tensor generation:  0.0009799003601074219
mini_batch_src_global generation:  0.002313852310180664
r_  generation:  0.023009300231933594
local_output_nid generation:  0.0015740394592285156
local_in_edges_tensor generation:  0.0009629726409912109
mini_batch_src_global generation:  0.001714944839477539
r_  generation:  0.022680044174194336
local_output_nid generation:  0.0016109943389892578
local_in_edges_tensor generation:  0.0009961128234863281
mini_batch_src_global generation:  0.0017445087432861328
r_  generation:  0.021919727325439453
local_output_nid generation:  0.0015997886657714844
local_in_edges_tensor generation:  0.0009632110595703125
mini_batch_src_global generation:  0.0017714500427246094
r_  generation:  0.022084474563598633
local_output_nid generation:  0.001611948013305664
local_in_edges_tensor generation:  0.0009508132934570312
mini_batch_src_global generation:  0.0017435550689697266
r_  generation:  0.022603750228881836
local_output_nid generation:  0.0015876293182373047
local_in_edges_tensor generation:  0.0009207725524902344
mini_batch_src_global generation:  0.0017652511596679688
r_  generation:  0.023105144500732422
local_output_nid generation:  0.0015785694122314453
local_in_edges_tensor generation:  0.0009911060333251953
mini_batch_src_global generation:  0.0017843246459960938
r_  generation:  0.02218914031982422
local_output_nid generation:  0.00156402587890625
local_in_edges_tensor generation:  0.0009529590606689453
mini_batch_src_global generation:  0.0017650127410888672
r_  generation:  0.02288508415222168
local_output_nid generation:  0.0015692710876464844
local_in_edges_tensor generation:  0.0009441375732421875
mini_batch_src_global generation:  0.0018010139465332031
r_  generation:  0.02270650863647461
local_output_nid generation:  0.0015628337860107422
local_in_edges_tensor generation:  0.0009148120880126953
mini_batch_src_global generation:  0.001813650131225586
r_  generation:  0.022852182388305664
local_output_nid generation:  0.0015821456909179688
local_in_edges_tensor generation:  0.0010051727294921875
mini_batch_src_global generation:  0.0017533302307128906
r_  generation:  0.022331714630126953
local_output_nid generation:  0.001657724380493164
local_in_edges_tensor generation:  0.0009257793426513672
mini_batch_src_global generation:  0.0017347335815429688
r_  generation:  0.022367238998413086
local_output_nid generation:  0.0015761852264404297
local_in_edges_tensor generation:  0.0009920597076416016
mini_batch_src_global generation:  0.0017380714416503906
r_  generation:  0.02251911163330078
local_output_nid generation:  0.0015485286712646484
local_in_edges_tensor generation:  0.0010113716125488281
mini_batch_src_global generation:  0.0018074512481689453
r_  generation:  0.023082494735717773
local_output_nid generation:  0.0015468597412109375
local_in_edges_tensor generation:  0.0009367465972900391
mini_batch_src_global generation:  0.0017809867858886719
r_  generation:  0.022394895553588867
----------------------check_connections_block total spend ----------------------------- 0.5349364280700684
generate_one_block  0.030890703201293945
generate_one_block  0.03180742263793945
generate_one_block  0.03191828727722168
generate_one_block  0.030923843383789062
generate_one_block  0.03103160858154297
generate_one_block  0.03303670883178711
generate_one_block  0.03188133239746094
generate_one_block  0.031166553497314453
generate_one_block  0.03174328804016113
generate_one_block  0.03143596649169922
generate_one_block  0.03166007995605469
generate_one_block  0.030826330184936523
generate_one_block  0.03134465217590332
generate_one_block  0.031006813049316406
generate_one_block  0.032024383544921875
generate_one_block  0.03143429756164551
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.036736488342285156
gen group dst list time:  0.018616199493408203
time for parepare:  0.0195767879486084
local_output_nid generation:  0.007437229156494141
local_in_edges_tensor generation:  0.024917125701904297
mini_batch_src_global generation:  0.0265042781829834
r_  generation:  0.2561986446380615
local_output_nid generation:  0.011429309844970703
local_in_edges_tensor generation:  0.017205238342285156
mini_batch_src_global generation:  0.03309488296508789
r_  generation:  0.2685542106628418
local_output_nid generation:  0.011838674545288086
local_in_edges_tensor generation:  0.014411449432373047
mini_batch_src_global generation:  0.03411436080932617
r_  generation:  0.2758932113647461
local_output_nid generation:  0.012536048889160156
local_in_edges_tensor generation:  0.015494346618652344
mini_batch_src_global generation:  0.03219890594482422
r_  generation:  0.2739880084991455
local_output_nid generation:  0.012557744979858398
local_in_edges_tensor generation:  0.014513969421386719
mini_batch_src_global generation:  0.03306126594543457
r_  generation:  0.2772641181945801
local_output_nid generation:  0.012968301773071289
local_in_edges_tensor generation:  0.01613593101501465
mini_batch_src_global generation:  0.03372955322265625
r_  generation:  0.2810096740722656
local_output_nid generation:  0.013063669204711914
local_in_edges_tensor generation:  0.01378488540649414
mini_batch_src_global generation:  0.0356597900390625
r_  generation:  0.2843797206878662
local_output_nid generation:  0.013047456741333008
local_in_edges_tensor generation:  0.014744043350219727
mini_batch_src_global generation:  0.03556513786315918
r_  generation:  0.27620863914489746
local_output_nid generation:  0.013545513153076172
local_in_edges_tensor generation:  0.01805400848388672
mini_batch_src_global generation:  0.03469681739807129
r_  generation:  0.28420424461364746
local_output_nid generation:  0.014122486114501953
local_in_edges_tensor generation:  0.018570899963378906
mini_batch_src_global generation:  0.03436851501464844
r_  generation:  0.28340673446655273
local_output_nid generation:  0.013239622116088867
local_in_edges_tensor generation:  0.015201091766357422
mini_batch_src_global generation:  0.03568840026855469
r_  generation:  0.2797062397003174
local_output_nid generation:  0.013076543807983398
local_in_edges_tensor generation:  0.01826953887939453
mini_batch_src_global generation:  0.034781455993652344
r_  generation:  0.27394747734069824
local_output_nid generation:  0.013419151306152344
local_in_edges_tensor generation:  0.013859748840332031
mini_batch_src_global generation:  0.03389096260070801
r_  generation:  0.27577805519104004
local_output_nid generation:  0.013251781463623047
local_in_edges_tensor generation:  0.014763116836547852
mini_batch_src_global generation:  0.03574848175048828
r_  generation:  0.2816336154937744
local_output_nid generation:  0.013391256332397461
local_in_edges_tensor generation:  0.019054412841796875
mini_batch_src_global generation:  0.036416053771972656
r_  generation:  0.300382137298584
local_output_nid generation:  0.015120267868041992
local_in_edges_tensor generation:  0.015377283096313477
mini_batch_src_global generation:  0.03487968444824219
r_  generation:  0.27719807624816895
----------------------check_connections_block total spend ----------------------------- 6.418997526168823
generate_one_block  0.3653433322906494
generate_one_block  0.3554573059082031
generate_one_block  0.3608376979827881
generate_one_block  0.3520798683166504
generate_one_block  0.35637569427490234
generate_one_block  0.35664987564086914
generate_one_block  0.3929896354675293
generate_one_block  0.3484325408935547
generate_one_block  0.36275577545166016
generate_one_block  0.36115503311157227
generate_one_block  0.3528883457183838
generate_one_block  0.3452150821685791
generate_one_block  0.34680891036987305
generate_one_block  0.3510918617248535
generate_one_block  0.364443302154541
generate_one_block  0.3497016429901123
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03401947021484375
gen group dst list time:  0.06716322898864746
time for parepare:  0.019487619400024414
local_output_nid generation:  0.026265859603881836
local_in_edges_tensor generation:  0.05605125427246094
mini_batch_src_global generation:  0.042307376861572266
r_  generation:  0.4714531898498535
local_output_nid generation:  0.03146648406982422
local_in_edges_tensor generation:  0.037743330001831055
mini_batch_src_global generation:  0.05514979362487793
r_  generation:  0.4896214008331299
local_output_nid generation:  0.03365325927734375
local_in_edges_tensor generation:  0.0366053581237793
mini_batch_src_global generation:  0.0552828311920166
r_  generation:  0.48583030700683594
local_output_nid generation:  0.032842397689819336
local_in_edges_tensor generation:  0.032380104064941406
mini_batch_src_global generation:  0.051883697509765625
r_  generation:  0.47999072074890137
local_output_nid generation:  0.03288006782531738
local_in_edges_tensor generation:  0.0832967758178711
mini_batch_src_global generation:  0.05246543884277344
r_  generation:  0.48523831367492676
local_output_nid generation:  0.032277584075927734
local_in_edges_tensor generation:  0.03032994270324707
mini_batch_src_global generation:  0.05911970138549805
r_  generation:  0.48438429832458496
local_output_nid generation:  0.03240084648132324
local_in_edges_tensor generation:  0.03711676597595215
mini_batch_src_global generation:  0.057448387145996094
r_  generation:  0.487015962600708
local_output_nid generation:  0.03229093551635742
local_in_edges_tensor generation:  0.0328981876373291
mini_batch_src_global generation:  0.05383419990539551
r_  generation:  0.4826204776763916
local_output_nid generation:  0.03239798545837402
local_in_edges_tensor generation:  0.030782222747802734
mini_batch_src_global generation:  0.05365777015686035
r_  generation:  0.4853994846343994
local_output_nid generation:  0.03232574462890625
local_in_edges_tensor generation:  0.0322880744934082
mini_batch_src_global generation:  0.056281089782714844
r_  generation:  0.4842238426208496
local_output_nid generation:  0.03248429298400879
local_in_edges_tensor generation:  0.03187704086303711
mini_batch_src_global generation:  0.05430436134338379
r_  generation:  0.5080521106719971
local_output_nid generation:  0.032854318618774414
local_in_edges_tensor generation:  0.030973196029663086
mini_batch_src_global generation:  0.05460691452026367
r_  generation:  0.4906504154205322
local_output_nid generation:  0.03280186653137207
local_in_edges_tensor generation:  0.030697345733642578
mini_batch_src_global generation:  0.05314922332763672
r_  generation:  0.4861488342285156
local_output_nid generation:  0.03510570526123047
local_in_edges_tensor generation:  0.03446054458618164
mini_batch_src_global generation:  0.05469655990600586
r_  generation:  0.48583197593688965
local_output_nid generation:  0.03274250030517578
local_in_edges_tensor generation:  0.03323793411254883
mini_batch_src_global generation:  0.05530714988708496
r_  generation:  0.49219775199890137
local_output_nid generation:  0.03335118293762207
local_in_edges_tensor generation:  0.03095865249633789
mini_batch_src_global generation:  0.053742170333862305
r_  generation:  0.49022340774536133
----------------------check_connections_block total spend ----------------------------- 11.501227855682373
generate_one_block  0.6114184856414795
generate_one_block  0.6137259006500244
generate_one_block  0.5960180759429932
generate_one_block  0.5907309055328369
generate_one_block  0.5942966938018799
generate_one_block  0.6001076698303223
generate_one_block  0.6041703224182129
generate_one_block  0.598395586013794
generate_one_block  0.6359350681304932
generate_one_block  0.6033098697662354
generate_one_block  0.6012849807739258
generate_one_block  0.5920865535736084
generate_one_block  0.5991816520690918
generate_one_block  0.6169171333312988
generate_one_block  0.5979831218719482
generate_one_block  0.5983302593231201
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12327337265014648  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

connection checking time:  17.920225381851196
block generation total time  15.376118183135986
average batch blocks generation time:  0.9610073864459991
block dataloader generation time/epoch 35.685643792152405
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09746026992797852  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7667760848999023  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09747838973999023  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7711787223815918  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0974893569946289  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7710657119750977  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09731388092041016  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7647876739501953  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09746694564819336  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7656259536743164  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09737348556518555  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7673745155334473  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09757089614868164  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7671828269958496  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09731626510620117  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7647452354431152  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09759902954101562  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.775062084197998  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09766149520874023  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7723245620727539  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09766674041748047  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7685375213623047  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09719324111938477  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7622404098510742  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0975337028503418  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7688508033752441  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09750938415527344  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7657465934753418  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09766960144042969  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7688312530517578  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09735250473022461  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7654595375061035  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06397372484207153 |0.01600712537765503 |0.003643721342086792 |9.617209434509277e-05 |0.003286704421043396 |0.002544879913330078 |
----------------------------------------------------------pseudo_mini_loss sum 1.5568963289260864
Total (block generation + training)time/epoch 37.13137114048004
Training time/epoch 1.4586796760559082
Training time without block to device /epoch 1.2025656700134277
Training time without total dataloading part /epoch 0.11497044563293457
load block tensor time/epoch 1.0235795974731445
block to device time/epoch 0.25611400604248047
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  5319122
Number of first layer input nodes during this epoch:  2509993
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12300252914428711  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02587127685546875
range selection method range initialization spend 0.012281656265258789
time for parepare:  0.018210649490356445
local_output_nid generation:  0.0014543533325195312
local_in_edges_tensor generation:  0.006055355072021484
mini_batch_src_global generation:  0.001817464828491211
r_  generation:  0.021945476531982422
local_output_nid generation:  0.0015535354614257812
local_in_edges_tensor generation:  0.0009596347808837891
mini_batch_src_global generation:  0.001981496810913086
r_  generation:  0.022851228713989258
local_output_nid generation:  0.0015971660614013672
local_in_edges_tensor generation:  0.0009658336639404297
mini_batch_src_global generation:  0.0018324851989746094
r_  generation:  0.022721529006958008
local_output_nid generation:  0.0016629695892333984
local_in_edges_tensor generation:  0.0009717941284179688
mini_batch_src_global generation:  0.0017242431640625
r_  generation:  0.02199840545654297
local_output_nid generation:  0.0016345977783203125
local_in_edges_tensor generation:  0.001001596450805664
mini_batch_src_global generation:  0.0017213821411132812
r_  generation:  0.022071361541748047
local_output_nid generation:  0.0016741752624511719
local_in_edges_tensor generation:  0.0009479522705078125
mini_batch_src_global generation:  0.00168609619140625
r_  generation:  0.024696826934814453
local_output_nid generation:  0.0016019344329833984
local_in_edges_tensor generation:  0.0009663105010986328
mini_batch_src_global generation:  0.0017256736755371094
r_  generation:  0.022822856903076172
local_output_nid generation:  0.0016036033630371094
local_in_edges_tensor generation:  0.0009622573852539062
mini_batch_src_global generation:  0.0017154216766357422
r_  generation:  0.022404193878173828
local_output_nid generation:  0.001588582992553711
local_in_edges_tensor generation:  0.0009119510650634766
mini_batch_src_global generation:  0.0017671585083007812
r_  generation:  0.02295970916748047
local_output_nid generation:  0.0016160011291503906
local_in_edges_tensor generation:  0.001165151596069336
mini_batch_src_global generation:  0.001875162124633789
r_  generation:  0.022085189819335938
local_output_nid generation:  0.0015888214111328125
local_in_edges_tensor generation:  0.00133514404296875
mini_batch_src_global generation:  0.0018568038940429688
r_  generation:  0.022628307342529297
local_output_nid generation:  0.0016396045684814453
local_in_edges_tensor generation:  0.0009338855743408203
mini_batch_src_global generation:  0.001725912094116211
r_  generation:  0.022278547286987305
local_output_nid generation:  0.0016236305236816406
local_in_edges_tensor generation:  0.0010497570037841797
mini_batch_src_global generation:  0.0018117427825927734
r_  generation:  0.022291183471679688
local_output_nid generation:  0.001611471176147461
local_in_edges_tensor generation:  0.0011301040649414062
mini_batch_src_global generation:  0.0017211437225341797
r_  generation:  0.023043155670166016
local_output_nid generation:  0.0016088485717773438
local_in_edges_tensor generation:  0.00095367431640625
mini_batch_src_global generation:  0.011371850967407227
r_  generation:  0.02275538444519043
local_output_nid generation:  0.001638174057006836
local_in_edges_tensor generation:  0.0010709762573242188
mini_batch_src_global generation:  0.0017375946044921875
r_  generation:  0.022783279418945312
----------------------check_connections_block total spend ----------------------------- 0.5430142879486084
generate_one_block  0.0356297492980957
generate_one_block  0.031621456146240234
generate_one_block  0.03244757652282715
generate_one_block  0.0312044620513916
generate_one_block  0.033034563064575195
generate_one_block  0.03313326835632324
generate_one_block  0.03151750564575195
generate_one_block  0.033477783203125
generate_one_block  0.032077789306640625
generate_one_block  0.030852556228637695
generate_one_block  0.031079530715942383
generate_one_block  0.030713796615600586
generate_one_block  0.031153202056884766
generate_one_block  0.03161311149597168
generate_one_block  0.03372335433959961
generate_one_block  0.0320742130279541
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04047131538391113
gen group dst list time:  0.01790642738342285
time for parepare:  0.021711111068725586
local_output_nid generation:  0.007689714431762695
local_in_edges_tensor generation:  0.024994373321533203
mini_batch_src_global generation:  0.028237342834472656
r_  generation:  0.26960039138793945
local_output_nid generation:  0.011043548583984375
local_in_edges_tensor generation:  0.019305944442749023
mini_batch_src_global generation:  0.03386330604553223
r_  generation:  0.28421759605407715
local_output_nid generation:  0.01352548599243164
local_in_edges_tensor generation:  0.017551898956298828
mini_batch_src_global generation:  0.033013343811035156
r_  generation:  0.27805042266845703
local_output_nid generation:  0.012562751770019531
local_in_edges_tensor generation:  0.0180206298828125
mini_batch_src_global generation:  0.03356003761291504
r_  generation:  0.27382683753967285
local_output_nid generation:  0.012920379638671875
local_in_edges_tensor generation:  0.01801133155822754
mini_batch_src_global generation:  0.03634786605834961
r_  generation:  0.2760000228881836
local_output_nid generation:  0.012714624404907227
local_in_edges_tensor generation:  0.0158236026763916
mini_batch_src_global generation:  0.03360891342163086
r_  generation:  0.2762453556060791
local_output_nid generation:  0.0132598876953125
local_in_edges_tensor generation:  0.0149688720703125
mini_batch_src_global generation:  0.03453850746154785
r_  generation:  0.2814936637878418
local_output_nid generation:  0.013336420059204102
local_in_edges_tensor generation:  0.018744945526123047
mini_batch_src_global generation:  0.03523588180541992
r_  generation:  0.2797224521636963
local_output_nid generation:  0.014304876327514648
local_in_edges_tensor generation:  0.015086174011230469
mini_batch_src_global generation:  0.03581809997558594
r_  generation:  0.28389906883239746
local_output_nid generation:  0.013130426406860352
local_in_edges_tensor generation:  0.01797652244567871
mini_batch_src_global generation:  0.03450512886047363
r_  generation:  0.2751758098602295
local_output_nid generation:  0.01303410530090332
local_in_edges_tensor generation:  0.015051603317260742
mini_batch_src_global generation:  0.03431081771850586
r_  generation:  0.281604528427124
local_output_nid generation:  0.013262748718261719
local_in_edges_tensor generation:  0.017440080642700195
mini_batch_src_global generation:  0.03617596626281738
r_  generation:  0.2744143009185791
local_output_nid generation:  0.013508081436157227
local_in_edges_tensor generation:  0.014863252639770508
mini_batch_src_global generation:  0.036192893981933594
r_  generation:  0.29288172721862793
local_output_nid generation:  0.015616178512573242
local_in_edges_tensor generation:  0.014999866485595703
mini_batch_src_global generation:  0.03484344482421875
r_  generation:  0.27910614013671875
local_output_nid generation:  0.013702869415283203
local_in_edges_tensor generation:  0.016092777252197266
mini_batch_src_global generation:  0.03482842445373535
r_  generation:  0.2837412357330322
local_output_nid generation:  0.013063907623291016
local_in_edges_tensor generation:  0.014093637466430664
mini_batch_src_global generation:  0.03464198112487793
r_  generation:  0.2755711078643799
----------------------check_connections_block total spend ----------------------------- 6.4665610790252686
generate_one_block  0.3800210952758789
generate_one_block  0.3531973361968994
generate_one_block  0.35602879524230957
generate_one_block  0.3509671688079834
generate_one_block  0.3444638252258301
generate_one_block  0.34296345710754395
generate_one_block  0.39191627502441406
generate_one_block  0.3501551151275635
generate_one_block  0.3652503490447998
generate_one_block  0.34352731704711914
generate_one_block  0.3495354652404785
generate_one_block  0.3448958396911621
generate_one_block  0.3564913272857666
generate_one_block  0.3557729721069336
generate_one_block  0.3560945987701416
generate_one_block  0.3498091697692871
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03691840171813965
gen group dst list time:  0.06814956665039062
time for parepare:  0.0198214054107666
local_output_nid generation:  0.026364803314208984
local_in_edges_tensor generation:  0.05864715576171875
mini_batch_src_global generation:  0.042090654373168945
r_  generation:  0.47733497619628906
local_output_nid generation:  0.030988454818725586
local_in_edges_tensor generation:  0.041617393493652344
mini_batch_src_global generation:  0.05326414108276367
r_  generation:  0.4703819751739502
local_output_nid generation:  0.03166604042053223
local_in_edges_tensor generation:  0.034913063049316406
mini_batch_src_global generation:  0.051752328872680664
r_  generation:  0.4816169738769531
local_output_nid generation:  0.03170585632324219
local_in_edges_tensor generation:  0.03348588943481445
mini_batch_src_global generation:  0.05215954780578613
r_  generation:  0.49582624435424805
local_output_nid generation:  0.03496909141540527
local_in_edges_tensor generation:  0.09194326400756836
mini_batch_src_global generation:  0.05510258674621582
r_  generation:  0.47646498680114746
local_output_nid generation:  0.03154778480529785
local_in_edges_tensor generation:  0.031513214111328125
mini_batch_src_global generation:  0.053002357482910156
r_  generation:  0.4722464084625244
local_output_nid generation:  0.031854867935180664
local_in_edges_tensor generation:  0.0327143669128418
mini_batch_src_global generation:  0.052507877349853516
r_  generation:  0.4780702590942383
local_output_nid generation:  0.03174591064453125
local_in_edges_tensor generation:  0.03525042533874512
mini_batch_src_global generation:  0.054001808166503906
r_  generation:  0.47484874725341797
local_output_nid generation:  0.0320889949798584
local_in_edges_tensor generation:  0.031087875366210938
mini_batch_src_global generation:  0.05333995819091797
r_  generation:  0.481123685836792
local_output_nid generation:  0.031609535217285156
local_in_edges_tensor generation:  0.03098917007446289
mini_batch_src_global generation:  0.05445218086242676
r_  generation:  0.4859328269958496
local_output_nid generation:  0.03202509880065918
local_in_edges_tensor generation:  0.03289294242858887
mini_batch_src_global generation:  0.054747819900512695
r_  generation:  0.489086389541626
local_output_nid generation:  0.03184390068054199
local_in_edges_tensor generation:  0.03132963180541992
mini_batch_src_global generation:  0.0541081428527832
r_  generation:  0.48706531524658203
local_output_nid generation:  0.031877756118774414
local_in_edges_tensor generation:  0.03386282920837402
mini_batch_src_global generation:  0.05324196815490723
r_  generation:  0.4852597713470459
local_output_nid generation:  0.03190898895263672
local_in_edges_tensor generation:  0.035349130630493164
mini_batch_src_global generation:  0.05587196350097656
r_  generation:  0.48386716842651367
local_output_nid generation:  0.034830570220947266
local_in_edges_tensor generation:  0.033037662506103516
mini_batch_src_global generation:  0.052893638610839844
r_  generation:  0.48027968406677246
local_output_nid generation:  0.03190350532531738
local_in_edges_tensor generation:  0.03291440010070801
mini_batch_src_global generation:  0.05393576622009277
r_  generation:  0.4748404026031494
----------------------check_connections_block total spend ----------------------------- 11.39095139503479
generate_one_block  0.6019771099090576
generate_one_block  0.5894975662231445
generate_one_block  0.5876612663269043
generate_one_block  0.5920119285583496
generate_one_block  0.5946576595306396
generate_one_block  0.589653730392456
generate_one_block  0.5931854248046875
generate_one_block  0.5982606410980225
generate_one_block  0.6616408824920654
generate_one_block  0.5928096771240234
generate_one_block  0.5999343395233154
generate_one_block  0.5934343338012695
generate_one_block  0.6016345024108887
generate_one_block  0.6035280227661133
generate_one_block  0.5954043865203857
generate_one_block  0.5938539505004883
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12300252914428711  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

connection checking time:  17.85751247406006
block generation total time  15.280235528945923
average batch blocks generation time:  0.9550147205591202
block dataloader generation time/epoch 35.582560777664185
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09769248962402344  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7710099220275879  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09759664535522461  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7704110145568848  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09776592254638672  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7764134407043457  GigaBytes
Max Memory Allocated: 0.865180492401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0976877212524414  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7712092399597168  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09735345840454102  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7704973220825195  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.097412109375  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7639503479003906  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09750604629516602  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7675714492797852  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09733867645263672  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7691545486450195  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09758281707763672  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7747392654418945  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09711599349975586  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7589411735534668  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09746026992797852  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7715349197387695  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09740972518920898  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7645049095153809  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09749078750610352  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7667322158813477  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09751510620117188  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7666101455688477  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09734916687011719  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7667679786682129  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09742116928100586  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.765965461730957  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.062221020460128784 |0.016188040375709534 |0.0037205666303634644 |9.448826313018799e-05 |0.003299534320831299 |0.0032982826232910156 |
----------------------------------------------------------pseudo_mini_loss sum 1.526586651802063
Total (block generation + training)time/epoch 37.02481611569723
Training time/epoch 1.4350461959838867
Training time without block to device /epoch 1.1760375499725342
Training time without total dataloading part /epoch 0.11713171005249023
load block tensor time/epoch 0.9955363273620605
block to device time/epoch 0.25900864601135254
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  5320647
Number of first layer input nodes during this epoch:  2510121
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12315177917480469  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022785663604736328
range selection method range initialization spend 0.012353181838989258
time for parepare:  0.01726555824279785
local_output_nid generation:  0.0014529228210449219
local_in_edges_tensor generation:  0.005972385406494141
mini_batch_src_global generation:  0.0033097267150878906
r_  generation:  0.02411198616027832
local_output_nid generation:  0.0019638538360595703
local_in_edges_tensor generation:  0.0011782646179199219
mini_batch_src_global generation:  0.0023865699768066406
r_  generation:  0.02239990234375
local_output_nid generation:  0.001890420913696289
local_in_edges_tensor generation:  0.001132965087890625
mini_batch_src_global generation:  0.001695394515991211
r_  generation:  0.020476341247558594
local_output_nid generation:  0.001935720443725586
local_in_edges_tensor generation:  0.0011286735534667969
mini_batch_src_global generation:  0.00168609619140625
r_  generation:  0.021015167236328125
local_output_nid generation:  0.0018925666809082031
local_in_edges_tensor generation:  0.001065969467163086
mini_batch_src_global generation:  0.001718759536743164
r_  generation:  0.021079540252685547
local_output_nid generation:  0.004099130630493164
local_in_edges_tensor generation:  0.0010733604431152344
mini_batch_src_global generation:  0.0017123222351074219
r_  generation:  0.021351337432861328
local_output_nid generation:  0.0018739700317382812
local_in_edges_tensor generation:  0.0011756420135498047
mini_batch_src_global generation:  0.0018951892852783203
r_  generation:  0.02252030372619629
local_output_nid generation:  0.0018434524536132812
local_in_edges_tensor generation:  0.0010483264923095703
mini_batch_src_global generation:  0.0018546581268310547
r_  generation:  0.021650075912475586
local_output_nid generation:  0.0018467903137207031
local_in_edges_tensor generation:  0.0010745525360107422
mini_batch_src_global generation:  0.0018336772918701172
r_  generation:  0.022299766540527344
local_output_nid generation:  0.0018031597137451172
local_in_edges_tensor generation:  0.0010459423065185547
mini_batch_src_global generation:  0.0018260478973388672
r_  generation:  0.021718263626098633
local_output_nid generation:  0.001791238784790039
local_in_edges_tensor generation:  0.0010259151458740234
mini_batch_src_global generation:  0.0017197132110595703
r_  generation:  0.021587371826171875
local_output_nid generation:  0.0018651485443115234
local_in_edges_tensor generation:  0.00102996826171875
mini_batch_src_global generation:  0.0017004013061523438
r_  generation:  0.021272659301757812
local_output_nid generation:  0.0017430782318115234
local_in_edges_tensor generation:  0.0010199546813964844
mini_batch_src_global generation:  0.0018215179443359375
r_  generation:  0.02139735221862793
local_output_nid generation:  0.0018303394317626953
local_in_edges_tensor generation:  0.0010693073272705078
mini_batch_src_global generation:  0.0017952919006347656
r_  generation:  0.02200794219970703
local_output_nid generation:  0.0017871856689453125
local_in_edges_tensor generation:  0.0010523796081542969
mini_batch_src_global generation:  0.0017156600952148438
r_  generation:  0.024257183074951172
local_output_nid generation:  0.0018205642700195312
local_in_edges_tensor generation:  0.001027822494506836
mini_batch_src_global generation:  0.0019006729125976562
r_  generation:  0.021819591522216797
----------------------check_connections_block total spend ----------------------------- 0.5358631610870361
generate_one_block  0.03646349906921387
generate_one_block  0.03423118591308594
generate_one_block  0.03105759620666504
generate_one_block  0.031362056732177734
generate_one_block  0.031381845474243164
generate_one_block  0.03635740280151367
generate_one_block  0.03334856033325195
generate_one_block  0.03151440620422363
generate_one_block  0.032616376876831055
generate_one_block  0.032462120056152344
generate_one_block  0.032205820083618164
generate_one_block  0.03232121467590332
generate_one_block  0.032437801361083984
generate_one_block  0.03231620788574219
generate_one_block  0.04334378242492676
generate_one_block  0.0517270565032959
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0398714542388916
gen group dst list time:  0.019228458404541016
time for parepare:  0.02057170867919922
local_output_nid generation:  0.007597923278808594
local_in_edges_tensor generation:  0.025202035903930664
mini_batch_src_global generation:  0.02697896957397461
r_  generation:  0.25739550590515137
local_output_nid generation:  0.012000322341918945
local_in_edges_tensor generation:  0.017452716827392578
mini_batch_src_global generation:  0.03342604637145996
r_  generation:  0.2731151580810547
local_output_nid generation:  0.014466047286987305
local_in_edges_tensor generation:  0.017784833908081055
mini_batch_src_global generation:  0.032613515853881836
r_  generation:  0.2739229202270508
local_output_nid generation:  0.012602567672729492
local_in_edges_tensor generation:  0.014485836029052734
mini_batch_src_global generation:  0.04532289505004883
r_  generation:  0.27419304847717285
local_output_nid generation:  0.013528585433959961
local_in_edges_tensor generation:  0.013686656951904297
mini_batch_src_global generation:  0.033739328384399414
r_  generation:  0.2730071544647217
local_output_nid generation:  0.013043880462646484
local_in_edges_tensor generation:  0.014411449432373047
mini_batch_src_global generation:  0.03467559814453125
r_  generation:  0.2773144245147705
local_output_nid generation:  0.013498544692993164
local_in_edges_tensor generation:  0.01623368263244629
mini_batch_src_global generation:  0.03647780418395996
r_  generation:  0.2886848449707031
local_output_nid generation:  0.013362884521484375
local_in_edges_tensor generation:  0.01365208625793457
mini_batch_src_global generation:  0.03604269027709961
r_  generation:  0.28365254402160645
local_output_nid generation:  0.013655662536621094
local_in_edges_tensor generation:  0.01758098602294922
mini_batch_src_global generation:  0.037741899490356445
r_  generation:  0.2926146984100342
local_output_nid generation:  0.014639854431152344
local_in_edges_tensor generation:  0.021396398544311523
mini_batch_src_global generation:  0.03614616394042969
r_  generation:  0.28964805603027344
local_output_nid generation:  0.013067007064819336
local_in_edges_tensor generation:  0.014673948287963867
mini_batch_src_global generation:  0.036572933197021484
r_  generation:  0.2870166301727295
local_output_nid generation:  0.013439655303955078
local_in_edges_tensor generation:  0.018891572952270508
mini_batch_src_global generation:  0.03661918640136719
r_  generation:  0.2809262275695801
local_output_nid generation:  0.013821601867675781
local_in_edges_tensor generation:  0.0163724422454834
mini_batch_src_global generation:  0.039124488830566406
r_  generation:  0.2866549491882324
local_output_nid generation:  0.013624429702758789
local_in_edges_tensor generation:  0.016061782836914062
mini_batch_src_global generation:  0.04209256172180176
r_  generation:  0.2887692451477051
local_output_nid generation:  0.015780925750732422
local_in_edges_tensor generation:  0.015054702758789062
mini_batch_src_global generation:  0.03621983528137207
r_  generation:  0.28052473068237305
local_output_nid generation:  0.013354063034057617
local_in_edges_tensor generation:  0.014959096908569336
mini_batch_src_global generation:  0.034279584884643555
r_  generation:  0.28268980979919434
----------------------check_connections_block total spend ----------------------------- 6.522085428237915
generate_one_block  0.35752224922180176
generate_one_block  0.35378336906433105
generate_one_block  0.34949326515197754
generate_one_block  0.35587549209594727
generate_one_block  0.3639810085296631
generate_one_block  0.35268473625183105
generate_one_block  0.393812894821167
generate_one_block  0.3524162769317627
generate_one_block  0.3653130531311035
generate_one_block  0.3605198860168457
generate_one_block  0.35956645011901855
generate_one_block  0.35370397567749023
generate_one_block  0.3619425296783447
generate_one_block  0.3607351779937744
generate_one_block  0.35680294036865234
generate_one_block  0.3582620620727539
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.036485910415649414
gen group dst list time:  0.06848812103271484
time for parepare:  0.020120620727539062
local_output_nid generation:  0.025320053100585938
local_in_edges_tensor generation:  0.051911354064941406
mini_batch_src_global generation:  0.0429532527923584
r_  generation:  0.4670844078063965
local_output_nid generation:  0.03152966499328613
local_in_edges_tensor generation:  0.04264378547668457
mini_batch_src_global generation:  0.05389976501464844
r_  generation:  0.47145676612854004
local_output_nid generation:  0.03219318389892578
local_in_edges_tensor generation:  0.03462719917297363
mini_batch_src_global generation:  0.05715298652648926
r_  generation:  0.49549126625061035
local_output_nid generation:  0.0357058048248291
local_in_edges_tensor generation:  0.0316920280456543
mini_batch_src_global generation:  0.055284738540649414
r_  generation:  0.47501683235168457
local_output_nid generation:  0.03364062309265137
local_in_edges_tensor generation:  0.08345389366149902
mini_batch_src_global generation:  0.05197882652282715
r_  generation:  0.48253941535949707
local_output_nid generation:  0.03239083290100098
local_in_edges_tensor generation:  0.03156709671020508
mini_batch_src_global generation:  0.05356407165527344
r_  generation:  0.47585391998291016
local_output_nid generation:  0.03291940689086914
local_in_edges_tensor generation:  0.03205728530883789
mini_batch_src_global generation:  0.05509042739868164
r_  generation:  0.4964148998260498
local_output_nid generation:  0.03299212455749512
local_in_edges_tensor generation:  0.034563302993774414
mini_batch_src_global generation:  0.05406785011291504
r_  generation:  0.4821610450744629
local_output_nid generation:  0.03272294998168945
local_in_edges_tensor generation:  0.032207489013671875
mini_batch_src_global generation:  0.052933692932128906
r_  generation:  0.4852437973022461
local_output_nid generation:  0.03302741050720215
local_in_edges_tensor generation:  0.029890775680541992
mini_batch_src_global generation:  0.05460834503173828
r_  generation:  0.480912446975708
local_output_nid generation:  0.03314971923828125
local_in_edges_tensor generation:  0.032440900802612305
mini_batch_src_global generation:  0.05252552032470703
r_  generation:  0.48911380767822266
local_output_nid generation:  0.03281259536743164
local_in_edges_tensor generation:  0.030266523361206055
mini_batch_src_global generation:  0.05430316925048828
r_  generation:  0.48172807693481445
local_output_nid generation:  0.03284645080566406
local_in_edges_tensor generation:  0.03383493423461914
mini_batch_src_global generation:  0.05333662033081055
r_  generation:  0.4909937381744385
local_output_nid generation:  0.033339500427246094
local_in_edges_tensor generation:  0.034799814224243164
mini_batch_src_global generation:  0.05591845512390137
r_  generation:  0.48801374435424805
local_output_nid generation:  0.03312349319458008
local_in_edges_tensor generation:  0.03340935707092285
mini_batch_src_global generation:  0.053018808364868164
r_  generation:  0.49367856979370117
local_output_nid generation:  0.0332493782043457
local_in_edges_tensor generation:  0.030354738235473633
mini_batch_src_global generation:  0.053949594497680664
r_  generation:  0.4829223155975342
----------------------check_connections_block total spend ----------------------------- 11.436164855957031
generate_one_block  0.6035819053649902
generate_one_block  0.6007182598114014
generate_one_block  0.6023905277252197
generate_one_block  0.6087379455566406
generate_one_block  0.6004621982574463
generate_one_block  0.6006014347076416
generate_one_block  0.6090013980865479
generate_one_block  0.6033210754394531
generate_one_block  0.6363413333892822
generate_one_block  0.600848913192749
generate_one_block  0.5989053249359131
generate_one_block  0.5919294357299805
generate_one_block  0.6052234172821045
generate_one_block  0.6183493137359619
generate_one_block  0.5999956130981445
generate_one_block  0.6147682666778564
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12315177917480469  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

connection checking time:  17.958250284194946
block generation total time  15.451591730117798
average batch blocks generation time:  0.9657244831323624
block dataloader generation time/epoch 35.6100047826767
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09701919555664062  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7592897415161133  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09751462936401367  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7665266990661621  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0972895622253418  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7654590606689453  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09743261337280273  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7700634002685547  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09728050231933594  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.764122486114502  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09716463088989258  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7606372833251953  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09766149520874023  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7751131057739258  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09747600555419922  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7688827514648438  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09761428833007812  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7711472511291504  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09741020202636719  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7683253288269043  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09739351272583008  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7649273872375488  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09725809097290039  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7653493881225586  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09756278991699219  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7720952033996582  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0975351333618164  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7678999900817871  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09742021560668945  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7670412063598633  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09743309020996094  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7675108909606934  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06722314655780792 |0.013935700058937073 |0.0036327093839645386 |9.238719940185547e-05 |0.0037341266870498657 |0.0016744136810302734 |
----------------------------------------------------------pseudo_mini_loss sum 1.491222858428955
Total (block generation + training)time/epoch 37.06240230798721
Training time/epoch 1.4825518131256104
Training time without block to device /epoch 1.2595806121826172
Training time without total dataloading part /epoch 0.12102198600769043
load block tensor time/epoch 1.0755703449249268
block to device time/epoch 0.22297120094299316
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  5313893
Number of first layer input nodes during this epoch:  2507713
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12328290939331055  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026506900787353516
range selection method range initialization spend 0.012229204177856445
time for parepare:  0.017716169357299805
local_output_nid generation:  0.0015730857849121094
local_in_edges_tensor generation:  0.006844520568847656
mini_batch_src_global generation:  0.0017592906951904297
r_  generation:  0.023548364639282227
local_output_nid generation:  0.0017061233520507812
local_in_edges_tensor generation:  0.0010361671447753906
mini_batch_src_global generation:  0.002039670944213867
r_  generation:  0.02241992950439453
local_output_nid generation:  0.0016193389892578125
local_in_edges_tensor generation:  0.0010559558868408203
mini_batch_src_global generation:  0.0016863346099853516
r_  generation:  0.02170562744140625
local_output_nid generation:  0.0016620159149169922
local_in_edges_tensor generation:  0.001055002212524414
mini_batch_src_global generation:  0.0017538070678710938
r_  generation:  0.024215221405029297
local_output_nid generation:  0.0016384124755859375
local_in_edges_tensor generation:  0.0010426044464111328
mini_batch_src_global generation:  0.0017728805541992188
r_  generation:  0.022710561752319336
local_output_nid generation:  0.0015769004821777344
local_in_edges_tensor generation:  0.0010921955108642578
mini_batch_src_global generation:  0.0017993450164794922
r_  generation:  0.022693395614624023
local_output_nid generation:  0.0016064643859863281
local_in_edges_tensor generation:  0.001039266586303711
mini_batch_src_global generation:  0.0017824172973632812
r_  generation:  0.022876501083374023
local_output_nid generation:  0.0017650127410888672
local_in_edges_tensor generation:  0.0010378360748291016
mini_batch_src_global generation:  0.0017616748809814453
r_  generation:  0.022225141525268555
local_output_nid generation:  0.0016021728515625
local_in_edges_tensor generation:  0.0010416507720947266
mini_batch_src_global generation:  0.0017366409301757812
r_  generation:  0.0224153995513916
local_output_nid generation:  0.0016002655029296875
local_in_edges_tensor generation:  0.001013040542602539
mini_batch_src_global generation:  0.0018248558044433594
r_  generation:  0.022989511489868164
local_output_nid generation:  0.0016431808471679688
local_in_edges_tensor generation:  0.0010235309600830078
mini_batch_src_global generation:  0.0018200874328613281
r_  generation:  0.0229184627532959
local_output_nid generation:  0.0016112327575683594
local_in_edges_tensor generation:  0.0010495185852050781
mini_batch_src_global generation:  0.001787424087524414
r_  generation:  0.022530317306518555
local_output_nid generation:  0.0016391277313232422
local_in_edges_tensor generation:  0.0010502338409423828
mini_batch_src_global generation:  0.0017192363739013672
r_  generation:  0.022055864334106445
local_output_nid generation:  0.0016317367553710938
local_in_edges_tensor generation:  0.001035451889038086
mini_batch_src_global generation:  0.0017473697662353516
r_  generation:  0.022395610809326172
local_output_nid generation:  0.001619577407836914
local_in_edges_tensor generation:  0.001028299331665039
mini_batch_src_global generation:  0.0017771720886230469
r_  generation:  0.0226747989654541
local_output_nid generation:  0.0016546249389648438
local_in_edges_tensor generation:  0.0010280609130859375
mini_batch_src_global generation:  0.0018112659454345703
r_  generation:  0.02316594123840332
----------------------check_connections_block total spend ----------------------------- 0.5412425994873047
generate_one_block  0.031016826629638672
generate_one_block  0.03127932548522949
generate_one_block  0.030796051025390625
generate_one_block  0.031055450439453125
generate_one_block  0.03139519691467285
generate_one_block  0.03337836265563965
generate_one_block  0.03470325469970703
generate_one_block  0.031343936920166016
generate_one_block  0.031246423721313477
generate_one_block  0.034595489501953125
generate_one_block  0.031609296798706055
generate_one_block  0.031145095825195312
generate_one_block  0.03078293800354004
generate_one_block  0.03603768348693848
generate_one_block  0.03163480758666992
generate_one_block  0.0326075553894043
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03723955154418945
gen group dst list time:  0.02101898193359375
time for parepare:  0.02005910873413086
local_output_nid generation:  0.007415294647216797
local_in_edges_tensor generation:  0.026548147201538086
mini_batch_src_global generation:  0.02653026580810547
r_  generation:  0.2568788528442383
local_output_nid generation:  0.011249303817749023
local_in_edges_tensor generation:  0.0172576904296875
mini_batch_src_global generation:  0.03268265724182129
r_  generation:  0.2668642997741699
local_output_nid generation:  0.011761903762817383
local_in_edges_tensor generation:  0.01765584945678711
mini_batch_src_global generation:  0.03242206573486328
r_  generation:  0.2731008529663086
local_output_nid generation:  0.012382745742797852
local_in_edges_tensor generation:  0.014617681503295898
mini_batch_src_global generation:  0.03380298614501953
r_  generation:  0.2778182029724121
local_output_nid generation:  0.013091325759887695
local_in_edges_tensor generation:  0.018374919891357422
mini_batch_src_global generation:  0.03380703926086426
r_  generation:  0.28362536430358887
local_output_nid generation:  0.012945175170898438
local_in_edges_tensor generation:  0.01501607894897461
mini_batch_src_global generation:  0.03364419937133789
r_  generation:  0.28344225883483887
local_output_nid generation:  0.013390779495239258
local_in_edges_tensor generation:  0.014392614364624023
mini_batch_src_global generation:  0.03551054000854492
r_  generation:  0.2819669246673584
local_output_nid generation:  0.013092279434204102
local_in_edges_tensor generation:  0.0178220272064209
mini_batch_src_global generation:  0.0347142219543457
r_  generation:  0.27240943908691406
local_output_nid generation:  0.013267755508422852
local_in_edges_tensor generation:  0.01378488540649414
mini_batch_src_global generation:  0.03433942794799805
r_  generation:  0.27909231185913086
local_output_nid generation:  0.01336812973022461
local_in_edges_tensor generation:  0.013849020004272461
mini_batch_src_global generation:  0.03408646583557129
r_  generation:  0.2814497947692871
local_output_nid generation:  0.012909650802612305
local_in_edges_tensor generation:  0.013807296752929688
mini_batch_src_global generation:  0.034474849700927734
r_  generation:  0.2820899486541748
local_output_nid generation:  0.013417720794677734
local_in_edges_tensor generation:  0.013851642608642578
mini_batch_src_global generation:  0.035700082778930664
r_  generation:  0.2841336727142334
local_output_nid generation:  0.013499736785888672
local_in_edges_tensor generation:  0.019965410232543945
mini_batch_src_global generation:  0.035253286361694336
r_  generation:  0.2763180732727051
local_output_nid generation:  0.013479471206665039
local_in_edges_tensor generation:  0.0189664363861084
mini_batch_src_global generation:  0.03539681434631348
r_  generation:  0.28203344345092773
local_output_nid generation:  0.01502370834350586
local_in_edges_tensor generation:  0.01728057861328125
mini_batch_src_global generation:  0.035692453384399414
r_  generation:  0.27936410903930664
local_output_nid generation:  0.015127182006835938
local_in_edges_tensor generation:  0.015395641326904297
mini_batch_src_global generation:  0.03647971153259277
r_  generation:  0.2861943244934082
----------------------check_connections_block total spend ----------------------------- 6.417112588882446
generate_one_block  0.36600160598754883
generate_one_block  0.35997891426086426
generate_one_block  0.3520467281341553
generate_one_block  0.36454010009765625
generate_one_block  0.35876989364624023
generate_one_block  0.3546466827392578
generate_one_block  0.39008665084838867
generate_one_block  0.344158411026001
generate_one_block  0.35256147384643555
generate_one_block  0.3620898723602295
generate_one_block  0.3576176166534424
generate_one_block  0.3466005325317383
generate_one_block  0.34288763999938965
generate_one_block  0.3551020622253418
generate_one_block  0.35497140884399414
generate_one_block  0.3684861660003662
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.037360429763793945
gen group dst list time:  0.0682516098022461
time for parepare:  0.018280744552612305
local_output_nid generation:  0.02621769905090332
local_in_edges_tensor generation:  0.052626609802246094
mini_batch_src_global generation:  0.04620695114135742
r_  generation:  0.4742472171783447
local_output_nid generation:  0.03163003921508789
local_in_edges_tensor generation:  0.03857588768005371
mini_batch_src_global generation:  0.05524492263793945
r_  generation:  0.4678614139556885
local_output_nid generation:  0.032227277755737305
local_in_edges_tensor generation:  0.03523588180541992
mini_batch_src_global generation:  0.052430152893066406
r_  generation:  0.4808049201965332
local_output_nid generation:  0.032209157943725586
local_in_edges_tensor generation:  0.03782773017883301
mini_batch_src_global generation:  0.05317187309265137
r_  generation:  0.47964954376220703
local_output_nid generation:  0.033176422119140625
local_in_edges_tensor generation:  0.07520580291748047
mini_batch_src_global generation:  0.05818343162536621
r_  generation:  0.4854319095611572
local_output_nid generation:  0.032332420349121094
local_in_edges_tensor generation:  0.03597760200500488
mini_batch_src_global generation:  0.053946495056152344
r_  generation:  0.49527812004089355
local_output_nid generation:  0.03538250923156738
local_in_edges_tensor generation:  0.03590822219848633
mini_batch_src_global generation:  0.05952882766723633
r_  generation:  0.48872900009155273
local_output_nid generation:  0.033531904220581055
local_in_edges_tensor generation:  0.03210043907165527
mini_batch_src_global generation:  0.05479884147644043
r_  generation:  0.47832274436950684
local_output_nid generation:  0.0333104133605957
local_in_edges_tensor generation:  0.03120708465576172
mini_batch_src_global generation:  0.053323984146118164
r_  generation:  0.4836142063140869
local_output_nid generation:  0.03330087661743164
local_in_edges_tensor generation:  0.03562808036804199
mini_batch_src_global generation:  0.05467510223388672
r_  generation:  0.48002195358276367
local_output_nid generation:  0.03342270851135254
local_in_edges_tensor generation:  0.0313718318939209
mini_batch_src_global generation:  0.0541689395904541
r_  generation:  0.4842801094055176
local_output_nid generation:  0.03374338150024414
local_in_edges_tensor generation:  0.03386259078979492
mini_batch_src_global generation:  0.054802656173706055
r_  generation:  0.47917604446411133
local_output_nid generation:  0.03369474411010742
local_in_edges_tensor generation:  0.032973289489746094
mini_batch_src_global generation:  0.05354428291320801
r_  generation:  0.4843285083770752
local_output_nid generation:  0.03362751007080078
local_in_edges_tensor generation:  0.03598952293395996
mini_batch_src_global generation:  0.054189205169677734
r_  generation:  0.4791829586029053
local_output_nid generation:  0.03342485427856445
local_in_edges_tensor generation:  0.03114485740661621
mini_batch_src_global generation:  0.05351591110229492
r_  generation:  0.48439955711364746
local_output_nid generation:  0.03367757797241211
local_in_edges_tensor generation:  0.03267025947570801
mini_batch_src_global generation:  0.05646991729736328
r_  generation:  0.479886531829834
----------------------check_connections_block total spend ----------------------------- 11.433491230010986
generate_one_block  0.5996401309967041
generate_one_block  0.6011199951171875
generate_one_block  0.6007041931152344
generate_one_block  0.6002652645111084
generate_one_block  0.5960750579833984
generate_one_block  0.597900390625
generate_one_block  0.5991415977478027
generate_one_block  0.5935208797454834
generate_one_block  0.6672999858856201
generate_one_block  0.6014847755432129
generate_one_block  0.6030659675598145
generate_one_block  0.5992519855499268
generate_one_block  0.600257158279419
generate_one_block  0.6015725135803223
generate_one_block  0.5970041751861572
generate_one_block  0.6070971488952637
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12328290939331055  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

connection checking time:  17.850603818893433
block generation total time  15.395946979522705
average batch blocks generation time:  0.9622466862201691
block dataloader generation time/epoch 35.58362808227539
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0975031852722168  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7745776176452637  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0972895622253418  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7590794563293457  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09755277633666992  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7705178260803223  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0975651741027832  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7716445922851562  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09754514694213867  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7752900123596191  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09744691848754883  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7677760124206543  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09765386581420898  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7759876251220703  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09728097915649414  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7638139724731445  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09732913970947266  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.763908863067627  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0974273681640625  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7679691314697266  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09743928909301758  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7660379409790039  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0973963737487793  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7649331092834473  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09740781784057617  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7681560516357422  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09752750396728516  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7663307189941406  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09733343124389648  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7649998664855957  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09762859344482422  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7747626304626465  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06775179505348206 |0.0158756822347641 |0.0035574734210968018 |9.201467037200928e-05 |0.0037953704595565796 |0.0020046234130859375 |
----------------------------------------------------------pseudo_mini_loss sum 1.451339602470398
Total (block generation + training)time/epoch 37.050169706344604
Training time/epoch 1.52280592918396
Training time without block to device /epoch 1.2687950134277344
Training time without total dataloading part /epoch 0.12112236022949219
load block tensor time/epoch 1.084028720855713
block to device time/epoch 0.2540109157562256
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  5319287
Number of first layer input nodes during this epoch:  2509307
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12379693984985352  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024155139923095703
range selection method range initialization spend 0.012444496154785156
time for parepare:  0.020842313766479492
local_output_nid generation:  0.0014472007751464844
local_in_edges_tensor generation:  0.0057446956634521484
mini_batch_src_global generation:  0.00200653076171875
r_  generation:  0.02050304412841797
local_output_nid generation:  0.0015790462493896484
local_in_edges_tensor generation:  0.000978708267211914
mini_batch_src_global generation:  0.0022287368774414062
r_  generation:  0.02270221710205078
local_output_nid generation:  0.0015523433685302734
local_in_edges_tensor generation:  0.0009951591491699219
mini_batch_src_global generation:  0.0016887187957763672
r_  generation:  0.021010398864746094
local_output_nid generation:  0.0015804767608642578
local_in_edges_tensor generation:  0.0009737014770507812
mini_batch_src_global generation:  0.0018763542175292969
r_  generation:  0.022261381149291992
local_output_nid generation:  0.001560211181640625
local_in_edges_tensor generation:  0.0010254383087158203
mini_batch_src_global generation:  0.0017094612121582031
r_  generation:  0.021337032318115234
local_output_nid generation:  0.001562356948852539
local_in_edges_tensor generation:  0.000982522964477539
mini_batch_src_global generation:  0.0017192363739013672
r_  generation:  0.02202606201171875
local_output_nid generation:  0.0016014575958251953
local_in_edges_tensor generation:  0.0009982585906982422
mini_batch_src_global generation:  0.0017600059509277344
r_  generation:  0.022212743759155273
local_output_nid generation:  0.0016252994537353516
local_in_edges_tensor generation:  0.0009343624114990234
mini_batch_src_global generation:  0.0018088817596435547
r_  generation:  0.023190021514892578
local_output_nid generation:  0.0015592575073242188
local_in_edges_tensor generation:  0.00095367431640625
mini_batch_src_global generation:  0.001837015151977539
r_  generation:  0.022716522216796875
local_output_nid generation:  0.0015838146209716797
local_in_edges_tensor generation:  0.0009338855743408203
mini_batch_src_global generation:  0.0018398761749267578
r_  generation:  0.023345947265625
local_output_nid generation:  0.001565694808959961
local_in_edges_tensor generation:  0.0009365081787109375
mini_batch_src_global generation:  0.0017993450164794922
r_  generation:  0.02209639549255371
local_output_nid generation:  0.0015513896942138672
local_in_edges_tensor generation:  0.0009248256683349609
mini_batch_src_global generation:  0.0018143653869628906
r_  generation:  0.022969484329223633
local_output_nid generation:  0.0015869140625
local_in_edges_tensor generation:  0.0009591579437255859
mini_batch_src_global generation:  0.0017783641815185547
r_  generation:  0.022696256637573242
local_output_nid generation:  0.0016474723815917969
local_in_edges_tensor generation:  0.0009641647338867188
mini_batch_src_global generation:  0.0018029212951660156
r_  generation:  0.022258996963500977
local_output_nid generation:  0.0015578269958496094
local_in_edges_tensor generation:  0.0009593963623046875
mini_batch_src_global generation:  0.0017278194427490234
r_  generation:  0.02204608917236328
local_output_nid generation:  0.0015718936920166016
local_in_edges_tensor generation:  0.0009062290191650391
mini_batch_src_global generation:  0.0017957687377929688
r_  generation:  0.02300405502319336
----------------------check_connections_block total spend ----------------------------- 0.530266284942627
generate_one_block  0.038837432861328125
generate_one_block  0.031580448150634766
generate_one_block  0.030510425567626953
generate_one_block  0.03167891502380371
generate_one_block  0.030712127685546875
generate_one_block  0.032500267028808594
generate_one_block  0.030851125717163086
generate_one_block  0.032196044921875
generate_one_block  0.031701087951660156
generate_one_block  0.032052040100097656
generate_one_block  0.0309603214263916
generate_one_block  0.032338857650756836
generate_one_block  0.03183460235595703
generate_one_block  0.031014680862426758
generate_one_block  0.030901193618774414
generate_one_block  0.032552242279052734
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03845667839050293
gen group dst list time:  0.018476009368896484
time for parepare:  0.020619869232177734
local_output_nid generation:  0.007559299468994141
local_in_edges_tensor generation:  0.024663925170898438
mini_batch_src_global generation:  0.026952028274536133
r_  generation:  0.2492661476135254
local_output_nid generation:  0.01109766960144043
local_in_edges_tensor generation:  0.01704096794128418
mini_batch_src_global generation:  0.03202056884765625
r_  generation:  0.26100635528564453
local_output_nid generation:  0.011170148849487305
local_in_edges_tensor generation:  0.014885902404785156
mini_batch_src_global generation:  0.03097248077392578
r_  generation:  0.25871753692626953
local_output_nid generation:  0.012304067611694336
local_in_edges_tensor generation:  0.015465974807739258
mini_batch_src_global generation:  0.03343057632446289
r_  generation:  0.2718992233276367
local_output_nid generation:  0.012305259704589844
local_in_edges_tensor generation:  0.013186931610107422
mini_batch_src_global generation:  0.03316974639892578
r_  generation:  0.2684493064880371
local_output_nid generation:  0.012695550918579102
local_in_edges_tensor generation:  0.013631820678710938
mini_batch_src_global generation:  0.035216569900512695
r_  generation:  0.2699470520019531
local_output_nid generation:  0.01256108283996582
local_in_edges_tensor generation:  0.013067245483398438
mini_batch_src_global generation:  0.03418755531311035
r_  generation:  0.26973795890808105
local_output_nid generation:  0.013079166412353516
local_in_edges_tensor generation:  0.016899824142456055
mini_batch_src_global generation:  0.037824153900146484
r_  generation:  0.2831587791442871
local_output_nid generation:  0.013282060623168945
local_in_edges_tensor generation:  0.014000177383422852
mini_batch_src_global generation:  0.035079240798950195
r_  generation:  0.27522873878479004
local_output_nid generation:  0.013427495956420898
local_in_edges_tensor generation:  0.014003515243530273
mini_batch_src_global generation:  0.035881996154785156
r_  generation:  0.2818775177001953
local_output_nid generation:  0.012818574905395508
local_in_edges_tensor generation:  0.013813495635986328
mini_batch_src_global generation:  0.035039663314819336
r_  generation:  0.2765378952026367
local_output_nid generation:  0.013470888137817383
local_in_edges_tensor generation:  0.013732433319091797
mini_batch_src_global generation:  0.0350642204284668
r_  generation:  0.28585267066955566
local_output_nid generation:  0.013303518295288086
local_in_edges_tensor generation:  0.014766693115234375
mini_batch_src_global generation:  0.03515219688415527
r_  generation:  0.2811131477355957
local_output_nid generation:  0.01332855224609375
local_in_edges_tensor generation:  0.014076471328735352
mini_batch_src_global generation:  0.034580230712890625
r_  generation:  0.2766568660736084
local_output_nid generation:  0.012681961059570312
local_in_edges_tensor generation:  0.013250589370727539
mini_batch_src_global generation:  0.03522920608520508
r_  generation:  0.2756643295288086
local_output_nid generation:  0.012723922729492188
local_in_edges_tensor generation:  0.013982772827148438
mini_batch_src_global generation:  0.03538060188293457
r_  generation:  0.2860875129699707
----------------------check_connections_block total spend ----------------------------- 6.2919602394104
generate_one_block  0.34410881996154785
generate_one_block  0.345278263092041
generate_one_block  0.3363380432128906
generate_one_block  0.3563826084136963
generate_one_block  0.3493025302886963
generate_one_block  0.3515052795410156
generate_one_block  0.37129902839660645
generate_one_block  0.3663203716278076
generate_one_block  0.35587525367736816
generate_one_block  0.35581231117248535
generate_one_block  0.3498718738555908
generate_one_block  0.3592653274536133
generate_one_block  0.3564136028289795
generate_one_block  0.35628700256347656
generate_one_block  0.35112571716308594
generate_one_block  0.36391758918762207
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02899312973022461
gen group dst list time:  0.06729507446289062
time for parepare:  0.018383264541625977
local_output_nid generation:  0.026156187057495117
local_in_edges_tensor generation:  0.04655146598815918
mini_batch_src_global generation:  0.04248666763305664
r_  generation:  0.47217416763305664
local_output_nid generation:  0.03165936470031738
local_in_edges_tensor generation:  0.03714251518249512
mini_batch_src_global generation:  0.05304408073425293
r_  generation:  0.47072482109069824
local_output_nid generation:  0.03184986114501953
local_in_edges_tensor generation:  0.036162376403808594
mini_batch_src_global generation:  0.05124378204345703
r_  generation:  0.48088574409484863
local_output_nid generation:  0.034059762954711914
local_in_edges_tensor generation:  0.0390019416809082
mini_batch_src_global generation:  0.051599740982055664
r_  generation:  0.47777247428894043
local_output_nid generation:  0.03230571746826172
local_in_edges_tensor generation:  0.07431650161743164
mini_batch_src_global generation:  0.051538944244384766
r_  generation:  0.48195600509643555
local_output_nid generation:  0.03237438201904297
local_in_edges_tensor generation:  0.03317451477050781
mini_batch_src_global generation:  0.053032636642456055
r_  generation:  0.4809234142303467
local_output_nid generation:  0.0327913761138916
local_in_edges_tensor generation:  0.02986621856689453
mini_batch_src_global generation:  0.0517885684967041
r_  generation:  0.4857499599456787
local_output_nid generation:  0.0323488712310791
local_in_edges_tensor generation:  0.030096054077148438
mini_batch_src_global generation:  0.05290412902832031
r_  generation:  0.49489617347717285
local_output_nid generation:  0.03299903869628906
local_in_edges_tensor generation:  0.0322418212890625
mini_batch_src_global generation:  0.05323386192321777
r_  generation:  0.4852876663208008
local_output_nid generation:  0.03289604187011719
local_in_edges_tensor generation:  0.034107208251953125
mini_batch_src_global generation:  0.05574631690979004
r_  generation:  0.49339962005615234
local_output_nid generation:  0.03358268737792969
local_in_edges_tensor generation:  0.03159499168395996
mini_batch_src_global generation:  0.05264163017272949
r_  generation:  0.4866061210632324
local_output_nid generation:  0.03282880783081055
local_in_edges_tensor generation:  0.033841609954833984
mini_batch_src_global generation:  0.055966854095458984
r_  generation:  0.4846010208129883
local_output_nid generation:  0.035062313079833984
local_in_edges_tensor generation:  0.03314948081970215
mini_batch_src_global generation:  0.052713632583618164
r_  generation:  0.48616504669189453
local_output_nid generation:  0.03285574913024902
local_in_edges_tensor generation:  0.030129432678222656
mini_batch_src_global generation:  0.053952932357788086
r_  generation:  0.4850947856903076
local_output_nid generation:  0.03273606300354004
local_in_edges_tensor generation:  0.030645370483398438
mini_batch_src_global generation:  0.05211448669433594
r_  generation:  0.488004207611084
local_output_nid generation:  0.03284764289855957
local_in_edges_tensor generation:  0.035585880279541016
mini_batch_src_global generation:  0.056511878967285156
r_  generation:  0.49036550521850586
----------------------check_connections_block total spend ----------------------------- 11.40529727935791
generate_one_block  0.6049423217773438
generate_one_block  0.5905649662017822
generate_one_block  0.5986771583557129
generate_one_block  0.6054732799530029
generate_one_block  0.5945413112640381
generate_one_block  0.6005995273590088
generate_one_block  0.5928404331207275
generate_one_block  0.5941038131713867
generate_one_block  0.6538946628570557
generate_one_block  0.596926212310791
generate_one_block  0.602149486541748
generate_one_block  0.604238748550415
generate_one_block  0.5961813926696777
generate_one_block  0.6015183925628662
generate_one_block  0.5947144031524658
generate_one_block  0.6104066371917725
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12379693984985352  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

connection checking time:  17.69725751876831
block generation total time  15.310876369476318
average batch blocks generation time:  0.9569297730922699
block dataloader generation time/epoch 35.51860268910726
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0973958969116211  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7629456520080566  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0973215103149414  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7648138999938965  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09746885299682617  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7669053077697754  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09765481948852539  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7715339660644531  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09741020202636719  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7645053863525391  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0973668098449707  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7695116996765137  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09739208221435547  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7622122764587402  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09756183624267578  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7704858779907227  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09737586975097656  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7708768844604492  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09761476516723633  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7713756561279297  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09737253189086914  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7649593353271484  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0977182388305664  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7759671211242676  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09763479232788086  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7747964859008789  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09756326675415039  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7701106071472168  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09730195999145508  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.765836238861084  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09769964218139648  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7754793167114258  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06806690990924835 |0.013177692890167236 |0.003558248281478882 |9.325146675109863e-05 |0.0038257241249084473 |0.0014569759368896484 |
----------------------------------------------------------pseudo_mini_loss sum 1.4317740201950073
Total (block generation + training)time/epoch 36.98816827932993
Training time/epoch 1.484499216079712
Training time without block to device /epoch 1.2736561298370361
Training time without total dataloading part /epoch 0.12109255790710449
load block tensor time/epoch 1.0890705585479736
block to device time/epoch 0.21084308624267578
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  5321522
Number of first layer input nodes during this epoch:  2510798
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12383651733398438  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02387380599975586
range selection method range initialization spend 0.012469768524169922
time for parepare:  0.01806640625
local_output_nid generation:  0.001443624496459961
local_in_edges_tensor generation:  0.08670902252197266
mini_batch_src_global generation:  0.0021076202392578125
r_  generation:  0.02243661880493164
local_output_nid generation:  0.0015401840209960938
local_in_edges_tensor generation:  0.0009777545928955078
mini_batch_src_global generation:  0.002468585968017578
r_  generation:  0.024186134338378906
local_output_nid generation:  0.001566171646118164
local_in_edges_tensor generation:  0.0009403228759765625
mini_batch_src_global generation:  0.0020706653594970703
r_  generation:  0.023542165756225586
local_output_nid generation:  0.0016100406646728516
local_in_edges_tensor generation:  0.0009639263153076172
mini_batch_src_global generation:  0.0020096302032470703
r_  generation:  0.021790742874145508
local_output_nid generation:  0.0015528202056884766
local_in_edges_tensor generation:  0.0011904239654541016
mini_batch_src_global generation:  0.0017039775848388672
r_  generation:  0.02213597297668457
local_output_nid generation:  0.001554727554321289
local_in_edges_tensor generation:  0.0009322166442871094
mini_batch_src_global generation:  0.00174713134765625
r_  generation:  0.022504568099975586
local_output_nid generation:  0.0015659332275390625
local_in_edges_tensor generation:  0.00093841552734375
mini_batch_src_global generation:  0.0017664432525634766
r_  generation:  0.022939443588256836
local_output_nid generation:  0.0015871524810791016
local_in_edges_tensor generation:  0.0009229183197021484
mini_batch_src_global generation:  0.001844167709350586
r_  generation:  0.02290511131286621
local_output_nid generation:  0.0015702247619628906
local_in_edges_tensor generation:  0.0009419918060302734
mini_batch_src_global generation:  0.00182342529296875
r_  generation:  0.03568625450134277
local_output_nid generation:  0.002028942108154297
local_in_edges_tensor generation:  0.0011513233184814453
mini_batch_src_global generation:  0.001920461654663086
r_  generation:  0.02256488800048828
local_output_nid generation:  0.001970052719116211
local_in_edges_tensor generation:  0.0010797977447509766
mini_batch_src_global generation:  0.0018832683563232422
r_  generation:  0.02216506004333496
local_output_nid generation:  0.0019054412841796875
local_in_edges_tensor generation:  0.0010509490966796875
mini_batch_src_global generation:  0.0017826557159423828
r_  generation:  0.021947622299194336
local_output_nid generation:  0.001880645751953125
local_in_edges_tensor generation:  0.0010519027709960938
mini_batch_src_global generation:  0.0019099712371826172
r_  generation:  0.0235292911529541
local_output_nid generation:  0.001897573471069336
local_in_edges_tensor generation:  0.0010530948638916016
mini_batch_src_global generation:  0.00189208984375
r_  generation:  0.02255845069885254
local_output_nid generation:  0.001890420913696289
local_in_edges_tensor generation:  0.001039743423461914
mini_batch_src_global generation:  0.0019519329071044922
r_  generation:  0.023205995559692383
local_output_nid generation:  0.0018718242645263672
local_in_edges_tensor generation:  0.0010669231414794922
mini_batch_src_global generation:  0.0019016265869140625
r_  generation:  0.022626876831054688
----------------------check_connections_block total spend ----------------------------- 0.6415016651153564
generate_one_block  0.043514251708984375
generate_one_block  0.04302525520324707
generate_one_block  0.03160977363586426
generate_one_block  0.031106948852539062
generate_one_block  0.031126022338867188
generate_one_block  0.03368330001831055
generate_one_block  0.031805992126464844
generate_one_block  0.031716346740722656
generate_one_block  0.0314333438873291
generate_one_block  0.031055450439453125
generate_one_block  0.030704498291015625
generate_one_block  0.030660629272460938
generate_one_block  0.032070159912109375
generate_one_block  0.031473636627197266
generate_one_block  0.03195333480834961
generate_one_block  0.03155231475830078
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03409123420715332
gen group dst list time:  0.01754927635192871
time for parepare:  0.019830703735351562
local_output_nid generation:  0.007273674011230469
local_in_edges_tensor generation:  0.02223992347717285
mini_batch_src_global generation:  0.025438547134399414
r_  generation:  0.25101208686828613
local_output_nid generation:  0.010967731475830078
local_in_edges_tensor generation:  0.0172116756439209
mini_batch_src_global generation:  0.03303384780883789
r_  generation:  0.26690077781677246
local_output_nid generation:  0.011575460433959961
local_in_edges_tensor generation:  0.01653122901916504
mini_batch_src_global generation:  0.0350184440612793
r_  generation:  0.2727944850921631
local_output_nid generation:  0.012418985366821289
local_in_edges_tensor generation:  0.0197603702545166
mini_batch_src_global generation:  0.03364276885986328
r_  generation:  0.27961301803588867
local_output_nid generation:  0.015949487686157227
local_in_edges_tensor generation:  0.0185549259185791
mini_batch_src_global generation:  0.03441929817199707
r_  generation:  0.2813992500305176
local_output_nid generation:  0.012899160385131836
local_in_edges_tensor generation:  0.01831340789794922
mini_batch_src_global generation:  0.03538680076599121
r_  generation:  0.30059289932250977
local_output_nid generation:  0.015224933624267578
local_in_edges_tensor generation:  0.015343427658081055
mini_batch_src_global generation:  0.036048173904418945
r_  generation:  0.2776494026184082
local_output_nid generation:  0.013455390930175781
local_in_edges_tensor generation:  0.01396036148071289
mini_batch_src_global generation:  0.03551340103149414
r_  generation:  0.2782728672027588
local_output_nid generation:  0.013578414916992188
local_in_edges_tensor generation:  0.013718605041503906
mini_batch_src_global generation:  0.03445625305175781
r_  generation:  0.2760913372039795
local_output_nid generation:  0.013420343399047852
local_in_edges_tensor generation:  0.016036510467529297
mini_batch_src_global generation:  0.03405165672302246
r_  generation:  0.27754998207092285
local_output_nid generation:  0.012634515762329102
local_in_edges_tensor generation:  0.017229795455932617
mini_batch_src_global generation:  0.035083770751953125
r_  generation:  0.2713744640350342
local_output_nid generation:  0.013242959976196289
local_in_edges_tensor generation:  0.013483524322509766
mini_batch_src_global generation:  0.03622031211853027
r_  generation:  0.2827169895172119
local_output_nid generation:  0.013775825500488281
local_in_edges_tensor generation:  0.015075445175170898
mini_batch_src_global generation:  0.05161094665527344
r_  generation:  0.28612518310546875
local_output_nid generation:  0.013457298278808594
local_in_edges_tensor generation:  0.013970136642456055
mini_batch_src_global generation:  0.037804603576660156
r_  generation:  0.2815539836883545
local_output_nid generation:  0.013138771057128906
local_in_edges_tensor generation:  0.01693582534790039
mini_batch_src_global generation:  0.0390009880065918
r_  generation:  0.2872767448425293
local_output_nid generation:  0.012811422348022461
local_in_edges_tensor generation:  0.019502639770507812
mini_batch_src_global generation:  0.03659987449645996
r_  generation:  0.2806849479675293
----------------------check_connections_block total spend ----------------------------- 6.450165510177612
generate_one_block  0.35852599143981934
generate_one_block  0.352064847946167
generate_one_block  0.3483712673187256
generate_one_block  0.35623836517333984
generate_one_block  0.3566863536834717
generate_one_block  0.35288548469543457
generate_one_block  0.39031434059143066
generate_one_block  0.35590076446533203
generate_one_block  0.3541254997253418
generate_one_block  0.35544347763061523
generate_one_block  0.34479355812072754
generate_one_block  0.35167384147644043
generate_one_block  0.36458277702331543
generate_one_block  0.3545846939086914
generate_one_block  0.3677189350128174
generate_one_block  0.35329556465148926
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03245067596435547
gen group dst list time:  0.06981229782104492
time for parepare:  0.020803213119506836
local_output_nid generation:  0.027730464935302734
local_in_edges_tensor generation:  0.054207801818847656
mini_batch_src_global generation:  0.04280352592468262
r_  generation:  0.468538761138916
local_output_nid generation:  0.03150463104248047
local_in_edges_tensor generation:  0.0379946231842041
mini_batch_src_global generation:  0.05548357963562012
r_  generation:  0.4708235263824463
local_output_nid generation:  0.03262591361999512
local_in_edges_tensor generation:  0.033609628677368164
mini_batch_src_global generation:  0.05148053169250488
r_  generation:  0.48000454902648926
local_output_nid generation:  0.03193020820617676
local_in_edges_tensor generation:  0.03338265419006348
mini_batch_src_global generation:  0.05240130424499512
r_  generation:  0.4827113151550293
local_output_nid generation:  0.032213449478149414
local_in_edges_tensor generation:  0.08046436309814453
mini_batch_src_global generation:  0.053850412368774414
r_  generation:  0.4989795684814453
local_output_nid generation:  0.03475832939147949
local_in_edges_tensor generation:  0.032828569412231445
mini_batch_src_global generation:  0.057180166244506836
r_  generation:  0.4837672710418701
local_output_nid generation:  0.034496307373046875
local_in_edges_tensor generation:  0.030720233917236328
mini_batch_src_global generation:  0.053002357482910156
r_  generation:  0.4884030818939209
local_output_nid generation:  0.0333712100982666
local_in_edges_tensor generation:  0.032171010971069336
mini_batch_src_global generation:  0.054121971130371094
r_  generation:  0.4821736812591553
local_output_nid generation:  0.0331573486328125
local_in_edges_tensor generation:  0.031002283096313477
mini_batch_src_global generation:  0.05234718322753906
r_  generation:  0.48171353340148926
local_output_nid generation:  0.033818721771240234
local_in_edges_tensor generation:  0.032021284103393555
mini_batch_src_global generation:  0.05458259582519531
r_  generation:  0.49309873580932617
local_output_nid generation:  0.03313851356506348
local_in_edges_tensor generation:  0.03061079978942871
mini_batch_src_global generation:  0.052510738372802734
r_  generation:  0.48526501655578613
local_output_nid generation:  0.03362536430358887
local_in_edges_tensor generation:  0.03227424621582031
mini_batch_src_global generation:  0.0562744140625
r_  generation:  0.4831216335296631
local_output_nid generation:  0.03324556350708008
local_in_edges_tensor generation:  0.03168201446533203
mini_batch_src_global generation:  0.05535125732421875
r_  generation:  0.48711609840393066
local_output_nid generation:  0.03330421447753906
local_in_edges_tensor generation:  0.030083656311035156
mini_batch_src_global generation:  0.05394935607910156
r_  generation:  0.4833388328552246
local_output_nid generation:  0.03382396697998047
local_in_edges_tensor generation:  0.03067755699157715
mini_batch_src_global generation:  0.055008649826049805
r_  generation:  0.4861617088317871
local_output_nid generation:  0.033660173416137695
local_in_edges_tensor generation:  0.03248333930969238
mini_batch_src_global generation:  0.05659341812133789
r_  generation:  0.4800839424133301
----------------------check_connections_block total spend ----------------------------- 11.43517541885376
generate_one_block  0.6018421649932861
generate_one_block  0.5974774360656738
generate_one_block  0.5959100723266602
generate_one_block  0.5970091819763184
generate_one_block  0.5958647727966309
generate_one_block  0.5975511074066162
generate_one_block  0.5984752178192139
generate_one_block  0.5957019329071045
generate_one_block  0.6591980457305908
generate_one_block  0.6040420532226562
generate_one_block  0.5952205657958984
generate_one_block  0.5926477909088135
generate_one_block  0.6071431636810303
generate_one_block  0.603837251663208
generate_one_block  0.6035947799682617
generate_one_block  0.5924375057220459
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12383651733398438  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

connection checking time:  17.885340929031372
block generation total time  15.355158805847168
average batch blocks generation time:  0.959697425365448
block dataloader generation time/epoch 35.522433689662385
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09723854064941406  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7628674507141113  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0973663330078125  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7642459869384766  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09743213653564453  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7648143768310547  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09748458862304688  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7682690620422363  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0975179672241211  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7675895690917969  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09761762619018555  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7744855880737305  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09749412536621094  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.768010139465332  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09753179550170898  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7714109420776367  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09739255905151367  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7663149833679199  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09742593765258789  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7696700096130371  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09714317321777344  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.758692741394043  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09725761413574219  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7640743255615234  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09757137298583984  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7719264030456543  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09742879867553711  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7703762054443359  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09779882431030273  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7763671875  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09731483459472656  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7653121948242188  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06711120903491974 |0.014833390712738037 |0.003735765814781189 |9.803473949432373e-05 |0.003627181053161621 |0.0027954578399658203 |
----------------------------------------------------------pseudo_mini_loss sum 1.4039819240570068
Total (block generation + training)time/epoch 37.00776672363281
Training time/epoch 1.5796661376953125
Training time without block to device /epoch 1.342331886291504
Training time without total dataloading part /epoch 0.12217116355895996
load block tensor time/epoch 1.0737793445587158
block to device time/epoch 0.2373342514038086
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  5316929
Number of first layer input nodes during this epoch:  2508959
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12307596206665039  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02288031578063965
range selection method range initialization spend 0.011957883834838867
time for parepare:  0.018908262252807617
local_output_nid generation:  0.0015382766723632812
local_in_edges_tensor generation:  0.006484508514404297
mini_batch_src_global generation:  0.0017616748809814453
r_  generation:  0.020963668823242188
local_output_nid generation:  0.0017199516296386719
local_in_edges_tensor generation:  0.0009884834289550781
mini_batch_src_global generation:  0.0021216869354248047
r_  generation:  0.02321338653564453
local_output_nid generation:  0.0015685558319091797
local_in_edges_tensor generation:  0.0009272098541259766
mini_batch_src_global generation:  0.0017457008361816406
r_  generation:  0.022380828857421875
local_output_nid generation:  0.0015835762023925781
local_in_edges_tensor generation:  0.0009431838989257812
mini_batch_src_global generation:  0.0017654895782470703
r_  generation:  0.022086143493652344
local_output_nid generation:  0.0015759468078613281
local_in_edges_tensor generation:  0.000942230224609375
mini_batch_src_global generation:  0.001787424087524414
r_  generation:  0.02216935157775879
local_output_nid generation:  0.0015859603881835938
local_in_edges_tensor generation:  0.0009355545043945312
mini_batch_src_global generation:  0.001787424087524414
r_  generation:  0.02240157127380371
local_output_nid generation:  0.0015993118286132812
local_in_edges_tensor generation:  0.0009181499481201172
mini_batch_src_global generation:  0.0018248558044433594
r_  generation:  0.02254486083984375
local_output_nid generation:  0.0015635490417480469
local_in_edges_tensor generation:  0.0009758472442626953
mini_batch_src_global generation:  0.001829385757446289
r_  generation:  0.022182226181030273
local_output_nid generation:  0.001581430435180664
local_in_edges_tensor generation:  0.0009589195251464844
mini_batch_src_global generation:  0.0018208026885986328
r_  generation:  0.022352218627929688
local_output_nid generation:  0.0015554428100585938
local_in_edges_tensor generation:  0.000926971435546875
mini_batch_src_global generation:  0.0018031597137451172
r_  generation:  0.02241659164428711
local_output_nid generation:  0.0016493797302246094
local_in_edges_tensor generation:  0.0009298324584960938
mini_batch_src_global generation:  0.0017976760864257812
r_  generation:  0.022588491439819336
local_output_nid generation:  0.0015802383422851562
local_in_edges_tensor generation:  0.0009112358093261719
mini_batch_src_global generation:  0.0018157958984375
r_  generation:  0.022595882415771484
local_output_nid generation:  0.0015861988067626953
local_in_edges_tensor generation:  0.0009236335754394531
mini_batch_src_global generation:  0.0017299652099609375
r_  generation:  0.02265143394470215
local_output_nid generation:  0.0015642642974853516
local_in_edges_tensor generation:  0.0009226799011230469
mini_batch_src_global generation:  0.0017955303192138672
r_  generation:  0.022489070892333984
local_output_nid generation:  0.0015709400177001953
local_in_edges_tensor generation:  0.0009293556213378906
mini_batch_src_global generation:  0.0018351078033447266
r_  generation:  0.02288079261779785
local_output_nid generation:  0.0015757083892822266
local_in_edges_tensor generation:  0.0008981227874755859
mini_batch_src_global generation:  0.0018131732940673828
r_  generation:  0.022484540939331055
----------------------check_connections_block total spend ----------------------------- 0.5304200649261475
generate_one_block  0.03405261039733887
generate_one_block  0.032233238220214844
generate_one_block  0.035605430603027344
generate_one_block  0.03140997886657715
generate_one_block  0.03152775764465332
generate_one_block  0.03331160545349121
generate_one_block  0.031357526779174805
generate_one_block  0.031227827072143555
generate_one_block  0.031449079513549805
generate_one_block  0.03100442886352539
generate_one_block  0.031059741973876953
generate_one_block  0.030871868133544922
generate_one_block  0.031110048294067383
generate_one_block  0.031058788299560547
generate_one_block  0.0317995548248291
generate_one_block  0.03170418739318848
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.041265249252319336
gen group dst list time:  0.017974138259887695
time for parepare:  0.019850969314575195
local_output_nid generation:  0.0073871612548828125
local_in_edges_tensor generation:  0.021427392959594727
mini_batch_src_global generation:  0.026980876922607422
r_  generation:  0.2555418014526367
local_output_nid generation:  0.01145172119140625
local_in_edges_tensor generation:  0.017488956451416016
mini_batch_src_global generation:  0.036101341247558594
r_  generation:  0.27783989906311035
local_output_nid generation:  0.011827468872070312
local_in_edges_tensor generation:  0.01894664764404297
mini_batch_src_global generation:  0.0317234992980957
r_  generation:  0.27210378646850586
local_output_nid generation:  0.014336347579956055
local_in_edges_tensor generation:  0.01852583885192871
mini_batch_src_global generation:  0.03191971778869629
r_  generation:  0.2765929698944092
local_output_nid generation:  0.012599468231201172
local_in_edges_tensor generation:  0.017060518264770508
mini_batch_src_global generation:  0.03671622276306152
r_  generation:  0.29637670516967773
local_output_nid generation:  0.015547513961791992
local_in_edges_tensor generation:  0.017292261123657227
mini_batch_src_global generation:  0.03688359260559082
r_  generation:  0.2780463695526123
local_output_nid generation:  0.013490676879882812
local_in_edges_tensor generation:  0.01504826545715332
mini_batch_src_global generation:  0.03406262397766113
r_  generation:  0.2780182361602783
local_output_nid generation:  0.013301610946655273
local_in_edges_tensor generation:  0.017954111099243164
mini_batch_src_global generation:  0.03457832336425781
r_  generation:  0.28667497634887695
local_output_nid generation:  0.013637781143188477
local_in_edges_tensor generation:  0.013837814331054688
mini_batch_src_global generation:  0.03470897674560547
r_  generation:  0.2788856029510498
local_output_nid generation:  0.013497591018676758
local_in_edges_tensor generation:  0.01581883430480957
mini_batch_src_global generation:  0.034940481185913086
r_  generation:  0.2789723873138428
local_output_nid generation:  0.015047073364257812
local_in_edges_tensor generation:  0.018048524856567383
mini_batch_src_global generation:  0.03565049171447754
r_  generation:  0.2818143367767334
local_output_nid generation:  0.013520956039428711
local_in_edges_tensor generation:  0.017305850982666016
mini_batch_src_global generation:  0.03530764579772949
r_  generation:  0.2791895866394043
local_output_nid generation:  0.013566970825195312
local_in_edges_tensor generation:  0.016127824783325195
mini_batch_src_global generation:  0.03587698936462402
r_  generation:  0.277895450592041
local_output_nid generation:  0.013669729232788086
local_in_edges_tensor generation:  0.014091014862060547
mini_batch_src_global generation:  0.03661942481994629
r_  generation:  0.2753632068634033
local_output_nid generation:  0.013146400451660156
local_in_edges_tensor generation:  0.015281438827514648
mini_batch_src_global generation:  0.03703713417053223
r_  generation:  0.28354763984680176
local_output_nid generation:  0.013691425323486328
local_in_edges_tensor generation:  0.01802349090576172
mini_batch_src_global generation:  0.0361781120300293
r_  generation:  0.2916707992553711
----------------------check_connections_block total spend ----------------------------- 6.4632933139801025
generate_one_block  0.35855746269226074
generate_one_block  0.35836076736450195
generate_one_block  0.35404157638549805
generate_one_block  0.35438013076782227
generate_one_block  0.36838746070861816
generate_one_block  0.3538780212402344
generate_one_block  0.38405442237854004
generate_one_block  0.35456347465515137
generate_one_block  0.35514235496520996
generate_one_block  0.3519585132598877
generate_one_block  0.35421037673950195
generate_one_block  0.35573673248291016
generate_one_block  0.35466670989990234
generate_one_block  0.3473989963531494
generate_one_block  0.35923099517822266
generate_one_block  0.3580300807952881
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.034888267517089844
gen group dst list time:  0.06769227981567383
time for parepare:  0.019825220108032227
local_output_nid generation:  0.02701878547668457
local_in_edges_tensor generation:  0.056346893310546875
mini_batch_src_global generation:  0.04493403434753418
r_  generation:  0.4744243621826172
local_output_nid generation:  0.03176546096801758
local_in_edges_tensor generation:  0.04282021522521973
mini_batch_src_global generation:  0.054350852966308594
r_  generation:  0.47162628173828125
local_output_nid generation:  0.0322880744934082
local_in_edges_tensor generation:  0.03917384147644043
mini_batch_src_global generation:  0.0530087947845459
r_  generation:  0.49471545219421387
local_output_nid generation:  0.034964799880981445
local_in_edges_tensor generation:  0.03968358039855957
mini_batch_src_global generation:  0.05769681930541992
r_  generation:  0.47556447982788086
local_output_nid generation:  0.03355240821838379
local_in_edges_tensor generation:  0.08767580986022949
mini_batch_src_global generation:  0.052721500396728516
r_  generation:  0.4816315174102783
local_output_nid generation:  0.03245210647583008
local_in_edges_tensor generation:  0.039628028869628906
mini_batch_src_global generation:  0.053926944732666016
r_  generation:  0.4923975467681885
local_output_nid generation:  0.03271651268005371
local_in_edges_tensor generation:  0.03367877006530762
mini_batch_src_global generation:  0.05358386039733887
r_  generation:  0.48441195487976074
local_output_nid generation:  0.04402637481689453
local_in_edges_tensor generation:  0.033149003982543945
mini_batch_src_global generation:  0.055037498474121094
r_  generation:  0.48516011238098145
local_output_nid generation:  0.03277015686035156
local_in_edges_tensor generation:  0.03612995147705078
mini_batch_src_global generation:  0.058490753173828125
r_  generation:  0.4837026596069336
local_output_nid generation:  0.03272581100463867
local_in_edges_tensor generation:  0.033608198165893555
mini_batch_src_global generation:  0.05440878868103027
r_  generation:  0.4844472408294678
local_output_nid generation:  0.03276181221008301
local_in_edges_tensor generation:  0.0357668399810791
mini_batch_src_global generation:  0.056244850158691406
r_  generation:  0.48835206031799316
local_output_nid generation:  0.032759904861450195
local_in_edges_tensor generation:  0.042331695556640625
mini_batch_src_global generation:  0.05450558662414551
r_  generation:  0.4857480525970459
local_output_nid generation:  0.03308677673339844
local_in_edges_tensor generation:  0.03567051887512207
mini_batch_src_global generation:  0.05373263359069824
r_  generation:  0.48517513275146484
local_output_nid generation:  0.034197330474853516
local_in_edges_tensor generation:  0.03350949287414551
mini_batch_src_global generation:  0.056635379791259766
r_  generation:  0.49712228775024414
local_output_nid generation:  0.0332183837890625
local_in_edges_tensor generation:  0.04010796546936035
mini_batch_src_global generation:  0.05539965629577637
r_  generation:  0.48561573028564453
local_output_nid generation:  0.032953500747680664
local_in_edges_tensor generation:  0.03519105911254883
mini_batch_src_global generation:  0.05465435981750488
r_  generation:  0.48993754386901855
----------------------check_connections_block total spend ----------------------------- 11.550339221954346
generate_one_block  0.6035830974578857
generate_one_block  0.5970854759216309
generate_one_block  0.5991885662078857
generate_one_block  0.5991613864898682
generate_one_block  0.5992507934570312
generate_one_block  0.6033952236175537
generate_one_block  0.598846435546875
generate_one_block  0.601893424987793
generate_one_block  0.6297633647918701
generate_one_block  0.5987944602966309
generate_one_block  0.6147983074188232
generate_one_block  0.6045913696289062
generate_one_block  0.5879898071289062
generate_one_block  0.6012923717498779
generate_one_block  0.6085779666900635
generate_one_block  0.5967590808868408
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12307596206665039  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

connection checking time:  18.01363253593445
block generation total time  15.367569208145142
average batch blocks generation time:  0.9604730755090714
block dataloader generation time/epoch 35.53097686171532
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09737062454223633  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.769477367401123  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09753656387329102  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7750773429870605  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09750699996948242  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7710204124450684  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09749031066894531  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7658147811889648  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09752464294433594  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7670631408691406  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0974574089050293  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7717390060424805  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09743261337280273  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7672677040100098  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09730052947998047  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7630424499511719  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09746313095092773  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7706046104431152  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09726905822753906  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7645449638366699  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09753084182739258  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7717275619506836  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09734964370727539  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7648720741271973  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09725236892700195  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7627449035644531  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09742212295532227  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7667708396911621  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09757232666015625  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.767669677734375  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09748649597167969  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.764625072479248  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06831277906894684 |0.014815926551818848 |0.0035730749368667603 |9.18358564376831e-05 |0.0037964731454849243 |0.0014986991882324219 |
----------------------------------------------------------pseudo_mini_loss sum 1.3751558065414429
Total (block generation + training)time/epoch 37.020085513591766
Training time/epoch 1.5152552127838135
Training time without block to device /epoch 1.278200387954712
Training time without total dataloading part /epoch 0.1208808422088623
load block tensor time/epoch 1.0930044651031494
block to device time/epoch 0.23705482482910156
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  5316767
Number of first layer input nodes during this epoch:  2509013
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12328290939331055  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025040388107299805
range selection method range initialization spend 0.012160301208496094
time for parepare:  0.01753401756286621
local_output_nid generation:  0.0014300346374511719
local_in_edges_tensor generation:  0.0060842037200927734
mini_batch_src_global generation:  0.0017209053039550781
r_  generation:  0.020768165588378906
local_output_nid generation:  0.0015146732330322266
local_in_edges_tensor generation:  0.0009827613830566406
mini_batch_src_global generation:  0.002076864242553711
r_  generation:  0.022720813751220703
local_output_nid generation:  0.0015687942504882812
local_in_edges_tensor generation:  0.0009367465972900391
mini_batch_src_global generation:  0.0017120838165283203
r_  generation:  0.02164316177368164
local_output_nid generation:  0.0016236305236816406
local_in_edges_tensor generation:  0.00095367431640625
mini_batch_src_global generation:  0.0017879009246826172
r_  generation:  0.022088289260864258
local_output_nid generation:  0.0015497207641601562
local_in_edges_tensor generation:  0.0009260177612304688
mini_batch_src_global generation:  0.0017495155334472656
r_  generation:  0.022526264190673828
local_output_nid generation:  0.0015878677368164062
local_in_edges_tensor generation:  0.0009183883666992188
mini_batch_src_global generation:  0.0017879009246826172
r_  generation:  0.02305126190185547
local_output_nid generation:  0.001573324203491211
local_in_edges_tensor generation:  0.0009682178497314453
mini_batch_src_global generation:  0.0017826557159423828
r_  generation:  0.02248859405517578
local_output_nid generation:  0.0016276836395263672
local_in_edges_tensor generation:  0.0009632110595703125
mini_batch_src_global generation:  0.0017061233520507812
r_  generation:  0.022015810012817383
local_output_nid generation:  0.0016086101531982422
local_in_edges_tensor generation:  0.0009603500366210938
mini_batch_src_global generation:  0.0017654895782470703
r_  generation:  0.02292180061340332
local_output_nid generation:  0.0016055107116699219
local_in_edges_tensor generation:  0.0009386539459228516
mini_batch_src_global generation:  0.0017511844635009766
r_  generation:  0.02239370346069336
local_output_nid generation:  0.0015735626220703125
local_in_edges_tensor generation:  0.0009808540344238281
mini_batch_src_global generation:  0.0018074512481689453
r_  generation:  0.023195266723632812
local_output_nid generation:  0.0015561580657958984
local_in_edges_tensor generation:  0.0009355545043945312
mini_batch_src_global generation:  0.0017621517181396484
r_  generation:  0.02223038673400879
local_output_nid generation:  0.0015590190887451172
local_in_edges_tensor generation:  0.0009520053863525391
mini_batch_src_global generation:  0.0017406940460205078
r_  generation:  0.022074222564697266
local_output_nid generation:  0.0015377998352050781
local_in_edges_tensor generation:  0.0009229183197021484
mini_batch_src_global generation:  0.0017850399017333984
r_  generation:  0.022460222244262695
local_output_nid generation:  0.001547098159790039
local_in_edges_tensor generation:  0.0009150505065917969
mini_batch_src_global generation:  0.0018167495727539062
r_  generation:  0.022829771041870117
local_output_nid generation:  0.0015664100646972656
local_in_edges_tensor generation:  0.0009171962738037109
mini_batch_src_global generation:  0.0017855167388916016
r_  generation:  0.022218942642211914
----------------------check_connections_block total spend ----------------------------- 0.5270438194274902
generate_one_block  0.03355860710144043
generate_one_block  0.0318911075592041
generate_one_block  0.03093242645263672
generate_one_block  0.031140565872192383
generate_one_block  0.03167390823364258
generate_one_block  0.03348350524902344
generate_one_block  0.03077244758605957
generate_one_block  0.03068399429321289
generate_one_block  0.03184223175048828
generate_one_block  0.030932188034057617
generate_one_block  0.032254934310913086
generate_one_block  0.034398794174194336
generate_one_block  0.031018495559692383
generate_one_block  0.03130149841308594
generate_one_block  0.0316166877746582
generate_one_block  0.03145456314086914
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05722403526306152
gen group dst list time:  0.01998448371887207
time for parepare:  0.01924586296081543
local_output_nid generation:  0.007260560989379883
local_in_edges_tensor generation:  0.02592635154724121
mini_batch_src_global generation:  0.029004812240600586
r_  generation:  0.25586462020874023
local_output_nid generation:  0.011203765869140625
local_in_edges_tensor generation:  0.01777791976928711
mini_batch_src_global generation:  0.03412961959838867
r_  generation:  0.2727315425872803
local_output_nid generation:  0.011372566223144531
local_in_edges_tensor generation:  0.015500068664550781
mini_batch_src_global generation:  0.034163475036621094
r_  generation:  0.2722158432006836
local_output_nid generation:  0.01220250129699707
local_in_edges_tensor generation:  0.014417648315429688
mini_batch_src_global generation:  0.03253960609436035
r_  generation:  0.2724618911743164
local_output_nid generation:  0.012728452682495117
local_in_edges_tensor generation:  0.014414548873901367
mini_batch_src_global generation:  0.03532838821411133
r_  generation:  0.27738189697265625
local_output_nid generation:  0.012861490249633789
local_in_edges_tensor generation:  0.017850637435913086
mini_batch_src_global generation:  0.035363197326660156
r_  generation:  0.27374768257141113
local_output_nid generation:  0.012719392776489258
local_in_edges_tensor generation:  0.013459920883178711
mini_batch_src_global generation:  0.03417778015136719
r_  generation:  0.2735469341278076
local_output_nid generation:  0.012781858444213867
local_in_edges_tensor generation:  0.014651775360107422
mini_batch_src_global generation:  0.033659934997558594
r_  generation:  0.2694118022918701
local_output_nid generation:  0.01319742202758789
local_in_edges_tensor generation:  0.014002084732055664
mini_batch_src_global generation:  0.03493380546569824
r_  generation:  0.2767150402069092
local_output_nid generation:  0.012876272201538086
local_in_edges_tensor generation:  0.015156269073486328
mini_batch_src_global generation:  0.03504753112792969
r_  generation:  0.27233266830444336
local_output_nid generation:  0.012761831283569336
local_in_edges_tensor generation:  0.013702392578125
mini_batch_src_global generation:  0.03760123252868652
r_  generation:  0.28238749504089355
local_output_nid generation:  0.013946771621704102
local_in_edges_tensor generation:  0.01559305191040039
mini_batch_src_global generation:  0.0343480110168457
r_  generation:  0.2736551761627197
local_output_nid generation:  0.013247013092041016
local_in_edges_tensor generation:  0.017655134201049805
mini_batch_src_global generation:  0.03468155860900879
r_  generation:  0.2729454040527344
local_output_nid generation:  0.01333761215209961
local_in_edges_tensor generation:  0.015129804611206055
mini_batch_src_global generation:  0.034735918045043945
r_  generation:  0.27413153648376465
local_output_nid generation:  0.012901067733764648
local_in_edges_tensor generation:  0.01618790626525879
mini_batch_src_global generation:  0.03677511215209961
r_  generation:  0.27991580963134766
local_output_nid generation:  0.012647628784179688
local_in_edges_tensor generation:  0.013893842697143555
mini_batch_src_global generation:  0.03445315361022949
r_  generation:  0.2760031223297119
----------------------check_connections_block total spend ----------------------------- 6.31836724281311
generate_one_block  0.3454749584197998
generate_one_block  0.3569037914276123
generate_one_block  0.3550527095794678
generate_one_block  0.34757137298583984
generate_one_block  0.35496973991394043
generate_one_block  0.3517172336578369
generate_one_block  0.37577033042907715
generate_one_block  0.34555506706237793
generate_one_block  0.3574948310852051
generate_one_block  0.3486654758453369
generate_one_block  0.36196017265319824
generate_one_block  0.3474578857421875
generate_one_block  0.34635353088378906
generate_one_block  0.3518698215484619
generate_one_block  0.36075544357299805
generate_one_block  0.34877634048461914
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03365969657897949
gen group dst list time:  0.06630873680114746
time for parepare:  0.018172740936279297
local_output_nid generation:  0.025793075561523438
local_in_edges_tensor generation:  0.04271197319030762
mini_batch_src_global generation:  0.04066133499145508
r_  generation:  0.46311044692993164
local_output_nid generation:  0.03143048286437988
local_in_edges_tensor generation:  0.03740215301513672
mini_batch_src_global generation:  0.056546926498413086
r_  generation:  0.46523356437683105
local_output_nid generation:  0.03081488609313965
local_in_edges_tensor generation:  0.03116154670715332
mini_batch_src_global generation:  0.05171918869018555
r_  generation:  0.47577357292175293
local_output_nid generation:  0.03135514259338379
local_in_edges_tensor generation:  0.032270193099975586
mini_batch_src_global generation:  0.05122494697570801
r_  generation:  0.4736471176147461
local_output_nid generation:  0.031537532806396484
local_in_edges_tensor generation:  0.07798123359680176
mini_batch_src_global generation:  0.05200052261352539
r_  generation:  0.47794580459594727
local_output_nid generation:  0.03195071220397949
local_in_edges_tensor generation:  0.03031158447265625
mini_batch_src_global generation:  0.055011749267578125
r_  generation:  0.4765143394470215
local_output_nid generation:  0.032050132751464844
local_in_edges_tensor generation:  0.035359859466552734
mini_batch_src_global generation:  0.05198979377746582
r_  generation:  0.47804903984069824
local_output_nid generation:  0.03216719627380371
local_in_edges_tensor generation:  0.03295540809631348
mini_batch_src_global generation:  0.054798126220703125
r_  generation:  0.48728275299072266
local_output_nid generation:  0.03231024742126465
local_in_edges_tensor generation:  0.030615568161010742
mini_batch_src_global generation:  0.05317091941833496
r_  generation:  0.48405957221984863
local_output_nid generation:  0.032735347747802734
local_in_edges_tensor generation:  0.030448198318481445
mini_batch_src_global generation:  0.05326366424560547
r_  generation:  0.5024044513702393
local_output_nid generation:  0.03621959686279297
local_in_edges_tensor generation:  0.034981727600097656
mini_batch_src_global generation:  0.05906319618225098
r_  generation:  0.48260998725891113
local_output_nid generation:  0.033406734466552734
local_in_edges_tensor generation:  0.032213687896728516
mini_batch_src_global generation:  0.05306696891784668
r_  generation:  0.4870419502258301
local_output_nid generation:  0.03342771530151367
local_in_edges_tensor generation:  0.03104257583618164
mini_batch_src_global generation:  0.05271267890930176
r_  generation:  0.48842740058898926
local_output_nid generation:  0.03322863578796387
local_in_edges_tensor generation:  0.030226707458496094
mini_batch_src_global generation:  0.05350613594055176
r_  generation:  0.48352646827697754
local_output_nid generation:  0.03350639343261719
local_in_edges_tensor generation:  0.029474258422851562
mini_batch_src_global generation:  0.052977800369262695
r_  generation:  0.48128771781921387
local_output_nid generation:  0.0335695743560791
local_in_edges_tensor generation:  0.03401923179626465
mini_batch_src_global generation:  0.05556845664978027
r_  generation:  0.4845585823059082
----------------------check_connections_block total spend ----------------------------- 11.338996887207031
generate_one_block  0.5904591083526611
generate_one_block  0.5979022979736328
generate_one_block  0.5942554473876953
generate_one_block  0.5944433212280273
generate_one_block  0.601003885269165
generate_one_block  0.6055936813354492
generate_one_block  0.5881903171539307
generate_one_block  0.5955119132995605
generate_one_block  0.6539750099182129
generate_one_block  0.5957560539245605
generate_one_block  0.5967397689819336
generate_one_block  0.5954399108886719
generate_one_block  0.6060242652893066
generate_one_block  0.5886096954345703
generate_one_block  0.5934677124023438
generate_one_block  0.6108214855194092
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12328290939331055  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

connection checking time:  17.65736413002014
block generation total time  15.264542579650879
average batch blocks generation time:  0.9540339112281799
block dataloader generation time/epoch 35.484213246239555
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0973515510559082  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7629437446594238  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.097503662109375  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7743310928344727  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09748125076293945  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7657246589660645  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09759235382080078  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.771355152130127  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09751272201538086  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7722597122192383  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09757852554321289  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7746443748474121  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09740972518920898  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.763615608215332  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09752607345581055  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7684464454650879  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09744834899902344  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.770789623260498  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09751749038696289  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7638578414916992  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09764766693115234  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7758579254150391  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09740734100341797  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7634854316711426  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09729385375976562  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7634134292602539  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09739971160888672  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7644643783569336  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09752893447875977  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.767486572265625  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09749746322631836  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7711424827575684  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.060467541217803955 |0.013978108763694763 |0.0037652552127838135 |9.815394878387451e-05 |0.0033549070358276367 |0.002924203872680664 |
----------------------------------------------------------pseudo_mini_loss sum 1.3599053621292114
Total (block generation + training)time/epoch 36.96070175700717
Training time/epoch 1.3752613067626953
Training time without block to device /epoch 1.151611566543579
Training time without total dataloading part /epoch 0.11841726303100586
load block tensor time/epoch 0.9674806594848633
block to device time/epoch 0.2236497402191162
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  5318871
Number of first layer input nodes during this epoch:  2510194
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12329673767089844  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026415348052978516
range selection method range initialization spend 0.01292729377746582
time for parepare:  0.020732641220092773
local_output_nid generation:  0.0014331340789794922
local_in_edges_tensor generation:  0.0043468475341796875
mini_batch_src_global generation:  0.0022373199462890625
r_  generation:  0.02173757553100586
local_output_nid generation:  0.001569509506225586
local_in_edges_tensor generation:  0.0009613037109375
mini_batch_src_global generation:  0.006781578063964844
r_  generation:  0.02255702018737793
local_output_nid generation:  0.0016493797302246094
local_in_edges_tensor generation:  0.0011591911315917969
mini_batch_src_global generation:  0.0016677379608154297
r_  generation:  0.028380632400512695
local_output_nid generation:  0.0037708282470703125
local_in_edges_tensor generation:  0.002295255661010742
mini_batch_src_global generation:  0.0030291080474853516
r_  generation:  0.023085355758666992
local_output_nid generation:  0.0020630359649658203
local_in_edges_tensor generation:  0.001096963882446289
mini_batch_src_global generation:  0.0019326210021972656
r_  generation:  0.022246360778808594
local_output_nid generation:  0.002039194107055664
local_in_edges_tensor generation:  0.0010366439819335938
mini_batch_src_global generation:  0.0017480850219726562
r_  generation:  0.02124619483947754
local_output_nid generation:  0.0019266605377197266
local_in_edges_tensor generation:  0.0010371208190917969
mini_batch_src_global generation:  0.0017390251159667969
r_  generation:  0.021931886672973633
local_output_nid generation:  0.0019478797912597656
local_in_edges_tensor generation:  0.0010523796081542969
mini_batch_src_global generation:  0.0018572807312011719
r_  generation:  0.022575855255126953
local_output_nid generation:  0.0019345283508300781
local_in_edges_tensor generation:  0.001033782958984375
mini_batch_src_global generation:  0.001779317855834961
r_  generation:  0.02218770980834961
local_output_nid generation:  0.0019192695617675781
local_in_edges_tensor generation:  0.0010330677032470703
mini_batch_src_global generation:  0.0017724037170410156
r_  generation:  0.02286553382873535
local_output_nid generation:  0.002287626266479492
local_in_edges_tensor generation:  0.0012793540954589844
mini_batch_src_global generation:  0.003321409225463867
r_  generation:  0.023939847946166992
local_output_nid generation:  0.0017025470733642578
local_in_edges_tensor generation:  0.0009608268737792969
mini_batch_src_global generation:  0.0018317699432373047
r_  generation:  0.03614234924316406
local_output_nid generation:  0.0036895275115966797
local_in_edges_tensor generation:  0.0018727779388427734
mini_batch_src_global generation:  0.005748271942138672
r_  generation:  0.02515101432800293
local_output_nid generation:  0.001600503921508789
local_in_edges_tensor generation:  0.0010182857513427734
mini_batch_src_global generation:  0.0017764568328857422
r_  generation:  0.02266383171081543
local_output_nid generation:  0.0015871524810791016
local_in_edges_tensor generation:  0.0009191036224365234
mini_batch_src_global generation:  0.0017547607421875
r_  generation:  0.021981477737426758
local_output_nid generation:  0.0015711784362792969
local_in_edges_tensor generation:  0.0009160041809082031
mini_batch_src_global generation:  0.0017769336700439453
r_  generation:  0.022616147994995117
----------------------check_connections_block total spend ----------------------------- 0.5868079662322998
generate_one_block  0.03541278839111328
generate_one_block  0.03164815902709961
generate_one_block  0.03061699867248535
generate_one_block  0.03134346008300781
generate_one_block  0.03464102745056152
generate_one_block  0.03255057334899902
generate_one_block  0.031093835830688477
generate_one_block  0.03145003318786621
generate_one_block  0.03159308433532715
generate_one_block  0.03204464912414551
generate_one_block  0.031908273696899414
generate_one_block  0.03151106834411621
generate_one_block  0.030835390090942383
generate_one_block  0.031864166259765625
generate_one_block  0.03130960464477539
generate_one_block  0.03212475776672363
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.039298057556152344
gen group dst list time:  0.018824338912963867
time for parepare:  0.019838809967041016
local_output_nid generation:  0.0075397491455078125
local_in_edges_tensor generation:  0.0286715030670166
mini_batch_src_global generation:  0.02736353874206543
r_  generation:  0.26709437370300293
local_output_nid generation:  0.012950658798217773
local_in_edges_tensor generation:  0.017731666564941406
mini_batch_src_global generation:  0.03339552879333496
r_  generation:  0.2713937759399414
local_output_nid generation:  0.011842727661132812
local_in_edges_tensor generation:  0.017792701721191406
mini_batch_src_global generation:  0.033776044845581055
r_  generation:  0.274092435836792
local_output_nid generation:  0.012840509414672852
local_in_edges_tensor generation:  0.018642425537109375
mini_batch_src_global generation:  0.03525376319885254
r_  generation:  0.28208184242248535
local_output_nid generation:  0.01405024528503418
local_in_edges_tensor generation:  0.018715620040893555
mini_batch_src_global generation:  0.0338900089263916
r_  generation:  0.2810549736022949
local_output_nid generation:  0.012858390808105469
local_in_edges_tensor generation:  0.023559093475341797
mini_batch_src_global generation:  0.03591609001159668
r_  generation:  0.27100610733032227
local_output_nid generation:  0.014038801193237305
local_in_edges_tensor generation:  0.019030332565307617
mini_batch_src_global generation:  0.045850276947021484
r_  generation:  0.2794017791748047
local_output_nid generation:  0.014859199523925781
local_in_edges_tensor generation:  0.01591014862060547
mini_batch_src_global generation:  0.034308433532714844
r_  generation:  0.27967238426208496
local_output_nid generation:  0.013535737991333008
local_in_edges_tensor generation:  0.01440572738647461
mini_batch_src_global generation:  0.035639047622680664
r_  generation:  0.2753758430480957
local_output_nid generation:  0.013778924942016602
local_in_edges_tensor generation:  0.016021251678466797
mini_batch_src_global generation:  0.034313201904296875
r_  generation:  0.27983665466308594
local_output_nid generation:  0.013596296310424805
local_in_edges_tensor generation:  0.018149852752685547
mini_batch_src_global generation:  0.03631258010864258
r_  generation:  0.2850778102874756
local_output_nid generation:  0.013699769973754883
local_in_edges_tensor generation:  0.016140460968017578
mini_batch_src_global generation:  0.03459787368774414
r_  generation:  0.27756810188293457
local_output_nid generation:  0.013589620590209961
local_in_edges_tensor generation:  0.014202356338500977
mini_batch_src_global generation:  0.03413128852844238
r_  generation:  0.2726471424102783
local_output_nid generation:  0.013975143432617188
local_in_edges_tensor generation:  0.014603137969970703
mini_batch_src_global generation:  0.036212921142578125
r_  generation:  0.2910642623901367
local_output_nid generation:  0.013195037841796875
local_in_edges_tensor generation:  0.014095544815063477
mini_batch_src_global generation:  0.037079811096191406
r_  generation:  0.2761566638946533
local_output_nid generation:  0.013192415237426758
local_in_edges_tensor generation:  0.01477670669555664
mini_batch_src_global generation:  0.03529953956604004
r_  generation:  0.28348255157470703
----------------------check_connections_block total spend ----------------------------- 6.449850559234619
generate_one_block  0.3744537830352783
generate_one_block  0.35291242599487305
generate_one_block  0.34871578216552734
generate_one_block  0.359576940536499
generate_one_block  0.35468578338623047
generate_one_block  0.3447396755218506
generate_one_block  0.37895798683166504
generate_one_block  0.3659369945526123
generate_one_block  0.3501596450805664
generate_one_block  0.355114221572876
generate_one_block  0.3611106872558594
generate_one_block  0.35196852684020996
generate_one_block  0.34865689277648926
generate_one_block  0.37239503860473633
generate_one_block  0.3483846187591553
generate_one_block  0.36269378662109375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.035854339599609375
gen group dst list time:  0.06993961334228516
time for parepare:  0.020594358444213867
local_output_nid generation:  0.02640080451965332
local_in_edges_tensor generation:  0.052904367446899414
mini_batch_src_global generation:  0.046063899993896484
r_  generation:  0.47040271759033203
local_output_nid generation:  0.031224966049194336
local_in_edges_tensor generation:  0.03800058364868164
mini_batch_src_global generation:  0.05419778823852539
r_  generation:  0.4697847366333008
local_output_nid generation:  0.0321195125579834
local_in_edges_tensor generation:  0.03668475151062012
mini_batch_src_global generation:  0.05144929885864258
r_  generation:  0.4806027412414551
local_output_nid generation:  0.032045841217041016
local_in_edges_tensor generation:  0.036637306213378906
mini_batch_src_global generation:  0.05450177192687988
r_  generation:  0.4784581661224365
local_output_nid generation:  0.03210306167602539
local_in_edges_tensor generation:  0.07975649833679199
mini_batch_src_global generation:  0.0524747371673584
r_  generation:  0.48731350898742676
local_output_nid generation:  0.03197622299194336
local_in_edges_tensor generation:  0.032080650329589844
mini_batch_src_global generation:  0.0535581111907959
r_  generation:  0.4839491844177246
local_output_nid generation:  0.032677650451660156
local_in_edges_tensor generation:  0.03824210166931152
mini_batch_src_global generation:  0.055670738220214844
r_  generation:  0.4846940040588379
local_output_nid generation:  0.03225207328796387
local_in_edges_tensor generation:  0.03724193572998047
mini_batch_src_global generation:  0.0540771484375
r_  generation:  0.4951436519622803
local_output_nid generation:  0.03415822982788086
local_in_edges_tensor generation:  0.0348818302154541
mini_batch_src_global generation:  0.053915977478027344
r_  generation:  0.4812133312225342
local_output_nid generation:  0.03316903114318848
local_in_edges_tensor generation:  0.03320050239562988
mini_batch_src_global generation:  0.05475568771362305
r_  generation:  0.48226499557495117
local_output_nid generation:  0.03330206871032715
local_in_edges_tensor generation:  0.03397965431213379
mini_batch_src_global generation:  0.05356097221374512
r_  generation:  0.4891808032989502
local_output_nid generation:  0.033190011978149414
local_in_edges_tensor generation:  0.03250408172607422
mini_batch_src_global generation:  0.05442667007446289
r_  generation:  0.481020450592041
local_output_nid generation:  0.0330655574798584
local_in_edges_tensor generation:  0.031169414520263672
mini_batch_src_global generation:  0.05276322364807129
r_  generation:  0.48357534408569336
local_output_nid generation:  0.033393144607543945
local_in_edges_tensor generation:  0.030757904052734375
mini_batch_src_global generation:  0.0551300048828125
r_  generation:  0.4869413375854492
local_output_nid generation:  0.03314089775085449
local_in_edges_tensor generation:  0.030596017837524414
mini_batch_src_global generation:  0.0537111759185791
r_  generation:  0.4827084541320801
local_output_nid generation:  0.03331422805786133
local_in_edges_tensor generation:  0.030858993530273438
mini_batch_src_global generation:  0.0577089786529541
r_  generation:  0.4937894344329834
----------------------check_connections_block total spend ----------------------------- 11.457043409347534
generate_one_block  0.6181306838989258
generate_one_block  0.596062183380127
generate_one_block  0.5908966064453125
generate_one_block  0.6010539531707764
generate_one_block  0.5999641418457031
generate_one_block  0.591515302658081
generate_one_block  0.5955142974853516
generate_one_block  0.597515344619751
generate_one_block  0.6253921985626221
generate_one_block  0.5931541919708252
generate_one_block  0.6050403118133545
generate_one_block  0.5906882286071777
generate_one_block  0.5956993103027344
generate_one_block  0.6074159145355225
generate_one_block  0.600257396697998
generate_one_block  0.6090753078460693
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12329673767089844  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

connection checking time:  17.906893968582153
block generation total time  15.347838163375854
average batch blocks generation time:  0.9592398852109909
block dataloader generation time/epoch 35.49161167144776
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09774160385131836  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7754063606262207  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09745550155639648  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7666645050048828  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0971064567565918  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7625246047973633  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0975651741027832  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7714405059814453  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09749269485473633  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7706847190856934  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0971384048461914  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.762293815612793  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09745597839355469  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7676939964294434  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0974583625793457  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7713065147399902  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09714126586914062  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7598838806152344  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09741973876953125  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.774594783782959  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09768486022949219  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7749533653259277  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09747600555419922  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7662768363952637  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09720945358276367  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7610836029052734  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09758424758911133  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7721376419067383  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09734058380126953  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.763392448425293  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09767913818359375  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7748613357543945  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0645752102136612 |0.01650702953338623 |0.003534570336341858 |9.569525718688965e-05 |0.003598228096961975 |0.0013594627380371094 |
----------------------------------------------------------pseudo_mini_loss sum 1.3454797267913818
Total (block generation + training)time/epoch 36.968636345863345
Training time/epoch 1.4816477298736572
Training time without block to device /epoch 1.2175352573394775
Training time without total dataloading part /epoch 0.11701536178588867
load block tensor time/epoch 1.033203363418579
block to device time/epoch 0.2641124725341797
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  5317234
Number of first layer input nodes during this epoch:  2508793
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12373208999633789  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024001121520996094
range selection method range initialization spend 0.01228642463684082
time for parepare:  0.01800680160522461
local_output_nid generation:  0.001529693603515625
local_in_edges_tensor generation:  0.00668025016784668
mini_batch_src_global generation:  0.0021953582763671875
r_  generation:  0.021871328353881836
local_output_nid generation:  0.0015430450439453125
local_in_edges_tensor generation:  0.000986337661743164
mini_batch_src_global generation:  0.002350330352783203
r_  generation:  0.022796630859375
local_output_nid generation:  0.0015690326690673828
local_in_edges_tensor generation:  0.0009398460388183594
mini_batch_src_global generation:  0.0016820430755615234
r_  generation:  0.02127361297607422
local_output_nid generation:  0.0016064643859863281
local_in_edges_tensor generation:  0.0009622573852539062
mini_batch_src_global generation:  0.0016412734985351562
r_  generation:  0.021610260009765625
local_output_nid generation:  0.001565694808959961
local_in_edges_tensor generation:  0.00096893310546875
mini_batch_src_global generation:  0.0017361640930175781
r_  generation:  0.022270679473876953
local_output_nid generation:  0.001575469970703125
local_in_edges_tensor generation:  0.0009522438049316406
mini_batch_src_global generation:  0.0019054412841796875
r_  generation:  0.023581743240356445
local_output_nid generation:  0.0015745162963867188
local_in_edges_tensor generation:  0.0009517669677734375
mini_batch_src_global generation:  0.001863718032836914
r_  generation:  0.023181438446044922
local_output_nid generation:  0.0015709400177001953
local_in_edges_tensor generation:  0.0009572505950927734
mini_batch_src_global generation:  0.0018193721771240234
r_  generation:  0.022368431091308594
local_output_nid generation:  0.001565694808959961
local_in_edges_tensor generation:  0.0009548664093017578
mini_batch_src_global generation:  0.001748800277709961
r_  generation:  0.02197265625
local_output_nid generation:  0.0015611648559570312
local_in_edges_tensor generation:  0.0009262561798095703
mini_batch_src_global generation:  0.001726388931274414
r_  generation:  0.022679567337036133
local_output_nid generation:  0.0015604496002197266
local_in_edges_tensor generation:  0.0009491443634033203
mini_batch_src_global generation:  0.001804351806640625
r_  generation:  0.022913455963134766
local_output_nid generation:  0.0015938282012939453
local_in_edges_tensor generation:  0.0009143352508544922
mini_batch_src_global generation:  0.0018093585968017578
r_  generation:  0.023482084274291992
local_output_nid generation:  0.001566171646118164
local_in_edges_tensor generation:  0.0009975433349609375
mini_batch_src_global generation:  0.0017735958099365234
r_  generation:  0.022434234619140625
local_output_nid generation:  0.001575469970703125
local_in_edges_tensor generation:  0.0009245872497558594
mini_batch_src_global generation:  0.0017724037170410156
r_  generation:  0.02377462387084961
local_output_nid generation:  0.0015714168548583984
local_in_edges_tensor generation:  0.0009076595306396484
mini_batch_src_global generation:  0.0018231868743896484
r_  generation:  0.022582054138183594
local_output_nid generation:  0.0016019344329833984
local_in_edges_tensor generation:  0.0009276866912841797
mini_batch_src_global generation:  0.001833200454711914
r_  generation:  0.023786544799804688
----------------------check_connections_block total spend ----------------------------- 0.5354015827178955
generate_one_block  0.0345768928527832
generate_one_block  0.03160429000854492
generate_one_block  0.030059099197387695
generate_one_block  0.029756546020507812
generate_one_block  0.031003713607788086
generate_one_block  0.03408503532409668
generate_one_block  0.031935930252075195
generate_one_block  0.030707120895385742
generate_one_block  0.030652761459350586
generate_one_block  0.030823469161987305
generate_one_block  0.03152656555175781
generate_one_block  0.031998395919799805
generate_one_block  0.03136610984802246
generate_one_block  0.031847476959228516
generate_one_block  0.031198740005493164
generate_one_block  0.03260493278503418
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03728055953979492
gen group dst list time:  0.018718719482421875
time for parepare:  0.019640207290649414
local_output_nid generation:  0.0073702335357666016
local_in_edges_tensor generation:  0.02438664436340332
mini_batch_src_global generation:  0.02740192413330078
r_  generation:  0.2607452869415283
local_output_nid generation:  0.011165857315063477
local_in_edges_tensor generation:  0.017592430114746094
mini_batch_src_global generation:  0.03243613243103027
r_  generation:  0.2741248607635498
local_output_nid generation:  0.011636972427368164
local_in_edges_tensor generation:  0.017445802688598633
mini_batch_src_global generation:  0.03163790702819824
r_  generation:  0.2700951099395752
local_output_nid generation:  0.012328624725341797
local_in_edges_tensor generation:  0.019366025924682617
mini_batch_src_global generation:  0.03187727928161621
r_  generation:  0.2719550132751465
local_output_nid generation:  0.012323141098022461
local_in_edges_tensor generation:  0.01815509796142578
mini_batch_src_global generation:  0.03502035140991211
r_  generation:  0.28235840797424316
local_output_nid generation:  0.013711929321289062
local_in_edges_tensor generation:  0.020411014556884766
mini_batch_src_global generation:  0.03571128845214844
r_  generation:  0.29038286209106445
local_output_nid generation:  0.013152122497558594
local_in_edges_tensor generation:  0.013881444931030273
mini_batch_src_global generation:  0.03784513473510742
r_  generation:  0.28786492347717285
local_output_nid generation:  0.013137578964233398
local_in_edges_tensor generation:  0.018206357955932617
mini_batch_src_global generation:  0.03601670265197754
r_  generation:  0.276578426361084
local_output_nid generation:  0.012945175170898438
local_in_edges_tensor generation:  0.016143083572387695
mini_batch_src_global generation:  0.03666949272155762
r_  generation:  0.2778656482696533
local_output_nid generation:  0.013242959976196289
local_in_edges_tensor generation:  0.013580083847045898
mini_batch_src_global generation:  0.04026150703430176
r_  generation:  0.2853715419769287
local_output_nid generation:  0.014659404754638672
local_in_edges_tensor generation:  0.0165860652923584
mini_batch_src_global generation:  0.03509378433227539
r_  generation:  0.28165125846862793
local_output_nid generation:  0.013995170593261719
local_in_edges_tensor generation:  0.018949270248413086
mini_batch_src_global generation:  0.03519296646118164
r_  generation:  0.2874152660369873
local_output_nid generation:  0.013683557510375977
local_in_edges_tensor generation:  0.013840913772583008
mini_batch_src_global generation:  0.03536391258239746
r_  generation:  0.2803304195404053
local_output_nid generation:  0.013879776000976562
local_in_edges_tensor generation:  0.015317440032958984
mini_batch_src_global generation:  0.03667902946472168
r_  generation:  0.2851064205169678
local_output_nid generation:  0.013484954833984375
local_in_edges_tensor generation:  0.013752460479736328
mini_batch_src_global generation:  0.03527021408081055
r_  generation:  0.2801246643066406
local_output_nid generation:  0.013380050659179688
local_in_edges_tensor generation:  0.015154600143432617
mini_batch_src_global generation:  0.03490161895751953
r_  generation:  0.2862541675567627
----------------------check_connections_block total spend ----------------------------- 6.466841220855713
generate_one_block  0.35912322998046875
generate_one_block  0.36980247497558594
generate_one_block  0.34487342834472656
generate_one_block  0.3391702175140381
generate_one_block  0.3545677661895752
generate_one_block  0.36382246017456055
generate_one_block  0.3887805938720703
generate_one_block  0.34699153900146484
generate_one_block  0.3452003002166748
generate_one_block  0.34844350814819336
generate_one_block  0.3563413619995117
generate_one_block  0.3627140522003174
generate_one_block  0.3495807647705078
generate_one_block  0.3599114418029785
generate_one_block  0.3524026870727539
generate_one_block  0.3612632751464844
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04164934158325195
gen group dst list time:  0.07231497764587402
time for parepare:  0.019835472106933594
local_output_nid generation:  0.026532649993896484
local_in_edges_tensor generation:  0.05596637725830078
mini_batch_src_global generation:  0.04474377632141113
r_  generation:  0.47890162467956543
local_output_nid generation:  0.03197646141052246
local_in_edges_tensor generation:  0.042441606521606445
mini_batch_src_global generation:  0.057694435119628906
r_  generation:  0.47174763679504395
local_output_nid generation:  0.03260159492492676
local_in_edges_tensor generation:  0.032505035400390625
mini_batch_src_global generation:  0.05063962936401367
r_  generation:  0.47806477546691895
local_output_nid generation:  0.03258204460144043
local_in_edges_tensor generation:  0.03658485412597656
mini_batch_src_global generation:  0.051541805267333984
r_  generation:  0.4796435832977295
local_output_nid generation:  0.03289055824279785
local_in_edges_tensor generation:  0.08545303344726562
mini_batch_src_global generation:  0.051759958267211914
r_  generation:  0.4858226776123047
local_output_nid generation:  0.03227663040161133
local_in_edges_tensor generation:  0.034409284591674805
mini_batch_src_global generation:  0.05279135704040527
r_  generation:  0.48658204078674316
local_output_nid generation:  0.03214621543884277
local_in_edges_tensor generation:  0.03438377380371094
mini_batch_src_global generation:  0.05208945274353027
r_  generation:  0.4923582077026367
local_output_nid generation:  0.03235125541687012
local_in_edges_tensor generation:  0.032842159271240234
mini_batch_src_global generation:  0.05487942695617676
r_  generation:  0.4835083484649658
local_output_nid generation:  0.03201651573181152
local_in_edges_tensor generation:  0.03269314765930176
mini_batch_src_global generation:  0.054203033447265625
r_  generation:  0.4890122413635254
local_output_nid generation:  0.032044410705566406
local_in_edges_tensor generation:  0.030303478240966797
mini_batch_src_global generation:  0.054960012435913086
r_  generation:  0.4840092658996582
local_output_nid generation:  0.03238821029663086
local_in_edges_tensor generation:  0.03269696235656738
mini_batch_src_global generation:  0.05541396141052246
r_  generation:  0.4883859157562256
local_output_nid generation:  0.03239107131958008
local_in_edges_tensor generation:  0.0305941104888916
mini_batch_src_global generation:  0.05660200119018555
r_  generation:  0.48671913146972656
local_output_nid generation:  0.03195953369140625
local_in_edges_tensor generation:  0.035587310791015625
mini_batch_src_global generation:  0.05416059494018555
r_  generation:  0.48610997200012207
local_output_nid generation:  0.032507896423339844
local_in_edges_tensor generation:  0.03280019760131836
mini_batch_src_global generation:  0.05510210990905762
r_  generation:  0.489882230758667
local_output_nid generation:  0.033081769943237305
local_in_edges_tensor generation:  0.03142356872558594
mini_batch_src_global generation:  0.05361747741699219
r_  generation:  0.49184489250183105
local_output_nid generation:  0.03252077102661133
local_in_edges_tensor generation:  0.03096747398376465
mini_batch_src_global generation:  0.058927059173583984
r_  generation:  0.4849061965942383
----------------------check_connections_block total spend ----------------------------- 11.476717472076416
generate_one_block  0.602496862411499
generate_one_block  0.5934031009674072
generate_one_block  0.6027626991271973
generate_one_block  0.6001670360565186
generate_one_block  0.6075472831726074
generate_one_block  0.6072700023651123
generate_one_block  0.6073222160339355
generate_one_block  0.5973401069641113
generate_one_block  0.6776223182678223
generate_one_block  0.6028711795806885
generate_one_block  0.6013669967651367
generate_one_block  0.6030149459838867
generate_one_block  0.6010770797729492
generate_one_block  0.6015181541442871
generate_one_block  0.5980525016784668
generate_one_block  0.6029834747314453
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12373208999633789  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

connection checking time:  17.94355869293213
block generation total time  15.409805059432983
average batch blocks generation time:  0.9631128162145615
block dataloader generation time/epoch 35.49964638189836
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09743881225585938  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7658500671386719  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09739446640014648  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7642755508422852  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09724807739257812  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7622604370117188  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09718990325927734  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.761289119720459  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09743595123291016  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.766331672668457  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09767723083496094  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.775972843170166  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0975041389465332  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7711582183837891  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09722661972045898  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7626018524169922  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09738492965698242  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.763519287109375  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0972280502319336  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7635102272033691  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09754705429077148  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7743110656738281  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09762859344482422  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7754945755004883  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09726333618164062  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7638797760009766  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09751176834106445  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7687139511108398  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09731388092041016  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7664070129394531  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09749126434326172  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7754602432250977  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06365329027175903 |0.01564207673072815 |0.003544166684150696 |9.483098983764648e-05 |0.003484666347503662 |0.002816915512084961 |
----------------------------------------------------------pseudo_mini_loss sum 1.3268122673034668
Total (block generation + training)time/epoch 36.97436237335205
Training time/epoch 1.4513599872589111
Training time without block to device /epoch 1.2010867595672607
Training time without total dataloading part /epoch 0.11679553985595703
load block tensor time/epoch 1.0184526443481445
block to device time/epoch 0.2502732276916504
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 20 |
Number of nodes for computation during this epoch:  5315195
Number of first layer input nodes during this epoch:  2508011
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.1235203742980957  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.029907703399658203
range selection method range initialization spend 0.012597084045410156
time for parepare:  0.01701807975769043
local_output_nid generation:  0.0014443397521972656
local_in_edges_tensor generation:  0.005537509918212891
mini_batch_src_global generation:  0.0019354820251464844
r_  generation:  0.02202892303466797
local_output_nid generation:  0.0015463829040527344
local_in_edges_tensor generation:  0.0013163089752197266
mini_batch_src_global generation:  0.0021958351135253906
r_  generation:  0.021965503692626953
local_output_nid generation:  0.0015583038330078125
local_in_edges_tensor generation:  0.0011508464813232422
mini_batch_src_global generation:  0.0018908977508544922
r_  generation:  0.021935701370239258
local_output_nid generation:  0.0016078948974609375
local_in_edges_tensor generation:  0.0009713172912597656
mini_batch_src_global generation:  0.0018415451049804688
r_  generation:  0.021468400955200195
local_output_nid generation:  0.0015463829040527344
local_in_edges_tensor generation:  0.0013298988342285156
mini_batch_src_global generation:  0.0018057823181152344
r_  generation:  0.024498939514160156
local_output_nid generation:  0.0017547607421875
local_in_edges_tensor generation:  0.001142263412475586
mini_batch_src_global generation:  0.0017888545989990234
r_  generation:  0.022878646850585938
local_output_nid generation:  0.0015780925750732422
local_in_edges_tensor generation:  0.0009448528289794922
mini_batch_src_global generation:  0.0018012523651123047
r_  generation:  0.022907257080078125
local_output_nid generation:  0.0015666484832763672
local_in_edges_tensor generation:  0.0010535717010498047
mini_batch_src_global generation:  0.0018777847290039062
r_  generation:  0.023032188415527344
local_output_nid generation:  0.0015687942504882812
local_in_edges_tensor generation:  0.00099945068359375
mini_batch_src_global generation:  0.002010822296142578
r_  generation:  0.02370309829711914
local_output_nid generation:  0.0015773773193359375
local_in_edges_tensor generation:  0.0010638236999511719
mini_batch_src_global generation:  0.0018391609191894531
r_  generation:  0.022937297821044922
local_output_nid generation:  0.0015606880187988281
local_in_edges_tensor generation:  0.0010559558868408203
mini_batch_src_global generation:  0.0018036365509033203
r_  generation:  0.022325515747070312
local_output_nid generation:  0.001600027084350586
local_in_edges_tensor generation:  0.0010519027709960938
mini_batch_src_global generation:  0.0018467903137207031
r_  generation:  0.022585153579711914
local_output_nid generation:  0.0015892982482910156
local_in_edges_tensor generation:  0.0010766983032226562
mini_batch_src_global generation:  0.018104076385498047
r_  generation:  0.022874832153320312
local_output_nid generation:  0.0015795230865478516
local_in_edges_tensor generation:  0.001064300537109375
mini_batch_src_global generation:  0.0018620491027832031
r_  generation:  0.022704601287841797
local_output_nid generation:  0.0015988349914550781
local_in_edges_tensor generation:  0.0033926963806152344
mini_batch_src_global generation:  0.0017790794372558594
r_  generation:  0.02292633056640625
local_output_nid generation:  0.0016012191772460938
local_in_edges_tensor generation:  0.001100301742553711
mini_batch_src_global generation:  0.0017414093017578125
r_  generation:  0.02253556251525879
----------------------check_connections_block total spend ----------------------------- 0.5605390071868896
generate_one_block  0.035408735275268555
generate_one_block  0.03242993354797363
generate_one_block  0.03157234191894531
generate_one_block  0.030717134475708008
generate_one_block  0.033319711685180664
generate_one_block  0.03323960304260254
generate_one_block  0.03150629997253418
generate_one_block  0.03209805488586426
generate_one_block  0.03240180015563965
generate_one_block  0.03174781799316406
generate_one_block  0.03319907188415527
generate_one_block  0.031203508377075195
generate_one_block  0.03190922737121582
generate_one_block  0.03148031234741211
generate_one_block  0.03365135192871094
generate_one_block  0.03196597099304199
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.041187286376953125
gen group dst list time:  0.018403291702270508
time for parepare:  0.02057337760925293
local_output_nid generation:  0.00798487663269043
local_in_edges_tensor generation:  0.0234220027923584
mini_batch_src_global generation:  0.027991294860839844
r_  generation:  0.2584257125854492
local_output_nid generation:  0.011112689971923828
local_in_edges_tensor generation:  0.017366409301757812
mini_batch_src_global generation:  0.03363633155822754
r_  generation:  0.2619516849517822
local_output_nid generation:  0.012044429779052734
local_in_edges_tensor generation:  0.016713857650756836
mini_batch_src_global generation:  0.03237104415893555
r_  generation:  0.26963376998901367
local_output_nid generation:  0.01205897331237793
local_in_edges_tensor generation:  0.01642465591430664
mini_batch_src_global generation:  0.031980276107788086
r_  generation:  0.2652101516723633
local_output_nid generation:  0.012025594711303711
local_in_edges_tensor generation:  0.013678550720214844
mini_batch_src_global generation:  0.03662514686584473
r_  generation:  0.2970602512359619
local_output_nid generation:  0.014882326126098633
local_in_edges_tensor generation:  0.015656232833862305
mini_batch_src_global generation:  0.03524279594421387
r_  generation:  0.27501511573791504
local_output_nid generation:  0.013156890869140625
local_in_edges_tensor generation:  0.014694690704345703
mini_batch_src_global generation:  0.034063100814819336
r_  generation:  0.2776172161102295
local_output_nid generation:  0.01358485221862793
local_in_edges_tensor generation:  0.013687610626220703
mini_batch_src_global generation:  0.03598809242248535
r_  generation:  0.2786858081817627
local_output_nid generation:  0.013644933700561523
local_in_edges_tensor generation:  0.017628908157348633
mini_batch_src_global generation:  0.03690218925476074
r_  generation:  0.2879476547241211
local_output_nid generation:  0.014560222625732422
local_in_edges_tensor generation:  0.01825690269470215
mini_batch_src_global generation:  0.03458595275878906
r_  generation:  0.2780170440673828
local_output_nid generation:  0.015207529067993164
local_in_edges_tensor generation:  0.013435840606689453
mini_batch_src_global generation:  0.034876108169555664
r_  generation:  0.27745985984802246
local_output_nid generation:  0.013472318649291992
local_in_edges_tensor generation:  0.01869964599609375
mini_batch_src_global generation:  0.03532290458679199
r_  generation:  0.27785539627075195
local_output_nid generation:  0.013886213302612305
local_in_edges_tensor generation:  0.017239809036254883
mini_batch_src_global generation:  0.04130434989929199
r_  generation:  0.28588128089904785
local_output_nid generation:  0.013676643371582031
local_in_edges_tensor generation:  0.016066312789916992
mini_batch_src_global generation:  0.03778886795043945
r_  generation:  0.2781867980957031
local_output_nid generation:  0.01351475715637207
local_in_edges_tensor generation:  0.016997337341308594
mini_batch_src_global generation:  0.036377668380737305
r_  generation:  0.28248119354248047
local_output_nid generation:  0.013203620910644531
local_in_edges_tensor generation:  0.01384592056274414
mini_batch_src_global generation:  0.0422210693359375
r_  generation:  0.27974748611450195
----------------------check_connections_block total spend ----------------------------- 6.428605318069458
generate_one_block  0.36941027641296387
generate_one_block  0.35033106803894043
generate_one_block  0.3576850891113281
generate_one_block  0.3482682704925537
generate_one_block  0.36827778816223145
generate_one_block  0.3526942729949951
generate_one_block  0.37809014320373535
generate_one_block  0.3584263324737549
generate_one_block  0.36704063415527344
generate_one_block  0.3509180545806885
generate_one_block  0.3479011058807373
generate_one_block  0.354478120803833
generate_one_block  0.3626890182495117
generate_one_block  0.3491041660308838
generate_one_block  0.35056471824645996
generate_one_block  0.3535158634185791
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.09356141090393066
gen group dst list time:  0.07176065444946289
time for parepare:  0.02011275291442871
local_output_nid generation:  0.025705814361572266
local_in_edges_tensor generation:  0.05150032043457031
mini_batch_src_global generation:  0.05413413047790527
r_  generation:  0.4775974750518799
local_output_nid generation:  0.03175806999206543
local_in_edges_tensor generation:  0.039113759994506836
mini_batch_src_global generation:  0.06334924697875977
r_  generation:  0.4728410243988037
local_output_nid generation:  0.03269457817077637
local_in_edges_tensor generation:  0.03156638145446777
mini_batch_src_global generation:  0.05359768867492676
r_  generation:  0.4782114028930664
local_output_nid generation:  0.032323360443115234
local_in_edges_tensor generation:  0.030764102935791016
mini_batch_src_global generation:  0.05455946922302246
r_  generation:  0.47480154037475586
local_output_nid generation:  0.03209233283996582
local_in_edges_tensor generation:  0.0837090015411377
mini_batch_src_global generation:  0.05598807334899902
r_  generation:  0.48366761207580566
local_output_nid generation:  0.04287910461425781
local_in_edges_tensor generation:  0.03391551971435547
mini_batch_src_global generation:  0.05528140068054199
r_  generation:  0.4839329719543457
local_output_nid generation:  0.03165769577026367
local_in_edges_tensor generation:  0.03097844123840332
mini_batch_src_global generation:  0.05813026428222656
r_  generation:  0.48262810707092285
local_output_nid generation:  0.032073259353637695
local_in_edges_tensor generation:  0.029680490493774414
mini_batch_src_global generation:  0.056096792221069336
r_  generation:  0.48624205589294434
local_output_nid generation:  0.03200674057006836
local_in_edges_tensor generation:  0.029352664947509766
mini_batch_src_global generation:  0.05575251579284668
r_  generation:  0.4894530773162842
local_output_nid generation:  0.03298783302307129
local_in_edges_tensor generation:  0.035805463790893555
mini_batch_src_global generation:  0.053991079330444336
r_  generation:  0.4892277717590332
local_output_nid generation:  0.03225898742675781
local_in_edges_tensor generation:  0.029938220977783203
mini_batch_src_global generation:  0.05297660827636719
r_  generation:  0.494356632232666
local_output_nid generation:  0.032563209533691406
local_in_edges_tensor generation:  0.031594276428222656
mini_batch_src_global generation:  0.05433821678161621
r_  generation:  0.4936082363128662
local_output_nid generation:  0.03299856185913086
local_in_edges_tensor generation:  0.031809091567993164
mini_batch_src_global generation:  0.05397176742553711
r_  generation:  0.4987344741821289
local_output_nid generation:  0.03266406059265137
local_in_edges_tensor generation:  0.03154778480529785
mini_batch_src_global generation:  0.05408954620361328
r_  generation:  0.4871668815612793
local_output_nid generation:  0.03399372100830078
local_in_edges_tensor generation:  0.03240799903869629
mini_batch_src_global generation:  0.0535435676574707
r_  generation:  0.4873075485229492
local_output_nid generation:  0.032573699951171875
local_in_edges_tensor generation:  0.03134632110595703
mini_batch_src_global generation:  0.05379962921142578
r_  generation:  0.48581504821777344
----------------------check_connections_block total spend ----------------------------- 11.482125043869019
generate_one_block  0.6123213768005371
generate_one_block  0.5990786552429199
generate_one_block  0.5969645977020264
generate_one_block  0.5901436805725098
generate_one_block  0.5973424911499023
generate_one_block  0.6047229766845703
generate_one_block  0.603156566619873
generate_one_block  0.6012258529663086
generate_one_block  0.6463634967803955
generate_one_block  0.6005496978759766
generate_one_block  0.5994925498962402
generate_one_block  0.5987527370452881
generate_one_block  0.6018111705780029
generate_one_block  0.6028594970703125
generate_one_block  0.6066460609436035
generate_one_block  0.5948820114135742
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.1235203742980957  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

connection checking time:  17.910730361938477
block generation total time  15.37570834159851
average batch blocks generation time:  0.9609817713499069
block dataloader generation time/epoch 35.508586049079895
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09769201278686523  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7746367454528809  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09741640090942383  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.763852596282959  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09739398956298828  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7682104110717773  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09714221954345703  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7630505561828613  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09750747680664062  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7677083015441895  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09734439849853516  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7644228935241699  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09723186492919922  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7648720741271973  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09742546081542969  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.767425537109375  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09756660461425781  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7699098587036133  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09734010696411133  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7652649879455566  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09731817245483398  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7641839981079102  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09734821319580078  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7651700973510742  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09773445129394531  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7752981185913086  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09762191772460938  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7704882621765137  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09744501113891602  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7667641639709473  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09752893447875977  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7721223831176758  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06693227589130402 |0.013703569769859314 |0.003547579050064087 |9.335577487945557e-05 |0.0037481337785720825 |0.0013315677642822266 |
----------------------------------------------------------pseudo_mini_loss sum 1.314915657043457
Total (block generation + training)time/epoch 36.9832486708959
Training time/epoch 1.4738941192626953
Training time without block to device /epoch 1.2546370029449463
Training time without total dataloading part /epoch 0.11955666542053223
load block tensor time/epoch 1.0709164142608643
block to device time/epoch 0.21925711631774902
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 21 |
Number of nodes for computation during this epoch:  5318073
Number of first layer input nodes during this epoch:  2509123
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12326240539550781  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0424954891204834
range selection method range initialization spend 0.027120590209960938
time for parepare:  0.019622802734375
local_output_nid generation:  0.0014462471008300781
local_in_edges_tensor generation:  0.007243633270263672
mini_batch_src_global generation:  0.0017976760864257812
r_  generation:  0.021697998046875
local_output_nid generation:  0.0016100406646728516
local_in_edges_tensor generation:  0.0009558200836181641
mini_batch_src_global generation:  0.0020978450775146484
r_  generation:  0.02270054817199707
local_output_nid generation:  0.001592874526977539
local_in_edges_tensor generation:  0.0009577274322509766
mini_batch_src_global generation:  0.001924276351928711
r_  generation:  0.021622180938720703
local_output_nid generation:  0.0016632080078125
local_in_edges_tensor generation:  0.00095367431640625
mini_batch_src_global generation:  0.0017392635345458984
r_  generation:  0.022084951400756836
local_output_nid generation:  0.0016798973083496094
local_in_edges_tensor generation:  0.0010044574737548828
mini_batch_src_global generation:  0.001786947250366211
r_  generation:  0.02422475814819336
local_output_nid generation:  0.0017457008361816406
local_in_edges_tensor generation:  0.0009369850158691406
mini_batch_src_global generation:  0.0018699169158935547
r_  generation:  0.02283024787902832
local_output_nid generation:  0.0016219615936279297
local_in_edges_tensor generation:  0.0009562969207763672
mini_batch_src_global generation:  0.0017781257629394531
r_  generation:  0.022394895553588867
local_output_nid generation:  0.0016140937805175781
local_in_edges_tensor generation:  0.0009465217590332031
mini_batch_src_global generation:  0.0017251968383789062
r_  generation:  0.02218174934387207
local_output_nid generation:  0.001604318618774414
local_in_edges_tensor generation:  0.0009398460388183594
mini_batch_src_global generation:  0.001768350601196289
r_  generation:  0.022542715072631836
local_output_nid generation:  0.0016155242919921875
local_in_edges_tensor generation:  0.0010840892791748047
mini_batch_src_global generation:  0.0018110275268554688
r_  generation:  0.021371126174926758
local_output_nid generation:  0.001617431640625
local_in_edges_tensor generation:  0.0009515285491943359
mini_batch_src_global generation:  0.00177001953125
r_  generation:  0.02245807647705078
local_output_nid generation:  0.0016062259674072266
local_in_edges_tensor generation:  0.0009932518005371094
mini_batch_src_global generation:  0.0017323493957519531
r_  generation:  0.02246260643005371
local_output_nid generation:  0.0016961097717285156
local_in_edges_tensor generation:  0.0010528564453125
mini_batch_src_global generation:  0.0018661022186279297
r_  generation:  0.022777557373046875
local_output_nid generation:  0.0015974044799804688
local_in_edges_tensor generation:  0.0010247230529785156
mini_batch_src_global generation:  0.0017497539520263672
r_  generation:  0.022236108779907227
local_output_nid generation:  0.001590728759765625
local_in_edges_tensor generation:  0.0010461807250976562
mini_batch_src_global generation:  0.001707315444946289
r_  generation:  0.024510860443115234
local_output_nid generation:  0.0016283988952636719
local_in_edges_tensor generation:  0.0010159015655517578
mini_batch_src_global generation:  0.0017504692077636719
r_  generation:  0.022531747817993164
----------------------check_connections_block total spend ----------------------------- 0.5357296466827393
generate_one_block  0.031943559646606445
generate_one_block  0.033487558364868164
generate_one_block  0.030926227569580078
generate_one_block  0.03136110305786133
generate_one_block  0.031166791915893555
generate_one_block  0.03387928009033203
generate_one_block  0.03157353401184082
generate_one_block  0.030852556228637695
generate_one_block  0.032251834869384766
generate_one_block  0.030725479125976562
generate_one_block  0.031618595123291016
generate_one_block  0.03127002716064453
generate_one_block  0.03171491622924805
generate_one_block  0.031223297119140625
generate_one_block  0.030930280685424805
generate_one_block  0.032495975494384766
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04111909866333008
gen group dst list time:  0.017220020294189453
time for parepare:  0.020487070083618164
local_output_nid generation:  0.007594108581542969
local_in_edges_tensor generation:  0.025571584701538086
mini_batch_src_global generation:  0.027613401412963867
r_  generation:  0.2608160972595215
local_output_nid generation:  0.011393547058105469
local_in_edges_tensor generation:  0.017242431640625
mini_batch_src_global generation:  0.03336668014526367
r_  generation:  0.2642812728881836
local_output_nid generation:  0.011687755584716797
local_in_edges_tensor generation:  0.01643061637878418
mini_batch_src_global generation:  0.03153419494628906
r_  generation:  0.2675812244415283
local_output_nid generation:  0.012214183807373047
local_in_edges_tensor generation:  0.013199567794799805
mini_batch_src_global generation:  0.03386950492858887
r_  generation:  0.27250099182128906
local_output_nid generation:  0.012591361999511719
local_in_edges_tensor generation:  0.013258218765258789
mini_batch_src_global generation:  0.033650875091552734
r_  generation:  0.27802085876464844
local_output_nid generation:  0.01282191276550293
local_in_edges_tensor generation:  0.01467752456665039
mini_batch_src_global generation:  0.040644168853759766
r_  generation:  0.2884399890899658
local_output_nid generation:  0.014185905456542969
local_in_edges_tensor generation:  0.01606893539428711
mini_batch_src_global generation:  0.03449392318725586
r_  generation:  0.27853941917419434
local_output_nid generation:  0.013338804244995117
local_in_edges_tensor generation:  0.01576852798461914
mini_batch_src_global generation:  0.03352785110473633
r_  generation:  0.27321624755859375
local_output_nid generation:  0.013587236404418945
local_in_edges_tensor generation:  0.013270854949951172
mini_batch_src_global generation:  0.03480815887451172
r_  generation:  0.2803990840911865
local_output_nid generation:  0.013013839721679688
local_in_edges_tensor generation:  0.017494916915893555
mini_batch_src_global generation:  0.03346109390258789
r_  generation:  0.26714324951171875
local_output_nid generation:  0.013042449951171875
local_in_edges_tensor generation:  0.012996673583984375
mini_batch_src_global generation:  0.03486037254333496
r_  generation:  0.28911733627319336
local_output_nid generation:  0.01338815689086914
local_in_edges_tensor generation:  0.013909339904785156
mini_batch_src_global generation:  0.03434395790100098
r_  generation:  0.28370213508605957
local_output_nid generation:  0.01376032829284668
local_in_edges_tensor generation:  0.014081239700317383
mini_batch_src_global generation:  0.035085201263427734
r_  generation:  0.27946043014526367
local_output_nid generation:  0.01342320442199707
local_in_edges_tensor generation:  0.015933513641357422
mini_batch_src_global generation:  0.034552812576293945
r_  generation:  0.27767181396484375
local_output_nid generation:  0.013368844985961914
local_in_edges_tensor generation:  0.013518095016479492
mini_batch_src_global generation:  0.03442811965942383
r_  generation:  0.27840685844421387
local_output_nid generation:  0.013399600982666016
local_in_edges_tensor generation:  0.01593947410583496
mini_batch_src_global generation:  0.0363309383392334
r_  generation:  0.2813386917114258
----------------------check_connections_block total spend ----------------------------- 6.3756935596466064
generate_one_block  0.36344122886657715
generate_one_block  0.35099339485168457
generate_one_block  0.35582470893859863
generate_one_block  0.3569672107696533
generate_one_block  0.3562166690826416
generate_one_block  0.3605966567993164
generate_one_block  0.37926197052001953
generate_one_block  0.3484020233154297
generate_one_block  0.3605468273162842
generate_one_block  0.337191104888916
generate_one_block  0.3529226779937744
generate_one_block  0.34903645515441895
generate_one_block  0.3552253246307373
generate_one_block  0.3549623489379883
generate_one_block  0.35002827644348145
generate_one_block  0.3624589443206787
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.034014225006103516
gen group dst list time:  0.070404052734375
time for parepare:  0.018860816955566406
local_output_nid generation:  0.026003122329711914
local_in_edges_tensor generation:  0.04984021186828613
mini_batch_src_global generation:  0.0436396598815918
r_  generation:  0.48505330085754395
local_output_nid generation:  0.03056502342224121
local_in_edges_tensor generation:  0.03749394416809082
mini_batch_src_global generation:  0.05329537391662598
r_  generation:  0.4762427806854248
local_output_nid generation:  0.03146839141845703
local_in_edges_tensor generation:  0.031857967376708984
mini_batch_src_global generation:  0.0512852668762207
r_  generation:  0.49172496795654297
local_output_nid generation:  0.032413482666015625
local_in_edges_tensor generation:  0.03587055206298828
mini_batch_src_global generation:  0.05261850357055664
r_  generation:  0.4765596389770508
local_output_nid generation:  0.03229212760925293
local_in_edges_tensor generation:  0.08319830894470215
mini_batch_src_global generation:  0.0578770637512207
r_  generation:  0.4880375862121582
local_output_nid generation:  0.03168845176696777
local_in_edges_tensor generation:  0.032128095626831055
mini_batch_src_global generation:  0.05558037757873535
r_  generation:  0.47999143600463867
local_output_nid generation:  0.03155779838562012
local_in_edges_tensor generation:  0.03237199783325195
mini_batch_src_global generation:  0.0531766414642334
r_  generation:  0.4876089096069336
local_output_nid generation:  0.03215527534484863
local_in_edges_tensor generation:  0.03814220428466797
mini_batch_src_global generation:  0.05352163314819336
r_  generation:  0.484555721282959
local_output_nid generation:  0.03217124938964844
local_in_edges_tensor generation:  0.03412818908691406
mini_batch_src_global generation:  0.05504655838012695
r_  generation:  0.49971723556518555
local_output_nid generation:  0.03179669380187988
local_in_edges_tensor generation:  0.03442573547363281
mini_batch_src_global generation:  0.05376172065734863
r_  generation:  0.5038535594940186
local_output_nid generation:  0.03495216369628906
local_in_edges_tensor generation:  0.0293121337890625
mini_batch_src_global generation:  0.05579638481140137
r_  generation:  0.4922351837158203
local_output_nid generation:  0.03255152702331543
local_in_edges_tensor generation:  0.031617164611816406
mini_batch_src_global generation:  0.05436587333679199
r_  generation:  0.48345279693603516
local_output_nid generation:  0.03316354751586914
local_in_edges_tensor generation:  0.030208349227905273
mini_batch_src_global generation:  0.05258584022521973
r_  generation:  0.4939885139465332
local_output_nid generation:  0.03289151191711426
local_in_edges_tensor generation:  0.03212428092956543
mini_batch_src_global generation:  0.05614805221557617
r_  generation:  0.48438310623168945
local_output_nid generation:  0.033115386962890625
local_in_edges_tensor generation:  0.029408693313598633
mini_batch_src_global generation:  0.053438663482666016
r_  generation:  0.49010419845581055
local_output_nid generation:  0.03316140174865723
local_in_edges_tensor generation:  0.030135631561279297
mini_batch_src_global generation:  0.05486702919006348
r_  generation:  0.48833656311035156
----------------------check_connections_block total spend ----------------------------- 11.486369132995605
generate_one_block  0.6107428073883057
generate_one_block  0.6080100536346436
generate_one_block  0.5951247215270996
generate_one_block  0.599174976348877
generate_one_block  0.5977423191070557
generate_one_block  0.6021733283996582
generate_one_block  0.594825267791748
generate_one_block  0.5970461368560791
generate_one_block  0.6649620532989502
generate_one_block  0.5946648120880127
generate_one_block  0.6001808643341064
generate_one_block  0.5904679298400879
generate_one_block  0.5968847274780273
generate_one_block  0.5971519947052002
generate_one_block  0.5988049507141113
generate_one_block  0.6012232303619385
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12326240539550781  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

connection checking time:  17.862062692642212
block generation total time  15.343255996704102
average batch blocks generation time:  0.9589534997940063
block dataloader generation time/epoch 35.50699996948242
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09774494171142578  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7759485244750977  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0973353385925293  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7656731605529785  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09751033782958984  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7656097412109375  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09755659103393555  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7718920707702637  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09755659103393555  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7719449996948242  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09758996963500977  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7748861312866211  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09731721878051758  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7655777931213379  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09721183776855469  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7641358375549316  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09757137298583984  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7718801498413086  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09696245193481445  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7563118934631348  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09758520126342773  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7710251808166504  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09729719161987305  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7619209289550781  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09740447998046875  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7686944007873535  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09738683700561523  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7650961875915527  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09734582901000977  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.764373779296875  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09761762619018555  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7754497528076172  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06711307168006897 |0.016675516963005066 |0.0035267025232315063 |9.104609489440918e-05 |0.0036862343549728394 |0.0014121532440185547 |
----------------------------------------------------------pseudo_mini_loss sum 1.2949458360671997
Total (block generation + training)time/epoch 36.985418411401604
Training time/epoch 1.5232353210449219
Training time without block to device /epoch 1.2564270496368408
Training time without total dataloading part /epoch 0.11827588081359863
load block tensor time/epoch 1.0738091468811035
block to device time/epoch 0.26680827140808105
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 22 |
Number of nodes for computation during this epoch:  5318288
Number of first layer input nodes during this epoch:  2508542
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12369728088378906  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02444148063659668
range selection method range initialization spend 0.015880107879638672
time for parepare:  0.01988053321838379
local_output_nid generation:  0.00144195556640625
local_in_edges_tensor generation:  0.0042154788970947266
mini_batch_src_global generation:  0.004223346710205078
r_  generation:  0.02684950828552246
local_output_nid generation:  0.0019631385803222656
local_in_edges_tensor generation:  0.0016508102416992188
mini_batch_src_global generation:  0.002689361572265625
r_  generation:  0.023296594619750977
local_output_nid generation:  0.001979827880859375
local_in_edges_tensor generation:  0.0011129379272460938
mini_batch_src_global generation:  0.00173187255859375
r_  generation:  0.020474672317504883
local_output_nid generation:  0.0020918846130371094
local_in_edges_tensor generation:  0.0010538101196289062
mini_batch_src_global generation:  0.004947185516357422
r_  generation:  0.025772809982299805
local_output_nid generation:  0.0017349720001220703
local_in_edges_tensor generation:  0.000995635986328125
mini_batch_src_global generation:  0.002276897430419922
r_  generation:  0.03813982009887695
local_output_nid generation:  0.0033485889434814453
local_in_edges_tensor generation:  0.001871347427368164
mini_batch_src_global generation:  0.02061748504638672
r_  generation:  0.025014162063598633
local_output_nid generation:  0.0016131401062011719
local_in_edges_tensor generation:  0.0009436607360839844
mini_batch_src_global generation:  0.0017406940460205078
r_  generation:  0.022757291793823242
local_output_nid generation:  0.001581430435180664
local_in_edges_tensor generation:  0.0009796619415283203
mini_batch_src_global generation:  0.0018339157104492188
r_  generation:  0.02263021469116211
local_output_nid generation:  0.0016019344329833984
local_in_edges_tensor generation:  0.0009343624114990234
mini_batch_src_global generation:  0.0018062591552734375
r_  generation:  0.02212691307067871
local_output_nid generation:  0.0015728473663330078
local_in_edges_tensor generation:  0.00093841552734375
mini_batch_src_global generation:  0.0018205642700195312
r_  generation:  0.022854089736938477
local_output_nid generation:  0.0015795230865478516
local_in_edges_tensor generation:  0.0009148120880126953
mini_batch_src_global generation:  0.0017633438110351562
r_  generation:  0.02395153045654297
local_output_nid generation:  0.001577138900756836
local_in_edges_tensor generation:  0.0009288787841796875
mini_batch_src_global generation:  0.002214670181274414
r_  generation:  0.036673784255981445
local_output_nid generation:  0.0028069019317626953
local_in_edges_tensor generation:  0.0015921592712402344
mini_batch_src_global generation:  0.003793954849243164
r_  generation:  0.02440500259399414
local_output_nid generation:  0.001566171646118164
local_in_edges_tensor generation:  0.0009331703186035156
mini_batch_src_global generation:  0.001707315444946289
r_  generation:  0.021925687789916992
local_output_nid generation:  0.0015559196472167969
local_in_edges_tensor generation:  0.0009286403656005859
mini_batch_src_global generation:  0.0017778873443603516
r_  generation:  0.027390241622924805
local_output_nid generation:  0.001950979232788086
local_in_edges_tensor generation:  0.0011105537414550781
mini_batch_src_global generation:  0.0018122196197509766
r_  generation:  0.021512269973754883
----------------------check_connections_block total spend ----------------------------- 0.6375529766082764
generate_one_block  0.045992136001586914
generate_one_block  0.03508186340332031
generate_one_block  0.0312957763671875
generate_one_block  0.033426761627197266
generate_one_block  0.03378009796142578
generate_one_block  0.03538179397583008
generate_one_block  0.04781031608581543
generate_one_block  0.03185391426086426
generate_one_block  0.03151583671569824
generate_one_block  0.032424211502075195
generate_one_block  0.03594493865966797
generate_one_block  0.03615117073059082
generate_one_block  0.032938241958618164
generate_one_block  0.030890464782714844
generate_one_block  0.03162717819213867
generate_one_block  0.032232046127319336
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.036466121673583984
gen group dst list time:  0.018954992294311523
time for parepare:  0.01960444450378418
local_output_nid generation:  0.0075643062591552734
local_in_edges_tensor generation:  0.030359506607055664
mini_batch_src_global generation:  0.02894735336303711
r_  generation:  0.27612972259521484
local_output_nid generation:  0.016734600067138672
local_in_edges_tensor generation:  0.025498390197753906
mini_batch_src_global generation:  0.03304004669189453
r_  generation:  0.2862823009490967
local_output_nid generation:  0.015565872192382812
local_in_edges_tensor generation:  0.022373437881469727
mini_batch_src_global generation:  0.036824941635131836
r_  generation:  0.2936222553253174
local_output_nid generation:  0.013193130493164062
local_in_edges_tensor generation:  0.018393993377685547
mini_batch_src_global generation:  0.03543376922607422
r_  generation:  0.2987098693847656
local_output_nid generation:  0.012707948684692383
local_in_edges_tensor generation:  0.020808935165405273
mini_batch_src_global generation:  0.040058135986328125
r_  generation:  0.3109867572784424
local_output_nid generation:  0.0161588191986084
local_in_edges_tensor generation:  0.01856851577758789
mini_batch_src_global generation:  0.03898358345031738
r_  generation:  0.2906992435455322
local_output_nid generation:  0.013226985931396484
local_in_edges_tensor generation:  0.017102956771850586
mini_batch_src_global generation:  0.03778433799743652
r_  generation:  0.295302152633667
local_output_nid generation:  0.01365208625793457
local_in_edges_tensor generation:  0.013757705688476562
mini_batch_src_global generation:  0.03839421272277832
r_  generation:  0.3191947937011719
local_output_nid generation:  0.013456583023071289
local_in_edges_tensor generation:  0.015923738479614258
mini_batch_src_global generation:  0.03883981704711914
r_  generation:  0.29712724685668945
local_output_nid generation:  0.014667987823486328
local_in_edges_tensor generation:  0.015029668807983398
mini_batch_src_global generation:  0.03965568542480469
r_  generation:  0.3053281307220459
local_output_nid generation:  0.013435125350952148
local_in_edges_tensor generation:  0.021245479583740234
mini_batch_src_global generation:  0.04095149040222168
r_  generation:  0.2980530261993408
local_output_nid generation:  0.013673543930053711
local_in_edges_tensor generation:  0.013832569122314453
mini_batch_src_global generation:  0.04010748863220215
r_  generation:  0.30948472023010254
local_output_nid generation:  0.013741016387939453
local_in_edges_tensor generation:  0.01511240005493164
mini_batch_src_global generation:  0.04254770278930664
r_  generation:  0.2918233871459961
local_output_nid generation:  0.013381719589233398
local_in_edges_tensor generation:  0.022211313247680664
mini_batch_src_global generation:  0.03779125213623047
r_  generation:  0.2944364547729492
local_output_nid generation:  0.015603303909301758
local_in_edges_tensor generation:  0.017813682556152344
mini_batch_src_global generation:  0.0390620231628418
r_  generation:  0.31928205490112305
local_output_nid generation:  0.013608932495117188
local_in_edges_tensor generation:  0.01846933364868164
mini_batch_src_global generation:  0.03901052474975586
r_  generation:  0.2937607765197754
----------------------check_connections_block total spend ----------------------------- 6.972862482070923
generate_one_block  0.36815500259399414
generate_one_block  0.35614609718322754
generate_one_block  0.35608911514282227
generate_one_block  0.36040711402893066
generate_one_block  0.3541834354400635
generate_one_block  0.3652665615081787
generate_one_block  0.3801586627960205
generate_one_block  0.36071109771728516
generate_one_block  0.3525862693786621
generate_one_block  0.36295032501220703
generate_one_block  0.3473844528198242
generate_one_block  0.3599715232849121
generate_one_block  0.35095882415771484
generate_one_block  0.34146738052368164
generate_one_block  0.36046886444091797
generate_one_block  0.36031603813171387
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.033631086349487305
gen group dst list time:  0.0670309066772461
time for parepare:  0.020209789276123047
local_output_nid generation:  0.026378393173217773
local_in_edges_tensor generation:  0.04931950569152832
mini_batch_src_global generation:  0.06894993782043457
r_  generation:  0.4814908504486084
local_output_nid generation:  0.032067298889160156
local_in_edges_tensor generation:  0.045815467834472656
mini_batch_src_global generation:  0.06673407554626465
r_  generation:  0.477308988571167
local_output_nid generation:  0.03335142135620117
local_in_edges_tensor generation:  0.03196001052856445
mini_batch_src_global generation:  0.05165839195251465
r_  generation:  0.4797227382659912
local_output_nid generation:  0.03250861167907715
local_in_edges_tensor generation:  0.029353618621826172
mini_batch_src_global generation:  0.05247092247009277
r_  generation:  0.47183752059936523
local_output_nid generation:  0.03265786170959473
local_in_edges_tensor generation:  0.08341550827026367
mini_batch_src_global generation:  0.051453590393066406
r_  generation:  0.4865550994873047
local_output_nid generation:  0.03185391426086426
local_in_edges_tensor generation:  0.0341033935546875
mini_batch_src_global generation:  0.05567169189453125
r_  generation:  0.4852747917175293
local_output_nid generation:  0.03248953819274902
local_in_edges_tensor generation:  0.034259796142578125
mini_batch_src_global generation:  0.05490827560424805
r_  generation:  0.48764657974243164
local_output_nid generation:  0.032721519470214844
local_in_edges_tensor generation:  0.03185558319091797
mini_batch_src_global generation:  0.05406928062438965
r_  generation:  0.48377227783203125
local_output_nid generation:  0.03233981132507324
local_in_edges_tensor generation:  0.03163623809814453
mini_batch_src_global generation:  0.05272173881530762
r_  generation:  0.49360108375549316
local_output_nid generation:  0.03259015083312988
local_in_edges_tensor generation:  0.040220022201538086
mini_batch_src_global generation:  0.05422234535217285
r_  generation:  0.4840562343597412
local_output_nid generation:  0.032506704330444336
local_in_edges_tensor generation:  0.036157846450805664
mini_batch_src_global generation:  0.053017616271972656
r_  generation:  0.5028214454650879
local_output_nid generation:  0.03348898887634277
local_in_edges_tensor generation:  0.04035544395446777
mini_batch_src_global generation:  0.0677940845489502
r_  generation:  0.48442721366882324
local_output_nid generation:  0.03423929214477539
local_in_edges_tensor generation:  0.0329442024230957
mini_batch_src_global generation:  0.053133487701416016
r_  generation:  0.4974832534790039
local_output_nid generation:  0.03778672218322754
local_in_edges_tensor generation:  0.031333208084106445
mini_batch_src_global generation:  0.054625749588012695
r_  generation:  0.47945356369018555
local_output_nid generation:  0.03331184387207031
local_in_edges_tensor generation:  0.03334617614746094
mini_batch_src_global generation:  0.055001258850097656
r_  generation:  0.48996615409851074
local_output_nid generation:  0.03337454795837402
local_in_edges_tensor generation:  0.03592991828918457
mini_batch_src_global generation:  0.0540313720703125
r_  generation:  0.48332953453063965
----------------------check_connections_block total spend ----------------------------- 11.547321319580078
generate_one_block  0.6052138805389404
generate_one_block  0.6035263538360596
generate_one_block  0.5994446277618408
generate_one_block  0.603419303894043
generate_one_block  0.5993833541870117
generate_one_block  0.6008412837982178
generate_one_block  0.6029140949249268
generate_one_block  0.6223609447479248
generate_one_block  0.6320781707763672
generate_one_block  0.6019439697265625
generate_one_block  0.5940811634063721
generate_one_block  0.608342170715332
generate_one_block  0.5941855907440186
generate_one_block  0.6017026901245117
generate_one_block  0.6024556159973145
generate_one_block  0.6086404323577881
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12369728088378906  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

connection checking time:  18.520183801651
block generation total time  15.417754411697388
average batch blocks generation time:  0.9636096507310867
block dataloader generation time/epoch 35.57089412212372
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09746646881103516  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7710065841674805  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09766674041748047  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7701764106750488  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09758615493774414  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7745256423950195  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09757232666015625  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.77496337890625  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09735536575317383  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7651157379150391  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09727191925048828  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7634353637695312  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09739303588867188  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.764887809753418  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09763145446777344  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7712416648864746  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0973367691040039  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7635884284973145  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09749794006347656  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7674574851989746  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09713363647460938  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7637219429016113  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09766912460327148  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7746572494506836  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09723758697509766  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7631683349609375  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09717464447021484  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7622323036193848  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09755945205688477  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7718605995178223  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0976405143737793  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7717714309692383  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06827870011329651 |0.014943420886993408 |0.0035168826580047607 |9.204447269439697e-05 |0.0037721097469329834 |0.003082752227783203 |
----------------------------------------------------------pseudo_mini_loss sum 1.2829424142837524
Total (block generation + training)time/epoch 37.051873207092285
Training time/epoch 1.5140023231506348
Training time without block to device /epoch 1.2749075889587402
Training time without total dataloading part /epoch 0.12117934226989746
load block tensor time/epoch 1.0924592018127441
block to device time/epoch 0.23909473419189453
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 23 |
Number of nodes for computation during this epoch:  5318233
Number of first layer input nodes during this epoch:  2509424
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12353706359863281  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0277557373046875
range selection method range initialization spend 0.0161285400390625
time for parepare:  0.01719212532043457
local_output_nid generation:  0.0014319419860839844
local_in_edges_tensor generation:  0.008858680725097656
mini_batch_src_global generation:  0.0021829605102539062
r_  generation:  0.023082256317138672
local_output_nid generation:  0.001558542251586914
local_in_edges_tensor generation:  0.0010955333709716797
mini_batch_src_global generation:  0.0024628639221191406
r_  generation:  0.02470874786376953
local_output_nid generation:  0.0015759468078613281
local_in_edges_tensor generation:  0.0010669231414794922
mini_batch_src_global generation:  0.002118349075317383
r_  generation:  0.02366495132446289
local_output_nid generation:  0.001650094985961914
local_in_edges_tensor generation:  0.0009739398956298828
mini_batch_src_global generation:  0.0023224353790283203
r_  generation:  0.02427983283996582
local_output_nid generation:  0.0016040802001953125
local_in_edges_tensor generation:  0.0009400844573974609
mini_batch_src_global generation:  0.0021822452545166016
r_  generation:  0.022038936614990234
local_output_nid generation:  0.0016264915466308594
local_in_edges_tensor generation:  0.0010876655578613281
mini_batch_src_global generation:  0.0017805099487304688
r_  generation:  0.022660017013549805
local_output_nid generation:  0.0016145706176757812
local_in_edges_tensor generation:  0.0010552406311035156
mini_batch_src_global generation:  0.0017642974853515625
r_  generation:  0.02236199378967285
local_output_nid generation:  0.00160980224609375
local_in_edges_tensor generation:  0.0010309219360351562
mini_batch_src_global generation:  0.0017697811126708984
r_  generation:  0.022745609283447266
local_output_nid generation:  0.0016107559204101562
local_in_edges_tensor generation:  0.0010516643524169922
mini_batch_src_global generation:  0.0017681121826171875
r_  generation:  0.02184152603149414
local_output_nid generation:  0.0016200542449951172
local_in_edges_tensor generation:  0.0010724067687988281
mini_batch_src_global generation:  0.0017926692962646484
r_  generation:  0.022706985473632812
local_output_nid generation:  0.0016207695007324219
local_in_edges_tensor generation:  0.0010290145874023438
mini_batch_src_global generation:  0.0017457008361816406
r_  generation:  0.024039030075073242
local_output_nid generation:  0.0017669200897216797
local_in_edges_tensor generation:  0.0011281967163085938
mini_batch_src_global generation:  0.0017709732055664062
r_  generation:  0.023340225219726562
local_output_nid generation:  0.0016360282897949219
local_in_edges_tensor generation:  0.0011124610900878906
mini_batch_src_global generation:  0.0019066333770751953
r_  generation:  0.02311110496520996
local_output_nid generation:  0.0016415119171142578
local_in_edges_tensor generation:  0.0010437965393066406
mini_batch_src_global generation:  0.0017690658569335938
r_  generation:  0.022375106811523438
local_output_nid generation:  0.0016374588012695312
local_in_edges_tensor generation:  0.0010068416595458984
mini_batch_src_global generation:  0.0017724037170410156
r_  generation:  0.022554636001586914
local_output_nid generation:  0.0016238689422607422
local_in_edges_tensor generation:  0.0010614395141601562
mini_batch_src_global generation:  0.0017647743225097656
r_  generation:  0.022007226943969727
----------------------check_connections_block total spend ----------------------------- 0.5520443916320801
generate_one_block  0.03047323226928711
generate_one_block  0.03366565704345703
generate_one_block  0.030870676040649414
generate_one_block  0.031996965408325195
generate_one_block  0.03215670585632324
generate_one_block  0.0337071418762207
generate_one_block  0.031043291091918945
generate_one_block  0.03222799301147461
generate_one_block  0.03091120719909668
generate_one_block  0.031610727310180664
generate_one_block  0.030808448791503906
generate_one_block  0.03232693672180176
generate_one_block  0.03288435935974121
generate_one_block  0.03168034553527832
generate_one_block  0.03174114227294922
generate_one_block  0.03137826919555664
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04006838798522949
gen group dst list time:  0.017653465270996094
time for parepare:  0.021353483200073242
local_output_nid generation:  0.0075190067291259766
local_in_edges_tensor generation:  0.02465343475341797
mini_batch_src_global generation:  0.03022933006286621
r_  generation:  0.2657337188720703
local_output_nid generation:  0.013276100158691406
local_in_edges_tensor generation:  0.0181276798248291
mini_batch_src_global generation:  0.03359389305114746
r_  generation:  0.2778599262237549
local_output_nid generation:  0.011943578720092773
local_in_edges_tensor generation:  0.013386726379394531
mini_batch_src_global generation:  0.032248735427856445
r_  generation:  0.2721543312072754
local_output_nid generation:  0.012890100479125977
local_in_edges_tensor generation:  0.017046213150024414
mini_batch_src_global generation:  0.03377079963684082
r_  generation:  0.284501314163208
local_output_nid generation:  0.012990951538085938
local_in_edges_tensor generation:  0.016898155212402344
mini_batch_src_global generation:  0.03345608711242676
r_  generation:  0.28000974655151367
local_output_nid generation:  0.01342153549194336
local_in_edges_tensor generation:  0.013914823532104492
mini_batch_src_global generation:  0.03308677673339844
r_  generation:  0.28630566596984863
local_output_nid generation:  0.013327836990356445
local_in_edges_tensor generation:  0.01774454116821289
mini_batch_src_global generation:  0.03459453582763672
r_  generation:  0.2802746295928955
local_output_nid generation:  0.014575958251953125
local_in_edges_tensor generation:  0.019167661666870117
mini_batch_src_global generation:  0.04998135566711426
r_  generation:  0.30812859535217285
local_output_nid generation:  0.016159534454345703
local_in_edges_tensor generation:  0.01643085479736328
mini_batch_src_global generation:  0.03688359260559082
r_  generation:  0.2851119041442871
local_output_nid generation:  0.013948202133178711
local_in_edges_tensor generation:  0.020580053329467773
mini_batch_src_global generation:  0.04604530334472656
r_  generation:  0.28472232818603516
local_output_nid generation:  0.015033483505249023
local_in_edges_tensor generation:  0.015277385711669922
mini_batch_src_global generation:  0.034363508224487305
r_  generation:  0.2735428810119629
local_output_nid generation:  0.013826847076416016
local_in_edges_tensor generation:  0.014734268188476562
mini_batch_src_global generation:  0.037981271743774414
r_  generation:  0.29654908180236816
local_output_nid generation:  0.014013290405273438
local_in_edges_tensor generation:  0.018776893615722656
mini_batch_src_global generation:  0.03702068328857422
r_  generation:  0.2906346321105957
local_output_nid generation:  0.01355600357055664
local_in_edges_tensor generation:  0.014920711517333984
mini_batch_src_global generation:  0.034624576568603516
r_  generation:  0.28163766860961914
local_output_nid generation:  0.014040231704711914
local_in_edges_tensor generation:  0.015521764755249023
mini_batch_src_global generation:  0.03525233268737793
r_  generation:  0.2859034538269043
local_output_nid generation:  0.014416933059692383
local_in_edges_tensor generation:  0.018609285354614258
mini_batch_src_global generation:  0.03470015525817871
r_  generation:  0.2802612781524658
----------------------check_connections_block total spend ----------------------------- 6.5758583545684814
generate_one_block  0.35846662521362305
generate_one_block  0.3591001033782959
generate_one_block  0.34600090980529785
generate_one_block  0.3622095584869385
generate_one_block  0.35547447204589844
generate_one_block  0.3507218360900879
generate_one_block  0.37471747398376465
generate_one_block  0.3535590171813965
generate_one_block  0.34413957595825195
generate_one_block  0.35669589042663574
generate_one_block  0.3557569980621338
generate_one_block  0.35814332962036133
generate_one_block  0.36739230155944824
generate_one_block  0.344285249710083
generate_one_block  0.35361552238464355
generate_one_block  0.34557223320007324
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.10376191139221191
gen group dst list time:  0.07127833366394043
time for parepare:  0.018110036849975586
local_output_nid generation:  0.02557063102722168
local_in_edges_tensor generation:  0.051749229431152344
mini_batch_src_global generation:  0.04462552070617676
r_  generation:  0.47777819633483887
local_output_nid generation:  0.03106093406677246
local_in_edges_tensor generation:  0.03713798522949219
mini_batch_src_global generation:  0.055738210678100586
r_  generation:  0.46738481521606445
local_output_nid generation:  0.030648231506347656
local_in_edges_tensor generation:  0.03296494483947754
mini_batch_src_global generation:  0.0513150691986084
r_  generation:  0.4804232120513916
local_output_nid generation:  0.03111553192138672
local_in_edges_tensor generation:  0.037496328353881836
mini_batch_src_global generation:  0.05175638198852539
r_  generation:  0.47627735137939453
local_output_nid generation:  0.030965328216552734
local_in_edges_tensor generation:  0.07620596885681152
mini_batch_src_global generation:  0.051845550537109375
r_  generation:  0.4876241683959961
local_output_nid generation:  0.03127264976501465
local_in_edges_tensor generation:  0.036212921142578125
mini_batch_src_global generation:  0.055620670318603516
r_  generation:  0.49845457077026367
local_output_nid generation:  0.0343327522277832
local_in_edges_tensor generation:  0.030970335006713867
mini_batch_src_global generation:  0.05592989921569824
r_  generation:  0.49337148666381836
local_output_nid generation:  0.03247952461242676
local_in_edges_tensor generation:  0.03145742416381836
mini_batch_src_global generation:  0.05586576461791992
r_  generation:  0.48285484313964844
local_output_nid generation:  0.03237724304199219
local_in_edges_tensor generation:  0.0300900936126709
mini_batch_src_global generation:  0.052935123443603516
r_  generation:  0.48494911193847656
local_output_nid generation:  0.032436370849609375
local_in_edges_tensor generation:  0.03145170211791992
mini_batch_src_global generation:  0.05471920967102051
r_  generation:  0.4960930347442627
local_output_nid generation:  0.03286886215209961
local_in_edges_tensor generation:  0.031964778900146484
mini_batch_src_global generation:  0.05323457717895508
r_  generation:  0.4912557601928711
local_output_nid generation:  0.03278040885925293
local_in_edges_tensor generation:  0.03300929069519043
mini_batch_src_global generation:  0.054543495178222656
r_  generation:  0.4854874610900879
local_output_nid generation:  0.03290891647338867
local_in_edges_tensor generation:  0.03148627281188965
mini_batch_src_global generation:  0.05343985557556152
r_  generation:  0.4885880947113037
local_output_nid generation:  0.03296041488647461
local_in_edges_tensor generation:  0.029921531677246094
mini_batch_src_global generation:  0.05441451072692871
r_  generation:  0.4826385974884033
local_output_nid generation:  0.03528857231140137
local_in_edges_tensor generation:  0.03336167335510254
mini_batch_src_global generation:  0.05524396896362305
r_  generation:  0.4875321388244629
local_output_nid generation:  0.0327143669128418
local_in_edges_tensor generation:  0.035338640213012695
mini_batch_src_global generation:  0.05623960494995117
r_  generation:  0.48193359375
----------------------check_connections_block total spend ----------------------------- 11.441739797592163
generate_one_block  0.6040737628936768
generate_one_block  0.5871222019195557
generate_one_block  0.592482328414917
generate_one_block  0.596172571182251
generate_one_block  0.5912826061248779
generate_one_block  0.5979070663452148
generate_one_block  0.5938694477081299
generate_one_block  0.6004045009613037
generate_one_block  0.6552574634552002
generate_one_block  0.5951573848724365
generate_one_block  0.6106898784637451
generate_one_block  0.5945000648498535
generate_one_block  0.5994253158569336
generate_one_block  0.5934140682220459
generate_one_block  0.595470666885376
generate_one_block  0.5991725921630859
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12353706359863281  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

connection checking time:  18.017598152160645
block generation total time  15.292253017425537
average batch blocks generation time:  0.9557658135890961
block dataloader generation time/epoch 35.57761319478353
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09725570678710938  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.760930061340332  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09743165969848633  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7635078430175781  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09734773635864258  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.764378547668457  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09761810302734375  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7754592895507812  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09744787216186523  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7665920257568359  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09752368927001953  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7716622352600098  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09726953506469727  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7644214630126953  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09762144088745117  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7687573432922363  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0971364974975586  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7610640525817871  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09753656387329102  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7708597183227539  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09740972518920898  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7634572982788086  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09766387939453125  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7752208709716797  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09779977798461914  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7763833999633789  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09732675552368164  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7649240493774414  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09779071807861328  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7751951217651367  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09733772277832031  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7683391571044922  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06688585877418518 |0.014822408556938171 |0.003632187843322754 |9.460747241973877e-05 |0.003522709012031555 |0.002951383590698242 |
----------------------------------------------------------pseudo_mini_loss sum 1.2767775058746338
Total (block generation + training)time/epoch 37.05925235748291
Training time/epoch 1.4906110763549805
Training time without block to device /epoch 1.2534525394439697
Training time without total dataloading part /epoch 0.11894345283508301
load block tensor time/epoch 1.070173740386963
block to device time/epoch 0.23715853691101074
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 24 |
Number of nodes for computation during this epoch:  5318295
Number of first layer input nodes during this epoch:  2509924
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.1229705810546875  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02588629722595215
range selection method range initialization spend 0.012204647064208984
time for parepare:  0.019119739532470703
local_output_nid generation:  0.0014464855194091797
local_in_edges_tensor generation:  0.008345365524291992
mini_batch_src_global generation:  0.0018050670623779297
r_  generation:  0.021060705184936523
local_output_nid generation:  0.0015425682067871094
local_in_edges_tensor generation:  0.0009713172912597656
mini_batch_src_global generation:  0.002146005630493164
r_  generation:  0.023034334182739258
local_output_nid generation:  0.0015482902526855469
local_in_edges_tensor generation:  0.0009620189666748047
mini_batch_src_global generation:  0.0017573833465576172
r_  generation:  0.022200822830200195
local_output_nid generation:  0.0016124248504638672
local_in_edges_tensor generation:  0.0009775161743164062
mini_batch_src_global generation:  0.0017848014831542969
r_  generation:  0.02185368537902832
local_output_nid generation:  0.0015866756439208984
local_in_edges_tensor generation:  0.0009441375732421875
mini_batch_src_global generation:  0.0018110275268554688
r_  generation:  0.021711349487304688
local_output_nid generation:  0.0015637874603271484
local_in_edges_tensor generation:  0.000980377197265625
mini_batch_src_global generation:  0.0018181800842285156
r_  generation:  0.02220606803894043
local_output_nid generation:  0.0015821456909179688
local_in_edges_tensor generation:  0.0009315013885498047
mini_batch_src_global generation:  0.0031626224517822266
r_  generation:  0.021954059600830078
local_output_nid generation:  0.0015773773193359375
local_in_edges_tensor generation:  0.0009682178497314453
mini_batch_src_global generation:  0.0018832683563232422
r_  generation:  0.022453784942626953
local_output_nid generation:  0.0015735626220703125
local_in_edges_tensor generation:  0.0009260177612304688
mini_batch_src_global generation:  0.0018649101257324219
r_  generation:  0.02258133888244629
local_output_nid generation:  0.0015883445739746094
local_in_edges_tensor generation:  0.0009596347808837891
mini_batch_src_global generation:  0.0018849372863769531
r_  generation:  0.022705078125
local_output_nid generation:  0.0015976428985595703
local_in_edges_tensor generation:  0.0009710788726806641
mini_batch_src_global generation:  0.0018270015716552734
r_  generation:  0.022750139236450195
local_output_nid generation:  0.0015816688537597656
local_in_edges_tensor generation:  0.0009860992431640625
mini_batch_src_global generation:  0.0018551349639892578
r_  generation:  0.022769927978515625
local_output_nid generation:  0.0015766620635986328
local_in_edges_tensor generation:  0.0010251998901367188
mini_batch_src_global generation:  0.0017971992492675781
r_  generation:  0.022602558135986328
local_output_nid generation:  0.0015988349914550781
local_in_edges_tensor generation:  0.001222372055053711
mini_batch_src_global generation:  0.0017631053924560547
r_  generation:  0.022157907485961914
local_output_nid generation:  0.001622915267944336
local_in_edges_tensor generation:  0.001190185546875
mini_batch_src_global generation:  0.0018820762634277344
r_  generation:  0.02285313606262207
local_output_nid generation:  0.001565694808959961
local_in_edges_tensor generation:  0.0009908676147460938
mini_batch_src_global generation:  0.0017788410186767578
r_  generation:  0.022693157196044922
----------------------check_connections_block total spend ----------------------------- 0.5386617183685303
generate_one_block  0.03156590461730957
generate_one_block  0.03230547904968262
generate_one_block  0.03473210334777832
generate_one_block  0.03322100639343262
generate_one_block  0.03301119804382324
generate_one_block  0.03521108627319336
generate_one_block  0.0332179069519043
generate_one_block  0.03368854522705078
generate_one_block  0.03390693664550781
generate_one_block  0.034195899963378906
generate_one_block  0.03432488441467285
generate_one_block  0.033345937728881836
generate_one_block  0.03289055824279785
generate_one_block  0.03152751922607422
generate_one_block  0.03237795829772949
generate_one_block  0.03184652328491211
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.040129661560058594
gen group dst list time:  0.020097732543945312
time for parepare:  0.021708965301513672
local_output_nid generation:  0.00803828239440918
local_in_edges_tensor generation:  0.031761884689331055
mini_batch_src_global generation:  0.026973485946655273
r_  generation:  0.2708773612976074
local_output_nid generation:  0.011840105056762695
local_in_edges_tensor generation:  0.017887353897094727
mini_batch_src_global generation:  0.03593945503234863
r_  generation:  0.29151368141174316
local_output_nid generation:  0.014171123504638672
local_in_edges_tensor generation:  0.01849365234375
mini_batch_src_global generation:  0.03248023986816406
r_  generation:  0.27660703659057617
local_output_nid generation:  0.013066768646240234
local_in_edges_tensor generation:  0.013230085372924805
mini_batch_src_global generation:  0.03354907035827637
r_  generation:  0.275393009185791
local_output_nid generation:  0.012731552124023438
local_in_edges_tensor generation:  0.031246662139892578
mini_batch_src_global generation:  0.034415483474731445
r_  generation:  0.2716081142425537
local_output_nid generation:  0.013350725173950195
local_in_edges_tensor generation:  0.019977331161499023
mini_batch_src_global generation:  0.03332996368408203
r_  generation:  0.27271008491516113
local_output_nid generation:  0.014263629913330078
local_in_edges_tensor generation:  0.019657611846923828
mini_batch_src_global generation:  0.03586387634277344
r_  generation:  0.27355408668518066
local_output_nid generation:  0.013801813125610352
local_in_edges_tensor generation:  0.018369197845458984
mini_batch_src_global generation:  0.036569833755493164
r_  generation:  0.2775249481201172
local_output_nid generation:  0.013983726501464844
local_in_edges_tensor generation:  0.016852378845214844
mini_batch_src_global generation:  0.039145708084106445
r_  generation:  0.2840447425842285
local_output_nid generation:  0.014065027236938477
local_in_edges_tensor generation:  0.013912677764892578
mini_batch_src_global generation:  0.03621792793273926
r_  generation:  0.2865159511566162
local_output_nid generation:  0.013605356216430664
local_in_edges_tensor generation:  0.017700672149658203
mini_batch_src_global generation:  0.03461956977844238
r_  generation:  0.28320741653442383
local_output_nid generation:  0.013762950897216797
local_in_edges_tensor generation:  0.016099214553833008
mini_batch_src_global generation:  0.03454017639160156
r_  generation:  0.29167795181274414
local_output_nid generation:  0.015622854232788086
local_in_edges_tensor generation:  0.016047000885009766
mini_batch_src_global generation:  0.03438162803649902
r_  generation:  0.2723362445831299
local_output_nid generation:  0.013640642166137695
local_in_edges_tensor generation:  0.014928340911865234
mini_batch_src_global generation:  0.03406858444213867
r_  generation:  0.27495431900024414
local_output_nid generation:  0.014007091522216797
local_in_edges_tensor generation:  0.015009880065917969
mini_batch_src_global generation:  0.036574602127075195
r_  generation:  0.28388071060180664
local_output_nid generation:  0.013775110244750977
local_in_edges_tensor generation:  0.013811111450195312
mini_batch_src_global generation:  0.03442740440368652
r_  generation:  0.279585599899292
----------------------check_connections_block total spend ----------------------------- 6.488518714904785
generate_one_block  0.36255455017089844
generate_one_block  0.362396240234375
generate_one_block  0.36327123641967773
generate_one_block  0.35677289962768555
generate_one_block  0.35822057723999023
generate_one_block  0.34459877014160156
generate_one_block  0.37459588050842285
generate_one_block  0.354658842086792
generate_one_block  0.35836195945739746
generate_one_block  0.35576605796813965
generate_one_block  0.35715222358703613
generate_one_block  0.35326075553894043
generate_one_block  0.34515810012817383
generate_one_block  0.34646081924438477
generate_one_block  0.37082433700561523
generate_one_block  0.3505733013153076
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03300118446350098
gen group dst list time:  0.06689047813415527
time for parepare:  0.019644975662231445
local_output_nid generation:  0.02683424949645996
local_in_edges_tensor generation:  0.045652151107788086
mini_batch_src_global generation:  0.0440371036529541
r_  generation:  0.48126769065856934
local_output_nid generation:  0.031386613845825195
local_in_edges_tensor generation:  0.03834819793701172
mini_batch_src_global generation:  0.0556027889251709
r_  generation:  0.47325825691223145
local_output_nid generation:  0.03367424011230469
local_in_edges_tensor generation:  0.036263227462768555
mini_batch_src_global generation:  0.05388450622558594
r_  generation:  0.5051922798156738
local_output_nid generation:  0.03492379188537598
local_in_edges_tensor generation:  0.029080867767333984
mini_batch_src_global generation:  0.05698513984680176
r_  generation:  0.4794001579284668
local_output_nid generation:  0.03337883949279785
local_in_edges_tensor generation:  0.08281993865966797
mini_batch_src_global generation:  0.05175900459289551
r_  generation:  0.4824972152709961
local_output_nid generation:  0.03241252899169922
local_in_edges_tensor generation:  0.03309321403503418
mini_batch_src_global generation:  0.05387091636657715
r_  generation:  0.48487138748168945
local_output_nid generation:  0.03255581855773926
local_in_edges_tensor generation:  0.0294189453125
mini_batch_src_global generation:  0.056121110916137695
r_  generation:  0.4993925094604492
local_output_nid generation:  0.032341718673706055
local_in_edges_tensor generation:  0.03145146369934082
mini_batch_src_global generation:  0.05557727813720703
r_  generation:  0.48569321632385254
local_output_nid generation:  0.03258991241455078
local_in_edges_tensor generation:  0.029763460159301758
mini_batch_src_global generation:  0.05297446250915527
r_  generation:  0.49225926399230957
local_output_nid generation:  0.03384685516357422
local_in_edges_tensor generation:  0.03320193290710449
mini_batch_src_global generation:  0.05522346496582031
r_  generation:  0.4871368408203125
local_output_nid generation:  0.03278160095214844
local_in_edges_tensor generation:  0.031763315200805664
mini_batch_src_global generation:  0.053916215896606445
r_  generation:  0.4890172481536865
local_output_nid generation:  0.03310370445251465
local_in_edges_tensor generation:  0.030127286911010742
mini_batch_src_global generation:  0.054097652435302734
r_  generation:  0.48755311965942383
local_output_nid generation:  0.032823801040649414
local_in_edges_tensor generation:  0.029621124267578125
mini_batch_src_global generation:  0.055081844329833984
r_  generation:  0.4884035587310791
local_output_nid generation:  0.032892704010009766
local_in_edges_tensor generation:  0.03218674659729004
mini_batch_src_global generation:  0.054052114486694336
r_  generation:  0.48634862899780273
local_output_nid generation:  0.03267836570739746
local_in_edges_tensor generation:  0.033925533294677734
mini_batch_src_global generation:  0.05477285385131836
r_  generation:  0.490048885345459
local_output_nid generation:  0.032837629318237305
local_in_edges_tensor generation:  0.03383660316467285
mini_batch_src_global generation:  0.05471539497375488
r_  generation:  0.4870476722717285
----------------------check_connections_block total spend ----------------------------- 11.495266675949097
generate_one_block  0.6017625331878662
generate_one_block  0.5936076641082764
generate_one_block  0.5968599319458008
generate_one_block  0.5990381240844727
generate_one_block  0.5950033664703369
generate_one_block  0.6015017032623291
generate_one_block  0.6058249473571777
generate_one_block  0.6000559329986572
generate_one_block  0.6568317413330078
generate_one_block  0.6010150909423828
generate_one_block  0.604058027267456
generate_one_block  0.5965375900268555
generate_one_block  0.5971498489379883
generate_one_block  0.5974862575531006
generate_one_block  0.5983760356903076
generate_one_block  0.596343994140625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.1229705810546875  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

connection checking time:  17.983785390853882
block generation total time  15.356079339981079
average batch blocks generation time:  0.9597549587488174
block dataloader generation time/epoch 35.580806016922
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09748506546020508  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7662982940673828  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09769344329833984  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7751460075378418  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09765052795410156  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7748727798461914  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0973653793334961  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7634110450744629  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09725666046142578  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7621021270751953  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09729719161987305  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7657980918884277  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09747171401977539  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7687420845031738  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0974431037902832  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.765162467956543  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09769058227539062  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7748732566833496  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09749174118041992  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7720413208007812  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09750890731811523  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.77215576171875  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09751510620117188  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7659797668457031  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09717607498168945  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7596287727355957  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09722614288330078  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7631173133850098  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09761333465576172  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7710361480712891  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09738016128540039  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7652311325073242  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06238222122192383 |0.015659436583518982 |0.003747999668121338 |9.773671627044678e-05 |0.003530949354171753 |0.0013778209686279297 |
----------------------------------------------------------pseudo_mini_loss sum 1.2611333131790161
Total (block generation + training)time/epoch 37.05938211083412
Training time/epoch 1.432363510131836
Training time without block to device /epoch 1.1818125247955322
Training time without total dataloading part /epoch 0.11940479278564453
load block tensor time/epoch 0.9981155395507812
block to device time/epoch 0.2505509853363037
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 25 |
Number of nodes for computation during this epoch:  5316720
Number of first layer input nodes during this epoch:  2509955
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12308597564697266  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024164199829101562
range selection method range initialization spend 0.016065359115600586
time for parepare:  0.01745319366455078
local_output_nid generation:  0.003007173538208008
local_in_edges_tensor generation:  0.007462501525878906
mini_batch_src_global generation:  0.002184152603149414
r_  generation:  0.023096799850463867
local_output_nid generation:  0.0015666484832763672
local_in_edges_tensor generation:  0.0010628700256347656
mini_batch_src_global generation:  0.002070188522338867
r_  generation:  0.02232646942138672
local_output_nid generation:  0.0015988349914550781
local_in_edges_tensor generation:  0.0009725093841552734
mini_batch_src_global generation:  0.0017178058624267578
r_  generation:  0.022050142288208008
local_output_nid generation:  0.0016286373138427734
local_in_edges_tensor generation:  0.0009481906890869141
mini_batch_src_global generation:  0.003918886184692383
r_  generation:  0.02235698699951172
local_output_nid generation:  0.0016436576843261719
local_in_edges_tensor generation:  0.0009744167327880859
mini_batch_src_global generation:  0.0017724037170410156
r_  generation:  0.022006511688232422
local_output_nid generation:  0.0015909671783447266
local_in_edges_tensor generation:  0.0009722709655761719
mini_batch_src_global generation:  0.0017418861389160156
r_  generation:  0.022095680236816406
local_output_nid generation:  0.0015897750854492188
local_in_edges_tensor generation:  0.0009620189666748047
mini_batch_src_global generation:  0.0017676353454589844
r_  generation:  0.02285480499267578
local_output_nid generation:  0.0015826225280761719
local_in_edges_tensor generation:  0.001047372817993164
mini_batch_src_global generation:  0.0017817020416259766
r_  generation:  0.02224564552307129
local_output_nid generation:  0.0016064643859863281
local_in_edges_tensor generation:  0.0010221004486083984
mini_batch_src_global generation:  0.0017740726470947266
r_  generation:  0.021762371063232422
local_output_nid generation:  0.0015900135040283203
local_in_edges_tensor generation:  0.0010073184967041016
mini_batch_src_global generation:  0.0017981529235839844
r_  generation:  0.0229036808013916
local_output_nid generation:  0.0016028881072998047
local_in_edges_tensor generation:  0.0010080337524414062
mini_batch_src_global generation:  0.0017888545989990234
r_  generation:  0.022766828536987305
local_output_nid generation:  0.0015914440155029297
local_in_edges_tensor generation:  0.001020193099975586
mini_batch_src_global generation:  0.0017864704132080078
r_  generation:  0.022682666778564453
local_output_nid generation:  0.0015861988067626953
local_in_edges_tensor generation:  0.0010137557983398438
mini_batch_src_global generation:  0.0017397403717041016
r_  generation:  0.022448062896728516
local_output_nid generation:  0.001573801040649414
local_in_edges_tensor generation:  0.0010404586791992188
mini_batch_src_global generation:  0.0017404556274414062
r_  generation:  0.02232980728149414
local_output_nid generation:  0.001674652099609375
local_in_edges_tensor generation:  0.0010225772857666016
mini_batch_src_global generation:  0.001878976821899414
r_  generation:  0.022658348083496094
local_output_nid generation:  0.0015668869018554688
local_in_edges_tensor generation:  0.0010514259338378906
mini_batch_src_global generation:  0.0017790794372558594
r_  generation:  0.02177882194519043
----------------------check_connections_block total spend ----------------------------- 0.5355825424194336
generate_one_block  0.03499341011047363
generate_one_block  0.031406402587890625
generate_one_block  0.031359195709228516
generate_one_block  0.031389713287353516
generate_one_block  0.031047344207763672
generate_one_block  0.03290438652038574
generate_one_block  0.03206586837768555
generate_one_block  0.031047344207763672
generate_one_block  0.0304262638092041
generate_one_block  0.031873464584350586
generate_one_block  0.03138375282287598
generate_one_block  0.03191208839416504
generate_one_block  0.03135967254638672
generate_one_block  0.030714988708496094
generate_one_block  0.03146219253540039
generate_one_block  0.03092646598815918
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.037969350814819336
gen group dst list time:  0.01722431182861328
time for parepare:  0.019803524017333984
local_output_nid generation:  0.007794618606567383
local_in_edges_tensor generation:  0.025011777877807617
mini_batch_src_global generation:  0.02710437774658203
r_  generation:  0.261183500289917
local_output_nid generation:  0.011281251907348633
local_in_edges_tensor generation:  0.017005443572998047
mini_batch_src_global generation:  0.03310370445251465
r_  generation:  0.26549482345581055
local_output_nid generation:  0.011661767959594727
local_in_edges_tensor generation:  0.017571210861206055
mini_batch_src_global generation:  0.03526496887207031
r_  generation:  0.28626012802124023
local_output_nid generation:  0.014527559280395508
local_in_edges_tensor generation:  0.021045684814453125
mini_batch_src_global generation:  0.03349614143371582
r_  generation:  0.2728302478790283
local_output_nid generation:  0.013231277465820312
local_in_edges_tensor generation:  0.015026330947875977
mini_batch_src_global generation:  0.033355712890625
r_  generation:  0.27565860748291016
local_output_nid generation:  0.013056516647338867
local_in_edges_tensor generation:  0.014631986618041992
mini_batch_src_global generation:  0.033492326736450195
r_  generation:  0.2805452346801758
local_output_nid generation:  0.013483047485351562
local_in_edges_tensor generation:  0.013657569885253906
mini_batch_src_global generation:  0.033926963806152344
r_  generation:  0.27865099906921387
local_output_nid generation:  0.013441324234008789
local_in_edges_tensor generation:  0.014708995819091797
mini_batch_src_global generation:  0.03418755531311035
r_  generation:  0.27750611305236816
local_output_nid generation:  0.013342142105102539
local_in_edges_tensor generation:  0.01690983772277832
mini_batch_src_global generation:  0.0338284969329834
r_  generation:  0.27652502059936523
local_output_nid generation:  0.013679027557373047
local_in_edges_tensor generation:  0.013869524002075195
mini_batch_src_global generation:  0.034821271896362305
r_  generation:  0.2914607524871826
local_output_nid generation:  0.01289987564086914
local_in_edges_tensor generation:  0.016022205352783203
mini_batch_src_global generation:  0.034914493560791016
r_  generation:  0.2877368927001953
local_output_nid generation:  0.013950109481811523
local_in_edges_tensor generation:  0.015037059783935547
mini_batch_src_global generation:  0.03623604774475098
r_  generation:  0.2863802909851074
local_output_nid generation:  0.013824224472045898
local_in_edges_tensor generation:  0.014126777648925781
mini_batch_src_global generation:  0.03469514846801758
r_  generation:  0.2834045886993408
local_output_nid generation:  0.013616323471069336
local_in_edges_tensor generation:  0.01360177993774414
mini_batch_src_global generation:  0.03438138961791992
r_  generation:  0.2845311164855957
local_output_nid generation:  0.013916015625
local_in_edges_tensor generation:  0.014688253402709961
mini_batch_src_global generation:  0.034577369689941406
r_  generation:  0.28409385681152344
local_output_nid generation:  0.013177871704101562
local_in_edges_tensor generation:  0.013654232025146484
mini_batch_src_global generation:  0.03422379493713379
r_  generation:  0.27183103561401367
----------------------check_connections_block total spend ----------------------------- 6.414077997207642
generate_one_block  0.3638620376586914
generate_one_block  0.3431556224822998
generate_one_block  0.34977006912231445
generate_one_block  0.35356926918029785
generate_one_block  0.35030031204223633
generate_one_block  0.3517615795135498
generate_one_block  0.3819148540496826
generate_one_block  0.35701560974121094
generate_one_block  0.3485109806060791
generate_one_block  0.36513257026672363
generate_one_block  0.3617703914642334
generate_one_block  0.3638155460357666
generate_one_block  0.34864377975463867
generate_one_block  0.3517322540283203
generate_one_block  0.3581819534301758
generate_one_block  0.3380117416381836
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03713488578796387
gen group dst list time:  0.07117772102355957
time for parepare:  0.019690275192260742
local_output_nid generation:  0.02708745002746582
local_in_edges_tensor generation:  0.0499720573425293
mini_batch_src_global generation:  0.042670249938964844
r_  generation:  0.47371888160705566
local_output_nid generation:  0.03327441215515137
local_in_edges_tensor generation:  0.037108421325683594
mini_batch_src_global generation:  0.05381011962890625
r_  generation:  0.47603607177734375
local_output_nid generation:  0.031775712966918945
local_in_edges_tensor generation:  0.03271031379699707
mini_batch_src_global generation:  0.051552534103393555
r_  generation:  0.49052929878234863
local_output_nid generation:  0.03192305564880371
local_in_edges_tensor generation:  0.03633904457092285
mini_batch_src_global generation:  0.0526430606842041
r_  generation:  0.4813251495361328
local_output_nid generation:  0.03341388702392578
local_in_edges_tensor generation:  0.07536888122558594
mini_batch_src_global generation:  0.0561375617980957
r_  generation:  0.5009088516235352
local_output_nid generation:  0.032837867736816406
local_in_edges_tensor generation:  0.03297829627990723
mini_batch_src_global generation:  0.053830623626708984
r_  generation:  0.47928380966186523
local_output_nid generation:  0.03232264518737793
local_in_edges_tensor generation:  0.03687238693237305
mini_batch_src_global generation:  0.05428314208984375
r_  generation:  0.4970705509185791
local_output_nid generation:  0.032518625259399414
local_in_edges_tensor generation:  0.0336458683013916
mini_batch_src_global generation:  0.05433797836303711
r_  generation:  0.48671936988830566
local_output_nid generation:  0.033093929290771484
local_in_edges_tensor generation:  0.03549385070800781
mini_batch_src_global generation:  0.053556203842163086
r_  generation:  0.4888737201690674
local_output_nid generation:  0.032659292221069336
local_in_edges_tensor generation:  0.04216766357421875
mini_batch_src_global generation:  0.05672144889831543
r_  generation:  0.48490309715270996
local_output_nid generation:  0.032929420471191406
local_in_edges_tensor generation:  0.03888440132141113
mini_batch_src_global generation:  0.05506420135498047
r_  generation:  0.50775146484375
local_output_nid generation:  0.03598976135253906
local_in_edges_tensor generation:  0.03355264663696289
mini_batch_src_global generation:  0.05725884437561035
r_  generation:  0.4803805351257324
local_output_nid generation:  0.03374981880187988
local_in_edges_tensor generation:  0.03324460983276367
mini_batch_src_global generation:  0.05240797996520996
r_  generation:  0.4929358959197998
local_output_nid generation:  0.03326892852783203
local_in_edges_tensor generation:  0.033429622650146484
mini_batch_src_global generation:  0.056462764739990234
r_  generation:  0.4953625202178955
local_output_nid generation:  0.0337672233581543
local_in_edges_tensor generation:  0.03177928924560547
mini_batch_src_global generation:  0.057637929916381836
r_  generation:  0.49155139923095703
local_output_nid generation:  0.033400535583496094
local_in_edges_tensor generation:  0.03363752365112305
mini_batch_src_global generation:  0.05412554740905762
r_  generation:  0.47696995735168457
----------------------check_connections_block total spend ----------------------------- 11.53852391242981
generate_one_block  0.6046512126922607
generate_one_block  0.5994529724121094
generate_one_block  0.5967280864715576
generate_one_block  0.5994327068328857
generate_one_block  0.5993058681488037
generate_one_block  0.5998227596282959
generate_one_block  0.6074249744415283
generate_one_block  0.5969669818878174
generate_one_block  0.6643996238708496
generate_one_block  0.6001224517822266
generate_one_block  0.6019811630249023
generate_one_block  0.6011857986450195
generate_one_block  0.5955374240875244
generate_one_block  0.5911900997161865
generate_one_block  0.5990145206451416
generate_one_block  0.5926730632781982
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12308597564697266  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

connection checking time:  17.95260190963745
block generation total time  15.337038278579712
average batch blocks generation time:  0.958564892411232
block dataloader generation time/epoch 35.57606555433834
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09759140014648438  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7746791839599609  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09726524353027344  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7626090049743652  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0974874496459961  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7712216377258301  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09744834899902344  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7676281929016113  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09745597839355469  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7682156562805176  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09734249114990234  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7645416259765625  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09737443923950195  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7674760818481445  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09729957580566406  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7640271186828613  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0972738265991211  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7646193504333496  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09777450561523438  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.775489330291748  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09761714935302734  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7700567245483398  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09781646728515625  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.775998592376709  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09745311737060547  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7704615592956543  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09741687774658203  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7646899223327637  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09756040573120117  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7749800682067871  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09706878662109375  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7584424018859863  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06354066729545593 |0.014318123459815979 |0.0035131126642227173 |9.25213098526001e-05 |0.003578856587409973 |0.002851247787475586 |
----------------------------------------------------------pseudo_mini_loss sum 1.2442986965179443
Total (block generation + training)time/epoch 37.051572378943945
Training time/epoch 1.4261298179626465
Training time without block to device /epoch 1.1970398426055908
Training time without total dataloading part /epoch 0.11780309677124023
load block tensor time/epoch 1.016650676727295
block to device time/epoch 0.22908997535705566
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 26 |
Number of nodes for computation during this epoch:  5319037
Number of first layer input nodes during this epoch:  2509307
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12247943878173828  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024463176727294922
range selection method range initialization spend 0.012653112411499023
time for parepare:  0.01941084861755371
local_output_nid generation:  0.001417398452758789
local_in_edges_tensor generation:  0.006406068801879883
mini_batch_src_global generation:  0.0021758079528808594
r_  generation:  0.020909547805786133
local_output_nid generation:  0.0015876293182373047
local_in_edges_tensor generation:  0.0009801387786865234
mini_batch_src_global generation:  0.0023043155670166016
r_  generation:  0.02271437644958496
local_output_nid generation:  0.001573324203491211
local_in_edges_tensor generation:  0.0009632110595703125
mini_batch_src_global generation:  0.001739501953125
r_  generation:  0.02206730842590332
local_output_nid generation:  0.001627206802368164
local_in_edges_tensor generation:  0.0009429454803466797
mini_batch_src_global generation:  0.0017745494842529297
r_  generation:  0.022496461868286133
local_output_nid generation:  0.0016107559204101562
local_in_edges_tensor generation:  0.000972747802734375
mini_batch_src_global generation:  0.0017087459564208984
r_  generation:  0.02193927764892578
local_output_nid generation:  0.001577138900756836
local_in_edges_tensor generation:  0.0009415149688720703
mini_batch_src_global generation:  0.0017888545989990234
r_  generation:  0.02335357666015625
local_output_nid generation:  0.0015773773193359375
local_in_edges_tensor generation:  0.0009496212005615234
mini_batch_src_global generation:  0.0017848014831542969
r_  generation:  0.02278590202331543
local_output_nid generation:  0.0015711784362792969
local_in_edges_tensor generation:  0.0009617805480957031
mini_batch_src_global generation:  0.0017576217651367188
r_  generation:  0.022925853729248047
local_output_nid generation:  0.001562356948852539
local_in_edges_tensor generation:  0.0009713172912597656
mini_batch_src_global generation:  0.0017423629760742188
r_  generation:  0.0222165584564209
local_output_nid generation:  0.0015854835510253906
local_in_edges_tensor generation:  0.0009911060333251953
mini_batch_src_global generation:  0.0017690658569335938
r_  generation:  0.02287459373474121
local_output_nid generation:  0.001577615737915039
local_in_edges_tensor generation:  0.0009322166442871094
mini_batch_src_global generation:  0.0017957687377929688
r_  generation:  0.022481203079223633
local_output_nid generation:  0.0015821456909179688
local_in_edges_tensor generation:  0.0009446144104003906
mini_batch_src_global generation:  0.0017957687377929688
r_  generation:  0.022885560989379883
local_output_nid generation:  0.001577615737915039
local_in_edges_tensor generation:  0.0009262561798095703
mini_batch_src_global generation:  0.0018038749694824219
r_  generation:  0.022854089736938477
local_output_nid generation:  0.001577615737915039
local_in_edges_tensor generation:  0.0009582042694091797
mini_batch_src_global generation:  0.0017991065979003906
r_  generation:  0.02341437339782715
local_output_nid generation:  0.0015838146209716797
local_in_edges_tensor generation:  0.00096893310546875
mini_batch_src_global generation:  0.0017590522766113281
r_  generation:  0.02216482162475586
local_output_nid generation:  0.0015881061553955078
local_in_edges_tensor generation:  0.00095367431640625
mini_batch_src_global generation:  0.0017442703247070312
r_  generation:  0.022571325302124023
----------------------check_connections_block total spend ----------------------------- 0.5340690612792969
generate_one_block  0.030176877975463867
generate_one_block  0.03163743019104004
generate_one_block  0.03130388259887695
generate_one_block  0.03144216537475586
generate_one_block  0.030648469924926758
generate_one_block  0.033426761627197266
generate_one_block  0.03173327445983887
generate_one_block  0.0317072868347168
generate_one_block  0.03071427345275879
generate_one_block  0.030972003936767578
generate_one_block  0.0307309627532959
generate_one_block  0.03164362907409668
generate_one_block  0.032338619232177734
generate_one_block  0.031877994537353516
generate_one_block  0.030562639236450195
generate_one_block  0.03100109100341797
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03602099418640137
gen group dst list time:  0.0183713436126709
time for parepare:  0.01961541175842285
local_output_nid generation:  0.007210969924926758
local_in_edges_tensor generation:  0.023600101470947266
mini_batch_src_global generation:  0.026331186294555664
r_  generation:  0.24964594841003418
local_output_nid generation:  0.01117086410522461
local_in_edges_tensor generation:  0.01733994483947754
mini_batch_src_global generation:  0.03287243843078613
r_  generation:  0.26421189308166504
local_output_nid generation:  0.011653661727905273
local_in_edges_tensor generation:  0.016391754150390625
mini_batch_src_global generation:  0.03139376640319824
r_  generation:  0.2730741500854492
local_output_nid generation:  0.012483596801757812
local_in_edges_tensor generation:  0.017908096313476562
mini_batch_src_global generation:  0.03493928909301758
r_  generation:  0.27887916564941406
local_output_nid generation:  0.012549400329589844
local_in_edges_tensor generation:  0.013429880142211914
mini_batch_src_global generation:  0.03536033630371094
r_  generation:  0.27765750885009766
local_output_nid generation:  0.012445688247680664
local_in_edges_tensor generation:  0.013770103454589844
mini_batch_src_global generation:  0.03534436225891113
r_  generation:  0.28600382804870605
local_output_nid generation:  0.01302647590637207
local_in_edges_tensor generation:  0.0135955810546875
mini_batch_src_global generation:  0.034442901611328125
r_  generation:  0.28264570236206055
local_output_nid generation:  0.012938976287841797
local_in_edges_tensor generation:  0.013882160186767578
mini_batch_src_global generation:  0.03468012809753418
r_  generation:  0.28560590744018555
local_output_nid generation:  0.012992620468139648
local_in_edges_tensor generation:  0.013886451721191406
mini_batch_src_global generation:  0.03424572944641113
r_  generation:  0.28194761276245117
local_output_nid generation:  0.013079166412353516
local_in_edges_tensor generation:  0.015846967697143555
mini_batch_src_global generation:  0.03467273712158203
r_  generation:  0.2862386703491211
local_output_nid generation:  0.013386726379394531
local_in_edges_tensor generation:  0.020128488540649414
mini_batch_src_global generation:  0.03409099578857422
r_  generation:  0.28026652336120605
local_output_nid generation:  0.013282537460327148
local_in_edges_tensor generation:  0.01635456085205078
mini_batch_src_global generation:  0.035929203033447266
r_  generation:  0.2873213291168213
local_output_nid generation:  0.013597488403320312
local_in_edges_tensor generation:  0.017591238021850586
mini_batch_src_global generation:  0.03686070442199707
r_  generation:  0.2924039363861084
local_output_nid generation:  0.013487815856933594
local_in_edges_tensor generation:  0.013718128204345703
mini_batch_src_global generation:  0.03573918342590332
r_  generation:  0.2881758213043213
local_output_nid generation:  0.013139009475708008
local_in_edges_tensor generation:  0.02029871940612793
mini_batch_src_global generation:  0.034716129302978516
r_  generation:  0.28751587867736816
local_output_nid generation:  0.014556407928466797
local_in_edges_tensor generation:  0.013590574264526367
mini_batch_src_global generation:  0.0344390869140625
r_  generation:  0.2801668643951416
----------------------check_connections_block total spend ----------------------------- 6.4623191356658936
generate_one_block  0.3552548885345459
generate_one_block  0.3492910861968994
generate_one_block  0.35536861419677734
generate_one_block  0.3598768711090088
generate_one_block  0.3485729694366455
generate_one_block  0.3590550422668457
generate_one_block  0.3886535167694092
generate_one_block  0.3636510372161865
generate_one_block  0.35250043869018555
generate_one_block  0.35250401496887207
generate_one_block  0.34636449813842773
generate_one_block  0.35096287727355957
generate_one_block  0.3632369041442871
generate_one_block  0.3528473377227783
generate_one_block  0.3431854248046875
generate_one_block  0.34707045555114746
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.036142826080322266
gen group dst list time:  0.0663595199584961
time for parepare:  0.018648147583007812
local_output_nid generation:  0.026279211044311523
local_in_edges_tensor generation:  0.04825139045715332
mini_batch_src_global generation:  0.043541908264160156
r_  generation:  0.47620224952697754
local_output_nid generation:  0.031126976013183594
local_in_edges_tensor generation:  0.042504310607910156
mini_batch_src_global generation:  0.054480791091918945
r_  generation:  0.47470998764038086
local_output_nid generation:  0.03438091278076172
local_in_edges_tensor generation:  0.03383016586303711
mini_batch_src_global generation:  0.051723480224609375
r_  generation:  0.4813191890716553
local_output_nid generation:  0.03243279457092285
local_in_edges_tensor generation:  0.03290605545043945
mini_batch_src_global generation:  0.05356335639953613
r_  generation:  0.47722768783569336
local_output_nid generation:  0.032228946685791016
local_in_edges_tensor generation:  0.07478141784667969
mini_batch_src_global generation:  0.05253434181213379
r_  generation:  0.4839205741882324
local_output_nid generation:  0.03251028060913086
local_in_edges_tensor generation:  0.03184843063354492
mini_batch_src_global generation:  0.0548403263092041
r_  generation:  0.47875499725341797
local_output_nid generation:  0.03461575508117676
local_in_edges_tensor generation:  0.04040694236755371
mini_batch_src_global generation:  0.055721282958984375
r_  generation:  0.4932861328125
local_output_nid generation:  0.033173561096191406
local_in_edges_tensor generation:  0.030514955520629883
mini_batch_src_global generation:  0.06714057922363281
r_  generation:  0.4826998710632324
local_output_nid generation:  0.03429388999938965
local_in_edges_tensor generation:  0.03178977966308594
mini_batch_src_global generation:  0.0534517765045166
r_  generation:  0.4919452667236328
local_output_nid generation:  0.033344268798828125
local_in_edges_tensor generation:  0.034856319427490234
mini_batch_src_global generation:  0.05462193489074707
r_  generation:  0.47904062271118164
local_output_nid generation:  0.03336906433105469
local_in_edges_tensor generation:  0.029586315155029297
mini_batch_src_global generation:  0.0527653694152832
r_  generation:  0.48516154289245605
local_output_nid generation:  0.0334925651550293
local_in_edges_tensor generation:  0.031485557556152344
mini_batch_src_global generation:  0.0774073600769043
r_  generation:  0.48694777488708496
local_output_nid generation:  0.033594608306884766
local_in_edges_tensor generation:  0.03435397148132324
mini_batch_src_global generation:  0.05238938331604004
r_  generation:  0.48767518997192383
local_output_nid generation:  0.03370237350463867
local_in_edges_tensor generation:  0.03176426887512207
mini_batch_src_global generation:  0.05454874038696289
r_  generation:  0.48069190979003906
local_output_nid generation:  0.03370952606201172
local_in_edges_tensor generation:  0.03318953514099121
mini_batch_src_global generation:  0.0530087947845459
r_  generation:  0.48819923400878906
local_output_nid generation:  0.03389143943786621
local_in_edges_tensor generation:  0.032907724380493164
mini_batch_src_global generation:  0.05655527114868164
r_  generation:  0.4821197986602783
----------------------check_connections_block total spend ----------------------------- 11.464140176773071
generate_one_block  0.6017844676971436
generate_one_block  0.5965259075164795
generate_one_block  0.5975258350372314
generate_one_block  0.6065061092376709
generate_one_block  0.6013975143432617
generate_one_block  0.6068618297576904
generate_one_block  0.604137659072876
generate_one_block  0.6045799255371094
generate_one_block  0.6314985752105713
generate_one_block  0.5884974002838135
generate_one_block  0.5971109867095947
generate_one_block  0.5996708869934082
generate_one_block  0.6179335117340088
generate_one_block  0.6135318279266357
generate_one_block  0.5985071659088135
generate_one_block  0.5976660251617432
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12247943878173828  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

connection checking time:  17.926459312438965
block generation total time  15.352131605148315
average batch blocks generation time:  0.9595082253217697
block dataloader generation time/epoch 35.5721658733156
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09721994400024414  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7632279396057129  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09741926193237305  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7693548202514648  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09744071960449219  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7663569450378418  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09762382507324219  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.774756908416748  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09726333618164062  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7636222839355469  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0975961685180664  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7746682167053223  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0974435806274414  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7742085456848145  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09751462936401367  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7677140235900879  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09738874435424805  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7643508911132812  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09721660614013672  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7614288330078125  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0974879264831543  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7647581100463867  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09739923477172852  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7680144309997559  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09775876998901367  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7761077880859375  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09759283065795898  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7745857238769531  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0972747802734375  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7628087997436523  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0973200798034668  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7659788131713867  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06394846737384796 |0.016622796654701233 |0.003508344292640686 |9.328126907348633e-05 |0.0037481337785720825 |0.0012981891632080078 |
----------------------------------------------------------pseudo_mini_loss sum 1.2384543418884277
Total (block generation + training)time/epoch 37.04750182893541
Training time/epoch 1.472219705581665
Training time without block to device /epoch 1.2062549591064453
Training time without total dataloading part /epoch 0.11889433860778809
load block tensor time/epoch 1.0231754779815674
block to device time/epoch 0.2659647464752197
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 27 |
Number of nodes for computation during this epoch:  5317356
Number of first layer input nodes during this epoch:  2508650
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12291765213012695  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023731470108032227
range selection method range initialization spend 0.0121307373046875
time for parepare:  0.018625259399414062
local_output_nid generation:  0.0014204978942871094
local_in_edges_tensor generation:  0.007468461990356445
mini_batch_src_global generation:  0.002225160598754883
r_  generation:  0.02128434181213379
local_output_nid generation:  0.0015594959259033203
local_in_edges_tensor generation:  0.0010182857513427734
mini_batch_src_global generation:  0.002392292022705078
r_  generation:  0.02281022071838379
local_output_nid generation:  0.0016131401062011719
local_in_edges_tensor generation:  0.0009722709655761719
mini_batch_src_global generation:  0.0016374588012695312
r_  generation:  0.021098852157592773
local_output_nid generation:  0.0016095638275146484
local_in_edges_tensor generation:  0.0010433197021484375
mini_batch_src_global generation:  0.0016696453094482422
r_  generation:  0.02094292640686035
local_output_nid generation:  0.0015387535095214844
local_in_edges_tensor generation:  0.0009531974792480469
mini_batch_src_global generation:  0.0017442703247070312
r_  generation:  0.022367238998413086
local_output_nid generation:  0.001577615737915039
local_in_edges_tensor generation:  0.0009565353393554688
mini_batch_src_global generation:  0.003095865249633789
r_  generation:  0.021747112274169922
local_output_nid generation:  0.0015730857849121094
local_in_edges_tensor generation:  0.0009706020355224609
mini_batch_src_global generation:  0.0017952919006347656
r_  generation:  0.022652864456176758
local_output_nid generation:  0.0015597343444824219
local_in_edges_tensor generation:  0.000993967056274414
mini_batch_src_global generation:  0.0017571449279785156
r_  generation:  0.02251887321472168
local_output_nid generation:  0.0016338825225830078
local_in_edges_tensor generation:  0.0009648799896240234
mini_batch_src_global generation:  0.0017232894897460938
r_  generation:  0.022081375122070312
local_output_nid generation:  0.0016629695892333984
local_in_edges_tensor generation:  0.0009627342224121094
mini_batch_src_global generation:  0.001779317855834961
r_  generation:  0.022724390029907227
local_output_nid generation:  0.0015821456909179688
local_in_edges_tensor generation:  0.0009317398071289062
mini_batch_src_global generation:  0.0017795562744140625
r_  generation:  0.022756576538085938
local_output_nid generation:  0.0015764236450195312
local_in_edges_tensor generation:  0.0009694099426269531
mini_batch_src_global generation:  0.0017347335815429688
r_  generation:  0.022504329681396484
local_output_nid generation:  0.0015788078308105469
local_in_edges_tensor generation:  0.0010223388671875
mini_batch_src_global generation:  0.0017597675323486328
r_  generation:  0.022208213806152344
local_output_nid generation:  0.001583099365234375
local_in_edges_tensor generation:  0.0009336471557617188
mini_batch_src_global generation:  0.001958131790161133
r_  generation:  0.023012399673461914
local_output_nid generation:  0.0015671253204345703
local_in_edges_tensor generation:  0.0009655952453613281
mini_batch_src_global generation:  0.0018122196197509766
r_  generation:  0.022623300552368164
local_output_nid generation:  0.001621246337890625
local_in_edges_tensor generation:  0.0012006759643554688
mini_batch_src_global generation:  0.0018515586853027344
r_  generation:  0.021881103515625
----------------------check_connections_block total spend ----------------------------- 0.5297362804412842
generate_one_block  0.03507828712463379
generate_one_block  0.03479647636413574
generate_one_block  0.031152725219726562
generate_one_block  0.0307466983795166
generate_one_block  0.03222846984863281
generate_one_block  0.03309273719787598
generate_one_block  0.03174448013305664
generate_one_block  0.03184938430786133
generate_one_block  0.03355884552001953
generate_one_block  0.03195309638977051
generate_one_block  0.03178572654724121
generate_one_block  0.03148913383483887
generate_one_block  0.031378746032714844
generate_one_block  0.03226065635681152
generate_one_block  0.03146243095397949
generate_one_block  0.03132152557373047
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04004359245300293
gen group dst list time:  0.019060134887695312
time for parepare:  0.020963668823242188
local_output_nid generation:  0.007666349411010742
local_in_edges_tensor generation:  0.025863170623779297
mini_batch_src_global generation:  0.026598215103149414
r_  generation:  0.26120686531066895
local_output_nid generation:  0.011614084243774414
local_in_edges_tensor generation:  0.01752758026123047
mini_batch_src_global generation:  0.03371596336364746
r_  generation:  0.27446413040161133
local_output_nid generation:  0.011576414108276367
local_in_edges_tensor generation:  0.017410993576049805
mini_batch_src_global generation:  0.03204917907714844
r_  generation:  0.27022266387939453
local_output_nid generation:  0.012960195541381836
local_in_edges_tensor generation:  0.019026517868041992
mini_batch_src_global generation:  0.03135275840759277
r_  generation:  0.27144956588745117
local_output_nid generation:  0.013263225555419922
local_in_edges_tensor generation:  0.017595767974853516
mini_batch_src_global generation:  0.03373408317565918
r_  generation:  0.29735422134399414
local_output_nid generation:  0.015065193176269531
local_in_edges_tensor generation:  0.01333475112915039
mini_batch_src_global generation:  0.03424334526062012
r_  generation:  0.27586936950683594
local_output_nid generation:  0.013740777969360352
local_in_edges_tensor generation:  0.014239072799682617
mini_batch_src_global generation:  0.03441643714904785
r_  generation:  0.2854018211364746
local_output_nid generation:  0.013617277145385742
local_in_edges_tensor generation:  0.01627373695373535
mini_batch_src_global generation:  0.0339970588684082
r_  generation:  0.2824058532714844
local_output_nid generation:  0.01346731185913086
local_in_edges_tensor generation:  0.014539957046508789
mini_batch_src_global generation:  0.035651445388793945
r_  generation:  0.2805972099304199
local_output_nid generation:  0.01368570327758789
local_in_edges_tensor generation:  0.013809442520141602
mini_batch_src_global generation:  0.03487849235534668
r_  generation:  0.2849416732788086
local_output_nid generation:  0.013210773468017578
local_in_edges_tensor generation:  0.017294883728027344
mini_batch_src_global generation:  0.034798383712768555
r_  generation:  0.2868492603302002
local_output_nid generation:  0.013482093811035156
local_in_edges_tensor generation:  0.013948202133178711
mini_batch_src_global generation:  0.034708261489868164
r_  generation:  0.28327059745788574
local_output_nid generation:  0.013624429702758789
local_in_edges_tensor generation:  0.013913154602050781
mini_batch_src_global generation:  0.035035133361816406
r_  generation:  0.28236985206604004
local_output_nid generation:  0.013795852661132812
local_in_edges_tensor generation:  0.014714241027832031
mini_batch_src_global generation:  0.03465104103088379
r_  generation:  0.2865309715270996
local_output_nid generation:  0.013745784759521484
local_in_edges_tensor generation:  0.013687849044799805
mini_batch_src_global generation:  0.03475809097290039
r_  generation:  0.291271448135376
local_output_nid generation:  0.013573884963989258
local_in_edges_tensor generation:  0.013717889785766602
mini_batch_src_global generation:  0.03370475769042969
r_  generation:  0.274367094039917
----------------------check_connections_block total spend ----------------------------- 6.440571069717407
generate_one_block  0.3619801998138428
generate_one_block  0.35530996322631836
generate_one_block  0.347214937210083
generate_one_block  0.34504103660583496
generate_one_block  0.3608675003051758
generate_one_block  0.3429219722747803
generate_one_block  0.38878870010375977
generate_one_block  0.3560924530029297
generate_one_block  0.3503000736236572
generate_one_block  0.3590362071990967
generate_one_block  0.36211681365966797
generate_one_block  0.35060811042785645
generate_one_block  0.3536367416381836
generate_one_block  0.3617899417877197
generate_one_block  0.3451681137084961
generate_one_block  0.34154582023620605
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03426718711853027
gen group dst list time:  0.07115554809570312
time for parepare:  0.01963663101196289
local_output_nid generation:  0.026437997817993164
local_in_edges_tensor generation:  0.05253791809082031
mini_batch_src_global generation:  0.04047513008117676
r_  generation:  0.47716593742370605
local_output_nid generation:  0.031066179275512695
local_in_edges_tensor generation:  0.03710317611694336
mini_batch_src_global generation:  0.05535626411437988
r_  generation:  0.47066473960876465
local_output_nid generation:  0.031197309494018555
local_in_edges_tensor generation:  0.029437541961669922
mini_batch_src_global generation:  0.050684213638305664
r_  generation:  0.4865274429321289
local_output_nid generation:  0.03156638145446777
local_in_edges_tensor generation:  0.03213047981262207
mini_batch_src_global generation:  0.05185818672180176
r_  generation:  0.47188782691955566
local_output_nid generation:  0.03168821334838867
local_in_edges_tensor generation:  0.07501626014709473
mini_batch_src_global generation:  0.06288361549377441
r_  generation:  0.48464393615722656
local_output_nid generation:  0.03168201446533203
local_in_edges_tensor generation:  0.03444719314575195
mini_batch_src_global generation:  0.054993629455566406
r_  generation:  0.479827880859375
local_output_nid generation:  0.03214263916015625
local_in_edges_tensor generation:  0.03125643730163574
mini_batch_src_global generation:  0.05270242691040039
r_  generation:  0.4875774383544922
local_output_nid generation:  0.03282475471496582
local_in_edges_tensor generation:  0.03389334678649902
mini_batch_src_global generation:  0.05385565757751465
r_  generation:  0.492173433303833
local_output_nid generation:  0.031881093978881836
local_in_edges_tensor generation:  0.03214764595031738
mini_batch_src_global generation:  0.05351710319519043
r_  generation:  0.49122118949890137
local_output_nid generation:  0.0345916748046875
local_in_edges_tensor generation:  0.033092498779296875
mini_batch_src_global generation:  0.056539058685302734
r_  generation:  0.4877781867980957
local_output_nid generation:  0.03201174736022949
local_in_edges_tensor generation:  0.03393840789794922
mini_batch_src_global generation:  0.05578207969665527
r_  generation:  0.48763179779052734
local_output_nid generation:  0.03181147575378418
local_in_edges_tensor generation:  0.03034663200378418
mini_batch_src_global generation:  0.056734561920166016
r_  generation:  0.4893069267272949
local_output_nid generation:  0.03211259841918945
local_in_edges_tensor generation:  0.029763460159301758
mini_batch_src_global generation:  0.053231239318847656
r_  generation:  0.49187278747558594
local_output_nid generation:  0.032277584075927734
local_in_edges_tensor generation:  0.031972646713256836
mini_batch_src_global generation:  0.05605626106262207
r_  generation:  0.488478422164917
local_output_nid generation:  0.03251910209655762
local_in_edges_tensor generation:  0.03270387649536133
mini_batch_src_global generation:  0.05302262306213379
r_  generation:  0.4936494827270508
local_output_nid generation:  0.03264904022216797
local_in_edges_tensor generation:  0.03510713577270508
mini_batch_src_global generation:  0.05405592918395996
r_  generation:  0.48737120628356934
----------------------check_connections_block total spend ----------------------------- 11.437745094299316
generate_one_block  0.5990433692932129
generate_one_block  0.5988459587097168
generate_one_block  0.599452018737793
generate_one_block  0.5919978618621826
generate_one_block  0.5953896045684814
generate_one_block  0.596107006072998
generate_one_block  0.6056113243103027
generate_one_block  0.6037404537200928
generate_one_block  0.6689174175262451
generate_one_block  0.595947265625
generate_one_block  0.5985891819000244
generate_one_block  0.5949766635894775
generate_one_block  0.5929391384124756
generate_one_block  0.596900224685669
generate_one_block  0.599276065826416
generate_one_block  0.5964710712432861
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12291765213012695  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

connection checking time:  17.878316164016724
block generation total time  15.316623210906982
average batch blocks generation time:  0.9572889506816864
block dataloader generation time/epoch 35.56322663708737
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0975027084350586  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7714858055114746  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09752035140991211  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7681083679199219  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09726238250732422  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7622356414794922  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09723043441772461  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7612686157226562  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09757709503173828  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7707986831665039  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09724998474121094  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7641777992248535  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09755754470825195  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7751278877258301  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0976705551147461  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7715954780578613  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09742355346679688  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7646622657775879  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09760808944702148  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7715640068054199  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09764814376831055  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7720985412597656  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09732866287231445  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7648220062255859  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09754562377929688  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.766411304473877  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0974736213684082  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7716598510742188  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09742164611816406  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7700891494750977  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09724569320678711  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7665505409240723  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0666673332452774 |0.01437292993068695 |0.0038134604692459106 |9.848177433013916e-05 |0.0037006735801696777 |0.0018627643585205078 |
----------------------------------------------------------pseudo_mini_loss sum 1.2274785041809082
Total (block generation + training)time/epoch 37.03918613885578
Training time/epoch 1.4869587421417236
Training time without block to device /epoch 1.2569918632507324
Training time without total dataloading part /epoch 0.12366461753845215
load block tensor time/epoch 1.0666773319244385
block to device time/epoch 0.2299668788909912
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 28 |
Number of nodes for computation during this epoch:  5317955
Number of first layer input nodes during this epoch:  2509543
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12272977828979492  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024440765380859375
range selection method range initialization spend 0.012969493865966797
time for parepare:  0.01721930503845215
local_output_nid generation:  0.0014600753784179688
local_in_edges_tensor generation:  0.004377841949462891
mini_batch_src_global generation:  0.0017731189727783203
r_  generation:  0.02164769172668457
local_output_nid generation:  0.0015783309936523438
local_in_edges_tensor generation:  0.0009696483612060547
mini_batch_src_global generation:  0.0021147727966308594
r_  generation:  0.024199247360229492
local_output_nid generation:  0.0016183853149414062
local_in_edges_tensor generation:  0.0011830329895019531
mini_batch_src_global generation:  0.001832723617553711
r_  generation:  0.02202010154724121
local_output_nid generation:  0.0016410350799560547
local_in_edges_tensor generation:  0.0013113021850585938
mini_batch_src_global generation:  0.0018846988677978516
r_  generation:  0.02214336395263672
local_output_nid generation:  0.00160980224609375
local_in_edges_tensor generation:  0.0009372234344482422
mini_batch_src_global generation:  0.0017354488372802734
r_  generation:  0.021602630615234375
local_output_nid generation:  0.0018095970153808594
local_in_edges_tensor generation:  0.0012981891632080078
mini_batch_src_global generation:  0.00183868408203125
r_  generation:  0.022399425506591797
local_output_nid generation:  0.0016427040100097656
local_in_edges_tensor generation:  0.0009818077087402344
mini_batch_src_global generation:  0.0018129348754882812
r_  generation:  0.02353358268737793
local_output_nid generation:  0.0017349720001220703
local_in_edges_tensor generation:  0.0011615753173828125
mini_batch_src_global generation:  0.0018148422241210938
r_  generation:  0.02247476577758789
local_output_nid generation:  0.0016427040100097656
local_in_edges_tensor generation:  0.0011687278747558594
mini_batch_src_global generation:  0.001888275146484375
r_  generation:  0.023255348205566406
local_output_nid generation:  0.0016379356384277344
local_in_edges_tensor generation:  0.0010631084442138672
mini_batch_src_global generation:  0.0019006729125976562
r_  generation:  0.022782325744628906
local_output_nid generation:  0.0016129016876220703
local_in_edges_tensor generation:  0.000949859619140625
mini_batch_src_global generation:  0.0018913745880126953
r_  generation:  0.02497577667236328
local_output_nid generation:  0.0016512870788574219
local_in_edges_tensor generation:  0.0009365081787109375
mini_batch_src_global generation:  0.0018422603607177734
r_  generation:  0.022569656372070312
local_output_nid generation:  0.0016336441040039062
local_in_edges_tensor generation:  0.001031637191772461
mini_batch_src_global generation:  0.0018153190612792969
r_  generation:  0.022630691528320312
local_output_nid generation:  0.0016384124755859375
local_in_edges_tensor generation:  0.0009317398071289062
mini_batch_src_global generation:  0.0018634796142578125
r_  generation:  0.023012399673461914
local_output_nid generation:  0.0016245841979980469
local_in_edges_tensor generation:  0.003499746322631836
mini_batch_src_global generation:  0.0018515586853027344
r_  generation:  0.02230072021484375
local_output_nid generation:  0.0016772747039794922
local_in_edges_tensor generation:  0.0011334419250488281
mini_batch_src_global generation:  0.001821279525756836
r_  generation:  0.023102521896362305
----------------------check_connections_block total spend ----------------------------- 0.5418076515197754
generate_one_block  0.03168320655822754
generate_one_block  0.033675432205200195
generate_one_block  0.0309145450592041
generate_one_block  0.031763553619384766
generate_one_block  0.03083491325378418
generate_one_block  0.033238887786865234
generate_one_block  0.03224039077758789
generate_one_block  0.03333425521850586
generate_one_block  0.032263994216918945
generate_one_block  0.031348228454589844
generate_one_block  0.03364086151123047
generate_one_block  0.0315401554107666
generate_one_block  0.03165292739868164
generate_one_block  0.03159809112548828
generate_one_block  0.03265237808227539
generate_one_block  0.0331883430480957
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04056286811828613
gen group dst list time:  0.017940759658813477
time for parepare:  0.020430564880371094
local_output_nid generation:  0.00787663459777832
local_in_edges_tensor generation:  0.02263951301574707
mini_batch_src_global generation:  0.02648329734802246
r_  generation:  0.27181529998779297
local_output_nid generation:  0.013203859329223633
local_in_edges_tensor generation:  0.017899513244628906
mini_batch_src_global generation:  0.03408956527709961
r_  generation:  0.2711753845214844
local_output_nid generation:  0.011793375015258789
local_in_edges_tensor generation:  0.020047426223754883
mini_batch_src_global generation:  0.03233981132507324
r_  generation:  0.266751766204834
local_output_nid generation:  0.012880563735961914
local_in_edges_tensor generation:  0.013314008712768555
mini_batch_src_global generation:  0.03483438491821289
r_  generation:  0.2778005599975586
local_output_nid generation:  0.012557268142700195
local_in_edges_tensor generation:  0.015633344650268555
mini_batch_src_global generation:  0.03241848945617676
r_  generation:  0.2682373523712158
local_output_nid generation:  0.013252973556518555
local_in_edges_tensor generation:  0.01736283302307129
mini_batch_src_global generation:  0.033860206604003906
r_  generation:  0.2793693542480469
local_output_nid generation:  0.01438140869140625
local_in_edges_tensor generation:  0.017566680908203125
mini_batch_src_global generation:  0.03633999824523926
r_  generation:  0.28316521644592285
local_output_nid generation:  0.0133514404296875
local_in_edges_tensor generation:  0.018114566802978516
mini_batch_src_global generation:  0.03478813171386719
r_  generation:  0.27562952041625977
local_output_nid generation:  0.01369333267211914
local_in_edges_tensor generation:  0.01516270637512207
mini_batch_src_global generation:  0.035717010498046875
r_  generation:  0.28503918647766113
local_output_nid generation:  0.013625621795654297
local_in_edges_tensor generation:  0.01992058753967285
mini_batch_src_global generation:  0.03484773635864258
r_  generation:  0.2764754295349121
local_output_nid generation:  0.013249874114990234
local_in_edges_tensor generation:  0.014668941497802734
mini_batch_src_global generation:  0.03432273864746094
r_  generation:  0.2785325050354004
local_output_nid generation:  0.013649225234985352
local_in_edges_tensor generation:  0.016145944595336914
mini_batch_src_global generation:  0.03427267074584961
r_  generation:  0.27698516845703125
local_output_nid generation:  0.013847589492797852
local_in_edges_tensor generation:  0.014959096908569336
mini_batch_src_global generation:  0.034770965576171875
r_  generation:  0.27823328971862793
local_output_nid generation:  0.013846397399902344
local_in_edges_tensor generation:  0.016204118728637695
mini_batch_src_global generation:  0.036084651947021484
r_  generation:  0.28285837173461914
local_output_nid generation:  0.013457775115966797
local_in_edges_tensor generation:  0.013913631439208984
mini_batch_src_global generation:  0.034233808517456055
r_  generation:  0.27669477462768555
local_output_nid generation:  0.013984203338623047
local_in_edges_tensor generation:  0.01687455177307129
mini_batch_src_global generation:  0.03512740135192871
r_  generation:  0.2918722629547119
----------------------check_connections_block total spend ----------------------------- 6.432010889053345
generate_one_block  0.3641066551208496
generate_one_block  0.3589205741882324
generate_one_block  0.3436250686645508
generate_one_block  0.3548882007598877
generate_one_block  0.34329891204833984
generate_one_block  0.36564040184020996
generate_one_block  0.3896596431732178
generate_one_block  0.34632277488708496
generate_one_block  0.35915040969848633
generate_one_block  0.354154109954834
generate_one_block  0.35318493843078613
generate_one_block  0.35434818267822266
generate_one_block  0.35742783546447754
generate_one_block  0.36479926109313965
generate_one_block  0.3489096164703369
generate_one_block  0.36460113525390625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.037017822265625
gen group dst list time:  0.06721901893615723
time for parepare:  0.020305871963500977
local_output_nid generation:  0.026660680770874023
local_in_edges_tensor generation:  0.05107522010803223
mini_batch_src_global generation:  0.04555463790893555
r_  generation:  0.47562170028686523
local_output_nid generation:  0.031009435653686523
local_in_edges_tensor generation:  0.0390317440032959
mini_batch_src_global generation:  0.05416250228881836
r_  generation:  0.482285737991333
local_output_nid generation:  0.03109145164489746
local_in_edges_tensor generation:  0.03333568572998047
mini_batch_src_global generation:  0.05363273620605469
r_  generation:  0.4930291175842285
local_output_nid generation:  0.0343477725982666
local_in_edges_tensor generation:  0.0342097282409668
mini_batch_src_global generation:  0.05910921096801758
r_  generation:  0.47655677795410156
local_output_nid generation:  0.03239703178405762
local_in_edges_tensor generation:  0.08248567581176758
mini_batch_src_global generation:  0.05275845527648926
r_  generation:  0.4787285327911377
local_output_nid generation:  0.031870365142822266
local_in_edges_tensor generation:  0.030920028686523438
mini_batch_src_global generation:  0.05330204963684082
r_  generation:  0.4836394786834717
local_output_nid generation:  0.03247833251953125
local_in_edges_tensor generation:  0.03430318832397461
mini_batch_src_global generation:  0.05335354804992676
r_  generation:  0.4877142906188965
local_output_nid generation:  0.031998395919799805
local_in_edges_tensor generation:  0.029399871826171875
mini_batch_src_global generation:  0.05415844917297363
r_  generation:  0.48073315620422363
local_output_nid generation:  0.04346632957458496
local_in_edges_tensor generation:  0.029573440551757812
mini_batch_src_global generation:  0.05271744728088379
r_  generation:  0.4847748279571533
local_output_nid generation:  0.03208804130554199
local_in_edges_tensor generation:  0.03381538391113281
mini_batch_src_global generation:  0.05848193168640137
r_  generation:  0.4828801155090332
local_output_nid generation:  0.032256126403808594
local_in_edges_tensor generation:  0.03004765510559082
mini_batch_src_global generation:  0.05531191825866699
r_  generation:  0.48500895500183105
local_output_nid generation:  0.032102346420288086
local_in_edges_tensor generation:  0.029764175415039062
mini_batch_src_global generation:  0.054828643798828125
r_  generation:  0.48371291160583496
local_output_nid generation:  0.03304886817932129
local_in_edges_tensor generation:  0.037726640701293945
mini_batch_src_global generation:  0.05567145347595215
r_  generation:  0.4916996955871582
local_output_nid generation:  0.032802581787109375
local_in_edges_tensor generation:  0.031674861907958984
mini_batch_src_global generation:  0.054480552673339844
r_  generation:  0.49147939682006836
local_output_nid generation:  0.032576560974121094
local_in_edges_tensor generation:  0.03269243240356445
mini_batch_src_global generation:  0.0534515380859375
r_  generation:  0.4919924736022949
local_output_nid generation:  0.03291010856628418
local_in_edges_tensor generation:  0.030096769332885742
mini_batch_src_global generation:  0.05676841735839844
r_  generation:  0.4889109134674072
----------------------check_connections_block total spend ----------------------------- 11.482820510864258
generate_one_block  0.6043272018432617
generate_one_block  0.5980467796325684
generate_one_block  0.5996391773223877
generate_one_block  0.6034998893737793
generate_one_block  0.5905272960662842
generate_one_block  0.6048669815063477
generate_one_block  0.6061022281646729
generate_one_block  0.5963246822357178
generate_one_block  0.6302647590637207
generate_one_block  0.6076552867889404
generate_one_block  0.6047825813293457
generate_one_block  0.5976588726043701
generate_one_block  0.6013636589050293
generate_one_block  0.606123685836792
generate_one_block  0.595667839050293
generate_one_block  0.6012237071990967
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.12272977828979492  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

connection checking time:  17.914831399917603
block generation total time  15.37111234664917
average batch blocks generation time:  0.9606945216655731
block dataloader generation time/epoch 35.56325011253357
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09742927551269531  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7710719108581543  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09747600555419922  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7702159881591797  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09723329544067383  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7619185447692871  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09759283065795898  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7717380523681641  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09712457656860352  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7599678039550781  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09741878509521484  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7655978202819824  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09766006469726562  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7748174667358398  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09718847274780273  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7623333930969238  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09757661819458008  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7711772918701172  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09740209579467773  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7695937156677246  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09739112854003906  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7704763412475586  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09754133224487305  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.765465259552002  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.097503662109375  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7683606147766113  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09775066375732422  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7752485275268555  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09715890884399414  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7630181312561035  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09767770767211914  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7750554084777832  GigaBytes
Max Memory Allocated: 0.8658108711242676  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0637132078409195 |0.014313235878944397 |0.003481149673461914 |9.334087371826172e-05 |0.003418534994125366 |0.003124237060546875 |
----------------------------------------------------------pseudo_mini_loss sum 1.2116432189941406
Total (block generation + training)time/epoch 37.03672860860824
Training time/epoch 1.4261536598205566
Training time without block to device /epoch 1.1971418857574463
Training time without total dataloading part /epoch 0.11501264572143555
load block tensor time/epoch 1.019411325454712
block to device time/epoch 0.22901177406311035
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 29 |
Number of nodes for computation during this epoch:  5317826
Number of first layer input nodes during this epoch:  2508998
