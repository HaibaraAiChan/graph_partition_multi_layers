Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1647780210.1110914
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027541399002075195
range selection method range initialization spend 0.01369929313659668
time for parepare:  0.0181882381439209
local_output_nid generation:  0.0014150142669677734
local_in_edges_tensor generation:  0.0040051937103271484
mini_batch_src_global generation:  0.001970052719116211
r_  generation:  0.020235776901245117
local_output_nid generation:  0.0014138221740722656
local_in_edges_tensor generation:  0.0009236335754394531
mini_batch_src_global generation:  0.002465963363647461
r_  generation:  0.020726919174194336
local_output_nid generation:  0.0014383792877197266
local_in_edges_tensor generation:  0.0008819103240966797
mini_batch_src_global generation:  0.0014944076538085938
r_  generation:  0.019547700881958008
local_output_nid generation:  0.0015447139739990234
local_in_edges_tensor generation:  0.0009448528289794922
mini_batch_src_global generation:  0.001369476318359375
r_  generation:  0.020105361938476562
local_output_nid generation:  0.00151824951171875
local_in_edges_tensor generation:  0.0008566379547119141
mini_batch_src_global generation:  0.0016069412231445312
r_  generation:  0.020542621612548828
local_output_nid generation:  0.0014700889587402344
local_in_edges_tensor generation:  0.0009329319000244141
mini_batch_src_global generation:  0.0016834735870361328
r_  generation:  0.02187323570251465
local_output_nid generation:  0.0016481876373291016
local_in_edges_tensor generation:  0.0009958744049072266
mini_batch_src_global generation:  0.0016579627990722656
r_  generation:  0.021538734436035156
local_output_nid generation:  0.0016217231750488281
local_in_edges_tensor generation:  0.0009846687316894531
mini_batch_src_global generation:  0.0016598701477050781
r_  generation:  0.02081751823425293
local_output_nid generation:  0.0015959739685058594
local_in_edges_tensor generation:  0.0008881092071533203
mini_batch_src_global generation:  0.0016810894012451172
r_  generation:  0.021313190460205078
local_output_nid generation:  0.0015609264373779297
local_in_edges_tensor generation:  0.0009233951568603516
mini_batch_src_global generation:  0.0016717910766601562
r_  generation:  0.020966291427612305
local_output_nid generation:  0.001573324203491211
local_in_edges_tensor generation:  0.0008571147918701172
mini_batch_src_global generation:  0.0017535686492919922
r_  generation:  0.021153926849365234
local_output_nid generation:  0.0014872550964355469
local_in_edges_tensor generation:  0.0008685588836669922
mini_batch_src_global generation:  0.0017108917236328125
r_  generation:  0.021927595138549805
local_output_nid generation:  0.0014963150024414062
local_in_edges_tensor generation:  0.0008609294891357422
mini_batch_src_global generation:  0.0017900466918945312
r_  generation:  0.021447181701660156
local_output_nid generation:  0.0014896392822265625
local_in_edges_tensor generation:  0.0008730888366699219
mini_batch_src_global generation:  0.0016939640045166016
r_  generation:  0.021619796752929688
local_output_nid generation:  0.0015096664428710938
local_in_edges_tensor generation:  0.0008707046508789062
mini_batch_src_global generation:  0.0017971992492675781
r_  generation:  0.0217134952545166
local_output_nid generation:  0.001493692398071289
local_in_edges_tensor generation:  0.000885009765625
mini_batch_src_global generation:  0.0017936229705810547
r_  generation:  0.02157449722290039
----------------------check_connections_block total spend ----------------------------- 0.5001580715179443
generate_one_block  0.031013965606689453
generate_one_block  0.032030344009399414
generate_one_block  0.03186154365539551
generate_one_block  0.03073596954345703
generate_one_block  0.031040191650390625
generate_one_block  0.03104853630065918
generate_one_block  0.031094789505004883
generate_one_block  0.029680252075195312
generate_one_block  0.030657052993774414
generate_one_block  0.02988147735595703
generate_one_block  0.030400514602661133
generate_one_block  0.030982494354248047
generate_one_block  0.030771255493164062
generate_one_block  0.030640363693237305
generate_one_block  0.031044960021972656
generate_one_block  0.030934572219848633
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04563474655151367
gen group dst list time:  0.020715951919555664
time for parepare:  0.019194364547729492
local_output_nid generation:  0.007210731506347656
local_in_edges_tensor generation:  0.020145893096923828
mini_batch_src_global generation:  0.026749610900878906
r_  generation:  0.2573695182800293
local_output_nid generation:  0.011392354965209961
local_in_edges_tensor generation:  0.023149967193603516
mini_batch_src_global generation:  0.03208422660827637
r_  generation:  0.26085996627807617
local_output_nid generation:  0.011094331741333008
local_in_edges_tensor generation:  0.016493558883666992
mini_batch_src_global generation:  0.0354161262512207
r_  generation:  0.25554370880126953
local_output_nid generation:  0.011622905731201172
local_in_edges_tensor generation:  0.01864457130432129
mini_batch_src_global generation:  0.03204822540283203
r_  generation:  0.2622084617614746
local_output_nid generation:  0.012007951736450195
local_in_edges_tensor generation:  0.016633272171020508
mini_batch_src_global generation:  0.0332489013671875
r_  generation:  0.2662949562072754
local_output_nid generation:  0.011911153793334961
local_in_edges_tensor generation:  0.016335248947143555
mini_batch_src_global generation:  0.03377699851989746
r_  generation:  0.2687091827392578
local_output_nid generation:  0.012176990509033203
local_in_edges_tensor generation:  0.021683454513549805
mini_batch_src_global generation:  0.03463459014892578
r_  generation:  0.27333950996398926
local_output_nid generation:  0.012048482894897461
local_in_edges_tensor generation:  0.016501903533935547
mini_batch_src_global generation:  0.03414463996887207
r_  generation:  0.26467466354370117
local_output_nid generation:  0.012137651443481445
local_in_edges_tensor generation:  0.017131567001342773
mini_batch_src_global generation:  0.0340578556060791
r_  generation:  0.2685363292694092
local_output_nid generation:  0.01208949089050293
local_in_edges_tensor generation:  0.013816118240356445
mini_batch_src_global generation:  0.044226884841918945
r_  generation:  0.26941990852355957
local_output_nid generation:  0.012221574783325195
local_in_edges_tensor generation:  0.019224882125854492
mini_batch_src_global generation:  0.03438687324523926
r_  generation:  0.26867055892944336
local_output_nid generation:  0.012425899505615234
local_in_edges_tensor generation:  0.02130889892578125
mini_batch_src_global generation:  0.03435802459716797
r_  generation:  0.2752408981323242
local_output_nid generation:  0.012332439422607422
local_in_edges_tensor generation:  0.016715526580810547
mini_batch_src_global generation:  0.034334421157836914
r_  generation:  0.27512693405151367
local_output_nid generation:  0.01238560676574707
local_in_edges_tensor generation:  0.014349937438964844
mini_batch_src_global generation:  0.03413867950439453
r_  generation:  0.27022814750671387
local_output_nid generation:  0.012442827224731445
local_in_edges_tensor generation:  0.016886234283447266
mini_batch_src_global generation:  0.0363922119140625
r_  generation:  0.2711367607116699
local_output_nid generation:  0.012416601181030273
local_in_edges_tensor generation:  0.01953268051147461
mini_batch_src_global generation:  0.03468060493469238
r_  generation:  0.2761363983154297
----------------------check_connections_block total spend ----------------------------- 6.249395370483398
generate_one_block  0.3559226989746094
generate_one_block  0.35805368423461914
generate_one_block  0.3397254943847656
generate_one_block  0.3500828742980957
generate_one_block  0.36621928215026855
generate_one_block  0.3493931293487549
generate_one_block  0.36538028717041016
generate_one_block  0.3388979434967041
generate_one_block  0.3474917411804199
generate_one_block  0.34934401512145996
generate_one_block  0.35320234298706055
generate_one_block  0.35955381393432617
generate_one_block  0.35383033752441406
generate_one_block  0.34609293937683105
generate_one_block  0.36260342597961426
generate_one_block  0.3600618839263916
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04270148277282715
gen group dst list time:  0.06399393081665039
time for parepare:  0.019136428833007812
local_output_nid generation:  0.024793148040771484
local_in_edges_tensor generation:  0.037438392639160156
mini_batch_src_global generation:  0.049481868743896484
r_  generation:  0.5279960632324219
local_output_nid generation:  0.03058600425720215
local_in_edges_tensor generation:  0.059937477111816406
mini_batch_src_global generation:  0.06337904930114746
r_  generation:  0.5438039302825928
local_output_nid generation:  0.03184676170349121
local_in_edges_tensor generation:  0.05318593978881836
mini_batch_src_global generation:  0.06866192817687988
r_  generation:  0.534010648727417
local_output_nid generation:  0.031375885009765625
local_in_edges_tensor generation:  0.041458845138549805
mini_batch_src_global generation:  0.06346893310546875
r_  generation:  0.5352797508239746
local_output_nid generation:  0.03350710868835449
local_in_edges_tensor generation:  0.03646969795227051
mini_batch_src_global generation:  0.06441307067871094
r_  generation:  0.54180908203125
local_output_nid generation:  0.03222990036010742
local_in_edges_tensor generation:  0.03246879577636719
mini_batch_src_global generation:  0.060485124588012695
r_  generation:  0.5386538505554199
local_output_nid generation:  0.03250432014465332
local_in_edges_tensor generation:  0.036443471908569336
mini_batch_src_global generation:  0.0622563362121582
r_  generation:  0.5451507568359375
local_output_nid generation:  0.03242158889770508
local_in_edges_tensor generation:  0.036414384841918945
mini_batch_src_global generation:  0.0615229606628418
r_  generation:  0.5486266613006592
local_output_nid generation:  0.03262758255004883
local_in_edges_tensor generation:  0.03575301170349121
mini_batch_src_global generation:  0.061405181884765625
r_  generation:  0.5373451709747314
local_output_nid generation:  0.032416582107543945
local_in_edges_tensor generation:  0.04047131538391113
mini_batch_src_global generation:  0.0645606517791748
r_  generation:  0.5390622615814209
local_output_nid generation:  0.03267645835876465
local_in_edges_tensor generation:  0.04131174087524414
mini_batch_src_global generation:  0.061440229415893555
r_  generation:  0.547720193862915
local_output_nid generation:  0.032537221908569336
local_in_edges_tensor generation:  0.03872823715209961
mini_batch_src_global generation:  0.06653785705566406
r_  generation:  0.5626416206359863
local_output_nid generation:  0.033623456954956055
local_in_edges_tensor generation:  0.045777082443237305
mini_batch_src_global generation:  0.09961271286010742
r_  generation:  0.5406613349914551
local_output_nid generation:  0.032547712326049805
local_in_edges_tensor generation:  0.04880404472351074
mini_batch_src_global generation:  0.0633845329284668
r_  generation:  0.5462217330932617
local_output_nid generation:  0.03483414649963379
local_in_edges_tensor generation:  0.03627586364746094
mini_batch_src_global generation:  0.06987404823303223
r_  generation:  0.5459246635437012
local_output_nid generation:  0.032408714294433594
local_in_edges_tensor generation:  0.044913291931152344
mini_batch_src_global generation:  0.06361913681030273
r_  generation:  0.5438718795776367
----------------------check_connections_block total spend ----------------------------- 12.862517356872559
generate_one_block  0.6847493648529053
generate_one_block  0.686537504196167
generate_one_block  0.6803622245788574
generate_one_block  0.6812410354614258
generate_one_block  0.6966359615325928
generate_one_block  0.6703517436981201
generate_one_block  0.7497973442077637
generate_one_block  0.6668624877929688
generate_one_block  0.6703557968139648
generate_one_block  0.6909162998199463
generate_one_block  0.6922557353973389
generate_one_block  0.684943675994873
generate_one_block  0.6739356517791748
generate_one_block  0.6875665187835693
generate_one_block  0.6850144863128662
generate_one_block  0.6829738616943359
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  19.111912727355957
block generation total time  16.640355587005615
average batch blocks generation time:  1.040022224187851
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09701299667358398  GigaBytes
Max Memory Allocated: 0.09701299667358398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7727017402648926  GigaBytes
Max Memory Allocated: 0.8139519691467285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5369873046875 GB
    Memory Allocated: 0.0982518196105957  GigaBytes
Max Memory Allocated: 0.8594059944152832  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5369873046875 GB
    Memory Allocated: 0.7743353843688965  GigaBytes
Max Memory Allocated: 0.8594059944152832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09899139404296875  GigaBytes
Max Memory Allocated: 0.8632903099060059  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7660393714904785  GigaBytes
Max Memory Allocated: 0.8632903099060059  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09812211990356445  GigaBytes
Max Memory Allocated: 0.8632903099060059  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.7718992233276367  GigaBytes
Max Memory Allocated: 0.8632903099060059  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.0991373062133789  GigaBytes
Max Memory Allocated: 0.8632903099060059  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.7767577171325684  GigaBytes
Max Memory Allocated: 0.8632903099060059  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.09811067581176758  GigaBytes
Max Memory Allocated: 0.8643913269042969  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.771204948425293  GigaBytes
Max Memory Allocated: 0.8643913269042969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.09833288192749023  GigaBytes
Max Memory Allocated: 0.8643913269042969  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.7759957313537598  GigaBytes
Max Memory Allocated: 0.8643913269042969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.09792661666870117  GigaBytes
Max Memory Allocated: 0.8647351264953613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.7652459144592285  GigaBytes
Max Memory Allocated: 0.8647351264953613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.09804725646972656  GigaBytes
Max Memory Allocated: 0.8647351264953613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.7681803703308105  GigaBytes
Max Memory Allocated: 0.8647351264953613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.09815406799316406  GigaBytes
Max Memory Allocated: 0.8647351264953613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.7708234786987305  GigaBytes
Max Memory Allocated: 0.8647351264953613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.0980982780456543  GigaBytes
Max Memory Allocated: 0.8647351264953613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.7701797485351562  GigaBytes
Max Memory Allocated: 0.8647351264953613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.09813594818115234  GigaBytes
Max Memory Allocated: 0.8647351264953613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.7726564407348633  GigaBytes
Max Memory Allocated: 0.8647351264953613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.0981602668762207  GigaBytes
Max Memory Allocated: 0.8647351264953613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.7693686485290527  GigaBytes
Max Memory Allocated: 0.8647351264953613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.0980830192565918  GigaBytes
Max Memory Allocated: 0.8647351264953613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.7694649696350098  GigaBytes
Max Memory Allocated: 0.8647351264953613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.09921550750732422  GigaBytes
Max Memory Allocated: 0.8647351264953613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.7759404182434082  GigaBytes
Max Memory Allocated: 0.8647351264953613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.09815073013305664  GigaBytes
Max Memory Allocated: 0.8647351264953613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.7705435752868652  GigaBytes
Max Memory Allocated: 0.8647351264953613  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0626467615365982 |0.03316722810268402 |0.04899194836616516 |9.532272815704346e-05 |0.008773580193519592 |0.0021104812622070312 |
----------------------------------------------------------pseudo_mini_loss sum 6.279320240020752
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5331165
Number of first layer input nodes during this epoch:  2521924
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.12851333618164062  GigaBytes
Max Memory Allocated: 0.8647351264953613  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0225217342376709
range selection method range initialization spend 0.01157999038696289
time for parepare:  0.017124176025390625
local_output_nid generation:  0.0013668537139892578
local_in_edges_tensor generation:  0.005343914031982422
mini_batch_src_global generation:  0.0019822120666503906
r_  generation:  0.01999974250793457
local_output_nid generation:  0.0015375614166259766
local_in_edges_tensor generation:  0.0009443759918212891
mini_batch_src_global generation:  0.0023627281188964844
r_  generation:  0.021091222763061523
local_output_nid generation:  0.0015234947204589844
local_in_edges_tensor generation:  0.0009350776672363281
mini_batch_src_global generation:  0.0015559196472167969
r_  generation:  0.02126765251159668
local_output_nid generation:  0.0015559196472167969
local_in_edges_tensor generation:  0.0008950233459472656
mini_batch_src_global generation:  0.0015528202056884766
r_  generation:  0.020516395568847656
local_output_nid generation:  0.0015513896942138672
local_in_edges_tensor generation:  0.0008740425109863281
mini_batch_src_global generation:  0.0015342235565185547
r_  generation:  0.020949363708496094
local_output_nid generation:  0.0015680789947509766
local_in_edges_tensor generation:  0.0008711814880371094
mini_batch_src_global generation:  0.0015902519226074219
r_  generation:  0.02123737335205078
local_output_nid generation:  0.0015490055084228516
local_in_edges_tensor generation:  0.0008630752563476562
mini_batch_src_global generation:  0.0016489028930664062
r_  generation:  0.021649599075317383
local_output_nid generation:  0.0015530586242675781
local_in_edges_tensor generation:  0.0008571147918701172
mini_batch_src_global generation:  0.001600503921508789
r_  generation:  0.02076244354248047
local_output_nid generation:  0.0015568733215332031
local_in_edges_tensor generation:  0.0008597373962402344
mini_batch_src_global generation:  0.001631021499633789
r_  generation:  0.02128744125366211
local_output_nid generation:  0.0015332698822021484
local_in_edges_tensor generation:  0.0008718967437744141
mini_batch_src_global generation:  0.001661062240600586
r_  generation:  0.02201557159423828
local_output_nid generation:  0.0015344619750976562
local_in_edges_tensor generation:  0.0008618831634521484
mini_batch_src_global generation:  0.0016858577728271484
r_  generation:  0.021615266799926758
local_output_nid generation:  0.0015292167663574219
local_in_edges_tensor generation:  0.0008618831634521484
mini_batch_src_global generation:  0.0017049312591552734
r_  generation:  0.021994829177856445
local_output_nid generation:  0.0015263557434082031
local_in_edges_tensor generation:  0.0008575916290283203
mini_batch_src_global generation:  0.0017199516296386719
r_  generation:  0.022542238235473633
local_output_nid generation:  0.0015337467193603516
local_in_edges_tensor generation:  0.0008709430694580078
mini_batch_src_global generation:  0.0017158985137939453
r_  generation:  0.022785425186157227
local_output_nid generation:  0.0015985965728759766
local_in_edges_tensor generation:  0.0009012222290039062
mini_batch_src_global generation:  0.0017600059509277344
r_  generation:  0.022032737731933594
local_output_nid generation:  0.0016071796417236328
local_in_edges_tensor generation:  0.0008909702301025391
mini_batch_src_global generation:  0.0017077922821044922
r_  generation:  0.022242069244384766
----------------------check_connections_block total spend ----------------------------- 0.5085000991821289
generate_one_block  0.030147314071655273
generate_one_block  0.031754493713378906
generate_one_block  0.03191637992858887
generate_one_block  0.03065037727355957
generate_one_block  0.031027793884277344
generate_one_block  0.032929420471191406
generate_one_block  0.031398773193359375
generate_one_block  0.03000497817993164
generate_one_block  0.030844449996948242
generate_one_block  0.03192758560180664
generate_one_block  0.030941247940063477
generate_one_block  0.032067298889160156
generate_one_block  0.03205156326293945
generate_one_block  0.031844377517700195
generate_one_block  0.03142857551574707
generate_one_block  0.03180837631225586
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04178643226623535
gen group dst list time:  0.01996135711669922
time for parepare:  0.018970966339111328
local_output_nid generation:  0.007292270660400391
local_in_edges_tensor generation:  0.021535634994506836
mini_batch_src_global generation:  0.02728438377380371
r_  generation:  0.2550928592681885
local_output_nid generation:  0.011303901672363281
local_in_edges_tensor generation:  0.02185368537902832
mini_batch_src_global generation:  0.03203582763671875
r_  generation:  0.2656681537628174
local_output_nid generation:  0.011516332626342773
local_in_edges_tensor generation:  0.017815828323364258
mini_batch_src_global generation:  0.03168368339538574
r_  generation:  0.27138304710388184
local_output_nid generation:  0.012408971786499023
local_in_edges_tensor generation:  0.015566110610961914
mini_batch_src_global generation:  0.03907179832458496
r_  generation:  0.2716844081878662
local_output_nid generation:  0.012209415435791016
local_in_edges_tensor generation:  0.01710653305053711
mini_batch_src_global generation:  0.03316831588745117
r_  generation:  0.27345848083496094
local_output_nid generation:  0.012042760848999023
local_in_edges_tensor generation:  0.016082048416137695
mini_batch_src_global generation:  0.0356900691986084
r_  generation:  0.27631258964538574
local_output_nid generation:  0.012119770050048828
local_in_edges_tensor generation:  0.013541936874389648
mini_batch_src_global generation:  0.03383207321166992
r_  generation:  0.2770092487335205
local_output_nid generation:  0.011935710906982422
local_in_edges_tensor generation:  0.015291929244995117
mini_batch_src_global generation:  0.03596043586730957
r_  generation:  0.2684032917022705
local_output_nid generation:  0.012221336364746094
local_in_edges_tensor generation:  0.01849818229675293
mini_batch_src_global generation:  0.03373456001281738
r_  generation:  0.2896153926849365
local_output_nid generation:  0.015609502792358398
local_in_edges_tensor generation:  0.025187015533447266
mini_batch_src_global generation:  0.03838181495666504
r_  generation:  0.2760164737701416
local_output_nid generation:  0.012672901153564453
local_in_edges_tensor generation:  0.016383647918701172
mini_batch_src_global generation:  0.033998966217041016
r_  generation:  0.2674272060394287
local_output_nid generation:  0.012753963470458984
local_in_edges_tensor generation:  0.018957853317260742
mini_batch_src_global generation:  0.034456729888916016
r_  generation:  0.27001380920410156
local_output_nid generation:  0.012939214706420898
local_in_edges_tensor generation:  0.01693892478942871
mini_batch_src_global generation:  0.03538823127746582
r_  generation:  0.2760646343231201
local_output_nid generation:  0.012753009796142578
local_in_edges_tensor generation:  0.016581296920776367
mini_batch_src_global generation:  0.03494715690612793
r_  generation:  0.2852334976196289
local_output_nid generation:  0.012809038162231445
local_in_edges_tensor generation:  0.020879030227661133
mini_batch_src_global generation:  0.03665518760681152
r_  generation:  0.2786276340484619
local_output_nid generation:  0.012817859649658203
local_in_edges_tensor generation:  0.01651597023010254
mini_batch_src_global generation:  0.03450465202331543
r_  generation:  0.27634644508361816
----------------------check_connections_block total spend ----------------------------- 6.363121032714844
generate_one_block  0.3861572742462158
generate_one_block  0.35782361030578613
generate_one_block  0.3585968017578125
generate_one_block  0.3451559543609619
generate_one_block  0.3484644889831543
generate_one_block  0.3506813049316406
generate_one_block  0.3847527503967285
generate_one_block  0.3385887145996094
generate_one_block  0.34888505935668945
generate_one_block  0.37914156913757324
generate_one_block  0.34693098068237305
generate_one_block  0.3619372844696045
generate_one_block  0.3769538402557373
generate_one_block  0.37323880195617676
generate_one_block  0.3637971878051758
generate_one_block  0.35362887382507324
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.08260083198547363
gen group dst list time:  0.07259821891784668
time for parepare:  0.020136594772338867
local_output_nid generation:  0.025404930114746094
local_in_edges_tensor generation:  0.05774950981140137
mini_batch_src_global generation:  0.0500943660736084
r_  generation:  0.5172090530395508
local_output_nid generation:  0.03033137321472168
local_in_edges_tensor generation:  0.0508730411529541
mini_batch_src_global generation:  0.061621904373168945
r_  generation:  0.5246250629425049
local_output_nid generation:  0.03067779541015625
local_in_edges_tensor generation:  0.03678417205810547
mini_batch_src_global generation:  0.05836296081542969
r_  generation:  0.5476572513580322
local_output_nid generation:  0.031415462493896484
local_in_edges_tensor generation:  0.03749418258666992
mini_batch_src_global generation:  0.05905914306640625
r_  generation:  0.5418846607208252
local_output_nid generation:  0.03133964538574219
local_in_edges_tensor generation:  0.09348487854003906
mini_batch_src_global generation:  0.06348180770874023
r_  generation:  0.565631628036499
local_output_nid generation:  0.033956050872802734
local_in_edges_tensor generation:  0.049040794372558594
mini_batch_src_global generation:  0.07582902908325195
r_  generation:  0.5410351753234863
local_output_nid generation:  0.03363847732543945
local_in_edges_tensor generation:  0.04320383071899414
mini_batch_src_global generation:  0.06181693077087402
r_  generation:  0.5455689430236816
local_output_nid generation:  0.03271746635437012
local_in_edges_tensor generation:  0.03260326385498047
mini_batch_src_global generation:  0.061357736587524414
r_  generation:  0.5450201034545898
local_output_nid generation:  0.03278756141662598
local_in_edges_tensor generation:  0.03798937797546387
mini_batch_src_global generation:  0.06568527221679688
r_  generation:  0.5427839756011963
local_output_nid generation:  0.03300333023071289
local_in_edges_tensor generation:  0.04924726486206055
mini_batch_src_global generation:  0.06200599670410156
r_  generation:  0.5549204349517822
local_output_nid generation:  0.03277873992919922
local_in_edges_tensor generation:  0.03281354904174805
mini_batch_src_global generation:  0.06264734268188477
r_  generation:  0.5492918491363525
local_output_nid generation:  0.03251457214355469
local_in_edges_tensor generation:  0.047209978103637695
mini_batch_src_global generation:  0.06430602073669434
r_  generation:  0.5625073909759521
local_output_nid generation:  0.03481554985046387
local_in_edges_tensor generation:  0.05951237678527832
mini_batch_src_global generation:  0.06882882118225098
r_  generation:  0.5430395603179932
local_output_nid generation:  0.0328371524810791
local_in_edges_tensor generation:  0.03984403610229492
mini_batch_src_global generation:  0.06197094917297363
r_  generation:  0.5503249168395996
local_output_nid generation:  0.03550434112548828
local_in_edges_tensor generation:  0.03823375701904297
mini_batch_src_global generation:  0.06522297859191895
r_  generation:  0.549144983291626
local_output_nid generation:  0.03332924842834473
local_in_edges_tensor generation:  0.03626418113708496
mini_batch_src_global generation:  0.06218385696411133
r_  generation:  0.5487253665924072
----------------------check_connections_block total spend ----------------------------- 12.95627498626709
generate_one_block  0.6881730556488037
generate_one_block  0.7156641483306885
generate_one_block  0.6974561214447021
generate_one_block  0.6940767765045166
generate_one_block  0.7017724514007568
generate_one_block  0.7131321430206299
generate_one_block  0.6872189044952393
generate_one_block  0.6839990615844727
generate_one_block  0.720130443572998
generate_one_block  0.69378662109375
generate_one_block  0.6890420913696289
generate_one_block  0.6905617713928223
generate_one_block  0.7072436809539795
generate_one_block  0.6987142562866211
generate_one_block  0.6934981346130371
generate_one_block  0.7128751277923584
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.12851333618164062  GigaBytes
Max Memory Allocated: 0.8647351264953613  GigaBytes

connection checking time:  19.319396018981934
block generation total time  16.962079286575317
average batch blocks generation time:  1.0601299554109573
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.09987592697143555  GigaBytes
Max Memory Allocated: 0.8647351264953613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.776188850402832  GigaBytes
Max Memory Allocated: 0.8647351264953613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09983158111572266  GigaBytes
Max Memory Allocated: 0.8649039268493652  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7726922035217285  GigaBytes
Max Memory Allocated: 0.8649039268493652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09978628158569336  GigaBytes
Max Memory Allocated: 0.8649039268493652  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.774909496307373  GigaBytes
Max Memory Allocated: 0.8649039268493652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0997018814086914  GigaBytes
Max Memory Allocated: 0.8649039268493652  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7707853317260742  GigaBytes
Max Memory Allocated: 0.8649039268493652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10074329376220703  GigaBytes
Max Memory Allocated: 0.8649039268493652  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7763023376464844  GigaBytes
Max Memory Allocated: 0.8649039268493652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09963369369506836  GigaBytes
Max Memory Allocated: 0.8649039268493652  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7694277763366699  GigaBytes
Max Memory Allocated: 0.8649039268493652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09966516494750977  GigaBytes
Max Memory Allocated: 0.8649039268493652  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7696533203125  GigaBytes
Max Memory Allocated: 0.8649039268493652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09966802597045898  GigaBytes
Max Memory Allocated: 0.8649039268493652  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7656064033508301  GigaBytes
Max Memory Allocated: 0.8649039268493652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10068702697753906  GigaBytes
Max Memory Allocated: 0.8649039268493652  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7708797454833984  GigaBytes
Max Memory Allocated: 0.8649039268493652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09997272491455078  GigaBytes
Max Memory Allocated: 0.8649039268493652  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7812600135803223  GigaBytes
Max Memory Allocated: 0.8649039268493652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09949254989624023  GigaBytes
Max Memory Allocated: 0.8702025413513184  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7645535469055176  GigaBytes
Max Memory Allocated: 0.8702025413513184  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09964990615844727  GigaBytes
Max Memory Allocated: 0.8702025413513184  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.773160457611084  GigaBytes
Max Memory Allocated: 0.8702025413513184  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10093021392822266  GigaBytes
Max Memory Allocated: 0.8702025413513184  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.781714916229248  GigaBytes
Max Memory Allocated: 0.8702025413513184  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09980010986328125  GigaBytes
Max Memory Allocated: 0.8704948425292969  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7727208137512207  GigaBytes
Max Memory Allocated: 0.8704948425292969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09975528717041016  GigaBytes
Max Memory Allocated: 0.8704948425292969  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7722973823547363  GigaBytes
Max Memory Allocated: 0.8704948425292969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09967565536499023  GigaBytes
Max Memory Allocated: 0.8704948425292969  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7708067893981934  GigaBytes
Max Memory Allocated: 0.8704948425292969  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06443768739700317 |0.01899014413356781 |0.0037013590335845947 |9.083747863769531e-05 |0.004890143871307373 |0.0013802051544189453 |
----------------------------------------------------------pseudo_mini_loss sum 3.238147020339966
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5328694
Number of first layer input nodes during this epoch:  2520986
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.1282973289489746  GigaBytes
Max Memory Allocated: 0.8704948425292969  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.029700279235839844
range selection method range initialization spend 0.012668848037719727
time for parepare:  0.01765727996826172
local_output_nid generation:  0.0014030933380126953
local_in_edges_tensor generation:  0.007241487503051758
mini_batch_src_global generation:  0.00176239013671875
r_  generation:  0.02123427391052246
local_output_nid generation:  0.0016145706176757812
local_in_edges_tensor generation:  0.0009930133819580078
mini_batch_src_global generation:  0.0025615692138671875
r_  generation:  0.02163982391357422
local_output_nid generation:  0.0015828609466552734
local_in_edges_tensor generation:  0.0009539127349853516
mini_batch_src_global generation:  0.0016901493072509766
r_  generation:  0.02121257781982422
local_output_nid generation:  0.001605987548828125
local_in_edges_tensor generation:  0.0009791851043701172
mini_batch_src_global generation:  0.0016245841979980469
r_  generation:  0.0215911865234375
local_output_nid generation:  0.0015783309936523438
local_in_edges_tensor generation:  0.0009267330169677734
mini_batch_src_global generation:  0.0017576217651367188
r_  generation:  0.022182226181030273
local_output_nid generation:  0.001569986343383789
local_in_edges_tensor generation:  0.0010330677032470703
mini_batch_src_global generation:  0.0017070770263671875
r_  generation:  0.021848201751708984
local_output_nid generation:  0.0015761852264404297
local_in_edges_tensor generation:  0.0009388923645019531
mini_batch_src_global generation:  0.0017573833465576172
r_  generation:  0.02185344696044922
local_output_nid generation:  0.0015997886657714844
local_in_edges_tensor generation:  0.0009882450103759766
mini_batch_src_global generation:  0.0016529560089111328
r_  generation:  0.021570444107055664
local_output_nid generation:  0.0015873908996582031
local_in_edges_tensor generation:  0.0010149478912353516
mini_batch_src_global generation:  0.001752614974975586
r_  generation:  0.02219104766845703
local_output_nid generation:  0.0016052722930908203
local_in_edges_tensor generation:  0.0009334087371826172
mini_batch_src_global generation:  0.0017445087432861328
r_  generation:  0.022279739379882812
local_output_nid generation:  0.0015993118286132812
local_in_edges_tensor generation:  0.0009603500366210938
mini_batch_src_global generation:  0.0017409324645996094
r_  generation:  0.022373437881469727
local_output_nid generation:  0.0015630722045898438
local_in_edges_tensor generation:  0.0009219646453857422
mini_batch_src_global generation:  0.0017695426940917969
r_  generation:  0.022576570510864258
local_output_nid generation:  0.0015764236450195312
local_in_edges_tensor generation:  0.0009202957153320312
mini_batch_src_global generation:  0.001773834228515625
r_  generation:  0.021876811981201172
local_output_nid generation:  0.0016169548034667969
local_in_edges_tensor generation:  0.0009493827819824219
mini_batch_src_global generation:  0.0017898082733154297
r_  generation:  0.022211313247680664
local_output_nid generation:  0.0015914440155029297
local_in_edges_tensor generation:  0.0009448528289794922
mini_batch_src_global generation:  0.0017790794372558594
r_  generation:  0.021659135818481445
local_output_nid generation:  0.0015761852264404297
local_in_edges_tensor generation:  0.0009431838989257812
mini_batch_src_global generation:  0.0017235279083251953
r_  generation:  0.02147698402404785
----------------------check_connections_block total spend ----------------------------- 0.5214877128601074
generate_one_block  0.034665584564208984
generate_one_block  0.0317835807800293
generate_one_block  0.03067779541015625
generate_one_block  0.031424760818481445
generate_one_block  0.031785011291503906
generate_one_block  0.03325057029724121
generate_one_block  0.03103947639465332
generate_one_block  0.030513525009155273
generate_one_block  0.031682729721069336
generate_one_block  0.03155779838562012
generate_one_block  0.03154420852661133
generate_one_block  0.032117605209350586
generate_one_block  0.030989885330200195
generate_one_block  0.0314478874206543
generate_one_block  0.03067779541015625
generate_one_block  0.03113555908203125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04255175590515137
gen group dst list time:  0.018819808959960938
time for parepare:  0.019246339797973633
local_output_nid generation:  0.007683992385864258
local_in_edges_tensor generation:  0.020876169204711914
mini_batch_src_global generation:  0.027037620544433594
r_  generation:  0.25296902656555176
local_output_nid generation:  0.011453628540039062
local_in_edges_tensor generation:  0.017348051071166992
mini_batch_src_global generation:  0.03250741958618164
r_  generation:  0.263561487197876
local_output_nid generation:  0.011778831481933594
local_in_edges_tensor generation:  0.01599431037902832
mini_batch_src_global generation:  0.031197071075439453
r_  generation:  0.2632274627685547
local_output_nid generation:  0.012565135955810547
local_in_edges_tensor generation:  0.013623714447021484
mini_batch_src_global generation:  0.03376603126525879
r_  generation:  0.27393555641174316
local_output_nid generation:  0.012498617172241211
local_in_edges_tensor generation:  0.017577409744262695
mini_batch_src_global generation:  0.033638715744018555
r_  generation:  0.2806077003479004
local_output_nid generation:  0.012717723846435547
local_in_edges_tensor generation:  0.014827489852905273
mini_batch_src_global generation:  0.03402543067932129
r_  generation:  0.27520155906677246
local_output_nid generation:  0.012615203857421875
local_in_edges_tensor generation:  0.016408920288085938
mini_batch_src_global generation:  0.0338289737701416
r_  generation:  0.2710545063018799
local_output_nid generation:  0.012435674667358398
local_in_edges_tensor generation:  0.014955520629882812
mini_batch_src_global generation:  0.03323864936828613
r_  generation:  0.27089452743530273
local_output_nid generation:  0.012729406356811523
local_in_edges_tensor generation:  0.01399683952331543
mini_batch_src_global generation:  0.034163713455200195
r_  generation:  0.278764009475708
local_output_nid generation:  0.01244974136352539
local_in_edges_tensor generation:  0.01592540740966797
mini_batch_src_global generation:  0.0344538688659668
r_  generation:  0.27801060676574707
local_output_nid generation:  0.012384891510009766
local_in_edges_tensor generation:  0.015967607498168945
mini_batch_src_global generation:  0.03399395942687988
r_  generation:  0.28035473823547363
local_output_nid generation:  0.01267862319946289
local_in_edges_tensor generation:  0.015513896942138672
mini_batch_src_global generation:  0.035275936126708984
r_  generation:  0.28360462188720703
local_output_nid generation:  0.012300252914428711
local_in_edges_tensor generation:  0.017000675201416016
mini_batch_src_global generation:  0.03430914878845215
r_  generation:  0.27803993225097656
local_output_nid generation:  0.012623786926269531
local_in_edges_tensor generation:  0.0143890380859375
mini_batch_src_global generation:  0.03468918800354004
r_  generation:  0.27947139739990234
local_output_nid generation:  0.012470006942749023
local_in_edges_tensor generation:  0.015021800994873047
mini_batch_src_global generation:  0.03380727767944336
r_  generation:  0.2752087116241455
local_output_nid generation:  0.012569665908813477
local_in_edges_tensor generation:  0.01872420310974121
mini_batch_src_global generation:  0.03391551971435547
r_  generation:  0.2721741199493408
----------------------check_connections_block total spend ----------------------------- 6.304701089859009
generate_one_block  0.3626892566680908
generate_one_block  0.3539543151855469
generate_one_block  0.3496577739715576
generate_one_block  0.355440616607666
generate_one_block  0.35768604278564453
generate_one_block  0.3545689582824707
generate_one_block  0.3900158405303955
generate_one_block  0.34372544288635254
generate_one_block  0.36203718185424805
generate_one_block  0.35986781120300293
generate_one_block  0.35816025733947754
generate_one_block  0.36565470695495605
generate_one_block  0.34485650062561035
generate_one_block  0.3498067855834961
generate_one_block  0.34084606170654297
generate_one_block  0.3422813415527344
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04752993583679199
gen group dst list time:  0.07063961029052734
time for parepare:  0.017852783203125
local_output_nid generation:  0.025722503662109375
local_in_edges_tensor generation:  0.05019736289978027
mini_batch_src_global generation:  0.055581092834472656
r_  generation:  0.5184669494628906
local_output_nid generation:  0.030791759490966797
local_in_edges_tensor generation:  0.04609823226928711
mini_batch_src_global generation:  0.06696343421936035
r_  generation:  0.5271425247192383
local_output_nid generation:  0.03204751014709473
local_in_edges_tensor generation:  0.034751176834106445
mini_batch_src_global generation:  0.05887341499328613
r_  generation:  0.5507512092590332
local_output_nid generation:  0.031996965408325195
local_in_edges_tensor generation:  0.03542304039001465
mini_batch_src_global generation:  0.05995988845825195
r_  generation:  0.5368802547454834
local_output_nid generation:  0.03560972213745117
local_in_edges_tensor generation:  0.09411144256591797
mini_batch_src_global generation:  0.06158304214477539
r_  generation:  0.54469895362854
local_output_nid generation:  0.0323333740234375
local_in_edges_tensor generation:  0.03760647773742676
mini_batch_src_global generation:  0.06164407730102539
r_  generation:  0.5483405590057373
local_output_nid generation:  0.0322728157043457
local_in_edges_tensor generation:  0.03623342514038086
mini_batch_src_global generation:  0.06053876876831055
r_  generation:  0.5522201061248779
local_output_nid generation:  0.032303810119628906
local_in_edges_tensor generation:  0.036676883697509766
mini_batch_src_global generation:  0.061818838119506836
r_  generation:  0.5436267852783203
local_output_nid generation:  0.03213858604431152
local_in_edges_tensor generation:  0.0359954833984375
mini_batch_src_global generation:  0.06389117240905762
r_  generation:  0.5453429222106934
local_output_nid generation:  0.03401541709899902
local_in_edges_tensor generation:  0.03685331344604492
mini_batch_src_global generation:  0.06091165542602539
r_  generation:  0.5593054294586182
local_output_nid generation:  0.03351593017578125
local_in_edges_tensor generation:  0.03259587287902832
mini_batch_src_global generation:  0.06493473052978516
r_  generation:  0.5512921810150146
local_output_nid generation:  0.03428339958190918
local_in_edges_tensor generation:  0.04176497459411621
mini_batch_src_global generation:  0.06192755699157715
r_  generation:  0.5460596084594727
local_output_nid generation:  0.03337907791137695
local_in_edges_tensor generation:  0.03203940391540527
mini_batch_src_global generation:  0.061759233474731445
r_  generation:  0.5421698093414307
local_output_nid generation:  0.0330958366394043
local_in_edges_tensor generation:  0.03584170341491699
mini_batch_src_global generation:  0.061720848083496094
r_  generation:  0.5480372905731201
local_output_nid generation:  0.03358292579650879
local_in_edges_tensor generation:  0.03988814353942871
mini_batch_src_global generation:  0.06230521202087402
r_  generation:  0.5481653213500977
local_output_nid generation:  0.03364157676696777
local_in_edges_tensor generation:  0.037625789642333984
mini_batch_src_global generation:  0.07274007797241211
r_  generation:  0.5445671081542969
----------------------check_connections_block total spend ----------------------------- 12.82296872138977
generate_one_block  0.6930828094482422
generate_one_block  0.6921243667602539
generate_one_block  0.6926934719085693
generate_one_block  0.6976237297058105
generate_one_block  0.6823673248291016
generate_one_block  0.688854455947876
generate_one_block  0.6851212978363037
generate_one_block  0.6778967380523682
generate_one_block  0.7586715221405029
generate_one_block  0.7031588554382324
generate_one_block  0.6882257461547852
generate_one_block  0.7024261951446533
generate_one_block  0.68684983253479
generate_one_block  0.6770427227020264
generate_one_block  0.6757857799530029
generate_one_block  0.686776876449585
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.1282973289489746  GigaBytes
Max Memory Allocated: 0.8704948425292969  GigaBytes

connection checking time:  19.12766981124878
block generation total time  16.779950618743896
average batch blocks generation time:  1.0487469136714935
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09975862503051758  GigaBytes
Max Memory Allocated: 0.8704948425292969  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7728466987609863  GigaBytes
Max Memory Allocated: 0.8704948425292969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09984874725341797  GigaBytes
Max Memory Allocated: 0.8704948425292969  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7763657569885254  GigaBytes
Max Memory Allocated: 0.8704948425292969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09963226318359375  GigaBytes
Max Memory Allocated: 0.8704948425292969  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.770904541015625  GigaBytes
Max Memory Allocated: 0.8704948425292969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09996986389160156  GigaBytes
Max Memory Allocated: 0.8704948425292969  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7808003425598145  GigaBytes
Max Memory Allocated: 0.8704948425292969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09987068176269531  GigaBytes
Max Memory Allocated: 0.8704948425292969  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7796230316162109  GigaBytes
Max Memory Allocated: 0.8704948425292969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09974241256713867  GigaBytes
Max Memory Allocated: 0.8704948425292969  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7703151702880859  GigaBytes
Max Memory Allocated: 0.8704948425292969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09958600997924805  GigaBytes
Max Memory Allocated: 0.8704948425292969  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7670669555664062  GigaBytes
Max Memory Allocated: 0.8704948425292969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09954309463500977  GigaBytes
Max Memory Allocated: 0.8704948425292969  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.765861988067627  GigaBytes
Max Memory Allocated: 0.8704948425292969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09991312026977539  GigaBytes
Max Memory Allocated: 0.8704948425292969  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7804460525512695  GigaBytes
Max Memory Allocated: 0.8704948425292969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09983968734741211  GigaBytes
Max Memory Allocated: 0.8704948425292969  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.779517650604248  GigaBytes
Max Memory Allocated: 0.8704948425292969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09971189498901367  GigaBytes
Max Memory Allocated: 0.8704948425292969  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7718572616577148  GigaBytes
Max Memory Allocated: 0.8704948425292969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10000038146972656  GigaBytes
Max Memory Allocated: 0.8704948425292969  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7814764976501465  GigaBytes
Max Memory Allocated: 0.8704948425292969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09951019287109375  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7664446830749512  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09962844848632812  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.772404670715332  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09956502914428711  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7666029930114746  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09966850280761719  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7660021781921387  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06713904440402985 |0.01911894977092743 |0.003590703010559082 |9.103119373321533e-05 |0.0033519715070724487 |0.0013804435729980469 |
----------------------------------------------------------pseudo_mini_loss sum 2.599152088165283
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  5328549
Number of first layer input nodes during this epoch:  2520533
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.12710237503051758  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025168180465698242
range selection method range initialization spend 0.011940240859985352
time for parepare:  0.0178983211517334
local_output_nid generation:  0.0013947486877441406
local_in_edges_tensor generation:  0.007271528244018555
mini_batch_src_global generation:  0.0021123886108398438
r_  generation:  0.020329952239990234
local_output_nid generation:  0.0015995502471923828
local_in_edges_tensor generation:  0.0009694099426269531
mini_batch_src_global generation:  0.0023403167724609375
r_  generation:  0.021976947784423828
local_output_nid generation:  0.0015707015991210938
local_in_edges_tensor generation:  0.0010066032409667969
mini_batch_src_global generation:  0.0017659664154052734
r_  generation:  0.0214846134185791
local_output_nid generation:  0.001669168472290039
local_in_edges_tensor generation:  0.0009276866912841797
mini_batch_src_global generation:  0.0016932487487792969
r_  generation:  0.021744489669799805
local_output_nid generation:  0.0015752315521240234
local_in_edges_tensor generation:  0.0009548664093017578
mini_batch_src_global generation:  0.0017309188842773438
r_  generation:  0.021262407302856445
local_output_nid generation:  0.0015926361083984375
local_in_edges_tensor generation:  0.0009050369262695312
mini_batch_src_global generation:  0.001695394515991211
r_  generation:  0.021870851516723633
local_output_nid generation:  0.00165557861328125
local_in_edges_tensor generation:  0.0009644031524658203
mini_batch_src_global generation:  0.001737833023071289
r_  generation:  0.02166295051574707
local_output_nid generation:  0.0015957355499267578
local_in_edges_tensor generation:  0.0008845329284667969
mini_batch_src_global generation:  0.0017232894897460938
r_  generation:  0.021736621856689453
local_output_nid generation:  0.0016171932220458984
local_in_edges_tensor generation:  0.0009107589721679688
mini_batch_src_global generation:  0.001758575439453125
r_  generation:  0.022014856338500977
local_output_nid generation:  0.0016031265258789062
local_in_edges_tensor generation:  0.0009543895721435547
mini_batch_src_global generation:  0.0017991065979003906
r_  generation:  0.022600412368774414
local_output_nid generation:  0.0016491413116455078
local_in_edges_tensor generation:  0.0010654926300048828
mini_batch_src_global generation:  0.0018608570098876953
r_  generation:  0.022497177124023438
local_output_nid generation:  0.0015978813171386719
local_in_edges_tensor generation:  0.0009152889251708984
mini_batch_src_global generation:  0.0017783641815185547
r_  generation:  0.022292137145996094
local_output_nid generation:  0.001621246337890625
local_in_edges_tensor generation:  0.0009033679962158203
mini_batch_src_global generation:  0.0018343925476074219
r_  generation:  0.022378921508789062
local_output_nid generation:  0.0016095638275146484
local_in_edges_tensor generation:  0.0009181499481201172
mini_batch_src_global generation:  0.0017428398132324219
r_  generation:  0.022502899169921875
local_output_nid generation:  0.0018191337585449219
local_in_edges_tensor generation:  0.0009272098541259766
mini_batch_src_global generation:  0.0018079280853271484
r_  generation:  0.021915674209594727
local_output_nid generation:  0.0016112327575683594
local_in_edges_tensor generation:  0.0009348392486572266
mini_batch_src_global generation:  0.0017278194427490234
r_  generation:  0.022081375122070312
----------------------check_connections_block total spend ----------------------------- 0.5241034030914307
generate_one_block  0.03029656410217285
generate_one_block  0.0321505069732666
generate_one_block  0.03125357627868652
generate_one_block  0.03228116035461426
generate_one_block  0.030354738235473633
generate_one_block  0.03290295600891113
generate_one_block  0.030626773834228516
generate_one_block  0.03156137466430664
generate_one_block  0.03488016128540039
generate_one_block  0.03235483169555664
generate_one_block  0.03175640106201172
generate_one_block  0.03156232833862305
generate_one_block  0.03165125846862793
generate_one_block  0.03125786781311035
generate_one_block  0.031071186065673828
generate_one_block  0.03202939033508301
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03866004943847656
gen group dst list time:  0.018853425979614258
time for parepare:  0.019107341766357422
local_output_nid generation:  0.007330656051635742
local_in_edges_tensor generation:  0.02329397201538086
mini_batch_src_global generation:  0.02565455436706543
r_  generation:  0.24683499336242676
local_output_nid generation:  0.011576652526855469
local_in_edges_tensor generation:  0.013031959533691406
mini_batch_src_global generation:  0.032201528549194336
r_  generation:  0.26231813430786133
local_output_nid generation:  0.011469125747680664
local_in_edges_tensor generation:  0.015087604522705078
mini_batch_src_global generation:  0.031075239181518555
r_  generation:  0.26572299003601074
local_output_nid generation:  0.012828826904296875
local_in_edges_tensor generation:  0.016727447509765625
mini_batch_src_global generation:  0.03284764289855957
r_  generation:  0.27369236946105957
local_output_nid generation:  0.011951923370361328
local_in_edges_tensor generation:  0.01644420623779297
mini_batch_src_global generation:  0.03274655342102051
r_  generation:  0.2624640464782715
local_output_nid generation:  0.012938499450683594
local_in_edges_tensor generation:  0.014360666275024414
mini_batch_src_global generation:  0.03336453437805176
r_  generation:  0.2696380615234375
local_output_nid generation:  0.012831687927246094
local_in_edges_tensor generation:  0.013495445251464844
mini_batch_src_global generation:  0.03356742858886719
r_  generation:  0.2686033248901367
local_output_nid generation:  0.013018369674682617
local_in_edges_tensor generation:  0.013289451599121094
mini_batch_src_global generation:  0.03420853614807129
r_  generation:  0.2752964496612549
local_output_nid generation:  0.01325845718383789
local_in_edges_tensor generation:  0.013344049453735352
mini_batch_src_global generation:  0.03648066520690918
r_  generation:  0.27227234840393066
local_output_nid generation:  0.013097286224365234
local_in_edges_tensor generation:  0.013728618621826172
mini_batch_src_global generation:  0.03445935249328613
r_  generation:  0.2790236473083496
local_output_nid generation:  0.012706756591796875
local_in_edges_tensor generation:  0.013577938079833984
mini_batch_src_global generation:  0.03609037399291992
r_  generation:  0.27725720405578613
local_output_nid generation:  0.012602806091308594
local_in_edges_tensor generation:  0.013855457305908203
mini_batch_src_global generation:  0.03499102592468262
r_  generation:  0.2776176929473877
local_output_nid generation:  0.012684106826782227
local_in_edges_tensor generation:  0.014653205871582031
mini_batch_src_global generation:  0.03445315361022949
r_  generation:  0.27692484855651855
local_output_nid generation:  0.012693166732788086
local_in_edges_tensor generation:  0.013693094253540039
mini_batch_src_global generation:  0.03733110427856445
r_  generation:  0.27564239501953125
local_output_nid generation:  0.012459278106689453
local_in_edges_tensor generation:  0.013809919357299805
mini_batch_src_global generation:  0.03606581687927246
r_  generation:  0.2748112678527832
local_output_nid generation:  0.01247859001159668
local_in_edges_tensor generation:  0.013912677764892578
mini_batch_src_global generation:  0.03435349464416504
r_  generation:  0.2741541862487793
----------------------check_connections_block total spend ----------------------------- 6.2437896728515625
generate_one_block  0.34317851066589355
generate_one_block  0.345534086227417
generate_one_block  0.35042309761047363
generate_one_block  0.35831236839294434
generate_one_block  0.3381667137145996
generate_one_block  0.34340977668762207
generate_one_block  0.3638124465942383
generate_one_block  0.34639978408813477
generate_one_block  0.3484213352203369
generate_one_block  0.3619248867034912
generate_one_block  0.35431385040283203
generate_one_block  0.35309481620788574
generate_one_block  0.3525965213775635
generate_one_block  0.3560457229614258
generate_one_block  0.35103583335876465
generate_one_block  0.34728479385375977
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.040708303451538086
gen group dst list time:  0.0651695728302002
time for parepare:  0.018346071243286133
local_output_nid generation:  0.025899648666381836
local_in_edges_tensor generation:  0.03961181640625
mini_batch_src_global generation:  0.048630714416503906
r_  generation:  0.5251595973968506
local_output_nid generation:  0.031081199645996094
local_in_edges_tensor generation:  0.04060769081115723
mini_batch_src_global generation:  0.06863594055175781
r_  generation:  0.521838903427124
local_output_nid generation:  0.03146243095397949
local_in_edges_tensor generation:  0.03534221649169922
mini_batch_src_global generation:  0.05889892578125
r_  generation:  0.5348691940307617
local_output_nid generation:  0.03229260444641113
local_in_edges_tensor generation:  0.03332686424255371
mini_batch_src_global generation:  0.060140132904052734
r_  generation:  0.5383260250091553
local_output_nid generation:  0.03206038475036621
local_in_edges_tensor generation:  0.07628226280212402
mini_batch_src_global generation:  0.06032919883728027
r_  generation:  0.536707878112793
local_output_nid generation:  0.03227090835571289
local_in_edges_tensor generation:  0.03445267677307129
mini_batch_src_global generation:  0.06363844871520996
r_  generation:  0.5380716323852539
local_output_nid generation:  0.03243613243103027
local_in_edges_tensor generation:  0.03358602523803711
mini_batch_src_global generation:  0.061158180236816406
r_  generation:  0.5436787605285645
local_output_nid generation:  0.03234243392944336
local_in_edges_tensor generation:  0.03281593322753906
mini_batch_src_global generation:  0.06130576133728027
r_  generation:  0.5392787456512451
local_output_nid generation:  0.0324404239654541
local_in_edges_tensor generation:  0.03187370300292969
mini_batch_src_global generation:  0.06327295303344727
r_  generation:  0.5459713935852051
local_output_nid generation:  0.03245735168457031
local_in_edges_tensor generation:  0.0372769832611084
mini_batch_src_global generation:  0.06438755989074707
r_  generation:  0.5441467761993408
local_output_nid generation:  0.03255152702331543
local_in_edges_tensor generation:  0.03590989112854004
mini_batch_src_global generation:  0.06106686592102051
r_  generation:  0.5457825660705566
local_output_nid generation:  0.03371715545654297
local_in_edges_tensor generation:  0.033100128173828125
mini_batch_src_global generation:  0.06298637390136719
r_  generation:  0.5401389598846436
local_output_nid generation:  0.03337407112121582
local_in_edges_tensor generation:  0.03384852409362793
mini_batch_src_global generation:  0.06392669677734375
r_  generation:  0.549729585647583
local_output_nid generation:  0.033029794692993164
local_in_edges_tensor generation:  0.03827381134033203
mini_batch_src_global generation:  0.06151914596557617
r_  generation:  0.5390298366546631
local_output_nid generation:  0.033133745193481445
local_in_edges_tensor generation:  0.031052589416503906
mini_batch_src_global generation:  0.06148719787597656
r_  generation:  0.5481412410736084
local_output_nid generation:  0.033060550689697266
local_in_edges_tensor generation:  0.04437685012817383
mini_batch_src_global generation:  0.06308627128601074
r_  generation:  0.537848949432373
----------------------check_connections_block total spend ----------------------------- 12.656959533691406
generate_one_block  0.6795954704284668
generate_one_block  0.6794586181640625
generate_one_block  0.6746912002563477
generate_one_block  0.6859793663024902
generate_one_block  0.6753137111663818
generate_one_block  0.680574893951416
generate_one_block  0.6905786991119385
generate_one_block  0.6745195388793945
generate_one_block  0.7333590984344482
generate_one_block  0.6983048915863037
generate_one_block  0.6776394844055176
generate_one_block  0.6754860877990723
generate_one_block  0.6865975856781006
generate_one_block  0.6860957145690918
generate_one_block  0.6831529140472412
generate_one_block  0.67482590675354
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.12710237503051758  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

connection checking time:  18.90074920654297
block generation total time  16.570127725601196
average batch blocks generation time:  1.0356329828500748
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09959793090820312  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7649931907653809  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09979438781738281  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7793478965759277  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09974002838134766  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7714118957519531  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09998273849487305  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7811636924743652  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09949254989624023  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.763880729675293  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09972429275512695  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7696619033813477  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10065174102783203  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7730727195739746  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09960651397705078  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7690143585205078  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10073471069335938  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7772212028503418  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10003948211669922  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7814655303955078  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09977102279663086  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7758798599243164  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0998692512512207  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7726855278015137  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.1008768081665039  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7810072898864746  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0998387336730957  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7733926773071289  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09973859786987305  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.771510124206543  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09951353073120117  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7687778472900391  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06295759975910187 |0.015065044164657593 |0.0036448389291763306 |9.03010368347168e-05 |0.005049481987953186 |0.0019195079803466797 |
----------------------------------------------------------pseudo_mini_loss sum 2.3502678871154785
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  5330653
Number of first layer input nodes during this epoch:  2521308
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.12811517715454102  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0277097225189209
range selection method range initialization spend 0.012037277221679688
time for parepare:  0.017669677734375
local_output_nid generation:  0.0013921260833740234
local_in_edges_tensor generation:  0.004288911819458008
mini_batch_src_global generation:  0.0018224716186523438
r_  generation:  0.021773576736450195
local_output_nid generation:  0.0015997886657714844
local_in_edges_tensor generation:  0.0009708404541015625
mini_batch_src_global generation:  0.00202178955078125
r_  generation:  0.022157907485961914
local_output_nid generation:  0.0016162395477294922
local_in_edges_tensor generation:  0.0009751319885253906
mini_batch_src_global generation:  0.0017251968383789062
r_  generation:  0.02182793617248535
local_output_nid generation:  0.0016813278198242188
local_in_edges_tensor generation:  0.0009720325469970703
mini_batch_src_global generation:  0.0016431808471679688
r_  generation:  0.02109527587890625
local_output_nid generation:  0.0016357898712158203
local_in_edges_tensor generation:  0.0009472370147705078
mini_batch_src_global generation:  0.0017514228820800781
r_  generation:  0.02202582359313965
local_output_nid generation:  0.0016450881958007812
local_in_edges_tensor generation:  0.0009324550628662109
mini_batch_src_global generation:  0.001790761947631836
r_  generation:  0.022140979766845703
local_output_nid generation:  0.0015916824340820312
local_in_edges_tensor generation:  0.0009419918060302734
mini_batch_src_global generation:  0.0017685890197753906
r_  generation:  0.022090435028076172
local_output_nid generation:  0.001611948013305664
local_in_edges_tensor generation:  0.0009334087371826172
mini_batch_src_global generation:  0.0017924308776855469
r_  generation:  0.02214646339416504
local_output_nid generation:  0.0016264915466308594
local_in_edges_tensor generation:  0.0009393692016601562
mini_batch_src_global generation:  0.0017828941345214844
r_  generation:  0.022683143615722656
local_output_nid generation:  0.0016269683837890625
local_in_edges_tensor generation:  0.0009562969207763672
mini_batch_src_global generation:  0.0018100738525390625
r_  generation:  0.022426843643188477
local_output_nid generation:  0.0016188621520996094
local_in_edges_tensor generation:  0.0009484291076660156
mini_batch_src_global generation:  0.0017392635345458984
r_  generation:  0.022121667861938477
local_output_nid generation:  0.0016171932220458984
local_in_edges_tensor generation:  0.000997304916381836
mini_batch_src_global generation:  0.0017859935760498047
r_  generation:  0.02250814437866211
local_output_nid generation:  0.0016078948974609375
local_in_edges_tensor generation:  0.0009558200836181641
mini_batch_src_global generation:  0.0017604827880859375
r_  generation:  0.021759033203125
local_output_nid generation:  0.0017156600952148438
local_in_edges_tensor generation:  0.0009465217590332031
mini_batch_src_global generation:  0.0018024444580078125
r_  generation:  0.02258157730102539
local_output_nid generation:  0.001608133316040039
local_in_edges_tensor generation:  0.000949859619140625
mini_batch_src_global generation:  0.0017788410186767578
r_  generation:  0.021723270416259766
local_output_nid generation:  0.0016133785247802734
local_in_edges_tensor generation:  0.0009615421295166016
mini_batch_src_global generation:  0.0018012523651123047
r_  generation:  0.02257680892944336
----------------------check_connections_block total spend ----------------------------- 0.5232534408569336
generate_one_block  0.03858828544616699
generate_one_block  0.03132915496826172
generate_one_block  0.03156709671020508
generate_one_block  0.030859947204589844
generate_one_block  0.0315399169921875
generate_one_block  0.03272867202758789
generate_one_block  0.03148651123046875
generate_one_block  0.03110980987548828
generate_one_block  0.03203535079956055
generate_one_block  0.031089305877685547
generate_one_block  0.031000852584838867
generate_one_block  0.0315704345703125
generate_one_block  0.030939817428588867
generate_one_block  0.032088518142700195
generate_one_block  0.030600309371948242
generate_one_block  0.031595468521118164
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.035184383392333984
gen group dst list time:  0.01873612403869629
time for parepare:  0.019314289093017578
local_output_nid generation:  0.007451772689819336
local_in_edges_tensor generation:  0.01936960220336914
mini_batch_src_global generation:  0.027326583862304688
r_  generation:  0.2539098262786865
local_output_nid generation:  0.011145591735839844
local_in_edges_tensor generation:  0.01608872413635254
mini_batch_src_global generation:  0.03456830978393555
r_  generation:  0.25871801376342773
local_output_nid generation:  0.011587381362915039
local_in_edges_tensor generation:  0.013178110122680664
mini_batch_src_global generation:  0.0343785285949707
r_  generation:  0.2710237503051758
local_output_nid generation:  0.012101888656616211
local_in_edges_tensor generation:  0.017366647720336914
mini_batch_src_global generation:  0.03146100044250488
r_  generation:  0.26262688636779785
local_output_nid generation:  0.012722015380859375
local_in_edges_tensor generation:  0.013422012329101562
mini_batch_src_global generation:  0.0332493782043457
r_  generation:  0.27434301376342773
local_output_nid generation:  0.012752056121826172
local_in_edges_tensor generation:  0.013169288635253906
mini_batch_src_global generation:  0.03363633155822754
r_  generation:  0.26695942878723145
local_output_nid generation:  0.012904644012451172
local_in_edges_tensor generation:  0.014825820922851562
mini_batch_src_global generation:  0.03506827354431152
r_  generation:  0.27115893363952637
local_output_nid generation:  0.013129949569702148
local_in_edges_tensor generation:  0.01358795166015625
mini_batch_src_global generation:  0.03468680381774902
r_  generation:  0.27942872047424316
local_output_nid generation:  0.013241291046142578
local_in_edges_tensor generation:  0.016278743743896484
mini_batch_src_global generation:  0.03434467315673828
r_  generation:  0.276932954788208
local_output_nid generation:  0.013054609298706055
local_in_edges_tensor generation:  0.014411449432373047
mini_batch_src_global generation:  0.034592390060424805
r_  generation:  0.2730858325958252
local_output_nid generation:  0.012946605682373047
local_in_edges_tensor generation:  0.013512849807739258
mini_batch_src_global generation:  0.0345461368560791
r_  generation:  0.2737257480621338
local_output_nid generation:  0.012716531753540039
local_in_edges_tensor generation:  0.014656305313110352
mini_batch_src_global generation:  0.03487706184387207
r_  generation:  0.2792952060699463
local_output_nid generation:  0.012324094772338867
local_in_edges_tensor generation:  0.014753341674804688
mini_batch_src_global generation:  0.03442192077636719
r_  generation:  0.2744154930114746
local_output_nid generation:  0.012667655944824219
local_in_edges_tensor generation:  0.013559103012084961
mini_batch_src_global generation:  0.03877449035644531
r_  generation:  0.28162384033203125
local_output_nid generation:  0.012381792068481445
local_in_edges_tensor generation:  0.013571977615356445
mini_batch_src_global generation:  0.03684711456298828
r_  generation:  0.27385401725769043
local_output_nid generation:  0.012412309646606445
local_in_edges_tensor generation:  0.013949871063232422
mini_batch_src_global generation:  0.03819870948791504
r_  generation:  0.278613805770874
----------------------check_connections_block total spend ----------------------------- 6.274827718734741
generate_one_block  0.3504507541656494
generate_one_block  0.3444194793701172
generate_one_block  0.3486957550048828
generate_one_block  0.34078550338745117
generate_one_block  0.3542165756225586
generate_one_block  0.3424379825592041
generate_one_block  0.3732154369354248
generate_one_block  0.35099339485168457
generate_one_block  0.3597431182861328
generate_one_block  0.3518869876861572
generate_one_block  0.3484935760498047
generate_one_block  0.35854244232177734
generate_one_block  0.34670495986938477
generate_one_block  0.3598463535308838
generate_one_block  0.3468048572540283
generate_one_block  0.3527381420135498
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04767894744873047
gen group dst list time:  0.07257366180419922
time for parepare:  0.023334980010986328
local_output_nid generation:  0.03501701354980469
local_in_edges_tensor generation:  0.07242679595947266
mini_batch_src_global generation:  0.0569305419921875
r_  generation:  0.5626480579376221
local_output_nid generation:  0.035372257232666016
local_in_edges_tensor generation:  0.04670143127441406
mini_batch_src_global generation:  0.06949400901794434
r_  generation:  0.5494740009307861
local_output_nid generation:  0.032700300216674805
local_in_edges_tensor generation:  0.03660941123962402
mini_batch_src_global generation:  0.0656428337097168
r_  generation:  0.5646708011627197
local_output_nid generation:  0.033254384994506836
local_in_edges_tensor generation:  0.04421710968017578
mini_batch_src_global generation:  0.06629490852355957
r_  generation:  0.554682731628418
local_output_nid generation:  0.03374767303466797
local_in_edges_tensor generation:  0.10352063179016113
mini_batch_src_global generation:  0.07089710235595703
r_  generation:  0.570622444152832
local_output_nid generation:  0.033911705017089844
local_in_edges_tensor generation:  0.04130959510803223
mini_batch_src_global generation:  0.06587386131286621
r_  generation:  0.5843181610107422
local_output_nid generation:  0.03954601287841797
local_in_edges_tensor generation:  0.03930974006652832
mini_batch_src_global generation:  0.08046960830688477
r_  generation:  0.5468220710754395
local_output_nid generation:  0.03689455986022949
local_in_edges_tensor generation:  0.032950401306152344
mini_batch_src_global generation:  0.062200069427490234
r_  generation:  0.5469424724578857
local_output_nid generation:  0.03703761100769043
local_in_edges_tensor generation:  0.038095712661743164
mini_batch_src_global generation:  0.06149578094482422
r_  generation:  0.5498878955841064
local_output_nid generation:  0.03711867332458496
local_in_edges_tensor generation:  0.035298824310302734
mini_batch_src_global generation:  0.06321334838867188
r_  generation:  0.5608723163604736
local_output_nid generation:  0.03740382194519043
local_in_edges_tensor generation:  0.0332949161529541
mini_batch_src_global generation:  0.06220197677612305
r_  generation:  0.5486390590667725
local_output_nid generation:  0.03747200965881348
local_in_edges_tensor generation:  0.04281020164489746
mini_batch_src_global generation:  0.06268310546875
r_  generation:  0.5498745441436768
local_output_nid generation:  0.03753781318664551
local_in_edges_tensor generation:  0.03181815147399902
mini_batch_src_global generation:  0.06293153762817383
r_  generation:  0.5447514057159424
local_output_nid generation:  0.03784370422363281
local_in_edges_tensor generation:  0.036446571350097656
mini_batch_src_global generation:  0.062451839447021484
r_  generation:  0.550940752029419
local_output_nid generation:  0.03751397132873535
local_in_edges_tensor generation:  0.03699517250061035
mini_batch_src_global generation:  0.06794619560241699
r_  generation:  0.5512926578521729
local_output_nid generation:  0.03828072547912598
local_in_edges_tensor generation:  0.03928208351135254
mini_batch_src_global generation:  0.06222653388977051
r_  generation:  0.547372579574585
----------------------check_connections_block total spend ----------------------------- 13.255172729492188
generate_one_block  0.7031099796295166
generate_one_block  0.6891646385192871
generate_one_block  0.6829397678375244
generate_one_block  0.6785323619842529
generate_one_block  0.6809568405151367
generate_one_block  0.6886179447174072
generate_one_block  0.6873314380645752
generate_one_block  0.7049407958984375
generate_one_block  0.7794234752655029
generate_one_block  0.6938247680664062
generate_one_block  0.7038662433624268
generate_one_block  0.696169376373291
generate_one_block  0.6890008449554443
generate_one_block  0.7046113014221191
generate_one_block  0.6918387413024902
generate_one_block  0.6812782287597656
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.12811517715454102  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

connection checking time:  19.53000044822693
block generation total time  16.785582065582275
average batch blocks generation time:  1.0490988790988922
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.1008906364440918  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7817344665527344  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09989356994628906  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7729697227478027  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10080528259277344  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7771706581115723  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09953737258911133  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.764549732208252  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09982061386108398  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.77532958984375  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09964704513549805  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7696104049682617  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09978866577148438  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7705421447753906  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09980106353759766  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7718634605407715  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09984493255615234  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7765817642211914  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09978055953979492  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7704358100891113  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10074996948242188  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7766427993774414  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09995174407958984  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7812051773071289  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09960317611694336  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7680320739746094  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10005903244018555  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7813081741333008  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09972906112670898  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7740631103515625  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09969520568847656  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7696371078491211  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.065244659781456 |0.017423555254936218 |0.003543168306350708 |9.015202522277832e-05 |0.00347118079662323 |0.0019023418426513672 |
----------------------------------------------------------pseudo_mini_loss sum 2.0975801944732666
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  5332547
Number of first layer input nodes during this epoch:  2522506
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.12839365005493164  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02534961700439453
range selection method range initialization spend 0.012414932250976562
time for parepare:  0.01836228370666504
local_output_nid generation:  0.0014557838439941406
local_in_edges_tensor generation:  0.006700754165649414
mini_batch_src_global generation:  0.0021219253540039062
r_  generation:  0.019983530044555664
local_output_nid generation:  0.0015811920166015625
local_in_edges_tensor generation:  0.0009644031524658203
mini_batch_src_global generation:  0.002277374267578125
r_  generation:  0.02219986915588379
local_output_nid generation:  0.0016019344329833984
local_in_edges_tensor generation:  0.0009713172912597656
mini_batch_src_global generation:  0.00174713134765625
r_  generation:  0.022169113159179688
local_output_nid generation:  0.0016033649444580078
local_in_edges_tensor generation:  0.0009562969207763672
mini_batch_src_global generation:  0.0016930103302001953
r_  generation:  0.02179265022277832
local_output_nid generation:  0.0015940666198730469
local_in_edges_tensor generation:  0.0009326934814453125
mini_batch_src_global generation:  0.0017273426055908203
r_  generation:  0.0214693546295166
local_output_nid generation:  0.0016372203826904297
local_in_edges_tensor generation:  0.0008866786956787109
mini_batch_src_global generation:  0.0017447471618652344
r_  generation:  0.02267146110534668
local_output_nid generation:  0.0016016960144042969
local_in_edges_tensor generation:  0.0009379386901855469
mini_batch_src_global generation:  0.0017778873443603516
r_  generation:  0.02236795425415039
local_output_nid generation:  0.0015721321105957031
local_in_edges_tensor generation:  0.0009255409240722656
mini_batch_src_global generation:  0.0018339157104492188
r_  generation:  0.02264118194580078
local_output_nid generation:  0.0015981197357177734
local_in_edges_tensor generation:  0.0009527206420898438
mini_batch_src_global generation:  0.0017900466918945312
r_  generation:  0.022006511688232422
local_output_nid generation:  0.0016067028045654297
local_in_edges_tensor generation:  0.0009598731994628906
mini_batch_src_global generation:  0.0017833709716796875
r_  generation:  0.021893739700317383
local_output_nid generation:  0.001592397689819336
local_in_edges_tensor generation:  0.0009355545043945312
mini_batch_src_global generation:  0.0017919540405273438
r_  generation:  0.02222442626953125
local_output_nid generation:  0.0015709400177001953
local_in_edges_tensor generation:  0.0009112358093261719
mini_batch_src_global generation:  0.0017580986022949219
r_  generation:  0.022124052047729492
local_output_nid generation:  0.0015938282012939453
local_in_edges_tensor generation:  0.0009276866912841797
mini_batch_src_global generation:  0.0017278194427490234
r_  generation:  0.021691083908081055
local_output_nid generation:  0.00157928466796875
local_in_edges_tensor generation:  0.0009179115295410156
mini_batch_src_global generation:  0.0017156600952148438
r_  generation:  0.021898269653320312
local_output_nid generation:  0.0015790462493896484
local_in_edges_tensor generation:  0.0009069442749023438
mini_batch_src_global generation:  0.0017650127410888672
r_  generation:  0.02252030372619629
local_output_nid generation:  0.0015926361083984375
local_in_edges_tensor generation:  0.0009303092956542969
mini_batch_src_global generation:  0.0017933845520019531
r_  generation:  0.022153854370117188
----------------------check_connections_block total spend ----------------------------- 0.5229077339172363
generate_one_block  0.02968311309814453
generate_one_block  0.0316009521484375
generate_one_block  0.03200984001159668
generate_one_block  0.03133821487426758
generate_one_block  0.03105640411376953
generate_one_block  0.03385567665100098
generate_one_block  0.031441450119018555
generate_one_block  0.03212714195251465
generate_one_block  0.03136324882507324
generate_one_block  0.031044483184814453
generate_one_block  0.03121471405029297
generate_one_block  0.031055688858032227
generate_one_block  0.030644893646240234
generate_one_block  0.030717134475708008
generate_one_block  0.03194165229797363
generate_one_block  0.03181910514831543
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03746986389160156
gen group dst list time:  0.01888751983642578
time for parepare:  0.0194246768951416
local_output_nid generation:  0.0073812007904052734
local_in_edges_tensor generation:  0.023804187774658203
mini_batch_src_global generation:  0.024451017379760742
r_  generation:  0.2460024356842041
local_output_nid generation:  0.011392831802368164
local_in_edges_tensor generation:  0.015165567398071289
mini_batch_src_global generation:  0.03356480598449707
r_  generation:  0.26389050483703613
local_output_nid generation:  0.012601375579833984
local_in_edges_tensor generation:  0.01624751091003418
mini_batch_src_global generation:  0.03235507011413574
r_  generation:  0.2759528160095215
local_output_nid generation:  0.012899637222290039
local_in_edges_tensor generation:  0.014293909072875977
mini_batch_src_global generation:  0.03419828414916992
r_  generation:  0.2713468074798584
local_output_nid generation:  0.012522220611572266
local_in_edges_tensor generation:  0.013503789901733398
mini_batch_src_global generation:  0.03311944007873535
r_  generation:  0.27431154251098633
local_output_nid generation:  0.013014078140258789
local_in_edges_tensor generation:  0.013779163360595703
mini_batch_src_global generation:  0.035355329513549805
r_  generation:  0.27991437911987305
local_output_nid generation:  0.013135910034179688
local_in_edges_tensor generation:  0.013564586639404297
mini_batch_src_global generation:  0.03382229804992676
r_  generation:  0.2732584476470947
local_output_nid generation:  0.013290882110595703
local_in_edges_tensor generation:  0.013962507247924805
mini_batch_src_global generation:  0.03438401222229004
r_  generation:  0.28053760528564453
local_output_nid generation:  0.013344287872314453
local_in_edges_tensor generation:  0.015964269638061523
mini_batch_src_global generation:  0.03428959846496582
r_  generation:  0.2794933319091797
local_output_nid generation:  0.01329183578491211
local_in_edges_tensor generation:  0.01739335060119629
mini_batch_src_global generation:  0.03396415710449219
r_  generation:  0.27493762969970703
local_output_nid generation:  0.01310276985168457
local_in_edges_tensor generation:  0.016199827194213867
mini_batch_src_global generation:  0.03399395942687988
r_  generation:  0.27654314041137695
local_output_nid generation:  0.014429092407226562
local_in_edges_tensor generation:  0.014651060104370117
mini_batch_src_global generation:  0.03544044494628906
r_  generation:  0.2766144275665283
local_output_nid generation:  0.012449026107788086
local_in_edges_tensor generation:  0.022946596145629883
mini_batch_src_global generation:  0.034865617752075195
r_  generation:  0.26909542083740234
local_output_nid generation:  0.013727903366088867
local_in_edges_tensor generation:  0.01813650131225586
mini_batch_src_global generation:  0.0356748104095459
r_  generation:  0.2730891704559326
local_output_nid generation:  0.012939929962158203
local_in_edges_tensor generation:  0.01734781265258789
mini_batch_src_global generation:  0.03458714485168457
r_  generation:  0.2918236255645752
local_output_nid generation:  0.015129327774047852
local_in_edges_tensor generation:  0.015094280242919922
mini_batch_src_global generation:  0.03499031066894531
r_  generation:  0.2776501178741455
----------------------check_connections_block total spend ----------------------------- 6.340762615203857
generate_one_block  0.3563215732574463
generate_one_block  0.37296605110168457
generate_one_block  0.3691737651824951
generate_one_block  0.35706424713134766
generate_one_block  0.3515493869781494
generate_one_block  0.36413097381591797
generate_one_block  0.3902430534362793
generate_one_block  0.35999631881713867
generate_one_block  0.35756468772888184
generate_one_block  0.35303187370300293
generate_one_block  0.34969544410705566
generate_one_block  0.3594784736633301
generate_one_block  0.34460878372192383
generate_one_block  0.35399580001831055
generate_one_block  0.36298418045043945
generate_one_block  0.3515431880950928
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04494667053222656
gen group dst list time:  0.06720733642578125
time for parepare:  0.019654512405395508
local_output_nid generation:  0.026961326599121094
local_in_edges_tensor generation:  0.05791664123535156
mini_batch_src_global generation:  0.05037236213684082
r_  generation:  0.5270049571990967
local_output_nid generation:  0.03374528884887695
local_in_edges_tensor generation:  0.04263591766357422
mini_batch_src_global generation:  0.06461596488952637
r_  generation:  0.5264432430267334
local_output_nid generation:  0.0334467887878418
local_in_edges_tensor generation:  0.034169912338256836
mini_batch_src_global generation:  0.05972719192504883
r_  generation:  0.5386035442352295
local_output_nid generation:  0.03347039222717285
local_in_edges_tensor generation:  0.03199577331542969
mini_batch_src_global generation:  0.0596613883972168
r_  generation:  0.5519750118255615
local_output_nid generation:  0.033690690994262695
local_in_edges_tensor generation:  0.08498072624206543
mini_batch_src_global generation:  0.06267476081848145
r_  generation:  0.5521097183227539
local_output_nid generation:  0.03289365768432617
local_in_edges_tensor generation:  0.03639984130859375
mini_batch_src_global generation:  0.06181001663208008
r_  generation:  0.5476069450378418
local_output_nid generation:  0.0330047607421875
local_in_edges_tensor generation:  0.03172588348388672
mini_batch_src_global generation:  0.06208395957946777
r_  generation:  0.5500967502593994
local_output_nid generation:  0.03309297561645508
local_in_edges_tensor generation:  0.03502845764160156
mini_batch_src_global generation:  0.06471419334411621
r_  generation:  0.5533082485198975
local_output_nid generation:  0.033046722412109375
local_in_edges_tensor generation:  0.034494876861572266
mini_batch_src_global generation:  0.06114530563354492
r_  generation:  0.5487997531890869
local_output_nid generation:  0.03297281265258789
local_in_edges_tensor generation:  0.03360152244567871
mini_batch_src_global generation:  0.06162524223327637
r_  generation:  0.5451381206512451
local_output_nid generation:  0.03283262252807617
local_in_edges_tensor generation:  0.036649465560913086
mini_batch_src_global generation:  0.06472301483154297
r_  generation:  0.5473744869232178
local_output_nid generation:  0.0327448844909668
local_in_edges_tensor generation:  0.03726625442504883
mini_batch_src_global generation:  0.06226968765258789
r_  generation:  0.5447988510131836
local_output_nid generation:  0.03525114059448242
local_in_edges_tensor generation:  0.03154158592224121
mini_batch_src_global generation:  0.06157231330871582
r_  generation:  0.5437140464782715
local_output_nid generation:  0.03559422492980957
local_in_edges_tensor generation:  0.03888058662414551
mini_batch_src_global generation:  0.06343984603881836
r_  generation:  0.544018030166626
local_output_nid generation:  0.036412954330444336
local_in_edges_tensor generation:  0.03680682182312012
mini_batch_src_global generation:  0.06389236450195312
r_  generation:  0.5531010627746582
local_output_nid generation:  0.034821271896362305
local_in_edges_tensor generation:  0.0368194580078125
mini_batch_src_global generation:  0.06458592414855957
r_  generation:  0.5497739315032959
----------------------check_connections_block total spend ----------------------------- 12.819268941879272
generate_one_block  0.6901628971099854
generate_one_block  0.6913633346557617
generate_one_block  0.6921472549438477
generate_one_block  0.6957817077636719
generate_one_block  0.689631462097168
generate_one_block  0.6927587985992432
generate_one_block  0.6808090209960938
generate_one_block  0.6907391548156738
generate_one_block  0.7214317321777344
generate_one_block  0.6938774585723877
generate_one_block  0.6862702369689941
generate_one_block  0.6766750812530518
generate_one_block  0.6800143718719482
generate_one_block  0.6797349452972412
generate_one_block  0.698706865310669
generate_one_block  0.678199052810669
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.12839365005493164  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

connection checking time:  19.16003155708313
block generation total time  16.792651176452637
average batch blocks generation time:  1.0495406985282898
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09952020645141602  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7642135620117188  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0998539924621582  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7729158401489258  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0999765396118164  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7814288139343262  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09992694854736328  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7771210670471191  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09961748123168945  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7726583480834961  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10005044937133789  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7813811302185059  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09970855712890625  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7694902420043945  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0998692512512207  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7803483009338379  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09977197647094727  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7706303596496582  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09963846206665039  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7728404998779297  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09967374801635742  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7723093032836914  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0996699333190918  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7680754661560059  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09938955307006836  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.764592170715332  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09963750839233398  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7699704170227051  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10083484649658203  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.781562328338623  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09969472885131836  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7690958976745605  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06963667273521423 |0.014868766069412231 |0.0036195069551467896 |9.15825366973877e-05 |0.003749847412109375 |0.001848459243774414 |
----------------------------------------------------------pseudo_mini_loss sum 1.9497761726379395
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  5329350
Number of first layer input nodes during this epoch:  2521290
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.12829971313476562  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024187088012695312
range selection method range initialization spend 0.012242794036865234
time for parepare:  0.018698692321777344
local_output_nid generation:  0.0014307498931884766
local_in_edges_tensor generation:  0.004789113998413086
mini_batch_src_global generation:  0.0017673969268798828
r_  generation:  0.020842790603637695
local_output_nid generation:  0.0016391277313232422
local_in_edges_tensor generation:  0.0010492801666259766
mini_batch_src_global generation:  0.0020749568939208984
r_  generation:  0.022836923599243164
local_output_nid generation:  0.001628875732421875
local_in_edges_tensor generation:  0.0009541511535644531
mini_batch_src_global generation:  0.0017213821411132812
r_  generation:  0.021848201751708984
local_output_nid generation:  0.0016205310821533203
local_in_edges_tensor generation:  0.0010449886322021484
mini_batch_src_global generation:  0.0017507076263427734
r_  generation:  0.021604537963867188
local_output_nid generation:  0.0015783309936523438
local_in_edges_tensor generation:  0.0009138584136962891
mini_batch_src_global generation:  0.0017201900482177734
r_  generation:  0.021767616271972656
local_output_nid generation:  0.0016012191772460938
local_in_edges_tensor generation:  0.0010149478912353516
mini_batch_src_global generation:  0.0017194747924804688
r_  generation:  0.02195119857788086
local_output_nid generation:  0.0015633106231689453
local_in_edges_tensor generation:  0.0010442733764648438
mini_batch_src_global generation:  0.0017459392547607422
r_  generation:  0.022353172302246094
local_output_nid generation:  0.0015904903411865234
local_in_edges_tensor generation:  0.0010271072387695312
mini_batch_src_global generation:  0.0017626285552978516
r_  generation:  0.022431612014770508
local_output_nid generation:  0.0016319751739501953
local_in_edges_tensor generation:  0.0010423660278320312
mini_batch_src_global generation:  0.001811981201171875
r_  generation:  0.022453784942626953
local_output_nid generation:  0.0016415119171142578
local_in_edges_tensor generation:  0.001035451889038086
mini_batch_src_global generation:  0.001810312271118164
r_  generation:  0.021879911422729492
local_output_nid generation:  0.0016410350799560547
local_in_edges_tensor generation:  0.0011570453643798828
mini_batch_src_global generation:  0.0018923282623291016
r_  generation:  0.022690773010253906
local_output_nid generation:  0.0016388893127441406
local_in_edges_tensor generation:  0.0010716915130615234
mini_batch_src_global generation:  0.001817464828491211
r_  generation:  0.022806882858276367
local_output_nid generation:  0.001638650894165039
local_in_edges_tensor generation:  0.001077890396118164
mini_batch_src_global generation:  0.0018231868743896484
r_  generation:  0.022550582885742188
local_output_nid generation:  0.0016391277313232422
local_in_edges_tensor generation:  0.0010833740234375
mini_batch_src_global generation:  0.0018286705017089844
r_  generation:  0.02222609519958496
local_output_nid generation:  0.001600027084350586
local_in_edges_tensor generation:  0.0010285377502441406
mini_batch_src_global generation:  0.0017960071563720703
r_  generation:  0.02230215072631836
local_output_nid generation:  0.0015971660614013672
local_in_edges_tensor generation:  0.001077413558959961
mini_batch_src_global generation:  0.0018079280853271484
r_  generation:  0.022074222564697266
----------------------check_connections_block total spend ----------------------------- 0.5289602279663086
generate_one_block  0.031168460845947266
generate_one_block  0.031923770904541016
generate_one_block  0.031208515167236328
generate_one_block  0.03127312660217285
generate_one_block  0.0308072566986084
generate_one_block  0.03258228302001953
generate_one_block  0.030966758728027344
generate_one_block  0.03229546546936035
generate_one_block  0.032517433166503906
generate_one_block  0.03072047233581543
generate_one_block  0.03157496452331543
generate_one_block  0.03112959861755371
generate_one_block  0.03153586387634277
generate_one_block  0.03148818016052246
generate_one_block  0.031831979751586914
generate_one_block  0.031154632568359375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04105949401855469
gen group dst list time:  0.018701791763305664
time for parepare:  0.019159555435180664
local_output_nid generation:  0.0075283050537109375
local_in_edges_tensor generation:  0.021682262420654297
mini_batch_src_global generation:  0.031290292739868164
r_  generation:  0.2472071647644043
local_output_nid generation:  0.012336969375610352
local_in_edges_tensor generation:  0.013585329055786133
mini_batch_src_global generation:  0.03643321990966797
r_  generation:  0.261141300201416
local_output_nid generation:  0.012247800827026367
local_in_edges_tensor generation:  0.015175342559814453
mini_batch_src_global generation:  0.03222966194152832
r_  generation:  0.2623329162597656
local_output_nid generation:  0.012737035751342773
local_in_edges_tensor generation:  0.013350963592529297
mini_batch_src_global generation:  0.032392024993896484
r_  generation:  0.27103734016418457
local_output_nid generation:  0.012848138809204102
local_in_edges_tensor generation:  0.013504981994628906
mini_batch_src_global generation:  0.03437018394470215
r_  generation:  0.26793622970581055
local_output_nid generation:  0.013266563415527344
local_in_edges_tensor generation:  0.01361227035522461
mini_batch_src_global generation:  0.03352928161621094
r_  generation:  0.27230000495910645
local_output_nid generation:  0.013318061828613281
local_in_edges_tensor generation:  0.018352985382080078
mini_batch_src_global generation:  0.03375434875488281
r_  generation:  0.27185726165771484
local_output_nid generation:  0.01335453987121582
local_in_edges_tensor generation:  0.014649629592895508
mini_batch_src_global generation:  0.034455060958862305
r_  generation:  0.27241086959838867
local_output_nid generation:  0.013651609420776367
local_in_edges_tensor generation:  0.01483774185180664
mini_batch_src_global generation:  0.035953521728515625
r_  generation:  0.2772510051727295
local_output_nid generation:  0.013242483139038086
local_in_edges_tensor generation:  0.016891956329345703
mini_batch_src_global generation:  0.033974647521972656
r_  generation:  0.2664155960083008
local_output_nid generation:  0.0137786865234375
local_in_edges_tensor generation:  0.013712406158447266
mini_batch_src_global generation:  0.034445762634277344
r_  generation:  0.2836573123931885
local_output_nid generation:  0.013637542724609375
local_in_edges_tensor generation:  0.015046358108520508
mini_batch_src_global generation:  0.03444981575012207
r_  generation:  0.2730381488800049
local_output_nid generation:  0.013330936431884766
local_in_edges_tensor generation:  0.014960289001464844
mini_batch_src_global generation:  0.034450531005859375
r_  generation:  0.27757811546325684
local_output_nid generation:  0.012904644012451172
local_in_edges_tensor generation:  0.013925313949584961
mini_batch_src_global generation:  0.03483891487121582
r_  generation:  0.2723984718322754
local_output_nid generation:  0.013117551803588867
local_in_edges_tensor generation:  0.014110088348388672
mini_batch_src_global generation:  0.03551745414733887
r_  generation:  0.2810709476470947
local_output_nid generation:  0.012808084487915039
local_in_edges_tensor generation:  0.014027118682861328
mini_batch_src_global generation:  0.03726482391357422
r_  generation:  0.26900601387023926
----------------------check_connections_block total spend ----------------------------- 6.26666259765625
generate_one_block  0.3530440330505371
generate_one_block  0.35257887840270996
generate_one_block  0.34613823890686035
generate_one_block  0.35106658935546875
generate_one_block  0.3461265563964844
generate_one_block  0.3474569320678711
generate_one_block  0.37514734268188477
generate_one_block  0.3572824001312256
generate_one_block  0.3588371276855469
generate_one_block  0.3412752151489258
generate_one_block  0.35405707359313965
generate_one_block  0.3464338779449463
generate_one_block  0.35306262969970703
generate_one_block  0.34509992599487305
generate_one_block  0.3549792766571045
generate_one_block  0.33949756622314453
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04200935363769531
gen group dst list time:  0.06632804870605469
time for parepare:  0.017095565795898438
local_output_nid generation:  0.025350093841552734
local_in_edges_tensor generation:  0.04637742042541504
mini_batch_src_global generation:  0.04928898811340332
r_  generation:  0.5266976356506348
local_output_nid generation:  0.030504226684570312
local_in_edges_tensor generation:  0.04116225242614746
mini_batch_src_global generation:  0.0623931884765625
r_  generation:  0.5214037895202637
local_output_nid generation:  0.03082561492919922
local_in_edges_tensor generation:  0.036339759826660156
mini_batch_src_global generation:  0.059324026107788086
r_  generation:  0.5461082458496094
local_output_nid generation:  0.03169560432434082
local_in_edges_tensor generation:  0.039871931076049805
mini_batch_src_global generation:  0.06063508987426758
r_  generation:  0.5355195999145508
local_output_nid generation:  0.03168988227844238
local_in_edges_tensor generation:  0.0792229175567627
mini_batch_src_global generation:  0.06116485595703125
r_  generation:  0.5503525733947754
local_output_nid generation:  0.03199434280395508
local_in_edges_tensor generation:  0.031228303909301758
mini_batch_src_global generation:  0.06512713432312012
r_  generation:  0.5447633266448975
local_output_nid generation:  0.03191494941711426
local_in_edges_tensor generation:  0.03580188751220703
mini_batch_src_global generation:  0.06186962127685547
r_  generation:  0.5518338680267334
local_output_nid generation:  0.03222322463989258
local_in_edges_tensor generation:  0.033792734146118164
mini_batch_src_global generation:  0.06495499610900879
r_  generation:  0.5449235439300537
local_output_nid generation:  0.03222846984863281
local_in_edges_tensor generation:  0.03232765197753906
mini_batch_src_global generation:  0.06198549270629883
r_  generation:  0.5573899745941162
local_output_nid generation:  0.032326698303222656
local_in_edges_tensor generation:  0.03608131408691406
mini_batch_src_global generation:  0.07304096221923828
r_  generation:  0.5434854030609131
local_output_nid generation:  0.0327303409576416
local_in_edges_tensor generation:  0.03997397422790527
mini_batch_src_global generation:  0.06492304801940918
r_  generation:  0.5467362403869629
local_output_nid generation:  0.032559871673583984
local_in_edges_tensor generation:  0.040003061294555664
mini_batch_src_global generation:  0.06276273727416992
r_  generation:  0.5410780906677246
local_output_nid generation:  0.032509565353393555
local_in_edges_tensor generation:  0.03257155418395996
mini_batch_src_global generation:  0.06266522407531738
r_  generation:  0.5454390048980713
local_output_nid generation:  0.032254934310913086
local_in_edges_tensor generation:  0.03229022026062012
mini_batch_src_global generation:  0.06318354606628418
r_  generation:  0.5493695735931396
local_output_nid generation:  0.0325469970703125
local_in_edges_tensor generation:  0.03231453895568848
mini_batch_src_global generation:  0.062486886978149414
r_  generation:  0.5452015399932861
local_output_nid generation:  0.03274416923522949
local_in_edges_tensor generation:  0.04100394248962402
mini_batch_src_global generation:  0.06576275825500488
r_  generation:  0.5523529052734375
----------------------check_connections_block total spend ----------------------------- 12.775500774383545
generate_one_block  0.6791315078735352
generate_one_block  0.6818516254425049
generate_one_block  0.6849000453948975
generate_one_block  0.6909680366516113
generate_one_block  0.6851999759674072
generate_one_block  0.691875696182251
generate_one_block  0.6853542327880859
generate_one_block  0.6831984519958496
generate_one_block  0.747901439666748
generate_one_block  0.6842989921569824
generate_one_block  0.6896235942840576
generate_one_block  0.6761767864227295
generate_one_block  0.6872434616088867
generate_one_block  0.6777293682098389
generate_one_block  0.708371639251709
generate_one_block  0.6897194385528564
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.12829971313476562  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

connection checking time:  19.042163372039795
block generation total time  16.66562795639038
average batch blocks generation time:  1.0416017472743988
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09968948364257812  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7691388130187988  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09987115859985352  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.775977611541748  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09973430633544922  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7722549438476562  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09981679916381836  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.776158332824707  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09970760345458984  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7711119651794434  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09972047805786133  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7721714973449707  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10080623626708984  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7721037864685059  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09979438781738281  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7717561721801758  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09977149963378906  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7717304229736328  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09960746765136719  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7662196159362793  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09981822967529297  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7758708000183105  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09982442855834961  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.772613525390625  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0998849868774414  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7806544303894043  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09981918334960938  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7707548141479492  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10091114044189453  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7817602157592773  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09966421127319336  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7725872993469238  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06293979287147522 |0.016978904604911804 |0.0037822723388671875 |9.860098361968994e-05 |0.0030534863471984863 |0.0019750595092773438 |
----------------------------------------------------------pseudo_mini_loss sum 1.8668479919433594
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  5331825
Number of first layer input nodes during this epoch:  2522048
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.12712955474853516  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023528099060058594
range selection method range initialization spend 0.012335062026977539
time for parepare:  0.018435955047607422
local_output_nid generation:  0.0014328956604003906
local_in_edges_tensor generation:  0.00411534309387207
mini_batch_src_global generation:  0.0021924972534179688
r_  generation:  0.021342754364013672
local_output_nid generation:  0.0016989707946777344
local_in_edges_tensor generation:  0.0010344982147216797
mini_batch_src_global generation:  0.0023288726806640625
r_  generation:  0.022109270095825195
local_output_nid generation:  0.0016069412231445312
local_in_edges_tensor generation:  0.0009667873382568359
mini_batch_src_global generation:  0.0016696453094482422
r_  generation:  0.02199721336364746
local_output_nid generation:  0.0016720294952392578
local_in_edges_tensor generation:  0.0009300708770751953
mini_batch_src_global generation:  0.0017249584197998047
r_  generation:  0.02094411849975586
local_output_nid generation:  0.0015900135040283203
local_in_edges_tensor generation:  0.0009350776672363281
mini_batch_src_global generation:  0.0017192363739013672
r_  generation:  0.02235698699951172
local_output_nid generation:  0.0015895366668701172
local_in_edges_tensor generation:  0.0009253025054931641
mini_batch_src_global generation:  0.0017547607421875
r_  generation:  0.0215911865234375
local_output_nid generation:  0.0015997886657714844
local_in_edges_tensor generation:  0.0009198188781738281
mini_batch_src_global generation:  0.001802682876586914
r_  generation:  0.02310776710510254
local_output_nid generation:  0.001598358154296875
local_in_edges_tensor generation:  0.00093841552734375
mini_batch_src_global generation:  0.0017592906951904297
r_  generation:  0.022136926651000977
local_output_nid generation:  0.001577138900756836
local_in_edges_tensor generation:  0.0010313987731933594
mini_batch_src_global generation:  0.0017940998077392578
r_  generation:  0.023045778274536133
local_output_nid generation:  0.0016074180603027344
local_in_edges_tensor generation:  0.0009524822235107422
mini_batch_src_global generation:  0.0018227100372314453
r_  generation:  0.022226810455322266
local_output_nid generation:  0.0016448497772216797
local_in_edges_tensor generation:  0.0009293556213378906
mini_batch_src_global generation:  0.0018236637115478516
r_  generation:  0.023153305053710938
local_output_nid generation:  0.0016019344329833984
local_in_edges_tensor generation:  0.0009260177612304688
mini_batch_src_global generation:  0.0017745494842529297
r_  generation:  0.022492408752441406
local_output_nid generation:  0.001575469970703125
local_in_edges_tensor generation:  0.0009043216705322266
mini_batch_src_global generation:  0.0017399787902832031
r_  generation:  0.022752761840820312
local_output_nid generation:  0.0015714168548583984
local_in_edges_tensor generation:  0.0009136199951171875
mini_batch_src_global generation:  0.0017845630645751953
r_  generation:  0.022754907608032227
local_output_nid generation:  0.0015871524810791016
local_in_edges_tensor generation:  0.0008864402770996094
mini_batch_src_global generation:  0.001734018325805664
r_  generation:  0.02213883399963379
local_output_nid generation:  0.001583099365234375
local_in_edges_tensor generation:  0.0008876323699951172
mini_batch_src_global generation:  0.001802682876586914
r_  generation:  0.03809857368469238
----------------------check_connections_block total spend ----------------------------- 0.5437138080596924
generate_one_block  0.04666638374328613
generate_one_block  0.03174614906311035
generate_one_block  0.0310213565826416
generate_one_block  0.030637264251708984
generate_one_block  0.031085729598999023
generate_one_block  0.03217768669128418
generate_one_block  0.031793832778930664
generate_one_block  0.031239032745361328
generate_one_block  0.03194570541381836
generate_one_block  0.031134605407714844
generate_one_block  0.03180098533630371
generate_one_block  0.0314023494720459
generate_one_block  0.03152799606323242
generate_one_block  0.03166484832763672
generate_one_block  0.030652284622192383
generate_one_block  0.03190946578979492
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.032834529876708984
gen group dst list time:  0.0191805362701416
time for parepare:  0.019938230514526367
local_output_nid generation:  0.007668495178222656
local_in_edges_tensor generation:  0.019463777542114258
mini_batch_src_global generation:  0.026600122451782227
r_  generation:  0.2558004856109619
local_output_nid generation:  0.011166572570800781
local_in_edges_tensor generation:  0.0168764591217041
mini_batch_src_global generation:  0.03208112716674805
r_  generation:  0.2581593990325928
local_output_nid generation:  0.012134313583374023
local_in_edges_tensor generation:  0.013805866241455078
mini_batch_src_global generation:  0.03281855583190918
r_  generation:  0.26588964462280273
local_output_nid generation:  0.012242317199707031
local_in_edges_tensor generation:  0.013989448547363281
mini_batch_src_global generation:  0.031764984130859375
r_  generation:  0.2628750801086426
local_output_nid generation:  0.012236595153808594
local_in_edges_tensor generation:  0.012941360473632812
mini_batch_src_global generation:  0.0342559814453125
r_  generation:  0.2695329189300537
local_output_nid generation:  0.01267552375793457
local_in_edges_tensor generation:  0.013765335083007812
mini_batch_src_global generation:  0.03339791297912598
r_  generation:  0.26801395416259766
local_output_nid generation:  0.013087987899780273
local_in_edges_tensor generation:  0.014162302017211914
mini_batch_src_global generation:  0.035718679428100586
r_  generation:  0.27705931663513184
local_output_nid generation:  0.013186216354370117
local_in_edges_tensor generation:  0.013234615325927734
mini_batch_src_global generation:  0.033788442611694336
r_  generation:  0.2717263698577881
local_output_nid generation:  0.01494598388671875
local_in_edges_tensor generation:  0.01310873031616211
mini_batch_src_global generation:  0.035883188247680664
r_  generation:  0.2819859981536865
local_output_nid generation:  0.013238668441772461
local_in_edges_tensor generation:  0.016718387603759766
mini_batch_src_global generation:  0.034651756286621094
r_  generation:  0.28279638290405273
local_output_nid generation:  0.013646125793457031
local_in_edges_tensor generation:  0.016714811325073242
mini_batch_src_global generation:  0.03890538215637207
r_  generation:  0.2894144058227539
local_output_nid generation:  0.01423501968383789
local_in_edges_tensor generation:  0.018839359283447266
mini_batch_src_global generation:  0.037366390228271484
r_  generation:  0.28121232986450195
local_output_nid generation:  0.013501644134521484
local_in_edges_tensor generation:  0.015107393264770508
mini_batch_src_global generation:  0.03652596473693848
r_  generation:  0.2893710136413574
local_output_nid generation:  0.012839078903198242
local_in_edges_tensor generation:  0.015949249267578125
mini_batch_src_global generation:  0.03626275062561035
r_  generation:  0.27857112884521484
local_output_nid generation:  0.013857364654541016
local_in_edges_tensor generation:  0.016407012939453125
mini_batch_src_global generation:  0.034584999084472656
r_  generation:  0.2676393985748291
local_output_nid generation:  0.013228178024291992
local_in_edges_tensor generation:  0.01367950439453125
mini_batch_src_global generation:  0.03439736366271973
r_  generation:  0.2771632671356201
----------------------check_connections_block total spend ----------------------------- 6.346872091293335
generate_one_block  0.36259007453918457
generate_one_block  0.3467681407928467
generate_one_block  0.35480546951293945
generate_one_block  0.34342408180236816
generate_one_block  0.349606990814209
generate_one_block  0.34729695320129395
generate_one_block  0.39114999771118164
generate_one_block  0.3600602149963379
generate_one_block  0.36687564849853516
generate_one_block  0.35610175132751465
generate_one_block  0.36748170852661133
generate_one_block  0.3557441234588623
generate_one_block  0.359602689743042
generate_one_block  0.35623598098754883
generate_one_block  0.35041165351867676
generate_one_block  0.3561427593231201
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0411221981048584
gen group dst list time:  0.07606220245361328
time for parepare:  0.019649267196655273
local_output_nid generation:  0.02786731719970703
local_in_edges_tensor generation:  0.05715346336364746
mini_batch_src_global generation:  0.04865884780883789
r_  generation:  0.5325660705566406
local_output_nid generation:  0.0319371223449707
local_in_edges_tensor generation:  0.04179549217224121
mini_batch_src_global generation:  0.06218528747558594
r_  generation:  0.5235183238983154
local_output_nid generation:  0.03216838836669922
local_in_edges_tensor generation:  0.033091068267822266
mini_batch_src_global generation:  0.061852455139160156
r_  generation:  0.5343682765960693
local_output_nid generation:  0.0328671932220459
local_in_edges_tensor generation:  0.0320286750793457
mini_batch_src_global generation:  0.060099124908447266
r_  generation:  0.5413622856140137
local_output_nid generation:  0.032488346099853516
local_in_edges_tensor generation:  0.08690571784973145
mini_batch_src_global generation:  0.062114715576171875
r_  generation:  0.5425376892089844
local_output_nid generation:  0.03226137161254883
local_in_edges_tensor generation:  0.03305554389953613
mini_batch_src_global generation:  0.06130862236022949
r_  generation:  0.5437710285186768
local_output_nid generation:  0.03267097473144531
local_in_edges_tensor generation:  0.04263949394226074
mini_batch_src_global generation:  0.06490087509155273
r_  generation:  0.5492696762084961
local_output_nid generation:  0.03298664093017578
local_in_edges_tensor generation:  0.03964352607727051
mini_batch_src_global generation:  0.06233787536621094
r_  generation:  0.5441854000091553
local_output_nid generation:  0.03359270095825195
local_in_edges_tensor generation:  0.035027265548706055
mini_batch_src_global generation:  0.06181645393371582
r_  generation:  0.5488853454589844
local_output_nid generation:  0.032704830169677734
local_in_edges_tensor generation:  0.03429388999938965
mini_batch_src_global generation:  0.06188678741455078
r_  generation:  0.5511503219604492
local_output_nid generation:  0.03308534622192383
local_in_edges_tensor generation:  0.03502655029296875
mini_batch_src_global generation:  0.0650339126586914
r_  generation:  0.5570876598358154
local_output_nid generation:  0.03286290168762207
local_in_edges_tensor generation:  0.035610198974609375
mini_batch_src_global generation:  0.06648850440979004
r_  generation:  0.5647714138031006
local_output_nid generation:  0.03497505187988281
local_in_edges_tensor generation:  0.04029583930969238
mini_batch_src_global generation:  0.07015514373779297
r_  generation:  0.553887128829956
local_output_nid generation:  0.03496718406677246
local_in_edges_tensor generation:  0.04184365272521973
mini_batch_src_global generation:  0.07979416847229004
r_  generation:  0.5425264835357666
local_output_nid generation:  0.033648014068603516
local_in_edges_tensor generation:  0.035515785217285156
mini_batch_src_global generation:  0.06136727333068848
r_  generation:  0.5429856777191162
local_output_nid generation:  0.034085750579833984
local_in_edges_tensor generation:  0.03450822830200195
mini_batch_src_global generation:  0.06499838829040527
r_  generation:  0.5428206920623779
----------------------check_connections_block total spend ----------------------------- 12.86016583442688
generate_one_block  0.6935703754425049
generate_one_block  0.6872167587280273
generate_one_block  0.6860778331756592
generate_one_block  0.6852340698242188
generate_one_block  0.686835765838623
generate_one_block  0.6881442070007324
generate_one_block  0.6873219013214111
generate_one_block  0.6927456855773926
generate_one_block  0.7162327766418457
generate_one_block  0.685936689376831
generate_one_block  0.6889746189117432
generate_one_block  0.6811904907226562
generate_one_block  0.6886065006256104
generate_one_block  0.6816108226776123
generate_one_block  0.6927340030670166
generate_one_block  0.7010881900787354
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.12712955474853516  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

connection checking time:  19.207037925720215
block generation total time  16.767818927764893
average batch blocks generation time:  1.0479886829853058
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0998544692993164  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7729344367980957  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0998373031616211  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7694029808044434  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09974861145019531  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7699570655822754  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09958124160766602  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7663164138793945  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0997161865234375  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7714872360229492  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.099700927734375  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7675189971923828  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09988927841186523  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7763171195983887  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0996861457824707  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7738518714904785  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09993600845336914  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7770013809204102  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09988260269165039  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7720475196838379  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10099983215332031  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7825980186462402  GigaBytes
Max Memory Allocated: 0.8706183433532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09975957870483398  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7714447975158691  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.1009073257446289  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7820191383361816  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09977483749389648  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7765536308288574  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09965896606445312  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7675232887268066  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09988927841186523  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7796831130981445  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06976191699504852 |0.018030643463134766 |0.0035216808319091797 |9.176135063171387e-05 |0.003701135516166687 |0.001922607421875 |
----------------------------------------------------------pseudo_mini_loss sum 1.7852091789245605
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  5333089
Number of first layer input nodes during this epoch:  2522542
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.12864160537719727  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02692723274230957
range selection method range initialization spend 0.012253761291503906
time for parepare:  0.01684093475341797
local_output_nid generation:  0.0014090538024902344
local_in_edges_tensor generation:  0.0069429874420166016
mini_batch_src_global generation:  0.0017142295837402344
r_  generation:  0.020520687103271484
local_output_nid generation:  0.0016245841979980469
local_in_edges_tensor generation:  0.0010173320770263672
mini_batch_src_global generation:  0.0020236968994140625
r_  generation:  0.022825241088867188
local_output_nid generation:  0.0015673637390136719
local_in_edges_tensor generation:  0.0009417533874511719
mini_batch_src_global generation:  0.0016922950744628906
r_  generation:  0.02103424072265625
local_output_nid generation:  0.0015759468078613281
local_in_edges_tensor generation:  0.0009200572967529297
mini_batch_src_global generation:  0.0017275810241699219
r_  generation:  0.025636672973632812
local_output_nid generation:  0.0015959739685058594
local_in_edges_tensor generation:  0.0009763240814208984
mini_batch_src_global generation:  0.0017459392547607422
r_  generation:  0.022309064865112305
local_output_nid generation:  0.0016324520111083984
local_in_edges_tensor generation:  0.0010025501251220703
mini_batch_src_global generation:  0.0017693042755126953
r_  generation:  0.022325754165649414
local_output_nid generation:  0.0017056465148925781
local_in_edges_tensor generation:  0.0009443759918212891
mini_batch_src_global generation:  0.0017764568328857422
r_  generation:  0.022674560546875
local_output_nid generation:  0.0016515254974365234
local_in_edges_tensor generation:  0.0009508132934570312
mini_batch_src_global generation:  0.0017549991607666016
r_  generation:  0.022271394729614258
local_output_nid generation:  0.0016515254974365234
local_in_edges_tensor generation:  0.000942230224609375
mini_batch_src_global generation:  0.0018222332000732422
r_  generation:  0.022151470184326172
local_output_nid generation:  0.0016622543334960938
local_in_edges_tensor generation:  0.0009243488311767578
mini_batch_src_global generation:  0.0017502307891845703
r_  generation:  0.02215719223022461
local_output_nid generation:  0.0016279220581054688
local_in_edges_tensor generation:  0.0009033679962158203
mini_batch_src_global generation:  0.0017533302307128906
r_  generation:  0.022317886352539062
local_output_nid generation:  0.0016036033630371094
local_in_edges_tensor generation:  0.0009205341339111328
mini_batch_src_global generation:  0.0017552375793457031
r_  generation:  0.022495031356811523
local_output_nid generation:  0.0016248226165771484
local_in_edges_tensor generation:  0.0009479522705078125
mini_batch_src_global generation:  0.0017502307891845703
r_  generation:  0.022055864334106445
local_output_nid generation:  0.001787424087524414
local_in_edges_tensor generation:  0.0009300708770751953
mini_batch_src_global generation:  0.0017726421356201172
r_  generation:  0.02244114875793457
local_output_nid generation:  0.0016107559204101562
local_in_edges_tensor generation:  0.0009145736694335938
mini_batch_src_global generation:  0.0018477439880371094
r_  generation:  0.02257370948791504
local_output_nid generation:  0.0016160011291503906
local_in_edges_tensor generation:  0.0009224414825439453
mini_batch_src_global generation:  0.0018153190612792969
r_  generation:  0.022404909133911133
----------------------check_connections_block total spend ----------------------------- 0.5293469429016113
generate_one_block  0.03011798858642578
generate_one_block  0.03177928924560547
generate_one_block  0.030611038208007812
generate_one_block  0.03128218650817871
generate_one_block  0.031703948974609375
generate_one_block  0.0330355167388916
generate_one_block  0.0316157341003418
generate_one_block  0.03143739700317383
generate_one_block  0.03135108947753906
generate_one_block  0.03067803382873535
generate_one_block  0.031003475189208984
generate_one_block  0.03138422966003418
generate_one_block  0.031229734420776367
generate_one_block  0.03415346145629883
generate_one_block  0.0324397087097168
generate_one_block  0.031812429428100586
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04950118064880371
gen group dst list time:  0.02044367790222168
time for parepare:  0.0195004940032959
local_output_nid generation:  0.00751948356628418
local_in_edges_tensor generation:  0.025844335556030273
mini_batch_src_global generation:  0.025925159454345703
r_  generation:  0.24833393096923828
local_output_nid generation:  0.01118326187133789
local_in_edges_tensor generation:  0.01408076286315918
mini_batch_src_global generation:  0.03254580497741699
r_  generation:  0.2681403160095215
local_output_nid generation:  0.011240243911743164
local_in_edges_tensor generation:  0.013098001480102539
mini_batch_src_global generation:  0.03198122978210449
r_  generation:  0.2598757743835449
local_output_nid generation:  0.012189149856567383
local_in_edges_tensor generation:  0.016520023345947266
mini_batch_src_global generation:  0.03197336196899414
r_  generation:  0.2691950798034668
local_output_nid generation:  0.012961387634277344
local_in_edges_tensor generation:  0.013811349868774414
mini_batch_src_global generation:  0.0350339412689209
r_  generation:  0.28385376930236816
local_output_nid generation:  0.012656688690185547
local_in_edges_tensor generation:  0.017558574676513672
mini_batch_src_global generation:  0.03567051887512207
r_  generation:  0.2811710834503174
local_output_nid generation:  0.012880325317382812
local_in_edges_tensor generation:  0.01368260383605957
mini_batch_src_global generation:  0.034543752670288086
r_  generation:  0.2765805721282959
local_output_nid generation:  0.013033390045166016
local_in_edges_tensor generation:  0.013771772384643555
mini_batch_src_global generation:  0.03422260284423828
r_  generation:  0.2740323543548584
local_output_nid generation:  0.0130157470703125
local_in_edges_tensor generation:  0.013967514038085938
mini_batch_src_global generation:  0.036607980728149414
r_  generation:  0.2778604030609131
local_output_nid generation:  0.012941360473632812
local_in_edges_tensor generation:  0.014956951141357422
mini_batch_src_global generation:  0.035893917083740234
r_  generation:  0.2725379467010498
local_output_nid generation:  0.01332545280456543
local_in_edges_tensor generation:  0.014078617095947266
mini_batch_src_global generation:  0.03420376777648926
r_  generation:  0.2790853977203369
local_output_nid generation:  0.013275861740112305
local_in_edges_tensor generation:  0.01629352569580078
mini_batch_src_global generation:  0.03498411178588867
r_  generation:  0.28162097930908203
local_output_nid generation:  0.013045072555541992
local_in_edges_tensor generation:  0.01727914810180664
mini_batch_src_global generation:  0.034235239028930664
r_  generation:  0.273622989654541
local_output_nid generation:  0.012740373611450195
local_in_edges_tensor generation:  0.013963460922241211
mini_batch_src_global generation:  0.03489971160888672
r_  generation:  0.2813727855682373
local_output_nid generation:  0.012720108032226562
local_in_edges_tensor generation:  0.01652979850769043
mini_batch_src_global generation:  0.035152435302734375
r_  generation:  0.2854793071746826
local_output_nid generation:  0.012756586074829102
local_in_edges_tensor generation:  0.015115737915039062
mini_batch_src_global generation:  0.035639047622680664
r_  generation:  0.2809603214263916
----------------------check_connections_block total spend ----------------------------- 6.3335161209106445
generate_one_block  0.350283145904541
generate_one_block  0.3497304916381836
generate_one_block  0.33646464347839355
generate_one_block  0.34708333015441895
generate_one_block  0.3552744388580322
generate_one_block  0.3580138683319092
generate_one_block  0.37508106231689453
generate_one_block  0.34642958641052246
generate_one_block  0.3470039367675781
generate_one_block  0.33814239501953125
generate_one_block  0.35137200355529785
generate_one_block  0.36093759536743164
generate_one_block  0.34409332275390625
generate_one_block  0.3509359359741211
generate_one_block  0.36115002632141113
generate_one_block  0.3555276393890381
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03595232963562012
gen group dst list time:  0.06446242332458496
time for parepare:  0.017217636108398438
local_output_nid generation:  0.02492666244506836
local_in_edges_tensor generation:  0.03951072692871094
mini_batch_src_global generation:  0.04832744598388672
r_  generation:  0.5259337425231934
local_output_nid generation:  0.030812740325927734
local_in_edges_tensor generation:  0.03790450096130371
mini_batch_src_global generation:  0.06461596488952637
r_  generation:  0.526115894317627
local_output_nid generation:  0.030983924865722656
local_in_edges_tensor generation:  0.03401446342468262
mini_batch_src_global generation:  0.059998512268066406
r_  generation:  0.5365869998931885
local_output_nid generation:  0.031528472900390625
local_in_edges_tensor generation:  0.03205227851867676
mini_batch_src_global generation:  0.059671878814697266
r_  generation:  0.5437686443328857
local_output_nid generation:  0.03202247619628906
local_in_edges_tensor generation:  0.07978153228759766
mini_batch_src_global generation:  0.06302618980407715
r_  generation:  0.5465712547302246
local_output_nid generation:  0.031913042068481445
local_in_edges_tensor generation:  0.03406786918640137
mini_batch_src_global generation:  0.061678409576416016
r_  generation:  0.5497174263000488
local_output_nid generation:  0.032904863357543945
local_in_edges_tensor generation:  0.042281389236450195
mini_batch_src_global generation:  0.06375598907470703
r_  generation:  0.5464584827423096
local_output_nid generation:  0.032293081283569336
local_in_edges_tensor generation:  0.03241586685180664
mini_batch_src_global generation:  0.06177806854248047
r_  generation:  0.550100564956665
local_output_nid generation:  0.03283095359802246
local_in_edges_tensor generation:  0.039231061935424805
mini_batch_src_global generation:  0.06170797348022461
r_  generation:  0.5496039390563965
local_output_nid generation:  0.03282475471496582
local_in_edges_tensor generation:  0.034873008728027344
mini_batch_src_global generation:  0.06227540969848633
r_  generation:  0.5519552230834961
local_output_nid generation:  0.03246307373046875
local_in_edges_tensor generation:  0.03255128860473633
mini_batch_src_global generation:  0.060957908630371094
r_  generation:  0.5495128631591797
local_output_nid generation:  0.032280921936035156
local_in_edges_tensor generation:  0.03220701217651367
mini_batch_src_global generation:  0.06165933609008789
r_  generation:  0.5494132041931152
local_output_nid generation:  0.03239798545837402
local_in_edges_tensor generation:  0.03745865821838379
mini_batch_src_global generation:  0.06392717361450195
r_  generation:  0.5462334156036377
local_output_nid generation:  0.0322728157043457
local_in_edges_tensor generation:  0.03523659706115723
mini_batch_src_global generation:  0.062744140625
r_  generation:  0.5499782562255859
local_output_nid generation:  0.03285694122314453
local_in_edges_tensor generation:  0.03668713569641113
mini_batch_src_global generation:  0.06385517120361328
r_  generation:  0.5467779636383057
local_output_nid generation:  0.03266119956970215
local_in_edges_tensor generation:  0.03222084045410156
mini_batch_src_global generation:  0.0620729923248291
r_  generation:  0.5521104335784912
----------------------check_connections_block total spend ----------------------------- 12.756601095199585
generate_one_block  0.6749465465545654
generate_one_block  0.6768805980682373
generate_one_block  0.6897759437561035
generate_one_block  0.6731545925140381
generate_one_block  0.7057497501373291
generate_one_block  0.6882250308990479
generate_one_block  0.6811461448669434
generate_one_block  0.675663948059082
generate_one_block  0.7726974487304688
generate_one_block  0.6825716495513916
generate_one_block  0.6747281551361084
generate_one_block  0.6912188529968262
generate_one_block  0.6802060604095459
generate_one_block  0.6833734512329102
generate_one_block  0.6986680030822754
generate_one_block  0.735572338104248
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.12864160537719727  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

connection checking time:  19.09011721611023
block generation total time  16.712101936340332
average batch blocks generation time:  1.0445063710212708
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09956979751586914  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7649192810058594  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09984588623046875  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7771611213684082  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10053348541259766  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7681403160095215  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09959745407104492  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7681732177734375  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10088539123535156  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7820067405700684  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10003519058227539  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7779445648193359  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09973001480102539  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7720561027526855  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09975957870483398  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7720494270324707  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09978294372558594  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7744235992431641  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09958457946777344  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7681331634521484  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0998072624206543  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7709646224975586  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09987640380859375  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7741680145263672  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10069465637207031  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7713990211486816  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09987878799438477  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7733750343322754  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10097789764404297  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7825889587402344  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10003805160522461  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7808847427368164  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0648258626461029 |0.016037821769714355 |0.0034821927547454834 |9.267032146453857e-05 |0.003140673041343689 |0.0017673969268798828 |
----------------------------------------------------------pseudo_mini_loss sum 1.6957659721374512
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  5332870
Number of first layer input nodes during this epoch:  2522496
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.1297159194946289  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025682687759399414
range selection method range initialization spend 0.016062498092651367
time for parepare:  0.01923656463623047
local_output_nid generation:  0.0014595985412597656
local_in_edges_tensor generation:  0.004912614822387695
mini_batch_src_global generation:  0.003505706787109375
r_  generation:  0.024709701538085938
local_output_nid generation:  0.0032944679260253906
local_in_edges_tensor generation:  0.001966714859008789
mini_batch_src_global generation:  0.005327701568603516
r_  generation:  0.02639007568359375
local_output_nid generation:  0.0015361309051513672
local_in_edges_tensor generation:  0.0009357929229736328
mini_batch_src_global generation:  0.0021822452545166016
r_  generation:  0.03677201271057129
local_output_nid generation:  0.0020978450775146484
local_in_edges_tensor generation:  0.0012106895446777344
mini_batch_src_global generation:  0.0020513534545898438
r_  generation:  0.022580623626708984
local_output_nid generation:  0.001984119415283203
local_in_edges_tensor generation:  0.0010728836059570312
mini_batch_src_global generation:  0.001871347427368164
r_  generation:  0.022490978240966797
local_output_nid generation:  0.002138376235961914
local_in_edges_tensor generation:  0.0011162757873535156
mini_batch_src_global generation:  0.0019001960754394531
r_  generation:  0.021920204162597656
local_output_nid generation:  0.001949310302734375
local_in_edges_tensor generation:  0.001073598861694336
mini_batch_src_global generation:  0.001960277557373047
r_  generation:  0.022743940353393555
local_output_nid generation:  0.0020067691802978516
local_in_edges_tensor generation:  0.0010650157928466797
mini_batch_src_global generation:  0.0019030570983886719
r_  generation:  0.022124052047729492
local_output_nid generation:  0.0019099712371826172
local_in_edges_tensor generation:  0.0010745525360107422
mini_batch_src_global generation:  0.002048969268798828
r_  generation:  0.021552324295043945
local_output_nid generation:  0.0019245147705078125
local_in_edges_tensor generation:  0.0010211467742919922
mini_batch_src_global generation:  0.0018353462219238281
r_  generation:  0.02243971824645996
local_output_nid generation:  0.0019481182098388672
local_in_edges_tensor generation:  0.0010426044464111328
mini_batch_src_global generation:  0.009170293807983398
r_  generation:  0.021638154983520508
local_output_nid generation:  0.0019118785858154297
local_in_edges_tensor generation:  0.0010428428649902344
mini_batch_src_global generation:  0.0018846988677978516
r_  generation:  0.022799968719482422
local_output_nid generation:  0.0018935203552246094
local_in_edges_tensor generation:  0.0010399818420410156
mini_batch_src_global generation:  0.0018889904022216797
r_  generation:  0.02223801612854004
local_output_nid generation:  0.0019254684448242188
local_in_edges_tensor generation:  0.0010302066802978516
mini_batch_src_global generation:  0.0018265247344970703
r_  generation:  0.021973133087158203
local_output_nid generation:  0.0018765926361083984
local_in_edges_tensor generation:  0.0010097026824951172
mini_batch_src_global generation:  0.0018908977508544922
r_  generation:  0.022382736206054688
local_output_nid generation:  0.001855611801147461
local_in_edges_tensor generation:  0.0010366439819335938
mini_batch_src_global generation:  0.0019321441650390625
r_  generation:  0.022975444793701172
----------------------check_connections_block total spend ----------------------------- 0.588707447052002
generate_one_block  0.03262472152709961
generate_one_block  0.03171849250793457
generate_one_block  0.03224062919616699
generate_one_block  0.03290581703186035
generate_one_block  0.032914161682128906
generate_one_block  0.034880638122558594
generate_one_block  0.033064842224121094
generate_one_block  0.03182578086853027
generate_one_block  0.03676271438598633
generate_one_block  0.038910627365112305
generate_one_block  0.03339838981628418
generate_one_block  0.03277587890625
generate_one_block  0.03149867057800293
generate_one_block  0.030837297439575195
generate_one_block  0.0315396785736084
generate_one_block  0.03251242637634277
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.038639068603515625
gen group dst list time:  0.01864147186279297
time for parepare:  0.01926112174987793
local_output_nid generation:  0.0074079036712646484
local_in_edges_tensor generation:  0.02390766143798828
mini_batch_src_global generation:  0.026254892349243164
r_  generation:  0.2477884292602539
local_output_nid generation:  0.011233329772949219
local_in_edges_tensor generation:  0.014440059661865234
mini_batch_src_global generation:  0.031534433364868164
r_  generation:  0.2590174674987793
local_output_nid generation:  0.014261007308959961
local_in_edges_tensor generation:  0.01613140106201172
mini_batch_src_global generation:  0.03117227554321289
r_  generation:  0.27501964569091797
local_output_nid generation:  0.012447834014892578
local_in_edges_tensor generation:  0.014011859893798828
mini_batch_src_global generation:  0.034833431243896484
r_  generation:  0.272815465927124
local_output_nid generation:  0.012402772903442383
local_in_edges_tensor generation:  0.014284849166870117
mini_batch_src_global generation:  0.03494906425476074
r_  generation:  0.27761173248291016
local_output_nid generation:  0.01516413688659668
local_in_edges_tensor generation:  0.018487215042114258
mini_batch_src_global generation:  0.03628110885620117
r_  generation:  0.27330970764160156
local_output_nid generation:  0.012982368469238281
local_in_edges_tensor generation:  0.01845264434814453
mini_batch_src_global generation:  0.03552556037902832
r_  generation:  0.27892422676086426
local_output_nid generation:  0.013901472091674805
local_in_edges_tensor generation:  0.014585494995117188
mini_batch_src_global generation:  0.03670692443847656
r_  generation:  0.27619290351867676
local_output_nid generation:  0.013227224349975586
local_in_edges_tensor generation:  0.01384282112121582
mini_batch_src_global generation:  0.03383350372314453
r_  generation:  0.28426241874694824
local_output_nid generation:  0.015764713287353516
local_in_edges_tensor generation:  0.017508268356323242
mini_batch_src_global generation:  0.035646677017211914
r_  generation:  0.2737462520599365
local_output_nid generation:  0.013220787048339844
local_in_edges_tensor generation:  0.016001462936401367
mini_batch_src_global generation:  0.033950090408325195
r_  generation:  0.2697334289550781
local_output_nid generation:  0.013596057891845703
local_in_edges_tensor generation:  0.01512289047241211
mini_batch_src_global generation:  0.036064863204956055
r_  generation:  0.27713561058044434
local_output_nid generation:  0.0137939453125
local_in_edges_tensor generation:  0.015498876571655273
mini_batch_src_global generation:  0.03490567207336426
r_  generation:  0.27516865730285645
local_output_nid generation:  0.013517379760742188
local_in_edges_tensor generation:  0.013873577117919922
mini_batch_src_global generation:  0.03433060646057129
r_  generation:  0.2690401077270508
local_output_nid generation:  0.013287782669067383
local_in_edges_tensor generation:  0.013689279556274414
mini_batch_src_global generation:  0.03601193428039551
r_  generation:  0.28926563262939453
local_output_nid generation:  0.013054370880126953
local_in_edges_tensor generation:  0.017261981964111328
mini_batch_src_global generation:  0.034639596939086914
r_  generation:  0.2818264961242676
----------------------check_connections_block total spend ----------------------------- 6.3477067947387695
generate_one_block  0.3637669086456299
generate_one_block  0.34478330612182617
generate_one_block  0.35637855529785156
generate_one_block  0.3555006980895996
generate_one_block  0.3596961498260498
generate_one_block  0.3498528003692627
generate_one_block  0.38305020332336426
generate_one_block  0.35654449462890625
generate_one_block  0.3432307243347168
generate_one_block  0.3518822193145752
generate_one_block  0.3487064838409424
generate_one_block  0.36174726486206055
generate_one_block  0.36905646324157715
generate_one_block  0.3537328243255615
generate_one_block  0.3525362014770508
generate_one_block  0.3569905757904053
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03844189643859863
gen group dst list time:  0.07113814353942871
time for parepare:  0.018938541412353516
local_output_nid generation:  0.026520967483520508
local_in_edges_tensor generation:  0.05444526672363281
mini_batch_src_global generation:  0.051583290100097656
r_  generation:  0.5203022956848145
local_output_nid generation:  0.03107285499572754
local_in_edges_tensor generation:  0.03796553611755371
mini_batch_src_global generation:  0.06516551971435547
r_  generation:  0.5187740325927734
local_output_nid generation:  0.031118392944335938
local_in_edges_tensor generation:  0.03434395790100098
mini_batch_src_global generation:  0.05906963348388672
r_  generation:  0.5376510620117188
local_output_nid generation:  0.03385663032531738
local_in_edges_tensor generation:  0.03210282325744629
mini_batch_src_global generation:  0.06035351753234863
r_  generation:  0.5266218185424805
local_output_nid generation:  0.032068490982055664
local_in_edges_tensor generation:  0.08631610870361328
mini_batch_src_global generation:  0.06309390068054199
r_  generation:  0.5390868186950684
local_output_nid generation:  0.031632184982299805
local_in_edges_tensor generation:  0.03837943077087402
mini_batch_src_global generation:  0.0624690055847168
r_  generation:  0.5450663566589355
local_output_nid generation:  0.0321805477142334
local_in_edges_tensor generation:  0.04111790657043457
mini_batch_src_global generation:  0.06114363670349121
r_  generation:  0.5446622371673584
local_output_nid generation:  0.03176546096801758
local_in_edges_tensor generation:  0.03659510612487793
mini_batch_src_global generation:  0.06868553161621094
r_  generation:  0.5422539710998535
local_output_nid generation:  0.03310847282409668
local_in_edges_tensor generation:  0.03533816337585449
mini_batch_src_global generation:  0.07388687133789062
r_  generation:  0.5475194454193115
local_output_nid generation:  0.03405618667602539
local_in_edges_tensor generation:  0.0341639518737793
mini_batch_src_global generation:  0.06326794624328613
r_  generation:  0.5381031036376953
local_output_nid generation:  0.032959699630737305
local_in_edges_tensor generation:  0.03258538246154785
mini_batch_src_global generation:  0.0621795654296875
r_  generation:  0.5428879261016846
local_output_nid generation:  0.0330510139465332
local_in_edges_tensor generation:  0.033677101135253906
mini_batch_src_global generation:  0.06528472900390625
r_  generation:  0.5372118949890137
local_output_nid generation:  0.032790184020996094
local_in_edges_tensor generation:  0.03235054016113281
mini_batch_src_global generation:  0.062247276306152344
r_  generation:  0.544985294342041
local_output_nid generation:  0.0331568717956543
local_in_edges_tensor generation:  0.033347368240356445
mini_batch_src_global generation:  0.06528472900390625
r_  generation:  0.55019211769104
local_output_nid generation:  0.03294539451599121
local_in_edges_tensor generation:  0.033844947814941406
mini_batch_src_global generation:  0.06442880630493164
r_  generation:  0.543745756149292
local_output_nid generation:  0.0324254035949707
local_in_edges_tensor generation:  0.03257036209106445
mini_batch_src_global generation:  0.0630502700805664
r_  generation:  0.5443928241729736
----------------------check_connections_block total spend ----------------------------- 12.700012445449829
generate_one_block  0.6821308135986328
generate_one_block  0.6767129898071289
generate_one_block  0.6792643070220947
generate_one_block  0.6790986061096191
generate_one_block  0.68717360496521
generate_one_block  0.6746463775634766
generate_one_block  0.6818454265594482
generate_one_block  0.6795101165771484
generate_one_block  0.7130537033081055
generate_one_block  0.6924755573272705
generate_one_block  0.6743650436401367
generate_one_block  0.690227746963501
generate_one_block  0.6786642074584961
generate_one_block  0.6942732334136963
generate_one_block  0.6943342685699463
generate_one_block  0.68092942237854
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.1297159194946289  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

connection checking time:  19.0477192401886
block generation total time  16.66616129875183
average batch blocks generation time:  1.0416350811719894
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09964323043823242  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7686767578125  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09974956512451172  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7730655670166016  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.099700927734375  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7690396308898926  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09973812103271484  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.770566463470459  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10088825225830078  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7779874801635742  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09963560104370117  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7680172920227051  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09986400604248047  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7763137817382812  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09974336624145508  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7737250328063965  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10066795349121094  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7699246406555176  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09989309310913086  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7795438766479492  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.1007223129272461  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7743997573852539  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09987592697143555  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7809643745422363  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09975814819335938  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7725214958190918  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09981346130371094  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7736973762512207  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09988021850585938  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.781010627746582  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09969186782836914  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7748274803161621  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06867392361164093 |0.01722685992717743 |0.003528013825416565 |8.96751880645752e-05 |0.0037456154823303223 |0.0013515949249267578 |
----------------------------------------------------------pseudo_mini_loss sum 1.6284924745559692
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  5332298
Number of first layer input nodes during this epoch:  2521865
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.1284642219543457  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02417731285095215
range selection method range initialization spend 0.012088298797607422
time for parepare:  0.018494129180908203
local_output_nid generation:  0.0014464855194091797
local_in_edges_tensor generation:  0.0071218013763427734
mini_batch_src_global generation:  0.0017592906951904297
r_  generation:  0.02134537696838379
local_output_nid generation:  0.0015690326690673828
local_in_edges_tensor generation:  0.001024484634399414
mini_batch_src_global generation:  0.0020601749420166016
r_  generation:  0.021890878677368164
local_output_nid generation:  0.0016295909881591797
local_in_edges_tensor generation:  0.0009856224060058594
mini_batch_src_global generation:  0.001714468002319336
r_  generation:  0.022043704986572266
local_output_nid generation:  0.0017151832580566406
local_in_edges_tensor generation:  0.0009307861328125
mini_batch_src_global generation:  0.0017440319061279297
r_  generation:  0.022008895874023438
local_output_nid generation:  0.0016109943389892578
local_in_edges_tensor generation:  0.0009548664093017578
mini_batch_src_global generation:  0.0017609596252441406
r_  generation:  0.021256208419799805
local_output_nid generation:  0.001623392105102539
local_in_edges_tensor generation:  0.0009891986846923828
mini_batch_src_global generation:  0.0017650127410888672
r_  generation:  0.021704435348510742
local_output_nid generation:  0.001611471176147461
local_in_edges_tensor generation:  0.0009341239929199219
mini_batch_src_global generation:  0.001728057861328125
r_  generation:  0.022119522094726562
local_output_nid generation:  0.0016140937805175781
local_in_edges_tensor generation:  0.0009367465972900391
mini_batch_src_global generation:  0.0017483234405517578
r_  generation:  0.02158641815185547
local_output_nid generation:  0.001619100570678711
local_in_edges_tensor generation:  0.0009670257568359375
mini_batch_src_global generation:  0.0017757415771484375
r_  generation:  0.022214174270629883
local_output_nid generation:  0.0016200542449951172
local_in_edges_tensor generation:  0.0009310245513916016
mini_batch_src_global generation:  0.001772165298461914
r_  generation:  0.022354841232299805
local_output_nid generation:  0.0016148090362548828
local_in_edges_tensor generation:  0.0009253025054931641
mini_batch_src_global generation:  0.0018315315246582031
r_  generation:  0.022248506546020508
local_output_nid generation:  0.0016434192657470703
local_in_edges_tensor generation:  0.0009372234344482422
mini_batch_src_global generation:  0.0018057823181152344
r_  generation:  0.02251291275024414
local_output_nid generation:  0.0016129016876220703
local_in_edges_tensor generation:  0.0009534358978271484
mini_batch_src_global generation:  0.0017926692962646484
r_  generation:  0.02225184440612793
local_output_nid generation:  0.0016117095947265625
local_in_edges_tensor generation:  0.0009133815765380859
mini_batch_src_global generation:  0.0018029212951660156
r_  generation:  0.02234625816345215
local_output_nid generation:  0.001642465591430664
local_in_edges_tensor generation:  0.0009217262268066406
mini_batch_src_global generation:  0.0017850399017333984
r_  generation:  0.021807193756103516
local_output_nid generation:  0.0017502307891845703
local_in_edges_tensor generation:  0.0009152889251708984
mini_batch_src_global generation:  0.0017848014831542969
r_  generation:  0.022010326385498047
----------------------check_connections_block total spend ----------------------------- 0.524836540222168
generate_one_block  0.03513956069946289
generate_one_block  0.031402587890625
generate_one_block  0.03200984001159668
generate_one_block  0.03146719932556152
generate_one_block  0.03088068962097168
generate_one_block  0.033236026763916016
generate_one_block  0.031174659729003906
generate_one_block  0.030419349670410156
generate_one_block  0.03269386291503906
generate_one_block  0.03158092498779297
generate_one_block  0.031096935272216797
generate_one_block  0.03304314613342285
generate_one_block  0.031153440475463867
generate_one_block  0.03206372261047363
generate_one_block  0.031198501586914062
generate_one_block  0.03290152549743652
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.09308886528015137
gen group dst list time:  0.02557516098022461
time for parepare:  0.03033900260925293
local_output_nid generation:  0.007858514785766602
local_in_edges_tensor generation:  0.0221555233001709
mini_batch_src_global generation:  0.02915668487548828
r_  generation:  0.2534356117248535
local_output_nid generation:  0.011198997497558594
local_in_edges_tensor generation:  0.017833471298217773
mini_batch_src_global generation:  0.0323328971862793
r_  generation:  0.26813602447509766
local_output_nid generation:  0.011908292770385742
local_in_edges_tensor generation:  0.02051830291748047
mini_batch_src_global generation:  0.03342127799987793
r_  generation:  0.2747948169708252
local_output_nid generation:  0.013323783874511719
local_in_edges_tensor generation:  0.01675891876220703
mini_batch_src_global generation:  0.035845041275024414
r_  generation:  0.2813267707824707
local_output_nid generation:  0.012393712997436523
local_in_edges_tensor generation:  0.01863384246826172
mini_batch_src_global generation:  0.034139394760131836
r_  generation:  0.28969836235046387
local_output_nid generation:  0.015024185180664062
local_in_edges_tensor generation:  0.01494908332824707
mini_batch_src_global generation:  0.03860068321228027
r_  generation:  0.2747523784637451
local_output_nid generation:  0.013370275497436523
local_in_edges_tensor generation:  0.0146636962890625
mini_batch_src_global generation:  0.03378915786743164
r_  generation:  0.33023977279663086
local_output_nid generation:  0.013155221939086914
local_in_edges_tensor generation:  0.015265226364135742
mini_batch_src_global generation:  0.03402090072631836
r_  generation:  0.26511406898498535
local_output_nid generation:  0.013667583465576172
local_in_edges_tensor generation:  0.013678312301635742
mini_batch_src_global generation:  0.03566622734069824
r_  generation:  0.27551937103271484
local_output_nid generation:  0.013802289962768555
local_in_edges_tensor generation:  0.01739192008972168
mini_batch_src_global generation:  0.03437328338623047
r_  generation:  0.2776169776916504
local_output_nid generation:  0.013429880142211914
local_in_edges_tensor generation:  0.014900684356689453
mini_batch_src_global generation:  0.037372589111328125
r_  generation:  0.2746713161468506
local_output_nid generation:  0.013921976089477539
local_in_edges_tensor generation:  0.01643991470336914
mini_batch_src_global generation:  0.035119056701660156
r_  generation:  0.28177881240844727
local_output_nid generation:  0.013649940490722656
local_in_edges_tensor generation:  0.013506412506103516
mini_batch_src_global generation:  0.03481626510620117
r_  generation:  0.2731208801269531
local_output_nid generation:  0.01393580436706543
local_in_edges_tensor generation:  0.01624155044555664
mini_batch_src_global generation:  0.03563213348388672
r_  generation:  0.2850356101989746
local_output_nid generation:  0.012882232666015625
local_in_edges_tensor generation:  0.01379084587097168
mini_batch_src_global generation:  0.03486895561218262
r_  generation:  0.27390432357788086
local_output_nid generation:  0.012984514236450195
local_in_edges_tensor generation:  0.013840913772583008
mini_batch_src_global generation:  0.03430509567260742
r_  generation:  0.2976043224334717
----------------------check_connections_block total spend ----------------------------- 6.465041160583496
generate_one_block  0.37290334701538086
generate_one_block  0.36103248596191406
generate_one_block  0.35953426361083984
generate_one_block  0.3606431484222412
generate_one_block  0.3653247356414795
generate_one_block  0.3509805202484131
generate_one_block  0.3835890293121338
generate_one_block  0.360607385635376
generate_one_block  0.35796499252319336
generate_one_block  0.36328625679016113
generate_one_block  0.3564279079437256
generate_one_block  0.3636608123779297
generate_one_block  0.3525197505950928
generate_one_block  0.3723573684692383
generate_one_block  0.35396409034729004
generate_one_block  0.3510589599609375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04204702377319336
gen group dst list time:  0.07226800918579102
time for parepare:  0.020194053649902344
local_output_nid generation:  0.0265195369720459
local_in_edges_tensor generation:  0.05223417282104492
mini_batch_src_global generation:  0.051114559173583984
r_  generation:  0.5276813507080078
local_output_nid generation:  0.03229403495788574
local_in_edges_tensor generation:  0.042029619216918945
mini_batch_src_global generation:  0.06247687339782715
r_  generation:  0.5267226696014404
local_output_nid generation:  0.03249478340148926
local_in_edges_tensor generation:  0.033170461654663086
mini_batch_src_global generation:  0.05980348587036133
r_  generation:  0.5389199256896973
local_output_nid generation:  0.032787322998046875
local_in_edges_tensor generation:  0.03598737716674805
mini_batch_src_global generation:  0.060489654541015625
r_  generation:  0.5324933528900146
local_output_nid generation:  0.03289651870727539
local_in_edges_tensor generation:  0.07863640785217285
mini_batch_src_global generation:  0.06052660942077637
r_  generation:  0.5463559627532959
local_output_nid generation:  0.03207278251647949
local_in_edges_tensor generation:  0.03163719177246094
mini_batch_src_global generation:  0.0644996166229248
r_  generation:  0.549778938293457
local_output_nid generation:  0.031975507736206055
local_in_edges_tensor generation:  0.03189826011657715
mini_batch_src_global generation:  0.06103372573852539
r_  generation:  0.5638272762298584
local_output_nid generation:  0.03229117393493652
local_in_edges_tensor generation:  0.031587839126586914
mini_batch_src_global generation:  0.06300473213195801
r_  generation:  0.5466194152832031
local_output_nid generation:  0.03272867202758789
local_in_edges_tensor generation:  0.04287910461425781
mini_batch_src_global generation:  0.06217074394226074
r_  generation:  0.5541889667510986
local_output_nid generation:  0.03334379196166992
local_in_edges_tensor generation:  0.03409433364868164
mini_batch_src_global generation:  0.06602859497070312
r_  generation:  0.5445363521575928
local_output_nid generation:  0.032587528228759766
local_in_edges_tensor generation:  0.03183460235595703
mini_batch_src_global generation:  0.061788320541381836
r_  generation:  0.5537290573120117
local_output_nid generation:  0.032706260681152344
local_in_edges_tensor generation:  0.03393888473510742
mini_batch_src_global generation:  0.06537532806396484
r_  generation:  0.5497205257415771
local_output_nid generation:  0.03258538246154785
local_in_edges_tensor generation:  0.034191131591796875
mini_batch_src_global generation:  0.061138153076171875
r_  generation:  0.5527889728546143
local_output_nid generation:  0.03290128707885742
local_in_edges_tensor generation:  0.034241437911987305
mini_batch_src_global generation:  0.06267046928405762
r_  generation:  0.5704193115234375
local_output_nid generation:  0.035404205322265625
local_in_edges_tensor generation:  0.03765749931335449
mini_batch_src_global generation:  0.06608104705810547
r_  generation:  0.5452911853790283
local_output_nid generation:  0.03360748291015625
local_in_edges_tensor generation:  0.0317685604095459
mini_batch_src_global generation:  0.06570053100585938
r_  generation:  0.5477595329284668
----------------------check_connections_block total spend ----------------------------- 12.845653533935547
generate_one_block  0.691396951675415
generate_one_block  0.6818063259124756
generate_one_block  0.6886603832244873
generate_one_block  0.6867563724517822
generate_one_block  0.6856992244720459
generate_one_block  0.6860857009887695
generate_one_block  0.6886961460113525
generate_one_block  0.6814019680023193
generate_one_block  0.7604506015777588
generate_one_block  0.6919460296630859
generate_one_block  0.6817188262939453
generate_one_block  0.6841423511505127
generate_one_block  0.6855762004852295
generate_one_block  0.6802201271057129
generate_one_block  0.6780605316162109
generate_one_block  0.6837239265441895
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.1284642219543457  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

connection checking time:  19.310694694519043
block generation total time  16.82219672203064
average batch blocks generation time:  1.051387295126915
block dataloader generation time/epoch 38.410027742385864
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09981966018676758  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7738795280456543  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0997309684753418  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7701420783996582  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09975910186767578  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7762608528137207  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09992027282714844  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7771978378295898  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0997014045715332  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7683062553405762  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09972858428955078  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7720413208007812  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09957599639892578  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7682476043701172  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09947586059570312  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7662739753723145  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09979677200317383  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7770180702209473  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0998539924621582  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7729325294494629  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09964895248413086  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.771507740020752  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.099853515625  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7805495262145996  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09978246688842773  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7725071907043457  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10003805160522461  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.781682014465332  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09964275360107422  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7664370536804199  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09983158111572266  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7751917839050293  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0651497095823288 |0.015532806515693665 |0.003429606556892395 |8.951127529144287e-05 |0.0033089369535446167 |0.0013532638549804688 |
----------------------------------------------------------pseudo_mini_loss sum 1.593536615371704
Total (block generation + training)time/epoch 39.87652134895325
Training time/epoch 1.4662494659423828
Training time without block to device /epoch 1.2177245616912842
Training time without total dataloading part /epoch 0.11060214042663574
load block tensor time/epoch 1.0423953533172607
block to device time/epoch 0.24852490425109863
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  5329792
Number of first layer input nodes during this epoch:  2520869
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.12848615646362305  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025279998779296875
range selection method range initialization spend 0.015964269638061523
time for parepare:  0.017628908157348633
local_output_nid generation:  0.0014374256134033203
local_in_edges_tensor generation:  0.0071430206298828125
mini_batch_src_global generation:  0.0021479129791259766
r_  generation:  0.027728796005249023
local_output_nid generation:  0.0015845298767089844
local_in_edges_tensor generation:  0.0009806156158447266
mini_batch_src_global generation:  0.0020902156829833984
r_  generation:  0.02282404899597168
local_output_nid generation:  0.0016529560089111328
local_in_edges_tensor generation:  0.0010249614715576172
mini_batch_src_global generation:  0.0017306804656982422
r_  generation:  0.02171778678894043
local_output_nid generation:  0.0016169548034667969
local_in_edges_tensor generation:  0.0009484291076660156
mini_batch_src_global generation:  0.0017673969268798828
r_  generation:  0.021049976348876953
local_output_nid generation:  0.001561880111694336
local_in_edges_tensor generation:  0.0009479522705078125
mini_batch_src_global generation:  0.0018079280853271484
r_  generation:  0.021237611770629883
local_output_nid generation:  0.0015370845794677734
local_in_edges_tensor generation:  0.0009510517120361328
mini_batch_src_global generation:  0.001753091812133789
r_  generation:  0.02195000648498535
local_output_nid generation:  0.0015835762023925781
local_in_edges_tensor generation:  0.0009229183197021484
mini_batch_src_global generation:  0.0018115043640136719
r_  generation:  0.022164106369018555
local_output_nid generation:  0.0015873908996582031
local_in_edges_tensor generation:  0.0010194778442382812
mini_batch_src_global generation:  0.0017595291137695312
r_  generation:  0.021448612213134766
local_output_nid generation:  0.0015559196472167969
local_in_edges_tensor generation:  0.0009543895721435547
mini_batch_src_global generation:  0.0018024444580078125
r_  generation:  0.021962404251098633
local_output_nid generation:  0.0015702247619628906
local_in_edges_tensor generation:  0.0009031295776367188
mini_batch_src_global generation:  0.0017538070678710938
r_  generation:  0.0217893123626709
local_output_nid generation:  0.0015451908111572266
local_in_edges_tensor generation:  0.0009443759918212891
mini_batch_src_global generation:  0.001810312271118164
r_  generation:  0.02194380760192871
local_output_nid generation:  0.00156402587890625
local_in_edges_tensor generation:  0.0009596347808837891
mini_batch_src_global generation:  0.0017557144165039062
r_  generation:  0.02126622200012207
local_output_nid generation:  0.0015337467193603516
local_in_edges_tensor generation:  0.0009467601776123047
mini_batch_src_global generation:  0.001752614974975586
r_  generation:  0.021381616592407227
local_output_nid generation:  0.0015285015106201172
local_in_edges_tensor generation:  0.0008842945098876953
mini_batch_src_global generation:  0.0017354488372802734
r_  generation:  0.021483898162841797
local_output_nid generation:  0.0015323162078857422
local_in_edges_tensor generation:  0.0009009838104248047
mini_batch_src_global generation:  0.0019507408142089844
r_  generation:  0.021975994110107422
local_output_nid generation:  0.0015518665313720703
local_in_edges_tensor generation:  0.0009233951568603516
mini_batch_src_global generation:  0.0017940998077392578
r_  generation:  0.021552085876464844
----------------------check_connections_block total spend ----------------------------- 0.5264992713928223
generate_one_block  0.030594825744628906
generate_one_block  0.0320429801940918
generate_one_block  0.03287363052368164
generate_one_block  0.0339808464050293
generate_one_block  0.03206825256347656
generate_one_block  0.03398942947387695
generate_one_block  0.03152203559875488
generate_one_block  0.03036952018737793
generate_one_block  0.031291961669921875
generate_one_block  0.03095865249633789
generate_one_block  0.03154110908508301
generate_one_block  0.0308377742767334
generate_one_block  0.031023740768432617
generate_one_block  0.03088092803955078
generate_one_block  0.03180384635925293
generate_one_block  0.031188249588012695
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03818559646606445
gen group dst list time:  0.02188849449157715
time for parepare:  0.01985645294189453
local_output_nid generation:  0.007369279861450195
local_in_edges_tensor generation:  0.025669336318969727
mini_batch_src_global generation:  0.027205467224121094
r_  generation:  0.2558145523071289
local_output_nid generation:  0.011187314987182617
local_in_edges_tensor generation:  0.017204999923706055
mini_batch_src_global generation:  0.033217430114746094
r_  generation:  0.2610747814178467
local_output_nid generation:  0.012121200561523438
local_in_edges_tensor generation:  0.014280557632446289
mini_batch_src_global generation:  0.03304576873779297
r_  generation:  0.2672560214996338
local_output_nid generation:  0.012463569641113281
local_in_edges_tensor generation:  0.015262126922607422
mini_batch_src_global generation:  0.03220319747924805
r_  generation:  0.2669048309326172
local_output_nid generation:  0.012169837951660156
local_in_edges_tensor generation:  0.013258934020996094
mini_batch_src_global generation:  0.03628683090209961
r_  generation:  0.2739238739013672
local_output_nid generation:  0.01262664794921875
local_in_edges_tensor generation:  0.014165639877319336
mini_batch_src_global generation:  0.033858299255371094
r_  generation:  0.2728281021118164
local_output_nid generation:  0.012832880020141602
local_in_edges_tensor generation:  0.015248537063598633
mini_batch_src_global generation:  0.03599977493286133
r_  generation:  0.2804126739501953
local_output_nid generation:  0.013593435287475586
local_in_edges_tensor generation:  0.01749396324157715
mini_batch_src_global generation:  0.03378701210021973
r_  generation:  0.27356624603271484
local_output_nid generation:  0.013149499893188477
local_in_edges_tensor generation:  0.015082836151123047
mini_batch_src_global generation:  0.03640389442443848
r_  generation:  0.2800629138946533
local_output_nid generation:  0.013257265090942383
local_in_edges_tensor generation:  0.014947175979614258
mini_batch_src_global generation:  0.034136056900024414
r_  generation:  0.27669429779052734
local_output_nid generation:  0.013134241104125977
local_in_edges_tensor generation:  0.0180051326751709
mini_batch_src_global generation:  0.03485393524169922
r_  generation:  0.27666211128234863
local_output_nid generation:  0.012842893600463867
local_in_edges_tensor generation:  0.018489360809326172
mini_batch_src_global generation:  0.033995866775512695
r_  generation:  0.2719118595123291
local_output_nid generation:  0.013074159622192383
local_in_edges_tensor generation:  0.014993667602539062
mini_batch_src_global generation:  0.03555917739868164
r_  generation:  0.2696864604949951
local_output_nid generation:  0.014490365982055664
local_in_edges_tensor generation:  0.013561725616455078
mini_batch_src_global generation:  0.036083221435546875
r_  generation:  0.27962565422058105
local_output_nid generation:  0.012831687927246094
local_in_edges_tensor generation:  0.01702117919921875
mini_batch_src_global generation:  0.037713050842285156
r_  generation:  0.27747225761413574
local_output_nid generation:  0.013675212860107422
local_in_edges_tensor generation:  0.015761852264404297
mini_batch_src_global generation:  0.0343017578125
r_  generation:  0.2705249786376953
----------------------check_connections_block total spend ----------------------------- 6.3111631870269775
generate_one_block  0.35860252380371094
generate_one_block  0.34546518325805664
generate_one_block  0.35680079460144043
generate_one_block  0.3550565242767334
generate_one_block  0.35526180267333984
generate_one_block  0.36356019973754883
generate_one_block  0.38942456245422363
generate_one_block  0.3478124141693115
generate_one_block  0.3575282096862793
generate_one_block  0.36057162284851074
generate_one_block  0.3547821044921875
generate_one_block  0.3454265594482422
generate_one_block  0.35077381134033203
generate_one_block  0.34352636337280273
generate_one_block  0.35933804512023926
generate_one_block  0.34686875343322754
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04081439971923828
gen group dst list time:  0.06787896156311035
time for parepare:  0.021378755569458008
local_output_nid generation:  0.0259702205657959
local_in_edges_tensor generation:  0.05583477020263672
mini_batch_src_global generation:  0.051528215408325195
r_  generation:  0.5256574153900146
local_output_nid generation:  0.03217029571533203
local_in_edges_tensor generation:  0.042382001876831055
mini_batch_src_global generation:  0.0628809928894043
r_  generation:  0.5153713226318359
local_output_nid generation:  0.03115224838256836
local_in_edges_tensor generation:  0.03925347328186035
mini_batch_src_global generation:  0.060297489166259766
r_  generation:  0.5422813892364502
local_output_nid generation:  0.031233549118041992
local_in_edges_tensor generation:  0.03307747840881348
mini_batch_src_global generation:  0.07123279571533203
r_  generation:  0.5253589153289795
local_output_nid generation:  0.03314018249511719
local_in_edges_tensor generation:  0.08863329887390137
mini_batch_src_global generation:  0.060648202896118164
r_  generation:  0.5361943244934082
local_output_nid generation:  0.03137350082397461
local_in_edges_tensor generation:  0.03421783447265625
mini_batch_src_global generation:  0.06217765808105469
r_  generation:  0.5372393131256104
local_output_nid generation:  0.03182244300842285
local_in_edges_tensor generation:  0.03147697448730469
mini_batch_src_global generation:  0.06045079231262207
r_  generation:  0.5468947887420654
local_output_nid generation:  0.03228116035461426
local_in_edges_tensor generation:  0.033849477767944336
mini_batch_src_global generation:  0.06166434288024902
r_  generation:  0.5485749244689941
local_output_nid generation:  0.03211665153503418
local_in_edges_tensor generation:  0.03388619422912598
mini_batch_src_global generation:  0.06362414360046387
r_  generation:  0.5466692447662354
local_output_nid generation:  0.032258033752441406
local_in_edges_tensor generation:  0.033148765563964844
mini_batch_src_global generation:  0.06296229362487793
r_  generation:  0.5444135665893555
local_output_nid generation:  0.032965898513793945
local_in_edges_tensor generation:  0.0321803092956543
mini_batch_src_global generation:  0.06252408027648926
r_  generation:  0.5458927154541016
local_output_nid generation:  0.032386064529418945
local_in_edges_tensor generation:  0.039604902267456055
mini_batch_src_global generation:  0.06190943717956543
r_  generation:  0.5376684665679932
local_output_nid generation:  0.03201794624328613
local_in_edges_tensor generation:  0.031080007553100586
mini_batch_src_global generation:  0.0619206428527832
r_  generation:  0.5502607822418213
local_output_nid generation:  0.03196907043457031
local_in_edges_tensor generation:  0.031218290328979492
mini_batch_src_global generation:  0.06305384635925293
r_  generation:  0.5432727336883545
local_output_nid generation:  0.031925201416015625
local_in_edges_tensor generation:  0.03316831588745117
mini_batch_src_global generation:  0.06583404541015625
r_  generation:  0.5454435348510742
local_output_nid generation:  0.031974077224731445
local_in_edges_tensor generation:  0.03156685829162598
mini_batch_src_global generation:  0.062242746353149414
r_  generation:  0.5427727699279785
----------------------check_connections_block total spend ----------------------------- 12.685640811920166
generate_one_block  0.6871531009674072
generate_one_block  0.6815354824066162
generate_one_block  0.6756572723388672
generate_one_block  0.6817927360534668
generate_one_block  0.6910748481750488
generate_one_block  0.6858222484588623
generate_one_block  0.6775715351104736
generate_one_block  0.6802105903625488
generate_one_block  0.7267298698425293
generate_one_block  0.6851978302001953
generate_one_block  0.6756467819213867
generate_one_block  0.6701412200927734
generate_one_block  0.674224853515625
generate_one_block  0.6844091415405273
generate_one_block  0.67435622215271
generate_one_block  0.6794240474700928
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.12848615646362305  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

connection checking time:  18.996803998947144
block generation total time  16.621747255325317
average batch blocks generation time:  1.0388592034578323
block dataloader generation time/epoch 38.16882359981537
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09976339340209961  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7717266082763672  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09976863861083984  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7754206657409668  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09978866577148438  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7739448547363281  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09961366653442383  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7698235511779785  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09978723526000977  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7712178230285645  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09966325759887695  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7725481986999512  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0998835563659668  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7724075317382812  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09964704513549805  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7693262100219727  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09987974166870117  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7808856964111328  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09993314743041992  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7773232460021973  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10084342956542969  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7744355201721191  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09953117370605469  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7661547660827637  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10070133209228516  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7740278244018555  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09978055953979492  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7701249122619629  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10093116760253906  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.774437427520752  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09969234466552734  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7698578834533691  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06842762231826782 |0.015075430274009705 |0.0034846514463424683 |8.900463581085205e-05 |0.003639012575149536 |0.001463174819946289 |
----------------------------------------------------------pseudo_mini_loss sum 1.558834195137024
Total (block generation + training)time/epoch 39.660510897636414
Training time/epoch 1.516679286956787
Training time without block to device /epoch 1.2754724025726318
Training time without total dataloading part /epoch 0.11686587333679199
load block tensor time/epoch 1.0948419570922852
block to device time/epoch 0.24120688438415527
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  5330997
Number of first layer input nodes during this epoch:  2521756
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.12730169296264648  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024190902709960938
range selection method range initialization spend 0.01268315315246582
time for parepare:  0.016564607620239258
local_output_nid generation:  0.0014791488647460938
local_in_edges_tensor generation:  0.006956815719604492
mini_batch_src_global generation:  0.0018088817596435547
r_  generation:  0.021870851516723633
local_output_nid generation:  0.0015685558319091797
local_in_edges_tensor generation:  0.0009772777557373047
mini_batch_src_global generation:  0.002026081085205078
r_  generation:  0.021770238876342773
local_output_nid generation:  0.0015416145324707031
local_in_edges_tensor generation:  0.0010275840759277344
mini_batch_src_global generation:  0.0017139911651611328
r_  generation:  0.02174520492553711
local_output_nid generation:  0.001581430435180664
local_in_edges_tensor generation:  0.001013040542602539
mini_batch_src_global generation:  0.001735687255859375
r_  generation:  0.02147674560546875
local_output_nid generation:  0.001539468765258789
local_in_edges_tensor generation:  0.0010247230529785156
mini_batch_src_global generation:  0.0017213821411132812
r_  generation:  0.021517038345336914
local_output_nid generation:  0.001567840576171875
local_in_edges_tensor generation:  0.001100301742553711
mini_batch_src_global generation:  0.0017123222351074219
r_  generation:  0.021693706512451172
local_output_nid generation:  0.0016164779663085938
local_in_edges_tensor generation:  0.0009748935699462891
mini_batch_src_global generation:  0.0017511844635009766
r_  generation:  0.022068262100219727
local_output_nid generation:  0.0016286373138427734
local_in_edges_tensor generation:  0.00093841552734375
mini_batch_src_global generation:  0.0017659664154052734
r_  generation:  0.022305727005004883
local_output_nid generation:  0.0015747547149658203
local_in_edges_tensor generation:  0.0009319782257080078
mini_batch_src_global generation:  0.0017771720886230469
r_  generation:  0.022008419036865234
local_output_nid generation:  0.0015609264373779297
local_in_edges_tensor generation:  0.0009596347808837891
mini_batch_src_global generation:  0.0017631053924560547
r_  generation:  0.021810293197631836
local_output_nid generation:  0.001554727554321289
local_in_edges_tensor generation:  0.0009441375732421875
mini_batch_src_global generation:  0.001748800277709961
r_  generation:  0.022136926651000977
local_output_nid generation:  0.0015914440155029297
local_in_edges_tensor generation:  0.0009481906890869141
mini_batch_src_global generation:  0.0017256736755371094
r_  generation:  0.02178025245666504
local_output_nid generation:  0.0015561580657958984
local_in_edges_tensor generation:  0.0009355545043945312
mini_batch_src_global generation:  0.001745462417602539
r_  generation:  0.02161431312561035
local_output_nid generation:  0.0015494823455810547
local_in_edges_tensor generation:  0.0009369850158691406
mini_batch_src_global generation:  0.0017514228820800781
r_  generation:  0.02231740951538086
local_output_nid generation:  0.0015454292297363281
local_in_edges_tensor generation:  0.0009338855743408203
mini_batch_src_global generation:  0.001749277114868164
r_  generation:  0.02196049690246582
local_output_nid generation:  0.0015411376953125
local_in_edges_tensor generation:  0.0009083747863769531
mini_batch_src_global generation:  0.0017261505126953125
r_  generation:  0.021926164627075195
----------------------check_connections_block total spend ----------------------------- 0.5180227756500244
generate_one_block  0.031828880310058594
generate_one_block  0.03127598762512207
generate_one_block  0.03192758560180664
generate_one_block  0.03115057945251465
generate_one_block  0.03098893165588379
generate_one_block  0.032225608825683594
generate_one_block  0.031047821044921875
generate_one_block  0.030881881713867188
generate_one_block  0.031178712844848633
generate_one_block  0.030601978302001953
generate_one_block  0.03110194206237793
generate_one_block  0.030413150787353516
generate_one_block  0.030828237533569336
generate_one_block  0.031075000762939453
generate_one_block  0.03090190887451172
generate_one_block  0.0314326286315918
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03954195976257324
gen group dst list time:  0.01835942268371582
time for parepare:  0.019421815872192383
local_output_nid generation:  0.007552146911621094
local_in_edges_tensor generation:  0.024232864379882812
mini_batch_src_global generation:  0.027075529098510742
r_  generation:  0.25800037384033203
local_output_nid generation:  0.011181116104125977
local_in_edges_tensor generation:  0.012607336044311523
mini_batch_src_global generation:  0.03256511688232422
r_  generation:  0.25969552993774414
local_output_nid generation:  0.012326240539550781
local_in_edges_tensor generation:  0.0181734561920166
mini_batch_src_global generation:  0.032418012619018555
r_  generation:  0.27007198333740234
local_output_nid generation:  0.012279033660888672
local_in_edges_tensor generation:  0.014281034469604492
mini_batch_src_global generation:  0.033172607421875
r_  generation:  0.2682676315307617
local_output_nid generation:  0.012140274047851562
local_in_edges_tensor generation:  0.01693868637084961
mini_batch_src_global generation:  0.03367042541503906
r_  generation:  0.2662034034729004
local_output_nid generation:  0.012547969818115234
local_in_edges_tensor generation:  0.01675891876220703
mini_batch_src_global generation:  0.03368997573852539
r_  generation:  0.26678991317749023
local_output_nid generation:  0.013003110885620117
local_in_edges_tensor generation:  0.013750791549682617
mini_batch_src_global generation:  0.03478074073791504
r_  generation:  0.2718698978424072
local_output_nid generation:  0.013802766799926758
local_in_edges_tensor generation:  0.013752460479736328
mini_batch_src_global generation:  0.03388404846191406
r_  generation:  0.2676808834075928
local_output_nid generation:  0.013204097747802734
local_in_edges_tensor generation:  0.014080286026000977
mini_batch_src_global generation:  0.03484988212585449
r_  generation:  0.2751336097717285
local_output_nid generation:  0.013027667999267578
local_in_edges_tensor generation:  0.015115499496459961
mini_batch_src_global generation:  0.033542633056640625
r_  generation:  0.26551270484924316
local_output_nid generation:  0.013403654098510742
local_in_edges_tensor generation:  0.013807535171508789
mini_batch_src_global generation:  0.03423881530761719
r_  generation:  0.27358460426330566
local_output_nid generation:  0.013138532638549805
local_in_edges_tensor generation:  0.013636350631713867
mini_batch_src_global generation:  0.034348487854003906
r_  generation:  0.26694321632385254
local_output_nid generation:  0.013239860534667969
local_in_edges_tensor generation:  0.013625144958496094
mini_batch_src_global generation:  0.03426957130432129
r_  generation:  0.2705812454223633
local_output_nid generation:  0.013331890106201172
local_in_edges_tensor generation:  0.014798879623413086
mini_batch_src_global generation:  0.034421443939208984
r_  generation:  0.2720222473144531
local_output_nid generation:  0.012892007827758789
local_in_edges_tensor generation:  0.015072345733642578
mini_batch_src_global generation:  0.03481125831604004
r_  generation:  0.27593541145324707
local_output_nid generation:  0.012418746948242188
local_in_edges_tensor generation:  0.015281438827514648
mini_batch_src_global generation:  0.03466463088989258
r_  generation:  0.27284908294677734
----------------------check_connections_block total spend ----------------------------- 6.222726821899414
generate_one_block  0.36111950874328613
generate_one_block  0.3479883670806885
generate_one_block  0.35791754722595215
generate_one_block  0.3496992588043213
generate_one_block  0.3459312915802002
generate_one_block  0.34177684783935547
generate_one_block  0.3755772113800049
generate_one_block  0.34986448287963867
generate_one_block  0.3547048568725586
generate_one_block  0.34122252464294434
generate_one_block  0.3472144603729248
generate_one_block  0.3420233726501465
generate_one_block  0.3419158458709717
generate_one_block  0.34723782539367676
generate_one_block  0.3519775867462158
generate_one_block  0.3455367088317871
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04011201858520508
gen group dst list time:  0.06514120101928711
time for parepare:  0.019484758377075195
local_output_nid generation:  0.025936603546142578
local_in_edges_tensor generation:  0.05143880844116211
mini_batch_src_global generation:  0.05096578598022461
r_  generation:  0.5206003189086914
local_output_nid generation:  0.030945301055908203
local_in_edges_tensor generation:  0.04218721389770508
mini_batch_src_global generation:  0.061743736267089844
r_  generation:  0.5184509754180908
local_output_nid generation:  0.031232833862304688
local_in_edges_tensor generation:  0.036835670471191406
mini_batch_src_global generation:  0.057891845703125
r_  generation:  0.5332684516906738
local_output_nid generation:  0.03141045570373535
local_in_edges_tensor generation:  0.035509347915649414
mini_batch_src_global generation:  0.058643341064453125
r_  generation:  0.5265493392944336
local_output_nid generation:  0.03149056434631348
local_in_edges_tensor generation:  0.07647871971130371
mini_batch_src_global generation:  0.06169271469116211
r_  generation:  0.5418498516082764
local_output_nid generation:  0.03163409233093262
local_in_edges_tensor generation:  0.03512835502624512
mini_batch_src_global generation:  0.0603785514831543
r_  generation:  0.5342557430267334
local_output_nid generation:  0.031705617904663086
local_in_edges_tensor generation:  0.0344698429107666
mini_batch_src_global generation:  0.06008338928222656
r_  generation:  0.5443992614746094
local_output_nid generation:  0.03223371505737305
local_in_edges_tensor generation:  0.04047703742980957
mini_batch_src_global generation:  0.061980485916137695
r_  generation:  0.5407171249389648
local_output_nid generation:  0.03202342987060547
local_in_edges_tensor generation:  0.03540849685668945
mini_batch_src_global generation:  0.06090426445007324
r_  generation:  0.5684044361114502
local_output_nid generation:  0.03517913818359375
local_in_edges_tensor generation:  0.03391098976135254
mini_batch_src_global generation:  0.06588578224182129
r_  generation:  0.5364184379577637
local_output_nid generation:  0.03304791450500488
local_in_edges_tensor generation:  0.03284430503845215
mini_batch_src_global generation:  0.06300234794616699
r_  generation:  0.5468809604644775
local_output_nid generation:  0.03290367126464844
local_in_edges_tensor generation:  0.032785654067993164
mini_batch_src_global generation:  0.06176948547363281
r_  generation:  0.5412325859069824
local_output_nid generation:  0.03303861618041992
local_in_edges_tensor generation:  0.03409290313720703
mini_batch_src_global generation:  0.06252717971801758
r_  generation:  0.5436198711395264
local_output_nid generation:  0.03587770462036133
local_in_edges_tensor generation:  0.03228402137756348
mini_batch_src_global generation:  0.06169414520263672
r_  generation:  0.5401632785797119
local_output_nid generation:  0.032996416091918945
local_in_edges_tensor generation:  0.0344846248626709
mini_batch_src_global generation:  0.06322526931762695
r_  generation:  0.5434536933898926
local_output_nid generation:  0.03321981430053711
local_in_edges_tensor generation:  0.03261423110961914
mini_batch_src_global generation:  0.06100583076477051
r_  generation:  0.5427911281585693
----------------------check_connections_block total spend ----------------------------- 12.661067247390747
generate_one_block  0.6742498874664307
generate_one_block  0.6826343536376953
generate_one_block  0.670875072479248
generate_one_block  0.6764121055603027
generate_one_block  0.6746273040771484
generate_one_block  0.6933069229125977
generate_one_block  0.6837313175201416
generate_one_block  0.681969404220581
generate_one_block  0.745293140411377
generate_one_block  0.6695995330810547
generate_one_block  0.6852686405181885
generate_one_block  0.6740899085998535
generate_one_block  0.6742262840270996
generate_one_block  0.6789577007293701
generate_one_block  0.6742382049560547
generate_one_block  0.6719701290130615
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.12730169296264648  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

connection checking time:  18.88379406929016
block generation total time  16.513157606124878
average batch blocks generation time:  1.0320723503828049
block dataloader generation time/epoch 37.97028040885925
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09998512268066406  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7760744094848633  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0999150276184082  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7756695747375488  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.1009969711303711  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7830495834350586  GigaBytes
Max Memory Allocated: 0.8717999458312988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09996366500854492  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7762069702148438  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09969186782836914  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.775754451751709  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09974527359008789  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7684860229492188  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09978342056274414  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7722349166870117  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09965324401855469  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7734909057617188  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.1008615493774414  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7807283401489258  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09941577911376953  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.762092113494873  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10074329376220703  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7777819633483887  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09976482391357422  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7717447280883789  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.1007242202758789  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7715239524841309  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0998067855834961  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7719321250915527  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09965181350708008  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7719683647155762  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09975957870483398  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7713322639465332  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06520144641399384 |0.01407100260257721 |0.003415718674659729 |9.003281593322754e-05 |0.003227055072784424 |0.0013959407806396484 |
----------------------------------------------------------pseudo_mini_loss sum 1.5172921419143677
Total (block generation + training)time/epoch 39.44606399536133
Training time/epoch 1.4437048435211182
Training time without block to device /epoch 1.2185688018798828
Training time without total dataloading part /epoch 0.10912084579467773
load block tensor time/epoch 1.0432231426239014
block to device time/epoch 0.22513604164123535
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  5333028
Number of first layer input nodes during this epoch:  2522071
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.12839698791503906  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02196216583251953
range selection method range initialization spend 0.012740373611450195
time for parepare:  0.017328500747680664
local_output_nid generation:  0.0014657974243164062
local_in_edges_tensor generation:  0.004197597503662109
mini_batch_src_global generation:  0.0017025470733642578
r_  generation:  0.020235776901245117
local_output_nid generation:  0.0015680789947509766
local_in_edges_tensor generation:  0.0009801387786865234
mini_batch_src_global generation:  0.0020225048065185547
r_  generation:  0.022689104080200195
local_output_nid generation:  0.0015799999237060547
local_in_edges_tensor generation:  0.0009593963623046875
mini_batch_src_global generation:  0.0016760826110839844
r_  generation:  0.021034717559814453
local_output_nid generation:  0.0016357898712158203
local_in_edges_tensor generation:  0.0009753704071044922
mini_batch_src_global generation:  0.0016956329345703125
r_  generation:  0.02115774154663086
local_output_nid generation:  0.0016069412231445312
local_in_edges_tensor generation:  0.0009686946868896484
mini_batch_src_global generation:  0.0017230510711669922
r_  generation:  0.02123403549194336
local_output_nid generation:  0.0016226768493652344
local_in_edges_tensor generation:  0.0009407997131347656
mini_batch_src_global generation:  0.001699209213256836
r_  generation:  0.021357297897338867
local_output_nid generation:  0.001592874526977539
local_in_edges_tensor generation:  0.0010313987731933594
mini_batch_src_global generation:  0.0017490386962890625
r_  generation:  0.02243351936340332
local_output_nid generation:  0.0015726089477539062
local_in_edges_tensor generation:  0.000919342041015625
mini_batch_src_global generation:  0.001760721206665039
r_  generation:  0.021751880645751953
local_output_nid generation:  0.0015587806701660156
local_in_edges_tensor generation:  0.0009613037109375
mini_batch_src_global generation:  0.0017163753509521484
r_  generation:  0.022147655487060547
local_output_nid generation:  0.0015561580657958984
local_in_edges_tensor generation:  0.0009176731109619141
mini_batch_src_global generation:  0.0017619132995605469
r_  generation:  0.02227616310119629
local_output_nid generation:  0.0015430450439453125
local_in_edges_tensor generation:  0.0009238719940185547
mini_batch_src_global generation:  0.0017275810241699219
r_  generation:  0.021889448165893555
local_output_nid generation:  0.0015611648559570312
local_in_edges_tensor generation:  0.0009014606475830078
mini_batch_src_global generation:  0.0017008781433105469
r_  generation:  0.021739959716796875
local_output_nid generation:  0.0015728473663330078
local_in_edges_tensor generation:  0.0009176731109619141
mini_batch_src_global generation:  0.0017077922821044922
r_  generation:  0.022104740142822266
local_output_nid generation:  0.0015957355499267578
local_in_edges_tensor generation:  0.0009136199951171875
mini_batch_src_global generation:  0.0017075538635253906
r_  generation:  0.021886110305786133
local_output_nid generation:  0.0015964508056640625
local_in_edges_tensor generation:  0.0009069442749023438
mini_batch_src_global generation:  0.0017256736755371094
r_  generation:  0.021687746047973633
local_output_nid generation:  0.0015685558319091797
local_in_edges_tensor generation:  0.0008983612060546875
mini_batch_src_global generation:  0.0017247200012207031
r_  generation:  0.022166013717651367
----------------------check_connections_block total spend ----------------------------- 0.5134615898132324
generate_one_block  0.030324220657348633
generate_one_block  0.03156232833862305
generate_one_block  0.0305478572845459
generate_one_block  0.03092217445373535
generate_one_block  0.03072953224182129
generate_one_block  0.03280186653137207
generate_one_block  0.0321650505065918
generate_one_block  0.030890226364135742
generate_one_block  0.031249523162841797
generate_one_block  0.03128671646118164
generate_one_block  0.03118157386779785
generate_one_block  0.030857324600219727
generate_one_block  0.03125619888305664
generate_one_block  0.03079533576965332
generate_one_block  0.030916213989257812
generate_one_block  0.03191208839416504
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04391670227050781
gen group dst list time:  0.018348217010498047
time for parepare:  0.01935410499572754
local_output_nid generation:  0.007285594940185547
local_in_edges_tensor generation:  0.022415637969970703
mini_batch_src_global generation:  0.026595115661621094
r_  generation:  0.2408616542816162
local_output_nid generation:  0.011112689971923828
local_in_edges_tensor generation:  0.014940023422241211
mini_batch_src_global generation:  0.032193660736083984
r_  generation:  0.25887179374694824
local_output_nid generation:  0.012011289596557617
local_in_edges_tensor generation:  0.012893199920654297
mini_batch_src_global generation:  0.031091928482055664
r_  generation:  0.256742000579834
local_output_nid generation:  0.011964797973632812
local_in_edges_tensor generation:  0.01678919792175293
mini_batch_src_global generation:  0.03299999237060547
r_  generation:  0.26278042793273926
local_output_nid generation:  0.0118865966796875
local_in_edges_tensor generation:  0.013472795486450195
mini_batch_src_global generation:  0.03348994255065918
r_  generation:  0.2626497745513916
local_output_nid generation:  0.012307405471801758
local_in_edges_tensor generation:  0.014468669891357422
mini_batch_src_global generation:  0.03449654579162598
r_  generation:  0.2647054195404053
local_output_nid generation:  0.012963294982910156
local_in_edges_tensor generation:  0.01733994483947754
mini_batch_src_global generation:  0.03610682487487793
r_  generation:  0.2740814685821533
local_output_nid generation:  0.012735366821289062
local_in_edges_tensor generation:  0.013787508010864258
mini_batch_src_global generation:  0.03381538391113281
r_  generation:  0.26755237579345703
local_output_nid generation:  0.013237237930297852
local_in_edges_tensor generation:  0.014009237289428711
mini_batch_src_global generation:  0.03532218933105469
r_  generation:  0.27504825592041016
local_output_nid generation:  0.013192415237426758
local_in_edges_tensor generation:  0.01615619659423828
mini_batch_src_global generation:  0.03484702110290527
r_  generation:  0.27423977851867676
local_output_nid generation:  0.012906789779663086
local_in_edges_tensor generation:  0.013799428939819336
mini_batch_src_global generation:  0.034963130950927734
r_  generation:  0.2718162536621094
local_output_nid generation:  0.01288914680480957
local_in_edges_tensor generation:  0.014385223388671875
mini_batch_src_global generation:  0.034157514572143555
r_  generation:  0.2700200080871582
local_output_nid generation:  0.013109207153320312
local_in_edges_tensor generation:  0.014902591705322266
mini_batch_src_global generation:  0.03538084030151367
r_  generation:  0.2763490676879883
local_output_nid generation:  0.013100624084472656
local_in_edges_tensor generation:  0.013839244842529297
mini_batch_src_global generation:  0.03509187698364258
r_  generation:  0.2742750644683838
local_output_nid generation:  0.012455940246582031
local_in_edges_tensor generation:  0.013759136199951172
mini_batch_src_global generation:  0.03461503982543945
r_  generation:  0.2711806297302246
local_output_nid generation:  0.012382984161376953
local_in_edges_tensor generation:  0.01496434211730957
mini_batch_src_global generation:  0.03435707092285156
r_  generation:  0.27214574813842773
----------------------check_connections_block total spend ----------------------------- 6.1891069412231445
generate_one_block  0.3381378650665283
generate_one_block  0.3501293659210205
generate_one_block  0.33931922912597656
generate_one_block  0.34322094917297363
generate_one_block  0.3390011787414551
generate_one_block  0.3455164432525635
generate_one_block  0.3866257667541504
generate_one_block  0.3430969715118408
generate_one_block  0.3555610179901123
generate_one_block  0.3549816608428955
generate_one_block  0.35221290588378906
generate_one_block  0.34652233123779297
generate_one_block  0.3567640781402588
generate_one_block  0.3527255058288574
generate_one_block  0.35039758682250977
generate_one_block  0.34848856925964355
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.038495779037475586
gen group dst list time:  0.07996487617492676
time for parepare:  0.03138399124145508
local_output_nid generation:  0.029031038284301758
local_in_edges_tensor generation:  0.04383397102355957
mini_batch_src_global generation:  0.05241060256958008
r_  generation:  0.5321230888366699
local_output_nid generation:  0.03153872489929199
local_in_edges_tensor generation:  0.04532170295715332
mini_batch_src_global generation:  0.06780695915222168
r_  generation:  0.541701078414917
local_output_nid generation:  0.03430032730102539
local_in_edges_tensor generation:  0.03314995765686035
mini_batch_src_global generation:  0.06142115592956543
r_  generation:  0.5463376045227051
local_output_nid generation:  0.0349421501159668
local_in_edges_tensor generation:  0.0315556526184082
mini_batch_src_global generation:  0.05981874465942383
r_  generation:  0.5342199802398682
local_output_nid generation:  0.033288002014160156
local_in_edges_tensor generation:  0.09599471092224121
mini_batch_src_global generation:  0.06147480010986328
r_  generation:  0.5474512577056885
local_output_nid generation:  0.03244829177856445
local_in_edges_tensor generation:  0.033541202545166016
mini_batch_src_global generation:  0.06135249137878418
r_  generation:  0.5455973148345947
local_output_nid generation:  0.03354310989379883
local_in_edges_tensor generation:  0.036997318267822266
mini_batch_src_global generation:  0.06705832481384277
r_  generation:  0.5600733757019043
local_output_nid generation:  0.03300809860229492
local_in_edges_tensor generation:  0.03941011428833008
mini_batch_src_global generation:  0.06237173080444336
r_  generation:  0.5487773418426514
local_output_nid generation:  0.03276705741882324
local_in_edges_tensor generation:  0.03576779365539551
mini_batch_src_global generation:  0.06222200393676758
r_  generation:  0.5570597648620605
local_output_nid generation:  0.03293943405151367
local_in_edges_tensor generation:  0.044801950454711914
mini_batch_src_global generation:  0.07443118095397949
r_  generation:  0.5602250099182129
local_output_nid generation:  0.038898468017578125
local_in_edges_tensor generation:  0.03491997718811035
mini_batch_src_global generation:  0.06487536430358887
r_  generation:  0.5512599945068359
local_output_nid generation:  0.03714561462402344
local_in_edges_tensor generation:  0.03405356407165527
mini_batch_src_global generation:  0.0619351863861084
r_  generation:  0.5455069541931152
local_output_nid generation:  0.03748297691345215
local_in_edges_tensor generation:  0.031737327575683594
mini_batch_src_global generation:  0.06202983856201172
r_  generation:  0.5509610176086426
local_output_nid generation:  0.03741621971130371
local_in_edges_tensor generation:  0.03906083106994629
mini_batch_src_global generation:  0.07575201988220215
r_  generation:  0.5469412803649902
local_output_nid generation:  0.03725004196166992
local_in_edges_tensor generation:  0.03195381164550781
mini_batch_src_global generation:  0.06355786323547363
r_  generation:  0.5485162734985352
local_output_nid generation:  0.03809618949890137
local_in_edges_tensor generation:  0.0319523811340332
mini_batch_src_global generation:  0.06655502319335938
r_  generation:  0.5490272045135498
----------------------check_connections_block total spend ----------------------------- 12.965111255645752
generate_one_block  0.6979944705963135
generate_one_block  0.6862807273864746
generate_one_block  0.6871135234832764
generate_one_block  0.7022676467895508
generate_one_block  0.685481071472168
generate_one_block  0.6968019008636475
generate_one_block  0.6979575157165527
generate_one_block  0.6927187442779541
generate_one_block  0.7290728092193604
generate_one_block  0.6939895153045654
generate_one_block  0.6872811317443848
generate_one_block  0.6888799667358398
generate_one_block  0.6968226432800293
generate_one_block  0.7014298439025879
generate_one_block  0.6865501403808594
generate_one_block  0.6845080852508545
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.12839698791503906  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

connection checking time:  19.154218196868896
block generation total time  16.717851161956787
average batch blocks generation time:  1.0448656976222992
block dataloader generation time/epoch 37.99976634979248
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09937763214111328  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7641291618347168  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09984779357910156  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.771817684173584  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10064125061035156  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7705755233764648  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09974431991577148  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7751269340515137  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09965991973876953  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7683229446411133  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09950065612792969  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7647080421447754  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09996747970581055  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7779049873352051  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09978151321411133  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7729449272155762  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09995698928833008  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7775497436523438  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09971952438354492  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7733960151672363  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09974431991577148  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7700200080871582  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09961938858032227  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.769444465637207  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0998988151550293  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7779560089111328  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09988117218017578  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7730779647827148  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09980392456054688  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7725939750671387  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09975337982177734  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.772458553314209  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06472228467464447 |0.01505117118358612 |0.0034884214401245117 |9.097158908843994e-05 |0.0029748231172561646 |0.0017731189727783203 |
----------------------------------------------------------pseudo_mini_loss sum 1.4848519563674927
Total (block generation + training)time/epoch 39.468482971191406
Training time/epoch 1.4472432136535645
Training time without block to device /epoch 1.2064244747161865
Training time without total dataloading part /epoch 0.10664057731628418
load block tensor time/epoch 1.0355565547943115
block to device time/epoch 0.24081873893737793
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  5327038
Number of first layer input nodes during this epoch:  2520789
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.12842035293579102  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023434162139892578
range selection method range initialization spend 0.012915611267089844
time for parepare:  0.01786184310913086
local_output_nid generation:  0.0014581680297851562
local_in_edges_tensor generation:  0.007508993148803711
mini_batch_src_global generation:  0.0017888545989990234
r_  generation:  0.02147698402404785
local_output_nid generation:  0.0015933513641357422
local_in_edges_tensor generation:  0.0009982585906982422
mini_batch_src_global generation:  0.0020689964294433594
r_  generation:  0.022133827209472656
local_output_nid generation:  0.0015716552734375
local_in_edges_tensor generation:  0.000988006591796875
mini_batch_src_global generation:  0.0016818046569824219
r_  generation:  0.0212557315826416
local_output_nid generation:  0.0016109943389892578
local_in_edges_tensor generation:  0.0009691715240478516
mini_batch_src_global generation:  0.0017447471618652344
r_  generation:  0.02183222770690918
local_output_nid generation:  0.0015583038330078125
local_in_edges_tensor generation:  0.0009560585021972656
mini_batch_src_global generation:  0.0017461776733398438
r_  generation:  0.0220644474029541
local_output_nid generation:  0.0015988349914550781
local_in_edges_tensor generation:  0.0009551048278808594
mini_batch_src_global generation:  0.0017855167388916016
r_  generation:  0.02230358123779297
local_output_nid generation:  0.0015854835510253906
local_in_edges_tensor generation:  0.0009639263153076172
mini_batch_src_global generation:  0.0018057823181152344
r_  generation:  0.022377967834472656
local_output_nid generation:  0.0015916824340820312
local_in_edges_tensor generation:  0.0010037422180175781
mini_batch_src_global generation:  0.0017690658569335938
r_  generation:  0.021891355514526367
local_output_nid generation:  0.0015904903411865234
local_in_edges_tensor generation:  0.0010058879852294922
mini_batch_src_global generation:  0.0017473697662353516
r_  generation:  0.02229619026184082
local_output_nid generation:  0.0016336441040039062
local_in_edges_tensor generation:  0.0009720325469970703
mini_batch_src_global generation:  0.0017886161804199219
r_  generation:  0.02265167236328125
local_output_nid generation:  0.0015559196472167969
local_in_edges_tensor generation:  0.0009074211120605469
mini_batch_src_global generation:  0.0017533302307128906
r_  generation:  0.02232646942138672
local_output_nid generation:  0.0015561580657958984
local_in_edges_tensor generation:  0.0009372234344482422
mini_batch_src_global generation:  0.0017743110656738281
r_  generation:  0.02194070816040039
local_output_nid generation:  0.0015463829040527344
local_in_edges_tensor generation:  0.0009067058563232422
mini_batch_src_global generation:  0.0017206668853759766
r_  generation:  0.0217132568359375
local_output_nid generation:  0.0015330314636230469
local_in_edges_tensor generation:  0.0009474754333496094
mini_batch_src_global generation:  0.0017306804656982422
r_  generation:  0.02198481559753418
local_output_nid generation:  0.0015666484832763672
local_in_edges_tensor generation:  0.0009202957153320312
mini_batch_src_global generation:  0.0017807483673095703
r_  generation:  0.022116899490356445
local_output_nid generation:  0.0015735626220703125
local_in_edges_tensor generation:  0.0009222030639648438
mini_batch_src_global generation:  0.0018024444580078125
r_  generation:  0.022718429565429688
----------------------check_connections_block total spend ----------------------------- 0.5248148441314697
generate_one_block  0.0311434268951416
generate_one_block  0.0313112735748291
generate_one_block  0.03133392333984375
generate_one_block  0.03187870979309082
generate_one_block  0.031783103942871094
generate_one_block  0.03319120407104492
generate_one_block  0.03251767158508301
generate_one_block  0.031150341033935547
generate_one_block  0.031108856201171875
generate_one_block  0.03191351890563965
generate_one_block  0.031415700912475586
generate_one_block  0.03130698204040527
generate_one_block  0.03100299835205078
generate_one_block  0.03122258186340332
generate_one_block  0.03182864189147949
generate_one_block  0.03277587890625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04121541976928711
gen group dst list time:  0.018781185150146484
time for parepare:  0.02043938636779785
local_output_nid generation:  0.007779836654663086
local_in_edges_tensor generation:  0.026317596435546875
mini_batch_src_global generation:  0.02787041664123535
r_  generation:  0.25576019287109375
local_output_nid generation:  0.011229515075683594
local_in_edges_tensor generation:  0.01749587059020996
mini_batch_src_global generation:  0.03355836868286133
r_  generation:  0.2638976573944092
local_output_nid generation:  0.011640787124633789
local_in_edges_tensor generation:  0.013094425201416016
mini_batch_src_global generation:  0.03830862045288086
r_  generation:  0.26511335372924805
local_output_nid generation:  0.012298345565795898
local_in_edges_tensor generation:  0.015880823135375977
mini_batch_src_global generation:  0.03542208671569824
r_  generation:  0.2727494239807129
local_output_nid generation:  0.01279592514038086
local_in_edges_tensor generation:  0.017492055892944336
mini_batch_src_global generation:  0.03798818588256836
r_  generation:  0.27565836906433105
local_output_nid generation:  0.013067483901977539
local_in_edges_tensor generation:  0.016797304153442383
mini_batch_src_global generation:  0.034030914306640625
r_  generation:  0.27247118949890137
local_output_nid generation:  0.013327360153198242
local_in_edges_tensor generation:  0.0144500732421875
mini_batch_src_global generation:  0.035082101821899414
r_  generation:  0.27822208404541016
local_output_nid generation:  0.013009786605834961
local_in_edges_tensor generation:  0.0164949893951416
mini_batch_src_global generation:  0.038519859313964844
r_  generation:  0.2749180793762207
local_output_nid generation:  0.01317739486694336
local_in_edges_tensor generation:  0.014087200164794922
mini_batch_src_global generation:  0.03493309020996094
r_  generation:  0.27927184104919434
local_output_nid generation:  0.013463497161865234
local_in_edges_tensor generation:  0.01373600959777832
mini_batch_src_global generation:  0.034898996353149414
r_  generation:  0.2843453884124756
local_output_nid generation:  0.01551365852355957
local_in_edges_tensor generation:  0.014183759689331055
mini_batch_src_global generation:  0.03509879112243652
r_  generation:  0.2811133861541748
local_output_nid generation:  0.013565540313720703
local_in_edges_tensor generation:  0.014140844345092773
mini_batch_src_global generation:  0.03412938117980957
r_  generation:  0.2741281986236572
local_output_nid generation:  0.013512372970581055
local_in_edges_tensor generation:  0.014338254928588867
mini_batch_src_global generation:  0.03383016586303711
r_  generation:  0.2706727981567383
local_output_nid generation:  0.013226985931396484
local_in_edges_tensor generation:  0.013527393341064453
mini_batch_src_global generation:  0.03564095497131348
r_  generation:  0.2758934497833252
local_output_nid generation:  0.012926340103149414
local_in_edges_tensor generation:  0.014896154403686523
mini_batch_src_global generation:  0.034241437911987305
r_  generation:  0.27382874488830566
local_output_nid generation:  0.013216495513916016
local_in_edges_tensor generation:  0.018519163131713867
mini_batch_src_global generation:  0.036550045013427734
r_  generation:  0.2810826301574707
----------------------check_connections_block total spend ----------------------------- 6.34778094291687
generate_one_block  0.35256075859069824
generate_one_block  0.3464961051940918
generate_one_block  0.3464956283569336
generate_one_block  0.35662388801574707
generate_one_block  0.35637450218200684
generate_one_block  0.3485836982727051
generate_one_block  0.385465145111084
generate_one_block  0.34560370445251465
generate_one_block  0.35538291931152344
generate_one_block  0.354048490524292
generate_one_block  0.35337400436401367
generate_one_block  0.35140252113342285
generate_one_block  0.3446204662322998
generate_one_block  0.3512394428253174
generate_one_block  0.34905457496643066
generate_one_block  0.3622474670410156
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.039852142333984375
gen group dst list time:  0.0670309066772461
time for parepare:  0.01786494255065918
local_output_nid generation:  0.02619004249572754
local_in_edges_tensor generation:  0.053075313568115234
mini_batch_src_global generation:  0.04877018928527832
r_  generation:  0.5267412662506104
local_output_nid generation:  0.031023740768432617
local_in_edges_tensor generation:  0.0383448600769043
mini_batch_src_global generation:  0.061368703842163086
r_  generation:  0.5220437049865723
local_output_nid generation:  0.031540870666503906
local_in_edges_tensor generation:  0.03687024116516113
mini_batch_src_global generation:  0.05886054039001465
r_  generation:  0.5551455020904541
local_output_nid generation:  0.032242774963378906
local_in_edges_tensor generation:  0.03291893005371094
mini_batch_src_global generation:  0.05893659591674805
r_  generation:  0.5495524406433105
local_output_nid generation:  0.03232121467590332
local_in_edges_tensor generation:  0.07942438125610352
mini_batch_src_global generation:  0.060097694396972656
r_  generation:  0.5488457679748535
local_output_nid generation:  0.032309770584106445
local_in_edges_tensor generation:  0.032538652420043945
mini_batch_src_global generation:  0.06135368347167969
r_  generation:  0.5455358028411865
local_output_nid generation:  0.0319981575012207
local_in_edges_tensor generation:  0.037105560302734375
mini_batch_src_global generation:  0.060733795166015625
r_  generation:  0.548161506652832
local_output_nid generation:  0.0325627326965332
local_in_edges_tensor generation:  0.03287816047668457
mini_batch_src_global generation:  0.061704158782958984
r_  generation:  0.5412237644195557
local_output_nid generation:  0.03226923942565918
local_in_edges_tensor generation:  0.03216266632080078
mini_batch_src_global generation:  0.05984354019165039
r_  generation:  0.549701452255249
local_output_nid generation:  0.032942771911621094
local_in_edges_tensor generation:  0.03486227989196777
mini_batch_src_global generation:  0.06218242645263672
r_  generation:  0.5460057258605957
local_output_nid generation:  0.032645225524902344
local_in_edges_tensor generation:  0.03716921806335449
mini_batch_src_global generation:  0.06087374687194824
r_  generation:  0.5526919364929199
local_output_nid generation:  0.03270888328552246
local_in_edges_tensor generation:  0.03293037414550781
mini_batch_src_global generation:  0.061234474182128906
r_  generation:  0.5443999767303467
local_output_nid generation:  0.032814741134643555
local_in_edges_tensor generation:  0.04110217094421387
mini_batch_src_global generation:  0.06247854232788086
r_  generation:  0.5499932765960693
local_output_nid generation:  0.0327603816986084
local_in_edges_tensor generation:  0.033142805099487305
mini_batch_src_global generation:  0.061901092529296875
r_  generation:  0.5428216457366943
local_output_nid generation:  0.03261899948120117
local_in_edges_tensor generation:  0.03249835968017578
mini_batch_src_global generation:  0.06051898002624512
r_  generation:  0.5495960712432861
local_output_nid generation:  0.032788753509521484
local_in_edges_tensor generation:  0.03828787803649902
mini_batch_src_global generation:  0.06231069564819336
r_  generation:  0.5434284210205078
----------------------check_connections_block total spend ----------------------------- 12.739927291870117
generate_one_block  0.680527925491333
generate_one_block  0.6716182231903076
generate_one_block  0.6813571453094482
generate_one_block  0.6809370517730713
generate_one_block  0.6786270141601562
generate_one_block  0.681368350982666
generate_one_block  0.6823899745941162
generate_one_block  0.6813428401947021
generate_one_block  0.7468876838684082
generate_one_block  0.6856677532196045
generate_one_block  0.6786642074584961
generate_one_block  0.6824836730957031
generate_one_block  0.688025951385498
generate_one_block  0.6814630031585693
generate_one_block  0.6836669445037842
generate_one_block  0.6827938556671143
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.12842035293579102  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

connection checking time:  19.087708234786987
block generation total time  16.627394914627075
average batch blocks generation time:  1.0392121821641922
block dataloader generation time/epoch 37.97696714401245
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0998530387878418  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7807817459106445  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09961509704589844  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7628779411315918  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.1007680892944336  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7766189575195312  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09980487823486328  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7734322547912598  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09984016418457031  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7813639640808105  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09971332550048828  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7728290557861328  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10092735290527344  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7830758094787598  GigaBytes
Max Memory Allocated: 0.8724527359008789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0995941162109375  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7676405906677246  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09963655471801758  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7689766883850098  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09976482391357422  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.773465633392334  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09974145889282227  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.771308422088623  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09970474243164062  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7689542770385742  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10058116912841797  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7728047370910645  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09985113143920898  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7707958221435547  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09970808029174805  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7703409194946289  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09991455078125  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7805652618408203  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06548894941806793 |0.014610722661018372 |0.0034828484058380127 |9.164214134216309e-05 |0.0033553391695022583 |0.001956462860107422 |
----------------------------------------------------------pseudo_mini_loss sum 1.4560203552246094
Total (block generation + training)time/epoch 39.443681144714354
Training time/epoch 1.458498477935791
Training time without block to device /epoch 1.224726915359497
Training time without total dataloading part /epoch 0.11283373832702637
load block tensor time/epoch 1.047823190689087
block to device time/epoch 0.23377156257629395
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  5330701
Number of first layer input nodes during this epoch:  2521024
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.1296525001525879  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02364945411682129
range selection method range initialization spend 0.012093305587768555
time for parepare:  0.017299890518188477
local_output_nid generation:  0.001439809799194336
local_in_edges_tensor generation:  0.003400087356567383
mini_batch_src_global generation:  0.0017499923706054688
r_  generation:  0.020662546157836914
local_output_nid generation:  0.0015521049499511719
local_in_edges_tensor generation:  0.001009225845336914
mini_batch_src_global generation:  0.002043485641479492
r_  generation:  0.02237081527709961
local_output_nid generation:  0.0015723705291748047
local_in_edges_tensor generation:  0.0009334087371826172
mini_batch_src_global generation:  0.0016586780548095703
r_  generation:  0.021120071411132812
local_output_nid generation:  0.0015954971313476562
local_in_edges_tensor generation:  0.0009593963623046875
mini_batch_src_global generation:  0.0017490386962890625
r_  generation:  0.0218198299407959
local_output_nid generation:  0.0015573501586914062
local_in_edges_tensor generation:  0.0009348392486572266
mini_batch_src_global generation:  0.0017333030700683594
r_  generation:  0.021613597869873047
local_output_nid generation:  0.0015561580657958984
local_in_edges_tensor generation:  0.0009903907775878906
mini_batch_src_global generation:  0.0017542839050292969
r_  generation:  0.021689176559448242
local_output_nid generation:  0.0015931129455566406
local_in_edges_tensor generation:  0.0009107589721679688
mini_batch_src_global generation:  0.0017244815826416016
r_  generation:  0.02209758758544922
local_output_nid generation:  0.0015594959259033203
local_in_edges_tensor generation:  0.0009293556213378906
mini_batch_src_global generation:  0.0017666816711425781
r_  generation:  0.023094892501831055
local_output_nid generation:  0.0015835762023925781
local_in_edges_tensor generation:  0.0009601116180419922
mini_batch_src_global generation:  0.0017974376678466797
r_  generation:  0.02256298065185547
local_output_nid generation:  0.0015568733215332031
local_in_edges_tensor generation:  0.0009496212005615234
mini_batch_src_global generation:  0.0018084049224853516
r_  generation:  0.02283453941345215
local_output_nid generation:  0.0015382766723632812
local_in_edges_tensor generation:  0.00093841552734375
mini_batch_src_global generation:  0.0017843246459960938
r_  generation:  0.021895647048950195
local_output_nid generation:  0.0015709400177001953
local_in_edges_tensor generation:  0.0009274482727050781
mini_batch_src_global generation:  0.0017971992492675781
r_  generation:  0.022587060928344727
local_output_nid generation:  0.001550912857055664
local_in_edges_tensor generation:  0.0009121894836425781
mini_batch_src_global generation:  0.001781463623046875
r_  generation:  0.02257513999938965
local_output_nid generation:  0.0016429424285888672
local_in_edges_tensor generation:  0.0009400844573974609
mini_batch_src_global generation:  0.0017580986022949219
r_  generation:  0.022017955780029297
local_output_nid generation:  0.0015447139739990234
local_in_edges_tensor generation:  0.000911712646484375
mini_batch_src_global generation:  0.001714468002319336
r_  generation:  0.02195882797241211
local_output_nid generation:  0.001529693603515625
local_in_edges_tensor generation:  0.0009253025054931641
mini_batch_src_global generation:  0.0017704963684082031
r_  generation:  0.022951602935791016
----------------------check_connections_block total spend ----------------------------- 0.521714448928833
generate_one_block  0.03064441680908203
generate_one_block  0.031449079513549805
generate_one_block  0.030146360397338867
generate_one_block  0.031560659408569336
generate_one_block  0.03081965446472168
generate_one_block  0.03272676467895508
generate_one_block  0.03110671043395996
generate_one_block  0.03229069709777832
generate_one_block  0.03147721290588379
generate_one_block  0.0323183536529541
generate_one_block  0.031205415725708008
generate_one_block  0.03243422508239746
generate_one_block  0.03180646896362305
generate_one_block  0.031070470809936523
generate_one_block  0.03122735023498535
generate_one_block  0.032944440841674805
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04247927665710449
gen group dst list time:  0.018212080001831055
time for parepare:  0.020739316940307617
local_output_nid generation:  0.007386445999145508
local_in_edges_tensor generation:  0.021831989288330078
mini_batch_src_global generation:  0.026187896728515625
r_  generation:  0.2492198944091797
local_output_nid generation:  0.011189460754394531
local_in_edges_tensor generation:  0.013817310333251953
mini_batch_src_global generation:  0.03990483283996582
r_  generation:  0.2671964168548584
local_output_nid generation:  0.011594295501708984
local_in_edges_tensor generation:  0.016353845596313477
mini_batch_src_global generation:  0.032262325286865234
r_  generation:  0.26411914825439453
local_output_nid generation:  0.015155553817749023
local_in_edges_tensor generation:  0.018219709396362305
mini_batch_src_global generation:  0.03802657127380371
r_  generation:  0.27343010902404785
local_output_nid generation:  0.012987136840820312
local_in_edges_tensor generation:  0.015574216842651367
mini_batch_src_global generation:  0.034577369689941406
r_  generation:  0.26737451553344727
local_output_nid generation:  0.01321268081665039
local_in_edges_tensor generation:  0.01585245132446289
mini_batch_src_global generation:  0.033664703369140625
r_  generation:  0.270827054977417
local_output_nid generation:  0.013118267059326172
local_in_edges_tensor generation:  0.013278484344482422
mini_batch_src_global generation:  0.033716440200805664
r_  generation:  0.26900482177734375
local_output_nid generation:  0.01347208023071289
local_in_edges_tensor generation:  0.016280174255371094
mini_batch_src_global generation:  0.036115407943725586
r_  generation:  0.2809901237487793
local_output_nid generation:  0.013508796691894531
local_in_edges_tensor generation:  0.014568090438842773
mini_batch_src_global generation:  0.035131216049194336
r_  generation:  0.27417778968811035
local_output_nid generation:  0.013683080673217773
local_in_edges_tensor generation:  0.017548799514770508
mini_batch_src_global generation:  0.03778791427612305
r_  generation:  0.27789831161499023
local_output_nid generation:  0.013025045394897461
local_in_edges_tensor generation:  0.013771772384643555
mini_batch_src_global generation:  0.03508448600769043
r_  generation:  0.2721691131591797
local_output_nid generation:  0.013674259185791016
local_in_edges_tensor generation:  0.013712406158447266
mini_batch_src_global generation:  0.03494739532470703
r_  generation:  0.2797970771789551
local_output_nid generation:  0.013644218444824219
local_in_edges_tensor generation:  0.014107227325439453
mini_batch_src_global generation:  0.03522038459777832
r_  generation:  0.2761576175689697
local_output_nid generation:  0.013570308685302734
local_in_edges_tensor generation:  0.014012336730957031
mini_batch_src_global generation:  0.034497737884521484
r_  generation:  0.27680492401123047
local_output_nid generation:  0.012923240661621094
local_in_edges_tensor generation:  0.014177799224853516
mini_batch_src_global generation:  0.034517526626586914
r_  generation:  0.2718472480773926
local_output_nid generation:  0.013010501861572266
local_in_edges_tensor generation:  0.014268636703491211
mini_batch_src_global generation:  0.03485298156738281
r_  generation:  0.28214287757873535
----------------------check_connections_block total spend ----------------------------- 6.306135892868042
generate_one_block  0.35352134704589844
generate_one_block  0.3463613986968994
generate_one_block  0.33628106117248535
generate_one_block  0.35358333587646484
generate_one_block  0.34027743339538574
generate_one_block  0.3427112102508545
generate_one_block  0.3732776641845703
generate_one_block  0.3611791133880615
generate_one_block  0.3524003028869629
generate_one_block  0.3553745746612549
generate_one_block  0.35416460037231445
generate_one_block  0.35997748374938965
generate_one_block  0.3551661968231201
generate_one_block  0.35043764114379883
generate_one_block  0.34557223320007324
generate_one_block  0.3571627140045166
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03459048271179199
gen group dst list time:  0.0668950080871582
time for parepare:  0.017806529998779297
local_output_nid generation:  0.025839805603027344
local_in_edges_tensor generation:  0.05101919174194336
mini_batch_src_global generation:  0.04887866973876953
r_  generation:  0.527604341506958
local_output_nid generation:  0.030717849731445312
local_in_edges_tensor generation:  0.03642129898071289
mini_batch_src_global generation:  0.06172323226928711
r_  generation:  0.5281543731689453
local_output_nid generation:  0.03157472610473633
local_in_edges_tensor generation:  0.03384232521057129
mini_batch_src_global generation:  0.061186790466308594
r_  generation:  0.5423424243927002
local_output_nid generation:  0.03185153007507324
local_in_edges_tensor generation:  0.036040544509887695
mini_batch_src_global generation:  0.05976223945617676
r_  generation:  0.5387980937957764
local_output_nid generation:  0.03206658363342285
local_in_edges_tensor generation:  0.08262419700622559
mini_batch_src_global generation:  0.06378507614135742
r_  generation:  0.5454063415527344
local_output_nid generation:  0.03200650215148926
local_in_edges_tensor generation:  0.03346729278564453
mini_batch_src_global generation:  0.060513973236083984
r_  generation:  0.5448627471923828
local_output_nid generation:  0.03211784362792969
local_in_edges_tensor generation:  0.03412938117980957
mini_batch_src_global generation:  0.06275486946105957
r_  generation:  0.5503461360931396
local_output_nid generation:  0.03205227851867676
local_in_edges_tensor generation:  0.03261518478393555
mini_batch_src_global generation:  0.0611567497253418
r_  generation:  0.5547683238983154
local_output_nid generation:  0.03268623352050781
local_in_edges_tensor generation:  0.0364990234375
mini_batch_src_global generation:  0.06359505653381348
r_  generation:  0.5526208877563477
local_output_nid generation:  0.03267383575439453
local_in_edges_tensor generation:  0.03718829154968262
mini_batch_src_global generation:  0.061903953552246094
r_  generation:  0.552445650100708
local_output_nid generation:  0.03267025947570801
local_in_edges_tensor generation:  0.03516793251037598
mini_batch_src_global generation:  0.0611271858215332
r_  generation:  0.5588076114654541
local_output_nid generation:  0.03263258934020996
local_in_edges_tensor generation:  0.03954339027404785
mini_batch_src_global generation:  0.06470441818237305
r_  generation:  0.5515744686126709
local_output_nid generation:  0.032998085021972656
local_in_edges_tensor generation:  0.03247642517089844
mini_batch_src_global generation:  0.061181068420410156
r_  generation:  0.5509271621704102
local_output_nid generation:  0.03252220153808594
local_in_edges_tensor generation:  0.03240561485290527
mini_batch_src_global generation:  0.06395840644836426
r_  generation:  0.5466098785400391
local_output_nid generation:  0.032470703125
local_in_edges_tensor generation:  0.03546261787414551
mini_batch_src_global generation:  0.06123161315917969
r_  generation:  0.5487985610961914
local_output_nid generation:  0.03274369239807129
local_in_edges_tensor generation:  0.03872370719909668
mini_batch_src_global generation:  0.06393814086914062
r_  generation:  0.5506861209869385
----------------------check_connections_block total spend ----------------------------- 12.799024105072021
generate_one_block  0.6779918670654297
generate_one_block  0.6753432750701904
generate_one_block  0.687671422958374
generate_one_block  0.6752862930297852
generate_one_block  0.6792504787445068
generate_one_block  0.6861414909362793
generate_one_block  0.6817033290863037
generate_one_block  0.6761941909790039
generate_one_block  0.7227680683135986
generate_one_block  0.6781883239746094
generate_one_block  0.6810557842254639
generate_one_block  0.6870908737182617
generate_one_block  0.6787283420562744
generate_one_block  0.6867852210998535
generate_one_block  0.6733474731445312
generate_one_block  0.6930098533630371
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.1296525001525879  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

connection checking time:  19.105159997940063
block generation total time  16.578004598617554
average batch blocks generation time:  1.036125287413597
block dataloader generation time/epoch 37.956899642944336
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0996694564819336  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7667579650878906  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09958744049072266  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7694635391235352  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10056304931640625  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7718415260314941  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09994697570800781  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7765331268310547  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10065174102783203  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7693791389465332  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09964656829833984  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7738981246948242  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09968900680541992  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7660737037658691  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09988975524902344  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7765274047851562  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09966802597045898  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7762384414672852  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0998539924621582  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7738218307495117  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09965181350708008  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7697062492370605  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09998703002929688  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7817888259887695  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09990215301513672  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7797102928161621  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09981870651245117  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7752041816711426  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09961080551147461  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.769709587097168  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09992456436157227  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7812480926513672  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06972630321979523 |0.014001116156578064 |0.003518432378768921 |9.021162986755371e-05 |0.0037549734115600586 |0.0030558109283447266 |
----------------------------------------------------------pseudo_mini_loss sum 1.4283920526504517
Total (block generation + training)time/epoch 39.43309144179026
Training time/epoch 1.5233514308929443
Training time without block to device /epoch 1.2993335723876953
Training time without total dataloading part /epoch 0.12087368965148926
load block tensor time/epoch 1.1156208515167236
block to device time/epoch 0.22401785850524902
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  5331467
Number of first layer input nodes during this epoch:  2521684
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.12963342666625977  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02331089973449707
range selection method range initialization spend 0.01205301284790039
time for parepare:  0.016621828079223633
local_output_nid generation:  0.0014541149139404297
local_in_edges_tensor generation:  0.003168344497680664
mini_batch_src_global generation:  0.0017330646514892578
r_  generation:  0.020844459533691406
local_output_nid generation:  0.0015859603881835938
local_in_edges_tensor generation:  0.0009853839874267578
mini_batch_src_global generation:  0.0019788742065429688
r_  generation:  0.022391796112060547
local_output_nid generation:  0.0016002655029296875
local_in_edges_tensor generation:  0.0009572505950927734
mini_batch_src_global generation:  0.0016875267028808594
r_  generation:  0.02072763442993164
local_output_nid generation:  0.0015964508056640625
local_in_edges_tensor generation:  0.0009331703186035156
mini_batch_src_global generation:  0.0017368793487548828
r_  generation:  0.021389484405517578
local_output_nid generation:  0.0015807151794433594
local_in_edges_tensor generation:  0.0009226799011230469
mini_batch_src_global generation:  0.0017571449279785156
r_  generation:  0.021474123001098633
local_output_nid generation:  0.0015869140625
local_in_edges_tensor generation:  0.0009524822235107422
mini_batch_src_global generation:  0.0017862319946289062
r_  generation:  0.02222156524658203
local_output_nid generation:  0.0015842914581298828
local_in_edges_tensor generation:  0.0009367465972900391
mini_batch_src_global generation:  0.0017940998077392578
r_  generation:  0.022342920303344727
local_output_nid generation:  0.0015969276428222656
local_in_edges_tensor generation:  0.0009288787841796875
mini_batch_src_global generation:  0.0017991065979003906
r_  generation:  0.02261495590209961
local_output_nid generation:  0.0015671253204345703
local_in_edges_tensor generation:  0.0009667873382568359
mini_batch_src_global generation:  0.0018024444580078125
r_  generation:  0.02223658561706543
local_output_nid generation:  0.0015790462493896484
local_in_edges_tensor generation:  0.0009529590606689453
mini_batch_src_global generation:  0.0018045902252197266
r_  generation:  0.022189855575561523
local_output_nid generation:  0.0015878677368164062
local_in_edges_tensor generation:  0.00093841552734375
mini_batch_src_global generation:  0.0017795562744140625
r_  generation:  0.021773099899291992
local_output_nid generation:  0.001585245132446289
local_in_edges_tensor generation:  0.0009350776672363281
mini_batch_src_global generation:  0.0017163753509521484
r_  generation:  0.021689414978027344
local_output_nid generation:  0.001592397689819336
local_in_edges_tensor generation:  0.0009334087371826172
mini_batch_src_global generation:  0.0018131732940673828
r_  generation:  0.02279949188232422
local_output_nid generation:  0.0015823841094970703
local_in_edges_tensor generation:  0.0009262561798095703
mini_batch_src_global generation:  0.001798868179321289
r_  generation:  0.022563457489013672
local_output_nid generation:  0.001613616943359375
local_in_edges_tensor generation:  0.000934600830078125
mini_batch_src_global generation:  0.0018246173858642578
r_  generation:  0.022623777389526367
local_output_nid generation:  0.0015726089477539062
local_in_edges_tensor generation:  0.0009541511535644531
mini_batch_src_global generation:  0.0018286705017089844
r_  generation:  0.02218484878540039
----------------------check_connections_block total spend ----------------------------- 0.5182814598083496
generate_one_block  0.029998064041137695
generate_one_block  0.03162384033203125
generate_one_block  0.03045487403869629
generate_one_block  0.031195402145385742
generate_one_block  0.0313265323638916
generate_one_block  0.03309011459350586
generate_one_block  0.03158688545227051
generate_one_block  0.031874656677246094
generate_one_block  0.03184366226196289
generate_one_block  0.030916213989257812
generate_one_block  0.030588388442993164
generate_one_block  0.030770063400268555
generate_one_block  0.03218364715576172
generate_one_block  0.03137779235839844
generate_one_block  0.03209877014160156
generate_one_block  0.031481266021728516
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03919172286987305
gen group dst list time:  0.018115997314453125
time for parepare:  0.019440650939941406
local_output_nid generation:  0.007303953170776367
local_in_edges_tensor generation:  0.01919865608215332
mini_batch_src_global generation:  0.026665449142456055
r_  generation:  0.24555158615112305
local_output_nid generation:  0.011192083358764648
local_in_edges_tensor generation:  0.016031742095947266
mini_batch_src_global generation:  0.03208661079406738
r_  generation:  0.2586042881011963
local_output_nid generation:  0.011853456497192383
local_in_edges_tensor generation:  0.014819860458374023
mini_batch_src_global generation:  0.031531572341918945
r_  generation:  0.26223278045654297
local_output_nid generation:  0.012523412704467773
local_in_edges_tensor generation:  0.015273332595825195
mini_batch_src_global generation:  0.03364825248718262
r_  generation:  0.2695152759552002
local_output_nid generation:  0.01246333122253418
local_in_edges_tensor generation:  0.015476226806640625
mini_batch_src_global generation:  0.03399491310119629
r_  generation:  0.27491188049316406
local_output_nid generation:  0.012745141983032227
local_in_edges_tensor generation:  0.014622688293457031
mini_batch_src_global generation:  0.03543996810913086
r_  generation:  0.2738461494445801
local_output_nid generation:  0.013340473175048828
local_in_edges_tensor generation:  0.01575446128845215
mini_batch_src_global generation:  0.046723127365112305
r_  generation:  0.2797212600708008
local_output_nid generation:  0.014549016952514648
local_in_edges_tensor generation:  0.013885974884033203
mini_batch_src_global generation:  0.03479719161987305
r_  generation:  0.2772216796875
local_output_nid generation:  0.01328897476196289
local_in_edges_tensor generation:  0.013686656951904297
mini_batch_src_global generation:  0.03533744812011719
r_  generation:  0.27641773223876953
local_output_nid generation:  0.013457536697387695
local_in_edges_tensor generation:  0.014041662216186523
mini_batch_src_global generation:  0.03400754928588867
r_  generation:  0.27321863174438477
local_output_nid generation:  0.012672185897827148
local_in_edges_tensor generation:  0.01334238052368164
mini_batch_src_global generation:  0.034110069274902344
r_  generation:  0.27565622329711914
local_output_nid generation:  0.013508319854736328
local_in_edges_tensor generation:  0.013576507568359375
mini_batch_src_global generation:  0.03400683403015137
r_  generation:  0.2708408832550049
local_output_nid generation:  0.013647079467773438
local_in_edges_tensor generation:  0.015057563781738281
mini_batch_src_global generation:  0.036867380142211914
r_  generation:  0.28165173530578613
local_output_nid generation:  0.013656377792358398
local_in_edges_tensor generation:  0.013823986053466797
mini_batch_src_global generation:  0.03478813171386719
r_  generation:  0.27443695068359375
local_output_nid generation:  0.013692140579223633
local_in_edges_tensor generation:  0.016440153121948242
mini_batch_src_global generation:  0.03650474548339844
r_  generation:  0.2850360870361328
local_output_nid generation:  0.012842655181884766
local_in_edges_tensor generation:  0.014242410659790039
mini_batch_src_global generation:  0.03797745704650879
r_  generation:  0.27356600761413574
----------------------check_connections_block total spend ----------------------------- 6.298214912414551
generate_one_block  0.3464977741241455
generate_one_block  0.34577083587646484
generate_one_block  0.34793567657470703
generate_one_block  0.3510866165161133
generate_one_block  0.3526425361633301
generate_one_block  0.35145044326782227
generate_one_block  0.3800375461578369
generate_one_block  0.3517739772796631
generate_one_block  0.35229063034057617
generate_one_block  0.34560585021972656
generate_one_block  0.3409581184387207
generate_one_block  0.34810590744018555
generate_one_block  0.360490083694458
generate_one_block  0.34907054901123047
generate_one_block  0.3641693592071533
generate_one_block  0.3467710018157959
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03630805015563965
gen group dst list time:  0.06607532501220703
time for parepare:  0.0178070068359375
local_output_nid generation:  0.026610851287841797
local_in_edges_tensor generation:  0.042949676513671875
mini_batch_src_global generation:  0.0512697696685791
r_  generation:  0.5261440277099609
local_output_nid generation:  0.031848907470703125
local_in_edges_tensor generation:  0.03977084159851074
mini_batch_src_global generation:  0.0634467601776123
r_  generation:  0.5303943157196045
local_output_nid generation:  0.03173255920410156
local_in_edges_tensor generation:  0.033385515213012695
mini_batch_src_global generation:  0.059987783432006836
r_  generation:  0.5369789600372314
local_output_nid generation:  0.031716108322143555
local_in_edges_tensor generation:  0.03142499923706055
mini_batch_src_global generation:  0.06068539619445801
r_  generation:  0.5366723537445068
local_output_nid generation:  0.032111406326293945
local_in_edges_tensor generation:  0.08069443702697754
mini_batch_src_global generation:  0.0627894401550293
r_  generation:  0.546173095703125
local_output_nid generation:  0.03266477584838867
local_in_edges_tensor generation:  0.03318619728088379
mini_batch_src_global generation:  0.06283426284790039
r_  generation:  0.5447375774383545
local_output_nid generation:  0.032666921615600586
local_in_edges_tensor generation:  0.031566619873046875
mini_batch_src_global generation:  0.0617060661315918
r_  generation:  0.5499420166015625
local_output_nid generation:  0.032491207122802734
local_in_edges_tensor generation:  0.03165793418884277
mini_batch_src_global generation:  0.06220555305480957
r_  generation:  0.5481066703796387
local_output_nid generation:  0.032549142837524414
local_in_edges_tensor generation:  0.033397674560546875
mini_batch_src_global generation:  0.0615994930267334
r_  generation:  0.5443463325500488
local_output_nid generation:  0.03293728828430176
local_in_edges_tensor generation:  0.03460526466369629
mini_batch_src_global generation:  0.06502032279968262
r_  generation:  0.5488090515136719
local_output_nid generation:  0.03243374824523926
local_in_edges_tensor generation:  0.03237414360046387
mini_batch_src_global generation:  0.06460142135620117
r_  generation:  0.543187141418457
local_output_nid generation:  0.03293895721435547
local_in_edges_tensor generation:  0.03200984001159668
mini_batch_src_global generation:  0.06282162666320801
r_  generation:  0.5441110134124756
local_output_nid generation:  0.03289961814880371
local_in_edges_tensor generation:  0.03306436538696289
mini_batch_src_global generation:  0.06472468376159668
r_  generation:  0.5493488311767578
local_output_nid generation:  0.03310251235961914
local_in_edges_tensor generation:  0.03255176544189453
mini_batch_src_global generation:  0.06277632713317871
r_  generation:  0.5457363128662109
local_output_nid generation:  0.03313493728637695
local_in_edges_tensor generation:  0.03627300262451172
mini_batch_src_global generation:  0.0621185302734375
r_  generation:  0.555535078048706
local_output_nid generation:  0.033187150955200195
local_in_edges_tensor generation:  0.040431976318359375
mini_batch_src_global generation:  0.06310081481933594
r_  generation:  0.5429506301879883
----------------------check_connections_block total spend ----------------------------- 12.742799282073975
generate_one_block  0.6834323406219482
generate_one_block  0.6803412437438965
generate_one_block  0.6798431873321533
generate_one_block  0.6869926452636719
generate_one_block  0.6857771873474121
generate_one_block  0.680891752243042
generate_one_block  0.6839535236358643
generate_one_block  0.6945114135742188
generate_one_block  0.7411301136016846
generate_one_block  0.6849634647369385
generate_one_block  0.6730391979217529
generate_one_block  0.685114860534668
generate_one_block  0.6890683174133301
generate_one_block  0.6815009117126465
generate_one_block  0.6844148635864258
generate_one_block  0.6786746978759766
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.12963342666625977  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

connection checking time:  19.041014194488525
block generation total time  16.62830662727356
average batch blocks generation time:  1.0392691642045975
block dataloader generation time/epoch 37.94127491542271
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09955263137817383  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7665777206420898  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09967660903930664  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7698354721069336  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10067939758300781  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7699699401855469  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09975433349609375  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7733149528503418  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09982728958129883  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7728619575500488  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0999140739440918  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7795262336730957  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09984827041625977  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7737326622009277  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0998382568359375  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7766785621643066  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09972190856933594  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7712268829345703  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09975051879882812  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7743282318115234  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09943675994873047  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.763063907623291  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0996103286743164  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7702059745788574  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09992027282714844  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7813353538513184  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09974193572998047  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7753872871398926  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10103416442871094  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7821745872497559  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09963417053222656  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7711281776428223  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0657544732093811 |0.014247789978981018 |0.003454446792602539 |9.073317050933838e-05 |0.0033911168575286865 |0.0017704963684082031 |
----------------------------------------------------------pseudo_mini_loss sum 1.3956177234649658
Total (block generation + training)time/epoch 39.427159547805786
Training time/epoch 1.5437757968902588
Training time without block to device /epoch 1.3158111572265625
Training time without total dataloading part /epoch 0.11275124549865723
load block tensor time/epoch 1.0520715713500977
block to device time/epoch 0.2279646396636963
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  5330272
Number of first layer input nodes during this epoch:  2520950
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.1282820701599121  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021488189697265625
range selection method range initialization spend 0.012107610702514648
time for parepare:  0.016544818878173828
local_output_nid generation:  0.0014100074768066406
local_in_edges_tensor generation:  0.0033111572265625
mini_batch_src_global generation:  0.0017743110656738281
r_  generation:  0.02058887481689453
local_output_nid generation:  0.0015683174133300781
local_in_edges_tensor generation:  0.0009937286376953125
mini_batch_src_global generation:  0.0020983219146728516
r_  generation:  0.023199796676635742
local_output_nid generation:  0.0015609264373779297
local_in_edges_tensor generation:  0.0009434223175048828
mini_batch_src_global generation:  0.001703500747680664
r_  generation:  0.022135257720947266
local_output_nid generation:  0.00154876708984375
local_in_edges_tensor generation:  0.000942230224609375
mini_batch_src_global generation:  0.0017533302307128906
r_  generation:  0.021610260009765625
local_output_nid generation:  0.0015461444854736328
local_in_edges_tensor generation:  0.0009095668792724609
mini_batch_src_global generation:  0.0017886161804199219
r_  generation:  0.02179741859436035
local_output_nid generation:  0.0015869140625
local_in_edges_tensor generation:  0.0009317398071289062
mini_batch_src_global generation:  0.0017578601837158203
r_  generation:  0.02209329605102539
local_output_nid generation:  0.0015766620635986328
local_in_edges_tensor generation:  0.0009281635284423828
mini_batch_src_global generation:  0.0017540454864501953
r_  generation:  0.02237987518310547
local_output_nid generation:  0.001561880111694336
local_in_edges_tensor generation:  0.0010356903076171875
mini_batch_src_global generation:  0.0017926692962646484
r_  generation:  0.021818161010742188
local_output_nid generation:  0.0015723705291748047
local_in_edges_tensor generation:  0.0009570121765136719
mini_batch_src_global generation:  0.0017709732055664062
r_  generation:  0.02208089828491211
local_output_nid generation:  0.0015873908996582031
local_in_edges_tensor generation:  0.0009520053863525391
mini_batch_src_global generation:  0.0018184185028076172
r_  generation:  0.021953821182250977
local_output_nid generation:  0.0015702247619628906
local_in_edges_tensor generation:  0.0009517669677734375
mini_batch_src_global generation:  0.0017588138580322266
r_  generation:  0.022185087203979492
local_output_nid generation:  0.0015726089477539062
local_in_edges_tensor generation:  0.0009310245513916016
mini_batch_src_global generation:  0.0017724037170410156
r_  generation:  0.02196025848388672
local_output_nid generation:  0.0015652179718017578
local_in_edges_tensor generation:  0.0009169578552246094
mini_batch_src_global generation:  0.0017445087432861328
r_  generation:  0.022318124771118164
local_output_nid generation:  0.0015690326690673828
local_in_edges_tensor generation:  0.0009455680847167969
mini_batch_src_global generation:  0.001745462417602539
r_  generation:  0.022092342376708984
local_output_nid generation:  0.00154876708984375
local_in_edges_tensor generation:  0.0009181499481201172
mini_batch_src_global generation:  0.0018875598907470703
r_  generation:  0.022602319717407227
local_output_nid generation:  0.0015485286712646484
local_in_edges_tensor generation:  0.0009233951568603516
mini_batch_src_global generation:  0.0017652511596679688
r_  generation:  0.022418737411499023
----------------------check_connections_block total spend ----------------------------- 0.5188121795654297
generate_one_block  0.03036952018737793
generate_one_block  0.0321962833404541
generate_one_block  0.031173229217529297
generate_one_block  0.030946969985961914
generate_one_block  0.03106999397277832
generate_one_block  0.03321480751037598
generate_one_block  0.031563520431518555
generate_one_block  0.030783414840698242
generate_one_block  0.031124353408813477
generate_one_block  0.030983924865722656
generate_one_block  0.03124070167541504
generate_one_block  0.03125143051147461
generate_one_block  0.031494855880737305
generate_one_block  0.030841350555419922
generate_one_block  0.03150010108947754
generate_one_block  0.031745195388793945
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.09518790245056152
gen group dst list time:  0.02060246467590332
time for parepare:  0.01963639259338379
local_output_nid generation:  0.0074672698974609375
local_in_edges_tensor generation:  0.024039030075073242
mini_batch_src_global generation:  0.0279238224029541
r_  generation:  0.24622797966003418
local_output_nid generation:  0.011256933212280273
local_in_edges_tensor generation:  0.017615795135498047
mini_batch_src_global generation:  0.03455162048339844
r_  generation:  0.26691555976867676
local_output_nid generation:  0.011525154113769531
local_in_edges_tensor generation:  0.015166044235229492
mini_batch_src_global generation:  0.03332066535949707
r_  generation:  0.26315879821777344
local_output_nid generation:  0.012269973754882812
local_in_edges_tensor generation:  0.015391826629638672
mini_batch_src_global generation:  0.033043861389160156
r_  generation:  0.2663004398345947
local_output_nid generation:  0.012411117553710938
local_in_edges_tensor generation:  0.013553857803344727
mini_batch_src_global generation:  0.03555893898010254
r_  generation:  0.27072715759277344
local_output_nid generation:  0.012454032897949219
local_in_edges_tensor generation:  0.013623237609863281
mini_batch_src_global generation:  0.03386807441711426
r_  generation:  0.2714977264404297
local_output_nid generation:  0.012892007827758789
local_in_edges_tensor generation:  0.016744136810302734
mini_batch_src_global generation:  0.0344235897064209
r_  generation:  0.2722187042236328
local_output_nid generation:  0.012704849243164062
local_in_edges_tensor generation:  0.017012357711791992
mini_batch_src_global generation:  0.03508305549621582
r_  generation:  0.26432085037231445
local_output_nid generation:  0.013055801391601562
local_in_edges_tensor generation:  0.01360464096069336
mini_batch_src_global generation:  0.034897804260253906
r_  generation:  0.27164220809936523
local_output_nid generation:  0.01294565200805664
local_in_edges_tensor generation:  0.01391148567199707
mini_batch_src_global generation:  0.034442901611328125
r_  generation:  0.2706425189971924
local_output_nid generation:  0.012810230255126953
local_in_edges_tensor generation:  0.013537406921386719
mini_batch_src_global generation:  0.036263465881347656
r_  generation:  0.27459216117858887
local_output_nid generation:  0.013063192367553711
local_in_edges_tensor generation:  0.014906167984008789
mini_batch_src_global generation:  0.03471851348876953
r_  generation:  0.27245402336120605
local_output_nid generation:  0.012983560562133789
local_in_edges_tensor generation:  0.013871431350708008
mini_batch_src_global generation:  0.03448176383972168
r_  generation:  0.2740182876586914
local_output_nid generation:  0.013044357299804688
local_in_edges_tensor generation:  0.013989925384521484
mini_batch_src_global generation:  0.034508466720581055
r_  generation:  0.2696564197540283
local_output_nid generation:  0.012651443481445312
local_in_edges_tensor generation:  0.014070510864257812
mini_batch_src_global generation:  0.03661322593688965
r_  generation:  0.2771468162536621
local_output_nid generation:  0.012273788452148438
local_in_edges_tensor generation:  0.014845609664916992
mini_batch_src_global generation:  0.03485512733459473
r_  generation:  0.27553415298461914
----------------------check_connections_block total spend ----------------------------- 6.241702318191528
generate_one_block  0.34511542320251465
generate_one_block  0.35648512840270996
generate_one_block  0.3497171401977539
generate_one_block  0.34899282455444336
generate_one_block  0.3523519039154053
generate_one_block  0.35246729850769043
generate_one_block  0.3770146369934082
generate_one_block  0.3447909355163574
generate_one_block  0.3477480411529541
generate_one_block  0.347459077835083
generate_one_block  0.35640931129455566
generate_one_block  0.3518986701965332
generate_one_block  0.3486747741699219
generate_one_block  0.3457636833190918
generate_one_block  0.36124467849731445
generate_one_block  0.3482484817504883
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.032820940017700195
gen group dst list time:  0.06950664520263672
time for parepare:  0.018127918243408203
local_output_nid generation:  0.02590036392211914
local_in_edges_tensor generation:  0.0510256290435791
mini_batch_src_global generation:  0.05074739456176758
r_  generation:  0.5201437473297119
local_output_nid generation:  0.030953645706176758
local_in_edges_tensor generation:  0.04041314125061035
mini_batch_src_global generation:  0.06217694282531738
r_  generation:  0.5240716934204102
local_output_nid generation:  0.03133440017700195
local_in_edges_tensor generation:  0.03315377235412598
mini_batch_src_global generation:  0.05980992317199707
r_  generation:  0.532740592956543
local_output_nid generation:  0.03146553039550781
local_in_edges_tensor generation:  0.031759023666381836
mini_batch_src_global generation:  0.05934286117553711
r_  generation:  0.5321414470672607
local_output_nid generation:  0.0315554141998291
local_in_edges_tensor generation:  0.07796692848205566
mini_batch_src_global generation:  0.06142139434814453
r_  generation:  0.5395395755767822
local_output_nid generation:  0.0317080020904541
local_in_edges_tensor generation:  0.03198838233947754
mini_batch_src_global generation:  0.061449527740478516
r_  generation:  0.5382647514343262
local_output_nid generation:  0.032038211822509766
local_in_edges_tensor generation:  0.03371024131774902
mini_batch_src_global generation:  0.06125903129577637
r_  generation:  0.5428011417388916
local_output_nid generation:  0.03192400932312012
local_in_edges_tensor generation:  0.03459429740905762
mini_batch_src_global generation:  0.06226396560668945
r_  generation:  0.5431416034698486
local_output_nid generation:  0.03255796432495117
local_in_edges_tensor generation:  0.033777713775634766
mini_batch_src_global generation:  0.06210064888000488
r_  generation:  0.5458765029907227
local_output_nid generation:  0.03190350532531738
local_in_edges_tensor generation:  0.03125166893005371
mini_batch_src_global generation:  0.06264686584472656
r_  generation:  0.539848804473877
local_output_nid generation:  0.032186269760131836
local_in_edges_tensor generation:  0.03403282165527344
mini_batch_src_global generation:  0.06224226951599121
r_  generation:  0.5472695827484131
local_output_nid generation:  0.03210258483886719
local_in_edges_tensor generation:  0.03186440467834473
mini_batch_src_global generation:  0.062384843826293945
r_  generation:  0.5414695739746094
local_output_nid generation:  0.031943321228027344
local_in_edges_tensor generation:  0.03136849403381348
mini_batch_src_global generation:  0.061951637268066406
r_  generation:  0.5476391315460205
local_output_nid generation:  0.03199577331542969
local_in_edges_tensor generation:  0.035645246505737305
mini_batch_src_global generation:  0.06224346160888672
r_  generation:  0.5419273376464844
local_output_nid generation:  0.03221893310546875
local_in_edges_tensor generation:  0.03390383720397949
mini_batch_src_global generation:  0.06496810913085938
r_  generation:  0.5490684509277344
local_output_nid generation:  0.03211188316345215
local_in_edges_tensor generation:  0.03185915946960449
mini_batch_src_global generation:  0.06236457824707031
r_  generation:  0.5461301803588867
----------------------check_connections_block total spend ----------------------------- 12.63895058631897
generate_one_block  0.6829559803009033
generate_one_block  0.6804914474487305
generate_one_block  0.6820132732391357
generate_one_block  0.6764860153198242
generate_one_block  0.6745181083679199
generate_one_block  0.6787216663360596
generate_one_block  0.6761362552642822
generate_one_block  0.676239013671875
generate_one_block  0.7133135795593262
generate_one_block  0.6756417751312256
generate_one_block  0.6864354610443115
generate_one_block  0.6720485687255859
generate_one_block  0.6701240539550781
generate_one_block  0.6813764572143555
generate_one_block  0.6861093044281006
generate_one_block  0.6786012649536133
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.1282820701599121  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

connection checking time:  18.880652904510498
block generation total time  16.525594234466553
average batch blocks generation time:  1.0328496396541595
block dataloader generation time/epoch 37.90315556526184
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09966659545898438  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7706665992736816  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09984493255615234  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7810931205749512  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10077762603759766  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7768950462341309  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0998525619506836  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7717337608337402  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09981918334960938  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7721338272094727  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09978342056274414  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7735495567321777  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09971904754638672  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7721991539001465  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09966897964477539  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7672514915466309  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09978771209716797  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7758822441101074  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09960126876831055  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7684693336486816  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10076713562011719  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7777490615844727  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09968137741088867  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7700705528259277  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09958267211914062  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7681312561035156  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09972524642944336  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7739334106445312  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09986639022827148  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.773127555847168  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0997166633605957  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7691922187805176  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06542067229747772 |0.013253703713417053 |0.0035761594772338867 |9.045004844665527e-05 |0.003097057342529297 |0.0017457008361816406 |
----------------------------------------------------------pseudo_mini_loss sum 1.3758348226547241
Total (block generation + training)time/epoch 39.38248071074486
Training time/epoch 1.4332220554351807
Training time without block to device /epoch 1.2211627960205078
Training time without total dataloading part /epoch 0.10996437072753906
load block tensor time/epoch 1.0467307567596436
block to device time/epoch 0.21205925941467285
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  5328603
Number of first layer input nodes during this epoch:  2521002
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.1283702850341797  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023124217987060547
range selection method range initialization spend 0.012208700180053711
time for parepare:  0.01733851432800293
local_output_nid generation:  0.0014657974243164062
local_in_edges_tensor generation:  0.006056547164916992
mini_batch_src_global generation:  0.0017285346984863281
r_  generation:  0.02061629295349121
local_output_nid generation:  0.0015645027160644531
local_in_edges_tensor generation:  0.00099945068359375
mini_batch_src_global generation:  0.0020127296447753906
r_  generation:  0.02294301986694336
local_output_nid generation:  0.0015530586242675781
local_in_edges_tensor generation:  0.0009167194366455078
mini_batch_src_global generation:  0.0016863346099853516
r_  generation:  0.022595882415771484
local_output_nid generation:  0.0016551017761230469
local_in_edges_tensor generation:  0.0009505748748779297
mini_batch_src_global generation:  0.0017886161804199219
r_  generation:  0.02188420295715332
local_output_nid generation:  0.001596689224243164
local_in_edges_tensor generation:  0.0009417533874511719
mini_batch_src_global generation:  0.0017399787902832031
r_  generation:  0.02214813232421875
local_output_nid generation:  0.0016140937805175781
local_in_edges_tensor generation:  0.0009531974792480469
mini_batch_src_global generation:  0.0017917156219482422
r_  generation:  0.0228421688079834
local_output_nid generation:  0.0015718936920166016
local_in_edges_tensor generation:  0.0009691715240478516
mini_batch_src_global generation:  0.0017538070678710938
r_  generation:  0.021893024444580078
local_output_nid generation:  0.0015628337860107422
local_in_edges_tensor generation:  0.0009500980377197266
mini_batch_src_global generation:  0.001707315444946289
r_  generation:  0.021793603897094727
local_output_nid generation:  0.0015816688537597656
local_in_edges_tensor generation:  0.0009183883666992188
mini_batch_src_global generation:  0.0017879009246826172
r_  generation:  0.022869110107421875
local_output_nid generation:  0.0015869140625
local_in_edges_tensor generation:  0.0009701251983642578
mini_batch_src_global generation:  0.0017888545989990234
r_  generation:  0.021990299224853516
local_output_nid generation:  0.0015745162963867188
local_in_edges_tensor generation:  0.0009305477142333984
mini_batch_src_global generation:  0.0018227100372314453
r_  generation:  0.023104429244995117
local_output_nid generation:  0.0015745162963867188
local_in_edges_tensor generation:  0.0009477138519287109
mini_batch_src_global generation:  0.001789093017578125
r_  generation:  0.02207469940185547
local_output_nid generation:  0.0015959739685058594
local_in_edges_tensor generation:  0.0009219646453857422
mini_batch_src_global generation:  0.001718759536743164
r_  generation:  0.02201557159423828
local_output_nid generation:  0.0015850067138671875
local_in_edges_tensor generation:  0.0008966922760009766
mini_batch_src_global generation:  0.0017256736755371094
r_  generation:  0.022363662719726562
local_output_nid generation:  0.0015788078308105469
local_in_edges_tensor generation:  0.0009860992431640625
mini_batch_src_global generation:  0.0018270015716552734
r_  generation:  0.022779226303100586
local_output_nid generation:  0.0015726089477539062
local_in_edges_tensor generation:  0.0009548664093017578
mini_batch_src_global generation:  0.001791238784790039
r_  generation:  0.022244930267333984
----------------------check_connections_block total spend ----------------------------- 0.5258526802062988
generate_one_block  0.02984786033630371
generate_one_block  0.031786203384399414
generate_one_block  0.03076028823852539
generate_one_block  0.03134489059448242
generate_one_block  0.03168630599975586
generate_one_block  0.0338292121887207
generate_one_block  0.030855894088745117
generate_one_block  0.030591964721679688
generate_one_block  0.032209157943725586
generate_one_block  0.030832529067993164
generate_one_block  0.032396793365478516
generate_one_block  0.030907869338989258
generate_one_block  0.030573606491088867
generate_one_block  0.030884504318237305
generate_one_block  0.03168153762817383
generate_one_block  0.031790971755981445
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0429081916809082
gen group dst list time:  0.018221378326416016
time for parepare:  0.020328998565673828
local_output_nid generation:  0.007530927658081055
local_in_edges_tensor generation:  0.02454853057861328
mini_batch_src_global generation:  0.026961803436279297
r_  generation:  0.24587392807006836
local_output_nid generation:  0.011337757110595703
local_in_edges_tensor generation:  0.016428709030151367
mini_batch_src_global generation:  0.033968448638916016
r_  generation:  0.2643136978149414
local_output_nid generation:  0.011797428131103516
local_in_edges_tensor generation:  0.01842808723449707
mini_batch_src_global generation:  0.032172203063964844
r_  generation:  0.26531243324279785
local_output_nid generation:  0.012385368347167969
local_in_edges_tensor generation:  0.013239383697509766
mini_batch_src_global generation:  0.03248453140258789
r_  generation:  0.26583433151245117
local_output_nid generation:  0.012761831283569336
local_in_edges_tensor generation:  0.013912439346313477
mini_batch_src_global generation:  0.039354801177978516
r_  generation:  0.2753944396972656
local_output_nid generation:  0.012659311294555664
local_in_edges_tensor generation:  0.013885259628295898
mini_batch_src_global generation:  0.03603243827819824
r_  generation:  0.2677280902862549
local_output_nid generation:  0.012822866439819336
local_in_edges_tensor generation:  0.015042543411254883
mini_batch_src_global generation:  0.03763151168823242
r_  generation:  0.27106738090515137
local_output_nid generation:  0.01302647590637207
local_in_edges_tensor generation:  0.013750791549682617
mini_batch_src_global generation:  0.043184518814086914
r_  generation:  0.2703268527984619
local_output_nid generation:  0.01345062255859375
local_in_edges_tensor generation:  0.01397252082824707
mini_batch_src_global generation:  0.038283348083496094
r_  generation:  0.27622199058532715
local_output_nid generation:  0.01456594467163086
local_in_edges_tensor generation:  0.01382303237915039
mini_batch_src_global generation:  0.040917158126831055
r_  generation:  0.26984214782714844
local_output_nid generation:  0.013463258743286133
local_in_edges_tensor generation:  0.015197515487670898
mini_batch_src_global generation:  0.03672671318054199
r_  generation:  0.2823629379272461
local_output_nid generation:  0.013514041900634766
local_in_edges_tensor generation:  0.014132022857666016
mini_batch_src_global generation:  0.034363746643066406
r_  generation:  0.2703425884246826
local_output_nid generation:  0.01340937614440918
local_in_edges_tensor generation:  0.01383829116821289
mini_batch_src_global generation:  0.03478121757507324
r_  generation:  0.2698643207550049
local_output_nid generation:  0.013405799865722656
local_in_edges_tensor generation:  0.016303300857543945
mini_batch_src_global generation:  0.03449535369873047
r_  generation:  0.27088022232055664
local_output_nid generation:  0.01293039321899414
local_in_edges_tensor generation:  0.014964103698730469
mini_batch_src_global generation:  0.037549734115600586
r_  generation:  0.27902817726135254
local_output_nid generation:  0.012892723083496094
local_in_edges_tensor generation:  0.014158487319946289
mini_batch_src_global generation:  0.03508472442626953
r_  generation:  0.27254176139831543
----------------------check_connections_block total spend ----------------------------- 6.2807297706604
generate_one_block  0.3462798595428467
generate_one_block  0.3545987606048584
generate_one_block  0.3587453365325928
generate_one_block  0.3521599769592285
generate_one_block  0.3542149066925049
generate_one_block  0.3507874011993408
generate_one_block  0.3764345645904541
generate_one_block  0.34179210662841797
generate_one_block  0.35361218452453613
generate_one_block  0.3437018394470215
generate_one_block  0.35826611518859863
generate_one_block  0.3478200435638428
generate_one_block  0.34273719787597656
generate_one_block  0.34879541397094727
generate_one_block  0.35837507247924805
generate_one_block  0.34963393211364746
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0373685359954834
gen group dst list time:  0.06560993194580078
time for parepare:  0.017603397369384766
local_output_nid generation:  0.025661230087280273
local_in_edges_tensor generation:  0.04975414276123047
mini_batch_src_global generation:  0.05040097236633301
r_  generation:  0.5209360122680664
local_output_nid generation:  0.030811071395874023
local_in_edges_tensor generation:  0.036626577377319336
mini_batch_src_global generation:  0.06168842315673828
r_  generation:  0.5215749740600586
local_output_nid generation:  0.030806541442871094
local_in_edges_tensor generation:  0.031343936920166016
mini_batch_src_global generation:  0.0586390495300293
r_  generation:  0.5318729877471924
local_output_nid generation:  0.03145241737365723
local_in_edges_tensor generation:  0.03589677810668945
mini_batch_src_global generation:  0.059234619140625
r_  generation:  0.5323352813720703
local_output_nid generation:  0.03166317939758301
local_in_edges_tensor generation:  0.08279061317443848
mini_batch_src_global generation:  0.0594179630279541
r_  generation:  0.5413498878479004
local_output_nid generation:  0.03176307678222656
local_in_edges_tensor generation:  0.03424668312072754
mini_batch_src_global generation:  0.06077837944030762
r_  generation:  0.5397591590881348
local_output_nid generation:  0.03194427490234375
local_in_edges_tensor generation:  0.033905982971191406
mini_batch_src_global generation:  0.06685090065002441
r_  generation:  0.5481348037719727
local_output_nid generation:  0.032178640365600586
local_in_edges_tensor generation:  0.03167247772216797
mini_batch_src_global generation:  0.06087636947631836
r_  generation:  0.54067063331604
local_output_nid generation:  0.032024383544921875
local_in_edges_tensor generation:  0.03349900245666504
mini_batch_src_global generation:  0.0628809928894043
r_  generation:  0.541140079498291
local_output_nid generation:  0.03217792510986328
local_in_edges_tensor generation:  0.031806230545043945
mini_batch_src_global generation:  0.06616830825805664
r_  generation:  0.538581132888794
local_output_nid generation:  0.032099246978759766
local_in_edges_tensor generation:  0.03411293029785156
mini_batch_src_global generation:  0.061990976333618164
r_  generation:  0.5413253307342529
local_output_nid generation:  0.03214406967163086
local_in_edges_tensor generation:  0.03150749206542969
mini_batch_src_global generation:  0.06098365783691406
r_  generation:  0.5494954586029053
local_output_nid generation:  0.03204846382141113
local_in_edges_tensor generation:  0.031996726989746094
mini_batch_src_global generation:  0.06145310401916504
r_  generation:  0.5427148342132568
local_output_nid generation:  0.03203606605529785
local_in_edges_tensor generation:  0.03369283676147461
mini_batch_src_global generation:  0.06183910369873047
r_  generation:  0.5422136783599854
local_output_nid generation:  0.032160282135009766
local_in_edges_tensor generation:  0.03481316566467285
mini_batch_src_global generation:  0.06382942199707031
r_  generation:  0.5404882431030273
local_output_nid generation:  0.03220629692077637
local_in_edges_tensor generation:  0.03666877746582031
mini_batch_src_global generation:  0.06107759475708008
r_  generation:  0.5452649593353271
----------------------check_connections_block total spend ----------------------------- 12.618068218231201
generate_one_block  0.674008846282959
generate_one_block  0.6739294528961182
generate_one_block  0.675952672958374
generate_one_block  0.6832797527313232
generate_one_block  0.6944198608398438
generate_one_block  0.6863508224487305
generate_one_block  0.6786549091339111
generate_one_block  0.6763293743133545
generate_one_block  0.7385542392730713
generate_one_block  0.6794717311859131
generate_one_block  0.6864662170410156
generate_one_block  0.6776392459869385
generate_one_block  0.6759974956512451
generate_one_block  0.670342206954956
generate_one_block  0.6824636459350586
generate_one_block  0.701594352722168
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.1283702850341797  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

connection checking time:  18.8987979888916
block generation total time  16.593409538269043
average batch blocks generation time:  1.0370880961418152
block dataloader generation time/epoch 37.877882136238945
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09961748123168945  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7666549682617188  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09981679916381836  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7803840637207031  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0997915267944336  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7706184387207031  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.099884033203125  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7765026092529297  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0998392105102539  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7773513793945312  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09984016418457031  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7796645164489746  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09972858428955078  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7690930366516113  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09978771209716797  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7720465660095215  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09981203079223633  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.776557445526123  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09986066818237305  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7679123878479004  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10091781616210938  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7827057838439941  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0997157096862793  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.76739501953125  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09960317611694336  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7673516273498535  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.099700927734375  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7694320678710938  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09985733032226562  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7730288505554199  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09981536865234375  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7761492729187012  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06909880042076111 |0.01321074366569519 |0.0035079121589660645 |9.021162986755371e-05 |0.0037356019020080566 |0.001417398452758789 |
----------------------------------------------------------pseudo_mini_loss sum 1.3520466089248657
Total (block generation + training)time/epoch 39.359469493230186
Training time/epoch 1.4994118213653564
Training time without block to device /epoch 1.2880399227142334
Training time without total dataloading part /epoch 0.11875700950622559
load block tensor time/epoch 1.1055808067321777
block to device time/epoch 0.21137189865112305
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  5330802
Number of first layer input nodes during this epoch:  2522185
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.1284656524658203  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02222275733947754
range selection method range initialization spend 0.012006998062133789
time for parepare:  0.017288684844970703
local_output_nid generation:  0.0014240741729736328
local_in_edges_tensor generation:  0.0032563209533691406
mini_batch_src_global generation:  0.0017747879028320312
r_  generation:  0.021587371826171875
local_output_nid generation:  0.0015420913696289062
local_in_edges_tensor generation:  0.0009829998016357422
mini_batch_src_global generation:  0.002023458480834961
r_  generation:  0.022236347198486328
local_output_nid generation:  0.0015633106231689453
local_in_edges_tensor generation:  0.0009520053863525391
mini_batch_src_global generation:  0.0016667842864990234
r_  generation:  0.02119898796081543
local_output_nid generation:  0.0015735626220703125
local_in_edges_tensor generation:  0.0009634494781494141
mini_batch_src_global generation:  0.0017724037170410156
r_  generation:  0.021698951721191406
local_output_nid generation:  0.0015549659729003906
local_in_edges_tensor generation:  0.0009520053863525391
mini_batch_src_global generation:  0.0017740726470947266
r_  generation:  0.021855831146240234
local_output_nid generation:  0.0015745162963867188
local_in_edges_tensor generation:  0.0009732246398925781
mini_batch_src_global generation:  0.0017158985137939453
r_  generation:  0.02137589454650879
local_output_nid generation:  0.001577615737915039
local_in_edges_tensor generation:  0.0009722709655761719
mini_batch_src_global generation:  0.0017173290252685547
r_  generation:  0.02194356918334961
local_output_nid generation:  0.0015811920166015625
local_in_edges_tensor generation:  0.0009603500366210938
mini_batch_src_global generation:  0.0017781257629394531
r_  generation:  0.022490501403808594
local_output_nid generation:  0.0015921592712402344
local_in_edges_tensor generation:  0.0009148120880126953
mini_batch_src_global generation:  0.0017597675323486328
r_  generation:  0.022221803665161133
local_output_nid generation:  0.0015811920166015625
local_in_edges_tensor generation:  0.0009369850158691406
mini_batch_src_global generation:  0.0017857551574707031
r_  generation:  0.02259039878845215
local_output_nid generation:  0.0015869140625
local_in_edges_tensor generation:  0.0009264945983886719
mini_batch_src_global generation:  0.0017561912536621094
r_  generation:  0.022829294204711914
local_output_nid generation:  0.0015921592712402344
local_in_edges_tensor generation:  0.0009467601776123047
mini_batch_src_global generation:  0.0018277168273925781
r_  generation:  0.022448301315307617
local_output_nid generation:  0.0015778541564941406
local_in_edges_tensor generation:  0.0009331703186035156
mini_batch_src_global generation:  0.001745462417602539
r_  generation:  0.021786212921142578
local_output_nid generation:  0.0015933513641357422
local_in_edges_tensor generation:  0.0009064674377441406
mini_batch_src_global generation:  0.0017511844635009766
r_  generation:  0.022327184677124023
local_output_nid generation:  0.00164031982421875
local_in_edges_tensor generation:  0.0009486675262451172
mini_batch_src_global generation:  0.0017399787902832031
r_  generation:  0.021883010864257812
local_output_nid generation:  0.0015993118286132812
local_in_edges_tensor generation:  0.000978708267211914
mini_batch_src_global generation:  0.001752614974975586
r_  generation:  0.022356748580932617
----------------------check_connections_block total spend ----------------------------- 0.5192224979400635
generate_one_block  0.03100299835205078
generate_one_block  0.031136274337768555
generate_one_block  0.030843734741210938
generate_one_block  0.031488656997680664
generate_one_block  0.03116440773010254
generate_one_block  0.03187251091003418
generate_one_block  0.030841827392578125
generate_one_block  0.031809091567993164
generate_one_block  0.031366825103759766
generate_one_block  0.0316777229309082
generate_one_block  0.03157782554626465
generate_one_block  0.03130364418029785
generate_one_block  0.030776262283325195
generate_one_block  0.0315554141998291
generate_one_block  0.031035184860229492
generate_one_block  0.032038211822509766
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04151606559753418
gen group dst list time:  0.018308401107788086
time for parepare:  0.019289731979370117
local_output_nid generation:  0.007542848587036133
local_in_edges_tensor generation:  0.023005008697509766
mini_batch_src_global generation:  0.028351545333862305
r_  generation:  0.2573091983795166
local_output_nid generation:  0.011107683181762695
local_in_edges_tensor generation:  0.017263174057006836
mini_batch_src_global generation:  0.03363966941833496
r_  generation:  0.2575080394744873
local_output_nid generation:  0.011289119720458984
local_in_edges_tensor generation:  0.01722240447998047
mini_batch_src_global generation:  0.031401634216308594
r_  generation:  0.26172327995300293
local_output_nid generation:  0.012401103973388672
local_in_edges_tensor generation:  0.015484333038330078
mini_batch_src_global generation:  0.03256058692932129
r_  generation:  0.27039122581481934
local_output_nid generation:  0.012718915939331055
local_in_edges_tensor generation:  0.013302803039550781
mini_batch_src_global generation:  0.03406691551208496
r_  generation:  0.27025771141052246
local_output_nid generation:  0.01226949691772461
local_in_edges_tensor generation:  0.01621413230895996
mini_batch_src_global generation:  0.033109188079833984
r_  generation:  0.26476001739501953
local_output_nid generation:  0.012933731079101562
local_in_edges_tensor generation:  0.013545751571655273
mini_batch_src_global generation:  0.034034013748168945
r_  generation:  0.2675058841705322
local_output_nid generation:  0.012979507446289062
local_in_edges_tensor generation:  0.01468038558959961
mini_batch_src_global generation:  0.0349583625793457
r_  generation:  0.27704334259033203
local_output_nid generation:  0.012877702713012695
local_in_edges_tensor generation:  0.013491153717041016
mini_batch_src_global generation:  0.035063982009887695
r_  generation:  0.2699127197265625
local_output_nid generation:  0.013221025466918945
local_in_edges_tensor generation:  0.014198064804077148
mini_batch_src_global generation:  0.035138845443725586
r_  generation:  0.2755444049835205
local_output_nid generation:  0.012836694717407227
local_in_edges_tensor generation:  0.014819622039794922
mini_batch_src_global generation:  0.0358278751373291
r_  generation:  0.27806830406188965
local_output_nid generation:  0.015926122665405273
local_in_edges_tensor generation:  0.016806840896606445
mini_batch_src_global generation:  0.034887075424194336
r_  generation:  0.2734665870666504
local_output_nid generation:  0.01291966438293457
local_in_edges_tensor generation:  0.013720512390136719
mini_batch_src_global generation:  0.03421831130981445
r_  generation:  0.2662067413330078
local_output_nid generation:  0.013186216354370117
local_in_edges_tensor generation:  0.01386713981628418
mini_batch_src_global generation:  0.035044193267822266
r_  generation:  0.27845263481140137
local_output_nid generation:  0.012286186218261719
local_in_edges_tensor generation:  0.01327824592590332
mini_batch_src_global generation:  0.034950971603393555
r_  generation:  0.2673461437225342
local_output_nid generation:  0.012563228607177734
local_in_edges_tensor generation:  0.01409006118774414
mini_batch_src_global generation:  0.03471088409423828
r_  generation:  0.27533864974975586
----------------------check_connections_block total spend ----------------------------- 6.238208055496216
generate_one_block  0.3610358238220215
generate_one_block  0.343062162399292
generate_one_block  0.34450554847717285
generate_one_block  0.3554661273956299
generate_one_block  0.34870314598083496
generate_one_block  0.3415977954864502
generate_one_block  0.3673830032348633
generate_one_block  0.35587000846862793
generate_one_block  0.35001611709594727
generate_one_block  0.35239195823669434
generate_one_block  0.3610084056854248
generate_one_block  0.35338521003723145
generate_one_block  0.340972900390625
generate_one_block  0.3543243408203125
generate_one_block  0.34546709060668945
generate_one_block  0.3528716564178467
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03598594665527344
gen group dst list time:  0.06623005867004395
time for parepare:  0.017807483673095703
local_output_nid generation:  0.025815248489379883
local_in_edges_tensor generation:  0.045217037200927734
mini_batch_src_global generation:  0.04870343208312988
r_  generation:  0.5232031345367432
local_output_nid generation:  0.03042149543762207
local_in_edges_tensor generation:  0.03806662559509277
mini_batch_src_global generation:  0.06257820129394531
r_  generation:  0.518700361251831
local_output_nid generation:  0.03078913688659668
local_in_edges_tensor generation:  0.036757707595825195
mini_batch_src_global generation:  0.061339378356933594
r_  generation:  0.5385603904724121
local_output_nid generation:  0.031639814376831055
local_in_edges_tensor generation:  0.03368496894836426
mini_batch_src_global generation:  0.060007333755493164
r_  generation:  0.5285522937774658
local_output_nid generation:  0.03195023536682129
local_in_edges_tensor generation:  0.08235883712768555
mini_batch_src_global generation:  0.06215953826904297
r_  generation:  0.5381207466125488
local_output_nid generation:  0.03183269500732422
local_in_edges_tensor generation:  0.0389561653137207
mini_batch_src_global generation:  0.06056332588195801
r_  generation:  0.5470423698425293
local_output_nid generation:  0.0356287956237793
local_in_edges_tensor generation:  0.033240318298339844
mini_batch_src_global generation:  0.06422781944274902
r_  generation:  0.545203685760498
local_output_nid generation:  0.03272843360900879
local_in_edges_tensor generation:  0.03515291213989258
mini_batch_src_global generation:  0.06442713737487793
r_  generation:  0.5409092903137207
local_output_nid generation:  0.03282451629638672
local_in_edges_tensor generation:  0.033318519592285156
mini_batch_src_global generation:  0.06154918670654297
r_  generation:  0.5382080078125
local_output_nid generation:  0.032855987548828125
local_in_edges_tensor generation:  0.03381800651550293
mini_batch_src_global generation:  0.061681509017944336
r_  generation:  0.5410981178283691
local_output_nid generation:  0.03310871124267578
local_in_edges_tensor generation:  0.03829765319824219
mini_batch_src_global generation:  0.061969757080078125
r_  generation:  0.5492641925811768
local_output_nid generation:  0.03316640853881836
local_in_edges_tensor generation:  0.0359649658203125
mini_batch_src_global generation:  0.06243634223937988
r_  generation:  0.5407261848449707
local_output_nid generation:  0.033013105392456055
local_in_edges_tensor generation:  0.035482168197631836
mini_batch_src_global generation:  0.062422752380371094
r_  generation:  0.5403957366943359
local_output_nid generation:  0.033033132553100586
local_in_edges_tensor generation:  0.03624582290649414
mini_batch_src_global generation:  0.06304311752319336
r_  generation:  0.5413219928741455
local_output_nid generation:  0.03287935256958008
local_in_edges_tensor generation:  0.03617405891418457
mini_batch_src_global generation:  0.06242680549621582
r_  generation:  0.5472009181976318
local_output_nid generation:  0.0333402156829834
local_in_edges_tensor generation:  0.03798413276672363
mini_batch_src_global generation:  0.0627143383026123
r_  generation:  0.5454668998718262
----------------------check_connections_block total spend ----------------------------- 12.679962635040283
generate_one_block  0.683079719543457
generate_one_block  0.6768050193786621
generate_one_block  0.6731185913085938
generate_one_block  0.6781604290008545
generate_one_block  0.6829357147216797
generate_one_block  0.6726536750793457
generate_one_block  0.6725404262542725
generate_one_block  0.6798181533813477
generate_one_block  0.7051856517791748
generate_one_block  0.6756255626678467
generate_one_block  0.6819891929626465
generate_one_block  0.6742229461669922
generate_one_block  0.675093412399292
generate_one_block  0.6809883117675781
generate_one_block  0.6746196746826172
generate_one_block  0.6866984367370605
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.1284656524658203  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

connection checking time:  18.9181706905365
block generation total time  16.501596212387085
average batch blocks generation time:  1.0313497632741928
block dataloader generation time/epoch 37.850716304779056
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10097932815551758  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7821645736694336  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0998067855834961  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7709183692932129  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09941720962524414  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.765235424041748  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0998845100402832  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7764477729797363  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09982061386108398  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7758598327636719  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09946775436401367  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7660436630249023  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10072040557861328  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7757349014282227  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09984159469604492  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7777919769287109  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09948873519897461  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7643923759460449  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09975433349609375  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7797155380249023  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09999799728393555  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7807755470275879  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0998377799987793  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7716984748840332  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09953451156616211  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7651891708374023  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09991216659545898  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7772526741027832  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10065841674804688  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7684288024902344  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09999752044677734  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7807846069335938  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06512720882892609 |0.012183353304862976 |0.0034290850162506104 |9.222328662872314e-05 |0.0030813366174697876 |0.0030884742736816406 |
----------------------------------------------------------pseudo_mini_loss sum 1.340926170349121
Total (block generation + training)time/epoch 39.32514216899872
Training time/epoch 1.4097845554351807
Training time without block to device /epoch 1.214850902557373
Training time without total dataloading part /epoch 0.10873079299926758
load block tensor time/epoch 1.0420353412628174
block to device time/epoch 0.19493365287780762
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  5330493
Number of first layer input nodes during this epoch:  2521660
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.12972736358642578  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022209644317626953
range selection method range initialization spend 0.012229442596435547
time for parepare:  0.017386198043823242
local_output_nid generation:  0.0014348030090332031
local_in_edges_tensor generation:  0.0069217681884765625
mini_batch_src_global generation:  0.0017592906951904297
r_  generation:  0.021167516708374023
local_output_nid generation:  0.0015902519226074219
local_in_edges_tensor generation:  0.000978231430053711
mini_batch_src_global generation:  0.0020902156829833984
r_  generation:  0.022265195846557617
local_output_nid generation:  0.0016155242919921875
local_in_edges_tensor generation:  0.0009577274322509766
mini_batch_src_global generation:  0.001653909683227539
r_  generation:  0.020872831344604492
local_output_nid generation:  0.0016164779663085938
local_in_edges_tensor generation:  0.0009331703186035156
mini_batch_src_global generation:  0.0016329288482666016
r_  generation:  0.02050495147705078
local_output_nid generation:  0.0016071796417236328
local_in_edges_tensor generation:  0.0009377002716064453
mini_batch_src_global generation:  0.0017476081848144531
r_  generation:  0.021589994430541992
local_output_nid generation:  0.0015811920166015625
local_in_edges_tensor generation:  0.0009481906890869141
mini_batch_src_global generation:  0.0017752647399902344
r_  generation:  0.022556543350219727
local_output_nid generation:  0.0016155242919921875
local_in_edges_tensor generation:  0.0009448528289794922
mini_batch_src_global generation:  0.001832723617553711
r_  generation:  0.02238011360168457
local_output_nid generation:  0.0016026496887207031
local_in_edges_tensor generation:  0.0009338855743408203
mini_batch_src_global generation:  0.0017731189727783203
r_  generation:  0.021624326705932617
local_output_nid generation:  0.0016124248504638672
local_in_edges_tensor generation:  0.000949859619140625
mini_batch_src_global generation:  0.0017077922821044922
r_  generation:  0.021593093872070312
local_output_nid generation:  0.001590728759765625
local_in_edges_tensor generation:  0.0009481906890869141
mini_batch_src_global generation:  0.0017476081848144531
r_  generation:  0.021893739700317383
local_output_nid generation:  0.0016202926635742188
local_in_edges_tensor generation:  0.0009548664093017578
mini_batch_src_global generation:  0.0018157958984375
r_  generation:  0.022317886352539062
local_output_nid generation:  0.0016052722930908203
local_in_edges_tensor generation:  0.0009090900421142578
mini_batch_src_global generation:  0.0017940998077392578
r_  generation:  0.02251577377319336
local_output_nid generation:  0.0016121864318847656
local_in_edges_tensor generation:  0.0009305477142333984
mini_batch_src_global generation:  0.0017423629760742188
r_  generation:  0.021924495697021484
local_output_nid generation:  0.0015952587127685547
local_in_edges_tensor generation:  0.0009298324584960938
mini_batch_src_global generation:  0.0017833709716796875
r_  generation:  0.022467851638793945
local_output_nid generation:  0.0015954971313476562
local_in_edges_tensor generation:  0.0009319782257080078
mini_batch_src_global generation:  0.001851797103881836
r_  generation:  0.0219876766204834
local_output_nid generation:  0.0015938282012939453
local_in_edges_tensor generation:  0.0009229183197021484
mini_batch_src_global generation:  0.001833200454711914
r_  generation:  0.022754430770874023
----------------------check_connections_block total spend ----------------------------- 0.5203897953033447
generate_one_block  0.030878782272338867
generate_one_block  0.0315859317779541
generate_one_block  0.03059983253479004
generate_one_block  0.030133962631225586
generate_one_block  0.03109121322631836
generate_one_block  0.03410625457763672
generate_one_block  0.03195548057556152
generate_one_block  0.031388282775878906
generate_one_block  0.03057408332824707
generate_one_block  0.031233549118041992
generate_one_block  0.031182289123535156
generate_one_block  0.0319058895111084
generate_one_block  0.0319364070892334
generate_one_block  0.032056570053100586
generate_one_block  0.03159523010253906
generate_one_block  0.032737016677856445
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03597879409790039
gen group dst list time:  0.019148826599121094
time for parepare:  0.019327402114868164
local_output_nid generation:  0.00762176513671875
local_in_edges_tensor generation:  0.02177143096923828
mini_batch_src_global generation:  0.025979280471801758
r_  generation:  0.252044677734375
local_output_nid generation:  0.011270761489868164
local_in_edges_tensor generation:  0.014821529388427734
mini_batch_src_global generation:  0.03642749786376953
r_  generation:  0.26024317741394043
local_output_nid generation:  0.01217508316040039
local_in_edges_tensor generation:  0.019647598266601562
mini_batch_src_global generation:  0.03546619415283203
r_  generation:  0.2628791332244873
local_output_nid generation:  0.01236867904663086
local_in_edges_tensor generation:  0.01607799530029297
mini_batch_src_global generation:  0.0349888801574707
r_  generation:  0.2661254405975342
local_output_nid generation:  0.012814998626708984
local_in_edges_tensor generation:  0.014333963394165039
mini_batch_src_global generation:  0.03503990173339844
r_  generation:  0.27232789993286133
local_output_nid generation:  0.012987136840820312
local_in_edges_tensor generation:  0.018469572067260742
mini_batch_src_global generation:  0.0357973575592041
r_  generation:  0.28171396255493164
local_output_nid generation:  0.013363122940063477
local_in_edges_tensor generation:  0.013946056365966797
mini_batch_src_global generation:  0.035834312438964844
r_  generation:  0.2764277458190918
local_output_nid generation:  0.01304006576538086
local_in_edges_tensor generation:  0.014452695846557617
mini_batch_src_global generation:  0.03416180610656738
r_  generation:  0.267608642578125
local_output_nid generation:  0.012920379638671875
local_in_edges_tensor generation:  0.013238668441772461
mini_batch_src_global generation:  0.0342710018157959
r_  generation:  0.26738476753234863
local_output_nid generation:  0.013134241104125977
local_in_edges_tensor generation:  0.013145685195922852
mini_batch_src_global generation:  0.03379416465759277
r_  generation:  0.2722339630126953
local_output_nid generation:  0.012961864471435547
local_in_edges_tensor generation:  0.013749122619628906
mini_batch_src_global generation:  0.03552079200744629
r_  generation:  0.27498817443847656
local_output_nid generation:  0.013480901718139648
local_in_edges_tensor generation:  0.014983415603637695
mini_batch_src_global generation:  0.03675103187561035
r_  generation:  0.28208065032958984
local_output_nid generation:  0.013282060623168945
local_in_edges_tensor generation:  0.01408839225769043
mini_batch_src_global generation:  0.035230398178100586
r_  generation:  0.2713942527770996
local_output_nid generation:  0.013456106185913086
local_in_edges_tensor generation:  0.013557910919189453
mini_batch_src_global generation:  0.034986019134521484
r_  generation:  0.2823352813720703
local_output_nid generation:  0.01335000991821289
local_in_edges_tensor generation:  0.01495218276977539
mini_batch_src_global generation:  0.035689592361450195
r_  generation:  0.2731330394744873
local_output_nid generation:  0.01286172866821289
local_in_edges_tensor generation:  0.01529383659362793
mini_batch_src_global generation:  0.036489009857177734
r_  generation:  0.2789039611816406
----------------------check_connections_block total spend ----------------------------- 6.293154001235962
generate_one_block  0.35013794898986816
generate_one_block  0.3452935218811035
generate_one_block  0.341489315032959
generate_one_block  0.3498215675354004
generate_one_block  0.3513212203979492
generate_one_block  0.361757755279541
generate_one_block  0.3784909248352051
generate_one_block  0.342759370803833
generate_one_block  0.34486818313598633
generate_one_block  0.3443145751953125
generate_one_block  0.3533592224121094
generate_one_block  0.3598630428314209
generate_one_block  0.3474729061126709
generate_one_block  0.355515718460083
generate_one_block  0.35365796089172363
generate_one_block  0.3571596145629883
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04043292999267578
gen group dst list time:  0.06661629676818848
time for parepare:  0.017643451690673828
local_output_nid generation:  0.025959253311157227
local_in_edges_tensor generation:  0.043073415756225586
mini_batch_src_global generation:  0.05048561096191406
r_  generation:  0.5189414024353027
local_output_nid generation:  0.030841588973999023
local_in_edges_tensor generation:  0.0407106876373291
mini_batch_src_global generation:  0.0620725154876709
r_  generation:  0.5210855007171631
local_output_nid generation:  0.030878543853759766
local_in_edges_tensor generation:  0.03624153137207031
mini_batch_src_global generation:  0.058746337890625
r_  generation:  0.5333912372589111
local_output_nid generation:  0.031275272369384766
local_in_edges_tensor generation:  0.033944129943847656
mini_batch_src_global generation:  0.060009002685546875
r_  generation:  0.5295851230621338
local_output_nid generation:  0.031529903411865234
local_in_edges_tensor generation:  0.07607913017272949
mini_batch_src_global generation:  0.06024980545043945
r_  generation:  0.5556182861328125
local_output_nid generation:  0.031913042068481445
local_in_edges_tensor generation:  0.032038211822509766
mini_batch_src_global generation:  0.06202363967895508
r_  generation:  0.53700852394104
local_output_nid generation:  0.03189492225646973
local_in_edges_tensor generation:  0.034002065658569336
mini_batch_src_global generation:  0.06252098083496094
r_  generation:  0.5488541126251221
local_output_nid generation:  0.03162670135498047
local_in_edges_tensor generation:  0.03091287612915039
mini_batch_src_global generation:  0.0623171329498291
r_  generation:  0.5366251468658447
local_output_nid generation:  0.03185606002807617
local_in_edges_tensor generation:  0.031209468841552734
mini_batch_src_global generation:  0.061382293701171875
r_  generation:  0.5405771732330322
local_output_nid generation:  0.03192853927612305
local_in_edges_tensor generation:  0.03367304801940918
mini_batch_src_global generation:  0.06192207336425781
r_  generation:  0.5559532642364502
local_output_nid generation:  0.03491544723510742
local_in_edges_tensor generation:  0.03168511390686035
mini_batch_src_global generation:  0.06462264060974121
r_  generation:  0.5408310890197754
local_output_nid generation:  0.033081769943237305
local_in_edges_tensor generation:  0.0360867977142334
mini_batch_src_global generation:  0.06273436546325684
r_  generation:  0.5397870540618896
local_output_nid generation:  0.032956600189208984
local_in_edges_tensor generation:  0.03189706802368164
mini_batch_src_global generation:  0.061222076416015625
r_  generation:  0.5362133979797363
local_output_nid generation:  0.033063650131225586
local_in_edges_tensor generation:  0.033156633377075195
mini_batch_src_global generation:  0.06503510475158691
r_  generation:  0.5417249202728271
local_output_nid generation:  0.032988548278808594
local_in_edges_tensor generation:  0.03402137756347656
mini_batch_src_global generation:  0.06363081932067871
r_  generation:  0.5401749610900879
local_output_nid generation:  0.03335738182067871
local_in_edges_tensor generation:  0.031790971755981445
mini_batch_src_global generation:  0.062296390533447266
r_  generation:  0.5475375652313232
----------------------check_connections_block total spend ----------------------------- 12.620120286941528
generate_one_block  0.675574779510498
generate_one_block  0.6755399703979492
generate_one_block  0.6806144714355469
generate_one_block  0.679743766784668
generate_one_block  0.681387186050415
generate_one_block  0.6871578693389893
generate_one_block  0.6840968132019043
generate_one_block  0.6724245548248291
generate_one_block  0.743959903717041
generate_one_block  0.6740672588348389
generate_one_block  0.6790199279785156
generate_one_block  0.6830956935882568
generate_one_block  0.6748354434967041
generate_one_block  0.6804189682006836
generate_one_block  0.6836051940917969
generate_one_block  0.6828556060791016
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.12972736358642578  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

connection checking time:  18.91327428817749
block generation total time  16.575680255889893
average batch blocks generation time:  1.0359800159931183
block dataloader generation time/epoch 37.83367785540494
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09978342056274414  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7706923484802246  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09975290298461914  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7693805694580078  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09959840774536133  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7660126686096191  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0995168685913086  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7643518447875977  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09974956512451172  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7713890075683594  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0999917984008789  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7817354202270508  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09978532791137695  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7757935523986816  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09955739974975586  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7665972709655762  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10063743591308594  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7683281898498535  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09956693649291992  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7670931816101074  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10083961486816406  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.780646800994873  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09997320175170898  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7815289497375488  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09960317611694336  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7686662673950195  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09983587265014648  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7732720375061035  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09971904754638672  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7719902992248535  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09985971450805664  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7806682586669922  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06891268491744995 |0.012628823518753052 |0.0035075843334198 |9.225308895111084e-05 |0.0037533193826675415 |0.003118276596069336 |
----------------------------------------------------------pseudo_mini_loss sum 1.3310869932174683
Total (block generation + training)time/epoch 39.30953218720176
Training time/epoch 1.4898672103881836
Training time without block to device /epoch 1.2878060340881348
Training time without total dataloading part /epoch 0.12076878547668457
load block tensor time/epoch 1.1026029586791992
block to device time/epoch 0.20206117630004883
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 20 |
Number of nodes for computation during this epoch:  5327213
Number of first layer input nodes during this epoch:  2521047
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.12865972518920898  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022503137588500977
range selection method range initialization spend 0.01386117935180664
time for parepare:  0.016233205795288086
local_output_nid generation:  0.0014255046844482422
local_in_edges_tensor generation:  0.006429910659790039
mini_batch_src_global generation:  0.0017826557159423828
r_  generation:  0.021661996841430664
local_output_nid generation:  0.0016231536865234375
local_in_edges_tensor generation:  0.0009686946868896484
mini_batch_src_global generation:  0.0020766258239746094
r_  generation:  0.021784305572509766
local_output_nid generation:  0.0016217231750488281
local_in_edges_tensor generation:  0.0009672641754150391
mini_batch_src_global generation:  0.0017147064208984375
r_  generation:  0.021500110626220703
local_output_nid generation:  0.0016689300537109375
local_in_edges_tensor generation:  0.0009284019470214844
mini_batch_src_global generation:  0.00173187255859375
r_  generation:  0.021128177642822266
local_output_nid generation:  0.0016047954559326172
local_in_edges_tensor generation:  0.00095367431640625
mini_batch_src_global generation:  0.0017578601837158203
r_  generation:  0.02154707908630371
local_output_nid generation:  0.00159454345703125
local_in_edges_tensor generation:  0.0009558200836181641
mini_batch_src_global generation:  0.0017583370208740234
r_  generation:  0.021780014038085938
local_output_nid generation:  0.0016131401062011719
local_in_edges_tensor generation:  0.0009293556213378906
mini_batch_src_global generation:  0.0017428398132324219
r_  generation:  0.02200484275817871
local_output_nid generation:  0.0016453266143798828
local_in_edges_tensor generation:  0.0009737014770507812
mini_batch_src_global generation:  0.0018339157104492188
r_  generation:  0.0224912166595459
local_output_nid generation:  0.001596212387084961
local_in_edges_tensor generation:  0.0009307861328125
mini_batch_src_global generation:  0.0018222332000732422
r_  generation:  0.022523164749145508
local_output_nid generation:  0.0016183853149414062
local_in_edges_tensor generation:  0.0009372234344482422
mini_batch_src_global generation:  0.0017933845520019531
r_  generation:  0.02219223976135254
local_output_nid generation:  0.0015981197357177734
local_in_edges_tensor generation:  0.0009446144104003906
mini_batch_src_global generation:  0.001773834228515625
r_  generation:  0.021944284439086914
local_output_nid generation:  0.0016355514526367188
local_in_edges_tensor generation:  0.000926971435546875
mini_batch_src_global generation:  0.0017442703247070312
r_  generation:  0.022299766540527344
local_output_nid generation:  0.0016124248504638672
local_in_edges_tensor generation:  0.0009129047393798828
mini_batch_src_global generation:  0.0017647743225097656
r_  generation:  0.022533178329467773
local_output_nid generation:  0.0015873908996582031
local_in_edges_tensor generation:  0.0009069442749023438
mini_batch_src_global generation:  0.0017480850219726562
r_  generation:  0.022067546844482422
local_output_nid generation:  0.0015943050384521484
local_in_edges_tensor generation:  0.0009577274322509766
mini_batch_src_global generation:  0.0017328262329101562
r_  generation:  0.021924257278442383
local_output_nid generation:  0.0015773773193359375
local_in_edges_tensor generation:  0.0008950233459472656
mini_batch_src_global generation:  0.001703500747680664
r_  generation:  0.02200174331665039
----------------------check_connections_block total spend ----------------------------- 0.5201563835144043
generate_one_block  0.030987262725830078
generate_one_block  0.030466318130493164
generate_one_block  0.031333208084106445
generate_one_block  0.030867576599121094
generate_one_block  0.03127169609069824
generate_one_block  0.03291583061218262
generate_one_block  0.030986547470092773
generate_one_block  0.0315699577331543
generate_one_block  0.03202962875366211
generate_one_block  0.03137469291687012
generate_one_block  0.03104090690612793
generate_one_block  0.0312809944152832
generate_one_block  0.031610727310180664
generate_one_block  0.03099799156188965
generate_one_block  0.031340599060058594
generate_one_block  0.03193831443786621
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.034119367599487305
gen group dst list time:  0.018192291259765625
time for parepare:  0.019632339477539062
local_output_nid generation:  0.0074787139892578125
local_in_edges_tensor generation:  0.024384737014770508
mini_batch_src_global generation:  0.03974437713623047
r_  generation:  0.2532017230987549
local_output_nid generation:  0.011217117309570312
local_in_edges_tensor generation:  0.016071081161499023
mini_batch_src_global generation:  0.03347301483154297
r_  generation:  0.26125478744506836
local_output_nid generation:  0.011939764022827148
local_in_edges_tensor generation:  0.015012979507446289
mini_batch_src_global generation:  0.032334327697753906
r_  generation:  0.2656538486480713
local_output_nid generation:  0.012360334396362305
local_in_edges_tensor generation:  0.012814521789550781
mini_batch_src_global generation:  0.03319549560546875
r_  generation:  0.2631819248199463
local_output_nid generation:  0.012143611907958984
local_in_edges_tensor generation:  0.013281583786010742
mini_batch_src_global generation:  0.0346827507019043
r_  generation:  0.27410006523132324
local_output_nid generation:  0.012550115585327148
local_in_edges_tensor generation:  0.013132810592651367
mini_batch_src_global generation:  0.03627800941467285
r_  generation:  0.2699434757232666
local_output_nid generation:  0.012810468673706055
local_in_edges_tensor generation:  0.01458430290222168
mini_batch_src_global generation:  0.03424811363220215
r_  generation:  0.2703526020050049
local_output_nid generation:  0.013277053833007812
local_in_edges_tensor generation:  0.013321161270141602
mini_batch_src_global generation:  0.03560757637023926
r_  generation:  0.2761075496673584
local_output_nid generation:  0.01331472396850586
local_in_edges_tensor generation:  0.0169675350189209
mini_batch_src_global generation:  0.036196231842041016
r_  generation:  0.2784583568572998
local_output_nid generation:  0.013004064559936523
local_in_edges_tensor generation:  0.013266801834106445
mini_batch_src_global generation:  0.03431296348571777
r_  generation:  0.2728900909423828
local_output_nid generation:  0.012919187545776367
local_in_edges_tensor generation:  0.013474225997924805
mini_batch_src_global generation:  0.03538966178894043
r_  generation:  0.2713174819946289
local_output_nid generation:  0.013157844543457031
local_in_edges_tensor generation:  0.013756036758422852
mini_batch_src_global generation:  0.03531217575073242
r_  generation:  0.2796332836151123
local_output_nid generation:  0.01336359977722168
local_in_edges_tensor generation:  0.013437509536743164
mini_batch_src_global generation:  0.03764152526855469
r_  generation:  0.2775838375091553
local_output_nid generation:  0.013271570205688477
local_in_edges_tensor generation:  0.013710737228393555
mini_batch_src_global generation:  0.03482866287231445
r_  generation:  0.272296667098999
local_output_nid generation:  0.013072490692138672
local_in_edges_tensor generation:  0.013506650924682617
mini_batch_src_global generation:  0.0350191593170166
r_  generation:  0.2716057300567627
local_output_nid generation:  0.01279139518737793
local_in_edges_tensor generation:  0.013695716857910156
mini_batch_src_global generation:  0.03470182418823242
r_  generation:  0.27358531951904297
----------------------check_connections_block total spend ----------------------------- 6.273873805999756
generate_one_block  0.3613905906677246
generate_one_block  0.3465087413787842
generate_one_block  0.35312318801879883
generate_one_block  0.3417387008666992
generate_one_block  0.3549318313598633
generate_one_block  0.3460817337036133
generate_one_block  0.3741304874420166
generate_one_block  0.35239481925964355
generate_one_block  0.3610506057739258
generate_one_block  0.3468339443206787
generate_one_block  0.34711790084838867
generate_one_block  0.35039329528808594
generate_one_block  0.3579580783843994
generate_one_block  0.34720778465270996
generate_one_block  0.34644484519958496
generate_one_block  0.3483424186706543
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.038298845291137695
gen group dst list time:  0.0678563117980957
time for parepare:  0.018238306045532227
local_output_nid generation:  0.027273893356323242
local_in_edges_tensor generation:  0.05102086067199707
mini_batch_src_global generation:  0.05116009712219238
r_  generation:  0.5379891395568848
local_output_nid generation:  0.03122711181640625
local_in_edges_tensor generation:  0.03936171531677246
mini_batch_src_global generation:  0.06270551681518555
r_  generation:  0.5340371131896973
local_output_nid generation:  0.03212857246398926
local_in_edges_tensor generation:  0.03204178810119629
mini_batch_src_global generation:  0.05963730812072754
r_  generation:  0.5450716018676758
local_output_nid generation:  0.0358431339263916
local_in_edges_tensor generation:  0.0350644588470459
mini_batch_src_global generation:  0.05996513366699219
r_  generation:  0.5349006652832031
local_output_nid generation:  0.03241419792175293
local_in_edges_tensor generation:  0.07947611808776855
mini_batch_src_global generation:  0.06052827835083008
r_  generation:  0.5437934398651123
local_output_nid generation:  0.03239297866821289
local_in_edges_tensor generation:  0.032541513442993164
mini_batch_src_global generation:  0.06248784065246582
r_  generation:  0.538196325302124
local_output_nid generation:  0.032399654388427734
local_in_edges_tensor generation:  0.032421112060546875
mini_batch_src_global generation:  0.0616602897644043
r_  generation:  0.5447936058044434
local_output_nid generation:  0.032427072525024414
local_in_edges_tensor generation:  0.039407968521118164
mini_batch_src_global generation:  0.06472992897033691
r_  generation:  0.5381927490234375
local_output_nid generation:  0.032312631607055664
local_in_edges_tensor generation:  0.03494763374328613
mini_batch_src_global generation:  0.06173396110534668
r_  generation:  0.5527670383453369
local_output_nid generation:  0.03293013572692871
local_in_edges_tensor generation:  0.03668642044067383
mini_batch_src_global generation:  0.06281757354736328
r_  generation:  0.5481932163238525
local_output_nid generation:  0.03262686729431152
local_in_edges_tensor generation:  0.03427767753601074
mini_batch_src_global generation:  0.06490969657897949
r_  generation:  0.5565822124481201
local_output_nid generation:  0.03229379653930664
local_in_edges_tensor generation:  0.032454490661621094
mini_batch_src_global generation:  0.062134504318237305
r_  generation:  0.5512802600860596
local_output_nid generation:  0.032698631286621094
local_in_edges_tensor generation:  0.03529214859008789
mini_batch_src_global generation:  0.062142372131347656
r_  generation:  0.554173469543457
local_output_nid generation:  0.033190250396728516
local_in_edges_tensor generation:  0.038990020751953125
mini_batch_src_global generation:  0.062326908111572266
r_  generation:  0.5478005409240723
local_output_nid generation:  0.03318333625793457
local_in_edges_tensor generation:  0.03467559814453125
mini_batch_src_global generation:  0.06415772438049316
r_  generation:  0.5513346195220947
local_output_nid generation:  0.032958030700683594
local_in_edges_tensor generation:  0.03261733055114746
mini_batch_src_global generation:  0.061795949935913086
r_  generation:  0.5567023754119873
----------------------check_connections_block total spend ----------------------------- 12.782279253005981
generate_one_block  0.6869015693664551
generate_one_block  0.6768820285797119
generate_one_block  0.6835248470306396
generate_one_block  0.6801681518554688
generate_one_block  0.6830039024353027
generate_one_block  0.6799123287200928
generate_one_block  0.6756713390350342
generate_one_block  0.6886143684387207
generate_one_block  0.7286820411682129
generate_one_block  0.6876068115234375
generate_one_block  0.6914691925048828
generate_one_block  0.6807889938354492
generate_one_block  0.6865322589874268
generate_one_block  0.6994104385375977
generate_one_block  0.6919045448303223
generate_one_block  0.6893506050109863
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.12865972518920898  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

connection checking time:  19.056153059005737
block generation total time  16.646072387695312
average batch blocks generation time:  1.040379524230957
block dataloader generation time/epoch 37.84218490123749
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10092496871948242  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.781651496887207  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09974527359008789  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7676882743835449  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09966897964477539  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7732634544372559  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09947443008422852  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7669281959533691  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09987354278564453  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7735352516174316  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09962034225463867  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7680563926696777  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09959220886230469  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7688436508178711  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09973859786987305  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7720088958740234  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09985542297363281  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7746486663818359  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09966468811035156  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7697381973266602  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09964895248413086  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7686328887939453  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09967565536499023  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7706260681152344  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10091590881347656  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7817473411560059  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09990501403808594  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7755866050720215  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09973907470703125  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.771878719329834  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09987783432006836  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7771930694580078  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06495808064937592 |0.014633595943450928 |0.003514334559440613 |9.106099605560303e-05 |0.0034292489290237427 |0.0013234615325927734 |
----------------------------------------------------------pseudo_mini_loss sum 1.313301920890808
Total (block generation + training)time/epoch 39.31632149219513
Training time/epoch 1.4550304412841797
Training time without block to device /epoch 1.2208929061889648
Training time without total dataloading part /epoch 0.11387777328491211
load block tensor time/epoch 1.0393292903900146
block to device time/epoch 0.23413753509521484
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 21 |
Number of nodes for computation during this epoch:  5329953
Number of first layer input nodes during this epoch:  2521176
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.12850666046142578  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022472620010375977
range selection method range initialization spend 0.012235403060913086
time for parepare:  0.01619887351989746
local_output_nid generation:  0.001453399658203125
local_in_edges_tensor generation:  0.007867097854614258
mini_batch_src_global generation:  0.0017933845520019531
r_  generation:  0.021608352661132812
local_output_nid generation:  0.001621246337890625
local_in_edges_tensor generation:  0.000985860824584961
mini_batch_src_global generation:  0.002023935317993164
r_  generation:  0.022586822509765625
local_output_nid generation:  0.001600027084350586
local_in_edges_tensor generation:  0.0009558200836181641
mini_batch_src_global generation:  0.0017096996307373047
r_  generation:  0.021342992782592773
local_output_nid generation:  0.001638174057006836
local_in_edges_tensor generation:  0.0009343624114990234
mini_batch_src_global generation:  0.0017418861389160156
r_  generation:  0.0216062068939209
local_output_nid generation:  0.0015707015991210938
local_in_edges_tensor generation:  0.0009627342224121094
mini_batch_src_global generation:  0.0017781257629394531
r_  generation:  0.021669626235961914
local_output_nid generation:  0.0015950202941894531
local_in_edges_tensor generation:  0.0009560585021972656
mini_batch_src_global generation:  0.001781463623046875
r_  generation:  0.02252483367919922
local_output_nid generation:  0.001600503921508789
local_in_edges_tensor generation:  0.0009365081787109375
mini_batch_src_global generation:  0.0017926692962646484
r_  generation:  0.022179365158081055
local_output_nid generation:  0.0015952587127685547
local_in_edges_tensor generation:  0.0009441375732421875
mini_batch_src_global generation:  0.0017442703247070312
r_  generation:  0.022040367126464844
local_output_nid generation:  0.0015788078308105469
local_in_edges_tensor generation:  0.0009627342224121094
mini_batch_src_global generation:  0.0017862319946289062
r_  generation:  0.02224874496459961
local_output_nid generation:  0.0015513896942138672
local_in_edges_tensor generation:  0.0011897087097167969
mini_batch_src_global generation:  0.0017580986022949219
r_  generation:  0.021423816680908203
local_output_nid generation:  0.0015749931335449219
local_in_edges_tensor generation:  0.0009343624114990234
mini_batch_src_global generation:  0.0017614364624023438
r_  generation:  0.02215290069580078
local_output_nid generation:  0.001573324203491211
local_in_edges_tensor generation:  0.000982046127319336
mini_batch_src_global generation:  0.001760721206665039
r_  generation:  0.02185797691345215
local_output_nid generation:  0.0015683174133300781
local_in_edges_tensor generation:  0.0009179115295410156
mini_batch_src_global generation:  0.0018184185028076172
r_  generation:  0.02239823341369629
local_output_nid generation:  0.0015494823455810547
local_in_edges_tensor generation:  0.0009202957153320312
mini_batch_src_global generation:  0.0018181800842285156
r_  generation:  0.022092580795288086
local_output_nid generation:  0.0015597343444824219
local_in_edges_tensor generation:  0.0009341239929199219
mini_batch_src_global generation:  0.0017690658569335938
r_  generation:  0.021841049194335938
local_output_nid generation:  0.0015540122985839844
local_in_edges_tensor generation:  0.0009219646453857422
mini_batch_src_global generation:  0.0018117427825927734
r_  generation:  0.02233576774597168
----------------------check_connections_block total spend ----------------------------- 0.5222582817077637
generate_one_block  0.034684181213378906
generate_one_block  0.031044483184814453
generate_one_block  0.030811071395874023
generate_one_block  0.03143930435180664
generate_one_block  0.03182625770568848
generate_one_block  0.034424781799316406
generate_one_block  0.03165769577026367
generate_one_block  0.03126382827758789
generate_one_block  0.031940460205078125
generate_one_block  0.030066251754760742
generate_one_block  0.03511691093444824
generate_one_block  0.031049728393554688
generate_one_block  0.031821250915527344
generate_one_block  0.03145766258239746
generate_one_block  0.030649900436401367
generate_one_block  0.03188300132751465
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0412750244140625
gen group dst list time:  0.018195390701293945
time for parepare:  0.019371747970581055
local_output_nid generation:  0.007551908493041992
local_in_edges_tensor generation:  0.02569890022277832
mini_batch_src_global generation:  0.028028011322021484
r_  generation:  0.2563142776489258
local_output_nid generation:  0.0111236572265625
local_in_edges_tensor generation:  0.01565408706665039
mini_batch_src_global generation:  0.03435635566711426
r_  generation:  0.25934386253356934
local_output_nid generation:  0.011608600616455078
local_in_edges_tensor generation:  0.014330863952636719
mini_batch_src_global generation:  0.03195476531982422
r_  generation:  0.26406002044677734
local_output_nid generation:  0.012415170669555664
local_in_edges_tensor generation:  0.013114690780639648
mini_batch_src_global generation:  0.0327298641204834
r_  generation:  0.2691023349761963
local_output_nid generation:  0.012392282485961914
local_in_edges_tensor generation:  0.014448404312133789
mini_batch_src_global generation:  0.03547930717468262
r_  generation:  0.2733168601989746
local_output_nid generation:  0.012702226638793945
local_in_edges_tensor generation:  0.016234397888183594
mini_batch_src_global generation:  0.03521847724914551
r_  generation:  0.28154873847961426
local_output_nid generation:  0.012864112854003906
local_in_edges_tensor generation:  0.013684511184692383
mini_batch_src_global generation:  0.03549480438232422
r_  generation:  0.27458691596984863
local_output_nid generation:  0.012881994247436523
local_in_edges_tensor generation:  0.01804041862487793
mini_batch_src_global generation:  0.03401446342468262
r_  generation:  0.27233290672302246
local_output_nid generation:  0.013135433197021484
local_in_edges_tensor generation:  0.013662338256835938
mini_batch_src_global generation:  0.037880897521972656
r_  generation:  0.2740039825439453
local_output_nid generation:  0.012709856033325195
local_in_edges_tensor generation:  0.017471790313720703
mini_batch_src_global generation:  0.036046504974365234
r_  generation:  0.2650477886199951
local_output_nid generation:  0.013218879699707031
local_in_edges_tensor generation:  0.013753175735473633
mini_batch_src_global generation:  0.03702569007873535
r_  generation:  0.2760660648345947
local_output_nid generation:  0.013161420822143555
local_in_edges_tensor generation:  0.017585039138793945
mini_batch_src_global generation:  0.03560996055603027
r_  generation:  0.2717742919921875
local_output_nid generation:  0.013385295867919922
local_in_edges_tensor generation:  0.016652345657348633
mini_batch_src_global generation:  0.03670215606689453
r_  generation:  0.2772643566131592
local_output_nid generation:  0.01329660415649414
local_in_edges_tensor generation:  0.014789104461669922
mini_batch_src_global generation:  0.03447890281677246
r_  generation:  0.2745788097381592
local_output_nid generation:  0.01302027702331543
local_in_edges_tensor generation:  0.013700246810913086
mini_batch_src_global generation:  0.03576183319091797
r_  generation:  0.2748861312866211
local_output_nid generation:  0.012981414794921875
local_in_edges_tensor generation:  0.014988899230957031
mini_batch_src_global generation:  0.03638005256652832
r_  generation:  0.2775881290435791
----------------------check_connections_block total spend ----------------------------- 6.298520803451538
generate_one_block  0.35653162002563477
generate_one_block  0.3539113998413086
generate_one_block  0.3495800495147705
generate_one_block  0.35164451599121094
generate_one_block  0.3525664806365967
generate_one_block  0.3612203598022461
generate_one_block  0.3741438388824463
generate_one_block  0.34638547897338867
generate_one_block  0.35178303718566895
generate_one_block  0.3416616916656494
generate_one_block  0.35327625274658203
generate_one_block  0.3465306758880615
generate_one_block  0.35655999183654785
generate_one_block  0.35436391830444336
generate_one_block  0.34787607192993164
generate_one_block  0.35886359214782715
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.08916068077087402
gen group dst list time:  0.06652998924255371
time for parepare:  0.019484996795654297
local_output_nid generation:  0.026276826858520508
local_in_edges_tensor generation:  0.04981279373168945
mini_batch_src_global generation:  0.05223870277404785
r_  generation:  0.532130241394043
local_output_nid generation:  0.0312502384185791
local_in_edges_tensor generation:  0.0348663330078125
mini_batch_src_global generation:  0.06521725654602051
r_  generation:  0.5384242534637451
local_output_nid generation:  0.031533002853393555
local_in_edges_tensor generation:  0.03510403633117676
mini_batch_src_global generation:  0.05960893630981445
r_  generation:  0.5422701835632324
local_output_nid generation:  0.031740427017211914
local_in_edges_tensor generation:  0.036655426025390625
mini_batch_src_global generation:  0.060350894927978516
r_  generation:  0.5339512825012207
local_output_nid generation:  0.03170156478881836
local_in_edges_tensor generation:  0.08089423179626465
mini_batch_src_global generation:  0.0603795051574707
r_  generation:  0.5436949729919434
local_output_nid generation:  0.0321195125579834
local_in_edges_tensor generation:  0.03548574447631836
mini_batch_src_global generation:  0.06210517883300781
r_  generation:  0.5348336696624756
local_output_nid generation:  0.03203082084655762
local_in_edges_tensor generation:  0.032675981521606445
mini_batch_src_global generation:  0.07498335838317871
r_  generation:  0.5487167835235596
local_output_nid generation:  0.033956289291381836
local_in_edges_tensor generation:  0.03509211540222168
mini_batch_src_global generation:  0.06278085708618164
r_  generation:  0.536531925201416
local_output_nid generation:  0.03340768814086914
local_in_edges_tensor generation:  0.03535008430480957
mini_batch_src_global generation:  0.06183648109436035
r_  generation:  0.5468266010284424
local_output_nid generation:  0.03298783302307129
local_in_edges_tensor generation:  0.034689903259277344
mini_batch_src_global generation:  0.06280755996704102
r_  generation:  0.5462887287139893
local_output_nid generation:  0.03347063064575195
local_in_edges_tensor generation:  0.03284406661987305
mini_batch_src_global generation:  0.06147575378417969
r_  generation:  0.5527029037475586
local_output_nid generation:  0.03309774398803711
local_in_edges_tensor generation:  0.0373997688293457
mini_batch_src_global generation:  0.0631110668182373
r_  generation:  0.5437872409820557
local_output_nid generation:  0.03405332565307617
local_in_edges_tensor generation:  0.03528594970703125
mini_batch_src_global generation:  0.06224966049194336
r_  generation:  0.5482854843139648
local_output_nid generation:  0.0333406925201416
local_in_edges_tensor generation:  0.03268766403198242
mini_batch_src_global generation:  0.062421560287475586
r_  generation:  0.5430171489715576
local_output_nid generation:  0.03310823440551758
local_in_edges_tensor generation:  0.038004398345947266
mini_batch_src_global generation:  0.06517243385314941
r_  generation:  0.5447680950164795
local_output_nid generation:  0.03319096565246582
local_in_edges_tensor generation:  0.03537631034851074
mini_batch_src_global generation:  0.06267905235290527
r_  generation:  0.5429885387420654
----------------------check_connections_block total spend ----------------------------- 12.752936124801636
generate_one_block  0.691554069519043
generate_one_block  0.6827449798583984
generate_one_block  0.677253007888794
generate_one_block  0.6786720752716064
generate_one_block  0.68253493309021
generate_one_block  0.6899435520172119
generate_one_block  0.6832747459411621
generate_one_block  0.6919758319854736
generate_one_block  0.7534472942352295
generate_one_block  0.6731595993041992
generate_one_block  0.685697078704834
generate_one_block  0.6781032085418701
generate_one_block  0.682593584060669
generate_one_block  0.6749682426452637
generate_one_block  0.6807284355163574
generate_one_block  0.6920483112335205
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.12850666046142578  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

connection checking time:  19.051456928253174
block generation total time  16.655597925186157
average batch blocks generation time:  1.0409748703241348
block dataloader generation time/epoch 37.85145075504597
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10094308853149414  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7825832366943359  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09966707229614258  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7707152366638184  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10077381134033203  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7716360092163086  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09983301162719727  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7768135070800781  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09981250762939453  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7768630981445312  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09987640380859375  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7807650566101074  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09963083267211914  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.770716667175293  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09954118728637695  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7682514190673828  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10081672668457031  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7778377532958984  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0993189811706543  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7597074508666992  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.1008453369140625  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7768135070800781  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09964847564697266  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7664790153503418  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09970331192016602  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.77587890625  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09968900680541992  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7697405815124512  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09968233108520508  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7700562477111816  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09991216659545898  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7813401222229004  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06896679103374481 |0.0166795551776886 |0.0035353153944015503 |9.174644947052002e-05 |0.0037420988082885742 |0.001772165298461914 |
----------------------------------------------------------pseudo_mini_loss sum 1.297202706336975
Total (block generation + training)time/epoch 39.33170791772696
Training time/epoch 1.5534248352050781
Training time without block to device /epoch 1.2865519523620605
Training time without total dataloading part /epoch 0.11967873573303223
load block tensor time/epoch 1.103468656539917
block to device time/epoch 0.2668728828430176
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 22 |
Number of nodes for computation during this epoch:  5329322
Number of first layer input nodes during this epoch:  2520507
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.12964582443237305  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02368927001953125
range selection method range initialization spend 0.012260913848876953
time for parepare:  0.01743149757385254
local_output_nid generation:  0.0014297962188720703
local_in_edges_tensor generation:  0.0066852569580078125
mini_batch_src_global generation:  0.0017800331115722656
r_  generation:  0.02137160301208496
local_output_nid generation:  0.001581430435180664
local_in_edges_tensor generation:  0.0009686946868896484
mini_batch_src_global generation:  0.002123594284057617
r_  generation:  0.022642135620117188
local_output_nid generation:  0.0015790462493896484
local_in_edges_tensor generation:  0.0009510517120361328
mini_batch_src_global generation:  0.0017435550689697266
r_  generation:  0.021958589553833008
local_output_nid generation:  0.0016279220581054688
local_in_edges_tensor generation:  0.0009529590606689453
mini_batch_src_global generation:  0.001852273941040039
r_  generation:  0.021960735321044922
local_output_nid generation:  0.0015475749969482422
local_in_edges_tensor generation:  0.0009591579437255859
mini_batch_src_global generation:  0.0017933845520019531
r_  generation:  0.02217864990234375
local_output_nid generation:  0.0015952587127685547
local_in_edges_tensor generation:  0.0009484291076660156
mini_batch_src_global generation:  0.0017852783203125
r_  generation:  0.022179126739501953
local_output_nid generation:  0.0015544891357421875
local_in_edges_tensor generation:  0.0009677410125732422
mini_batch_src_global generation:  0.0017616748809814453
r_  generation:  0.02163100242614746
local_output_nid generation:  0.0015807151794433594
local_in_edges_tensor generation:  0.0009582042694091797
mini_batch_src_global generation:  0.0017211437225341797
r_  generation:  0.02242565155029297
local_output_nid generation:  0.001584768295288086
local_in_edges_tensor generation:  0.0009353160858154297
mini_batch_src_global generation:  0.0017783641815185547
r_  generation:  0.021840333938598633
local_output_nid generation:  0.0015480518341064453
local_in_edges_tensor generation:  0.00091552734375
mini_batch_src_global generation:  0.0017955303192138672
r_  generation:  0.022299766540527344
local_output_nid generation:  0.0015685558319091797
local_in_edges_tensor generation:  0.0009307861328125
mini_batch_src_global generation:  0.0017936229705810547
r_  generation:  0.0218203067779541
local_output_nid generation:  0.0015680789947509766
local_in_edges_tensor generation:  0.0008854866027832031
mini_batch_src_global generation:  0.00466465950012207
r_  generation:  0.022369384765625
local_output_nid generation:  0.0015769004821777344
local_in_edges_tensor generation:  0.0009424686431884766
mini_batch_src_global generation:  0.0017914772033691406
r_  generation:  0.023671865463256836
local_output_nid generation:  0.00167083740234375
local_in_edges_tensor generation:  0.0009741783142089844
mini_batch_src_global generation:  0.0017893314361572266
r_  generation:  0.021731853485107422
local_output_nid generation:  0.001659393310546875
local_in_edges_tensor generation:  0.0009112358093261719
mini_batch_src_global generation:  0.0017516613006591797
r_  generation:  0.022385835647583008
local_output_nid generation:  0.0016520023345947266
local_in_edges_tensor generation:  0.0008835792541503906
mini_batch_src_global generation:  0.001743316650390625
r_  generation:  0.022165775299072266
----------------------check_connections_block total spend ----------------------------- 0.5294773578643799
generate_one_block  0.031024694442749023
generate_one_block  0.03104114532470703
generate_one_block  0.03166460990905762
generate_one_block  0.03197216987609863
generate_one_block  0.03131842613220215
generate_one_block  0.03278541564941406
generate_one_block  0.030580520629882812
generate_one_block  0.031183481216430664
generate_one_block  0.03101658821105957
generate_one_block  0.03173017501831055
generate_one_block  0.030620813369750977
generate_one_block  0.03159332275390625
generate_one_block  0.030953168869018555
generate_one_block  0.030512571334838867
generate_one_block  0.031537532806396484
generate_one_block  0.03202509880065918
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0394895076751709
gen group dst list time:  0.019644737243652344
time for parepare:  0.019423961639404297
local_output_nid generation:  0.0076007843017578125
local_in_edges_tensor generation:  0.026405811309814453
mini_batch_src_global generation:  0.028032302856445312
r_  generation:  0.2541224956512451
local_output_nid generation:  0.011287450790405273
local_in_edges_tensor generation:  0.01359868049621582
mini_batch_src_global generation:  0.03316473960876465
r_  generation:  0.2625257968902588
local_output_nid generation:  0.01239156723022461
local_in_edges_tensor generation:  0.01402735710144043
mini_batch_src_global generation:  0.03380107879638672
r_  generation:  0.2669548988342285
local_output_nid generation:  0.012550830841064453
local_in_edges_tensor generation:  0.015065193176269531
mini_batch_src_global generation:  0.03425431251525879
r_  generation:  0.2724189758300781
local_output_nid generation:  0.012156486511230469
local_in_edges_tensor generation:  0.013874530792236328
mini_batch_src_global generation:  0.03449511528015137
r_  generation:  0.26996588706970215
local_output_nid generation:  0.012721061706542969
local_in_edges_tensor generation:  0.01680898666381836
mini_batch_src_global generation:  0.033883094787597656
r_  generation:  0.2718231678009033
local_output_nid generation:  0.012856245040893555
local_in_edges_tensor generation:  0.014787673950195312
mini_batch_src_global generation:  0.03443121910095215
r_  generation:  0.2690622806549072
local_output_nid generation:  0.013002634048461914
local_in_edges_tensor generation:  0.013375997543334961
mini_batch_src_global generation:  0.03432512283325195
r_  generation:  0.27530455589294434
local_output_nid generation:  0.014572381973266602
local_in_edges_tensor generation:  0.013664722442626953
mini_batch_src_global generation:  0.03477787971496582
r_  generation:  0.2704782485961914
local_output_nid generation:  0.013149738311767578
local_in_edges_tensor generation:  0.013364315032958984
mini_batch_src_global generation:  0.03480648994445801
r_  generation:  0.27692508697509766
local_output_nid generation:  0.013023138046264648
local_in_edges_tensor generation:  0.015088558197021484
mini_batch_src_global generation:  0.034903764724731445
r_  generation:  0.26895761489868164
local_output_nid generation:  0.013239145278930664
local_in_edges_tensor generation:  0.013470172882080078
mini_batch_src_global generation:  0.03631734848022461
r_  generation:  0.27769017219543457
local_output_nid generation:  0.013160228729248047
local_in_edges_tensor generation:  0.014970779418945312
mini_batch_src_global generation:  0.035124778747558594
r_  generation:  0.27404117584228516
local_output_nid generation:  0.01300048828125
local_in_edges_tensor generation:  0.01324772834777832
mini_batch_src_global generation:  0.03596234321594238
r_  generation:  0.2643454074859619
local_output_nid generation:  0.013254880905151367
local_in_edges_tensor generation:  0.015529632568359375
mini_batch_src_global generation:  0.0355839729309082
r_  generation:  0.28021860122680664
local_output_nid generation:  0.012782812118530273
local_in_edges_tensor generation:  0.01607036590576172
mini_batch_src_global generation:  0.03497314453125
r_  generation:  0.27554988861083984
----------------------check_connections_block total spend ----------------------------- 6.265488147735596
generate_one_block  0.3590233325958252
generate_one_block  0.3529379367828369
generate_one_block  0.3543965816497803
generate_one_block  0.3574190139770508
generate_one_block  0.35045313835144043
generate_one_block  0.34596824645996094
generate_one_block  0.37013673782348633
generate_one_block  0.3551304340362549
generate_one_block  0.34624457359313965
generate_one_block  0.3566274642944336
generate_one_block  0.3480706214904785
generate_one_block  0.3542466163635254
generate_one_block  0.34637880325317383
generate_one_block  0.34227538108825684
generate_one_block  0.3533134460449219
generate_one_block  0.35221314430236816
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03540945053100586
gen group dst list time:  0.06618046760559082
time for parepare:  0.018566608428955078
local_output_nid generation:  0.025226116180419922
local_in_edges_tensor generation:  0.05948829650878906
mini_batch_src_global generation:  0.05092215538024902
r_  generation:  0.5294597148895264
local_output_nid generation:  0.031046390533447266
local_in_edges_tensor generation:  0.041765451431274414
mini_batch_src_global generation:  0.06270217895507812
r_  generation:  0.5263392925262451
local_output_nid generation:  0.031126976013183594
local_in_edges_tensor generation:  0.034496307373046875
mini_batch_src_global generation:  0.05963635444641113
r_  generation:  0.542945384979248
local_output_nid generation:  0.03213071823120117
local_in_edges_tensor generation:  0.03340959548950195
mini_batch_src_global generation:  0.06008100509643555
r_  generation:  0.5371332168579102
local_output_nid generation:  0.03219270706176758
local_in_edges_tensor generation:  0.0777428150177002
mini_batch_src_global generation:  0.06046152114868164
r_  generation:  0.5427463054656982
local_output_nid generation:  0.031905174255371094
local_in_edges_tensor generation:  0.03462672233581543
mini_batch_src_global generation:  0.06164050102233887
r_  generation:  0.5424432754516602
local_output_nid generation:  0.032204389572143555
local_in_edges_tensor generation:  0.035245418548583984
mini_batch_src_global generation:  0.06366944313049316
r_  generation:  0.5430417060852051
local_output_nid generation:  0.03195309638977051
local_in_edges_tensor generation:  0.032999515533447266
mini_batch_src_global generation:  0.06192922592163086
r_  generation:  0.5466475486755371
local_output_nid generation:  0.0320582389831543
local_in_edges_tensor generation:  0.03560233116149902
mini_batch_src_global generation:  0.061131954193115234
r_  generation:  0.5458557605743408
local_output_nid generation:  0.03225302696228027
local_in_edges_tensor generation:  0.035123348236083984
mini_batch_src_global generation:  0.06418275833129883
r_  generation:  0.544299840927124
local_output_nid generation:  0.03233599662780762
local_in_edges_tensor generation:  0.03348422050476074
mini_batch_src_global generation:  0.06100869178771973
r_  generation:  0.5427024364471436
local_output_nid generation:  0.0325932502746582
local_in_edges_tensor generation:  0.03573036193847656
mini_batch_src_global generation:  0.061919450759887695
r_  generation:  0.54477858543396
local_output_nid generation:  0.032224178314208984
local_in_edges_tensor generation:  0.034713029861450195
mini_batch_src_global generation:  0.06187915802001953
r_  generation:  0.5418505668640137
local_output_nid generation:  0.0325312614440918
local_in_edges_tensor generation:  0.033017873764038086
mini_batch_src_global generation:  0.06273007392883301
r_  generation:  0.5420088768005371
local_output_nid generation:  0.0326695442199707
local_in_edges_tensor generation:  0.04327702522277832
mini_batch_src_global generation:  0.06151890754699707
r_  generation:  0.544224739074707
local_output_nid generation:  0.032715559005737305
local_in_edges_tensor generation:  0.03443741798400879
mini_batch_src_global generation:  0.06354808807373047
r_  generation:  0.5465104579925537
----------------------check_connections_block total spend ----------------------------- 12.713524103164673
generate_one_block  0.6810684204101562
generate_one_block  0.6810548305511475
generate_one_block  0.679713249206543
generate_one_block  0.6834526062011719
generate_one_block  0.6799423694610596
generate_one_block  0.684406042098999
generate_one_block  0.6834290027618408
generate_one_block  0.6806988716125488
generate_one_block  0.7184247970581055
generate_one_block  0.6812615394592285
generate_one_block  0.6768414974212646
generate_one_block  0.6811108589172363
generate_one_block  0.681926965713501
generate_one_block  0.682257890701294
generate_one_block  0.6853628158569336
generate_one_block  0.6840770244598389
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.12964582443237305  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

connection checking time:  18.97901225090027
block generation total time  16.589864253997803
average batch blocks generation time:  1.0368665158748627
block dataloader generation time/epoch 37.84606734343937
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09978055953979492  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7793354988098145  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10004711151123047  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.775693416595459  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10085582733154297  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7777743339538574  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09996318817138672  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7809925079345703  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09972763061523438  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7708430290222168  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09960174560546875  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7672080993652344  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10071277618408203  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7701230049133301  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09997367858886719  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7774577140808105  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09966468811035156  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7679295539855957  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09982109069824219  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7723689079284668  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09951305389404297  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7680187225341797  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.1000361442565918  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7807760238647461  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09954500198364258  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7669358253479004  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09955310821533203  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7664732933044434  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10085201263427734  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7779974937438965  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09999608993530273  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7770624160766602  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06973962485790253 |0.014298096299171448 |0.003510713577270508 |9.091198444366455e-05 |0.003694012761116028 |0.0013341903686523438 |
----------------------------------------------------------pseudo_mini_loss sum 1.2847777605056763
Total (block generation + training)time/epoch 39.32968616485596
Training time/epoch 1.5271356105804443
Training time without block to device /epoch 1.2983660697937012
Training time without total dataloading part /epoch 0.11806440353393555
load block tensor time/epoch 1.1158339977264404
block to device time/epoch 0.22876954078674316
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 23 |
Number of nodes for computation during this epoch:  5332754
Number of first layer input nodes during this epoch:  2522611
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.12870264053344727  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026688098907470703
range selection method range initialization spend 0.012326478958129883
time for parepare:  0.018244028091430664
local_output_nid generation:  0.0014407634735107422
local_in_edges_tensor generation:  0.0032210350036621094
mini_batch_src_global generation:  0.0017349720001220703
r_  generation:  0.021396160125732422
local_output_nid generation:  0.0015385150909423828
local_in_edges_tensor generation:  0.0009737014770507812
mini_batch_src_global generation:  0.002077341079711914
r_  generation:  0.021935462951660156
local_output_nid generation:  0.001567840576171875
local_in_edges_tensor generation:  0.0009505748748779297
mini_batch_src_global generation:  0.0016918182373046875
r_  generation:  0.021294593811035156
local_output_nid generation:  0.0015707015991210938
local_in_edges_tensor generation:  0.0009374618530273438
mini_batch_src_global generation:  0.0016922950744628906
r_  generation:  0.021914243698120117
local_output_nid generation:  0.0015492439270019531
local_in_edges_tensor generation:  0.0009210109710693359
mini_batch_src_global generation:  0.0017757415771484375
r_  generation:  0.0217742919921875
local_output_nid generation:  0.0016024112701416016
local_in_edges_tensor generation:  0.001016855239868164
mini_batch_src_global generation:  0.00174713134765625
r_  generation:  0.02262711524963379
local_output_nid generation:  0.0016150474548339844
local_in_edges_tensor generation:  0.001016855239868164
mini_batch_src_global generation:  0.0017676353454589844
r_  generation:  0.02205061912536621
local_output_nid generation:  0.001566171646118164
local_in_edges_tensor generation:  0.0009593963623046875
mini_batch_src_global generation:  0.0017404556274414062
r_  generation:  0.022338390350341797
local_output_nid generation:  0.0015785694122314453
local_in_edges_tensor generation:  0.0010311603546142578
mini_batch_src_global generation:  0.0017440319061279297
r_  generation:  0.021899938583374023
local_output_nid generation:  0.0015568733215332031
local_in_edges_tensor generation:  0.0009517669677734375
mini_batch_src_global generation:  0.0017578601837158203
r_  generation:  0.022187471389770508
local_output_nid generation:  0.0015501976013183594
local_in_edges_tensor generation:  0.0009222030639648438
mini_batch_src_global generation:  0.001753091812133789
r_  generation:  0.021727561950683594
local_output_nid generation:  0.001550436019897461
local_in_edges_tensor generation:  0.0009038448333740234
mini_batch_src_global generation:  0.0017962455749511719
r_  generation:  0.022839069366455078
local_output_nid generation:  0.001566171646118164
local_in_edges_tensor generation:  0.0010275840759277344
mini_batch_src_global generation:  0.0018229484558105469
r_  generation:  0.022922277450561523
local_output_nid generation:  0.0015697479248046875
local_in_edges_tensor generation:  0.0009360313415527344
mini_batch_src_global generation:  0.0018002986907958984
r_  generation:  0.021756410598754883
local_output_nid generation:  0.0015761852264404297
local_in_edges_tensor generation:  0.0009515285491943359
mini_batch_src_global generation:  0.001804351806640625
r_  generation:  0.022266864776611328
local_output_nid generation:  0.0015571117401123047
local_in_edges_tensor generation:  0.0009567737579345703
mini_batch_src_global generation:  0.0017273426055908203
r_  generation:  0.02153921127319336
----------------------check_connections_block total spend ----------------------------- 0.5193982124328613
generate_one_block  0.030069351196289062
generate_one_block  0.03146076202392578
generate_one_block  0.031029224395751953
generate_one_block  0.031856536865234375
generate_one_block  0.030869483947753906
generate_one_block  0.032631874084472656
generate_one_block  0.03091144561767578
generate_one_block  0.03186988830566406
generate_one_block  0.03091597557067871
generate_one_block  0.030956029891967773
generate_one_block  0.030932188034057617
generate_one_block  0.03221440315246582
generate_one_block  0.0320429801940918
generate_one_block  0.030750036239624023
generate_one_block  0.03143501281738281
generate_one_block  0.031231403350830078
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03943800926208496
gen group dst list time:  0.018515825271606445
time for parepare:  0.019171476364135742
local_output_nid generation:  0.007182121276855469
local_in_edges_tensor generation:  0.02399134635925293
mini_batch_src_global generation:  0.026998281478881836
r_  generation:  0.25496864318847656
local_output_nid generation:  0.013039588928222656
local_in_edges_tensor generation:  0.016029834747314453
mini_batch_src_global generation:  0.033814430236816406
r_  generation:  0.2643158435821533
local_output_nid generation:  0.011703252792358398
local_in_edges_tensor generation:  0.013010978698730469
mini_batch_src_global generation:  0.03305649757385254
r_  generation:  0.26232028007507324
local_output_nid generation:  0.012735843658447266
local_in_edges_tensor generation:  0.016560792922973633
mini_batch_src_global generation:  0.03835654258728027
r_  generation:  0.2715749740600586
local_output_nid generation:  0.012633562088012695
local_in_edges_tensor generation:  0.014717578887939453
mini_batch_src_global generation:  0.0341641902923584
r_  generation:  0.2696399688720703
local_output_nid generation:  0.012635231018066406
local_in_edges_tensor generation:  0.013622283935546875
mini_batch_src_global generation:  0.033570051193237305
r_  generation:  0.2720329761505127
local_output_nid generation:  0.013090372085571289
local_in_edges_tensor generation:  0.016022205352783203
mini_batch_src_global generation:  0.03436279296875
r_  generation:  0.2672157287597656
local_output_nid generation:  0.013340473175048828
local_in_edges_tensor generation:  0.01357269287109375
mini_batch_src_global generation:  0.034410715103149414
r_  generation:  0.2754225730895996
local_output_nid generation:  0.012985467910766602
local_in_edges_tensor generation:  0.013570308685302734
mini_batch_src_global generation:  0.03471231460571289
r_  generation:  0.26857447624206543
local_output_nid generation:  0.013278484344482422
local_in_edges_tensor generation:  0.013377666473388672
mini_batch_src_global generation:  0.038042545318603516
r_  generation:  0.27472615242004395
local_output_nid generation:  0.013124227523803711
local_in_edges_tensor generation:  0.013652801513671875
mini_batch_src_global generation:  0.03439688682556152
r_  generation:  0.26935315132141113
local_output_nid generation:  0.013280391693115234
local_in_edges_tensor generation:  0.013990402221679688
mini_batch_src_global generation:  0.036180734634399414
r_  generation:  0.27782440185546875
local_output_nid generation:  0.013663768768310547
local_in_edges_tensor generation:  0.018021583557128906
mini_batch_src_global generation:  0.03703594207763672
r_  generation:  0.28284335136413574
local_output_nid generation:  0.013251066207885742
local_in_edges_tensor generation:  0.013995170593261719
mini_batch_src_global generation:  0.0347599983215332
r_  generation:  0.2719850540161133
local_output_nid generation:  0.013379812240600586
local_in_edges_tensor generation:  0.014007806777954102
mini_batch_src_global generation:  0.035562992095947266
r_  generation:  0.2774500846862793
local_output_nid generation:  0.012681722640991211
local_in_edges_tensor generation:  0.01613593101501465
mini_batch_src_global generation:  0.037091970443725586
r_  generation:  0.272885799407959
----------------------check_connections_block total spend ----------------------------- 6.275727033615112
generate_one_block  0.3510904312133789
generate_one_block  0.3503715991973877
generate_one_block  0.34563565254211426
generate_one_block  0.3563411235809326
generate_one_block  0.34727931022644043
generate_one_block  0.3499763011932373
generate_one_block  0.368560791015625
generate_one_block  0.35688328742980957
generate_one_block  0.3403961658477783
generate_one_block  0.34911084175109863
generate_one_block  0.339383602142334
generate_one_block  0.35793113708496094
generate_one_block  0.36376452445983887
generate_one_block  0.34659695625305176
generate_one_block  0.3538045883178711
generate_one_block  0.34415483474731445
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03459787368774414
gen group dst list time:  0.0687258243560791
time for parepare:  0.0176849365234375
local_output_nid generation:  0.026221513748168945
local_in_edges_tensor generation:  0.04500937461853027
mini_batch_src_global generation:  0.050409555435180664
r_  generation:  0.5191059112548828
local_output_nid generation:  0.030762195587158203
local_in_edges_tensor generation:  0.0330510139465332
mini_batch_src_global generation:  0.06290054321289062
r_  generation:  0.522503137588501
local_output_nid generation:  0.03127574920654297
local_in_edges_tensor generation:  0.03296947479248047
mini_batch_src_global generation:  0.06025362014770508
r_  generation:  0.5399456024169922
local_output_nid generation:  0.03156590461730957
local_in_edges_tensor generation:  0.035352230072021484
mini_batch_src_global generation:  0.06006288528442383
r_  generation:  0.535825252532959
local_output_nid generation:  0.03174781799316406
local_in_edges_tensor generation:  0.07805299758911133
mini_batch_src_global generation:  0.060787200927734375
r_  generation:  0.5455765724182129
local_output_nid generation:  0.032032012939453125
local_in_edges_tensor generation:  0.03588700294494629
mini_batch_src_global generation:  0.06278443336486816
r_  generation:  0.5401229858398438
local_output_nid generation:  0.03228402137756348
local_in_edges_tensor generation:  0.03385782241821289
mini_batch_src_global generation:  0.06063222885131836
r_  generation:  0.5434732437133789
local_output_nid generation:  0.03199481964111328
local_in_edges_tensor generation:  0.03346586227416992
mini_batch_src_global generation:  0.06292104721069336
r_  generation:  0.5459206104278564
local_output_nid generation:  0.03192591667175293
local_in_edges_tensor generation:  0.03420710563659668
mini_batch_src_global generation:  0.06180238723754883
r_  generation:  0.544996976852417
local_output_nid generation:  0.03240466117858887
local_in_edges_tensor generation:  0.033417701721191406
mini_batch_src_global generation:  0.06722354888916016
r_  generation:  0.5410201549530029
local_output_nid generation:  0.032166242599487305
local_in_edges_tensor generation:  0.033911943435668945
mini_batch_src_global generation:  0.06134772300720215
r_  generation:  0.5460426807403564
local_output_nid generation:  0.03235197067260742
local_in_edges_tensor generation:  0.034337520599365234
mini_batch_src_global generation:  0.062408447265625
r_  generation:  0.5450663566589355
local_output_nid generation:  0.03246426582336426
local_in_edges_tensor generation:  0.032402753829956055
mini_batch_src_global generation:  0.061356306076049805
r_  generation:  0.5453221797943115
local_output_nid generation:  0.032221078872680664
local_in_edges_tensor generation:  0.0339815616607666
mini_batch_src_global generation:  0.06346797943115234
r_  generation:  0.5426599979400635
local_output_nid generation:  0.03226137161254883
local_in_edges_tensor generation:  0.03247213363647461
mini_batch_src_global generation:  0.06179237365722656
r_  generation:  0.5422813892364502
local_output_nid generation:  0.03224587440490723
local_in_edges_tensor generation:  0.03660082817077637
mini_batch_src_global generation:  0.06510496139526367
r_  generation:  0.5462279319763184
----------------------check_connections_block total spend ----------------------------- 12.67427110671997
generate_one_block  0.6733684539794922
generate_one_block  0.6840636730194092
generate_one_block  0.6821544170379639
generate_one_block  0.6860830783843994
generate_one_block  0.6897215843200684
generate_one_block  0.6797070503234863
generate_one_block  0.6744420528411865
generate_one_block  0.6893422603607178
generate_one_block  0.7373731136322021
generate_one_block  0.6848978996276855
generate_one_block  0.6781909465789795
generate_one_block  0.6891489028930664
generate_one_block  0.6889843940734863
generate_one_block  0.6873469352722168
generate_one_block  0.6861419677734375
generate_one_block  0.6857712268829346
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.12870264053344727  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

connection checking time:  18.949998140335083
block generation total time  16.618019104003906
average batch blocks generation time:  1.0386261940002441
block dataloader generation time/epoch 37.84017960230509
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09965229034423828  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7653765678405762  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.099700927734375  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.76904296875  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09967327117919922  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7689828872680664  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09994077682495117  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7812299728393555  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09977531433105469  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7723150253295898  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09981775283813477  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7769718170166016  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09960508346557617  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7687931060791016  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09998941421508789  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7772607803344727  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09947633743286133  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7653203010559082  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09981250762939453  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7760233879089355  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10064315795898438  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7689657211303711  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09999227523803711  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7812032699584961  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10103607177734375  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7822761535644531  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09961271286010742  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7693929672241211  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10085296630859375  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7809219360351562  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09966754913330078  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7723336219787598  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07130759954452515 |0.015947043895721436 |0.0035628080368041992 |9.205937385559082e-05 |0.003741025924682617 |0.0013043880462646484 |
----------------------------------------------------------pseudo_mini_loss sum 1.2689188718795776
Total (block generation + training)time/epoch 39.33025089899699
Training time/epoch 1.5802009105682373
Training time without block to device /epoch 1.3250482082366943
Training time without total dataloading part /epoch 0.11963868141174316
load block tensor time/epoch 1.1409215927124023
block to device time/epoch 0.25515270233154297
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 24 |
Number of nodes for computation during this epoch:  5332106
Number of first layer input nodes during this epoch:  2522173
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.1271815299987793  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02036738395690918
range selection method range initialization spend 0.012305259704589844
time for parepare:  0.01869344711303711
local_output_nid generation:  0.0014338493347167969
local_in_edges_tensor generation:  0.006582021713256836
mini_batch_src_global generation:  0.0022046566009521484
r_  generation:  0.021404743194580078
local_output_nid generation:  0.0016965866088867188
local_in_edges_tensor generation:  0.0009937286376953125
mini_batch_src_global generation:  0.002379894256591797
r_  generation:  0.022478103637695312
local_output_nid generation:  0.0015430450439453125
local_in_edges_tensor generation:  0.0009562969207763672
mini_batch_src_global generation:  0.0017261505126953125
r_  generation:  0.02185678482055664
local_output_nid generation:  0.0016205310821533203
local_in_edges_tensor generation:  0.0009593963623046875
mini_batch_src_global generation:  0.0017473697662353516
r_  generation:  0.021389245986938477
local_output_nid generation:  0.0015697479248046875
local_in_edges_tensor generation:  0.0009410381317138672
mini_batch_src_global generation:  0.0017580986022949219
r_  generation:  0.021349191665649414
local_output_nid generation:  0.0015726089477539062
local_in_edges_tensor generation:  0.0009374618530273438
mini_batch_src_global generation:  0.0017330646514892578
r_  generation:  0.02168869972229004
local_output_nid generation:  0.001575469970703125
local_in_edges_tensor generation:  0.0009744167327880859
mini_batch_src_global generation:  0.001748800277709961
r_  generation:  0.021733522415161133
local_output_nid generation:  0.0015645027160644531
local_in_edges_tensor generation:  0.0009396076202392578
mini_batch_src_global generation:  0.0017786026000976562
r_  generation:  0.021968841552734375
local_output_nid generation:  0.0015721321105957031
local_in_edges_tensor generation:  0.000946044921875
mini_batch_src_global generation:  0.0017664432525634766
r_  generation:  0.02211761474609375
local_output_nid generation:  0.0016019344329833984
local_in_edges_tensor generation:  0.0009212493896484375
mini_batch_src_global generation:  0.0017719268798828125
r_  generation:  0.022297143936157227
local_output_nid generation:  0.0015931129455566406
local_in_edges_tensor generation:  0.0009305477142333984
mini_batch_src_global generation:  0.0017833709716796875
r_  generation:  0.02247333526611328
local_output_nid generation:  0.0015654563903808594
local_in_edges_tensor generation:  0.0009241104125976562
mini_batch_src_global generation:  0.0017209053039550781
r_  generation:  0.022012948989868164
local_output_nid generation:  0.0015463829040527344
local_in_edges_tensor generation:  0.0009572505950927734
mini_batch_src_global generation:  0.0017600059509277344
r_  generation:  0.021641254425048828
local_output_nid generation:  0.00157928466796875
local_in_edges_tensor generation:  0.0009737014770507812
mini_batch_src_global generation:  0.0017268657684326172
r_  generation:  0.0217435359954834
local_output_nid generation:  0.0015397071838378906
local_in_edges_tensor generation:  0.0009100437164306641
mini_batch_src_global generation:  0.0017611980438232422
r_  generation:  0.02243971824645996
local_output_nid generation:  0.0015566349029541016
local_in_edges_tensor generation:  0.0009431838989257812
mini_batch_src_global generation:  0.0017654895782470703
r_  generation:  0.02220749855041504
----------------------check_connections_block total spend ----------------------------- 0.5232605934143066
generate_one_block  0.030616283416748047
generate_one_block  0.032143592834472656
generate_one_block  0.03155016899108887
generate_one_block  0.030863285064697266
generate_one_block  0.03073740005493164
generate_one_block  0.03269624710083008
generate_one_block  0.030853748321533203
generate_one_block  0.031182289123535156
generate_one_block  0.031436920166015625
generate_one_block  0.03130078315734863
generate_one_block  0.03162407875061035
generate_one_block  0.03143501281738281
generate_one_block  0.030851125717163086
generate_one_block  0.030774831771850586
generate_one_block  0.03170490264892578
generate_one_block  0.03157353401184082
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06364798545837402
gen group dst list time:  0.01910114288330078
time for parepare:  0.019353628158569336
local_output_nid generation:  0.007375955581665039
local_in_edges_tensor generation:  0.016764402389526367
mini_batch_src_global generation:  0.028052806854248047
r_  generation:  0.2515132427215576
local_output_nid generation:  0.011533737182617188
local_in_edges_tensor generation:  0.017479896545410156
mini_batch_src_global generation:  0.03410744667053223
r_  generation:  0.2650187015533447
local_output_nid generation:  0.011747598648071289
local_in_edges_tensor generation:  0.013348817825317383
mini_batch_src_global generation:  0.03294014930725098
r_  generation:  0.2680540084838867
local_output_nid generation:  0.012458562850952148
local_in_edges_tensor generation:  0.014669179916381836
mini_batch_src_global generation:  0.03274893760681152
r_  generation:  0.2654235363006592
local_output_nid generation:  0.012542247772216797
local_in_edges_tensor generation:  0.016521930694580078
mini_batch_src_global generation:  0.033679962158203125
r_  generation:  0.2633500099182129
local_output_nid generation:  0.012633562088012695
local_in_edges_tensor generation:  0.013242483139038086
mini_batch_src_global generation:  0.03314995765686035
r_  generation:  0.26314401626586914
local_output_nid generation:  0.012901544570922852
local_in_edges_tensor generation:  0.013118505477905273
mini_batch_src_global generation:  0.03371834754943848
r_  generation:  0.2666590213775635
local_output_nid generation:  0.012990951538085938
local_in_edges_tensor generation:  0.013344287872314453
mini_batch_src_global generation:  0.03400230407714844
r_  generation:  0.2734494209289551
local_output_nid generation:  0.013429880142211914
local_in_edges_tensor generation:  0.013307809829711914
mini_batch_src_global generation:  0.03511500358581543
r_  generation:  0.27874016761779785
local_output_nid generation:  0.013328313827514648
local_in_edges_tensor generation:  0.013592243194580078
mini_batch_src_global generation:  0.03457355499267578
r_  generation:  0.2743048667907715
local_output_nid generation:  0.012683868408203125
local_in_edges_tensor generation:  0.01494908332824707
mini_batch_src_global generation:  0.03500699996948242
r_  generation:  0.27501344680786133
local_output_nid generation:  0.01325225830078125
local_in_edges_tensor generation:  0.013916492462158203
mini_batch_src_global generation:  0.034470319747924805
r_  generation:  0.2754340171813965
local_output_nid generation:  0.012816905975341797
local_in_edges_tensor generation:  0.013087987899780273
mini_batch_src_global generation:  0.0342402458190918
r_  generation:  0.26963067054748535
local_output_nid generation:  0.013203620910644531
local_in_edges_tensor generation:  0.013103008270263672
mini_batch_src_global generation:  0.03395843505859375
r_  generation:  0.2685716152191162
local_output_nid generation:  0.013500452041625977
local_in_edges_tensor generation:  0.015929698944091797
mini_batch_src_global generation:  0.03700828552246094
r_  generation:  0.27753615379333496
local_output_nid generation:  0.012940645217895508
local_in_edges_tensor generation:  0.01377248764038086
mini_batch_src_global generation:  0.034845829010009766
r_  generation:  0.2731466293334961
----------------------check_connections_block total spend ----------------------------- 6.219805002212524
generate_one_block  0.35539889335632324
generate_one_block  0.35895514488220215
generate_one_block  0.3566904067993164
generate_one_block  0.34763312339782715
generate_one_block  0.34369897842407227
generate_one_block  0.3390781879425049
generate_one_block  0.36598968505859375
generate_one_block  0.35178208351135254
generate_one_block  0.35811424255371094
generate_one_block  0.35190725326538086
generate_one_block  0.3551361560821533
generate_one_block  0.349168062210083
generate_one_block  0.3420383930206299
generate_one_block  0.34298181533813477
generate_one_block  0.35903358459472656
generate_one_block  0.34970593452453613
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05448579788208008
gen group dst list time:  0.0660696029663086
time for parepare:  0.0173799991607666
local_output_nid generation:  0.0254976749420166
local_in_edges_tensor generation:  0.03987693786621094
mini_batch_src_global generation:  0.049299001693725586
r_  generation:  0.5233154296875
local_output_nid generation:  0.033693790435791016
local_in_edges_tensor generation:  0.0334014892578125
mini_batch_src_global generation:  0.0652470588684082
r_  generation:  0.5230555534362793
local_output_nid generation:  0.03126692771911621
local_in_edges_tensor generation:  0.03221893310546875
mini_batch_src_global generation:  0.05922555923461914
r_  generation:  0.5350964069366455
local_output_nid generation:  0.031652212142944336
local_in_edges_tensor generation:  0.03372359275817871
mini_batch_src_global generation:  0.058827877044677734
r_  generation:  0.5361590385437012
local_output_nid generation:  0.03161740303039551
local_in_edges_tensor generation:  0.07643675804138184
mini_batch_src_global generation:  0.059602975845336914
r_  generation:  0.5390884876251221
local_output_nid generation:  0.031743764877319336
local_in_edges_tensor generation:  0.03302192687988281
mini_batch_src_global generation:  0.06363701820373535
r_  generation:  0.537689208984375
local_output_nid generation:  0.03234696388244629
local_in_edges_tensor generation:  0.034288883209228516
mini_batch_src_global generation:  0.06176424026489258
r_  generation:  0.5425081253051758
local_output_nid generation:  0.032010555267333984
local_in_edges_tensor generation:  0.03181815147399902
mini_batch_src_global generation:  0.06114840507507324
r_  generation:  0.5377862453460693
local_output_nid generation:  0.032300472259521484
local_in_edges_tensor generation:  0.034377098083496094
mini_batch_src_global generation:  0.06019926071166992
r_  generation:  0.5468919277191162
local_output_nid generation:  0.03223705291748047
local_in_edges_tensor generation:  0.03403925895690918
mini_batch_src_global generation:  0.06087636947631836
r_  generation:  0.5401082038879395
local_output_nid generation:  0.03238844871520996
local_in_edges_tensor generation:  0.03301262855529785
mini_batch_src_global generation:  0.06035971641540527
r_  generation:  0.5440282821655273
local_output_nid generation:  0.03206634521484375
local_in_edges_tensor generation:  0.032654762268066406
mini_batch_src_global generation:  0.06171703338623047
r_  generation:  0.5584397315979004
local_output_nid generation:  0.032076120376586914
local_in_edges_tensor generation:  0.03192281723022461
mini_batch_src_global generation:  0.06176567077636719
r_  generation:  0.5475125312805176
local_output_nid generation:  0.03213644027709961
local_in_edges_tensor generation:  0.03189730644226074
mini_batch_src_global generation:  0.06511187553405762
r_  generation:  0.547208309173584
local_output_nid generation:  0.03226113319396973
local_in_edges_tensor generation:  0.03216052055358887
mini_batch_src_global generation:  0.06212306022644043
r_  generation:  0.5413315296173096
local_output_nid generation:  0.03222775459289551
local_in_edges_tensor generation:  0.03214550018310547
mini_batch_src_global generation:  0.06304430961608887
r_  generation:  0.5434305667877197
----------------------check_connections_block total spend ----------------------------- 12.620246171951294
generate_one_block  0.6759169101715088
generate_one_block  0.6801910400390625
generate_one_block  0.6750843524932861
generate_one_block  0.6769757270812988
generate_one_block  0.6733367443084717
generate_one_block  0.6755337715148926
generate_one_block  0.6835150718688965
generate_one_block  0.6749780178070068
generate_one_block  0.7156500816345215
generate_one_block  0.6742062568664551
generate_one_block  0.6811916828155518
generate_one_block  0.6808130741119385
generate_one_block  0.6790940761566162
generate_one_block  0.6789140701293945
generate_one_block  0.6819350719451904
generate_one_block  0.6795990467071533
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.1271815299987793  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

connection checking time:  18.84005117416382
block generation total time  16.514246940612793
average batch blocks generation time:  1.0321404337882996
block dataloader generation time/epoch 37.82406474649906
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0998077392578125  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7714424133300781  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10003089904785156  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.781095027923584  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0999288558959961  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7809362411499023  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09968423843383789  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7689666748046875  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09961652755737305  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7664451599121094  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09959793090820312  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7696881294250488  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.1006479263305664  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7737569808959961  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09975767135620117  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7699899673461914  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10088920593261719  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7818088531494141  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09978866577148438  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7739667892456055  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0998072624206543  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.776252269744873  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09987592697143555  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7706699371337891  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09950733184814453  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7633543014526367  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09950733184814453  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7669296264648438  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09985876083374023  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7754120826721191  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09965753555297852  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7702546119689941  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0648619681596756 |0.013897329568862915 |0.003413766622543335 |9.049475193023682e-05 |0.0033436715602874756 |0.0016658306121826172 |
----------------------------------------------------------pseudo_mini_loss sum 1.2594712972640991
Total (block generation + training)time/epoch 39.310705825686455
Training time/epoch 1.4349701404571533
Training time without block to device /epoch 1.2126128673553467
Training time without total dataloading part /epoch 0.11123275756835938
load block tensor time/epoch 1.0377914905548096
block to device time/epoch 0.22235727310180664
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 25 |
Number of nodes for computation during this epoch:  5327872
Number of first layer input nodes during this epoch:  2521650
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.12826251983642578  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027340173721313477
range selection method range initialization spend 0.011981487274169922
time for parepare:  0.016794204711914062
local_output_nid generation:  0.0014452934265136719
local_in_edges_tensor generation:  0.004160404205322266
mini_batch_src_global generation:  0.0018625259399414062
r_  generation:  0.021199703216552734
local_output_nid generation:  0.001556396484375
local_in_edges_tensor generation:  0.0009770393371582031
mini_batch_src_global generation:  0.002111196517944336
r_  generation:  0.022534608840942383
local_output_nid generation:  0.0015420913696289062
local_in_edges_tensor generation:  0.0009546279907226562
mini_batch_src_global generation:  0.0016942024230957031
r_  generation:  0.0215909481048584
local_output_nid generation:  0.0015897750854492188
local_in_edges_tensor generation:  0.0009207725524902344
mini_batch_src_global generation:  0.0018048286437988281
r_  generation:  0.021942615509033203
local_output_nid generation:  0.0015850067138671875
local_in_edges_tensor generation:  0.0009446144104003906
mini_batch_src_global generation:  0.0017809867858886719
r_  generation:  0.02171921730041504
local_output_nid generation:  0.0015916824340820312
local_in_edges_tensor generation:  0.0009703636169433594
mini_batch_src_global generation:  0.0018453598022460938
r_  generation:  0.02181696891784668
local_output_nid generation:  0.001577615737915039
local_in_edges_tensor generation:  0.0009341239929199219
mini_batch_src_global generation:  0.0018532276153564453
r_  generation:  0.022266626358032227
local_output_nid generation:  0.0015745162963867188
local_in_edges_tensor generation:  0.00093841552734375
mini_batch_src_global generation:  0.0018157958984375
r_  generation:  0.02203536033630371
local_output_nid generation:  0.0015802383422851562
local_in_edges_tensor generation:  0.0009393692016601562
mini_batch_src_global generation:  0.0017993450164794922
r_  generation:  0.021455764770507812
local_output_nid generation:  0.0015780925750732422
local_in_edges_tensor generation:  0.0009176731109619141
mini_batch_src_global generation:  0.0018351078033447266
r_  generation:  0.022518634796142578
local_output_nid generation:  0.0015764236450195312
local_in_edges_tensor generation:  0.00092315673828125
mini_batch_src_global generation:  0.0018665790557861328
r_  generation:  0.022043704986572266
local_output_nid generation:  0.0015604496002197266
local_in_edges_tensor generation:  0.0009624958038330078
mini_batch_src_global generation:  0.0017843246459960938
r_  generation:  0.022612333297729492
local_output_nid generation:  0.001558542251586914
local_in_edges_tensor generation:  0.0009527206420898438
mini_batch_src_global generation:  0.0018627643585205078
r_  generation:  0.022284507751464844
local_output_nid generation:  0.0015575885772705078
local_in_edges_tensor generation:  0.0009779930114746094
mini_batch_src_global generation:  0.0017774105072021484
r_  generation:  0.021980762481689453
local_output_nid generation:  0.0015535354614257812
local_in_edges_tensor generation:  0.0009133815765380859
mini_batch_src_global generation:  0.0018470287322998047
r_  generation:  0.022411346435546875
local_output_nid generation:  0.0015544891357421875
local_in_edges_tensor generation:  0.0009484291076660156
mini_batch_src_global generation:  0.0017919540405273438
r_  generation:  0.0216214656829834
----------------------check_connections_block total spend ----------------------------- 0.5197255611419678
generate_one_block  0.030839204788208008
generate_one_block  0.031018733978271484
generate_one_block  0.031094074249267578
generate_one_block  0.0313420295715332
generate_one_block  0.031229019165039062
generate_one_block  0.03307294845581055
generate_one_block  0.03163290023803711
generate_one_block  0.0309295654296875
generate_one_block  0.030732154846191406
generate_one_block  0.03186845779418945
generate_one_block  0.03136610984802246
generate_one_block  0.03172469139099121
generate_one_block  0.030919790267944336
generate_one_block  0.030689477920532227
generate_one_block  0.0315093994140625
generate_one_block  0.03087472915649414
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.08255171775817871
gen group dst list time:  0.0202178955078125
time for parepare:  0.019475936889648438
local_output_nid generation:  0.007601261138916016
local_in_edges_tensor generation:  0.0239255428314209
mini_batch_src_global generation:  0.02806711196899414
r_  generation:  0.25287866592407227
local_output_nid generation:  0.011093378067016602
local_in_edges_tensor generation:  0.017202377319335938
mini_batch_src_global generation:  0.034130096435546875
r_  generation:  0.25492262840270996
local_output_nid generation:  0.011476755142211914
local_in_edges_tensor generation:  0.019318819046020508
mini_batch_src_global generation:  0.033159494400024414
r_  generation:  0.2620277404785156
local_output_nid generation:  0.012308597564697266
local_in_edges_tensor generation:  0.014789342880249023
mini_batch_src_global generation:  0.04238414764404297
r_  generation:  0.26609349250793457
local_output_nid generation:  0.014128923416137695
local_in_edges_tensor generation:  0.013576507568359375
mini_batch_src_global generation:  0.03662753105163574
r_  generation:  0.26710033416748047
local_output_nid generation:  0.013175725936889648
local_in_edges_tensor generation:  0.013943195343017578
mini_batch_src_global generation:  0.0336453914642334
r_  generation:  0.26598215103149414
local_output_nid generation:  0.013265371322631836
local_in_edges_tensor generation:  0.013175725936889648
mini_batch_src_global generation:  0.035474538803100586
r_  generation:  0.26866936683654785
local_output_nid generation:  0.013253450393676758
local_in_edges_tensor generation:  0.013531923294067383
mini_batch_src_global generation:  0.034013986587524414
r_  generation:  0.26872801780700684
local_output_nid generation:  0.013109445571899414
local_in_edges_tensor generation:  0.01585221290588379
mini_batch_src_global generation:  0.03411698341369629
r_  generation:  0.26566481590270996
local_output_nid generation:  0.013518810272216797
local_in_edges_tensor generation:  0.015633583068847656
mini_batch_src_global generation:  0.03479933738708496
r_  generation:  0.2769627571105957
local_output_nid generation:  0.012700319290161133
local_in_edges_tensor generation:  0.0135498046875
mini_batch_src_global generation:  0.035965681076049805
r_  generation:  0.2746317386627197
local_output_nid generation:  0.013704776763916016
local_in_edges_tensor generation:  0.014880180358886719
mini_batch_src_global generation:  0.03687691688537598
r_  generation:  0.27788543701171875
local_output_nid generation:  0.013390064239501953
local_in_edges_tensor generation:  0.013337135314941406
mini_batch_src_global generation:  0.03524041175842285
r_  generation:  0.27097249031066895
local_output_nid generation:  0.013307571411132812
local_in_edges_tensor generation:  0.013854503631591797
mini_batch_src_global generation:  0.03483247756958008
r_  generation:  0.2723531723022461
local_output_nid generation:  0.013720512390136719
local_in_edges_tensor generation:  0.016107797622680664
mini_batch_src_global generation:  0.036144256591796875
r_  generation:  0.2756345272064209
local_output_nid generation:  0.012705802917480469
local_in_edges_tensor generation:  0.01547551155090332
mini_batch_src_global generation:  0.034911394119262695
r_  generation:  0.2643110752105713
----------------------check_connections_block total spend ----------------------------- 6.236470937728882
generate_one_block  0.3614380359649658
generate_one_block  0.3415486812591553
generate_one_block  0.34485936164855957
generate_one_block  0.34929609298706055
generate_one_block  0.3457648754119873
generate_one_block  0.3439462184906006
generate_one_block  0.37230491638183594
generate_one_block  0.348341703414917
generate_one_block  0.33827996253967285
generate_one_block  0.36008119583129883
generate_one_block  0.3565335273742676
generate_one_block  0.3570125102996826
generate_one_block  0.3486189842224121
generate_one_block  0.34958577156066895
generate_one_block  0.3503448963165283
generate_one_block  0.336306095123291
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.046004533767700195
gen group dst list time:  0.06753230094909668
time for parepare:  0.017516136169433594
local_output_nid generation:  0.025468111038208008
local_in_edges_tensor generation:  0.05209803581237793
mini_batch_src_global generation:  0.05012392997741699
r_  generation:  0.5190157890319824
local_output_nid generation:  0.03016376495361328
local_in_edges_tensor generation:  0.04117393493652344
mini_batch_src_global generation:  0.06231236457824707
r_  generation:  0.5205738544464111
local_output_nid generation:  0.0311129093170166
local_in_edges_tensor generation:  0.0321652889251709
mini_batch_src_global generation:  0.05919814109802246
r_  generation:  0.5336310863494873
local_output_nid generation:  0.031239748001098633
local_in_edges_tensor generation:  0.03190207481384277
mini_batch_src_global generation:  0.05977630615234375
r_  generation:  0.5301940441131592
local_output_nid generation:  0.031319379806518555
local_in_edges_tensor generation:  0.07870674133300781
mini_batch_src_global generation:  0.060501813888549805
r_  generation:  0.5437030792236328
local_output_nid generation:  0.031445980072021484
local_in_edges_tensor generation:  0.03430366516113281
mini_batch_src_global generation:  0.0627596378326416
r_  generation:  0.5408298969268799
local_output_nid generation:  0.03187084197998047
local_in_edges_tensor generation:  0.034432172775268555
mini_batch_src_global generation:  0.06134366989135742
r_  generation:  0.5400967597961426
local_output_nid generation:  0.031786441802978516
local_in_edges_tensor generation:  0.03244352340698242
mini_batch_src_global generation:  0.062319278717041016
r_  generation:  0.5353398323059082
local_output_nid generation:  0.0320127010345459
local_in_edges_tensor generation:  0.034531354904174805
mini_batch_src_global generation:  0.06603312492370605
r_  generation:  0.5420854091644287
local_output_nid generation:  0.03189849853515625
local_in_edges_tensor generation:  0.03299260139465332
mini_batch_src_global generation:  0.062253475189208984
r_  generation:  0.53853440284729
local_output_nid generation:  0.032094478607177734
local_in_edges_tensor generation:  0.03683066368103027
mini_batch_src_global generation:  0.061022281646728516
r_  generation:  0.5427343845367432
local_output_nid generation:  0.03215479850769043
local_in_edges_tensor generation:  0.034705162048339844
mini_batch_src_global generation:  0.06386256217956543
r_  generation:  0.5402121543884277
local_output_nid generation:  0.03205728530883789
local_in_edges_tensor generation:  0.03225851058959961
mini_batch_src_global generation:  0.06089949607849121
r_  generation:  0.5493419170379639
local_output_nid generation:  0.03192591667175293
local_in_edges_tensor generation:  0.032327890396118164
mini_batch_src_global generation:  0.062094926834106445
r_  generation:  0.5479562282562256
local_output_nid generation:  0.032224416732788086
local_in_edges_tensor generation:  0.034604549407958984
mini_batch_src_global generation:  0.06402254104614258
r_  generation:  0.5454957485198975
local_output_nid generation:  0.031887054443359375
local_in_edges_tensor generation:  0.03273916244506836
mini_batch_src_global generation:  0.06290221214294434
r_  generation:  0.5393228530883789
----------------------check_connections_block total spend ----------------------------- 12.623501539230347
generate_one_block  0.6711971759796143
generate_one_block  0.689133882522583
generate_one_block  0.6780471801757812
generate_one_block  0.679340124130249
generate_one_block  0.6781227588653564
generate_one_block  0.6762230396270752
generate_one_block  0.6726350784301758
generate_one_block  0.6751141548156738
generate_one_block  0.7406394481658936
generate_one_block  0.6770076751708984
generate_one_block  0.6829342842102051
generate_one_block  0.6800820827484131
generate_one_block  0.6745882034301758
generate_one_block  0.6772992610931396
generate_one_block  0.6839785575866699
generate_one_block  0.6691956520080566
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.12826251983642578  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

connection checking time:  18.85997247695923
block generation total time  16.509801387786865
average batch blocks generation time:  1.031862586736679
block dataloader generation time/epoch 37.81009937735165
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0998988151550293  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.780487060546875  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09958362579345703  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7664036750793457  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09980154037475586  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7766432762145996  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09975910186767578  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7729291915893555  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09978771209716797  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7736501693725586  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09969568252563477  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7691612243652344  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09969139099121094  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7727899551391602  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0996403694152832  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.769533634185791  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09963178634643555  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7689681053161621  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10005664825439453  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7812252044677734  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09988594055175781  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7751779556274414  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10012292861938477  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7818164825439453  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09975004196166992  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7754902839660645  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09973812103271484  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7702207565307617  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0998539924621582  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7800493240356445  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09945392608642578  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7621755599975586  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06759649515151978 |0.014700233936309814 |0.0035746991634368896 |9.438395500183105e-05 |0.0034953057765960693 |0.0017364025115966797 |
----------------------------------------------------------pseudo_mini_loss sum 1.2434039115905762
Total (block generation + training)time/epoch 39.29733029533835
Training time/epoch 1.496396541595459
Training time without block to device /epoch 1.261192798614502
Training time without total dataloading part /epoch 0.11636662483215332
load block tensor time/epoch 1.0815439224243164
block to device time/epoch 0.23520374298095703
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 26 |
Number of nodes for computation during this epoch:  5331650
Number of first layer input nodes during this epoch:  2521477
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.1265711784362793  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024405717849731445
range selection method range initialization spend 0.01212310791015625
time for parepare:  0.018321990966796875
local_output_nid generation:  0.0014374256134033203
local_in_edges_tensor generation:  0.0031964778900146484
mini_batch_src_global generation:  0.0017292499542236328
r_  generation:  0.020768404006958008
local_output_nid generation:  0.0015957355499267578
local_in_edges_tensor generation:  0.0009789466857910156
mini_batch_src_global generation:  0.0020294189453125
r_  generation:  0.021943092346191406
local_output_nid generation:  0.001583099365234375
local_in_edges_tensor generation:  0.0009698867797851562
mini_batch_src_global generation:  0.001705169677734375
r_  generation:  0.021628141403198242
local_output_nid generation:  0.0015950202941894531
local_in_edges_tensor generation:  0.0010368824005126953
mini_batch_src_global generation:  0.0017571449279785156
r_  generation:  0.03703022003173828
local_output_nid generation:  0.002115488052368164
local_in_edges_tensor generation:  0.0011909008026123047
mini_batch_src_global generation:  0.0020585060119628906
r_  generation:  0.0227813720703125
local_output_nid generation:  0.002030611038208008
local_in_edges_tensor generation:  0.0012161731719970703
mini_batch_src_global generation:  0.001960277557373047
r_  generation:  0.023040771484375
local_output_nid generation:  0.0019643306732177734
local_in_edges_tensor generation:  0.0010788440704345703
mini_batch_src_global generation:  0.0019109249114990234
r_  generation:  0.02294158935546875
local_output_nid generation:  0.0019350051879882812
local_in_edges_tensor generation:  0.0010864734649658203
mini_batch_src_global generation:  0.0018694400787353516
r_  generation:  0.02259206771850586
local_output_nid generation:  0.0019559860229492188
local_in_edges_tensor generation:  0.0010428428649902344
mini_batch_src_global generation:  0.0019011497497558594
r_  generation:  0.02233409881591797
local_output_nid generation:  0.0020074844360351562
local_in_edges_tensor generation:  0.001173257827758789
mini_batch_src_global generation:  0.00959634780883789
r_  generation:  0.022930145263671875
local_output_nid generation:  0.0016815662384033203
local_in_edges_tensor generation:  0.0009884834289550781
mini_batch_src_global generation:  0.0017533302307128906
r_  generation:  0.022382020950317383
local_output_nid generation:  0.0016148090362548828
local_in_edges_tensor generation:  0.0009438991546630859
mini_batch_src_global generation:  0.0017778873443603516
r_  generation:  0.022899866104125977
local_output_nid generation:  0.0015957355499267578
local_in_edges_tensor generation:  0.0010290145874023438
mini_batch_src_global generation:  0.0017971992492675781
r_  generation:  0.022961139678955078
local_output_nid generation:  0.0015707015991210938
local_in_edges_tensor generation:  0.0010123252868652344
mini_batch_src_global generation:  0.00179290771484375
r_  generation:  0.022470712661743164
local_output_nid generation:  0.0015749931335449219
local_in_edges_tensor generation:  0.0010366439819335938
mini_batch_src_global generation:  0.0017991065979003906
r_  generation:  0.021932601928710938
local_output_nid generation:  0.0015587806701660156
local_in_edges_tensor generation:  0.0010006427764892578
mini_batch_src_global generation:  0.0017459392547607422
r_  generation:  0.02179884910583496
----------------------check_connections_block total spend ----------------------------- 0.5567281246185303
generate_one_block  0.030370235443115234
generate_one_block  0.03117513656616211
generate_one_block  0.03131985664367676
generate_one_block  0.03181052207946777
generate_one_block  0.031232357025146484
generate_one_block  0.033913612365722656
generate_one_block  0.031844377517700195
generate_one_block  0.0317080020904541
generate_one_block  0.03132319450378418
generate_one_block  0.03193855285644531
generate_one_block  0.03106975555419922
generate_one_block  0.031906843185424805
generate_one_block  0.03353619575500488
generate_one_block  0.03181290626525879
generate_one_block  0.030988693237304688
generate_one_block  0.03190946578979492
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03870654106140137
gen group dst list time:  0.02206254005432129
time for parepare:  0.019629716873168945
local_output_nid generation:  0.007445096969604492
local_in_edges_tensor generation:  0.02913832664489746
mini_batch_src_global generation:  0.026694297790527344
r_  generation:  0.24645400047302246
local_output_nid generation:  0.01137232780456543
local_in_edges_tensor generation:  0.014756441116333008
mini_batch_src_global generation:  0.03193020820617676
r_  generation:  0.26014018058776855
local_output_nid generation:  0.01179814338684082
local_in_edges_tensor generation:  0.016643762588500977
mini_batch_src_global generation:  0.03320431709289551
r_  generation:  0.2633998394012451
local_output_nid generation:  0.012782812118530273
local_in_edges_tensor generation:  0.014217615127563477
mini_batch_src_global generation:  0.0337064266204834
r_  generation:  0.269223690032959
local_output_nid generation:  0.012742280960083008
local_in_edges_tensor generation:  0.01327657699584961
mini_batch_src_global generation:  0.033834218978881836
r_  generation:  0.2671811580657959
local_output_nid generation:  0.01310110092163086
local_in_edges_tensor generation:  0.01338338851928711
mini_batch_src_global generation:  0.03557252883911133
r_  generation:  0.2738149166107178
local_output_nid generation:  0.015023946762084961
local_in_edges_tensor generation:  0.01460576057434082
mini_batch_src_global generation:  0.034647464752197266
r_  generation:  0.2786281108856201
local_output_nid generation:  0.013247013092041016
local_in_edges_tensor generation:  0.015332221984863281
mini_batch_src_global generation:  0.03602480888366699
r_  generation:  0.2776937484741211
local_output_nid generation:  0.013073205947875977
local_in_edges_tensor generation:  0.013651609420776367
mini_batch_src_global generation:  0.03617978096008301
r_  generation:  0.27385687828063965
local_output_nid generation:  0.013042211532592773
local_in_edges_tensor generation:  0.013493776321411133
mini_batch_src_global generation:  0.0358431339263916
r_  generation:  0.2762162685394287
local_output_nid generation:  0.013057470321655273
local_in_edges_tensor generation:  0.013666629791259766
mini_batch_src_global generation:  0.034450531005859375
r_  generation:  0.272350549697876
local_output_nid generation:  0.013312578201293945
local_in_edges_tensor generation:  0.01348567008972168
mini_batch_src_global generation:  0.03616499900817871
r_  generation:  0.2784402370452881
local_output_nid generation:  0.013680696487426758
local_in_edges_tensor generation:  0.017691850662231445
mini_batch_src_global generation:  0.0371243953704834
r_  generation:  0.2840542793273926
local_output_nid generation:  0.01432180404663086
local_in_edges_tensor generation:  0.017736434936523438
mini_batch_src_global generation:  0.0352022647857666
r_  generation:  0.2810709476470947
local_output_nid generation:  0.013414859771728516
local_in_edges_tensor generation:  0.019264698028564453
mini_batch_src_global generation:  0.03593564033508301
r_  generation:  0.27370357513427734
local_output_nid generation:  0.01276850700378418
local_in_edges_tensor generation:  0.013847112655639648
mini_batch_src_global generation:  0.03423619270324707
r_  generation:  0.27417540550231934
----------------------check_connections_block total spend ----------------------------- 6.3177196979522705
generate_one_block  0.360698938369751
generate_one_block  0.35286974906921387
generate_one_block  0.3642439842224121
generate_one_block  0.35823798179626465
generate_one_block  0.3520638942718506
generate_one_block  0.3557736873626709
generate_one_block  0.3865523338317871
generate_one_block  0.35574841499328613
generate_one_block  0.3494837284088135
generate_one_block  0.35225963592529297
generate_one_block  0.35103273391723633
generate_one_block  0.35610532760620117
generate_one_block  0.3627948760986328
generate_one_block  0.3572378158569336
generate_one_block  0.3438119888305664
generate_one_block  0.3513007164001465
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.040435791015625
gen group dst list time:  0.06928372383117676
time for parepare:  0.01923680305480957
local_output_nid generation:  0.026990652084350586
local_in_edges_tensor generation:  0.05416083335876465
mini_batch_src_global generation:  0.0502777099609375
r_  generation:  0.5260274410247803
local_output_nid generation:  0.031861305236816406
local_in_edges_tensor generation:  0.0415196418762207
mini_batch_src_global generation:  0.0665132999420166
r_  generation:  0.5302653312683105
local_output_nid generation:  0.03215980529785156
local_in_edges_tensor generation:  0.03303718566894531
mini_batch_src_global generation:  0.060712575912475586
r_  generation:  0.541189432144165
local_output_nid generation:  0.032288312911987305
local_in_edges_tensor generation:  0.0370328426361084
mini_batch_src_global generation:  0.06042885780334473
r_  generation:  0.5391948223114014
local_output_nid generation:  0.03246426582336426
local_in_edges_tensor generation:  0.08045768737792969
mini_batch_src_global generation:  0.06063246726989746
r_  generation:  0.5426290035247803
local_output_nid generation:  0.032723188400268555
local_in_edges_tensor generation:  0.04102492332458496
mini_batch_src_global generation:  0.06415343284606934
r_  generation:  0.5631370544433594
local_output_nid generation:  0.035628557205200195
local_in_edges_tensor generation:  0.03333425521850586
mini_batch_src_global generation:  0.06620144844055176
r_  generation:  0.5465431213378906
local_output_nid generation:  0.03357529640197754
local_in_edges_tensor generation:  0.034308671951293945
mini_batch_src_global generation:  0.061792850494384766
r_  generation:  0.5411295890808105
local_output_nid generation:  0.03362250328063965
local_in_edges_tensor generation:  0.03181052207946777
mini_batch_src_global generation:  0.061953067779541016
r_  generation:  0.5495617389678955
local_output_nid generation:  0.03347468376159668
local_in_edges_tensor generation:  0.03449416160583496
mini_batch_src_global generation:  0.06446099281311035
r_  generation:  0.5408835411071777
local_output_nid generation:  0.033831119537353516
local_in_edges_tensor generation:  0.03238248825073242
mini_batch_src_global generation:  0.06111574172973633
r_  generation:  0.5625660419464111
local_output_nid generation:  0.03376173973083496
local_in_edges_tensor generation:  0.031269073486328125
mini_batch_src_global generation:  0.062279701232910156
r_  generation:  0.5450460910797119
local_output_nid generation:  0.033745527267456055
local_in_edges_tensor generation:  0.033718109130859375
mini_batch_src_global generation:  0.06355786323547363
r_  generation:  0.5451717376708984
local_output_nid generation:  0.03407764434814453
local_in_edges_tensor generation:  0.03630208969116211
mini_batch_src_global generation:  0.06263017654418945
r_  generation:  0.5437090396881104
local_output_nid generation:  0.03497648239135742
local_in_edges_tensor generation:  0.03678107261657715
mini_batch_src_global generation:  0.06300067901611328
r_  generation:  0.5440263748168945
local_output_nid generation:  0.034004926681518555
local_in_edges_tensor generation:  0.03159976005554199
mini_batch_src_global generation:  0.06222200393676758
r_  generation:  0.5408599376678467
----------------------check_connections_block total spend ----------------------------- 12.7819242477417
generate_one_block  0.6944773197174072
generate_one_block  0.6831421852111816
generate_one_block  0.6832802295684814
generate_one_block  0.6905405521392822
generate_one_block  0.6803531646728516
generate_one_block  0.6882083415985107
generate_one_block  0.6913895606994629
generate_one_block  0.6860136985778809
generate_one_block  0.7234234809875488
generate_one_block  0.6809046268463135
generate_one_block  0.6842546463012695
generate_one_block  0.6924974918365479
generate_one_block  0.6935367584228516
generate_one_block  0.6830034255981445
generate_one_block  0.680091142654419
generate_one_block  0.6807856559753418
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.1265711784362793  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

connection checking time:  19.09964394569397
block generation total time  16.726118087768555
average batch blocks generation time:  1.0453823804855347
block dataloader generation time/epoch 37.82484528753493
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09956550598144531  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7676963806152344  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09972381591796875  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7733216285705566  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0997767448425293  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7719058990478516  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09994840621948242  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7796759605407715  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09961652755737305  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7681546211242676  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09991121292114258  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7807049751281738  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09977102279663086  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7794561386108398  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09985065460205078  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7728395462036133  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09970426559448242  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7703065872192383  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09958219528198242  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7678484916687012  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.1006937026977539  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7693347930908203  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0997166633605957  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7732114791870117  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.1009836196899414  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7827048301696777  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0998849868774414  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7807712554931641  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09959793090820312  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7668933868408203  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09963703155517578  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7705202102661133  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06961806118488312 |0.015888214111328125 |0.003520652651786804 |9.05841588973999e-05 |0.0037170350551605225 |0.0014946460723876953 |
----------------------------------------------------------pseudo_mini_loss sum 1.2332841157913208
Total (block generation + training)time/epoch 39.315621270073784
Training time/epoch 1.5508549213409424
Training time without block to device /epoch 1.2966434955596924
Training time without total dataloading part /epoch 0.11874699592590332
load block tensor time/epoch 1.1138889789581299
block to device time/epoch 0.25421142578125
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 27 |
Number of nodes for computation during this epoch:  5330687
Number of first layer input nodes during this epoch:  2521129
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.1271042823791504  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023935556411743164
range selection method range initialization spend 0.01211237907409668
time for parepare:  0.01691913604736328
local_output_nid generation:  0.0014553070068359375
local_in_edges_tensor generation:  0.005902767181396484
mini_batch_src_global generation:  0.0018012523651123047
r_  generation:  0.0215604305267334
local_output_nid generation:  0.0015742778778076172
local_in_edges_tensor generation:  0.0010516643524169922
mini_batch_src_global generation:  0.0021092891693115234
r_  generation:  0.022437572479248047
local_output_nid generation:  0.001577138900756836
local_in_edges_tensor generation:  0.0009915828704833984
mini_batch_src_global generation:  0.0016820430755615234
r_  generation:  0.02109074592590332
local_output_nid generation:  0.0016236305236816406
local_in_edges_tensor generation:  0.0009522438049316406
mini_batch_src_global generation:  0.0016758441925048828
r_  generation:  0.02089524269104004
local_output_nid generation:  0.0016026496887207031
local_in_edges_tensor generation:  0.0009281635284423828
mini_batch_src_global generation:  0.0017943382263183594
r_  generation:  0.022207260131835938
local_output_nid generation:  0.0016026496887207031
local_in_edges_tensor generation:  0.0009522438049316406
mini_batch_src_global generation:  0.0017523765563964844
r_  generation:  0.021600961685180664
local_output_nid generation:  0.001566171646118164
local_in_edges_tensor generation:  0.0009465217590332031
mini_batch_src_global generation:  0.0017769336700439453
r_  generation:  0.022519826889038086
local_output_nid generation:  0.0015704631805419922
local_in_edges_tensor generation:  0.0009648799896240234
mini_batch_src_global generation:  0.001817464828491211
r_  generation:  0.022368431091308594
local_output_nid generation:  0.0015873908996582031
local_in_edges_tensor generation:  0.0009434223175048828
mini_batch_src_global generation:  0.0017731189727783203
r_  generation:  0.02187490463256836
local_output_nid generation:  0.0015773773193359375
local_in_edges_tensor generation:  0.0008916854858398438
mini_batch_src_global generation:  0.0017850399017333984
r_  generation:  0.02249312400817871
local_output_nid generation:  0.0015637874603271484
local_in_edges_tensor generation:  0.0010485649108886719
mini_batch_src_global generation:  0.0018095970153808594
r_  generation:  0.022710323333740234
local_output_nid generation:  0.0015633106231689453
local_in_edges_tensor generation:  0.0009543895721435547
mini_batch_src_global generation:  0.0017933845520019531
r_  generation:  0.022233009338378906
local_output_nid generation:  0.0015935897827148438
local_in_edges_tensor generation:  0.0009658336639404297
mini_batch_src_global generation:  0.001734018325805664
r_  generation:  0.02171039581298828
local_output_nid generation:  0.0015630722045898438
local_in_edges_tensor generation:  0.0009303092956542969
mini_batch_src_global generation:  0.0017781257629394531
r_  generation:  0.02285027503967285
local_output_nid generation:  0.001583099365234375
local_in_edges_tensor generation:  0.0009381771087646484
mini_batch_src_global generation:  0.001795053482055664
r_  generation:  0.022164344787597656
local_output_nid generation:  0.0015940666198730469
local_in_edges_tensor generation:  0.0008950233459472656
mini_batch_src_global generation:  0.0017578601837158203
r_  generation:  0.0214231014251709
----------------------check_connections_block total spend ----------------------------- 0.5219035148620605
generate_one_block  0.03426241874694824
generate_one_block  0.031815528869628906
generate_one_block  0.03076934814453125
generate_one_block  0.030147075653076172
generate_one_block  0.03165555000305176
generate_one_block  0.03257179260253906
generate_one_block  0.03228402137756348
generate_one_block  0.03160285949707031
generate_one_block  0.030878067016601562
generate_one_block  0.03169703483581543
generate_one_block  0.03142213821411133
generate_one_block  0.03148365020751953
generate_one_block  0.031226634979248047
generate_one_block  0.032041311264038086
generate_one_block  0.031083106994628906
generate_one_block  0.030950546264648438
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04686570167541504
gen group dst list time:  0.017722606658935547
time for parepare:  0.01973557472229004
local_output_nid generation:  0.007539033889770508
local_in_edges_tensor generation:  0.022796630859375
mini_batch_src_global generation:  0.027554035186767578
r_  generation:  0.2515285015106201
local_output_nid generation:  0.011615514755249023
local_in_edges_tensor generation:  0.017596006393432617
mini_batch_src_global generation:  0.0325624942779541
r_  generation:  0.26467204093933105
local_output_nid generation:  0.01153707504272461
local_in_edges_tensor generation:  0.017452239990234375
mini_batch_src_global generation:  0.03268575668334961
r_  generation:  0.25778913497924805
local_output_nid generation:  0.012311935424804688
local_in_edges_tensor generation:  0.017661094665527344
mini_batch_src_global generation:  0.03154587745666504
r_  generation:  0.2620882987976074
local_output_nid generation:  0.012953042984008789
local_in_edges_tensor generation:  0.014244318008422852
mini_batch_src_global generation:  0.03564882278442383
r_  generation:  0.27735280990600586
local_output_nid generation:  0.012703895568847656
local_in_edges_tensor generation:  0.013857841491699219
mini_batch_src_global generation:  0.0337371826171875
r_  generation:  0.26773810386657715
local_output_nid generation:  0.013270378112792969
local_in_edges_tensor generation:  0.014349222183227539
mini_batch_src_global generation:  0.034786224365234375
r_  generation:  0.2779231071472168
local_output_nid generation:  0.01321268081665039
local_in_edges_tensor generation:  0.015255212783813477
mini_batch_src_global generation:  0.03482842445373535
r_  generation:  0.2766551971435547
local_output_nid generation:  0.013291120529174805
local_in_edges_tensor generation:  0.013970613479614258
mini_batch_src_global generation:  0.03617048263549805
r_  generation:  0.2730426788330078
local_output_nid generation:  0.01361393928527832
local_in_edges_tensor generation:  0.014102697372436523
mini_batch_src_global generation:  0.03499722480773926
r_  generation:  0.281252384185791
local_output_nid generation:  0.01320028305053711
local_in_edges_tensor generation:  0.016173362731933594
mini_batch_src_global generation:  0.03537106513977051
r_  generation:  0.27773118019104004
local_output_nid generation:  0.013354778289794922
local_in_edges_tensor generation:  0.014439821243286133
mini_batch_src_global generation:  0.03456258773803711
r_  generation:  0.27390170097351074
local_output_nid generation:  0.013415336608886719
local_in_edges_tensor generation:  0.014214277267456055
mini_batch_src_global generation:  0.03529548645019531
r_  generation:  0.27318692207336426
local_output_nid generation:  0.013659238815307617
local_in_edges_tensor generation:  0.014168739318847656
mini_batch_src_global generation:  0.0347745418548584
r_  generation:  0.2780778408050537
local_output_nid generation:  0.01345205307006836
local_in_edges_tensor generation:  0.014187335968017578
mini_batch_src_global generation:  0.0351870059967041
r_  generation:  0.27320098876953125
local_output_nid generation:  0.013164520263671875
local_in_edges_tensor generation:  0.014331817626953125
mini_batch_src_global generation:  0.033597469329833984
r_  generation:  0.2682762145996094
----------------------check_connections_block total spend ----------------------------- 6.270390033721924
generate_one_block  0.3504331111907959
generate_one_block  0.353623628616333
generate_one_block  0.3435361385345459
generate_one_block  0.34035348892211914
generate_one_block  0.3616163730621338
generate_one_block  0.33941221237182617
generate_one_block  0.3850080966949463
generate_one_block  0.35751891136169434
generate_one_block  0.3545207977294922
generate_one_block  0.35370397567749023
generate_one_block  0.35616111755371094
generate_one_block  0.35381436347961426
generate_one_block  0.34992218017578125
generate_one_block  0.35180044174194336
generate_one_block  0.34601759910583496
generate_one_block  0.34220242500305176
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03857254981994629
gen group dst list time:  0.06821084022521973
time for parepare:  0.019432544708251953
local_output_nid generation:  0.025447845458984375
local_in_edges_tensor generation:  0.04346013069152832
mini_batch_src_global generation:  0.051001548767089844
r_  generation:  0.5214567184448242
local_output_nid generation:  0.03138899803161621
local_in_edges_tensor generation:  0.03979945182800293
mini_batch_src_global generation:  0.06232905387878418
r_  generation:  0.5241920948028564
local_output_nid generation:  0.03190445899963379
local_in_edges_tensor generation:  0.03556466102600098
mini_batch_src_global generation:  0.06000161170959473
r_  generation:  0.5333845615386963
local_output_nid generation:  0.031888484954833984
local_in_edges_tensor generation:  0.03386712074279785
mini_batch_src_global generation:  0.06029820442199707
r_  generation:  0.5354909896850586
local_output_nid generation:  0.032593488693237305
local_in_edges_tensor generation:  0.0813758373260498
mini_batch_src_global generation:  0.061242103576660156
r_  generation:  0.5510730743408203
local_output_nid generation:  0.03271794319152832
local_in_edges_tensor generation:  0.03722047805786133
mini_batch_src_global generation:  0.06142306327819824
r_  generation:  0.5505094528198242
local_output_nid generation:  0.0325775146484375
local_in_edges_tensor generation:  0.03592324256896973
mini_batch_src_global generation:  0.06049489974975586
r_  generation:  0.5496735572814941
local_output_nid generation:  0.032423973083496094
local_in_edges_tensor generation:  0.03784346580505371
mini_batch_src_global generation:  0.06271195411682129
r_  generation:  0.5529110431671143
local_output_nid generation:  0.032704830169677734
local_in_edges_tensor generation:  0.03657937049865723
mini_batch_src_global generation:  0.06067323684692383
r_  generation:  0.5520501136779785
local_output_nid generation:  0.03293251991271973
local_in_edges_tensor generation:  0.034314870834350586
mini_batch_src_global generation:  0.0619196891784668
r_  generation:  0.5440874099731445
local_output_nid generation:  0.03297257423400879
local_in_edges_tensor generation:  0.03838396072387695
mini_batch_src_global generation:  0.0612330436706543
r_  generation:  0.5478000640869141
local_output_nid generation:  0.03274035453796387
local_in_edges_tensor generation:  0.036113739013671875
mini_batch_src_global generation:  0.06361579895019531
r_  generation:  0.5465025901794434
local_output_nid generation:  0.03266286849975586
local_in_edges_tensor generation:  0.03667259216308594
mini_batch_src_global generation:  0.06144547462463379
r_  generation:  0.5548760890960693
local_output_nid generation:  0.0328669548034668
local_in_edges_tensor generation:  0.03629899024963379
mini_batch_src_global generation:  0.06260871887207031
r_  generation:  0.552966833114624
local_output_nid generation:  0.032860755920410156
local_in_edges_tensor generation:  0.03838491439819336
mini_batch_src_global generation:  0.06101346015930176
r_  generation:  0.5582675933837891
local_output_nid generation:  0.03275275230407715
local_in_edges_tensor generation:  0.033901214599609375
mini_batch_src_global generation:  0.06287527084350586
r_  generation:  0.5483644008636475
----------------------check_connections_block total spend ----------------------------- 12.791470050811768
generate_one_block  0.6806530952453613
generate_one_block  0.6803233623504639
generate_one_block  0.688046932220459
generate_one_block  0.6778197288513184
generate_one_block  0.6949069499969482
generate_one_block  0.6847641468048096
generate_one_block  0.6893718242645264
generate_one_block  0.6865918636322021
generate_one_block  0.7597086429595947
generate_one_block  0.6812129020690918
generate_one_block  0.6884942054748535
generate_one_block  0.6821832656860352
generate_one_block  0.677954912185669
generate_one_block  0.6885933876037598
generate_one_block  0.6956310272216797
generate_one_block  0.680354118347168
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.1271042823791504  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

connection checking time:  19.06186008453369
block generation total time  16.676255226135254
average batch blocks generation time:  1.0422659516334534
block dataloader generation time/epoch 37.83124236056679
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10085725784301758  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7778868675231934  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09985780715942383  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7733221054077148  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09961795806884766  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7663908004760742  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09959220886230469  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7658867835998535  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09994792938232422  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7771182060241699  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09957075119018555  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7682180404663086  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0998830795288086  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7810802459716797  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10002565383911133  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7770209312438965  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09976434707641602  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7699394226074219  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09999418258666992  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7797684669494629  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10089302062988281  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7779908180236816  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.099700927734375  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7705988883972168  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10079097747802734  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7718863487243652  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09985065460205078  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7768049240112305  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10072612762451172  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7754330635070801  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09963607788085938  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.770409107208252  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06922371685504913 |0.014760270714759827 |0.0035023093223571777 |9.045004844665527e-05 |0.003690481185913086 |0.0028667449951171875 |
----------------------------------------------------------pseudo_mini_loss sum 1.2207202911376953
Total (block generation + training)time/epoch 39.32423242769743
Training time/epoch 1.5326673984527588
Training time without block to device /epoch 1.2965030670166016
Training time without total dataloading part /epoch 0.11939859390258789
load block tensor time/epoch 1.1075794696807861
block to device time/epoch 0.23616433143615723
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 28 |
Number of nodes for computation during this epoch:  5332078
Number of first layer input nodes during this epoch:  2522936
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.12687921524047852  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022098779678344727
range selection method range initialization spend 0.01225137710571289
time for parepare:  0.016906261444091797
local_output_nid generation:  0.00140380859375
local_in_edges_tensor generation:  0.00432133674621582
mini_batch_src_global generation:  0.0017800331115722656
r_  generation:  0.02138662338256836
local_output_nid generation:  0.0015342235565185547
local_in_edges_tensor generation:  0.000942230224609375
mini_batch_src_global generation:  0.002064228057861328
r_  generation:  0.02312302589416504
local_output_nid generation:  0.0015680789947509766
local_in_edges_tensor generation:  0.0010223388671875
mini_batch_src_global generation:  0.001712799072265625
r_  generation:  0.02126145362854004
local_output_nid generation:  0.0016095638275146484
local_in_edges_tensor generation:  0.0009765625
mini_batch_src_global generation:  0.0017642974853515625
r_  generation:  0.021757125854492188
local_output_nid generation:  0.0015895366668701172
local_in_edges_tensor generation:  0.0010347366333007812
mini_batch_src_global generation:  0.0017070770263671875
r_  generation:  0.021046161651611328
local_output_nid generation:  0.0015769004821777344
local_in_edges_tensor generation:  0.00095367431640625
mini_batch_src_global generation:  0.0017304420471191406
r_  generation:  0.021690845489501953
local_output_nid generation:  0.0015707015991210938
local_in_edges_tensor generation:  0.0009562969207763672
mini_batch_src_global generation:  0.0018124580383300781
r_  generation:  0.022683382034301758
local_output_nid generation:  0.001569509506225586
local_in_edges_tensor generation:  0.0009279251098632812
mini_batch_src_global generation:  0.0017888545989990234
r_  generation:  0.02197885513305664
local_output_nid generation:  0.0015788078308105469
local_in_edges_tensor generation:  0.0009484291076660156
mini_batch_src_global generation:  0.0017876625061035156
r_  generation:  0.022449493408203125
local_output_nid generation:  0.0015704631805419922
local_in_edges_tensor generation:  0.0009438991546630859
mini_batch_src_global generation:  0.0017881393432617188
r_  generation:  0.022269248962402344
local_output_nid generation:  0.0015773773193359375
local_in_edges_tensor generation:  0.0009381771087646484
mini_batch_src_global generation:  0.0017914772033691406
r_  generation:  0.022182464599609375
local_output_nid generation:  0.0015790462493896484
local_in_edges_tensor generation:  0.0009481906890869141
mini_batch_src_global generation:  0.0017626285552978516
r_  generation:  0.021926164627075195
local_output_nid generation:  0.0015516281127929688
local_in_edges_tensor generation:  0.0009276866912841797
mini_batch_src_global generation:  0.0017669200897216797
r_  generation:  0.02200460433959961
local_output_nid generation:  0.0016009807586669922
local_in_edges_tensor generation:  0.0009002685546875
mini_batch_src_global generation:  0.0017957687377929688
r_  generation:  0.022706031799316406
local_output_nid generation:  0.001596212387084961
local_in_edges_tensor generation:  0.0009663105010986328
mini_batch_src_global generation:  0.0017557144165039062
r_  generation:  0.021773815155029297
local_output_nid generation:  0.0015680789947509766
local_in_edges_tensor generation:  0.0009291172027587891
mini_batch_src_global generation:  0.0017657279968261719
r_  generation:  0.022411346435546875
----------------------check_connections_block total spend ----------------------------- 0.5205740928649902
generate_one_block  0.03891921043395996
generate_one_block  0.03199458122253418
generate_one_block  0.0306394100189209
generate_one_block  0.03133654594421387
generate_one_block  0.030214548110961914
generate_one_block  0.03292036056518555
generate_one_block  0.03189492225646973
generate_one_block  0.03095078468322754
generate_one_block  0.03135871887207031
generate_one_block  0.030869483947753906
generate_one_block  0.030977487564086914
generate_one_block  0.031052827835083008
generate_one_block  0.03110480308532715
generate_one_block  0.03186655044555664
generate_one_block  0.030658960342407227
generate_one_block  0.03221607208251953
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03650045394897461
gen group dst list time:  0.0177154541015625
time for parepare:  0.019542694091796875
local_output_nid generation:  0.007529258728027344
local_in_edges_tensor generation:  0.018348217010498047
mini_batch_src_global generation:  0.029006481170654297
r_  generation:  0.2502150535583496
local_output_nid generation:  0.011500835418701172
local_in_edges_tensor generation:  0.017737150192260742
mini_batch_src_global generation:  0.03636503219604492
r_  generation:  0.2639763355255127
local_output_nid generation:  0.011469364166259766
local_in_edges_tensor generation:  0.017369747161865234
mini_batch_src_global generation:  0.03435373306274414
r_  generation:  0.2575223445892334
local_output_nid generation:  0.012368440628051758
local_in_edges_tensor generation:  0.013522148132324219
mini_batch_src_global generation:  0.03256368637084961
r_  generation:  0.26837587356567383
local_output_nid generation:  0.012524604797363281
local_in_edges_tensor generation:  0.013139486312866211
mini_batch_src_global generation:  0.0372312068939209
r_  generation:  0.25816822052001953
local_output_nid generation:  0.013022422790527344
local_in_edges_tensor generation:  0.016753196716308594
mini_batch_src_global generation:  0.03376913070678711
r_  generation:  0.2688744068145752
local_output_nid generation:  0.013170242309570312
local_in_edges_tensor generation:  0.013801813125610352
mini_batch_src_global generation:  0.03461742401123047
r_  generation:  0.27304983139038086
local_output_nid generation:  0.012912750244140625
local_in_edges_tensor generation:  0.013375520706176758
mini_batch_src_global generation:  0.03413248062133789
r_  generation:  0.2692990303039551
local_output_nid generation:  0.013173580169677734
local_in_edges_tensor generation:  0.013573408126831055
mini_batch_src_global generation:  0.03490614891052246
r_  generation:  0.27355074882507324
local_output_nid generation:  0.012958049774169922
local_in_edges_tensor generation:  0.01347804069519043
mini_batch_src_global generation:  0.03451204299926758
r_  generation:  0.27121567726135254
local_output_nid generation:  0.012666702270507812
local_in_edges_tensor generation:  0.014529228210449219
mini_batch_src_global generation:  0.03602933883666992
r_  generation:  0.27272510528564453
local_output_nid generation:  0.01322627067565918
local_in_edges_tensor generation:  0.01441192626953125
mini_batch_src_global generation:  0.03460979461669922
r_  generation:  0.2744426727294922
local_output_nid generation:  0.013505220413208008
local_in_edges_tensor generation:  0.016840457916259766
mini_batch_src_global generation:  0.03494548797607422
r_  generation:  0.2761867046356201
local_output_nid generation:  0.01360321044921875
local_in_edges_tensor generation:  0.014087438583374023
mini_batch_src_global generation:  0.035219669342041016
r_  generation:  0.2794613838195801
local_output_nid generation:  0.013135194778442383
local_in_edges_tensor generation:  0.013781547546386719
mini_batch_src_global generation:  0.034871816635131836
r_  generation:  0.26996636390686035
local_output_nid generation:  0.013445377349853516
local_in_edges_tensor generation:  0.014267683029174805
mini_batch_src_global generation:  0.035184383392333984
r_  generation:  0.2785978317260742
----------------------check_connections_block total spend ----------------------------- 6.238760232925415
generate_one_block  0.35010313987731934
generate_one_block  0.35913825035095215
generate_one_block  0.34538698196411133
generate_one_block  0.35135531425476074
generate_one_block  0.3353888988494873
generate_one_block  0.3451731204986572
generate_one_block  0.3763270378112793
generate_one_block  0.3445291519165039
generate_one_block  0.35085082054138184
generate_one_block  0.3458704948425293
generate_one_block  0.345700740814209
generate_one_block  0.3515739440917969
generate_one_block  0.35354018211364746
generate_one_block  0.359835147857666
generate_one_block  0.3443615436553955
generate_one_block  0.35733580589294434
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028892040252685547
gen group dst list time:  0.06633424758911133
time for parepare:  0.01831197738647461
local_output_nid generation:  0.026691198348999023
local_in_edges_tensor generation:  0.045969486236572266
mini_batch_src_global generation:  0.05007624626159668
r_  generation:  0.5250577926635742
local_output_nid generation:  0.03120899200439453
local_in_edges_tensor generation:  0.034357309341430664
mini_batch_src_global generation:  0.06228470802307129
r_  generation:  0.5200550556182861
local_output_nid generation:  0.031845808029174805
local_in_edges_tensor generation:  0.03181648254394531
mini_batch_src_global generation:  0.05843687057495117
r_  generation:  0.5412344932556152
local_output_nid generation:  0.03222990036010742
local_in_edges_tensor generation:  0.03318166732788086
mini_batch_src_global generation:  0.059372901916503906
r_  generation:  0.5344982147216797
local_output_nid generation:  0.03213810920715332
local_in_edges_tensor generation:  0.07787632942199707
mini_batch_src_global generation:  0.06037545204162598
r_  generation:  0.541806697845459
local_output_nid generation:  0.032349348068237305
local_in_edges_tensor generation:  0.03207278251647949
mini_batch_src_global generation:  0.06219983100891113
r_  generation:  0.5354118347167969
local_output_nid generation:  0.0325474739074707
local_in_edges_tensor generation:  0.03859519958496094
mini_batch_src_global generation:  0.06449341773986816
r_  generation:  0.5517816543579102
local_output_nid generation:  0.0325162410736084
local_in_edges_tensor generation:  0.040288448333740234
mini_batch_src_global generation:  0.06278324127197266
r_  generation:  0.5404651165008545
local_output_nid generation:  0.03274869918823242
local_in_edges_tensor generation:  0.035092830657958984
mini_batch_src_global generation:  0.06143689155578613
r_  generation:  0.5492732524871826
local_output_nid generation:  0.03353166580200195
local_in_edges_tensor generation:  0.03370046615600586
mini_batch_src_global generation:  0.06258535385131836
r_  generation:  0.5406608581542969
local_output_nid generation:  0.03253436088562012
local_in_edges_tensor generation:  0.03450202941894531
mini_batch_src_global generation:  0.06285667419433594
r_  generation:  0.5545387268066406
local_output_nid generation:  0.03253030776977539
local_in_edges_tensor generation:  0.034303903579711914
mini_batch_src_global generation:  0.06293916702270508
r_  generation:  0.5463612079620361
local_output_nid generation:  0.03272509574890137
local_in_edges_tensor generation:  0.031865596771240234
mini_batch_src_global generation:  0.06396365165710449
r_  generation:  0.545166015625
local_output_nid generation:  0.03263044357299805
local_in_edges_tensor generation:  0.034388065338134766
mini_batch_src_global generation:  0.06366467475891113
r_  generation:  0.5476818084716797
local_output_nid generation:  0.03261995315551758
local_in_edges_tensor generation:  0.0386202335357666
mini_batch_src_global generation:  0.06228065490722656
r_  generation:  0.5432157516479492
local_output_nid generation:  0.03283238410949707
local_in_edges_tensor generation:  0.031781673431396484
mini_batch_src_global generation:  0.06335043907165527
r_  generation:  0.5488214492797852
----------------------check_connections_block total spend ----------------------------- 12.70648741722107
generate_one_block  0.6800909042358398
generate_one_block  0.6789965629577637
generate_one_block  0.6767690181732178
generate_one_block  0.6880395412445068
generate_one_block  0.6743862628936768
generate_one_block  0.6821119785308838
generate_one_block  0.6908309459686279
generate_one_block  0.6766402721405029
generate_one_block  0.722264289855957
generate_one_block  0.693150520324707
generate_one_block  0.6839396953582764
generate_one_block  0.677093505859375
generate_one_block  0.6882719993591309
generate_one_block  0.6847622394561768
generate_one_block  0.6774775981903076
generate_one_block  0.6828441619873047
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.12687921524047852  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

connection checking time:  18.945247650146484
block generation total time  16.574140071868896
average batch blocks generation time:  1.035883754491806
block dataloader generation time/epoch 37.824386501312254
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09983205795288086  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7795429229736328  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.099853515625  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7733721733093262  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09958362579345703  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7661967277526855  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09993934631347656  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7771377563476562  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0994877815246582  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7636990547180176  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0997629165649414  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7712244987487793  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10086822509765625  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.781761646270752  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09955167770385742  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7667675018310547  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10085773468017578  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.778043270111084  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09975051879882812  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7749457359313965  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09976863861083984  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7755846977233887  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09988784790039062  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7707562446594238  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.1008462905883789  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7746052742004395  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10009050369262695  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7809863090515137  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0995488166809082  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7671399116516113  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10000991821289062  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.780728816986084  GigaBytes
Max Memory Allocated: 0.8724608421325684  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06387192010879517 |0.015816345810890198 |0.0036670565605163574 |9.37432050704956e-05 |0.0032295584678649902 |0.001556396484375 |
----------------------------------------------------------pseudo_mini_loss sum 1.21277916431427
Total (block generation + training)time/epoch 39.31563729047775
Training time/epoch 1.4579639434814453
Training time without block to device /epoch 1.2049024105072021
Training time without total dataloading part /epoch 0.11340212821960449
load block tensor time/epoch 1.0219507217407227
block to device time/epoch 0.25306153297424316
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 29 |
Number of nodes for computation during this epoch:  5331941
Number of first layer input nodes during this epoch:  2522511
