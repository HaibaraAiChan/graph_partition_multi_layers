Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1647754266.8038256
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02650141716003418
random selection method range initialization spend 0.006102561950683594
time for parepare:  0.01831197738647461
local_output_nid generation:  0.008597135543823242
local_in_edges_tensor generation:  0.009715080261230469
mini_batch_src_global generation:  0.007249593734741211
r_  generation:  0.09033560752868652
local_output_nid generation:  0.011706113815307617
local_in_edges_tensor generation:  0.006053447723388672
mini_batch_src_global generation:  0.009732246398925781
r_  generation:  0.09497261047363281
local_output_nid generation:  0.011863231658935547
local_in_edges_tensor generation:  0.006211519241333008
mini_batch_src_global generation:  0.007385730743408203
r_  generation:  0.10141134262084961
local_output_nid generation:  0.01189565658569336
local_in_edges_tensor generation:  0.006040096282958984
mini_batch_src_global generation:  0.00832366943359375
r_  generation:  0.10167765617370605
----------------------check_connections_block total spend ----------------------------- 0.598701000213623
generate_one_block  0.11749958992004395
generate_one_block  0.11456632614135742
generate_one_block  0.11636519432067871
generate_one_block  0.11559534072875977
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04161691665649414
gen group dst list time:  0.011769771575927734
time for parepare:  0.019636154174804688
local_output_nid generation:  0.021018028259277344
local_in_edges_tensor generation:  0.04410696029663086
mini_batch_src_global generation:  0.04381155967712402
r_  generation:  0.4251058101654053
local_output_nid generation:  0.03097987174987793
local_in_edges_tensor generation:  0.04127931594848633
mini_batch_src_global generation:  0.04994845390319824
r_  generation:  0.434553861618042
local_output_nid generation:  0.031288862228393555
local_in_edges_tensor generation:  0.033384084701538086
mini_batch_src_global generation:  0.04990863800048828
r_  generation:  0.4385061264038086
local_output_nid generation:  0.031511545181274414
local_in_edges_tensor generation:  0.03471112251281738
mini_batch_src_global generation:  0.05013322830200195
r_  generation:  0.4446535110473633
----------------------check_connections_block total spend ----------------------------- 2.608274459838867
generate_one_block  0.5923926830291748
generate_one_block  0.5600295066833496
generate_one_block  0.5685379505157471
generate_one_block  0.5732030868530273
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03402590751647949
gen group dst list time:  0.021135568618774414
time for parepare:  0.019608497619628906
local_output_nid generation:  0.030344247817993164
local_in_edges_tensor generation:  0.04592299461364746
mini_batch_src_global generation:  0.045893192291259766
r_  generation:  0.4949178695678711
local_output_nid generation:  0.042101144790649414
local_in_edges_tensor generation:  0.056195735931396484
mini_batch_src_global generation:  0.05606698989868164
r_  generation:  0.5026516914367676
local_output_nid generation:  0.042702674865722656
local_in_edges_tensor generation:  0.04193592071533203
mini_batch_src_global generation:  0.05447196960449219
r_  generation:  0.5026791095733643
local_output_nid generation:  0.04296517372131348
local_in_edges_tensor generation:  0.043406009674072266
mini_batch_src_global generation:  0.05158877372741699
r_  generation:  0.5166182518005371
----------------------check_connections_block total spend ----------------------------- 3.041447639465332
generate_one_block  0.6358218193054199
generate_one_block  0.6330342292785645
generate_one_block  0.6370158195495605
generate_one_block  0.6322672367095947
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  5.649722099304199
block generation total time  4.8323023319244385
average batch blocks generation time:  1.2080755829811096
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.10314464569091797  GigaBytes
Max Memory Allocated: 0.10314464569091797  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6893310546875 GB
    Memory Allocated: 1.132359504699707  GigaBytes
Max Memory Allocated: 1.2266626358032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1131591796875 GB
    Memory Allocated: 0.10804033279418945  GigaBytes
Max Memory Allocated: 1.337820053100586  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1131591796875 GB
    Memory Allocated: 1.1299324035644531  GigaBytes
Max Memory Allocated: 1.337820053100586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1131591796875 GB
    Memory Allocated: 0.10819339752197266  GigaBytes
Max Memory Allocated: 1.337820053100586  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1131591796875 GB
    Memory Allocated: 1.1293177604675293  GigaBytes
Max Memory Allocated: 1.337820053100586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1131591796875 GB
    Memory Allocated: 0.1075587272644043  GigaBytes
Max Memory Allocated: 1.337820053100586  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1131591796875 GB
    Memory Allocated: 1.1282143592834473  GigaBytes
Max Memory Allocated: 1.337820053100586  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05953007936477661 |0.09010249376296997 |0.19410032033920288 |0.00013655424118041992 |0.02569127082824707 |0.0024471282958984375 |
----------------------------------------------------------pseudo_mini_loss sum 6.168535232543945
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1711739
Number of first layer input nodes during this epoch:  658425
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.1473073959350586  GigaBytes
Max Memory Allocated: 1.337820053100586  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0476222038269043
random selection method range initialization spend 0.005461215972900391
time for parepare:  0.018821001052856445
local_output_nid generation:  0.008351325988769531
local_in_edges_tensor generation:  0.020072221755981445
mini_batch_src_global generation:  0.007627725601196289
r_  generation:  0.09069371223449707
local_output_nid generation:  0.011585235595703125
local_in_edges_tensor generation:  0.0078084468841552734
mini_batch_src_global generation:  0.00979757308959961
r_  generation:  0.09500575065612793
local_output_nid generation:  0.01166534423828125
local_in_edges_tensor generation:  0.006547212600708008
mini_batch_src_global generation:  0.007814168930053711
r_  generation:  0.09950494766235352
local_output_nid generation:  0.011862516403198242
local_in_edges_tensor generation:  0.0064585208892822266
mini_batch_src_global generation:  0.008608102798461914
r_  generation:  0.10196208953857422
----------------------check_connections_block total spend ----------------------------- 0.6153488159179688
generate_one_block  0.1154177188873291
generate_one_block  0.11429619789123535
generate_one_block  0.11429619789123535
generate_one_block  0.11467957496643066
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.08958911895751953
gen group dst list time:  0.011922121047973633
time for parepare:  0.018645048141479492
local_output_nid generation:  0.0197298526763916
local_in_edges_tensor generation:  0.05640530586242676
mini_batch_src_global generation:  0.039689064025878906
r_  generation:  0.4155154228210449
local_output_nid generation:  0.025764942169189453
local_in_edges_tensor generation:  0.04402422904968262
mini_batch_src_global generation:  0.049710750579833984
r_  generation:  0.4277212619781494
local_output_nid generation:  0.02632927894592285
local_in_edges_tensor generation:  0.03682994842529297
mini_batch_src_global generation:  0.04956650733947754
r_  generation:  0.43849611282348633
local_output_nid generation:  0.02612137794494629
local_in_edges_tensor generation:  0.03656506538391113
mini_batch_src_global generation:  0.05061173439025879
r_  generation:  0.44718408584594727
----------------------check_connections_block total spend ----------------------------- 2.5945210456848145
generate_one_block  0.5742809772491455
generate_one_block  0.5679442882537842
generate_one_block  0.5828590393066406
generate_one_block  0.5669431686401367
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04329705238342285
gen group dst list time:  0.02395486831665039
time for parepare:  0.018678665161132812
local_output_nid generation:  0.029045581817626953
local_in_edges_tensor generation:  0.07377052307128906
mini_batch_src_global generation:  0.051433563232421875
r_  generation:  0.4896829128265381
local_output_nid generation:  0.03606367111206055
local_in_edges_tensor generation:  0.050290584564208984
mini_batch_src_global generation:  0.05431652069091797
r_  generation:  0.49866509437561035
local_output_nid generation:  0.03611874580383301
local_in_edges_tensor generation:  0.039849042892456055
mini_batch_src_global generation:  0.05486249923706055
r_  generation:  0.510239839553833
local_output_nid generation:  0.037962913513183594
local_in_edges_tensor generation:  0.03618979454040527
mini_batch_src_global generation:  0.05599045753479004
r_  generation:  0.5196552276611328
----------------------check_connections_block total spend ----------------------------- 3.0509097576141357
generate_one_block  0.67130446434021
generate_one_block  0.6344382762908936
generate_one_block  0.6251766681671143
generate_one_block  0.6279850006103516
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.1473073959350586  GigaBytes
Max Memory Allocated: 1.337820053100586  GigaBytes

connection checking time:  5.64543080329895
block generation total time  4.850931882858276
average batch blocks generation time:  1.212732970714569
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.10975980758666992  GigaBytes
Max Memory Allocated: 1.337820053100586  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.1341338157653809  GigaBytes
Max Memory Allocated: 1.337820053100586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10929632186889648  GigaBytes
Max Memory Allocated: 1.3391666412353516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1308188438415527  GigaBytes
Max Memory Allocated: 1.3391666412353516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10915470123291016  GigaBytes
Max Memory Allocated: 1.3391666412353516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1292133331298828  GigaBytes
Max Memory Allocated: 1.3391666412353516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10919857025146484  GigaBytes
Max Memory Allocated: 1.3391666412353516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1331825256347656  GigaBytes
Max Memory Allocated: 1.3391666412353516  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09525591135025024 |0.018900394439697266 |0.003561079502105713 |9.435415267944336e-05 |0.003349006175994873 |0.0029337406158447266 |
----------------------------------------------------------pseudo_mini_loss sum 3.226768732070923
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1711033
Number of first layer input nodes during this epoch:  658285
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14727258682250977  GigaBytes
Max Memory Allocated: 1.3391666412353516  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026452064514160156
random selection method range initialization spend 0.004948139190673828
time for parepare:  0.019783735275268555
local_output_nid generation:  0.008479118347167969
local_in_edges_tensor generation:  0.00960540771484375
mini_batch_src_global generation:  0.007814407348632812
r_  generation:  0.09310054779052734
local_output_nid generation:  0.011814355850219727
local_in_edges_tensor generation:  0.006727457046508789
mini_batch_src_global generation:  0.009924650192260742
r_  generation:  0.09743380546569824
local_output_nid generation:  0.014220952987670898
local_in_edges_tensor generation:  0.007222414016723633
mini_batch_src_global generation:  0.008316516876220703
r_  generation:  0.10412430763244629
local_output_nid generation:  0.012040376663208008
local_in_edges_tensor generation:  0.006860494613647461
mini_batch_src_global generation:  0.008987665176391602
r_  generation:  0.10948467254638672
----------------------check_connections_block total spend ----------------------------- 0.6291360855102539
generate_one_block  0.1153419017791748
generate_one_block  0.1366863250732422
generate_one_block  0.12027096748352051
generate_one_block  0.11946678161621094
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.042072296142578125
gen group dst list time:  0.013133049011230469
time for parepare:  0.02086806297302246
local_output_nid generation:  0.02200937271118164
local_in_edges_tensor generation:  0.05058097839355469
mini_batch_src_global generation:  0.0421297550201416
r_  generation:  0.42572021484375
local_output_nid generation:  0.026710033416748047
local_in_edges_tensor generation:  0.048580169677734375
mini_batch_src_global generation:  0.049719810485839844
r_  generation:  0.4391212463378906
local_output_nid generation:  0.028655290603637695
local_in_edges_tensor generation:  0.03533053398132324
mini_batch_src_global generation:  0.04994058609008789
r_  generation:  0.4480893611907959
local_output_nid generation:  0.027788162231445312
local_in_edges_tensor generation:  0.043924570083618164
mini_batch_src_global generation:  0.05253934860229492
r_  generation:  0.46602416038513184
----------------------check_connections_block total spend ----------------------------- 2.6734442710876465
generate_one_block  0.5646038055419922
generate_one_block  0.5789108276367188
generate_one_block  0.6125543117523193
generate_one_block  0.5597221851348877
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04281735420227051
gen group dst list time:  0.02286362648010254
time for parepare:  0.02067732810974121
local_output_nid generation:  0.030999422073364258
local_in_edges_tensor generation:  0.05755138397216797
mini_batch_src_global generation:  0.045534610748291016
r_  generation:  0.5106427669525146
local_output_nid generation:  0.03845858573913574
local_in_edges_tensor generation:  0.04955887794494629
mini_batch_src_global generation:  0.056630849838256836
r_  generation:  0.5111989974975586
local_output_nid generation:  0.04250454902648926
local_in_edges_tensor generation:  0.05040693283081055
mini_batch_src_global generation:  0.06532502174377441
r_  generation:  0.5171737670898438
local_output_nid generation:  0.03839707374572754
local_in_edges_tensor generation:  0.037041664123535156
mini_batch_src_global generation:  0.052052974700927734
r_  generation:  0.5223352909088135
----------------------check_connections_block total spend ----------------------------- 3.0927422046661377
generate_one_block  0.6377861499786377
generate_one_block  0.6307461261749268
generate_one_block  0.6278440952301025
generate_one_block  0.64687180519104
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14727258682250977  GigaBytes
Max Memory Allocated: 1.3391666412353516  GigaBytes

connection checking time:  5.766186475753784
block generation total time  4.859039306640625
average batch blocks generation time:  1.2147598266601562
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10961675643920898  GigaBytes
Max Memory Allocated: 1.3391666412353516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.130061149597168  GigaBytes
Max Memory Allocated: 1.3391666412353516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10991191864013672  GigaBytes
Max Memory Allocated: 1.3391666412353516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1284632682800293  GigaBytes
Max Memory Allocated: 1.3391666412353516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10932207107543945  GigaBytes
Max Memory Allocated: 1.3391666412353516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1349234580993652  GigaBytes
Max Memory Allocated: 1.3391666412353516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10964822769165039  GigaBytes
Max Memory Allocated: 1.340223789215088  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.13189697265625  GigaBytes
Max Memory Allocated: 1.340223789215088  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09390866756439209 |0.024831652641296387 |0.00376206636428833 |9.763240814208984e-05 |0.003988087177276611 |0.002908945083618164 |
----------------------------------------------------------pseudo_mini_loss sum 2.609746217727661
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  1710199
Number of first layer input nodes during this epoch:  658027
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14876365661621094  GigaBytes
Max Memory Allocated: 1.340223789215088  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02586674690246582
random selection method range initialization spend 0.00568079948425293
time for parepare:  0.01794266700744629
local_output_nid generation:  0.00869441032409668
local_in_edges_tensor generation:  0.009748697280883789
mini_batch_src_global generation:  0.007942438125610352
r_  generation:  0.09163212776184082
local_output_nid generation:  0.011802434921264648
local_in_edges_tensor generation:  0.006752967834472656
mini_batch_src_global generation:  0.01037144660949707
r_  generation:  0.13611984252929688
local_output_nid generation:  0.012578248977661133
local_in_edges_tensor generation:  0.006364107131958008
mini_batch_src_global generation:  0.014203310012817383
r_  generation:  0.10447382926940918
local_output_nid generation:  0.011972904205322266
local_in_edges_tensor generation:  0.006336212158203125
mini_batch_src_global generation:  0.009033203125
r_  generation:  0.11072301864624023
----------------------check_connections_block total spend ----------------------------- 0.687762975692749
generate_one_block  0.11729907989501953
generate_one_block  0.11821818351745605
generate_one_block  0.11677908897399902
generate_one_block  0.12152552604675293
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03640460968017578
gen group dst list time:  0.011526346206665039
time for parepare:  0.019255399703979492
local_output_nid generation:  0.021788835525512695
local_in_edges_tensor generation:  0.04049110412597656
mini_batch_src_global generation:  0.04199576377868652
r_  generation:  0.42688751220703125
local_output_nid generation:  0.027579545974731445
local_in_edges_tensor generation:  0.03919672966003418
mini_batch_src_global generation:  0.05133700370788574
r_  generation:  0.43728113174438477
local_output_nid generation:  0.026826858520507812
local_in_edges_tensor generation:  0.029111623764038086
mini_batch_src_global generation:  0.051162004470825195
r_  generation:  0.44878673553466797
local_output_nid generation:  0.02722620964050293
local_in_edges_tensor generation:  0.02874016761779785
mini_batch_src_global generation:  0.05482625961303711
r_  generation:  0.4485890865325928
----------------------check_connections_block total spend ----------------------------- 2.6096713542938232
generate_one_block  0.5723772048950195
generate_one_block  0.5744705200195312
generate_one_block  0.5911893844604492
generate_one_block  0.5750057697296143
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.047265052795410156
gen group dst list time:  0.021712541580200195
time for parepare:  0.019097089767456055
local_output_nid generation:  0.029948711395263672
local_in_edges_tensor generation:  0.05953192710876465
mini_batch_src_global generation:  0.04520678520202637
r_  generation:  0.5000877380371094
local_output_nid generation:  0.03841829299926758
local_in_edges_tensor generation:  0.04615926742553711
mini_batch_src_global generation:  0.05716228485107422
r_  generation:  0.5064194202423096
local_output_nid generation:  0.03845810890197754
local_in_edges_tensor generation:  0.044335365295410156
mini_batch_src_global generation:  0.0547633171081543
r_  generation:  0.5174887180328369
local_output_nid generation:  0.04026055335998535
local_in_edges_tensor generation:  0.039411067962646484
mini_batch_src_global generation:  0.07615900039672852
r_  generation:  0.5193901062011719
----------------------check_connections_block total spend ----------------------------- 3.0868470668792725
generate_one_block  0.6453418731689453
generate_one_block  0.6462068557739258
generate_one_block  0.6406362056732178
generate_one_block  0.6312167644500732
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14876365661621094  GigaBytes
Max Memory Allocated: 1.340223789215088  GigaBytes

connection checking time:  5.696518421173096
block generation total time  4.876444578170776
average batch blocks generation time:  1.219111144542694
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10979938507080078  GigaBytes
Max Memory Allocated: 1.340223789215088  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1323628425598145  GigaBytes
Max Memory Allocated: 1.340223789215088  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10919713973999023  GigaBytes
Max Memory Allocated: 1.340223789215088  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1275663375854492  GigaBytes
Max Memory Allocated: 1.340223789215088  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10924625396728516  GigaBytes
Max Memory Allocated: 1.340223789215088  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.134481430053711  GigaBytes
Max Memory Allocated: 1.340223789215088  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10962820053100586  GigaBytes
Max Memory Allocated: 1.340223789215088  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.130958080291748  GigaBytes
Max Memory Allocated: 1.340223789215088  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09459835290908813 |0.01957380771636963 |0.003733336925506592 |9.846687316894531e-05 |0.0038434863090515137 |0.0018684864044189453 |
----------------------------------------------------------pseudo_mini_loss sum 2.377474784851074
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  1709926
Number of first layer input nodes during this epoch:  658124
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14883184432983398  GigaBytes
Max Memory Allocated: 1.340223789215088  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024531126022338867
random selection method range initialization spend 0.005370140075683594
time for parepare:  0.018079042434692383
local_output_nid generation:  0.008678674697875977
local_in_edges_tensor generation:  0.01250910758972168
mini_batch_src_global generation:  0.007971525192260742
r_  generation:  0.09101104736328125
local_output_nid generation:  0.011714696884155273
local_in_edges_tensor generation:  0.006158113479614258
mini_batch_src_global generation:  0.010077714920043945
r_  generation:  0.09766983985900879
local_output_nid generation:  0.01174783706665039
local_in_edges_tensor generation:  0.006169557571411133
mini_batch_src_global generation:  0.00806427001953125
r_  generation:  0.10176706314086914
local_output_nid generation:  0.011824607849121094
local_in_edges_tensor generation:  0.006287574768066406
mini_batch_src_global generation:  0.010084152221679688
r_  generation:  0.10434651374816895
----------------------check_connections_block total spend ----------------------------- 0.6157991886138916
generate_one_block  0.1132664680480957
generate_one_block  0.11465311050415039
generate_one_block  0.11593151092529297
generate_one_block  0.11501836776733398
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0488736629486084
gen group dst list time:  0.011673688888549805
time for parepare:  0.018988370895385742
local_output_nid generation:  0.02150440216064453
local_in_edges_tensor generation:  0.051563262939453125
mini_batch_src_global generation:  0.04076743125915527
r_  generation:  0.4243314266204834
local_output_nid generation:  0.028713226318359375
local_in_edges_tensor generation:  0.032056331634521484
mini_batch_src_global generation:  0.0512540340423584
r_  generation:  0.4420623779296875
local_output_nid generation:  0.02702164649963379
local_in_edges_tensor generation:  0.037664175033569336
mini_batch_src_global generation:  0.04925942420959473
r_  generation:  0.44078612327575684
local_output_nid generation:  0.026958703994750977
local_in_edges_tensor generation:  0.029170989990234375
mini_batch_src_global generation:  0.0500638484954834
r_  generation:  0.4432942867279053
----------------------check_connections_block total spend ----------------------------- 2.5995376110076904
generate_one_block  0.5620806217193604
generate_one_block  0.5608596801757812
generate_one_block  0.5858719348907471
generate_one_block  0.5527362823486328
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03642606735229492
gen group dst list time:  0.02225947380065918
time for parepare:  0.019187450408935547
local_output_nid generation:  0.030379533767700195
local_in_edges_tensor generation:  0.04654073715209961
mini_batch_src_global generation:  0.0441584587097168
r_  generation:  0.5044996738433838
local_output_nid generation:  0.039444923400878906
local_in_edges_tensor generation:  0.0511627197265625
mini_batch_src_global generation:  0.055158376693725586
r_  generation:  0.5068018436431885
local_output_nid generation:  0.03883671760559082
local_in_edges_tensor generation:  0.037676334381103516
mini_batch_src_global generation:  0.0540614128112793
r_  generation:  0.505347490310669
local_output_nid generation:  0.03816032409667969
local_in_edges_tensor generation:  0.03817105293273926
mini_batch_src_global generation:  0.05202436447143555
r_  generation:  0.5183711051940918
----------------------check_connections_block total spend ----------------------------- 3.031205892562866
generate_one_block  0.6223187446594238
generate_one_block  0.6305196285247803
generate_one_block  0.6314318180084229
generate_one_block  0.6306126117706299
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14883184432983398  GigaBytes
Max Memory Allocated: 1.340223789215088  GigaBytes

connection checking time:  5.630743503570557
block generation total time  4.776431322097778
average batch blocks generation time:  1.1941078305244446
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10982513427734375  GigaBytes
Max Memory Allocated: 1.340223789215088  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.128706455230713  GigaBytes
Max Memory Allocated: 1.340223789215088  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10916805267333984  GigaBytes
Max Memory Allocated: 1.340223789215088  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.13307523727417  GigaBytes
Max Memory Allocated: 1.340223789215088  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10924720764160156  GigaBytes
Max Memory Allocated: 1.340223789215088  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1287288665771484  GigaBytes
Max Memory Allocated: 1.340223789215088  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10973691940307617  GigaBytes
Max Memory Allocated: 1.340223789215088  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.135484218597412  GigaBytes
Max Memory Allocated: 1.340223789215088  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08783310651779175 |0.015736281871795654 |0.003567516803741455 |9.655952453613281e-05 |0.016651630401611328 |0.003083944320678711 |
----------------------------------------------------------pseudo_mini_loss sum 2.115121841430664
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  1710575
Number of first layer input nodes during this epoch:  658187
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14796066284179688  GigaBytes
Max Memory Allocated: 1.340531349182129  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022568941116333008
random selection method range initialization spend 0.005406856536865234
time for parepare:  0.018125295639038086
local_output_nid generation:  0.00858616828918457
local_in_edges_tensor generation:  0.009598970413208008
mini_batch_src_global generation:  0.00766444206237793
r_  generation:  0.09022808074951172
local_output_nid generation:  0.011684894561767578
local_in_edges_tensor generation:  0.007055521011352539
mini_batch_src_global generation:  0.010177135467529297
r_  generation:  0.09858822822570801
local_output_nid generation:  0.01170802116394043
local_in_edges_tensor generation:  0.006349086761474609
mini_batch_src_global generation:  0.007951974868774414
r_  generation:  0.10148096084594727
local_output_nid generation:  0.011775493621826172
local_in_edges_tensor generation:  0.006292581558227539
mini_batch_src_global generation:  0.008522272109985352
r_  generation:  0.10420036315917969
----------------------check_connections_block total spend ----------------------------- 0.611687421798706
generate_one_block  0.11220431327819824
generate_one_block  0.11636853218078613
generate_one_block  0.11678600311279297
generate_one_block  0.11675500869750977
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029078960418701172
gen group dst list time:  0.011794805526733398
time for parepare:  0.019219398498535156
local_output_nid generation:  0.02131366729736328
local_in_edges_tensor generation:  0.03510713577270508
mini_batch_src_global generation:  0.03918337821960449
r_  generation:  0.41945695877075195
local_output_nid generation:  0.027600765228271484
local_in_edges_tensor generation:  0.03175616264343262
mini_batch_src_global generation:  0.04905223846435547
r_  generation:  0.4317362308502197
local_output_nid generation:  0.02676987648010254
local_in_edges_tensor generation:  0.028585195541381836
mini_batch_src_global generation:  0.048837900161743164
r_  generation:  0.43967556953430176
local_output_nid generation:  0.026844501495361328
local_in_edges_tensor generation:  0.028229475021362305
mini_batch_src_global generation:  0.05194902420043945
r_  generation:  0.4380638599395752
----------------------check_connections_block total spend ----------------------------- 2.544341802597046
generate_one_block  0.5478601455688477
generate_one_block  0.5557973384857178
generate_one_block  0.5794522762298584
generate_one_block  0.5570142269134521
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02673935890197754
gen group dst list time:  0.02172684669494629
time for parepare:  0.018619060516357422
local_output_nid generation:  0.030206680297851562
local_in_edges_tensor generation:  0.04143357276916504
mini_batch_src_global generation:  0.04652833938598633
r_  generation:  0.49320101737976074
local_output_nid generation:  0.03727269172668457
local_in_edges_tensor generation:  0.035806894302368164
mini_batch_src_global generation:  0.056145668029785156
r_  generation:  0.49668288230895996
local_output_nid generation:  0.037387847900390625
local_in_edges_tensor generation:  0.035310983657836914
mini_batch_src_global generation:  0.05499672889709473
r_  generation:  0.5055785179138184
local_output_nid generation:  0.03751111030578613
local_in_edges_tensor generation:  0.035334110260009766
mini_batch_src_global generation:  0.0521388053894043
r_  generation:  0.5086386203765869
----------------------check_connections_block total spend ----------------------------- 2.961324691772461
generate_one_block  0.625389575958252
generate_one_block  0.6259136199951172
generate_one_block  0.6271066665649414
generate_one_block  0.6400845050811768
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14796066284179688  GigaBytes
Max Memory Allocated: 1.340531349182129  GigaBytes

connection checking time:  5.505666494369507
block generation total time  4.758618354797363
average batch blocks generation time:  1.1896545886993408
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10894155502319336  GigaBytes
Max Memory Allocated: 1.340531349182129  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1263751983642578  GigaBytes
Max Memory Allocated: 1.340531349182129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10933542251586914  GigaBytes
Max Memory Allocated: 1.340531349182129  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1341485977172852  GigaBytes
Max Memory Allocated: 1.340531349182129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10968828201293945  GigaBytes
Max Memory Allocated: 1.340531349182129  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1343779563903809  GigaBytes
Max Memory Allocated: 1.340531349182129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10918664932250977  GigaBytes
Max Memory Allocated: 1.340531349182129  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1295814514160156  GigaBytes
Max Memory Allocated: 1.340531349182129  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08816134929656982 |0.015665531158447266 |0.0034561753273010254 |9.208917617797852e-05 |0.003054678440093994 |0.0013120174407958984 |
----------------------------------------------------------pseudo_mini_loss sum 1.959977388381958
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  1710509
Number of first layer input nodes during this epoch:  658135
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.1468520164489746  GigaBytes
Max Memory Allocated: 1.340531349182129  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.07389569282531738
random selection method range initialization spend 0.006082773208618164
time for parepare:  0.01916360855102539
local_output_nid generation:  0.00858926773071289
local_in_edges_tensor generation:  0.009164810180664062
mini_batch_src_global generation:  0.009374141693115234
r_  generation:  0.09455108642578125
local_output_nid generation:  0.011708974838256836
local_in_edges_tensor generation:  0.006228923797607422
mini_batch_src_global generation:  0.012503862380981445
r_  generation:  0.1034858226776123
local_output_nid generation:  0.011923551559448242
local_in_edges_tensor generation:  0.0063533782958984375
mini_batch_src_global generation:  0.009758949279785156
r_  generation:  0.10721921920776367
local_output_nid generation:  0.01193690299987793
local_in_edges_tensor generation:  0.0077021121978759766
mini_batch_src_global generation:  0.010199546813964844
r_  generation:  0.11424612998962402
----------------------check_connections_block total spend ----------------------------- 0.6540288925170898
generate_one_block  0.11701226234436035
generate_one_block  0.11809515953063965
generate_one_block  0.11650466918945312
generate_one_block  0.11553359031677246
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03772091865539551
gen group dst list time:  0.011596441268920898
time for parepare:  0.019450902938842773
local_output_nid generation:  0.022284984588623047
local_in_edges_tensor generation:  0.047704458236694336
mini_batch_src_global generation:  0.054749250411987305
r_  generation:  0.4283320903778076
local_output_nid generation:  0.028781652450561523
local_in_edges_tensor generation:  0.03506779670715332
mini_batch_src_global generation:  0.05013418197631836
r_  generation:  0.4474773406982422
local_output_nid generation:  0.028461456298828125
local_in_edges_tensor generation:  0.028476238250732422
mini_batch_src_global generation:  0.049747467041015625
r_  generation:  0.43816089630126953
local_output_nid generation:  0.02860426902770996
local_in_edges_tensor generation:  0.029280900955200195
mini_batch_src_global generation:  0.05275559425354004
r_  generation:  0.44727325439453125
----------------------check_connections_block total spend ----------------------------- 2.621349573135376
generate_one_block  0.5687427520751953
generate_one_block  0.5719864368438721
generate_one_block  0.5939271450042725
generate_one_block  0.5630204677581787
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030446529388427734
gen group dst list time:  0.03578591346740723
time for parepare:  0.02209329605102539
local_output_nid generation:  0.030715465545654297
local_in_edges_tensor generation:  0.05678915977478027
mini_batch_src_global generation:  0.060426950454711914
r_  generation:  0.5319113731384277
local_output_nid generation:  0.04085183143615723
local_in_edges_tensor generation:  0.04721188545227051
mini_batch_src_global generation:  0.05983614921569824
r_  generation:  0.5442800521850586
local_output_nid generation:  0.042122602462768555
local_in_edges_tensor generation:  0.05040168762207031
mini_batch_src_global generation:  0.06343626976013184
r_  generation:  0.5224525928497314
local_output_nid generation:  0.03926992416381836
local_in_edges_tensor generation:  0.04141807556152344
mini_batch_src_global generation:  0.05529975891113281
r_  generation:  0.5358231067657471
----------------------check_connections_block total spend ----------------------------- 3.250549554824829
generate_one_block  0.6409780979156494
generate_one_block  0.64701247215271
generate_one_block  0.6412098407745361
generate_one_block  0.6334371566772461
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.1468520164489746  GigaBytes
Max Memory Allocated: 1.340531349182129  GigaBytes

connection checking time:  5.871899127960205
block generation total time  4.86031436920166
average batch blocks generation time:  1.215078592300415
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10927343368530273  GigaBytes
Max Memory Allocated: 1.340531349182129  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1354093551635742  GigaBytes
Max Memory Allocated: 1.340531349182129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10967493057250977  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1316041946411133  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.1097421646118164  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1279759407043457  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10919046401977539  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1293063163757324  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09228676557540894 |0.018663644790649414 |0.0036951303482055664 |9.959936141967773e-05 |0.00393986701965332 |0.001405954360961914 |
----------------------------------------------------------pseudo_mini_loss sum 1.8700814247131348
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  1710374
Number of first layer input nodes during this epoch:  658169
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14716720581054688  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02569723129272461
random selection method range initialization spend 0.0061151981353759766
time for parepare:  0.01982736587524414
local_output_nid generation:  0.008394241333007812
local_in_edges_tensor generation:  0.010115623474121094
mini_batch_src_global generation:  0.007678508758544922
r_  generation:  0.09076952934265137
local_output_nid generation:  0.011873960494995117
local_in_edges_tensor generation:  0.006066322326660156
mini_batch_src_global generation:  0.010054349899291992
r_  generation:  0.09748673439025879
local_output_nid generation:  0.01187276840209961
local_in_edges_tensor generation:  0.006183624267578125
mini_batch_src_global generation:  0.007794618606567383
r_  generation:  0.10079360008239746
local_output_nid generation:  0.011938810348510742
local_in_edges_tensor generation:  0.0060236454010009766
mini_batch_src_global generation:  0.00874781608581543
r_  generation:  0.10510587692260742
----------------------check_connections_block total spend ----------------------------- 0.6128058433532715
generate_one_block  0.11417293548583984
generate_one_block  0.11458921432495117
generate_one_block  0.11540365219116211
generate_one_block  0.11619257926940918
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03908801078796387
gen group dst list time:  0.0117034912109375
time for parepare:  0.0192110538482666
local_output_nid generation:  0.021412372589111328
local_in_edges_tensor generation:  0.03522348403930664
mini_batch_src_global generation:  0.04148674011230469
r_  generation:  0.4223313331604004
local_output_nid generation:  0.027292966842651367
local_in_edges_tensor generation:  0.03024888038635254
mini_batch_src_global generation:  0.0499873161315918
r_  generation:  0.4311800003051758
local_output_nid generation:  0.02670598030090332
local_in_edges_tensor generation:  0.0283205509185791
mini_batch_src_global generation:  0.0507810115814209
r_  generation:  0.44190359115600586
local_output_nid generation:  0.02703237533569336
local_in_edges_tensor generation:  0.027515411376953125
mini_batch_src_global generation:  0.05086517333984375
r_  generation:  0.44339966773986816
----------------------check_connections_block total spend ----------------------------- 2.5679924488067627
generate_one_block  0.5602536201477051
generate_one_block  0.5610470771789551
generate_one_block  0.59047532081604
generate_one_block  0.5736391544342041
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03133726119995117
gen group dst list time:  0.02193617820739746
time for parepare:  0.019684553146362305
local_output_nid generation:  0.030442476272583008
local_in_edges_tensor generation:  0.05477476119995117
mini_batch_src_global generation:  0.049241065979003906
r_  generation:  0.49565649032592773
local_output_nid generation:  0.03784012794494629
local_in_edges_tensor generation:  0.04153561592102051
mini_batch_src_global generation:  0.05584430694580078
r_  generation:  0.5076098442077637
local_output_nid generation:  0.03669261932373047
local_in_edges_tensor generation:  0.03797602653503418
mini_batch_src_global generation:  0.054264068603515625
r_  generation:  0.5079450607299805
local_output_nid generation:  0.03725385665893555
local_in_edges_tensor generation:  0.04191184043884277
mini_batch_src_global generation:  0.05110812187194824
r_  generation:  0.5336987972259521
----------------------check_connections_block total spend ----------------------------- 3.037597894668579
generate_one_block  0.628817081451416
generate_one_block  0.6324188709259033
generate_one_block  0.6240439414978027
generate_one_block  0.6274938583374023
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14716720581054688  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

connection checking time:  5.605590343475342
block generation total time  4.798188924789429
average batch blocks generation time:  1.1995472311973572
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10975217819213867  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.135232925415039  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10896921157836914  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.125462532043457  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10917949676513672  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.134049415588379  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10967540740966797  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1316165924072266  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07898151874542236 |0.015938639640808105 |0.003769993782043457 |9.804964065551758e-05 |0.019074857234954834 |0.001374959945678711 |
----------------------------------------------------------pseudo_mini_loss sum 1.796331763267517
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  1709835
Number of first layer input nodes during this epoch:  657988
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14906787872314453  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022402524948120117
random selection method range initialization spend 0.005352497100830078
time for parepare:  0.01762700080871582
local_output_nid generation:  0.008652687072753906
local_in_edges_tensor generation:  0.013550043106079102
mini_batch_src_global generation:  0.007971763610839844
r_  generation:  0.08991217613220215
local_output_nid generation:  0.011795997619628906
local_in_edges_tensor generation:  0.0062465667724609375
mini_batch_src_global generation:  0.010124444961547852
r_  generation:  0.09681272506713867
local_output_nid generation:  0.012495756149291992
local_in_edges_tensor generation:  0.008137226104736328
mini_batch_src_global generation:  0.007802724838256836
r_  generation:  0.10181546211242676
local_output_nid generation:  0.011864662170410156
local_in_edges_tensor generation:  0.006123542785644531
mini_batch_src_global generation:  0.009266376495361328
r_  generation:  0.10346293449401855
----------------------check_connections_block total spend ----------------------------- 0.6167595386505127
generate_one_block  0.11193609237670898
generate_one_block  0.11702752113342285
generate_one_block  0.11602401733398438
generate_one_block  0.11696076393127441
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04009103775024414
gen group dst list time:  0.011850595474243164
time for parepare:  0.0208280086517334
local_output_nid generation:  0.020864009857177734
local_in_edges_tensor generation:  0.044996023178100586
mini_batch_src_global generation:  0.04197525978088379
r_  generation:  0.4297337532043457
local_output_nid generation:  0.02907705307006836
local_in_edges_tensor generation:  0.03589010238647461
mini_batch_src_global generation:  0.049745798110961914
r_  generation:  0.43747425079345703
local_output_nid generation:  0.02807450294494629
local_in_edges_tensor generation:  0.030983686447143555
mini_batch_src_global generation:  0.04949188232421875
r_  generation:  0.4416337013244629
local_output_nid generation:  0.027509450912475586
local_in_edges_tensor generation:  0.027378320693969727
mini_batch_src_global generation:  0.050856828689575195
r_  generation:  0.44139814376831055
----------------------check_connections_block total spend ----------------------------- 2.5954830646514893
generate_one_block  0.5486776828765869
generate_one_block  0.5567116737365723
generate_one_block  0.5817556381225586
generate_one_block  0.5567271709442139
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028937101364135742
gen group dst list time:  0.02154254913330078
time for parepare:  0.01892995834350586
local_output_nid generation:  0.030649900436401367
local_in_edges_tensor generation:  0.04677152633666992
mini_batch_src_global generation:  0.047332048416137695
r_  generation:  0.49486231803894043
local_output_nid generation:  0.038245201110839844
local_in_edges_tensor generation:  0.04595518112182617
mini_batch_src_global generation:  0.0556950569152832
r_  generation:  0.5033755302429199
local_output_nid generation:  0.037216901779174805
local_in_edges_tensor generation:  0.039247751235961914
mini_batch_src_global generation:  0.053844451904296875
r_  generation:  0.505544900894165
local_output_nid generation:  0.03733181953430176
local_in_edges_tensor generation:  0.03426170349121094
mini_batch_src_global generation:  0.05194211006164551
r_  generation:  0.513481855392456
----------------------check_connections_block total spend ----------------------------- 2.9977049827575684
generate_one_block  0.6319854259490967
generate_one_block  0.6298356056213379
generate_one_block  0.631462574005127
generate_one_block  0.6255044937133789
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14906787872314453  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

connection checking time:  5.593188047409058
block generation total time  4.762660264968872
average batch blocks generation time:  1.190665066242218
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10982799530029297  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1269187927246094  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10927438735961914  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.130037784576416  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10973834991455078  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1343941688537598  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10926103591918945  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1340155601501465  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09362369775772095 |0.014720618724822998 |0.003648698329925537 |9.548664093017578e-05 |0.0037760138511657715 |0.0030677318572998047 |
----------------------------------------------------------pseudo_mini_loss sum 1.7093151807785034
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  1710512
Number of first layer input nodes during this epoch:  658154
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14688491821289062  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021894216537475586
random selection method range initialization spend 0.004938602447509766
time for parepare:  0.017472028732299805
local_output_nid generation:  0.00851297378540039
local_in_edges_tensor generation:  0.009255409240722656
mini_batch_src_global generation:  0.007982492446899414
r_  generation:  0.09069395065307617
local_output_nid generation:  0.01166534423828125
local_in_edges_tensor generation:  0.007404804229736328
mini_batch_src_global generation:  0.011575937271118164
r_  generation:  0.09838986396789551
local_output_nid generation:  0.011747598648071289
local_in_edges_tensor generation:  0.006179332733154297
mini_batch_src_global generation:  0.011269092559814453
r_  generation:  0.09931159019470215
local_output_nid generation:  0.011760950088500977
local_in_edges_tensor generation:  0.006301164627075195
mini_batch_src_global generation:  0.010084390640258789
r_  generation:  0.10741090774536133
----------------------check_connections_block total spend ----------------------------- 0.6199641227722168
generate_one_block  0.11629343032836914
generate_one_block  0.11846446990966797
generate_one_block  0.11713576316833496
generate_one_block  0.12034988403320312
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04456353187561035
gen group dst list time:  0.011884927749633789
time for parepare:  0.02132415771484375
local_output_nid generation:  0.02173018455505371
local_in_edges_tensor generation:  0.0422823429107666
mini_batch_src_global generation:  0.0424504280090332
r_  generation:  0.4239654541015625
local_output_nid generation:  0.03004622459411621
local_in_edges_tensor generation:  0.03571152687072754
mini_batch_src_global generation:  0.04967093467712402
r_  generation:  0.4350697994232178
local_output_nid generation:  0.027214765548706055
local_in_edges_tensor generation:  0.028479337692260742
mini_batch_src_global generation:  0.051389217376708984
r_  generation:  0.4420132637023926
local_output_nid generation:  0.027671098709106445
local_in_edges_tensor generation:  0.02765345573425293
mini_batch_src_global generation:  0.05225706100463867
r_  generation:  0.446094274520874
----------------------check_connections_block total spend ----------------------------- 2.608504056930542
generate_one_block  0.5594658851623535
generate_one_block  0.5537075996398926
generate_one_block  0.5728230476379395
generate_one_block  0.5583770275115967
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0361785888671875
gen group dst list time:  0.02185511589050293
time for parepare:  0.020694732666015625
local_output_nid generation:  0.030901193618774414
local_in_edges_tensor generation:  0.05570578575134277
mini_batch_src_global generation:  0.04551219940185547
r_  generation:  0.5129086971282959
local_output_nid generation:  0.040589332580566406
local_in_edges_tensor generation:  0.04613542556762695
mini_batch_src_global generation:  0.05626940727233887
r_  generation:  0.4996654987335205
local_output_nid generation:  0.03806781768798828
local_in_edges_tensor generation:  0.04238390922546387
mini_batch_src_global generation:  0.05653095245361328
r_  generation:  0.5007305145263672
local_output_nid generation:  0.038379669189453125
local_in_edges_tensor generation:  0.0394287109375
mini_batch_src_global generation:  0.051752328872680664
r_  generation:  0.5153896808624268
----------------------check_connections_block total spend ----------------------------- 3.034534215927124
generate_one_block  0.6306755542755127
generate_one_block  0.6350612640380859
generate_one_block  0.6534109115600586
generate_one_block  0.627009391784668
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14688491821289062  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

connection checking time:  5.643038272857666
block generation total time  4.790530681610107
average batch blocks generation time:  1.1976326704025269
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10921096801757812  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.130955696105957  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10967826843261719  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1312170028686523  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10992813110351562  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1310877799987793  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10921430587768555  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1288938522338867  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09180516004562378 |0.018829643726348877 |0.003707408905029297 |9.626150131225586e-05 |0.00389176607131958 |0.0018215179443359375 |
----------------------------------------------------------pseudo_mini_loss sum 1.6398472785949707
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  1710584
Number of first layer input nodes during this epoch:  658235
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14690113067626953  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02265644073486328
random selection method range initialization spend 0.005311727523803711
time for parepare:  0.017973899841308594
local_output_nid generation:  0.008604049682617188
local_in_edges_tensor generation:  0.014954805374145508
mini_batch_src_global generation:  0.007773637771606445
r_  generation:  0.09191226959228516
local_output_nid generation:  0.011732101440429688
local_in_edges_tensor generation:  0.007086038589477539
mini_batch_src_global generation:  0.012185811996459961
r_  generation:  0.09797883033752441
local_output_nid generation:  0.012456417083740234
local_in_edges_tensor generation:  0.006154775619506836
mini_batch_src_global generation:  0.00805044174194336
r_  generation:  0.10268425941467285
local_output_nid generation:  0.011986732482910156
local_in_edges_tensor generation:  0.0061185359954833984
mini_batch_src_global generation:  0.008595466613769531
r_  generation:  0.10847043991088867
----------------------check_connections_block total spend ----------------------------- 0.630317211151123
generate_one_block  0.11301183700561523
generate_one_block  0.11370301246643066
generate_one_block  0.11505651473999023
generate_one_block  0.11673712730407715
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03486061096191406
gen group dst list time:  0.011839628219604492
time for parepare:  0.0195159912109375
local_output_nid generation:  0.020715951919555664
local_in_edges_tensor generation:  0.0465388298034668
mini_batch_src_global generation:  0.042574167251586914
r_  generation:  0.4208052158355713
local_output_nid generation:  0.02715277671813965
local_in_edges_tensor generation:  0.03140854835510254
mini_batch_src_global generation:  0.049538373947143555
r_  generation:  0.43035411834716797
local_output_nid generation:  0.02624368667602539
local_in_edges_tensor generation:  0.027901887893676758
mini_batch_src_global generation:  0.049252986907958984
r_  generation:  0.4326162338256836
local_output_nid generation:  0.026657819747924805
local_in_edges_tensor generation:  0.030797243118286133
mini_batch_src_global generation:  0.050549983978271484
r_  generation:  0.43912768363952637
----------------------check_connections_block total spend ----------------------------- 2.553739309310913
generate_one_block  0.558591365814209
generate_one_block  0.548264741897583
generate_one_block  0.5728373527526855
generate_one_block  0.5524814128875732
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02870631217956543
gen group dst list time:  0.021608829498291016
time for parepare:  0.018867969512939453
local_output_nid generation:  0.029486417770385742
local_in_edges_tensor generation:  0.045835256576538086
mini_batch_src_global generation:  0.04694199562072754
r_  generation:  0.4894423484802246
local_output_nid generation:  0.03684067726135254
local_in_edges_tensor generation:  0.044220924377441406
mini_batch_src_global generation:  0.05540966987609863
r_  generation:  0.49577784538269043
local_output_nid generation:  0.036895036697387695
local_in_edges_tensor generation:  0.042525291442871094
mini_batch_src_global generation:  0.05441164970397949
r_  generation:  0.5022690296173096
local_output_nid generation:  0.0369412899017334
local_in_edges_tensor generation:  0.037981510162353516
mini_batch_src_global generation:  0.051535844802856445
r_  generation:  0.5094647407531738
----------------------check_connections_block total spend ----------------------------- 2.973337411880493
generate_one_block  0.6150667667388916
generate_one_block  0.621147632598877
generate_one_block  0.6289360523223877
generate_one_block  0.6265943050384521
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14690113067626953  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

connection checking time:  5.527076721191406
block generation total time  4.723919630050659
average batch blocks generation time:  1.1809799075126648
block dataloader generation time/epoch 12.173025846481323
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10923385620117188  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1347179412841797  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10963582992553711  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1305804252624512  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10991573333740234  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.133164405822754  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10928201675415039  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.134981632232666  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09016096591949463 |0.016461670398712158 |0.0035334229469299316 |9.60230827331543e-05 |0.0037821531295776367 |0.001813650131225586 |
----------------------------------------------------------pseudo_mini_loss sum 1.5878500938415527
Total (block generation + training)time/epoch 12.721890211105347
Training time/epoch 0.5486307144165039
Training time without block to device /epoch 0.4827840328216553
Training time without total dataloading part /epoch 0.03146004676818848
load block tensor time/epoch 0.3606438636779785
block to device time/epoch 0.06584668159484863
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  1711364
Number of first layer input nodes during this epoch:  658309
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14744091033935547  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02182936668395996
random selection method range initialization spend 0.00493311882019043
time for parepare:  0.01779770851135254
local_output_nid generation:  0.008713006973266602
local_in_edges_tensor generation:  0.008227348327636719
mini_batch_src_global generation:  0.007641315460205078
r_  generation:  0.08917570114135742
local_output_nid generation:  0.011714935302734375
local_in_edges_tensor generation:  0.006640195846557617
mini_batch_src_global generation:  0.009709596633911133
r_  generation:  0.09449362754821777
local_output_nid generation:  0.011766195297241211
local_in_edges_tensor generation:  0.00608372688293457
mini_batch_src_global generation:  0.0077588558197021484
r_  generation:  0.1016533374786377
local_output_nid generation:  0.011872291564941406
local_in_edges_tensor generation:  0.006102561950683594
mini_batch_src_global generation:  0.008905649185180664
r_  generation:  0.10413074493408203
----------------------check_connections_block total spend ----------------------------- 0.6053886413574219
generate_one_block  0.11335611343383789
generate_one_block  0.1128697395324707
generate_one_block  0.11560535430908203
generate_one_block  0.12050342559814453
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03628945350646973
gen group dst list time:  0.011585474014282227
time for parepare:  0.02060675621032715
local_output_nid generation:  0.021569013595581055
local_in_edges_tensor generation:  0.03398752212524414
mini_batch_src_global generation:  0.05037569999694824
r_  generation:  0.41813230514526367
local_output_nid generation:  0.02773880958557129
local_in_edges_tensor generation:  0.03761696815490723
mini_batch_src_global generation:  0.049729108810424805
r_  generation:  0.4254164695739746
local_output_nid generation:  0.026506900787353516
local_in_edges_tensor generation:  0.027127742767333984
mini_batch_src_global generation:  0.04935956001281738
r_  generation:  0.44047045707702637
local_output_nid generation:  0.026660919189453125
local_in_edges_tensor generation:  0.029041051864624023
mini_batch_src_global generation:  0.050374507904052734
r_  generation:  0.46125268936157227
----------------------check_connections_block total spend ----------------------------- 2.5790202617645264
generate_one_block  0.553809642791748
generate_one_block  0.5474894046783447
generate_one_block  0.5826010704040527
generate_one_block  0.5615229606628418
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029427766799926758
gen group dst list time:  0.02161407470703125
time for parepare:  0.01869034767150879
local_output_nid generation:  0.029411792755126953
local_in_edges_tensor generation:  0.04669523239135742
mini_batch_src_global generation:  0.04692530632019043
r_  generation:  0.49466633796691895
local_output_nid generation:  0.036966562271118164
local_in_edges_tensor generation:  0.04289412498474121
mini_batch_src_global generation:  0.055332183837890625
r_  generation:  0.4944424629211426
local_output_nid generation:  0.03742718696594238
local_in_edges_tensor generation:  0.036524295806884766
mini_batch_src_global generation:  0.0544285774230957
r_  generation:  0.5070757865905762
local_output_nid generation:  0.03935527801513672
local_in_edges_tensor generation:  0.04058337211608887
mini_batch_src_global generation:  0.05179095268249512
r_  generation:  0.5163519382476807
----------------------check_connections_block total spend ----------------------------- 2.9874520301818848
generate_one_block  0.6298563480377197
generate_one_block  0.6204469203948975
generate_one_block  0.61676025390625
generate_one_block  0.6319327354431152
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14744091033935547  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

connection checking time:  5.566472291946411
block generation total time  4.74441933631897
average batch blocks generation time:  1.1861048340797424
block dataloader generation time/epoch 12.192363739013672
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10972785949707031  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.134598731994629  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10964632034301758  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1255159378051758  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10931396484375  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1295390129089355  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.1097874641418457  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1369218826293945  GigaBytes
Max Memory Allocated: 1.3406243324279785  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09274256229400635 |0.013924121856689453 |0.003699004650115967 |9.357929229736328e-05 |0.003826737403869629 |0.0028672218322753906 |
----------------------------------------------------------pseudo_mini_loss sum 1.5498336553573608
Total (block generation + training)time/epoch 12.74176549911499
Training time/epoch 0.5497543811798096
Training time without block to device /epoch 0.49405789375305176
Training time without total dataloading part /epoch 0.03334450721740723
load block tensor time/epoch 0.3709702491760254
block to device time/epoch 0.05569648742675781
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  1710418
Number of first layer input nodes during this epoch:  658387
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.1491389274597168  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023052215576171875
random selection method range initialization spend 0.006197214126586914
time for parepare:  0.01915907859802246
local_output_nid generation:  0.008594989776611328
local_in_edges_tensor generation:  0.009072542190551758
mini_batch_src_global generation:  0.007871150970458984
r_  generation:  0.09076285362243652
local_output_nid generation:  0.011650800704956055
local_in_edges_tensor generation:  0.006371974945068359
mini_batch_src_global generation:  0.010061502456665039
r_  generation:  0.09917831420898438
local_output_nid generation:  0.011759519577026367
local_in_edges_tensor generation:  0.006285667419433594
mini_batch_src_global generation:  0.007831335067749023
r_  generation:  0.10349321365356445
local_output_nid generation:  0.011749505996704102
local_in_edges_tensor generation:  0.0062487125396728516
mini_batch_src_global generation:  0.00890350341796875
r_  generation:  0.10461020469665527
----------------------check_connections_block total spend ----------------------------- 0.6153218746185303
generate_one_block  0.11560869216918945
generate_one_block  0.1162564754486084
generate_one_block  0.11837220191955566
generate_one_block  0.12126016616821289
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0316166877746582
gen group dst list time:  0.012604951858520508
time for parepare:  0.02027440071105957
local_output_nid generation:  0.021793842315673828
local_in_edges_tensor generation:  0.03474283218383789
mini_batch_src_global generation:  0.04008173942565918
r_  generation:  0.430894136428833
local_output_nid generation:  0.02869391441345215
local_in_edges_tensor generation:  0.0401456356048584
mini_batch_src_global generation:  0.05164813995361328
r_  generation:  0.45595240592956543
local_output_nid generation:  0.029812335968017578
local_in_edges_tensor generation:  0.03371429443359375
mini_batch_src_global generation:  0.05123782157897949
r_  generation:  0.4428551197052002
local_output_nid generation:  0.027794361114501953
local_in_edges_tensor generation:  0.030680179595947266
mini_batch_src_global generation:  0.05045580863952637
r_  generation:  0.4400484561920166
----------------------check_connections_block total spend ----------------------------- 2.6277379989624023
generate_one_block  0.5608832836151123
generate_one_block  0.555607795715332
generate_one_block  0.5906598567962646
generate_one_block  0.5775530338287354
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03504037857055664
gen group dst list time:  0.022362709045410156
time for parepare:  0.01963353157043457
local_output_nid generation:  0.030969619750976562
local_in_edges_tensor generation:  0.056548357009887695
mini_batch_src_global generation:  0.047441959381103516
r_  generation:  0.49973058700561523
local_output_nid generation:  0.03884267807006836
local_in_edges_tensor generation:  0.04403519630432129
mini_batch_src_global generation:  0.057531118392944336
r_  generation:  0.5152082443237305
local_output_nid generation:  0.04017376899719238
local_in_edges_tensor generation:  0.051882266998291016
mini_batch_src_global generation:  0.056176185607910156
r_  generation:  0.5210180282592773
local_output_nid generation:  0.04162740707397461
local_in_edges_tensor generation:  0.04180908203125
mini_batch_src_global generation:  0.05145978927612305
r_  generation:  0.5195322036743164
----------------------check_connections_block total spend ----------------------------- 3.091683864593506
generate_one_block  0.6319332122802734
generate_one_block  0.6510164737701416
generate_one_block  0.6377029418945312
generate_one_block  0.6307177543640137
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.1491389274597168  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

connection checking time:  5.719421863555908
block generation total time  4.836074352264404
average batch blocks generation time:  1.209018588066101
block dataloader generation time/epoch 12.312987724939982
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.1100916862487793  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1334099769592285  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10908126831054688  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1251335144042969  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10935640335083008  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1350884437561035  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10975313186645508  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.136704444885254  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09327620267868042 |0.021133363246917725 |0.003730297088623047 |9.822845458984375e-05 |0.017114102840423584 |0.003091573715209961 |
----------------------------------------------------------pseudo_mini_loss sum 1.514094352722168
Total (block generation + training)time/epoch 12.872580925623575
Training time/epoch 0.5796904563903809
Training time without block to device /epoch 0.49515700340270996
Training time without total dataloading part /epoch 0.08686208724975586
load block tensor time/epoch 0.3731048107147217
block to device time/epoch 0.0845334529876709
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  1711071
Number of first layer input nodes during this epoch:  658465
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14881324768066406  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022874116897583008
random selection method range initialization spend 0.0048749446868896484
time for parepare:  0.01787257194519043
local_output_nid generation:  0.00885629653930664
local_in_edges_tensor generation:  0.01214599609375
mini_batch_src_global generation:  0.007664680480957031
r_  generation:  0.09268355369567871
local_output_nid generation:  0.011831283569335938
local_in_edges_tensor generation:  0.006623744964599609
mini_batch_src_global generation:  0.010215044021606445
r_  generation:  0.09887170791625977
local_output_nid generation:  0.011749505996704102
local_in_edges_tensor generation:  0.006467103958129883
mini_batch_src_global generation:  0.00831460952758789
r_  generation:  0.1016392707824707
local_output_nid generation:  0.011785507202148438
local_in_edges_tensor generation:  0.006159782409667969
mini_batch_src_global generation:  0.00872659683227539
r_  generation:  0.11377382278442383
----------------------check_connections_block total spend ----------------------------- 0.6308166980743408
generate_one_block  0.11249518394470215
generate_one_block  0.11649131774902344
generate_one_block  0.11840415000915527
generate_one_block  0.1167762279510498
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04236650466918945
gen group dst list time:  0.011754035949707031
time for parepare:  0.019617319107055664
local_output_nid generation:  0.02145528793334961
local_in_edges_tensor generation:  0.04360151290893555
mini_batch_src_global generation:  0.04171442985534668
r_  generation:  0.4217841625213623
local_output_nid generation:  0.028107166290283203
local_in_edges_tensor generation:  0.03194165229797363
mini_batch_src_global generation:  0.05000591278076172
r_  generation:  0.43419885635375977
local_output_nid generation:  0.026632070541381836
local_in_edges_tensor generation:  0.028863191604614258
mini_batch_src_global generation:  0.04917025566101074
r_  generation:  0.4392082691192627
local_output_nid generation:  0.02647089958190918
local_in_edges_tensor generation:  0.028962135314941406
mini_batch_src_global generation:  0.05061936378479004
r_  generation:  0.4411435127258301
----------------------check_connections_block total spend ----------------------------- 2.5676870346069336
generate_one_block  0.5558910369873047
generate_one_block  0.5536386966705322
generate_one_block  0.5747716426849365
generate_one_block  0.5573434829711914
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.033028602600097656
gen group dst list time:  0.021897554397583008
time for parepare:  0.018512964248657227
local_output_nid generation:  0.03005051612854004
local_in_edges_tensor generation:  0.04051542282104492
mini_batch_src_global generation:  0.04488635063171387
r_  generation:  0.49158644676208496
local_output_nid generation:  0.03754568099975586
local_in_edges_tensor generation:  0.0396115779876709
mini_batch_src_global generation:  0.05577707290649414
r_  generation:  0.49825215339660645
local_output_nid generation:  0.03767538070678711
local_in_edges_tensor generation:  0.03732776641845703
mini_batch_src_global generation:  0.05672097206115723
r_  generation:  0.5042495727539062
local_output_nid generation:  0.03757119178771973
local_in_edges_tensor generation:  0.03725242614746094
mini_batch_src_global generation:  0.051937103271484375
r_  generation:  0.5146269798278809
----------------------check_connections_block total spend ----------------------------- 2.9768009185791016
generate_one_block  0.6215057373046875
generate_one_block  0.6226272583007812
generate_one_block  0.6248135566711426
generate_one_block  0.6257236003875732
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14881324768066406  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

connection checking time:  5.544487953186035
block generation total time  4.736315011978149
average batch blocks generation time:  1.1840787529945374
block dataloader generation time/epoch 12.295741617679596
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10985612869262695  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1304049491882324  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10925674438476562  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1308832168579102  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10972452163696289  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1312546730041504  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10928535461425781  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1332707405090332  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09468483924865723 |0.014114618301391602 |0.00373917818069458 |9.542703628540039e-05 |0.003805994987487793 |0.0024874210357666016 |
----------------------------------------------------------pseudo_mini_loss sum 1.4842307567596436
Total (block generation + training)time/epoch 12.854659676551819
Training time/epoch 0.5566320419311523
Training time without block to device /epoch 0.5001735687255859
Training time without total dataloading part /epoch 0.033049821853637695
load block tensor time/epoch 0.3787393569946289
block to device time/epoch 0.056458473205566406
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  1711438
Number of first layer input nodes during this epoch:  658439
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14692258834838867  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01923656463623047
random selection method range initialization spend 0.004853248596191406
time for parepare:  0.019057512283325195
local_output_nid generation:  0.008589029312133789
local_in_edges_tensor generation:  0.008364200592041016
mini_batch_src_global generation:  0.007870912551879883
r_  generation:  0.09090447425842285
local_output_nid generation:  0.011797904968261719
local_in_edges_tensor generation:  0.006315469741821289
mini_batch_src_global generation:  0.010195493698120117
r_  generation:  0.1014413833618164
local_output_nid generation:  0.011834383010864258
local_in_edges_tensor generation:  0.006794452667236328
mini_batch_src_global generation:  0.010133504867553711
r_  generation:  0.10559272766113281
local_output_nid generation:  0.011961936950683594
local_in_edges_tensor generation:  0.006836891174316406
mini_batch_src_global generation:  0.009639978408813477
r_  generation:  0.10692262649536133
----------------------check_connections_block total spend ----------------------------- 0.6281430721282959
generate_one_block  0.11527109146118164
generate_one_block  0.11740899085998535
generate_one_block  0.11607837677001953
generate_one_block  0.12023663520812988
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.042818546295166016
gen group dst list time:  0.01181650161743164
time for parepare:  0.020171165466308594
local_output_nid generation:  0.021897315979003906
local_in_edges_tensor generation:  0.046286821365356445
mini_batch_src_global generation:  0.04034614562988281
r_  generation:  0.4421372413635254
local_output_nid generation:  0.03112030029296875
local_in_edges_tensor generation:  0.03802800178527832
mini_batch_src_global generation:  0.05053520202636719
r_  generation:  0.4346182346343994
local_output_nid generation:  0.027752161026000977
local_in_edges_tensor generation:  0.03148341178894043
mini_batch_src_global generation:  0.049257755279541016
r_  generation:  0.4368457794189453
local_output_nid generation:  0.02772665023803711
local_in_edges_tensor generation:  0.03038191795349121
mini_batch_src_global generation:  0.05086636543273926
r_  generation:  0.4415125846862793
----------------------check_connections_block total spend ----------------------------- 2.6073012351989746
generate_one_block  0.5591554641723633
generate_one_block  0.5654113292694092
generate_one_block  0.5764973163604736
generate_one_block  0.5671529769897461
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0314486026763916
gen group dst list time:  0.02291417121887207
time for parepare:  0.01946735382080078
local_output_nid generation:  0.03340554237365723
local_in_edges_tensor generation:  0.04956197738647461
mini_batch_src_global generation:  0.04707980155944824
r_  generation:  0.49623703956604004
local_output_nid generation:  0.03958392143249512
local_in_edges_tensor generation:  0.04907870292663574
mini_batch_src_global generation:  0.06259608268737793
r_  generation:  0.5040924549102783
local_output_nid generation:  0.037560224533081055
local_in_edges_tensor generation:  0.04067659378051758
mini_batch_src_global generation:  0.05681920051574707
r_  generation:  0.5175831317901611
local_output_nid generation:  0.040590763092041016
local_in_edges_tensor generation:  0.039736270904541016
mini_batch_src_global generation:  0.05343747138977051
r_  generation:  0.5140271186828613
----------------------check_connections_block total spend ----------------------------- 3.0609989166259766
generate_one_block  0.6252365112304688
generate_one_block  0.6323971748352051
generate_one_block  0.6250302791595459
generate_one_block  0.630570650100708
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14692258834838867  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

connection checking time:  5.668300151824951
block generation total time  4.78145170211792
average batch blocks generation time:  1.19536292552948
block dataloader generation time/epoch 12.310768222808838
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10915756225585938  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1285896301269531  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10932493209838867  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1345901489257812  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10962963104248047  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1278042793273926  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10993242263793945  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1344718933105469  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09293884038925171 |0.018924832344055176 |0.0037449002265930176 |9.918212890625e-05 |0.003838956356048584 |0.0017752647399902344 |
----------------------------------------------------------pseudo_mini_loss sum 1.4562044143676758
Total (block generation + training)time/epoch 12.87203631401062
Training time/epoch 0.5703141689300537
Training time without block to device /epoch 0.494614839553833
Training time without total dataloading part /epoch 0.03250741958618164
load block tensor time/epoch 0.37175536155700684
block to device time/epoch 0.0756993293762207
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  1710540
Number of first layer input nodes during this epoch:  658441
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14769887924194336  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022713422775268555
random selection method range initialization spend 0.00488734245300293
time for parepare:  0.017643451690673828
local_output_nid generation:  0.008713960647583008
local_in_edges_tensor generation:  0.011526107788085938
mini_batch_src_global generation:  0.008217573165893555
r_  generation:  0.09055399894714355
local_output_nid generation:  0.013636112213134766
local_in_edges_tensor generation:  0.0068721771240234375
mini_batch_src_global generation:  0.010071516036987305
r_  generation:  0.10006880760192871
local_output_nid generation:  0.011798620223999023
local_in_edges_tensor generation:  0.006557464599609375
mini_batch_src_global generation:  0.007941246032714844
r_  generation:  0.1048123836517334
local_output_nid generation:  0.012383460998535156
local_in_edges_tensor generation:  0.006055116653442383
mini_batch_src_global generation:  0.008735895156860352
r_  generation:  0.10296964645385742
----------------------check_connections_block total spend ----------------------------- 0.6259405612945557
generate_one_block  0.11255550384521484
generate_one_block  0.11899614334106445
generate_one_block  0.12262964248657227
generate_one_block  0.11934351921081543
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03996777534484863
gen group dst list time:  0.01168060302734375
time for parepare:  0.019963979721069336
local_output_nid generation:  0.021093368530273438
local_in_edges_tensor generation:  0.04247903823852539
mini_batch_src_global generation:  0.04271888732910156
r_  generation:  0.4224889278411865
local_output_nid generation:  0.027976036071777344
local_in_edges_tensor generation:  0.035312652587890625
mini_batch_src_global generation:  0.05577540397644043
r_  generation:  0.4324514865875244
local_output_nid generation:  0.026679039001464844
local_in_edges_tensor generation:  0.03158760070800781
mini_batch_src_global generation:  0.05000782012939453
r_  generation:  0.437664270401001
local_output_nid generation:  0.026613950729370117
local_in_edges_tensor generation:  0.02761673927307129
mini_batch_src_global generation:  0.050240278244018555
r_  generation:  0.43663787841796875
----------------------check_connections_block total spend ----------------------------- 2.571495532989502
generate_one_block  0.553241491317749
generate_one_block  0.565809965133667
generate_one_block  0.6051466464996338
generate_one_block  0.5707340240478516
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03669548034667969
gen group dst list time:  0.02296924591064453
time for parepare:  0.01933121681213379
local_output_nid generation:  0.030290842056274414
local_in_edges_tensor generation:  0.045742034912109375
mini_batch_src_global generation:  0.045538902282714844
r_  generation:  0.5127625465393066
local_output_nid generation:  0.041678667068481445
local_in_edges_tensor generation:  0.045800209045410156
mini_batch_src_global generation:  0.06017494201660156
r_  generation:  0.5065553188323975
local_output_nid generation:  0.03905963897705078
local_in_edges_tensor generation:  0.040876150131225586
mini_batch_src_global generation:  0.05733680725097656
r_  generation:  0.5042896270751953
local_output_nid generation:  0.03838062286376953
local_in_edges_tensor generation:  0.04204392433166504
mini_batch_src_global generation:  0.051542043685913086
r_  generation:  0.5133965015411377
----------------------check_connections_block total spend ----------------------------- 3.0414628982543945
generate_one_block  0.6221957206726074
generate_one_block  0.6261215209960938
generate_one_block  0.6501479148864746
generate_one_block  0.628911018371582
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14769887924194336  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

connection checking time:  5.6129584312438965
block generation total time  4.822308301925659
average batch blocks generation time:  1.2055770754814148
block dataloader generation time/epoch 12.326276938120523
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10913228988647461  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.127955436706543  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10927772521972656  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1338391304016113  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.1097407341003418  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1345648765563965  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10919046401977539  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1304616928100586  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09502482414245605 |0.018825769424438477 |0.0037175416946411133 |9.632110595703125e-05 |0.0038494467735290527 |0.0014917850494384766 |
----------------------------------------------------------pseudo_mini_loss sum 1.4305440187454224
Total (block generation + training)time/epoch 12.890998760859171
Training time/epoch 0.5817227363586426
Training time without block to device /epoch 0.5064196586608887
Training time without total dataloading part /epoch 0.032145023345947266
load block tensor time/epoch 0.3800992965698242
block to device time/epoch 0.0753030776977539
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  1711218
Number of first layer input nodes during this epoch:  658349
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14678716659545898  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025279998779296875
random selection method range initialization spend 0.00490570068359375
time for parepare:  0.017945528030395508
local_output_nid generation:  0.008875846862792969
local_in_edges_tensor generation:  0.012772083282470703
mini_batch_src_global generation:  0.007840633392333984
r_  generation:  0.09051203727722168
local_output_nid generation:  0.011828184127807617
local_in_edges_tensor generation:  0.006345510482788086
mini_batch_src_global generation:  0.010095357894897461
r_  generation:  0.10033082962036133
local_output_nid generation:  0.01183009147644043
local_in_edges_tensor generation:  0.00629878044128418
mini_batch_src_global generation:  0.007913589477539062
r_  generation:  0.10085487365722656
local_output_nid generation:  0.011967658996582031
local_in_edges_tensor generation:  0.0066187381744384766
mini_batch_src_global generation:  0.00867605209350586
r_  generation:  0.10517096519470215
----------------------check_connections_block total spend ----------------------------- 0.6215212345123291
generate_one_block  0.11259198188781738
generate_one_block  0.11572647094726562
generate_one_block  0.11565446853637695
generate_one_block  0.11872005462646484
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0400998592376709
gen group dst list time:  0.011872529983520508
time for parepare:  0.019399642944335938
local_output_nid generation:  0.02147960662841797
local_in_edges_tensor generation:  0.04912853240966797
mini_batch_src_global generation:  0.04422879219055176
r_  generation:  0.41980671882629395
local_output_nid generation:  0.027770042419433594
local_in_edges_tensor generation:  0.032885074615478516
mini_batch_src_global generation:  0.05003952980041504
r_  generation:  0.43503260612487793
local_output_nid generation:  0.02676534652709961
local_in_edges_tensor generation:  0.026676654815673828
mini_batch_src_global generation:  0.05001473426818848
r_  generation:  0.43851232528686523
local_output_nid generation:  0.027014970779418945
local_in_edges_tensor generation:  0.030960798263549805
mini_batch_src_global generation:  0.050481319427490234
r_  generation:  0.4659848213195801
----------------------check_connections_block total spend ----------------------------- 2.6023108959198
generate_one_block  0.5628566741943359
generate_one_block  0.5564095973968506
generate_one_block  0.584186315536499
generate_one_block  0.5600402355194092
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03360128402709961
gen group dst list time:  0.02213263511657715
time for parepare:  0.01915740966796875
local_output_nid generation:  0.03041815757751465
local_in_edges_tensor generation:  0.04522252082824707
mini_batch_src_global generation:  0.045665740966796875
r_  generation:  0.4902658462524414
local_output_nid generation:  0.03750300407409668
local_in_edges_tensor generation:  0.04341864585876465
mini_batch_src_global generation:  0.07114958763122559
r_  generation:  0.5007412433624268
local_output_nid generation:  0.037633657455444336
local_in_edges_tensor generation:  0.03473687171936035
mini_batch_src_global generation:  0.05429410934448242
r_  generation:  0.5079195499420166
local_output_nid generation:  0.037506103515625
local_in_edges_tensor generation:  0.03931403160095215
mini_batch_src_global generation:  0.05445528030395508
r_  generation:  0.5138945579528809
----------------------check_connections_block total spend ----------------------------- 3.0044424533843994
generate_one_block  0.6270782947540283
generate_one_block  0.6305480003356934
generate_one_block  0.626692533493042
generate_one_block  0.6374046802520752
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14678716659545898  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

connection checking time:  5.606753349304199
block generation total time  4.785216331481934
average batch blocks generation time:  1.1963040828704834
block dataloader generation time/epoch 12.326412882123675
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10921812057495117  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1347694396972656  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10972833633422852  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1322760581970215  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10979795455932617  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1266636848449707  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10930442810058594  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1338725090026855  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08602368831634521 |0.013640820980072021 |0.003461599349975586 |9.5367431640625e-05 |0.003778219223022461 |0.0016367435455322266 |
----------------------------------------------------------pseudo_mini_loss sum 1.3923542499542236
Total (block generation + training)time/epoch 12.884592635290963
Training time/epoch 0.5186636447906494
Training time without block to device /epoch 0.46410036087036133
Training time without total dataloading part /epoch 0.030977487564086914
load block tensor time/epoch 0.34409475326538086
block to device time/epoch 0.054563283920288086
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  1710459
Number of first layer input nodes during this epoch:  658282
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14737272262573242  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020858287811279297
random selection method range initialization spend 0.006142139434814453
time for parepare:  0.01773834228515625
local_output_nid generation:  0.008603096008300781
local_in_edges_tensor generation:  0.008237838745117188
mini_batch_src_global generation:  0.007854938507080078
r_  generation:  0.09059691429138184
local_output_nid generation:  0.011853694915771484
local_in_edges_tensor generation:  0.00622248649597168
mini_batch_src_global generation:  0.013067483901977539
r_  generation:  0.09758901596069336
local_output_nid generation:  0.011827468872070312
local_in_edges_tensor generation:  0.00615239143371582
mini_batch_src_global generation:  0.010001659393310547
r_  generation:  0.1002805233001709
local_output_nid generation:  0.01182866096496582
local_in_edges_tensor generation:  0.006203413009643555
mini_batch_src_global generation:  0.008759021759033203
r_  generation:  0.10234379768371582
----------------------check_connections_block total spend ----------------------------- 0.6109707355499268
generate_one_block  0.11202788352966309
generate_one_block  0.11464428901672363
generate_one_block  0.11592245101928711
generate_one_block  0.11478948593139648
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03263545036315918
gen group dst list time:  0.011635541915893555
time for parepare:  0.01934218406677246
local_output_nid generation:  0.02174973487854004
local_in_edges_tensor generation:  0.031932830810546875
mini_batch_src_global generation:  0.04183220863342285
r_  generation:  0.41797924041748047
local_output_nid generation:  0.02845168113708496
local_in_edges_tensor generation:  0.030846357345581055
mini_batch_src_global generation:  0.04963350296020508
r_  generation:  0.4312326908111572
local_output_nid generation:  0.027382373809814453
local_in_edges_tensor generation:  0.027275800704956055
mini_batch_src_global generation:  0.05021309852600098
r_  generation:  0.4442455768585205
local_output_nid generation:  0.027252912521362305
local_in_edges_tensor generation:  0.026660442352294922
mini_batch_src_global generation:  0.05149555206298828
r_  generation:  0.43846631050109863
----------------------check_connections_block total spend ----------------------------- 2.5489840507507324
generate_one_block  0.5527560710906982
generate_one_block  0.5498120784759521
generate_one_block  0.5869665145874023
generate_one_block  0.5623073577880859
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.032491445541381836
gen group dst list time:  0.022145748138427734
time for parepare:  0.01881861686706543
local_output_nid generation:  0.030215740203857422
local_in_edges_tensor generation:  0.04860401153564453
mini_batch_src_global generation:  0.04802250862121582
r_  generation:  0.49379587173461914
local_output_nid generation:  0.03833317756652832
local_in_edges_tensor generation:  0.04258131980895996
mini_batch_src_global generation:  0.055838584899902344
r_  generation:  0.5110797882080078
local_output_nid generation:  0.03679943084716797
local_in_edges_tensor generation:  0.03423714637756348
mini_batch_src_global generation:  0.055339813232421875
r_  generation:  0.5024306774139404
local_output_nid generation:  0.04202079772949219
local_in_edges_tensor generation:  0.036249399185180664
mini_batch_src_global generation:  0.06287693977355957
r_  generation:  0.5126996040344238
----------------------check_connections_block total spend ----------------------------- 3.0105905532836914
generate_one_block  0.6242547035217285
generate_one_block  0.6301908493041992
generate_one_block  0.623762845993042
generate_one_block  0.6289479732513428
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14737272262573242  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

connection checking time:  5.559574604034424
block generation total time  4.758998394012451
average batch blocks generation time:  1.1897495985031128
block dataloader generation time/epoch 12.314646303653717
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10965585708618164  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1343016624450684  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10924673080444336  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1301312446594238  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10924291610717773  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1334285736083984  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.1096487045288086  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.131462574005127  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09443402290344238 |0.01701056957244873 |0.0043354034423828125 |0.00011968612670898438 |0.0036823153495788574 |0.0031621456146240234 |
----------------------------------------------------------pseudo_mini_loss sum 1.3738813400268555
Total (block generation + training)time/epoch 12.874428391456604
Training time/epoch 0.5707709789276123
Training time without block to device /epoch 0.5027287006378174
Training time without total dataloading part /epoch 0.03571176528930664
load block tensor time/epoch 0.37773609161376953
block to device time/epoch 0.06804227828979492
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  1710709
Number of first layer input nodes during this epoch:  658170
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14897966384887695  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02232050895690918
random selection method range initialization spend 0.004851341247558594
time for parepare:  0.017506122589111328
local_output_nid generation:  0.009088754653930664
local_in_edges_tensor generation:  0.009882926940917969
mini_batch_src_global generation:  0.007913351058959961
r_  generation:  0.09095311164855957
local_output_nid generation:  0.01169276237487793
local_in_edges_tensor generation:  0.006357669830322266
mini_batch_src_global generation:  0.010058879852294922
r_  generation:  0.09794044494628906
local_output_nid generation:  0.011768579483032227
local_in_edges_tensor generation:  0.0060901641845703125
mini_batch_src_global generation:  0.0077860355377197266
r_  generation:  0.1012270450592041
local_output_nid generation:  0.01183009147644043
local_in_edges_tensor generation:  0.006197929382324219
mini_batch_src_global generation:  0.008666753768920898
r_  generation:  0.10471343994140625
----------------------check_connections_block total spend ----------------------------- 0.612257719039917
generate_one_block  0.11731600761413574
generate_one_block  0.11515522003173828
generate_one_block  0.11528968811035156
generate_one_block  0.1158909797668457
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03260064125061035
gen group dst list time:  0.014015436172485352
time for parepare:  0.019176483154296875
local_output_nid generation:  0.021425247192382812
local_in_edges_tensor generation:  0.03705286979675293
mini_batch_src_global generation:  0.042962074279785156
r_  generation:  0.43443942070007324
local_output_nid generation:  0.02806234359741211
local_in_edges_tensor generation:  0.027222156524658203
mini_batch_src_global generation:  0.05230307579040527
r_  generation:  0.4461250305175781
local_output_nid generation:  0.02741527557373047
local_in_edges_tensor generation:  0.034726619720458984
mini_batch_src_global generation:  0.06026053428649902
r_  generation:  0.469775915145874
local_output_nid generation:  0.027853012084960938
local_in_edges_tensor generation:  0.03805732727050781
mini_batch_src_global generation:  0.05318307876586914
r_  generation:  0.44188880920410156
----------------------check_connections_block total spend ----------------------------- 2.6544032096862793
generate_one_block  0.5651657581329346
generate_one_block  0.5772185325622559
generate_one_block  0.5876822471618652
generate_one_block  0.5581521987915039
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029875755310058594
gen group dst list time:  0.022292375564575195
time for parepare:  0.018817424774169922
local_output_nid generation:  0.030504226684570312
local_in_edges_tensor generation:  0.06275296211242676
mini_batch_src_global generation:  0.04885721206665039
r_  generation:  0.5106260776519775
local_output_nid generation:  0.037883758544921875
local_in_edges_tensor generation:  0.04257392883300781
mini_batch_src_global generation:  0.05830860137939453
r_  generation:  0.5068359375
local_output_nid generation:  0.03912210464477539
local_in_edges_tensor generation:  0.04085111618041992
mini_batch_src_global generation:  0.05633735656738281
r_  generation:  0.5116465091705322
local_output_nid generation:  0.03866100311279297
local_in_edges_tensor generation:  0.05537891387939453
mini_batch_src_global generation:  0.0707857608795166
r_  generation:  0.5148780345916748
----------------------check_connections_block total spend ----------------------------- 3.099332332611084
generate_one_block  0.6281497478485107
generate_one_block  0.6413626670837402
generate_one_block  0.6307687759399414
generate_one_block  0.6446466445922852
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14897966384887695  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

connection checking time:  5.753735542297363
block generation total time  4.833146572113037
average batch blocks generation time:  1.2082866430282593
block dataloader generation time/epoch 12.33477791150411
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.11002159118652344  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1338386535644531  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10916423797607422  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.130232810974121  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10918188095092773  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1299476623535156  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10915946960449219  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1273202896118164  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0884711742401123 |0.019501328468322754 |0.009716033935546875 |9.799003601074219e-05 |0.003843545913696289 |0.0030889511108398438 |
----------------------------------------------------------pseudo_mini_loss sum 1.3542802333831787
Total (block generation + training)time/epoch 12.896608670552572
Training time/epoch 0.5779557228088379
Training time without block to device /epoch 0.4999504089355469
Training time without total dataloading part /epoch 0.05771923065185547
load block tensor time/epoch 0.3538846969604492
block to device time/epoch 0.07800531387329102
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  1710517
Number of first layer input nodes during this epoch:  658083
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.1472487449645996  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025599956512451172
random selection method range initialization spend 0.0048105716705322266
time for parepare:  0.01752495765686035
local_output_nid generation:  0.00874018669128418
local_in_edges_tensor generation:  0.009461641311645508
mini_batch_src_global generation:  0.007768869400024414
r_  generation:  0.09393000602722168
local_output_nid generation:  0.013667821884155273
local_in_edges_tensor generation:  0.008616447448730469
mini_batch_src_global generation:  0.011409282684326172
r_  generation:  0.10149383544921875
local_output_nid generation:  0.011972665786743164
local_in_edges_tensor generation:  0.006405830383300781
mini_batch_src_global generation:  0.008222341537475586
r_  generation:  0.102081298828125
local_output_nid generation:  0.011941909790039062
local_in_edges_tensor generation:  0.006330013275146484
mini_batch_src_global generation:  0.008855819702148438
r_  generation:  0.10454034805297852
----------------------check_connections_block total spend ----------------------------- 0.6318178176879883
generate_one_block  0.11296534538269043
generate_one_block  0.1157071590423584
generate_one_block  0.11651611328125
generate_one_block  0.11638498306274414
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.034629106521606445
gen group dst list time:  0.011659860610961914
time for parepare:  0.019136667251586914
local_output_nid generation:  0.02166128158569336
local_in_edges_tensor generation:  0.04070639610290527
mini_batch_src_global generation:  0.04028892517089844
r_  generation:  0.41851139068603516
local_output_nid generation:  0.028849363327026367
local_in_edges_tensor generation:  0.033995866775512695
mini_batch_src_global generation:  0.04992175102233887
r_  generation:  0.4388604164123535
local_output_nid generation:  0.026970386505126953
local_in_edges_tensor generation:  0.03302931785583496
mini_batch_src_global generation:  0.04985618591308594
r_  generation:  0.4416768550872803
local_output_nid generation:  0.02706122398376465
local_in_edges_tensor generation:  0.02657151222229004
mini_batch_src_global generation:  0.05024266242980957
r_  generation:  0.4491567611694336
----------------------check_connections_block total spend ----------------------------- 2.589240074157715
generate_one_block  0.5612282752990723
generate_one_block  0.5601396560668945
generate_one_block  0.5906102657318115
generate_one_block  0.5630960464477539
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.038460731506347656
gen group dst list time:  0.022043943405151367
time for parepare:  0.020148277282714844
local_output_nid generation:  0.03262448310852051
local_in_edges_tensor generation:  0.045095205307006836
mini_batch_src_global generation:  0.04526972770690918
r_  generation:  0.515493631362915
local_output_nid generation:  0.042046546936035156
local_in_edges_tensor generation:  0.046053409576416016
mini_batch_src_global generation:  0.05864381790161133
r_  generation:  0.5038034915924072
local_output_nid generation:  0.038761138916015625
local_in_edges_tensor generation:  0.03889608383178711
mini_batch_src_global generation:  0.05717062950134277
r_  generation:  0.5083675384521484
local_output_nid generation:  0.038956642150878906
local_in_edges_tensor generation:  0.03603386878967285
mini_batch_src_global generation:  0.05189776420593262
r_  generation:  0.511570930480957
----------------------check_connections_block total spend ----------------------------- 3.044085741043091
generate_one_block  0.6251966953277588
generate_one_block  0.6354608535766602
generate_one_block  0.6461350917816162
generate_one_block  0.6298823356628418
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.1472487449645996  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

connection checking time:  5.633325815200806
block generation total time  4.811749219894409
average batch blocks generation time:  1.2029373049736023
block dataloader generation time/epoch 12.342588901519775
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10964202880859375  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1312732696533203  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10926485061645508  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1300640106201172  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10918807983398438  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1339921951293945  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10915327072143555  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1295785903930664  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09331440925598145 |0.018727660179138184 |0.003685176372528076 |9.745359420776367e-05 |0.003606259822845459 |0.003031015396118164 |
----------------------------------------------------------pseudo_mini_loss sum 1.3418151140213013
Total (block generation + training)time/epoch 12.905321192741393
Training time/epoch 0.5705587863922119
Training time without block to device /epoch 0.4956481456756592
Training time without total dataloading part /epoch 0.03258657455444336
load block tensor time/epoch 0.3732576370239258
block to device time/epoch 0.07491064071655273
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  1711039
Number of first layer input nodes during this epoch:  658217
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14688396453857422  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021058320999145508
random selection method range initialization spend 0.005066394805908203
time for parepare:  0.017955303192138672
local_output_nid generation:  0.008752584457397461
local_in_edges_tensor generation:  0.009810686111450195
mini_batch_src_global generation:  0.008249759674072266
r_  generation:  0.0907297134399414
local_output_nid generation:  0.011780977249145508
local_in_edges_tensor generation:  0.006317138671875
mini_batch_src_global generation:  0.010336637496948242
r_  generation:  0.09770798683166504
local_output_nid generation:  0.011750459671020508
local_in_edges_tensor generation:  0.0060825347900390625
mini_batch_src_global generation:  0.007809162139892578
r_  generation:  0.09972000122070312
local_output_nid generation:  0.011890172958374023
local_in_edges_tensor generation:  0.008685827255249023
mini_batch_src_global generation:  0.008666038513183594
r_  generation:  0.10222864151000977
----------------------check_connections_block total spend ----------------------------- 0.6145617961883545
generate_one_block  0.11475920677185059
generate_one_block  0.11763262748718262
generate_one_block  0.11774063110351562
generate_one_block  0.11576366424560547
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03609347343444824
gen group dst list time:  0.013226747512817383
time for parepare:  0.019594669342041016
local_output_nid generation:  0.021809816360473633
local_in_edges_tensor generation:  0.04154658317565918
mini_batch_src_global generation:  0.04225873947143555
r_  generation:  0.431934118270874
local_output_nid generation:  0.028142452239990234
local_in_edges_tensor generation:  0.03452181816101074
mini_batch_src_global generation:  0.05053877830505371
r_  generation:  0.4401133060455322
local_output_nid generation:  0.027099132537841797
local_in_edges_tensor generation:  0.030199766159057617
mini_batch_src_global generation:  0.04961585998535156
r_  generation:  0.4434995651245117
local_output_nid generation:  0.02651691436767578
local_in_edges_tensor generation:  0.028485774993896484
mini_batch_src_global generation:  0.05079483985900879
r_  generation:  0.44522714614868164
----------------------check_connections_block total spend ----------------------------- 2.6052405834198
generate_one_block  0.5592837333679199
generate_one_block  0.559689998626709
generate_one_block  0.5752770900726318
generate_one_block  0.5567305088043213
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0339665412902832
gen group dst list time:  0.02206277847290039
time for parepare:  0.01864027976989746
local_output_nid generation:  0.029895305633544922
local_in_edges_tensor generation:  0.04906320571899414
mini_batch_src_global generation:  0.04571247100830078
r_  generation:  0.4982938766479492
local_output_nid generation:  0.03670096397399902
local_in_edges_tensor generation:  0.04489612579345703
mini_batch_src_global generation:  0.05529475212097168
r_  generation:  0.5124070644378662
local_output_nid generation:  0.03687858581542969
local_in_edges_tensor generation:  0.04027223587036133
mini_batch_src_global generation:  0.05418682098388672
r_  generation:  0.5204269886016846
local_output_nid generation:  0.037035465240478516
local_in_edges_tensor generation:  0.03692507743835449
mini_batch_src_global generation:  0.052191972732543945
r_  generation:  0.519942045211792
----------------------check_connections_block total spend ----------------------------- 3.031395673751831
generate_one_block  0.626319169998169
generate_one_block  0.6288840770721436
generate_one_block  0.6350865364074707
generate_one_block  0.6401617527008057
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14688396453857422  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

connection checking time:  5.636636257171631
block generation total time  4.781432867050171
average batch blocks generation time:  1.1953582167625427
block dataloader generation time/epoch 12.343068014491688
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10925483703613281  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1340513229370117  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10975456237792969  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1361780166625977  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10990047454833984  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1282916069030762  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10921001434326172  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.130760669708252  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09385401010513306 |0.01440364122390747 |0.003709733486175537 |9.769201278686523e-05 |0.003857553005218506 |0.0019245147705078125 |
----------------------------------------------------------pseudo_mini_loss sum 1.3307902812957764
Total (block generation + training)time/epoch 12.90529634735801
Training time/epoch 0.5569262504577637
Training time without block to device /epoch 0.4993116855621338
Training time without total dataloading part /epoch 0.032584428787231445
load block tensor time/epoch 0.3754160404205322
block to device time/epoch 0.05761456489562988
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 20 |
Number of nodes for computation during this epoch:  1710810
Number of first layer input nodes during this epoch:  658240
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14719152450561523  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02026844024658203
random selection method range initialization spend 0.004854917526245117
time for parepare:  0.017498254776000977
local_output_nid generation:  0.009245157241821289
local_in_edges_tensor generation:  0.008372783660888672
mini_batch_src_global generation:  0.00773930549621582
r_  generation:  0.09226250648498535
local_output_nid generation:  0.011717081069946289
local_in_edges_tensor generation:  0.006198406219482422
mini_batch_src_global generation:  0.009942293167114258
r_  generation:  0.09909415245056152
local_output_nid generation:  0.011790990829467773
local_in_edges_tensor generation:  0.006037235260009766
mini_batch_src_global generation:  0.007974386215209961
r_  generation:  0.10289335250854492
local_output_nid generation:  0.01169896125793457
local_in_edges_tensor generation:  0.006173849105834961
mini_batch_src_global generation:  0.008770942687988281
r_  generation:  0.10415506362915039
----------------------check_connections_block total spend ----------------------------- 0.61411452293396
generate_one_block  0.11283159255981445
generate_one_block  0.11446785926818848
generate_one_block  0.12085914611816406
generate_one_block  0.11616230010986328
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030501604080200195
gen group dst list time:  0.011734724044799805
time for parepare:  0.01963186264038086
local_output_nid generation:  0.021285533905029297
local_in_edges_tensor generation:  0.03593277931213379
mini_batch_src_global generation:  0.04021811485290527
r_  generation:  0.4257218837738037
local_output_nid generation:  0.027938127517700195
local_in_edges_tensor generation:  0.02875351905822754
mini_batch_src_global generation:  0.049654483795166016
r_  generation:  0.43151140213012695
local_output_nid generation:  0.02753591537475586
local_in_edges_tensor generation:  0.026665925979614258
mini_batch_src_global generation:  0.0503993034362793
r_  generation:  0.44404006004333496
local_output_nid generation:  0.026622295379638672
local_in_edges_tensor generation:  0.028680086135864258
mini_batch_src_global generation:  0.05025887489318848
r_  generation:  0.44222307205200195
----------------------check_connections_block total spend ----------------------------- 2.5648772716522217
generate_one_block  0.5561079978942871
generate_one_block  0.5557084083557129
generate_one_block  0.5906236171722412
generate_one_block  0.5647034645080566
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03372812271118164
gen group dst list time:  0.022023439407348633
time for parepare:  0.020504236221313477
local_output_nid generation:  0.02960944175720215
local_in_edges_tensor generation:  0.04528975486755371
mini_batch_src_global generation:  0.04506874084472656
r_  generation:  0.5016586780548096
local_output_nid generation:  0.03692340850830078
local_in_edges_tensor generation:  0.04028487205505371
mini_batch_src_global generation:  0.05689835548400879
r_  generation:  0.5068914890289307
local_output_nid generation:  0.03733253479003906
local_in_edges_tensor generation:  0.04196977615356445
mini_batch_src_global generation:  0.05786871910095215
r_  generation:  0.5228333473205566
local_output_nid generation:  0.040494680404663086
local_in_edges_tensor generation:  0.034433603286743164
mini_batch_src_global generation:  0.05842185020446777
r_  generation:  0.5185997486114502
----------------------check_connections_block total spend ----------------------------- 3.0400784015655518
generate_one_block  0.6275475025177002
generate_one_block  0.6278393268585205
generate_one_block  0.6323614120483398
generate_one_block  0.6304008960723877
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14719152450561523  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

connection checking time:  5.604955673217773
block generation total time  4.785292625427246
average batch blocks generation time:  1.1963231563568115
block dataloader generation time/epoch 12.338071604569754
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10971593856811523  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1343164443969727  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10987567901611328  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1291861534118652  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10941076278686523  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1353092193603516  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10964536666870117  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.129347324371338  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0886184573173523 |0.016564488410949707 |0.0036936402320861816 |9.328126907348633e-05 |0.0035977959632873535 |0.002959012985229492 |
----------------------------------------------------------pseudo_mini_loss sum 1.3088877201080322
Total (block generation + training)time/epoch 12.8985808690389
Training time/epoch 0.5413904190063477
Training time without block to device /epoch 0.47513246536254883
Training time without total dataloading part /epoch 0.03249788284301758
load block tensor time/epoch 0.3544738292694092
block to device time/epoch 0.06625795364379883
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 21 |
Number of nodes for computation during this epoch:  1710562
Number of first layer input nodes during this epoch:  658418
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.1487884521484375  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020047903060913086
random selection method range initialization spend 0.005115032196044922
time for parepare:  0.01952195167541504
local_output_nid generation:  0.008912324905395508
local_in_edges_tensor generation:  0.009608983993530273
mini_batch_src_global generation:  0.00782322883605957
r_  generation:  0.09076333045959473
local_output_nid generation:  0.011926889419555664
local_in_edges_tensor generation:  0.0063533782958984375
mini_batch_src_global generation:  0.01001119613647461
r_  generation:  0.09833073616027832
local_output_nid generation:  0.011951923370361328
local_in_edges_tensor generation:  0.006348848342895508
mini_batch_src_global generation:  0.008313417434692383
r_  generation:  0.10000753402709961
local_output_nid generation:  0.011914491653442383
local_in_edges_tensor generation:  0.006578207015991211
mini_batch_src_global generation:  0.008617877960205078
r_  generation:  0.10555076599121094
----------------------check_connections_block total spend ----------------------------- 0.6149296760559082
generate_one_block  0.11345410346984863
generate_one_block  0.11523675918579102
generate_one_block  0.11617732048034668
generate_one_block  0.11721920967102051
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03408932685852051
gen group dst list time:  0.011515378952026367
time for parepare:  0.01975417137145996
local_output_nid generation:  0.02212357521057129
local_in_edges_tensor generation:  0.035025596618652344
mini_batch_src_global generation:  0.041689157485961914
r_  generation:  0.4241597652435303
local_output_nid generation:  0.028754711151123047
local_in_edges_tensor generation:  0.03246927261352539
mini_batch_src_global generation:  0.05210113525390625
r_  generation:  0.4367527961730957
local_output_nid generation:  0.027274608612060547
local_in_edges_tensor generation:  0.027750730514526367
mini_batch_src_global generation:  0.04987907409667969
r_  generation:  0.4425971508026123
local_output_nid generation:  0.027324676513671875
local_in_edges_tensor generation:  0.028605222702026367
mini_batch_src_global generation:  0.053067922592163086
r_  generation:  0.44792747497558594
----------------------check_connections_block total spend ----------------------------- 2.580606698989868
generate_one_block  0.559910774230957
generate_one_block  0.5523707866668701
generate_one_block  0.5813477039337158
generate_one_block  0.5609371662139893
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.027920246124267578
gen group dst list time:  0.022092103958129883
time for parepare:  0.01905035972595215
local_output_nid generation:  0.03141212463378906
local_in_edges_tensor generation:  0.0435330867767334
mini_batch_src_global generation:  0.049617767333984375
r_  generation:  0.4938080310821533
local_output_nid generation:  0.0384519100189209
local_in_edges_tensor generation:  0.03539156913757324
mini_batch_src_global generation:  0.055400848388671875
r_  generation:  0.5029947757720947
local_output_nid generation:  0.038457393646240234
local_in_edges_tensor generation:  0.03427934646606445
mini_batch_src_global generation:  0.055145978927612305
r_  generation:  0.5052201747894287
local_output_nid generation:  0.038492441177368164
local_in_edges_tensor generation:  0.03599834442138672
mini_batch_src_global generation:  0.05186796188354492
r_  generation:  0.5160424709320068
----------------------check_connections_block total spend ----------------------------- 2.985452890396118
generate_one_block  0.6249504089355469
generate_one_block  0.6258306503295898
generate_one_block  0.6413192749023438
generate_one_block  0.6452722549438477
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.1487884521484375  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

connection checking time:  5.566059589385986
block generation total time  4.79193902015686
average batch blocks generation time:  1.197984755039215
block dataloader generation time/epoch 12.332550232227032
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.1097726821899414  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1289033889770508  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10909557342529297  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1286368370056152  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10929059982299805  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1297521591186523  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10967731475830078  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1357245445251465  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09224432706832886 |0.013628602027893066 |0.003563225269317627 |9.22083854675293e-05 |0.003750741481781006 |0.0012936592102050781 |
----------------------------------------------------------pseudo_mini_loss sum 1.2914235591888428
Total (block generation + training)time/epoch 12.89181480040917
Training time/epoch 0.5441162586212158
Training time without block to device /epoch 0.48960185050964355
Training time without total dataloading part /epoch 0.030918359756469727
load block tensor time/epoch 0.36897730827331543
block to device time/epoch 0.054514408111572266
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 22 |
Number of nodes for computation during this epoch:  1710198
Number of first layer input nodes during this epoch:  658121
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14904212951660156  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018637657165527344
random selection method range initialization spend 0.004897117614746094
time for parepare:  0.017715930938720703
local_output_nid generation:  0.008970499038696289
local_in_edges_tensor generation:  0.008306264877319336
mini_batch_src_global generation:  0.007836103439331055
r_  generation:  0.09001946449279785
local_output_nid generation:  0.011690139770507812
local_in_edges_tensor generation:  0.006079196929931641
mini_batch_src_global generation:  0.010269641876220703
r_  generation:  0.09578108787536621
local_output_nid generation:  0.011811494827270508
local_in_edges_tensor generation:  0.006195783615112305
mini_batch_src_global generation:  0.008026361465454102
r_  generation:  0.10047674179077148
local_output_nid generation:  0.011892080307006836
local_in_edges_tensor generation:  0.006018877029418945
mini_batch_src_global generation:  0.00868844985961914
r_  generation:  0.1038970947265625
----------------------check_connections_block total spend ----------------------------- 0.6057901382446289
generate_one_block  0.11375284194946289
generate_one_block  0.11420297622680664
generate_one_block  0.11646270751953125
generate_one_block  0.11645197868347168
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03127026557922363
gen group dst list time:  0.012401103973388672
time for parepare:  0.02114725112915039
local_output_nid generation:  0.02186298370361328
local_in_edges_tensor generation:  0.03194427490234375
mini_batch_src_global generation:  0.039751291275024414
r_  generation:  0.4216170310974121
local_output_nid generation:  0.02769613265991211
local_in_edges_tensor generation:  0.026130199432373047
mini_batch_src_global generation:  0.04958200454711914
r_  generation:  0.4358510971069336
local_output_nid generation:  0.0270538330078125
local_in_edges_tensor generation:  0.02650737762451172
mini_batch_src_global generation:  0.049513816833496094
r_  generation:  0.444537878036499
local_output_nid generation:  0.0267789363861084
local_in_edges_tensor generation:  0.02753162384033203
mini_batch_src_global generation:  0.050463199615478516
r_  generation:  0.4410104751586914
----------------------check_connections_block total spend ----------------------------- 2.552337169647217
generate_one_block  0.5530898571014404
generate_one_block  0.5559706687927246
generate_one_block  0.5776016712188721
generate_one_block  0.5576198101043701
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.026539087295532227
gen group dst list time:  0.022148847579956055
time for parepare:  0.01891303062438965
local_output_nid generation:  0.030556917190551758
local_in_edges_tensor generation:  0.04440879821777344
mini_batch_src_global generation:  0.04499197006225586
r_  generation:  0.49117231369018555
local_output_nid generation:  0.037229299545288086
local_in_edges_tensor generation:  0.035471439361572266
mini_batch_src_global generation:  0.05538630485534668
r_  generation:  0.5039677619934082
local_output_nid generation:  0.038680076599121094
local_in_edges_tensor generation:  0.034273624420166016
mini_batch_src_global generation:  0.05396866798400879
r_  generation:  0.5060396194458008
local_output_nid generation:  0.037569284439086914
local_in_edges_tensor generation:  0.03898477554321289
mini_batch_src_global generation:  0.05195760726928711
r_  generation:  0.5150456428527832
----------------------check_connections_block total spend ----------------------------- 2.9769914150238037
generate_one_block  0.6270976066589355
generate_one_block  0.6240942478179932
generate_one_block  0.6318259239196777
generate_one_block  0.6293864250183105
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14904212951660156  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

connection checking time:  5.5293285846710205
block generation total time  4.756686210632324
average batch blocks generation time:  1.189171552658081
block dataloader generation time/epoch 12.317720668656486
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.11003351211547852  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1339421272277832  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10910558700561523  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1286711692810059  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10922622680664062  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1296005249023438  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10968494415283203  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1326355934143066  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08878815174102783 |0.015548288822174072 |0.003477811813354492 |8.851289749145508e-05 |0.0034270286560058594 |0.0014104843139648438 |
----------------------------------------------------------pseudo_mini_loss sum 1.2813537120819092
Total (block generation + training)time/epoch 12.875381350517273
Training time/epoch 0.5365979671478271
Training time without block to device /epoch 0.47440481185913086
Training time without total dataloading part /epoch 0.02938389778137207
load block tensor time/epoch 0.35515260696411133
block to device time/epoch 0.06219315528869629
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 23 |
Number of nodes for computation during this epoch:  1710542
Number of first layer input nodes during this epoch:  658141
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.1489548683166504  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023247718811035156
random selection method range initialization spend 0.004912376403808594
time for parepare:  0.01732635498046875
local_output_nid generation:  0.009009361267089844
local_in_edges_tensor generation:  0.008978605270385742
mini_batch_src_global generation:  0.007946252822875977
r_  generation:  0.09169435501098633
local_output_nid generation:  0.011817216873168945
local_in_edges_tensor generation:  0.0061855316162109375
mini_batch_src_global generation:  0.010111093521118164
r_  generation:  0.09991121292114258
local_output_nid generation:  0.011932611465454102
local_in_edges_tensor generation:  0.006232738494873047
mini_batch_src_global generation:  0.007874011993408203
r_  generation:  0.10025906562805176
local_output_nid generation:  0.01175832748413086
local_in_edges_tensor generation:  0.006384134292602539
mini_batch_src_global generation:  0.008707523345947266
r_  generation:  0.10414791107177734
----------------------check_connections_block total spend ----------------------------- 0.6127851009368896
generate_one_block  0.11524415016174316
generate_one_block  0.11566877365112305
generate_one_block  0.11581611633300781
generate_one_block  0.11633872985839844
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03823280334472656
gen group dst list time:  0.011526107788085938
time for parepare:  0.019745349884033203
local_output_nid generation:  0.021953344345092773
local_in_edges_tensor generation:  0.036652326583862305
mini_batch_src_global generation:  0.04382133483886719
r_  generation:  0.42525815963745117
local_output_nid generation:  0.028561830520629883
local_in_edges_tensor generation:  0.032195091247558594
mini_batch_src_global generation:  0.04958796501159668
r_  generation:  0.43678760528564453
local_output_nid generation:  0.027698755264282227
local_in_edges_tensor generation:  0.027283430099487305
mini_batch_src_global generation:  0.051434993743896484
r_  generation:  0.4511392116546631
local_output_nid generation:  0.02976393699645996
local_in_edges_tensor generation:  0.027988195419311523
mini_batch_src_global generation:  0.051346778869628906
r_  generation:  0.44347357749938965
----------------------check_connections_block total spend ----------------------------- 2.5990564823150635
generate_one_block  0.5547187328338623
generate_one_block  0.5579924583435059
generate_one_block  0.5840625762939453
generate_one_block  0.5614886283874512
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02934718132019043
gen group dst list time:  0.022097110748291016
time for parepare:  0.019454002380371094
local_output_nid generation:  0.03167247772216797
local_in_edges_tensor generation:  0.047155141830444336
mini_batch_src_global generation:  0.04568004608154297
r_  generation:  0.49486541748046875
local_output_nid generation:  0.038106441497802734
local_in_edges_tensor generation:  0.042169809341430664
mini_batch_src_global generation:  0.05590224266052246
r_  generation:  0.504148006439209
local_output_nid generation:  0.03841710090637207
local_in_edges_tensor generation:  0.037275075912475586
mini_batch_src_global generation:  0.057065486907958984
r_  generation:  0.5033531188964844
local_output_nid generation:  0.03840994834899902
local_in_edges_tensor generation:  0.03824305534362793
mini_batch_src_global generation:  0.05130624771118164
r_  generation:  0.5187461376190186
----------------------check_connections_block total spend ----------------------------- 3.000488758087158
generate_one_block  0.6278121471405029
generate_one_block  0.629727840423584
generate_one_block  0.6273665428161621
generate_one_block  0.6247415542602539
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.1489548683166504  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

connection checking time:  5.599545240402222
block generation total time  4.767910480499268
average batch blocks generation time:  1.191977620124817
block dataloader generation time/epoch 12.313703123728434
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.1101064682006836  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1348857879638672  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10899066925048828  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1282448768615723  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.1092367172241211  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1291685104370117  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10970735549926758  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.130445957183838  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09253329038619995 |0.013705670833587646 |0.0036649107933044434 |9.423494338989258e-05 |0.003780186176300049 |0.0018482208251953125 |
----------------------------------------------------------pseudo_mini_loss sum 1.2681760787963867
Total (block generation + training)time/epoch 12.870661290486654
Training time/epoch 0.5469424724578857
Training time without block to device /epoch 0.49211978912353516
Training time without total dataloading part /epoch 0.03200554847717285
load block tensor time/epoch 0.3701331615447998
block to device time/epoch 0.054822683334350586
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 24 |
Number of nodes for computation during this epoch:  1710865
Number of first layer input nodes during this epoch:  658372
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.1479945182800293  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01824355125427246
random selection method range initialization spend 0.00491786003112793
time for parepare:  0.017455577850341797
local_output_nid generation:  0.008926630020141602
local_in_edges_tensor generation:  0.008517265319824219
mini_batch_src_global generation:  0.007855415344238281
r_  generation:  0.09104585647583008
local_output_nid generation:  0.012013912200927734
local_in_edges_tensor generation:  0.006218910217285156
mini_batch_src_global generation:  0.010355949401855469
r_  generation:  0.09784626960754395
local_output_nid generation:  0.011901378631591797
local_in_edges_tensor generation:  0.006398439407348633
mini_batch_src_global generation:  0.007954597473144531
r_  generation:  0.10193061828613281
local_output_nid generation:  0.011911869049072266
local_in_edges_tensor generation:  0.0062084197998046875
mini_batch_src_global generation:  0.008628368377685547
r_  generation:  0.10543274879455566
----------------------check_connections_block total spend ----------------------------- 0.6133043766021729
generate_one_block  0.11240148544311523
generate_one_block  0.11698675155639648
generate_one_block  0.11647534370422363
generate_one_block  0.11661553382873535
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03529787063598633
gen group dst list time:  0.011562585830688477
time for parepare:  0.019443988800048828
local_output_nid generation:  0.021415233612060547
local_in_edges_tensor generation:  0.032521724700927734
mini_batch_src_global generation:  0.04030966758728027
r_  generation:  0.4238317012786865
local_output_nid generation:  0.02812957763671875
local_in_edges_tensor generation:  0.028325319290161133
mini_batch_src_global generation:  0.05058431625366211
r_  generation:  0.436830997467041
local_output_nid generation:  0.026807308197021484
local_in_edges_tensor generation:  0.027931928634643555
mini_batch_src_global generation:  0.050252676010131836
r_  generation:  0.4362185001373291
local_output_nid generation:  0.025957345962524414
local_in_edges_tensor generation:  0.029308080673217773
mini_batch_src_global generation:  0.050719261169433594
r_  generation:  0.44054627418518066
----------------------check_connections_block total spend ----------------------------- 2.553318977355957
generate_one_block  0.5527369976043701
generate_one_block  0.5558650493621826
generate_one_block  0.5762901306152344
generate_one_block  0.550426721572876
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025617361068725586
gen group dst list time:  0.022025108337402344
time for parepare:  0.018706560134887695
local_output_nid generation:  0.030246734619140625
local_in_edges_tensor generation:  0.03993368148803711
mini_batch_src_global generation:  0.045519351959228516
r_  generation:  0.4977140426635742
local_output_nid generation:  0.037862539291381836
local_in_edges_tensor generation:  0.03409743309020996
mini_batch_src_global generation:  0.05541086196899414
r_  generation:  0.5040957927703857
local_output_nid generation:  0.037429094314575195
local_in_edges_tensor generation:  0.03455209732055664
mini_batch_src_global generation:  0.05457019805908203
r_  generation:  0.5081684589385986
local_output_nid generation:  0.0376276969909668
local_in_edges_tensor generation:  0.033777475357055664
mini_batch_src_global generation:  0.05136847496032715
r_  generation:  0.515261173248291
----------------------check_connections_block total spend ----------------------------- 2.9797255992889404
generate_one_block  0.6264774799346924
generate_one_block  0.6266469955444336
generate_one_block  0.6233367919921875
generate_one_block  0.6217870712280273
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.1479945182800293  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

connection checking time:  5.5330445766448975
block generation total time  4.733567237854004
average batch blocks generation time:  1.183391809463501
block dataloader generation time/epoch 12.303448274731636
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10904836654663086  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1302990913391113  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.1093587875366211  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1358766555786133  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.1096639633178711  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.128507137298584  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10969209671020508  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1297497749328613  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07376724481582642 |0.013460099697113037 |0.00348508358001709 |8.970499038696289e-05 |0.016813576221466064 |0.0015299320220947266 |
----------------------------------------------------------pseudo_mini_loss sum 1.255767583847046
Total (block generation + training)time/epoch 12.858377501368523
Training time/epoch 0.5242769718170166
Training time without block to device /epoch 0.47043657302856445
Training time without total dataloading part /epoch 0.0830833911895752
load block tensor time/epoch 0.29506897926330566
block to device time/epoch 0.05384039878845215
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 25 |
Number of nodes for computation during this epoch:  1711016
Number of first layer input nodes during this epoch:  658433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14753341674804688  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01999831199645996
random selection method range initialization spend 0.006078481674194336
time for parepare:  0.019024372100830078
local_output_nid generation:  0.008689165115356445
local_in_edges_tensor generation:  0.009787321090698242
mini_batch_src_global generation:  0.009218454360961914
r_  generation:  0.09096598625183105
local_output_nid generation:  0.011707782745361328
local_in_edges_tensor generation:  0.006190061569213867
mini_batch_src_global generation:  0.012020111083984375
r_  generation:  0.09787154197692871
local_output_nid generation:  0.011774539947509766
local_in_edges_tensor generation:  0.006106376647949219
mini_batch_src_global generation:  0.009458303451538086
r_  generation:  0.10241341590881348
local_output_nid generation:  0.011770248413085938
local_in_edges_tensor generation:  0.006057024002075195
mini_batch_src_global generation:  0.010293722152709961
r_  generation:  0.10569047927856445
----------------------check_connections_block total spend ----------------------------- 0.6234064102172852
generate_one_block  0.1119847297668457
generate_one_block  0.11710500717163086
generate_one_block  0.11622858047485352
generate_one_block  0.11607098579406738
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03021979331970215
gen group dst list time:  0.01147770881652832
time for parepare:  0.0192568302154541
local_output_nid generation:  0.0216524600982666
local_in_edges_tensor generation:  0.03220939636230469
mini_batch_src_global generation:  0.03990030288696289
r_  generation:  0.4190633296966553
local_output_nid generation:  0.028325319290161133
local_in_edges_tensor generation:  0.02701091766357422
mini_batch_src_global generation:  0.049898624420166016
r_  generation:  0.43274569511413574
local_output_nid generation:  0.026737451553344727
local_in_edges_tensor generation:  0.026044845581054688
mini_batch_src_global generation:  0.050141334533691406
r_  generation:  0.4410858154296875
local_output_nid generation:  0.026648998260498047
local_in_edges_tensor generation:  0.026271343231201172
mini_batch_src_global generation:  0.050577402114868164
r_  generation:  0.44089531898498535
----------------------check_connections_block total spend ----------------------------- 2.540301561355591
generate_one_block  0.548698902130127
generate_one_block  0.5532002449035645
generate_one_block  0.5823872089385986
generate_one_block  0.5614476203918457
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.024982690811157227
gen group dst list time:  0.02218914031982422
time for parepare:  0.018636226654052734
local_output_nid generation:  0.030558347702026367
local_in_edges_tensor generation:  0.04059100151062012
mini_batch_src_global generation:  0.04478096961975098
r_  generation:  0.493208646774292
local_output_nid generation:  0.037761688232421875
local_in_edges_tensor generation:  0.03474068641662598
mini_batch_src_global generation:  0.05582094192504883
r_  generation:  0.49889349937438965
local_output_nid generation:  0.03769040107727051
local_in_edges_tensor generation:  0.034631967544555664
mini_batch_src_global generation:  0.055027008056640625
r_  generation:  0.5046491622924805
local_output_nid generation:  0.03775739669799805
local_in_edges_tensor generation:  0.03483986854553223
mini_batch_src_global generation:  0.05155444145202637
r_  generation:  0.5137856006622314
----------------------check_connections_block total spend ----------------------------- 2.9692392349243164
generate_one_block  0.6236860752105713
generate_one_block  0.6209807395935059
generate_one_block  0.6198272705078125
generate_one_block  0.6237308979034424
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14753341674804688  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

connection checking time:  5.509540796279907
block generation total time  4.733958959579468
average batch blocks generation time:  1.183489739894867
block dataloader generation time/epoch 12.291106518577127
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10912847518920898  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1262283325195312  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10925865173339844  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1295685768127441  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10982990264892578  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1364994049072266  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.11005210876464844  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1337943077087402  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08082515001296997 |0.013532578945159912 |0.008662164211273193 |8.797645568847656e-05 |0.0034025907516479492 |0.002904653549194336 |
----------------------------------------------------------pseudo_mini_loss sum 1.2449688911437988
Total (block generation + training)time/epoch 12.843912363052368
Training time/epoch 0.518613338470459
Training time without block to device /epoch 0.46448302268981934
Training time without total dataloading part /epoch 0.05151557922363281
load block tensor time/epoch 0.3233006000518799
block to device time/epoch 0.05413031578063965
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 26 |
Number of nodes for computation during this epoch:  1710866
Number of first layer input nodes during this epoch:  658438
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14766836166381836  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019376516342163086
random selection method range initialization spend 0.004812002182006836
time for parepare:  0.017340660095214844
local_output_nid generation:  0.008997440338134766
local_in_edges_tensor generation:  0.008615732192993164
mini_batch_src_global generation:  0.007853984832763672
r_  generation:  0.09101986885070801
local_output_nid generation:  0.012060880661010742
local_in_edges_tensor generation:  0.006199359893798828
mini_batch_src_global generation:  0.010098695755004883
r_  generation:  0.09848165512084961
local_output_nid generation:  0.01212167739868164
local_in_edges_tensor generation:  0.006173849105834961
mini_batch_src_global generation:  0.00793004035949707
r_  generation:  0.10155296325683594
local_output_nid generation:  0.011969327926635742
local_in_edges_tensor generation:  0.006082773208618164
mini_batch_src_global generation:  0.008626222610473633
r_  generation:  0.10292744636535645
----------------------check_connections_block total spend ----------------------------- 0.6107132434844971
generate_one_block  0.11349368095397949
generate_one_block  0.11599993705749512
generate_one_block  0.11550235748291016
generate_one_block  0.11547589302062988
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03165793418884277
gen group dst list time:  0.011408805847167969
time for parepare:  0.019410133361816406
local_output_nid generation:  0.021921873092651367
local_in_edges_tensor generation:  0.03143668174743652
mini_batch_src_global generation:  0.04004240036010742
r_  generation:  0.4273710250854492
local_output_nid generation:  0.028393030166625977
local_in_edges_tensor generation:  0.02932143211364746
mini_batch_src_global generation:  0.050354719161987305
r_  generation:  0.43840479850769043
local_output_nid generation:  0.02684640884399414
local_in_edges_tensor generation:  0.0281524658203125
mini_batch_src_global generation:  0.050095319747924805
r_  generation:  0.4437687397003174
local_output_nid generation:  0.026719331741333008
local_in_edges_tensor generation:  0.026554107666015625
mini_batch_src_global generation:  0.0507662296295166
r_  generation:  0.439847469329834
----------------------check_connections_block total spend ----------------------------- 2.5631935596466064
generate_one_block  0.5598828792572021
generate_one_block  0.5547544956207275
generate_one_block  0.5738282203674316
generate_one_block  0.546867847442627
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.024916410446166992
gen group dst list time:  0.022054433822631836
time for parepare:  0.018445730209350586
local_output_nid generation:  0.03000950813293457
local_in_edges_tensor generation:  0.03938627243041992
mini_batch_src_global generation:  0.04503011703491211
r_  generation:  0.4941732883453369
local_output_nid generation:  0.03773355484008789
local_in_edges_tensor generation:  0.03355050086975098
mini_batch_src_global generation:  0.05528545379638672
r_  generation:  0.5017344951629639
local_output_nid generation:  0.037772417068481445
local_in_edges_tensor generation:  0.03399658203125
mini_batch_src_global generation:  0.05478835105895996
r_  generation:  0.5084924697875977
local_output_nid generation:  0.03781557083129883
local_in_edges_tensor generation:  0.03366255760192871
mini_batch_src_global generation:  0.05173921585083008
r_  generation:  0.5110669136047363
----------------------check_connections_block total spend ----------------------------- 2.9657509326934814
generate_one_block  0.629929780960083
generate_one_block  0.6297659873962402
generate_one_block  0.6231057643890381
generate_one_block  0.6312479972839355
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14766836166381836  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

connection checking time:  5.528944492340088
block generation total time  4.749382972717285
average batch blocks generation time:  1.1873457431793213
block dataloader generation time/epoch 12.281290584140354
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.1091914176940918  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.133768081665039  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10931587219238281  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1346426010131836  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.1096506118774414  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1310396194458008  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10976886749267578  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1292638778686523  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09149891138076782 |0.016283154487609863 |0.0035260915756225586 |8.994340896606445e-05 |0.003704965114593506 |0.0026917457580566406 |
----------------------------------------------------------pseudo_mini_loss sum 1.2356914281845093
Total (block generation + training)time/epoch 12.8341144323349
Training time/epoch 0.552919864654541
Training time without block to device /epoch 0.48778724670410156
Training time without total dataloading part /epoch 0.031975746154785156
load block tensor time/epoch 0.3659956455230713
block to device time/epoch 0.06513261795043945
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 27 |
Number of nodes for computation during this epoch:  1710892
Number of first layer input nodes during this epoch:  658282
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14751100540161133  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01753854751586914
random selection method range initialization spend 0.005140781402587891
time for parepare:  0.01745748519897461
local_output_nid generation:  0.009069204330444336
local_in_edges_tensor generation:  0.008592844009399414
mini_batch_src_global generation:  0.007942914962768555
r_  generation:  0.09101295471191406
local_output_nid generation:  0.011684656143188477
local_in_edges_tensor generation:  0.006172895431518555
mini_batch_src_global generation:  0.00999593734741211
r_  generation:  0.09743714332580566
local_output_nid generation:  0.011836051940917969
local_in_edges_tensor generation:  0.0061190128326416016
mini_batch_src_global generation:  0.007860660552978516
r_  generation:  0.1002187728881836
local_output_nid generation:  0.011687278747558594
local_in_edges_tensor generation:  0.0062677860260009766
mini_batch_src_global generation:  0.008583307266235352
r_  generation:  0.10282540321350098
----------------------check_connections_block total spend ----------------------------- 0.6065676212310791
generate_one_block  0.1156005859375
generate_one_block  0.11466336250305176
generate_one_block  0.1176762580871582
generate_one_block  0.11521029472351074
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03365945816040039
gen group dst list time:  0.011476516723632812
time for parepare:  0.021120309829711914
local_output_nid generation:  0.02209019660949707
local_in_edges_tensor generation:  0.03571152687072754
mini_batch_src_global generation:  0.04232525825500488
r_  generation:  0.4296224117279053
local_output_nid generation:  0.028445720672607422
local_in_edges_tensor generation:  0.029710769653320312
mini_batch_src_global generation:  0.050835371017456055
r_  generation:  0.4343373775482178
local_output_nid generation:  0.02782750129699707
local_in_edges_tensor generation:  0.0285489559173584
mini_batch_src_global generation:  0.05038881301879883
r_  generation:  0.4422430992126465
local_output_nid generation:  0.02764129638671875
local_in_edges_tensor generation:  0.027121543884277344
mini_batch_src_global generation:  0.05087637901306152
r_  generation:  0.44454240798950195
----------------------check_connections_block total spend ----------------------------- 2.578191041946411
generate_one_block  0.5706863403320312
generate_one_block  0.5560929775238037
generate_one_block  0.5867331027984619
generate_one_block  0.557427167892456
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.027755260467529297
gen group dst list time:  0.02207326889038086
time for parepare:  0.019060850143432617
local_output_nid generation:  0.03056812286376953
local_in_edges_tensor generation:  0.04634261131286621
mini_batch_src_global generation:  0.047605276107788086
r_  generation:  0.4958662986755371
local_output_nid generation:  0.03895998001098633
local_in_edges_tensor generation:  0.04325413703918457
mini_batch_src_global generation:  0.05580401420593262
r_  generation:  0.5029375553131104
local_output_nid generation:  0.03849339485168457
local_in_edges_tensor generation:  0.039285898208618164
mini_batch_src_global generation:  0.054718732833862305
r_  generation:  0.5092694759368896
local_output_nid generation:  0.03819870948791504
local_in_edges_tensor generation:  0.03794503211975098
mini_batch_src_global generation:  0.05174541473388672
r_  generation:  0.5161929130554199
----------------------check_connections_block total spend ----------------------------- 3.009345769882202
generate_one_block  0.6247358322143555
generate_one_block  0.6227014064788818
generate_one_block  0.634751558303833
generate_one_block  0.6417510509490967
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14751100540161133  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

connection checking time:  5.587536811828613
block generation total time  4.79487943649292
average batch blocks generation time:  1.19871985912323
block dataloader generation time/epoch 12.2791477379046
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10931587219238281  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1299066543579102  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10962581634521484  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.130018711090088  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.11007070541381836  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1334171295166016  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10909271240234375  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1301789283752441  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0910501480102539 |0.01370161771774292 |0.0036889314651489258 |9.340047836303711e-05 |0.0038550496101379395 |0.0017633438110351562 |
----------------------------------------------------------pseudo_mini_loss sum 1.2224557399749756
Total (block generation + training)time/epoch 12.83137059211731
Training time/epoch 0.5411419868469238
Training time without block to device /epoch 0.48633551597595215
Training time without total dataloading part /epoch 0.032312870025634766
load block tensor time/epoch 0.3642005920410156
block to device time/epoch 0.05480647087097168
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 28 |
Number of nodes for computation during this epoch:  1710243
Number of first layer input nodes during this epoch:  658210
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14677762985229492  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020221471786499023
random selection method range initialization spend 0.004887580871582031
time for parepare:  0.01777935028076172
local_output_nid generation:  0.009326696395874023
local_in_edges_tensor generation:  0.009382963180541992
mini_batch_src_global generation:  0.007905244827270508
r_  generation:  0.09009575843811035
local_output_nid generation:  0.011727094650268555
local_in_edges_tensor generation:  0.0072133541107177734
mini_batch_src_global generation:  0.010345697402954102
r_  generation:  0.09745645523071289
local_output_nid generation:  0.011888504028320312
local_in_edges_tensor generation:  0.0070116519927978516
mini_batch_src_global generation:  0.007860422134399414
r_  generation:  0.09931325912475586
local_output_nid generation:  0.011918067932128906
local_in_edges_tensor generation:  0.0070989131927490234
mini_batch_src_global generation:  0.00887918472290039
r_  generation:  0.10440564155578613
----------------------check_connections_block total spend ----------------------------- 0.6120538711547852
generate_one_block  0.1161503791809082
generate_one_block  0.11546158790588379
generate_one_block  0.11458659172058105
generate_one_block  0.11673140525817871
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03135061264038086
gen group dst list time:  0.011395454406738281
time for parepare:  0.019402742385864258
local_output_nid generation:  0.021018028259277344
local_in_edges_tensor generation:  0.0324249267578125
mini_batch_src_global generation:  0.040549516677856445
r_  generation:  0.41834330558776855
local_output_nid generation:  0.027669906616210938
local_in_edges_tensor generation:  0.026865243911743164
mini_batch_src_global generation:  0.050240516662597656
r_  generation:  0.43158483505249023
local_output_nid generation:  0.026734590530395508
local_in_edges_tensor generation:  0.027068614959716797
mini_batch_src_global generation:  0.052774906158447266
r_  generation:  0.4361698627471924
local_output_nid generation:  0.026472806930541992
local_in_edges_tensor generation:  0.026764631271362305
mini_batch_src_global generation:  0.052335262298583984
r_  generation:  0.4409308433532715
----------------------check_connections_block total spend ----------------------------- 2.5390357971191406
generate_one_block  0.5547425746917725
generate_one_block  0.5524606704711914
generate_one_block  0.5737245082855225
generate_one_block  0.5524017810821533
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030991315841674805
gen group dst list time:  0.02226996421813965
time for parepare:  0.018673419952392578
local_output_nid generation:  0.029985904693603516
local_in_edges_tensor generation:  0.04052233695983887
mini_batch_src_global generation:  0.045041799545288086
r_  generation:  0.49585890769958496
local_output_nid generation:  0.03716301918029785
local_in_edges_tensor generation:  0.03820610046386719
mini_batch_src_global generation:  0.055341482162475586
r_  generation:  0.5040020942687988
local_output_nid generation:  0.037316083908081055
local_in_edges_tensor generation:  0.03454899787902832
mini_batch_src_global generation:  0.05415654182434082
r_  generation:  0.508594274520874
local_output_nid generation:  0.03745603561401367
local_in_edges_tensor generation:  0.03776264190673828
mini_batch_src_global generation:  0.050969600677490234
r_  generation:  0.5163106918334961
----------------------check_connections_block total spend ----------------------------- 2.9826467037200928
generate_one_block  0.6217200756072998
generate_one_block  0.6270465850830078
generate_one_block  0.6212825775146484
generate_one_block  0.6234753131866455
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.14677762985229492  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

connection checking time:  5.521682500839233
block generation total time  4.726854085922241
average batch blocks generation time:  1.1817135214805603
block dataloader generation time/epoch 12.271385157108307
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10918235778808594  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1285367012023926  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10927248001098633  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1293392181396484  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.10969209671020508  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.1301050186157227  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.1093897819519043  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 1.134099006652832  GigaBytes
Max Memory Allocated: 1.342268466949463  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09184145927429199 |0.01368016004562378 |0.0035223960876464844 |9.1552734375e-05 |0.0037443041801452637 |0.0012903213500976562 |
----------------------------------------------------------pseudo_mini_loss sum 1.212203025817871
Total (block generation + training)time/epoch 12.82293461561203
Training time/epoch 0.5385758876800537
Training time without block to device /epoch 0.4838552474975586
Training time without total dataloading part /epoch 0.03072333335876465
load block tensor time/epoch 0.36736583709716797
block to device time/epoch 0.05472064018249512
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 29 |
Number of nodes for computation during this epoch:  1710662
Number of first layer input nodes during this epoch:  658270
