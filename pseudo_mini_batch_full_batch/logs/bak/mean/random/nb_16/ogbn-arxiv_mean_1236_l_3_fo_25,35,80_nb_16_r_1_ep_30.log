Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1647755310.0393696
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027722597122192383
random selection method range initialization spend 0.006497621536254883
time for parepare:  0.01861286163330078
local_output_nid generation:  0.002170085906982422
local_in_edges_tensor generation:  0.004937887191772461
mini_batch_src_global generation:  0.002095460891723633
r_  generation:  0.020390987396240234
local_output_nid generation:  0.0025675296783447266
local_in_edges_tensor generation:  0.0017960071563720703
mini_batch_src_global generation:  0.0025124549865722656
r_  generation:  0.02014470100402832
local_output_nid generation:  0.002842426300048828
local_in_edges_tensor generation:  0.0016865730285644531
mini_batch_src_global generation:  0.001583099365234375
r_  generation:  0.020708560943603516
local_output_nid generation:  0.002849102020263672
local_in_edges_tensor generation:  0.0017015933990478516
mini_batch_src_global generation:  0.0016407966613769531
r_  generation:  0.020138263702392578
local_output_nid generation:  0.0028672218322753906
local_in_edges_tensor generation:  0.0015902519226074219
mini_batch_src_global generation:  0.0016264915466308594
r_  generation:  0.01956462860107422
local_output_nid generation:  0.0028400421142578125
local_in_edges_tensor generation:  0.0016198158264160156
mini_batch_src_global generation:  0.0016398429870605469
r_  generation:  0.021818161010742188
local_output_nid generation:  0.003058195114135742
local_in_edges_tensor generation:  0.0016300678253173828
mini_batch_src_global generation:  0.001615285873413086
r_  generation:  0.02167797088623047
local_output_nid generation:  0.003156900405883789
local_in_edges_tensor generation:  0.0016982555389404297
mini_batch_src_global generation:  0.001722574234008789
r_  generation:  0.020781993865966797
local_output_nid generation:  0.0030362606048583984
local_in_edges_tensor generation:  0.0016355514526367188
mini_batch_src_global generation:  0.0016720294952392578
r_  generation:  0.021637916564941406
local_output_nid generation:  0.0029382705688476562
local_in_edges_tensor generation:  0.0016121864318847656
mini_batch_src_global generation:  0.001672506332397461
r_  generation:  0.021532058715820312
local_output_nid generation:  0.002905607223510742
local_in_edges_tensor generation:  0.0016102790832519531
mini_batch_src_global generation:  0.0017015933990478516
r_  generation:  0.021228551864624023
local_output_nid generation:  0.0029506683349609375
local_in_edges_tensor generation:  0.0015702247619628906
mini_batch_src_global generation:  0.0017096996307373047
r_  generation:  0.021474599838256836
local_output_nid generation:  0.00295257568359375
local_in_edges_tensor generation:  0.0015521049499511719
mini_batch_src_global generation:  0.0017082691192626953
r_  generation:  0.02133345603942871
local_output_nid generation:  0.002881288528442383
local_in_edges_tensor generation:  0.0016226768493652344
mini_batch_src_global generation:  0.0017681121826171875
r_  generation:  0.021502256393432617
local_output_nid generation:  0.0029075145721435547
local_in_edges_tensor generation:  0.0015850067138671875
mini_batch_src_global generation:  0.001783132553100586
r_  generation:  0.021266460418701172
local_output_nid generation:  0.0028793811798095703
local_in_edges_tensor generation:  0.0015912055969238281
mini_batch_src_global generation:  0.0017058849334716797
r_  generation:  0.02123570442199707
----------------------check_connections_block total spend ----------------------------- 0.544872522354126
generate_one_block  0.031091690063476562
generate_one_block  0.03194904327392578
generate_one_block  0.035416603088378906
generate_one_block  0.0317234992980957
generate_one_block  0.02951955795288086
generate_one_block  0.03162837028503418
generate_one_block  0.030735015869140625
generate_one_block  0.030486106872558594
generate_one_block  0.03153586387634277
generate_one_block  0.030767202377319336
generate_one_block  0.030370235443115234
generate_one_block  0.031224727630615234
generate_one_block  0.03106236457824707
generate_one_block  0.03167295455932617
generate_one_block  0.031502723693847656
generate_one_block  0.030708789825439453
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04093194007873535
gen group dst list time:  0.020484209060668945
time for parepare:  0.01906132698059082
local_output_nid generation:  0.008929967880249023
local_in_edges_tensor generation:  0.021419763565063477
mini_batch_src_global generation:  0.022860050201416016
r_  generation:  0.21586108207702637
local_output_nid generation:  0.013431310653686523
local_in_edges_tensor generation:  0.022304534912109375
mini_batch_src_global generation:  0.026901960372924805
r_  generation:  0.2241959571838379
local_output_nid generation:  0.013090133666992188
local_in_edges_tensor generation:  0.01856088638305664
mini_batch_src_global generation:  0.026960372924804688
r_  generation:  0.23291516304016113
local_output_nid generation:  0.012818574905395508
local_in_edges_tensor generation:  0.01949334144592285
mini_batch_src_global generation:  0.027678966522216797
r_  generation:  0.2289142608642578
local_output_nid generation:  0.012693405151367188
local_in_edges_tensor generation:  0.013266324996948242
mini_batch_src_global generation:  0.028142929077148438
r_  generation:  0.23096203804016113
local_output_nid generation:  0.012947320938110352
local_in_edges_tensor generation:  0.0161898136138916
mini_batch_src_global generation:  0.029574871063232422
r_  generation:  0.2386329174041748
local_output_nid generation:  0.012839078903198242
local_in_edges_tensor generation:  0.019377708435058594
mini_batch_src_global generation:  0.028814077377319336
r_  generation:  0.23240065574645996
local_output_nid generation:  0.012825250625610352
local_in_edges_tensor generation:  0.013365745544433594
mini_batch_src_global generation:  0.02855396270751953
r_  generation:  0.22707176208496094
local_output_nid generation:  0.012892723083496094
local_in_edges_tensor generation:  0.015497684478759766
mini_batch_src_global generation:  0.029578447341918945
r_  generation:  0.23413395881652832
local_output_nid generation:  0.012988090515136719
local_in_edges_tensor generation:  0.019862651824951172
mini_batch_src_global generation:  0.02931666374206543
r_  generation:  0.23397159576416016
local_output_nid generation:  0.012802362442016602
local_in_edges_tensor generation:  0.013356924057006836
mini_batch_src_global generation:  0.028975963592529297
r_  generation:  0.23517751693725586
local_output_nid generation:  0.013235330581665039
local_in_edges_tensor generation:  0.01780557632446289
mini_batch_src_global generation:  0.02937626838684082
r_  generation:  0.23509860038757324
local_output_nid generation:  0.013017892837524414
local_in_edges_tensor generation:  0.01360321044921875
mini_batch_src_global generation:  0.029745817184448242
r_  generation:  0.23617911338806152
local_output_nid generation:  0.013073921203613281
local_in_edges_tensor generation:  0.017601490020751953
mini_batch_src_global generation:  0.031828880310058594
r_  generation:  0.23316192626953125
local_output_nid generation:  0.01278233528137207
local_in_edges_tensor generation:  0.016219377517700195
mini_batch_src_global generation:  0.031385183334350586
r_  generation:  0.23549985885620117
local_output_nid generation:  0.012975692749023438
local_in_edges_tensor generation:  0.014190912246704102
mini_batch_src_global generation:  0.029610872268676758
r_  generation:  0.23396587371826172
----------------------check_connections_block total spend ----------------------------- 5.4753782749176025
generate_one_block  0.31192946434020996
generate_one_block  0.3056166172027588
generate_one_block  0.3178825378417969
generate_one_block  0.2984476089477539
generate_one_block  0.3099243640899658
generate_one_block  0.3117198944091797
generate_one_block  0.30170321464538574
generate_one_block  0.29329657554626465
generate_one_block  0.3071095943450928
generate_one_block  0.30686211585998535
generate_one_block  0.2963688373565674
generate_one_block  0.3081505298614502
generate_one_block  0.3051629066467285
generate_one_block  0.3081831932067871
generate_one_block  0.31381821632385254
generate_one_block  0.29860830307006836
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03601574897766113
gen group dst list time:  0.06037259101867676
time for parepare:  0.01952648162841797
local_output_nid generation:  0.026104211807250977
local_in_edges_tensor generation:  0.04015231132507324
mini_batch_src_global generation:  0.045697927474975586
r_  generation:  0.4396181106567383
local_output_nid generation:  0.034917593002319336
local_in_edges_tensor generation:  0.04854774475097656
mini_batch_src_global generation:  0.05160069465637207
r_  generation:  0.44942164421081543
local_output_nid generation:  0.03522372245788574
local_in_edges_tensor generation:  0.04584932327270508
mini_batch_src_global generation:  0.050386667251586914
r_  generation:  0.45766592025756836
local_output_nid generation:  0.03466916084289551
local_in_edges_tensor generation:  0.03766679763793945
mini_batch_src_global generation:  0.05231666564941406
r_  generation:  0.45098066329956055
local_output_nid generation:  0.03499865531921387
local_in_edges_tensor generation:  0.03262591361999512
mini_batch_src_global generation:  0.05182600021362305
r_  generation:  0.4587745666503906
local_output_nid generation:  0.03473997116088867
local_in_edges_tensor generation:  0.032232046127319336
mini_batch_src_global generation:  0.05630636215209961
r_  generation:  0.45653295516967773
local_output_nid generation:  0.03500843048095703
local_in_edges_tensor generation:  0.04434990882873535
mini_batch_src_global generation:  0.0519864559173584
r_  generation:  0.46282362937927246
local_output_nid generation:  0.035036563873291016
local_in_edges_tensor generation:  0.033254146575927734
mini_batch_src_global generation:  0.05348825454711914
r_  generation:  0.4562387466430664
local_output_nid generation:  0.03443431854248047
local_in_edges_tensor generation:  0.03176760673522949
mini_batch_src_global generation:  0.05213618278503418
r_  generation:  0.46189045906066895
local_output_nid generation:  0.03532004356384277
local_in_edges_tensor generation:  0.0402677059173584
mini_batch_src_global generation:  0.052750587463378906
r_  generation:  0.46119046211242676
local_output_nid generation:  0.034827232360839844
local_in_edges_tensor generation:  0.040528297424316406
mini_batch_src_global generation:  0.0523223876953125
r_  generation:  0.4706134796142578
local_output_nid generation:  0.035663604736328125
local_in_edges_tensor generation:  0.04168367385864258
mini_batch_src_global generation:  0.05307912826538086
r_  generation:  0.46199893951416016
local_output_nid generation:  0.03551030158996582
local_in_edges_tensor generation:  0.04039955139160156
mini_batch_src_global generation:  0.05270671844482422
r_  generation:  0.46230340003967285
local_output_nid generation:  0.03550863265991211
local_in_edges_tensor generation:  0.032343387603759766
mini_batch_src_global generation:  0.053735971450805664
r_  generation:  0.4613840579986572
local_output_nid generation:  0.03519129753112793
local_in_edges_tensor generation:  0.04980635643005371
mini_batch_src_global generation:  0.05641746520996094
r_  generation:  0.4682586193084717
local_output_nid generation:  0.03508281707763672
local_in_edges_tensor generation:  0.03746151924133301
mini_batch_src_global generation:  0.05319333076477051
r_  generation:  0.459561824798584
----------------------check_connections_block total spend ----------------------------- 10.959664344787598
generate_one_block  0.5912864208221436
generate_one_block  0.6400926113128662
generate_one_block  0.5953969955444336
generate_one_block  0.6383497714996338
generate_one_block  0.5918211936950684
generate_one_block  0.6159517765045166
generate_one_block  0.6625609397888184
generate_one_block  0.6038777828216553
generate_one_block  0.6224203109741211
generate_one_block  0.6116902828216553
generate_one_block  0.6173021793365479
generate_one_block  0.5961768627166748
generate_one_block  0.603386402130127
generate_one_block  0.598168134689331
generate_one_block  0.593083381652832
generate_one_block  0.5928215980529785
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  16.4350426197052
block generation total time  14.669170618057251
average batch blocks generation time:  0.9168231636285782
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.0915379524230957  GigaBytes
Max Memory Allocated: 0.0915379524230957  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.7456912994384766  GigaBytes
Max Memory Allocated: 0.7872686386108398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4881591796875 GB
    Memory Allocated: 0.0929713249206543  GigaBytes
Max Memory Allocated: 0.8330769538879395  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9725341796875 GB
    Memory Allocated: 0.7460770606994629  GigaBytes
Max Memory Allocated: 0.8330769538879395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.09338569641113281  GigaBytes
Max Memory Allocated: 0.8335590362548828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.7539668083190918  GigaBytes
Max Memory Allocated: 0.8335590362548828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.09300374984741211  GigaBytes
Max Memory Allocated: 0.843416690826416  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.7450647354125977  GigaBytes
Max Memory Allocated: 0.843416690826416  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.09291839599609375  GigaBytes
Max Memory Allocated: 0.843416690826416  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.7373394966125488  GigaBytes
Max Memory Allocated: 0.843416690826416  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.0931558609008789  GigaBytes
Max Memory Allocated: 0.843416690826416  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.7501583099365234  GigaBytes
Max Memory Allocated: 0.843416690826416  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.0930471420288086  GigaBytes
Max Memory Allocated: 0.843416690826416  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.7431797981262207  GigaBytes
Max Memory Allocated: 0.843416690826416  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.09264087677001953  GigaBytes
Max Memory Allocated: 0.843416690826416  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.737800121307373  GigaBytes
Max Memory Allocated: 0.843416690826416  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.09314823150634766  GigaBytes
Max Memory Allocated: 0.843416690826416  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.741549015045166  GigaBytes
Max Memory Allocated: 0.843416690826416  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.09290361404418945  GigaBytes
Max Memory Allocated: 0.843416690826416  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.7447476387023926  GigaBytes
Max Memory Allocated: 0.843416690826416  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.09304428100585938  GigaBytes
Max Memory Allocated: 0.843416690826416  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.7408289909362793  GigaBytes
Max Memory Allocated: 0.843416690826416  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.09316444396972656  GigaBytes
Max Memory Allocated: 0.843416690826416  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.7554717063903809  GigaBytes
Max Memory Allocated: 0.843416690826416  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.09316730499267578  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.7442770004272461  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.09293556213378906  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.7477908134460449  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.09317302703857422  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.742645263671875  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.09282064437866211  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.7412395477294922  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05813530087471008 |0.03559611737728119 |0.04996970295906067 |9.441375732421875e-05 |0.010948747396469116 |0.003502368927001953 |
----------------------------------------------------------pseudo_mini_loss sum 6.269316673278809
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5212143
Number of first layer input nodes during this epoch:  2481684
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.1177988052368164  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02210259437561035
random selection method range initialization spend 0.005623817443847656
time for parepare:  0.018062114715576172
local_output_nid generation:  0.0023131370544433594
local_in_edges_tensor generation:  0.004817008972167969
mini_batch_src_global generation:  0.0019588470458984375
r_  generation:  0.02000594139099121
local_output_nid generation:  0.002836942672729492
local_in_edges_tensor generation:  0.001676797866821289
mini_batch_src_global generation:  0.0023734569549560547
r_  generation:  0.02111983299255371
local_output_nid generation:  0.0029213428497314453
local_in_edges_tensor generation:  0.0015676021575927734
mini_batch_src_global generation:  0.0015635490417480469
r_  generation:  0.020764827728271484
local_output_nid generation:  0.002982616424560547
local_in_edges_tensor generation:  0.0016055107116699219
mini_batch_src_global generation:  0.0015723705291748047
r_  generation:  0.02111673355102539
local_output_nid generation:  0.0029888153076171875
local_in_edges_tensor generation:  0.0015299320220947266
mini_batch_src_global generation:  0.0015516281127929688
r_  generation:  0.021360397338867188
local_output_nid generation:  0.002941608428955078
local_in_edges_tensor generation:  0.0015349388122558594
mini_batch_src_global generation:  0.0016269683837890625
r_  generation:  0.02124500274658203
local_output_nid generation:  0.002950906753540039
local_in_edges_tensor generation:  0.0014841556549072266
mini_batch_src_global generation:  0.0016765594482421875
r_  generation:  0.021834373474121094
local_output_nid generation:  0.0029397010803222656
local_in_edges_tensor generation:  0.0015232563018798828
mini_batch_src_global generation:  0.001634836196899414
r_  generation:  0.021079540252685547
local_output_nid generation:  0.002941608428955078
local_in_edges_tensor generation:  0.001500844955444336
mini_batch_src_global generation:  0.0016980171203613281
r_  generation:  0.02225661277770996
local_output_nid generation:  0.0029900074005126953
local_in_edges_tensor generation:  0.0015583038330078125
mini_batch_src_global generation:  0.0017294883728027344
r_  generation:  0.022114276885986328
local_output_nid generation:  0.0031206607818603516
local_in_edges_tensor generation:  0.0016021728515625
mini_batch_src_global generation:  0.0017476081848144531
r_  generation:  0.021765708923339844
local_output_nid generation:  0.0029664039611816406
local_in_edges_tensor generation:  0.0015022754669189453
mini_batch_src_global generation:  0.0017018318176269531
r_  generation:  0.02207803726196289
local_output_nid generation:  0.0030252933502197266
local_in_edges_tensor generation:  0.001580953598022461
mini_batch_src_global generation:  0.0017704963684082031
r_  generation:  0.022220134735107422
local_output_nid generation:  0.002962350845336914
local_in_edges_tensor generation:  0.001535654067993164
mini_batch_src_global generation:  0.0017480850219726562
r_  generation:  0.022730112075805664
local_output_nid generation:  0.002974987030029297
local_in_edges_tensor generation:  0.0015690326690673828
mini_batch_src_global generation:  0.0017735958099365234
r_  generation:  0.02181863784790039
local_output_nid generation:  0.002959728240966797
local_in_edges_tensor generation:  0.0015530586242675781
mini_batch_src_global generation:  0.0017046928405761719
r_  generation:  0.022127866744995117
----------------------check_connections_block total spend ----------------------------- 0.5547611713409424
generate_one_block  0.03385615348815918
generate_one_block  0.032114505767822266
generate_one_block  0.03185677528381348
generate_one_block  0.0316004753112793
generate_one_block  0.031796932220458984
generate_one_block  0.03345918655395508
generate_one_block  0.031847476959228516
generate_one_block  0.03200554847717285
generate_one_block  0.03164935111999512
generate_one_block  0.03110051155090332
generate_one_block  0.031188011169433594
generate_one_block  0.031134843826293945
generate_one_block  0.03141045570373535
generate_one_block  0.0349123477935791
generate_one_block  0.03101801872253418
generate_one_block  0.031717538833618164
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.036788225173950195
gen group dst list time:  0.01944875717163086
time for parepare:  0.019045114517211914
local_output_nid generation:  0.009183883666992188
local_in_edges_tensor generation:  0.02311229705810547
mini_batch_src_global generation:  0.02300739288330078
r_  generation:  0.22020173072814941
local_output_nid generation:  0.013345956802368164
local_in_edges_tensor generation:  0.02141427993774414
mini_batch_src_global generation:  0.027724504470825195
r_  generation:  0.2281661033630371
local_output_nid generation:  0.013280868530273438
local_in_edges_tensor generation:  0.016357421875
mini_batch_src_global generation:  0.0266110897064209
r_  generation:  0.2354443073272705
local_output_nid generation:  0.013988971710205078
local_in_edges_tensor generation:  0.017406463623046875
mini_batch_src_global generation:  0.02785801887512207
r_  generation:  0.2382652759552002
local_output_nid generation:  0.014751195907592773
local_in_edges_tensor generation:  0.023354768753051758
mini_batch_src_global generation:  0.030759572982788086
r_  generation:  0.24180340766906738
local_output_nid generation:  0.016643047332763672
local_in_edges_tensor generation:  0.01666879653930664
mini_batch_src_global generation:  0.03885364532470703
r_  generation:  0.23375511169433594
local_output_nid generation:  0.013454198837280273
local_in_edges_tensor generation:  0.017565011978149414
mini_batch_src_global generation:  0.02897500991821289
r_  generation:  0.2370140552520752
local_output_nid generation:  0.013232707977294922
local_in_edges_tensor generation:  0.014847993850708008
mini_batch_src_global generation:  0.028881072998046875
r_  generation:  0.22891783714294434
local_output_nid generation:  0.013404369354248047
local_in_edges_tensor generation:  0.015842676162719727
mini_batch_src_global generation:  0.031056642532348633
r_  generation:  0.23689508438110352
local_output_nid generation:  0.013454914093017578
local_in_edges_tensor generation:  0.017293214797973633
mini_batch_src_global generation:  0.04886341094970703
r_  generation:  0.23377346992492676
local_output_nid generation:  0.013458251953125
local_in_edges_tensor generation:  0.013150215148925781
mini_batch_src_global generation:  0.03173232078552246
r_  generation:  0.23357224464416504
local_output_nid generation:  0.013545751571655273
local_in_edges_tensor generation:  0.01674032211303711
mini_batch_src_global generation:  0.03409624099731445
r_  generation:  0.24048447608947754
local_output_nid generation:  0.014335870742797852
local_in_edges_tensor generation:  0.024863481521606445
mini_batch_src_global generation:  0.030132055282592773
r_  generation:  0.24661970138549805
local_output_nid generation:  0.013738870620727539
local_in_edges_tensor generation:  0.01687788963317871
mini_batch_src_global generation:  0.031093120574951172
r_  generation:  0.24800515174865723
local_output_nid generation:  0.015282630920410156
local_in_edges_tensor generation:  0.014662027359008789
mini_batch_src_global generation:  0.02930593490600586
r_  generation:  0.2365269660949707
local_output_nid generation:  0.01350712776184082
local_in_edges_tensor generation:  0.014919042587280273
mini_batch_src_global generation:  0.02935051918029785
r_  generation:  0.23242497444152832
----------------------check_connections_block total spend ----------------------------- 5.622574329376221
generate_one_block  0.3115522861480713
generate_one_block  0.31873273849487305
generate_one_block  0.30825328826904297
generate_one_block  0.30869436264038086
generate_one_block  0.30904698371887207
generate_one_block  0.30295872688293457
generate_one_block  0.3444633483886719
generate_one_block  0.2913835048675537
generate_one_block  0.3103351593017578
generate_one_block  0.3054637908935547
generate_one_block  0.30043935775756836
generate_one_block  0.3086056709289551
generate_one_block  0.307969331741333
generate_one_block  0.31783127784729004
generate_one_block  0.293701171875
generate_one_block  0.29515957832336426
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04961562156677246
gen group dst list time:  0.06788396835327148
time for parepare:  0.02035808563232422
local_output_nid generation:  0.02682971954345703
local_in_edges_tensor generation:  0.06686806678771973
mini_batch_src_global generation:  0.042879343032836914
r_  generation:  0.45705270767211914
local_output_nid generation:  0.03477597236633301
local_in_edges_tensor generation:  0.048340797424316406
mini_batch_src_global generation:  0.053424835205078125
r_  generation:  0.45120716094970703
local_output_nid generation:  0.03267312049865723
local_in_edges_tensor generation:  0.03279709815979004
mini_batch_src_global generation:  0.05073952674865723
r_  generation:  0.45727086067199707
local_output_nid generation:  0.03240084648132324
local_in_edges_tensor generation:  0.035902976989746094
mini_batch_src_global generation:  0.05201458930969238
r_  generation:  0.45627856254577637
local_output_nid generation:  0.03276491165161133
local_in_edges_tensor generation:  0.09451723098754883
mini_batch_src_global generation:  0.052565813064575195
r_  generation:  0.4762234687805176
local_output_nid generation:  0.03127932548522949
local_in_edges_tensor generation:  0.03295493125915527
mini_batch_src_global generation:  0.05420804023742676
r_  generation:  0.45929503440856934
local_output_nid generation:  0.03137040138244629
local_in_edges_tensor generation:  0.03244471549987793
mini_batch_src_global generation:  0.05276989936828613
r_  generation:  0.46616530418395996
local_output_nid generation:  0.03163313865661621
local_in_edges_tensor generation:  0.03847670555114746
mini_batch_src_global generation:  0.053026437759399414
r_  generation:  0.4580230712890625
local_output_nid generation:  0.03140687942504883
local_in_edges_tensor generation:  0.039981842041015625
mini_batch_src_global generation:  0.05191349983215332
r_  generation:  0.4675416946411133
local_output_nid generation:  0.031554222106933594
local_in_edges_tensor generation:  0.03600788116455078
mini_batch_src_global generation:  0.05686664581298828
r_  generation:  0.46573400497436523
local_output_nid generation:  0.031549692153930664
local_in_edges_tensor generation:  0.035508155822753906
mini_batch_src_global generation:  0.052625417709350586
r_  generation:  0.4651906490325928
local_output_nid generation:  0.03127145767211914
local_in_edges_tensor generation:  0.03209853172302246
mini_batch_src_global generation:  0.05434274673461914
r_  generation:  0.4604015350341797
local_output_nid generation:  0.03168344497680664
local_in_edges_tensor generation:  0.04005122184753418
mini_batch_src_global generation:  0.05336809158325195
r_  generation:  0.47074413299560547
local_output_nid generation:  0.03160357475280762
local_in_edges_tensor generation:  0.04053688049316406
mini_batch_src_global generation:  0.05400967597961426
r_  generation:  0.4642753601074219
local_output_nid generation:  0.031366586685180664
local_in_edges_tensor generation:  0.0373690128326416
mini_batch_src_global generation:  0.05267214775085449
r_  generation:  0.46587610244750977
local_output_nid generation:  0.03152179718017578
local_in_edges_tensor generation:  0.03958630561828613
mini_batch_src_global generation:  0.05336189270019531
r_  generation:  0.4645876884460449
----------------------check_connections_block total spend ----------------------------- 11.055662870407104
generate_one_block  0.5849611759185791
generate_one_block  0.5928385257720947
generate_one_block  0.574397087097168
generate_one_block  0.5821022987365723
generate_one_block  0.5813531875610352
generate_one_block  0.5832886695861816
generate_one_block  0.5937762260437012
generate_one_block  0.5712640285491943
generate_one_block  0.6310513019561768
generate_one_block  0.6005673408508301
generate_one_block  0.5802667140960693
generate_one_block  0.5889027118682861
generate_one_block  0.592670202255249
generate_one_block  0.6014668941497803
generate_one_block  0.5736441612243652
generate_one_block  0.5726280212402344
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.1177988052368164  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

connection checking time:  16.678237199783325
block generation total time  14.339769124984741
average batch blocks generation time:  0.8962355703115463
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.09485578536987305  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.7511320114135742  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09472417831420898  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7547116279602051  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0948476791381836  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.746345043182373  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09454679489135742  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.748192310333252  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0948343276977539  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7483892440795898  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09453153610229492  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7453145980834961  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09477901458740234  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7446479797363281  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09411859512329102  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7386054992675781  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09478378295898438  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7475543022155762  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09438180923461914  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7446002960205078  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09469413757324219  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7433319091796875  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09454679489135742  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7439713478088379  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0948171615600586  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7485857009887695  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0946955680847168  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7542448043823242  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0946340560913086  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7417163848876953  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09444332122802734  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7434821128845215  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06573070585727692 |0.014931827783584595 |0.0035457462072372437 |8.99583101272583e-05 |0.0037491172552108765 |0.0015325546264648438 |
----------------------------------------------------------pseudo_mini_loss sum 3.2449440956115723
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5214625
Number of first layer input nodes during this epoch:  2482397
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11764669418334961  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03520941734313965
random selection method range initialization spend 0.005455732345581055
time for parepare:  0.017830371856689453
local_output_nid generation:  0.002353191375732422
local_in_edges_tensor generation:  0.005081892013549805
mini_batch_src_global generation:  0.001676797866821289
r_  generation:  0.021517038345336914
local_output_nid generation:  0.0028727054595947266
local_in_edges_tensor generation:  0.0018162727355957031
mini_batch_src_global generation:  0.0025472640991210938
r_  generation:  0.021335601806640625
local_output_nid generation:  0.002966165542602539
local_in_edges_tensor generation:  0.0017795562744140625
mini_batch_src_global generation:  0.0016446113586425781
r_  generation:  0.021641969680786133
local_output_nid generation:  0.0030591487884521484
local_in_edges_tensor generation:  0.0017917156219482422
mini_batch_src_global generation:  0.0016024112701416016
r_  generation:  0.020763397216796875
local_output_nid generation:  0.0030107498168945312
local_in_edges_tensor generation:  0.00177764892578125
mini_batch_src_global generation:  0.0016970634460449219
r_  generation:  0.02175736427307129
local_output_nid generation:  0.0030007362365722656
local_in_edges_tensor generation:  0.0019147396087646484
mini_batch_src_global generation:  0.001676797866821289
r_  generation:  0.021518468856811523
local_output_nid generation:  0.0029811859130859375
local_in_edges_tensor generation:  0.0017769336700439453
mini_batch_src_global generation:  0.001737833023071289
r_  generation:  0.022385358810424805
local_output_nid generation:  0.0030183792114257812
local_in_edges_tensor generation:  0.001744985580444336
mini_batch_src_global generation:  0.0017256736755371094
r_  generation:  0.022215604782104492
local_output_nid generation:  0.003033161163330078
local_in_edges_tensor generation:  0.0017371177673339844
mini_batch_src_global generation:  0.0017659664154052734
r_  generation:  0.022474288940429688
local_output_nid generation:  0.0030438899993896484
local_in_edges_tensor generation:  0.0017490386962890625
mini_batch_src_global generation:  0.001795053482055664
r_  generation:  0.022864103317260742
local_output_nid generation:  0.0030362606048583984
local_in_edges_tensor generation:  0.0017819404602050781
mini_batch_src_global generation:  0.0018117427825927734
r_  generation:  0.02259039878845215
local_output_nid generation:  0.003039121627807617
local_in_edges_tensor generation:  0.0017523765563964844
mini_batch_src_global generation:  0.0017578601837158203
r_  generation:  0.022308349609375
local_output_nid generation:  0.003052949905395508
local_in_edges_tensor generation:  0.0018172264099121094
mini_batch_src_global generation:  0.00434422492980957
r_  generation:  0.0217740535736084
local_output_nid generation:  0.002997159957885742
local_in_edges_tensor generation:  0.0017735958099365234
mini_batch_src_global generation:  0.0017042160034179688
r_  generation:  0.021863460540771484
local_output_nid generation:  0.003021717071533203
local_in_edges_tensor generation:  0.0017809867858886719
mini_batch_src_global generation:  0.001832723617553711
r_  generation:  0.023072481155395508
local_output_nid generation:  0.0030019283294677734
local_in_edges_tensor generation:  0.0017380714416503906
mini_batch_src_global generation:  0.0018367767333984375
r_  generation:  0.022818326950073242
----------------------check_connections_block total spend ----------------------------- 0.5761260986328125
generate_one_block  0.03895115852355957
generate_one_block  0.03215599060058594
generate_one_block  0.03119969367980957
generate_one_block  0.03107762336730957
generate_one_block  0.030889511108398438
generate_one_block  0.03371930122375488
generate_one_block  0.03127646446228027
generate_one_block  0.03171110153198242
generate_one_block  0.03179025650024414
generate_one_block  0.032126426696777344
generate_one_block  0.030797958374023438
generate_one_block  0.031592369079589844
generate_one_block  0.030785560607910156
generate_one_block  0.030857324600219727
generate_one_block  0.03254580497741699
generate_one_block  0.032068729400634766
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03960537910461426
gen group dst list time:  0.019020795822143555
time for parepare:  0.01937246322631836
local_output_nid generation:  0.00943136215209961
local_in_edges_tensor generation:  0.018128633499145508
mini_batch_src_global generation:  0.024239063262939453
r_  generation:  0.21616148948669434
local_output_nid generation:  0.013881444931030273
local_in_edges_tensor generation:  0.01658034324645996
mini_batch_src_global generation:  0.029689311981201172
r_  generation:  0.22748374938964844
local_output_nid generation:  0.013482093811035156
local_in_edges_tensor generation:  0.013556718826293945
mini_batch_src_global generation:  0.026563644409179688
r_  generation:  0.22893118858337402
local_output_nid generation:  0.013361215591430664
local_in_edges_tensor generation:  0.013299942016601562
mini_batch_src_global generation:  0.027187824249267578
r_  generation:  0.22730588912963867
local_output_nid generation:  0.013985395431518555
local_in_edges_tensor generation:  0.013608932495117188
mini_batch_src_global generation:  0.02918720245361328
r_  generation:  0.23383569717407227
local_output_nid generation:  0.013907432556152344
local_in_edges_tensor generation:  0.01442408561706543
mini_batch_src_global generation:  0.028954505920410156
r_  generation:  0.23500609397888184
local_output_nid generation:  0.014319896697998047
local_in_edges_tensor generation:  0.014555692672729492
mini_batch_src_global generation:  0.029665470123291016
r_  generation:  0.23866891860961914
local_output_nid generation:  0.013963699340820312
local_in_edges_tensor generation:  0.014666080474853516
mini_batch_src_global generation:  0.029676198959350586
r_  generation:  0.2382369041442871
local_output_nid generation:  0.014103174209594727
local_in_edges_tensor generation:  0.014540672302246094
mini_batch_src_global generation:  0.03266716003417969
r_  generation:  0.240065336227417
local_output_nid generation:  0.013461112976074219
local_in_edges_tensor generation:  0.020645856857299805
mini_batch_src_global generation:  0.030102252960205078
r_  generation:  0.24017620086669922
local_output_nid generation:  0.013211727142333984
local_in_edges_tensor generation:  0.014258861541748047
mini_batch_src_global generation:  0.029534339904785156
r_  generation:  0.2362074851989746
local_output_nid generation:  0.013042926788330078
local_in_edges_tensor generation:  0.014229059219360352
mini_batch_src_global generation:  0.029635906219482422
r_  generation:  0.23557782173156738
local_output_nid generation:  0.013358592987060547
local_in_edges_tensor generation:  0.015111446380615234
mini_batch_src_global generation:  0.028485774993896484
r_  generation:  0.23489594459533691
local_output_nid generation:  0.01315617561340332
local_in_edges_tensor generation:  0.013423681259155273
mini_batch_src_global generation:  0.029136180877685547
r_  generation:  0.23319387435913086
local_output_nid generation:  0.013649940490722656
local_in_edges_tensor generation:  0.015480756759643555
mini_batch_src_global generation:  0.029855728149414062
r_  generation:  0.24664759635925293
local_output_nid generation:  0.013217449188232422
local_in_edges_tensor generation:  0.013256549835205078
mini_batch_src_global generation:  0.030023574829101562
r_  generation:  0.23891925811767578
----------------------check_connections_block total spend ----------------------------- 5.510229825973511
generate_one_block  0.29894089698791504
generate_one_block  0.30193305015563965
generate_one_block  0.2984793186187744
generate_one_block  0.29819178581237793
generate_one_block  0.2968270778656006
generate_one_block  0.298555850982666
generate_one_block  0.32099461555480957
generate_one_block  0.3044867515563965
generate_one_block  0.3023552894592285
generate_one_block  0.30956602096557617
generate_one_block  0.29663753509521484
generate_one_block  0.29979395866394043
generate_one_block  0.29620838165283203
generate_one_block  0.29750490188598633
generate_one_block  0.3078188896179199
generate_one_block  0.30750274658203125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.042638301849365234
gen group dst list time:  0.06354904174804688
time for parepare:  0.01850104331970215
local_output_nid generation:  0.027589797973632812
local_in_edges_tensor generation:  0.04479098320007324
mini_batch_src_global generation:  0.042999267578125
r_  generation:  0.4422290325164795
local_output_nid generation:  0.032112836837768555
local_in_edges_tensor generation:  0.035444021224975586
mini_batch_src_global generation:  0.05161595344543457
r_  generation:  0.4545881748199463
local_output_nid generation:  0.033303260803222656
local_in_edges_tensor generation:  0.03492474555969238
mini_batch_src_global generation:  0.04960894584655762
r_  generation:  0.4583768844604492
local_output_nid generation:  0.03287100791931152
local_in_edges_tensor generation:  0.035318613052368164
mini_batch_src_global generation:  0.05229997634887695
r_  generation:  0.45620179176330566
local_output_nid generation:  0.032388925552368164
local_in_edges_tensor generation:  0.07520771026611328
mini_batch_src_global generation:  0.0515904426574707
r_  generation:  0.46738433837890625
local_output_nid generation:  0.03203749656677246
local_in_edges_tensor generation:  0.031301259994506836
mini_batch_src_global generation:  0.054972171783447266
r_  generation:  0.45955896377563477
local_output_nid generation:  0.032206058502197266
local_in_edges_tensor generation:  0.03531026840209961
mini_batch_src_global generation:  0.05243492126464844
r_  generation:  0.4641890525817871
local_output_nid generation:  0.03237795829772949
local_in_edges_tensor generation:  0.031359195709228516
mini_batch_src_global generation:  0.05319929122924805
r_  generation:  0.4624338150024414
local_output_nid generation:  0.0325314998626709
local_in_edges_tensor generation:  0.033841848373413086
mini_batch_src_global generation:  0.05397152900695801
r_  generation:  0.46825337409973145
local_output_nid generation:  0.032491445541381836
local_in_edges_tensor generation:  0.03590250015258789
mini_batch_src_global generation:  0.053114891052246094
r_  generation:  0.4629817008972168
local_output_nid generation:  0.032189369201660156
local_in_edges_tensor generation:  0.032746076583862305
mini_batch_src_global generation:  0.05212998390197754
r_  generation:  0.4709010124206543
local_output_nid generation:  0.032656192779541016
local_in_edges_tensor generation:  0.03167080879211426
mini_batch_src_global generation:  0.05314779281616211
r_  generation:  0.46321606636047363
local_output_nid generation:  0.03203725814819336
local_in_edges_tensor generation:  0.0320584774017334
mini_batch_src_global generation:  0.05178213119506836
r_  generation:  0.46703338623046875
local_output_nid generation:  0.032265663146972656
local_in_edges_tensor generation:  0.03122234344482422
mini_batch_src_global generation:  0.052979230880737305
r_  generation:  0.46012425422668457
local_output_nid generation:  0.032474517822265625
local_in_edges_tensor generation:  0.04097342491149902
mini_batch_src_global generation:  0.06334161758422852
r_  generation:  0.4710667133331299
local_output_nid generation:  0.03363800048828125
local_in_edges_tensor generation:  0.033479928970336914
mini_batch_src_global generation:  0.053371429443359375
r_  generation:  0.46035003662109375
----------------------check_connections_block total spend ----------------------------- 10.959807872772217
generate_one_block  0.5881974697113037
generate_one_block  0.5900137424468994
generate_one_block  0.5806102752685547
generate_one_block  0.5779786109924316
generate_one_block  0.5793046951293945
generate_one_block  0.5789506435394287
generate_one_block  0.5851104259490967
generate_one_block  0.5777015686035156
generate_one_block  0.6489875316619873
generate_one_block  0.5886201858520508
generate_one_block  0.5867288112640381
generate_one_block  0.5809626579284668
generate_one_block  0.5787990093231201
generate_one_block  0.589439868927002
generate_one_block  0.6048448085784912
generate_one_block  0.600836992263794
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11764669418334961  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

connection checking time:  16.470037698745728
block generation total time  14.272884368896484
average batch blocks generation time:  0.8920552730560303
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09474802017211914  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7441682815551758  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09454679489135742  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.747736930847168  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09473991394042969  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7433662414550781  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0943303108215332  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7426848411560059  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09469413757324219  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7437911033630371  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0942850112915039  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7425708770751953  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0947427749633789  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.746211051940918  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09446096420288086  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7440671920776367  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09481334686279297  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.748481273651123  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09453439712524414  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.752110481262207  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0947122573852539  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7431578636169434  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09442996978759766  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7432847023010254  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.094573974609375  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7405233383178711  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09438705444335938  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7415943145751953  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09493732452392578  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7550458908081055  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09445714950561523  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7444963455200195  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06316287815570831 |0.01093745231628418 |0.003450244665145874 |9.150803089141846e-05 |0.0031905919313430786 |0.0017495155334472656 |
----------------------------------------------------------pseudo_mini_loss sum 2.6028223037719727
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  5206291
Number of first layer input nodes during this epoch:  2479074
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11802101135253906  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021723508834838867
random selection method range initialization spend 0.005626201629638672
time for parepare:  0.01762104034423828
local_output_nid generation:  0.0023806095123291016
local_in_edges_tensor generation:  0.006424427032470703
mini_batch_src_global generation:  0.0017650127410888672
r_  generation:  0.021259069442749023
local_output_nid generation:  0.0029692649841308594
local_in_edges_tensor generation:  0.00177764892578125
mini_batch_src_global generation:  0.002110004425048828
r_  generation:  0.02250957489013672
local_output_nid generation:  0.0029904842376708984
local_in_edges_tensor generation:  0.0017697811126708984
mini_batch_src_global generation:  0.0017828941345214844
r_  generation:  0.02221083641052246
local_output_nid generation:  0.0029854774475097656
local_in_edges_tensor generation:  0.0018067359924316406
mini_batch_src_global generation:  0.0017268657684326172
r_  generation:  0.021464109420776367
local_output_nid generation:  0.0029821395874023438
local_in_edges_tensor generation:  0.00168609619140625
mini_batch_src_global generation:  0.0016908645629882812
r_  generation:  0.02132272720336914
local_output_nid generation:  0.0030083656311035156
local_in_edges_tensor generation:  0.0017533302307128906
mini_batch_src_global generation:  0.0017397403717041016
r_  generation:  0.022144794464111328
local_output_nid generation:  0.003060579299926758
local_in_edges_tensor generation:  0.0016527175903320312
mini_batch_src_global generation:  0.0017590522766113281
r_  generation:  0.022366762161254883
local_output_nid generation:  0.0030231475830078125
local_in_edges_tensor generation:  0.0017120838165283203
mini_batch_src_global generation:  0.0017876625061035156
r_  generation:  0.021963834762573242
local_output_nid generation:  0.0030112266540527344
local_in_edges_tensor generation:  0.0016961097717285156
mini_batch_src_global generation:  0.001773834228515625
r_  generation:  0.022489309310913086
local_output_nid generation:  0.0029973983764648438
local_in_edges_tensor generation:  0.0017101764678955078
mini_batch_src_global generation:  0.0017709732055664062
r_  generation:  0.022432804107666016
local_output_nid generation:  0.0029697418212890625
local_in_edges_tensor generation:  0.0016808509826660156
mini_batch_src_global generation:  0.0017850399017333984
r_  generation:  0.023266315460205078
local_output_nid generation:  0.003022432327270508
local_in_edges_tensor generation:  0.0019783973693847656
mini_batch_src_global generation:  0.0018541812896728516
r_  generation:  0.0223691463470459
local_output_nid generation:  0.003017902374267578
local_in_edges_tensor generation:  0.0016810894012451172
mini_batch_src_global generation:  0.0017614364624023438
r_  generation:  0.022040605545043945
local_output_nid generation:  0.0030777454376220703
local_in_edges_tensor generation:  0.0017054080963134766
mini_batch_src_global generation:  0.0017573833465576172
r_  generation:  0.02237081527709961
local_output_nid generation:  0.003000020980834961
local_in_edges_tensor generation:  0.0017647743225097656
mini_batch_src_global generation:  0.0017657279968261719
r_  generation:  0.02241802215576172
local_output_nid generation:  0.00360870361328125
local_in_edges_tensor generation:  0.00177001953125
mini_batch_src_global generation:  0.0017955303192138672
r_  generation:  0.02298736572265625
----------------------check_connections_block total spend ----------------------------- 0.5754363536834717
generate_one_block  0.030580520629882812
generate_one_block  0.03220343589782715
generate_one_block  0.032506465911865234
generate_one_block  0.03146219253540039
generate_one_block  0.03062582015991211
generate_one_block  0.034017086029052734
generate_one_block  0.030954599380493164
generate_one_block  0.03141927719116211
generate_one_block  0.03157472610473633
generate_one_block  0.031191587448120117
generate_one_block  0.031293392181396484
generate_one_block  0.030845165252685547
generate_one_block  0.030965328216552734
generate_one_block  0.03140068054199219
generate_one_block  0.0315089225769043
generate_one_block  0.03226828575134277
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04229736328125
gen group dst list time:  0.019076824188232422
time for parepare:  0.01945805549621582
local_output_nid generation:  0.009871482849121094
local_in_edges_tensor generation:  0.03150820732116699
mini_batch_src_global generation:  0.022279977798461914
r_  generation:  0.21863627433776855
local_output_nid generation:  0.013295412063598633
local_in_edges_tensor generation:  0.021616220474243164
mini_batch_src_global generation:  0.0328519344329834
r_  generation:  0.22818708419799805
local_output_nid generation:  0.013553142547607422
local_in_edges_tensor generation:  0.015939950942993164
mini_batch_src_global generation:  0.029346227645874023
r_  generation:  0.23553943634033203
local_output_nid generation:  0.014106512069702148
local_in_edges_tensor generation:  0.017206668853759766
mini_batch_src_global generation:  0.027289152145385742
r_  generation:  0.2313988208770752
local_output_nid generation:  0.013981342315673828
local_in_edges_tensor generation:  0.018904685974121094
mini_batch_src_global generation:  0.028443098068237305
r_  generation:  0.23252153396606445
local_output_nid generation:  0.013860702514648438
local_in_edges_tensor generation:  0.01506662368774414
mini_batch_src_global generation:  0.02892780303955078
r_  generation:  0.23438096046447754
local_output_nid generation:  0.014001131057739258
local_in_edges_tensor generation:  0.017551898956298828
mini_batch_src_global generation:  0.0289764404296875
r_  generation:  0.23490142822265625
local_output_nid generation:  0.01386570930480957
local_in_edges_tensor generation:  0.014445066452026367
mini_batch_src_global generation:  0.029516935348510742
r_  generation:  0.2374098300933838
local_output_nid generation:  0.01396799087524414
local_in_edges_tensor generation:  0.01580667495727539
mini_batch_src_global generation:  0.030436038970947266
r_  generation:  0.24037456512451172
local_output_nid generation:  0.013883113861083984
local_in_edges_tensor generation:  0.015616178512573242
mini_batch_src_global generation:  0.03355264663696289
r_  generation:  0.2402510643005371
local_output_nid generation:  0.013824224472045898
local_in_edges_tensor generation:  0.01763153076171875
mini_batch_src_global generation:  0.030228137969970703
r_  generation:  0.24218344688415527
local_output_nid generation:  0.013309955596923828
local_in_edges_tensor generation:  0.015118122100830078
mini_batch_src_global generation:  0.029386281967163086
r_  generation:  0.2342989444732666
local_output_nid generation:  0.013268709182739258
local_in_edges_tensor generation:  0.015183687210083008
mini_batch_src_global generation:  0.029204845428466797
r_  generation:  0.23547720909118652
local_output_nid generation:  0.013126611709594727
local_in_edges_tensor generation:  0.014724969863891602
mini_batch_src_global generation:  0.02916407585144043
r_  generation:  0.23232245445251465
local_output_nid generation:  0.013063192367553711
local_in_edges_tensor generation:  0.014988183975219727
mini_batch_src_global generation:  0.029175996780395508
r_  generation:  0.23716974258422852
local_output_nid generation:  0.013492822647094727
local_in_edges_tensor generation:  0.01511526107788086
mini_batch_src_global generation:  0.03128957748413086
r_  generation:  0.24411916732788086
----------------------check_connections_block total spend ----------------------------- 5.564625263214111
generate_one_block  0.3036484718322754
generate_one_block  0.3057229518890381
generate_one_block  0.3083646297454834
generate_one_block  0.29873061180114746
generate_one_block  0.30559229850769043
generate_one_block  0.3006293773651123
generate_one_block  0.3240170478820801
generate_one_block  0.2978169918060303
generate_one_block  0.30995750427246094
generate_one_block  0.30084872245788574
generate_one_block  0.3115103244781494
generate_one_block  0.29407501220703125
generate_one_block  0.2943747043609619
generate_one_block  0.29300808906555176
generate_one_block  0.3012814521789551
generate_one_block  0.3105926513671875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.033056020736694336
gen group dst list time:  0.0659494400024414
time for parepare:  0.017856597900390625
local_output_nid generation:  0.027083158493041992
local_in_edges_tensor generation:  0.05319666862487793
mini_batch_src_global generation:  0.0434722900390625
r_  generation:  0.44706225395202637
local_output_nid generation:  0.032386064529418945
local_in_edges_tensor generation:  0.037514686584472656
mini_batch_src_global generation:  0.054619550704956055
r_  generation:  0.46236181259155273
local_output_nid generation:  0.03186941146850586
local_in_edges_tensor generation:  0.03666400909423828
mini_batch_src_global generation:  0.060461997985839844
r_  generation:  0.4643094539642334
local_output_nid generation:  0.032186031341552734
local_in_edges_tensor generation:  0.03146052360534668
mini_batch_src_global generation:  0.05270218849182129
r_  generation:  0.45526552200317383
local_output_nid generation:  0.03223562240600586
local_in_edges_tensor generation:  0.07395029067993164
mini_batch_src_global generation:  0.05188727378845215
r_  generation:  0.46191859245300293
local_output_nid generation:  0.03169870376586914
local_in_edges_tensor generation:  0.03486752510070801
mini_batch_src_global generation:  0.055933237075805664
r_  generation:  0.46128153800964355
local_output_nid generation:  0.03194093704223633
local_in_edges_tensor generation:  0.03379225730895996
mini_batch_src_global generation:  0.05406999588012695
r_  generation:  0.46614861488342285
local_output_nid generation:  0.03210282325744629
local_in_edges_tensor generation:  0.03230881690979004
mini_batch_src_global generation:  0.053922176361083984
r_  generation:  0.4623744487762451
local_output_nid generation:  0.03195071220397949
local_in_edges_tensor generation:  0.03170418739318848
mini_batch_src_global generation:  0.052355289459228516
r_  generation:  0.4665262699127197
local_output_nid generation:  0.03207111358642578
local_in_edges_tensor generation:  0.03456759452819824
mini_batch_src_global generation:  0.05400824546813965
r_  generation:  0.4626138210296631
local_output_nid generation:  0.032518863677978516
local_in_edges_tensor generation:  0.033434152603149414
mini_batch_src_global generation:  0.05738329887390137
r_  generation:  0.4707355499267578
local_output_nid generation:  0.03229832649230957
local_in_edges_tensor generation:  0.03171396255493164
mini_batch_src_global generation:  0.05318117141723633
r_  generation:  0.46079444885253906
local_output_nid generation:  0.032030582427978516
local_in_edges_tensor generation:  0.0330812931060791
mini_batch_src_global generation:  0.051825761795043945
r_  generation:  0.46602821350097656
local_output_nid generation:  0.032563209533691406
local_in_edges_tensor generation:  0.03345465660095215
mini_batch_src_global generation:  0.054761648178100586
r_  generation:  0.4603128433227539
local_output_nid generation:  0.03235125541687012
local_in_edges_tensor generation:  0.031954288482666016
mini_batch_src_global generation:  0.05441904067993164
r_  generation:  0.4680638313293457
local_output_nid generation:  0.032373905181884766
local_in_edges_tensor generation:  0.033149003982543945
mini_batch_src_global generation:  0.053395748138427734
r_  generation:  0.4607977867126465
----------------------check_connections_block total spend ----------------------------- 10.982636451721191
generate_one_block  0.5813941955566406
generate_one_block  0.5816683769226074
generate_one_block  0.5832886695861816
generate_one_block  0.5782177448272705
generate_one_block  0.5725765228271484
generate_one_block  0.5804328918457031
generate_one_block  0.5807390213012695
generate_one_block  0.5744626522064209
generate_one_block  0.6178350448608398
generate_one_block  0.5798470973968506
generate_one_block  0.5879549980163574
generate_one_block  0.5759568214416504
generate_one_block  0.5790805816650391
generate_one_block  0.5808959007263184
generate_one_block  0.5894365310668945
generate_one_block  0.5944406986236572
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11802101135253906  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

connection checking time:  16.547261714935303
block generation total time  14.19839859008789
average batch blocks generation time:  0.8873999118804932
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09477090835571289  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7437715530395508  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09440946578979492  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7452855110168457  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09488201141357422  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7518224716186523  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09428024291992188  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7438116073608398  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09468746185302734  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.742192268371582  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09448671340942383  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7444419860839844  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09475517272949219  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7433023452758789  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09442949295043945  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7429990768432617  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09479045867919922  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7445430755615234  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09436988830566406  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7452731132507324  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09491825103759766  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7523961067199707  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09423160552978516  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7431817054748535  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09464454650878906  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7408943176269531  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09441137313842773  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7437429428100586  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09473323822021484  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7450757026672363  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0944819450378418  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7502994537353516  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06486739218235016 |0.010255441069602966 |0.0035730749368667603 |9.140372276306152e-05 |0.0036651045083999634 |0.0015649795532226562 |
----------------------------------------------------------pseudo_mini_loss sum 2.3508949279785156
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  5206371
Number of first layer input nodes during this epoch:  2478983
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.118133544921875  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022684812545776367
random selection method range initialization spend 0.005402803421020508
time for parepare:  0.018274545669555664
local_output_nid generation:  0.002306699752807617
local_in_edges_tensor generation:  0.004027605056762695
mini_batch_src_global generation:  0.0018672943115234375
r_  generation:  0.021791696548461914
local_output_nid generation:  0.002972126007080078
local_in_edges_tensor generation:  0.0018067359924316406
mini_batch_src_global generation:  0.002059459686279297
r_  generation:  0.02305912971496582
local_output_nid generation:  0.0029888153076171875
local_in_edges_tensor generation:  0.0017905235290527344
mini_batch_src_global generation:  0.0017600059509277344
r_  generation:  0.021563053131103516
local_output_nid generation:  0.0030202865600585938
local_in_edges_tensor generation:  0.0017714500427246094
mini_batch_src_global generation:  0.0017151832580566406
r_  generation:  0.02185201644897461
local_output_nid generation:  0.0030434131622314453
local_in_edges_tensor generation:  0.0019164085388183594
mini_batch_src_global generation:  0.0017807483673095703
r_  generation:  0.0219876766204834
local_output_nid generation:  0.003075838088989258
local_in_edges_tensor generation:  0.001817941665649414
mini_batch_src_global generation:  0.0017206668853759766
r_  generation:  0.021684885025024414
local_output_nid generation:  0.0030646324157714844
local_in_edges_tensor generation:  0.0018010139465332031
mini_batch_src_global generation:  0.0018131732940673828
r_  generation:  0.022942543029785156
local_output_nid generation:  0.0030145645141601562
local_in_edges_tensor generation:  0.001743316650390625
mini_batch_src_global generation:  0.0018520355224609375
r_  generation:  0.022788286209106445
local_output_nid generation:  0.0030269622802734375
local_in_edges_tensor generation:  0.0018200874328613281
mini_batch_src_global generation:  0.0018100738525390625
r_  generation:  0.02256464958190918
local_output_nid generation:  0.003031492233276367
local_in_edges_tensor generation:  0.0018062591552734375
mini_batch_src_global generation:  0.001852273941040039
r_  generation:  0.022812604904174805
local_output_nid generation:  0.003076791763305664
local_in_edges_tensor generation:  0.001794576644897461
mini_batch_src_global generation:  0.0017845630645751953
r_  generation:  0.022564411163330078
local_output_nid generation:  0.003077983856201172
local_in_edges_tensor generation:  0.001813650131225586
mini_batch_src_global generation:  0.0018367767333984375
r_  generation:  0.022656917572021484
local_output_nid generation:  0.003022909164428711
local_in_edges_tensor generation:  0.0017666816711425781
mini_batch_src_global generation:  0.001760721206665039
r_  generation:  0.02205038070678711
local_output_nid generation:  0.0030181407928466797
local_in_edges_tensor generation:  0.0017633438110351562
mini_batch_src_global generation:  0.0017805099487304688
r_  generation:  0.022417783737182617
local_output_nid generation:  0.0030286312103271484
local_in_edges_tensor generation:  0.0017499923706054688
mini_batch_src_global generation:  0.001771688461303711
r_  generation:  0.022207021713256836
local_output_nid generation:  0.003005504608154297
local_in_edges_tensor generation:  0.00173187255859375
mini_batch_src_global generation:  0.0017824172973632812
r_  generation:  0.022641658782958984
----------------------check_connections_block total spend ----------------------------- 0.5734832286834717
generate_one_block  0.03112959861755371
generate_one_block  0.03175806999206543
generate_one_block  0.031243562698364258
generate_one_block  0.031540870666503906
generate_one_block  0.03081536293029785
generate_one_block  0.03374171257019043
generate_one_block  0.03220176696777344
generate_one_block  0.03134012222290039
generate_one_block  0.03137683868408203
generate_one_block  0.03152728080749512
generate_one_block  0.03134751319885254
generate_one_block  0.03147172927856445
generate_one_block  0.031200170516967773
generate_one_block  0.0317227840423584
generate_one_block  0.03170204162597656
generate_one_block  0.03265523910522461
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03937482833862305
gen group dst list time:  0.01921367645263672
time for parepare:  0.020008325576782227
local_output_nid generation:  0.00976872444152832
local_in_edges_tensor generation:  0.024689674377441406
mini_batch_src_global generation:  0.022367477416992188
r_  generation:  0.21641898155212402
local_output_nid generation:  0.013465642929077148
local_in_edges_tensor generation:  0.01689004898071289
mini_batch_src_global generation:  0.028746604919433594
r_  generation:  0.2267611026763916
local_output_nid generation:  0.012932777404785156
local_in_edges_tensor generation:  0.014818429946899414
mini_batch_src_global generation:  0.026094675064086914
r_  generation:  0.22667264938354492
local_output_nid generation:  0.013881444931030273
local_in_edges_tensor generation:  0.01508784294128418
mini_batch_src_global generation:  0.03832101821899414
r_  generation:  0.23271441459655762
local_output_nid generation:  0.013904809951782227
local_in_edges_tensor generation:  0.013990640640258789
mini_batch_src_global generation:  0.028411388397216797
r_  generation:  0.230743408203125
local_output_nid generation:  0.01365971565246582
local_in_edges_tensor generation:  0.016989469528198242
mini_batch_src_global generation:  0.03914523124694824
r_  generation:  0.23541927337646484
local_output_nid generation:  0.015833616256713867
local_in_edges_tensor generation:  0.014755964279174805
mini_batch_src_global generation:  0.03563952445983887
r_  generation:  0.24004769325256348
local_output_nid generation:  0.014348983764648438
local_in_edges_tensor generation:  0.014207124710083008
mini_batch_src_global generation:  0.029087543487548828
r_  generation:  0.23610568046569824
local_output_nid generation:  0.014248371124267578
local_in_edges_tensor generation:  0.014840126037597656
mini_batch_src_global generation:  0.030362606048583984
r_  generation:  0.23980069160461426
local_output_nid generation:  0.014245033264160156
local_in_edges_tensor generation:  0.014962196350097656
mini_batch_src_global generation:  0.029570579528808594
r_  generation:  0.2408432960510254
local_output_nid generation:  0.0139923095703125
local_in_edges_tensor generation:  0.014119625091552734
mini_batch_src_global generation:  0.02921152114868164
r_  generation:  0.237351655960083
local_output_nid generation:  0.01408839225769043
local_in_edges_tensor generation:  0.014962911605834961
mini_batch_src_global generation:  0.02941107749938965
r_  generation:  0.23797178268432617
local_output_nid generation:  0.013657808303833008
local_in_edges_tensor generation:  0.014801979064941406
mini_batch_src_global generation:  0.029275178909301758
r_  generation:  0.23462700843811035
local_output_nid generation:  0.01344752311706543
local_in_edges_tensor generation:  0.015031099319458008
mini_batch_src_global generation:  0.032135963439941406
r_  generation:  0.23840546607971191
local_output_nid generation:  0.013372182846069336
local_in_edges_tensor generation:  0.015074968338012695
mini_batch_src_global generation:  0.03142952919006348
r_  generation:  0.2375354766845703
local_output_nid generation:  0.013662099838256836
local_in_edges_tensor generation:  0.014774322509765625
mini_batch_src_global generation:  0.029727458953857422
r_  generation:  0.24034881591796875
----------------------check_connections_block total spend ----------------------------- 5.549586296081543
generate_one_block  0.31023573875427246
generate_one_block  0.302875280380249
generate_one_block  0.3009176254272461
generate_one_block  0.3015732765197754
generate_one_block  0.2975118160247803
generate_one_block  0.29534912109375
generate_one_block  0.33492302894592285
generate_one_block  0.3001711368560791
generate_one_block  0.3073282241821289
generate_one_block  0.30712389945983887
generate_one_block  0.3020496368408203
generate_one_block  0.3000023365020752
generate_one_block  0.2987203598022461
generate_one_block  0.29981279373168945
generate_one_block  0.29766368865966797
generate_one_block  0.30661797523498535
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.035984039306640625
gen group dst list time:  0.06383776664733887
time for parepare:  0.0181272029876709
local_output_nid generation:  0.02654290199279785
local_in_edges_tensor generation:  0.04810452461242676
mini_batch_src_global generation:  0.04248404502868652
r_  generation:  0.44557690620422363
local_output_nid generation:  0.03210592269897461
local_in_edges_tensor generation:  0.04232072830200195
mini_batch_src_global generation:  0.05244779586791992
r_  generation:  0.45434999465942383
local_output_nid generation:  0.03257441520690918
local_in_edges_tensor generation:  0.032521724700927734
mini_batch_src_global generation:  0.051061391830444336
r_  generation:  0.4620492458343506
local_output_nid generation:  0.032552242279052734
local_in_edges_tensor generation:  0.029535531997680664
mini_batch_src_global generation:  0.05495405197143555
r_  generation:  0.45775318145751953
local_output_nid generation:  0.03221845626831055
local_in_edges_tensor generation:  0.07317781448364258
mini_batch_src_global generation:  0.05369448661804199
r_  generation:  0.46877503395080566
local_output_nid generation:  0.033904075622558594
local_in_edges_tensor generation:  0.03642106056213379
mini_batch_src_global generation:  0.05315065383911133
r_  generation:  0.4599111080169678
local_output_nid generation:  0.0325925350189209
local_in_edges_tensor generation:  0.031786441802978516
mini_batch_src_global generation:  0.054172515869140625
r_  generation:  0.47348976135253906
local_output_nid generation:  0.032697200775146484
local_in_edges_tensor generation:  0.0322725772857666
mini_batch_src_global generation:  0.05379033088684082
r_  generation:  0.4619464874267578
local_output_nid generation:  0.03238320350646973
local_in_edges_tensor generation:  0.04284954071044922
mini_batch_src_global generation:  0.05399656295776367
r_  generation:  0.4656689167022705
local_output_nid generation:  0.03264737129211426
local_in_edges_tensor generation:  0.03170013427734375
mini_batch_src_global generation:  0.05331754684448242
r_  generation:  0.46398234367370605
local_output_nid generation:  0.03258562088012695
local_in_edges_tensor generation:  0.03182077407836914
mini_batch_src_global generation:  0.052344560623168945
r_  generation:  0.4660933017730713
local_output_nid generation:  0.03242635726928711
local_in_edges_tensor generation:  0.03179311752319336
mini_batch_src_global generation:  0.05586647987365723
r_  generation:  0.4600238800048828
local_output_nid generation:  0.03225517272949219
local_in_edges_tensor generation:  0.031939029693603516
mini_batch_src_global generation:  0.05208587646484375
r_  generation:  0.4646008014678955
local_output_nid generation:  0.03265070915222168
local_in_edges_tensor generation:  0.0321347713470459
mini_batch_src_global generation:  0.05506634712219238
r_  generation:  0.46243739128112793
local_output_nid generation:  0.03234529495239258
local_in_edges_tensor generation:  0.031907081604003906
mini_batch_src_global generation:  0.05247092247009277
r_  generation:  0.4658238887786865
local_output_nid generation:  0.032375335693359375
local_in_edges_tensor generation:  0.03292727470397949
mini_batch_src_global generation:  0.053275108337402344
r_  generation:  0.46105432510375977
----------------------check_connections_block total spend ----------------------------- 10.9711754322052
generate_one_block  0.5770595073699951
generate_one_block  0.5858912467956543
generate_one_block  0.6037368774414062
generate_one_block  0.5793507099151611
generate_one_block  0.5815515518188477
generate_one_block  0.5805773735046387
generate_one_block  0.5940160751342773
generate_one_block  0.5882182121276855
generate_one_block  0.6467897891998291
generate_one_block  0.5861754417419434
generate_one_block  0.5832862854003906
generate_one_block  0.5783343315124512
generate_one_block  0.5797021389007568
generate_one_block  0.5889489650726318
generate_one_block  0.595792293548584
generate_one_block  0.594245195388794
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.118133544921875  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

connection checking time:  16.520761728286743
block generation total time  14.306551933288574
average batch blocks generation time:  0.8941594958305359
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09479379653930664  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7452306747436523  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09445810317993164  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7449383735656738  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09471893310546875  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7449550628662109  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09450149536132812  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7481250762939453  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09467315673828125  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7455182075500488  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0941324234008789  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.740959644317627  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09488677978515625  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7507104873657227  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0944051742553711  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.743614673614502  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09481430053710938  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.74462890625  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0943598747253418  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7443990707397461  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09475326538085938  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7473859786987305  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09427738189697266  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7414307594299316  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09463882446289062  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.742189884185791  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0946507453918457  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7468075752258301  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09470176696777344  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7458181381225586  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09470462799072266  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7516593933105469  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06200359761714935 |0.013684779405593872 |0.0035129785537719727 |9.250640869140625e-05 |0.0034728646278381348 |0.0020105838775634766 |
----------------------------------------------------------pseudo_mini_loss sum 2.097092390060425
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  5208288
Number of first layer input nodes during this epoch:  2480368
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11825990676879883  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02286529541015625
random selection method range initialization spend 0.0056531429290771484
time for parepare:  0.01838207244873047
local_output_nid generation:  0.0023555755615234375
local_in_edges_tensor generation:  0.004191398620605469
mini_batch_src_global generation:  0.0017430782318115234
r_  generation:  0.020735979080200195
local_output_nid generation:  0.0029838085174560547
local_in_edges_tensor generation:  0.0018351078033447266
mini_batch_src_global generation:  0.0020363330841064453
r_  generation:  0.02161097526550293
local_output_nid generation:  0.0030121803283691406
local_in_edges_tensor generation:  0.0017910003662109375
mini_batch_src_global generation:  0.0016837120056152344
r_  generation:  0.02116084098815918
local_output_nid generation:  0.0030052661895751953
local_in_edges_tensor generation:  0.0017626285552978516
mini_batch_src_global generation:  0.0017626285552978516
r_  generation:  0.022457122802734375
local_output_nid generation:  0.0030498504638671875
local_in_edges_tensor generation:  0.0017826557159423828
mini_batch_src_global generation:  0.0018270015716552734
r_  generation:  0.02228999137878418
local_output_nid generation:  0.003023862838745117
local_in_edges_tensor generation:  0.001794576644897461
mini_batch_src_global generation:  0.0017664432525634766
r_  generation:  0.02206587791442871
local_output_nid generation:  0.0030384063720703125
local_in_edges_tensor generation:  0.0017344951629638672
mini_batch_src_global generation:  0.001756906509399414
r_  generation:  0.022327184677124023
local_output_nid generation:  0.0030362606048583984
local_in_edges_tensor generation:  0.001706838607788086
mini_batch_src_global generation:  0.0018239021301269531
r_  generation:  0.022690296173095703
local_output_nid generation:  0.003051280975341797
local_in_edges_tensor generation:  0.001779317855834961
mini_batch_src_global generation:  0.0017795562744140625
r_  generation:  0.022487163543701172
local_output_nid generation:  0.0030138492584228516
local_in_edges_tensor generation:  0.0017418861389160156
mini_batch_src_global generation:  0.0017902851104736328
r_  generation:  0.02230072021484375
local_output_nid generation:  0.003022909164428711
local_in_edges_tensor generation:  0.001711130142211914
mini_batch_src_global generation:  0.0017583370208740234
r_  generation:  0.022182941436767578
local_output_nid generation:  0.003030061721801758
local_in_edges_tensor generation:  0.0017027854919433594
mini_batch_src_global generation:  0.0018050670623779297
r_  generation:  0.02430438995361328
local_output_nid generation:  0.0042514801025390625
local_in_edges_tensor generation:  0.0017931461334228516
mini_batch_src_global generation:  0.0018343925476074219
r_  generation:  0.023099660873413086
local_output_nid generation:  0.0030515193939208984
local_in_edges_tensor generation:  0.0017635822296142578
mini_batch_src_global generation:  0.0017807483673095703
r_  generation:  0.022416114807128906
local_output_nid generation:  0.003061532974243164
local_in_edges_tensor generation:  0.0017673969268798828
mini_batch_src_global generation:  0.0017552375793457031
r_  generation:  0.02256917953491211
local_output_nid generation:  0.0030477046966552734
local_in_edges_tensor generation:  0.001668691635131836
mini_batch_src_global generation:  0.001758575439453125
r_  generation:  0.021593093872070312
----------------------check_connections_block total spend ----------------------------- 0.5754640102386475
generate_one_block  0.030110836029052734
generate_one_block  0.03083944320678711
generate_one_block  0.030792236328125
generate_one_block  0.03355097770690918
generate_one_block  0.031812191009521484
generate_one_block  0.033905744552612305
generate_one_block  0.0309603214263916
generate_one_block  0.03232979774475098
generate_one_block  0.031816959381103516
generate_one_block  0.03144693374633789
generate_one_block  0.030701637268066406
generate_one_block  0.031960248947143555
generate_one_block  0.03222465515136719
generate_one_block  0.03158903121948242
generate_one_block  0.031143903732299805
generate_one_block  0.03136444091796875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03629040718078613
gen group dst list time:  0.018662452697753906
time for parepare:  0.01905989646911621
local_output_nid generation:  0.009145736694335938
local_in_edges_tensor generation:  0.02588677406311035
mini_batch_src_global generation:  0.021511077880859375
r_  generation:  0.2085108757019043
local_output_nid generation:  0.013037443161010742
local_in_edges_tensor generation:  0.014944076538085938
mini_batch_src_global generation:  0.026442766189575195
r_  generation:  0.21910667419433594
local_output_nid generation:  0.013388633728027344
local_in_edges_tensor generation:  0.013016223907470703
mini_batch_src_global generation:  0.025665283203125
r_  generation:  0.22416067123413086
local_output_nid generation:  0.014086723327636719
local_in_edges_tensor generation:  0.01590871810913086
mini_batch_src_global generation:  0.028861045837402344
r_  generation:  0.2362983226776123
local_output_nid generation:  0.013982772827148438
local_in_edges_tensor generation:  0.01453709602355957
mini_batch_src_global generation:  0.02891993522644043
r_  generation:  0.237715482711792
local_output_nid generation:  0.013604879379272461
local_in_edges_tensor generation:  0.012960672378540039
mini_batch_src_global generation:  0.02978515625
r_  generation:  0.2347412109375
local_output_nid generation:  0.01383519172668457
local_in_edges_tensor generation:  0.014226913452148438
mini_batch_src_global generation:  0.028933048248291016
r_  generation:  0.23088479042053223
local_output_nid generation:  0.014277935028076172
local_in_edges_tensor generation:  0.013870954513549805
mini_batch_src_global generation:  0.029907941818237305
r_  generation:  0.24254250526428223
local_output_nid generation:  0.01423335075378418
local_in_edges_tensor generation:  0.013653755187988281
mini_batch_src_global generation:  0.029547452926635742
r_  generation:  0.23892688751220703
local_output_nid generation:  0.014162302017211914
local_in_edges_tensor generation:  0.013429641723632812
mini_batch_src_global generation:  0.033248186111450195
r_  generation:  0.23869609832763672
local_output_nid generation:  0.013789653778076172
local_in_edges_tensor generation:  0.013106107711791992
mini_batch_src_global generation:  0.03094959259033203
r_  generation:  0.23431015014648438
local_output_nid generation:  0.014056682586669922
local_in_edges_tensor generation:  0.013312101364135742
mini_batch_src_global generation:  0.02981257438659668
r_  generation:  0.2422778606414795
local_output_nid generation:  0.013549089431762695
local_in_edges_tensor generation:  0.017009973526000977
mini_batch_src_global generation:  0.030174732208251953
r_  generation:  0.2425851821899414
local_output_nid generation:  0.013097047805786133
local_in_edges_tensor generation:  0.013064861297607422
mini_batch_src_global generation:  0.03210163116455078
r_  generation:  0.23926258087158203
local_output_nid generation:  0.01322627067565918
local_in_edges_tensor generation:  0.01344609260559082
mini_batch_src_global generation:  0.029579877853393555
r_  generation:  0.23579168319702148
local_output_nid generation:  0.013011455535888672
local_in_edges_tensor generation:  0.01340341567993164
mini_batch_src_global generation:  0.028891563415527344
r_  generation:  0.23472905158996582
----------------------check_connections_block total spend ----------------------------- 5.486046314239502
generate_one_block  0.29924631118774414
generate_one_block  0.29149389266967773
generate_one_block  0.29378557205200195
generate_one_block  0.3085932731628418
generate_one_block  0.3078911304473877
generate_one_block  0.2991366386413574
generate_one_block  0.3219165802001953
generate_one_block  0.3135495185852051
generate_one_block  0.3034663200378418
generate_one_block  0.3044240474700928
generate_one_block  0.30141258239746094
generate_one_block  0.30962586402893066
generate_one_block  0.31703734397888184
generate_one_block  0.30565953254699707
generate_one_block  0.29765820503234863
generate_one_block  0.2949862480163574
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.034303903579711914
gen group dst list time:  0.06327414512634277
time for parepare:  0.017543792724609375
local_output_nid generation:  0.027736186981201172
local_in_edges_tensor generation:  0.038712263107299805
mini_batch_src_global generation:  0.040010929107666016
r_  generation:  0.444685697555542
local_output_nid generation:  0.032736778259277344
local_in_edges_tensor generation:  0.03498554229736328
mini_batch_src_global generation:  0.053646087646484375
r_  generation:  0.44963860511779785
local_output_nid generation:  0.03602242469787598
local_in_edges_tensor generation:  0.029753446578979492
mini_batch_src_global generation:  0.050508975982666016
r_  generation:  0.46129369735717773
local_output_nid generation:  0.03249073028564453
local_in_edges_tensor generation:  0.03299307823181152
mini_batch_src_global generation:  0.05236625671386719
r_  generation:  0.45772433280944824
local_output_nid generation:  0.0323643684387207
local_in_edges_tensor generation:  0.07143092155456543
mini_batch_src_global generation:  0.05143117904663086
r_  generation:  0.4679417610168457
local_output_nid generation:  0.032274484634399414
local_in_edges_tensor generation:  0.031229734420776367
mini_batch_src_global generation:  0.058098554611206055
r_  generation:  0.46433115005493164
local_output_nid generation:  0.03327798843383789
local_in_edges_tensor generation:  0.03526878356933594
mini_batch_src_global generation:  0.0526125431060791
r_  generation:  0.46959352493286133
local_output_nid generation:  0.03225827217102051
local_in_edges_tensor generation:  0.03535890579223633
mini_batch_src_global generation:  0.0530242919921875
r_  generation:  0.4633369445800781
local_output_nid generation:  0.03249812126159668
local_in_edges_tensor generation:  0.031595468521118164
mini_batch_src_global generation:  0.05426192283630371
r_  generation:  0.4674263000488281
local_output_nid generation:  0.03283405303955078
local_in_edges_tensor generation:  0.03037428855895996
mini_batch_src_global generation:  0.05341911315917969
r_  generation:  0.4594566822052002
local_output_nid generation:  0.03246307373046875
local_in_edges_tensor generation:  0.02931952476501465
mini_batch_src_global generation:  0.05195450782775879
r_  generation:  0.4653351306915283
local_output_nid generation:  0.03260207176208496
local_in_edges_tensor generation:  0.03165149688720703
mini_batch_src_global generation:  0.05505204200744629
r_  generation:  0.4650306701660156
local_output_nid generation:  0.033237457275390625
local_in_edges_tensor generation:  0.032988786697387695
mini_batch_src_global generation:  0.052597761154174805
r_  generation:  0.4685792922973633
local_output_nid generation:  0.03278923034667969
local_in_edges_tensor generation:  0.03148055076599121
mini_batch_src_global generation:  0.05331778526306152
r_  generation:  0.46323156356811523
local_output_nid generation:  0.03272056579589844
local_in_edges_tensor generation:  0.03183293342590332
mini_batch_src_global generation:  0.05220317840576172
r_  generation:  0.47019386291503906
local_output_nid generation:  0.03293013572692871
local_in_edges_tensor generation:  0.029848337173461914
mini_batch_src_global generation:  0.05386805534362793
r_  generation:  0.46591949462890625
----------------------check_connections_block total spend ----------------------------- 10.939655303955078
generate_one_block  0.5836713314056396
generate_one_block  0.5848371982574463
generate_one_block  0.576301097869873
generate_one_block  0.5819857120513916
generate_one_block  0.5832474231719971
generate_one_block  0.5916216373443604
generate_one_block  0.6009280681610107
generate_one_block  0.5880126953125
generate_one_block  0.6217434406280518
generate_one_block  0.5906736850738525
generate_one_block  0.5821456909179688
generate_one_block  0.5787477493286133
generate_one_block  0.5893745422363281
generate_one_block  0.5883445739746094
generate_one_block  0.5886270999908447
generate_one_block  0.6037428379058838
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11825990676879883  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

connection checking time:  16.42570161819458
block generation total time  14.303887844085693
average batch blocks generation time:  0.8939929902553558
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0945429801940918  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.738990306854248  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09415340423583984  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7389874458312988  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09461402893066406  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.742255687713623  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09467315673828125  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7512917518615723  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09486675262451172  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7502813339233398  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09444665908813477  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7454414367675781  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09463691711425781  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7440080642700195  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09471988677978516  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7510643005371094  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09479427337646484  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7454524040222168  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0946197509765625  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.751314640045166  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09463214874267578  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7424798011779785  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09471511840820312  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7545585632324219  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09495353698730469  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7522921562194824  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09461402893066406  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7459707260131836  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09469318389892578  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7443532943725586  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09430742263793945  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7412071228027344  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06242689490318298 |0.012489542365074158 |0.003547772765159607 |9.247660636901855e-05 |0.003169640898704529 |0.001936197280883789 |
----------------------------------------------------------pseudo_mini_loss sum 1.9425362348556519
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  5208658
Number of first layer input nodes during this epoch:  2480068
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11748790740966797  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023427486419677734
random selection method range initialization spend 0.005429983139038086
time for parepare:  0.018189191818237305
local_output_nid generation:  0.0023148059844970703
local_in_edges_tensor generation:  0.004306316375732422
mini_batch_src_global generation:  0.0017740726470947266
r_  generation:  0.020955801010131836
local_output_nid generation:  0.002943754196166992
local_in_edges_tensor generation:  0.0017914772033691406
mini_batch_src_global generation:  0.0020983219146728516
r_  generation:  0.0223996639251709
local_output_nid generation:  0.0029754638671875
local_in_edges_tensor generation:  0.0017437934875488281
mini_batch_src_global generation:  0.0017497539520263672
r_  generation:  0.021869897842407227
local_output_nid generation:  0.002992868423461914
local_in_edges_tensor generation:  0.0017666816711425781
mini_batch_src_global generation:  0.0018100738525390625
r_  generation:  0.022205829620361328
local_output_nid generation:  0.002989053726196289
local_in_edges_tensor generation:  0.0017633438110351562
mini_batch_src_global generation:  0.0017969608306884766
r_  generation:  0.021955251693725586
local_output_nid generation:  0.0030066967010498047
local_in_edges_tensor generation:  0.0017859935760498047
mini_batch_src_global generation:  0.001834869384765625
r_  generation:  0.022497177124023438
local_output_nid generation:  0.0030035972595214844
local_in_edges_tensor generation:  0.0018508434295654297
mini_batch_src_global generation:  0.001855611801147461
r_  generation:  0.023148536682128906
local_output_nid generation:  0.003013134002685547
local_in_edges_tensor generation:  0.0017371177673339844
mini_batch_src_global generation:  0.0018641948699951172
r_  generation:  0.023018836975097656
local_output_nid generation:  0.002991914749145508
local_in_edges_tensor generation:  0.0018243789672851562
mini_batch_src_global generation:  0.0018873214721679688
r_  generation:  0.02242588996887207
local_output_nid generation:  0.0029926300048828125
local_in_edges_tensor generation:  0.0017774105072021484
mini_batch_src_global generation:  0.001802682876586914
r_  generation:  0.022452354431152344
local_output_nid generation:  0.002988576889038086
local_in_edges_tensor generation:  0.0017976760864257812
mini_batch_src_global generation:  0.0018377304077148438
r_  generation:  0.022769451141357422
local_output_nid generation:  0.0030002593994140625
local_in_edges_tensor generation:  0.0018215179443359375
mini_batch_src_global generation:  0.0018227100372314453
r_  generation:  0.02232670783996582
local_output_nid generation:  0.003011941909790039
local_in_edges_tensor generation:  0.0017514228820800781
mini_batch_src_global generation:  0.0017566680908203125
r_  generation:  0.021770715713500977
local_output_nid generation:  0.0030133724212646484
local_in_edges_tensor generation:  0.0017142295837402344
mini_batch_src_global generation:  0.0017518997192382812
r_  generation:  0.021712303161621094
local_output_nid generation:  0.002966642379760742
local_in_edges_tensor generation:  0.001680612564086914
mini_batch_src_global generation:  0.0018069744110107422
r_  generation:  0.022492647171020508
local_output_nid generation:  0.0029914379119873047
local_in_edges_tensor generation:  0.0016570091247558594
mini_batch_src_global generation:  0.0018343925476074219
r_  generation:  0.022750139236450195
----------------------check_connections_block total spend ----------------------------- 0.5720620155334473
generate_one_block  0.030063390731811523
generate_one_block  0.03188967704772949
generate_one_block  0.031523704528808594
generate_one_block  0.032082319259643555
generate_one_block  0.03158760070800781
generate_one_block  0.03419160842895508
generate_one_block  0.03235268592834473
generate_one_block  0.033397674560546875
generate_one_block  0.031583547592163086
generate_one_block  0.031238794326782227
generate_one_block  0.03148508071899414
generate_one_block  0.031170368194580078
generate_one_block  0.030453205108642578
generate_one_block  0.030353307723999023
generate_one_block  0.03198838233947754
generate_one_block  0.03197216987609863
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03470945358276367
gen group dst list time:  0.017998456954956055
time for parepare:  0.018925189971923828
local_output_nid generation:  0.009124279022216797
local_in_edges_tensor generation:  0.020840883255004883
mini_batch_src_global generation:  0.020967483520507812
r_  generation:  0.22213387489318848
local_output_nid generation:  0.013085126876831055
local_in_edges_tensor generation:  0.013929128646850586
mini_batch_src_global generation:  0.0302278995513916
r_  generation:  0.2271404266357422
local_output_nid generation:  0.013425350189208984
local_in_edges_tensor generation:  0.019602298736572266
mini_batch_src_global generation:  0.027807235717773438
r_  generation:  0.24016833305358887
local_output_nid generation:  0.0167388916015625
local_in_edges_tensor generation:  0.016010046005249023
mini_batch_src_global generation:  0.033690690994262695
r_  generation:  0.2359452247619629
local_output_nid generation:  0.014046669006347656
local_in_edges_tensor generation:  0.013665914535522461
mini_batch_src_global generation:  0.02877020835876465
r_  generation:  0.23546910285949707
local_output_nid generation:  0.014268875122070312
local_in_edges_tensor generation:  0.013091564178466797
mini_batch_src_global generation:  0.028763294219970703
r_  generation:  0.2335512638092041
local_output_nid generation:  0.014403343200683594
local_in_edges_tensor generation:  0.013392925262451172
mini_batch_src_global generation:  0.03065943717956543
r_  generation:  0.24263381958007812
local_output_nid generation:  0.014130592346191406
local_in_edges_tensor generation:  0.013318061828613281
mini_batch_src_global generation:  0.02951335906982422
r_  generation:  0.234694242477417
local_output_nid generation:  0.01418757438659668
local_in_edges_tensor generation:  0.013012170791625977
mini_batch_src_global generation:  0.02909255027770996
r_  generation:  0.23677873611450195
local_output_nid generation:  0.01407933235168457
local_in_edges_tensor generation:  0.013166427612304688
mini_batch_src_global generation:  0.02920079231262207
r_  generation:  0.23515772819519043
local_output_nid generation:  0.013808727264404297
local_in_edges_tensor generation:  0.013741731643676758
mini_batch_src_global generation:  0.03031635284423828
r_  generation:  0.2383286952972412
local_output_nid generation:  0.013936281204223633
local_in_edges_tensor generation:  0.013325214385986328
mini_batch_src_global generation:  0.029367923736572266
r_  generation:  0.23340678215026855
local_output_nid generation:  0.013598203659057617
local_in_edges_tensor generation:  0.013149261474609375
mini_batch_src_global generation:  0.0290372371673584
r_  generation:  0.2319338321685791
local_output_nid generation:  0.013153314590454102
local_in_edges_tensor generation:  0.013153076171875
mini_batch_src_global generation:  0.03163504600524902
r_  generation:  0.23404502868652344
local_output_nid generation:  0.013330936431884766
local_in_edges_tensor generation:  0.014747858047485352
mini_batch_src_global generation:  0.029746532440185547
r_  generation:  0.2372903823852539
local_output_nid generation:  0.013471603393554688
local_in_edges_tensor generation:  0.013597965240478516
mini_batch_src_global generation:  0.029747486114501953
r_  generation:  0.24140119552612305
----------------------check_connections_block total spend ----------------------------- 5.511840105056763
generate_one_block  0.3055248260498047
generate_one_block  0.2960343360900879
generate_one_block  0.30445289611816406
generate_one_block  0.3087191581726074
generate_one_block  0.3024027347564697
generate_one_block  0.2997617721557617
generate_one_block  0.33251118659973145
generate_one_block  0.2998814582824707
generate_one_block  0.30042552947998047
generate_one_block  0.2955765724182129
generate_one_block  0.30477261543273926
generate_one_block  0.2938370704650879
generate_one_block  0.29310083389282227
generate_one_block  0.29567384719848633
generate_one_block  0.3066420555114746
generate_one_block  0.3081684112548828
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0299379825592041
gen group dst list time:  0.06321048736572266
time for parepare:  0.018280744552612305
local_output_nid generation:  0.02788257598876953
local_in_edges_tensor generation:  0.04376029968261719
mini_batch_src_global generation:  0.04193305969238281
r_  generation:  0.4496750831604004
local_output_nid generation:  0.03280758857727051
local_in_edges_tensor generation:  0.03764605522155762
mini_batch_src_global generation:  0.051516056060791016
r_  generation:  0.4546480178833008
local_output_nid generation:  0.032238006591796875
local_in_edges_tensor generation:  0.0313565731048584
mini_batch_src_global generation:  0.05077362060546875
r_  generation:  0.461439847946167
local_output_nid generation:  0.032326698303222656
local_in_edges_tensor generation:  0.03173017501831055
mini_batch_src_global generation:  0.05442500114440918
r_  generation:  0.45983028411865234
local_output_nid generation:  0.031960487365722656
local_in_edges_tensor generation:  0.07181406021118164
mini_batch_src_global generation:  0.05177116394042969
r_  generation:  0.4677739143371582
local_output_nid generation:  0.031838417053222656
local_in_edges_tensor generation:  0.03154754638671875
mini_batch_src_global generation:  0.05355381965637207
r_  generation:  0.4604620933532715
local_output_nid generation:  0.032212018966674805
local_in_edges_tensor generation:  0.03173565864562988
mini_batch_src_global generation:  0.05248880386352539
r_  generation:  0.4696202278137207
local_output_nid generation:  0.03219175338745117
local_in_edges_tensor generation:  0.031191349029541016
mini_batch_src_global generation:  0.05673503875732422
r_  generation:  0.4623689651489258
local_output_nid generation:  0.033251285552978516
local_in_edges_tensor generation:  0.030992507934570312
mini_batch_src_global generation:  0.05268502235412598
r_  generation:  0.46808409690856934
local_output_nid generation:  0.032189369201660156
local_in_edges_tensor generation:  0.031935930252075195
mini_batch_src_global generation:  0.055689096450805664
r_  generation:  0.46509718894958496
local_output_nid generation:  0.03243255615234375
local_in_edges_tensor generation:  0.03209567070007324
mini_batch_src_global generation:  0.05237102508544922
r_  generation:  0.4665346145629883
local_output_nid generation:  0.03231000900268555
local_in_edges_tensor generation:  0.035639047622680664
mini_batch_src_global generation:  0.05498671531677246
r_  generation:  0.46228504180908203
local_output_nid generation:  0.032124996185302734
local_in_edges_tensor generation:  0.034128665924072266
mini_batch_src_global generation:  0.05205082893371582
r_  generation:  0.4638693332672119
local_output_nid generation:  0.03218245506286621
local_in_edges_tensor generation:  0.029927968978881836
mini_batch_src_global generation:  0.053343772888183594
r_  generation:  0.46245646476745605
local_output_nid generation:  0.03242158889770508
local_in_edges_tensor generation:  0.02974700927734375
mini_batch_src_global generation:  0.05407309532165527
r_  generation:  0.47319912910461426
local_output_nid generation:  0.03255510330200195
local_in_edges_tensor generation:  0.036261796951293945
mini_batch_src_global generation:  0.05305171012878418
r_  generation:  0.4634978771209717
----------------------check_connections_block total spend ----------------------------- 10.951269149780273
generate_one_block  0.579230546951294
generate_one_block  0.5848817825317383
generate_one_block  0.5816442966461182
generate_one_block  0.5916979312896729
generate_one_block  0.5754067897796631
generate_one_block  0.5756697654724121
generate_one_block  0.5873243808746338
generate_one_block  0.5741605758666992
generate_one_block  0.6437325477600098
generate_one_block  0.5822842121124268
generate_one_block  0.5795178413391113
generate_one_block  0.5789320468902588
generate_one_block  0.5766735076904297
generate_one_block  0.5912449359893799
generate_one_block  0.5923686027526855
generate_one_block  0.5949456691741943
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11748790740966797  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

connection checking time:  16.463109254837036
block generation total time  14.237200736999512
average batch blocks generation time:  0.8898250460624695
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0946803092956543  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7441048622131348  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09434938430786133  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7431640625  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0948019027709961  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7455358505249023  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0947265625  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7545714378356934  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09474945068359375  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7433619499206543  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09435796737670898  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7434849739074707  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0949411392211914  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7505350112915039  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09441089630126953  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7436695098876953  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09474849700927734  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7467827796936035  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09434747695922852  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7424788475036621  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09475994110107422  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7463741302490234  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09435701370239258  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7414636611938477  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0945587158203125  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7349629402160645  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09431076049804688  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7428908348083496  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09476757049560547  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7465987205505371  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09475851058959961  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7524919509887695  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06171277165412903 |0.01440460979938507 |0.00401635468006134 |0.00010244548320770264 |0.003408372402191162 |0.0013713836669921875 |
----------------------------------------------------------pseudo_mini_loss sum 1.868348240852356
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  5207819
Number of first layer input nodes during this epoch:  2480648
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11837387084960938  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021376609802246094
random selection method range initialization spend 0.00486445426940918
time for parepare:  0.01820230484008789
local_output_nid generation:  0.002343416213989258
local_in_edges_tensor generation:  0.003882169723510742
mini_batch_src_global generation:  0.0017917156219482422
r_  generation:  0.022130489349365234
local_output_nid generation:  0.003040790557861328
local_in_edges_tensor generation:  0.0017094612121582031
mini_batch_src_global generation:  0.002150297164916992
r_  generation:  0.02269577980041504
local_output_nid generation:  0.0030362606048583984
local_in_edges_tensor generation:  0.0017702579498291016
mini_batch_src_global generation:  0.0017328262329101562
r_  generation:  0.021478652954101562
local_output_nid generation:  0.0030651092529296875
local_in_edges_tensor generation:  0.0017547607421875
mini_batch_src_global generation:  0.003002166748046875
r_  generation:  0.029372692108154297
local_output_nid generation:  0.004658937454223633
local_in_edges_tensor generation:  0.003144502639770508
mini_batch_src_global generation:  0.005914926528930664
r_  generation:  0.02588963508605957
local_output_nid generation:  0.0036237239837646484
local_in_edges_tensor generation:  0.0017843246459960938
mini_batch_src_global generation:  0.0018572807312011719
r_  generation:  0.03603315353393555
local_output_nid generation:  0.004769563674926758
local_in_edges_tensor generation:  0.0023174285888671875
mini_batch_src_global generation:  0.0018908977508544922
r_  generation:  0.022757768630981445
local_output_nid generation:  0.0045566558837890625
local_in_edges_tensor generation:  0.002099752426147461
mini_batch_src_global generation:  0.0018489360809326172
r_  generation:  0.0216214656829834
local_output_nid generation:  0.004561662673950195
local_in_edges_tensor generation:  0.0020117759704589844
mini_batch_src_global generation:  0.0018792152404785156
r_  generation:  0.022454500198364258
local_output_nid generation:  0.0044405460357666016
local_in_edges_tensor generation:  0.0019032955169677734
mini_batch_src_global generation:  0.0017995834350585938
r_  generation:  0.02178168296813965
local_output_nid generation:  0.004338741302490234
local_in_edges_tensor generation:  0.0019404888153076172
mini_batch_src_global generation:  0.0017931461334228516
r_  generation:  0.02288818359375
local_output_nid generation:  0.004396677017211914
local_in_edges_tensor generation:  0.0018999576568603516
mini_batch_src_global generation:  0.001847982406616211
r_  generation:  0.021990299224853516
local_output_nid generation:  0.004340171813964844
local_in_edges_tensor generation:  0.0018994808197021484
mini_batch_src_global generation:  0.001901388168334961
r_  generation:  0.02232193946838379
local_output_nid generation:  0.0043375492095947266
local_in_edges_tensor generation:  0.0019266605377197266
mini_batch_src_global generation:  0.0018587112426757812
r_  generation:  0.0227506160736084
local_output_nid generation:  0.0044057369232177734
local_in_edges_tensor generation:  0.001955270767211914
mini_batch_src_global generation:  0.0018279552459716797
r_  generation:  0.02277374267578125
local_output_nid generation:  0.004271507263183594
local_in_edges_tensor generation:  0.001961946487426758
mini_batch_src_global generation:  0.0018429756164550781
r_  generation:  0.022564172744750977
----------------------check_connections_block total spend ----------------------------- 0.6360812187194824
generate_one_block  0.04436039924621582
generate_one_block  0.03258395195007324
generate_one_block  0.0455327033996582
generate_one_block  0.03981924057006836
generate_one_block  0.0325312614440918
generate_one_block  0.04820132255554199
generate_one_block  0.033226966857910156
generate_one_block  0.04161477088928223
generate_one_block  0.03199124336242676
generate_one_block  0.03158211708068848
generate_one_block  0.0321202278137207
generate_one_block  0.031157493591308594
generate_one_block  0.0310666561126709
generate_one_block  0.05149054527282715
generate_one_block  0.03569650650024414
generate_one_block  0.049146175384521484
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0354766845703125
gen group dst list time:  0.024013996124267578
time for parepare:  0.03198528289794922
local_output_nid generation:  0.010085582733154297
local_in_edges_tensor generation:  0.03424239158630371
mini_batch_src_global generation:  0.02377772331237793
r_  generation:  0.24351239204406738
local_output_nid generation:  0.014683008193969727
local_in_edges_tensor generation:  0.018811702728271484
mini_batch_src_global generation:  0.03228926658630371
r_  generation:  0.23731136322021484
local_output_nid generation:  0.013335704803466797
local_in_edges_tensor generation:  0.01712322235107422
mini_batch_src_global generation:  0.02832341194152832
r_  generation:  0.2335660457611084
local_output_nid generation:  0.014765262603759766
local_in_edges_tensor generation:  0.01346588134765625
mini_batch_src_global generation:  0.02978372573852539
r_  generation:  0.24494171142578125
local_output_nid generation:  0.014358758926391602
local_in_edges_tensor generation:  0.013320207595825195
mini_batch_src_global generation:  0.030623912811279297
r_  generation:  0.24898219108581543
local_output_nid generation:  0.013704538345336914
local_in_edges_tensor generation:  0.014148473739624023
mini_batch_src_global generation:  0.03290557861328125
r_  generation:  0.2502927780151367
local_output_nid generation:  0.013897180557250977
local_in_edges_tensor generation:  0.013979434967041016
mini_batch_src_global generation:  0.03197836875915527
r_  generation:  0.2550191879272461
local_output_nid generation:  0.013637781143188477
local_in_edges_tensor generation:  0.013987541198730469
mini_batch_src_global generation:  0.035108089447021484
r_  generation:  0.24575304985046387
local_output_nid generation:  0.014039278030395508
local_in_edges_tensor generation:  0.013121366500854492
mini_batch_src_global generation:  0.032233476638793945
r_  generation:  0.2638719081878662
local_output_nid generation:  0.013831377029418945
local_in_edges_tensor generation:  0.013885974884033203
mini_batch_src_global generation:  0.032894134521484375
r_  generation:  0.25286269187927246
local_output_nid generation:  0.014970779418945312
local_in_edges_tensor generation:  0.01371455192565918
mini_batch_src_global generation:  0.0327451229095459
r_  generation:  0.25937533378601074
local_output_nid generation:  0.013931512832641602
local_in_edges_tensor generation:  0.016092538833618164
mini_batch_src_global generation:  0.035730838775634766
r_  generation:  0.2531626224517822
local_output_nid generation:  0.014358758926391602
local_in_edges_tensor generation:  0.020455360412597656
mini_batch_src_global generation:  0.03228259086608887
r_  generation:  0.25524067878723145
local_output_nid generation:  0.013309478759765625
local_in_edges_tensor generation:  0.017589092254638672
mini_batch_src_global generation:  0.03614616394042969
r_  generation:  0.2683103084564209
local_output_nid generation:  0.015961647033691406
local_in_edges_tensor generation:  0.017780542373657227
mini_batch_src_global generation:  0.03267812728881836
r_  generation:  0.2560303211212158
local_output_nid generation:  0.013600349426269531
local_in_edges_tensor generation:  0.014180421829223633
mini_batch_src_global generation:  0.03242754936218262
r_  generation:  0.25032949447631836
----------------------check_connections_block total spend ----------------------------- 5.942044258117676
generate_one_block  0.3177986145019531
generate_one_block  0.30678272247314453
generate_one_block  0.29712867736816406
generate_one_block  0.3063085079193115
generate_one_block  0.30524468421936035
generate_one_block  0.31073975563049316
generate_one_block  0.35079479217529297
generate_one_block  0.296184778213501
generate_one_block  0.31111598014831543
generate_one_block  0.30164504051208496
generate_one_block  0.3097691535949707
generate_one_block  0.3011147975921631
generate_one_block  0.30231428146362305
generate_one_block  0.3179023265838623
generate_one_block  0.3101654052734375
generate_one_block  0.30588316917419434
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03092789649963379
gen group dst list time:  0.07468366622924805
time for parepare:  0.019971132278442383
local_output_nid generation:  0.027825355529785156
local_in_edges_tensor generation:  0.051859140396118164
mini_batch_src_global generation:  0.04322052001953125
r_  generation:  0.45259785652160645
local_output_nid generation:  0.03227996826171875
local_in_edges_tensor generation:  0.038896799087524414
mini_batch_src_global generation:  0.05210137367248535
r_  generation:  0.45514822006225586
local_output_nid generation:  0.031798362731933594
local_in_edges_tensor generation:  0.031630516052246094
mini_batch_src_global generation:  0.05121183395385742
r_  generation:  0.45891237258911133
local_output_nid generation:  0.03206896781921387
local_in_edges_tensor generation:  0.030546188354492188
mini_batch_src_global generation:  0.061658620834350586
r_  generation:  0.45703983306884766
local_output_nid generation:  0.03240346908569336
local_in_edges_tensor generation:  0.07559967041015625
mini_batch_src_global generation:  0.05228281021118164
r_  generation:  0.47453904151916504
local_output_nid generation:  0.031958818435668945
local_in_edges_tensor generation:  0.03266096115112305
mini_batch_src_global generation:  0.054288387298583984
r_  generation:  0.46479225158691406
local_output_nid generation:  0.03309774398803711
local_in_edges_tensor generation:  0.029860973358154297
mini_batch_src_global generation:  0.05238842964172363
r_  generation:  0.4699130058288574
local_output_nid generation:  0.03210926055908203
local_in_edges_tensor generation:  0.03247356414794922
mini_batch_src_global generation:  0.05427193641662598
r_  generation:  0.46402931213378906
local_output_nid generation:  0.03387951850891113
local_in_edges_tensor generation:  0.03664255142211914
mini_batch_src_global generation:  0.053209543228149414
r_  generation:  0.4700031280517578
local_output_nid generation:  0.03243064880371094
local_in_edges_tensor generation:  0.03226113319396973
mini_batch_src_global generation:  0.05365872383117676
r_  generation:  0.4607069492340088
local_output_nid generation:  0.032509803771972656
local_in_edges_tensor generation:  0.030611038208007812
mini_batch_src_global generation:  0.05211329460144043
r_  generation:  0.47135305404663086
local_output_nid generation:  0.03424429893493652
local_in_edges_tensor generation:  0.0395658016204834
mini_batch_src_global generation:  0.05597090721130371
r_  generation:  0.4615747928619385
local_output_nid generation:  0.03239607810974121
local_in_edges_tensor generation:  0.029850244522094727
mini_batch_src_global generation:  0.05207657814025879
r_  generation:  0.48529744148254395
local_output_nid generation:  0.03528475761413574
local_in_edges_tensor generation:  0.034928083419799805
mini_batch_src_global generation:  0.055045127868652344
r_  generation:  0.46011781692504883
local_output_nid generation:  0.03355145454406738
local_in_edges_tensor generation:  0.031944990158081055
mini_batch_src_global generation:  0.0541386604309082
r_  generation:  0.47036099433898926
local_output_nid generation:  0.03314638137817383
local_in_edges_tensor generation:  0.032193660736083984
mini_batch_src_global generation:  0.053801536560058594
r_  generation:  0.4595644474029541
----------------------check_connections_block total spend ----------------------------- 11.034705638885498
generate_one_block  0.5864567756652832
generate_one_block  0.582554817199707
generate_one_block  0.5829243659973145
generate_one_block  0.5983960628509521
generate_one_block  0.5876522064208984
generate_one_block  0.5802309513092041
generate_one_block  0.584414005279541
generate_one_block  0.5863795280456543
generate_one_block  0.6154930591583252
generate_one_block  0.5842220783233643
generate_one_block  0.5866029262542725
generate_one_block  0.5856664180755615
generate_one_block  0.5785088539123535
generate_one_block  0.5825233459472656
generate_one_block  0.5868258476257324
generate_one_block  0.591789722442627
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11837387084960938  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

connection checking time:  16.976749897003174
block generation total time  14.351533651351929
average batch blocks generation time:  0.8969708532094955
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09489583969116211  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7516689300537109  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09459114074707031  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7510156631469727  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09458065032958984  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7409806251525879  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09461164474487305  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7482156753540039  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0947866439819336  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7460780143737793  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0943603515625  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7442231178283691  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0947732925415039  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7426276206970215  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09424972534179688  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7398777008056641  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09485149383544922  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7479910850524902  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09447860717773438  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7428979873657227  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0947580337524414  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7474708557128906  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09440040588378906  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7425403594970703  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09468460083007812  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7425169944763184  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09451055526733398  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7482700347900391  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09485626220703125  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.748687744140625  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09447002410888672  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7461056709289551  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06323447823524475 |0.015188679099082947 |0.0037250518798828125 |9.673833847045898e-05 |0.0034183859825134277 |0.0020096302032470703 |
----------------------------------------------------------pseudo_mini_loss sum 1.780124306678772
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  5209539
Number of first layer input nodes during this epoch:  2480806
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11788129806518555  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024288654327392578
random selection method range initialization spend 0.00555109977722168
time for parepare:  0.018439292907714844
local_output_nid generation:  0.0022881031036376953
local_in_edges_tensor generation:  0.007782936096191406
mini_batch_src_global generation:  0.0017549991607666016
r_  generation:  0.02004551887512207
local_output_nid generation:  0.0029134750366210938
local_in_edges_tensor generation:  0.0018110275268554688
mini_batch_src_global generation:  0.0020656585693359375
r_  generation:  0.0223543643951416
local_output_nid generation:  0.0029616355895996094
local_in_edges_tensor generation:  0.0017325878143310547
mini_batch_src_global generation:  0.0017206668853759766
r_  generation:  0.021510839462280273
local_output_nid generation:  0.003046751022338867
local_in_edges_tensor generation:  0.0018525123596191406
mini_batch_src_global generation:  0.0017511844635009766
r_  generation:  0.02199387550354004
local_output_nid generation:  0.0030677318572998047
local_in_edges_tensor generation:  0.001783132553100586
mini_batch_src_global generation:  0.0018193721771240234
r_  generation:  0.022552013397216797
local_output_nid generation:  0.0030143260955810547
local_in_edges_tensor generation:  0.0019707679748535156
mini_batch_src_global generation:  0.0017914772033691406
r_  generation:  0.022396087646484375
local_output_nid generation:  0.0030493736267089844
local_in_edges_tensor generation:  0.0017549991607666016
mini_batch_src_global generation:  0.0018351078033447266
r_  generation:  0.022850751876831055
local_output_nid generation:  0.003045320510864258
local_in_edges_tensor generation:  0.0017614364624023438
mini_batch_src_global generation:  0.0017664432525634766
r_  generation:  0.022318601608276367
local_output_nid generation:  0.003070831298828125
local_in_edges_tensor generation:  0.0018513202667236328
mini_batch_src_global generation:  0.0017864704132080078
r_  generation:  0.022612333297729492
local_output_nid generation:  0.0030601024627685547
local_in_edges_tensor generation:  0.0017914772033691406
mini_batch_src_global generation:  0.0018379688262939453
r_  generation:  0.024559974670410156
local_output_nid generation:  0.004617929458618164
local_in_edges_tensor generation:  0.0018153190612792969
mini_batch_src_global generation:  0.0018858909606933594
r_  generation:  0.022166728973388672
local_output_nid generation:  0.003064870834350586
local_in_edges_tensor generation:  0.0017533302307128906
mini_batch_src_global generation:  0.001789093017578125
r_  generation:  0.022186279296875
local_output_nid generation:  0.0030760765075683594
local_in_edges_tensor generation:  0.0017440319061279297
mini_batch_src_global generation:  0.0018072128295898438
r_  generation:  0.02381277084350586
local_output_nid generation:  0.0030705928802490234
local_in_edges_tensor generation:  0.0019981861114501953
mini_batch_src_global generation:  0.0018892288208007812
r_  generation:  0.022187232971191406
local_output_nid generation:  0.0030977725982666016
local_in_edges_tensor generation:  0.0017879009246826172
mini_batch_src_global generation:  0.0017800331115722656
r_  generation:  0.022748231887817383
local_output_nid generation:  0.003061056137084961
local_in_edges_tensor generation:  0.0017647743225097656
mini_batch_src_global generation:  0.0017855167388916016
r_  generation:  0.021886587142944336
----------------------check_connections_block total spend ----------------------------- 0.5817489624023438
generate_one_block  0.030044078826904297
generate_one_block  0.03172707557678223
generate_one_block  0.031217336654663086
generate_one_block  0.031003952026367188
generate_one_block  0.03170347213745117
generate_one_block  0.03460097312927246
generate_one_block  0.03153181076049805
generate_one_block  0.031184673309326172
generate_one_block  0.031130552291870117
generate_one_block  0.03174185752868652
generate_one_block  0.030717134475708008
generate_one_block  0.03149604797363281
generate_one_block  0.03214669227600098
generate_one_block  0.03123617172241211
generate_one_block  0.03123927116394043
generate_one_block  0.031155109405517578
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.035401344299316406
gen group dst list time:  0.01836228370666504
time for parepare:  0.0197756290435791
local_output_nid generation:  0.009281396865844727
local_in_edges_tensor generation:  0.02635335922241211
mini_batch_src_global generation:  0.02209782600402832
r_  generation:  0.2141878604888916
local_output_nid generation:  0.013424873352050781
local_in_edges_tensor generation:  0.014375686645507812
mini_batch_src_global generation:  0.028322219848632812
r_  generation:  0.2269608974456787
local_output_nid generation:  0.01304173469543457
local_in_edges_tensor generation:  0.01866292953491211
mini_batch_src_global generation:  0.0260465145111084
r_  generation:  0.22852206230163574
local_output_nid generation:  0.013771295547485352
local_in_edges_tensor generation:  0.014171123504638672
mini_batch_src_global generation:  0.027091264724731445
r_  generation:  0.23376178741455078
local_output_nid generation:  0.01405191421508789
local_in_edges_tensor generation:  0.017441749572753906
mini_batch_src_global generation:  0.029754161834716797
r_  generation:  0.23943114280700684
local_output_nid generation:  0.014125585556030273
local_in_edges_tensor generation:  0.016856908798217773
mini_batch_src_global generation:  0.030671119689941406
r_  generation:  0.24488496780395508
local_output_nid generation:  0.013965845108032227
local_in_edges_tensor generation:  0.013647794723510742
mini_batch_src_global generation:  0.02922344207763672
r_  generation:  0.2392714023590088
local_output_nid generation:  0.013855934143066406
local_in_edges_tensor generation:  0.013427734375
mini_batch_src_global generation:  0.028980731964111328
r_  generation:  0.23831629753112793
local_output_nid generation:  0.014201641082763672
local_in_edges_tensor generation:  0.015476226806640625
mini_batch_src_global generation:  0.030686140060424805
r_  generation:  0.2427530288696289
local_output_nid generation:  0.015074968338012695
local_in_edges_tensor generation:  0.017292022705078125
mini_batch_src_global generation:  0.030343055725097656
r_  generation:  0.24706530570983887
local_output_nid generation:  0.013515233993530273
local_in_edges_tensor generation:  0.0162355899810791
mini_batch_src_global generation:  0.02942800521850586
r_  generation:  0.23888397216796875
local_output_nid generation:  0.014059305191040039
local_in_edges_tensor generation:  0.018982887268066406
mini_batch_src_global generation:  0.030185699462890625
r_  generation:  0.24135470390319824
local_output_nid generation:  0.014222860336303711
local_in_edges_tensor generation:  0.01729607582092285
mini_batch_src_global generation:  0.03334999084472656
r_  generation:  0.24405837059020996
local_output_nid generation:  0.013091802597045898
local_in_edges_tensor generation:  0.017327070236206055
mini_batch_src_global generation:  0.0295259952545166
r_  generation:  0.23818230628967285
local_output_nid generation:  0.013269662857055664
local_in_edges_tensor generation:  0.014280319213867188
mini_batch_src_global generation:  0.03125905990600586
r_  generation:  0.2458057403564453
local_output_nid generation:  0.014906167984008789
local_in_edges_tensor generation:  0.013374805450439453
mini_batch_src_global generation:  0.032485246658325195
r_  generation:  0.24677443504333496
----------------------check_connections_block total spend ----------------------------- 5.606208562850952
generate_one_block  0.30322885513305664
generate_one_block  0.3024013042449951
generate_one_block  0.29865598678588867
generate_one_block  0.29801082611083984
generate_one_block  0.30591559410095215
generate_one_block  0.3162860870361328
generate_one_block  0.32956409454345703
generate_one_block  0.30178213119506836
generate_one_block  0.31003522872924805
generate_one_block  0.3140370845794678
generate_one_block  0.3218214511871338
generate_one_block  0.30527329444885254
generate_one_block  0.3056776523590088
generate_one_block  0.29852747917175293
generate_one_block  0.30612611770629883
generate_one_block  0.301283597946167
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03470444679260254
gen group dst list time:  0.06621932983398438
time for parepare:  0.019788265228271484
local_output_nid generation:  0.027373552322387695
local_in_edges_tensor generation:  0.052809953689575195
mini_batch_src_global generation:  0.04259347915649414
r_  generation:  0.4524393081665039
local_output_nid generation:  0.032248497009277344
local_in_edges_tensor generation:  0.04061102867126465
mini_batch_src_global generation:  0.05271029472351074
r_  generation:  0.45384812355041504
local_output_nid generation:  0.0340876579284668
local_in_edges_tensor generation:  0.03620314598083496
mini_batch_src_global generation:  0.05336260795593262
r_  generation:  0.461902379989624
local_output_nid generation:  0.03203630447387695
local_in_edges_tensor generation:  0.03533124923706055
mini_batch_src_global generation:  0.05239248275756836
r_  generation:  0.46002888679504395
local_output_nid generation:  0.03240013122558594
local_in_edges_tensor generation:  0.0771322250366211
mini_batch_src_global generation:  0.054108381271362305
r_  generation:  0.482999324798584
local_output_nid generation:  0.035396575927734375
local_in_edges_tensor generation:  0.03761744499206543
mini_batch_src_global generation:  0.056357383728027344
r_  generation:  0.4742143154144287
local_output_nid generation:  0.03293585777282715
local_in_edges_tensor generation:  0.03376960754394531
mini_batch_src_global generation:  0.05219459533691406
r_  generation:  0.47422337532043457
local_output_nid generation:  0.033071041107177734
local_in_edges_tensor generation:  0.03250837326049805
mini_batch_src_global generation:  0.05585050582885742
r_  generation:  0.4606635570526123
local_output_nid generation:  0.03303194046020508
local_in_edges_tensor generation:  0.032293081283569336
mini_batch_src_global generation:  0.05286073684692383
r_  generation:  0.4664900302886963
local_output_nid generation:  0.03330636024475098
local_in_edges_tensor generation:  0.03146100044250488
mini_batch_src_global generation:  0.05638313293457031
r_  generation:  0.4611382484436035
local_output_nid generation:  0.03288531303405762
local_in_edges_tensor generation:  0.03231048583984375
mini_batch_src_global generation:  0.07590556144714355
r_  generation:  0.4694197177886963
local_output_nid generation:  0.03304171562194824
local_in_edges_tensor generation:  0.030930757522583008
mini_batch_src_global generation:  0.056122779846191406
r_  generation:  0.45905041694641113
local_output_nid generation:  0.034108638763427734
local_in_edges_tensor generation:  0.03540921211242676
mini_batch_src_global generation:  0.05350828170776367
r_  generation:  0.4673769474029541
local_output_nid generation:  0.033002376556396484
local_in_edges_tensor generation:  0.031059980392456055
mini_batch_src_global generation:  0.054746150970458984
r_  generation:  0.465451717376709
local_output_nid generation:  0.033056020736694336
local_in_edges_tensor generation:  0.03270697593688965
mini_batch_src_global generation:  0.05233621597290039
r_  generation:  0.47046732902526855
local_output_nid generation:  0.03321218490600586
local_in_edges_tensor generation:  0.03871893882751465
mini_batch_src_global generation:  0.0548403263092041
r_  generation:  0.4664132595062256
----------------------check_connections_block total spend ----------------------------- 11.093903541564941
generate_one_block  0.5932645797729492
generate_one_block  0.5962729454040527
generate_one_block  0.5841245651245117
generate_one_block  0.5800204277038574
generate_one_block  0.585841178894043
generate_one_block  0.5939836502075195
generate_one_block  0.6062183380126953
generate_one_block  0.5957529544830322
generate_one_block  0.6756677627563477
generate_one_block  0.604560136795044
generate_one_block  0.5797944068908691
generate_one_block  0.5844354629516602
generate_one_block  0.600386381149292
generate_one_block  0.5866751670837402
generate_one_block  0.589003324508667
generate_one_block  0.5837059020996094
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11788129806518555  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

connection checking time:  16.700112104415894
block generation total time  14.458333969116211
average batch blocks generation time:  0.9036458730697632
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09458208084106445  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7392148971557617  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09451150894165039  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7467107772827148  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09467887878417969  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7452163696289062  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09408283233642578  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7412757873535156  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0948476791381836  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7500152587890625  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09480857849121094  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.752960205078125  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09476661682128906  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7445263862609863  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09446048736572266  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7463164329528809  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09482479095458984  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.746617317199707  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09478187561035156  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7541918754577637  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0946502685546875  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7411923408508301  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09452056884765625  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7448968887329102  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09490394592285156  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7525272369384766  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09433174133300781  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.743201732635498  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09479808807373047  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7459259033203125  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09420967102050781  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7407736778259277  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06262035667896271 |0.01392112672328949 |0.004148229956626892 |0.00010403990745544434 |0.0035216957330703735 |0.0028100013732910156 |
----------------------------------------------------------pseudo_mini_loss sum 1.6907509565353394
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  5209540
Number of first layer input nodes during this epoch:  2480078
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11727190017700195  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025540828704833984
random selection method range initialization spend 0.006190299987792969
time for parepare:  0.018471240997314453
local_output_nid generation:  0.0023758411407470703
local_in_edges_tensor generation:  0.0055294036865234375
mini_batch_src_global generation:  0.0021944046020507812
r_  generation:  0.023823022842407227
local_output_nid generation:  0.0029065608978271484
local_in_edges_tensor generation:  0.0017740726470947266
mini_batch_src_global generation:  0.001992464065551758
r_  generation:  0.0219268798828125
local_output_nid generation:  0.0029795169830322266
local_in_edges_tensor generation:  0.0018076896667480469
mini_batch_src_global generation:  0.0017325878143310547
r_  generation:  0.021236896514892578
local_output_nid generation:  0.0030603408813476562
local_in_edges_tensor generation:  0.0017840862274169922
mini_batch_src_global generation:  0.0017437934875488281
r_  generation:  0.022304296493530273
local_output_nid generation:  0.003009796142578125
local_in_edges_tensor generation:  0.0017788410186767578
mini_batch_src_global generation:  0.001848459243774414
r_  generation:  0.022156476974487305
local_output_nid generation:  0.003671884536743164
local_in_edges_tensor generation:  0.0018603801727294922
mini_batch_src_global generation:  0.0017824172973632812
r_  generation:  0.021871328353881836
local_output_nid generation:  0.0030274391174316406
local_in_edges_tensor generation:  0.001733541488647461
mini_batch_src_global generation:  0.0017728805541992188
r_  generation:  0.023017406463623047
local_output_nid generation:  0.003013134002685547
local_in_edges_tensor generation:  0.0017209053039550781
mini_batch_src_global generation:  0.0017976760864257812
r_  generation:  0.02497124671936035
local_output_nid generation:  0.0030248165130615234
local_in_edges_tensor generation:  0.0018122196197509766
mini_batch_src_global generation:  0.001982450485229492
r_  generation:  0.022098779678344727
local_output_nid generation:  0.003033161163330078
local_in_edges_tensor generation:  0.0016906261444091797
mini_batch_src_global generation:  0.0018329620361328125
r_  generation:  0.022040367126464844
local_output_nid generation:  0.0030896663665771484
local_in_edges_tensor generation:  0.00174713134765625
mini_batch_src_global generation:  0.0017817020416259766
r_  generation:  0.022490262985229492
local_output_nid generation:  0.0030517578125
local_in_edges_tensor generation:  0.0031652450561523438
mini_batch_src_global generation:  0.0017826557159423828
r_  generation:  0.02170395851135254
local_output_nid generation:  0.0030727386474609375
local_in_edges_tensor generation:  0.0018982887268066406
mini_batch_src_global generation:  0.001819610595703125
r_  generation:  0.023173093795776367
local_output_nid generation:  0.002991199493408203
local_in_edges_tensor generation:  0.0017590522766113281
mini_batch_src_global generation:  0.0017547607421875
r_  generation:  0.022135257720947266
local_output_nid generation:  0.0031576156616210938
local_in_edges_tensor generation:  0.0030875205993652344
mini_batch_src_global generation:  0.0018763542175292969
r_  generation:  0.022609472274780273
local_output_nid generation:  0.0030863285064697266
local_in_edges_tensor generation:  0.0018968582153320312
mini_batch_src_global generation:  0.0018923282623291016
r_  generation:  0.02209186553955078
----------------------check_connections_block total spend ----------------------------- 0.5841588973999023
generate_one_block  0.03473067283630371
generate_one_block  0.03138899803161621
generate_one_block  0.030610084533691406
generate_one_block  0.03347206115722656
generate_one_block  0.03127598762512207
generate_one_block  0.034246206283569336
generate_one_block  0.0326085090637207
generate_one_block  0.03442072868347168
generate_one_block  0.03118586540222168
generate_one_block  0.031366825103759766
generate_one_block  0.031642913818359375
generate_one_block  0.031343936920166016
generate_one_block  0.03316092491149902
generate_one_block  0.031149625778198242
generate_one_block  0.031661272048950195
generate_one_block  0.03215622901916504
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03623318672180176
gen group dst list time:  0.01839900016784668
time for parepare:  0.02080082893371582
local_output_nid generation:  0.009795665740966797
local_in_edges_tensor generation:  0.02518939971923828
mini_batch_src_global generation:  0.03130698204040527
r_  generation:  0.22636818885803223
local_output_nid generation:  0.013285636901855469
local_in_edges_tensor generation:  0.020389080047607422
mini_batch_src_global generation:  0.029277563095092773
r_  generation:  0.23619437217712402
local_output_nid generation:  0.015321016311645508
local_in_edges_tensor generation:  0.017093181610107422
mini_batch_src_global generation:  0.02789449691772461
r_  generation:  0.22922062873840332
local_output_nid generation:  0.014402389526367188
local_in_edges_tensor generation:  0.01640176773071289
mini_batch_src_global generation:  0.0288693904876709
r_  generation:  0.2408442497253418
local_output_nid generation:  0.015953779220581055
local_in_edges_tensor generation:  0.012949228286743164
mini_batch_src_global generation:  0.02865767478942871
r_  generation:  0.23511362075805664
local_output_nid generation:  0.013791561126708984
local_in_edges_tensor generation:  0.015658855438232422
mini_batch_src_global generation:  0.028520584106445312
r_  generation:  0.2351515293121338
local_output_nid generation:  0.01442265510559082
local_in_edges_tensor generation:  0.014590263366699219
mini_batch_src_global generation:  0.029172897338867188
r_  generation:  0.24265670776367188
local_output_nid generation:  0.016030550003051758
local_in_edges_tensor generation:  0.01550436019897461
mini_batch_src_global generation:  0.030797481536865234
r_  generation:  0.24529361724853516
local_output_nid generation:  0.014400959014892578
local_in_edges_tensor generation:  0.013594388961791992
mini_batch_src_global generation:  0.02962660789489746
r_  generation:  0.2377021312713623
local_output_nid generation:  0.014082193374633789
local_in_edges_tensor generation:  0.013526678085327148
mini_batch_src_global generation:  0.029329776763916016
r_  generation:  0.2437577247619629
local_output_nid generation:  0.014925718307495117
local_in_edges_tensor generation:  0.013576030731201172
mini_batch_src_global generation:  0.029555559158325195
r_  generation:  0.23970794677734375
local_output_nid generation:  0.013855934143066406
local_in_edges_tensor generation:  0.013020753860473633
mini_batch_src_global generation:  0.030976057052612305
r_  generation:  0.23888254165649414
local_output_nid generation:  0.01460886001586914
local_in_edges_tensor generation:  0.01681065559387207
mini_batch_src_global generation:  0.03181624412536621
r_  generation:  0.24884390830993652
local_output_nid generation:  0.013361215591430664
local_in_edges_tensor generation:  0.014191389083862305
mini_batch_src_global generation:  0.02939748764038086
r_  generation:  0.2358241081237793
local_output_nid generation:  0.013643503189086914
local_in_edges_tensor generation:  0.013581275939941406
mini_batch_src_global generation:  0.02971792221069336
r_  generation:  0.24088716506958008
local_output_nid generation:  0.013397216796875
local_in_edges_tensor generation:  0.01296687126159668
mini_batch_src_global generation:  0.029628276824951172
r_  generation:  0.24189281463623047
----------------------check_connections_block total spend ----------------------------- 5.6143434047698975
generate_one_block  0.3215816020965576
generate_one_block  0.29702210426330566
generate_one_block  0.30229854583740234
generate_one_block  0.31456565856933594
generate_one_block  0.3044891357421875
generate_one_block  0.3055706024169922
generate_one_block  0.3454904556274414
generate_one_block  0.31311798095703125
generate_one_block  0.3010067939758301
generate_one_block  0.29969191551208496
generate_one_block  0.30570054054260254
generate_one_block  0.30478453636169434
generate_one_block  0.32027459144592285
generate_one_block  0.2985553741455078
generate_one_block  0.3043069839477539
generate_one_block  0.3074045181274414
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03677821159362793
gen group dst list time:  0.06584572792053223
time for parepare:  0.019614219665527344
local_output_nid generation:  0.029579639434814453
local_in_edges_tensor generation:  0.05506253242492676
mini_batch_src_global generation:  0.04251408576965332
r_  generation:  0.4514186382293701
local_output_nid generation:  0.031911611557006836
local_in_edges_tensor generation:  0.0384218692779541
mini_batch_src_global generation:  0.05225181579589844
r_  generation:  0.4495272636413574
local_output_nid generation:  0.03286862373352051
local_in_edges_tensor generation:  0.03206825256347656
mini_batch_src_global generation:  0.05077075958251953
r_  generation:  0.45907163619995117
local_output_nid generation:  0.03194236755371094
local_in_edges_tensor generation:  0.03907012939453125
mini_batch_src_global generation:  0.052364349365234375
r_  generation:  0.4571239948272705
local_output_nid generation:  0.0319821834564209
local_in_edges_tensor generation:  0.07739663124084473
mini_batch_src_global generation:  0.05230069160461426
r_  generation:  0.4646925926208496
local_output_nid generation:  0.03216123580932617
local_in_edges_tensor generation:  0.03591728210449219
mini_batch_src_global generation:  0.0548253059387207
r_  generation:  0.47515177726745605
local_output_nid generation:  0.03502988815307617
local_in_edges_tensor generation:  0.03710651397705078
mini_batch_src_global generation:  0.05544424057006836
r_  generation:  0.4667024612426758
local_output_nid generation:  0.032937049865722656
local_in_edges_tensor generation:  0.033233642578125
mini_batch_src_global generation:  0.05410408973693848
r_  generation:  0.45934271812438965
local_output_nid generation:  0.03308868408203125
local_in_edges_tensor generation:  0.029862403869628906
mini_batch_src_global generation:  0.05264687538146973
r_  generation:  0.46750688552856445
local_output_nid generation:  0.0333402156829834
local_in_edges_tensor generation:  0.03176164627075195
mini_batch_src_global generation:  0.056752681732177734
r_  generation:  0.460369348526001
local_output_nid generation:  0.03284811973571777
local_in_edges_tensor generation:  0.029875516891479492
mini_batch_src_global generation:  0.06335639953613281
r_  generation:  0.46760010719299316
local_output_nid generation:  0.032723188400268555
local_in_edges_tensor generation:  0.030393362045288086
mini_batch_src_global generation:  0.05321550369262695
r_  generation:  0.4555659294128418
local_output_nid generation:  0.03291201591491699
local_in_edges_tensor generation:  0.030147075653076172
mini_batch_src_global generation:  0.05421090126037598
r_  generation:  0.47153663635253906
local_output_nid generation:  0.03296995162963867
local_in_edges_tensor generation:  0.030045747756958008
mini_batch_src_global generation:  0.053839683532714844
r_  generation:  0.4597742557525635
local_output_nid generation:  0.033390045166015625
local_in_edges_tensor generation:  0.030152559280395508
mini_batch_src_global generation:  0.05236411094665527
r_  generation:  0.4695096015930176
local_output_nid generation:  0.03245234489440918
local_in_edges_tensor generation:  0.030249834060668945
mini_batch_src_global generation:  0.055387258529663086
r_  generation:  0.4596233367919922
----------------------check_connections_block total spend ----------------------------- 10.994269371032715
generate_one_block  0.5872032642364502
generate_one_block  0.5876643657684326
generate_one_block  0.5821247100830078
generate_one_block  0.5787866115570068
generate_one_block  0.5870335102081299
generate_one_block  0.5805890560150146
generate_one_block  0.5863347053527832
generate_one_block  0.5882697105407715
generate_one_block  0.6254456043243408
generate_one_block  0.5914182662963867
generate_one_block  0.5996782779693604
generate_one_block  0.5831315517425537
generate_one_block  0.5994648933410645
generate_one_block  0.580247163772583
generate_one_block  0.5960056781768799
generate_one_block  0.5905065536499023
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11727190017700195  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

connection checking time:  16.608612775802612
block generation total time  14.38976526260376
average batch blocks generation time:  0.899360328912735
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09496164321899414  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.754432201385498  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09433937072753906  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7403097152709961  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09467220306396484  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7417616844177246  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09464597702026367  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7520828247070312  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09464645385742188  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7417211532592773  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09427404403686523  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7408719062805176  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0948190689086914  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7512946128845215  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09467935562133789  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7530441284179688  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09473419189453125  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7460427284240723  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09466791152954102  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7454895973205566  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09473705291748047  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7477717399597168  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09418249130249023  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7393970489501953  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09505176544189453  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7534189224243164  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0942840576171875  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7403192520141602  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.094818115234375  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7477312088012695  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09456348419189453  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7437319755554199  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06282560527324677 |0.014496386051177979 |0.0037799179553985596 |0.00010059773921966553 |0.003376513719558716 |0.0030672550201416016 |
----------------------------------------------------------pseudo_mini_loss sum 1.6309064626693726
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  5210766
Number of first layer input nodes during this epoch:  2481324
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11808347702026367  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023716211318969727
random selection method range initialization spend 0.005025386810302734
time for parepare:  0.017754077911376953
local_output_nid generation:  0.0023555755615234375
local_in_edges_tensor generation:  0.004316806793212891
mini_batch_src_global generation:  0.0018432140350341797
r_  generation:  0.02172112464904785
local_output_nid generation:  0.0029709339141845703
local_in_edges_tensor generation:  0.0017240047454833984
mini_batch_src_global generation:  0.0021238327026367188
r_  generation:  0.038085222244262695
local_output_nid generation:  0.00487065315246582
local_in_edges_tensor generation:  0.0024662017822265625
mini_batch_src_global generation:  0.0020780563354492188
r_  generation:  0.02165675163269043
local_output_nid generation:  0.004635810852050781
local_in_edges_tensor generation:  0.0023076534271240234
mini_batch_src_global generation:  0.001909494400024414
r_  generation:  0.020704269409179688
local_output_nid generation:  0.004389286041259766
local_in_edges_tensor generation:  0.002149343490600586
mini_batch_src_global generation:  0.0018935203552246094
r_  generation:  0.021290302276611328
local_output_nid generation:  0.004464626312255859
local_in_edges_tensor generation:  0.002097606658935547
mini_batch_src_global generation:  0.0017969608306884766
r_  generation:  0.020218610763549805
local_output_nid generation:  0.004284381866455078
local_in_edges_tensor generation:  0.002139568328857422
mini_batch_src_global generation:  0.0017921924591064453
r_  generation:  0.02117919921875
local_output_nid generation:  0.004409313201904297
local_in_edges_tensor generation:  0.0020580291748046875
mini_batch_src_global generation:  0.0017817020416259766
r_  generation:  0.020955562591552734
local_output_nid generation:  0.004235267639160156
local_in_edges_tensor generation:  0.002001047134399414
mini_batch_src_global generation:  0.0018031597137451172
r_  generation:  0.020746707916259766
local_output_nid generation:  0.004335165023803711
local_in_edges_tensor generation:  0.002145051956176758
mini_batch_src_global generation:  0.0018527507781982422
r_  generation:  0.02378988265991211
local_output_nid generation:  0.004434347152709961
local_in_edges_tensor generation:  0.002377748489379883
mini_batch_src_global generation:  0.013645410537719727
r_  generation:  0.025038719177246094
local_output_nid generation:  0.004674673080444336
local_in_edges_tensor generation:  0.0020682811737060547
mini_batch_src_global generation:  0.003273487091064453
r_  generation:  0.027358293533325195
local_output_nid generation:  0.00431370735168457
local_in_edges_tensor generation:  0.002008676528930664
mini_batch_src_global generation:  0.001842498779296875
r_  generation:  0.022364139556884766
local_output_nid generation:  0.004281759262084961
local_in_edges_tensor generation:  0.002019166946411133
mini_batch_src_global generation:  0.0018529891967773438
r_  generation:  0.0215761661529541
local_output_nid generation:  0.004367351531982422
local_in_edges_tensor generation:  0.0021715164184570312
mini_batch_src_global generation:  0.001867055892944336
r_  generation:  0.022411823272705078
local_output_nid generation:  0.004307746887207031
local_in_edges_tensor generation:  0.002038717269897461
mini_batch_src_global generation:  0.0019240379333496094
r_  generation:  0.02211308479309082
----------------------check_connections_block total spend ----------------------------- 0.6416382789611816
generate_one_block  0.04515242576599121
generate_one_block  0.03229117393493652
generate_one_block  0.03219127655029297
generate_one_block  0.03329348564147949
generate_one_block  0.03615140914916992
generate_one_block  0.03430008888244629
generate_one_block  0.033400535583496094
generate_one_block  0.03130054473876953
generate_one_block  0.03121352195739746
generate_one_block  0.03200793266296387
generate_one_block  0.03127026557922363
generate_one_block  0.03147268295288086
generate_one_block  0.03145194053649902
generate_one_block  0.03390812873840332
generate_one_block  0.03287315368652344
generate_one_block  0.03303265571594238
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06209993362426758
gen group dst list time:  0.022182703018188477
time for parepare:  0.02131485939025879
local_output_nid generation:  0.013445854187011719
local_in_edges_tensor generation:  0.02591085433959961
mini_batch_src_global generation:  0.023578882217407227
r_  generation:  0.2330026626586914
local_output_nid generation:  0.016902446746826172
local_in_edges_tensor generation:  0.019020557403564453
mini_batch_src_global generation:  0.03555750846862793
r_  generation:  0.23976588249206543
local_output_nid generation:  0.018955707550048828
local_in_edges_tensor generation:  0.019594669342041016
mini_batch_src_global generation:  0.0289154052734375
r_  generation:  0.2451314926147461
local_output_nid generation:  0.017221927642822266
local_in_edges_tensor generation:  0.017551898956298828
mini_batch_src_global generation:  0.029309511184692383
r_  generation:  0.24390053749084473
local_output_nid generation:  0.01766824722290039
local_in_edges_tensor generation:  0.027753114700317383
mini_batch_src_global generation:  0.0390629768371582
r_  generation:  0.25111913681030273
local_output_nid generation:  0.018255233764648438
local_in_edges_tensor generation:  0.01768326759338379
mini_batch_src_global generation:  0.031107425689697266
r_  generation:  0.2333064079284668
local_output_nid generation:  0.019610166549682617
local_in_edges_tensor generation:  0.015380382537841797
mini_batch_src_global generation:  0.030795812606811523
r_  generation:  0.24854612350463867
local_output_nid generation:  0.017488718032836914
local_in_edges_tensor generation:  0.016865015029907227
mini_batch_src_global generation:  0.05218768119812012
r_  generation:  0.24340152740478516
local_output_nid generation:  0.017447948455810547
local_in_edges_tensor generation:  0.01880502700805664
mini_batch_src_global generation:  0.031221628189086914
r_  generation:  0.24780058860778809
local_output_nid generation:  0.01770186424255371
local_in_edges_tensor generation:  0.017395734786987305
mini_batch_src_global generation:  0.03252863883972168
r_  generation:  0.24733448028564453
local_output_nid generation:  0.0172274112701416
local_in_edges_tensor generation:  0.01627182960510254
mini_batch_src_global generation:  0.030919790267944336
r_  generation:  0.2454211711883545
local_output_nid generation:  0.017445087432861328
local_in_edges_tensor generation:  0.015001535415649414
mini_batch_src_global generation:  0.031929731369018555
r_  generation:  0.24414849281311035
local_output_nid generation:  0.0177001953125
local_in_edges_tensor generation:  0.017268896102905273
mini_batch_src_global generation:  0.032419681549072266
r_  generation:  0.24888134002685547
local_output_nid generation:  0.016754150390625
local_in_edges_tensor generation:  0.016335248947143555
mini_batch_src_global generation:  0.03147411346435547
r_  generation:  0.23926758766174316
local_output_nid generation:  0.01683783531188965
local_in_edges_tensor generation:  0.01544499397277832
mini_batch_src_global generation:  0.03181195259094238
r_  generation:  0.24690651893615723
local_output_nid generation:  0.016890525817871094
local_in_edges_tensor generation:  0.017945051193237305
mini_batch_src_global generation:  0.0330960750579834
r_  generation:  0.28065061569213867
----------------------check_connections_block total spend ----------------------------- 5.971529960632324
generate_one_block  0.32477259635925293
generate_one_block  0.3095386028289795
generate_one_block  0.3120255470275879
generate_one_block  0.30384349822998047
generate_one_block  0.31218814849853516
generate_one_block  0.2951796054840088
generate_one_block  0.3561244010925293
generate_one_block  0.3052973747253418
generate_one_block  0.30046892166137695
generate_one_block  0.31438302993774414
generate_one_block  0.30411291122436523
generate_one_block  0.30913376808166504
generate_one_block  0.3124692440032959
generate_one_block  0.30451011657714844
generate_one_block  0.30713725090026855
generate_one_block  0.31902575492858887
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03590059280395508
gen group dst list time:  0.07046127319335938
time for parepare:  0.020342588424682617
local_output_nid generation:  0.029209375381469727
local_in_edges_tensor generation:  0.05318880081176758
mini_batch_src_global generation:  0.04249382019042969
r_  generation:  0.4473083019256592
local_output_nid generation:  0.03266572952270508
local_in_edges_tensor generation:  0.03589296340942383
mini_batch_src_global generation:  0.05199170112609863
r_  generation:  0.4491739273071289
local_output_nid generation:  0.03271341323852539
local_in_edges_tensor generation:  0.031243324279785156
mini_batch_src_global generation:  0.052824974060058594
r_  generation:  0.4584815502166748
local_output_nid generation:  0.032108306884765625
local_in_edges_tensor generation:  0.02947711944580078
mini_batch_src_global generation:  0.05222296714782715
r_  generation:  0.4538562297821045
local_output_nid generation:  0.03242015838623047
local_in_edges_tensor generation:  0.0738365650177002
mini_batch_src_global generation:  0.05554652214050293
r_  generation:  0.47305750846862793
local_output_nid generation:  0.0321354866027832
local_in_edges_tensor generation:  0.03129291534423828
mini_batch_src_global generation:  0.0531764030456543
r_  generation:  0.4585897922515869
local_output_nid generation:  0.03219008445739746
local_in_edges_tensor generation:  0.03205156326293945
mini_batch_src_global generation:  0.05266284942626953
r_  generation:  0.46916913986206055
local_output_nid generation:  0.03241157531738281
local_in_edges_tensor generation:  0.03130292892456055
mini_batch_src_global generation:  0.05680394172668457
r_  generation:  0.45965051651000977
local_output_nid generation:  0.0324254035949707
local_in_edges_tensor generation:  0.031778812408447266
mini_batch_src_global generation:  0.05449032783508301
r_  generation:  0.4696183204650879
local_output_nid generation:  0.03307604789733887
local_in_edges_tensor generation:  0.02956366539001465
mini_batch_src_global generation:  0.05344676971435547
r_  generation:  0.4636247158050537
local_output_nid generation:  0.032306671142578125
local_in_edges_tensor generation:  0.03556060791015625
mini_batch_src_global generation:  0.05203962326049805
r_  generation:  0.46859049797058105
local_output_nid generation:  0.032341957092285156
local_in_edges_tensor generation:  0.038614749908447266
mini_batch_src_global generation:  0.05538177490234375
r_  generation:  0.46064066886901855
local_output_nid generation:  0.03232431411743164
local_in_edges_tensor generation:  0.03368115425109863
mini_batch_src_global generation:  0.05222773551940918
r_  generation:  0.465651273727417
local_output_nid generation:  0.03222489356994629
local_in_edges_tensor generation:  0.03613758087158203
mini_batch_src_global generation:  0.06427645683288574
r_  generation:  0.4644193649291992
local_output_nid generation:  0.034120798110961914
local_in_edges_tensor generation:  0.03176712989807129
mini_batch_src_global generation:  0.052175283432006836
r_  generation:  0.46577882766723633
local_output_nid generation:  0.03322649002075195
local_in_edges_tensor generation:  0.03409719467163086
mini_batch_src_global generation:  0.05349135398864746
r_  generation:  0.4673922061920166
----------------------check_connections_block total spend ----------------------------- 10.995163917541504
generate_one_block  0.5900735855102539
generate_one_block  0.5798633098602295
generate_one_block  0.5858588218688965
generate_one_block  0.5858802795410156
generate_one_block  0.5887672901153564
generate_one_block  0.5832293033599854
generate_one_block  0.5970122814178467
generate_one_block  0.5851037502288818
generate_one_block  0.6583619117736816
generate_one_block  0.5929210186004639
generate_one_block  0.5825693607330322
generate_one_block  0.5819089412689209
generate_one_block  0.5811352729797363
generate_one_block  0.581650972366333
generate_one_block  0.5839917659759521
generate_one_block  0.5989885330200195
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11808347702026367  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

connection checking time:  16.966693878173828
block generation total time  14.447527170181274
average batch blocks generation time:  0.9029704481363297
block dataloader generation time/epoch 33.79300260543823
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0948939323425293  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7509899139404297  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09463834762573242  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7476091384887695  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09486770629882812  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.74993896484375  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0943155288696289  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7423510551452637  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09493064880371094  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7521910667419434  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09417295455932617  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7372994422912598  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09475421905517578  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7419700622558594  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09435272216796875  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.741786003112793  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09467506408691406  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7434272766113281  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09454917907714844  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7505807876586914  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09468460083007812  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.743288516998291  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09456062316894531  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7475404739379883  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09479808807373047  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7483768463134766  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09437990188598633  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7440214157104492  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0948019027709961  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7439846992492676  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09468555450439453  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7493915557861328  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06381838023662567 |0.014174938201904297 |0.003716379404067993 |9.335577487945557e-05 |0.0036552995443344116 |0.002960681915283203 |
----------------------------------------------------------pseudo_mini_loss sum 1.5901883840560913
Total (block generation + training)time/epoch 35.231635093688965
Training time/epoch 1.4384236335754395
Training time without block to device /epoch 1.2116246223449707
Training time without total dataloading part /epoch 0.12240123748779297
load block tensor time/epoch 1.0210940837860107
block to device time/epoch 0.22679901123046875
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  5208928
Number of first layer input nodes during this epoch:  2480517
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11832761764526367  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026615142822265625
random selection method range initialization spend 0.0053958892822265625
time for parepare:  0.017748117446899414
local_output_nid generation:  0.002382040023803711
local_in_edges_tensor generation:  0.008421659469604492
mini_batch_src_global generation:  0.0017774105072021484
r_  generation:  0.020905017852783203
local_output_nid generation:  0.0028743743896484375
local_in_edges_tensor generation:  0.0017771720886230469
mini_batch_src_global generation:  0.002070903778076172
r_  generation:  0.022184371948242188
local_output_nid generation:  0.002942800521850586
local_in_edges_tensor generation:  0.0017652511596679688
mini_batch_src_global generation:  0.0016884803771972656
r_  generation:  0.02169632911682129
local_output_nid generation:  0.0029518604278564453
local_in_edges_tensor generation:  0.001680612564086914
mini_batch_src_global generation:  0.0017561912536621094
r_  generation:  0.02337813377380371
local_output_nid generation:  0.0029990673065185547
local_in_edges_tensor generation:  0.0017628669738769531
mini_batch_src_global generation:  0.0017096996307373047
r_  generation:  0.020839214324951172
local_output_nid generation:  0.0029778480529785156
local_in_edges_tensor generation:  0.0017549991607666016
mini_batch_src_global generation:  0.0017392635345458984
r_  generation:  0.02210402488708496
local_output_nid generation:  0.0029845237731933594
local_in_edges_tensor generation:  0.0016655921936035156
mini_batch_src_global generation:  0.00179290771484375
r_  generation:  0.0240478515625
local_output_nid generation:  0.0029892921447753906
local_in_edges_tensor generation:  0.0018329620361328125
mini_batch_src_global generation:  0.0018036365509033203
r_  generation:  0.022409915924072266
local_output_nid generation:  0.003014802932739258
local_in_edges_tensor generation:  0.001710653305053711
mini_batch_src_global generation:  0.0019481182098388672
r_  generation:  0.023268461227416992
local_output_nid generation:  0.002986907958984375
local_in_edges_tensor generation:  0.0017108917236328125
mini_batch_src_global generation:  0.0018050670623779297
r_  generation:  0.02404952049255371
local_output_nid generation:  0.003030538558959961
local_in_edges_tensor generation:  0.0017254352569580078
mini_batch_src_global generation:  0.0017473697662353516
r_  generation:  0.02207493782043457
local_output_nid generation:  0.0029973983764648438
local_in_edges_tensor generation:  0.0016493797302246094
mini_batch_src_global generation:  0.0017888545989990234
r_  generation:  0.02240777015686035
local_output_nid generation:  0.0029609203338623047
local_in_edges_tensor generation:  0.0016331672668457031
mini_batch_src_global generation:  0.0017859935760498047
r_  generation:  0.023114919662475586
local_output_nid generation:  0.005371809005737305
local_in_edges_tensor generation:  0.00311279296875
mini_batch_src_global generation:  0.0017976760864257812
r_  generation:  0.02254939079284668
local_output_nid generation:  0.003002166748046875
local_in_edges_tensor generation:  0.0017409324645996094
mini_batch_src_global generation:  0.0018172264099121094
r_  generation:  0.023234844207763672
local_output_nid generation:  0.0030057430267333984
local_in_edges_tensor generation:  0.0016634464263916016
mini_batch_src_global generation:  0.0018084049224853516
r_  generation:  0.022553682327270508
----------------------check_connections_block total spend ----------------------------- 0.5842149257659912
generate_one_block  0.03198432922363281
generate_one_block  0.0319514274597168
generate_one_block  0.03116917610168457
generate_one_block  0.03389430046081543
generate_one_block  0.030483245849609375
generate_one_block  0.0340116024017334
generate_one_block  0.03432488441467285
generate_one_block  0.031651973724365234
generate_one_block  0.03206992149353027
generate_one_block  0.03222942352294922
generate_one_block  0.031071901321411133
generate_one_block  0.03220224380493164
generate_one_block  0.0318148136138916
generate_one_block  0.031119823455810547
generate_one_block  0.03246498107910156
generate_one_block  0.032460689544677734
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.034820556640625
gen group dst list time:  0.021045207977294922
time for parepare:  0.01996612548828125
local_output_nid generation:  0.009514331817626953
local_in_edges_tensor generation:  0.023003339767456055
mini_batch_src_global generation:  0.021668434143066406
r_  generation:  0.21993803977966309
local_output_nid generation:  0.013288259506225586
local_in_edges_tensor generation:  0.015503644943237305
mini_batch_src_global generation:  0.027216672897338867
r_  generation:  0.22746920585632324
local_output_nid generation:  0.013520240783691406
local_in_edges_tensor generation:  0.01457357406616211
mini_batch_src_global generation:  0.027731895446777344
r_  generation:  0.23397350311279297
local_output_nid generation:  0.01406407356262207
local_in_edges_tensor generation:  0.018024921417236328
mini_batch_src_global generation:  0.02993011474609375
r_  generation:  0.2379460334777832
local_output_nid generation:  0.01349329948425293
local_in_edges_tensor generation:  0.013575553894042969
mini_batch_src_global generation:  0.028345108032226562
r_  generation:  0.22861528396606445
local_output_nid generation:  0.013765573501586914
local_in_edges_tensor generation:  0.013124704360961914
mini_batch_src_global generation:  0.028844356536865234
r_  generation:  0.2365245819091797
local_output_nid generation:  0.01369023323059082
local_in_edges_tensor generation:  0.013181447982788086
mini_batch_src_global generation:  0.02892446517944336
r_  generation:  0.23215508460998535
local_output_nid generation:  0.014073610305786133
local_in_edges_tensor generation:  0.013256072998046875
mini_batch_src_global generation:  0.029389142990112305
r_  generation:  0.2435166835784912
local_output_nid generation:  0.014313697814941406
local_in_edges_tensor generation:  0.01635432243347168
mini_batch_src_global generation:  0.030982017517089844
r_  generation:  0.24356627464294434
local_output_nid generation:  0.014804601669311523
local_in_edges_tensor generation:  0.013550043106079102
mini_batch_src_global generation:  0.03261733055114746
r_  generation:  0.2381734848022461
local_output_nid generation:  0.013772964477539062
local_in_edges_tensor generation:  0.013559579849243164
mini_batch_src_global generation:  0.029607057571411133
r_  generation:  0.23763823509216309
local_output_nid generation:  0.014095783233642578
local_in_edges_tensor generation:  0.015436410903930664
mini_batch_src_global generation:  0.03232526779174805
r_  generation:  0.24557757377624512
local_output_nid generation:  0.01415705680847168
local_in_edges_tensor generation:  0.019049406051635742
mini_batch_src_global generation:  0.030455827713012695
r_  generation:  0.2440199851989746
local_output_nid generation:  0.013201475143432617
local_in_edges_tensor generation:  0.0166168212890625
mini_batch_src_global generation:  0.03273773193359375
r_  generation:  0.23830819129943848
local_output_nid generation:  0.013575553894042969
local_in_edges_tensor generation:  0.014673948287963867
mini_batch_src_global generation:  0.03125357627868652
r_  generation:  0.24575304985046387
local_output_nid generation:  0.013149499893188477
local_in_edges_tensor generation:  0.016132831573486328
mini_batch_src_global generation:  0.030214786529541016
r_  generation:  0.24419498443603516
----------------------check_connections_block total spend ----------------------------- 5.579247713088989
generate_one_block  0.3133573532104492
generate_one_block  0.3059377670288086
generate_one_block  0.30485033988952637
generate_one_block  0.3091719150543213
generate_one_block  0.29343581199645996
generate_one_block  0.3104870319366455
generate_one_block  0.32653355598449707
generate_one_block  0.3091094493865967
generate_one_block  0.31584596633911133
generate_one_block  0.30266594886779785
generate_one_block  0.31860947608947754
generate_one_block  0.31444287300109863
generate_one_block  0.315509557723999
generate_one_block  0.3020029067993164
generate_one_block  0.3129546642303467
generate_one_block  0.3086071014404297
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03954124450683594
gen group dst list time:  0.06499695777893066
time for parepare:  0.019682884216308594
local_output_nid generation:  0.027626514434814453
local_in_edges_tensor generation:  0.0481419563293457
mini_batch_src_global generation:  0.04263806343078613
r_  generation:  0.4500558376312256
local_output_nid generation:  0.033838510513305664
local_in_edges_tensor generation:  0.03927111625671387
mini_batch_src_global generation:  0.054059743881225586
r_  generation:  0.45448780059814453
local_output_nid generation:  0.03189277648925781
local_in_edges_tensor generation:  0.03248143196105957
mini_batch_src_global generation:  0.050730228424072266
r_  generation:  0.46224355697631836
local_output_nid generation:  0.031728267669677734
local_in_edges_tensor generation:  0.03180241584777832
mini_batch_src_global generation:  0.0545201301574707
r_  generation:  0.45951390266418457
local_output_nid generation:  0.03379511833190918
local_in_edges_tensor generation:  0.07858443260192871
mini_batch_src_global generation:  0.051795005798339844
r_  generation:  0.46274566650390625
local_output_nid generation:  0.032151222229003906
local_in_edges_tensor generation:  0.03410172462463379
mini_batch_src_global generation:  0.05624985694885254
r_  generation:  0.477353572845459
local_output_nid generation:  0.0346980094909668
local_in_edges_tensor generation:  0.037352561950683594
mini_batch_src_global generation:  0.05466771125793457
r_  generation:  0.4683256149291992
local_output_nid generation:  0.03254342079162598
local_in_edges_tensor generation:  0.029659748077392578
mini_batch_src_global generation:  0.05397486686706543
r_  generation:  0.46082520484924316
local_output_nid generation:  0.03267335891723633
local_in_edges_tensor generation:  0.033162593841552734
mini_batch_src_global generation:  0.0527338981628418
r_  generation:  0.4690990447998047
local_output_nid generation:  0.03283262252807617
local_in_edges_tensor generation:  0.033267974853515625
mini_batch_src_global generation:  0.05403542518615723
r_  generation:  0.4604041576385498
local_output_nid generation:  0.032590627670288086
local_in_edges_tensor generation:  0.031075000762939453
mini_batch_src_global generation:  0.05486559867858887
r_  generation:  0.46570467948913574
local_output_nid generation:  0.03473353385925293
local_in_edges_tensor generation:  0.03192639350891113
mini_batch_src_global generation:  0.054445743560791016
r_  generation:  0.4603426456451416
local_output_nid generation:  0.03302288055419922
local_in_edges_tensor generation:  0.031226158142089844
mini_batch_src_global generation:  0.05453944206237793
r_  generation:  0.46744489669799805
local_output_nid generation:  0.03286123275756836
local_in_edges_tensor generation:  0.030622005462646484
mini_batch_src_global generation:  0.053508758544921875
r_  generation:  0.4623088836669922
local_output_nid generation:  0.03325247764587402
local_in_edges_tensor generation:  0.029550790786743164
mini_batch_src_global generation:  0.05428719520568848
r_  generation:  0.4706137180328369
local_output_nid generation:  0.03365612030029297
local_in_edges_tensor generation:  0.029705047607421875
mini_batch_src_global generation:  0.05414605140686035
r_  generation:  0.4637274742126465
----------------------check_connections_block total spend ----------------------------- 11.00824236869812
generate_one_block  0.5856368541717529
generate_one_block  0.5839855670928955
generate_one_block  0.5856983661651611
generate_one_block  0.5774548053741455
generate_one_block  0.5797007083892822
generate_one_block  0.5961310863494873
generate_one_block  0.5854902267456055
generate_one_block  0.5930459499359131
generate_one_block  0.6223673820495605
generate_one_block  0.6015956401824951
generate_one_block  0.5861289501190186
generate_one_block  0.5933995246887207
generate_one_block  0.5882258415222168
generate_one_block  0.5826961994171143
generate_one_block  0.6052227020263672
generate_one_block  0.5832667350769043
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11832761764526367  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

connection checking time:  16.58749008178711
block generation total time  14.413568258285522
average batch blocks generation time:  0.9008480161428452
block dataloader generation time/epoch 33.52073311805725
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0947117805480957  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7438387870788574  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09457540512084961  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7475590705871582  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09475994110107422  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7441234588623047  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09443426132202148  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7494978904724121  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09453296661376953  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.738922119140625  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0944371223449707  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7438502311706543  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09453773498535156  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7390232086181641  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09453010559082031  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.746973991394043  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09487056732177734  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7485723495483398  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09444713592529297  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7415857315063477  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09467124938964844  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.741724967956543  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0947871208190918  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7540173530578613  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09489822387695312  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7520856857299805  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09431266784667969  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7431912422180176  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09494972229003906  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7549676895141602  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09435367584228516  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7439427375793457  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06630097329616547 |0.015664711594581604 |0.0035485178232192993 |9.347498416900635e-05 |0.003720983862876892 |0.0017926692962646484 |
----------------------------------------------------------pseudo_mini_loss sum 1.5509659051895142
Total (block generation + training)time/epoch 34.986881494522095
Training time/epoch 1.4933655261993408
Training time without block to device /epoch 1.2427301406860352
Training time without total dataloading part /epoch 0.11960029602050781
load block tensor time/epoch 1.0608155727386475
block to device time/epoch 0.25063538551330566
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  5208814
Number of first layer input nodes during this epoch:  2480005
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11789560317993164  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024835824966430664
random selection method range initialization spend 0.00522613525390625
time for parepare:  0.017618894577026367
local_output_nid generation:  0.002377748489379883
local_in_edges_tensor generation:  0.04511713981628418
mini_batch_src_global generation:  0.002068758010864258
r_  generation:  0.0221097469329834
local_output_nid generation:  0.003034353256225586
local_in_edges_tensor generation:  0.0017528533935546875
mini_batch_src_global generation:  0.0025415420532226562
r_  generation:  0.02475118637084961
local_output_nid generation:  0.003061532974243164
local_in_edges_tensor generation:  0.0018062591552734375
mini_batch_src_global generation:  0.0021996498107910156
r_  generation:  0.022365331649780273
local_output_nid generation:  0.0030372142791748047
local_in_edges_tensor generation:  0.0017681121826171875
mini_batch_src_global generation:  0.0018475055694580078
r_  generation:  0.02247905731201172
local_output_nid generation:  0.003020763397216797
local_in_edges_tensor generation:  0.0017185211181640625
mini_batch_src_global generation:  0.0018324851989746094
r_  generation:  0.02159905433654785
local_output_nid generation:  0.0030477046966552734
local_in_edges_tensor generation:  0.0017316341400146484
mini_batch_src_global generation:  0.0017974376678466797
r_  generation:  0.02225494384765625
local_output_nid generation:  0.003062725067138672
local_in_edges_tensor generation:  0.0016765594482421875
mini_batch_src_global generation:  0.0018150806427001953
r_  generation:  0.03322649002075195
local_output_nid generation:  0.004561662673950195
local_in_edges_tensor generation:  0.0022728443145751953
mini_batch_src_global generation:  0.0050737857818603516
r_  generation:  0.021465301513671875
local_output_nid generation:  0.004355907440185547
local_in_edges_tensor generation:  0.0021224021911621094
mini_batch_src_global generation:  0.001865386962890625
r_  generation:  0.02252054214477539
local_output_nid generation:  0.004350900650024414
local_in_edges_tensor generation:  0.0020766258239746094
mini_batch_src_global generation:  0.0019080638885498047
r_  generation:  0.02233576774597168
local_output_nid generation:  0.004374027252197266
local_in_edges_tensor generation:  0.002049684524536133
mini_batch_src_global generation:  0.0019381046295166016
r_  generation:  0.02237415313720703
local_output_nid generation:  0.004351139068603516
local_in_edges_tensor generation:  0.002106189727783203
mini_batch_src_global generation:  0.0018703937530517578
r_  generation:  0.022408723831176758
local_output_nid generation:  0.004277467727661133
local_in_edges_tensor generation:  0.002067089080810547
mini_batch_src_global generation:  0.0019304752349853516
r_  generation:  0.022220134735107422
local_output_nid generation:  0.004276275634765625
local_in_edges_tensor generation:  0.002002239227294922
mini_batch_src_global generation:  0.0019271373748779297
r_  generation:  0.02275705337524414
local_output_nid generation:  0.004189729690551758
local_in_edges_tensor generation:  0.002056121826171875
mini_batch_src_global generation:  0.009151935577392578
r_  generation:  0.02190876007080078
local_output_nid generation:  0.004296302795410156
local_in_edges_tensor generation:  0.0020263195037841797
mini_batch_src_global generation:  0.006286144256591797
r_  generation:  0.022113323211669922
----------------------check_connections_block total spend ----------------------------- 0.6676409244537354
generate_one_block  0.040082693099975586
generate_one_block  0.032350778579711914
generate_one_block  0.03255486488342285
generate_one_block  0.032981157302856445
generate_one_block  0.03184795379638672
generate_one_block  0.036896467208862305
generate_one_block  0.03304004669189453
generate_one_block  0.0314786434173584
generate_one_block  0.03258085250854492
generate_one_block  0.03266716003417969
generate_one_block  0.03256583213806152
generate_one_block  0.03184056282043457
generate_one_block  0.03240370750427246
generate_one_block  0.03334760665893555
generate_one_block  0.03163480758666992
generate_one_block  0.03250598907470703
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03640484809875488
gen group dst list time:  0.021679401397705078
time for parepare:  0.021343469619750977
local_output_nid generation:  0.01062321662902832
local_in_edges_tensor generation:  0.028269052505493164
mini_batch_src_global generation:  0.02236461639404297
r_  generation:  0.21514081954956055
local_output_nid generation:  0.01784229278564453
local_in_edges_tensor generation:  0.021742582321166992
mini_batch_src_global generation:  0.03062582015991211
r_  generation:  0.23339223861694336
local_output_nid generation:  0.017146825790405273
local_in_edges_tensor generation:  0.01705145835876465
mini_batch_src_global generation:  0.03204965591430664
r_  generation:  0.23391270637512207
local_output_nid generation:  0.018688201904296875
local_in_edges_tensor generation:  0.022037267684936523
mini_batch_src_global generation:  0.029780149459838867
r_  generation:  0.2774186134338379
local_output_nid generation:  0.021361589431762695
local_in_edges_tensor generation:  0.02188587188720703
mini_batch_src_global generation:  0.036562204360961914
r_  generation:  0.25838589668273926
local_output_nid generation:  0.01779007911682129
local_in_edges_tensor generation:  0.02154707908630371
mini_batch_src_global generation:  0.032238006591796875
r_  generation:  0.2579669952392578
local_output_nid generation:  0.017721891403198242
local_in_edges_tensor generation:  0.02350306510925293
mini_batch_src_global generation:  0.034482479095458984
r_  generation:  0.27457261085510254
local_output_nid generation:  0.019730329513549805
local_in_edges_tensor generation:  0.0199127197265625
mini_batch_src_global generation:  0.034009456634521484
r_  generation:  0.25059008598327637
local_output_nid generation:  0.017675399780273438
local_in_edges_tensor generation:  0.016393661499023438
mini_batch_src_global generation:  0.03521466255187988
r_  generation:  0.26218223571777344
local_output_nid generation:  0.01773524284362793
local_in_edges_tensor generation:  0.01981663703918457
mini_batch_src_global generation:  0.03483939170837402
r_  generation:  0.2656984329223633
local_output_nid generation:  0.020269155502319336
local_in_edges_tensor generation:  0.017248868942260742
mini_batch_src_global generation:  0.03429436683654785
r_  generation:  0.2641332149505615
local_output_nid generation:  0.017549753189086914
local_in_edges_tensor generation:  0.01739025115966797
mini_batch_src_global generation:  0.03380298614501953
r_  generation:  0.25838637351989746
local_output_nid generation:  0.018290281295776367
local_in_edges_tensor generation:  0.015758752822875977
mini_batch_src_global generation:  0.034583091735839844
r_  generation:  0.25936055183410645
local_output_nid generation:  0.017223596572875977
local_in_edges_tensor generation:  0.014148473739624023
mini_batch_src_global generation:  0.035303354263305664
r_  generation:  0.2602670192718506
local_output_nid generation:  0.01652359962463379
local_in_edges_tensor generation:  0.016507387161254883
mini_batch_src_global generation:  0.03450608253479004
r_  generation:  0.2547340393066406
local_output_nid generation:  0.017010927200317383
local_in_edges_tensor generation:  0.014278888702392578
mini_batch_src_global generation:  0.034049272537231445
r_  generation:  0.25765180587768555
----------------------check_connections_block total spend ----------------------------- 6.166139841079712
generate_one_block  0.303635835647583
generate_one_block  0.3098032474517822
generate_one_block  0.30646657943725586
generate_one_block  0.3185102939605713
generate_one_block  0.3049275875091553
generate_one_block  0.3022346496582031
generate_one_block  0.35125184059143066
generate_one_block  0.29802584648132324
generate_one_block  0.3052842617034912
generate_one_block  0.31227850914001465
generate_one_block  0.3072822093963623
generate_one_block  0.3064248561859131
generate_one_block  0.3071329593658447
generate_one_block  0.3134779930114746
generate_one_block  0.30009961128234863
generate_one_block  0.3081808090209961
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04241037368774414
gen group dst list time:  0.06529974937438965
time for parepare:  0.018188953399658203
local_output_nid generation:  0.0301210880279541
local_in_edges_tensor generation:  0.05471968650817871
mini_batch_src_global generation:  0.040663957595825195
r_  generation:  0.4504539966583252
local_output_nid generation:  0.031961917877197266
local_in_edges_tensor generation:  0.03911423683166504
mini_batch_src_global generation:  0.05504155158996582
r_  generation:  0.45935702323913574
local_output_nid generation:  0.03243708610534668
local_in_edges_tensor generation:  0.03153824806213379
mini_batch_src_global generation:  0.05127096176147461
r_  generation:  0.4606029987335205
local_output_nid generation:  0.03449368476867676
local_in_edges_tensor generation:  0.03339886665344238
mini_batch_src_global generation:  0.0535273551940918
r_  generation:  0.45967960357666016
local_output_nid generation:  0.0318300724029541
local_in_edges_tensor generation:  0.07810711860656738
mini_batch_src_global generation:  0.05454301834106445
r_  generation:  0.4660911560058594
local_output_nid generation:  0.03171801567077637
local_in_edges_tensor generation:  0.036603689193725586
mini_batch_src_global generation:  0.053244590759277344
r_  generation:  0.48710012435913086
local_output_nid generation:  0.035272836685180664
local_in_edges_tensor generation:  0.03400588035583496
mini_batch_src_global generation:  0.057528018951416016
r_  generation:  0.46927595138549805
local_output_nid generation:  0.03259468078613281
local_in_edges_tensor generation:  0.034169912338256836
mini_batch_src_global generation:  0.05397343635559082
r_  generation:  0.4586188793182373
local_output_nid generation:  0.032646894454956055
local_in_edges_tensor generation:  0.029897689819335938
mini_batch_src_global generation:  0.053139686584472656
r_  generation:  0.46399831771850586
local_output_nid generation:  0.033133506774902344
local_in_edges_tensor generation:  0.0303041934967041
mini_batch_src_global generation:  0.05385327339172363
r_  generation:  0.4621396064758301
local_output_nid generation:  0.03326749801635742
local_in_edges_tensor generation:  0.03403973579406738
mini_batch_src_global generation:  0.051984310150146484
r_  generation:  0.4672880172729492
local_output_nid generation:  0.03270602226257324
local_in_edges_tensor generation:  0.029534339904785156
mini_batch_src_global generation:  0.053722381591796875
r_  generation:  0.4596683979034424
local_output_nid generation:  0.033138275146484375
local_in_edges_tensor generation:  0.0318455696105957
mini_batch_src_global generation:  0.06281352043151855
r_  generation:  0.46489524841308594
local_output_nid generation:  0.03319358825683594
local_in_edges_tensor generation:  0.030010223388671875
mini_batch_src_global generation:  0.05566143989562988
r_  generation:  0.4666571617126465
local_output_nid generation:  0.032811880111694336
local_in_edges_tensor generation:  0.03477835655212402
mini_batch_src_global generation:  0.052663564682006836
r_  generation:  0.46868300437927246
local_output_nid generation:  0.03313803672790527
local_in_edges_tensor generation:  0.03229069709777832
mini_batch_src_global generation:  0.05536508560180664
r_  generation:  0.4638791084289551
----------------------check_connections_block total spend ----------------------------- 11.030936241149902
generate_one_block  0.5907785892486572
generate_one_block  0.5854666233062744
generate_one_block  0.5912446975708008
generate_one_block  0.5893063545227051
generate_one_block  0.5808975696563721
generate_one_block  0.5846054553985596
generate_one_block  0.5828053951263428
generate_one_block  0.5792922973632812
generate_one_block  0.6507267951965332
generate_one_block  0.5932931900024414
generate_one_block  0.5950713157653809
generate_one_block  0.5873820781707764
generate_one_block  0.5922727584838867
generate_one_block  0.5928916931152344
generate_one_block  0.590378999710083
generate_one_block  0.5973105430603027
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11789560317993164  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

connection checking time:  17.197076082229614
block generation total time  14.438741445541382
average batch blocks generation time:  0.9024213403463364
block dataloader generation time/epoch 33.6672625541687
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09442758560180664  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7379941940307617  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09450483322143555  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7471985816955566  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09473037719726562  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.747992992401123  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09488868713378906  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7554750442504883  GigaBytes
Max Memory Allocated: 0.844482421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09470367431640625  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7422161102294922  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09422492980957031  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7407050132751465  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0948171615600586  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7486047744750977  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09416961669921875  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7389874458312988  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09484291076660156  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7450160980224609  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09473991394042969  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7541980743408203  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0948190689086914  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7469549179077148  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09456825256347656  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7461791038513184  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09483051300048828  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7525768280029297  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09475994110107422  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7540550231933594  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09463214874267578  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7414469718933105  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09439229965209961  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7460975646972656  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0654677152633667 |0.014559835195541382 |0.0035394877195358276 |9.110569953918457e-05 |0.0037020444869995117 |0.0013213157653808594 |
----------------------------------------------------------pseudo_mini_loss sum 1.5195598602294922
Total (block generation + training)time/epoch 35.13189387321472
Training time/epoch 1.4613254070281982
Training time without block to device /epoch 1.2283680438995361
Training time without total dataloading part /epoch 0.11864352226257324
load block tensor time/epoch 1.0474834442138672
block to device time/epoch 0.2329573631286621
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  5211523
Number of first layer input nodes during this epoch:  2480694
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11788749694824219  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.030380964279174805
random selection method range initialization spend 0.0051593780517578125
time for parepare:  0.017375946044921875
local_output_nid generation:  0.0023360252380371094
local_in_edges_tensor generation:  0.009263753890991211
mini_batch_src_global generation:  0.0017821788787841797
r_  generation:  0.021230459213256836
local_output_nid generation:  0.002923250198364258
local_in_edges_tensor generation:  0.0017762184143066406
mini_batch_src_global generation:  0.002148866653442383
r_  generation:  0.02201390266418457
local_output_nid generation:  0.003058195114135742
local_in_edges_tensor generation:  0.0017666816711425781
mini_batch_src_global generation:  0.0018086433410644531
r_  generation:  0.021431922912597656
local_output_nid generation:  0.003069639205932617
local_in_edges_tensor generation:  0.0017535686492919922
mini_batch_src_global generation:  0.0018274784088134766
r_  generation:  0.022709369659423828
local_output_nid generation:  0.0031652450561523438
local_in_edges_tensor generation:  0.0019466876983642578
mini_batch_src_global generation:  0.001871347427368164
r_  generation:  0.022891998291015625
local_output_nid generation:  0.003118276596069336
local_in_edges_tensor generation:  0.0017032623291015625
mini_batch_src_global generation:  0.0018398761749267578
r_  generation:  0.021790504455566406
local_output_nid generation:  0.003084897994995117
local_in_edges_tensor generation:  0.0017027854919433594
mini_batch_src_global generation:  0.0018107891082763672
r_  generation:  0.02233266830444336
local_output_nid generation:  0.0031032562255859375
local_in_edges_tensor generation:  0.0016717910766601562
mini_batch_src_global generation:  0.0018093585968017578
r_  generation:  0.022556066513061523
local_output_nid generation:  0.0030655860900878906
local_in_edges_tensor generation:  0.001688241958618164
mini_batch_src_global generation:  0.0018281936645507812
r_  generation:  0.0228269100189209
local_output_nid generation:  0.0031244754791259766
local_in_edges_tensor generation:  0.0017366409301757812
mini_batch_src_global generation:  0.0017886161804199219
r_  generation:  0.022842884063720703
local_output_nid generation:  0.003116130828857422
local_in_edges_tensor generation:  0.0016655921936035156
mini_batch_src_global generation:  0.001821756362915039
r_  generation:  0.022151708602905273
local_output_nid generation:  0.003017425537109375
local_in_edges_tensor generation:  0.0017046928405761719
mini_batch_src_global generation:  0.0017910003662109375
r_  generation:  0.02247786521911621
local_output_nid generation:  0.003102540969848633
local_in_edges_tensor generation:  0.001703500747680664
mini_batch_src_global generation:  0.0017871856689453125
r_  generation:  0.0224149227142334
local_output_nid generation:  0.003080129623413086
local_in_edges_tensor generation:  0.0016362667083740234
mini_batch_src_global generation:  0.001837015151977539
r_  generation:  0.022727251052856445
local_output_nid generation:  0.0030922889709472656
local_in_edges_tensor generation:  0.0016674995422363281
mini_batch_src_global generation:  0.0018053054809570312
r_  generation:  0.022781848907470703
local_output_nid generation:  0.003049612045288086
local_in_edges_tensor generation:  0.0016412734985351562
mini_batch_src_global generation:  0.0018031597137451172
r_  generation:  0.022359848022460938
----------------------check_connections_block total spend ----------------------------- 0.578228235244751
generate_one_block  0.03101325035095215
generate_one_block  0.03141140937805176
generate_one_block  0.030844926834106445
generate_one_block  0.031131982803344727
generate_one_block  0.033762216567993164
generate_one_block  0.0354611873626709
generate_one_block  0.033464908599853516
generate_one_block  0.033446550369262695
generate_one_block  0.032143354415893555
generate_one_block  0.03122115135192871
generate_one_block  0.03070235252380371
generate_one_block  0.03164362907409668
generate_one_block  0.031412601470947266
generate_one_block  0.03186964988708496
generate_one_block  0.031441450119018555
generate_one_block  0.0317840576171875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03194570541381836
gen group dst list time:  0.017905712127685547
time for parepare:  0.019191503524780273
local_output_nid generation:  0.009247303009033203
local_in_edges_tensor generation:  0.024648189544677734
mini_batch_src_global generation:  0.02123856544494629
r_  generation:  0.21479082107543945
local_output_nid generation:  0.013453960418701172
local_in_edges_tensor generation:  0.013339757919311523
mini_batch_src_global generation:  0.027823448181152344
r_  generation:  0.22495245933532715
local_output_nid generation:  0.013140439987182617
local_in_edges_tensor generation:  0.012960672378540039
mini_batch_src_global generation:  0.026275157928466797
r_  generation:  0.22767925262451172
local_output_nid generation:  0.013933658599853516
local_in_edges_tensor generation:  0.013243675231933594
mini_batch_src_global generation:  0.02864861488342285
r_  generation:  0.23281073570251465
local_output_nid generation:  0.01430511474609375
local_in_edges_tensor generation:  0.01748037338256836
mini_batch_src_global generation:  0.030252695083618164
r_  generation:  0.2406308650970459
local_output_nid generation:  0.013643741607666016
local_in_edges_tensor generation:  0.01319742202758789
mini_batch_src_global generation:  0.028762340545654297
r_  generation:  0.23111820220947266
local_output_nid generation:  0.014071226119995117
local_in_edges_tensor generation:  0.015393257141113281
mini_batch_src_global generation:  0.029181718826293945
r_  generation:  0.23865818977355957
local_output_nid generation:  0.014209508895874023
local_in_edges_tensor generation:  0.014139175415039062
mini_batch_src_global generation:  0.03217649459838867
r_  generation:  0.23708105087280273
local_output_nid generation:  0.014096498489379883
local_in_edges_tensor generation:  0.01427006721496582
mini_batch_src_global generation:  0.03183245658874512
r_  generation:  0.23895001411437988
local_output_nid generation:  0.014002084732055664
local_in_edges_tensor generation:  0.012959718704223633
mini_batch_src_global generation:  0.031592607498168945
r_  generation:  0.2368152141571045
local_output_nid generation:  0.01324772834777832
local_in_edges_tensor generation:  0.013025522232055664
mini_batch_src_global generation:  0.02945256233215332
r_  generation:  0.23640227317810059
local_output_nid generation:  0.014011144638061523
local_in_edges_tensor generation:  0.013103008270263672
mini_batch_src_global generation:  0.03184008598327637
r_  generation:  0.23724031448364258
local_output_nid generation:  0.013962030410766602
local_in_edges_tensor generation:  0.012765884399414062
mini_batch_src_global generation:  0.029335498809814453
r_  generation:  0.23781824111938477
local_output_nid generation:  0.013417720794677734
local_in_edges_tensor generation:  0.01480245590209961
mini_batch_src_global generation:  0.038231849670410156
r_  generation:  0.24196314811706543
local_output_nid generation:  0.013205528259277344
local_in_edges_tensor generation:  0.013308286666870117
mini_batch_src_global generation:  0.03195691108703613
r_  generation:  0.23722505569458008
local_output_nid generation:  0.013310432434082031
local_in_edges_tensor generation:  0.013412714004516602
mini_batch_src_global generation:  0.030905485153198242
r_  generation:  0.2397446632385254
----------------------check_connections_block total spend ----------------------------- 5.51111912727356
generate_one_block  0.2980942726135254
generate_one_block  0.2963991165161133
generate_one_block  0.301760196685791
generate_one_block  0.30355167388916016
generate_one_block  0.3097953796386719
generate_one_block  0.29225945472717285
generate_one_block  0.3275115489959717
generate_one_block  0.30589914321899414
generate_one_block  0.3036763668060303
generate_one_block  0.30088257789611816
generate_one_block  0.2999556064605713
generate_one_block  0.3034794330596924
generate_one_block  0.30389928817749023
generate_one_block  0.3078000545501709
generate_one_block  0.3003532886505127
generate_one_block  0.30582165718078613
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030820131301879883
gen group dst list time:  0.06442046165466309
time for parepare:  0.01727890968322754
local_output_nid generation:  0.026709318161010742
local_in_edges_tensor generation:  0.041175127029418945
mini_batch_src_global generation:  0.04191136360168457
r_  generation:  0.44361376762390137
local_output_nid generation:  0.0322263240814209
local_in_edges_tensor generation:  0.03352928161621094
mini_batch_src_global generation:  0.052043914794921875
r_  generation:  0.4476430416107178
local_output_nid generation:  0.03236079216003418
local_in_edges_tensor generation:  0.030691146850585938
mini_batch_src_global generation:  0.05240821838378906
r_  generation:  0.45913076400756836
local_output_nid generation:  0.03252053260803223
local_in_edges_tensor generation:  0.03696250915527344
mini_batch_src_global generation:  0.05429673194885254
r_  generation:  0.4539303779602051
local_output_nid generation:  0.03240561485290527
local_in_edges_tensor generation:  0.07846260070800781
mini_batch_src_global generation:  0.05140852928161621
r_  generation:  0.4633052349090576
local_output_nid generation:  0.032052040100097656
local_in_edges_tensor generation:  0.03593158721923828
mini_batch_src_global generation:  0.05372047424316406
r_  generation:  0.457080602645874
local_output_nid generation:  0.03214836120605469
local_in_edges_tensor generation:  0.03185558319091797
mini_batch_src_global generation:  0.05402994155883789
r_  generation:  0.46544766426086426
local_output_nid generation:  0.03197288513183594
local_in_edges_tensor generation:  0.03502941131591797
mini_batch_src_global generation:  0.05304837226867676
r_  generation:  0.460679292678833
local_output_nid generation:  0.03266787528991699
local_in_edges_tensor generation:  0.03181934356689453
mini_batch_src_global generation:  0.05233955383300781
r_  generation:  0.46752357482910156
local_output_nid generation:  0.032411813735961914
local_in_edges_tensor generation:  0.029589414596557617
mini_batch_src_global generation:  0.053148508071899414
r_  generation:  0.4639716148376465
local_output_nid generation:  0.03229117393493652
local_in_edges_tensor generation:  0.02959895133972168
mini_batch_src_global generation:  0.052158355712890625
r_  generation:  0.4652218818664551
local_output_nid generation:  0.03227591514587402
local_in_edges_tensor generation:  0.030124664306640625
mini_batch_src_global generation:  0.05297541618347168
r_  generation:  0.4594254493713379
local_output_nid generation:  0.03204607963562012
local_in_edges_tensor generation:  0.03473234176635742
mini_batch_src_global generation:  0.05442047119140625
r_  generation:  0.4719424247741699
local_output_nid generation:  0.03290295600891113
local_in_edges_tensor generation:  0.032628774642944336
mini_batch_src_global generation:  0.054645538330078125
r_  generation:  0.4597179889678955
local_output_nid generation:  0.032003164291381836
local_in_edges_tensor generation:  0.0314021110534668
mini_batch_src_global generation:  0.05135607719421387
r_  generation:  0.4636821746826172
local_output_nid generation:  0.035051822662353516
local_in_edges_tensor generation:  0.032595157623291016
mini_batch_src_global generation:  0.05359172821044922
r_  generation:  0.4600694179534912
----------------------check_connections_block total spend ----------------------------- 10.909476518630981
generate_one_block  0.573244571685791
generate_one_block  0.5811731815338135
generate_one_block  0.5844221115112305
generate_one_block  0.5861513614654541
generate_one_block  0.5864360332489014
generate_one_block  0.5726127624511719
generate_one_block  0.5782811641693115
generate_one_block  0.5849640369415283
generate_one_block  0.615772008895874
generate_one_block  0.5893542766571045
generate_one_block  0.5836532115936279
generate_one_block  0.5789709091186523
generate_one_block  0.5865066051483154
generate_one_block  0.5898675918579102
generate_one_block  0.5836966037750244
generate_one_block  0.5945470333099365
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11788749694824219  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

connection checking time:  16.42059564590454
block generation total time  14.23079252243042
average batch blocks generation time:  0.8894245326519012
block dataloader generation time/epoch 33.46003097295761
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09456968307495117  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7405452728271484  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09446239471435547  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7431774139404297  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09471797943115234  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.743049144744873  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09461450576782227  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7482199668884277  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09494686126708984  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7519159317016602  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0942544937133789  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7402267456054688  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.094818115234375  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7480707168579102  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09433507919311523  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7446908950805664  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09481334686279297  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7509751319885254  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09444761276245117  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7457547187805176  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0947113037109375  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7428250312805176  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09440755844116211  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7436981201171875  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09477043151855469  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7456502914428711  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09466361999511719  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7511601448059082  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09472179412841797  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7445836067199707  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09468889236450195  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7524662017822266  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06085856258869171 |0.012717410922050476 |0.003549933433532715 |9.167194366455078e-05 |0.0034769177436828613 |0.003163576126098633 |
----------------------------------------------------------pseudo_mini_loss sum 1.4819762706756592
Total (block generation + training)time/epoch 34.89780116081238
Training time/epoch 1.3569228649139404
Training time without block to device /epoch 1.1534442901611328
Training time without total dataloading part /epoch 0.11705994606018066
load block tensor time/epoch 0.9737370014190674
block to device time/epoch 0.20347857475280762
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  5211166
Number of first layer input nodes during this epoch:  2481017
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11836528778076172  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02262592315673828
random selection method range initialization spend 0.005433559417724609
time for parepare:  0.018144607543945312
local_output_nid generation:  0.002382516860961914
local_in_edges_tensor generation:  0.007545948028564453
mini_batch_src_global generation:  0.0017414093017578125
r_  generation:  0.020800113677978516
local_output_nid generation:  0.0028498172760009766
local_in_edges_tensor generation:  0.0017566680908203125
mini_batch_src_global generation:  0.0019783973693847656
r_  generation:  0.020897388458251953
local_output_nid generation:  0.0029358863830566406
local_in_edges_tensor generation:  0.0017163753509521484
mini_batch_src_global generation:  0.0017104148864746094
r_  generation:  0.022284984588623047
local_output_nid generation:  0.002920389175415039
local_in_edges_tensor generation:  0.0017173290252685547
mini_batch_src_global generation:  0.0017974376678466797
r_  generation:  0.022301197052001953
local_output_nid generation:  0.0029456615447998047
local_in_edges_tensor generation:  0.0016937255859375
mini_batch_src_global generation:  0.001794576644897461
r_  generation:  0.0216672420501709
local_output_nid generation:  0.0029900074005126953
local_in_edges_tensor generation:  0.0017750263214111328
mini_batch_src_global generation:  0.0018091201782226562
r_  generation:  0.023138761520385742
local_output_nid generation:  0.002963542938232422
local_in_edges_tensor generation:  0.0017292499542236328
mini_batch_src_global generation:  0.0018153190612792969
r_  generation:  0.021636486053466797
local_output_nid generation:  0.002921581268310547
local_in_edges_tensor generation:  0.0016715526580810547
mini_batch_src_global generation:  0.0018546581268310547
r_  generation:  0.02284979820251465
local_output_nid generation:  0.002949237823486328
local_in_edges_tensor generation:  0.0016937255859375
mini_batch_src_global generation:  0.0017850399017333984
r_  generation:  0.021935701370239258
local_output_nid generation:  0.002939462661743164
local_in_edges_tensor generation:  0.001733541488647461
mini_batch_src_global generation:  0.001768350601196289
r_  generation:  0.02176213264465332
local_output_nid generation:  0.0030057430267333984
local_in_edges_tensor generation:  0.0016789436340332031
mini_batch_src_global generation:  0.0017921924591064453
r_  generation:  0.02294135093688965
local_output_nid generation:  0.0029702186584472656
local_in_edges_tensor generation:  0.0016944408416748047
mini_batch_src_global generation:  0.0018069744110107422
r_  generation:  0.021720170974731445
local_output_nid generation:  0.002932310104370117
local_in_edges_tensor generation:  0.001705169677734375
mini_batch_src_global generation:  0.0018177032470703125
r_  generation:  0.022860288619995117
local_output_nid generation:  0.0030450820922851562
local_in_edges_tensor generation:  0.0016281604766845703
mini_batch_src_global generation:  0.0018277168273925781
r_  generation:  0.023134946823120117
local_output_nid generation:  0.003064393997192383
local_in_edges_tensor generation:  0.001734018325805664
mini_batch_src_global generation:  0.0018565654754638672
r_  generation:  0.02271294593811035
local_output_nid generation:  0.0029807090759277344
local_in_edges_tensor generation:  0.0017037391662597656
mini_batch_src_global generation:  0.0018057823181152344
r_  generation:  0.02231764793395996
----------------------check_connections_block total spend ----------------------------- 0.5740163326263428
generate_one_block  0.034722328186035156
generate_one_block  0.030369997024536133
generate_one_block  0.03156089782714844
generate_one_block  0.03185868263244629
generate_one_block  0.03106832504272461
generate_one_block  0.03517794609069824
generate_one_block  0.031388282775878906
generate_one_block  0.03162741661071777
generate_one_block  0.030806779861450195
generate_one_block  0.030617475509643555
generate_one_block  0.031862497329711914
generate_one_block  0.0311126708984375
generate_one_block  0.03207063674926758
generate_one_block  0.03194236755371094
generate_one_block  0.03166770935058594
generate_one_block  0.03181338310241699
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03412485122680664
gen group dst list time:  0.017919301986694336
time for parepare:  0.019354820251464844
local_output_nid generation:  0.010820388793945312
local_in_edges_tensor generation:  0.025400876998901367
mini_batch_src_global generation:  0.02159595489501953
r_  generation:  0.21459627151489258
local_output_nid generation:  0.012973785400390625
local_in_edges_tensor generation:  0.01519775390625
mini_batch_src_global generation:  0.027002573013305664
r_  generation:  0.21927380561828613
local_output_nid generation:  0.013165712356567383
local_in_edges_tensor generation:  0.0171353816986084
mini_batch_src_global generation:  0.027881145477294922
r_  generation:  0.23862695693969727
local_output_nid generation:  0.01475834846496582
local_in_edges_tensor generation:  0.017291784286499023
mini_batch_src_global generation:  0.028905153274536133
r_  generation:  0.24356722831726074
local_output_nid generation:  0.014126062393188477
local_in_edges_tensor generation:  0.01815009117126465
mini_batch_src_global generation:  0.03162050247192383
r_  generation:  0.24142670631408691
local_output_nid generation:  0.016693830490112305
local_in_edges_tensor generation:  0.015196084976196289
mini_batch_src_global generation:  0.029517412185668945
r_  generation:  0.2483069896697998
local_output_nid generation:  0.013915538787841797
local_in_edges_tensor generation:  0.019603490829467773
mini_batch_src_global generation:  0.030236482620239258
r_  generation:  0.23989439010620117
local_output_nid generation:  0.015541315078735352
local_in_edges_tensor generation:  0.015426397323608398
mini_batch_src_global generation:  0.0303955078125
r_  generation:  0.23707246780395508
local_output_nid generation:  0.014156579971313477
local_in_edges_tensor generation:  0.015202045440673828
mini_batch_src_global generation:  0.029422521591186523
r_  generation:  0.23323726654052734
local_output_nid generation:  0.014254570007324219
local_in_edges_tensor generation:  0.014499902725219727
mini_batch_src_global generation:  0.028821945190429688
r_  generation:  0.2338118553161621
local_output_nid generation:  0.013976097106933594
local_in_edges_tensor generation:  0.013484716415405273
mini_batch_src_global generation:  0.030165672302246094
r_  generation:  0.2384014129638672
local_output_nid generation:  0.014098167419433594
local_in_edges_tensor generation:  0.013181447982788086
mini_batch_src_global generation:  0.02952098846435547
r_  generation:  0.23668122291564941
local_output_nid generation:  0.01428675651550293
local_in_edges_tensor generation:  0.014282464981079102
mini_batch_src_global generation:  0.03146481513977051
r_  generation:  0.24432754516601562
local_output_nid generation:  0.01369929313659668
local_in_edges_tensor generation:  0.01449441909790039
mini_batch_src_global generation:  0.033536434173583984
r_  generation:  0.2417435646057129
local_output_nid generation:  0.013492584228515625
local_in_edges_tensor generation:  0.01302647590637207
mini_batch_src_global generation:  0.029778003692626953
r_  generation:  0.2539186477661133
local_output_nid generation:  0.013766050338745117
local_in_edges_tensor generation:  0.01315760612487793
mini_batch_src_global generation:  0.029227733612060547
r_  generation:  0.23784899711608887
----------------------check_connections_block total spend ----------------------------- 5.604812145233154
generate_one_block  0.31260156631469727
generate_one_block  0.2920033931732178
generate_one_block  0.3125591278076172
generate_one_block  0.3111910820007324
generate_one_block  0.3078138828277588
generate_one_block  0.3111891746520996
generate_one_block  0.3322298526763916
generate_one_block  0.30974245071411133
generate_one_block  0.2995905876159668
generate_one_block  0.295947790145874
generate_one_block  0.30368614196777344
generate_one_block  0.3002634048461914
generate_one_block  0.31157445907592773
generate_one_block  0.30678749084472656
generate_one_block  0.30442214012145996
generate_one_block  0.305483341217041
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03815603256225586
gen group dst list time:  0.06870126724243164
time for parepare:  0.017581701278686523
local_output_nid generation:  0.02725052833557129
local_in_edges_tensor generation:  0.05312943458557129
mini_batch_src_global generation:  0.04077863693237305
r_  generation:  0.45416808128356934
local_output_nid generation:  0.03158712387084961
local_in_edges_tensor generation:  0.0356907844543457
mini_batch_src_global generation:  0.051748037338256836
r_  generation:  0.4513509273529053
local_output_nid generation:  0.03164172172546387
local_in_edges_tensor generation:  0.036786794662475586
mini_batch_src_global generation:  0.05137014389038086
r_  generation:  0.4636068344116211
local_output_nid generation:  0.034110069274902344
local_in_edges_tensor generation:  0.033298492431640625
mini_batch_src_global generation:  0.054046630859375
r_  generation:  0.462766170501709
local_output_nid generation:  0.03265738487243652
local_in_edges_tensor generation:  0.07657647132873535
mini_batch_src_global generation:  0.0516660213470459
r_  generation:  0.46640801429748535
local_output_nid generation:  0.032305002212524414
local_in_edges_tensor generation:  0.032607316970825195
mini_batch_src_global generation:  0.05317282676696777
r_  generation:  0.46181774139404297
local_output_nid generation:  0.03204607963562012
local_in_edges_tensor generation:  0.03485369682312012
mini_batch_src_global generation:  0.05418729782104492
r_  generation:  0.4667799472808838
local_output_nid generation:  0.032210350036621094
local_in_edges_tensor generation:  0.037290334701538086
mini_batch_src_global generation:  0.05346035957336426
r_  generation:  0.4633326530456543
local_output_nid generation:  0.03223061561584473
local_in_edges_tensor generation:  0.03304123878479004
mini_batch_src_global generation:  0.05222654342651367
r_  generation:  0.4830434322357178
local_output_nid generation:  0.03498506546020508
local_in_edges_tensor generation:  0.03412365913391113
mini_batch_src_global generation:  0.057921648025512695
r_  generation:  0.45816731452941895
local_output_nid generation:  0.0330042839050293
local_in_edges_tensor generation:  0.03499150276184082
mini_batch_src_global generation:  0.05410265922546387
r_  generation:  0.46541833877563477
local_output_nid generation:  0.03258323669433594
local_in_edges_tensor generation:  0.03253531455993652
mini_batch_src_global generation:  0.05545854568481445
r_  generation:  0.4579777717590332
local_output_nid generation:  0.033275604248046875
local_in_edges_tensor generation:  0.030285358428955078
mini_batch_src_global generation:  0.053963422775268555
r_  generation:  0.46416163444519043
local_output_nid generation:  0.03331875801086426
local_in_edges_tensor generation:  0.03255939483642578
mini_batch_src_global generation:  0.05343174934387207
r_  generation:  0.4597008228302002
local_output_nid generation:  0.032915353775024414
local_in_edges_tensor generation:  0.03199005126953125
mini_batch_src_global generation:  0.05211591720581055
r_  generation:  0.4674248695373535
local_output_nid generation:  0.0333561897277832
local_in_edges_tensor generation:  0.031926631927490234
mini_batch_src_global generation:  0.05285143852233887
r_  generation:  0.46110010147094727
----------------------check_connections_block total spend ----------------------------- 11.012191772460938
generate_one_block  0.590888261795044
generate_one_block  0.578291654586792
generate_one_block  0.5877294540405273
generate_one_block  0.5902228355407715
generate_one_block  0.5841183662414551
generate_one_block  0.5874373912811279
generate_one_block  0.5836648941040039
generate_one_block  0.5839478969573975
generate_one_block  0.647179126739502
generate_one_block  0.5888524055480957
generate_one_block  0.586993932723999
generate_one_block  0.590212345123291
generate_one_block  0.5843267440795898
generate_one_block  0.5863995552062988
generate_one_block  0.5817546844482422
generate_one_block  0.5821659564971924
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11836528778076172  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

connection checking time:  16.617003917694092
block generation total time  14.351271390914917
average batch blocks generation time:  0.8969544619321823
block dataloader generation time/epoch 33.3974091053009
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09468221664428711  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7452578544616699  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09395265579223633  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7313103675842285  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09487056732177734  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.748380184173584  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09456443786621094  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.751248836517334  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09481048583984375  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.745795726776123  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09468698501586914  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7547211647033691  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09468269348144531  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7433762550354004  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09457206726074219  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7474946975708008  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09460163116455078  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7412681579589844  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09430265426635742  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7403793334960938  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09480762481689453  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.746065616607666  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09453773498535156  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7441625595092773  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09490203857421875  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7495980262756348  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0946035385131836  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7516613006591797  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09473896026611328  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7437210083007812  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09436655044555664  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7441720962524414  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.061978235840797424 |0.015116140246391296 |0.003477931022644043 |9.213387966156006e-05 |0.0031206905841827393 |0.0028638839721679688 |
----------------------------------------------------------pseudo_mini_loss sum 1.4541053771972656
Total (block generation + training)time/epoch 34.82847599983215
Training time/epoch 1.4039816856384277
Training time without block to device /epoch 1.162123441696167
Training time without total dataloading part /epoch 0.10991597175598145
load block tensor time/epoch 0.9916517734527588
block to device time/epoch 0.24185824394226074
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  5207804
Number of first layer input nodes during this epoch:  2480558
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11772441864013672  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023881912231445312
random selection method range initialization spend 0.00538182258605957
time for parepare:  0.01755499839782715
local_output_nid generation:  0.0023860931396484375
local_in_edges_tensor generation:  0.00745391845703125
mini_batch_src_global generation:  0.001734018325805664
r_  generation:  0.021128177642822266
local_output_nid generation:  0.0029807090759277344
local_in_edges_tensor generation:  0.00176239013671875
mini_batch_src_global generation:  0.0020890235900878906
r_  generation:  0.022559642791748047
local_output_nid generation:  0.003035306930541992
local_in_edges_tensor generation:  0.0017952919006347656
mini_batch_src_global generation:  0.0017459392547607422
r_  generation:  0.024278640747070312
local_output_nid generation:  0.004378557205200195
local_in_edges_tensor generation:  0.001772165298461914
mini_batch_src_global generation:  0.007506608963012695
r_  generation:  0.021301984786987305
local_output_nid generation:  0.0031380653381347656
local_in_edges_tensor generation:  0.0017321109771728516
mini_batch_src_global generation:  0.001806020736694336
r_  generation:  0.021628618240356445
local_output_nid generation:  0.0030438899993896484
local_in_edges_tensor generation:  0.0017635822296142578
mini_batch_src_global generation:  0.0018138885498046875
r_  generation:  0.02300548553466797
local_output_nid generation:  0.003045320510864258
local_in_edges_tensor generation:  0.0019478797912597656
mini_batch_src_global generation:  0.0018267631530761719
r_  generation:  0.02295994758605957
local_output_nid generation:  0.003116130828857422
local_in_edges_tensor generation:  0.001735687255859375
mini_batch_src_global generation:  0.0018274784088134766
r_  generation:  0.02169203758239746
local_output_nid generation:  0.0030100345611572266
local_in_edges_tensor generation:  0.0017154216766357422
mini_batch_src_global generation:  0.0018177032470703125
r_  generation:  0.02266669273376465
local_output_nid generation:  0.0030517578125
local_in_edges_tensor generation:  0.001779794692993164
mini_batch_src_global generation:  0.0018033981323242188
r_  generation:  0.021811246871948242
local_output_nid generation:  0.003082275390625
local_in_edges_tensor generation:  0.001661539077758789
mini_batch_src_global generation:  0.0018274784088134766
r_  generation:  0.023008108139038086
local_output_nid generation:  0.0030364990234375
local_in_edges_tensor generation:  0.0016994476318359375
mini_batch_src_global generation:  0.0018131732940673828
r_  generation:  0.022737503051757812
local_output_nid generation:  0.003087282180786133
local_in_edges_tensor generation:  0.001821756362915039
mini_batch_src_global generation:  0.0017762184143066406
r_  generation:  0.021427392959594727
local_output_nid generation:  0.003072023391723633
local_in_edges_tensor generation:  0.0017898082733154297
mini_batch_src_global generation:  0.001802206039428711
r_  generation:  0.022215843200683594
local_output_nid generation:  0.0031409263610839844
local_in_edges_tensor generation:  0.0016579627990722656
mini_batch_src_global generation:  0.001794576644897461
r_  generation:  0.022294282913208008
local_output_nid generation:  0.0030469894409179688
local_in_edges_tensor generation:  0.0016949176788330078
mini_batch_src_global generation:  0.0017750263214111328
r_  generation:  0.022350072860717773
----------------------check_connections_block total spend ----------------------------- 0.5914926528930664
generate_one_block  0.03562736511230469
generate_one_block  0.0315248966217041
generate_one_block  0.03286314010620117
generate_one_block  0.034889936447143555
generate_one_block  0.031644582748413086
generate_one_block  0.035384178161621094
generate_one_block  0.03367209434509277
generate_one_block  0.03131675720214844
generate_one_block  0.031944990158081055
generate_one_block  0.030740976333618164
generate_one_block  0.032047271728515625
generate_one_block  0.032259464263916016
generate_one_block  0.03187084197998047
generate_one_block  0.0316317081451416
generate_one_block  0.03137040138244629
generate_one_block  0.03196549415588379
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03679203987121582
gen group dst list time:  0.01869058609008789
time for parepare:  0.019496440887451172
local_output_nid generation:  0.00945901870727539
local_in_edges_tensor generation:  0.022028207778930664
mini_batch_src_global generation:  0.022022485733032227
r_  generation:  0.21855759620666504
local_output_nid generation:  0.013155460357666016
local_in_edges_tensor generation:  0.017467975616455078
mini_batch_src_global generation:  0.027180194854736328
r_  generation:  0.22505474090576172
local_output_nid generation:  0.013162851333618164
local_in_edges_tensor generation:  0.017969369888305664
mini_batch_src_global generation:  0.028342485427856445
r_  generation:  0.23682498931884766
local_output_nid generation:  0.013569355010986328
local_in_edges_tensor generation:  0.013087034225463867
mini_batch_src_global generation:  0.028066396713256836
r_  generation:  0.23016619682312012
local_output_nid generation:  0.01380610466003418
local_in_edges_tensor generation:  0.013185977935791016
mini_batch_src_global generation:  0.02841973304748535
r_  generation:  0.23492002487182617
local_output_nid generation:  0.016466379165649414
local_in_edges_tensor generation:  0.01483917236328125
mini_batch_src_global generation:  0.029758691787719727
r_  generation:  0.24517035484313965
local_output_nid generation:  0.014949321746826172
local_in_edges_tensor generation:  0.01730942726135254
mini_batch_src_global generation:  0.02978682518005371
r_  generation:  0.2459883689880371
local_output_nid generation:  0.013896703720092773
local_in_edges_tensor generation:  0.013918161392211914
mini_batch_src_global generation:  0.029991626739501953
r_  generation:  0.23782920837402344
local_output_nid generation:  0.014009714126586914
local_in_edges_tensor generation:  0.019048690795898438
mini_batch_src_global generation:  0.031000375747680664
r_  generation:  0.24051690101623535
local_output_nid generation:  0.015450716018676758
local_in_edges_tensor generation:  0.015195846557617188
mini_batch_src_global generation:  0.02852463722229004
r_  generation:  0.23481154441833496
local_output_nid generation:  0.01393747329711914
local_in_edges_tensor generation:  0.015626907348632812
mini_batch_src_global generation:  0.030214548110961914
r_  generation:  0.24605083465576172
local_output_nid generation:  0.014193058013916016
local_in_edges_tensor generation:  0.014693498611450195
mini_batch_src_global generation:  0.030916213989257812
r_  generation:  0.24901247024536133
local_output_nid generation:  0.01374197006225586
local_in_edges_tensor generation:  0.013078927993774414
mini_batch_src_global generation:  0.029523849487304688
r_  generation:  0.2368924617767334
local_output_nid generation:  0.013527631759643555
local_in_edges_tensor generation:  0.01948404312133789
mini_batch_src_global generation:  0.03289937973022461
r_  generation:  0.2576446533203125
local_output_nid generation:  0.01568436622619629
local_in_edges_tensor generation:  0.016042232513427734
mini_batch_src_global generation:  0.030174970626831055
r_  generation:  0.23827672004699707
local_output_nid generation:  0.013653039932250977
local_in_edges_tensor generation:  0.013704061508178711
mini_batch_src_global generation:  0.02969646453857422
r_  generation:  0.23883700370788574
----------------------check_connections_block total spend ----------------------------- 5.612083673477173
generate_one_block  0.30309391021728516
generate_one_block  0.29895472526550293
generate_one_block  0.31735682487487793
generate_one_block  0.2997133731842041
generate_one_block  0.30048394203186035
generate_one_block  0.3294243812561035
generate_one_block  0.34497737884521484
generate_one_block  0.30001068115234375
generate_one_block  0.3060460090637207
generate_one_block  0.29881930351257324
generate_one_block  0.3139820098876953
generate_one_block  0.3099021911621094
generate_one_block  0.298907995223999
generate_one_block  0.3062591552734375
generate_one_block  0.3037605285644531
generate_one_block  0.3030979633331299
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.039900779724121094
gen group dst list time:  0.06488156318664551
time for parepare:  0.01965475082397461
local_output_nid generation:  0.028515100479125977
local_in_edges_tensor generation:  0.05415773391723633
mini_batch_src_global generation:  0.04220867156982422
r_  generation:  0.4530622959136963
local_output_nid generation:  0.03461098670959473
local_in_edges_tensor generation:  0.04096698760986328
mini_batch_src_global generation:  0.05474972724914551
r_  generation:  0.4521195888519287
local_output_nid generation:  0.03303265571594238
local_in_edges_tensor generation:  0.030857324600219727
mini_batch_src_global generation:  0.05500054359436035
r_  generation:  0.46248865127563477
local_output_nid generation:  0.03246188163757324
local_in_edges_tensor generation:  0.03658866882324219
mini_batch_src_global generation:  0.057100772857666016
r_  generation:  0.4750649929046631
local_output_nid generation:  0.03651690483093262
local_in_edges_tensor generation:  0.08439397811889648
mini_batch_src_global generation:  0.05308675765991211
r_  generation:  0.4642667770385742
local_output_nid generation:  0.03207588195800781
local_in_edges_tensor generation:  0.03526878356933594
mini_batch_src_global generation:  0.053662776947021484
r_  generation:  0.46250200271606445
local_output_nid generation:  0.03245258331298828
local_in_edges_tensor generation:  0.03300619125366211
mini_batch_src_global generation:  0.05215930938720703
r_  generation:  0.47083258628845215
local_output_nid generation:  0.03187918663024902
local_in_edges_tensor generation:  0.0337369441986084
mini_batch_src_global generation:  0.05328679084777832
r_  generation:  0.4581286907196045
local_output_nid generation:  0.032355308532714844
local_in_edges_tensor generation:  0.0329437255859375
mini_batch_src_global generation:  0.06532573699951172
r_  generation:  0.4656813144683838
local_output_nid generation:  0.0320286750793457
local_in_edges_tensor generation:  0.030620098114013672
mini_batch_src_global generation:  0.053894996643066406
r_  generation:  0.4575183391571045
local_output_nid generation:  0.032009124755859375
local_in_edges_tensor generation:  0.033155202865600586
mini_batch_src_global generation:  0.0544886589050293
r_  generation:  0.47480297088623047
local_output_nid generation:  0.03237795829772949
local_in_edges_tensor generation:  0.03300881385803223
mini_batch_src_global generation:  0.054785728454589844
r_  generation:  0.46287059783935547
local_output_nid generation:  0.03218698501586914
local_in_edges_tensor generation:  0.03030228614807129
mini_batch_src_global generation:  0.05243802070617676
r_  generation:  0.46576356887817383
local_output_nid generation:  0.03233981132507324
local_in_edges_tensor generation:  0.030780315399169922
mini_batch_src_global generation:  0.05349898338317871
r_  generation:  0.46064090728759766
local_output_nid generation:  0.03214740753173828
local_in_edges_tensor generation:  0.032152652740478516
mini_batch_src_global generation:  0.0521235466003418
r_  generation:  0.4681985378265381
local_output_nid generation:  0.0326540470123291
local_in_edges_tensor generation:  0.032618045806884766
mini_batch_src_global generation:  0.05853724479675293
r_  generation:  0.45923542976379395
----------------------check_connections_block total spend ----------------------------- 11.025718212127686
generate_one_block  0.5840909481048584
generate_one_block  0.580970048904419
generate_one_block  0.5870254039764404
generate_one_block  0.5859992504119873
generate_one_block  0.5821363925933838
generate_one_block  0.5871131420135498
generate_one_block  0.5876953601837158
generate_one_block  0.5816993713378906
generate_one_block  0.6186363697052002
generate_one_block  0.5853362083435059
generate_one_block  0.580327033996582
generate_one_block  0.592430830001831
generate_one_block  0.5766749382019043
generate_one_block  0.5871007442474365
generate_one_block  0.5876040458679199
generate_one_block  0.5982673168182373
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11772441864013672  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

connection checking time:  16.63780188560486
block generation total time  14.337897777557373
average batch blocks generation time:  0.8961186110973358
block dataloader generation time/epoch 33.365362962087
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0947575569152832  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7438745498657227  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09431314468383789  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7422618865966797  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09498977661132812  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7532558441162109  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09418153762817383  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7394018173217773  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09464836120605469  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7430195808410645  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09443950653076172  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7495174407958984  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09491825103759766  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7523331642150879  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09440994262695312  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7422633171081543  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09480667114257812  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7497682571411133  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09411954879760742  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7392687797546387  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09491729736328125  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7533116340637207  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09464597702026367  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7527427673339844  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09447765350341797  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7378411293029785  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09460783004760742  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7513203620910645  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09473609924316406  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7439851760864258  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09433507919311523  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7444076538085938  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06519751250743866 |0.014537692070007324 |0.003530755639076233 |9.21487808227539e-05 |0.003738313913345337 |0.0013501644134521484 |
----------------------------------------------------------pseudo_mini_loss sum 1.4267081022262573
Total (block generation + training)time/epoch 34.8008496761322
Training time/epoch 1.4572882652282715
Training time without block to device /epoch 1.2246851921081543
Training time without total dataloading part /epoch 0.11912965774536133
load block tensor time/epoch 1.0431602001190186
block to device time/epoch 0.2326030731201172
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  5207944
Number of first layer input nodes during this epoch:  2479891
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.1177663803100586  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02449774742126465
random selection method range initialization spend 0.005316019058227539
time for parepare:  0.017683029174804688
local_output_nid generation:  0.0023670196533203125
local_in_edges_tensor generation:  0.007447004318237305
mini_batch_src_global generation:  0.0017709732055664062
r_  generation:  0.02095794677734375
local_output_nid generation:  0.002888202667236328
local_in_edges_tensor generation:  0.0017495155334472656
mini_batch_src_global generation:  0.002106189727783203
r_  generation:  0.02253866195678711
local_output_nid generation:  0.002980947494506836
local_in_edges_tensor generation:  0.001811981201171875
mini_batch_src_global generation:  0.0017609596252441406
r_  generation:  0.02179741859436035
local_output_nid generation:  0.0029964447021484375
local_in_edges_tensor generation:  0.0017731189727783203
mini_batch_src_global generation:  0.0017840862274169922
r_  generation:  0.02145528793334961
local_output_nid generation:  0.0030083656311035156
local_in_edges_tensor generation:  0.0017228126525878906
mini_batch_src_global generation:  0.0018074512481689453
r_  generation:  0.022406578063964844
local_output_nid generation:  0.003017425537109375
local_in_edges_tensor generation:  0.001741170883178711
mini_batch_src_global generation:  0.0018267631530761719
r_  generation:  0.02236032485961914
local_output_nid generation:  0.003001689910888672
local_in_edges_tensor generation:  0.0017430782318115234
mini_batch_src_global generation:  0.0017955303192138672
r_  generation:  0.022583961486816406
local_output_nid generation:  0.0030052661895751953
local_in_edges_tensor generation:  0.00177764892578125
mini_batch_src_global generation:  0.0018181800842285156
r_  generation:  0.021733522415161133
local_output_nid generation:  0.003020048141479492
local_in_edges_tensor generation:  0.0017595291137695312
mini_batch_src_global generation:  0.0017976760864257812
r_  generation:  0.023807525634765625
local_output_nid generation:  0.004510164260864258
local_in_edges_tensor generation:  0.0016791820526123047
mini_batch_src_global generation:  0.0018067359924316406
r_  generation:  0.022176027297973633
local_output_nid generation:  0.003078460693359375
local_in_edges_tensor generation:  0.001734018325805664
mini_batch_src_global generation:  0.0018243789672851562
r_  generation:  0.02227020263671875
local_output_nid generation:  0.0030570030212402344
local_in_edges_tensor generation:  0.0017352104187011719
mini_batch_src_global generation:  0.001771688461303711
r_  generation:  0.021945714950561523
local_output_nid generation:  0.0030319690704345703
local_in_edges_tensor generation:  0.0017125606536865234
mini_batch_src_global generation:  0.0017991065979003906
r_  generation:  0.022516965866088867
local_output_nid generation:  0.0030927658081054688
local_in_edges_tensor generation:  0.0017194747924804688
mini_batch_src_global generation:  0.0018334388732910156
r_  generation:  0.02245163917541504
local_output_nid generation:  0.0030364990234375
local_in_edges_tensor generation:  0.0017173290252685547
mini_batch_src_global generation:  0.0017995834350585938
r_  generation:  0.022150754928588867
local_output_nid generation:  0.003064393997192383
local_in_edges_tensor generation:  0.0016505718231201172
mini_batch_src_global generation:  0.0018110275268554688
r_  generation:  0.023408889770507812
----------------------check_connections_block total spend ----------------------------- 0.5774285793304443
generate_one_block  0.0311739444732666
generate_one_block  0.03157186508178711
generate_one_block  0.03127121925354004
generate_one_block  0.031133174896240234
generate_one_block  0.032012939453125
generate_one_block  0.03473401069641113
generate_one_block  0.03151369094848633
generate_one_block  0.03095102310180664
generate_one_block  0.031610727310180664
generate_one_block  0.030950069427490234
generate_one_block  0.031098365783691406
generate_one_block  0.030694961547851562
generate_one_block  0.031749725341796875
generate_one_block  0.03115701675415039
generate_one_block  0.03124403953552246
generate_one_block  0.032105207443237305
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.033480167388916016
gen group dst list time:  0.01894068717956543
time for parepare:  0.01920914649963379
local_output_nid generation:  0.009232282638549805
local_in_edges_tensor generation:  0.021182775497436523
mini_batch_src_global generation:  0.022704601287841797
r_  generation:  0.21535038948059082
local_output_nid generation:  0.013327836990356445
local_in_edges_tensor generation:  0.017417430877685547
mini_batch_src_global generation:  0.028582096099853516
r_  generation:  0.2263329029083252
local_output_nid generation:  0.013367652893066406
local_in_edges_tensor generation:  0.013610601425170898
mini_batch_src_global generation:  0.026918411254882812
r_  generation:  0.22869253158569336
local_output_nid generation:  0.01367640495300293
local_in_edges_tensor generation:  0.01701641082763672
mini_batch_src_global generation:  0.028322458267211914
r_  generation:  0.2282412052154541
local_output_nid generation:  0.013927936553955078
local_in_edges_tensor generation:  0.013096809387207031
mini_batch_src_global generation:  0.03008723258972168
r_  generation:  0.2380669116973877
local_output_nid generation:  0.013720035552978516
local_in_edges_tensor generation:  0.014347314834594727
mini_batch_src_global generation:  0.029202938079833984
r_  generation:  0.2357015609741211
local_output_nid generation:  0.013890981674194336
local_in_edges_tensor generation:  0.014709234237670898
mini_batch_src_global generation:  0.03393101692199707
r_  generation:  0.23398423194885254
local_output_nid generation:  0.013657331466674805
local_in_edges_tensor generation:  0.014284610748291016
mini_batch_src_global generation:  0.029006004333496094
r_  generation:  0.2331373691558838
local_output_nid generation:  0.013888120651245117
local_in_edges_tensor generation:  0.013234376907348633
mini_batch_src_global generation:  0.03246760368347168
r_  generation:  0.2368028163909912
local_output_nid generation:  0.013756752014160156
local_in_edges_tensor generation:  0.013289690017700195
mini_batch_src_global generation:  0.029142141342163086
r_  generation:  0.23896455764770508
local_output_nid generation:  0.013503789901733398
local_in_edges_tensor generation:  0.013045787811279297
mini_batch_src_global generation:  0.029708385467529297
r_  generation:  0.2469649314880371
local_output_nid generation:  0.013878583908081055
local_in_edges_tensor generation:  0.015063762664794922
mini_batch_src_global generation:  0.02921772003173828
r_  generation:  0.2393186092376709
local_output_nid generation:  0.014082670211791992
local_in_edges_tensor generation:  0.014585018157958984
mini_batch_src_global generation:  0.03019094467163086
r_  generation:  0.24441742897033691
local_output_nid generation:  0.013868093490600586
local_in_edges_tensor generation:  0.015230417251586914
mini_batch_src_global generation:  0.029813051223754883
r_  generation:  0.24074649810791016
local_output_nid generation:  0.013189315795898438
local_in_edges_tensor generation:  0.01326298713684082
mini_batch_src_global generation:  0.02987074851989746
r_  generation:  0.24281549453735352
local_output_nid generation:  0.013199567794799805
local_in_edges_tensor generation:  0.013342142105102539
mini_batch_src_global generation:  0.031072616577148438
r_  generation:  0.23969697952270508
----------------------check_connections_block total spend ----------------------------- 5.5293028354644775
generate_one_block  0.3080320358276367
generate_one_block  0.30436015129089355
generate_one_block  0.3024728298187256
generate_one_block  0.299471378326416
generate_one_block  0.30446362495422363
generate_one_block  0.30253028869628906
generate_one_block  0.32747936248779297
generate_one_block  0.30147576332092285
generate_one_block  0.30293941497802734
generate_one_block  0.30227208137512207
generate_one_block  0.30840086936950684
generate_one_block  0.3038036823272705
generate_one_block  0.3141021728515625
generate_one_block  0.3098266124725342
generate_one_block  0.3015284538269043
generate_one_block  0.30258846282958984
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03094315528869629
gen group dst list time:  0.06399893760681152
time for parepare:  0.019460201263427734
local_output_nid generation:  0.027094364166259766
local_in_edges_tensor generation:  0.04054665565490723
mini_batch_src_global generation:  0.04032135009765625
r_  generation:  0.4521498680114746
local_output_nid generation:  0.032494544982910156
local_in_edges_tensor generation:  0.03950786590576172
mini_batch_src_global generation:  0.051703453063964844
r_  generation:  0.4532485008239746
local_output_nid generation:  0.0321197509765625
local_in_edges_tensor generation:  0.029346704483032227
mini_batch_src_global generation:  0.050283193588256836
r_  generation:  0.46225929260253906
local_output_nid generation:  0.03212308883666992
local_in_edges_tensor generation:  0.031017303466796875
mini_batch_src_global generation:  0.05223727226257324
r_  generation:  0.4596281051635742
local_output_nid generation:  0.032488107681274414
local_in_edges_tensor generation:  0.07436251640319824
mini_batch_src_global generation:  0.05086040496826172
r_  generation:  0.4737849235534668
local_output_nid generation:  0.03211188316345215
local_in_edges_tensor generation:  0.03380751609802246
mini_batch_src_global generation:  0.05373883247375488
r_  generation:  0.4583923816680908
local_output_nid generation:  0.032126665115356445
local_in_edges_tensor generation:  0.032605886459350586
mini_batch_src_global generation:  0.05160832405090332
r_  generation:  0.46680736541748047
local_output_nid generation:  0.03222489356994629
local_in_edges_tensor generation:  0.029593706130981445
mini_batch_src_global generation:  0.05343985557556152
r_  generation:  0.4633033275604248
local_output_nid generation:  0.0323026180267334
local_in_edges_tensor generation:  0.03206634521484375
mini_batch_src_global generation:  0.05356192588806152
r_  generation:  0.4722890853881836
local_output_nid generation:  0.032175540924072266
local_in_edges_tensor generation:  0.02940082550048828
mini_batch_src_global generation:  0.052906036376953125
r_  generation:  0.46267032623291016
local_output_nid generation:  0.03190922737121582
local_in_edges_tensor generation:  0.0316622257232666
mini_batch_src_global generation:  0.05124258995056152
r_  generation:  0.4745004177093506
local_output_nid generation:  0.03225111961364746
local_in_edges_tensor generation:  0.032501935958862305
mini_batch_src_global generation:  0.0540308952331543
r_  generation:  0.4632890224456787
local_output_nid generation:  0.0324099063873291
local_in_edges_tensor generation:  0.02929377555847168
mini_batch_src_global generation:  0.051862478256225586
r_  generation:  0.46798157691955566
local_output_nid generation:  0.032570838928222656
local_in_edges_tensor generation:  0.032308101654052734
mini_batch_src_global generation:  0.05953359603881836
r_  generation:  0.46500301361083984
local_output_nid generation:  0.032109975814819336
local_in_edges_tensor generation:  0.030451059341430664
mini_batch_src_global generation:  0.05528664588928223
r_  generation:  0.469970703125
local_output_nid generation:  0.032044410705566406
local_in_edges_tensor generation:  0.03549981117248535
mini_batch_src_global generation:  0.05714750289916992
r_  generation:  0.46214938163757324
----------------------check_connections_block total spend ----------------------------- 10.9651517868042
generate_one_block  0.5832164287567139
generate_one_block  0.5901424884796143
generate_one_block  0.5874392986297607
generate_one_block  0.5943160057067871
generate_one_block  0.5924277305603027
generate_one_block  0.5954568386077881
generate_one_block  0.5884506702423096
generate_one_block  0.5955779552459717
generate_one_block  0.6529431343078613
generate_one_block  0.5933074951171875
generate_one_block  0.5919177532196045
generate_one_block  0.5948891639709473
generate_one_block  0.5954275131225586
generate_one_block  0.5972974300384521
generate_one_block  0.5898003578186035
generate_one_block  0.5923500061035156
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.1177663803100586  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

connection checking time:  16.494454622268677
block generation total time  14.430707454681396
average batch blocks generation time:  0.9019192159175873
block dataloader generation time/epoch 33.324106863566804
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09475278854370117  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.747779369354248  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09460115432739258  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7478141784667969  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09476184844970703  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7452211380004883  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09438371658325195  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7418169975280762  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09488868713378906  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7522597312927246  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09437179565429688  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7448954582214355  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09465789794921875  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.74334716796875  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09454011917114258  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7425227165222168  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0947408676147461  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7452540397644043  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09430599212646484  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7421197891235352  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09475994110107422  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7443413734436035  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0943002700805664  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7419357299804688  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0948486328125  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7450981140136719  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0945134162902832  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7455043792724609  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09473800659179688  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7449641227722168  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09446096420288086  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.746086597442627  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06526154279708862 |0.012389704585075378 |0.0035526305437088013 |9.360909461975098e-05 |0.00371377170085907 |0.002920389175415039 |
----------------------------------------------------------pseudo_mini_loss sum 1.3962804079055786
Total (block generation + training)time/epoch 34.77041285378592
Training time/epoch 1.511030912399292
Training time without block to device /epoch 1.312795639038086
Training time without total dataloading part /epoch 0.12068057060241699
load block tensor time/epoch 1.044184684753418
block to device time/epoch 0.19823527336120605
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  5207981
Number of first layer input nodes during this epoch:  2479969
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.1179513931274414  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02210545539855957
random selection method range initialization spend 0.005167961120605469
time for parepare:  0.017450571060180664
local_output_nid generation:  0.002350330352783203
local_in_edges_tensor generation:  0.004105091094970703
mini_batch_src_global generation:  0.0017273426055908203
r_  generation:  0.020715713500976562
local_output_nid generation:  0.0029287338256835938
local_in_edges_tensor generation:  0.0017976760864257812
mini_batch_src_global generation:  0.0020368099212646484
r_  generation:  0.022753000259399414
local_output_nid generation:  0.002927064895629883
local_in_edges_tensor generation:  0.0016987323760986328
mini_batch_src_global generation:  0.0017650127410888672
r_  generation:  0.02227163314819336
local_output_nid generation:  0.003007173538208008
local_in_edges_tensor generation:  0.001775503158569336
mini_batch_src_global generation:  0.0017974376678466797
r_  generation:  0.022635221481323242
local_output_nid generation:  0.003218412399291992
local_in_edges_tensor generation:  0.001917123794555664
mini_batch_src_global generation:  0.0018873214721679688
r_  generation:  0.0218355655670166
local_output_nid generation:  0.003183603286743164
local_in_edges_tensor generation:  0.001840829849243164
mini_batch_src_global generation:  0.0017809867858886719
r_  generation:  0.022242069244384766
local_output_nid generation:  0.0031447410583496094
local_in_edges_tensor generation:  0.0018055438995361328
mini_batch_src_global generation:  0.0017504692077636719
r_  generation:  0.022797107696533203
local_output_nid generation:  0.003054380416870117
local_in_edges_tensor generation:  0.0017368793487548828
mini_batch_src_global generation:  0.0018224716186523438
r_  generation:  0.02240610122680664
local_output_nid generation:  0.003025531768798828
local_in_edges_tensor generation:  0.0016891956329345703
mini_batch_src_global generation:  0.001775503158569336
r_  generation:  0.02258777618408203
local_output_nid generation:  0.002972841262817383
local_in_edges_tensor generation:  0.001672983169555664
mini_batch_src_global generation:  0.0017642974853515625
r_  generation:  0.022513866424560547
local_output_nid generation:  0.0030486583709716797
local_in_edges_tensor generation:  0.0017385482788085938
mini_batch_src_global generation:  0.001790761947631836
r_  generation:  0.02246570587158203
local_output_nid generation:  0.002978801727294922
local_in_edges_tensor generation:  0.00162506103515625
mini_batch_src_global generation:  0.0018205642700195312
r_  generation:  0.02295517921447754
local_output_nid generation:  0.002995729446411133
local_in_edges_tensor generation:  0.0017766952514648438
mini_batch_src_global generation:  0.0018012523651123047
r_  generation:  0.022124767303466797
local_output_nid generation:  0.003053426742553711
local_in_edges_tensor generation:  0.0016858577728271484
mini_batch_src_global generation:  0.0017445087432861328
r_  generation:  0.021715641021728516
local_output_nid generation:  0.00298309326171875
local_in_edges_tensor generation:  0.0016405582427978516
mini_batch_src_global generation:  0.001796722412109375
r_  generation:  0.022965431213378906
local_output_nid generation:  0.0030519962310791016
local_in_edges_tensor generation:  0.0017070770263671875
mini_batch_src_global generation:  0.0018649101257324219
r_  generation:  0.021730661392211914
----------------------check_connections_block total spend ----------------------------- 0.5727024078369141
generate_one_block  0.030649662017822266
generate_one_block  0.03252267837524414
generate_one_block  0.03190970420837402
generate_one_block  0.03133368492126465
generate_one_block  0.031131267547607422
generate_one_block  0.035637617111206055
generate_one_block  0.03190493583679199
generate_one_block  0.03160357475280762
generate_one_block  0.031797170639038086
generate_one_block  0.03157353401184082
generate_one_block  0.03141021728515625
generate_one_block  0.0328826904296875
generate_one_block  0.03169822692871094
generate_one_block  0.03061676025390625
generate_one_block  0.03212451934814453
generate_one_block  0.031231164932250977
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03328585624694824
gen group dst list time:  0.020946741104125977
time for parepare:  0.01947784423828125
local_output_nid generation:  0.009084939956665039
local_in_edges_tensor generation:  0.023573875427246094
mini_batch_src_global generation:  0.021877765655517578
r_  generation:  0.20915794372558594
local_output_nid generation:  0.013094663619995117
local_in_edges_tensor generation:  0.014086484909057617
mini_batch_src_global generation:  0.028145790100097656
r_  generation:  0.2218303680419922
local_output_nid generation:  0.013468027114868164
local_in_edges_tensor generation:  0.01744842529296875
mini_batch_src_global generation:  0.028277158737182617
r_  generation:  0.2311875820159912
local_output_nid generation:  0.013960123062133789
local_in_edges_tensor generation:  0.017302513122558594
mini_batch_src_global generation:  0.027659177780151367
r_  generation:  0.2329423427581787
local_output_nid generation:  0.013731956481933594
local_in_edges_tensor generation:  0.013161420822143555
mini_batch_src_global generation:  0.028623104095458984
r_  generation:  0.23096466064453125
local_output_nid generation:  0.013542652130126953
local_in_edges_tensor generation:  0.014197587966918945
mini_batch_src_global generation:  0.028837919235229492
r_  generation:  0.23366165161132812
local_output_nid generation:  0.013864994049072266
local_in_edges_tensor generation:  0.013374090194702148
mini_batch_src_global generation:  0.029567241668701172
r_  generation:  0.23848438262939453
local_output_nid generation:  0.013744354248046875
local_in_edges_tensor generation:  0.012863636016845703
mini_batch_src_global generation:  0.029430627822875977
r_  generation:  0.23541760444641113
local_output_nid generation:  0.01403665542602539
local_in_edges_tensor generation:  0.013313770294189453
mini_batch_src_global generation:  0.030366182327270508
r_  generation:  0.24636030197143555
local_output_nid generation:  0.01389932632446289
local_in_edges_tensor generation:  0.013225555419921875
mini_batch_src_global generation:  0.02998971939086914
r_  generation:  0.24061203002929688
local_output_nid generation:  0.013399600982666016
local_in_edges_tensor generation:  0.013920783996582031
mini_batch_src_global generation:  0.03426361083984375
r_  generation:  0.2393488883972168
local_output_nid generation:  0.013693094253540039
local_in_edges_tensor generation:  0.01624751091003418
mini_batch_src_global generation:  0.029796838760375977
r_  generation:  0.24024701118469238
local_output_nid generation:  0.014013051986694336
local_in_edges_tensor generation:  0.014287710189819336
mini_batch_src_global generation:  0.030130863189697266
r_  generation:  0.24072527885437012
local_output_nid generation:  0.013490915298461914
local_in_edges_tensor generation:  0.013018131256103516
mini_batch_src_global generation:  0.028800010681152344
r_  generation:  0.23020362854003906
local_output_nid generation:  0.013885498046875
local_in_edges_tensor generation:  0.013806819915771484
mini_batch_src_global generation:  0.030530929565429688
r_  generation:  0.2460041046142578
local_output_nid generation:  0.012749910354614258
local_in_edges_tensor generation:  0.012778043746948242
mini_batch_src_global generation:  0.02953171730041504
r_  generation:  0.23449182510375977
----------------------check_connections_block total spend ----------------------------- 5.501310586929321
generate_one_block  0.2935163974761963
generate_one_block  0.30181050300598145
generate_one_block  0.3044734001159668
generate_one_block  0.30310821533203125
generate_one_block  0.2944824695587158
generate_one_block  0.2977151870727539
generate_one_block  0.32891106605529785
generate_one_block  0.3053104877471924
generate_one_block  0.31026148796081543
generate_one_block  0.3036351203918457
generate_one_block  0.30419492721557617
generate_one_block  0.30818676948547363
generate_one_block  0.3069920539855957
generate_one_block  0.2912311553955078
generate_one_block  0.3123042583465576
generate_one_block  0.2983882427215576
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04716157913208008
gen group dst list time:  0.06310081481933594
time for parepare:  0.018451929092407227
local_output_nid generation:  0.02683877944946289
local_in_edges_tensor generation:  0.044003963470458984
mini_batch_src_global generation:  0.041956424713134766
r_  generation:  0.44794273376464844
local_output_nid generation:  0.03183102607727051
local_in_edges_tensor generation:  0.03775167465209961
mini_batch_src_global generation:  0.052385568618774414
r_  generation:  0.4607412815093994
local_output_nid generation:  0.03247690200805664
local_in_edges_tensor generation:  0.030702829360961914
mini_batch_src_global generation:  0.051804542541503906
r_  generation:  0.46461057662963867
local_output_nid generation:  0.03169751167297363
local_in_edges_tensor generation:  0.03297734260559082
mini_batch_src_global generation:  0.05329704284667969
r_  generation:  0.4666295051574707
local_output_nid generation:  0.03206658363342285
local_in_edges_tensor generation:  0.07257390022277832
mini_batch_src_global generation:  0.0523679256439209
r_  generation:  0.4635031223297119
local_output_nid generation:  0.032071590423583984
local_in_edges_tensor generation:  0.032521724700927734
mini_batch_src_global generation:  0.055864572525024414
r_  generation:  0.462874174118042
local_output_nid generation:  0.031770944595336914
local_in_edges_tensor generation:  0.029700756072998047
mini_batch_src_global generation:  0.05190610885620117
r_  generation:  0.46460723876953125
local_output_nid generation:  0.03235936164855957
local_in_edges_tensor generation:  0.03254342079162598
mini_batch_src_global generation:  0.05446624755859375
r_  generation:  0.45793986320495605
local_output_nid generation:  0.031941890716552734
local_in_edges_tensor generation:  0.032668113708496094
mini_batch_src_global generation:  0.051839351654052734
r_  generation:  0.464231014251709
local_output_nid generation:  0.031780242919921875
local_in_edges_tensor generation:  0.03151893615722656
mini_batch_src_global generation:  0.05294966697692871
r_  generation:  0.45798683166503906
local_output_nid generation:  0.03239774703979492
local_in_edges_tensor generation:  0.03235650062561035
mini_batch_src_global generation:  0.053849220275878906
r_  generation:  0.46469926834106445
local_output_nid generation:  0.03195023536682129
local_in_edges_tensor generation:  0.03135943412780762
mini_batch_src_global generation:  0.054067134857177734
r_  generation:  0.46323084831237793
local_output_nid generation:  0.0319368839263916
local_in_edges_tensor generation:  0.03219413757324219
mini_batch_src_global generation:  0.05171489715576172
r_  generation:  0.46299052238464355
local_output_nid generation:  0.03183150291442871
local_in_edges_tensor generation:  0.03236055374145508
mini_batch_src_global generation:  0.05264616012573242
r_  generation:  0.45723390579223633
local_output_nid generation:  0.03199005126953125
local_in_edges_tensor generation:  0.030014514923095703
mini_batch_src_global generation:  0.05350184440612793
r_  generation:  0.46764254570007324
local_output_nid generation:  0.03223729133605957
local_in_edges_tensor generation:  0.030938386917114258
mini_batch_src_global generation:  0.05348849296569824
r_  generation:  0.4582700729370117
----------------------check_connections_block total spend ----------------------------- 10.907581567764282
generate_one_block  0.5709168910980225
generate_one_block  0.5823478698730469
generate_one_block  0.5964558124542236
generate_one_block  0.5948326587677002
generate_one_block  0.5780301094055176
generate_one_block  0.5812122821807861
generate_one_block  0.5752384662628174
generate_one_block  0.5916621685028076
generate_one_block  0.6313786506652832
generate_one_block  0.5781457424163818
generate_one_block  0.5822536945343018
generate_one_block  0.5906617641448975
generate_one_block  0.5831716060638428
generate_one_block  0.5763282775878906
generate_one_block  0.589287519454956
generate_one_block  0.5853991508483887
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.1179513931274414  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

connection checking time:  16.408892154693604
block generation total time  14.25184440612793
average batch blocks generation time:  0.8907402753829956
block dataloader generation time/epoch 33.260584861040115
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09445810317993164  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7395639419555664  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0943593978881836  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7439594268798828  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09485149383544922  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7522439956665039  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0945439338684082  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7488088607788086  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09461212158203125  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7424368858337402  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09456014633178711  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7468132972717285  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09478378295898438  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7437772750854492  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0944509506225586  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7439308166503906  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09489822387695312  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7526764869689941  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0942850112915039  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7426228523254395  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09480476379394531  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7469606399536133  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0944976806640625  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7470622062683105  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09482002258300781  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7457466125488281  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09409379959106445  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7375049591064453  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09498882293701172  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7525286674499512  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09435319900512695  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7415170669555664  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06517159938812256 |0.010608121752738953 |0.0035189539194107056 |9.244680404663086e-05 |0.0036855340003967285 |0.00131988525390625 |
----------------------------------------------------------pseudo_mini_loss sum 1.371973991394043
Total (block generation + training)time/epoch 34.70021662116051
Training time/epoch 1.3926303386688232
Training time without block to device /epoch 1.222900390625
Training time without total dataloading part /epoch 0.11807084083557129
load block tensor time/epoch 1.042745590209961
block to device time/epoch 0.16972994804382324
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  5208123
Number of first layer input nodes during this epoch:  2480234
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11749458312988281  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02126765251159668
random selection method range initialization spend 0.005127906799316406
time for parepare:  0.01759171485900879
local_output_nid generation:  0.002445220947265625
local_in_edges_tensor generation:  0.004066944122314453
mini_batch_src_global generation:  0.0018146038055419922
r_  generation:  0.021454572677612305
local_output_nid generation:  0.002860546112060547
local_in_edges_tensor generation:  0.0017390251159667969
mini_batch_src_global generation:  0.002143383026123047
r_  generation:  0.022635936737060547
local_output_nid generation:  0.0029599666595458984
local_in_edges_tensor generation:  0.0017387866973876953
mini_batch_src_global generation:  0.0017631053924560547
r_  generation:  0.021549224853515625
local_output_nid generation:  0.0029931068420410156
local_in_edges_tensor generation:  0.0017647743225097656
mini_batch_src_global generation:  0.0017914772033691406
r_  generation:  0.022086143493652344
local_output_nid generation:  0.003049612045288086
local_in_edges_tensor generation:  0.001767873764038086
mini_batch_src_global generation:  0.0018343925476074219
r_  generation:  0.022459030151367188
local_output_nid generation:  0.003044605255126953
local_in_edges_tensor generation:  0.0017230510711669922
mini_batch_src_global generation:  0.001796722412109375
r_  generation:  0.022581100463867188
local_output_nid generation:  0.0030655860900878906
local_in_edges_tensor generation:  0.0017385482788085938
mini_batch_src_global generation:  0.0018041133880615234
r_  generation:  0.02231907844543457
local_output_nid generation:  0.0030188560485839844
local_in_edges_tensor generation:  0.0017633438110351562
mini_batch_src_global generation:  0.0017540454864501953
r_  generation:  0.02207779884338379
local_output_nid generation:  0.003027200698852539
local_in_edges_tensor generation:  0.001806020736694336
mini_batch_src_global generation:  0.0017349720001220703
r_  generation:  0.02157282829284668
local_output_nid generation:  0.0030405521392822266
local_in_edges_tensor generation:  0.0017447471618652344
mini_batch_src_global generation:  0.0017631053924560547
r_  generation:  0.022231101989746094
local_output_nid generation:  0.0030181407928466797
local_in_edges_tensor generation:  0.0017056465148925781
mini_batch_src_global generation:  0.001804351806640625
r_  generation:  0.021872997283935547
local_output_nid generation:  0.0030450820922851562
local_in_edges_tensor generation:  0.0016906261444091797
mini_batch_src_global generation:  0.0018470287322998047
r_  generation:  0.023372173309326172
local_output_nid generation:  0.003023862838745117
local_in_edges_tensor generation:  0.0016987323760986328
mini_batch_src_global generation:  0.0017893314361572266
r_  generation:  0.02223038673400879
local_output_nid generation:  0.0029959678649902344
local_in_edges_tensor generation:  0.0017178058624267578
mini_batch_src_global generation:  0.0017671585083007812
r_  generation:  0.02231574058532715
local_output_nid generation:  0.0030126571655273438
local_in_edges_tensor generation:  0.0016980171203613281
mini_batch_src_global generation:  0.0018160343170166016
r_  generation:  0.022115707397460938
local_output_nid generation:  0.0029947757720947266
local_in_edges_tensor generation:  0.001676321029663086
mini_batch_src_global generation:  0.0018072128295898438
r_  generation:  0.022927284240722656
----------------------check_connections_block total spend ----------------------------- 0.5699665546417236
generate_one_block  0.03166699409484863
generate_one_block  0.03229093551635742
generate_one_block  0.03091144561767578
generate_one_block  0.031508684158325195
generate_one_block  0.03160285949707031
generate_one_block  0.03456306457519531
generate_one_block  0.031456708908081055
generate_one_block  0.030782222747802734
generate_one_block  0.030272960662841797
generate_one_block  0.03131604194641113
generate_one_block  0.030870437622070312
generate_one_block  0.03236579895019531
generate_one_block  0.031027793884277344
generate_one_block  0.030910730361938477
generate_one_block  0.031288862228393555
generate_one_block  0.03237414360046387
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06161046028137207
gen group dst list time:  0.02181863784790039
time for parepare:  0.021799564361572266
local_output_nid generation:  0.010757684707641602
local_in_edges_tensor generation:  0.02540278434753418
mini_batch_src_global generation:  0.022937774658203125
r_  generation:  0.21748828887939453
local_output_nid generation:  0.018520593643188477
local_in_edges_tensor generation:  0.017223119735717773
mini_batch_src_global generation:  0.027538061141967773
r_  generation:  0.2297666072845459
local_output_nid generation:  0.0164639949798584
local_in_edges_tensor generation:  0.018476009368896484
mini_batch_src_global generation:  0.027836322784423828
r_  generation:  0.22975683212280273
local_output_nid generation:  0.017298221588134766
local_in_edges_tensor generation:  0.014391183853149414
mini_batch_src_global generation:  0.02738809585571289
r_  generation:  0.23685884475708008
local_output_nid generation:  0.01721334457397461
local_in_edges_tensor generation:  0.01712632179260254
mini_batch_src_global generation:  0.03404688835144043
r_  generation:  0.2444155216217041
local_output_nid generation:  0.021023273468017578
local_in_edges_tensor generation:  0.01613473892211914
mini_batch_src_global generation:  0.029162883758544922
r_  generation:  0.24827790260314941
local_output_nid generation:  0.01741814613342285
local_in_edges_tensor generation:  0.017293930053710938
mini_batch_src_global generation:  0.03073263168334961
r_  generation:  0.2395470142364502
local_output_nid generation:  0.018656253814697266
local_in_edges_tensor generation:  0.018160581588745117
mini_batch_src_global generation:  0.02957463264465332
r_  generation:  0.23876404762268066
local_output_nid generation:  0.016984939575195312
local_in_edges_tensor generation:  0.01734447479248047
mini_batch_src_global generation:  0.030133485794067383
r_  generation:  0.23231840133666992
local_output_nid generation:  0.017675161361694336
local_in_edges_tensor generation:  0.015755414962768555
mini_batch_src_global generation:  0.0294339656829834
r_  generation:  0.23796844482421875
local_output_nid generation:  0.01830434799194336
local_in_edges_tensor generation:  0.014443159103393555
mini_batch_src_global generation:  0.02996659278869629
r_  generation:  0.23736357688903809
local_output_nid generation:  0.017877578735351562
local_in_edges_tensor generation:  0.017687082290649414
mini_batch_src_global generation:  0.03135323524475098
r_  generation:  0.2454986572265625
local_output_nid generation:  0.017292022705078125
local_in_edges_tensor generation:  0.014521598815917969
mini_batch_src_global generation:  0.030018091201782227
r_  generation:  0.23997259140014648
local_output_nid generation:  0.01750349998474121
local_in_edges_tensor generation:  0.014250755310058594
mini_batch_src_global generation:  0.03044891357421875
r_  generation:  0.2401876449584961
local_output_nid generation:  0.017142772674560547
local_in_edges_tensor generation:  0.02011871337890625
mini_batch_src_global generation:  0.031421661376953125
r_  generation:  0.2437601089477539
local_output_nid generation:  0.016876697540283203
local_in_edges_tensor generation:  0.01483607292175293
mini_batch_src_global generation:  0.029699325561523438
r_  generation:  0.2414093017578125
----------------------check_connections_block total spend ----------------------------- 5.706226348876953
generate_one_block  0.31777048110961914
generate_one_block  0.31169843673706055
generate_one_block  0.3069736957550049
generate_one_block  0.30556654930114746
generate_one_block  0.3075277805328369
generate_one_block  0.3074367046356201
generate_one_block  0.3488450050354004
generate_one_block  0.3046281337738037
generate_one_block  0.2953822612762451
generate_one_block  0.31023120880126953
generate_one_block  0.3133699893951416
generate_one_block  0.3265798091888428
generate_one_block  0.30036497116088867
generate_one_block  0.3035459518432617
generate_one_block  0.31101202964782715
generate_one_block  0.31225132942199707
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04184579849243164
gen group dst list time:  0.06650424003601074
time for parepare:  0.020694971084594727
local_output_nid generation:  0.02771925926208496
local_in_edges_tensor generation:  0.053353071212768555
mini_batch_src_global generation:  0.04246258735656738
r_  generation:  0.46137118339538574
local_output_nid generation:  0.03259754180908203
local_in_edges_tensor generation:  0.03905653953552246
mini_batch_src_global generation:  0.05440163612365723
r_  generation:  0.4646117687225342
local_output_nid generation:  0.03179764747619629
local_in_edges_tensor generation:  0.03440976142883301
mini_batch_src_global generation:  0.054985761642456055
r_  generation:  0.4626190662384033
local_output_nid generation:  0.03300762176513672
local_in_edges_tensor generation:  0.031101465225219727
mini_batch_src_global generation:  0.05316805839538574
r_  generation:  0.45777416229248047
local_output_nid generation:  0.03225445747375488
local_in_edges_tensor generation:  0.0808708667755127
mini_batch_src_global generation:  0.0536952018737793
r_  generation:  0.47120237350463867
local_output_nid generation:  0.03374528884887695
local_in_edges_tensor generation:  0.03772568702697754
mini_batch_src_global generation:  0.054833412170410156
r_  generation:  0.48589062690734863
local_output_nid generation:  0.03522157669067383
local_in_edges_tensor generation:  0.0348973274230957
mini_batch_src_global generation:  0.0569765567779541
r_  generation:  0.4737997055053711
local_output_nid generation:  0.03301692008972168
local_in_edges_tensor generation:  0.033782958984375
mini_batch_src_global generation:  0.05450797080993652
r_  generation:  0.4663403034210205
local_output_nid generation:  0.033263444900512695
local_in_edges_tensor generation:  0.03001546859741211
mini_batch_src_global generation:  0.05235171318054199
r_  generation:  0.4637300968170166
local_output_nid generation:  0.03292512893676758
local_in_edges_tensor generation:  0.03190946578979492
mini_batch_src_global generation:  0.0584409236907959
r_  generation:  0.45747804641723633
local_output_nid generation:  0.03318333625793457
local_in_edges_tensor generation:  0.03061842918395996
mini_batch_src_global generation:  0.07091259956359863
r_  generation:  0.4648716449737549
local_output_nid generation:  0.0328829288482666
local_in_edges_tensor generation:  0.03226900100708008
mini_batch_src_global generation:  0.05405855178833008
r_  generation:  0.4596216678619385
local_output_nid generation:  0.032674312591552734
local_in_edges_tensor generation:  0.0296480655670166
mini_batch_src_global generation:  0.05239295959472656
r_  generation:  0.4731912612915039
local_output_nid generation:  0.03294873237609863
local_in_edges_tensor generation:  0.03074169158935547
mini_batch_src_global generation:  0.0603334903717041
r_  generation:  0.46714115142822266
local_output_nid generation:  0.03325629234313965
local_in_edges_tensor generation:  0.0321812629699707
mini_batch_src_global generation:  0.05540108680725098
r_  generation:  0.48069119453430176
local_output_nid generation:  0.033294677734375
local_in_edges_tensor generation:  0.03451800346374512
mini_batch_src_global generation:  0.056572675704956055
r_  generation:  0.4720287322998047
----------------------check_connections_block total spend ----------------------------- 11.137761116027832
generate_one_block  0.6016876697540283
generate_one_block  0.5995354652404785
generate_one_block  0.5936930179595947
generate_one_block  0.5856173038482666
generate_one_block  0.5927503108978271
generate_one_block  0.5905125141143799
generate_one_block  0.5947287082672119
generate_one_block  0.5836915969848633
generate_one_block  0.658867597579956
generate_one_block  0.5958349704742432
generate_one_block  0.5822312831878662
generate_one_block  0.5966856479644775
generate_one_block  0.5923857688903809
generate_one_block  0.6079204082489014
generate_one_block  0.6036005020141602
generate_one_block  0.6005017757415771
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11749458312988281  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

connection checking time:  16.843987464904785
block generation total time  14.56342887878418
average batch blocks generation time:  0.9102143049240112
block dataloader generation time/epoch 33.30087023311191
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09488248825073242  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7483692169189453  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09466743469238281  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7530941963195801  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.094635009765625  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7401008605957031  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0944666862487793  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7468342781066895  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09479904174804688  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7473201751708984  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09464406967163086  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7477302551269531  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09477615356445312  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7443728446960449  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09436368942260742  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7435073852539062  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09453487396240234  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7384815216064453  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09455490112304688  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7476644515991211  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09466171264648438  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7419428825378418  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0948019027709961  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7565250396728516  GigaBytes
Max Memory Allocated: 0.8448271751403809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0946340560913086  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7411966323852539  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09430122375488281  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7424111366271973  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09482479095458984  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7465133666992188  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09453010559082031  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7469010353088379  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06193499267101288 |0.013982370495796204 |0.0034779608249664307 |9.381771087646484e-05 |0.003387659788131714 |0.00165557861328125 |
----------------------------------------------------------pseudo_mini_loss sum 1.3541074991226196
Total (block generation + training)time/epoch 34.735055367151894
Training time/epoch 1.3903326988220215
Training time without block to device /epoch 1.1666147708892822
Training time without total dataloading part /epoch 0.113006591796875
load block tensor time/epoch 0.990959882736206
block to device time/epoch 0.22371792793273926
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  5209900
Number of first layer input nodes during this epoch:  2480295
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11814260482788086  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02617359161376953
random selection method range initialization spend 0.00514674186706543
time for parepare:  0.01975107192993164
local_output_nid generation:  0.002326488494873047
local_in_edges_tensor generation:  0.0049512386322021484
mini_batch_src_global generation:  0.0017247200012207031
r_  generation:  0.020506858825683594
local_output_nid generation:  0.002869129180908203
local_in_edges_tensor generation:  0.0017397403717041016
mini_batch_src_global generation:  0.0020568370819091797
r_  generation:  0.021683216094970703
local_output_nid generation:  0.0029599666595458984
local_in_edges_tensor generation:  0.0017330646514892578
mini_batch_src_global generation:  0.0017771720886230469
r_  generation:  0.02126598358154297
local_output_nid generation:  0.0031566619873046875
local_in_edges_tensor generation:  0.0018680095672607422
mini_batch_src_global generation:  0.001821279525756836
r_  generation:  0.02133798599243164
local_output_nid generation:  0.0030035972595214844
local_in_edges_tensor generation:  0.0017008781433105469
mini_batch_src_global generation:  0.0018308162689208984
r_  generation:  0.0227508544921875
local_output_nid generation:  0.002989053726196289
local_in_edges_tensor generation:  0.0018010139465332031
mini_batch_src_global generation:  0.0018284320831298828
r_  generation:  0.02205491065979004
local_output_nid generation:  0.002984762191772461
local_in_edges_tensor generation:  0.0016970634460449219
mini_batch_src_global generation:  0.0018413066864013672
r_  generation:  0.0221102237701416
local_output_nid generation:  0.003010272979736328
local_in_edges_tensor generation:  0.0016951560974121094
mini_batch_src_global generation:  0.001834869384765625
r_  generation:  0.022173404693603516
local_output_nid generation:  0.0029985904693603516
local_in_edges_tensor generation:  0.0016951560974121094
mini_batch_src_global generation:  0.0018155574798583984
r_  generation:  0.02219223976135254
local_output_nid generation:  0.00301361083984375
local_in_edges_tensor generation:  0.0016684532165527344
mini_batch_src_global generation:  0.0018036365509033203
r_  generation:  0.024516820907592773
local_output_nid generation:  0.002974271774291992
local_in_edges_tensor generation:  0.0016717910766601562
mini_batch_src_global generation:  0.0018548965454101562
r_  generation:  0.023214340209960938
local_output_nid generation:  0.0030431747436523438
local_in_edges_tensor generation:  0.0017023086547851562
mini_batch_src_global generation:  0.0018656253814697266
r_  generation:  0.022516489028930664
local_output_nid generation:  0.0029764175415039062
local_in_edges_tensor generation:  0.001692056655883789
mini_batch_src_global generation:  0.0018546581268310547
r_  generation:  0.02200007438659668
local_output_nid generation:  0.003000497817993164
local_in_edges_tensor generation:  0.001653909683227539
mini_batch_src_global generation:  0.0018286705017089844
r_  generation:  0.022124528884887695
local_output_nid generation:  0.0030052661895751953
local_in_edges_tensor generation:  0.0016179084777832031
mini_batch_src_global generation:  0.0018229484558105469
r_  generation:  0.022524356842041016
local_output_nid generation:  0.002969026565551758
local_in_edges_tensor generation:  0.0016586780548095703
mini_batch_src_global generation:  0.0017859935760498047
r_  generation:  0.02276468276977539
----------------------check_connections_block total spend ----------------------------- 0.57222580909729
generate_one_block  0.03834080696105957
generate_one_block  0.03162384033203125
generate_one_block  0.030523300170898438
generate_one_block  0.03050398826599121
generate_one_block  0.03213930130004883
generate_one_block  0.03395581245422363
generate_one_block  0.031354665756225586
generate_one_block  0.03109145164489746
generate_one_block  0.03088665008544922
generate_one_block  0.031607627868652344
generate_one_block  0.032907962799072266
generate_one_block  0.03205084800720215
generate_one_block  0.031042098999023438
generate_one_block  0.03147268295288086
generate_one_block  0.03154730796813965
generate_one_block  0.0324854850769043
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030704736709594727
gen group dst list time:  0.017914295196533203
time for parepare:  0.019750595092773438
local_output_nid generation:  0.009093284606933594
local_in_edges_tensor generation:  0.01984858512878418
mini_batch_src_global generation:  0.021571636199951172
r_  generation:  0.21146464347839355
local_output_nid generation:  0.013333559036254883
local_in_edges_tensor generation:  0.015242338180541992
mini_batch_src_global generation:  0.026945114135742188
r_  generation:  0.2218928337097168
local_output_nid generation:  0.013286828994750977
local_in_edges_tensor generation:  0.013963699340820312
mini_batch_src_global generation:  0.026462554931640625
r_  generation:  0.22887516021728516
local_output_nid generation:  0.01382899284362793
local_in_edges_tensor generation:  0.013458490371704102
mini_batch_src_global generation:  0.026953458786010742
r_  generation:  0.22609448432922363
local_output_nid generation:  0.013921499252319336
local_in_edges_tensor generation:  0.019281864166259766
mini_batch_src_global generation:  0.030371665954589844
r_  generation:  0.23912715911865234
local_output_nid generation:  0.013516426086425781
local_in_edges_tensor generation:  0.013167381286621094
mini_batch_src_global generation:  0.029076099395751953
r_  generation:  0.2321310043334961
local_output_nid generation:  0.01389622688293457
local_in_edges_tensor generation:  0.015122413635253906
mini_batch_src_global generation:  0.02907109260559082
r_  generation:  0.23704981803894043
local_output_nid generation:  0.013867616653442383
local_in_edges_tensor generation:  0.01314544677734375
mini_batch_src_global generation:  0.029412031173706055
r_  generation:  0.23721981048583984
local_output_nid generation:  0.013823270797729492
local_in_edges_tensor generation:  0.013298988342285156
mini_batch_src_global generation:  0.029171228408813477
r_  generation:  0.2366492748260498
local_output_nid generation:  0.013954877853393555
local_in_edges_tensor generation:  0.012937784194946289
mini_batch_src_global generation:  0.029097318649291992
r_  generation:  0.2340857982635498
local_output_nid generation:  0.01363062858581543
local_in_edges_tensor generation:  0.01644158363342285
mini_batch_src_global generation:  0.031261444091796875
r_  generation:  0.24348163604736328
local_output_nid generation:  0.014032602310180664
local_in_edges_tensor generation:  0.01321268081665039
mini_batch_src_global generation:  0.030019044876098633
r_  generation:  0.24198341369628906
local_output_nid generation:  0.013929128646850586
local_in_edges_tensor generation:  0.013267993927001953
mini_batch_src_global generation:  0.029593944549560547
r_  generation:  0.2351675033569336
local_output_nid generation:  0.013779640197753906
local_in_edges_tensor generation:  0.013297080993652344
mini_batch_src_global generation:  0.02967095375061035
r_  generation:  0.24151229858398438
local_output_nid generation:  0.013518333435058594
local_in_edges_tensor generation:  0.01412820816040039
mini_batch_src_global generation:  0.02999711036682129
r_  generation:  0.24586772918701172
local_output_nid generation:  0.01366734504699707
local_in_edges_tensor generation:  0.01593494415283203
mini_batch_src_global generation:  0.0315401554107666
r_  generation:  0.24790358543395996
----------------------check_connections_block total spend ----------------------------- 5.509856700897217
generate_one_block  0.30147314071655273
generate_one_block  0.29894471168518066
generate_one_block  0.29764628410339355
generate_one_block  0.2965872287750244
generate_one_block  0.3138561248779297
generate_one_block  0.30425095558166504
generate_one_block  0.3311161994934082
generate_one_block  0.30941152572631836
generate_one_block  0.30605030059814453
generate_one_block  0.30103492736816406
generate_one_block  0.31798577308654785
generate_one_block  0.31184983253479004
generate_one_block  0.3008460998535156
generate_one_block  0.3041067123413086
generate_one_block  0.30471372604370117
generate_one_block  0.31426572799682617
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03373098373413086
gen group dst list time:  0.06347537040710449
time for parepare:  0.01827073097229004
local_output_nid generation:  0.027299165725708008
local_in_edges_tensor generation:  0.04078388214111328
mini_batch_src_global generation:  0.03984856605529785
r_  generation:  0.453230619430542
local_output_nid generation:  0.03227639198303223
local_in_edges_tensor generation:  0.03868865966796875
mini_batch_src_global generation:  0.05197477340698242
r_  generation:  0.4510970115661621
local_output_nid generation:  0.03241872787475586
local_in_edges_tensor generation:  0.030710458755493164
mini_batch_src_global generation:  0.052942752838134766
r_  generation:  0.46304965019226074
local_output_nid generation:  0.03188347816467285
local_in_edges_tensor generation:  0.031235694885253906
mini_batch_src_global generation:  0.0523984432220459
r_  generation:  0.45579957962036133
local_output_nid generation:  0.03219866752624512
local_in_edges_tensor generation:  0.07309341430664062
mini_batch_src_global generation:  0.05190539360046387
r_  generation:  0.4725337028503418
local_output_nid generation:  0.0317683219909668
local_in_edges_tensor generation:  0.03199028968811035
mini_batch_src_global generation:  0.053821563720703125
r_  generation:  0.4637150764465332
local_output_nid generation:  0.03199887275695801
local_in_edges_tensor generation:  0.03345942497253418
mini_batch_src_global generation:  0.052739620208740234
r_  generation:  0.4769887924194336
local_output_nid generation:  0.03210306167602539
local_in_edges_tensor generation:  0.03546857833862305
mini_batch_src_global generation:  0.0537562370300293
r_  generation:  0.464282751083374
local_output_nid generation:  0.03223991394042969
local_in_edges_tensor generation:  0.03283119201660156
mini_batch_src_global generation:  0.05239725112915039
r_  generation:  0.47376585006713867
local_output_nid generation:  0.03259158134460449
local_in_edges_tensor generation:  0.03248000144958496
mini_batch_src_global generation:  0.05664801597595215
r_  generation:  0.4617493152618408
local_output_nid generation:  0.032510995864868164
local_in_edges_tensor generation:  0.030933141708374023
mini_batch_src_global generation:  0.05187225341796875
r_  generation:  0.4711263179779053
local_output_nid generation:  0.031862735748291016
local_in_edges_tensor generation:  0.034895896911621094
mini_batch_src_global generation:  0.05369091033935547
r_  generation:  0.4643120765686035
local_output_nid generation:  0.03314352035522461
local_in_edges_tensor generation:  0.035514116287231445
mini_batch_src_global generation:  0.05198383331298828
r_  generation:  0.46915221214294434
local_output_nid generation:  0.03228020668029785
local_in_edges_tensor generation:  0.03267836570739746
mini_batch_src_global generation:  0.055860280990600586
r_  generation:  0.46245551109313965
local_output_nid generation:  0.03176379203796387
local_in_edges_tensor generation:  0.03081536293029785
mini_batch_src_global generation:  0.05173015594482422
r_  generation:  0.4731321334838867
local_output_nid generation:  0.032351016998291016
local_in_edges_tensor generation:  0.032819509506225586
mini_batch_src_global generation:  0.055002450942993164
r_  generation:  0.46264028549194336
----------------------check_connections_block total spend ----------------------------- 10.987865447998047
generate_one_block  0.5786104202270508
generate_one_block  0.5810539722442627
generate_one_block  0.5809075832366943
generate_one_block  0.5807335376739502
generate_one_block  0.585651159286499
generate_one_block  0.5961410999298096
generate_one_block  0.5939157009124756
generate_one_block  0.5897805690765381
generate_one_block  0.6270639896392822
generate_one_block  0.5940515995025635
generate_one_block  0.5976815223693848
generate_one_block  0.595496416091919
generate_one_block  0.5913221836090088
generate_one_block  0.5970439910888672
generate_one_block  0.5848557949066162
generate_one_block  0.5833516120910645
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11814260482788086  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

connection checking time:  16.497722148895264
block generation total time  14.371800422668457
average batch blocks generation time:  0.8982375264167786
block dataloader generation time/epoch 33.27580935955048
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0946049690246582  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.741307258605957  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09436988830566406  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7424454689025879  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09468936920166016  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7434530258178711  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09434843063354492  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7425346374511719  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0949239730834961  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7530598640441895  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09429168701171875  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7416625022888184  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09475326538085938  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7433309555053711  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09452962875366211  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7472586631774902  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09471607208251953  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.743445873260498  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09438228607177734  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7418279647827148  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09491348266601562  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7496485710144043  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09452581405639648  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.753143310546875  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09461307525634766  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7424092292785645  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09436464309692383  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7434282302856445  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09479904174804688  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7434678077697754  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09468460083007812  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7540392875671387  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06508159637451172 |0.015145555138587952 |0.0035272687673568726 |9.310245513916016e-05 |0.0036538541316986084 |0.001752614974975586 |
----------------------------------------------------------pseudo_mini_loss sum 1.3380573987960815
Total (block generation + training)time/epoch 34.712967824935916
Training time/epoch 1.4637799263000488
Training time without block to device /epoch 1.2214510440826416
Training time without total dataloading part /epoch 0.11814022064208984
load block tensor time/epoch 1.0413055419921875
block to device time/epoch 0.24232888221740723
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  5206646
Number of first layer input nodes during this epoch:  2479360
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11942672729492188  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023392915725708008
random selection method range initialization spend 0.005271196365356445
time for parepare:  0.019126176834106445
local_output_nid generation:  0.002404451370239258
local_in_edges_tensor generation:  0.00716853141784668
mini_batch_src_global generation:  0.0022170543670654297
r_  generation:  0.02156805992126465
local_output_nid generation:  0.0029458999633789062
local_in_edges_tensor generation:  0.0017669200897216797
mini_batch_src_global generation:  0.00235748291015625
r_  generation:  0.022786617279052734
local_output_nid generation:  0.002992391586303711
local_in_edges_tensor generation:  0.0018203258514404297
mini_batch_src_global generation:  0.0017273426055908203
r_  generation:  0.021574735641479492
local_output_nid generation:  0.0030832290649414062
local_in_edges_tensor generation:  0.0017962455749511719
mini_batch_src_global generation:  0.0018162727355957031
r_  generation:  0.022672414779663086
local_output_nid generation:  0.0030069351196289062
local_in_edges_tensor generation:  0.0017361640930175781
mini_batch_src_global generation:  0.0018177032470703125
r_  generation:  0.02195000648498535
local_output_nid generation:  0.003007650375366211
local_in_edges_tensor generation:  0.0017316341400146484
mini_batch_src_global generation:  0.001766204833984375
r_  generation:  0.022522687911987305
local_output_nid generation:  0.003051280975341797
local_in_edges_tensor generation:  0.0018329620361328125
mini_batch_src_global generation:  0.0037386417388916016
r_  generation:  0.02220749855041504
local_output_nid generation:  0.003020048141479492
local_in_edges_tensor generation:  0.001760721206665039
mini_batch_src_global generation:  0.0018281936645507812
r_  generation:  0.028277158737182617
local_output_nid generation:  0.003055572509765625
local_in_edges_tensor generation:  0.0017795562744140625
mini_batch_src_global generation:  0.0021805763244628906
r_  generation:  0.023915767669677734
local_output_nid generation:  0.0029892921447753906
local_in_edges_tensor generation:  0.001735687255859375
mini_batch_src_global generation:  0.0021317005157470703
r_  generation:  0.024660825729370117
local_output_nid generation:  0.003009796142578125
local_in_edges_tensor generation:  0.0017101764678955078
mini_batch_src_global generation:  0.0021812915802001953
r_  generation:  0.02399158477783203
local_output_nid generation:  0.0030202865600585938
local_in_edges_tensor generation:  0.0016739368438720703
mini_batch_src_global generation:  0.002310514450073242
r_  generation:  0.02439117431640625
local_output_nid generation:  0.0030777454376220703
local_in_edges_tensor generation:  0.0016994476318359375
mini_batch_src_global generation:  0.002106904983520508
r_  generation:  0.024054288864135742
local_output_nid generation:  0.0029976367950439453
local_in_edges_tensor generation:  0.0017240047454833984
mini_batch_src_global generation:  0.0021016597747802734
r_  generation:  0.024356603622436523
local_output_nid generation:  0.0029892921447753906
local_in_edges_tensor generation:  0.0016455650329589844
mini_batch_src_global generation:  0.0022187232971191406
r_  generation:  0.02459573745727539
local_output_nid generation:  0.003026723861694336
local_in_edges_tensor generation:  0.001695871353149414
mini_batch_src_global generation:  0.0020956993103027344
r_  generation:  0.023696184158325195
----------------------check_connections_block total spend ----------------------------- 0.6151394844055176
generate_one_block  0.03924202919006348
generate_one_block  0.03320002555847168
generate_one_block  0.032456159591674805
generate_one_block  0.03390169143676758
generate_one_block  0.031714439392089844
generate_one_block  0.03368330001831055
generate_one_block  0.03128957748413086
generate_one_block  0.03228449821472168
generate_one_block  0.03090667724609375
generate_one_block  0.030795574188232422
generate_one_block  0.030444622039794922
generate_one_block  0.03115701675415039
generate_one_block  0.030947208404541016
generate_one_block  0.030841350555419922
generate_one_block  0.03228902816772461
generate_one_block  0.030483245849609375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03332400321960449
gen group dst list time:  0.019034385681152344
time for parepare:  0.019110918045043945
local_output_nid generation:  0.009319543838500977
local_in_edges_tensor generation:  0.02526402473449707
mini_batch_src_global generation:  0.025386810302734375
r_  generation:  0.2191617488861084
local_output_nid generation:  0.013085603713989258
local_in_edges_tensor generation:  0.017245769500732422
mini_batch_src_global generation:  0.027997493743896484
r_  generation:  0.22023797035217285
local_output_nid generation:  0.01276087760925293
local_in_edges_tensor generation:  0.012959957122802734
mini_batch_src_global generation:  0.0264434814453125
r_  generation:  0.2267298698425293
local_output_nid generation:  0.013759136199951172
local_in_edges_tensor generation:  0.01404118537902832
mini_batch_src_global generation:  0.029072999954223633
r_  generation:  0.23576116561889648
local_output_nid generation:  0.0136566162109375
local_in_edges_tensor generation:  0.013954639434814453
mini_batch_src_global generation:  0.02974867820739746
r_  generation:  0.23620128631591797
local_output_nid generation:  0.013667821884155273
local_in_edges_tensor generation:  0.015316963195800781
mini_batch_src_global generation:  0.029077768325805664
r_  generation:  0.23433327674865723
local_output_nid generation:  0.01516866683959961
local_in_edges_tensor generation:  0.014010906219482422
mini_batch_src_global generation:  0.0289764404296875
r_  generation:  0.23521709442138672
local_output_nid generation:  0.013934850692749023
local_in_edges_tensor generation:  0.01331186294555664
mini_batch_src_global generation:  0.02986431121826172
r_  generation:  0.24329447746276855
local_output_nid generation:  0.013892650604248047
local_in_edges_tensor generation:  0.014901161193847656
mini_batch_src_global generation:  0.02974414825439453
r_  generation:  0.23579955101013184
local_output_nid generation:  0.015078544616699219
local_in_edges_tensor generation:  0.013061046600341797
mini_batch_src_global generation:  0.02943253517150879
r_  generation:  0.23779559135437012
local_output_nid generation:  0.013479232788085938
local_in_edges_tensor generation:  0.013449430465698242
mini_batch_src_global generation:  0.02985548973083496
r_  generation:  0.23735308647155762
local_output_nid generation:  0.01470494270324707
local_in_edges_tensor generation:  0.013726234436035156
mini_batch_src_global generation:  0.030718326568603516
r_  generation:  0.24343562126159668
local_output_nid generation:  0.013744592666625977
local_in_edges_tensor generation:  0.016185760498046875
mini_batch_src_global generation:  0.02983689308166504
r_  generation:  0.24027562141418457
local_output_nid generation:  0.013861417770385742
local_in_edges_tensor generation:  0.014326810836791992
mini_batch_src_global generation:  0.029709815979003906
r_  generation:  0.2375192642211914
local_output_nid generation:  0.013668537139892578
local_in_edges_tensor generation:  0.013058900833129883
mini_batch_src_global generation:  0.031263113021850586
r_  generation:  0.2442789077758789
local_output_nid generation:  0.012883901596069336
local_in_edges_tensor generation:  0.017772912979125977
mini_batch_src_global generation:  0.029014110565185547
r_  generation:  0.2311854362487793
----------------------check_connections_block total spend ----------------------------- 5.521581649780273
generate_one_block  0.31871557235717773
generate_one_block  0.3044466972351074
generate_one_block  0.3021402359008789
generate_one_block  0.3136100769042969
generate_one_block  0.30107545852661133
generate_one_block  0.30066585540771484
generate_one_block  0.3334989547729492
generate_one_block  0.3152143955230713
generate_one_block  0.2984926700592041
generate_one_block  0.29923009872436523
generate_one_block  0.2948904037475586
generate_one_block  0.31268835067749023
generate_one_block  0.30672383308410645
generate_one_block  0.31029748916625977
generate_one_block  0.3109292984008789
generate_one_block  0.2911372184753418
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03441333770751953
gen group dst list time:  0.06650710105895996
time for parepare:  0.017959117889404297
local_output_nid generation:  0.027347087860107422
local_in_edges_tensor generation:  0.052306175231933594
mini_batch_src_global generation:  0.043547630310058594
r_  generation:  0.4537210464477539
local_output_nid generation:  0.033506155014038086
local_in_edges_tensor generation:  0.038712263107299805
mini_batch_src_global generation:  0.054308176040649414
r_  generation:  0.45311999320983887
local_output_nid generation:  0.032024383544921875
local_in_edges_tensor generation:  0.03460407257080078
mini_batch_src_global generation:  0.05156731605529785
r_  generation:  0.4619014263153076
local_output_nid generation:  0.03228640556335449
local_in_edges_tensor generation:  0.03653550148010254
mini_batch_src_global generation:  0.05358481407165527
r_  generation:  0.4601116180419922
local_output_nid generation:  0.03179430961608887
local_in_edges_tensor generation:  0.08122801780700684
mini_batch_src_global generation:  0.054923057556152344
r_  generation:  0.4651784896850586
local_output_nid generation:  0.03220558166503906
local_in_edges_tensor generation:  0.033072710037231445
mini_batch_src_global generation:  0.05352330207824707
r_  generation:  0.4580833911895752
local_output_nid generation:  0.03184008598327637
local_in_edges_tensor generation:  0.0317378044128418
mini_batch_src_global generation:  0.05233001708984375
r_  generation:  0.4678030014038086
local_output_nid generation:  0.03205227851867676
local_in_edges_tensor generation:  0.035486698150634766
mini_batch_src_global generation:  0.06637024879455566
r_  generation:  0.4599905014038086
local_output_nid generation:  0.03408980369567871
local_in_edges_tensor generation:  0.03170013427734375
mini_batch_src_global generation:  0.052469491958618164
r_  generation:  0.4644920825958252
local_output_nid generation:  0.03283357620239258
local_in_edges_tensor generation:  0.03183412551879883
mini_batch_src_global generation:  0.05499625205993652
r_  generation:  0.45859313011169434
local_output_nid generation:  0.032991647720336914
local_in_edges_tensor generation:  0.03007364273071289
mini_batch_src_global generation:  0.0519106388092041
r_  generation:  0.4644336700439453
local_output_nid generation:  0.032683610916137695
local_in_edges_tensor generation:  0.03046584129333496
mini_batch_src_global generation:  0.054975032806396484
r_  generation:  0.4585690498352051
local_output_nid generation:  0.03282570838928223
local_in_edges_tensor generation:  0.03266191482543945
mini_batch_src_global generation:  0.052077531814575195
r_  generation:  0.46900057792663574
local_output_nid generation:  0.032904624938964844
local_in_edges_tensor generation:  0.030109405517578125
mini_batch_src_global generation:  0.05357527732849121
r_  generation:  0.4680771827697754
local_output_nid generation:  0.03306245803833008
local_in_edges_tensor generation:  0.032299041748046875
mini_batch_src_global generation:  0.053848981857299805
r_  generation:  0.4729149341583252
local_output_nid generation:  0.03280782699584961
local_in_edges_tensor generation:  0.03023219108581543
mini_batch_src_global generation:  0.05441927909851074
r_  generation:  0.45772385597229004
----------------------check_connections_block total spend ----------------------------- 10.99370813369751
generate_one_block  0.5874650478363037
generate_one_block  0.5838503837585449
generate_one_block  0.582207202911377
generate_one_block  0.5850589275360107
generate_one_block  0.5898187160491943
generate_one_block  0.588470458984375
generate_one_block  0.5861296653747559
generate_one_block  0.587073564529419
generate_one_block  0.6520519256591797
generate_one_block  0.5830991268157959
generate_one_block  0.5881860256195068
generate_one_block  0.588341474533081
generate_one_block  0.5825214385986328
generate_one_block  0.5897111892700195
generate_one_block  0.5883176326751709
generate_one_block  0.5885963439941406
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11942672729492188  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

connection checking time:  16.515289783477783
block generation total time  14.36465573310852
average batch blocks generation time:  0.8977909833192825
block dataloader generation time/epoch 33.2620737769387
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0949244499206543  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7514238357543945  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09457921981811523  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7465395927429199  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09472465515136719  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7433652877807617  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0945882797241211  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7498188018798828  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09478473663330078  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7456893920898438  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09453964233398438  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7453818321228027  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09470558166503906  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7437734603881836  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09472465515136719  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7527308464050293  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09468460083007812  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7455830574035645  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09430074691772461  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7440409660339355  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09462261199951172  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7420158386230469  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09454536437988281  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7453255653381348  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09472465515136719  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7441649436950684  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09428119659423828  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7419581413269043  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09487342834472656  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7533164024353027  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09417104721069336  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7377791404724121  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.062391579151153564 |0.01411166787147522 |0.003454744815826416 |9.167194366455078e-05 |0.0031505227088928223 |0.002877473831176758 |
----------------------------------------------------------pseudo_mini_loss sum 1.326919436454773
Total (block generation + training)time/epoch 34.69530972567472
Training time/epoch 1.3937366008758545
Training time without block to device /epoch 1.167949914932251
Training time without total dataloading part /epoch 0.11002850532531738
load block tensor time/epoch 0.998265266418457
block to device time/epoch 0.22578668594360352
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 20 |
Number of nodes for computation during this epoch:  5211617
Number of first layer input nodes during this epoch:  2482064
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11756229400634766  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02344989776611328
random selection method range initialization spend 0.005188941955566406
time for parepare:  0.01806020736694336
local_output_nid generation:  0.0024106502532958984
local_in_edges_tensor generation:  0.007163047790527344
mini_batch_src_global generation:  0.0018088817596435547
r_  generation:  0.021642446517944336
local_output_nid generation:  0.002889871597290039
local_in_edges_tensor generation:  0.0017325878143310547
mini_batch_src_global generation:  0.002054929733276367
r_  generation:  0.022003650665283203
local_output_nid generation:  0.0029900074005126953
local_in_edges_tensor generation:  0.0017442703247070312
mini_batch_src_global generation:  0.0017113685607910156
r_  generation:  0.02190542221069336
local_output_nid generation:  0.002992868423461914
local_in_edges_tensor generation:  0.0017094612121582031
mini_batch_src_global generation:  0.0017197132110595703
r_  generation:  0.02170109748840332
local_output_nid generation:  0.003027200698852539
local_in_edges_tensor generation:  0.0016779899597167969
mini_batch_src_global generation:  0.0017285346984863281
r_  generation:  0.021836280822753906
local_output_nid generation:  0.0030052661895751953
local_in_edges_tensor generation:  0.0017006397247314453
mini_batch_src_global generation:  0.0017428398132324219
r_  generation:  0.021946430206298828
local_output_nid generation:  0.0030066967010498047
local_in_edges_tensor generation:  0.001722097396850586
mini_batch_src_global generation:  0.0017921924591064453
r_  generation:  0.023857593536376953
local_output_nid generation:  0.0030558109283447266
local_in_edges_tensor generation:  0.002001523971557617
mini_batch_src_global generation:  0.0018057823181152344
r_  generation:  0.02149200439453125
local_output_nid generation:  0.0030205249786376953
local_in_edges_tensor generation:  0.0016980171203613281
mini_batch_src_global generation:  0.0017783641815185547
r_  generation:  0.022930383682250977
local_output_nid generation:  0.003000974655151367
local_in_edges_tensor generation:  0.0017421245574951172
mini_batch_src_global generation:  0.0018100738525390625
r_  generation:  0.022122859954833984
local_output_nid generation:  0.0030279159545898438
local_in_edges_tensor generation:  0.0016596317291259766
mini_batch_src_global generation:  0.0018329620361328125
r_  generation:  0.023232698440551758
local_output_nid generation:  0.0030291080474853516
local_in_edges_tensor generation:  0.0017116069793701172
mini_batch_src_global generation:  0.0017843246459960938
r_  generation:  0.02241992950439453
local_output_nid generation:  0.003012418746948242
local_in_edges_tensor generation:  0.0017540454864501953
mini_batch_src_global generation:  0.0017542839050292969
r_  generation:  0.022347450256347656
local_output_nid generation:  0.003028392791748047
local_in_edges_tensor generation:  0.0016663074493408203
mini_batch_src_global generation:  0.0018117427825927734
r_  generation:  0.022722482681274414
local_output_nid generation:  0.0030210018157958984
local_in_edges_tensor generation:  0.0016939640045166016
mini_batch_src_global generation:  0.0017864704132080078
r_  generation:  0.021742582321166992
local_output_nid generation:  0.002990245819091797
local_in_edges_tensor generation:  0.0017037391662597656
mini_batch_src_global generation:  0.0017724037170410156
r_  generation:  0.021686077117919922
----------------------check_connections_block total spend ----------------------------- 0.5725288391113281
generate_one_block  0.03125715255737305
generate_one_block  0.031199216842651367
generate_one_block  0.031432390213012695
generate_one_block  0.031090736389160156
generate_one_block  0.030638456344604492
generate_one_block  0.033614158630371094
generate_one_block  0.032299041748046875
generate_one_block  0.03052806854248047
generate_one_block  0.0320436954498291
generate_one_block  0.03126120567321777
generate_one_block  0.03227829933166504
generate_one_block  0.03172636032104492
generate_one_block  0.031052589416503906
generate_one_block  0.03192949295043945
generate_one_block  0.030564308166503906
generate_one_block  0.03174638748168945
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03821086883544922
gen group dst list time:  0.017658710479736328
time for parepare:  0.01936054229736328
local_output_nid generation:  0.009310722351074219
local_in_edges_tensor generation:  0.02771902084350586
mini_batch_src_global generation:  0.023319482803344727
r_  generation:  0.2201676368713379
local_output_nid generation:  0.013250350952148438
local_in_edges_tensor generation:  0.017168760299682617
mini_batch_src_global generation:  0.028229713439941406
r_  generation:  0.23073649406433105
local_output_nid generation:  0.013245344161987305
local_in_edges_tensor generation:  0.01677250862121582
mini_batch_src_global generation:  0.03223085403442383
r_  generation:  0.23145604133605957
local_output_nid generation:  0.013800382614135742
local_in_edges_tensor generation:  0.013186216354370117
mini_batch_src_global generation:  0.02739858627319336
r_  generation:  0.23042607307434082
local_output_nid generation:  0.013736248016357422
local_in_edges_tensor generation:  0.015132427215576172
mini_batch_src_global generation:  0.028470516204833984
r_  generation:  0.2317204475402832
local_output_nid generation:  0.013713836669921875
local_in_edges_tensor generation:  0.015993595123291016
mini_batch_src_global generation:  0.029813289642333984
r_  generation:  0.23335814476013184
local_output_nid generation:  0.013804912567138672
local_in_edges_tensor generation:  0.013962745666503906
mini_batch_src_global generation:  0.030564308166503906
r_  generation:  0.23958063125610352
local_output_nid generation:  0.013567209243774414
local_in_edges_tensor generation:  0.013223409652709961
mini_batch_src_global generation:  0.02883601188659668
r_  generation:  0.22954487800598145
local_output_nid generation:  0.014104843139648438
local_in_edges_tensor generation:  0.013162851333618164
mini_batch_src_global generation:  0.02968287467956543
r_  generation:  0.23983550071716309
local_output_nid generation:  0.01387643814086914
local_in_edges_tensor generation:  0.012949705123901367
mini_batch_src_global generation:  0.02912139892578125
r_  generation:  0.23536443710327148
local_output_nid generation:  0.013660430908203125
local_in_edges_tensor generation:  0.013738393783569336
mini_batch_src_global generation:  0.03131508827209473
r_  generation:  0.245802640914917
local_output_nid generation:  0.013893842697143555
local_in_edges_tensor generation:  0.014365196228027344
mini_batch_src_global generation:  0.030202865600585938
r_  generation:  0.2416541576385498
local_output_nid generation:  0.013733863830566406
local_in_edges_tensor generation:  0.012755393981933594
mini_batch_src_global generation:  0.0300600528717041
r_  generation:  0.23731780052185059
local_output_nid generation:  0.014055728912353516
local_in_edges_tensor generation:  0.013103246688842773
mini_batch_src_global generation:  0.031751155853271484
r_  generation:  0.24292969703674316
local_output_nid generation:  0.013435125350952148
local_in_edges_tensor generation:  0.013241767883300781
mini_batch_src_global generation:  0.029446840286254883
r_  generation:  0.23400473594665527
local_output_nid generation:  0.012989997863769531
local_in_edges_tensor generation:  0.013211250305175781
mini_batch_src_global generation:  0.02935791015625
r_  generation:  0.23418188095092773
----------------------check_connections_block total spend ----------------------------- 5.5190300941467285
generate_one_block  0.31317830085754395
generate_one_block  0.2955622673034668
generate_one_block  0.3006765842437744
generate_one_block  0.3020164966583252
generate_one_block  0.2951545715332031
generate_one_block  0.2954680919647217
generate_one_block  0.33393120765686035
generate_one_block  0.29025840759277344
generate_one_block  0.30431389808654785
generate_one_block  0.29941749572753906
generate_one_block  0.31290102005004883
generate_one_block  0.3052482604980469
generate_one_block  0.29848527908325195
generate_one_block  0.31136322021484375
generate_one_block  0.2944164276123047
generate_one_block  0.29895520210266113
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030553579330444336
gen group dst list time:  0.06346654891967773
time for parepare:  0.017867565155029297
local_output_nid generation:  0.027037620544433594
local_in_edges_tensor generation:  0.05263113975524902
mini_batch_src_global generation:  0.0444028377532959
r_  generation:  0.45304012298583984
local_output_nid generation:  0.0320134162902832
local_in_edges_tensor generation:  0.033638715744018555
mini_batch_src_global generation:  0.05422496795654297
r_  generation:  0.4500463008880615
local_output_nid generation:  0.03265690803527832
local_in_edges_tensor generation:  0.030884742736816406
mini_batch_src_global generation:  0.05095267295837402
r_  generation:  0.45830273628234863
local_output_nid generation:  0.03196430206298828
local_in_edges_tensor generation:  0.031179428100585938
mini_batch_src_global generation:  0.053185462951660156
r_  generation:  0.45647668838500977
local_output_nid generation:  0.032048940658569336
local_in_edges_tensor generation:  0.07312870025634766
mini_batch_src_global generation:  0.05143904685974121
r_  generation:  0.4616215229034424
local_output_nid generation:  0.03212571144104004
local_in_edges_tensor generation:  0.03106069564819336
mini_batch_src_global generation:  0.05327558517456055
r_  generation:  0.46233654022216797
local_output_nid generation:  0.032990455627441406
local_in_edges_tensor generation:  0.02962183952331543
mini_batch_src_global generation:  0.05214667320251465
r_  generation:  0.47425317764282227
local_output_nid generation:  0.03243660926818848
local_in_edges_tensor generation:  0.03044438362121582
mini_batch_src_global generation:  0.05370759963989258
r_  generation:  0.4595670700073242
local_output_nid generation:  0.032338857650756836
local_in_edges_tensor generation:  0.03653264045715332
mini_batch_src_global generation:  0.05207252502441406
r_  generation:  0.46774935722351074
local_output_nid generation:  0.031853675842285156
local_in_edges_tensor generation:  0.03093242645263672
mini_batch_src_global generation:  0.052971601486206055
r_  generation:  0.456493616104126
local_output_nid generation:  0.03191256523132324
local_in_edges_tensor generation:  0.030339717864990234
mini_batch_src_global generation:  0.05353260040283203
r_  generation:  0.46970677375793457
local_output_nid generation:  0.03209114074707031
local_in_edges_tensor generation:  0.0330958366394043
mini_batch_src_global generation:  0.05353593826293945
r_  generation:  0.46027302742004395
local_output_nid generation:  0.032423973083496094
local_in_edges_tensor generation:  0.02972722053527832
mini_batch_src_global generation:  0.05133223533630371
r_  generation:  0.4695415496826172
local_output_nid generation:  0.03218507766723633
local_in_edges_tensor generation:  0.0297243595123291
mini_batch_src_global generation:  0.05458188056945801
r_  generation:  0.46411967277526855
local_output_nid generation:  0.03227519989013672
local_in_edges_tensor generation:  0.029566049575805664
mini_batch_src_global generation:  0.05117440223693848
r_  generation:  0.4672858715057373
local_output_nid generation:  0.03229355812072754
local_in_edges_tensor generation:  0.03182339668273926
mini_batch_src_global generation:  0.05686807632446289
r_  generation:  0.4616434574127197
----------------------check_connections_block total spend ----------------------------- 10.918233156204224
generate_one_block  0.5839364528656006
generate_one_block  0.5836212635040283
generate_one_block  0.5781471729278564
generate_one_block  0.5762407779693604
generate_one_block  0.5877158641815186
generate_one_block  0.578913688659668
generate_one_block  0.5804815292358398
generate_one_block  0.6390872001647949
generate_one_block  0.6480040550231934
generate_one_block  0.5987555980682373
generate_one_block  0.6154007911682129
generate_one_block  0.5971279144287109
generate_one_block  0.5852627754211426
generate_one_block  0.5978436470031738
generate_one_block  0.6009886264801025
generate_one_block  0.6030063629150391
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11756229400634766  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

connection checking time:  16.437263250350952
block generation total time  14.405880451202393
average batch blocks generation time:  0.9003675282001495
block dataloader generation time/epoch 33.24346023797989
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09490728378295898  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.752993106842041  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09425640106201172  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7435097694396973  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09477519989013672  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7446599006652832  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0944366455078125  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7434749603271484  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09465599060058594  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7447719573974609  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09448814392089844  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7461929321289062  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.094879150390625  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7503890991210938  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09420394897460938  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.739555835723877  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09482383728027344  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7520523071289062  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0943136215209961  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7422389984130859  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0950155258178711  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7584028244018555  GigaBytes
Max Memory Allocated: 0.8465590476989746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09436273574829102  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7493748664855957  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09471702575683594  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7432785034179688  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09461832046508789  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7538013458251953  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09458732604980469  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7391357421875  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0943903923034668  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7428560256958008  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06415586173534393 |0.014111101627349854 |0.0036696046590805054 |9.164214134216309e-05 |0.005342155694961548 |0.001588582992553711 |
----------------------------------------------------------pseudo_mini_loss sum 1.314077377319336
Total (block generation + training)time/epoch 34.679040809472404
Training time/epoch 1.461094617843628
Training time without block to device /epoch 1.2353169918060303
Training time without total dataloading part /epoch 0.14724302291870117
load block tensor time/epoch 1.026493787765503
block to device time/epoch 0.22577762603759766
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 21 |
Number of nodes for computation during this epoch:  5210536
Number of first layer input nodes during this epoch:  2480235
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.117645263671875  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022095441818237305
random selection method range initialization spend 0.0052678585052490234
time for parepare:  0.017592668533325195
local_output_nid generation:  0.0023686885833740234
local_in_edges_tensor generation:  0.0067861080169677734
mini_batch_src_global generation:  0.0017695426940917969
r_  generation:  0.02098393440246582
local_output_nid generation:  0.003004312515258789
local_in_edges_tensor generation:  0.0017685890197753906
mini_batch_src_global generation:  0.0020864009857177734
r_  generation:  0.022542238235473633
local_output_nid generation:  0.0030248165130615234
local_in_edges_tensor generation:  0.0017497539520263672
mini_batch_src_global generation:  0.001699686050415039
r_  generation:  0.02127528190612793
local_output_nid generation:  0.0030028820037841797
local_in_edges_tensor generation:  0.0016961097717285156
mini_batch_src_global generation:  0.0017740726470947266
r_  generation:  0.02217841148376465
local_output_nid generation:  0.002991199493408203
local_in_edges_tensor generation:  0.0017044544219970703
mini_batch_src_global generation:  0.0017795562744140625
r_  generation:  0.021444082260131836
local_output_nid generation:  0.0030460357666015625
local_in_edges_tensor generation:  0.0017499923706054688
mini_batch_src_global generation:  0.001800537109375
r_  generation:  0.022438526153564453
local_output_nid generation:  0.0030672550201416016
local_in_edges_tensor generation:  0.0017261505126953125
mini_batch_src_global generation:  0.0018084049224853516
r_  generation:  0.022707223892211914
local_output_nid generation:  0.003011941909790039
local_in_edges_tensor generation:  0.0017390251159667969
mini_batch_src_global generation:  0.0017902851104736328
r_  generation:  0.022040605545043945
local_output_nid generation:  0.0030765533447265625
local_in_edges_tensor generation:  0.0017249584197998047
mini_batch_src_global generation:  0.0018160343170166016
r_  generation:  0.022464752197265625
local_output_nid generation:  0.0029668807983398438
local_in_edges_tensor generation:  0.001737833023071289
mini_batch_src_global generation:  0.0018277168273925781
r_  generation:  0.02227187156677246
local_output_nid generation:  0.0030379295349121094
local_in_edges_tensor generation:  0.0016660690307617188
mini_batch_src_global generation:  0.0017805099487304688
r_  generation:  0.022152185440063477
local_output_nid generation:  0.0029964447021484375
local_in_edges_tensor generation:  0.0017294883728027344
mini_batch_src_global generation:  0.0017576217651367188
r_  generation:  0.022097110748291016
local_output_nid generation:  0.0029845237731933594
local_in_edges_tensor generation:  0.0016856193542480469
mini_batch_src_global generation:  0.0018126964569091797
r_  generation:  0.02237868309020996
local_output_nid generation:  0.003126859664916992
local_in_edges_tensor generation:  0.0017120838165283203
mini_batch_src_global generation:  0.0018208026885986328
r_  generation:  0.0223691463470459
local_output_nid generation:  0.003008127212524414
local_in_edges_tensor generation:  0.0017435550689697266
mini_batch_src_global generation:  0.0017790794372558594
r_  generation:  0.022098302841186523
local_output_nid generation:  0.0030221939086914062
local_in_edges_tensor generation:  0.0016281604766845703
mini_batch_src_global generation:  0.0018360614776611328
r_  generation:  0.022930145263671875
----------------------check_connections_block total spend ----------------------------- 0.5711333751678467
generate_one_block  0.031733036041259766
generate_one_block  0.03188204765319824
generate_one_block  0.030958890914916992
generate_one_block  0.03204512596130371
generate_one_block  0.03107738494873047
generate_one_block  0.03467106819152832
generate_one_block  0.032082557678222656
generate_one_block  0.031012773513793945
generate_one_block  0.03365612030029297
generate_one_block  0.0316317081451416
generate_one_block  0.03096461296081543
generate_one_block  0.03582882881164551
generate_one_block  0.035433053970336914
generate_one_block  0.031536102294921875
generate_one_block  0.032712459564208984
generate_one_block  0.032782554626464844
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03313851356506348
gen group dst list time:  0.01796412467956543
time for parepare:  0.02152085304260254
local_output_nid generation:  0.0093994140625
local_in_edges_tensor generation:  0.02512645721435547
mini_batch_src_global generation:  0.022908687591552734
r_  generation:  0.22042512893676758
local_output_nid generation:  0.013447046279907227
local_in_edges_tensor generation:  0.02033233642578125
mini_batch_src_global generation:  0.028699398040771484
r_  generation:  0.24311375617980957
local_output_nid generation:  0.01572561264038086
local_in_edges_tensor generation:  0.018952608108520508
mini_batch_src_global generation:  0.030656814575195312
r_  generation:  0.22571253776550293
local_output_nid generation:  0.014423131942749023
local_in_edges_tensor generation:  0.01493382453918457
mini_batch_src_global generation:  0.030053138732910156
r_  generation:  0.24154186248779297
local_output_nid generation:  0.013757705688476562
local_in_edges_tensor generation:  0.014217615127563477
mini_batch_src_global generation:  0.028697490692138672
r_  generation:  0.23501825332641602
local_output_nid generation:  0.01404881477355957
local_in_edges_tensor generation:  0.013185501098632812
mini_batch_src_global generation:  0.028650522232055664
r_  generation:  0.23597311973571777
local_output_nid generation:  0.01447439193725586
local_in_edges_tensor generation:  0.016264677047729492
mini_batch_src_global generation:  0.030615568161010742
r_  generation:  0.24538326263427734
local_output_nid generation:  0.014296293258666992
local_in_edges_tensor generation:  0.0135650634765625
mini_batch_src_global generation:  0.029286623001098633
r_  generation:  0.23695659637451172
local_output_nid generation:  0.01426839828491211
local_in_edges_tensor generation:  0.013170003890991211
mini_batch_src_global generation:  0.029856204986572266
r_  generation:  0.24111104011535645
local_output_nid generation:  0.014190912246704102
local_in_edges_tensor generation:  0.014141082763671875
mini_batch_src_global generation:  0.03083348274230957
r_  generation:  0.2400047779083252
local_output_nid generation:  0.013760805130004883
local_in_edges_tensor generation:  0.014234066009521484
mini_batch_src_global generation:  0.029244661331176758
r_  generation:  0.24073338508605957
local_output_nid generation:  0.014968395233154297
local_in_edges_tensor generation:  0.015198945999145508
mini_batch_src_global generation:  0.029273271560668945
r_  generation:  0.24174165725708008
local_output_nid generation:  0.014352083206176758
local_in_edges_tensor generation:  0.016950368881225586
mini_batch_src_global generation:  0.03066849708557129
r_  generation:  0.23994016647338867
local_output_nid generation:  0.0142364501953125
local_in_edges_tensor generation:  0.014709234237670898
mini_batch_src_global generation:  0.029311656951904297
r_  generation:  0.2352278232574463
local_output_nid generation:  0.014338493347167969
local_in_edges_tensor generation:  0.014200925827026367
mini_batch_src_global generation:  0.030955076217651367
r_  generation:  0.2404932975769043
local_output_nid generation:  0.013698577880859375
local_in_edges_tensor generation:  0.015426874160766602
mini_batch_src_global generation:  0.030092716217041016
r_  generation:  0.24176573753356934
----------------------check_connections_block total spend ----------------------------- 5.60230827331543
generate_one_block  0.3090023994445801
generate_one_block  0.30737972259521484
generate_one_block  0.29697561264038086
generate_one_block  0.31504392623901367
generate_one_block  0.3026468753814697
generate_one_block  0.3060731887817383
generate_one_block  0.33431506156921387
generate_one_block  0.3079795837402344
generate_one_block  0.31305718421936035
generate_one_block  0.3020014762878418
generate_one_block  0.3029317855834961
generate_one_block  0.30411505699157715
generate_one_block  0.3100912570953369
generate_one_block  0.3125934600830078
generate_one_block  0.31183791160583496
generate_one_block  0.3128540515899658
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0363612174987793
gen group dst list time:  0.07105112075805664
time for parepare:  0.020545005798339844
local_output_nid generation:  0.02712845802307129
local_in_edges_tensor generation:  0.051540374755859375
mini_batch_src_global generation:  0.040372371673583984
r_  generation:  0.45050549507141113
local_output_nid generation:  0.032537221908569336
local_in_edges_tensor generation:  0.03841662406921387
mini_batch_src_global generation:  0.054378509521484375
r_  generation:  0.45284342765808105
local_output_nid generation:  0.03296494483947754
local_in_edges_tensor generation:  0.03619050979614258
mini_batch_src_global generation:  0.051506757736206055
r_  generation:  0.46409106254577637
local_output_nid generation:  0.03252387046813965
local_in_edges_tensor generation:  0.03039836883544922
mini_batch_src_global generation:  0.05736112594604492
r_  generation:  0.4615488052368164
local_output_nid generation:  0.031870126724243164
local_in_edges_tensor generation:  0.0817420482635498
mini_batch_src_global generation:  0.05319094657897949
r_  generation:  0.46372199058532715
local_output_nid generation:  0.03231167793273926
local_in_edges_tensor generation:  0.03438758850097656
mini_batch_src_global generation:  0.055238962173461914
r_  generation:  0.46035289764404297
local_output_nid generation:  0.03195548057556152
local_in_edges_tensor generation:  0.03744029998779297
mini_batch_src_global generation:  0.05233001708984375
r_  generation:  0.46715831756591797
local_output_nid generation:  0.03831076622009277
local_in_edges_tensor generation:  0.03433346748352051
mini_batch_src_global generation:  0.06590032577514648
r_  generation:  0.4629833698272705
local_output_nid generation:  0.032731056213378906
local_in_edges_tensor generation:  0.0312807559967041
mini_batch_src_global generation:  0.052191972732543945
r_  generation:  0.4656178951263428
local_output_nid generation:  0.03279876708984375
local_in_edges_tensor generation:  0.03164505958557129
mini_batch_src_global generation:  0.05374598503112793
r_  generation:  0.4578676223754883
local_output_nid generation:  0.03315854072570801
local_in_edges_tensor generation:  0.030306100845336914
mini_batch_src_global generation:  0.05678415298461914
r_  generation:  0.47844910621643066
local_output_nid generation:  0.032808780670166016
local_in_edges_tensor generation:  0.031951189041137695
mini_batch_src_global generation:  0.053720712661743164
r_  generation:  0.45734286308288574
local_output_nid generation:  0.03277230262756348
local_in_edges_tensor generation:  0.030828237533569336
mini_batch_src_global generation:  0.0538790225982666
r_  generation:  0.46883583068847656
local_output_nid generation:  0.03282284736633301
local_in_edges_tensor generation:  0.035917043685913086
mini_batch_src_global generation:  0.053461313247680664
r_  generation:  0.45960140228271484
local_output_nid generation:  0.03284287452697754
local_in_edges_tensor generation:  0.031078577041625977
mini_batch_src_global generation:  0.05290794372558594
r_  generation:  0.4680633544921875
local_output_nid generation:  0.033132314682006836
local_in_edges_tensor generation:  0.03591513633728027
mini_batch_src_global generation:  0.05415010452270508
r_  generation:  0.4711875915527344
----------------------check_connections_block total spend ----------------------------- 11.022513628005981
generate_one_block  0.5942306518554688
generate_one_block  0.5831422805786133
generate_one_block  0.5821535587310791
generate_one_block  0.5883405208587646
generate_one_block  0.5845179557800293
generate_one_block  0.5871596336364746
generate_one_block  0.5883915424346924
generate_one_block  0.5923178195953369
generate_one_block  0.6599457263946533
generate_one_block  0.5858578681945801
generate_one_block  0.598503589630127
generate_one_block  0.5886349678039551
generate_one_block  0.5911741256713867
generate_one_block  0.593442440032959
generate_one_block  0.5919582843780518
generate_one_block  0.5973875522613525
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.117645263671875  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

connection checking time:  16.62482190132141
block generation total time  14.456057071685791
average batch blocks generation time:  0.9035035669803619
block dataloader generation time/epoch 33.24559384125929
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09471940994262695  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7431535720825195  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0946187973022461  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7458291053771973  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09461402893066406  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7407717704772949  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09465885162353516  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.749880313873291  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0946664810180664  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7412943840026855  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09444999694824219  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7442727088928223  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09474849700927734  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7457389831542969  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09444379806518555  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.744102954864502  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09482669830322266  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7451009750366211  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09440326690673828  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7437009811401367  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0947408676147461  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7465486526489258  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09452056884765625  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7434625625610352  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09478950500488281  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7470974922180176  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09441804885864258  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7417092323303223  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0947885513305664  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7451119422912598  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0946497917175293  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.750420093536377  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06312243640422821 |0.014510735869407654 |0.0034887343645095825 |9.185075759887695e-05 |0.0035805851221084595 |0.002367258071899414 |
----------------------------------------------------------pseudo_mini_loss sum 1.2971246242523193
Total (block generation + training)time/epoch 34.68078129108135
Training time/epoch 1.43027663230896
Training time without block to device /epoch 1.1981048583984375
Training time without total dataloading part /epoch 0.11694598197937012
load block tensor time/epoch 1.0099589824676514
block to device time/epoch 0.23217177391052246
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 22 |
Number of nodes for computation during this epoch:  5207339
Number of first layer input nodes during this epoch:  2480951
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11832046508789062  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02264547348022461
random selection method range initialization spend 0.005165815353393555
time for parepare:  0.018116235733032227
local_output_nid generation:  0.0023543834686279297
local_in_edges_tensor generation:  0.007256269454956055
mini_batch_src_global generation:  0.0017750263214111328
r_  generation:  0.02087879180908203
local_output_nid generation:  0.003021240234375
local_in_edges_tensor generation:  0.0017986297607421875
mini_batch_src_global generation:  0.002026081085205078
r_  generation:  0.021668434143066406
local_output_nid generation:  0.002972126007080078
local_in_edges_tensor generation:  0.0017952919006347656
mini_batch_src_global generation:  0.0017457008361816406
r_  generation:  0.02245950698852539
local_output_nid generation:  0.003007173538208008
local_in_edges_tensor generation:  0.0017304420471191406
mini_batch_src_global generation:  0.0017879009246826172
r_  generation:  0.02231287956237793
local_output_nid generation:  0.0030364990234375
local_in_edges_tensor generation:  0.0017728805541992188
mini_batch_src_global generation:  0.0018095970153808594
r_  generation:  0.021760225296020508
local_output_nid generation:  0.0030698776245117188
local_in_edges_tensor generation:  0.0018584728240966797
mini_batch_src_global generation:  0.001767873764038086
r_  generation:  0.0217282772064209
local_output_nid generation:  0.0030951499938964844
local_in_edges_tensor generation:  0.0016942024230957031
mini_batch_src_global generation:  0.0017881393432617188
r_  generation:  0.022409439086914062
local_output_nid generation:  0.0030059814453125
local_in_edges_tensor generation:  0.0017096996307373047
mini_batch_src_global generation:  0.0017685890197753906
r_  generation:  0.022322416305541992
local_output_nid generation:  0.0029892921447753906
local_in_edges_tensor generation:  0.0016884803771972656
mini_batch_src_global generation:  0.0017795562744140625
r_  generation:  0.022301197052001953
local_output_nid generation:  0.0030066967010498047
local_in_edges_tensor generation:  0.0016679763793945312
mini_batch_src_global generation:  0.001773834228515625
r_  generation:  0.022616863250732422
local_output_nid generation:  0.0029947757720947266
local_in_edges_tensor generation:  0.001683950424194336
mini_batch_src_global generation:  0.0018143653869628906
r_  generation:  0.022538423538208008
local_output_nid generation:  0.0029914379119873047
local_in_edges_tensor generation:  0.0016841888427734375
mini_batch_src_global generation:  0.0018134117126464844
r_  generation:  0.022493362426757812
local_output_nid generation:  0.002973318099975586
local_in_edges_tensor generation:  0.0016965866088867188
mini_batch_src_global generation:  0.0017385482788085938
r_  generation:  0.022181272506713867
local_output_nid generation:  0.002978801727294922
local_in_edges_tensor generation:  0.0016758441925048828
mini_batch_src_global generation:  0.0017514228820800781
r_  generation:  0.0220186710357666
local_output_nid generation:  0.0029931068420410156
local_in_edges_tensor generation:  0.0016436576843261719
mini_batch_src_global generation:  0.0017969608306884766
r_  generation:  0.022702693939208984
local_output_nid generation:  0.002975940704345703
local_in_edges_tensor generation:  0.0016591548919677734
mini_batch_src_global generation:  0.0018076896667480469
r_  generation:  0.022656917572021484
----------------------check_connections_block total spend ----------------------------- 0.5726425647735596
generate_one_block  0.03102254867553711
generate_one_block  0.030698299407958984
generate_one_block  0.03217720985412598
generate_one_block  0.03242230415344238
generate_one_block  0.031062602996826172
generate_one_block  0.033773183822631836
generate_one_block  0.03165888786315918
generate_one_block  0.031160354614257812
generate_one_block  0.03270530700683594
generate_one_block  0.03132891654968262
generate_one_block  0.031249046325683594
generate_one_block  0.031563520431518555
generate_one_block  0.031210660934448242
generate_one_block  0.031177997589111328
generate_one_block  0.03221845626831055
generate_one_block  0.03222250938415527
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03973245620727539
gen group dst list time:  0.020921707153320312
time for parepare:  0.019637346267700195
local_output_nid generation:  0.009399652481079102
local_in_edges_tensor generation:  0.02192211151123047
mini_batch_src_global generation:  0.022631168365478516
r_  generation:  0.21350669860839844
local_output_nid generation:  0.013120412826538086
local_in_edges_tensor generation:  0.01646876335144043
mini_batch_src_global generation:  0.02820134162902832
r_  generation:  0.2205348014831543
local_output_nid generation:  0.01341104507446289
local_in_edges_tensor generation:  0.018170595169067383
mini_batch_src_global generation:  0.028177499771118164
r_  generation:  0.23563241958618164
local_output_nid generation:  0.014032125473022461
local_in_edges_tensor generation:  0.015610218048095703
mini_batch_src_global generation:  0.03133392333984375
r_  generation:  0.2348155975341797
local_output_nid generation:  0.013761043548583984
local_in_edges_tensor generation:  0.013457298278808594
mini_batch_src_global generation:  0.02888178825378418
r_  generation:  0.23267459869384766
local_output_nid generation:  0.013680219650268555
local_in_edges_tensor generation:  0.014603376388549805
mini_batch_src_global generation:  0.029105663299560547
r_  generation:  0.23763251304626465
local_output_nid generation:  0.013996124267578125
local_in_edges_tensor generation:  0.013712167739868164
mini_batch_src_global generation:  0.02899026870727539
r_  generation:  0.23676657676696777
local_output_nid generation:  0.013840198516845703
local_in_edges_tensor generation:  0.013880491256713867
mini_batch_src_global generation:  0.029022932052612305
r_  generation:  0.23575806617736816
local_output_nid generation:  0.014061212539672852
local_in_edges_tensor generation:  0.013486146926879883
mini_batch_src_global generation:  0.02992391586303711
r_  generation:  0.24026894569396973
local_output_nid generation:  0.013948917388916016
local_in_edges_tensor generation:  0.015394926071166992
mini_batch_src_global generation:  0.029613971710205078
r_  generation:  0.23971939086914062
local_output_nid generation:  0.013215780258178711
local_in_edges_tensor generation:  0.013454914093017578
mini_batch_src_global generation:  0.029732465744018555
r_  generation:  0.23868298530578613
local_output_nid generation:  0.013933897018432617
local_in_edges_tensor generation:  0.014710664749145508
mini_batch_src_global generation:  0.029728412628173828
r_  generation:  0.2392573356628418
local_output_nid generation:  0.013732671737670898
local_in_edges_tensor generation:  0.013636589050292969
mini_batch_src_global generation:  0.029642820358276367
r_  generation:  0.23480772972106934
local_output_nid generation:  0.013757705688476562
local_in_edges_tensor generation:  0.013067960739135742
mini_batch_src_global generation:  0.03157186508178711
r_  generation:  0.23484420776367188
local_output_nid generation:  0.014057159423828125
local_in_edges_tensor generation:  0.01566147804260254
mini_batch_src_global generation:  0.031168222427368164
r_  generation:  0.23900294303894043
local_output_nid generation:  0.013834238052368164
local_in_edges_tensor generation:  0.015352487564086914
mini_batch_src_global generation:  0.0296783447265625
r_  generation:  0.24106454849243164
----------------------check_connections_block total spend ----------------------------- 5.5201640129089355
generate_one_block  0.306865930557251
generate_one_block  0.29395031929016113
generate_one_block  0.31345558166503906
generate_one_block  0.30774426460266113
generate_one_block  0.2972700595855713
generate_one_block  0.3034498691558838
generate_one_block  0.326465368270874
generate_one_block  0.3003883361816406
generate_one_block  0.30768680572509766
generate_one_block  0.3082082271575928
generate_one_block  0.3017582893371582
generate_one_block  0.3015923500061035
generate_one_block  0.29837489128112793
generate_one_block  0.30011582374572754
generate_one_block  0.30322813987731934
generate_one_block  0.3092927932739258
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029497623443603516
gen group dst list time:  0.0626981258392334
time for parepare:  0.018543481826782227
local_output_nid generation:  0.027523517608642578
local_in_edges_tensor generation:  0.04210805892944336
mini_batch_src_global generation:  0.0417022705078125
r_  generation:  0.45565342903137207
local_output_nid generation:  0.03252553939819336
local_in_edges_tensor generation:  0.038491249084472656
mini_batch_src_global generation:  0.052445411682128906
r_  generation:  0.4521160125732422
local_output_nid generation:  0.032564640045166016
local_in_edges_tensor generation:  0.03728914260864258
mini_batch_src_global generation:  0.05096173286437988
r_  generation:  0.46558690071105957
local_output_nid generation:  0.03217339515686035
local_in_edges_tensor generation:  0.030883073806762695
mini_batch_src_global generation:  0.05292820930480957
r_  generation:  0.45648813247680664
local_output_nid generation:  0.03220176696777344
local_in_edges_tensor generation:  0.07332015037536621
mini_batch_src_global generation:  0.05202960968017578
r_  generation:  0.46683764457702637
local_output_nid generation:  0.03257632255554199
local_in_edges_tensor generation:  0.033110618591308594
mini_batch_src_global generation:  0.05338263511657715
r_  generation:  0.45863986015319824
local_output_nid generation:  0.03250598907470703
local_in_edges_tensor generation:  0.033360958099365234
mini_batch_src_global generation:  0.05188918113708496
r_  generation:  0.469043493270874
local_output_nid generation:  0.032102108001708984
local_in_edges_tensor generation:  0.03335404396057129
mini_batch_src_global generation:  0.05357980728149414
r_  generation:  0.4606974124908447
local_output_nid generation:  0.03208494186401367
local_in_edges_tensor generation:  0.0331568717956543
mini_batch_src_global generation:  0.05200004577636719
r_  generation:  0.4679536819458008
local_output_nid generation:  0.033495187759399414
local_in_edges_tensor generation:  0.032410621643066406
mini_batch_src_global generation:  0.0534062385559082
r_  generation:  0.4570488929748535
local_output_nid generation:  0.03235149383544922
local_in_edges_tensor generation:  0.030867338180541992
mini_batch_src_global generation:  0.05202341079711914
r_  generation:  0.46828246116638184
local_output_nid generation:  0.03224897384643555
local_in_edges_tensor generation:  0.03130745887756348
mini_batch_src_global generation:  0.05329298973083496
r_  generation:  0.4596586227416992
local_output_nid generation:  0.031903982162475586
local_in_edges_tensor generation:  0.031178951263427734
mini_batch_src_global generation:  0.05197000503540039
r_  generation:  0.4653949737548828
local_output_nid generation:  0.03234100341796875
local_in_edges_tensor generation:  0.032634735107421875
mini_batch_src_global generation:  0.05344438552856445
r_  generation:  0.4586801528930664
local_output_nid generation:  0.03235936164855957
local_in_edges_tensor generation:  0.03723478317260742
mini_batch_src_global generation:  0.05151033401489258
r_  generation:  0.4697294235229492
local_output_nid generation:  0.03272604942321777
local_in_edges_tensor generation:  0.033762216567993164
mini_batch_src_global generation:  0.05381631851196289
r_  generation:  0.46103549003601074
----------------------check_connections_block total spend ----------------------------- 10.944368600845337
generate_one_block  0.5836970806121826
generate_one_block  0.5782108306884766
generate_one_block  0.5857009887695312
generate_one_block  0.5842740535736084
generate_one_block  0.5806369781494141
generate_one_block  0.5862586498260498
generate_one_block  0.583249568939209
generate_one_block  0.5821413993835449
generate_one_block  0.6187317371368408
generate_one_block  0.5804498195648193
generate_one_block  0.5853991508483887
generate_one_block  0.5938844680786133
generate_one_block  0.5772664546966553
generate_one_block  0.5825486183166504
generate_one_block  0.5852358341217041
generate_one_block  0.5811796188354492
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11832046508789062  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

connection checking time:  16.464532613754272
block generation total time  14.248712301254272
average batch blocks generation time:  0.890544518828392
block dataloader generation time/epoch 33.21857609067644
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09473276138305664  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7468137741088867  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09418201446533203  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7392644882202148  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09498119354248047  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7545042037963867  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09451055526733398  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7472500801086426  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09467315673828125  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7430777549743652  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09436750411987305  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7430481910705566  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09470081329345703  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7457795143127441  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09433507919311523  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7425961494445801  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09485244750976562  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7480349540710449  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09447050094604492  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.743687629699707  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09476566314697266  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7439260482788086  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09461593627929688  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7488846778869629  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09461593627929688  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7409777641296387  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0943293571472168  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7417750358581543  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09479236602783203  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7483839988708496  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09458732604980469  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7481255531311035  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06557776033878326 |0.010714605450630188 |0.0035342425107955933 |9.195506572723389e-05 |0.0037215054035186768 |0.002887725830078125 |
----------------------------------------------------------pseudo_mini_loss sum 1.2849853038787842
Total (block generation + training)time/epoch 34.65149601868221
Training time/epoch 1.4032495021820068
Training time without block to device /epoch 1.2318158149719238
Training time without total dataloading part /epoch 0.12045097351074219
load block tensor time/epoch 1.0492441654205322
block to device time/epoch 0.171433687210083
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 23 |
Number of nodes for computation during this epoch:  5209591
Number of first layer input nodes during this epoch:  2480493
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11815690994262695  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022595882415771484
random selection method range initialization spend 0.005129575729370117
time for parepare:  0.017789125442504883
local_output_nid generation:  0.002348661422729492
local_in_edges_tensor generation:  0.004109621047973633
mini_batch_src_global generation:  0.0017881393432617188
r_  generation:  0.021568775177001953
local_output_nid generation:  0.002871990203857422
local_in_edges_tensor generation:  0.0017445087432861328
mini_batch_src_global generation:  0.0020618438720703125
r_  generation:  0.02299666404724121
local_output_nid generation:  0.0029883384704589844
local_in_edges_tensor generation:  0.001772165298461914
mini_batch_src_global generation:  0.001735687255859375
r_  generation:  0.021708250045776367
local_output_nid generation:  0.0030019283294677734
local_in_edges_tensor generation:  0.0017237663269042969
mini_batch_src_global generation:  0.0017735958099365234
r_  generation:  0.02209329605102539
local_output_nid generation:  0.002973794937133789
local_in_edges_tensor generation:  0.0016548633575439453
mini_batch_src_global generation:  0.0019321441650390625
r_  generation:  0.02254319190979004
local_output_nid generation:  0.003050088882446289
local_in_edges_tensor generation:  0.0017175674438476562
mini_batch_src_global generation:  0.001791238784790039
r_  generation:  0.021968364715576172
local_output_nid generation:  0.003583669662475586
local_in_edges_tensor generation:  0.0017011165618896484
mini_batch_src_global generation:  0.0017724037170410156
r_  generation:  0.022289514541625977
local_output_nid generation:  0.0030248165130615234
local_in_edges_tensor generation:  0.0017232894897460938
mini_batch_src_global generation:  0.0017251968383789062
r_  generation:  0.021808147430419922
local_output_nid generation:  0.003016948699951172
local_in_edges_tensor generation:  0.001956939697265625
mini_batch_src_global generation:  0.0017268657684326172
r_  generation:  0.02163100242614746
local_output_nid generation:  0.0031375885009765625
local_in_edges_tensor generation:  0.0017383098602294922
mini_batch_src_global generation:  0.0017938613891601562
r_  generation:  0.02191758155822754
local_output_nid generation:  0.003070831298828125
local_in_edges_tensor generation:  0.0017940998077392578
mini_batch_src_global generation:  0.0018227100372314453
r_  generation:  0.02289128303527832
local_output_nid generation:  0.0029823780059814453
local_in_edges_tensor generation:  0.0016922950744628906
mini_batch_src_global generation:  0.0018086433410644531
r_  generation:  0.022043943405151367
local_output_nid generation:  0.003000020980834961
local_in_edges_tensor generation:  0.0017154216766357422
mini_batch_src_global generation:  0.0017621517181396484
r_  generation:  0.021997928619384766
local_output_nid generation:  0.0030994415283203125
local_in_edges_tensor generation:  0.0017154216766357422
mini_batch_src_global generation:  0.0017764568328857422
r_  generation:  0.022011280059814453
local_output_nid generation:  0.003010988235473633
local_in_edges_tensor generation:  0.0017421245574951172
mini_batch_src_global generation:  0.0017383098602294922
r_  generation:  0.02228522300720215
local_output_nid generation:  0.0030379295349121094
local_in_edges_tensor generation:  0.0017924308776855469
mini_batch_src_global generation:  0.0017910003662109375
r_  generation:  0.02262735366821289
----------------------check_connections_block total spend ----------------------------- 0.5698692798614502
generate_one_block  0.03129887580871582
generate_one_block  0.03188967704772949
generate_one_block  0.031662702560424805
generate_one_block  0.03157854080200195
generate_one_block  0.03197932243347168
generate_one_block  0.034122467041015625
generate_one_block  0.03137969970703125
generate_one_block  0.030918359756469727
generate_one_block  0.030256986618041992
generate_one_block  0.030986547470092773
generate_one_block  0.03239870071411133
generate_one_block  0.0310366153717041
generate_one_block  0.031233549118041992
generate_one_block  0.030930042266845703
generate_one_block  0.030730485916137695
generate_one_block  0.03234696388244629
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030676603317260742
gen group dst list time:  0.017436504364013672
time for parepare:  0.019437551498413086
local_output_nid generation:  0.009638786315917969
local_in_edges_tensor generation:  0.018915414810180664
mini_batch_src_global generation:  0.023337841033935547
r_  generation:  0.22257661819458008
local_output_nid generation:  0.013613224029541016
local_in_edges_tensor generation:  0.013411521911621094
mini_batch_src_global generation:  0.028612136840820312
r_  generation:  0.22803425788879395
local_output_nid generation:  0.013247966766357422
local_in_edges_tensor generation:  0.015342235565185547
mini_batch_src_global generation:  0.026501893997192383
r_  generation:  0.22943830490112305
local_output_nid generation:  0.013893365859985352
local_in_edges_tensor generation:  0.015551567077636719
mini_batch_src_global generation:  0.027925491333007812
r_  generation:  0.2336111068725586
local_output_nid generation:  0.014342784881591797
local_in_edges_tensor generation:  0.0145721435546875
mini_batch_src_global generation:  0.030465364456176758
r_  generation:  0.24322247505187988
local_output_nid generation:  0.013943195343017578
local_in_edges_tensor generation:  0.016762971878051758
mini_batch_src_global generation:  0.029901742935180664
r_  generation:  0.23349905014038086
local_output_nid generation:  0.013777971267700195
local_in_edges_tensor generation:  0.014354705810546875
mini_batch_src_global generation:  0.028584718704223633
r_  generation:  0.23352694511413574
local_output_nid generation:  0.013843059539794922
local_in_edges_tensor generation:  0.013812541961669922
mini_batch_src_global generation:  0.02923130989074707
r_  generation:  0.23235774040222168
local_output_nid generation:  0.013659238815307617
local_in_edges_tensor generation:  0.013984918594360352
mini_batch_src_global generation:  0.028900623321533203
r_  generation:  0.23219728469848633
local_output_nid generation:  0.013843059539794922
local_in_edges_tensor generation:  0.013321876525878906
mini_batch_src_global generation:  0.029505491256713867
r_  generation:  0.23649358749389648
local_output_nid generation:  0.01366114616394043
local_in_edges_tensor generation:  0.013438224792480469
mini_batch_src_global generation:  0.03171873092651367
r_  generation:  0.24625039100646973
local_output_nid generation:  0.013812541961669922
local_in_edges_tensor generation:  0.013424873352050781
mini_batch_src_global generation:  0.029715299606323242
r_  generation:  0.2381119728088379
local_output_nid generation:  0.013867378234863281
local_in_edges_tensor generation:  0.012897729873657227
mini_batch_src_global generation:  0.029339075088500977
r_  generation:  0.2376573085784912
local_output_nid generation:  0.013887643814086914
local_in_edges_tensor generation:  0.013118743896484375
mini_batch_src_global generation:  0.029774904251098633
r_  generation:  0.23691391944885254
local_output_nid generation:  0.013767480850219727
local_in_edges_tensor generation:  0.013248443603515625
mini_batch_src_global generation:  0.029385089874267578
r_  generation:  0.2338118553161621
local_output_nid generation:  0.014160871505737305
local_in_edges_tensor generation:  0.014413118362426758
mini_batch_src_global generation:  0.031121253967285156
r_  generation:  0.24465036392211914
----------------------check_connections_block total spend ----------------------------- 5.511605739593506
generate_one_block  0.3065304756164551
generate_one_block  0.30004215240478516
generate_one_block  0.3018977642059326
generate_one_block  0.30571556091308594
generate_one_block  0.3146798610687256
generate_one_block  0.29918837547302246
generate_one_block  0.32271718978881836
generate_one_block  0.29677414894104004
generate_one_block  0.29540491104125977
generate_one_block  0.30109643936157227
generate_one_block  0.3109254837036133
generate_one_block  0.3005833625793457
generate_one_block  0.2991201877593994
generate_one_block  0.3011918067932129
generate_one_block  0.299163818359375
generate_one_block  0.31893181800842285
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02777409553527832
gen group dst list time:  0.06295061111450195
time for parepare:  0.01828622817993164
local_output_nid generation:  0.027719974517822266
local_in_edges_tensor generation:  0.04095268249511719
mini_batch_src_global generation:  0.03967905044555664
r_  generation:  0.4535257816314697
local_output_nid generation:  0.03255128860473633
local_in_edges_tensor generation:  0.03477978706359863
mini_batch_src_global generation:  0.052025556564331055
r_  generation:  0.45354437828063965
local_output_nid generation:  0.03227663040161133
local_in_edges_tensor generation:  0.032480478286743164
mini_batch_src_global generation:  0.052057504653930664
r_  generation:  0.46268415451049805
local_output_nid generation:  0.03231620788574219
local_in_edges_tensor generation:  0.030928850173950195
mini_batch_src_global generation:  0.05383753776550293
r_  generation:  0.45940184593200684
local_output_nid generation:  0.032343149185180664
local_in_edges_tensor generation:  0.0788261890411377
mini_batch_src_global generation:  0.05253481864929199
r_  generation:  0.47206830978393555
local_output_nid generation:  0.03194832801818848
local_in_edges_tensor generation:  0.030166149139404297
mini_batch_src_global generation:  0.05418276786804199
r_  generation:  0.4614889621734619
local_output_nid generation:  0.031955718994140625
local_in_edges_tensor generation:  0.03461432456970215
mini_batch_src_global generation:  0.05253267288208008
r_  generation:  0.46516942977905273
local_output_nid generation:  0.031998395919799805
local_in_edges_tensor generation:  0.033069610595703125
mini_batch_src_global generation:  0.054358482360839844
r_  generation:  0.46256208419799805
local_output_nid generation:  0.031989097595214844
local_in_edges_tensor generation:  0.03178763389587402
mini_batch_src_global generation:  0.0530092716217041
r_  generation:  0.4740791320800781
local_output_nid generation:  0.03221273422241211
local_in_edges_tensor generation:  0.031213760375976562
mini_batch_src_global generation:  0.05397534370422363
r_  generation:  0.46811461448669434
local_output_nid generation:  0.03217291831970215
local_in_edges_tensor generation:  0.03658008575439453
mini_batch_src_global generation:  0.05466485023498535
r_  generation:  0.4750638008117676
local_output_nid generation:  0.03222393989562988
local_in_edges_tensor generation:  0.031459808349609375
mini_batch_src_global generation:  0.05419111251831055
r_  generation:  0.46270155906677246
local_output_nid generation:  0.03180432319641113
local_in_edges_tensor generation:  0.03502345085144043
mini_batch_src_global generation:  0.05268216133117676
r_  generation:  0.4838681221008301
local_output_nid generation:  0.03421378135681152
local_in_edges_tensor generation:  0.0299527645111084
mini_batch_src_global generation:  0.05792737007141113
r_  generation:  0.4613606929779053
local_output_nid generation:  0.03296327590942383
local_in_edges_tensor generation:  0.03061676025390625
mini_batch_src_global generation:  0.05228614807128906
r_  generation:  0.46656155586242676
local_output_nid generation:  0.03309822082519531
local_in_edges_tensor generation:  0.032447099685668945
mini_batch_src_global generation:  0.054026126861572266
r_  generation:  0.4737234115600586
----------------------check_connections_block total spend ----------------------------- 11.021394729614258
generate_one_block  0.5800023078918457
generate_one_block  0.5874307155609131
generate_one_block  0.5793149471282959
generate_one_block  0.582160234451294
generate_one_block  0.5852456092834473
generate_one_block  0.5791301727294922
generate_one_block  0.5829696655273438
generate_one_block  0.5834662914276123
generate_one_block  0.6482994556427002
generate_one_block  0.5830936431884766
generate_one_block  0.5925493240356445
generate_one_block  0.5847835540771484
generate_one_block  0.5893211364746094
generate_one_block  0.5803771018981934
generate_one_block  0.5851330757141113
generate_one_block  0.5942022800445557
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11815690994262695  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

connection checking time:  16.533000469207764
block generation total time  14.29144287109375
average batch blocks generation time:  0.8932151794433594
block dataloader generation time/epoch 33.20164383252462
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0949254035949707  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7533392906188965  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09457874298095703  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7482476234436035  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.094757080078125  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7477593421936035  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0943746566772461  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7446455955505371  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09502887725830078  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7586755752563477  GigaBytes
Max Memory Allocated: 0.847719669342041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09432029724121094  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7419261932373047  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09465217590332031  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7420158386230469  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09421682357788086  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.742222785949707  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09457969665527344  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7388434410095215  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09443950653076172  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7441120147705078  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09495067596435547  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7510995864868164  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09446907043457031  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7453165054321289  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09468746185302734  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7442374229431152  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09427404403686523  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.738616943359375  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09463024139404297  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7405967712402344  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0948019027709961  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7536273002624512  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06357051432132721 |0.012198686599731445 |0.00405082106590271 |0.00010374188423156738 |0.0034507066011428833 |0.0034437179565429688 |
----------------------------------------------------------pseudo_mini_loss sum 1.2692339420318604
Total (block generation + training)time/epoch 34.63259654045105
Training time/epoch 1.4031147956848145
Training time without block to device /epoch 1.2079358100891113
Training time without total dataloading part /epoch 0.12512803077697754
load block tensor time/epoch 1.0171282291412354
block to device time/epoch 0.19517898559570312
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 24 |
Number of nodes for computation during this epoch:  5208628
Number of first layer input nodes during this epoch:  2479940
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11956024169921875  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019008874893188477
random selection method range initialization spend 0.005214691162109375
time for parepare:  0.017843008041381836
local_output_nid generation:  0.002321481704711914
local_in_edges_tensor generation:  0.004701137542724609
mini_batch_src_global generation:  0.0017197132110595703
r_  generation:  0.020655393600463867
local_output_nid generation:  0.0028960704803466797
local_in_edges_tensor generation:  0.0017626285552978516
mini_batch_src_global generation:  0.0020563602447509766
r_  generation:  0.022532224655151367
local_output_nid generation:  0.002942800521850586
local_in_edges_tensor generation:  0.0017104148864746094
mini_batch_src_global generation:  0.0017535686492919922
r_  generation:  0.021788835525512695
local_output_nid generation:  0.003004312515258789
local_in_edges_tensor generation:  0.0017435550689697266
mini_batch_src_global generation:  0.0017652511596679688
r_  generation:  0.021889448165893555
local_output_nid generation:  0.002987384796142578
local_in_edges_tensor generation:  0.0017380714416503906
mini_batch_src_global generation:  0.0017702579498291016
r_  generation:  0.02132892608642578
local_output_nid generation:  0.0030455589294433594
local_in_edges_tensor generation:  0.0017387866973876953
mini_batch_src_global generation:  0.0017542839050292969
r_  generation:  0.02255392074584961
local_output_nid generation:  0.0029757022857666016
local_in_edges_tensor generation:  0.0017333030700683594
mini_batch_src_global generation:  0.0018315315246582031
r_  generation:  0.022662639617919922
local_output_nid generation:  0.003008127212524414
local_in_edges_tensor generation:  0.0016994476318359375
mini_batch_src_global generation:  0.0018308162689208984
r_  generation:  0.022783994674682617
local_output_nid generation:  0.0029642581939697266
local_in_edges_tensor generation:  0.001669168472290039
mini_batch_src_global generation:  0.0018031597137451172
r_  generation:  0.022875308990478516
local_output_nid generation:  0.003045320510864258
local_in_edges_tensor generation:  0.001699686050415039
mini_batch_src_global generation:  0.0018041133880615234
r_  generation:  0.022237777709960938
local_output_nid generation:  0.0029871463775634766
local_in_edges_tensor generation:  0.0016937255859375
mini_batch_src_global generation:  0.0018343925476074219
r_  generation:  0.022652149200439453
local_output_nid generation:  0.0029654502868652344
local_in_edges_tensor generation:  0.0017142295837402344
mini_batch_src_global generation:  0.0018126964569091797
r_  generation:  0.022113323211669922
local_output_nid generation:  0.003098011016845703
local_in_edges_tensor generation:  0.0017058849334716797
mini_batch_src_global generation:  0.0017962455749511719
r_  generation:  0.022588491439819336
local_output_nid generation:  0.00302886962890625
local_in_edges_tensor generation:  0.0017321109771728516
mini_batch_src_global generation:  0.0017778873443603516
r_  generation:  0.02205634117126465
local_output_nid generation:  0.0030024051666259766
local_in_edges_tensor generation:  0.0016744136810302734
mini_batch_src_global generation:  0.001794576644897461
r_  generation:  0.02209329605102539
local_output_nid generation:  0.0030050277709960938
local_in_edges_tensor generation:  0.0016031265258789062
mini_batch_src_global generation:  0.0018095970153808594
r_  generation:  0.022444725036621094
----------------------check_connections_block total spend ----------------------------- 0.5688877105712891
generate_one_block  0.029980897903442383
generate_one_block  0.031340599060058594
generate_one_block  0.031087636947631836
generate_one_block  0.031088829040527344
generate_one_block  0.03043961524963379
generate_one_block  0.0347292423248291
generate_one_block  0.03200578689575195
generate_one_block  0.031622886657714844
generate_one_block  0.03151249885559082
generate_one_block  0.031470537185668945
generate_one_block  0.03173947334289551
generate_one_block  0.031071186065673828
generate_one_block  0.03166460990905762
generate_one_block  0.030783891677856445
generate_one_block  0.031220674514770508
generate_one_block  0.03223991394042969
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.07169961929321289
gen group dst list time:  0.02039170265197754
time for parepare:  0.019520282745361328
local_output_nid generation:  0.009134292602539062
local_in_edges_tensor generation:  0.021608829498291016
mini_batch_src_global generation:  0.022043943405151367
r_  generation:  0.21008801460266113
local_output_nid generation:  0.013270378112792969
local_in_edges_tensor generation:  0.013944149017333984
mini_batch_src_global generation:  0.02724456787109375
r_  generation:  0.2231738567352295
local_output_nid generation:  0.013177156448364258
local_in_edges_tensor generation:  0.013012886047363281
mini_batch_src_global generation:  0.02629542350769043
r_  generation:  0.22811555862426758
local_output_nid generation:  0.014069557189941406
local_in_edges_tensor generation:  0.016852140426635742
mini_batch_src_global generation:  0.028773784637451172
r_  generation:  0.23595213890075684
local_output_nid generation:  0.013846874237060547
local_in_edges_tensor generation:  0.015006303787231445
mini_batch_src_global generation:  0.028414249420166016
r_  generation:  0.23348307609558105
local_output_nid generation:  0.013859033584594727
local_in_edges_tensor generation:  0.013397216796875
mini_batch_src_global generation:  0.03026103973388672
r_  generation:  0.2471024990081787
local_output_nid generation:  0.014149904251098633
local_in_edges_tensor generation:  0.018924713134765625
mini_batch_src_global generation:  0.030169963836669922
r_  generation:  0.24770736694335938
local_output_nid generation:  0.01412057876586914
local_in_edges_tensor generation:  0.02106928825378418
mini_batch_src_global generation:  0.029775381088256836
r_  generation:  0.24747276306152344
local_output_nid generation:  0.01414036750793457
local_in_edges_tensor generation:  0.015336751937866211
mini_batch_src_global generation:  0.030417203903198242
r_  generation:  0.24431443214416504
local_output_nid generation:  0.014817476272583008
local_in_edges_tensor generation:  0.015216827392578125
mini_batch_src_global generation:  0.03250718116760254
r_  generation:  0.253629207611084
local_output_nid generation:  0.016920089721679688
local_in_edges_tensor generation:  0.015284299850463867
mini_batch_src_global generation:  0.031037569046020508
r_  generation:  0.24185562133789062
local_output_nid generation:  0.014180660247802734
local_in_edges_tensor generation:  0.014600515365600586
mini_batch_src_global generation:  0.03197455406188965
r_  generation:  0.24078989028930664
local_output_nid generation:  0.014467477798461914
local_in_edges_tensor generation:  0.013565301895141602
mini_batch_src_global generation:  0.030033588409423828
r_  generation:  0.2548198699951172
local_output_nid generation:  0.014124393463134766
local_in_edges_tensor generation:  0.013260364532470703
mini_batch_src_global generation:  0.029338836669921875
r_  generation:  0.24212360382080078
local_output_nid generation:  0.01432037353515625
local_in_edges_tensor generation:  0.01886606216430664
mini_batch_src_global generation:  0.03025507926940918
r_  generation:  0.24053740501403809
local_output_nid generation:  0.014244556427001953
local_in_edges_tensor generation:  0.016973018646240234
mini_batch_src_global generation:  0.02968144416809082
r_  generation:  0.24370741844177246
----------------------check_connections_block total spend ----------------------------- 5.6378867626190186
generate_one_block  0.3081223964691162
generate_one_block  0.30803465843200684
generate_one_block  0.30655932426452637
generate_one_block  0.31001996994018555
generate_one_block  0.30115246772766113
generate_one_block  0.31849241256713867
generate_one_block  0.3413264751434326
generate_one_block  0.3083639144897461
generate_one_block  0.3068065643310547
generate_one_block  0.30541205406188965
generate_one_block  0.3084580898284912
generate_one_block  0.3157327175140381
generate_one_block  0.31021904945373535
generate_one_block  0.2981452941894531
generate_one_block  0.3009519577026367
generate_one_block  0.30318427085876465
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.036093950271606445
gen group dst list time:  0.06652212142944336
time for parepare:  0.01783013343811035
local_output_nid generation:  0.028179168701171875
local_in_edges_tensor generation:  0.05230522155761719
mini_batch_src_global generation:  0.04361724853515625
r_  generation:  0.45192527770996094
local_output_nid generation:  0.03267931938171387
local_in_edges_tensor generation:  0.04011678695678711
mini_batch_src_global generation:  0.0527341365814209
r_  generation:  0.45311522483825684
local_output_nid generation:  0.03222513198852539
local_in_edges_tensor generation:  0.03207683563232422
mini_batch_src_global generation:  0.05131363868713379
r_  generation:  0.46598267555236816
local_output_nid generation:  0.03203177452087402
local_in_edges_tensor generation:  0.03758835792541504
mini_batch_src_global generation:  0.053503990173339844
r_  generation:  0.459275484085083
local_output_nid generation:  0.032308101654052734
local_in_edges_tensor generation:  0.08356618881225586
mini_batch_src_global generation:  0.051880598068237305
r_  generation:  0.46935248374938965
local_output_nid generation:  0.0317387580871582
local_in_edges_tensor generation:  0.03370213508605957
mini_batch_src_global generation:  0.054099321365356445
r_  generation:  0.46336793899536133
local_output_nid generation:  0.03896808624267578
local_in_edges_tensor generation:  0.034132957458496094
mini_batch_src_global generation:  0.06453728675842285
r_  generation:  0.46941328048706055
local_output_nid generation:  0.03291463851928711
local_in_edges_tensor generation:  0.03223872184753418
mini_batch_src_global generation:  0.056502342224121094
r_  generation:  0.4586672782897949
local_output_nid generation:  0.03288888931274414
local_in_edges_tensor generation:  0.031661033630371094
mini_batch_src_global generation:  0.051885366439819336
r_  generation:  0.46558499336242676
local_output_nid generation:  0.032506465911865234
local_in_edges_tensor generation:  0.029361248016357422
mini_batch_src_global generation:  0.05371809005737305
r_  generation:  0.45876646041870117
local_output_nid generation:  0.03331279754638672
local_in_edges_tensor generation:  0.030895471572875977
mini_batch_src_global generation:  0.06393074989318848
r_  generation:  0.46430325508117676
local_output_nid generation:  0.03290987014770508
local_in_edges_tensor generation:  0.02920055389404297
mini_batch_src_global generation:  0.05418705940246582
r_  generation:  0.46118974685668945
local_output_nid generation:  0.03295540809631348
local_in_edges_tensor generation:  0.031174898147583008
mini_batch_src_global generation:  0.05400848388671875
r_  generation:  0.4671189785003662
local_output_nid generation:  0.032459259033203125
local_in_edges_tensor generation:  0.0293424129486084
mini_batch_src_global generation:  0.05356884002685547
r_  generation:  0.45746517181396484
local_output_nid generation:  0.03266310691833496
local_in_edges_tensor generation:  0.031584978103637695
mini_batch_src_global generation:  0.052716732025146484
r_  generation:  0.4663534164428711
local_output_nid generation:  0.0340275764465332
local_in_edges_tensor generation:  0.03671121597290039
mini_batch_src_global generation:  0.05321383476257324
r_  generation:  0.45433592796325684
----------------------check_connections_block total spend ----------------------------- 11.003270864486694
generate_one_block  0.5904135704040527
generate_one_block  0.5958328247070312
generate_one_block  0.5907399654388428
generate_one_block  0.5907692909240723
generate_one_block  0.590827465057373
generate_one_block  0.5990848541259766
generate_one_block  0.5881915092468262
generate_one_block  0.5896375179290771
generate_one_block  0.6202282905578613
generate_one_block  0.5834498405456543
generate_one_block  0.5972726345062256
generate_one_block  0.5857033729553223
generate_one_block  0.5885214805603027
generate_one_block  0.5893537998199463
generate_one_block  0.5865211486816406
generate_one_block  0.5844202041625977
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11956024169921875  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

connection checking time:  16.641157627105713
block generation total time  14.42194938659668
average batch blocks generation time:  0.9013718366622925
block dataloader generation time/epoch 33.20643004775047
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09453344345092773  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.739893913269043  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09435844421386719  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7428154945373535  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09470748901367188  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7439179420471191  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09443044662475586  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7452273368835449  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09467601776123047  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7462301254272461  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0945272445678711  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7494688034057617  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09487342834472656  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7561278343200684  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09464883804321289  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7517800331115723  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0947885513305664  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7457513809204102  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09437036514282227  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7423858642578125  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0948343276977539  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7459783554077148  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09432506561279297  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7420916557312012  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09485244750976562  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7515277862548828  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09435081481933594  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7418355941772461  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09469127655029297  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7440237998962402  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09436416625976562  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.742919921875  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06198374927043915 |0.01290924847126007 |0.0034717172384262085 |9.18358564376831e-05 |0.0033738166093826294 |0.0014646053314208984 |
----------------------------------------------------------pseudo_mini_loss sum 1.2593917846679688
Total (block generation + training)time/epoch 34.6337983161211
Training time/epoch 1.3733227252960205
Training time without block to device /epoch 1.1667747497558594
Training time without total dataloading part /epoch 0.11246252059936523
load block tensor time/epoch 0.9917399883270264
block to device time/epoch 0.20654797554016113
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 25 |
Number of nodes for computation during this epoch:  5208272
Number of first layer input nodes during this epoch:  2480431
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11774301528930664  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023121118545532227
random selection method range initialization spend 0.005437135696411133
time for parepare:  0.017385482788085938
local_output_nid generation:  0.0023429393768310547
local_in_edges_tensor generation:  0.008368492126464844
mini_batch_src_global generation:  0.0017986297607421875
r_  generation:  0.021166563034057617
local_output_nid generation:  0.003053903579711914
local_in_edges_tensor generation:  0.0017654895782470703
mini_batch_src_global generation:  0.0020415782928466797
r_  generation:  0.022090435028076172
local_output_nid generation:  0.0030024051666259766
local_in_edges_tensor generation:  0.0017402172088623047
mini_batch_src_global generation:  0.0017209053039550781
r_  generation:  0.021401166915893555
local_output_nid generation:  0.003004789352416992
local_in_edges_tensor generation:  0.0017709732055664062
mini_batch_src_global generation:  0.0018050670623779297
r_  generation:  0.022512197494506836
local_output_nid generation:  0.002985715866088867
local_in_edges_tensor generation:  0.0017724037170410156
mini_batch_src_global generation:  0.0017666816711425781
r_  generation:  0.02158188819885254
local_output_nid generation:  0.003004789352416992
local_in_edges_tensor generation:  0.0017228126525878906
mini_batch_src_global generation:  0.0017986297607421875
r_  generation:  0.02292799949645996
local_output_nid generation:  0.003025531768798828
local_in_edges_tensor generation:  0.0017642974853515625
mini_batch_src_global generation:  0.0017788410186767578
r_  generation:  0.022259235382080078
local_output_nid generation:  0.003062009811401367
local_in_edges_tensor generation:  0.0017459392547607422
mini_batch_src_global generation:  0.0018153190612792969
r_  generation:  0.02262282371520996
local_output_nid generation:  0.003030061721801758
local_in_edges_tensor generation:  0.0017971992492675781
mini_batch_src_global generation:  0.0018663406372070312
r_  generation:  0.022759199142456055
local_output_nid generation:  0.002999544143676758
local_in_edges_tensor generation:  0.0017502307891845703
mini_batch_src_global generation:  0.0017933845520019531
r_  generation:  0.022702693939208984
local_output_nid generation:  0.0030133724212646484
local_in_edges_tensor generation:  0.0017466545104980469
mini_batch_src_global generation:  0.001787424087524414
r_  generation:  0.022716522216796875
local_output_nid generation:  0.003061056137084961
local_in_edges_tensor generation:  0.001775503158569336
mini_batch_src_global generation:  0.001837015151977539
r_  generation:  0.02286839485168457
local_output_nid generation:  0.0030066967010498047
local_in_edges_tensor generation:  0.0017344951629638672
mini_batch_src_global generation:  0.0017833709716796875
r_  generation:  0.022023916244506836
local_output_nid generation:  0.0030307769775390625
local_in_edges_tensor generation:  0.0016906261444091797
mini_batch_src_global generation:  0.0017702579498291016
r_  generation:  0.02265334129333496
local_output_nid generation:  0.0030007362365722656
local_in_edges_tensor generation:  0.0017368793487548828
mini_batch_src_global generation:  0.001748800277709961
r_  generation:  0.021738290786743164
local_output_nid generation:  0.003013134002685547
local_in_edges_tensor generation:  0.0017054080963134766
mini_batch_src_global generation:  0.0018305778503417969
r_  generation:  0.022996902465820312
----------------------check_connections_block total spend ----------------------------- 0.5751919746398926
generate_one_block  0.038503408432006836
generate_one_block  0.030994653701782227
generate_one_block  0.031261444091796875
generate_one_block  0.03127717971801758
generate_one_block  0.030625104904174805
generate_one_block  0.03450202941894531
generate_one_block  0.03145480155944824
generate_one_block  0.031160593032836914
generate_one_block  0.03177380561828613
generate_one_block  0.031118392944335938
generate_one_block  0.03152203559875488
generate_one_block  0.03154873847961426
generate_one_block  0.03103923797607422
generate_one_block  0.031012535095214844
generate_one_block  0.03075695037841797
generate_one_block  0.03203463554382324
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03691697120666504
gen group dst list time:  0.01732015609741211
time for parepare:  0.019237041473388672
local_output_nid generation:  0.009368658065795898
local_in_edges_tensor generation:  0.023007631301879883
mini_batch_src_global generation:  0.023020029067993164
r_  generation:  0.22593212127685547
local_output_nid generation:  0.013077020645141602
local_in_edges_tensor generation:  0.017080307006835938
mini_batch_src_global generation:  0.030408620834350586
r_  generation:  0.22221016883850098
local_output_nid generation:  0.012897014617919922
local_in_edges_tensor generation:  0.0169830322265625
mini_batch_src_global generation:  0.028621435165405273
r_  generation:  0.22454023361206055
local_output_nid generation:  0.013358592987060547
local_in_edges_tensor generation:  0.01781153678894043
mini_batch_src_global generation:  0.027585744857788086
r_  generation:  0.22805142402648926
local_output_nid generation:  0.013631343841552734
local_in_edges_tensor generation:  0.012640953063964844
mini_batch_src_global generation:  0.029114723205566406
r_  generation:  0.22920632362365723
local_output_nid generation:  0.013901948928833008
local_in_edges_tensor generation:  0.015162229537963867
mini_batch_src_global generation:  0.03072524070739746
r_  generation:  0.2351374626159668
local_output_nid generation:  0.013559341430664062
local_in_edges_tensor generation:  0.013030290603637695
mini_batch_src_global generation:  0.03148078918457031
r_  generation:  0.23282337188720703
local_output_nid generation:  0.013684988021850586
local_in_edges_tensor generation:  0.013262510299682617
mini_batch_src_global generation:  0.029403209686279297
r_  generation:  0.23372960090637207
local_output_nid generation:  0.013839960098266602
local_in_edges_tensor generation:  0.014833688735961914
mini_batch_src_global generation:  0.03110480308532715
r_  generation:  0.2378549575805664
local_output_nid generation:  0.013742446899414062
local_in_edges_tensor generation:  0.01325535774230957
mini_batch_src_global generation:  0.030091285705566406
r_  generation:  0.23725342750549316
local_output_nid generation:  0.013337373733520508
local_in_edges_tensor generation:  0.01321554183959961
mini_batch_src_global generation:  0.029808521270751953
r_  generation:  0.23592519760131836
local_output_nid generation:  0.01389622688293457
local_in_edges_tensor generation:  0.013395071029663086
mini_batch_src_global generation:  0.029502153396606445
r_  generation:  0.23601365089416504
local_output_nid generation:  0.013792991638183594
local_in_edges_tensor generation:  0.013287782669067383
mini_batch_src_global generation:  0.02970409393310547
r_  generation:  0.2340564727783203
local_output_nid generation:  0.013746500015258789
local_in_edges_tensor generation:  0.01343393325805664
mini_batch_src_global generation:  0.029514789581298828
r_  generation:  0.23777031898498535
local_output_nid generation:  0.013744831085205078
local_in_edges_tensor generation:  0.013274192810058594
mini_batch_src_global generation:  0.030125141143798828
r_  generation:  0.23489713668823242
local_output_nid generation:  0.013837099075317383
local_in_edges_tensor generation:  0.01364898681640625
mini_batch_src_global generation:  0.030965328216552734
r_  generation:  0.24121761322021484
----------------------check_connections_block total spend ----------------------------- 5.479956150054932
generate_one_block  0.30232715606689453
generate_one_block  0.2910590171813965
generate_one_block  0.2936739921569824
generate_one_block  0.29841136932373047
generate_one_block  0.29334592819213867
generate_one_block  0.30739784240722656
generate_one_block  0.32445454597473145
generate_one_block  0.301654577255249
generate_one_block  0.3069498538970947
generate_one_block  0.30351805686950684
generate_one_block  0.2998332977294922
generate_one_block  0.3043327331542969
generate_one_block  0.29982662200927734
generate_one_block  0.3004279136657715
generate_one_block  0.29742980003356934
generate_one_block  0.30858683586120605
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03155803680419922
gen group dst list time:  0.0630488395690918
time for parepare:  0.01762843132019043
local_output_nid generation:  0.02721548080444336
local_in_edges_tensor generation:  0.037354230880737305
mini_batch_src_global generation:  0.04013419151306152
r_  generation:  0.45083141326904297
local_output_nid generation:  0.03197789192199707
local_in_edges_tensor generation:  0.03382062911987305
mini_batch_src_global generation:  0.05283308029174805
r_  generation:  0.44763898849487305
local_output_nid generation:  0.032113075256347656
local_in_edges_tensor generation:  0.031522512435913086
mini_batch_src_global generation:  0.05260181427001953
r_  generation:  0.46202874183654785
local_output_nid generation:  0.03226900100708008
local_in_edges_tensor generation:  0.03528785705566406
mini_batch_src_global generation:  0.05363631248474121
r_  generation:  0.4509258270263672
local_output_nid generation:  0.03205108642578125
local_in_edges_tensor generation:  0.07670378684997559
mini_batch_src_global generation:  0.05178022384643555
r_  generation:  0.4649367332458496
local_output_nid generation:  0.03196358680725098
local_in_edges_tensor generation:  0.03492331504821777
mini_batch_src_global generation:  0.05388832092285156
r_  generation:  0.45545411109924316
local_output_nid generation:  0.03193974494934082
local_in_edges_tensor generation:  0.029693126678466797
mini_batch_src_global generation:  0.05164742469787598
r_  generation:  0.46367979049682617
local_output_nid generation:  0.03191947937011719
local_in_edges_tensor generation:  0.029927730560302734
mini_batch_src_global generation:  0.05577874183654785
r_  generation:  0.4567146301269531
local_output_nid generation:  0.03294205665588379
local_in_edges_tensor generation:  0.03192710876464844
mini_batch_src_global generation:  0.05377554893493652
r_  generation:  0.4689600467681885
local_output_nid generation:  0.03175926208496094
local_in_edges_tensor generation:  0.02985858917236328
mini_batch_src_global generation:  0.05591440200805664
r_  generation:  0.46091294288635254
local_output_nid generation:  0.03234457969665527
local_in_edges_tensor generation:  0.03202319145202637
mini_batch_src_global generation:  0.05170154571533203
r_  generation:  0.4707784652709961
local_output_nid generation:  0.032393693923950195
local_in_edges_tensor generation:  0.029325008392333984
mini_batch_src_global generation:  0.053931236267089844
r_  generation:  0.4628136157989502
local_output_nid generation:  0.03247857093811035
local_in_edges_tensor generation:  0.03027820587158203
mini_batch_src_global generation:  0.051639556884765625
r_  generation:  0.46657514572143555
local_output_nid generation:  0.032259464263916016
local_in_edges_tensor generation:  0.029732227325439453
mini_batch_src_global generation:  0.05415701866149902
r_  generation:  0.4562981128692627
local_output_nid generation:  0.031842708587646484
local_in_edges_tensor generation:  0.03130626678466797
mini_batch_src_global generation:  0.054970502853393555
r_  generation:  0.46683287620544434
local_output_nid generation:  0.03225207328796387
local_in_edges_tensor generation:  0.031934499740600586
mini_batch_src_global generation:  0.05424070358276367
r_  generation:  0.45737719535827637
----------------------check_connections_block total spend ----------------------------- 10.892614126205444
generate_one_block  0.5831472873687744
generate_one_block  0.575427770614624
generate_one_block  0.573143482208252
generate_one_block  0.5898025035858154
generate_one_block  0.5817310810089111
generate_one_block  0.5813758373260498
generate_one_block  0.5827865600585938
generate_one_block  0.5823960304260254
generate_one_block  0.6534183025360107
generate_one_block  0.5860698223114014
generate_one_block  0.5853128433227539
generate_one_block  0.5932736396789551
generate_one_block  0.5852348804473877
generate_one_block  0.5931177139282227
generate_one_block  0.5851964950561523
generate_one_block  0.6020963191986084
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11774301528930664  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

connection checking time:  16.372570276260376
block generation total time  14.266760110855103
average batch blocks generation time:  0.8916725069284439
block dataloader generation time/epoch 33.182099286247706
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09476423263549805  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7435154914855957  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0942373275756836  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7401895523071289  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0946187973022461  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7435588836669922  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09447240829467773  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7431440353393555  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09465980529785156  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7447390556335449  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09459590911865234  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7496118545532227  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09469318389892578  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7424302101135254  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09431028366088867  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7432680130004883  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09484291076660156  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7502303123474121  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09443521499633789  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7447152137756348  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09475994110107422  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7481637001037598  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09447002410888672  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7448792457580566  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09469985961914062  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7464532852172852  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09456014633178711  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7436747550964355  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09469127655029297  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7426633834838867  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09448051452636719  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7457942962646484  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06588602066040039 |0.013971954584121704 |0.0035222023725509644 |9.094178676605225e-05 |0.003703191876411438 |0.0030171871185302734 |
----------------------------------------------------------pseudo_mini_loss sum 1.248145341873169
Total (block generation + training)time/epoch 34.61129644337822
Training time/epoch 1.4582552909851074
Training time without block to device /epoch 1.2347040176391602
Training time without total dataloading part /epoch 0.12007856369018555
load block tensor time/epoch 1.0541763305664062
block to device time/epoch 0.22355127334594727
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 26 |
Number of nodes for computation during this epoch:  5206379
Number of first layer input nodes during this epoch:  2480188
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11817789077758789  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021836042404174805
random selection method range initialization spend 0.005513191223144531
time for parepare:  0.019731998443603516
local_output_nid generation:  0.0023508071899414062
local_in_edges_tensor generation:  0.0048046112060546875
mini_batch_src_global generation:  0.0021238327026367188
r_  generation:  0.02028369903564453
local_output_nid generation:  0.0029387474060058594
local_in_edges_tensor generation:  0.0017576217651367188
mini_batch_src_global generation:  0.0023713111877441406
r_  generation:  0.022763729095458984
local_output_nid generation:  0.002991914749145508
local_in_edges_tensor generation:  0.0016803741455078125
mini_batch_src_global generation:  0.0017359256744384766
r_  generation:  0.022095441818237305
local_output_nid generation:  0.0030057430267333984
local_in_edges_tensor generation:  0.001682281494140625
mini_batch_src_global generation:  0.001775979995727539
r_  generation:  0.022227048873901367
local_output_nid generation:  0.003004789352416992
local_in_edges_tensor generation:  0.0016407966613769531
mini_batch_src_global generation:  0.0017621517181396484
r_  generation:  0.021630287170410156
local_output_nid generation:  0.003024578094482422
local_in_edges_tensor generation:  0.001634836196899414
mini_batch_src_global generation:  0.0017733573913574219
r_  generation:  0.022417545318603516
local_output_nid generation:  0.0030906200408935547
local_in_edges_tensor generation:  0.00162506103515625
mini_batch_src_global generation:  0.0017726421356201172
r_  generation:  0.021910667419433594
local_output_nid generation:  0.0030040740966796875
local_in_edges_tensor generation:  0.001650094985961914
mini_batch_src_global generation:  0.0018188953399658203
r_  generation:  0.022941112518310547
local_output_nid generation:  0.002989053726196289
local_in_edges_tensor generation:  0.001674652099609375
mini_batch_src_global generation:  0.0017845630645751953
r_  generation:  0.02247905731201172
local_output_nid generation:  0.0030639171600341797
local_in_edges_tensor generation:  0.0016598701477050781
mini_batch_src_global generation:  0.001794576644897461
r_  generation:  0.021816253662109375
local_output_nid generation:  0.003042936325073242
local_in_edges_tensor generation:  0.0016510486602783203
mini_batch_src_global generation:  0.0017740726470947266
r_  generation:  0.022374629974365234
local_output_nid generation:  0.0030150413513183594
local_in_edges_tensor generation:  0.0016222000122070312
mini_batch_src_global generation:  0.0018186569213867188
r_  generation:  0.021820783615112305
local_output_nid generation:  0.0030677318572998047
local_in_edges_tensor generation:  0.0017101764678955078
mini_batch_src_global generation:  0.0017902851104736328
r_  generation:  0.021956682205200195
local_output_nid generation:  0.0030078887939453125
local_in_edges_tensor generation:  0.0015959739685058594
mini_batch_src_global generation:  0.0017824172973632812
r_  generation:  0.022199630737304688
local_output_nid generation:  0.002994537353515625
local_in_edges_tensor generation:  0.0016756057739257812
mini_batch_src_global generation:  0.0017974376678466797
r_  generation:  0.02176523208618164
local_output_nid generation:  0.0030145645141601562
local_in_edges_tensor generation:  0.0016243457794189453
mini_batch_src_global generation:  0.00174713134765625
r_  generation:  0.021773099899291992
----------------------check_connections_block total spend ----------------------------- 0.5682048797607422
generate_one_block  0.02988600730895996
generate_one_block  0.03217005729675293
generate_one_block  0.031522274017333984
generate_one_block  0.03157520294189453
generate_one_block  0.03079390525817871
generate_one_block  0.03436160087585449
generate_one_block  0.031175613403320312
generate_one_block  0.032082319259643555
generate_one_block  0.03113555908203125
generate_one_block  0.03090643882751465
generate_one_block  0.03168177604675293
generate_one_block  0.031100988388061523
generate_one_block  0.030608177185058594
generate_one_block  0.031601667404174805
generate_one_block  0.030817270278930664
generate_one_block  0.03134775161743164
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03197431564331055
gen group dst list time:  0.018748998641967773
time for parepare:  0.01953887939453125
local_output_nid generation:  0.00919485092163086
local_in_edges_tensor generation:  0.02190399169921875
mini_batch_src_global generation:  0.022369861602783203
r_  generation:  0.21057558059692383
local_output_nid generation:  0.013524293899536133
local_in_edges_tensor generation:  0.017669200897216797
mini_batch_src_global generation:  0.028774261474609375
r_  generation:  0.226668119430542
local_output_nid generation:  0.013259649276733398
local_in_edges_tensor generation:  0.015068531036376953
mini_batch_src_global generation:  0.028934717178344727
r_  generation:  0.22801995277404785
local_output_nid generation:  0.013896703720092773
local_in_edges_tensor generation:  0.014548301696777344
mini_batch_src_global generation:  0.02898120880126953
r_  generation:  0.23207330703735352
local_output_nid generation:  0.01357889175415039
local_in_edges_tensor generation:  0.015291452407836914
mini_batch_src_global generation:  0.028544902801513672
r_  generation:  0.2330937385559082
local_output_nid generation:  0.013918161392211914
local_in_edges_tensor generation:  0.014693975448608398
mini_batch_src_global generation:  0.030265331268310547
r_  generation:  0.2368156909942627
local_output_nid generation:  0.01376652717590332
local_in_edges_tensor generation:  0.013570308685302734
mini_batch_src_global generation:  0.029270172119140625
r_  generation:  0.23410892486572266
local_output_nid generation:  0.014188528060913086
local_in_edges_tensor generation:  0.01366281509399414
mini_batch_src_global generation:  0.03048110008239746
r_  generation:  0.2431631088256836
local_output_nid generation:  0.01383519172668457
local_in_edges_tensor generation:  0.01319432258605957
mini_batch_src_global generation:  0.0299680233001709
r_  generation:  0.23620176315307617
local_output_nid generation:  0.013665914535522461
local_in_edges_tensor generation:  0.013532400131225586
mini_batch_src_global generation:  0.031218528747558594
r_  generation:  0.23447942733764648
local_output_nid generation:  0.01334834098815918
local_in_edges_tensor generation:  0.013145208358764648
mini_batch_src_global generation:  0.030002832412719727
r_  generation:  0.23935222625732422
local_output_nid generation:  0.013742923736572266
local_in_edges_tensor generation:  0.01339578628540039
mini_batch_src_global generation:  0.029650449752807617
r_  generation:  0.2354283332824707
local_output_nid generation:  0.01365518569946289
local_in_edges_tensor generation:  0.01259613037109375
mini_batch_src_global generation:  0.029302597045898438
r_  generation:  0.23456311225891113
local_output_nid generation:  0.013868093490600586
local_in_edges_tensor generation:  0.013970136642456055
mini_batch_src_global generation:  0.030697107315063477
r_  generation:  0.23916244506835938
local_output_nid generation:  0.01369929313659668
local_in_edges_tensor generation:  0.014203786849975586
mini_batch_src_global generation:  0.02941441535949707
r_  generation:  0.23311161994934082
local_output_nid generation:  0.013673067092895508
local_in_edges_tensor generation:  0.013180732727050781
mini_batch_src_global generation:  0.029494524002075195
r_  generation:  0.23772835731506348
----------------------check_connections_block total spend ----------------------------- 5.486690521240234
generate_one_block  0.3044164180755615
generate_one_block  0.30983686447143555
generate_one_block  0.30170774459838867
generate_one_block  0.3022801876068115
generate_one_block  0.3014950752258301
generate_one_block  0.3034086227416992
generate_one_block  0.3245105743408203
generate_one_block  0.312408447265625
generate_one_block  0.30159521102905273
generate_one_block  0.29668116569519043
generate_one_block  0.3027310371398926
generate_one_block  0.2964324951171875
generate_one_block  0.2948489189147949
generate_one_block  0.3047347068786621
generate_one_block  0.29503726959228516
generate_one_block  0.29654574394226074
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03141427040100098
gen group dst list time:  0.06287837028503418
time for parepare:  0.019046306610107422
local_output_nid generation:  0.02642202377319336
local_in_edges_tensor generation:  0.041863441467285156
mini_batch_src_global generation:  0.04154396057128906
r_  generation:  0.44863438606262207
local_output_nid generation:  0.03203296661376953
local_in_edges_tensor generation:  0.037168025970458984
mini_batch_src_global generation:  0.05487561225891113
r_  generation:  0.4512045383453369
local_output_nid generation:  0.03183388710021973
local_in_edges_tensor generation:  0.030532360076904297
mini_batch_src_global generation:  0.051017045974731445
r_  generation:  0.4660069942474365
local_output_nid generation:  0.03139519691467285
local_in_edges_tensor generation:  0.03018331527709961
mini_batch_src_global generation:  0.05262637138366699
r_  generation:  0.45334410667419434
local_output_nid generation:  0.031726837158203125
local_in_edges_tensor generation:  0.07164931297302246
mini_batch_src_global generation:  0.051664113998413086
r_  generation:  0.4638681411743164
local_output_nid generation:  0.03178119659423828
local_in_edges_tensor generation:  0.02962470054626465
mini_batch_src_global generation:  0.05382227897644043
r_  generation:  0.4612736701965332
local_output_nid generation:  0.031738996505737305
local_in_edges_tensor generation:  0.02926802635192871
mini_batch_src_global generation:  0.05188107490539551
r_  generation:  0.464719295501709
local_output_nid generation:  0.03188824653625488
local_in_edges_tensor generation:  0.03144097328186035
mini_batch_src_global generation:  0.053826332092285156
r_  generation:  0.4640371799468994
local_output_nid generation:  0.03198051452636719
local_in_edges_tensor generation:  0.02926039695739746
mini_batch_src_global generation:  0.0520474910736084
r_  generation:  0.4629824161529541
local_output_nid generation:  0.03182339668273926
local_in_edges_tensor generation:  0.0295257568359375
mini_batch_src_global generation:  0.05559659004211426
r_  generation:  0.45929765701293945
local_output_nid generation:  0.031848907470703125
local_in_edges_tensor generation:  0.02957940101623535
mini_batch_src_global generation:  0.05433773994445801
r_  generation:  0.4627954959869385
local_output_nid generation:  0.03335213661193848
local_in_edges_tensor generation:  0.03125715255737305
mini_batch_src_global generation:  0.05403542518615723
r_  generation:  0.45960211753845215
local_output_nid generation:  0.031560659408569336
local_in_edges_tensor generation:  0.02958083152770996
mini_batch_src_global generation:  0.051599740982055664
r_  generation:  0.46183323860168457
local_output_nid generation:  0.03194022178649902
local_in_edges_tensor generation:  0.03412461280822754
mini_batch_src_global generation:  0.05329537391662598
r_  generation:  0.4579610824584961
local_output_nid generation:  0.03213667869567871
local_in_edges_tensor generation:  0.029715299606323242
mini_batch_src_global generation:  0.054233551025390625
r_  generation:  0.46346235275268555
local_output_nid generation:  0.03179001808166504
local_in_edges_tensor generation:  0.02904057502746582
mini_batch_src_global generation:  0.05924367904663086
r_  generation:  0.45997095108032227
----------------------check_connections_block total spend ----------------------------- 10.865428924560547
generate_one_block  0.5741584300994873
generate_one_block  0.5808687210083008
generate_one_block  0.5811879634857178
generate_one_block  0.5844197273254395
generate_one_block  0.583613395690918
generate_one_block  0.5791885852813721
generate_one_block  0.5826771259307861
generate_one_block  0.5838143825531006
generate_one_block  0.6165940761566162
generate_one_block  0.5777013301849365
generate_one_block  0.5794053077697754
generate_one_block  0.5855205059051514
generate_one_block  0.5825285911560059
generate_one_block  0.5812785625457764
generate_one_block  0.5736057758331299
generate_one_block  0.5845341682434082
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11817789077758789  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

connection checking time:  16.35211944580078
block generation total time  14.17976713180542
average batch blocks generation time:  0.8862354457378387
block dataloader generation time/epoch 33.154585507180954
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09453821182250977  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7394237518310547  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09469795227050781  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7528181076049805  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09476852416992188  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7453022003173828  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0943446159362793  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.744234561920166  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0947713851928711  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.744297981262207  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09461116790771484  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.748687744140625  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09468460083007812  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7428436279296875  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09475278854370117  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7539219856262207  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09474754333496094  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7466745376586914  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09429311752319336  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7420039176940918  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09481334686279297  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7454957962036133  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09443283081054688  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7426776885986328  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09465885162353516  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7430591583251953  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09455728530883789  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7498865127563477  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09462165832519531  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7415938377380371  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0944967269897461  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7437810897827148  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0614946186542511 |0.01231352984905243 |0.003404974937438965 |9.050965309143066e-05 |0.0030487030744552612 |0.0017273426055908203 |
----------------------------------------------------------pseudo_mini_loss sum 1.2385797500610352
Total (block generation + training)time/epoch 34.579470290078056
Training time/epoch 1.3513469696044922
Training time without block to device /epoch 1.1543304920196533
Training time without total dataloading part /epoch 0.10643434524536133
load block tensor time/epoch 0.9839138984680176
block to device time/epoch 0.19701647758483887
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 27 |
Number of nodes for computation during this epoch:  5208957
Number of first layer input nodes during this epoch:  2480356
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11780691146850586  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02209162712097168
random selection method range initialization spend 0.005429983139038086
time for parepare:  0.017441272735595703
local_output_nid generation:  0.0023279190063476562
local_in_edges_tensor generation:  0.0040590763092041016
mini_batch_src_global generation:  0.0017552375793457031
r_  generation:  0.02066326141357422
local_output_nid generation:  0.002834320068359375
local_in_edges_tensor generation:  0.0016639232635498047
mini_batch_src_global generation:  0.002069711685180664
r_  generation:  0.022432327270507812
local_output_nid generation:  0.0029387474060058594
local_in_edges_tensor generation:  0.0016970634460449219
mini_batch_src_global generation:  0.0017390251159667969
r_  generation:  0.021761655807495117
local_output_nid generation:  0.0030422210693359375
local_in_edges_tensor generation:  0.0016214847564697266
mini_batch_src_global generation:  0.0018210411071777344
r_  generation:  0.021892786026000977
local_output_nid generation:  0.0029697418212890625
local_in_edges_tensor generation:  0.0016329288482666016
mini_batch_src_global generation:  0.0017580986022949219
r_  generation:  0.02179718017578125
local_output_nid generation:  0.0029892921447753906
local_in_edges_tensor generation:  0.0016276836395263672
mini_batch_src_global generation:  0.0016961097717285156
r_  generation:  0.021071434020996094
local_output_nid generation:  0.0029828548431396484
local_in_edges_tensor generation:  0.0016484260559082031
mini_batch_src_global generation:  0.0017800331115722656
r_  generation:  0.021904468536376953
local_output_nid generation:  0.0029993057250976562
local_in_edges_tensor generation:  0.0016379356384277344
mini_batch_src_global generation:  0.0018019676208496094
r_  generation:  0.02227640151977539
local_output_nid generation:  0.0029685497283935547
local_in_edges_tensor generation:  0.0016160011291503906
mini_batch_src_global generation:  0.001772165298461914
r_  generation:  0.022379636764526367
local_output_nid generation:  0.0030727386474609375
local_in_edges_tensor generation:  0.0016415119171142578
mini_batch_src_global generation:  0.0017960071563720703
r_  generation:  0.021698474884033203
local_output_nid generation:  0.002999544143676758
local_in_edges_tensor generation:  0.0016162395477294922
mini_batch_src_global generation:  0.0017855167388916016
r_  generation:  0.022574424743652344
local_output_nid generation:  0.0029871463775634766
local_in_edges_tensor generation:  0.0016255378723144531
mini_batch_src_global generation:  0.001789093017578125
r_  generation:  0.02259206771850586
local_output_nid generation:  0.0030031204223632812
local_in_edges_tensor generation:  0.001615285873413086
mini_batch_src_global generation:  0.001800537109375
r_  generation:  0.022650718688964844
local_output_nid generation:  0.003022432327270508
local_in_edges_tensor generation:  0.0016293525695800781
mini_batch_src_global generation:  0.0017881393432617188
r_  generation:  0.02202439308166504
local_output_nid generation:  0.003002643585205078
local_in_edges_tensor generation:  0.0016579627990722656
mini_batch_src_global generation:  0.00171661376953125
r_  generation:  0.021434783935546875
local_output_nid generation:  0.0029900074005126953
local_in_edges_tensor generation:  0.0016164779663085938
mini_batch_src_global generation:  0.0017287731170654297
r_  generation:  0.021240711212158203
----------------------check_connections_block total spend ----------------------------- 0.5605762004852295
generate_one_block  0.03051161766052246
generate_one_block  0.031772613525390625
generate_one_block  0.03164386749267578
generate_one_block  0.03159761428833008
generate_one_block  0.030718564987182617
generate_one_block  0.03305864334106445
generate_one_block  0.03134727478027344
generate_one_block  0.031768798828125
generate_one_block  0.03165149688720703
generate_one_block  0.031047821044921875
generate_one_block  0.03143882751464844
generate_one_block  0.03206586837768555
generate_one_block  0.032033443450927734
generate_one_block  0.03088998794555664
generate_one_block  0.03025054931640625
generate_one_block  0.030874967575073242
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03411221504211426
gen group dst list time:  0.017508506774902344
time for parepare:  0.019719600677490234
local_output_nid generation:  0.009476900100708008
local_in_edges_tensor generation:  0.0214540958404541
mini_batch_src_global generation:  0.022893428802490234
r_  generation:  0.2146458625793457
local_output_nid generation:  0.013545989990234375
local_in_edges_tensor generation:  0.015334367752075195
mini_batch_src_global generation:  0.028895139694213867
r_  generation:  0.2272655963897705
local_output_nid generation:  0.013259649276733398
local_in_edges_tensor generation:  0.015280008316040039
mini_batch_src_global generation:  0.02814030647277832
r_  generation:  0.2312936782836914
local_output_nid generation:  0.013675212860107422
local_in_edges_tensor generation:  0.013580799102783203
mini_batch_src_global generation:  0.027706623077392578
r_  generation:  0.23219680786132812
local_output_nid generation:  0.013960599899291992
local_in_edges_tensor generation:  0.013057947158813477
mini_batch_src_global generation:  0.02878260612487793
r_  generation:  0.23307228088378906
local_output_nid generation:  0.01364278793334961
local_in_edges_tensor generation:  0.016405105590820312
mini_batch_src_global generation:  0.029002666473388672
r_  generation:  0.22679352760314941
local_output_nid generation:  0.013894796371459961
local_in_edges_tensor generation:  0.015899658203125
mini_batch_src_global generation:  0.029021024703979492
r_  generation:  0.23129510879516602
local_output_nid generation:  0.013978004455566406
local_in_edges_tensor generation:  0.013447999954223633
mini_batch_src_global generation:  0.029569625854492188
r_  generation:  0.236405611038208
local_output_nid generation:  0.014101028442382812
local_in_edges_tensor generation:  0.013983964920043945
mini_batch_src_global generation:  0.032657623291015625
r_  generation:  0.23899388313293457
local_output_nid generation:  0.013894796371459961
local_in_edges_tensor generation:  0.01303720474243164
mini_batch_src_global generation:  0.02971649169921875
r_  generation:  0.23500466346740723
local_output_nid generation:  0.013470649719238281
local_in_edges_tensor generation:  0.013765811920166016
mini_batch_src_global generation:  0.029325008392333984
r_  generation:  0.23557114601135254
local_output_nid generation:  0.013956069946289062
local_in_edges_tensor generation:  0.01298666000366211
mini_batch_src_global generation:  0.029678821563720703
r_  generation:  0.23743486404418945
local_output_nid generation:  0.014106988906860352
local_in_edges_tensor generation:  0.01499795913696289
mini_batch_src_global generation:  0.030556678771972656
r_  generation:  0.2407364845275879
local_output_nid generation:  0.01378631591796875
local_in_edges_tensor generation:  0.01325535774230957
mini_batch_src_global generation:  0.029476165771484375
r_  generation:  0.23356986045837402
local_output_nid generation:  0.013605117797851562
local_in_edges_tensor generation:  0.013383626937866211
mini_batch_src_global generation:  0.031311988830566406
r_  generation:  0.23308992385864258
local_output_nid generation:  0.013271570205688477
local_in_edges_tensor generation:  0.013044118881225586
mini_batch_src_global generation:  0.02865147590637207
r_  generation:  0.2305309772491455
----------------------check_connections_block total spend ----------------------------- 5.463451862335205
generate_one_block  0.30082106590270996
generate_one_block  0.30222105979919434
generate_one_block  0.30577659606933594
generate_one_block  0.3069460391998291
generate_one_block  0.29860806465148926
generate_one_block  0.2906641960144043
generate_one_block  0.31944966316223145
generate_one_block  0.3027057647705078
generate_one_block  0.30182933807373047
generate_one_block  0.2979776859283447
generate_one_block  0.2986173629760742
generate_one_block  0.3055555820465088
generate_one_block  0.3099391460418701
generate_one_block  0.29799509048461914
generate_one_block  0.2938239574432373
generate_one_block  0.29176807403564453
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03045964241027832
gen group dst list time:  0.06308412551879883
time for parepare:  0.01895308494567871
local_output_nid generation:  0.02651238441467285
local_in_edges_tensor generation:  0.04400467872619629
mini_batch_src_global generation:  0.03968334197998047
r_  generation:  0.45061445236206055
local_output_nid generation:  0.03177905082702637
local_in_edges_tensor generation:  0.035649776458740234
mini_batch_src_global generation:  0.052337646484375
r_  generation:  0.44577693939208984
local_output_nid generation:  0.0317227840423584
local_in_edges_tensor generation:  0.0322721004486084
mini_batch_src_global generation:  0.0512232780456543
r_  generation:  0.45940518379211426
local_output_nid generation:  0.031230449676513672
local_in_edges_tensor generation:  0.03028249740600586
mini_batch_src_global generation:  0.05233645439147949
r_  generation:  0.4683854579925537
local_output_nid generation:  0.032622337341308594
local_in_edges_tensor generation:  0.07589411735534668
mini_batch_src_global generation:  0.054337263107299805
r_  generation:  0.46788644790649414
local_output_nid generation:  0.030962228775024414
local_in_edges_tensor generation:  0.02950263023376465
mini_batch_src_global generation:  0.05329084396362305
r_  generation:  0.4499680995941162
local_output_nid generation:  0.03102564811706543
local_in_edges_tensor generation:  0.03176522254943848
mini_batch_src_global generation:  0.05338001251220703
r_  generation:  0.4865231513977051
local_output_nid generation:  0.03315281867980957
local_in_edges_tensor generation:  0.03058600425720215
mini_batch_src_global generation:  0.05433511734008789
r_  generation:  0.4540858268737793
local_output_nid generation:  0.03279590606689453
local_in_edges_tensor generation:  0.03531384468078613
mini_batch_src_global generation:  0.05283045768737793
r_  generation:  0.4647982120513916
local_output_nid generation:  0.032282114028930664
local_in_edges_tensor generation:  0.03001260757446289
mini_batch_src_global generation:  0.05300617218017578
r_  generation:  0.4534451961517334
local_output_nid generation:  0.03223156929016113
local_in_edges_tensor generation:  0.030318260192871094
mini_batch_src_global generation:  0.0542910099029541
r_  generation:  0.46103453636169434
local_output_nid generation:  0.032205820083618164
local_in_edges_tensor generation:  0.03137683868408203
mini_batch_src_global generation:  0.05335187911987305
r_  generation:  0.4550497531890869
local_output_nid generation:  0.03250765800476074
local_in_edges_tensor generation:  0.03374314308166504
mini_batch_src_global generation:  0.052155494689941406
r_  generation:  0.4649510383605957
local_output_nid generation:  0.03271484375
local_in_edges_tensor generation:  0.03293156623840332
mini_batch_src_global generation:  0.0531315803527832
r_  generation:  0.4561169147491455
local_output_nid generation:  0.03249764442443848
local_in_edges_tensor generation:  0.03036785125732422
mini_batch_src_global generation:  0.05172133445739746
r_  generation:  0.46600866317749023
local_output_nid generation:  0.03241991996765137
local_in_edges_tensor generation:  0.030017614364624023
mini_batch_src_global generation:  0.05333709716796875
r_  generation:  0.4584650993347168
----------------------check_connections_block total spend ----------------------------- 10.87969160079956
generate_one_block  0.5771923065185547
generate_one_block  0.5863511562347412
generate_one_block  0.5823731422424316
generate_one_block  0.5806288719177246
generate_one_block  0.5774345397949219
generate_one_block  0.573655366897583
generate_one_block  0.5776641368865967
generate_one_block  0.5833523273468018
generate_one_block  0.642754316329956
generate_one_block  0.571711540222168
generate_one_block  0.5751841068267822
generate_one_block  0.5768401622772217
generate_one_block  0.5821638107299805
generate_one_block  0.575218677520752
generate_one_block  0.57444167137146
generate_one_block  0.5802040100097656
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11780691146850586  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

connection checking time:  16.343143463134766
block generation total time  14.141868829727173
average batch blocks generation time:  0.8838668018579483
block dataloader generation time/epoch 33.124987715169006
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09479665756225586  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7448577880859375  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09458160400390625  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7450299263000488  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09490489959716797  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7524762153625488  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09443950653076172  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7451071739196777  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0947122573852539  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7431578636169434  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09406661987304688  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7345452308654785  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09464263916015625  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7427916526794434  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0946054458618164  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7499332427978516  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09483909606933594  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7514410018920898  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09428787231445312  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7413582801818848  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09474658966064453  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7455439567565918  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09447765350341797  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7450089454650879  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09488105773925781  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7520675659179688  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09435415267944336  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7429170608520508  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09458255767822266  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7396860122680664  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09432220458984375  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7415504455566406  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.061899974942207336 |0.010180383920669556 |0.003442138433456421 |9.185075759887695e-05 |0.003116011619567871 |0.003058910369873047 |
----------------------------------------------------------pseudo_mini_loss sum 1.223884105682373
Total (block generation + training)time/epoch 34.544498318120056
Training time/epoch 1.3224916458129883
Training time without block to device /epoch 1.1596055030822754
Training time without total dataloading part /epoch 0.10945892333984375
load block tensor time/epoch 0.9903995990753174
block to device time/epoch 0.1628861427307129
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 28 |
Number of nodes for computation during this epoch:  5205307
Number of first layer input nodes during this epoch:  2479869
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11739683151245117  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02150726318359375
random selection method range initialization spend 0.00524449348449707
time for parepare:  0.018005847930908203
local_output_nid generation:  0.0023648738861083984
local_in_edges_tensor generation:  0.007235050201416016
mini_batch_src_global generation:  0.0017020702362060547
r_  generation:  0.020255088806152344
local_output_nid generation:  0.0029146671295166016
local_in_edges_tensor generation:  0.001741647720336914
mini_batch_src_global generation:  0.0020110607147216797
r_  generation:  0.021958351135253906
local_output_nid generation:  0.002937793731689453
local_in_edges_tensor generation:  0.0017359256744384766
mini_batch_src_global generation:  0.0017549991607666016
r_  generation:  0.021811962127685547
local_output_nid generation:  0.0029554367065429688
local_in_edges_tensor generation:  0.0017216205596923828
mini_batch_src_global generation:  0.0017681121826171875
r_  generation:  0.021413326263427734
local_output_nid generation:  0.002964496612548828
local_in_edges_tensor generation:  0.0017175674438476562
mini_batch_src_global generation:  0.0017387866973876953
r_  generation:  0.021642684936523438
local_output_nid generation:  0.003004312515258789
local_in_edges_tensor generation:  0.0017850399017333984
mini_batch_src_global generation:  0.001741647720336914
r_  generation:  0.021429061889648438
local_output_nid generation:  0.0030488967895507812
local_in_edges_tensor generation:  0.0017251968383789062
mini_batch_src_global generation:  0.0017614364624023438
r_  generation:  0.022992610931396484
local_output_nid generation:  0.0030088424682617188
local_in_edges_tensor generation:  0.0017015933990478516
mini_batch_src_global generation:  0.001779794692993164
r_  generation:  0.02189779281616211
local_output_nid generation:  0.0031135082244873047
local_in_edges_tensor generation:  0.00174713134765625
mini_batch_src_global generation:  0.0018870830535888672
r_  generation:  0.022641658782958984
local_output_nid generation:  0.0030083656311035156
local_in_edges_tensor generation:  0.0017094612121582031
mini_batch_src_global generation:  0.0017850399017333984
r_  generation:  0.021561622619628906
local_output_nid generation:  0.0029878616333007812
local_in_edges_tensor generation:  0.0017268657684326172
mini_batch_src_global generation:  0.0017087459564208984
r_  generation:  0.02145552635192871
local_output_nid generation:  0.0030045509338378906
local_in_edges_tensor generation:  0.00165557861328125
mini_batch_src_global generation:  0.0017104148864746094
r_  generation:  0.021654367446899414
local_output_nid generation:  0.0029783248901367188
local_in_edges_tensor generation:  0.0016407966613769531
mini_batch_src_global generation:  0.0017919540405273438
r_  generation:  0.022633790969848633
local_output_nid generation:  0.002996683120727539
local_in_edges_tensor generation:  0.0017104148864746094
mini_batch_src_global generation:  0.0018045902252197266
r_  generation:  0.02192401885986328
local_output_nid generation:  0.00299835205078125
local_in_edges_tensor generation:  0.001668691635131836
mini_batch_src_global generation:  0.0017330646514892578
r_  generation:  0.02191638946533203
local_output_nid generation:  0.0029556751251220703
local_in_edges_tensor generation:  0.0016391277313232422
mini_batch_src_global generation:  0.0017974376678466797
r_  generation:  0.02220463752746582
----------------------check_connections_block total spend ----------------------------- 0.5641305446624756
generate_one_block  0.030575275421142578
generate_one_block  0.03094768524169922
generate_one_block  0.031221628189086914
generate_one_block  0.0310361385345459
generate_one_block  0.0312347412109375
generate_one_block  0.03341507911682129
generate_one_block  0.03219723701477051
generate_one_block  0.03135323524475098
generate_one_block  0.03195047378540039
generate_one_block  0.030738353729248047
generate_one_block  0.030209779739379883
generate_one_block  0.0306704044342041
generate_one_block  0.032550811767578125
generate_one_block  0.03112483024597168
generate_one_block  0.030786514282226562
generate_one_block  0.032262563705444336
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.027414798736572266
gen group dst list time:  0.017575740814208984
time for parepare:  0.02059340476989746
local_output_nid generation:  0.00908207893371582
local_in_edges_tensor generation:  0.02183675765991211
mini_batch_src_global generation:  0.021546363830566406
r_  generation:  0.21142196655273438
local_output_nid generation:  0.013061285018920898
local_in_edges_tensor generation:  0.013090372085571289
mini_batch_src_global generation:  0.026665210723876953
r_  generation:  0.2182934284210205
local_output_nid generation:  0.012896537780761719
local_in_edges_tensor generation:  0.016228437423706055
mini_batch_src_global generation:  0.027776002883911133
r_  generation:  0.22981548309326172
local_output_nid generation:  0.01371312141418457
local_in_edges_tensor generation:  0.013378381729125977
mini_batch_src_global generation:  0.02745342254638672
r_  generation:  0.2307300567626953
local_output_nid generation:  0.013867378234863281
local_in_edges_tensor generation:  0.013663530349731445
mini_batch_src_global generation:  0.02871417999267578
r_  generation:  0.23349952697753906
local_output_nid generation:  0.013537883758544922
local_in_edges_tensor generation:  0.013198137283325195
mini_batch_src_global generation:  0.028791427612304688
r_  generation:  0.23203754425048828
local_output_nid generation:  0.013926267623901367
local_in_edges_tensor generation:  0.014480113983154297
mini_batch_src_global generation:  0.029653072357177734
r_  generation:  0.23903822898864746
local_output_nid generation:  0.013734579086303711
local_in_edges_tensor generation:  0.01416325569152832
mini_batch_src_global generation:  0.029308557510375977
r_  generation:  0.2330014705657959
local_output_nid generation:  0.013978719711303711
local_in_edges_tensor generation:  0.013620138168334961
mini_batch_src_global generation:  0.03035259246826172
r_  generation:  0.2394249439239502
local_output_nid generation:  0.013540506362915039
local_in_edges_tensor generation:  0.013423919677734375
mini_batch_src_global generation:  0.029158592224121094
r_  generation:  0.2303295135498047
local_output_nid generation:  0.013315677642822266
local_in_edges_tensor generation:  0.013273000717163086
mini_batch_src_global generation:  0.0289614200592041
r_  generation:  0.23267555236816406
local_output_nid generation:  0.013672590255737305
local_in_edges_tensor generation:  0.013529062271118164
mini_batch_src_global generation:  0.029338836669921875
r_  generation:  0.23430252075195312
local_output_nid generation:  0.01429891586303711
local_in_edges_tensor generation:  0.013819456100463867
mini_batch_src_global generation:  0.030690431594848633
r_  generation:  0.24680614471435547
local_output_nid generation:  0.013721704483032227
local_in_edges_tensor generation:  0.013351917266845703
mini_batch_src_global generation:  0.02979302406311035
r_  generation:  0.23207712173461914
local_output_nid generation:  0.013624191284179688
local_in_edges_tensor generation:  0.01320028305053711
mini_batch_src_global generation:  0.02938246726989746
r_  generation:  0.23639893531799316
local_output_nid generation:  0.013132095336914062
local_in_edges_tensor generation:  0.014232397079467773
mini_batch_src_global generation:  0.029802322387695312
r_  generation:  0.23853445053100586
----------------------check_connections_block total spend ----------------------------- 5.450211524963379
generate_one_block  0.29397010803222656
generate_one_block  0.295212984085083
generate_one_block  0.3031580448150635
generate_one_block  0.29850101470947266
generate_one_block  0.29924559593200684
generate_one_block  0.29639363288879395
generate_one_block  0.33005619049072266
generate_one_block  0.30297327041625977
generate_one_block  0.3072371482849121
generate_one_block  0.2965395450592041
generate_one_block  0.291827917098999
generate_one_block  0.2978091239929199
generate_one_block  0.3196837902069092
generate_one_block  0.29467105865478516
generate_one_block  0.29479002952575684
generate_one_block  0.3043487071990967
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028665542602539062
gen group dst list time:  0.06293821334838867
time for parepare:  0.018056154251098633
local_output_nid generation:  0.027253150939941406
local_in_edges_tensor generation:  0.03573298454284668
mini_batch_src_global generation:  0.040358781814575195
r_  generation:  0.44588613510131836
local_output_nid generation:  0.03126239776611328
local_in_edges_tensor generation:  0.03266191482543945
mini_batch_src_global generation:  0.05192923545837402
r_  generation:  0.4416778087615967
local_output_nid generation:  0.03146862983703613
local_in_edges_tensor generation:  0.030318737030029297
mini_batch_src_global generation:  0.05059456825256348
r_  generation:  0.45543980598449707
local_output_nid generation:  0.032781362533569336
local_in_edges_tensor generation:  0.03175711631774902
mini_batch_src_global generation:  0.054653167724609375
r_  generation:  0.4501805305480957
local_output_nid generation:  0.031493186950683594
local_in_edges_tensor generation:  0.0716390609741211
mini_batch_src_global generation:  0.05121564865112305
r_  generation:  0.4572267532348633
local_output_nid generation:  0.03110027313232422
local_in_edges_tensor generation:  0.028702974319458008
mini_batch_src_global generation:  0.053696632385253906
r_  generation:  0.4540441036224365
local_output_nid generation:  0.03526949882507324
local_in_edges_tensor generation:  0.029381752014160156
mini_batch_src_global generation:  0.05197477340698242
r_  generation:  0.4611823558807373
local_output_nid generation:  0.03190135955810547
local_in_edges_tensor generation:  0.03293180465698242
mini_batch_src_global generation:  0.0532536506652832
r_  generation:  0.4538764953613281
local_output_nid generation:  0.03177666664123535
local_in_edges_tensor generation:  0.031420230865478516
mini_batch_src_global generation:  0.05415201187133789
r_  generation:  0.46601247787475586
local_output_nid generation:  0.031434059143066406
local_in_edges_tensor generation:  0.028759002685546875
mini_batch_src_global generation:  0.05582857131958008
r_  generation:  0.45360231399536133
local_output_nid generation:  0.03168296813964844
local_in_edges_tensor generation:  0.031398773193359375
mini_batch_src_global generation:  0.0539243221282959
r_  generation:  0.4633772373199463
local_output_nid generation:  0.03160572052001953
local_in_edges_tensor generation:  0.031798362731933594
mini_batch_src_global generation:  0.05295848846435547
r_  generation:  0.45503711700439453
local_output_nid generation:  0.03176307678222656
local_in_edges_tensor generation:  0.029992341995239258
mini_batch_src_global generation:  0.05418086051940918
r_  generation:  0.46851682662963867
local_output_nid generation:  0.03171849250793457
local_in_edges_tensor generation:  0.029394865036010742
mini_batch_src_global generation:  0.05302000045776367
r_  generation:  0.4580404758453369
local_output_nid generation:  0.03165173530578613
local_in_edges_tensor generation:  0.029458045959472656
mini_batch_src_global generation:  0.05159401893615723
r_  generation:  0.46569108963012695
local_output_nid generation:  0.0317990779876709
local_in_edges_tensor generation:  0.03131604194641113
mini_batch_src_global generation:  0.0530393123626709
r_  generation:  0.46043992042541504
----------------------check_connections_block total spend ----------------------------- 10.808735370635986
generate_one_block  0.5781364440917969
generate_one_block  0.5796835422515869
generate_one_block  0.5754232406616211
generate_one_block  0.5824718475341797
generate_one_block  0.5722804069519043
generate_one_block  0.573908805847168
generate_one_block  0.5817878246307373
generate_one_block  0.5836169719696045
generate_one_block  0.6197195053100586
generate_one_block  0.5789015293121338
generate_one_block  0.5800516605377197
generate_one_block  0.5741410255432129
generate_one_block  0.5821256637573242
generate_one_block  0.5835371017456055
generate_one_block  0.576545000076294
generate_one_block  0.5805597305297852
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.11739683151245117  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

connection checking time:  16.258946895599365
block generation total time  14.129308462142944
average batch blocks generation time:  0.883081778883934
block dataloader generation time/epoch 33.093473851680756
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09466314315795898  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7442288398742676  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.0941472053527832  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7414865493774414  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09478759765625  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7461180686950684  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09466266632080078  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7466535568237305  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09474754333496094  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7435078620910645  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09421873092651367  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.742058277130127  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09489822387695312  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7515687942504883  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09444475173950195  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7455635070800781  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09493064880371094  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7578916549682617  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09433603286743164  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7398290634155273  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09463691711425781  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7439842224121094  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09443092346191406  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7445602416992188  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09508132934570312  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7589545249938965  GigaBytes
Max Memory Allocated: 0.8481054306030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09446430206298828  GigaBytes
Max Memory Allocated: 0.8484811782836914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7442760467529297  GigaBytes
Max Memory Allocated: 0.8484811782836914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09469890594482422  GigaBytes
Max Memory Allocated: 0.8484811782836914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.74383544921875  GigaBytes
Max Memory Allocated: 0.8484811782836914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09463167190551758  GigaBytes
Max Memory Allocated: 0.8484811782836914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.748903751373291  GigaBytes
Max Memory Allocated: 0.8484811782836914  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.059858739376068115 |0.012988805770874023 |0.0035288184881210327 |8.690357208251953e-05 |0.004845678806304932 |0.0018343925476074219 |
----------------------------------------------------------pseudo_mini_loss sum 1.2147315740585327
Total (block generation + training)time/epoch 34.51032475233078
Training time/epoch 1.3661856651306152
Training time without block to device /epoch 1.1583647727966309
Training time without total dataloading part /epoch 0.13721680641174316
load block tensor time/epoch 0.9577398300170898
block to device time/epoch 0.20782089233398438
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 29 |
Number of nodes for computation during this epoch:  5213217
Number of first layer input nodes during this epoch:  2481799
