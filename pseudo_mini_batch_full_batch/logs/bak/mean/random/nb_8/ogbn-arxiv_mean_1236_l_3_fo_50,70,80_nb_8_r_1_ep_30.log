Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1647762949.9426048
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026817798614501953
random selection method range initialization spend 0.0063359737396240234
time for parepare:  0.018565654754638672
local_output_nid generation:  0.00426173210144043
local_in_edges_tensor generation:  0.006543874740600586
mini_batch_src_global generation:  0.0037336349487304688
r_  generation:  0.04221653938293457
local_output_nid generation:  0.005753040313720703
local_in_edges_tensor generation:  0.003333568572998047
mini_batch_src_global generation:  0.004858255386352539
r_  generation:  0.04445624351501465
local_output_nid generation:  0.0060503482818603516
local_in_edges_tensor generation:  0.003390789031982422
mini_batch_src_global generation:  0.0033261775970458984
r_  generation:  0.04430985450744629
local_output_nid generation:  0.006198406219482422
local_in_edges_tensor generation:  0.003401517868041992
mini_batch_src_global generation:  0.003328084945678711
r_  generation:  0.049562692642211914
local_output_nid generation:  0.006435871124267578
local_in_edges_tensor generation:  0.0036232471466064453
mini_batch_src_global generation:  0.003635406494140625
r_  generation:  0.046257734298706055
local_output_nid generation:  0.006074190139770508
local_in_edges_tensor generation:  0.003452301025390625
mini_batch_src_global generation:  0.003726482391357422
r_  generation:  0.0463104248046875
local_output_nid generation:  0.0060651302337646484
local_in_edges_tensor generation:  0.0034055709838867188
mini_batch_src_global generation:  0.0039348602294921875
r_  generation:  0.0461421012878418
local_output_nid generation:  0.006022214889526367
local_in_edges_tensor generation:  0.0033941268920898438
mini_batch_src_global generation:  0.003937244415283203
r_  generation:  0.045569419860839844
----------------------check_connections_block total spend ----------------------------- 0.5762429237365723
generate_one_block  0.06202077865600586
generate_one_block  0.06267452239990234
generate_one_block  0.06107902526855469
generate_one_block  0.06020021438598633
generate_one_block  0.06463027000427246
generate_one_block  0.06148648262023926
generate_one_block  0.060877084732055664
generate_one_block  0.061254024505615234
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04557013511657715
gen group dst list time:  0.016151905059814453
time for parepare:  0.019338130950927734
local_output_nid generation:  0.014582157135009766
local_in_edges_tensor generation:  0.038121700286865234
mini_batch_src_global generation:  0.038971900939941406
r_  generation:  0.36118388175964355
local_output_nid generation:  0.019949674606323242
local_in_edges_tensor generation:  0.035767555236816406
mini_batch_src_global generation:  0.04475855827331543
r_  generation:  0.3745105266571045
local_output_nid generation:  0.01953721046447754
local_in_edges_tensor generation:  0.028835058212280273
mini_batch_src_global generation:  0.04415702819824219
r_  generation:  0.3876681327819824
local_output_nid generation:  0.019047021865844727
local_in_edges_tensor generation:  0.025056838989257812
mini_batch_src_global generation:  0.04449272155761719
r_  generation:  0.36914753913879395
local_output_nid generation:  0.019619226455688477
local_in_edges_tensor generation:  0.025289058685302734
mini_batch_src_global generation:  0.04864907264709473
r_  generation:  0.38170838356018066
local_output_nid generation:  0.019662141799926758
local_in_edges_tensor generation:  0.029109954833984375
mini_batch_src_global generation:  0.045983076095581055
r_  generation:  0.3843836784362793
local_output_nid generation:  0.01973867416381836
local_in_edges_tensor generation:  0.028371095657348633
mini_batch_src_global generation:  0.04942607879638672
r_  generation:  0.3955092430114746
local_output_nid generation:  0.01973438262939453
local_in_edges_tensor generation:  0.022581815719604492
mini_batch_src_global generation:  0.046811819076538086
r_  generation:  0.3785109519958496
----------------------check_connections_block total spend ----------------------------- 4.432932376861572
generate_one_block  0.49703311920166016
generate_one_block  0.5000302791595459
generate_one_block  0.49775147438049316
generate_one_block  0.4830129146575928
generate_one_block  0.4976632595062256
generate_one_block  0.5065393447875977
generate_one_block  0.498427152633667
generate_one_block  0.4953320026397705
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03819084167480469
gen group dst list time:  0.03670096397399902
time for parepare:  0.01927471160888672
local_output_nid generation:  0.028483867645263672
local_in_edges_tensor generation:  0.04724526405334473
mini_batch_src_global generation:  0.05245804786682129
r_  generation:  0.5468847751617432
local_output_nid generation:  0.0354161262512207
local_in_edges_tensor generation:  0.05361628532409668
mini_batch_src_global generation:  0.06840920448303223
r_  generation:  0.5480751991271973
local_output_nid generation:  0.03513813018798828
local_in_edges_tensor generation:  0.04562973976135254
mini_batch_src_global generation:  0.06176280975341797
r_  generation:  0.5494201183319092
local_output_nid generation:  0.035058021545410156
local_in_edges_tensor generation:  0.03920578956604004
mini_batch_src_global generation:  0.061608314514160156
r_  generation:  0.5695505142211914
local_output_nid generation:  0.03496503829956055
local_in_edges_tensor generation:  0.03509235382080078
mini_batch_src_global generation:  0.06279683113098145
r_  generation:  0.5572988986968994
local_output_nid generation:  0.035315752029418945
local_in_edges_tensor generation:  0.04366612434387207
mini_batch_src_global generation:  0.061582088470458984
r_  generation:  0.5714244842529297
local_output_nid generation:  0.03518366813659668
local_in_edges_tensor generation:  0.03596043586730957
mini_batch_src_global generation:  0.06652140617370605
r_  generation:  0.5742571353912354
local_output_nid generation:  0.03519725799560547
local_in_edges_tensor generation:  0.03578472137451172
mini_batch_src_global generation:  0.06349539756774902
r_  generation:  0.5708389282226562
----------------------check_connections_block total spend ----------------------------- 6.608642101287842
generate_one_block  0.7299807071685791
generate_one_block  0.7316877841949463
generate_one_block  0.7243936061859131
generate_one_block  0.7181556224822998
generate_one_block  0.7060427665710449
generate_one_block  0.7320740222930908
generate_one_block  0.7236664295196533
generate_one_block  0.7001004219055176
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  11.041574478149414
block generation total time  9.741890907287598
average batch blocks generation time:  1.2177363634109497
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.10234832763671875  GigaBytes
Max Memory Allocated: 0.10234832763671875  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4979248046875 GB
    Memory Allocated: 0.9526505470275879  GigaBytes
Max Memory Allocated: 1.018777847290039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8690185546875 GB
    Memory Allocated: 0.10486173629760742  GigaBytes
Max Memory Allocated: 1.0932579040527344  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8709716796875 GB
    Memory Allocated: 0.9574594497680664  GigaBytes
Max Memory Allocated: 1.0932579040527344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.10479879379272461  GigaBytes
Max Memory Allocated: 1.0992183685302734  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.9510083198547363  GigaBytes
Max Memory Allocated: 1.0992183685302734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.10448217391967773  GigaBytes
Max Memory Allocated: 1.0992183685302734  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.9490585327148438  GigaBytes
Max Memory Allocated: 1.0992183685302734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.10571622848510742  GigaBytes
Max Memory Allocated: 1.0992183685302734  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.9516410827636719  GigaBytes
Max Memory Allocated: 1.0992183685302734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.10506296157836914  GigaBytes
Max Memory Allocated: 1.0992183685302734  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.9578638076782227  GigaBytes
Max Memory Allocated: 1.0992183685302734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.1052865982055664  GigaBytes
Max Memory Allocated: 1.0992183685302734  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.9532294273376465  GigaBytes
Max Memory Allocated: 1.0992183685302734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.1046743392944336  GigaBytes
Max Memory Allocated: 1.0992183685302734  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.9517359733581543  GigaBytes
Max Memory Allocated: 1.0992183685302734  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06816324591636658 |0.04997768998146057 |0.0993712842464447 |0.00010141730308532715 |0.015439480543136597 |0.0016393661499023438 |
----------------------------------------------------------pseudo_mini_loss sum 6.242050647735596
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3058375
Number of first layer input nodes during this epoch:  1301274
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.14149236679077148  GigaBytes
Max Memory Allocated: 1.0992183685302734  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02732253074645996
random selection method range initialization spend 0.005479097366333008
time for parepare:  0.018059730529785156
local_output_nid generation:  0.004587888717651367
local_in_edges_tensor generation:  0.006745576858520508
mini_batch_src_global generation:  0.003747224807739258
r_  generation:  0.047722816467285156
local_output_nid generation:  0.006666898727416992
local_in_edges_tensor generation:  0.0032629966735839844
mini_batch_src_global generation:  0.004734992980957031
r_  generation:  0.04356265068054199
local_output_nid generation:  0.010668516159057617
local_in_edges_tensor generation:  0.003584146499633789
mini_batch_src_global generation:  0.0033729076385498047
r_  generation:  0.04455232620239258
local_output_nid generation:  0.007328987121582031
local_in_edges_tensor generation:  0.0034058094024658203
mini_batch_src_global generation:  0.003548860549926758
r_  generation:  0.04742550849914551
local_output_nid generation:  0.007410764694213867
local_in_edges_tensor generation:  0.0034208297729492188
mini_batch_src_global generation:  0.0036895275115966797
r_  generation:  0.0491485595703125
local_output_nid generation:  0.007407665252685547
local_in_edges_tensor generation:  0.003288745880126953
mini_batch_src_global generation:  0.007225990295410156
r_  generation:  0.047663211822509766
local_output_nid generation:  0.007465839385986328
local_in_edges_tensor generation:  0.0033228397369384766
mini_batch_src_global generation:  0.0040547847747802734
r_  generation:  0.052938222885131836
local_output_nid generation:  0.007691144943237305
local_in_edges_tensor generation:  0.006963253021240234
mini_batch_src_global generation:  0.0060236454010009766
r_  generation:  0.052845001220703125
----------------------check_connections_block total spend ----------------------------- 0.6252796649932861
generate_one_block  0.0631413459777832
generate_one_block  0.06226539611816406
generate_one_block  0.06466197967529297
generate_one_block  0.06073331832885742
generate_one_block  0.06453323364257812
generate_one_block  0.061862945556640625
generate_one_block  0.0680379867553711
generate_one_block  0.061301469802856445
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.060373544692993164
gen group dst list time:  0.0161287784576416
time for parepare:  0.02107691764831543
local_output_nid generation:  0.01451420783996582
local_in_edges_tensor generation:  0.05003547668457031
mini_batch_src_global generation:  0.036376237869262695
r_  generation:  0.3590695858001709
local_output_nid generation:  0.020351409912109375
local_in_edges_tensor generation:  0.03544163703918457
mini_batch_src_global generation:  0.04482889175415039
r_  generation:  0.36983180046081543
local_output_nid generation:  0.01936936378479004
local_in_edges_tensor generation:  0.02825760841369629
mini_batch_src_global generation:  0.04421877861022949
r_  generation:  0.3730630874633789
local_output_nid generation:  0.019224882125854492
local_in_edges_tensor generation:  0.02849578857421875
mini_batch_src_global generation:  0.04613137245178223
r_  generation:  0.37039971351623535
local_output_nid generation:  0.02082061767578125
local_in_edges_tensor generation:  0.02185678482055664
mini_batch_src_global generation:  0.045609235763549805
r_  generation:  0.37964391708374023
local_output_nid generation:  0.019431114196777344
local_in_edges_tensor generation:  0.028307676315307617
mini_batch_src_global generation:  0.04750394821166992
r_  generation:  0.3837594985961914
local_output_nid generation:  0.019672632217407227
local_in_edges_tensor generation:  0.025434255599975586
mini_batch_src_global generation:  0.04934263229370117
r_  generation:  0.3858339786529541
local_output_nid generation:  0.021615982055664062
local_in_edges_tensor generation:  0.025373458862304688
mini_batch_src_global generation:  0.04610276222229004
r_  generation:  0.3824172019958496
----------------------check_connections_block total spend ----------------------------- 4.420587062835693
generate_one_block  0.5377893447875977
generate_one_block  0.5217876434326172
generate_one_block  0.4949028491973877
generate_one_block  0.5602912902832031
generate_one_block  0.5161747932434082
generate_one_block  0.5062675476074219
generate_one_block  0.5088813304901123
generate_one_block  0.5151979923248291
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.1031796932220459
gen group dst list time:  0.0407259464263916
time for parepare:  0.019298791885375977
local_output_nid generation:  0.029868602752685547
local_in_edges_tensor generation:  0.05788064002990723
mini_batch_src_global generation:  0.05272078514099121
r_  generation:  0.5697879791259766
local_output_nid generation:  0.04077005386352539
local_in_edges_tensor generation:  0.06306982040405273
mini_batch_src_global generation:  0.06692171096801758
r_  generation:  0.5490469932556152
local_output_nid generation:  0.03675532341003418
local_in_edges_tensor generation:  0.056352853775024414
mini_batch_src_global generation:  0.06155681610107422
r_  generation:  0.5550098419189453
local_output_nid generation:  0.03677773475646973
local_in_edges_tensor generation:  0.04730367660522461
mini_batch_src_global generation:  0.060648441314697266
r_  generation:  0.5827703475952148
local_output_nid generation:  0.037114620208740234
local_in_edges_tensor generation:  0.03694510459899902
mini_batch_src_global generation:  0.06193971633911133
r_  generation:  0.5721049308776855
local_output_nid generation:  0.03796052932739258
local_in_edges_tensor generation:  0.04819750785827637
mini_batch_src_global generation:  0.06572818756103516
r_  generation:  0.5938808917999268
local_output_nid generation:  0.04068875312805176
local_in_edges_tensor generation:  0.06113862991333008
mini_batch_src_global generation:  0.0708000659942627
r_  generation:  0.5703520774841309
local_output_nid generation:  0.03705739974975586
local_in_edges_tensor generation:  0.04892230033874512
mini_batch_src_global generation:  0.06335139274597168
r_  generation:  0.5691695213317871
----------------------check_connections_block total spend ----------------------------- 6.80137300491333
generate_one_block  0.7345790863037109
generate_one_block  0.7150354385375977
generate_one_block  0.7359318733215332
generate_one_block  0.7135987281799316
generate_one_block  0.7213137149810791
generate_one_block  0.7030982971191406
generate_one_block  0.7178435325622559
generate_one_block  0.7533719539642334
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.14149236679077148  GigaBytes
Max Memory Allocated: 1.0992183685302734  GigaBytes

connection checking time:  11.221960067749023
block generation total time  9.95606541633606
average batch blocks generation time:  1.2445081770420074
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.10730504989624023  GigaBytes
Max Memory Allocated: 1.0992183685302734  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9588794708251953  GigaBytes
Max Memory Allocated: 1.0992183685302734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1060032844543457  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9557170867919922  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10642671585083008  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9553523063659668  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10620975494384766  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.953087329864502  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10719585418701172  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9541397094726562  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10657405853271484  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9541034698486328  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10727357864379883  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9567418098449707  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1059103012084961  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9540238380432129  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08339270949363708 |0.022074013948440552 |0.0035437345504760742 |9.360909461975098e-05 |0.003351539373397827 |0.0013954639434814453 |
----------------------------------------------------------pseudo_mini_loss sum 3.2352170944213867
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3059440
Number of first layer input nodes during this epoch:  1301164
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14137935638427734  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.033252716064453125
random selection method range initialization spend 0.005258798599243164
time for parepare:  0.017606496810913086
local_output_nid generation:  0.004438638687133789
local_in_edges_tensor generation:  0.010170459747314453
mini_batch_src_global generation:  0.004007101058959961
r_  generation:  0.042185068130493164
local_output_nid generation:  0.006038188934326172
local_in_edges_tensor generation:  0.0032529830932617188
mini_batch_src_global generation:  0.0049114227294921875
r_  generation:  0.04470109939575195
local_output_nid generation:  0.006087541580200195
local_in_edges_tensor generation:  0.0033419132232666016
mini_batch_src_global generation:  0.0032100677490234375
r_  generation:  0.045201778411865234
local_output_nid generation:  0.0061473846435546875
local_in_edges_tensor generation:  0.003396749496459961
mini_batch_src_global generation:  0.0035448074340820312
r_  generation:  0.04699540138244629
local_output_nid generation:  0.006108760833740234
local_in_edges_tensor generation:  0.0033674240112304688
mini_batch_src_global generation:  0.003759622573852539
r_  generation:  0.0482175350189209
local_output_nid generation:  0.006185054779052734
local_in_edges_tensor generation:  0.0033457279205322266
mini_batch_src_global generation:  0.004079580307006836
r_  generation:  0.04795050621032715
local_output_nid generation:  0.0061151981353759766
local_in_edges_tensor generation:  0.0033712387084960938
mini_batch_src_global generation:  0.003932952880859375
r_  generation:  0.04725146293640137
local_output_nid generation:  0.006117105484008789
local_in_edges_tensor generation:  0.003341197967529297
mini_batch_src_global generation:  0.004147052764892578
r_  generation:  0.04979443550109863
----------------------check_connections_block total spend ----------------------------- 0.5907912254333496
generate_one_block  0.05990099906921387
generate_one_block  0.0606229305267334
generate_one_block  0.06050229072570801
generate_one_block  0.06161952018737793
generate_one_block  0.06259584426879883
generate_one_block  0.06143641471862793
generate_one_block  0.06485152244567871
generate_one_block  0.06316876411437988
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04616951942443848
gen group dst list time:  0.01631641387939453
time for parepare:  0.01902627944946289
local_output_nid generation:  0.014838933944702148
local_in_edges_tensor generation:  0.034375905990600586
mini_batch_src_global generation:  0.03660011291503906
r_  generation:  0.3629264831542969
local_output_nid generation:  0.020452499389648438
local_in_edges_tensor generation:  0.02716517448425293
mini_batch_src_global generation:  0.044213056564331055
r_  generation:  0.3714640140533447
local_output_nid generation:  0.02035689353942871
local_in_edges_tensor generation:  0.02266073226928711
mini_batch_src_global generation:  0.04498147964477539
r_  generation:  0.37538695335388184
local_output_nid generation:  0.01932525634765625
local_in_edges_tensor generation:  0.02227950096130371
mini_batch_src_global generation:  0.045293331146240234
r_  generation:  0.3766357898712158
local_output_nid generation:  0.01962876319885254
local_in_edges_tensor generation:  0.0225982666015625
mini_batch_src_global generation:  0.04639315605163574
r_  generation:  0.38677430152893066
local_output_nid generation:  0.01928997039794922
local_in_edges_tensor generation:  0.021530628204345703
mini_batch_src_global generation:  0.04688572883605957
r_  generation:  0.38022541999816895
local_output_nid generation:  0.019207239151000977
local_in_edges_tensor generation:  0.022211074829101562
mini_batch_src_global generation:  0.047608137130737305
r_  generation:  0.380962610244751
local_output_nid generation:  0.01949286460876465
local_in_edges_tensor generation:  0.02307748794555664
mini_batch_src_global generation:  0.04674172401428223
r_  generation:  0.3847968578338623
----------------------check_connections_block total spend ----------------------------- 4.379785776138306
generate_one_block  0.49316906929016113
generate_one_block  0.4861612319946289
generate_one_block  0.48966073989868164
generate_one_block  0.4928915500640869
generate_one_block  0.49385881423950195
generate_one_block  0.49152183532714844
generate_one_block  0.48320627212524414
generate_one_block  0.520639181137085
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.06864356994628906
gen group dst list time:  0.03995537757873535
time for parepare:  0.01997685432434082
local_output_nid generation:  0.03050994873046875
local_in_edges_tensor generation:  0.04731464385986328
mini_batch_src_global generation:  0.05190157890319824
r_  generation:  0.5488767623901367
local_output_nid generation:  0.041085004806518555
local_in_edges_tensor generation:  0.04657316207885742
mini_batch_src_global generation:  0.06430363655090332
r_  generation:  0.5542643070220947
local_output_nid generation:  0.037386417388916016
local_in_edges_tensor generation:  0.04121875762939453
mini_batch_src_global generation:  0.06125164031982422
r_  generation:  0.5594346523284912
local_output_nid generation:  0.036409616470336914
local_in_edges_tensor generation:  0.04134702682495117
mini_batch_src_global generation:  0.06068825721740723
r_  generation:  0.569072961807251
local_output_nid generation:  0.036319732666015625
local_in_edges_tensor generation:  0.04407620429992676
mini_batch_src_global generation:  0.06459593772888184
r_  generation:  0.5664412975311279
local_output_nid generation:  0.03610992431640625
local_in_edges_tensor generation:  0.04389667510986328
mini_batch_src_global generation:  0.0624690055847168
r_  generation:  0.5704765319824219
local_output_nid generation:  0.035944223403930664
local_in_edges_tensor generation:  0.04075908660888672
mini_batch_src_global generation:  0.06423592567443848
r_  generation:  0.5785045623779297
local_output_nid generation:  0.03596186637878418
local_in_edges_tensor generation:  0.0461583137512207
mini_batch_src_global generation:  0.0648963451385498
r_  generation:  0.5778577327728271
----------------------check_connections_block total spend ----------------------------- 6.672457933425903
generate_one_block  0.7141807079315186
generate_one_block  0.704169750213623
generate_one_block  0.7183678150177002
generate_one_block  0.7236034870147705
generate_one_block  0.7065002918243408
generate_one_block  0.7171344757080078
generate_one_block  0.6999013423919678
generate_one_block  0.7198121547698975
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14137935638427734  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

connection checking time:  11.052243709564209
block generation total time  9.654778718948364
average batch blocks generation time:  1.2068473398685455
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10721921920776367  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9546718597412109  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10626888275146484  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9543366432189941  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10715675354003906  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9544434547424316  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10663795471191406  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9545702934265137  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10732460021972656  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9572787284851074  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10582256317138672  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9528522491455078  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10676813125610352  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9526076316833496  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10680341720581055  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9559478759765625  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08315876126289368 |0.020305871963500977 |0.003489881753921509 |9.593367576599121e-05 |0.003397345542907715 |0.0015420913696289062 |
----------------------------------------------------------pseudo_mini_loss sum 2.6124930381774902
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  3057243
Number of first layer input nodes during this epoch:  1300502
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14149713516235352  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023445844650268555
random selection method range initialization spend 0.00503230094909668
time for parepare:  0.017120361328125
local_output_nid generation:  0.004601716995239258
local_in_edges_tensor generation:  0.007022857666015625
mini_batch_src_global generation:  0.003831148147583008
r_  generation:  0.042281389236450195
local_output_nid generation:  0.005928993225097656
local_in_edges_tensor generation:  0.0038487911224365234
mini_batch_src_global generation:  0.004893779754638672
r_  generation:  0.04467630386352539
local_output_nid generation:  0.006060361862182617
local_in_edges_tensor generation:  0.0036764144897460938
mini_batch_src_global generation:  0.003312349319458008
r_  generation:  0.044957637786865234
local_output_nid generation:  0.006127595901489258
local_in_edges_tensor generation:  0.0037736892700195312
mini_batch_src_global generation:  0.0035626888275146484
r_  generation:  0.04658341407775879
local_output_nid generation:  0.006174325942993164
local_in_edges_tensor generation:  0.003841876983642578
mini_batch_src_global generation:  0.003636598587036133
r_  generation:  0.04758596420288086
local_output_nid generation:  0.0061032772064208984
local_in_edges_tensor generation:  0.005639314651489258
mini_batch_src_global generation:  0.003995656967163086
r_  generation:  0.04809832572937012
local_output_nid generation:  0.006072998046875
local_in_edges_tensor generation:  0.0036940574645996094
mini_batch_src_global generation:  0.003977537155151367
r_  generation:  0.047768354415893555
local_output_nid generation:  0.006125450134277344
local_in_edges_tensor generation:  0.003680706024169922
mini_batch_src_global generation:  0.0041310787200927734
r_  generation:  0.04982900619506836
----------------------check_connections_block total spend ----------------------------- 0.5937216281890869
generate_one_block  0.06473207473754883
generate_one_block  0.06198453903198242
generate_one_block  0.06129574775695801
generate_one_block  0.061177968978881836
generate_one_block  0.06274843215942383
generate_one_block  0.06207752227783203
generate_one_block  0.06519198417663574
generate_one_block  0.0627603530883789
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03620266914367676
gen group dst list time:  0.015880107879638672
time for parepare:  0.018878936767578125
local_output_nid generation:  0.015085220336914062
local_in_edges_tensor generation:  0.032013654708862305
mini_batch_src_global generation:  0.04565906524658203
r_  generation:  0.36141252517700195
local_output_nid generation:  0.021158456802368164
local_in_edges_tensor generation:  0.023650407791137695
mini_batch_src_global generation:  0.04881000518798828
r_  generation:  0.3793447017669678
local_output_nid generation:  0.021640777587890625
local_in_edges_tensor generation:  0.028826475143432617
mini_batch_src_global generation:  0.048763275146484375
r_  generation:  0.38228893280029297
local_output_nid generation:  0.020196199417114258
local_in_edges_tensor generation:  0.0245358943939209
mini_batch_src_global generation:  0.0565638542175293
r_  generation:  0.3815877437591553
local_output_nid generation:  0.0207064151763916
local_in_edges_tensor generation:  0.026752948760986328
mini_batch_src_global generation:  0.0526278018951416
r_  generation:  0.3827016353607178
local_output_nid generation:  0.02015376091003418
local_in_edges_tensor generation:  0.02552056312561035
mini_batch_src_global generation:  0.047178030014038086
r_  generation:  0.3888556957244873
local_output_nid generation:  0.019793272018432617
local_in_edges_tensor generation:  0.021015167236328125
mini_batch_src_global generation:  0.049134016036987305
r_  generation:  0.38643503189086914
local_output_nid generation:  0.019968032836914062
local_in_edges_tensor generation:  0.0225374698638916
mini_batch_src_global generation:  0.04685688018798828
r_  generation:  0.3820509910583496
----------------------check_connections_block total spend ----------------------------- 4.4611876010894775
generate_one_block  0.49686479568481445
generate_one_block  0.49422383308410645
generate_one_block  0.4887964725494385
generate_one_block  0.48789358139038086
generate_one_block  0.4886305332183838
generate_one_block  0.494490385055542
generate_one_block  0.4808051586151123
generate_one_block  0.514167070388794
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.049152374267578125
gen group dst list time:  0.03740811347961426
time for parepare:  0.01969456672668457
local_output_nid generation:  0.03013324737548828
local_in_edges_tensor generation:  0.0553278923034668
mini_batch_src_global generation:  0.05161929130554199
r_  generation:  0.5392906665802002
local_output_nid generation:  0.03620743751525879
local_in_edges_tensor generation:  0.0471343994140625
mini_batch_src_global generation:  0.06380176544189453
r_  generation:  0.5460917949676514
local_output_nid generation:  0.03629803657531738
local_in_edges_tensor generation:  0.04742693901062012
mini_batch_src_global generation:  0.06237006187438965
r_  generation:  0.5546417236328125
local_output_nid generation:  0.0364987850189209
local_in_edges_tensor generation:  0.039574384689331055
mini_batch_src_global generation:  0.06085658073425293
r_  generation:  0.5598292350769043
local_output_nid generation:  0.03639507293701172
local_in_edges_tensor generation:  0.03990030288696289
mini_batch_src_global generation:  0.06175947189331055
r_  generation:  0.5645105838775635
local_output_nid generation:  0.03609299659729004
local_in_edges_tensor generation:  0.039760589599609375
mini_batch_src_global generation:  0.0622868537902832
r_  generation:  0.566185474395752
local_output_nid generation:  0.03616690635681152
local_in_edges_tensor generation:  0.03922581672668457
mini_batch_src_global generation:  0.06273961067199707
r_  generation:  0.5679733753204346
local_output_nid generation:  0.036237478256225586
local_in_edges_tensor generation:  0.039147377014160156
mini_batch_src_global generation:  0.06552863121032715
r_  generation:  0.5704312324523926
----------------------check_connections_block total spend ----------------------------- 6.602174758911133
generate_one_block  0.6969144344329834
generate_one_block  0.7046234607696533
generate_one_block  0.7170588970184326
generate_one_block  0.7120380401611328
generate_one_block  0.697899580001831
generate_one_block  0.7006103992462158
generate_one_block  0.7032191753387451
generate_one_block  0.7139277458190918
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14149713516235352  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

connection checking time:  11.06336236000061
block generation total time  9.592163562774658
average batch blocks generation time:  1.1990204453468323
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10647153854370117  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9527750015258789  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10631036758422852  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9551897048950195  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10640764236450195  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9535655975341797  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10634946823120117  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9541597366333008  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10726451873779297  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9558653831481934  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10639429092407227  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9567670822143555  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1062922477722168  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9519705772399902  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10634279251098633  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9553236961364746  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08568286895751953 |0.014590442180633545 |0.0035772323608398438 |9.199976921081543e-05 |0.003836303949356079 |0.001332998275756836 |
----------------------------------------------------------pseudo_mini_loss sum 2.3664193153381348
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  3058253
Number of first layer input nodes during this epoch:  1300858
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14127588272094727  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022206544876098633
random selection method range initialization spend 0.004998922348022461
time for parepare:  0.017462491989135742
local_output_nid generation:  0.004578590393066406
local_in_edges_tensor generation:  0.0060045719146728516
mini_batch_src_global generation:  0.003906965255737305
r_  generation:  0.04254007339477539
local_output_nid generation:  0.006018638610839844
local_in_edges_tensor generation:  0.003427743911743164
mini_batch_src_global generation:  0.004843235015869141
r_  generation:  0.04494786262512207
local_output_nid generation:  0.006136178970336914
local_in_edges_tensor generation:  0.0034923553466796875
mini_batch_src_global generation:  0.0032088756561279297
r_  generation:  0.04519009590148926
local_output_nid generation:  0.006162881851196289
local_in_edges_tensor generation:  0.0034410953521728516
mini_batch_src_global generation:  0.003531217575073242
r_  generation:  0.04786562919616699
local_output_nid generation:  0.0061376094818115234
local_in_edges_tensor generation:  0.003590822219848633
mini_batch_src_global generation:  0.003702878952026367
r_  generation:  0.04788994789123535
local_output_nid generation:  0.006127834320068359
local_in_edges_tensor generation:  0.0036628246307373047
mini_batch_src_global generation:  0.003953456878662109
r_  generation:  0.04840350151062012
local_output_nid generation:  0.006174564361572266
local_in_edges_tensor generation:  0.003636598587036133
mini_batch_src_global generation:  0.003892660140991211
r_  generation:  0.04809880256652832
local_output_nid generation:  0.0061283111572265625
local_in_edges_tensor generation:  0.0034241676330566406
mini_batch_src_global generation:  0.00403904914855957
r_  generation:  0.04943275451660156
----------------------check_connections_block total spend ----------------------------- 0.589045524597168
generate_one_block  0.06071591377258301
generate_one_block  0.06109356880187988
generate_one_block  0.06044650077819824
generate_one_block  0.06214094161987305
generate_one_block  0.06193995475769043
generate_one_block  0.061632633209228516
generate_one_block  0.06501197814941406
generate_one_block  0.062146663665771484
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03957414627075195
gen group dst list time:  0.018627166748046875
time for parepare:  0.02052021026611328
local_output_nid generation:  0.01518392562866211
local_in_edges_tensor generation:  0.031369924545288086
mini_batch_src_global generation:  0.035156965255737305
r_  generation:  0.36710333824157715
local_output_nid generation:  0.020838022232055664
local_in_edges_tensor generation:  0.030046701431274414
mini_batch_src_global generation:  0.04438447952270508
r_  generation:  0.3770143985748291
local_output_nid generation:  0.021053314208984375
local_in_edges_tensor generation:  0.023862123489379883
mini_batch_src_global generation:  0.04357457160949707
r_  generation:  0.3807504177093506
local_output_nid generation:  0.02015995979309082
local_in_edges_tensor generation:  0.02220892906188965
mini_batch_src_global generation:  0.04527640342712402
r_  generation:  0.3816566467285156
local_output_nid generation:  0.019773244857788086
local_in_edges_tensor generation:  0.025025606155395508
mini_batch_src_global generation:  0.04579448699951172
r_  generation:  0.39222264289855957
local_output_nid generation:  0.0197751522064209
local_in_edges_tensor generation:  0.023035764694213867
mini_batch_src_global generation:  0.0464174747467041
r_  generation:  0.3865020275115967
local_output_nid generation:  0.019670963287353516
local_in_edges_tensor generation:  0.021631479263305664
mini_batch_src_global generation:  0.04575920104980469
r_  generation:  0.3870556354522705
local_output_nid generation:  0.019677400588989258
local_in_edges_tensor generation:  0.021609067916870117
mini_batch_src_global generation:  0.04606461524963379
r_  generation:  0.3830735683441162
----------------------check_connections_block total spend ----------------------------- 4.415820837020874
generate_one_block  0.49089622497558594
generate_one_block  0.48381805419921875
generate_one_block  0.47900915145874023
generate_one_block  0.48684000968933105
generate_one_block  0.494204044342041
generate_one_block  0.48466038703918457
generate_one_block  0.48542046546936035
generate_one_block  0.5098259449005127
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04804396629333496
gen group dst list time:  0.038220882415771484
time for parepare:  0.019147872924804688
local_output_nid generation:  0.030460357666015625
local_in_edges_tensor generation:  0.04957413673400879
mini_batch_src_global generation:  0.053194284439086914
r_  generation:  0.5423800945281982
local_output_nid generation:  0.03740286827087402
local_in_edges_tensor generation:  0.04161858558654785
mini_batch_src_global generation:  0.06344962120056152
r_  generation:  0.5519280433654785
local_output_nid generation:  0.03639578819274902
local_in_edges_tensor generation:  0.04312467575073242
mini_batch_src_global generation:  0.06098461151123047
r_  generation:  0.5560288429260254
local_output_nid generation:  0.03597235679626465
local_in_edges_tensor generation:  0.03709149360656738
mini_batch_src_global generation:  0.0603480339050293
r_  generation:  0.5613124370574951
local_output_nid generation:  0.03581833839416504
local_in_edges_tensor generation:  0.044447898864746094
mini_batch_src_global generation:  0.06386566162109375
r_  generation:  0.5636725425720215
local_output_nid generation:  0.03591752052307129
local_in_edges_tensor generation:  0.03705191612243652
mini_batch_src_global generation:  0.06263232231140137
r_  generation:  0.5704655647277832
local_output_nid generation:  0.03656506538391113
local_in_edges_tensor generation:  0.03957366943359375
mini_batch_src_global generation:  0.06604385375976562
r_  generation:  0.5705294609069824
local_output_nid generation:  0.03616499900817871
local_in_edges_tensor generation:  0.03966069221496582
mini_batch_src_global generation:  0.06652021408081055
r_  generation:  0.5717372894287109
----------------------check_connections_block total spend ----------------------------- 6.615974187850952
generate_one_block  0.7198500633239746
generate_one_block  0.7093658447265625
generate_one_block  0.703965425491333
generate_one_block  0.7201159000396729
generate_one_block  0.7061629295349121
generate_one_block  0.7000057697296143
generate_one_block  0.7095217704772949
generate_one_block  0.7198696136474609
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14127588272094727  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

connection checking time:  11.031795024871826
block generation total time  9.6035315990448
average batch blocks generation time:  1.2004414498806
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1069192886352539  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.954775333404541  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10657215118408203  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9564013481140137  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1068105697631836  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9552831649780273  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10659360885620117  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9547543525695801  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10711288452148438  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9550385475158691  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10654640197753906  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9540276527404785  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10709190368652344  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9553847312927246  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10664939880371094  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9573826789855957  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08257487416267395 |0.015992850065231323 |0.0033532679080963135 |8.666515350341797e-05 |0.003122091293334961 |0.001220703125 |
----------------------------------------------------------pseudo_mini_loss sum 2.09930682182312
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  3059615
Number of first layer input nodes during this epoch:  1301141
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14136600494384766  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022132158279418945
random selection method range initialization spend 0.004906415939331055
time for parepare:  0.018237829208374023
local_output_nid generation:  0.00446772575378418
local_in_edges_tensor generation:  0.006566047668457031
mini_batch_src_global generation:  0.003836393356323242
r_  generation:  0.0410151481628418
local_output_nid generation:  0.005973100662231445
local_in_edges_tensor generation:  0.0033729076385498047
mini_batch_src_global generation:  0.004842281341552734
r_  generation:  0.04441547393798828
local_output_nid generation:  0.006099700927734375
local_in_edges_tensor generation:  0.0034456253051757812
mini_batch_src_global generation:  0.0032892227172851562
r_  generation:  0.046042442321777344
local_output_nid generation:  0.006137847900390625
local_in_edges_tensor generation:  0.0036330223083496094
mini_batch_src_global generation:  0.0036003589630126953
r_  generation:  0.04734945297241211
local_output_nid generation:  0.006155729293823242
local_in_edges_tensor generation:  0.003476381301879883
mini_batch_src_global generation:  0.0036733150482177734
r_  generation:  0.04773139953613281
local_output_nid generation:  0.006156206130981445
local_in_edges_tensor generation:  0.0034487247467041016
mini_batch_src_global generation:  0.0040493011474609375
r_  generation:  0.04860854148864746
local_output_nid generation:  0.006160259246826172
local_in_edges_tensor generation:  0.0034372806549072266
mini_batch_src_global generation:  0.00400996208190918
r_  generation:  0.048087120056152344
local_output_nid generation:  0.006172657012939453
local_in_edges_tensor generation:  0.0035004615783691406
mini_batch_src_global generation:  0.004108905792236328
r_  generation:  0.04785323143005371
----------------------check_connections_block total spend ----------------------------- 0.5872340202331543
generate_one_block  0.0665891170501709
generate_one_block  0.06108903884887695
generate_one_block  0.06137824058532715
generate_one_block  0.061716318130493164
generate_one_block  0.06206631660461426
generate_one_block  0.06227874755859375
generate_one_block  0.06608057022094727
generate_one_block  0.06166362762451172
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03600478172302246
gen group dst list time:  0.015503883361816406
time for parepare:  0.018900156021118164
local_output_nid generation:  0.014826059341430664
local_in_edges_tensor generation:  0.033516645431518555
mini_batch_src_global generation:  0.03547334671020508
r_  generation:  0.35022497177124023
local_output_nid generation:  0.0211794376373291
local_in_edges_tensor generation:  0.02931952476501465
mini_batch_src_global generation:  0.04618239402770996
r_  generation:  0.37366771697998047
local_output_nid generation:  0.02117156982421875
local_in_edges_tensor generation:  0.021138429641723633
mini_batch_src_global generation:  0.04472017288208008
r_  generation:  0.3776841163635254
local_output_nid generation:  0.020488977432250977
local_in_edges_tensor generation:  0.021389007568359375
mini_batch_src_global generation:  0.045508623123168945
r_  generation:  0.37805938720703125
local_output_nid generation:  0.020084857940673828
local_in_edges_tensor generation:  0.020573139190673828
mini_batch_src_global generation:  0.04638409614562988
r_  generation:  0.38387441635131836
local_output_nid generation:  0.019744396209716797
local_in_edges_tensor generation:  0.02101612091064453
mini_batch_src_global generation:  0.046363115310668945
r_  generation:  0.381742000579834
local_output_nid generation:  0.01978302001953125
local_in_edges_tensor generation:  0.021324634552001953
mini_batch_src_global generation:  0.04766535758972168
r_  generation:  0.3875138759613037
local_output_nid generation:  0.019873619079589844
local_in_edges_tensor generation:  0.020989656448364258
mini_batch_src_global generation:  0.04667043685913086
r_  generation:  0.3757972717285156
----------------------check_connections_block total spend ----------------------------- 4.364783525466919
generate_one_block  0.4781169891357422
generate_one_block  0.4914674758911133
generate_one_block  0.49510788917541504
generate_one_block  0.4880340099334717
generate_one_block  0.49555373191833496
generate_one_block  0.4894082546234131
generate_one_block  0.5018963813781738
generate_one_block  0.5100443363189697
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.037450313568115234
gen group dst list time:  0.03755617141723633
time for parepare:  0.018987178802490234
local_output_nid generation:  0.03016495704650879
local_in_edges_tensor generation:  0.041059255599975586
mini_batch_src_global generation:  0.05153059959411621
r_  generation:  0.5441267490386963
local_output_nid generation:  0.03639960289001465
local_in_edges_tensor generation:  0.038660287857055664
mini_batch_src_global generation:  0.06631708145141602
r_  generation:  0.5516011714935303
local_output_nid generation:  0.03649473190307617
local_in_edges_tensor generation:  0.0389561653137207
mini_batch_src_global generation:  0.06164073944091797
r_  generation:  0.5574362277984619
local_output_nid generation:  0.03601503372192383
local_in_edges_tensor generation:  0.03836464881896973
mini_batch_src_global generation:  0.06120109558105469
r_  generation:  0.5592703819274902
local_output_nid generation:  0.036148786544799805
local_in_edges_tensor generation:  0.03893756866455078
mini_batch_src_global generation:  0.0624542236328125
r_  generation:  0.5695111751556396
local_output_nid generation:  0.03608369827270508
local_in_edges_tensor generation:  0.0439910888671875
mini_batch_src_global generation:  0.0628046989440918
r_  generation:  0.5647430419921875
local_output_nid generation:  0.03627943992614746
local_in_edges_tensor generation:  0.03884458541870117
mini_batch_src_global generation:  0.06358599662780762
r_  generation:  0.5735855102539062
local_output_nid generation:  0.036446571350097656
local_in_edges_tensor generation:  0.03716635704040527
mini_batch_src_global generation:  0.06629657745361328
r_  generation:  0.5703372955322266
----------------------check_connections_block total spend ----------------------------- 6.594794988632202
generate_one_block  0.7018508911132812
generate_one_block  0.7134139537811279
generate_one_block  0.7061669826507568
generate_one_block  0.7030930519104004
generate_one_block  0.706636905670166
generate_one_block  0.7026855945587158
generate_one_block  0.69903564453125
generate_one_block  0.6969907283782959
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14136600494384766  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

connection checking time:  10.959578514099121
block generation total time  9.579502820968628
average batch blocks generation time:  1.1974378526210785
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10632467269897461  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9461269378662109  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10635137557983398  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9547619819641113  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10725212097167969  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9566240310668945  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10585689544677734  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9539794921875  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10696554183959961  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9581670761108398  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10584878921508789  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9547343254089355  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10705375671386719  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.956611156463623  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10568094253540039  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9520320892333984  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08059397339820862 |0.018964767456054688 |0.00344124436378479 |9.134411811828613e-05 |0.0030941665172576904 |0.0015292167663574219 |
----------------------------------------------------------pseudo_mini_loss sum 1.9503958225250244
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  3057710
Number of first layer input nodes during this epoch:  1300730
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14047479629516602  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021791934967041016
random selection method range initialization spend 0.004836559295654297
time for parepare:  0.018955230712890625
local_output_nid generation:  0.004502773284912109
local_in_edges_tensor generation:  0.005683183670043945
mini_batch_src_global generation:  0.0038640499114990234
r_  generation:  0.042818546295166016
local_output_nid generation:  0.005957603454589844
local_in_edges_tensor generation:  0.003318309783935547
mini_batch_src_global generation:  0.004891872406005859
r_  generation:  0.04513692855834961
local_output_nid generation:  0.006114006042480469
local_in_edges_tensor generation:  0.0032863616943359375
mini_batch_src_global generation:  0.003368377685546875
r_  generation:  0.0465695858001709
local_output_nid generation:  0.006144285202026367
local_in_edges_tensor generation:  0.0033388137817382812
mini_batch_src_global generation:  0.0035724639892578125
r_  generation:  0.04811739921569824
local_output_nid generation:  0.006154537200927734
local_in_edges_tensor generation:  0.003343820571899414
mini_batch_src_global generation:  0.0037987232208251953
r_  generation:  0.0484158992767334
local_output_nid generation:  0.0061664581298828125
local_in_edges_tensor generation:  0.0033223628997802734
mini_batch_src_global generation:  0.0039691925048828125
r_  generation:  0.04819226264953613
local_output_nid generation:  0.006142139434814453
local_in_edges_tensor generation:  0.0033745765686035156
mini_batch_src_global generation:  0.0038878917694091797
r_  generation:  0.04865241050720215
local_output_nid generation:  0.0061604976654052734
local_in_edges_tensor generation:  0.0033588409423828125
mini_batch_src_global generation:  0.004097461700439453
r_  generation:  0.0492551326751709
----------------------check_connections_block total spend ----------------------------- 0.592048168182373
generate_one_block  0.059229135513305664
generate_one_block  0.06177949905395508
generate_one_block  0.06131172180175781
generate_one_block  0.0626976490020752
generate_one_block  0.061731815338134766
generate_one_block  0.06119585037231445
generate_one_block  0.06451845169067383
generate_one_block  0.06241488456726074
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.039958953857421875
gen group dst list time:  0.015456199645996094
time for parepare:  0.01919698715209961
local_output_nid generation:  0.014746904373168945
local_in_edges_tensor generation:  0.028485536575317383
mini_batch_src_global generation:  0.036640167236328125
r_  generation:  0.3678152561187744
local_output_nid generation:  0.02380514144897461
local_in_edges_tensor generation:  0.026189088821411133
mini_batch_src_global generation:  0.04732799530029297
r_  generation:  0.37740302085876465
local_output_nid generation:  0.021435022354125977
local_in_edges_tensor generation:  0.02182793617248535
mini_batch_src_global generation:  0.0446469783782959
r_  generation:  0.37786221504211426
local_output_nid generation:  0.02091383934020996
local_in_edges_tensor generation:  0.021001815795898438
mini_batch_src_global generation:  0.045781612396240234
r_  generation:  0.38159823417663574
local_output_nid generation:  0.020386695861816406
local_in_edges_tensor generation:  0.020301103591918945
mini_batch_src_global generation:  0.04578375816345215
r_  generation:  0.38096165657043457
local_output_nid generation:  0.020067214965820312
local_in_edges_tensor generation:  0.02182149887084961
mini_batch_src_global generation:  0.04631185531616211
r_  generation:  0.3820655345916748
local_output_nid generation:  0.019728422164916992
local_in_edges_tensor generation:  0.021466970443725586
mini_batch_src_global generation:  0.04567241668701172
r_  generation:  0.3796393871307373
local_output_nid generation:  0.020364999771118164
local_in_edges_tensor generation:  0.026178836822509766
mini_batch_src_global generation:  0.04870033264160156
r_  generation:  0.3871777057647705
----------------------check_connections_block total spend ----------------------------- 4.392766952514648
generate_one_block  0.48920512199401855
generate_one_block  0.493084192276001
generate_one_block  0.4905223846435547
generate_one_block  0.4876251220703125
generate_one_block  0.4858579635620117
generate_one_block  0.4868631362915039
generate_one_block  0.47940921783447266
generate_one_block  0.5147435665130615
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.034211158752441406
gen group dst list time:  0.03747057914733887
time for parepare:  0.018999814987182617
local_output_nid generation:  0.029677152633666992
local_in_edges_tensor generation:  0.0537106990814209
mini_batch_src_global generation:  0.05257439613342285
r_  generation:  0.5457990169525146
local_output_nid generation:  0.03654170036315918
local_in_edges_tensor generation:  0.046541452407836914
mini_batch_src_global generation:  0.06434774398803711
r_  generation:  0.5554924011230469
local_output_nid generation:  0.0364687442779541
local_in_edges_tensor generation:  0.03455710411071777
mini_batch_src_global generation:  0.06249809265136719
r_  generation:  0.5655441284179688
local_output_nid generation:  0.0360410213470459
local_in_edges_tensor generation:  0.03431057929992676
mini_batch_src_global generation:  0.06138348579406738
r_  generation:  0.565194845199585
local_output_nid generation:  0.036394596099853516
local_in_edges_tensor generation:  0.038492679595947266
mini_batch_src_global generation:  0.06255745887756348
r_  generation:  0.5640735626220703
local_output_nid generation:  0.03635525703430176
local_in_edges_tensor generation:  0.036559104919433594
mini_batch_src_global generation:  0.06511497497558594
r_  generation:  0.5707354545593262
local_output_nid generation:  0.03603625297546387
local_in_edges_tensor generation:  0.035305023193359375
mini_batch_src_global generation:  0.06416440010070801
r_  generation:  0.5662720203399658
local_output_nid generation:  0.03648662567138672
local_in_edges_tensor generation:  0.035574913024902344
mini_batch_src_global generation:  0.06678938865661621
r_  generation:  0.5721027851104736
----------------------check_connections_block total spend ----------------------------- 6.6053972244262695
generate_one_block  0.7011077404022217
generate_one_block  0.7047710418701172
generate_one_block  0.7037162780761719
generate_one_block  0.7014980316162109
generate_one_block  0.7018551826477051
generate_one_block  0.7129654884338379
generate_one_block  0.7045159339904785
generate_one_block  0.7186009883880615
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14047479629516602  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

connection checking time:  10.998164176940918
block generation total time  9.576341390609741
average batch blocks generation time:  1.1970426738262177
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1068415641784668  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9529085159301758  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10678434371948242  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.957190990447998  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10645294189453125  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9537816047668457  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1066431999206543  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.955195426940918  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10642242431640625  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9539399147033691  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10657930374145508  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9539074897766113  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10700368881225586  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.946589469909668  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.106658935546875  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9571495056152344  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08604055643081665 |0.013928472995758057 |0.0035646557807922363 |9.229779243469238e-05 |0.0037752389907836914 |0.002907276153564453 |
----------------------------------------------------------pseudo_mini_loss sum 1.869771122932434
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  3056434
Number of first layer input nodes during this epoch:  1300699
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14145565032958984  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020435571670532227
random selection method range initialization spend 0.005632877349853516
time for parepare:  0.01728057861328125
local_output_nid generation:  0.004509925842285156
local_in_edges_tensor generation:  0.005561351776123047
mini_batch_src_global generation:  0.0038535594940185547
r_  generation:  0.043164968490600586
local_output_nid generation:  0.005978107452392578
local_in_edges_tensor generation:  0.0032961368560791016
mini_batch_src_global generation:  0.004853725433349609
r_  generation:  0.04433012008666992
local_output_nid generation:  0.00608372688293457
local_in_edges_tensor generation:  0.003259420394897461
mini_batch_src_global generation:  0.003542184829711914
r_  generation:  0.04607582092285156
local_output_nid generation:  0.006123065948486328
local_in_edges_tensor generation:  0.0034401416778564453
mini_batch_src_global generation:  0.003533601760864258
r_  generation:  0.04594779014587402
local_output_nid generation:  0.006135702133178711
local_in_edges_tensor generation:  0.003335714340209961
mini_batch_src_global generation:  0.003743410110473633
r_  generation:  0.04720330238342285
local_output_nid generation:  0.006124734878540039
local_in_edges_tensor generation:  0.003321409225463867
mini_batch_src_global generation:  0.003909111022949219
r_  generation:  0.04802346229553223
local_output_nid generation:  0.00608372688293457
local_in_edges_tensor generation:  0.003283262252807617
mini_batch_src_global generation:  0.003988504409790039
r_  generation:  0.04866528511047363
local_output_nid generation:  0.006108999252319336
local_in_edges_tensor generation:  0.003260374069213867
mini_batch_src_global generation:  0.004000186920166016
r_  generation:  0.0486602783203125
----------------------check_connections_block total spend ----------------------------- 0.5850598812103271
generate_one_block  0.06042051315307617
generate_one_block  0.060689687728881836
generate_one_block  0.061681270599365234
generate_one_block  0.060629844665527344
generate_one_block  0.06115126609802246
generate_one_block  0.06173586845397949
generate_one_block  0.06544899940490723
generate_one_block  0.06162738800048828
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03413653373718262
gen group dst list time:  0.015630722045898438
time for parepare:  0.018949031829833984
local_output_nid generation:  0.015027999877929688
local_in_edges_tensor generation:  0.029959917068481445
mini_batch_src_global generation:  0.03712725639343262
r_  generation:  0.3674750328063965
local_output_nid generation:  0.020910024642944336
local_in_edges_tensor generation:  0.030954837799072266
mini_batch_src_global generation:  0.04445910453796387
r_  generation:  0.37050604820251465
local_output_nid generation:  0.020703792572021484
local_in_edges_tensor generation:  0.02251744270324707
mini_batch_src_global generation:  0.04429030418395996
r_  generation:  0.37732982635498047
local_output_nid generation:  0.020342350006103516
local_in_edges_tensor generation:  0.022904634475708008
mini_batch_src_global generation:  0.0445253849029541
r_  generation:  0.3740849494934082
local_output_nid generation:  0.020285606384277344
local_in_edges_tensor generation:  0.02255845069885254
mini_batch_src_global generation:  0.045736074447631836
r_  generation:  0.38053154945373535
local_output_nid generation:  0.0195462703704834
local_in_edges_tensor generation:  0.022295713424682617
mini_batch_src_global generation:  0.04615283012390137
r_  generation:  0.38208723068237305
local_output_nid generation:  0.019636154174804688
local_in_edges_tensor generation:  0.02236175537109375
mini_batch_src_global generation:  0.046170949935913086
r_  generation:  0.38575124740600586
local_output_nid generation:  0.019660472869873047
local_in_edges_tensor generation:  0.02689671516418457
mini_batch_src_global generation:  0.04626321792602539
r_  generation:  0.3862786293029785
----------------------check_connections_block total spend ----------------------------- 4.387361526489258
generate_one_block  0.4938626289367676
generate_one_block  0.4917478561401367
generate_one_block  0.48977017402648926
generate_one_block  0.4812486171722412
generate_one_block  0.4833352565765381
generate_one_block  0.4884505271911621
generate_one_block  0.4913136959075928
generate_one_block  0.5134444236755371
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03557586669921875
gen group dst list time:  0.037810325622558594
time for parepare:  0.019870758056640625
local_output_nid generation:  0.030283212661743164
local_in_edges_tensor generation:  0.04912424087524414
mini_batch_src_global generation:  0.052916765213012695
r_  generation:  0.5491724014282227
local_output_nid generation:  0.03671717643737793
local_in_edges_tensor generation:  0.04229092597961426
mini_batch_src_global generation:  0.06480050086975098
r_  generation:  0.5564711093902588
local_output_nid generation:  0.03626060485839844
local_in_edges_tensor generation:  0.04062247276306152
mini_batch_src_global generation:  0.06234598159790039
r_  generation:  0.5585711002349854
local_output_nid generation:  0.03657865524291992
local_in_edges_tensor generation:  0.03549838066101074
mini_batch_src_global generation:  0.06117868423461914
r_  generation:  0.5631370544433594
local_output_nid generation:  0.03651237487792969
local_in_edges_tensor generation:  0.038507699966430664
mini_batch_src_global generation:  0.06366324424743652
r_  generation:  0.5685586929321289
local_output_nid generation:  0.037010908126831055
local_in_edges_tensor generation:  0.03885030746459961
mini_batch_src_global generation:  0.0627145767211914
r_  generation:  0.5658881664276123
local_output_nid generation:  0.036867618560791016
local_in_edges_tensor generation:  0.03542327880859375
mini_batch_src_global generation:  0.06354594230651855
r_  generation:  0.5750524997711182
local_output_nid generation:  0.03723549842834473
local_in_edges_tensor generation:  0.04187965393066406
mini_batch_src_global generation:  0.06595444679260254
r_  generation:  0.5706777572631836
----------------------check_connections_block total spend ----------------------------- 6.628084897994995
generate_one_block  0.697242259979248
generate_one_block  0.708409309387207
generate_one_block  0.6978600025177002
generate_one_block  0.6960592269897461
generate_one_block  0.7234847545623779
generate_one_block  0.7057733535766602
generate_one_block  0.699777364730835
generate_one_block  0.7080168724060059
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14145565032958984  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

connection checking time:  11.015446424484253
block generation total time  9.569796323776245
average batch blocks generation time:  1.1962245404720306
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10658550262451172  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9582805633544922  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10662221908569336  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9538116455078125  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10717105865478516  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9517230987548828  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10621833801269531  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9482970237731934  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10682010650634766  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.954857349395752  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10654735565185547  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9543728828430176  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10701274871826172  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9543352127075195  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10660314559936523  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9552102088928223  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08562645316123962 |0.017821937799453735 |0.0034689903259277344 |8.800625801086426e-05 |0.0037680864334106445 |0.002695798873901367 |
----------------------------------------------------------pseudo_mini_loss sum 1.7958803176879883
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  3056582
Number of first layer input nodes during this epoch:  1300803
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14136266708374023  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0241549015045166
random selection method range initialization spend 0.004927396774291992
time for parepare:  0.017578601837158203
local_output_nid generation:  0.004523038864135742
local_in_edges_tensor generation:  0.006453037261962891
mini_batch_src_global generation:  0.003761768341064453
r_  generation:  0.04181933403015137
local_output_nid generation:  0.005980253219604492
local_in_edges_tensor generation:  0.0033063888549804688
mini_batch_src_global generation:  0.004889965057373047
r_  generation:  0.044432878494262695
local_output_nid generation:  0.006167411804199219
local_in_edges_tensor generation:  0.0033216476440429688
mini_batch_src_global generation:  0.0035190582275390625
r_  generation:  0.04650473594665527
local_output_nid generation:  0.006186485290527344
local_in_edges_tensor generation:  0.003412961959838867
mini_batch_src_global generation:  0.003663778305053711
r_  generation:  0.04683876037597656
local_output_nid generation:  0.006162881851196289
local_in_edges_tensor generation:  0.003442049026489258
mini_batch_src_global generation:  0.00400853157043457
r_  generation:  0.0482027530670166
local_output_nid generation:  0.006272554397583008
local_in_edges_tensor generation:  0.0034172534942626953
mini_batch_src_global generation:  0.0041120052337646484
r_  generation:  0.047917842864990234
local_output_nid generation:  0.006196260452270508
local_in_edges_tensor generation:  0.0034646987915039062
mini_batch_src_global generation:  0.004224300384521484
r_  generation:  0.04938840866088867
local_output_nid generation:  0.006223440170288086
local_in_edges_tensor generation:  0.0033690929412841797
mini_batch_src_global generation:  0.004221200942993164
r_  generation:  0.048436641693115234
----------------------check_connections_block total spend ----------------------------- 0.59051513671875
generate_one_block  0.062447547912597656
generate_one_block  0.06026935577392578
generate_one_block  0.06222105026245117
generate_one_block  0.06100821495056152
generate_one_block  0.062111854553222656
generate_one_block  0.06103181838989258
generate_one_block  0.06610512733459473
generate_one_block  0.06170821189880371
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04099392890930176
gen group dst list time:  0.015963315963745117
time for parepare:  0.018879413604736328
local_output_nid generation:  0.014674663543701172
local_in_edges_tensor generation:  0.02809596061706543
mini_batch_src_global generation:  0.03644514083862305
r_  generation:  0.3565235137939453
local_output_nid generation:  0.02054452896118164
local_in_edges_tensor generation:  0.022186756134033203
mini_batch_src_global generation:  0.044019222259521484
r_  generation:  0.3676793575286865
local_output_nid generation:  0.020829439163208008
local_in_edges_tensor generation:  0.023206710815429688
mini_batch_src_global generation:  0.044508934020996094
r_  generation:  0.3806321620941162
local_output_nid generation:  0.020667552947998047
local_in_edges_tensor generation:  0.02226543426513672
mini_batch_src_global generation:  0.0577702522277832
r_  generation:  0.3815791606903076
local_output_nid generation:  0.02191901206970215
local_in_edges_tensor generation:  0.022739171981811523
mini_batch_src_global generation:  0.051847219467163086
r_  generation:  0.3859846591949463
local_output_nid generation:  0.02010059356689453
local_in_edges_tensor generation:  0.020441293716430664
mini_batch_src_global generation:  0.046484947204589844
r_  generation:  0.3793375492095947
local_output_nid generation:  0.020150423049926758
local_in_edges_tensor generation:  0.021493196487426758
mini_batch_src_global generation:  0.04618239402770996
r_  generation:  0.38398170471191406
local_output_nid generation:  0.020060062408447266
local_in_edges_tensor generation:  0.023681640625
mini_batch_src_global generation:  0.0462496280670166
r_  generation:  0.3802030086517334
----------------------check_connections_block total spend ----------------------------- 4.3834288120269775
generate_one_block  0.4808530807495117
generate_one_block  0.4838738441467285
generate_one_block  0.4993751049041748
generate_one_block  0.4942195415496826
generate_one_block  0.493959903717041
generate_one_block  0.48655080795288086
generate_one_block  0.49128055572509766
generate_one_block  0.5136213302612305
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04320645332336426
gen group dst list time:  0.03780627250671387
time for parepare:  0.018610477447509766
local_output_nid generation:  0.02979254722595215
local_in_edges_tensor generation:  0.050133705139160156
mini_batch_src_global generation:  0.05126237869262695
r_  generation:  0.5414156913757324
local_output_nid generation:  0.036547183990478516
local_in_edges_tensor generation:  0.041581153869628906
mini_batch_src_global generation:  0.0635833740234375
r_  generation:  0.5494084358215332
local_output_nid generation:  0.036066293716430664
local_in_edges_tensor generation:  0.03917121887207031
mini_batch_src_global generation:  0.06376838684082031
r_  generation:  0.5555849075317383
local_output_nid generation:  0.0364232063293457
local_in_edges_tensor generation:  0.03690004348754883
mini_batch_src_global generation:  0.05993342399597168
r_  generation:  0.5632493495941162
local_output_nid generation:  0.03628182411193848
local_in_edges_tensor generation:  0.03915810585021973
mini_batch_src_global generation:  0.06140446662902832
r_  generation:  0.5663876533508301
local_output_nid generation:  0.036284446716308594
local_in_edges_tensor generation:  0.039380550384521484
mini_batch_src_global generation:  0.0612635612487793
r_  generation:  0.5703089237213135
local_output_nid generation:  0.03622174263000488
local_in_edges_tensor generation:  0.039175987243652344
mini_batch_src_global generation:  0.06224465370178223
r_  generation:  0.5703980922698975
local_output_nid generation:  0.036741018295288086
local_in_edges_tensor generation:  0.039725542068481445
mini_batch_src_global generation:  0.0626840591430664
r_  generation:  0.5746846199035645
----------------------check_connections_block total spend ----------------------------- 6.590828895568848
generate_one_block  0.7045361995697021
generate_one_block  0.7036526203155518
generate_one_block  0.7045211791992188
generate_one_block  0.7077031135559082
generate_one_block  0.7026903629302979
generate_one_block  0.705603837966919
generate_one_block  0.7024755477905273
generate_one_block  0.7096066474914551
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14136266708374023  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

connection checking time:  10.974257707595825
block generation total time  9.584523677825928
average batch blocks generation time:  1.198065459728241
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10675907135009766  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9499778747558594  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10619831085205078  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9532380104064941  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10741424560546875  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9565773010253906  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10596656799316406  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9559450149536133  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1071310043334961  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9572319984436035  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10576629638671875  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9525160789489746  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1069478988647461  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9560189247131348  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10587453842163086  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9540905952453613  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08247658610343933 |0.013747096061706543 |0.0034530460834503174 |9.191036224365234e-05 |0.003180265426635742 |0.0028367042541503906 |
----------------------------------------------------------pseudo_mini_loss sum 1.7080098390579224
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  3058262
Number of first layer input nodes during this epoch:  1301184
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1409921646118164  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020453214645385742
random selection method range initialization spend 0.005197286605834961
time for parepare:  0.016898393630981445
local_output_nid generation:  0.00466609001159668
local_in_edges_tensor generation:  0.005648136138916016
mini_batch_src_global generation:  0.003772735595703125
r_  generation:  0.04283475875854492
local_output_nid generation:  0.006097078323364258
local_in_edges_tensor generation:  0.003337860107421875
mini_batch_src_global generation:  0.005153179168701172
r_  generation:  0.04512476921081543
local_output_nid generation:  0.006177186965942383
local_in_edges_tensor generation:  0.0033447742462158203
mini_batch_src_global generation:  0.003357410430908203
r_  generation:  0.04539775848388672
local_output_nid generation:  0.006207704544067383
local_in_edges_tensor generation:  0.003446817398071289
mini_batch_src_global generation:  0.0036056041717529297
r_  generation:  0.047894954681396484
local_output_nid generation:  0.006204843521118164
local_in_edges_tensor generation:  0.0034608840942382812
mini_batch_src_global generation:  0.003803730010986328
r_  generation:  0.04672384262084961
local_output_nid generation:  0.006216287612915039
local_in_edges_tensor generation:  0.00337982177734375
mini_batch_src_global generation:  0.0038836002349853516
r_  generation:  0.04757094383239746
local_output_nid generation:  0.006207466125488281
local_in_edges_tensor generation:  0.0033483505249023438
mini_batch_src_global generation:  0.0041387081146240234
r_  generation:  0.04888129234313965
local_output_nid generation:  0.00619196891784668
local_in_edges_tensor generation:  0.003407716751098633
mini_batch_src_global generation:  0.0041735172271728516
r_  generation:  0.0486147403717041
----------------------check_connections_block total spend ----------------------------- 0.5875036716461182
generate_one_block  0.05991363525390625
generate_one_block  0.06149649620056152
generate_one_block  0.06096339225769043
generate_one_block  0.0629572868347168
generate_one_block  0.06148672103881836
generate_one_block  0.061188697814941406
generate_one_block  0.06595921516418457
generate_one_block  0.06248044967651367
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030289173126220703
gen group dst list time:  0.015811443328857422
time for parepare:  0.01897287368774414
local_output_nid generation:  0.014890909194946289
local_in_edges_tensor generation:  0.03264212608337402
mini_batch_src_global generation:  0.03655719757080078
r_  generation:  0.3646528720855713
local_output_nid generation:  0.02100968360900879
local_in_edges_tensor generation:  0.03173494338989258
mini_batch_src_global generation:  0.04428911209106445
r_  generation:  0.3714578151702881
local_output_nid generation:  0.020647764205932617
local_in_edges_tensor generation:  0.02285027503967285
mini_batch_src_global generation:  0.04399609565734863
r_  generation:  0.37403130531311035
local_output_nid generation:  0.020753860473632812
local_in_edges_tensor generation:  0.02155780792236328
mini_batch_src_global generation:  0.045595407485961914
r_  generation:  0.3811957836151123
local_output_nid generation:  0.02066636085510254
local_in_edges_tensor generation:  0.02203679084777832
mini_batch_src_global generation:  0.04563260078430176
r_  generation:  0.3860046863555908
local_output_nid generation:  0.019577980041503906
local_in_edges_tensor generation:  0.02683091163635254
mini_batch_src_global generation:  0.04604530334472656
r_  generation:  0.3759019374847412
local_output_nid generation:  0.019692659378051758
local_in_edges_tensor generation:  0.02162003517150879
mini_batch_src_global generation:  0.04638266563415527
r_  generation:  0.3864405155181885
local_output_nid generation:  0.01985621452331543
local_in_edges_tensor generation:  0.02182936668395996
mini_batch_src_global generation:  0.04680204391479492
r_  generation:  0.38213062286376953
----------------------check_connections_block total spend ----------------------------- 4.3874452114105225
generate_one_block  0.48589324951171875
generate_one_block  0.4874875545501709
generate_one_block  0.47922635078430176
generate_one_block  0.4908883571624756
generate_one_block  0.48789429664611816
generate_one_block  0.4866671562194824
generate_one_block  0.493149995803833
generate_one_block  0.5200393199920654
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.032050132751464844
gen group dst list time:  0.037914276123046875
time for parepare:  0.01879596710205078
local_output_nid generation:  0.030553340911865234
local_in_edges_tensor generation:  0.04766845703125
mini_batch_src_global generation:  0.051778316497802734
r_  generation:  0.5476267337799072
local_output_nid generation:  0.035871267318725586
local_in_edges_tensor generation:  0.03812837600708008
mini_batch_src_global generation:  0.06651067733764648
r_  generation:  0.5513463020324707
local_output_nid generation:  0.03604865074157715
local_in_edges_tensor generation:  0.036846160888671875
mini_batch_src_global generation:  0.06089591979980469
r_  generation:  0.5566208362579346
local_output_nid generation:  0.036049842834472656
local_in_edges_tensor generation:  0.03709912300109863
mini_batch_src_global generation:  0.063262939453125
r_  generation:  0.5621397495269775
local_output_nid generation:  0.03627133369445801
local_in_edges_tensor generation:  0.03919792175292969
mini_batch_src_global generation:  0.06441855430603027
r_  generation:  0.563352108001709
local_output_nid generation:  0.035977840423583984
local_in_edges_tensor generation:  0.03932452201843262
mini_batch_src_global generation:  0.061835527420043945
r_  generation:  0.566216230392456
local_output_nid generation:  0.0361478328704834
local_in_edges_tensor generation:  0.03535652160644531
mini_batch_src_global generation:  0.06286072731018066
r_  generation:  0.580655574798584
local_output_nid generation:  0.0359649658203125
local_in_edges_tensor generation:  0.03925800323486328
mini_batch_src_global generation:  0.06289076805114746
r_  generation:  0.5742127895355225
----------------------check_connections_block total spend ----------------------------- 6.5943076610565186
generate_one_block  0.7028203010559082
generate_one_block  0.7076764106750488
generate_one_block  0.7062423229217529
generate_one_block  0.7104015350341797
generate_one_block  0.717254638671875
generate_one_block  0.7063150405883789
generate_one_block  0.7002596855163574
generate_one_block  0.7048583030700684
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1409921646118164  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

connection checking time:  10.981752872467041
block generation total time  9.587074518203735
average batch blocks generation time:  1.198384314775467
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10710906982421875  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9562840461730957  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1062784194946289  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9540061950683594  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10705041885375977  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9489378929138184  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10650110244750977  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9591665267944336  GigaBytes
Max Memory Allocated: 1.1005854606628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10640192031860352  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9546146392822266  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1061849594116211  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9532814025878906  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1073141098022461  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9532809257507324  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1063838005065918  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.954531192779541  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08329153060913086 |0.015652835369110107 |0.0059104859828948975 |8.755922317504883e-05 |0.0037877559661865234 |0.0026721954345703125 |
----------------------------------------------------------pseudo_mini_loss sum 1.6300002336502075
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  3057015
Number of first layer input nodes during this epoch:  1300614
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14148759841918945  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023167848587036133
random selection method range initialization spend 0.005001068115234375
time for parepare:  0.017614126205444336
local_output_nid generation:  0.004551887512207031
local_in_edges_tensor generation:  0.008946418762207031
mini_batch_src_global generation:  0.0036759376525878906
r_  generation:  0.0433192253112793
local_output_nid generation:  0.005954742431640625
local_in_edges_tensor generation:  0.0033044815063476562
mini_batch_src_global generation:  0.004941701889038086
r_  generation:  0.045105934143066406
local_output_nid generation:  0.006135702133178711
local_in_edges_tensor generation:  0.0033538341522216797
mini_batch_src_global generation:  0.0034062862396240234
r_  generation:  0.04542851448059082
local_output_nid generation:  0.006093740463256836
local_in_edges_tensor generation:  0.003384113311767578
mini_batch_src_global generation:  0.003425121307373047
r_  generation:  0.04626798629760742
local_output_nid generation:  0.006134033203125
local_in_edges_tensor generation:  0.003301382064819336
mini_batch_src_global generation:  0.003744363784790039
r_  generation:  0.04797983169555664
local_output_nid generation:  0.006205081939697266
local_in_edges_tensor generation:  0.0034401416778564453
mini_batch_src_global generation:  0.0038957595825195312
r_  generation:  0.04873490333557129
local_output_nid generation:  0.006153583526611328
local_in_edges_tensor generation:  0.0036504268646240234
mini_batch_src_global generation:  0.003937721252441406
r_  generation:  0.048157691955566406
local_output_nid generation:  0.006127595901489258
local_in_edges_tensor generation:  0.0035238265991210938
mini_batch_src_global generation:  0.00410771369934082
r_  generation:  0.04902458190917969
----------------------check_connections_block total spend ----------------------------- 0.5925774574279785
generate_one_block  0.0605616569519043
generate_one_block  0.06140398979187012
generate_one_block  0.061279296875
generate_one_block  0.06117677688598633
generate_one_block  0.061742544174194336
generate_one_block  0.061577558517456055
generate_one_block  0.0649571418762207
generate_one_block  0.06255364418029785
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03348588943481445
gen group dst list time:  0.015793323516845703
time for parepare:  0.019225120544433594
local_output_nid generation:  0.01515507698059082
local_in_edges_tensor generation:  0.030889511108398438
mini_batch_src_global generation:  0.03685712814331055
r_  generation:  0.36057496070861816
local_output_nid generation:  0.020971298217773438
local_in_edges_tensor generation:  0.025069713592529297
mini_batch_src_global generation:  0.044934988021850586
r_  generation:  0.37990736961364746
local_output_nid generation:  0.0210418701171875
local_in_edges_tensor generation:  0.020782470703125
mini_batch_src_global generation:  0.04395937919616699
r_  generation:  0.3779592514038086
local_output_nid generation:  0.0206453800201416
local_in_edges_tensor generation:  0.02072310447692871
mini_batch_src_global generation:  0.044751644134521484
r_  generation:  0.37536025047302246
local_output_nid generation:  0.02084183692932129
local_in_edges_tensor generation:  0.020944833755493164
mini_batch_src_global generation:  0.046868085861206055
r_  generation:  0.38475537300109863
local_output_nid generation:  0.01972174644470215
local_in_edges_tensor generation:  0.022252321243286133
mini_batch_src_global generation:  0.04582858085632324
r_  generation:  0.3802027702331543
local_output_nid generation:  0.01964735984802246
local_in_edges_tensor generation:  0.02280879020690918
mini_batch_src_global generation:  0.04634451866149902
r_  generation:  0.3828103542327881
local_output_nid generation:  0.01983165740966797
local_in_edges_tensor generation:  0.024091005325317383
mini_batch_src_global generation:  0.04669380187988281
r_  generation:  0.3856632709503174
----------------------check_connections_block total spend ----------------------------- 4.380789041519165
generate_one_block  0.4970121383666992
generate_one_block  0.49188971519470215
generate_one_block  0.4838237762451172
generate_one_block  0.4845108985900879
generate_one_block  0.4853522777557373
generate_one_block  0.48601508140563965
generate_one_block  0.4850904941558838
generate_one_block  0.5154669284820557
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.035292625427246094
gen group dst list time:  0.03818154335021973
time for parepare:  0.018819808959960938
local_output_nid generation:  0.030179500579833984
local_in_edges_tensor generation:  0.041455984115600586
mini_batch_src_global generation:  0.05466651916503906
r_  generation:  0.5443227291107178
local_output_nid generation:  0.035994768142700195
local_in_edges_tensor generation:  0.047730445861816406
mini_batch_src_global generation:  0.06337761878967285
r_  generation:  0.5507931709289551
local_output_nid generation:  0.03634381294250488
local_in_edges_tensor generation:  0.03923201560974121
mini_batch_src_global generation:  0.06336712837219238
r_  generation:  0.5580911636352539
local_output_nid generation:  0.03802156448364258
local_in_edges_tensor generation:  0.040134429931640625
mini_batch_src_global generation:  0.06025409698486328
r_  generation:  0.5604152679443359
local_output_nid generation:  0.0363926887512207
local_in_edges_tensor generation:  0.037946224212646484
mini_batch_src_global generation:  0.06370162963867188
r_  generation:  0.5796749591827393
local_output_nid generation:  0.037322998046875
local_in_edges_tensor generation:  0.03632473945617676
mini_batch_src_global generation:  0.06282496452331543
r_  generation:  0.5728485584259033
local_output_nid generation:  0.03659796714782715
local_in_edges_tensor generation:  0.03702592849731445
mini_batch_src_global generation:  0.06235504150390625
r_  generation:  0.5692253112792969
local_output_nid generation:  0.036841630935668945
local_in_edges_tensor generation:  0.036290645599365234
mini_batch_src_global generation:  0.06284570693969727
r_  generation:  0.569514274597168
----------------------check_connections_block total spend ----------------------------- 6.606946706771851
generate_one_block  0.7030391693115234
generate_one_block  0.7045409679412842
generate_one_block  0.7021567821502686
generate_one_block  0.706601619720459
generate_one_block  0.7016019821166992
generate_one_block  0.7097563743591309
generate_one_block  0.6963663101196289
generate_one_block  0.7141759395599365
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14148759841918945  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

connection checking time:  10.987735748291016
block generation total time  9.567400455474854
average batch blocks generation time:  1.1959250569343567
block dataloader generation time/epoch 22.57295274734497
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10703849792480469  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9561314582824707  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10588312149047852  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9536142349243164  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1067972183227539  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.954653263092041  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10637140274047852  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9510130882263184  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10728931427001953  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9546470642089844  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10651254653930664  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9546995162963867  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1071009635925293  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9555888175964355  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10633611679077148  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9553394317626953  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0799531638622284 |0.013976037502288818 |0.0034281909465789795 |9.15229320526123e-05 |0.0034147799015045166 |0.0014624595642089844 |
----------------------------------------------------------pseudo_mini_loss sum 1.5913783311843872
Total (block generation + training)time/epoch 23.457704544067383
Training time/epoch 0.8844726085662842
Training time without block to device /epoch 0.7726643085479736
Training time without total dataloading part /epoch 0.05693840980529785
load block tensor time/epoch 0.6396253108978271
block to device time/epoch 0.11180830001831055
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  3057778
Number of first layer input nodes during this epoch:  1300660
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1414322853088379  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021265268325805664
random selection method range initialization spend 0.005219459533691406
time for parepare:  0.017296791076660156
local_output_nid generation:  0.004569292068481445
local_in_edges_tensor generation:  0.00644683837890625
mini_batch_src_global generation:  0.003742218017578125
r_  generation:  0.04252505302429199
local_output_nid generation:  0.005957126617431641
local_in_edges_tensor generation:  0.003186464309692383
mini_batch_src_global generation:  0.005060672760009766
r_  generation:  0.04464578628540039
local_output_nid generation:  0.006121158599853516
local_in_edges_tensor generation:  0.003224611282348633
mini_batch_src_global generation:  0.0034961700439453125
r_  generation:  0.04568219184875488
local_output_nid generation:  0.00616908073425293
local_in_edges_tensor generation:  0.0035376548767089844
mini_batch_src_global generation:  0.003579378128051758
r_  generation:  0.04618549346923828
local_output_nid generation:  0.006174802780151367
local_in_edges_tensor generation:  0.003348112106323242
mini_batch_src_global generation:  0.004012346267700195
r_  generation:  0.047641754150390625
local_output_nid generation:  0.006136178970336914
local_in_edges_tensor generation:  0.003408670425415039
mini_batch_src_global generation:  0.004164934158325195
r_  generation:  0.0481870174407959
local_output_nid generation:  0.006784200668334961
local_in_edges_tensor generation:  0.0036046504974365234
mini_batch_src_global generation:  0.004321098327636719
r_  generation:  0.048285484313964844
local_output_nid generation:  0.00613093376159668
local_in_edges_tensor generation:  0.0033190250396728516
mini_batch_src_global generation:  0.0041501522064208984
r_  generation:  0.04914045333862305
----------------------check_connections_block total spend ----------------------------- 0.5909883975982666
generate_one_block  0.059526920318603516
generate_one_block  0.0610048770904541
generate_one_block  0.06005549430847168
generate_one_block  0.060353994369506836
generate_one_block  0.06235074996948242
generate_one_block  0.062265872955322266
generate_one_block  0.06589674949645996
generate_one_block  0.06287169456481934
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03704047203063965
gen group dst list time:  0.015996456146240234
time for parepare:  0.021070003509521484
local_output_nid generation:  0.015337467193603516
local_in_edges_tensor generation:  0.030551910400390625
mini_batch_src_global generation:  0.036939144134521484
r_  generation:  0.36534881591796875
local_output_nid generation:  0.021283864974975586
local_in_edges_tensor generation:  0.02738475799560547
mini_batch_src_global generation:  0.047608137130737305
r_  generation:  0.37373876571655273
local_output_nid generation:  0.020938634872436523
local_in_edges_tensor generation:  0.02209162712097168
mini_batch_src_global generation:  0.04476499557495117
r_  generation:  0.3918740749359131
local_output_nid generation:  0.021187543869018555
local_in_edges_tensor generation:  0.021770477294921875
mini_batch_src_global generation:  0.04738879203796387
r_  generation:  0.3743157386779785
local_output_nid generation:  0.022722244262695312
local_in_edges_tensor generation:  0.022797107696533203
mini_batch_src_global generation:  0.05192446708679199
r_  generation:  0.38471126556396484
local_output_nid generation:  0.02068352699279785
local_in_edges_tensor generation:  0.022670984268188477
mini_batch_src_global generation:  0.048809051513671875
r_  generation:  0.38266682624816895
local_output_nid generation:  0.020452260971069336
local_in_edges_tensor generation:  0.02094864845275879
mini_batch_src_global generation:  0.04677271842956543
r_  generation:  0.3872716426849365
local_output_nid generation:  0.020487070083618164
local_in_edges_tensor generation:  0.02233743667602539
mini_batch_src_global generation:  0.04897642135620117
r_  generation:  0.3861267566680908
----------------------check_connections_block total spend ----------------------------- 4.4291486740112305
generate_one_block  0.48662590980529785
generate_one_block  0.495624303817749
generate_one_block  0.4893221855163574
generate_one_block  0.4818460941314697
generate_one_block  0.4891936779022217
generate_one_block  0.490708589553833
generate_one_block  0.48964691162109375
generate_one_block  0.5217874050140381
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0362851619720459
gen group dst list time:  0.038079261779785156
time for parepare:  0.018897533416748047
local_output_nid generation:  0.030110836029052734
local_in_edges_tensor generation:  0.05165839195251465
mini_batch_src_global generation:  0.05633187294006348
r_  generation:  0.5429162979125977
local_output_nid generation:  0.03690505027770996
local_in_edges_tensor generation:  0.0474085807800293
mini_batch_src_global generation:  0.06587076187133789
r_  generation:  0.5567185878753662
local_output_nid generation:  0.03668975830078125
local_in_edges_tensor generation:  0.04083847999572754
mini_batch_src_global generation:  0.06075000762939453
r_  generation:  0.5600438117980957
local_output_nid generation:  0.036655426025390625
local_in_edges_tensor generation:  0.04372549057006836
mini_batch_src_global generation:  0.06128239631652832
r_  generation:  0.5625615119934082
local_output_nid generation:  0.037604331970214844
local_in_edges_tensor generation:  0.04132890701293945
mini_batch_src_global generation:  0.06119370460510254
r_  generation:  0.5704150199890137
local_output_nid generation:  0.03629660606384277
local_in_edges_tensor generation:  0.04067826271057129
mini_batch_src_global generation:  0.06142473220825195
r_  generation:  0.5662076473236084
local_output_nid generation:  0.0366361141204834
local_in_edges_tensor generation:  0.03774666786193848
mini_batch_src_global generation:  0.06261229515075684
r_  generation:  0.573702335357666
local_output_nid generation:  0.03716754913330078
local_in_edges_tensor generation:  0.0402224063873291
mini_batch_src_global generation:  0.06492066383361816
r_  generation:  0.5728352069854736
----------------------check_connections_block total spend ----------------------------- 6.646727561950684
generate_one_block  0.7095811367034912
generate_one_block  0.6998708248138428
generate_one_block  0.7056875228881836
generate_one_block  0.7064361572265625
generate_one_block  0.7028484344482422
generate_one_block  0.7144067287445068
generate_one_block  0.7093544006347656
generate_one_block  0.708184003829956
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1414322853088379  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

connection checking time:  11.075876235961914
block generation total time  9.601124286651611
average batch blocks generation time:  1.2001405358314514
block dataloader generation time/epoch 22.636807322502136
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10639762878417969  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9541001319885254  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10628032684326172  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9546022415161133  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1067514419555664  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9498004913330078  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10614299774169922  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9506425857543945  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10733652114868164  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9530353546142578  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10674762725830078  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9559812545776367  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10645771026611328  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9545426368713379  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10663127899169922  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9579071998596191  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08204644918441772 |0.017975568771362305 |0.003519415855407715 |9.170174598693848e-05 |0.003495723009109497 |0.0028641223907470703 |
----------------------------------------------------------pseudo_mini_loss sum 1.555410623550415
Total (block generation + training)time/epoch 23.54693067073822
Training time/epoch 0.93520188331604
Training time without block to device /epoch 0.7913973331451416
Training time without total dataloading part /epoch 0.05971884727478027
load block tensor time/epoch 0.6563715934753418
block to device time/epoch 0.14380455017089844
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  3056900
Number of first layer input nodes during this epoch:  1301027
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14177608489990234  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024180889129638672
random selection method range initialization spend 0.004806995391845703
time for parepare:  0.01736760139465332
local_output_nid generation:  0.004645586013793945
local_in_edges_tensor generation:  0.0056629180908203125
mini_batch_src_global generation:  0.0037348270416259766
r_  generation:  0.04203391075134277
local_output_nid generation:  0.0059087276458740234
local_in_edges_tensor generation:  0.003333568572998047
mini_batch_src_global generation:  0.0051081180572509766
r_  generation:  0.04635000228881836
local_output_nid generation:  0.0062732696533203125
local_in_edges_tensor generation:  0.0034410953521728516
mini_batch_src_global generation:  0.0036897659301757812
r_  generation:  0.04556846618652344
local_output_nid generation:  0.006170511245727539
local_in_edges_tensor generation:  0.00328826904296875
mini_batch_src_global generation:  0.0034308433532714844
r_  generation:  0.04654240608215332
local_output_nid generation:  0.0061664581298828125
local_in_edges_tensor generation:  0.003480672836303711
mini_batch_src_global generation:  0.003949880599975586
r_  generation:  0.048146963119506836
local_output_nid generation:  0.006139993667602539
local_in_edges_tensor generation:  0.0033686161041259766
mini_batch_src_global generation:  0.0041046142578125
r_  generation:  0.04842042922973633
local_output_nid generation:  0.006203174591064453
local_in_edges_tensor generation:  0.0033893585205078125
mini_batch_src_global generation:  0.0041828155517578125
r_  generation:  0.04980158805847168
local_output_nid generation:  0.006150245666503906
local_in_edges_tensor generation:  0.0034360885620117188
mini_batch_src_global generation:  0.004126071929931641
r_  generation:  0.04804491996765137
----------------------check_connections_block total spend ----------------------------- 0.5910470485687256
generate_one_block  0.05913233757019043
generate_one_block  0.06179666519165039
generate_one_block  0.060564279556274414
generate_one_block  0.06057572364807129
generate_one_block  0.06224417686462402
generate_one_block  0.06138205528259277
generate_one_block  0.06624746322631836
generate_one_block  0.06157851219177246
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04236888885498047
gen group dst list time:  0.01898980140686035
time for parepare:  0.020748376846313477
local_output_nid generation:  0.015117168426513672
local_in_edges_tensor generation:  0.02761220932006836
mini_batch_src_global generation:  0.03767538070678711
r_  generation:  0.37399983406066895
local_output_nid generation:  0.02317047119140625
local_in_edges_tensor generation:  0.024356365203857422
mini_batch_src_global generation:  0.04804635047912598
r_  generation:  0.375
local_output_nid generation:  0.02193737030029297
local_in_edges_tensor generation:  0.02134990692138672
mini_batch_src_global generation:  0.04431509971618652
r_  generation:  0.37247443199157715
local_output_nid generation:  0.02110910415649414
local_in_edges_tensor generation:  0.02213120460510254
mini_batch_src_global generation:  0.04746437072753906
r_  generation:  0.3751847743988037
local_output_nid generation:  0.021431684494018555
local_in_edges_tensor generation:  0.021231651306152344
mini_batch_src_global generation:  0.04675626754760742
r_  generation:  0.3876621723175049
local_output_nid generation:  0.020394086837768555
local_in_edges_tensor generation:  0.022582054138183594
mini_batch_src_global generation:  0.04700326919555664
r_  generation:  0.3834099769592285
local_output_nid generation:  0.020341873168945312
local_in_edges_tensor generation:  0.02328038215637207
mini_batch_src_global generation:  0.0475459098815918
r_  generation:  0.3833916187286377
local_output_nid generation:  0.020205974578857422
local_in_edges_tensor generation:  0.022486448287963867
mini_batch_src_global generation:  0.04849410057067871
r_  generation:  0.38168907165527344
----------------------check_connections_block total spend ----------------------------- 4.404799222946167
generate_one_block  0.489574670791626
generate_one_block  0.49582934379577637
generate_one_block  0.48644590377807617
generate_one_block  0.4841737747192383
generate_one_block  0.4962611198425293
generate_one_block  0.490081787109375
generate_one_block  0.49008870124816895
generate_one_block  0.5087380409240723
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03659963607788086
gen group dst list time:  0.038402557373046875
time for parepare:  0.01871800422668457
local_output_nid generation:  0.03021979331970215
local_in_edges_tensor generation:  0.04602360725402832
mini_batch_src_global generation:  0.05120038986206055
r_  generation:  0.5435419082641602
local_output_nid generation:  0.03670549392700195
local_in_edges_tensor generation:  0.04334568977355957
mini_batch_src_global generation:  0.06326746940612793
r_  generation:  0.5467913150787354
local_output_nid generation:  0.03671455383300781
local_in_edges_tensor generation:  0.0369718074798584
mini_batch_src_global generation:  0.06328725814819336
r_  generation:  0.5550460815429688
local_output_nid generation:  0.03650689125061035
local_in_edges_tensor generation:  0.03721141815185547
mini_batch_src_global generation:  0.05965900421142578
r_  generation:  0.5594594478607178
local_output_nid generation:  0.03650712966918945
local_in_edges_tensor generation:  0.03724265098571777
mini_batch_src_global generation:  0.06387877464294434
r_  generation:  0.5654654502868652
local_output_nid generation:  0.0363469123840332
local_in_edges_tensor generation:  0.03774881362915039
mini_batch_src_global generation:  0.061936378479003906
r_  generation:  0.5731179714202881
local_output_nid generation:  0.03637075424194336
local_in_edges_tensor generation:  0.037439823150634766
mini_batch_src_global generation:  0.06604814529418945
r_  generation:  0.5694873332977295
local_output_nid generation:  0.03633427619934082
local_in_edges_tensor generation:  0.03432106971740723
mini_batch_src_global generation:  0.06295537948608398
r_  generation:  0.5699520111083984
----------------------check_connections_block total spend ----------------------------- 6.575166463851929
generate_one_block  0.7002172470092773
generate_one_block  0.704411506652832
generate_one_block  0.6995291709899902
generate_one_block  0.7063274383544922
generate_one_block  0.7042102813720703
generate_one_block  0.6988966464996338
generate_one_block  0.7008571624755859
generate_one_block  0.7005386352539062
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14177608489990234  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

connection checking time:  10.979965686798096
block generation total time  9.55618143081665
average batch blocks generation time:  1.1945226788520813
block dataloader generation time/epoch 22.622440020243328
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10631275177001953  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9521632194519043  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10654783248901367  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9583935737609863  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10634756088256836  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9502964019775391  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10613298416137695  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9524931907653809  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10743570327758789  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9573144912719727  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10597801208496094  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9559545516967773  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10715389251708984  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9589242935180664  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10581111907958984  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9538578987121582  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08595573902130127 |0.013873755931854248 |0.003548920154571533 |9.146332740783691e-05 |0.003844320774078369 |0.001316070556640625 |
----------------------------------------------------------pseudo_mini_loss sum 1.5157495737075806
Total (block generation + training)time/epoch 23.539631128311157
Training time/epoch 0.9310863018035889
Training time without block to device /epoch 0.8200962543487549
Training time without total dataloading part /epoch 0.06119370460510254
load block tensor time/epoch 0.6876459121704102
block to device time/epoch 0.11099004745483398
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  3059220
Number of first layer input nodes during this epoch:  1301177
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14074373245239258  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022647380828857422
random selection method range initialization spend 0.0048520565032958984
time for parepare:  0.017011404037475586
local_output_nid generation:  0.0046007633209228516
local_in_edges_tensor generation:  0.005849599838256836
mini_batch_src_global generation:  0.003542661666870117
r_  generation:  0.042089223861694336
local_output_nid generation:  0.0060214996337890625
local_in_edges_tensor generation:  0.003256559371948242
mini_batch_src_global generation:  0.004876375198364258
r_  generation:  0.04381823539733887
local_output_nid generation:  0.006186723709106445
local_in_edges_tensor generation:  0.0033147335052490234
mini_batch_src_global generation:  0.0034525394439697266
r_  generation:  0.04615139961242676
local_output_nid generation:  0.006198883056640625
local_in_edges_tensor generation:  0.003310680389404297
mini_batch_src_global generation:  0.003536224365234375
r_  generation:  0.04709267616271973
local_output_nid generation:  0.0062139034271240234
local_in_edges_tensor generation:  0.0034017562866210938
mini_batch_src_global generation:  0.003869295120239258
r_  generation:  0.04788470268249512
local_output_nid generation:  0.006159067153930664
local_in_edges_tensor generation:  0.0033888816833496094
mini_batch_src_global generation:  0.004019260406494141
r_  generation:  0.04760289192199707
local_output_nid generation:  0.00617671012878418
local_in_edges_tensor generation:  0.0034055709838867188
mini_batch_src_global generation:  0.00419926643371582
r_  generation:  0.04861879348754883
local_output_nid generation:  0.006199836730957031
local_in_edges_tensor generation:  0.0034444332122802734
mini_batch_src_global generation:  0.0040667057037353516
r_  generation:  0.04845762252807617
----------------------check_connections_block total spend ----------------------------- 0.5873148441314697
generate_one_block  0.05948495864868164
generate_one_block  0.0606837272644043
generate_one_block  0.061548471450805664
generate_one_block  0.06197237968444824
generate_one_block  0.06217527389526367
generate_one_block  0.06146526336669922
generate_one_block  0.0659794807434082
generate_one_block  0.06235647201538086
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03046584129333496
gen group dst list time:  0.016083717346191406
time for parepare:  0.019291400909423828
local_output_nid generation:  0.014892816543579102
local_in_edges_tensor generation:  0.027360916137695312
mini_batch_src_global generation:  0.0366663932800293
r_  generation:  0.35663390159606934
local_output_nid generation:  0.02119755744934082
local_in_edges_tensor generation:  0.02366948127746582
mini_batch_src_global generation:  0.04476189613342285
r_  generation:  0.37555766105651855
local_output_nid generation:  0.020949125289916992
local_in_edges_tensor generation:  0.0223081111907959
mini_batch_src_global generation:  0.04406094551086426
r_  generation:  0.3760042190551758
local_output_nid generation:  0.020977258682250977
local_in_edges_tensor generation:  0.022116422653198242
mini_batch_src_global generation:  0.04565906524658203
r_  generation:  0.38131117820739746
local_output_nid generation:  0.021040678024291992
local_in_edges_tensor generation:  0.0207364559173584
mini_batch_src_global generation:  0.04607558250427246
r_  generation:  0.38890743255615234
local_output_nid generation:  0.01980113983154297
local_in_edges_tensor generation:  0.02153611183166504
mini_batch_src_global generation:  0.0467684268951416
r_  generation:  0.3857762813568115
local_output_nid generation:  0.02296614646911621
local_in_edges_tensor generation:  0.02023172378540039
mini_batch_src_global generation:  0.04656863212585449
r_  generation:  0.3907158374786377
local_output_nid generation:  0.020039796829223633
local_in_edges_tensor generation:  0.02126312255859375
mini_batch_src_global generation:  0.04680514335632324
r_  generation:  0.38424062728881836
----------------------check_connections_block total spend ----------------------------- 4.390124559402466
generate_one_block  0.4865078926086426
generate_one_block  0.49521946907043457
generate_one_block  0.49560093879699707
generate_one_block  0.49936389923095703
generate_one_block  0.49614620208740234
generate_one_block  0.49014711380004883
generate_one_block  0.48774218559265137
generate_one_block  0.5098130702972412
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.034917593002319336
gen group dst list time:  0.03844332695007324
time for parepare:  0.01851630210876465
local_output_nid generation:  0.030106067657470703
local_in_edges_tensor generation:  0.04595494270324707
mini_batch_src_global generation:  0.051409006118774414
r_  generation:  0.5409550666809082
local_output_nid generation:  0.03670072555541992
local_in_edges_tensor generation:  0.034299612045288086
mini_batch_src_global generation:  0.06330752372741699
r_  generation:  0.5533382892608643
local_output_nid generation:  0.03746294975280762
local_in_edges_tensor generation:  0.034474849700927734
mini_batch_src_global generation:  0.062178611755371094
r_  generation:  0.5547177791595459
local_output_nid generation:  0.037000417709350586
local_in_edges_tensor generation:  0.03687644004821777
mini_batch_src_global generation:  0.06261706352233887
r_  generation:  0.5596632957458496
local_output_nid generation:  0.03693962097167969
local_in_edges_tensor generation:  0.03549957275390625
mini_batch_src_global generation:  0.06250166893005371
r_  generation:  0.5759000778198242
local_output_nid generation:  0.0369565486907959
local_in_edges_tensor generation:  0.03725147247314453
mini_batch_src_global generation:  0.06394553184509277
r_  generation:  0.5642797946929932
local_output_nid generation:  0.037067413330078125
local_in_edges_tensor generation:  0.036652565002441406
mini_batch_src_global generation:  0.06462693214416504
r_  generation:  0.5680050849914551
local_output_nid generation:  0.03711128234863281
local_in_edges_tensor generation:  0.03956007957458496
mini_batch_src_global generation:  0.06357097625732422
r_  generation:  0.5763726234436035
----------------------check_connections_block total spend ----------------------------- 6.584399938583374
generate_one_block  0.6984536647796631
generate_one_block  0.7107119560241699
generate_one_block  0.7037990093231201
generate_one_block  0.7082560062408447
generate_one_block  0.7087802886962891
generate_one_block  0.7031838893890381
generate_one_block  0.7162055969238281
generate_one_block  0.710712194442749
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14074373245239258  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

connection checking time:  10.97452449798584
block generation total time  9.620643377304077
average batch blocks generation time:  1.2025804221630096
block dataloader generation time/epoch 22.62435245513916
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10675621032714844  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9530296325683594  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10676908493041992  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9549193382263184  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1071481704711914  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.952207088470459  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10634231567382812  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9554104804992676  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10645437240600586  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9562196731567383  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.106201171875  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9516820907592773  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1069040298461914  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9547271728515625  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10648393630981445  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9549217224121094  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0878165066242218 |0.01628434658050537 |0.0034666359424591064 |8.767843246459961e-05 |0.003711789846420288 |0.0012171268463134766 |
----------------------------------------------------------pseudo_mini_loss sum 1.4825291633605957
Total (block generation + training)time/epoch 23.554550647735596
Training time/epoch 0.968977689743042
Training time without block to device /epoch 0.838702917098999
Training time without total dataloading part /epoch 0.05934596061706543
load block tensor time/epoch 0.7025320529937744
block to device time/epoch 0.13027477264404297
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  3057366
Number of first layer input nodes during this epoch:  1301015
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1413583755493164  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02339339256286621
random selection method range initialization spend 0.004960775375366211
time for parepare:  0.01821422576904297
local_output_nid generation:  0.00457763671875
local_in_edges_tensor generation:  0.0061800479888916016
mini_batch_src_global generation:  0.0038542747497558594
r_  generation:  0.04112720489501953
local_output_nid generation:  0.005967617034912109
local_in_edges_tensor generation:  0.003237485885620117
mini_batch_src_global generation:  0.004984140396118164
r_  generation:  0.045058488845825195
local_output_nid generation:  0.0061206817626953125
local_in_edges_tensor generation:  0.0034949779510498047
mini_batch_src_global generation:  0.0034897327423095703
r_  generation:  0.046646833419799805
local_output_nid generation:  0.006181240081787109
local_in_edges_tensor generation:  0.003347158432006836
mini_batch_src_global generation:  0.0035300254821777344
r_  generation:  0.04684185981750488
local_output_nid generation:  0.006127834320068359
local_in_edges_tensor generation:  0.0033872127532958984
mini_batch_src_global generation:  0.0038132667541503906
r_  generation:  0.04741215705871582
local_output_nid generation:  0.006150245666503906
local_in_edges_tensor generation:  0.003340482711791992
mini_batch_src_global generation:  0.00406336784362793
r_  generation:  0.04821205139160156
local_output_nid generation:  0.006116628646850586
local_in_edges_tensor generation:  0.003269195556640625
mini_batch_src_global generation:  0.004233121871948242
r_  generation:  0.04967617988586426
local_output_nid generation:  0.006171703338623047
local_in_edges_tensor generation:  0.0034284591674804688
mini_batch_src_global generation:  0.0042285919189453125
r_  generation:  0.04880523681640625
----------------------check_connections_block total spend ----------------------------- 0.5912175178527832
generate_one_block  0.05786442756652832
generate_one_block  0.06148672103881836
generate_one_block  0.06181979179382324
generate_one_block  0.060553550720214844
generate_one_block  0.060056447982788086
generate_one_block  0.062286376953125
generate_one_block  0.06650519371032715
generate_one_block  0.061827659606933594
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03687906265258789
gen group dst list time:  0.01594686508178711
time for parepare:  0.019443988800048828
local_output_nid generation:  0.014682531356811523
local_in_edges_tensor generation:  0.02975606918334961
mini_batch_src_global generation:  0.03644680976867676
r_  generation:  0.3499939441680908
local_output_nid generation:  0.020983219146728516
local_in_edges_tensor generation:  0.026057004928588867
mini_batch_src_global generation:  0.045298099517822266
r_  generation:  0.3778817653656006
local_output_nid generation:  0.0211179256439209
local_in_edges_tensor generation:  0.02125835418701172
mini_batch_src_global generation:  0.04541420936584473
r_  generation:  0.37987351417541504
local_output_nid generation:  0.020703792572021484
local_in_edges_tensor generation:  0.020631074905395508
mini_batch_src_global generation:  0.04561758041381836
r_  generation:  0.3816409111022949
local_output_nid generation:  0.02077484130859375
local_in_edges_tensor generation:  0.02199411392211914
mini_batch_src_global generation:  0.04589033126831055
r_  generation:  0.37725067138671875
local_output_nid generation:  0.019641876220703125
local_in_edges_tensor generation:  0.02248525619506836
mini_batch_src_global generation:  0.04659581184387207
r_  generation:  0.38257718086242676
local_output_nid generation:  0.019870996475219727
local_in_edges_tensor generation:  0.02259993553161621
mini_batch_src_global generation:  0.04717659950256348
r_  generation:  0.3869974613189697
local_output_nid generation:  0.01975727081298828
local_in_edges_tensor generation:  0.02208232879638672
mini_batch_src_global generation:  0.04666757583618164
r_  generation:  0.38077306747436523
----------------------check_connections_block total spend ----------------------------- 4.371800422668457
generate_one_block  0.48256778717041016
generate_one_block  0.49695444107055664
generate_one_block  0.49184298515319824
generate_one_block  0.4892103672027588
generate_one_block  0.48078322410583496
generate_one_block  0.4900088310241699
generate_one_block  0.4913332462310791
generate_one_block  0.5083804130554199
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.038672685623168945
gen group dst list time:  0.039101362228393555
time for parepare:  0.019481897354125977
local_output_nid generation:  0.030130386352539062
local_in_edges_tensor generation:  0.042058706283569336
mini_batch_src_global generation:  0.051199913024902344
r_  generation:  0.5484683513641357
local_output_nid generation:  0.03643655776977539
local_in_edges_tensor generation:  0.044464111328125
mini_batch_src_global generation:  0.06426095962524414
r_  generation:  0.5558276176452637
local_output_nid generation:  0.03680157661437988
local_in_edges_tensor generation:  0.03735518455505371
mini_batch_src_global generation:  0.062345266342163086
r_  generation:  0.5569047927856445
local_output_nid generation:  0.03662252426147461
local_in_edges_tensor generation:  0.035399436950683594
mini_batch_src_global generation:  0.06067633628845215
r_  generation:  0.5703463554382324
local_output_nid generation:  0.03636908531188965
local_in_edges_tensor generation:  0.03521728515625
mini_batch_src_global generation:  0.061876535415649414
r_  generation:  0.5674583911895752
local_output_nid generation:  0.03653430938720703
local_in_edges_tensor generation:  0.03744673728942871
mini_batch_src_global generation:  0.0648653507232666
r_  generation:  0.5683684349060059
local_output_nid generation:  0.03679680824279785
local_in_edges_tensor generation:  0.03702092170715332
mini_batch_src_global generation:  0.06347107887268066
r_  generation:  0.5734090805053711
local_output_nid generation:  0.036467552185058594
local_in_edges_tensor generation:  0.037909746170043945
mini_batch_src_global generation:  0.06381726264953613
r_  generation:  0.5749638080596924
----------------------check_connections_block total spend ----------------------------- 6.61384391784668
generate_one_block  0.7136890888214111
generate_one_block  0.7114500999450684
generate_one_block  0.7074105739593506
generate_one_block  0.7029416561126709
generate_one_block  0.6987698078155518
generate_one_block  0.7005553245544434
generate_one_block  0.7059674263000488
generate_one_block  0.6993045806884766
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1413583755493164  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

connection checking time:  10.985644340515137
block generation total time  9.57116985321045
average batch blocks generation time:  1.1963962316513062
block dataloader generation time/epoch 22.61666750907898
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.106689453125  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.948826789855957  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10647726058959961  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9572539329528809  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10654211044311523  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9586758613586426  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10675334930419922  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9553146362304688  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10696697235107422  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9504961967468262  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10680246353149414  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9543766975402832  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10731124877929688  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9587969779968262  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10571908950805664  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.952174186706543  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08083167672157288 |0.013510584831237793 |0.0034782588481903076 |9.295344352722168e-05 |0.0031097233295440674 |0.0015521049499511719 |
----------------------------------------------------------pseudo_mini_loss sum 1.4550812244415283
Total (block generation + training)time/epoch 23.538147926330566
Training time/epoch 0.8863089084625244
Training time without block to device /epoch 0.7782242298126221
Training time without total dataloading part /epoch 0.054999589920043945
load block tensor time/epoch 0.646653413772583
block to device time/epoch 0.10808467864990234
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  3058267
Number of first layer input nodes during this epoch:  1301095
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1406245231628418  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019032716751098633
random selection method range initialization spend 0.004941701889038086
time for parepare:  0.017974853515625
local_output_nid generation:  0.0045092105865478516
local_in_edges_tensor generation:  0.005704402923583984
mini_batch_src_global generation:  0.0035505294799804688
r_  generation:  0.04251813888549805
local_output_nid generation:  0.0058972835540771484
local_in_edges_tensor generation:  0.003240346908569336
mini_batch_src_global generation:  0.0050733089447021484
r_  generation:  0.04465222358703613
local_output_nid generation:  0.0060443878173828125
local_in_edges_tensor generation:  0.0033261775970458984
mini_batch_src_global generation:  0.0035262107849121094
r_  generation:  0.04619550704956055
local_output_nid generation:  0.006115913391113281
local_in_edges_tensor generation:  0.003345489501953125
mini_batch_src_global generation:  0.0035309791564941406
r_  generation:  0.04694199562072754
local_output_nid generation:  0.006112337112426758
local_in_edges_tensor generation:  0.003400087356567383
mini_batch_src_global generation:  0.003796815872192383
r_  generation:  0.04828071594238281
local_output_nid generation:  0.006095409393310547
local_in_edges_tensor generation:  0.0033524036407470703
mini_batch_src_global generation:  0.004098176956176758
r_  generation:  0.04916858673095703
local_output_nid generation:  0.0061037540435791016
local_in_edges_tensor generation:  0.0033931732177734375
mini_batch_src_global generation:  0.004147768020629883
r_  generation:  0.04773855209350586
local_output_nid generation:  0.006151914596557617
local_in_edges_tensor generation:  0.003382444381713867
mini_batch_src_global generation:  0.0041005611419677734
r_  generation:  0.048030853271484375
----------------------check_connections_block total spend ----------------------------- 0.5894794464111328
generate_one_block  0.06212806701660156
generate_one_block  0.06132054328918457
generate_one_block  0.06175422668457031
generate_one_block  0.0616307258605957
generate_one_block  0.061654090881347656
generate_one_block  0.06287860870361328
generate_one_block  0.06436443328857422
generate_one_block  0.061873435974121094
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03339695930480957
gen group dst list time:  0.016164064407348633
time for parepare:  0.019924402236938477
local_output_nid generation:  0.015019893646240234
local_in_edges_tensor generation:  0.028630733489990234
mini_batch_src_global generation:  0.03549790382385254
r_  generation:  0.35643577575683594
local_output_nid generation:  0.021101951599121094
local_in_edges_tensor generation:  0.02343130111694336
mini_batch_src_global generation:  0.0465397834777832
r_  generation:  0.37048816680908203
local_output_nid generation:  0.02087259292602539
local_in_edges_tensor generation:  0.02164483070373535
mini_batch_src_global generation:  0.044972896575927734
r_  generation:  0.3807971477508545
local_output_nid generation:  0.020842552185058594
local_in_edges_tensor generation:  0.02109050750732422
mini_batch_src_global generation:  0.045426130294799805
r_  generation:  0.38202643394470215
local_output_nid generation:  0.02105259895324707
local_in_edges_tensor generation:  0.022069692611694336
mini_batch_src_global generation:  0.0464167594909668
r_  generation:  0.3793661594390869
local_output_nid generation:  0.01991128921508789
local_in_edges_tensor generation:  0.02191948890686035
mini_batch_src_global generation:  0.04981684684753418
r_  generation:  0.38629579544067383
local_output_nid generation:  0.019611120223999023
local_in_edges_tensor generation:  0.022230148315429688
mini_batch_src_global generation:  0.04738306999206543
r_  generation:  0.38142943382263184
local_output_nid generation:  0.02001667022705078
local_in_edges_tensor generation:  0.023204326629638672
mini_batch_src_global generation:  0.04674506187438965
r_  generation:  0.3823361396789551
----------------------check_connections_block total spend ----------------------------- 4.378829002380371
generate_one_block  0.4864206314086914
generate_one_block  0.4850735664367676
generate_one_block  0.48845481872558594
generate_one_block  0.4881470203399658
generate_one_block  0.4870586395263672
generate_one_block  0.49952197074890137
generate_one_block  0.4829139709472656
generate_one_block  0.5082986354827881
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03498578071594238
gen group dst list time:  0.03860640525817871
time for parepare:  0.02065134048461914
local_output_nid generation:  0.030971527099609375
local_in_edges_tensor generation:  0.05755949020385742
mini_batch_src_global generation:  0.05257892608642578
r_  generation:  0.545079231262207
local_output_nid generation:  0.036485910415649414
local_in_edges_tensor generation:  0.03570151329040527
mini_batch_src_global generation:  0.06387186050415039
r_  generation:  0.54949951171875
local_output_nid generation:  0.03650403022766113
local_in_edges_tensor generation:  0.03778862953186035
mini_batch_src_global generation:  0.061448097229003906
r_  generation:  0.5576705932617188
local_output_nid generation:  0.03657221794128418
local_in_edges_tensor generation:  0.03793644905090332
mini_batch_src_global generation:  0.06056380271911621
r_  generation:  0.560157299041748
local_output_nid generation:  0.03706550598144531
local_in_edges_tensor generation:  0.03504037857055664
mini_batch_src_global generation:  0.06182289123535156
r_  generation:  0.5636610984802246
local_output_nid generation:  0.03663825988769531
local_in_edges_tensor generation:  0.035691022872924805
mini_batch_src_global generation:  0.061730384826660156
r_  generation:  0.5660340785980225
local_output_nid generation:  0.03915262222290039
local_in_edges_tensor generation:  0.03917121887207031
mini_batch_src_global generation:  0.06329917907714844
r_  generation:  0.5703330039978027
local_output_nid generation:  0.036679744720458984
local_in_edges_tensor generation:  0.03525352478027344
mini_batch_src_global generation:  0.06300711631774902
r_  generation:  0.568108081817627
----------------------check_connections_block total spend ----------------------------- 6.581575870513916
generate_one_block  0.7139008045196533
generate_one_block  0.712212085723877
generate_one_block  0.6968882083892822
generate_one_block  0.7040863037109375
generate_one_block  0.7018804550170898
generate_one_block  0.7097787857055664
generate_one_block  0.7031304836273193
generate_one_block  0.7108719348907471
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1406245231628418  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

connection checking time:  10.960404872894287
block generation total time  9.578638315200806
average batch blocks generation time:  1.1973297894001007
block dataloader generation time/epoch 22.606793244679768
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10683298110961914  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9538068771362305  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10671710968017578  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9540715217590332  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10747051239013672  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9558930397033691  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10588455200195312  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9537949562072754  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10679149627685547  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9539356231689453  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10682010650634766  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9583296775817871  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10642099380493164  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9542222023010254  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10651683807373047  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9533171653747559  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.084331214427948 |0.01669374108314514 |0.003480583429336548 |8.7738037109375e-05 |0.0037838220596313477 |0.0017094612121582031 |
----------------------------------------------------------pseudo_mini_loss sum 1.4247360229492188
Total (block generation + training)time/epoch 23.53183873494466
Training time/epoch 0.9426369667053223
Training time without block to device /epoch 0.8090870380401611
Training time without total dataloading part /epoch 0.06052660942077637
load block tensor time/epoch 0.674649715423584
block to device time/epoch 0.13354992866516113
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  3058196
Number of first layer input nodes during this epoch:  1301109
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14144229888916016  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022171974182128906
random selection method range initialization spend 0.004961252212524414
time for parepare:  0.016912460327148438
local_output_nid generation:  0.004551410675048828
local_in_edges_tensor generation:  0.006579399108886719
mini_batch_src_global generation:  0.0036933422088623047
r_  generation:  0.04355955123901367
local_output_nid generation:  0.005943775177001953
local_in_edges_tensor generation:  0.0036585330963134766
mini_batch_src_global generation:  0.005187034606933594
r_  generation:  0.04469656944274902
local_output_nid generation:  0.006083965301513672
local_in_edges_tensor generation:  0.003627777099609375
mini_batch_src_global generation:  0.0036492347717285156
r_  generation:  0.046320438385009766
local_output_nid generation:  0.006155252456665039
local_in_edges_tensor generation:  0.003602743148803711
mini_batch_src_global generation:  0.003651857376098633
r_  generation:  0.04654383659362793
local_output_nid generation:  0.006170511245727539
local_in_edges_tensor generation:  0.0036520957946777344
mini_batch_src_global generation:  0.004032611846923828
r_  generation:  0.04782390594482422
local_output_nid generation:  0.006144523620605469
local_in_edges_tensor generation:  0.00362396240234375
mini_batch_src_global generation:  0.004506587982177734
r_  generation:  0.04824185371398926
local_output_nid generation:  0.006967782974243164
local_in_edges_tensor generation:  0.003564119338989258
mini_batch_src_global generation:  0.004199028015136719
r_  generation:  0.048834800720214844
local_output_nid generation:  0.006223201751708984
local_in_edges_tensor generation:  0.0036852359771728516
mini_batch_src_global generation:  0.00413060188293457
r_  generation:  0.04883074760437012
----------------------check_connections_block total spend ----------------------------- 0.6183555126190186
generate_one_block  0.0602726936340332
generate_one_block  0.06068277359008789
generate_one_block  0.0618894100189209
generate_one_block  0.06070065498352051
generate_one_block  0.06068277359008789
generate_one_block  0.06253552436828613
generate_one_block  0.06620049476623535
generate_one_block  0.06194472312927246
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03572225570678711
gen group dst list time:  0.015838623046875
time for parepare:  0.019189119338989258
local_output_nid generation:  0.015127182006835938
local_in_edges_tensor generation:  0.03827619552612305
mini_batch_src_global generation:  0.037629127502441406
r_  generation:  0.35941267013549805
local_output_nid generation:  0.020910024642944336
local_in_edges_tensor generation:  0.027399778366088867
mini_batch_src_global generation:  0.04480409622192383
r_  generation:  0.37024855613708496
local_output_nid generation:  0.02068305015563965
local_in_edges_tensor generation:  0.022059202194213867
mini_batch_src_global generation:  0.0465083122253418
r_  generation:  0.37866878509521484
local_output_nid generation:  0.020664215087890625
local_in_edges_tensor generation:  0.020636796951293945
mini_batch_src_global generation:  0.04892110824584961
r_  generation:  0.37495923042297363
local_output_nid generation:  0.020992755889892578
local_in_edges_tensor generation:  0.02162933349609375
mini_batch_src_global generation:  0.046160221099853516
r_  generation:  0.38079047203063965
local_output_nid generation:  0.01968693733215332
local_in_edges_tensor generation:  0.021834135055541992
mini_batch_src_global generation:  0.04681396484375
r_  generation:  0.3779928684234619
local_output_nid generation:  0.019527912139892578
local_in_edges_tensor generation:  0.022356033325195312
mini_batch_src_global generation:  0.04853200912475586
r_  generation:  0.3844618797302246
local_output_nid generation:  0.019532203674316406
local_in_edges_tensor generation:  0.022510528564453125
mini_batch_src_global generation:  0.04696846008300781
r_  generation:  0.3805415630340576
----------------------check_connections_block total spend ----------------------------- 4.382721424102783
generate_one_block  0.49892210960388184
generate_one_block  0.48610639572143555
generate_one_block  0.492398738861084
generate_one_block  0.4835782051086426
generate_one_block  0.4838283061981201
generate_one_block  0.4900968074798584
generate_one_block  0.49620747566223145
generate_one_block  0.5118610858917236
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03612256050109863
gen group dst list time:  0.03867602348327637
time for parepare:  0.019774913787841797
local_output_nid generation:  0.0305938720703125
local_in_edges_tensor generation:  0.04432535171508789
mini_batch_src_global generation:  0.05203866958618164
r_  generation:  0.540661096572876
local_output_nid generation:  0.03934741020202637
local_in_edges_tensor generation:  0.04458975791931152
mini_batch_src_global generation:  0.06400704383850098
r_  generation:  0.5563452243804932
local_output_nid generation:  0.04008984565734863
local_in_edges_tensor generation:  0.040169715881347656
mini_batch_src_global generation:  0.06158852577209473
r_  generation:  0.5599756240844727
local_output_nid generation:  0.039896249771118164
local_in_edges_tensor generation:  0.03389906883239746
mini_batch_src_global generation:  0.06027340888977051
r_  generation:  0.5621254444122314
local_output_nid generation:  0.03927278518676758
local_in_edges_tensor generation:  0.03715944290161133
mini_batch_src_global generation:  0.0617673397064209
r_  generation:  0.566763162612915
local_output_nid generation:  0.039701223373413086
local_in_edges_tensor generation:  0.03620600700378418
mini_batch_src_global generation:  0.06198906898498535
r_  generation:  0.5717616081237793
local_output_nid generation:  0.03978085517883301
local_in_edges_tensor generation:  0.037233829498291016
mini_batch_src_global generation:  0.06600832939147949
r_  generation:  0.5676820278167725
local_output_nid generation:  0.039717674255371094
local_in_edges_tensor generation:  0.03455495834350586
mini_batch_src_global generation:  0.06309747695922852
r_  generation:  0.5713305473327637
----------------------check_connections_block total spend ----------------------------- 6.614034652709961
generate_one_block  0.7018642425537109
generate_one_block  0.7072372436523438
generate_one_block  0.7067856788635254
generate_one_block  0.7020268440246582
generate_one_block  0.7032809257507324
generate_one_block  0.7019691467285156
generate_one_block  0.7092037200927734
generate_one_block  0.7062318325042725
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14144229888916016  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

connection checking time:  10.996756076812744
block generation total time  9.58159875869751
average batch blocks generation time:  1.1976998448371887
block dataloader generation time/epoch 22.612220900399343
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10719871520996094  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9585185050964355  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10586214065551758  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9548587799072266  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10719633102416992  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9587035179138184  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10591316223144531  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.953242301940918  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10715055465698242  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9536714553833008  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10653877258300781  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9524059295654297  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10733604431152344  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9549875259399414  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10659217834472656  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9545331001281738  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08624359965324402 |0.015395313501358032 |0.0035656094551086426 |9.125471115112305e-05 |0.0038520991802215576 |0.0017025470733642578 |
----------------------------------------------------------pseudo_mini_loss sum 1.4010303020477295
Total (block generation + training)time/epoch 23.540920155388967
Training time/epoch 0.9503545761108398
Training time without block to device /epoch 0.8271920680999756
Training time without total dataloading part /epoch 0.061774253845214844
load block tensor time/epoch 0.6899487972259521
block to device time/epoch 0.12316250801086426
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  3058601
Number of first layer input nodes during this epoch:  1301320
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14157629013061523  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023073196411132812
random selection method range initialization spend 0.0053844451904296875
time for parepare:  0.01898026466369629
local_output_nid generation:  0.004441022872924805
local_in_edges_tensor generation:  0.005625486373901367
mini_batch_src_global generation:  0.003603696823120117
r_  generation:  0.042669057846069336
local_output_nid generation:  0.005927085876464844
local_in_edges_tensor generation:  0.0036215782165527344
mini_batch_src_global generation:  0.0050966739654541016
r_  generation:  0.04585146903991699
local_output_nid generation:  0.006136894226074219
local_in_edges_tensor generation:  0.003394603729248047
mini_batch_src_global generation:  0.0036432743072509766
r_  generation:  0.045624494552612305
local_output_nid generation:  0.006116151809692383
local_in_edges_tensor generation:  0.0033750534057617188
mini_batch_src_global generation:  0.0035452842712402344
r_  generation:  0.047295570373535156
local_output_nid generation:  0.006140470504760742
local_in_edges_tensor generation:  0.0033206939697265625
mini_batch_src_global generation:  0.003943920135498047
r_  generation:  0.04811286926269531
local_output_nid generation:  0.006182670593261719
local_in_edges_tensor generation:  0.003383159637451172
mini_batch_src_global generation:  0.004012107849121094
r_  generation:  0.04861283302307129
local_output_nid generation:  0.006146669387817383
local_in_edges_tensor generation:  0.0035734176635742188
mini_batch_src_global generation:  0.004268646240234375
r_  generation:  0.04743051528930664
local_output_nid generation:  0.006186008453369141
local_in_edges_tensor generation:  0.003355264663696289
mini_batch_src_global generation:  0.004122018814086914
r_  generation:  0.0485234260559082
----------------------check_connections_block total spend ----------------------------- 0.5922932624816895
generate_one_block  0.058632850646972656
generate_one_block  0.06175827980041504
generate_one_block  0.06081652641296387
generate_one_block  0.06135201454162598
generate_one_block  0.062108755111694336
generate_one_block  0.0626530647277832
generate_one_block  0.06408333778381348
generate_one_block  0.061713218688964844
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.033333778381347656
gen group dst list time:  0.0158541202545166
time for parepare:  0.019190311431884766
local_output_nid generation:  0.014680862426757812
local_in_edges_tensor generation:  0.028350353240966797
mini_batch_src_global generation:  0.04054832458496094
r_  generation:  0.35291504859924316
local_output_nid generation:  0.021132707595825195
local_in_edges_tensor generation:  0.022286415100097656
mini_batch_src_global generation:  0.045275211334228516
r_  generation:  0.3776724338531494
local_output_nid generation:  0.02164912223815918
local_in_edges_tensor generation:  0.022513628005981445
mini_batch_src_global generation:  0.046150922775268555
r_  generation:  0.37614011764526367
local_output_nid generation:  0.020477294921875
local_in_edges_tensor generation:  0.02069854736328125
mini_batch_src_global generation:  0.04543185234069824
r_  generation:  0.3785133361816406
local_output_nid generation:  0.021156787872314453
local_in_edges_tensor generation:  0.022433042526245117
mini_batch_src_global generation:  0.04654097557067871
r_  generation:  0.38616180419921875
local_output_nid generation:  0.020400285720825195
local_in_edges_tensor generation:  0.020091533660888672
mini_batch_src_global generation:  0.046854257583618164
r_  generation:  0.3893270492553711
local_output_nid generation:  0.01951885223388672
local_in_edges_tensor generation:  0.020685672760009766
mini_batch_src_global generation:  0.04824566841125488
r_  generation:  0.3799881935119629
local_output_nid generation:  0.019697189331054688
local_in_edges_tensor generation:  0.020323514938354492
mini_batch_src_global generation:  0.04711580276489258
r_  generation:  0.38593482971191406
----------------------check_connections_block total spend ----------------------------- 4.3790504932403564
generate_one_block  0.4790036678314209
generate_one_block  0.49492788314819336
generate_one_block  0.4932866096496582
generate_one_block  0.4877650737762451
generate_one_block  0.4994521141052246
generate_one_block  0.4930605888366699
generate_one_block  0.4843270778656006
generate_one_block  0.5219213962554932
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04244828224182129
gen group dst list time:  0.038634300231933594
time for parepare:  0.020334482192993164
local_output_nid generation:  0.03076767921447754
local_in_edges_tensor generation:  0.0555567741394043
mini_batch_src_global generation:  0.0518951416015625
r_  generation:  0.5439624786376953
local_output_nid generation:  0.036838531494140625
local_in_edges_tensor generation:  0.0465545654296875
mini_batch_src_global generation:  0.06411910057067871
r_  generation:  0.5474741458892822
local_output_nid generation:  0.037111520767211914
local_in_edges_tensor generation:  0.04062819480895996
mini_batch_src_global generation:  0.06106305122375488
r_  generation:  0.5614988803863525
local_output_nid generation:  0.0371701717376709
local_in_edges_tensor generation:  0.03747296333312988
mini_batch_src_global generation:  0.059839725494384766
r_  generation:  0.5587818622589111
local_output_nid generation:  0.03759908676147461
local_in_edges_tensor generation:  0.03832387924194336
mini_batch_src_global generation:  0.06142449378967285
r_  generation:  0.5653514862060547
local_output_nid generation:  0.03786349296569824
local_in_edges_tensor generation:  0.04031777381896973
mini_batch_src_global generation:  0.06445550918579102
r_  generation:  0.5640907287597656
local_output_nid generation:  0.03745675086975098
local_in_edges_tensor generation:  0.0367889404296875
mini_batch_src_global generation:  0.0622248649597168
r_  generation:  0.5713284015655518
local_output_nid generation:  0.03753948211669922
local_in_edges_tensor generation:  0.0357823371887207
mini_batch_src_global generation:  0.06425118446350098
r_  generation:  0.5713648796081543
----------------------check_connections_block total spend ----------------------------- 6.6097400188446045
generate_one_block  0.7066893577575684
generate_one_block  0.7019636631011963
generate_one_block  0.7060167789459229
generate_one_block  0.7072169780731201
generate_one_block  0.7050304412841797
generate_one_block  0.7100310325622559
generate_one_block  0.7044689655303955
generate_one_block  0.7061557769775391
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14157629013061523  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

connection checking time:  10.988790512084961
block generation total time  9.601317405700684
average batch blocks generation time:  1.2001646757125854
block dataloader generation time/epoch 22.616138637065887
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10693883895874023  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.950958251953125  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10644960403442383  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9581122398376465  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10632753372192383  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9536337852478027  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10637664794921875  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9536309242248535  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10732555389404297  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9556260108947754  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10630035400390625  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9541482925415039  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10703372955322266  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9508132934570312  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10681962966918945  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9560847282409668  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07989621162414551 |0.014174401760101318 |0.00348857045173645 |9.000301361083984e-05 |0.003667086362838745 |0.002900362014770508 |
----------------------------------------------------------pseudo_mini_loss sum 1.3724591732025146
Total (block generation + training)time/epoch 23.539871871471405
Training time/epoch 0.8886840343475342
Training time without block to device /epoch 0.7752888202667236
Training time without total dataloading part /epoch 0.06086564064025879
load block tensor time/epoch 0.6391696929931641
block to device time/epoch 0.11339521408081055
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  3057380
Number of first layer input nodes during this epoch:  1300960
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14142513275146484  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018995285034179688
random selection method range initialization spend 0.005396366119384766
time for parepare:  0.01756453514099121
local_output_nid generation:  0.00478672981262207
local_in_edges_tensor generation:  0.006026029586791992
mini_batch_src_global generation:  0.003377199172973633
r_  generation:  0.045319557189941406
local_output_nid generation:  0.0060350894927978516
local_in_edges_tensor generation:  0.0033812522888183594
mini_batch_src_global generation:  0.005121707916259766
r_  generation:  0.04506325721740723
local_output_nid generation:  0.006189107894897461
local_in_edges_tensor generation:  0.003430604934692383
mini_batch_src_global generation:  0.003648042678833008
r_  generation:  0.04690957069396973
local_output_nid generation:  0.0062177181243896484
local_in_edges_tensor generation:  0.0034286975860595703
mini_batch_src_global generation:  0.003618478775024414
r_  generation:  0.04702615737915039
local_output_nid generation:  0.0061457157135009766
local_in_edges_tensor generation:  0.003392457962036133
mini_batch_src_global generation:  0.0038328170776367188
r_  generation:  0.04729914665222168
local_output_nid generation:  0.006186962127685547
local_in_edges_tensor generation:  0.0032732486724853516
mini_batch_src_global generation:  0.0040130615234375
r_  generation:  0.049178361892700195
local_output_nid generation:  0.0061337947845458984
local_in_edges_tensor generation:  0.0033903121948242188
mini_batch_src_global generation:  0.004158496856689453
r_  generation:  0.04807281494140625
local_output_nid generation:  0.006159543991088867
local_in_edges_tensor generation:  0.0033447742462158203
mini_batch_src_global generation:  0.004171609878540039
r_  generation:  0.04917788505554199
----------------------check_connections_block total spend ----------------------------- 0.5949838161468506
generate_one_block  0.06058001518249512
generate_one_block  0.06125354766845703
generate_one_block  0.06160449981689453
generate_one_block  0.06104707717895508
generate_one_block  0.06060171127319336
generate_one_block  0.062485456466674805
generate_one_block  0.06531691551208496
generate_one_block  0.06254386901855469
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.036004066467285156
gen group dst list time:  0.015692710876464844
time for parepare:  0.019392013549804688
local_output_nid generation:  0.015028238296508789
local_in_edges_tensor generation:  0.02920246124267578
mini_batch_src_global generation:  0.03850889205932617
r_  generation:  0.3677992820739746
local_output_nid generation:  0.02083420753479004
local_in_edges_tensor generation:  0.02428126335144043
mini_batch_src_global generation:  0.044394493103027344
r_  generation:  0.3679320812225342
local_output_nid generation:  0.020717382431030273
local_in_edges_tensor generation:  0.020893573760986328
mini_batch_src_global generation:  0.04411005973815918
r_  generation:  0.37488317489624023
local_output_nid generation:  0.020486116409301758
local_in_edges_tensor generation:  0.020628690719604492
mini_batch_src_global generation:  0.044928789138793945
r_  generation:  0.3767263889312744
local_output_nid generation:  0.02078723907470703
local_in_edges_tensor generation:  0.021726369857788086
mini_batch_src_global generation:  0.04529166221618652
r_  generation:  0.3802504539489746
local_output_nid generation:  0.02073836326599121
local_in_edges_tensor generation:  0.022433757781982422
mini_batch_src_global generation:  0.046301841735839844
r_  generation:  0.385101318359375
local_output_nid generation:  0.019361257553100586
local_in_edges_tensor generation:  0.020501375198364258
mini_batch_src_global generation:  0.046068429946899414
r_  generation:  0.37757325172424316
local_output_nid generation:  0.01957249641418457
local_in_edges_tensor generation:  0.020542383193969727
mini_batch_src_global generation:  0.04617667198181152
r_  generation:  0.3845651149749756
----------------------check_connections_block total spend ----------------------------- 4.360692977905273
generate_one_block  0.49617767333984375
generate_one_block  0.4845287799835205
generate_one_block  0.48906707763671875
generate_one_block  0.48705291748046875
generate_one_block  0.4817202091217041
generate_one_block  0.4949042797088623
generate_one_block  0.4837327003479004
generate_one_block  0.5195543766021729
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030519962310791016
gen group dst list time:  0.03874850273132324
time for parepare:  0.018670320510864258
local_output_nid generation:  0.030799388885498047
local_in_edges_tensor generation:  0.04303169250488281
mini_batch_src_global generation:  0.050829410552978516
r_  generation:  0.5502557754516602
local_output_nid generation:  0.03685593605041504
local_in_edges_tensor generation:  0.039174795150756836
mini_batch_src_global generation:  0.06618070602416992
r_  generation:  0.5503742694854736
local_output_nid generation:  0.0371854305267334
local_in_edges_tensor generation:  0.03582882881164551
mini_batch_src_global generation:  0.06233930587768555
r_  generation:  0.5620293617248535
local_output_nid generation:  0.036676645278930664
local_in_edges_tensor generation:  0.03667736053466797
mini_batch_src_global generation:  0.06206011772155762
r_  generation:  0.5607409477233887
local_output_nid generation:  0.036744117736816406
local_in_edges_tensor generation:  0.039556026458740234
mini_batch_src_global generation:  0.062387704849243164
r_  generation:  0.5722451210021973
local_output_nid generation:  0.03655219078063965
local_in_edges_tensor generation:  0.035249948501586914
mini_batch_src_global generation:  0.06400799751281738
r_  generation:  0.5702500343322754
local_output_nid generation:  0.036084890365600586
local_in_edges_tensor generation:  0.035291433334350586
mini_batch_src_global generation:  0.06415867805480957
r_  generation:  0.573993444442749
local_output_nid generation:  0.036440372467041016
local_in_edges_tensor generation:  0.0361025333404541
mini_batch_src_global generation:  0.06995630264282227
r_  generation:  0.5719807147979736
----------------------check_connections_block total spend ----------------------------- 6.610474348068237
generate_one_block  0.7006425857543945
generate_one_block  0.7071974277496338
generate_one_block  0.7103085517883301
generate_one_block  0.7056858539581299
generate_one_block  0.7115468978881836
generate_one_block  0.7029924392700195
generate_one_block  0.7012062072753906
generate_one_block  0.7045116424560547
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14142513275146484  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

connection checking time:  10.97116732597351
block generation total time  9.580829620361328
average batch blocks generation time:  1.197603702545166
block dataloader generation time/epoch 22.613521814346313
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10662364959716797  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9656710624694824  GigaBytes
Max Memory Allocated: 1.1011710166931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10614967346191406  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9528541564941406  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10691213607788086  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.956519603729248  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10584592819213867  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9531455039978027  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10704898834228516  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9533090591430664  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10674619674682617  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9566736221313477  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10640954971313477  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.949005126953125  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10632801055908203  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9539265632629395  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07780513167381287 |0.01765817403793335 |0.006260186433792114 |9.003281593322754e-05 |0.0036090314388275146 |0.002966642379760742 |
----------------------------------------------------------pseudo_mini_loss sum 1.3535797595977783
Total (block generation + training)time/epoch 23.536455657747055
Training time/epoch 0.9163129329681396
Training time without block to device /epoch 0.7750475406646729
Training time without total dataloading part /epoch 0.0826406478881836
load block tensor time/epoch 0.6224410533905029
block to device time/epoch 0.1412653923034668
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  3058145
Number of first layer input nodes during this epoch:  1300768
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1415576934814453  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02255725860595703
random selection method range initialization spend 0.004879951477050781
time for parepare:  0.016946792602539062
local_output_nid generation:  0.0045397281646728516
local_in_edges_tensor generation:  0.006119251251220703
mini_batch_src_global generation:  0.0034651756286621094
r_  generation:  0.04303097724914551
local_output_nid generation:  0.005890846252441406
local_in_edges_tensor generation:  0.003422975540161133
mini_batch_src_global generation:  0.0048258304595947266
r_  generation:  0.04427361488342285
local_output_nid generation:  0.006114482879638672
local_in_edges_tensor generation:  0.0033423900604248047
mini_batch_src_global generation:  0.003674745559692383
r_  generation:  0.04698371887207031
local_output_nid generation:  0.006124258041381836
local_in_edges_tensor generation:  0.00337982177734375
mini_batch_src_global generation:  0.0036280155181884766
r_  generation:  0.047348737716674805
local_output_nid generation:  0.006187915802001953
local_in_edges_tensor generation:  0.0033903121948242188
mini_batch_src_global generation:  0.003916740417480469
r_  generation:  0.04769611358642578
local_output_nid generation:  0.006867170333862305
local_in_edges_tensor generation:  0.0033266544342041016
mini_batch_src_global generation:  0.0041408538818359375
r_  generation:  0.04949784278869629
local_output_nid generation:  0.0060749053955078125
local_in_edges_tensor generation:  0.00335693359375
mini_batch_src_global generation:  0.0042688846588134766
r_  generation:  0.04837989807128906
local_output_nid generation:  0.006108760833740234
local_in_edges_tensor generation:  0.0033600330352783203
mini_batch_src_global generation:  0.004146575927734375
r_  generation:  0.04951810836791992
----------------------check_connections_block total spend ----------------------------- 0.5972170829772949
generate_one_block  0.05953192710876465
generate_one_block  0.0615086555480957
generate_one_block  0.06170344352722168
generate_one_block  0.0626375675201416
generate_one_block  0.06040763854980469
generate_one_block  0.06287574768066406
generate_one_block  0.06564593315124512
generate_one_block  0.06281709671020508
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.039018869400024414
gen group dst list time:  0.016882896423339844
time for parepare:  0.019502639770507812
local_output_nid generation:  0.014643192291259766
local_in_edges_tensor generation:  0.03123950958251953
mini_batch_src_global generation:  0.036725759506225586
r_  generation:  0.3548753261566162
local_output_nid generation:  0.020645618438720703
local_in_edges_tensor generation:  0.02436089515686035
mini_batch_src_global generation:  0.04604530334472656
r_  generation:  0.36663079261779785
local_output_nid generation:  0.020821809768676758
local_in_edges_tensor generation:  0.026151657104492188
mini_batch_src_global generation:  0.04437685012817383
r_  generation:  0.37754034996032715
local_output_nid generation:  0.02057623863220215
local_in_edges_tensor generation:  0.02286553382873535
mini_batch_src_global generation:  0.044933319091796875
r_  generation:  0.37958621978759766
local_output_nid generation:  0.020962238311767578
local_in_edges_tensor generation:  0.021187782287597656
mini_batch_src_global generation:  0.04641437530517578
r_  generation:  0.38320350646972656
local_output_nid generation:  0.020556926727294922
local_in_edges_tensor generation:  0.021291017532348633
mini_batch_src_global generation:  0.046768903732299805
r_  generation:  0.39015913009643555
local_output_nid generation:  0.019609928131103516
local_in_edges_tensor generation:  0.022301912307739258
mini_batch_src_global generation:  0.04640626907348633
r_  generation:  0.379763126373291
local_output_nid generation:  0.019755840301513672
local_in_edges_tensor generation:  0.022543907165527344
mini_batch_src_global generation:  0.04859209060668945
r_  generation:  0.38822412490844727
----------------------check_connections_block total spend ----------------------------- 4.381418466567993
generate_one_block  0.4904935359954834
generate_one_block  0.480698823928833
generate_one_block  0.49588632583618164
generate_one_block  0.4968686103820801
generate_one_block  0.48293638229370117
generate_one_block  0.49732327461242676
generate_one_block  0.48087334632873535
generate_one_block  0.523280143737793
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.031908512115478516
gen group dst list time:  0.03918957710266113
time for parepare:  0.0198514461517334
local_output_nid generation:  0.02982616424560547
local_in_edges_tensor generation:  0.0434114933013916
mini_batch_src_global generation:  0.05112123489379883
r_  generation:  0.5465066432952881
local_output_nid generation:  0.036420345306396484
local_in_edges_tensor generation:  0.0427091121673584
mini_batch_src_global generation:  0.06357622146606445
r_  generation:  0.5514092445373535
local_output_nid generation:  0.036190032958984375
local_in_edges_tensor generation:  0.037560462951660156
mini_batch_src_global generation:  0.0635061264038086
r_  generation:  0.5612268447875977
local_output_nid generation:  0.0366053581237793
local_in_edges_tensor generation:  0.04088401794433594
mini_batch_src_global generation:  0.060150146484375
r_  generation:  0.5664300918579102
local_output_nid generation:  0.03658938407897949
local_in_edges_tensor generation:  0.03849434852600098
mini_batch_src_global generation:  0.061930179595947266
r_  generation:  0.5634176731109619
local_output_nid generation:  0.03658938407897949
local_in_edges_tensor generation:  0.03482937812805176
mini_batch_src_global generation:  0.06795215606689453
r_  generation:  0.5730259418487549
local_output_nid generation:  0.03653240203857422
local_in_edges_tensor generation:  0.035436153411865234
mini_batch_src_global generation:  0.062209129333496094
r_  generation:  0.5688309669494629
local_output_nid generation:  0.03644990921020508
local_in_edges_tensor generation:  0.03547310829162598
mini_batch_src_global generation:  0.0632619857788086
r_  generation:  0.5763232707977295
----------------------check_connections_block total spend ----------------------------- 6.6109278202056885
generate_one_block  0.7044229507446289
generate_one_block  0.703139066696167
generate_one_block  0.7095954418182373
generate_one_block  0.7109179496765137
generate_one_block  0.6980020999908447
generate_one_block  0.7086293697357178
generate_one_block  0.7077739238739014
generate_one_block  0.7051389217376709
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1415576934814453  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

connection checking time:  10.992346286773682
block generation total time  9.595980167388916
average batch blocks generation time:  1.1994975209236145
block dataloader generation time/epoch 22.611995387077332
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10696792602539062  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9538435935974121  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10657596588134766  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9543113708496094  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10719442367553711  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9553933143615723  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10649299621582031  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9549756050109863  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10705995559692383  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9529099464416504  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10680341720581055  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9586434364318848  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10639333724975586  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9528975486755371  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10674762725830078  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9559760093688965  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08526045083999634 |0.014003962278366089 |0.003546774387359619 |9.179115295410156e-05 |0.003878980875015259 |0.0013172626495361328 |
----------------------------------------------------------pseudo_mini_loss sum 1.3442018032073975
Total (block generation + training)time/epoch 23.535736274719238
Training time/epoch 0.930762767791748
Training time without block to device /epoch 0.8187310695648193
Training time without total dataloading part /epoch 0.06145763397216797
load block tensor time/epoch 0.6820836067199707
block to device time/epoch 0.11203169822692871
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  3058181
Number of first layer input nodes during this epoch:  1300784
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14165019989013672  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02249312400817871
random selection method range initialization spend 0.005196809768676758
time for parepare:  0.017484664916992188
local_output_nid generation:  0.004567146301269531
local_in_edges_tensor generation:  0.006052255630493164
mini_batch_src_global generation:  0.0033745765686035156
r_  generation:  0.045172929763793945
local_output_nid generation:  0.005973100662231445
local_in_edges_tensor generation:  0.0036933422088623047
mini_batch_src_global generation:  0.005047798156738281
r_  generation:  0.045749664306640625
local_output_nid generation:  0.006105184555053711
local_in_edges_tensor generation:  0.004843950271606445
mini_batch_src_global generation:  0.003977298736572266
r_  generation:  0.04654359817504883
local_output_nid generation:  0.006142854690551758
local_in_edges_tensor generation:  0.0034399032592773438
mini_batch_src_global generation:  0.003765106201171875
r_  generation:  0.04832863807678223
local_output_nid generation:  0.006122589111328125
local_in_edges_tensor generation:  0.0035552978515625
mini_batch_src_global generation:  0.004068613052368164
r_  generation:  0.04790472984313965
local_output_nid generation:  0.006078958511352539
local_in_edges_tensor generation:  0.0033457279205322266
mini_batch_src_global generation:  0.00401616096496582
r_  generation:  0.048091888427734375
local_output_nid generation:  0.00609588623046875
local_in_edges_tensor generation:  0.0034253597259521484
mini_batch_src_global generation:  0.0042645931243896484
r_  generation:  0.04789018630981445
local_output_nid generation:  0.0061376094818115234
local_in_edges_tensor generation:  0.003278493881225586
mini_batch_src_global generation:  0.0040130615234375
r_  generation:  0.04826998710632324
----------------------check_connections_block total spend ----------------------------- 0.6015732288360596
generate_one_block  0.06029701232910156
generate_one_block  0.062361955642700195
generate_one_block  0.061071157455444336
generate_one_block  0.06254887580871582
generate_one_block  0.061597347259521484
generate_one_block  0.062131404876708984
generate_one_block  0.06554603576660156
generate_one_block  0.06210899353027344
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04285168647766113
gen group dst list time:  0.016077280044555664
time for parepare:  0.019215106964111328
local_output_nid generation:  0.015331029891967773
local_in_edges_tensor generation:  0.03293490409851074
mini_batch_src_global generation:  0.03819584846496582
r_  generation:  0.3677558898925781
local_output_nid generation:  0.02205657958984375
local_in_edges_tensor generation:  0.028485774993896484
mini_batch_src_global generation:  0.061211347579956055
r_  generation:  0.380932092666626
local_output_nid generation:  0.022659778594970703
local_in_edges_tensor generation:  0.025437116622924805
mini_batch_src_global generation:  0.04424548149108887
r_  generation:  0.37647581100463867
local_output_nid generation:  0.0214231014251709
local_in_edges_tensor generation:  0.021372079849243164
mini_batch_src_global generation:  0.04926419258117676
r_  generation:  0.38170433044433594
local_output_nid generation:  0.021479368209838867
local_in_edges_tensor generation:  0.024675607681274414
mini_batch_src_global generation:  0.04611992835998535
r_  generation:  0.3796696662902832
local_output_nid generation:  0.02131509780883789
local_in_edges_tensor generation:  0.020966768264770508
mini_batch_src_global generation:  0.04587125778198242
r_  generation:  0.37972426414489746
local_output_nid generation:  0.020430803298950195
local_in_edges_tensor generation:  0.022439241409301758
mini_batch_src_global generation:  0.04816269874572754
r_  generation:  0.3822317123413086
local_output_nid generation:  0.020360469818115234
local_in_edges_tensor generation:  0.02161574363708496
mini_batch_src_global generation:  0.045671939849853516
r_  generation:  0.3784291744232178
----------------------check_connections_block total spend ----------------------------- 4.423370361328125
generate_one_block  0.4944164752960205
generate_one_block  0.49881672859191895
generate_one_block  0.48828959465026855
generate_one_block  0.4928116798400879
generate_one_block  0.48517847061157227
generate_one_block  0.48576855659484863
generate_one_block  0.49071574211120605
generate_one_block  0.509270429611206
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04025459289550781
gen group dst list time:  0.03889918327331543
time for parepare:  0.019217967987060547
local_output_nid generation:  0.030633926391601562
local_in_edges_tensor generation:  0.057296037673950195
mini_batch_src_global generation:  0.054145097732543945
r_  generation:  0.5476500988006592
local_output_nid generation:  0.03646969795227051
local_in_edges_tensor generation:  0.046553850173950195
mini_batch_src_global generation:  0.06384944915771484
r_  generation:  0.5580551624298096
local_output_nid generation:  0.03656005859375
local_in_edges_tensor generation:  0.03851199150085449
mini_batch_src_global generation:  0.06398844718933105
r_  generation:  0.5608243942260742
local_output_nid generation:  0.0366673469543457
local_in_edges_tensor generation:  0.03859353065490723
mini_batch_src_global generation:  0.06038546562194824
r_  generation:  0.5650773048400879
local_output_nid generation:  0.036644935607910156
local_in_edges_tensor generation:  0.03966808319091797
mini_batch_src_global generation:  0.06070137023925781
r_  generation:  0.569350004196167
local_output_nid generation:  0.03660464286804199
local_in_edges_tensor generation:  0.03657650947570801
mini_batch_src_global generation:  0.06172657012939453
r_  generation:  0.5689551830291748
local_output_nid generation:  0.03668093681335449
local_in_edges_tensor generation:  0.041051626205444336
mini_batch_src_global generation:  0.06669735908508301
r_  generation:  0.5759165287017822
local_output_nid generation:  0.03641486167907715
local_in_edges_tensor generation:  0.039517879486083984
mini_batch_src_global generation:  0.062390804290771484
r_  generation:  0.5755617618560791
----------------------check_connections_block total spend ----------------------------- 6.649562120437622
generate_one_block  0.6983211040496826
generate_one_block  0.701176643371582
generate_one_block  0.7049341201782227
generate_one_block  0.7080261707305908
generate_one_block  0.703315019607544
generate_one_block  0.703646183013916
generate_one_block  0.7113502025604248
generate_one_block  0.7023899555206299
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14165019989013672  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

connection checking time:  11.072932481765747
block generation total time  9.578427076339722
average batch blocks generation time:  1.1973033845424652
block dataloader generation time/epoch 22.62028852376071
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10649299621582031  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9565081596374512  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10651731491088867  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9540510177612305  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10683917999267578  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.955014705657959  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10664844512939453  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9564089775085449  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10639381408691406  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9533014297485352  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10656023025512695  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9527702331542969  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10718441009521484  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9559330940246582  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10640954971313477  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9533448219299316  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08093830943107605 |0.013688325881958008 |0.0035102367401123047 |9.375810623168945e-05 |0.0032125115394592285 |0.0016057491302490234 |
----------------------------------------------------------pseudo_mini_loss sum 1.3289172649383545
Total (block generation + training)time/epoch 23.54113927754489
Training time/epoch 0.8916687965393066
Training time without block to device /epoch 0.7821621894836426
Training time without total dataloading part /epoch 0.056137800216674805
load block tensor time/epoch 0.6475064754486084
block to device time/epoch 0.10950660705566406
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 20 |
Number of nodes for computation during this epoch:  3058021
Number of first layer input nodes during this epoch:  1301125
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1413874626159668  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026251554489135742
random selection method range initialization spend 0.0048885345458984375
time for parepare:  0.01831340789794922
local_output_nid generation:  0.004615306854248047
local_in_edges_tensor generation:  0.006443023681640625
mini_batch_src_global generation:  0.0035104751586914062
r_  generation:  0.04429173469543457
local_output_nid generation:  0.005937099456787109
local_in_edges_tensor generation:  0.0034482479095458984
mini_batch_src_global generation:  0.005059719085693359
r_  generation:  0.04561161994934082
local_output_nid generation:  0.0060770511627197266
local_in_edges_tensor generation:  0.0033867359161376953
mini_batch_src_global generation:  0.0036606788635253906
r_  generation:  0.0467679500579834
local_output_nid generation:  0.006134033203125
local_in_edges_tensor generation:  0.0033528804779052734
mini_batch_src_global generation:  0.0036020278930664062
r_  generation:  0.04729175567626953
local_output_nid generation:  0.006163120269775391
local_in_edges_tensor generation:  0.0033566951751708984
mini_batch_src_global generation:  0.004071474075317383
r_  generation:  0.04857349395751953
local_output_nid generation:  0.006154775619506836
local_in_edges_tensor generation:  0.003340005874633789
mini_batch_src_global generation:  0.0042226314544677734
r_  generation:  0.049935102462768555
local_output_nid generation:  0.0061550140380859375
local_in_edges_tensor generation:  0.0033545494079589844
mini_batch_src_global generation:  0.0043087005615234375
r_  generation:  0.049685001373291016
local_output_nid generation:  0.00616455078125
local_in_edges_tensor generation:  0.0033712387084960938
mini_batch_src_global generation:  0.00413203239440918
r_  generation:  0.04789400100708008
----------------------check_connections_block total spend ----------------------------- 0.5988292694091797
generate_one_block  0.05995440483093262
generate_one_block  0.061112403869628906
generate_one_block  0.06055307388305664
generate_one_block  0.060793161392211914
generate_one_block  0.06221365928649902
generate_one_block  0.0625159740447998
generate_one_block  0.06596660614013672
generate_one_block  0.06060671806335449
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03871607780456543
gen group dst list time:  0.015943050384521484
time for parepare:  0.020845651626586914
local_output_nid generation:  0.015468835830688477
local_in_edges_tensor generation:  0.030302047729492188
mini_batch_src_global generation:  0.03836941719055176
r_  generation:  0.3659501075744629
local_output_nid generation:  0.021074771881103516
local_in_edges_tensor generation:  0.02591395378112793
mini_batch_src_global generation:  0.048542022705078125
r_  generation:  0.3739283084869385
local_output_nid generation:  0.021257400512695312
local_in_edges_tensor generation:  0.02041482925415039
mini_batch_src_global generation:  0.0469515323638916
r_  generation:  0.37302064895629883
local_output_nid generation:  0.020963430404663086
local_in_edges_tensor generation:  0.022455453872680664
mini_batch_src_global generation:  0.045532941818237305
r_  generation:  0.3811206817626953
local_output_nid generation:  0.021102428436279297
local_in_edges_tensor generation:  0.023764848709106445
mini_batch_src_global generation:  0.046877384185791016
r_  generation:  0.3816976547241211
local_output_nid generation:  0.020750045776367188
local_in_edges_tensor generation:  0.022261857986450195
mini_batch_src_global generation:  0.04916048049926758
r_  generation:  0.39112281799316406
local_output_nid generation:  0.019880056381225586
local_in_edges_tensor generation:  0.02094292640686035
mini_batch_src_global generation:  0.04744267463684082
r_  generation:  0.3884735107421875
local_output_nid generation:  0.019576549530029297
local_in_edges_tensor generation:  0.022144794464111328
mini_batch_src_global generation:  0.04635262489318848
r_  generation:  0.3826866149902344
----------------------check_connections_block total spend ----------------------------- 4.411916971206665
generate_one_block  0.492722749710083
generate_one_block  0.4946167469024658
generate_one_block  0.4852159023284912
generate_one_block  0.4919140338897705
generate_one_block  0.4905111789703369
generate_one_block  0.49799394607543945
generate_one_block  0.49463415145874023
generate_one_block  0.510023832321167
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03962349891662598
gen group dst list time:  0.039083003997802734
time for parepare:  0.019032716751098633
local_output_nid generation:  0.031699419021606445
local_in_edges_tensor generation:  0.05547595024108887
mini_batch_src_global generation:  0.05286288261413574
r_  generation:  0.5466394424438477
local_output_nid generation:  0.04084515571594238
local_in_edges_tensor generation:  0.047315359115600586
mini_batch_src_global generation:  0.06502413749694824
r_  generation:  0.5513479709625244
local_output_nid generation:  0.040082454681396484
local_in_edges_tensor generation:  0.04164838790893555
mini_batch_src_global generation:  0.06400227546691895
r_  generation:  0.5722110271453857
local_output_nid generation:  0.04144644737243652
local_in_edges_tensor generation:  0.036481618881225586
mini_batch_src_global generation:  0.06647634506225586
r_  generation:  0.564751148223877
local_output_nid generation:  0.04019880294799805
local_in_edges_tensor generation:  0.03696751594543457
mini_batch_src_global generation:  0.06326103210449219
r_  generation:  0.5661153793334961
local_output_nid generation:  0.04004263877868652
local_in_edges_tensor generation:  0.03946399688720703
mini_batch_src_global generation:  0.06551909446716309
r_  generation:  0.5718958377838135
local_output_nid generation:  0.042351484298706055
local_in_edges_tensor generation:  0.0370020866394043
mini_batch_src_global generation:  0.0681905746459961
r_  generation:  0.5718722343444824
local_output_nid generation:  0.04138946533203125
local_in_edges_tensor generation:  0.03613734245300293
mini_batch_src_global generation:  0.0634913444519043
r_  generation:  0.571019172668457
----------------------check_connections_block total spend ----------------------------- 6.69238543510437
generate_one_block  0.7022085189819336
generate_one_block  0.7050273418426514
generate_one_block  0.706336259841919
generate_one_block  0.7123749256134033
generate_one_block  0.7083084583282471
generate_one_block  0.7141704559326172
generate_one_block  0.7018914222717285
generate_one_block  0.7044517993927002
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1413874626159668  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

connection checking time:  11.104302406311035
block generation total time  9.612401723861694
average batch blocks generation time:  1.2015502154827118
block dataloader generation time/epoch 22.63626726468404
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10722112655639648  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9552731513977051  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10637664794921875  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.954371452331543  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10703372955322266  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9587621688842773  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10655641555786133  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9541869163513184  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10718345642089844  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9553227424621582  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10654592514038086  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9591960906982422  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10650777816772461  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9542279243469238  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10609769821166992  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9497804641723633  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08051607012748718 |0.01542520523071289 |0.0034747719764709473 |9.185075759887695e-05 |0.003580033779144287 |0.0012979507446289062 |
----------------------------------------------------------pseudo_mini_loss sum 1.3101527690887451
Total (block generation + training)time/epoch 23.555083970228832
Training time/epoch 0.89620041847229
Training time without block to device /epoch 0.7727987766265869
Training time without total dataloading part /epoch 0.0584712028503418
load block tensor time/epoch 0.6441285610198975
block to device time/epoch 0.12340164184570312
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 21 |
Number of nodes for computation during this epoch:  3058417
Number of first layer input nodes during this epoch:  1300749
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14156436920166016  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019792556762695312
random selection method range initialization spend 0.005076408386230469
time for parepare:  0.018052101135253906
local_output_nid generation:  0.0048482418060302734
local_in_edges_tensor generation:  0.007009029388427734
mini_batch_src_global generation:  0.0034737586975097656
r_  generation:  0.0436553955078125
local_output_nid generation:  0.005967855453491211
local_in_edges_tensor generation:  0.0037963390350341797
mini_batch_src_global generation:  0.00490117073059082
r_  generation:  0.04603123664855957
local_output_nid generation:  0.006061077117919922
local_in_edges_tensor generation:  0.0040171146392822266
mini_batch_src_global generation:  0.0034723281860351562
r_  generation:  0.04598522186279297
local_output_nid generation:  0.006113767623901367
local_in_edges_tensor generation:  0.0038022994995117188
mini_batch_src_global generation:  0.003529071807861328
r_  generation:  0.047388315200805664
local_output_nid generation:  0.006112575531005859
local_in_edges_tensor generation:  0.003743410110473633
mini_batch_src_global generation:  0.003931283950805664
r_  generation:  0.047360897064208984
local_output_nid generation:  0.006096601486206055
local_in_edges_tensor generation:  0.003869295120239258
mini_batch_src_global generation:  0.004065275192260742
r_  generation:  0.04807400703430176
local_output_nid generation:  0.00607752799987793
local_in_edges_tensor generation:  0.003874063491821289
mini_batch_src_global generation:  0.004220485687255859
r_  generation:  0.0478367805480957
local_output_nid generation:  0.0061244964599609375
local_in_edges_tensor generation:  0.003779888153076172
mini_batch_src_global generation:  0.0042266845703125
r_  generation:  0.049217939376831055
----------------------check_connections_block total spend ----------------------------- 0.5966532230377197
generate_one_block  0.059807538986206055
generate_one_block  0.06066393852233887
generate_one_block  0.060385704040527344
generate_one_block  0.060913801193237305
generate_one_block  0.061660051345825195
generate_one_block  0.06104230880737305
generate_one_block  0.06496763229370117
generate_one_block  0.06377625465393066
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03188896179199219
gen group dst list time:  0.01576685905456543
time for parepare:  0.019693374633789062
local_output_nid generation:  0.015264511108398438
local_in_edges_tensor generation:  0.03035116195678711
mini_batch_src_global generation:  0.0377960205078125
r_  generation:  0.35924792289733887
local_output_nid generation:  0.020908355712890625
local_in_edges_tensor generation:  0.029119491577148438
mini_batch_src_global generation:  0.044515132904052734
r_  generation:  0.376021146774292
local_output_nid generation:  0.020518064498901367
local_in_edges_tensor generation:  0.02142786979675293
mini_batch_src_global generation:  0.04433608055114746
r_  generation:  0.3746607303619385
local_output_nid generation:  0.02043461799621582
local_in_edges_tensor generation:  0.021005868911743164
mini_batch_src_global generation:  0.04445838928222656
r_  generation:  0.3780553340911865
local_output_nid generation:  0.021051645278930664
local_in_edges_tensor generation:  0.020316123962402344
mini_batch_src_global generation:  0.04626631736755371
r_  generation:  0.3847823143005371
local_output_nid generation:  0.020400285720825195
local_in_edges_tensor generation:  0.02079319953918457
mini_batch_src_global generation:  0.04578375816345215
r_  generation:  0.38700056076049805
local_output_nid generation:  0.01952385902404785
local_in_edges_tensor generation:  0.020717382431030273
mini_batch_src_global generation:  0.0462191104888916
r_  generation:  0.3856081962585449
local_output_nid generation:  0.019754886627197266
local_in_edges_tensor generation:  0.022551536560058594
mini_batch_src_global generation:  0.04663825035095215
r_  generation:  0.3879971504211426
----------------------check_connections_block total spend ----------------------------- 4.387277841567993
generate_one_block  0.4859747886657715
generate_one_block  0.48958778381347656
generate_one_block  0.4819459915161133
generate_one_block  0.4837918281555176
generate_one_block  0.4882683753967285
generate_one_block  0.4878418445587158
generate_one_block  0.4866795539855957
generate_one_block  0.518470048904419
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029825448989868164
gen group dst list time:  0.03893613815307617
time for parepare:  0.018715620040893555
local_output_nid generation:  0.030347108840942383
local_in_edges_tensor generation:  0.0430450439453125
mini_batch_src_global generation:  0.050748586654663086
r_  generation:  0.5444581508636475
local_output_nid generation:  0.0363004207611084
local_in_edges_tensor generation:  0.04481840133666992
mini_batch_src_global generation:  0.06397223472595215
r_  generation:  0.5490331649780273
local_output_nid generation:  0.03649091720581055
local_in_edges_tensor generation:  0.04145979881286621
mini_batch_src_global generation:  0.06087613105773926
r_  generation:  0.5617620944976807
local_output_nid generation:  0.036602020263671875
local_in_edges_tensor generation:  0.0347132682800293
mini_batch_src_global generation:  0.06162261962890625
r_  generation:  0.5601801872253418
local_output_nid generation:  0.03929948806762695
local_in_edges_tensor generation:  0.04275822639465332
mini_batch_src_global generation:  0.06165504455566406
r_  generation:  0.5691127777099609
local_output_nid generation:  0.03651928901672363
local_in_edges_tensor generation:  0.03484988212585449
mini_batch_src_global generation:  0.062445878982543945
r_  generation:  0.5655004978179932
local_output_nid generation:  0.036290645599365234
local_in_edges_tensor generation:  0.034945011138916016
mini_batch_src_global generation:  0.06260514259338379
r_  generation:  0.5754551887512207
local_output_nid generation:  0.03612923622131348
local_in_edges_tensor generation:  0.04203367233276367
mini_batch_src_global generation:  0.06474471092224121
r_  generation:  0.5699770450592041
----------------------check_connections_block total spend ----------------------------- 6.599711894989014
generate_one_block  0.7017626762390137
generate_one_block  0.7028298377990723
generate_one_block  0.6983704566955566
generate_one_block  0.698559045791626
generate_one_block  0.7100980281829834
generate_one_block  0.6985867023468018
generate_one_block  0.7012293338775635
generate_one_block  0.7053349018096924
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14156436920166016  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

connection checking time:  10.986989736557007
block generation total time  9.539331197738647
average batch blocks generation time:  1.192416399717331
block dataloader generation time/epoch 22.629451733369095
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10736513137817383  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9538912773132324  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10655832290649414  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.954289436340332  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10703325271606445  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9526009559631348  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10658931732177734  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9550056457519531  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10713386535644531  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9541988372802734  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10674095153808594  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9538912773132324  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10712528228759766  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9539098739624023  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10664987564086914  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9557652473449707  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08082199096679688 |0.015615254640579224 |0.0034019947052001953 |8.895993232727051e-05 |0.003689706325531006 |0.0016341209411621094 |
----------------------------------------------------------pseudo_mini_loss sum 1.2930679321289062
Total (block generation + training)time/epoch 23.54749353115375
Training time/epoch 0.9086120128631592
Training time without block to device /epoch 0.7836899757385254
Training time without total dataloading part /epoch 0.05907940864562988
load block tensor time/epoch 0.646575927734375
block to device time/epoch 0.12492203712463379
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 22 |
Number of nodes for computation during this epoch:  3056621
Number of first layer input nodes during this epoch:  1300909
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1414327621459961  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022119998931884766
random selection method range initialization spend 0.0049664974212646484
time for parepare:  0.016707181930541992
local_output_nid generation:  0.0046346187591552734
local_in_edges_tensor generation:  0.0058825016021728516
mini_batch_src_global generation:  0.0036017894744873047
r_  generation:  0.04257345199584961
local_output_nid generation:  0.0059375762939453125
local_in_edges_tensor generation:  0.0033283233642578125
mini_batch_src_global generation:  0.005175590515136719
r_  generation:  0.04583859443664551
local_output_nid generation:  0.006083250045776367
local_in_edges_tensor generation:  0.0034112930297851562
mini_batch_src_global generation:  0.0035758018493652344
r_  generation:  0.045206308364868164
local_output_nid generation:  0.0061473846435546875
local_in_edges_tensor generation:  0.003469228744506836
mini_batch_src_global generation:  0.003504037857055664
r_  generation:  0.04651331901550293
local_output_nid generation:  0.006087064743041992
local_in_edges_tensor generation:  0.0033130645751953125
mini_batch_src_global generation:  0.003957986831665039
r_  generation:  0.0476531982421875
local_output_nid generation:  0.006109952926635742
local_in_edges_tensor generation:  0.0033538341522216797
mini_batch_src_global generation:  0.0040285587310791016
r_  generation:  0.04832029342651367
local_output_nid generation:  0.006125688552856445
local_in_edges_tensor generation:  0.003403186798095703
mini_batch_src_global generation:  0.004140377044677734
r_  generation:  0.04752779006958008
local_output_nid generation:  0.0061757564544677734
local_in_edges_tensor generation:  0.003322124481201172
mini_batch_src_global generation:  0.004204273223876953
r_  generation:  0.04938864707946777
----------------------check_connections_block total spend ----------------------------- 0.5885655879974365
generate_one_block  0.06173276901245117
generate_one_block  0.06245613098144531
generate_one_block  0.06032133102416992
generate_one_block  0.06087946891784668
generate_one_block  0.06181001663208008
generate_one_block  0.06189393997192383
generate_one_block  0.0645606517791748
generate_one_block  0.06252813339233398
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.032774925231933594
gen group dst list time:  0.01564931869506836
time for parepare:  0.01937413215637207
local_output_nid generation:  0.015100955963134766
local_in_edges_tensor generation:  0.03020477294921875
mini_batch_src_global generation:  0.03724503517150879
r_  generation:  0.3600034713745117
local_output_nid generation:  0.021500349044799805
local_in_edges_tensor generation:  0.02360057830810547
mini_batch_src_global generation:  0.045058488845825195
r_  generation:  0.378725528717041
local_output_nid generation:  0.021033048629760742
local_in_edges_tensor generation:  0.02160334587097168
mini_batch_src_global generation:  0.04485511779785156
r_  generation:  0.3766617774963379
local_output_nid generation:  0.0207521915435791
local_in_edges_tensor generation:  0.023089170455932617
mini_batch_src_global generation:  0.04707217216491699
r_  generation:  0.3778815269470215
local_output_nid generation:  0.02107834815979004
local_in_edges_tensor generation:  0.023589611053466797
mini_batch_src_global generation:  0.046239614486694336
r_  generation:  0.38707470893859863
local_output_nid generation:  0.020358800888061523
local_in_edges_tensor generation:  0.023295879364013672
mini_batch_src_global generation:  0.04677271842956543
r_  generation:  0.3809494972229004
local_output_nid generation:  0.019781112670898438
local_in_edges_tensor generation:  0.02158355712890625
mini_batch_src_global generation:  0.04586434364318848
r_  generation:  0.3762385845184326
local_output_nid generation:  0.020314931869506836
local_in_edges_tensor generation:  0.022775650024414062
mini_batch_src_global generation:  0.046878814697265625
r_  generation:  0.38335227966308594
----------------------check_connections_block total spend ----------------------------- 4.386363506317139
generate_one_block  0.48116016387939453
generate_one_block  0.4928104877471924
generate_one_block  0.48156142234802246
generate_one_block  0.4890625476837158
generate_one_block  0.4870438575744629
generate_one_block  0.48630833625793457
generate_one_block  0.4795982837677002
generate_one_block  0.5145463943481445
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03266763687133789
gen group dst list time:  0.038759708404541016
time for parepare:  0.020026445388793945
local_output_nid generation:  0.030076265335083008
local_in_edges_tensor generation:  0.040583133697509766
mini_batch_src_global generation:  0.0555877685546875
r_  generation:  0.5445632934570312
local_output_nid generation:  0.03647112846374512
local_in_edges_tensor generation:  0.04673171043395996
mini_batch_src_global generation:  0.06625580787658691
r_  generation:  0.5685982704162598
local_output_nid generation:  0.03776955604553223
local_in_edges_tensor generation:  0.040741682052612305
mini_batch_src_global generation:  0.06347799301147461
r_  generation:  0.5726840496063232
local_output_nid generation:  0.038266897201538086
local_in_edges_tensor generation:  0.035825490951538086
mini_batch_src_global generation:  0.06253552436828613
r_  generation:  0.563340425491333
local_output_nid generation:  0.0374908447265625
local_in_edges_tensor generation:  0.03479480743408203
mini_batch_src_global generation:  0.06133866310119629
r_  generation:  0.5689923763275146
local_output_nid generation:  0.03754878044128418
local_in_edges_tensor generation:  0.03687620162963867
mini_batch_src_global generation:  0.061481475830078125
r_  generation:  0.5740725994110107
local_output_nid generation:  0.037578582763671875
local_in_edges_tensor generation:  0.03703927993774414
mini_batch_src_global generation:  0.0746309757232666
r_  generation:  0.5716216564178467
local_output_nid generation:  0.037756919860839844
local_in_edges_tensor generation:  0.03442072868347168
mini_batch_src_global generation:  0.06552529335021973
r_  generation:  0.5728738307952881
----------------------check_connections_block total spend ----------------------------- 6.664337635040283
generate_one_block  0.7127020359039307
generate_one_block  0.7027153968811035
generate_one_block  0.7072813510894775
generate_one_block  0.7067034244537354
generate_one_block  0.7047796249389648
generate_one_block  0.7028799057006836
generate_one_block  0.7045176029205322
generate_one_block  0.7095777988433838
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1414327621459961  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

connection checking time:  11.050701141357422
block generation total time  9.563248634338379
average batch blocks generation time:  1.1954060792922974
block dataloader generation time/epoch 22.628922871180944
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10640144348144531  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9523234367370605  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10686206817626953  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9583287239074707  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10642290115356445  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9532413482666016  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10648965835571289  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9540157318115234  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10721397399902344  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.953679084777832  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1062626838684082  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9541645050048828  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10703229904174805  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9528255462646484  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10679292678833008  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9588584899902344  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08062711358070374 |0.01583653688430786 |0.0034795403480529785 |9.122490882873535e-05 |0.0036304593086242676 |0.0013360977172851562 |
----------------------------------------------------------pseudo_mini_loss sum 1.2809216976165771
Total (block generation + training)time/epoch 23.546087333134242
Training time/epoch 0.9054594039916992
Training time without block to device /epoch 0.7787671089172363
Training time without total dataloading part /epoch 0.05894589424133301
load block tensor time/epoch 0.6450169086456299
block to device time/epoch 0.1266922950744629
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 23 |
Number of nodes for computation during this epoch:  3057797
Number of first layer input nodes during this epoch:  1300864
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14150428771972656  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021224021911621094
random selection method range initialization spend 0.004988431930541992
time for parepare:  0.01713705062866211
local_output_nid generation:  0.00460052490234375
local_in_edges_tensor generation:  0.008183002471923828
mini_batch_src_global generation:  0.003515481948852539
r_  generation:  0.044687509536743164
local_output_nid generation:  0.005984306335449219
local_in_edges_tensor generation:  0.003362894058227539
mini_batch_src_global generation:  0.00501561164855957
r_  generation:  0.045630455017089844
local_output_nid generation:  0.006085634231567383
local_in_edges_tensor generation:  0.003348112106323242
mini_batch_src_global generation:  0.0037109851837158203
r_  generation:  0.04654335975646973
local_output_nid generation:  0.0061187744140625
local_in_edges_tensor generation:  0.0034613609313964844
mini_batch_src_global generation:  0.0035479068756103516
r_  generation:  0.046588897705078125
local_output_nid generation:  0.006145000457763672
local_in_edges_tensor generation:  0.003405332565307617
mini_batch_src_global generation:  0.0037941932678222656
r_  generation:  0.04645347595214844
local_output_nid generation:  0.006133079528808594
local_in_edges_tensor generation:  0.0033953189849853516
mini_batch_src_global generation:  0.004030704498291016
r_  generation:  0.0488438606262207
local_output_nid generation:  0.006144285202026367
local_in_edges_tensor generation:  0.0037124156951904297
mini_batch_src_global generation:  0.00420832633972168
r_  generation:  0.0478510856628418
local_output_nid generation:  0.006100177764892578
local_in_edges_tensor generation:  0.0035772323608398438
mini_batch_src_global generation:  0.004110097885131836
r_  generation:  0.048544883728027344
----------------------check_connections_block total spend ----------------------------- 0.5934665203094482
generate_one_block  0.06080770492553711
generate_one_block  0.06219649314880371
generate_one_block  0.0621790885925293
generate_one_block  0.06240701675415039
generate_one_block  0.06103062629699707
generate_one_block  0.0631108283996582
generate_one_block  0.0658102035522461
generate_one_block  0.06310200691223145
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03996109962463379
gen group dst list time:  0.01594066619873047
time for parepare:  0.02207660675048828
local_output_nid generation:  0.015596866607666016
local_in_edges_tensor generation:  0.03477597236633301
mini_batch_src_global generation:  0.038788795471191406
r_  generation:  0.36981987953186035
local_output_nid generation:  0.021167993545532227
local_in_edges_tensor generation:  0.0307466983795166
mini_batch_src_global generation:  0.048309326171875
r_  generation:  0.3726332187652588
local_output_nid generation:  0.020880699157714844
local_in_edges_tensor generation:  0.021620512008666992
mini_batch_src_global generation:  0.04585003852844238
r_  generation:  0.38083553314208984
local_output_nid generation:  0.02070903778076172
local_in_edges_tensor generation:  0.020809650421142578
mini_batch_src_global generation:  0.04492688179016113
r_  generation:  0.37468409538269043
local_output_nid generation:  0.020899534225463867
local_in_edges_tensor generation:  0.021603822708129883
mini_batch_src_global generation:  0.04601573944091797
r_  generation:  0.3848001956939697
local_output_nid generation:  0.020803451538085938
local_in_edges_tensor generation:  0.02578115463256836
mini_batch_src_global generation:  0.04680323600769043
r_  generation:  0.38651371002197266
local_output_nid generation:  0.019562959671020508
local_in_edges_tensor generation:  0.020597457885742188
mini_batch_src_global generation:  0.04688310623168945
r_  generation:  0.38217830657958984
local_output_nid generation:  0.019925355911254883
local_in_edges_tensor generation:  0.02248072624206543
mini_batch_src_global generation:  0.048798322677612305
r_  generation:  0.3822925090789795
----------------------check_connections_block total spend ----------------------------- 4.41453218460083
generate_one_block  0.49340343475341797
generate_one_block  0.4928610324859619
generate_one_block  0.4945247173309326
generate_one_block  0.48297572135925293
generate_one_block  0.48178982734680176
generate_one_block  0.49958229064941406
generate_one_block  0.4903709888458252
generate_one_block  0.5174453258514404
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03707695007324219
gen group dst list time:  0.03900551795959473
time for parepare:  0.018665552139282227
local_output_nid generation:  0.029817819595336914
local_in_edges_tensor generation:  0.053717613220214844
mini_batch_src_global generation:  0.0526275634765625
r_  generation:  0.543137788772583
local_output_nid generation:  0.039043426513671875
local_in_edges_tensor generation:  0.04419994354248047
mini_batch_src_global generation:  0.06595778465270996
r_  generation:  0.5480027198791504
local_output_nid generation:  0.036237239837646484
local_in_edges_tensor generation:  0.04403996467590332
mini_batch_src_global generation:  0.06089186668395996
r_  generation:  0.5576369762420654
local_output_nid generation:  0.03642606735229492
local_in_edges_tensor generation:  0.0358428955078125
mini_batch_src_global generation:  0.06293559074401855
r_  generation:  0.5748717784881592
local_output_nid generation:  0.03783774375915527
local_in_edges_tensor generation:  0.03610825538635254
mini_batch_src_global generation:  0.0672903060913086
r_  generation:  0.5635647773742676
local_output_nid generation:  0.0364995002746582
local_in_edges_tensor generation:  0.03769874572753906
mini_batch_src_global generation:  0.06459522247314453
r_  generation:  0.5668075084686279
local_output_nid generation:  0.036527395248413086
local_in_edges_tensor generation:  0.036180734634399414
mini_batch_src_global generation:  0.06269979476928711
r_  generation:  0.577678918838501
local_output_nid generation:  0.0388946533203125
local_in_edges_tensor generation:  0.03857588768005371
mini_batch_src_global generation:  0.06557559967041016
r_  generation:  0.5666747093200684
----------------------check_connections_block total spend ----------------------------- 6.628297328948975
generate_one_block  0.7011325359344482
generate_one_block  0.7067599296569824
generate_one_block  0.7008459568023682
generate_one_block  0.6988945007324219
generate_one_block  0.7004868984222412
generate_one_block  0.7102475166320801
generate_one_block  0.6997418403625488
generate_one_block  0.7115135192871094
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14150428771972656  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

connection checking time:  11.042829513549805
block generation total time  9.582576036453247
average batch blocks generation time:  1.1978220045566559
block dataloader generation time/epoch 22.632006708780924
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10652923583984375  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9594836235046387  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.106231689453125  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9559621810913086  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10696172714233398  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9561901092529297  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10570001602172852  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9520449638366699  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10682010650634766  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9502921104431152  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10680627822875977  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9541754722595215  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10690498352050781  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9520611763000488  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10643577575683594  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9552001953125  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08138301968574524 |0.01599365472793579 |0.0035310685634613037 |9.119510650634766e-05 |0.0036278069019317627 |0.0017247200012207031 |
----------------------------------------------------------pseudo_mini_loss sum 1.2693228721618652
Total (block generation + training)time/epoch 23.549015776316324
Training time/epoch 0.9145498275756836
Training time without block to device /epoch 0.7866005897521973
Training time without total dataloading part /epoch 0.059725284576416016
load block tensor time/epoch 0.6510641574859619
block to device time/epoch 0.12794923782348633
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 24 |
Number of nodes for computation during this epoch:  3058180
Number of first layer input nodes during this epoch:  1301206
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14169025421142578  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022517919540405273
random selection method range initialization spend 0.004858255386352539
time for parepare:  0.01771092414855957
local_output_nid generation:  0.004517555236816406
local_in_edges_tensor generation:  0.008903980255126953
mini_batch_src_global generation:  0.0035681724548339844
r_  generation:  0.04333901405334473
local_output_nid generation:  0.005961894989013672
local_in_edges_tensor generation:  0.003405332565307617
mini_batch_src_global generation:  0.0051403045654296875
r_  generation:  0.04587554931640625
local_output_nid generation:  0.006116628646850586
local_in_edges_tensor generation:  0.0034406185150146484
mini_batch_src_global generation:  0.003573894500732422
r_  generation:  0.04609966278076172
local_output_nid generation:  0.006109714508056641
local_in_edges_tensor generation:  0.003411531448364258
mini_batch_src_global generation:  0.0036041736602783203
r_  generation:  0.04800224304199219
local_output_nid generation:  0.006136894226074219
local_in_edges_tensor generation:  0.0034956932067871094
mini_batch_src_global generation:  0.0040283203125
r_  generation:  0.04821944236755371
local_output_nid generation:  0.006119489669799805
local_in_edges_tensor generation:  0.003376007080078125
mini_batch_src_global generation:  0.003911495208740234
r_  generation:  0.0482175350189209
local_output_nid generation:  0.0061419010162353516
local_in_edges_tensor generation:  0.003480195999145508
mini_batch_src_global generation:  0.004216670989990234
r_  generation:  0.04861950874328613
local_output_nid generation:  0.0061185359954833984
local_in_edges_tensor generation:  0.003277301788330078
mini_batch_src_global generation:  0.004070758819580078
r_  generation:  0.04921889305114746
----------------------check_connections_block total spend ----------------------------- 0.5975310802459717
generate_one_block  0.05914783477783203
generate_one_block  0.06079864501953125
generate_one_block  0.0610661506652832
generate_one_block  0.062417030334472656
generate_one_block  0.06119704246520996
generate_one_block  0.06130790710449219
generate_one_block  0.06455826759338379
generate_one_block  0.06161022186279297
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03617596626281738
gen group dst list time:  0.01834845542907715
time for parepare:  0.019160032272338867
local_output_nid generation:  0.014723777770996094
local_in_edges_tensor generation:  0.028696775436401367
mini_batch_src_global generation:  0.04040241241455078
r_  generation:  0.36084866523742676
local_output_nid generation:  0.021004438400268555
local_in_edges_tensor generation:  0.030544281005859375
mini_batch_src_global generation:  0.04688000679016113
r_  generation:  0.37508249282836914
local_output_nid generation:  0.02073526382446289
local_in_edges_tensor generation:  0.021162748336791992
mini_batch_src_global generation:  0.04677605628967285
r_  generation:  0.37978053092956543
local_output_nid generation:  0.020798444747924805
local_in_edges_tensor generation:  0.020875215530395508
mini_batch_src_global generation:  0.045495033264160156
r_  generation:  0.38367319107055664
local_output_nid generation:  0.020768404006958008
local_in_edges_tensor generation:  0.021981239318847656
mini_batch_src_global generation:  0.04602479934692383
r_  generation:  0.37766432762145996
local_output_nid generation:  0.020160198211669922
local_in_edges_tensor generation:  0.020951271057128906
mini_batch_src_global generation:  0.04595351219177246
r_  generation:  0.382174015045166
local_output_nid generation:  0.019689321517944336
local_in_edges_tensor generation:  0.02067089080810547
mini_batch_src_global generation:  0.04726862907409668
r_  generation:  0.38298463821411133
local_output_nid generation:  0.01935124397277832
local_in_edges_tensor generation:  0.021254777908325195
mini_batch_src_global generation:  0.04576921463012695
r_  generation:  0.3758065700531006
----------------------check_connections_block total spend ----------------------------- 4.376310348510742
generate_one_block  0.4812774658203125
generate_one_block  0.48654913902282715
generate_one_block  0.48674488067626953
generate_one_block  0.4946417808532715
generate_one_block  0.48664188385009766
generate_one_block  0.48572206497192383
generate_one_block  0.48883605003356934
generate_one_block  0.5135431289672852
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0314183235168457
gen group dst list time:  0.03936624526977539
time for parepare:  0.018734216690063477
local_output_nid generation:  0.029558658599853516
local_in_edges_tensor generation:  0.04303932189941406
mini_batch_src_global generation:  0.051044464111328125
r_  generation:  0.5434820652008057
local_output_nid generation:  0.03615760803222656
local_in_edges_tensor generation:  0.04010319709777832
mini_batch_src_global generation:  0.06583762168884277
r_  generation:  0.5585136413574219
local_output_nid generation:  0.03647279739379883
local_in_edges_tensor generation:  0.0402982234954834
mini_batch_src_global generation:  0.06141018867492676
r_  generation:  0.5599501132965088
local_output_nid generation:  0.03610372543334961
local_in_edges_tensor generation:  0.04390120506286621
mini_batch_src_global generation:  0.060637474060058594
r_  generation:  0.5672948360443115
local_output_nid generation:  0.035962581634521484
local_in_edges_tensor generation:  0.03621721267700195
mini_batch_src_global generation:  0.0613408088684082
r_  generation:  0.5634181499481201
local_output_nid generation:  0.0362548828125
local_in_edges_tensor generation:  0.03658795356750488
mini_batch_src_global generation:  0.06195688247680664
r_  generation:  0.5733542442321777
local_output_nid generation:  0.03651070594787598
local_in_edges_tensor generation:  0.034978389739990234
mini_batch_src_global generation:  0.06544876098632812
r_  generation:  0.5711715221405029
local_output_nid generation:  0.036684513092041016
local_in_edges_tensor generation:  0.03806638717651367
mini_batch_src_global generation:  0.06297492980957031
r_  generation:  0.5852797031402588
----------------------check_connections_block total spend ----------------------------- 6.6199140548706055
generate_one_block  0.7008206844329834
generate_one_block  0.7062320709228516
generate_one_block  0.7073872089385986
generate_one_block  0.7026827335357666
generate_one_block  0.7027528285980225
generate_one_block  0.7080328464508057
generate_one_block  0.7159643173217773
generate_one_block  0.7007594108581543
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14169025421142578  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

connection checking time:  10.996224403381348
block generation total time  9.568588495254517
average batch blocks generation time:  1.1960735619068146
block dataloader generation time/epoch 22.630022808909416
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10692501068115234  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9529047012329102  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10674047470092773  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9547791481018066  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10702228546142578  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9547619819641113  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10677862167358398  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9624910354614258  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10644006729125977  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9511609077453613  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10627317428588867  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9500980377197266  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10712051391601562  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9562692642211914  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10618972778320312  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9535460472106934  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08062687516212463 |0.01733413338661194 |0.0034837722778320312 |8.973479270935059e-05 |0.008707135915756226 |0.0018169879913330078 |
----------------------------------------------------------pseudo_mini_loss sum 1.2579855918884277
Total (block generation + training)time/epoch 23.549404695630074
Training time/epoch 0.9547431468963623
Training time without block to device /epoch 0.8160700798034668
Training time without total dataloading part /epoch 0.10006213188171387
load block tensor time/epoch 0.6450150012969971
block to device time/epoch 0.1386730670928955
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 25 |
Number of nodes for computation during this epoch:  3056799
Number of first layer input nodes during this epoch:  1300965
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14148759841918945  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027518033981323242
random selection method range initialization spend 0.005190610885620117
time for parepare:  0.018628597259521484
local_output_nid generation:  0.004534721374511719
local_in_edges_tensor generation:  0.008453607559204102
mini_batch_src_global generation:  0.004036903381347656
r_  generation:  0.04403209686279297
local_output_nid generation:  0.006030082702636719
local_in_edges_tensor generation:  0.003276824951171875
mini_batch_src_global generation:  0.0051136016845703125
r_  generation:  0.045165300369262695
local_output_nid generation:  0.006114959716796875
local_in_edges_tensor generation:  0.0034933090209960938
mini_batch_src_global generation:  0.0036525726318359375
r_  generation:  0.04677867889404297
local_output_nid generation:  0.006154298782348633
local_in_edges_tensor generation:  0.0033445358276367188
mini_batch_src_global generation:  0.0035805702209472656
r_  generation:  0.04700469970703125
local_output_nid generation:  0.006156206130981445
local_in_edges_tensor generation:  0.003320455551147461
mini_batch_src_global generation:  0.0040171146392822266
r_  generation:  0.04828023910522461
local_output_nid generation:  0.00612640380859375
local_in_edges_tensor generation:  0.0033516883850097656
mini_batch_src_global generation:  0.00409698486328125
r_  generation:  0.048391103744506836
local_output_nid generation:  0.006170988082885742
local_in_edges_tensor generation:  0.003304719924926758
mini_batch_src_global generation:  0.004359722137451172
r_  generation:  0.048113346099853516
local_output_nid generation:  0.006140232086181641
local_in_edges_tensor generation:  0.0033473968505859375
mini_batch_src_global generation:  0.004282951354980469
r_  generation:  0.04839324951171875
----------------------check_connections_block total spend ----------------------------- 0.5977342128753662
generate_one_block  0.059714555740356445
generate_one_block  0.06081795692443848
generate_one_block  0.06126117706298828
generate_one_block  0.06136941909790039
generate_one_block  0.06158709526062012
generate_one_block  0.06184959411621094
generate_one_block  0.06519818305969238
generate_one_block  0.061180830001831055
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.034780263900756836
gen group dst list time:  0.015690088272094727
time for parepare:  0.01924419403076172
local_output_nid generation:  0.014852046966552734
local_in_edges_tensor generation:  0.030923128128051758
mini_batch_src_global generation:  0.03779268264770508
r_  generation:  0.3581197261810303
local_output_nid generation:  0.020960330963134766
local_in_edges_tensor generation:  0.030063152313232422
mini_batch_src_global generation:  0.04462766647338867
r_  generation:  0.36601924896240234
local_output_nid generation:  0.020650148391723633
local_in_edges_tensor generation:  0.022186756134033203
mini_batch_src_global generation:  0.04969525337219238
r_  generation:  0.3781306743621826
local_output_nid generation:  0.02037835121154785
local_in_edges_tensor generation:  0.020930051803588867
mini_batch_src_global generation:  0.04760098457336426
r_  generation:  0.376941442489624
local_output_nid generation:  0.021006107330322266
local_in_edges_tensor generation:  0.02227926254272461
mini_batch_src_global generation:  0.04897880554199219
r_  generation:  0.39060449600219727
local_output_nid generation:  0.02065730094909668
local_in_edges_tensor generation:  0.020566225051879883
mini_batch_src_global generation:  0.04697918891906738
r_  generation:  0.3828005790710449
local_output_nid generation:  0.01989912986755371
local_in_edges_tensor generation:  0.020557165145874023
mini_batch_src_global generation:  0.04945635795593262
r_  generation:  0.38623595237731934
local_output_nid generation:  0.019536972045898438
local_in_edges_tensor generation:  0.020683765411376953
mini_batch_src_global generation:  0.04693484306335449
r_  generation:  0.38371706008911133
----------------------check_connections_block total spend ----------------------------- 4.39427375793457
generate_one_block  0.4916260242462158
generate_one_block  0.4893176555633545
generate_one_block  0.48807644844055176
generate_one_block  0.48954153060913086
generate_one_block  0.49604105949401855
generate_one_block  0.49245667457580566
generate_one_block  0.49248647689819336
generate_one_block  0.5177567005157471
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.034487247467041016
gen group dst list time:  0.03897881507873535
time for parepare:  0.018637895584106445
local_output_nid generation:  0.030064821243286133
local_in_edges_tensor generation:  0.04839181900024414
mini_batch_src_global generation:  0.05137968063354492
r_  generation:  0.5468113422393799
local_output_nid generation:  0.036847591400146484
local_in_edges_tensor generation:  0.040001869201660156
mini_batch_src_global generation:  0.06407594680786133
r_  generation:  0.5628697872161865
local_output_nid generation:  0.03698444366455078
local_in_edges_tensor generation:  0.0389409065246582
mini_batch_src_global generation:  0.06308889389038086
r_  generation:  0.5673000812530518
local_output_nid generation:  0.03660750389099121
local_in_edges_tensor generation:  0.03525185585021973
mini_batch_src_global generation:  0.06094980239868164
r_  generation:  0.5665273666381836
local_output_nid generation:  0.0371091365814209
local_in_edges_tensor generation:  0.03476262092590332
mini_batch_src_global generation:  0.06355762481689453
r_  generation:  0.5795090198516846
local_output_nid generation:  0.037793636322021484
local_in_edges_tensor generation:  0.044130563735961914
mini_batch_src_global generation:  0.06235241889953613
r_  generation:  0.574336051940918
local_output_nid generation:  0.03668642044067383
local_in_edges_tensor generation:  0.03715109825134277
mini_batch_src_global generation:  0.06381964683532715
r_  generation:  0.5818328857421875
local_output_nid generation:  0.037082672119140625
local_in_edges_tensor generation:  0.04116082191467285
mini_batch_src_global generation:  0.06457161903381348
r_  generation:  0.5766799449920654
----------------------check_connections_block total spend ----------------------------- 6.674061059951782
generate_one_block  0.7006351947784424
generate_one_block  0.7037220001220703
generate_one_block  0.7124264240264893
generate_one_block  0.7077736854553223
generate_one_block  0.7092630863189697
generate_one_block  0.7089066505432129
generate_one_block  0.7210919857025146
generate_one_block  0.7078962326049805
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14148759841918945  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

connection checking time:  11.068334817886353
block generation total time  9.62901782989502
average batch blocks generation time:  1.2036272287368774
block dataloader generation time/epoch 22.636709016912125
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10719156265258789  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9484977722167969  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10644006729125977  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9534487724304199  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10717916488647461  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9553413391113281  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10647106170654297  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9524641036987305  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10732316970825195  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9564838409423828  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10593223571777344  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9551620483398438  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10699462890625  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9558606147766113  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10638046264648438  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9525189399719238  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08222109079360962 |0.018538743257522583 |0.003565281629562378 |9.232759475708008e-05 |0.0035788118839263916 |0.0029015541076660156 |
----------------------------------------------------------pseudo_mini_loss sum 1.246077537536621
Total (block generation + training)time/epoch 23.557539014255298
Training time/epoch 0.9438095092773438
Training time without block to device /epoch 0.7954995632171631
Training time without total dataloading part /epoch 0.06079292297363281
load block tensor time/epoch 0.657768726348877
block to device time/epoch 0.14830994606018066
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 26 |
Number of nodes for computation during this epoch:  3055778
Number of first layer input nodes during this epoch:  1300679
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14129924774169922  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03362727165222168
random selection method range initialization spend 0.004918098449707031
time for parepare:  0.017223596572875977
local_output_nid generation:  0.004521846771240234
local_in_edges_tensor generation:  0.006022453308105469
mini_batch_src_global generation:  0.0034911632537841797
r_  generation:  0.04460430145263672
local_output_nid generation:  0.0059702396392822266
local_in_edges_tensor generation:  0.0034477710723876953
mini_batch_src_global generation:  0.005144596099853516
r_  generation:  0.04521822929382324
local_output_nid generation:  0.006100177764892578
local_in_edges_tensor generation:  0.003735780715942383
mini_batch_src_global generation:  0.0038056373596191406
r_  generation:  0.04647660255432129
local_output_nid generation:  0.0061337947845458984
local_in_edges_tensor generation:  0.0035898685455322266
mini_batch_src_global generation:  0.003702878952026367
r_  generation:  0.047769784927368164
local_output_nid generation:  0.006173133850097656
local_in_edges_tensor generation:  0.0035552978515625
mini_batch_src_global generation:  0.004024028778076172
r_  generation:  0.04772496223449707
local_output_nid generation:  0.006111621856689453
local_in_edges_tensor generation:  0.0035305023193359375
mini_batch_src_global generation:  0.004100322723388672
r_  generation:  0.047853708267211914
local_output_nid generation:  0.006195783615112305
local_in_edges_tensor generation:  0.0034835338592529297
mini_batch_src_global generation:  0.004171133041381836
r_  generation:  0.04872894287109375
local_output_nid generation:  0.006127834320068359
local_in_edges_tensor generation:  0.003589630126953125
mini_batch_src_global generation:  0.0041942596435546875
r_  generation:  0.047760009765625
----------------------check_connections_block total spend ----------------------------- 0.5943305492401123
generate_one_block  0.05928397178649902
generate_one_block  0.06184220314025879
generate_one_block  0.061363935470581055
generate_one_block  0.062346458435058594
generate_one_block  0.061363935470581055
generate_one_block  0.06184506416320801
generate_one_block  0.06591105461120605
generate_one_block  0.061925649642944336
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03521394729614258
gen group dst list time:  0.016023635864257812
time for parepare:  0.021811962127685547
local_output_nid generation:  0.014927864074707031
local_in_edges_tensor generation:  0.02879810333251953
mini_batch_src_global generation:  0.038048744201660156
r_  generation:  0.3583970069885254
local_output_nid generation:  0.0211026668548584
local_in_edges_tensor generation:  0.030317068099975586
mini_batch_src_global generation:  0.048912763595581055
r_  generation:  0.3746497631072998
local_output_nid generation:  0.021120786666870117
local_in_edges_tensor generation:  0.02225327491760254
mini_batch_src_global generation:  0.04487752914428711
r_  generation:  0.378368616104126
local_output_nid generation:  0.020760536193847656
local_in_edges_tensor generation:  0.021036863327026367
mini_batch_src_global generation:  0.045397043228149414
r_  generation:  0.38324713706970215
local_output_nid generation:  0.021127939224243164
local_in_edges_tensor generation:  0.021625757217407227
mini_batch_src_global generation:  0.05514860153198242
r_  generation:  0.38086748123168945
local_output_nid generation:  0.02226996421813965
local_in_edges_tensor generation:  0.02115654945373535
mini_batch_src_global generation:  0.05306744575500488
r_  generation:  0.3837559223175049
local_output_nid generation:  0.02036309242248535
local_in_edges_tensor generation:  0.021625518798828125
mini_batch_src_global generation:  0.04673051834106445
r_  generation:  0.3860955238342285
local_output_nid generation:  0.020188331604003906
local_in_edges_tensor generation:  0.021699190139770508
mini_batch_src_global generation:  0.045540809631347656
r_  generation:  0.37946367263793945
----------------------check_connections_block total spend ----------------------------- 4.411694288253784
generate_one_block  0.48643970489501953
generate_one_block  0.49216794967651367
generate_one_block  0.49820685386657715
generate_one_block  0.5001285076141357
generate_one_block  0.48482799530029297
generate_one_block  0.491194486618042
generate_one_block  0.49140405654907227
generate_one_block  0.5095932483673096
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.040570735931396484
gen group dst list time:  0.039102792739868164
time for parepare:  0.01866316795349121
local_output_nid generation:  0.030585289001464844
local_in_edges_tensor generation:  0.04792928695678711
mini_batch_src_global generation:  0.05447053909301758
r_  generation:  0.5494983196258545
local_output_nid generation:  0.03667187690734863
local_in_edges_tensor generation:  0.043538808822631836
mini_batch_src_global generation:  0.0651092529296875
r_  generation:  0.5549459457397461
local_output_nid generation:  0.036682844161987305
local_in_edges_tensor generation:  0.03499794006347656
mini_batch_src_global generation:  0.0628972053527832
r_  generation:  0.5604686737060547
local_output_nid generation:  0.036457061767578125
local_in_edges_tensor generation:  0.03805041313171387
mini_batch_src_global generation:  0.06088519096374512
r_  generation:  0.5647969245910645
local_output_nid generation:  0.036226511001586914
local_in_edges_tensor generation:  0.03783297538757324
mini_batch_src_global generation:  0.061476945877075195
r_  generation:  0.5749931335449219
local_output_nid generation:  0.03638863563537598
local_in_edges_tensor generation:  0.03697633743286133
mini_batch_src_global generation:  0.06214618682861328
r_  generation:  0.5723302364349365
local_output_nid generation:  0.036314964294433594
local_in_edges_tensor generation:  0.03606128692626953
mini_batch_src_global generation:  0.0633540153503418
r_  generation:  0.5732953548431396
local_output_nid generation:  0.036582231521606445
local_in_edges_tensor generation:  0.03969311714172363
mini_batch_src_global generation:  0.06323671340942383
r_  generation:  0.5774285793304443
----------------------check_connections_block total spend ----------------------------- 6.640141248703003
generate_one_block  0.702045202255249
generate_one_block  0.713153600692749
generate_one_block  0.7097280025482178
generate_one_block  0.710594892501831
generate_one_block  0.707890510559082
generate_one_block  0.7033812999725342
generate_one_block  0.7121789455413818
generate_one_block  0.7051706314086914
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14129924774169922  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

connection checking time:  11.051835536956787
block generation total time  9.6181058883667
average batch blocks generation time:  1.2022632360458374
block dataloader generation time/epoch 22.642925805515713
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10685253143310547  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9551339149475098  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1065683364868164  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9542422294616699  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10702228546142578  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9556970596313477  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10655498504638672  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9556632041931152  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10634946823120117  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9538006782531738  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10634469985961914  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9540958404541016  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10707855224609375  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.955082893371582  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10622692108154297  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9523625373840332  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08163321018218994 |0.014610320329666138 |0.0035378336906433105 |9.34898853302002e-05 |0.003336608409881592 |0.0017445087432861328 |
----------------------------------------------------------pseudo_mini_loss sum 1.2353171110153198
Total (block generation + training)time/epoch 23.562872264120315
Training time/epoch 0.9046835899353027
Training time without block to device /epoch 0.7878010272979736
Training time without total dataloading part /epoch 0.05748796463012695
load block tensor time/epoch 0.6530656814575195
block to device time/epoch 0.1168825626373291
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 27 |
Number of nodes for computation during this epoch:  3057684
Number of first layer input nodes during this epoch:  1300765
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14141321182250977  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023459672927856445
random selection method range initialization spend 0.00502467155456543
time for parepare:  0.017429590225219727
local_output_nid generation:  0.004568576812744141
local_in_edges_tensor generation:  0.006078243255615234
mini_batch_src_global generation:  0.0034317970275878906
r_  generation:  0.044258832931518555
local_output_nid generation:  0.0059146881103515625
local_in_edges_tensor generation:  0.003507375717163086
mini_batch_src_global generation:  0.0053348541259765625
r_  generation:  0.046709537506103516
local_output_nid generation:  0.0061647891998291016
local_in_edges_tensor generation:  0.0034999847412109375
mini_batch_src_global generation:  0.003663778305053711
r_  generation:  0.04523301124572754
local_output_nid generation:  0.0061724185943603516
local_in_edges_tensor generation:  0.0035104751586914062
mini_batch_src_global generation:  0.0036611557006835938
r_  generation:  0.047769784927368164
local_output_nid generation:  0.006195545196533203
local_in_edges_tensor generation:  0.003423929214477539
mini_batch_src_global generation:  0.0039517879486083984
r_  generation:  0.04801344871520996
local_output_nid generation:  0.006161212921142578
local_in_edges_tensor generation:  0.0035071372985839844
mini_batch_src_global generation:  0.004082679748535156
r_  generation:  0.04958939552307129
local_output_nid generation:  0.006149768829345703
local_in_edges_tensor generation:  0.003465890884399414
mini_batch_src_global generation:  0.0041735172271728516
r_  generation:  0.04890847206115723
local_output_nid generation:  0.0061817169189453125
local_in_edges_tensor generation:  0.0035140514373779297
mini_batch_src_global generation:  0.00388336181640625
r_  generation:  0.04765796661376953
----------------------check_connections_block total spend ----------------------------- 0.5954892635345459
generate_one_block  0.060302734375
generate_one_block  0.06228232383728027
generate_one_block  0.06051063537597656
generate_one_block  0.06158041954040527
generate_one_block  0.06163787841796875
generate_one_block  0.06268072128295898
generate_one_block  0.06554079055786133
generate_one_block  0.06046724319458008
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0358884334564209
gen group dst list time:  0.015482187271118164
time for parepare:  0.019585847854614258
local_output_nid generation:  0.014894485473632812
local_in_edges_tensor generation:  0.02927708625793457
mini_batch_src_global generation:  0.038266658782958984
r_  generation:  0.36557865142822266
local_output_nid generation:  0.021008729934692383
local_in_edges_tensor generation:  0.026363134384155273
mini_batch_src_global generation:  0.045030832290649414
r_  generation:  0.38412022590637207
local_output_nid generation:  0.02076268196105957
local_in_edges_tensor generation:  0.021112442016601562
mini_batch_src_global generation:  0.04548311233520508
r_  generation:  0.3751041889190674
local_output_nid generation:  0.02073526382446289
local_in_edges_tensor generation:  0.023350238800048828
mini_batch_src_global generation:  0.04495954513549805
r_  generation:  0.3855433464050293
local_output_nid generation:  0.02082991600036621
local_in_edges_tensor generation:  0.022051334381103516
mini_batch_src_global generation:  0.04641437530517578
r_  generation:  0.391803503036499
local_output_nid generation:  0.02083754539489746
local_in_edges_tensor generation:  0.02048659324645996
mini_batch_src_global generation:  0.04604148864746094
r_  generation:  0.38980698585510254
local_output_nid generation:  0.019721269607543945
local_in_edges_tensor generation:  0.020403623580932617
mini_batch_src_global generation:  0.04725766181945801
r_  generation:  0.39096522331237793
local_output_nid generation:  0.019412994384765625
local_in_edges_tensor generation:  0.02099132537841797
mini_batch_src_global generation:  0.04548454284667969
r_  generation:  0.37998294830322266
----------------------check_connections_block total spend ----------------------------- 4.41788649559021
generate_one_block  0.49523234367370605
generate_one_block  0.502943754196167
generate_one_block  0.4835178852081299
generate_one_block  0.4953632354736328
generate_one_block  0.4997251033782959
generate_one_block  0.4953489303588867
generate_one_block  0.4981362819671631
generate_one_block  0.5101103782653809
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0373992919921875
gen group dst list time:  0.0390927791595459
time for parepare:  0.019365549087524414
local_output_nid generation:  0.030292510986328125
local_in_edges_tensor generation:  0.04373931884765625
mini_batch_src_global generation:  0.05104351043701172
r_  generation:  0.5458159446716309
local_output_nid generation:  0.036423444747924805
local_in_edges_tensor generation:  0.04119992256164551
mini_batch_src_global generation:  0.06438493728637695
r_  generation:  0.5575716495513916
local_output_nid generation:  0.037380218505859375
local_in_edges_tensor generation:  0.04658842086791992
mini_batch_src_global generation:  0.061698198318481445
r_  generation:  0.558790922164917
local_output_nid generation:  0.03652191162109375
local_in_edges_tensor generation:  0.0373077392578125
mini_batch_src_global generation:  0.06117129325866699
r_  generation:  0.5642552375793457
local_output_nid generation:  0.03651165962219238
local_in_edges_tensor generation:  0.036585330963134766
mini_batch_src_global generation:  0.06274271011352539
r_  generation:  0.5703587532043457
local_output_nid generation:  0.036934614181518555
local_in_edges_tensor generation:  0.04136323928833008
mini_batch_src_global generation:  0.06339001655578613
r_  generation:  0.5712146759033203
local_output_nid generation:  0.03655672073364258
local_in_edges_tensor generation:  0.040406227111816406
mini_batch_src_global generation:  0.06371569633483887
r_  generation:  0.5791609287261963
local_output_nid generation:  0.0365447998046875
local_in_edges_tensor generation:  0.037926673889160156
mini_batch_src_global generation:  0.06370830535888672
r_  generation:  0.5766305923461914
----------------------check_connections_block total spend ----------------------------- 6.638470649719238
generate_one_block  0.705085277557373
generate_one_block  0.7280905246734619
generate_one_block  0.7066898345947266
generate_one_block  0.7128198146820068
generate_one_block  0.7072772979736328
generate_one_block  0.7078089714050293
generate_one_block  0.7098162174224854
generate_one_block  0.6989431381225586
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14141321182250977  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

connection checking time:  11.056357145309448
block generation total time  9.656908988952637
average batch blocks generation time:  1.2071136236190796
block dataloader generation time/epoch 22.64991357451991
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10731077194213867  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9537343978881836  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10687112808227539  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9553089141845703  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10624456405639648  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.946019172668457  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10642480850219727  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9560608863830566  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10648727416992188  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9537663459777832  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1065516471862793  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9552359580993652  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1069488525390625  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9573245048522949  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10558366775512695  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9490261077880859  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08239030838012695 |0.015534818172454834 |0.0034528374671936035 |8.887052536010742e-05 |0.0032666027545928955 |0.0012722015380859375 |
----------------------------------------------------------pseudo_mini_loss sum 1.2211546897888184
Total (block generation + training)time/epoch 23.569767776288483
Training time/epoch 0.9179074764251709
Training time without block to device /epoch 0.7936289310455322
Training time without total dataloading part /epoch 0.05573868751525879
load block tensor time/epoch 0.6591224670410156
block to device time/epoch 0.12427854537963867
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 28 |
Number of nodes for computation during this epoch:  3055913
Number of first layer input nodes during this epoch:  1300639
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14024591445922852  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02482461929321289
random selection method range initialization spend 0.005045890808105469
time for parepare:  0.017802715301513672
local_output_nid generation:  0.004533052444458008
local_in_edges_tensor generation:  0.009127378463745117
mini_batch_src_global generation:  0.0033273696899414062
r_  generation:  0.04399728775024414
local_output_nid generation:  0.005932331085205078
local_in_edges_tensor generation:  0.003272533416748047
mini_batch_src_global generation:  0.005124092102050781
r_  generation:  0.04524111747741699
local_output_nid generation:  0.00614476203918457
local_in_edges_tensor generation:  0.0033969879150390625
mini_batch_src_global generation:  0.0036728382110595703
r_  generation:  0.045851945877075195
local_output_nid generation:  0.006124734878540039
local_in_edges_tensor generation:  0.003304719924926758
mini_batch_src_global generation:  0.003669261932373047
r_  generation:  0.0482175350189209
local_output_nid generation:  0.006165504455566406
local_in_edges_tensor generation:  0.0034265518188476562
mini_batch_src_global generation:  0.004037380218505859
r_  generation:  0.04834270477294922
local_output_nid generation:  0.0061359405517578125
local_in_edges_tensor generation:  0.0034508705139160156
mini_batch_src_global generation:  0.004115104675292969
r_  generation:  0.04767918586730957
local_output_nid generation:  0.0061724185943603516
local_in_edges_tensor generation:  0.0033524036407470703
mini_batch_src_global generation:  0.004225254058837891
r_  generation:  0.049614906311035156
local_output_nid generation:  0.006159782409667969
local_in_edges_tensor generation:  0.0035185813903808594
mini_batch_src_global generation:  0.004121541976928711
r_  generation:  0.04900336265563965
----------------------check_connections_block total spend ----------------------------- 0.5982258319854736
generate_one_block  0.06295943260192871
generate_one_block  0.06155824661254883
generate_one_block  0.06081795692443848
generate_one_block  0.062093257904052734
generate_one_block  0.06184697151184082
generate_one_block  0.060823917388916016
generate_one_block  0.06647515296936035
generate_one_block  0.06221270561218262
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.035625457763671875
gen group dst list time:  0.01584005355834961
time for parepare:  0.01933741569519043
local_output_nid generation:  0.0149078369140625
local_in_edges_tensor generation:  0.030042171478271484
mini_batch_src_global generation:  0.035830020904541016
r_  generation:  0.35663628578186035
local_output_nid generation:  0.020870208740234375
local_in_edges_tensor generation:  0.026952743530273438
mini_batch_src_global generation:  0.04636025428771973
r_  generation:  0.37115478515625
local_output_nid generation:  0.02054142951965332
local_in_edges_tensor generation:  0.023665428161621094
mini_batch_src_global generation:  0.04643416404724121
r_  generation:  0.3806896209716797
local_output_nid generation:  0.020715713500976562
local_in_edges_tensor generation:  0.02068185806274414
mini_batch_src_global generation:  0.04581785202026367
r_  generation:  0.38161301612854004
local_output_nid generation:  0.02082681655883789
local_in_edges_tensor generation:  0.020303964614868164
mini_batch_src_global generation:  0.04680943489074707
r_  generation:  0.3832979202270508
local_output_nid generation:  0.02063584327697754
local_in_edges_tensor generation:  0.020995616912841797
mini_batch_src_global generation:  0.04648089408874512
r_  generation:  0.37777209281921387
local_output_nid generation:  0.0200197696685791
local_in_edges_tensor generation:  0.020750045776367188
mini_batch_src_global generation:  0.047573089599609375
r_  generation:  0.38807201385498047
local_output_nid generation:  0.019791603088378906
local_in_edges_tensor generation:  0.024199724197387695
mini_batch_src_global generation:  0.046576738357543945
r_  generation:  0.379971981048584
----------------------check_connections_block total spend ----------------------------- 4.378708600997925
generate_one_block  0.48410773277282715
generate_one_block  0.485353946685791
generate_one_block  0.4902381896972656
generate_one_block  0.49601149559020996
generate_one_block  0.4863128662109375
generate_one_block  0.481456995010376
generate_one_block  0.49878668785095215
generate_one_block  0.5163650512695312
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03738808631896973
gen group dst list time:  0.03943586349487305
time for parepare:  0.018895387649536133
local_output_nid generation:  0.031180381774902344
local_in_edges_tensor generation:  0.04744315147399902
mini_batch_src_global generation:  0.05173754692077637
r_  generation:  0.5477743148803711
local_output_nid generation:  0.037087202072143555
local_in_edges_tensor generation:  0.04302549362182617
mini_batch_src_global generation:  0.06450438499450684
r_  generation:  0.55010986328125
local_output_nid generation:  0.037338972091674805
local_in_edges_tensor generation:  0.040346622467041016
mini_batch_src_global generation:  0.06200385093688965
r_  generation:  0.5652086734771729
local_output_nid generation:  0.037276268005371094
local_in_edges_tensor generation:  0.03961658477783203
mini_batch_src_global generation:  0.06104111671447754
r_  generation:  0.564788818359375
local_output_nid generation:  0.036829471588134766
local_in_edges_tensor generation:  0.04065895080566406
mini_batch_src_global generation:  0.062474966049194336
r_  generation:  0.5620408058166504
local_output_nid generation:  0.03678107261657715
local_in_edges_tensor generation:  0.035553932189941406
mini_batch_src_global generation:  0.06291794776916504
r_  generation:  0.5665547847747803
local_output_nid generation:  0.03736376762390137
local_in_edges_tensor generation:  0.03490948677062988
mini_batch_src_global generation:  0.06285548210144043
r_  generation:  0.5688292980194092
local_output_nid generation:  0.036612749099731445
local_in_edges_tensor generation:  0.0362095832824707
mini_batch_src_global generation:  0.06352710723876953
r_  generation:  0.5712206363677979
----------------------check_connections_block total spend ----------------------------- 6.609915494918823
generate_one_block  0.6993510723114014
generate_one_block  0.6981308460235596
generate_one_block  0.6983027458190918
generate_one_block  0.7084484100341797
generate_one_block  0.7126317024230957
generate_one_block  0.7103700637817383
generate_one_block  0.7220520973205566
generate_one_block  0.712261438369751
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.14024591445922852  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

connection checking time:  10.988624095916748
block generation total time  9.600181341171265
average batch blocks generation time:  1.200022667646408
block dataloader generation time/epoch 22.64916524887085
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10686922073364258  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9528255462646484  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.106719970703125  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9543075561523438  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10712146759033203  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9534244537353516  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10698938369750977  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9547266960144043  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10693740844726562  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9559311866760254  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10650300979614258  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9543905258178711  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10736227035522461  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9588665962219238  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10579824447631836  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9528579711914062  GigaBytes
Max Memory Allocated: 1.1089420318603516  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0829448401927948 |0.017949730157852173 |0.003460794687271118 |9.012222290039062e-05 |0.0036686062812805176 |0.002725362777709961 |
----------------------------------------------------------pseudo_mini_loss sum 1.2100839614868164
Total (block generation + training)time/epoch 23.570113551616668
Training time/epoch 0.9415161609649658
Training time without block to device /epoch 0.7979183197021484
Training time without total dataloading part /epoch 0.06048154830932617
load block tensor time/epoch 0.6635587215423584
block to device time/epoch 0.14359784126281738
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 29 |
Number of nodes for computation during this epoch:  3058084
Number of first layer input nodes during this epoch:  1301134
