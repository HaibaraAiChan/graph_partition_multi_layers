Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1647758666.9124074
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027780771255493164
random selection method range initialization spend 0.006536722183227539
time for parepare:  0.018707752227783203
local_output_nid generation:  0.004258155822753906
local_in_edges_tensor generation:  0.0064907073974609375
mini_batch_src_global generation:  0.0038480758666992188
r_  generation:  0.042825937271118164
local_output_nid generation:  0.005756378173828125
local_in_edges_tensor generation:  0.003364086151123047
mini_batch_src_global generation:  0.005049467086791992
r_  generation:  0.04457855224609375
local_output_nid generation:  0.006051778793334961
local_in_edges_tensor generation:  0.00347137451171875
mini_batch_src_global generation:  0.003274202346801758
r_  generation:  0.04445385932922363
local_output_nid generation:  0.006104946136474609
local_in_edges_tensor generation:  0.0033521652221679688
mini_batch_src_global generation:  0.00354766845703125
r_  generation:  0.046111345291137695
local_output_nid generation:  0.006062746047973633
local_in_edges_tensor generation:  0.003281831741333008
mini_batch_src_global generation:  0.0037178993225097656
r_  generation:  0.04763603210449219
local_output_nid generation:  0.006056547164916992
local_in_edges_tensor generation:  0.0032591819763183594
mini_batch_src_global generation:  0.0038924217224121094
r_  generation:  0.04631352424621582
local_output_nid generation:  0.00600743293762207
local_in_edges_tensor generation:  0.0032122135162353516
mini_batch_src_global generation:  0.0040471553802490234
r_  generation:  0.04801344871520996
local_output_nid generation:  0.00602412223815918
local_in_edges_tensor generation:  0.003209352493286133
mini_batch_src_global generation:  0.004002809524536133
r_  generation:  0.04748725891113281
----------------------check_connections_block total spend ----------------------------- 0.5793793201446533
generate_one_block  0.06188392639160156
generate_one_block  0.06328368186950684
generate_one_block  0.06140470504760742
generate_one_block  0.06079745292663574
generate_one_block  0.06583881378173828
generate_one_block  0.06178855895996094
generate_one_block  0.06181621551513672
generate_one_block  0.061524152755737305
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04418182373046875
gen group dst list time:  0.016300201416015625
time for parepare:  0.01990222930908203
local_output_nid generation:  0.014566898345947266
local_in_edges_tensor generation:  0.03617429733276367
mini_batch_src_global generation:  0.03928542137145996
r_  generation:  0.36321234703063965
local_output_nid generation:  0.022997379302978516
local_in_edges_tensor generation:  0.035411834716796875
mini_batch_src_global generation:  0.055811166763305664
r_  generation:  0.37085413932800293
local_output_nid generation:  0.022583484649658203
local_in_edges_tensor generation:  0.02675628662109375
mini_batch_src_global generation:  0.044760942459106445
r_  generation:  0.3723897933959961
local_output_nid generation:  0.02277064323425293
local_in_edges_tensor generation:  0.029029130935668945
mini_batch_src_global generation:  0.04429793357849121
r_  generation:  0.3724365234375
local_output_nid generation:  0.022754907608032227
local_in_edges_tensor generation:  0.021825313568115234
mini_batch_src_global generation:  0.0458216667175293
r_  generation:  0.3774080276489258
local_output_nid generation:  0.02297353744506836
local_in_edges_tensor generation:  0.02576160430908203
mini_batch_src_global generation:  0.04694652557373047
r_  generation:  0.38085317611694336
local_output_nid generation:  0.02332305908203125
local_in_edges_tensor generation:  0.025742053985595703
mini_batch_src_global generation:  0.04687070846557617
r_  generation:  0.3824913501739502
local_output_nid generation:  0.02291107177734375
local_in_edges_tensor generation:  0.032230377197265625
mini_batch_src_global generation:  0.04609346389770508
r_  generation:  0.3869161605834961
----------------------check_connections_block total spend ----------------------------- 4.434359788894653
generate_one_block  0.5014142990112305
generate_one_block  0.5114662647247314
generate_one_block  0.49620652198791504
generate_one_block  0.48833727836608887
generate_one_block  0.5059771537780762
generate_one_block  0.5129928588867188
generate_one_block  0.5041453838348389
generate_one_block  0.4974517822265625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03328251838684082
gen group dst list time:  0.036875247955322266
time for parepare:  0.019423246383666992
local_output_nid generation:  0.028952598571777344
local_in_edges_tensor generation:  0.045126914978027344
mini_batch_src_global generation:  0.04421424865722656
r_  generation:  0.48287487030029297
local_output_nid generation:  0.03537440299987793
local_in_edges_tensor generation:  0.0507810115814209
mini_batch_src_global generation:  0.05909609794616699
r_  generation:  0.4917154312133789
local_output_nid generation:  0.03506612777709961
local_in_edges_tensor generation:  0.04665088653564453
mini_batch_src_global generation:  0.055364370346069336
r_  generation:  0.4886624813079834
local_output_nid generation:  0.035284996032714844
local_in_edges_tensor generation:  0.03573465347290039
mini_batch_src_global generation:  0.05303502082824707
r_  generation:  0.4966106414794922
local_output_nid generation:  0.035158634185791016
local_in_edges_tensor generation:  0.04538321495056152
mini_batch_src_global generation:  0.07415437698364258
r_  generation:  0.504561185836792
local_output_nid generation:  0.03700852394104004
local_in_edges_tensor generation:  0.041115522384643555
mini_batch_src_global generation:  0.05806994438171387
r_  generation:  0.5103302001953125
local_output_nid generation:  0.037180185317993164
local_in_edges_tensor generation:  0.0434267520904541
mini_batch_src_global generation:  0.057349443435668945
r_  generation:  0.5154213905334473
local_output_nid generation:  0.03692960739135742
local_in_edges_tensor generation:  0.04294133186340332
mini_batch_src_global generation:  0.05543875694274902
r_  generation:  0.5246388912200928
----------------------check_connections_block total spend ----------------------------- 6.044644594192505
generate_one_block  0.6267609596252441
generate_one_block  0.6411457061767578
generate_one_block  0.6315698623657227
generate_one_block  0.6301519870758057
generate_one_block  0.6275875568389893
generate_one_block  0.635263204574585
generate_one_block  0.651287317276001
generate_one_block  0.6238634586334229
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  10.479004383087158
block generation total time  9.08562159538269
average batch blocks generation time:  1.1357026994228363
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.10040664672851562  GigaBytes
Max Memory Allocated: 0.10040664672851562  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4783935546875 GB
    Memory Allocated: 0.948333740234375  GigaBytes
Max Memory Allocated: 1.0143890380859375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8494873046875 GB
    Memory Allocated: 0.10277175903320312  GigaBytes
Max Memory Allocated: 1.088881015777588  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8514404296875 GB
    Memory Allocated: 0.9529333114624023  GigaBytes
Max Memory Allocated: 1.088881015777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.10329627990722656  GigaBytes
Max Memory Allocated: 1.094512939453125  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.9485764503479004  GigaBytes
Max Memory Allocated: 1.094512939453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.10376358032226562  GigaBytes
Max Memory Allocated: 1.094512939453125  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.9453611373901367  GigaBytes
Max Memory Allocated: 1.094512939453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.10250377655029297  GigaBytes
Max Memory Allocated: 1.094512939453125  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.946380615234375  GigaBytes
Max Memory Allocated: 1.094512939453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.10327625274658203  GigaBytes
Max Memory Allocated: 1.094512939453125  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.9547443389892578  GigaBytes
Max Memory Allocated: 1.094512939453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.10254287719726562  GigaBytes
Max Memory Allocated: 1.0953164100646973  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.9488410949707031  GigaBytes
Max Memory Allocated: 1.0953164100646973  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.10331153869628906  GigaBytes
Max Memory Allocated: 1.0953164100646973  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.9470701217651367  GigaBytes
Max Memory Allocated: 1.0953164100646973  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07245323061943054 |0.05471611022949219 |0.1001075804233551 |0.0001017153263092041 |0.015443682670593262 |0.002226591110229492 |
----------------------------------------------------------pseudo_mini_loss sum 6.24975061416626
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3054915
Number of first layer input nodes during this epoch:  1298266
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.13815784454345703  GigaBytes
Max Memory Allocated: 1.0953164100646973  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0307769775390625
random selection method range initialization spend 0.0055789947509765625
time for parepare:  0.017755746841430664
local_output_nid generation:  0.0043599605560302734
local_in_edges_tensor generation:  0.007311582565307617
mini_batch_src_global generation:  0.0038242340087890625
r_  generation:  0.042501211166381836
local_output_nid generation:  0.0057163238525390625
local_in_edges_tensor generation:  0.003313302993774414
mini_batch_src_global generation:  0.004811286926269531
r_  generation:  0.04349517822265625
local_output_nid generation:  0.006018161773681641
local_in_edges_tensor generation:  0.0033617019653320312
mini_batch_src_global generation:  0.0032351016998291016
r_  generation:  0.04405641555786133
local_output_nid generation:  0.006075382232666016
local_in_edges_tensor generation:  0.0033507347106933594
mini_batch_src_global generation:  0.0033724308013916016
r_  generation:  0.04435610771179199
local_output_nid generation:  0.0060846805572509766
local_in_edges_tensor generation:  0.0033597946166992188
mini_batch_src_global generation:  0.0036916732788085938
r_  generation:  0.04992842674255371
local_output_nid generation:  0.007002115249633789
local_in_edges_tensor generation:  0.0114288330078125
mini_batch_src_global generation:  0.008519887924194336
r_  generation:  0.049153804779052734
local_output_nid generation:  0.007750988006591797
local_in_edges_tensor generation:  0.0035238265991210938
mini_batch_src_global generation:  0.0041255950927734375
r_  generation:  0.04808950424194336
local_output_nid generation:  0.0061795711517333984
local_in_edges_tensor generation:  0.003202676773071289
mini_batch_src_global generation:  0.003999471664428711
r_  generation:  0.04579782485961914
----------------------check_connections_block total spend ----------------------------- 0.6005611419677734
generate_one_block  0.06098151206970215
generate_one_block  0.06266236305236816
generate_one_block  0.06152606010437012
generate_one_block  0.06096076965332031
generate_one_block  0.062140703201293945
generate_one_block  0.06139993667602539
generate_one_block  0.06618571281433105
generate_one_block  0.06078529357910156
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06029558181762695
gen group dst list time:  0.01622748374938965
time for parepare:  0.01895761489868164
local_output_nid generation:  0.01433873176574707
local_in_edges_tensor generation:  0.05392742156982422
mini_batch_src_global generation:  0.03607320785522461
r_  generation:  0.36321496963500977
local_output_nid generation:  0.020384550094604492
local_in_edges_tensor generation:  0.0363767147064209
mini_batch_src_global generation:  0.04508376121520996
r_  generation:  0.3769683837890625
local_output_nid generation:  0.019312143325805664
local_in_edges_tensor generation:  0.029660701751708984
mini_batch_src_global generation:  0.04388713836669922
r_  generation:  0.38077306747436523
local_output_nid generation:  0.019181013107299805
local_in_edges_tensor generation:  0.029831409454345703
mini_batch_src_global generation:  0.04468560218811035
r_  generation:  0.3744978904724121
local_output_nid generation:  0.01937103271484375
local_in_edges_tensor generation:  0.027004003524780273
mini_batch_src_global generation:  0.04594826698303223
r_  generation:  0.3778421878814697
local_output_nid generation:  0.022416114807128906
local_in_edges_tensor generation:  0.026668310165405273
mini_batch_src_global generation:  0.0491030216217041
r_  generation:  0.3851616382598877
local_output_nid generation:  0.01960301399230957
local_in_edges_tensor generation:  0.029848814010620117
mini_batch_src_global generation:  0.046896934509277344
r_  generation:  0.3891913890838623
local_output_nid generation:  0.01938605308532715
local_in_edges_tensor generation:  0.02601027488708496
mini_batch_src_global generation:  0.04650712013244629
r_  generation:  0.377608060836792
----------------------check_connections_block total spend ----------------------------- 4.451165437698364
generate_one_block  0.5265271663665771
generate_one_block  0.5021634101867676
generate_one_block  0.49586939811706543
generate_one_block  0.4854316711425781
generate_one_block  0.49292993545532227
generate_one_block  0.4956989288330078
generate_one_block  0.507742166519165
generate_one_block  0.5057311058044434
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.047239065170288086
gen group dst list time:  0.03709006309509277
time for parepare:  0.01936793327331543
local_output_nid generation:  0.02929997444152832
local_in_edges_tensor generation:  0.04743242263793945
mini_batch_src_global generation:  0.04522132873535156
r_  generation:  0.47913241386413574
local_output_nid generation:  0.03586912155151367
local_in_edges_tensor generation:  0.051633358001708984
mini_batch_src_global generation:  0.0554499626159668
r_  generation:  0.4875755310058594
local_output_nid generation:  0.0358433723449707
local_in_edges_tensor generation:  0.04405474662780762
mini_batch_src_global generation:  0.05853629112243652
r_  generation:  0.4896275997161865
local_output_nid generation:  0.035926103591918945
local_in_edges_tensor generation:  0.038877248764038086
mini_batch_src_global generation:  0.05408596992492676
r_  generation:  0.4983863830566406
local_output_nid generation:  0.03597378730773926
local_in_edges_tensor generation:  0.03434872627258301
mini_batch_src_global generation:  0.055237531661987305
r_  generation:  0.5023279190063477
local_output_nid generation:  0.035828351974487305
local_in_edges_tensor generation:  0.04348587989807129
mini_batch_src_global generation:  0.05457353591918945
r_  generation:  0.5019547939300537
local_output_nid generation:  0.035958051681518555
local_in_edges_tensor generation:  0.043591976165771484
mini_batch_src_global generation:  0.05472397804260254
r_  generation:  0.5116679668426514
local_output_nid generation:  0.03600144386291504
local_in_edges_tensor generation:  0.0429232120513916
mini_batch_src_global generation:  0.05522727966308594
r_  generation:  0.5102312564849854
----------------------check_connections_block total spend ----------------------------- 5.9410560131073
generate_one_block  0.6136133670806885
generate_one_block  0.6109554767608643
generate_one_block  0.6300265789031982
generate_one_block  0.6201515197753906
generate_one_block  0.6133215427398682
generate_one_block  0.624643087387085
generate_one_block  0.625145435333252
generate_one_block  0.6220602989196777
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.13815784454345703  GigaBytes
Max Memory Allocated: 1.0953164100646973  GigaBytes

connection checking time:  10.392221450805664
block generation total time  8.972011089324951
average batch blocks generation time:  1.121501386165619
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.10426616668701172  GigaBytes
Max Memory Allocated: 1.0953164100646973  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9542431831359863  GigaBytes
Max Memory Allocated: 1.0953164100646973  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1045832633972168  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9522714614868164  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10508966445922852  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9548196792602539  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1050710678100586  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9490504264831543  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10437965393066406  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9494237899780273  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10520458221435547  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9510402679443359  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10442733764648438  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9521584510803223  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1049203872680664  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9502987861633301  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08280128240585327 |0.01290789246559143 |0.0063970983028411865 |9.143352508544922e-05 |0.0038174688816070557 |0.0013141632080078125 |
----------------------------------------------------------pseudo_mini_loss sum 3.235211133956909
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3056259
Number of first layer input nodes during this epoch:  1297771
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13865280151367188  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03082132339477539
random selection method range initialization spend 0.005701541900634766
time for parepare:  0.01830744743347168
local_output_nid generation:  0.0043985843658447266
local_in_edges_tensor generation:  0.006713151931762695
mini_batch_src_global generation:  0.0038590431213378906
r_  generation:  0.04200243949890137
local_output_nid generation:  0.005852699279785156
local_in_edges_tensor generation:  0.003205537796020508
mini_batch_src_global generation:  0.004770040512084961
r_  generation:  0.044254302978515625
local_output_nid generation:  0.006079673767089844
local_in_edges_tensor generation:  0.0033121109008789062
mini_batch_src_global generation:  0.0031943321228027344
r_  generation:  0.04461073875427246
local_output_nid generation:  0.0060749053955078125
local_in_edges_tensor generation:  0.0034537315368652344
mini_batch_src_global generation:  0.0035123825073242188
r_  generation:  0.046953439712524414
local_output_nid generation:  0.006047725677490234
local_in_edges_tensor generation:  0.003393888473510742
mini_batch_src_global generation:  0.0037925243377685547
r_  generation:  0.04791903495788574
local_output_nid generation:  0.00611567497253418
local_in_edges_tensor generation:  0.003424406051635742
mini_batch_src_global generation:  0.0039975643157958984
r_  generation:  0.048090219497680664
local_output_nid generation:  0.00611114501953125
local_in_edges_tensor generation:  0.003426074981689453
mini_batch_src_global generation:  0.003915548324584961
r_  generation:  0.04660463333129883
local_output_nid generation:  0.006077766418457031
local_in_edges_tensor generation:  0.0033578872680664062
mini_batch_src_global generation:  0.004217386245727539
r_  generation:  0.049723148345947266
----------------------check_connections_block total spend ----------------------------- 0.5837032794952393
generate_one_block  0.060009002685546875
generate_one_block  0.06035757064819336
generate_one_block  0.06028437614440918
generate_one_block  0.061350107192993164
generate_one_block  0.06179523468017578
generate_one_block  0.060918569564819336
generate_one_block  0.06413793563842773
generate_one_block  0.06277775764465332
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04446291923522949
gen group dst list time:  0.015848159790039062
time for parepare:  0.019156217575073242
local_output_nid generation:  0.014985084533691406
local_in_edges_tensor generation:  0.03352618217468262
mini_batch_src_global generation:  0.03784060478210449
r_  generation:  0.366055965423584
local_output_nid generation:  0.021097421646118164
local_in_edges_tensor generation:  0.024662256240844727
mini_batch_src_global generation:  0.04979395866394043
r_  generation:  0.37591099739074707
local_output_nid generation:  0.021831989288330078
local_in_edges_tensor generation:  0.029418230056762695
mini_batch_src_global generation:  0.05007219314575195
r_  generation:  0.3834831714630127
local_output_nid generation:  0.019948244094848633
local_in_edges_tensor generation:  0.03135275840759277
mini_batch_src_global generation:  0.048267364501953125
r_  generation:  0.38272905349731445
local_output_nid generation:  0.020297765731811523
local_in_edges_tensor generation:  0.024847984313964844
mini_batch_src_global generation:  0.04807901382446289
r_  generation:  0.3929588794708252
local_output_nid generation:  0.019942522048950195
local_in_edges_tensor generation:  0.023566484451293945
mini_batch_src_global generation:  0.05889749526977539
r_  generation:  0.4011504650115967
local_output_nid generation:  0.022132158279418945
local_in_edges_tensor generation:  0.02350616455078125
mini_batch_src_global generation:  0.04723072052001953
r_  generation:  0.38431763648986816
local_output_nid generation:  0.0202181339263916
local_in_edges_tensor generation:  0.022664546966552734
mini_batch_src_global generation:  0.04956316947937012
r_  generation:  0.38929009437561035
----------------------check_connections_block total spend ----------------------------- 4.502699851989746
generate_one_block  0.49025654792785645
generate_one_block  0.48558616638183594
generate_one_block  0.4880356788635254
generate_one_block  0.49719882011413574
generate_one_block  0.49837327003479004
generate_one_block  0.4929378032684326
generate_one_block  0.4790458679199219
generate_one_block  0.5262436866760254
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05811500549316406
gen group dst list time:  0.04059147834777832
time for parepare:  0.020942211151123047
local_output_nid generation:  0.02957916259765625
local_in_edges_tensor generation:  0.054656267166137695
mini_batch_src_global generation:  0.049190521240234375
r_  generation:  0.48870849609375
local_output_nid generation:  0.036685943603515625
local_in_edges_tensor generation:  0.04166817665100098
mini_batch_src_global generation:  0.05798459053039551
r_  generation:  0.4870176315307617
local_output_nid generation:  0.03632164001464844
local_in_edges_tensor generation:  0.043706655502319336
mini_batch_src_global generation:  0.055243492126464844
r_  generation:  0.4938929080963135
local_output_nid generation:  0.03675389289855957
local_in_edges_tensor generation:  0.04226946830749512
mini_batch_src_global generation:  0.053273677825927734
r_  generation:  0.4982757568359375
local_output_nid generation:  0.03594541549682617
local_in_edges_tensor generation:  0.03626227378845215
mini_batch_src_global generation:  0.05457758903503418
r_  generation:  0.5033044815063477
local_output_nid generation:  0.036150217056274414
local_in_edges_tensor generation:  0.03632068634033203
mini_batch_src_global generation:  0.055783748626708984
r_  generation:  0.5004878044128418
local_output_nid generation:  0.03641557693481445
local_in_edges_tensor generation:  0.03877735137939453
mini_batch_src_global generation:  0.05959606170654297
r_  generation:  0.5060486793518066
local_output_nid generation:  0.03627586364746094
local_in_edges_tensor generation:  0.03638315200805664
mini_batch_src_global generation:  0.05484580993652344
r_  generation:  0.5071439743041992
----------------------check_connections_block total spend ----------------------------- 5.940689325332642
generate_one_block  0.6240973472595215
generate_one_block  0.6172902584075928
generate_one_block  0.636667013168335
generate_one_block  0.6233470439910889
generate_one_block  0.628300666809082
generate_one_block  0.6293003559112549
generate_one_block  0.6178817749023438
generate_one_block  0.6341805458068848
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13865280151367188  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

connection checking time:  10.443389177322388
block generation total time  8.968742847442627
average batch blocks generation time:  1.1210928559303284
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10442590713500977  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9500985145568848  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10492992401123047  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9512181282043457  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10467767715454102  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9500908851623535  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10541629791259766  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9513311386108398  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10451650619506836  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9524211883544922  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10410022735595703  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9508504867553711  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10533905029296875  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9478402137756348  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10422468185424805  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9531326293945312  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08456146717071533 |0.013388007879257202 |0.003481745719909668 |9.316205978393555e-05 |0.003122001886367798 |0.0028502941131591797 |
----------------------------------------------------------pseudo_mini_loss sum 2.6095330715179443
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  3054036
Number of first layer input nodes during this epoch:  1297268
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13754701614379883  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019262313842773438
random selection method range initialization spend 0.005555629730224609
time for parepare:  0.019397258758544922
local_output_nid generation:  0.004671812057495117
local_in_edges_tensor generation:  0.005865335464477539
mini_batch_src_global generation:  0.003985166549682617
r_  generation:  0.04272270202636719
local_output_nid generation:  0.0070188045501708984
local_in_edges_tensor generation:  0.0032541751861572266
mini_batch_src_global generation:  0.0050394535064697266
r_  generation:  0.04474639892578125
local_output_nid generation:  0.0072574615478515625
local_in_edges_tensor generation:  0.0032966136932373047
mini_batch_src_global generation:  0.003324270248413086
r_  generation:  0.044901371002197266
local_output_nid generation:  0.007309913635253906
local_in_edges_tensor generation:  0.0033655166625976562
mini_batch_src_global generation:  0.003469705581665039
r_  generation:  0.046221017837524414
local_output_nid generation:  0.007425785064697266
local_in_edges_tensor generation:  0.003293275833129883
mini_batch_src_global generation:  0.003710508346557617
r_  generation:  0.04754447937011719
local_output_nid generation:  0.007385969161987305
local_in_edges_tensor generation:  0.003318309783935547
mini_batch_src_global generation:  0.004046440124511719
r_  generation:  0.048398733139038086
local_output_nid generation:  0.007407665252685547
local_in_edges_tensor generation:  0.003260374069213867
mini_batch_src_global generation:  0.0039441585540771484
r_  generation:  0.04755091667175293
local_output_nid generation:  0.007421016693115234
local_in_edges_tensor generation:  0.0032739639282226562
mini_batch_src_global generation:  0.004086017608642578
r_  generation:  0.048482418060302734
----------------------check_connections_block total spend ----------------------------- 0.5951962471008301
generate_one_block  0.059990644454956055
generate_one_block  0.06182384490966797
generate_one_block  0.060632944107055664
generate_one_block  0.06110572814941406
generate_one_block  0.06192207336425781
generate_one_block  0.061711788177490234
generate_one_block  0.06489443778991699
generate_one_block  0.06253337860107422
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04545307159423828
gen group dst list time:  0.01574873924255371
time for parepare:  0.019719362258911133
local_output_nid generation:  0.015465974807739258
local_in_edges_tensor generation:  0.026097536087036133
mini_batch_src_global generation:  0.035744428634643555
r_  generation:  0.3571047782897949
local_output_nid generation:  0.0250396728515625
local_in_edges_tensor generation:  0.025458335876464844
mini_batch_src_global generation:  0.04435443878173828
r_  generation:  0.3741331100463867
local_output_nid generation:  0.025306224822998047
local_in_edges_tensor generation:  0.023190736770629883
mini_batch_src_global generation:  0.04419398307800293
r_  generation:  0.3737528324127197
local_output_nid generation:  0.02453756332397461
local_in_edges_tensor generation:  0.02194380760192871
mini_batch_src_global generation:  0.04721808433532715
r_  generation:  0.3778519630432129
local_output_nid generation:  0.02440357208251953
local_in_edges_tensor generation:  0.0218050479888916
mini_batch_src_global generation:  0.046031951904296875
r_  generation:  0.3829948902130127
local_output_nid generation:  0.02416062355041504
local_in_edges_tensor generation:  0.021871328353881836
mini_batch_src_global generation:  0.04674959182739258
r_  generation:  0.38382720947265625
local_output_nid generation:  0.02403426170349121
local_in_edges_tensor generation:  0.02195882797241211
mini_batch_src_global generation:  0.046532630920410156
r_  generation:  0.37876415252685547
local_output_nid generation:  0.023796796798706055
local_in_edges_tensor generation:  0.021907329559326172
mini_batch_src_global generation:  0.04781794548034668
r_  generation:  0.3798391819000244
----------------------check_connections_block total spend ----------------------------- 4.392500400543213
generate_one_block  0.4865295886993408
generate_one_block  0.4918975830078125
generate_one_block  0.49066662788391113
generate_one_block  0.49051856994628906
generate_one_block  0.4943382740020752
generate_one_block  0.49579763412475586
generate_one_block  0.4829232692718506
generate_one_block  0.5164575576782227
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.037431955337524414
gen group dst list time:  0.03792142868041992
time for parepare:  0.01898336410522461
local_output_nid generation:  0.030205726623535156
local_in_edges_tensor generation:  0.03980731964111328
mini_batch_src_global generation:  0.04386758804321289
r_  generation:  0.4823617935180664
local_output_nid generation:  0.038667917251586914
local_in_edges_tensor generation:  0.040558815002441406
mini_batch_src_global generation:  0.05508923530578613
r_  generation:  0.4857454299926758
local_output_nid generation:  0.038728952407836914
local_in_edges_tensor generation:  0.04132485389709473
mini_batch_src_global generation:  0.060602664947509766
r_  generation:  0.491945743560791
local_output_nid generation:  0.03920745849609375
local_in_edges_tensor generation:  0.03562283515930176
mini_batch_src_global generation:  0.052731990814208984
r_  generation:  0.4973483085632324
local_output_nid generation:  0.03887319564819336
local_in_edges_tensor generation:  0.03575277328491211
mini_batch_src_global generation:  0.05429244041442871
r_  generation:  0.4985086917877197
local_output_nid generation:  0.03911733627319336
local_in_edges_tensor generation:  0.03542733192443848
mini_batch_src_global generation:  0.0538482666015625
r_  generation:  0.5000560283660889
local_output_nid generation:  0.038732051849365234
local_in_edges_tensor generation:  0.0343017578125
mini_batch_src_global generation:  0.054654836654663086
r_  generation:  0.5049371719360352
local_output_nid generation:  0.03850269317626953
local_in_edges_tensor generation:  0.03402090072631836
mini_batch_src_global generation:  0.05502176284790039
r_  generation:  0.5137894153594971
----------------------check_connections_block total spend ----------------------------- 5.903090476989746
generate_one_block  0.6301031112670898
generate_one_block  0.6134114265441895
generate_one_block  0.6246981620788574
generate_one_block  0.6246457099914551
generate_one_block  0.6166493892669678
generate_one_block  0.6216552257537842
generate_one_block  0.6230719089508057
generate_one_block  0.6350905895233154
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13754701614379883  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

connection checking time:  10.295590877532959
block generation total time  8.938454627990723
average batch blocks generation time:  1.1173068284988403
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1040506362915039  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9491915702819824  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10501956939697266  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9522294998168945  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10422515869140625  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9499936103820801  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10515928268432617  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9500470161437988  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10445928573608398  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9508328437805176  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10502338409423828  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.953855037689209  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10357379913330078  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.948211669921875  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10525083541870117  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9525532722473145  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.082573801279068 |0.017864912748336792 |0.0034078657627105713 |8.794665336608887e-05 |0.0033211112022399902 |0.0012166500091552734 |
----------------------------------------------------------pseudo_mini_loss sum 2.3666062355041504
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  3054827
Number of first layer input nodes during this epoch:  1297440
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13855886459350586  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.08264327049255371
random selection method range initialization spend 0.01235198974609375
time for parepare:  0.018411636352539062
local_output_nid generation:  0.004439115524291992
local_in_edges_tensor generation:  0.005955696105957031
mini_batch_src_global generation:  0.004573345184326172
r_  generation:  0.04439902305603027
local_output_nid generation:  0.006062507629394531
local_in_edges_tensor generation:  0.0032563209533691406
mini_batch_src_global generation:  0.0051267147064208984
r_  generation:  0.045066118240356445
local_output_nid generation:  0.006139039993286133
local_in_edges_tensor generation:  0.003247499465942383
mini_batch_src_global generation:  0.011508941650390625
r_  generation:  0.044698476791381836
local_output_nid generation:  0.006087779998779297
local_in_edges_tensor generation:  0.0033032894134521484
mini_batch_src_global generation:  0.003536224365234375
r_  generation:  0.0472564697265625
local_output_nid generation:  0.0060842037200927734
local_in_edges_tensor generation:  0.003328084945678711
mini_batch_src_global generation:  0.004931211471557617
r_  generation:  0.05431962013244629
local_output_nid generation:  0.009216070175170898
local_in_edges_tensor generation:  0.004507541656494141
mini_batch_src_global generation:  0.004513740539550781
r_  generation:  0.05119490623474121
local_output_nid generation:  0.009172916412353516
local_in_edges_tensor generation:  0.008908748626708984
mini_batch_src_global generation:  0.004603862762451172
r_  generation:  0.051572322845458984
local_output_nid generation:  0.009211540222167969
local_in_edges_tensor generation:  0.004525423049926758
mini_batch_src_global generation:  0.004700422286987305
r_  generation:  0.051857948303222656
----------------------check_connections_block total spend ----------------------------- 0.6492776870727539
generate_one_block  0.06470417976379395
generate_one_block  0.07721352577209473
generate_one_block  0.07238006591796875
generate_one_block  0.07773017883300781
generate_one_block  0.06482648849487305
generate_one_block  0.06460404396057129
generate_one_block  0.07016277313232422
generate_one_block  0.06557059288024902
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04529905319213867
gen group dst list time:  0.017583847045898438
time for parepare:  0.02077507972717285
local_output_nid generation:  0.016868114471435547
local_in_edges_tensor generation:  0.03716230392456055
mini_batch_src_global generation:  0.04030799865722656
r_  generation:  0.3673884868621826
local_output_nid generation:  0.026380062103271484
local_in_edges_tensor generation:  0.036641836166381836
mini_batch_src_global generation:  0.04717278480529785
r_  generation:  0.37346792221069336
local_output_nid generation:  0.025584697723388672
local_in_edges_tensor generation:  0.024234294891357422
mini_batch_src_global generation:  0.04397463798522949
r_  generation:  0.39769935607910156
local_output_nid generation:  0.028075695037841797
local_in_edges_tensor generation:  0.026587963104248047
mini_batch_src_global generation:  0.04836249351501465
r_  generation:  0.3789706230163574
local_output_nid generation:  0.025652170181274414
local_in_edges_tensor generation:  0.03331708908081055
mini_batch_src_global generation:  0.04666733741760254
r_  generation:  0.3869447708129883
local_output_nid generation:  0.02506709098815918
local_in_edges_tensor generation:  0.02296900749206543
mini_batch_src_global generation:  0.04702281951904297
r_  generation:  0.38700175285339355
local_output_nid generation:  0.02506875991821289
local_in_edges_tensor generation:  0.02269768714904785
mini_batch_src_global generation:  0.05020284652709961
r_  generation:  0.3855135440826416
local_output_nid generation:  0.025290489196777344
local_in_edges_tensor generation:  0.02303290367126465
mini_batch_src_global generation:  0.04656624794006348
r_  generation:  0.3866260051727295
----------------------check_connections_block total spend ----------------------------- 4.53136944770813
generate_one_block  0.504774808883667
generate_one_block  0.4958343505859375
generate_one_block  0.4932844638824463
generate_one_block  0.4997520446777344
generate_one_block  0.49987053871154785
generate_one_block  0.4992802143096924
generate_one_block  0.4952366352081299
generate_one_block  0.5296304225921631
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03555750846862793
gen group dst list time:  0.03909420967102051
time for parepare:  0.02152729034423828
local_output_nid generation:  0.030835866928100586
local_in_edges_tensor generation:  0.05259442329406738
mini_batch_src_global generation:  0.04617571830749512
r_  generation:  0.4918489456176758
local_output_nid generation:  0.03701949119567871
local_in_edges_tensor generation:  0.0535588264465332
mini_batch_src_global generation:  0.055371999740600586
r_  generation:  0.4950120449066162
local_output_nid generation:  0.03669118881225586
local_in_edges_tensor generation:  0.03914642333984375
mini_batch_src_global generation:  0.05725526809692383
r_  generation:  0.49453234672546387
local_output_nid generation:  0.037116289138793945
local_in_edges_tensor generation:  0.03528594970703125
mini_batch_src_global generation:  0.05675911903381348
r_  generation:  0.49677491188049316
local_output_nid generation:  0.036496877670288086
local_in_edges_tensor generation:  0.038071393966674805
mini_batch_src_global generation:  0.055795907974243164
r_  generation:  0.5021660327911377
local_output_nid generation:  0.03688859939575195
local_in_edges_tensor generation:  0.04036068916320801
mini_batch_src_global generation:  0.053930044174194336
r_  generation:  0.5039999485015869
local_output_nid generation:  0.04147672653198242
local_in_edges_tensor generation:  0.04216575622558594
mini_batch_src_global generation:  0.06804203987121582
r_  generation:  0.5135269165039062
local_output_nid generation:  0.039307355880737305
local_in_edges_tensor generation:  0.04640316963195801
mini_batch_src_global generation:  0.06142783164978027
r_  generation:  0.5046679973602295
----------------------check_connections_block total spend ----------------------------- 6.01173996925354
generate_one_block  0.6360406875610352
generate_one_block  0.6222343444824219
generate_one_block  0.6340796947479248
generate_one_block  0.6197574138641357
generate_one_block  0.6102018356323242
generate_one_block  0.6209878921508789
generate_one_block  0.6223626136779785
generate_one_block  0.6257827281951904
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13855886459350586  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

connection checking time:  10.54310941696167
block generation total time  9.009110689163208
average batch blocks generation time:  1.126138836145401
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1042633056640625  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9495940208435059  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10518932342529297  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.953101634979248  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10404586791992188  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9517917633056641  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10550212860107422  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9514327049255371  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10438823699951172  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9503879547119141  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1051473617553711  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9510064125061035  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1045069694519043  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9515385627746582  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1053466796875  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9535565376281738  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08146777749061584 |0.01748347282409668 |0.0037488043308258057 |9.581446647644043e-05 |0.003161013126373291 |0.0023126602172851562 |
----------------------------------------------------------pseudo_mini_loss sum 2.1036553382873535
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  3056109
Number of first layer input nodes during this epoch:  1297819
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1381082534790039  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04134702682495117
random selection method range initialization spend 0.006206512451171875
time for parepare:  0.0211484432220459
local_output_nid generation:  0.004513978958129883
local_in_edges_tensor generation:  0.01061391830444336
mini_batch_src_global generation:  0.003742694854736328
r_  generation:  0.04235053062438965
local_output_nid generation:  0.006071805953979492
local_in_edges_tensor generation:  0.0033724308013916016
mini_batch_src_global generation:  0.004873991012573242
r_  generation:  0.04529881477355957
local_output_nid generation:  0.006133317947387695
local_in_edges_tensor generation:  0.0033371448516845703
mini_batch_src_global generation:  0.0033655166625976562
r_  generation:  0.046231985092163086
local_output_nid generation:  0.0062160491943359375
local_in_edges_tensor generation:  0.0032503604888916016
mini_batch_src_global generation:  0.0034971237182617188
r_  generation:  0.0482029914855957
local_output_nid generation:  0.006211996078491211
local_in_edges_tensor generation:  0.0033960342407226562
mini_batch_src_global generation:  0.0038542747497558594
r_  generation:  0.0488431453704834
local_output_nid generation:  0.006229400634765625
local_in_edges_tensor generation:  0.0033659934997558594
mini_batch_src_global generation:  0.003997325897216797
r_  generation:  0.04957866668701172
local_output_nid generation:  0.006216287612915039
local_in_edges_tensor generation:  0.003360748291015625
mini_batch_src_global generation:  0.004113197326660156
r_  generation:  0.04961848258972168
local_output_nid generation:  0.006191253662109375
local_in_edges_tensor generation:  0.0033266544342041016
mini_batch_src_global generation:  0.004124879837036133
r_  generation:  0.04856133460998535
----------------------check_connections_block total spend ----------------------------- 0.6028008460998535
generate_one_block  0.05901789665222168
generate_one_block  0.061147451400756836
generate_one_block  0.06142568588256836
generate_one_block  0.06181645393371582
generate_one_block  0.06207728385925293
generate_one_block  0.06217312812805176
generate_one_block  0.0656883716583252
generate_one_block  0.06208491325378418
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.042250633239746094
gen group dst list time:  0.021642446517944336
time for parepare:  0.033329010009765625
local_output_nid generation:  0.019353389739990234
local_in_edges_tensor generation:  0.033212900161743164
mini_batch_src_global generation:  0.03700375556945801
r_  generation:  0.35797810554504395
local_output_nid generation:  0.025824785232543945
local_in_edges_tensor generation:  0.028408527374267578
mini_batch_src_global generation:  0.04867410659790039
r_  generation:  0.3795499801635742
local_output_nid generation:  0.025751829147338867
local_in_edges_tensor generation:  0.024623394012451172
mini_batch_src_global generation:  0.04617118835449219
r_  generation:  0.38669276237487793
local_output_nid generation:  0.02711200714111328
local_in_edges_tensor generation:  0.022252321243286133
mini_batch_src_global generation:  0.04562258720397949
r_  generation:  0.395676851272583
local_output_nid generation:  0.02580571174621582
local_in_edges_tensor generation:  0.024230480194091797
mini_batch_src_global generation:  0.049480438232421875
r_  generation:  0.3984534740447998
local_output_nid generation:  0.02493429183959961
local_in_edges_tensor generation:  0.03780651092529297
mini_batch_src_global generation:  0.05215120315551758
r_  generation:  0.38930845260620117
local_output_nid generation:  0.0260927677154541
local_in_edges_tensor generation:  0.02749037742614746
mini_batch_src_global generation:  0.049127817153930664
r_  generation:  0.3947489261627197
local_output_nid generation:  0.025092601776123047
local_in_edges_tensor generation:  0.021854639053344727
mini_batch_src_global generation:  0.04666709899902344
r_  generation:  0.3791470527648926
----------------------check_connections_block total spend ----------------------------- 4.569228172302246
generate_one_block  0.48863744735717773
generate_one_block  0.494905948638916
generate_one_block  0.4977548122406006
generate_one_block  0.4944956302642822
generate_one_block  0.4968881607055664
generate_one_block  0.4901087284088135
generate_one_block  0.5180072784423828
generate_one_block  0.5220909118652344
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.034813880920410156
gen group dst list time:  0.0401303768157959
time for parepare:  0.019214391708374023
local_output_nid generation:  0.03263497352600098
local_in_edges_tensor generation:  0.04830503463745117
mini_batch_src_global generation:  0.046361684799194336
r_  generation:  0.49042844772338867
local_output_nid generation:  0.03821611404418945
local_in_edges_tensor generation:  0.048544883728027344
mini_batch_src_global generation:  0.06247711181640625
r_  generation:  0.5141310691833496
local_output_nid generation:  0.04079842567443848
local_in_edges_tensor generation:  0.04356098175048828
mini_batch_src_global generation:  0.05859494209289551
r_  generation:  0.4963226318359375
local_output_nid generation:  0.03746962547302246
local_in_edges_tensor generation:  0.03736448287963867
mini_batch_src_global generation:  0.05333876609802246
r_  generation:  0.49780964851379395
local_output_nid generation:  0.03783130645751953
local_in_edges_tensor generation:  0.03315424919128418
mini_batch_src_global generation:  0.054244041442871094
r_  generation:  0.5023751258850098
local_output_nid generation:  0.03790783882141113
local_in_edges_tensor generation:  0.03708148002624512
mini_batch_src_global generation:  0.05435538291931152
r_  generation:  0.5008797645568848
local_output_nid generation:  0.03944993019104004
local_in_edges_tensor generation:  0.03589200973510742
mini_batch_src_global generation:  0.05443406105041504
r_  generation:  0.5151443481445312
local_output_nid generation:  0.03764510154724121
local_in_edges_tensor generation:  0.03277397155761719
mini_batch_src_global generation:  0.057953834533691406
r_  generation:  0.5056924819946289
----------------------check_connections_block total spend ----------------------------- 6.007258892059326
generate_one_block  0.6370561122894287
generate_one_block  0.6191518306732178
generate_one_block  0.6245014667510986
generate_one_block  0.6296858787536621
generate_one_block  0.6269254684448242
generate_one_block  0.6432287693023682
generate_one_block  0.6317126750946045
generate_one_block  0.6203920841217041
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1381082534790039  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

connection checking time:  10.576487064361572
block generation total time  9.035543203353882
average batch blocks generation time:  1.1294429004192352
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1034083366394043  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9404392242431641  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10519027709960938  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9515442848205566  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10452699661254883  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9514665603637695  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10379600524902344  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9506001472473145  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10526561737060547  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9539556503295898  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10372447967529297  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9506626129150391  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10523128509521484  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9526681900024414  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10393047332763672  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9486298561096191  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08233341574668884 |0.01934373378753662 |0.003429979085922241 |9.194016456604004e-05 |0.0034440457820892334 |0.0029382705688476562 |
----------------------------------------------------------pseudo_mini_loss sum 1.9521926641464233
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  3053621
Number of first layer input nodes during this epoch:  1297398
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13789701461791992  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026323318481445312
random selection method range initialization spend 0.005399227142333984
time for parepare:  0.0175020694732666
local_output_nid generation:  0.004640102386474609
local_in_edges_tensor generation:  0.007460117340087891
mini_batch_src_global generation:  0.007071256637573242
r_  generation:  0.04418206214904785
local_output_nid generation:  0.008324146270751953
local_in_edges_tensor generation:  0.0044879913330078125
mini_batch_src_global generation:  0.008709192276000977
r_  generation:  0.05745387077331543
local_output_nid generation:  0.008254051208496094
local_in_edges_tensor generation:  0.003869295120239258
mini_batch_src_global generation:  0.0037457942962646484
r_  generation:  0.04840445518493652
local_output_nid generation:  0.007214546203613281
local_in_edges_tensor generation:  0.0035657882690429688
mini_batch_src_global generation:  0.003895998001098633
r_  generation:  0.0503084659576416
local_output_nid generation:  0.006742954254150391
local_in_edges_tensor generation:  0.003381967544555664
mini_batch_src_global generation:  0.004354000091552734
r_  generation:  0.05002403259277344
local_output_nid generation:  0.006531238555908203
local_in_edges_tensor generation:  0.003484010696411133
mini_batch_src_global generation:  0.004534721374511719
r_  generation:  0.05189657211303711
local_output_nid generation:  0.00640416145324707
local_in_edges_tensor generation:  0.0033173561096191406
mini_batch_src_global generation:  0.0046558380126953125
r_  generation:  0.048955678939819336
local_output_nid generation:  0.0062830448150634766
local_in_edges_tensor generation:  0.0033884048461914062
mini_batch_src_global generation:  0.004737377166748047
r_  generation:  0.05053234100341797
----------------------check_connections_block total spend ----------------------------- 0.6476967334747314
generate_one_block  0.06681990623474121
generate_one_block  0.06198477745056152
generate_one_block  0.0613253116607666
generate_one_block  0.06260347366333008
generate_one_block  0.06121540069580078
generate_one_block  0.06151437759399414
generate_one_block  0.06559467315673828
generate_one_block  0.0626678466796875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04209280014038086
gen group dst list time:  0.0157167911529541
time for parepare:  0.01901984214782715
local_output_nid generation:  0.01452779769897461
local_in_edges_tensor generation:  0.02926802635192871
mini_batch_src_global generation:  0.038049936294555664
r_  generation:  0.37738633155822754
local_output_nid generation:  0.02147650718688965
local_in_edges_tensor generation:  0.03166627883911133
mini_batch_src_global generation:  0.04589343070983887
r_  generation:  0.3875772953033447
local_output_nid generation:  0.021764039993286133
local_in_edges_tensor generation:  0.03167581558227539
mini_batch_src_global generation:  0.056122541427612305
r_  generation:  0.40076112747192383
local_output_nid generation:  0.02344489097595215
local_in_edges_tensor generation:  0.02721095085144043
mini_batch_src_global generation:  0.04772830009460449
r_  generation:  0.3829386234283447
local_output_nid generation:  0.02121281623840332
local_in_edges_tensor generation:  0.025032758712768555
mini_batch_src_global generation:  0.04591941833496094
r_  generation:  0.3809814453125
local_output_nid generation:  0.020110368728637695
local_in_edges_tensor generation:  0.02101612091064453
mini_batch_src_global generation:  0.04636645317077637
r_  generation:  0.3817596435546875
local_output_nid generation:  0.020149946212768555
local_in_edges_tensor generation:  0.020560503005981445
mini_batch_src_global generation:  0.04622292518615723
r_  generation:  0.38062596321105957
local_output_nid generation:  0.020459651947021484
local_in_edges_tensor generation:  0.022332429885864258
mini_batch_src_global generation:  0.04864501953125
r_  generation:  0.4052577018737793
----------------------check_connections_block total spend ----------------------------- 4.508968830108643
generate_one_block  0.5001063346862793
generate_one_block  0.5074834823608398
generate_one_block  0.4997680187225342
generate_one_block  0.5114176273345947
generate_one_block  0.4951004981994629
generate_one_block  0.49284791946411133
generate_one_block  0.48865652084350586
generate_one_block  0.5298213958740234
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.036698341369628906
gen group dst list time:  0.03820180892944336
time for parepare:  0.020548582077026367
local_output_nid generation:  0.03138256072998047
local_in_edges_tensor generation:  0.05437803268432617
mini_batch_src_global generation:  0.04445171356201172
r_  generation:  0.483318567276001
local_output_nid generation:  0.0370638370513916
local_in_edges_tensor generation:  0.048319101333618164
mini_batch_src_global generation:  0.05777096748352051
r_  generation:  0.4998972415924072
local_output_nid generation:  0.03688931465148926
local_in_edges_tensor generation:  0.03444385528564453
mini_batch_src_global generation:  0.05449867248535156
r_  generation:  0.4948289394378662
local_output_nid generation:  0.03671908378601074
local_in_edges_tensor generation:  0.03748297691345215
mini_batch_src_global generation:  0.05276036262512207
r_  generation:  0.5078091621398926
local_output_nid generation:  0.03710293769836426
local_in_edges_tensor generation:  0.041298627853393555
mini_batch_src_global generation:  0.05414628982543945
r_  generation:  0.5024375915527344
local_output_nid generation:  0.03671574592590332
local_in_edges_tensor generation:  0.042799949645996094
mini_batch_src_global generation:  0.054180145263671875
r_  generation:  0.5060913562774658
local_output_nid generation:  0.03724217414855957
local_in_edges_tensor generation:  0.03479290008544922
mini_batch_src_global generation:  0.0583653450012207
r_  generation:  0.5122897624969482
local_output_nid generation:  0.03765273094177246
local_in_edges_tensor generation:  0.03813886642456055
mini_batch_src_global generation:  0.06005549430847168
r_  generation:  0.5133316516876221
----------------------check_connections_block total spend ----------------------------- 6.000488519668579
generate_one_block  0.6404011249542236
generate_one_block  0.6222536563873291
generate_one_block  0.6158387660980225
generate_one_block  0.6152966022491455
generate_one_block  0.6176836490631104
generate_one_block  0.6294107437133789
generate_one_block  0.617232084274292
generate_one_block  0.6408288478851318
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13789701461791992  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

connection checking time:  10.509457349777222
block generation total time  9.024147272109985
average batch blocks generation time:  1.1280184090137482
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10522174835205078  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9494991302490234  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10460042953491211  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.953341007232666  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10500383377075195  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9504694938659668  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1044459342956543  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.951420783996582  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1049795150756836  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9498357772827148  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10445070266723633  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9497594833374023  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10508298873901367  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9441180229187012  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10445594787597656  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9533743858337402  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0853310227394104 |0.017803043127059937 |0.0037047266960144043 |9.307265281677246e-05 |0.0037834644317626953 |0.0013053417205810547 |
----------------------------------------------------------pseudo_mini_loss sum 1.8710243701934814
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  3053423
Number of first layer input nodes during this epoch:  1297209
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13750505447387695  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.05771040916442871
random selection method range initialization spend 0.0056476593017578125
time for parepare:  0.01760554313659668
local_output_nid generation:  0.004452943801879883
local_in_edges_tensor generation:  0.0063571929931640625
mini_batch_src_global generation:  0.0037851333618164062
r_  generation:  0.04384112358093262
local_output_nid generation:  0.005986928939819336
local_in_edges_tensor generation:  0.003197193145751953
mini_batch_src_global generation:  0.008856058120727539
r_  generation:  0.045966386795043945
local_output_nid generation:  0.0066487789154052734
local_in_edges_tensor generation:  0.0035431385040283203
mini_batch_src_global generation:  0.003407001495361328
r_  generation:  0.04721546173095703
local_output_nid generation:  0.006143808364868164
local_in_edges_tensor generation:  0.003355264663696289
mini_batch_src_global generation:  0.003541707992553711
r_  generation:  0.04694342613220215
local_output_nid generation:  0.0060994625091552734
local_in_edges_tensor generation:  0.003294229507446289
mini_batch_src_global generation:  0.0037546157836914062
r_  generation:  0.04785013198852539
local_output_nid generation:  0.006157636642456055
local_in_edges_tensor generation:  0.003437519073486328
mini_batch_src_global generation:  0.004052877426147461
r_  generation:  0.04895758628845215
local_output_nid generation:  0.006109714508056641
local_in_edges_tensor generation:  0.003346681594848633
mini_batch_src_global generation:  0.004056453704833984
r_  generation:  0.04929995536804199
local_output_nid generation:  0.0069122314453125
local_in_edges_tensor generation:  0.0033292770385742188
mini_batch_src_global generation:  0.004141807556152344
r_  generation:  0.05101966857910156
----------------------check_connections_block total spend ----------------------------- 0.6113038063049316
generate_one_block  0.06175518035888672
generate_one_block  0.060979604721069336
generate_one_block  0.06159210205078125
generate_one_block  0.06086015701293945
generate_one_block  0.061368465423583984
generate_one_block  0.06248211860656738
generate_one_block  0.0658876895904541
generate_one_block  0.062020063400268555
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04376578330993652
gen group dst list time:  0.01581883430480957
time for parepare:  0.020665884017944336
local_output_nid generation:  0.015282630920410156
local_in_edges_tensor generation:  0.037206411361694336
mini_batch_src_global generation:  0.03774094581604004
r_  generation:  0.3643941879272461
local_output_nid generation:  0.021486520767211914
local_in_edges_tensor generation:  0.026227474212646484
mini_batch_src_global generation:  0.046799659729003906
r_  generation:  0.37332606315612793
local_output_nid generation:  0.021172046661376953
local_in_edges_tensor generation:  0.020911216735839844
mini_batch_src_global generation:  0.044445037841796875
r_  generation:  0.3748958110809326
local_output_nid generation:  0.021107912063598633
local_in_edges_tensor generation:  0.02205204963684082
mini_batch_src_global generation:  0.04527020454406738
r_  generation:  0.37349867820739746
local_output_nid generation:  0.02103567123413086
local_in_edges_tensor generation:  0.02237868309020996
mini_batch_src_global generation:  0.04581737518310547
r_  generation:  0.3802652359008789
local_output_nid generation:  0.020497798919677734
local_in_edges_tensor generation:  0.022522926330566406
mini_batch_src_global generation:  0.04817628860473633
r_  generation:  0.3829960823059082
local_output_nid generation:  0.020587921142578125
local_in_edges_tensor generation:  0.02189183235168457
mini_batch_src_global generation:  0.04651141166687012
r_  generation:  0.3858511447906494
local_output_nid generation:  0.020605802536010742
local_in_edges_tensor generation:  0.027001619338989258
mini_batch_src_global generation:  0.04676485061645508
r_  generation:  0.3858811855316162
----------------------check_connections_block total spend ----------------------------- 4.397609233856201
generate_one_block  0.5068061351776123
generate_one_block  0.49822092056274414
generate_one_block  0.5002732276916504
generate_one_block  0.49382734298706055
generate_one_block  0.4990973472595215
generate_one_block  0.4913947582244873
generate_one_block  0.49213504791259766
generate_one_block  0.5280499458312988
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03235268592834473
gen group dst list time:  0.03794717788696289
time for parepare:  0.020879030227661133
local_output_nid generation:  0.03136897087097168
local_in_edges_tensor generation:  0.05483531951904297
mini_batch_src_global generation:  0.046079158782958984
r_  generation:  0.4764885902404785
local_output_nid generation:  0.03698110580444336
local_in_edges_tensor generation:  0.04171586036682129
mini_batch_src_global generation:  0.055448055267333984
r_  generation:  0.4882090091705322
local_output_nid generation:  0.03634762763977051
local_in_edges_tensor generation:  0.034999847412109375
mini_batch_src_global generation:  0.054656028747558594
r_  generation:  0.4873652458190918
local_output_nid generation:  0.036665916442871094
local_in_edges_tensor generation:  0.04802346229553223
mini_batch_src_global generation:  0.052843570709228516
r_  generation:  0.4970877170562744
local_output_nid generation:  0.03694462776184082
local_in_edges_tensor generation:  0.0398869514465332
mini_batch_src_global generation:  0.05563831329345703
r_  generation:  0.49911022186279297
local_output_nid generation:  0.03644728660583496
local_in_edges_tensor generation:  0.035283565521240234
mini_batch_src_global generation:  0.055748701095581055
r_  generation:  0.5069472789764404
local_output_nid generation:  0.03678154945373535
local_in_edges_tensor generation:  0.03583097457885742
mini_batch_src_global generation:  0.05505847930908203
r_  generation:  0.5048367977142334
local_output_nid generation:  0.03673386573791504
local_in_edges_tensor generation:  0.035666704177856445
mini_batch_src_global generation:  0.05731773376464844
r_  generation:  0.5086252689361572
----------------------check_connections_block total spend ----------------------------- 5.925773859024048
generate_one_block  0.6395153999328613
generate_one_block  0.629051923751831
generate_one_block  0.6161496639251709
generate_one_block  0.6312055587768555
generate_one_block  0.6383113861083984
generate_one_block  0.6222317218780518
generate_one_block  0.6125345230102539
generate_one_block  0.6243882179260254
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13750505447387695  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

connection checking time:  10.323383092880249
block generation total time  9.023193120956421
average batch blocks generation time:  1.1278991401195526
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10462665557861328  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9540624618530273  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10492753982543945  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9497866630554199  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1052241325378418  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.947845458984375  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10410070419311523  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9450774192810059  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10485315322875977  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9516282081604004  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10455513000488281  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9504561424255371  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10511970520019531  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9507813453674316  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10441064834594727  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9514975547790527  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08491310477256775 |0.01704612374305725 |0.0036596953868865967 |9.551644325256348e-05 |0.003751903772354126 |0.003068685531616211 |
----------------------------------------------------------pseudo_mini_loss sum 1.7981374263763428
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  3053061
Number of first layer input nodes during this epoch:  1297169
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13738727569580078  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02562427520751953
random selection method range initialization spend 0.0053288936614990234
time for parepare:  0.01692676544189453
local_output_nid generation:  0.0045473575592041016
local_in_edges_tensor generation:  0.007287740707397461
mini_batch_src_global generation:  0.003725767135620117
r_  generation:  0.0423123836517334
local_output_nid generation:  0.006003141403198242
local_in_edges_tensor generation:  0.0033707618713378906
mini_batch_src_global generation:  0.004847288131713867
r_  generation:  0.0457918643951416
local_output_nid generation:  0.0062465667724609375
local_in_edges_tensor generation:  0.0033919811248779297
mini_batch_src_global generation:  0.0034902095794677734
r_  generation:  0.047583580017089844
local_output_nid generation:  0.006190061569213867
local_in_edges_tensor generation:  0.0033872127532958984
mini_batch_src_global generation:  0.0035305023193359375
r_  generation:  0.047113656997680664
local_output_nid generation:  0.00617218017578125
local_in_edges_tensor generation:  0.003494739532470703
mini_batch_src_global generation:  0.003953218460083008
r_  generation:  0.0487363338470459
local_output_nid generation:  0.006156206130981445
local_in_edges_tensor generation:  0.003551483154296875
mini_batch_src_global generation:  0.003989696502685547
r_  generation:  0.047525882720947266
local_output_nid generation:  0.006173610687255859
local_in_edges_tensor generation:  0.0035638809204101562
mini_batch_src_global generation:  0.004152774810791016
r_  generation:  0.049019575119018555
local_output_nid generation:  0.0062084197998046875
local_in_edges_tensor generation:  0.0034134387969970703
mini_batch_src_global generation:  0.004134178161621094
r_  generation:  0.04991459846496582
----------------------check_connections_block total spend ----------------------------- 0.5983219146728516
generate_one_block  0.059784889221191406
generate_one_block  0.06070375442504883
generate_one_block  0.06252360343933105
generate_one_block  0.06229114532470703
generate_one_block  0.062290191650390625
generate_one_block  0.06142091751098633
generate_one_block  0.06647491455078125
generate_one_block  0.06579804420471191
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04630017280578613
gen group dst list time:  0.016825199127197266
time for parepare:  0.023090124130249023
local_output_nid generation:  0.01560831069946289
local_in_edges_tensor generation:  0.03325819969177246
mini_batch_src_global generation:  0.03661227226257324
r_  generation:  0.36504364013671875
local_output_nid generation:  0.02098536491394043
local_in_edges_tensor generation:  0.0294339656829834
mini_batch_src_global generation:  0.04455709457397461
r_  generation:  0.39305830001831055
local_output_nid generation:  0.02347731590270996
local_in_edges_tensor generation:  0.027520179748535156
mini_batch_src_global generation:  0.045450687408447266
r_  generation:  0.3850553035736084
local_output_nid generation:  0.021278858184814453
local_in_edges_tensor generation:  0.023984670639038086
mini_batch_src_global generation:  0.04557323455810547
r_  generation:  0.37722277641296387
local_output_nid generation:  0.02140355110168457
local_in_edges_tensor generation:  0.022421836853027344
mini_batch_src_global generation:  0.04834699630737305
r_  generation:  0.3898799419403076
local_output_nid generation:  0.02016592025756836
local_in_edges_tensor generation:  0.021105527877807617
mini_batch_src_global generation:  0.04662919044494629
r_  generation:  0.3837134838104248
local_output_nid generation:  0.020331382751464844
local_in_edges_tensor generation:  0.02243638038635254
mini_batch_src_global generation:  0.04674720764160156
r_  generation:  0.38936424255371094
local_output_nid generation:  0.02001476287841797
local_in_edges_tensor generation:  0.02262091636657715
mini_batch_src_global generation:  0.04636049270629883
r_  generation:  0.39473867416381836
----------------------check_connections_block total spend ----------------------------- 4.472004175186157
generate_one_block  0.4934704303741455
generate_one_block  0.49366211891174316
generate_one_block  0.5065991878509521
generate_one_block  0.49942517280578613
generate_one_block  0.5078551769256592
generate_one_block  0.49695849418640137
generate_one_block  0.5006759166717529
generate_one_block  0.5278892517089844
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.034780263900756836
gen group dst list time:  0.03902077674865723
time for parepare:  0.020306825637817383
local_output_nid generation:  0.031259775161743164
local_in_edges_tensor generation:  0.05085587501525879
mini_batch_src_global generation:  0.046896934509277344
r_  generation:  0.4778099060058594
local_output_nid generation:  0.036283254623413086
local_in_edges_tensor generation:  0.03942584991455078
mini_batch_src_global generation:  0.05767679214477539
r_  generation:  0.48818325996398926
local_output_nid generation:  0.036116600036621094
local_in_edges_tensor generation:  0.03547310829162598
mini_batch_src_global generation:  0.057192087173461914
r_  generation:  0.49303197860717773
local_output_nid generation:  0.03625345230102539
local_in_edges_tensor generation:  0.033219099044799805
mini_batch_src_global generation:  0.05376410484313965
r_  generation:  0.49918341636657715
local_output_nid generation:  0.03719496726989746
local_in_edges_tensor generation:  0.040009260177612305
mini_batch_src_global generation:  0.0551905632019043
r_  generation:  0.499312162399292
local_output_nid generation:  0.036749839782714844
local_in_edges_tensor generation:  0.03937649726867676
mini_batch_src_global generation:  0.054241180419921875
r_  generation:  0.5077416896820068
local_output_nid generation:  0.036802053451538086
local_in_edges_tensor generation:  0.03346514701843262
mini_batch_src_global generation:  0.056113243103027344
r_  generation:  0.5088205337524414
local_output_nid generation:  0.0366518497467041
local_in_edges_tensor generation:  0.036926984786987305
mini_batch_src_global generation:  0.05649518966674805
r_  generation:  0.5127444267272949
----------------------check_connections_block total spend ----------------------------- 5.941805124282837
generate_one_block  0.6427168846130371
generate_one_block  0.6263418197631836
generate_one_block  0.6230127811431885
generate_one_block  0.6218698024749756
generate_one_block  0.6206040382385254
generate_one_block  0.6121909618377686
generate_one_block  0.6222608089447021
generate_one_block  0.6230301856994629
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13738727569580078  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

connection checking time:  10.413809299468994
block generation total time  9.018563032150269
average batch blocks generation time:  1.1273203790187836
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1036825180053711  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9455633163452148  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10484790802001953  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9499702453613281  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10503578186035156  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9520540237426758  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10488176345825195  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9522700309753418  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10446500778198242  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9524540901184082  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10401105880737305  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9503250122070312  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1056203842163086  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9521884918212891  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10361289978027344  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9495754241943359  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08482348918914795 |0.017222225666046143 |0.004070103168487549 |9.688735008239746e-05 |0.003676176071166992 |0.0013093948364257812 |
----------------------------------------------------------pseudo_mini_loss sum 1.7013025283813477
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  3053989
Number of first layer input nodes during this epoch:  1297331
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13709545135498047  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026178836822509766
random selection method range initialization spend 0.0049896240234375
time for parepare:  0.01731133460998535
local_output_nid generation:  0.004525423049926758
local_in_edges_tensor generation:  0.008680343627929688
mini_batch_src_global generation:  0.0037157535552978516
r_  generation:  0.0428621768951416
local_output_nid generation:  0.006017208099365234
local_in_edges_tensor generation:  0.003463268280029297
mini_batch_src_global generation:  0.00503993034362793
r_  generation:  0.045623779296875
local_output_nid generation:  0.0061299800872802734
local_in_edges_tensor generation:  0.0033485889434814453
mini_batch_src_global generation:  0.003427743911743164
r_  generation:  0.04590940475463867
local_output_nid generation:  0.006125211715698242
local_in_edges_tensor generation:  0.0033676624298095703
mini_batch_src_global generation:  0.0036983489990234375
r_  generation:  0.04801321029663086
local_output_nid generation:  0.006204366683959961
local_in_edges_tensor generation:  0.0034253597259521484
mini_batch_src_global generation:  0.003856658935546875
r_  generation:  0.04762077331542969
local_output_nid generation:  0.006154298782348633
local_in_edges_tensor generation:  0.003418445587158203
mini_batch_src_global generation:  0.0038690567016601562
r_  generation:  0.04781007766723633
local_output_nid generation:  0.006143808364868164
local_in_edges_tensor generation:  0.003347635269165039
mini_batch_src_global generation:  0.004034519195556641
r_  generation:  0.050405025482177734
local_output_nid generation:  0.006247043609619141
local_in_edges_tensor generation:  0.005452394485473633
mini_batch_src_global generation:  0.0043528079986572266
r_  generation:  0.04910993576049805
----------------------check_connections_block total spend ----------------------------- 0.5987420082092285
generate_one_block  0.06009674072265625
generate_one_block  0.0614776611328125
generate_one_block  0.060877084732055664
generate_one_block  0.06259322166442871
generate_one_block  0.06085062026977539
generate_one_block  0.06196260452270508
generate_one_block  0.06620550155639648
generate_one_block  0.06255030632019043
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03806185722351074
gen group dst list time:  0.016115665435791016
time for parepare:  0.01944112777709961
local_output_nid generation:  0.01518106460571289
local_in_edges_tensor generation:  0.03440070152282715
mini_batch_src_global generation:  0.037374019622802734
r_  generation:  0.3662378787994385
local_output_nid generation:  0.0209197998046875
local_in_edges_tensor generation:  0.027669191360473633
mini_batch_src_global generation:  0.04734301567077637
r_  generation:  0.39227294921875
local_output_nid generation:  0.021598339080810547
local_in_edges_tensor generation:  0.027688264846801758
mini_batch_src_global generation:  0.04797840118408203
r_  generation:  0.37605786323547363
local_output_nid generation:  0.022518634796142578
local_in_edges_tensor generation:  0.031684160232543945
mini_batch_src_global generation:  0.04747891426086426
r_  generation:  0.3879365921020508
local_output_nid generation:  0.02169489860534668
local_in_edges_tensor generation:  0.020220041275024414
mini_batch_src_global generation:  0.046499013900756836
r_  generation:  0.38216376304626465
local_output_nid generation:  0.020188570022583008
local_in_edges_tensor generation:  0.020953893661499023
mini_batch_src_global generation:  0.04616260528564453
r_  generation:  0.37491536140441895
local_output_nid generation:  0.02021479606628418
local_in_edges_tensor generation:  0.02213120460510254
mini_batch_src_global generation:  0.0484318733215332
r_  generation:  0.38811445236206055
local_output_nid generation:  0.02218484878540039
local_in_edges_tensor generation:  0.023915767669677734
mini_batch_src_global generation:  0.046898603439331055
r_  generation:  0.3854072093963623
----------------------check_connections_block total spend ----------------------------- 4.4525909423828125
generate_one_block  0.49724888801574707
generate_one_block  0.49306559562683105
generate_one_block  0.4858522415161133
generate_one_block  0.4967184066772461
generate_one_block  0.49695277214050293
generate_one_block  0.48572301864624023
generate_one_block  0.501960277557373
generate_one_block  0.5330636501312256
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.037496089935302734
gen group dst list time:  0.03969836235046387
time for parepare:  0.022301197052001953
local_output_nid generation:  0.03187847137451172
local_in_edges_tensor generation:  0.05788135528564453
mini_batch_src_global generation:  0.04643535614013672
r_  generation:  0.4938504695892334
local_output_nid generation:  0.038527488708496094
local_in_edges_tensor generation:  0.0425565242767334
mini_batch_src_global generation:  0.055280447006225586
r_  generation:  0.48983049392700195
local_output_nid generation:  0.037091732025146484
local_in_edges_tensor generation:  0.033555030822753906
mini_batch_src_global generation:  0.054990291595458984
r_  generation:  0.48920607566833496
local_output_nid generation:  0.037500858306884766
local_in_edges_tensor generation:  0.038367509841918945
mini_batch_src_global generation:  0.05289816856384277
r_  generation:  0.49747538566589355
local_output_nid generation:  0.03727841377258301
local_in_edges_tensor generation:  0.03565359115600586
mini_batch_src_global generation:  0.0534663200378418
r_  generation:  0.49773335456848145
local_output_nid generation:  0.03730511665344238
local_in_edges_tensor generation:  0.03838634490966797
mini_batch_src_global generation:  0.05377817153930664
r_  generation:  0.5163156986236572
local_output_nid generation:  0.03721475601196289
local_in_edges_tensor generation:  0.03365492820739746
mini_batch_src_global generation:  0.054060935974121094
r_  generation:  0.5053353309631348
local_output_nid generation:  0.038125038146972656
local_in_edges_tensor generation:  0.03314995765686035
mini_batch_src_global generation:  0.054711341857910156
r_  generation:  0.5143892765045166
----------------------check_connections_block total spend ----------------------------- 5.9637227058410645
generate_one_block  0.6244475841522217
generate_one_block  0.6248228549957275
generate_one_block  0.6194407939910889
generate_one_block  0.6308555603027344
generate_one_block  0.6360588073730469
generate_one_block  0.6133003234863281
generate_one_block  0.6196224689483643
generate_one_block  0.6224086284637451
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13709545135498047  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

connection checking time:  10.416313648223877
block generation total time  8.981541872024536
average batch blocks generation time:  1.122692734003067
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10518598556518555  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.952970027923584  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10434579849243164  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9498434066772461  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10508537292480469  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9447941780090332  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1043696403503418  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9551281929016113  GigaBytes
Max Memory Allocated: 1.0960793495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10446977615356445  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9515352249145508  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10432577133178711  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9497494697570801  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10582637786865234  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9497995376586914  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1042180061340332  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9505534172058105  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08371055126190186 |0.017826348543167114 |0.0061511993408203125 |0.00010329484939575195 |0.0035784542560577393 |0.0029098987579345703 |
----------------------------------------------------------pseudo_mini_loss sum 1.6365033388137817
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  3054630
Number of first layer input nodes during this epoch:  1297711
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13754606246948242  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024158477783203125
random selection method range initialization spend 0.006451606750488281
time for parepare:  0.019125938415527344
local_output_nid generation:  0.006105184555053711
local_in_edges_tensor generation:  0.007785320281982422
mini_batch_src_global generation:  0.004456281661987305
r_  generation:  0.04351663589477539
local_output_nid generation:  0.0059967041015625
local_in_edges_tensor generation:  0.003359079360961914
mini_batch_src_global generation:  0.0051233768463134766
r_  generation:  0.047173500061035156
local_output_nid generation:  0.006180763244628906
local_in_edges_tensor generation:  0.0033478736877441406
mini_batch_src_global generation:  0.0033588409423828125
r_  generation:  0.04582691192626953
local_output_nid generation:  0.007756710052490234
local_in_edges_tensor generation:  0.0034270286560058594
mini_batch_src_global generation:  0.003378629684448242
r_  generation:  0.04703164100646973
local_output_nid generation:  0.006175041198730469
local_in_edges_tensor generation:  0.0034606456756591797
mini_batch_src_global generation:  0.0036780834197998047
r_  generation:  0.05000472068786621
local_output_nid generation:  0.006207942962646484
local_in_edges_tensor generation:  0.0033867359161376953
mini_batch_src_global generation:  0.0038878917694091797
r_  generation:  0.04843640327453613
local_output_nid generation:  0.0077779293060302734
local_in_edges_tensor generation:  0.0034220218658447266
mini_batch_src_global generation:  0.003989458084106445
r_  generation:  0.04829740524291992
local_output_nid generation:  0.006128787994384766
local_in_edges_tensor generation:  0.003443479537963867
mini_batch_src_global generation:  0.004037618637084961
r_  generation:  0.05019783973693848
----------------------check_connections_block total spend ----------------------------- 0.606776237487793
generate_one_block  0.06590008735656738
generate_one_block  0.06177210807800293
generate_one_block  0.06370687484741211
generate_one_block  0.06198859214782715
generate_one_block  0.06433796882629395
generate_one_block  0.06238055229187012
generate_one_block  0.06743359565734863
generate_one_block  0.06568264961242676
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.041812896728515625
gen group dst list time:  0.016266345977783203
time for parepare:  0.022562265396118164
local_output_nid generation:  0.015479087829589844
local_in_edges_tensor generation:  0.03522634506225586
mini_batch_src_global generation:  0.03757500648498535
r_  generation:  0.37676262855529785
local_output_nid generation:  0.02106451988220215
local_in_edges_tensor generation:  0.02815556526184082
mini_batch_src_global generation:  0.049695491790771484
r_  generation:  0.4039182662963867
local_output_nid generation:  0.023774385452270508
local_in_edges_tensor generation:  0.023192167282104492
mini_batch_src_global generation:  0.044805049896240234
r_  generation:  0.3850686550140381
local_output_nid generation:  0.021201610565185547
local_in_edges_tensor generation:  0.023308753967285156
mini_batch_src_global generation:  0.04510831832885742
r_  generation:  0.38097524642944336
local_output_nid generation:  0.021820783615112305
local_in_edges_tensor generation:  0.023132801055908203
mini_batch_src_global generation:  0.04748344421386719
r_  generation:  0.3825962543487549
local_output_nid generation:  0.02020883560180664
local_in_edges_tensor generation:  0.022775650024414062
mini_batch_src_global generation:  0.04657101631164551
r_  generation:  0.38068294525146484
local_output_nid generation:  0.020184755325317383
local_in_edges_tensor generation:  0.023056507110595703
mini_batch_src_global generation:  0.04850959777832031
r_  generation:  0.3843080997467041
local_output_nid generation:  0.02042245864868164
local_in_edges_tensor generation:  0.022388458251953125
mini_batch_src_global generation:  0.048810482025146484
r_  generation:  0.39725255966186523
----------------------check_connections_block total spend ----------------------------- 4.4896399974823
generate_one_block  0.5080583095550537
generate_one_block  0.4982483386993408
generate_one_block  0.49959516525268555
generate_one_block  0.49486470222473145
generate_one_block  0.49738502502441406
generate_one_block  0.4887528419494629
generate_one_block  0.4914891719818115
generate_one_block  0.5332057476043701
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.033272743225097656
gen group dst list time:  0.038692474365234375
time for parepare:  0.020461320877075195
local_output_nid generation:  0.031630754470825195
local_in_edges_tensor generation:  0.05414986610412598
mini_batch_src_global generation:  0.046356916427612305
r_  generation:  0.48384833335876465
local_output_nid generation:  0.03645730018615723
local_in_edges_tensor generation:  0.0392911434173584
mini_batch_src_global generation:  0.055489540100097656
r_  generation:  0.4919319152832031
local_output_nid generation:  0.03656959533691406
local_in_edges_tensor generation:  0.03530120849609375
mini_batch_src_global generation:  0.05490279197692871
r_  generation:  0.5048506259918213
local_output_nid generation:  0.03705954551696777
local_in_edges_tensor generation:  0.03906702995300293
mini_batch_src_global generation:  0.05265021324157715
r_  generation:  0.4993588924407959
local_output_nid generation:  0.03771042823791504
local_in_edges_tensor generation:  0.03870058059692383
mini_batch_src_global generation:  0.07137799263000488
r_  generation:  0.511650562286377
local_output_nid generation:  0.03696775436401367
local_in_edges_tensor generation:  0.042835235595703125
mini_batch_src_global generation:  0.0596776008605957
r_  generation:  0.5326025485992432
local_output_nid generation:  0.03993988037109375
local_in_edges_tensor generation:  0.04980731010437012
mini_batch_src_global generation:  0.059468984603881836
r_  generation:  0.5044834613800049
local_output_nid generation:  0.037406206130981445
local_in_edges_tensor generation:  0.03503775596618652
mini_batch_src_global generation:  0.05775785446166992
r_  generation:  0.5042648315429688
----------------------check_connections_block total spend ----------------------------- 6.061511516571045
generate_one_block  0.6284043788909912
generate_one_block  0.6317989826202393
generate_one_block  0.6297330856323242
generate_one_block  0.6303045749664307
generate_one_block  0.6361644268035889
generate_one_block  0.6424541473388672
generate_one_block  0.6272835731506348
generate_one_block  0.6174767017364502
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13754606246948242  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

connection checking time:  10.551151514053345
block generation total time  9.055219173431396
average batch blocks generation time:  1.1319023966789246
block dataloader generation time/epoch 21.724980115890503
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10509967803955078  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9530134201049805  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10377120971679688  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9494223594665527  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10503673553466797  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9511985778808594  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10431432723999023  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9474177360534668  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10488653182983398  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9514093399047852  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10442543029785156  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9509248733520508  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10516643524169922  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.952211856842041  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10422420501708984  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9511208534240723  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08583274483680725 |0.01890137791633606 |0.003567814826965332 |9.420514106750488e-05 |0.0038193166255950928 |0.001959085464477539 |
----------------------------------------------------------pseudo_mini_loss sum 1.5921844244003296
Total (block generation + training)time/epoch 22.702444553375244
Training time/epoch 0.9771809577941895
Training time without block to device /epoch 0.825969934463501
Training time without total dataloading part /epoch 0.06180977821350098
load block tensor time/epoch 0.686661958694458
block to device time/epoch 0.15121102333068848
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  3055066
Number of first layer input nodes during this epoch:  1297732
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13749408721923828  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02397894859313965
random selection method range initialization spend 0.0049588680267333984
time for parepare:  0.019081592559814453
local_output_nid generation:  0.004530668258666992
local_in_edges_tensor generation:  0.00669550895690918
mini_batch_src_global generation:  0.003789186477661133
r_  generation:  0.04214048385620117
local_output_nid generation:  0.005922555923461914
local_in_edges_tensor generation:  0.003284931182861328
mini_batch_src_global generation:  0.004910469055175781
r_  generation:  0.04492330551147461
local_output_nid generation:  0.0061016082763671875
local_in_edges_tensor generation:  0.0032956600189208984
mini_batch_src_global generation:  0.003464221954345703
r_  generation:  0.0445096492767334
local_output_nid generation:  0.006132841110229492
local_in_edges_tensor generation:  0.0034935474395751953
mini_batch_src_global generation:  0.0035817623138427734
r_  generation:  0.046053409576416016
local_output_nid generation:  0.0061032772064208984
local_in_edges_tensor generation:  0.0034189224243164062
mini_batch_src_global generation:  0.0037636756896972656
r_  generation:  0.04776406288146973
local_output_nid generation:  0.006139039993286133
local_in_edges_tensor generation:  0.00323486328125
mini_batch_src_global generation:  0.003966093063354492
r_  generation:  0.04927206039428711
local_output_nid generation:  0.006170749664306641
local_in_edges_tensor generation:  0.003449678421020508
mini_batch_src_global generation:  0.003966808319091797
r_  generation:  0.04810953140258789
local_output_nid generation:  0.0061147212982177734
local_in_edges_tensor generation:  0.003333568572998047
mini_batch_src_global generation:  0.004159212112426758
r_  generation:  0.05160856246948242
----------------------check_connections_block total spend ----------------------------- 0.5930931568145752
generate_one_block  0.06775093078613281
generate_one_block  0.061783790588378906
generate_one_block  0.06469225883483887
generate_one_block  0.06200575828552246
generate_one_block  0.06519556045532227
generate_one_block  0.0640726089477539
generate_one_block  0.06744098663330078
generate_one_block  0.06551218032836914
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03651833534240723
gen group dst list time:  0.016068458557128906
time for parepare:  0.022853851318359375
local_output_nid generation:  0.015329599380493164
local_in_edges_tensor generation:  0.03464317321777344
mini_batch_src_global generation:  0.03764963150024414
r_  generation:  0.37938833236694336
local_output_nid generation:  0.024782657623291016
local_in_edges_tensor generation:  0.030559062957763672
mini_batch_src_global generation:  0.05080270767211914
r_  generation:  0.3766763210296631
local_output_nid generation:  0.021204710006713867
local_in_edges_tensor generation:  0.021100282669067383
mini_batch_src_global generation:  0.045511722564697266
r_  generation:  0.37499451637268066
local_output_nid generation:  0.02082204818725586
local_in_edges_tensor generation:  0.021931886672973633
mini_batch_src_global generation:  0.044310569763183594
r_  generation:  0.3788487911224365
local_output_nid generation:  0.021010160446166992
local_in_edges_tensor generation:  0.020521879196166992
mini_batch_src_global generation:  0.04593348503112793
r_  generation:  0.3800206184387207
local_output_nid generation:  0.020235061645507812
local_in_edges_tensor generation:  0.022228479385375977
mini_batch_src_global generation:  0.048705101013183594
r_  generation:  0.38901400566101074
local_output_nid generation:  0.020188331604003906
local_in_edges_tensor generation:  0.02137899398803711
mini_batch_src_global generation:  0.046057939529418945
r_  generation:  0.39467310905456543
local_output_nid generation:  0.020267248153686523
local_in_edges_tensor generation:  0.02902984619140625
mini_batch_src_global generation:  0.04876708984375
r_  generation:  0.39028310775756836
----------------------check_connections_block total spend ----------------------------- 4.455865859985352
generate_one_block  0.5091426372528076
generate_one_block  0.4966742992401123
generate_one_block  0.48841214179992676
generate_one_block  0.48952794075012207
generate_one_block  0.49166107177734375
generate_one_block  0.49858760833740234
generate_one_block  0.5074703693389893
generate_one_block  0.5420753955841064
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03479266166687012
gen group dst list time:  0.0389857292175293
time for parepare:  0.020121335983276367
local_output_nid generation:  0.030824661254882812
local_in_edges_tensor generation:  0.0594637393951416
mini_batch_src_global generation:  0.04832267761230469
r_  generation:  0.47915196418762207
local_output_nid generation:  0.036850929260253906
local_in_edges_tensor generation:  0.04279041290283203
mini_batch_src_global generation:  0.05480074882507324
r_  generation:  0.4852933883666992
local_output_nid generation:  0.03660941123962402
local_in_edges_tensor generation:  0.0333552360534668
mini_batch_src_global generation:  0.05464458465576172
r_  generation:  0.48746562004089355
local_output_nid generation:  0.03665733337402344
local_in_edges_tensor generation:  0.0355377197265625
mini_batch_src_global generation:  0.055707693099975586
r_  generation:  0.5024633407592773
local_output_nid generation:  0.036307334899902344
local_in_edges_tensor generation:  0.0442047119140625
mini_batch_src_global generation:  0.05379366874694824
r_  generation:  0.498776912689209
local_output_nid generation:  0.03637814521789551
local_in_edges_tensor generation:  0.03379631042480469
mini_batch_src_global generation:  0.05950498580932617
r_  generation:  0.5073485374450684
local_output_nid generation:  0.03702044486999512
local_in_edges_tensor generation:  0.04117393493652344
mini_batch_src_global generation:  0.06166505813598633
r_  generation:  0.5071346759796143
local_output_nid generation:  0.037487030029296875
local_in_edges_tensor generation:  0.03427767753601074
mini_batch_src_global generation:  0.05534863471984863
r_  generation:  0.5073831081390381
----------------------check_connections_block total spend ----------------------------- 5.946568250656128
generate_one_block  0.6314637660980225
generate_one_block  0.6304214000701904
generate_one_block  0.6485753059387207
generate_one_block  0.619173526763916
generate_one_block  0.6190328598022461
generate_one_block  0.6290895938873291
generate_one_block  0.6321802139282227
generate_one_block  0.6232492923736572
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13749408721923828  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

connection checking time:  10.40243411064148
block generation total time  9.056737422943115
average batch blocks generation time:  1.1320921778678894
block dataloader generation time/epoch 21.644158244132996
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10489463806152344  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9516940116882324  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10447168350219727  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9511599540710449  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1037602424621582  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9457902908325195  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1048879623413086  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9463582038879395  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10405969619750977  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9493203163146973  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1056509017944336  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9525690078735352  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10375213623046875  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9503054618835449  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10515594482421875  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9548463821411133  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08643579483032227 |0.017246097326278687 |0.003554999828338623 |9.238719940185547e-05 |0.0037895143032073975 |0.0013070106506347656 |
----------------------------------------------------------pseudo_mini_loss sum 1.5597115755081177
Total (block generation + training)time/epoch 22.61673080921173
Training time/epoch 0.9674034118652344
Training time without block to device /epoch 0.8294346332550049
Training time without total dataloading part /epoch 0.06080222129821777
load block tensor time/epoch 0.6914863586425781
block to device time/epoch 0.1379687786102295
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  3054140
Number of first layer input nodes during this epoch:  1297845
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13843631744384766  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025209665298461914
random selection method range initialization spend 0.004889965057373047
time for parepare:  0.01719522476196289
local_output_nid generation:  0.006020069122314453
local_in_edges_tensor generation:  0.05688190460205078
mini_batch_src_global generation:  0.004259347915649414
r_  generation:  0.04402780532836914
local_output_nid generation:  0.006053924560546875
local_in_edges_tensor generation:  0.0031948089599609375
mini_batch_src_global generation:  0.005939483642578125
r_  generation:  0.04708433151245117
local_output_nid generation:  0.006075620651245117
local_in_edges_tensor generation:  0.0032389163970947266
mini_batch_src_global generation:  0.0041179656982421875
r_  generation:  0.04679679870605469
local_output_nid generation:  0.006060361862182617
local_in_edges_tensor generation:  0.0032236576080322266
mini_batch_src_global generation:  0.003462076187133789
r_  generation:  0.04593038558959961
local_output_nid generation:  0.006076335906982422
local_in_edges_tensor generation:  0.0032868385314941406
mini_batch_src_global generation:  0.005311489105224609
r_  generation:  0.055158138275146484
local_output_nid generation:  0.011424779891967773
local_in_edges_tensor generation:  0.004561424255371094
mini_batch_src_global generation:  0.004682302474975586
r_  generation:  0.05018901824951172
local_output_nid generation:  0.009040117263793945
local_in_edges_tensor generation:  0.004496097564697266
mini_batch_src_global generation:  0.0048525333404541016
r_  generation:  0.06235671043395996
local_output_nid generation:  0.008559226989746094
local_in_edges_tensor generation:  0.0037746429443359375
mini_batch_src_global generation:  0.006893634796142578
r_  generation:  0.0496060848236084
----------------------check_connections_block total spend ----------------------------- 0.7107062339782715
generate_one_block  0.06601309776306152
generate_one_block  0.08613753318786621
generate_one_block  0.06487703323364258
generate_one_block  0.08716011047363281
generate_one_block  0.06483888626098633
generate_one_block  0.07490205764770508
generate_one_block  0.08288884162902832
generate_one_block  0.06746673583984375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03918743133544922
gen group dst list time:  0.016237497329711914
time for parepare:  0.02193593978881836
local_output_nid generation:  0.017700910568237305
local_in_edges_tensor generation:  0.03606677055358887
mini_batch_src_global generation:  0.04204964637756348
r_  generation:  0.3813183307647705
local_output_nid generation:  0.024116992950439453
local_in_edges_tensor generation:  0.031311988830566406
mini_batch_src_global generation:  0.04801464080810547
r_  generation:  0.384824275970459
local_output_nid generation:  0.021111726760864258
local_in_edges_tensor generation:  0.022164344787597656
mini_batch_src_global generation:  0.04442453384399414
r_  generation:  0.39240217208862305
local_output_nid generation:  0.021274328231811523
local_in_edges_tensor generation:  0.022057771682739258
mini_batch_src_global generation:  0.04497051239013672
r_  generation:  0.3876180648803711
local_output_nid generation:  0.02280592918395996
local_in_edges_tensor generation:  0.032605886459350586
mini_batch_src_global generation:  0.048644065856933594
r_  generation:  0.46054577827453613
local_output_nid generation:  0.020661354064941406
local_in_edges_tensor generation:  0.026005983352661133
mini_batch_src_global generation:  0.05199098587036133
r_  generation:  0.4038689136505127
local_output_nid generation:  0.022536754608154297
local_in_edges_tensor generation:  0.029524803161621094
mini_batch_src_global generation:  0.0513763427734375
r_  generation:  0.3876471519470215
local_output_nid generation:  0.02035212516784668
local_in_edges_tensor generation:  0.021526575088500977
mini_batch_src_global generation:  0.04682660102844238
r_  generation:  0.4023933410644531
----------------------check_connections_block total spend ----------------------------- 4.643976449966431
generate_one_block  0.5060586929321289
generate_one_block  0.5118255615234375
generate_one_block  0.4942450523376465
generate_one_block  0.4951357841491699
generate_one_block  0.509423017501831
generate_one_block  0.49268198013305664
generate_one_block  0.5026187896728516
generate_one_block  0.5251419544219971
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04121994972229004
gen group dst list time:  0.03941035270690918
time for parepare:  0.02024698257446289
local_output_nid generation:  0.031179428100585938
local_in_edges_tensor generation:  0.06484866142272949
mini_batch_src_global generation:  0.04611468315124512
r_  generation:  0.48334407806396484
local_output_nid generation:  0.03688979148864746
local_in_edges_tensor generation:  0.041605472564697266
mini_batch_src_global generation:  0.055240631103515625
r_  generation:  0.4910087585449219
local_output_nid generation:  0.037949562072753906
local_in_edges_tensor generation:  0.03338050842285156
mini_batch_src_global generation:  0.05784869194030762
r_  generation:  0.49212646484375
local_output_nid generation:  0.03655529022216797
local_in_edges_tensor generation:  0.0392153263092041
mini_batch_src_global generation:  0.053246259689331055
r_  generation:  0.4982869625091553
local_output_nid generation:  0.037261009216308594
local_in_edges_tensor generation:  0.0368039608001709
mini_batch_src_global generation:  0.05325794219970703
r_  generation:  0.49893879890441895
local_output_nid generation:  0.03697490692138672
local_in_edges_tensor generation:  0.03488516807556152
mini_batch_src_global generation:  0.06018662452697754
r_  generation:  0.503366231918335
local_output_nid generation:  0.03679347038269043
local_in_edges_tensor generation:  0.03992199897766113
mini_batch_src_global generation:  0.054731130599975586
r_  generation:  0.5161442756652832
local_output_nid generation:  0.03988361358642578
local_in_edges_tensor generation:  0.04115104675292969
mini_batch_src_global generation:  0.05812692642211914
r_  generation:  0.5050830841064453
----------------------check_connections_block total spend ----------------------------- 5.971967935562134
generate_one_block  0.629230260848999
generate_one_block  0.6195318698883057
generate_one_block  0.6208202838897705
generate_one_block  0.6206870079040527
generate_one_block  0.6259098052978516
generate_one_block  0.6423637866973877
generate_one_block  0.6225645542144775
generate_one_block  0.6171765327453613
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13843631744384766  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

connection checking time:  10.615944385528564
block generation total time  9.035414934158325
average batch blocks generation time:  1.1294268667697906
block dataloader generation time/epoch 21.743505080540974
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10404109954833984  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9494757652282715  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1053776741027832  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.95550537109375  GigaBytes
Max Memory Allocated: 1.0971364974975586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1040201187133789  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9465746879577637  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10527944564819336  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9485583305358887  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10466670989990234  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9536924362182617  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10572290420532227  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9526734352111816  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10448169708251953  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.954585075378418  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10494518280029297  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9526753425598145  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08293789625167847 |0.015983939170837402 |0.0035995543003082275 |9.548664093017578e-05 |0.003530144691467285 |0.0030460357666015625 |
----------------------------------------------------------pseudo_mini_loss sum 1.5183082818984985
Total (block generation + training)time/epoch 22.70163901646932
Training time/epoch 0.9289047718048096
Training time without block to device /epoch 0.8010332584381104
Training time without total dataloading part /epoch 0.06084752082824707
load block tensor time/epoch 0.6635031700134277
block to device time/epoch 0.12787151336669922
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  3056357
Number of first layer input nodes during this epoch:  1297886
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13843488693237305  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022405147552490234
random selection method range initialization spend 0.0050356388092041016
time for parepare:  0.020319223403930664
local_output_nid generation:  0.00457453727722168
local_in_edges_tensor generation:  0.009388923645019531
mini_batch_src_global generation:  0.003552675247192383
r_  generation:  0.043411970138549805
local_output_nid generation:  0.006050586700439453
local_in_edges_tensor generation:  0.0033426284790039062
mini_batch_src_global generation:  0.004749298095703125
r_  generation:  0.045758724212646484
local_output_nid generation:  0.006166219711303711
local_in_edges_tensor generation:  0.0033714771270751953
mini_batch_src_global generation:  0.0034494400024414062
r_  generation:  0.049865007400512695
local_output_nid generation:  0.006234645843505859
local_in_edges_tensor generation:  0.0034041404724121094
mini_batch_src_global generation:  0.0035135746002197266
r_  generation:  0.04869675636291504
local_output_nid generation:  0.0061724185943603516
local_in_edges_tensor generation:  0.0033681392669677734
mini_batch_src_global generation:  0.003895998001098633
r_  generation:  0.04867887496948242
local_output_nid generation:  0.0067138671875
local_in_edges_tensor generation:  0.003348112106323242
mini_batch_src_global generation:  0.003954410552978516
r_  generation:  0.05052351951599121
local_output_nid generation:  0.0061876773834228516
local_in_edges_tensor generation:  0.003454446792602539
mini_batch_src_global generation:  0.0042476654052734375
r_  generation:  0.049218177795410156
local_output_nid generation:  0.008227348327636719
local_in_edges_tensor generation:  0.003857135772705078
mini_batch_src_global generation:  0.0041964054107666016
r_  generation:  0.04922175407409668
----------------------check_connections_block total spend ----------------------------- 0.6151378154754639
generate_one_block  0.06429553031921387
generate_one_block  0.060996055603027344
generate_one_block  0.06324172019958496
generate_one_block  0.06523895263671875
generate_one_block  0.06252217292785645
generate_one_block  0.061667680740356445
generate_one_block  0.06765556335449219
generate_one_block  0.06343412399291992
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03865551948547363
gen group dst list time:  0.016779422760009766
time for parepare:  0.020778894424438477
local_output_nid generation:  0.015190839767456055
local_in_edges_tensor generation:  0.036019086837768555
mini_batch_src_global generation:  0.03691506385803223
r_  generation:  0.3600165843963623
local_output_nid generation:  0.021017789840698242
local_in_edges_tensor generation:  0.027579784393310547
mini_batch_src_global generation:  0.046540021896362305
r_  generation:  0.37632155418395996
local_output_nid generation:  0.020905256271362305
local_in_edges_tensor generation:  0.0210111141204834
mini_batch_src_global generation:  0.04431724548339844
r_  generation:  0.37798404693603516
local_output_nid generation:  0.02093648910522461
local_in_edges_tensor generation:  0.02661919593811035
mini_batch_src_global generation:  0.046977996826171875
r_  generation:  0.38443756103515625
local_output_nid generation:  0.021255016326904297
local_in_edges_tensor generation:  0.01999831199645996
mini_batch_src_global generation:  0.04814624786376953
r_  generation:  0.38945484161376953
local_output_nid generation:  0.02023935317993164
local_in_edges_tensor generation:  0.02210211753845215
mini_batch_src_global generation:  0.0464780330657959
r_  generation:  0.385150671005249
local_output_nid generation:  0.02144789695739746
local_in_edges_tensor generation:  0.02208089828491211
mini_batch_src_global generation:  0.04694366455078125
r_  generation:  0.3925356864929199
local_output_nid generation:  0.019927501678466797
local_in_edges_tensor generation:  0.02108454704284668
mini_batch_src_global generation:  0.048433780670166016
r_  generation:  0.3898346424102783
----------------------check_connections_block total spend ----------------------------- 4.434904336929321
generate_one_block  0.49719691276550293
generate_one_block  0.5021679401397705
generate_one_block  0.49991464614868164
generate_one_block  0.5069708824157715
generate_one_block  0.5058448314666748
generate_one_block  0.49787402153015137
generate_one_block  0.5036416053771973
generate_one_block  0.5319766998291016
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03423738479614258
gen group dst list time:  0.038423776626586914
time for parepare:  0.02048969268798828
local_output_nid generation:  0.042768239974975586
local_in_edges_tensor generation:  0.05374884605407715
mini_batch_src_global generation:  0.044412851333618164
r_  generation:  0.49202442169189453
local_output_nid generation:  0.03686356544494629
local_in_edges_tensor generation:  0.03690910339355469
mini_batch_src_global generation:  0.057059526443481445
r_  generation:  0.4950120449066162
local_output_nid generation:  0.036566734313964844
local_in_edges_tensor generation:  0.03309154510498047
mini_batch_src_global generation:  0.05507397651672363
r_  generation:  0.498960018157959
local_output_nid generation:  0.037024736404418945
local_in_edges_tensor generation:  0.036132097244262695
mini_batch_src_global generation:  0.05316281318664551
r_  generation:  0.4999392032623291
local_output_nid generation:  0.03758835792541504
local_in_edges_tensor generation:  0.0413508415222168
mini_batch_src_global generation:  0.05822038650512695
r_  generation:  0.5062425136566162
local_output_nid generation:  0.040305376052856445
local_in_edges_tensor generation:  0.04652667045593262
mini_batch_src_global generation:  0.05375981330871582
r_  generation:  0.5066835880279541
local_output_nid generation:  0.03710794448852539
local_in_edges_tensor generation:  0.04562973976135254
mini_batch_src_global generation:  0.06360387802124023
r_  generation:  0.5184147357940674
local_output_nid generation:  0.04025983810424805
local_in_edges_tensor generation:  0.0328981876373291
mini_batch_src_global generation:  0.05758023262023926
r_  generation:  0.5060000419616699
----------------------check_connections_block total spend ----------------------------- 6.015480041503906
generate_one_block  0.6171817779541016
generate_one_block  0.624147891998291
generate_one_block  0.6177587509155273
generate_one_block  0.6176190376281738
generate_one_block  0.6185595989227295
generate_one_block  0.6193454265594482
generate_one_block  0.6151342391967773
generate_one_block  0.6146280765533447
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13843488693237305  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

connection checking time:  10.450384378433228
block generation total time  8.989962339401245
average batch blocks generation time:  1.1237452924251556
block dataloader generation time/epoch 21.693931460380554
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10530567169189453  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.950592041015625  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10506153106689453  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9504895210266113  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1052236557006836  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9488205909729004  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1041097640991211  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9514107704162598  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10451173782348633  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9520969390869141  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10405969619750977  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9482378959655762  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.105010986328125  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9503011703491211  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10412359237670898  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9507136344909668  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08022752404212952 |0.0180339515209198 |0.003732621669769287 |9.238719940185547e-05 |0.0034310519695281982 |0.0028231143951416016 |
----------------------------------------------------------pseudo_mini_loss sum 1.4862674474716187
Total (block generation + training)time/epoch 22.64340054988861
Training time/epoch 0.9232089519500732
Training time without block to device /epoch 0.7789373397827148
Training time without total dataloading part /epoch 0.06087160110473633
load block tensor time/epoch 0.6418201923370361
block to device time/epoch 0.1442716121673584
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  3053278
Number of first layer input nodes during this epoch:  1297345
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13755178451538086  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027524948120117188
random selection method range initialization spend 0.005362749099731445
time for parepare:  0.017189741134643555
local_output_nid generation:  0.00457000732421875
local_in_edges_tensor generation:  0.03470039367675781
mini_batch_src_global generation:  0.0034296512603759766
r_  generation:  0.04289102554321289
local_output_nid generation:  0.006057262420654297
local_in_edges_tensor generation:  0.003328084945678711
mini_batch_src_global generation:  0.005151033401489258
r_  generation:  0.04608941078186035
local_output_nid generation:  0.006288766860961914
local_in_edges_tensor generation:  0.003276348114013672
mini_batch_src_global generation:  0.003692150115966797
r_  generation:  0.04750967025756836
local_output_nid generation:  0.00626063346862793
local_in_edges_tensor generation:  0.003375530242919922
mini_batch_src_global generation:  0.0035970211029052734
r_  generation:  0.04766392707824707
local_output_nid generation:  0.00616002082824707
local_in_edges_tensor generation:  0.0032634735107421875
mini_batch_src_global generation:  0.004023075103759766
r_  generation:  0.0472869873046875
local_output_nid generation:  0.006159782409667969
local_in_edges_tensor generation:  0.003319978713989258
mini_batch_src_global generation:  0.004147768020629883
r_  generation:  0.0492098331451416
local_output_nid generation:  0.00614619255065918
local_in_edges_tensor generation:  0.0033652782440185547
mini_batch_src_global generation:  0.004250526428222656
r_  generation:  0.04987812042236328
local_output_nid generation:  0.006293535232543945
local_in_edges_tensor generation:  0.003416299819946289
mini_batch_src_global generation:  0.0041425228118896484
r_  generation:  0.04938673973083496
----------------------check_connections_block total spend ----------------------------- 0.6264209747314453
generate_one_block  0.05859017372131348
generate_one_block  0.06222224235534668
generate_one_block  0.06257867813110352
generate_one_block  0.06141352653503418
generate_one_block  0.06111955642700195
generate_one_block  0.06213498115539551
generate_one_block  0.06686663627624512
generate_one_block  0.06256842613220215
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04211592674255371
gen group dst list time:  0.01902461051940918
time for parepare:  0.02155780792236328
local_output_nid generation:  0.03135275840759277
local_in_edges_tensor generation:  0.03269600868225098
mini_batch_src_global generation:  0.03655362129211426
r_  generation:  0.356748104095459
local_output_nid generation:  0.026696443557739258
local_in_edges_tensor generation:  0.031192541122436523
mini_batch_src_global generation:  0.04696512222290039
r_  generation:  0.38585686683654785
local_output_nid generation:  0.029537677764892578
local_in_edges_tensor generation:  0.026539087295532227
mini_batch_src_global generation:  0.04672861099243164
r_  generation:  0.39136362075805664
local_output_nid generation:  0.025995254516601562
local_in_edges_tensor generation:  0.026377201080322266
mini_batch_src_global generation:  0.04814291000366211
r_  generation:  0.4082920551300049
local_output_nid generation:  0.028929710388183594
local_in_edges_tensor generation:  0.03223133087158203
mini_batch_src_global generation:  0.0462191104888916
r_  generation:  0.37932443618774414
local_output_nid generation:  0.026539087295532227
local_in_edges_tensor generation:  0.025766849517822266
mini_batch_src_global generation:  0.0481867790222168
r_  generation:  0.3842203617095947
local_output_nid generation:  0.025751352310180664
local_in_edges_tensor generation:  0.024341106414794922
mini_batch_src_global generation:  0.04725027084350586
r_  generation:  0.38880300521850586
local_output_nid generation:  0.025565624237060547
local_in_edges_tensor generation:  0.022211074829101562
mini_batch_src_global generation:  0.04647254943847656
r_  generation:  0.3797938823699951
----------------------check_connections_block total spend ----------------------------- 4.564073324203491
generate_one_block  0.4881572723388672
generate_one_block  0.5226285457611084
generate_one_block  0.5055849552154541
generate_one_block  0.4969980716705322
generate_one_block  0.497539758682251
generate_one_block  0.5143015384674072
generate_one_block  0.5063900947570801
generate_one_block  0.5289947986602783
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04062390327453613
gen group dst list time:  0.04006671905517578
time for parepare:  0.02031683921813965
local_output_nid generation:  0.031203746795654297
local_in_edges_tensor generation:  0.05455780029296875
mini_batch_src_global generation:  0.0439150333404541
r_  generation:  0.4984622001647949
local_output_nid generation:  0.036606550216674805
local_in_edges_tensor generation:  0.04209733009338379
mini_batch_src_global generation:  0.05523324012756348
r_  generation:  0.4944007396697998
local_output_nid generation:  0.03914475440979004
local_in_edges_tensor generation:  0.039376020431518555
mini_batch_src_global generation:  0.05529332160949707
r_  generation:  0.49587273597717285
local_output_nid generation:  0.03768634796142578
local_in_edges_tensor generation:  0.0386509895324707
mini_batch_src_global generation:  0.05428576469421387
r_  generation:  0.4997231960296631
local_output_nid generation:  0.03655076026916504
local_in_edges_tensor generation:  0.035318851470947266
mini_batch_src_global generation:  0.0538630485534668
r_  generation:  0.5065882205963135
local_output_nid generation:  0.03694939613342285
local_in_edges_tensor generation:  0.03387331962585449
mini_batch_src_global generation:  0.0542302131652832
r_  generation:  0.5069668292999268
local_output_nid generation:  0.03679180145263672
local_in_edges_tensor generation:  0.039972782135009766
mini_batch_src_global generation:  0.05593729019165039
r_  generation:  0.511693000793457
local_output_nid generation:  0.03728532791137695
local_in_edges_tensor generation:  0.04101705551147461
mini_batch_src_global generation:  0.05963635444641113
r_  generation:  0.5140988826751709
----------------------check_connections_block total spend ----------------------------- 5.990463733673096
generate_one_block  0.6324412822723389
generate_one_block  0.6238486766815186
generate_one_block  0.6306557655334473
generate_one_block  0.627326488494873
generate_one_block  0.6199169158935547
generate_one_block  0.6313607692718506
generate_one_block  0.6255519390106201
generate_one_block  0.6165664196014404
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13755178451538086  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

connection checking time:  10.554537057876587
block generation total time  9.068263292312622
average batch blocks generation time:  1.1335329115390778
block dataloader generation time/epoch 21.70223135948181
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10481739044189453  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9439487457275391  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10421943664550781  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9522824287414551  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.104248046875  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9531674385070801  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10492134094238281  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9515814781188965  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1042628288269043  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.946263313293457  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1054224967956543  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9513778686523438  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1044926643371582  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9535984992980957  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10489702224731445  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9482030868530273  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0873275101184845 |0.01769396662712097 |0.003590613603591919 |9.340047836303711e-05 |0.0038367807865142822 |0.0030803680419921875 |
----------------------------------------------------------pseudo_mini_loss sum 1.4567902088165283
Total (block generation + training)time/epoch 22.657780790328978
Training time/epoch 0.9796874523162842
Training time without block to device /epoch 0.8381357192993164
Training time without total dataloading part /epoch 0.0632467269897461
load block tensor time/epoch 0.698620080947876
block to device time/epoch 0.14155173301696777
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  3053923
Number of first layer input nodes during this epoch:  1297659
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13843345642089844  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027079105377197266
random selection method range initialization spend 0.005347728729248047
time for parepare:  0.022937774658203125
local_output_nid generation:  0.004502534866333008
local_in_edges_tensor generation:  0.009207487106323242
mini_batch_src_global generation:  0.0039899349212646484
r_  generation:  0.043544769287109375
local_output_nid generation:  0.00597381591796875
local_in_edges_tensor generation:  0.0034301280975341797
mini_batch_src_global generation:  0.005076885223388672
r_  generation:  0.045064449310302734
local_output_nid generation:  0.006138324737548828
local_in_edges_tensor generation:  0.0036373138427734375
mini_batch_src_global generation:  0.0035789012908935547
r_  generation:  0.04636788368225098
local_output_nid generation:  0.006197452545166016
local_in_edges_tensor generation:  0.003462553024291992
mini_batch_src_global generation:  0.0034792423248291016
r_  generation:  0.04682040214538574
local_output_nid generation:  0.00620269775390625
local_in_edges_tensor generation:  0.0033953189849853516
mini_batch_src_global generation:  0.003876924514770508
r_  generation:  0.04752302169799805
local_output_nid generation:  0.0061321258544921875
local_in_edges_tensor generation:  0.003393888473510742
mini_batch_src_global generation:  0.004070281982421875
r_  generation:  0.048999786376953125
local_output_nid generation:  0.006203413009643555
local_in_edges_tensor generation:  0.0033566951751708984
mini_batch_src_global generation:  0.0042073726654052734
r_  generation:  0.04868316650390625
local_output_nid generation:  0.006211042404174805
local_in_edges_tensor generation:  0.003373861312866211
mini_batch_src_global generation:  0.00408625602722168
r_  generation:  0.04838252067565918
----------------------check_connections_block total spend ----------------------------- 0.6021053791046143
generate_one_block  0.059978485107421875
generate_one_block  0.06153249740600586
generate_one_block  0.06260442733764648
generate_one_block  0.061493635177612305
generate_one_block  0.06176638603210449
generate_one_block  0.06398797035217285
generate_one_block  0.06486153602600098
generate_one_block  0.06233787536621094
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03897523880004883
gen group dst list time:  0.01580667495727539
time for parepare:  0.021051406860351562
local_output_nid generation:  0.015167951583862305
local_in_edges_tensor generation:  0.033869028091430664
mini_batch_src_global generation:  0.03744006156921387
r_  generation:  0.3600654602050781
local_output_nid generation:  0.020947933197021484
local_in_edges_tensor generation:  0.02830338478088379
mini_batch_src_global generation:  0.04703092575073242
r_  generation:  0.37398290634155273
local_output_nid generation:  0.02091693878173828
local_in_edges_tensor generation:  0.024001359939575195
mini_batch_src_global generation:  0.044541120529174805
r_  generation:  0.3821403980255127
local_output_nid generation:  0.022431612014770508
local_in_edges_tensor generation:  0.021976470947265625
mini_batch_src_global generation:  0.04521965980529785
r_  generation:  0.38242459297180176
local_output_nid generation:  0.021044015884399414
local_in_edges_tensor generation:  0.02134990692138672
mini_batch_src_global generation:  0.04618573188781738
r_  generation:  0.38918113708496094
local_output_nid generation:  0.020404577255249023
local_in_edges_tensor generation:  0.02411031723022461
mini_batch_src_global generation:  0.04898953437805176
r_  generation:  0.39409565925598145
local_output_nid generation:  0.021231412887573242
local_in_edges_tensor generation:  0.020807266235351562
mini_batch_src_global generation:  0.047225236892700195
r_  generation:  0.3898963928222656
local_output_nid generation:  0.01985025405883789
local_in_edges_tensor generation:  0.0210726261138916
mini_batch_src_global generation:  0.048830270767211914
r_  generation:  0.3947417736053467
----------------------check_connections_block total spend ----------------------------- 4.454212188720703
generate_one_block  0.5086970329284668
generate_one_block  0.4943215847015381
generate_one_block  0.49886584281921387
generate_one_block  0.49274611473083496
generate_one_block  0.49902987480163574
generate_one_block  0.5105574131011963
generate_one_block  0.4896407127380371
generate_one_block  0.5224819183349609
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03676748275756836
gen group dst list time:  0.03929638862609863
time for parepare:  0.02027726173400879
local_output_nid generation:  0.031169414520263672
local_in_edges_tensor generation:  0.05597877502441406
mini_batch_src_global generation:  0.04436922073364258
r_  generation:  0.4868471622467041
local_output_nid generation:  0.03679370880126953
local_in_edges_tensor generation:  0.043554067611694336
mini_batch_src_global generation:  0.0544588565826416
r_  generation:  0.490206241607666
local_output_nid generation:  0.03669333457946777
local_in_edges_tensor generation:  0.036835432052612305
mini_batch_src_global generation:  0.05398416519165039
r_  generation:  0.498549222946167
local_output_nid generation:  0.04726552963256836
local_in_edges_tensor generation:  0.03613615036010742
mini_batch_src_global generation:  0.0521848201751709
r_  generation:  0.5055007934570312
local_output_nid generation:  0.0370938777923584
local_in_edges_tensor generation:  0.037949562072753906
mini_batch_src_global generation:  0.05361294746398926
r_  generation:  0.5045132637023926
local_output_nid generation:  0.036479949951171875
local_in_edges_tensor generation:  0.04133343696594238
mini_batch_src_global generation:  0.05497097969055176
r_  generation:  0.5101306438446045
local_output_nid generation:  0.03638768196105957
local_in_edges_tensor generation:  0.034424543380737305
mini_batch_src_global generation:  0.05490541458129883
r_  generation:  0.5089647769927979
local_output_nid generation:  0.03659486770629883
local_in_edges_tensor generation:  0.03555417060852051
mini_batch_src_global generation:  0.05761265754699707
r_  generation:  0.5136313438415527
----------------------check_connections_block total spend ----------------------------- 5.972867488861084
generate_one_block  0.6401052474975586
generate_one_block  0.6346209049224854
generate_one_block  0.616438627243042
generate_one_block  0.6227374076843262
generate_one_block  0.6275804042816162
generate_one_block  0.6261811256408691
generate_one_block  0.6282939910888672
generate_one_block  0.6185991764068604
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13843345642089844  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

connection checking time:  10.427079677581787
block generation total time  9.030897378921509
average batch blocks generation time:  1.1288621723651886
block dataloader generation time/epoch 21.678107420603435
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1040964126586914  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9502086639404297  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10567951202392578  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9509987831115723  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10468196868896484  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9514126777648926  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10387897491455078  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9508218765258789  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10515689849853516  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9502143859863281  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10485458374023438  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9542717933654785  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10484170913696289  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9504122734069824  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10434913635253906  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9490694999694824  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08148881793022156 |0.017451375722885132 |0.003514915704727173 |9.226799011230469e-05 |0.00362473726272583 |0.0013947486877441406 |
----------------------------------------------------------pseudo_mini_loss sum 1.4289511442184448
Total (block generation + training)time/epoch 22.628723820050556
Training time/epoch 0.925696849822998
Training time without block to device /epoch 0.786085844039917
Training time without total dataloading part /epoch 0.0592501163482666
load block tensor time/epoch 0.6519105434417725
block to device time/epoch 0.13961100578308105
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  3054133
Number of first layer input nodes during this epoch:  1297427
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13778448104858398  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.18936443328857422
random selection method range initialization spend 0.006125211715698242
time for parepare:  0.019026994705200195
local_output_nid generation:  0.004312753677368164
local_in_edges_tensor generation:  0.00791788101196289
mini_batch_src_global generation:  0.006237506866455078
r_  generation:  0.045287132263183594
local_output_nid generation:  0.008297443389892578
local_in_edges_tensor generation:  0.004956722259521484
mini_batch_src_global generation:  0.004831552505493164
r_  generation:  0.04479551315307617
local_output_nid generation:  0.008810281753540039
local_in_edges_tensor generation:  0.004558563232421875
mini_batch_src_global generation:  0.003712892532348633
r_  generation:  0.04774284362792969
local_output_nid generation:  0.00915837287902832
local_in_edges_tensor generation:  0.004630565643310547
mini_batch_src_global generation:  0.0035996437072753906
r_  generation:  0.04722309112548828
local_output_nid generation:  0.009207010269165039
local_in_edges_tensor generation:  0.004751920700073242
mini_batch_src_global generation:  0.004079103469848633
r_  generation:  0.04899454116821289
local_output_nid generation:  0.00929713249206543
local_in_edges_tensor generation:  0.004689455032348633
mini_batch_src_global generation:  0.004042387008666992
r_  generation:  0.0488123893737793
local_output_nid generation:  0.009375810623168945
local_in_edges_tensor generation:  0.004713535308837891
mini_batch_src_global generation:  0.004082441329956055
r_  generation:  0.049951791763305664
local_output_nid generation:  0.009267568588256836
local_in_edges_tensor generation:  0.004682302474975586
mini_batch_src_global generation:  0.004087924957275391
r_  generation:  0.04949021339416504
----------------------check_connections_block total spend ----------------------------- 0.6407537460327148
generate_one_block  0.06557488441467285
generate_one_block  0.06380128860473633
generate_one_block  0.06454920768737793
generate_one_block  0.06509757041931152
generate_one_block  0.06464099884033203
generate_one_block  0.06581568717956543
generate_one_block  0.07478070259094238
generate_one_block  0.06673240661621094
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04078388214111328
gen group dst list time:  0.017934322357177734
time for parepare:  0.02095198631286621
local_output_nid generation:  0.03156304359436035
local_in_edges_tensor generation:  0.036431074142456055
mini_batch_src_global generation:  0.04298591613769531
r_  generation:  0.3652031421661377
local_output_nid generation:  0.025918006896972656
local_in_edges_tensor generation:  0.02625751495361328
mini_batch_src_global generation:  0.04839444160461426
r_  generation:  0.37563061714172363
local_output_nid generation:  0.025583505630493164
local_in_edges_tensor generation:  0.024178028106689453
mini_batch_src_global generation:  0.049454450607299805
r_  generation:  0.3871035575866699
local_output_nid generation:  0.027138233184814453
local_in_edges_tensor generation:  0.02944016456604004
mini_batch_src_global generation:  0.04727482795715332
r_  generation:  0.4005868434906006
local_output_nid generation:  0.029462575912475586
local_in_edges_tensor generation:  0.035230159759521484
mini_batch_src_global generation:  0.05260753631591797
r_  generation:  0.38312649726867676
local_output_nid generation:  0.025334596633911133
local_in_edges_tensor generation:  0.02396368980407715
mini_batch_src_global generation:  0.046276092529296875
r_  generation:  0.3941361904144287
local_output_nid generation:  0.025236845016479492
local_in_edges_tensor generation:  0.02363896369934082
mini_batch_src_global generation:  0.049309730529785156
r_  generation:  0.3859567642211914
local_output_nid generation:  0.026923179626464844
local_in_edges_tensor generation:  0.02466273307800293
mini_batch_src_global generation:  0.0473170280456543
r_  generation:  0.3842310905456543
----------------------check_connections_block total spend ----------------------------- 4.580131769180298
generate_one_block  0.5131692886352539
generate_one_block  0.4966621398925781
generate_one_block  0.5147745609283447
generate_one_block  0.48798370361328125
generate_one_block  0.48912644386291504
generate_one_block  0.4924609661102295
generate_one_block  0.5044960975646973
generate_one_block  0.5316212177276611
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03360247611999512
gen group dst list time:  0.04183650016784668
time for parepare:  0.019364118576049805
local_output_nid generation:  0.029838085174560547
local_in_edges_tensor generation:  0.05337715148925781
mini_batch_src_global generation:  0.043802499771118164
r_  generation:  0.4774491786956787
local_output_nid generation:  0.03720736503601074
local_in_edges_tensor generation:  0.045151472091674805
mini_batch_src_global generation:  0.06922268867492676
r_  generation:  0.5388591289520264
local_output_nid generation:  0.0375521183013916
local_in_edges_tensor generation:  0.038269758224487305
mini_batch_src_global generation:  0.06663870811462402
r_  generation:  0.5288567543029785
local_output_nid generation:  0.03979372978210449
local_in_edges_tensor generation:  0.04594874382019043
mini_batch_src_global generation:  0.06345081329345703
r_  generation:  0.5116090774536133
local_output_nid generation:  0.037758588790893555
local_in_edges_tensor generation:  0.03504133224487305
mini_batch_src_global generation:  0.05911588668823242
r_  generation:  0.5209975242614746
local_output_nid generation:  0.03967475891113281
local_in_edges_tensor generation:  0.03522753715515137
mini_batch_src_global generation:  0.06099295616149902
r_  generation:  0.5277495384216309
local_output_nid generation:  0.03865385055541992
local_in_edges_tensor generation:  0.033313751220703125
mini_batch_src_global generation:  0.0652623176574707
r_  generation:  0.5214457511901855
local_output_nid generation:  0.03764152526855469
local_in_edges_tensor generation:  0.04687952995300293
mini_batch_src_global generation:  0.07510638236999512
r_  generation:  0.5263898372650146
----------------------check_connections_block total spend ----------------------------- 6.267674446105957
generate_one_block  0.6346302032470703
generate_one_block  0.6344349384307861
generate_one_block  0.6219203472137451
generate_one_block  0.6399307250976562
generate_one_block  0.6320114135742188
generate_one_block  0.6283862590789795
generate_one_block  0.6305882930755615
generate_one_block  0.6382901668548584
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13778448104858398  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

connection checking time:  10.847806215286255
block generation total time  9.090486764907837
average batch blocks generation time:  1.1363108456134796
block dataloader generation time/epoch 21.75991439819336
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10524940490722656  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9535560607910156  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10420703887939453  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9505009651184082  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10525226593017578  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9537839889526367  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10425901412963867  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9496617317199707  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10518503189086914  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9496450424194336  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10436391830444336  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9465427398681641  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10497665405273438  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9505772590637207  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10449600219726562  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9500870704650879  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08511167764663696 |0.016327470541000366 |0.003577321767807007 |9.569525718688965e-05 |0.003697693347930908 |0.003232717514038086 |
----------------------------------------------------------pseudo_mini_loss sum 1.3968462944030762
Total (block generation + training)time/epoch 22.709877933774674
Training time/epoch 0.9457695484161377
Training time without block to device /epoch 0.8151497840881348
Training time without total dataloading part /epoch 0.06219840049743652
load block tensor time/epoch 0.6808934211730957
block to device time/epoch 0.13061976432800293
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  3054745
Number of first layer input nodes during this epoch:  1298137
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13786649703979492  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025258779525756836
random selection method range initialization spend 0.0054013729095458984
time for parepare:  0.019100427627563477
local_output_nid generation:  0.004514932632446289
local_in_edges_tensor generation:  0.008774280548095703
mini_batch_src_global generation:  0.0042078495025634766
r_  generation:  0.043477773666381836
local_output_nid generation:  0.005965471267700195
local_in_edges_tensor generation:  0.003326892852783203
mini_batch_src_global generation:  0.005114078521728516
r_  generation:  0.04588890075683594
local_output_nid generation:  0.006120920181274414
local_in_edges_tensor generation:  0.0035288333892822266
mini_batch_src_global generation:  0.003689289093017578
r_  generation:  0.04662132263183594
local_output_nid generation:  0.006197452545166016
local_in_edges_tensor generation:  0.00345611572265625
mini_batch_src_global generation:  0.0035371780395507812
r_  generation:  0.04795432090759277
local_output_nid generation:  0.006133556365966797
local_in_edges_tensor generation:  0.0034966468811035156
mini_batch_src_global generation:  0.004021167755126953
r_  generation:  0.048842668533325195
local_output_nid generation:  0.006160259246826172
local_in_edges_tensor generation:  0.003294706344604492
mini_batch_src_global generation:  0.0041370391845703125
r_  generation:  0.04889225959777832
local_output_nid generation:  0.006117343902587891
local_in_edges_tensor generation:  0.0035033226013183594
mini_batch_src_global generation:  0.004156589508056641
r_  generation:  0.04810810089111328
local_output_nid generation:  0.006159067153930664
local_in_edges_tensor generation:  0.0033805370330810547
mini_batch_src_global generation:  0.004108428955078125
r_  generation:  0.04883766174316406
----------------------check_connections_block total spend ----------------------------- 0.6016356945037842
generate_one_block  0.06754946708679199
generate_one_block  0.0634763240814209
generate_one_block  0.06135964393615723
generate_one_block  0.062256813049316406
generate_one_block  0.06437420845031738
generate_one_block  0.06316256523132324
generate_one_block  0.06511759757995605
generate_one_block  0.06434798240661621
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.037325143814086914
gen group dst list time:  0.019527435302734375
time for parepare:  0.02385401725769043
local_output_nid generation:  0.01498866081237793
local_in_edges_tensor generation:  0.03412985801696777
mini_batch_src_global generation:  0.03675055503845215
r_  generation:  0.3565695285797119
local_output_nid generation:  0.022818565368652344
local_in_edges_tensor generation:  0.02783942222595215
mini_batch_src_global generation:  0.04670286178588867
r_  generation:  0.38185715675354004
local_output_nid generation:  0.021413326263427734
local_in_edges_tensor generation:  0.03136587142944336
mini_batch_src_global generation:  0.04577016830444336
r_  generation:  0.38561010360717773
local_output_nid generation:  0.021523714065551758
local_in_edges_tensor generation:  0.027893543243408203
mini_batch_src_global generation:  0.04895377159118652
r_  generation:  0.4022359848022461
local_output_nid generation:  0.02369976043701172
local_in_edges_tensor generation:  0.030042409896850586
mini_batch_src_global generation:  0.04624581336975098
r_  generation:  0.3848869800567627
local_output_nid generation:  0.0211031436920166
local_in_edges_tensor generation:  0.022420167922973633
mini_batch_src_global generation:  0.0465240478515625
r_  generation:  0.38553738594055176
local_output_nid generation:  0.020781993865966797
local_in_edges_tensor generation:  0.022240638732910156
mini_batch_src_global generation:  0.046381235122680664
r_  generation:  0.38308215141296387
local_output_nid generation:  0.020504236221313477
local_in_edges_tensor generation:  0.020494699478149414
mini_batch_src_global generation:  0.04625582695007324
r_  generation:  0.38134098052978516
----------------------check_connections_block total spend ----------------------------- 4.476579904556274
generate_one_block  0.49987339973449707
generate_one_block  0.5031948089599609
generate_one_block  0.49735212326049805
generate_one_block  0.49601316452026367
generate_one_block  0.5049817562103271
generate_one_block  0.5061736106872559
generate_one_block  0.4897470474243164
generate_one_block  0.5296247005462646
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.040543317794799805
gen group dst list time:  0.03961944580078125
time for parepare:  0.020838022232055664
local_output_nid generation:  0.03132295608520508
local_in_edges_tensor generation:  0.056188344955444336
mini_batch_src_global generation:  0.0459134578704834
r_  generation:  0.49095678329467773
local_output_nid generation:  0.037268877029418945
local_in_edges_tensor generation:  0.04185295104980469
mini_batch_src_global generation:  0.05909132957458496
r_  generation:  0.5044772624969482
local_output_nid generation:  0.03711295127868652
local_in_edges_tensor generation:  0.03887200355529785
mini_batch_src_global generation:  0.05882620811462402
r_  generation:  0.5028443336486816
local_output_nid generation:  0.036670684814453125
local_in_edges_tensor generation:  0.03410625457763672
mini_batch_src_global generation:  0.0555422306060791
r_  generation:  0.5041124820709229
local_output_nid generation:  0.036982059478759766
local_in_edges_tensor generation:  0.03317379951477051
mini_batch_src_global generation:  0.05837202072143555
r_  generation:  0.506333589553833
local_output_nid generation:  0.03817892074584961
local_in_edges_tensor generation:  0.03751683235168457
mini_batch_src_global generation:  0.057054996490478516
r_  generation:  0.5119602680206299
local_output_nid generation:  0.037302494049072266
local_in_edges_tensor generation:  0.03987717628479004
mini_batch_src_global generation:  0.05631899833679199
r_  generation:  0.5108556747436523
local_output_nid generation:  0.03738117218017578
local_in_edges_tensor generation:  0.0449223518371582
mini_batch_src_global generation:  0.059792280197143555
r_  generation:  0.5226638317108154
----------------------check_connections_block total spend ----------------------------- 6.037493467330933
generate_one_block  0.6329824924468994
generate_one_block  0.619112491607666
generate_one_block  0.6226789951324463
generate_one_block  0.6187722682952881
generate_one_block  0.6255340576171875
generate_one_block  0.6269011497497559
generate_one_block  0.623405933380127
generate_one_block  0.6195063591003418
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13786649703979492  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

connection checking time:  10.514073371887207
block generation total time  9.015854358673096
average batch blocks generation time:  1.126981794834137
block dataloader generation time/epoch 21.748075038194656
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1051788330078125  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9477500915527344  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10426759719848633  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9539213180541992  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10440778732299805  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9506263732910156  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10466575622558594  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9498891830444336  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10539722442626953  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9517011642456055  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10426855087280273  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9501662254333496  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10526752471923828  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9481654167175293  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10425424575805664  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9525556564331055  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08140024542808533 |0.017627567052841187 |0.0035778582096099854 |9.277462959289551e-05 |0.003400951623916626 |0.0013012886047363281 |
----------------------------------------------------------pseudo_mini_loss sum 1.371729850769043
Total (block generation + training)time/epoch 22.69517683982849
Training time/epoch 0.9268043041229248
Training time without block to device /epoch 0.7857837677001953
Training time without total dataloading part /epoch 0.05787396430969238
load block tensor time/epoch 0.6512019634246826
block to device time/epoch 0.1410205364227295
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  3054945
Number of first layer input nodes during this epoch:  1298140
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13752508163452148  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02376866340637207
random selection method range initialization spend 0.0053043365478515625
time for parepare:  0.018790006637573242
local_output_nid generation:  0.004512310028076172
local_in_edges_tensor generation:  0.006334066390991211
mini_batch_src_global generation:  0.003530263900756836
r_  generation:  0.04494810104370117
local_output_nid generation:  0.006082057952880859
local_in_edges_tensor generation:  0.0035331249237060547
mini_batch_src_global generation:  0.0049932003021240234
r_  generation:  0.04575800895690918
local_output_nid generation:  0.006102800369262695
local_in_edges_tensor generation:  0.003334522247314453
mini_batch_src_global generation:  0.0036973953247070312
r_  generation:  0.04750490188598633
local_output_nid generation:  0.0063629150390625
local_in_edges_tensor generation:  0.003429889678955078
mini_batch_src_global generation:  0.003661632537841797
r_  generation:  0.04760003089904785
local_output_nid generation:  0.006138324737548828
local_in_edges_tensor generation:  0.003378629684448242
mini_batch_src_global generation:  0.0038633346557617188
r_  generation:  0.047760009765625
local_output_nid generation:  0.006181478500366211
local_in_edges_tensor generation:  0.0051114559173583984
mini_batch_src_global generation:  0.004028797149658203
r_  generation:  0.048581600189208984
local_output_nid generation:  0.006178855895996094
local_in_edges_tensor generation:  0.0033156871795654297
mini_batch_src_global generation:  0.0042264461517333984
r_  generation:  0.048304080963134766
local_output_nid generation:  0.006154060363769531
local_in_edges_tensor generation:  0.0033559799194335938
mini_batch_src_global generation:  0.004176139831542969
r_  generation:  0.04920387268066406
----------------------check_connections_block total spend ----------------------------- 0.6051797866821289
generate_one_block  0.06475591659545898
generate_one_block  0.06114697456359863
generate_one_block  0.06236004829406738
generate_one_block  0.0612177848815918
generate_one_block  0.06071662902832031
generate_one_block  0.06539344787597656
generate_one_block  0.06642460823059082
generate_one_block  0.06777548789978027
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03888130187988281
gen group dst list time:  0.01679682731628418
time for parepare:  0.01975560188293457
local_output_nid generation:  0.015127897262573242
local_in_edges_tensor generation:  0.03792214393615723
mini_batch_src_global generation:  0.03898358345031738
r_  generation:  0.3686962127685547
local_output_nid generation:  0.020983457565307617
local_in_edges_tensor generation:  0.02625107765197754
mini_batch_src_global generation:  0.04517483711242676
r_  generation:  0.3699796199798584
local_output_nid generation:  0.020919084548950195
local_in_edges_tensor generation:  0.023298978805541992
mini_batch_src_global generation:  0.044295549392700195
r_  generation:  0.37645840644836426
local_output_nid generation:  0.020393848419189453
local_in_edges_tensor generation:  0.02220010757446289
mini_batch_src_global generation:  0.04503321647644043
r_  generation:  0.37619805335998535
local_output_nid generation:  0.020626068115234375
local_in_edges_tensor generation:  0.021666526794433594
mini_batch_src_global generation:  0.045897722244262695
r_  generation:  0.3841547966003418
local_output_nid generation:  0.020767688751220703
local_in_edges_tensor generation:  0.020906686782836914
mini_batch_src_global generation:  0.04841446876525879
r_  generation:  0.3919515609741211
local_output_nid generation:  0.019345521926879883
local_in_edges_tensor generation:  0.024942636489868164
mini_batch_src_global generation:  0.04617452621459961
r_  generation:  0.385723352432251
local_output_nid generation:  0.01939845085144043
local_in_edges_tensor generation:  0.022450685501098633
mini_batch_src_global generation:  0.048004150390625
r_  generation:  0.3876206874847412
----------------------check_connections_block total spend ----------------------------- 4.416186571121216
generate_one_block  0.5093836784362793
generate_one_block  0.5021328926086426
generate_one_block  0.4985005855560303
generate_one_block  0.5028085708618164
generate_one_block  0.5060906410217285
generate_one_block  0.5004441738128662
generate_one_block  0.4948420524597168
generate_one_block  0.5295042991638184
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.034169912338256836
gen group dst list time:  0.03948974609375
time for parepare:  0.020712614059448242
local_output_nid generation:  0.03135180473327637
local_in_edges_tensor generation:  0.05431771278381348
mini_batch_src_global generation:  0.04638791084289551
r_  generation:  0.48792338371276855
local_output_nid generation:  0.03635597229003906
local_in_edges_tensor generation:  0.03751397132873535
mini_batch_src_global generation:  0.05516314506530762
r_  generation:  0.49333786964416504
local_output_nid generation:  0.03649115562438965
local_in_edges_tensor generation:  0.03624558448791504
mini_batch_src_global generation:  0.056941986083984375
r_  generation:  0.5043232440948486
local_output_nid generation:  0.03659176826477051
local_in_edges_tensor generation:  0.0380403995513916
mini_batch_src_global generation:  0.05353093147277832
r_  generation:  0.5087671279907227
local_output_nid generation:  0.037458181381225586
local_in_edges_tensor generation:  0.0333864688873291
mini_batch_src_global generation:  0.05379605293273926
r_  generation:  0.5061910152435303
local_output_nid generation:  0.03889822959899902
local_in_edges_tensor generation:  0.034475088119506836
mini_batch_src_global generation:  0.05615806579589844
r_  generation:  0.5090818405151367
local_output_nid generation:  0.037030935287475586
local_in_edges_tensor generation:  0.03428077697753906
mini_batch_src_global generation:  0.0567929744720459
r_  generation:  0.5092697143554688
local_output_nid generation:  0.0367121696472168
local_in_edges_tensor generation:  0.04138469696044922
mini_batch_src_global generation:  0.05785775184631348
r_  generation:  0.5145480632781982
----------------------check_connections_block total spend ----------------------------- 5.997500896453857
generate_one_block  0.6389148235321045
generate_one_block  0.6247551441192627
generate_one_block  0.6182284355163574
generate_one_block  0.6213951110839844
generate_one_block  0.6219387054443359
generate_one_block  0.6248166561126709
generate_one_block  0.6330106258392334
generate_one_block  0.6192502975463867
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13752508163452148  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

connection checking time:  10.413687467575073
block generation total time  9.046016693115234
average batch blocks generation time:  1.1307520866394043
block dataloader generation time/epoch 21.72660228941176
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1040806770324707  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9599123001098633  GigaBytes
Max Memory Allocated: 1.0972604751586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10480546951293945  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9493727684020996  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1046595573425293  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9517216682434082  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10492897033691406  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9510388374328613  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10451412200927734  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9494519233703613  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10585498809814453  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9537353515625  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10358905792236328  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.945274829864502  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10498714447021484  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.950991153717041  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0786900520324707 |0.017180263996124268 |0.006386399269104004 |9.587407112121582e-05 |0.003396958112716675 |0.00147247314453125 |
----------------------------------------------------------pseudo_mini_loss sum 1.3566856384277344
Total (block generation + training)time/epoch 22.67142717043559
Training time/epoch 0.9263439178466797
Training time without block to device /epoch 0.7889018058776855
Training time without total dataloading part /epoch 0.0805063247680664
load block tensor time/epoch 0.6295204162597656
block to device time/epoch 0.13744211196899414
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  3055220
Number of first layer input nodes during this epoch:  1297681
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13849544525146484  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024808883666992188
random selection method range initialization spend 0.005336284637451172
time for parepare:  0.017534732818603516
local_output_nid generation:  0.004640340805053711
local_in_edges_tensor generation:  0.009156942367553711
mini_batch_src_global generation:  0.0033833980560302734
r_  generation:  0.04603075981140137
local_output_nid generation:  0.006005525588989258
local_in_edges_tensor generation:  0.003431081771850586
mini_batch_src_global generation:  0.004910945892333984
r_  generation:  0.04489278793334961
local_output_nid generation:  0.0060884952545166016
local_in_edges_tensor generation:  0.0036809444427490234
mini_batch_src_global generation:  0.005043506622314453
r_  generation:  0.0470430850982666
local_output_nid generation:  0.0062372684478759766
local_in_edges_tensor generation:  0.003370523452758789
mini_batch_src_global generation:  0.0037097930908203125
r_  generation:  0.049120187759399414
local_output_nid generation:  0.006201744079589844
local_in_edges_tensor generation:  0.003500223159790039
mini_batch_src_global generation:  0.003895998001098633
r_  generation:  0.04803872108459473
local_output_nid generation:  0.006144285202026367
local_in_edges_tensor generation:  0.0033948421478271484
mini_batch_src_global generation:  0.005432844161987305
r_  generation:  0.049405813217163086
local_output_nid generation:  0.006197214126586914
local_in_edges_tensor generation:  0.003442049026489258
mini_batch_src_global generation:  0.004215717315673828
r_  generation:  0.049672842025756836
local_output_nid generation:  0.006154537200927734
local_in_edges_tensor generation:  0.0034945011138916016
mini_batch_src_global generation:  0.0041980743408203125
r_  generation:  0.04942059516906738
----------------------check_connections_block total spend ----------------------------- 0.6094951629638672
generate_one_block  0.059728384017944336
generate_one_block  0.06391143798828125
generate_one_block  0.06267905235290527
generate_one_block  0.06545877456665039
generate_one_block  0.061842918395996094
generate_one_block  0.06759905815124512
generate_one_block  0.06725144386291504
generate_one_block  0.06406068801879883
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05001544952392578
gen group dst list time:  0.01605534553527832
time for parepare:  0.022040367126464844
local_output_nid generation:  0.015127182006835938
local_in_edges_tensor generation:  0.032971858978271484
mini_batch_src_global generation:  0.037369728088378906
r_  generation:  0.36240673065185547
local_output_nid generation:  0.023407936096191406
local_in_edges_tensor generation:  0.030489444732666016
mini_batch_src_global generation:  0.04571938514709473
r_  generation:  0.39098548889160156
local_output_nid generation:  0.023749828338623047
local_in_edges_tensor generation:  0.02557063102722168
mini_batch_src_global generation:  0.046976566314697266
r_  generation:  0.377657413482666
local_output_nid generation:  0.020996809005737305
local_in_edges_tensor generation:  0.021197795867919922
mini_batch_src_global generation:  0.047486305236816406
r_  generation:  0.38133692741394043
local_output_nid generation:  0.021399736404418945
local_in_edges_tensor generation:  0.020458221435546875
mini_batch_src_global generation:  0.04642343521118164
r_  generation:  0.3779945373535156
local_output_nid generation:  0.021599292755126953
local_in_edges_tensor generation:  0.02252984046936035
mini_batch_src_global generation:  0.049102067947387695
r_  generation:  0.3896934986114502
local_output_nid generation:  0.020056962966918945
local_in_edges_tensor generation:  0.02063894271850586
mini_batch_src_global generation:  0.046567440032958984
r_  generation:  0.3907492160797119
local_output_nid generation:  0.020299434661865234
local_in_edges_tensor generation:  0.022102832794189453
mini_batch_src_global generation:  0.05167245864868164
r_  generation:  0.39553141593933105
----------------------check_connections_block total spend ----------------------------- 4.463130474090576
generate_one_block  0.504523754119873
generate_one_block  0.49655699729919434
generate_one_block  0.5051748752593994
generate_one_block  0.4988260269165039
generate_one_block  0.4908602237701416
generate_one_block  0.5013008117675781
generate_one_block  0.4950673580169678
generate_one_block  0.5328550338745117
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03766918182373047
gen group dst list time:  0.03955340385437012
time for parepare:  0.020429611206054688
local_output_nid generation:  0.030481338500976562
local_in_edges_tensor generation:  0.05450749397277832
mini_batch_src_global generation:  0.046395301818847656
r_  generation:  0.4882700443267822
local_output_nid generation:  0.0383601188659668
local_in_edges_tensor generation:  0.03970074653625488
mini_batch_src_global generation:  0.05525374412536621
r_  generation:  0.5028729438781738
local_output_nid generation:  0.036371707916259766
local_in_edges_tensor generation:  0.03777265548706055
mini_batch_src_global generation:  0.05760598182678223
r_  generation:  0.49782562255859375
local_output_nid generation:  0.03632354736328125
local_in_edges_tensor generation:  0.035108089447021484
mini_batch_src_global generation:  0.05316805839538574
r_  generation:  0.5024368762969971
local_output_nid generation:  0.03761744499206543
local_in_edges_tensor generation:  0.03555941581726074
mini_batch_src_global generation:  0.05383753776550293
r_  generation:  0.5046255588531494
local_output_nid generation:  0.03704094886779785
local_in_edges_tensor generation:  0.0337977409362793
mini_batch_src_global generation:  0.05735588073730469
r_  generation:  0.5039644241333008
local_output_nid generation:  0.03875899314880371
local_in_edges_tensor generation:  0.04449820518493652
mini_batch_src_global generation:  0.0549168586730957
r_  generation:  0.5084855556488037
local_output_nid generation:  0.036664485931396484
local_in_edges_tensor generation:  0.04429888725280762
mini_batch_src_global generation:  0.05545163154602051
r_  generation:  0.528306245803833
----------------------check_connections_block total spend ----------------------------- 5.999759197235107
generate_one_block  0.6339273452758789
generate_one_block  0.6132726669311523
generate_one_block  0.618065357208252
generate_one_block  0.6299254894256592
generate_one_block  0.6117830276489258
generate_one_block  0.6270284652709961
generate_one_block  0.6127896308898926
generate_one_block  0.6088802814483643
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13849544525146484  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

connection checking time:  10.462889671325684
block generation total time  8.980837345123291
average batch blocks generation time:  1.1226046681404114
block dataloader generation time/epoch 21.70933997631073
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10429143905639648  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9502439498901367  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10555648803710938  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9516186714172363  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10469627380371094  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9511880874633789  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1050729751586914  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9515762329101562  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10435009002685547  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9487948417663574  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1058492660522461  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9556698799133301  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10399341583251953  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9495644569396973  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10543155670166016  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9538516998291016  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08646970987319946 |0.01708093285560608 |0.0035766661167144775 |9.530782699584961e-05 |0.003796905279159546 |0.001867532730102539 |
----------------------------------------------------------pseudo_mini_loss sum 1.3413302898406982
Total (block generation + training)time/epoch 22.656310272216796
Training time/epoch 0.9660160541534424
Training time without block to device /epoch 0.8293685913085938
Training time without total dataloading part /epoch 0.06161856651306152
load block tensor time/epoch 0.6917576789855957
block to device time/epoch 0.13664746284484863
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  3055462
Number of first layer input nodes during this epoch:  1297733
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1392660140991211  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025331974029541016
random selection method range initialization spend 0.005692958831787109
time for parepare:  0.017782211303710938
local_output_nid generation:  0.004501819610595703
local_in_edges_tensor generation:  0.009446144104003906
mini_batch_src_global generation:  0.003367900848388672
r_  generation:  0.0451357364654541
local_output_nid generation:  0.006056308746337891
local_in_edges_tensor generation:  0.0033049583435058594
mini_batch_src_global generation:  0.0050525665283203125
r_  generation:  0.04548525810241699
local_output_nid generation:  0.006104946136474609
local_in_edges_tensor generation:  0.0033490657806396484
mini_batch_src_global generation:  0.0037550926208496094
r_  generation:  0.04636430740356445
local_output_nid generation:  0.006112098693847656
local_in_edges_tensor generation:  0.0032854080200195312
mini_batch_src_global generation:  0.0037250518798828125
r_  generation:  0.048232316970825195
local_output_nid generation:  0.006295204162597656
local_in_edges_tensor generation:  0.0033838748931884766
mini_batch_src_global generation:  0.004121303558349609
r_  generation:  0.04777646064758301
local_output_nid generation:  0.006078958511352539
local_in_edges_tensor generation:  0.003389120101928711
mini_batch_src_global generation:  0.004036664962768555
r_  generation:  0.04853391647338867
local_output_nid generation:  0.006181955337524414
local_in_edges_tensor generation:  0.0033965110778808594
mini_batch_src_global generation:  0.004191875457763672
r_  generation:  0.04883742332458496
local_output_nid generation:  0.0061664581298828125
local_in_edges_tensor generation:  0.0032694339752197266
mini_batch_src_global generation:  0.004095554351806641
r_  generation:  0.04866290092468262
----------------------check_connections_block total spend ----------------------------- 0.6000964641571045
generate_one_block  0.06081676483154297
generate_one_block  0.06175518035888672
generate_one_block  0.06137800216674805
generate_one_block  0.06219649314880371
generate_one_block  0.06156420707702637
generate_one_block  0.06163763999938965
generate_one_block  0.06534123420715332
generate_one_block  0.061957597732543945
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03916525840759277
gen group dst list time:  0.015614986419677734
time for parepare:  0.020005464553833008
local_output_nid generation:  0.015142679214477539
local_in_edges_tensor generation:  0.030979633331298828
mini_batch_src_global generation:  0.03812980651855469
r_  generation:  0.36748528480529785
local_output_nid generation:  0.021095991134643555
local_in_edges_tensor generation:  0.026336669921875
mini_batch_src_global generation:  0.047037601470947266
r_  generation:  0.3882791996002197
local_output_nid generation:  0.0207059383392334
local_in_edges_tensor generation:  0.02142786979675293
mini_batch_src_global generation:  0.04757976531982422
r_  generation:  0.38693737983703613
local_output_nid generation:  0.021620512008666992
local_in_edges_tensor generation:  0.030673980712890625
mini_batch_src_global generation:  0.05139875411987305
r_  generation:  0.4078836441040039
local_output_nid generation:  0.02576756477355957
local_in_edges_tensor generation:  0.02634716033935547
mini_batch_src_global generation:  0.04696488380432129
r_  generation:  0.3811795711517334
local_output_nid generation:  0.021445274353027344
local_in_edges_tensor generation:  0.023610830307006836
mini_batch_src_global generation:  0.04652810096740723
r_  generation:  0.38419604301452637
local_output_nid generation:  0.020502567291259766
local_in_edges_tensor generation:  0.02196669578552246
mini_batch_src_global generation:  0.047728776931762695
r_  generation:  0.3830909729003906
local_output_nid generation:  0.020073652267456055
local_in_edges_tensor generation:  0.020867109298706055
mini_batch_src_global generation:  0.04661726951599121
r_  generation:  0.37897682189941406
----------------------check_connections_block total spend ----------------------------- 4.480551481246948
generate_one_block  0.5016942024230957
generate_one_block  0.5102829933166504
generate_one_block  0.4981234073638916
generate_one_block  0.4966762065887451
generate_one_block  0.49595165252685547
generate_one_block  0.49388980865478516
generate_one_block  0.5115101337432861
generate_one_block  0.522484302520752
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0383608341217041
gen group dst list time:  0.0399014949798584
time for parepare:  0.0208127498626709
local_output_nid generation:  0.03142237663269043
local_in_edges_tensor generation:  0.05734896659851074
mini_batch_src_global generation:  0.04779386520385742
r_  generation:  0.482882022857666
local_output_nid generation:  0.03600716590881348
local_in_edges_tensor generation:  0.039124250411987305
mini_batch_src_global generation:  0.05634045600891113
r_  generation:  0.4852726459503174
local_output_nid generation:  0.0361332893371582
local_in_edges_tensor generation:  0.03651928901672363
mini_batch_src_global generation:  0.05700111389160156
r_  generation:  0.48885154724121094
local_output_nid generation:  0.03671622276306152
local_in_edges_tensor generation:  0.03553962707519531
mini_batch_src_global generation:  0.052492380142211914
r_  generation:  0.4959568977355957
local_output_nid generation:  0.03622841835021973
local_in_edges_tensor generation:  0.03735494613647461
mini_batch_src_global generation:  0.05400800704956055
r_  generation:  0.5105187892913818
local_output_nid generation:  0.03612184524536133
local_in_edges_tensor generation:  0.03423476219177246
mini_batch_src_global generation:  0.05414891242980957
r_  generation:  0.5046415328979492
local_output_nid generation:  0.03651833534240723
local_in_edges_tensor generation:  0.03849148750305176
mini_batch_src_global generation:  0.05539512634277344
r_  generation:  0.5078568458557129
local_output_nid generation:  0.03602266311645508
local_in_edges_tensor generation:  0.047446250915527344
mini_batch_src_global generation:  0.05433535575866699
r_  generation:  0.5092904567718506
----------------------check_connections_block total spend ----------------------------- 5.940027713775635
generate_one_block  0.6328706741333008
generate_one_block  0.6286811828613281
generate_one_block  0.6375112533569336
generate_one_block  0.6314938068389893
generate_one_block  0.6191778182983398
generate_one_block  0.6218156814575195
generate_one_block  0.6227457523345947
generate_one_block  0.618140697479248
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1392660140991211  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

connection checking time:  10.420579195022583
block generation total time  9.043049573898315
average batch blocks generation time:  1.1303811967372894
block dataloader generation time/epoch 21.693538774143565
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10506296157836914  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9519057273864746  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10509490966796875  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9511418342590332  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1042013168334961  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9506292343139648  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10534000396728516  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9523105621337891  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10396671295166016  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9492683410644531  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10515356063842773  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9488134384155273  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10445833206176758  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9510016441345215  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10507011413574219  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9496893882751465  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07949194312095642 |0.020368844270706177 |0.003856569528579712 |9.709596633911133e-05 |0.003178119659423828 |0.00159454345703125 |
----------------------------------------------------------pseudo_mini_loss sum 1.3268829584121704
Total (block generation + training)time/epoch 22.63889054818587
Training time/epoch 0.9289193153381348
Training time without block to device /epoch 0.7659685611724854
Training time without total dataloading part /epoch 0.05864882469177246
load block tensor time/epoch 0.6359355449676514
block to device time/epoch 0.16295075416564941
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 20 |
Number of nodes for computation during this epoch:  3054536
Number of first layer input nodes during this epoch:  1297706
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1386547088623047  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026607275009155273
random selection method range initialization spend 0.006741762161254883
time for parepare:  0.01830005645751953
local_output_nid generation:  0.004505634307861328
local_in_edges_tensor generation:  0.01007390022277832
mini_batch_src_global generation:  0.004103183746337891
r_  generation:  0.04506373405456543
local_output_nid generation:  0.0059702396392822266
local_in_edges_tensor generation:  0.003384113311767578
mini_batch_src_global generation:  0.005000591278076172
r_  generation:  0.04508662223815918
local_output_nid generation:  0.006087541580200195
local_in_edges_tensor generation:  0.0034401416778564453
mini_batch_src_global generation:  0.0037355422973632812
r_  generation:  0.046050310134887695
local_output_nid generation:  0.006142139434814453
local_in_edges_tensor generation:  0.0034661293029785156
mini_batch_src_global generation:  0.0037088394165039062
r_  generation:  0.04670524597167969
local_output_nid generation:  0.006145477294921875
local_in_edges_tensor generation:  0.003336668014526367
mini_batch_src_global generation:  0.004017829895019531
r_  generation:  0.04778265953063965
local_output_nid generation:  0.0061168670654296875
local_in_edges_tensor generation:  0.003477334976196289
mini_batch_src_global generation:  0.004134416580200195
r_  generation:  0.04897189140319824
local_output_nid generation:  0.006054878234863281
local_in_edges_tensor generation:  0.003480195999145508
mini_batch_src_global generation:  0.004224061965942383
r_  generation:  0.04808163642883301
local_output_nid generation:  0.00606536865234375
local_in_edges_tensor generation:  0.0034990310668945312
mini_batch_src_global generation:  0.004032611846923828
r_  generation:  0.04665040969848633
----------------------check_connections_block total spend ----------------------------- 0.5980567932128906
generate_one_block  0.06342482566833496
generate_one_block  0.06058621406555176
generate_one_block  0.06203436851501465
generate_one_block  0.06472253799438477
generate_one_block  0.06324243545532227
generate_one_block  0.06387019157409668
generate_one_block  0.06597328186035156
generate_one_block  0.06205940246582031
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03789973258972168
gen group dst list time:  0.015194177627563477
time for parepare:  0.020304441452026367
local_output_nid generation:  0.014767169952392578
local_in_edges_tensor generation:  0.03610348701477051
mini_batch_src_global generation:  0.037554025650024414
r_  generation:  0.364013671875
local_output_nid generation:  0.020725011825561523
local_in_edges_tensor generation:  0.027729511260986328
mini_batch_src_global generation:  0.04481935501098633
r_  generation:  0.3812835216522217
local_output_nid generation:  0.02139568328857422
local_in_edges_tensor generation:  0.026601552963256836
mini_batch_src_global generation:  0.045775651931762695
r_  generation:  0.38030409812927246
local_output_nid generation:  0.020476102828979492
local_in_edges_tensor generation:  0.0314791202545166
mini_batch_src_global generation:  0.050469398498535156
r_  generation:  0.3885915279388428
local_output_nid generation:  0.023598670959472656
local_in_edges_tensor generation:  0.024017333984375
mini_batch_src_global generation:  0.04588913917541504
r_  generation:  0.3786635398864746
local_output_nid generation:  0.021446943283081055
local_in_edges_tensor generation:  0.02568674087524414
mini_batch_src_global generation:  0.05833148956298828
r_  generation:  0.38556623458862305
local_output_nid generation:  0.020231246948242188
local_in_edges_tensor generation:  0.02177572250366211
mini_batch_src_global generation:  0.04668569564819336
r_  generation:  0.3829808235168457
local_output_nid generation:  0.019698619842529297
local_in_edges_tensor generation:  0.020661115646362305
mini_batch_src_global generation:  0.04615521430969238
r_  generation:  0.3744330406188965
----------------------check_connections_block total spend ----------------------------- 4.445397853851318
generate_one_block  0.4916408061981201
generate_one_block  0.503162145614624
generate_one_block  0.47873783111572266
generate_one_block  0.486499547958374
generate_one_block  0.485980749130249
generate_one_block  0.506066083908081
generate_one_block  0.5004072189331055
generate_one_block  0.5233175754547119
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03654789924621582
gen group dst list time:  0.03959918022155762
time for parepare:  0.020900726318359375
local_output_nid generation:  0.0319209098815918
local_in_edges_tensor generation:  0.05686640739440918
mini_batch_src_global generation:  0.0440518856048584
r_  generation:  0.4948246479034424
local_output_nid generation:  0.03604412078857422
local_in_edges_tensor generation:  0.047638893127441406
mini_batch_src_global generation:  0.05965399742126465
r_  generation:  0.5102188587188721
local_output_nid generation:  0.03906893730163574
local_in_edges_tensor generation:  0.0393373966217041
mini_batch_src_global generation:  0.05695223808288574
r_  generation:  0.4979572296142578
local_output_nid generation:  0.036968231201171875
local_in_edges_tensor generation:  0.039483070373535156
mini_batch_src_global generation:  0.052974700927734375
r_  generation:  0.4975860118865967
local_output_nid generation:  0.03720855712890625
local_in_edges_tensor generation:  0.036762237548828125
mini_batch_src_global generation:  0.056116342544555664
r_  generation:  0.4964563846588135
local_output_nid generation:  0.037018537521362305
local_in_edges_tensor generation:  0.03671598434448242
mini_batch_src_global generation:  0.05400252342224121
r_  generation:  0.5044310092926025
local_output_nid generation:  0.03735661506652832
local_in_edges_tensor generation:  0.03375673294067383
mini_batch_src_global generation:  0.055196285247802734
r_  generation:  0.5116238594055176
local_output_nid generation:  0.0371859073638916
local_in_edges_tensor generation:  0.03480792045593262
mini_batch_src_global generation:  0.054297447204589844
r_  generation:  0.5087511539459229
----------------------check_connections_block total spend ----------------------------- 5.985369682312012
generate_one_block  0.6231932640075684
generate_one_block  0.6171655654907227
generate_one_block  0.622614860534668
generate_one_block  0.6200563907623291
generate_one_block  0.630305290222168
generate_one_block  0.6297814846038818
generate_one_block  0.6174826622009277
generate_one_block  0.6242034435272217
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1386547088623047  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

connection checking time:  10.43076753616333
block generation total time  8.960614919662476
average batch blocks generation time:  1.1200768649578094
block dataloader generation time/epoch 21.67499715089798
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10443782806396484  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9505877494812012  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10506248474121094  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9509210586547852  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1045541763305664  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9552030563354492  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10530281066894531  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9506030082702637  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10481739044189453  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9508261680603027  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10518455505371094  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9555253982543945  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10371732711791992  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9495072364807129  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10484886169433594  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9462490081787109  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0867074728012085 |0.01817074418067932 |0.0035031139850616455 |9.22083854675293e-05 |0.0038039088249206543 |0.0016031265258789062 |
----------------------------------------------------------pseudo_mini_loss sum 1.3115639686584473
Total (block generation + training)time/epoch 22.62299891312917
Training time/epoch 0.9768762588500977
Training time without block to device /epoch 0.8315103054046631
Training time without total dataloading part /epoch 0.06079697608947754
load block tensor time/epoch 0.693659782409668
block to device time/epoch 0.14536595344543457
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 21 |
Number of nodes for computation during this epoch:  3054732
Number of first layer input nodes during this epoch:  1297602
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13784551620483398  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023061037063598633
random selection method range initialization spend 0.0054645538330078125
time for parepare:  0.017151594161987305
local_output_nid generation:  0.00457000732421875
local_in_edges_tensor generation:  0.006712436676025391
mini_batch_src_global generation:  0.00344085693359375
r_  generation:  0.044888973236083984
local_output_nid generation:  0.005948305130004883
local_in_edges_tensor generation:  0.0032892227172851562
mini_batch_src_global generation:  0.004950761795043945
r_  generation:  0.04529595375061035
local_output_nid generation:  0.006097316741943359
local_in_edges_tensor generation:  0.0035054683685302734
mini_batch_src_global generation:  0.003691434860229492
r_  generation:  0.04665088653564453
local_output_nid generation:  0.006104946136474609
local_in_edges_tensor generation:  0.003354787826538086
mini_batch_src_global generation:  0.0037317276000976562
r_  generation:  0.04721784591674805
local_output_nid generation:  0.0060901641845703125
local_in_edges_tensor generation:  0.0032536983489990234
mini_batch_src_global generation:  0.004080533981323242
r_  generation:  0.047804832458496094
local_output_nid generation:  0.00612330436706543
local_in_edges_tensor generation:  0.003407001495361328
mini_batch_src_global generation:  0.004050016403198242
r_  generation:  0.04806232452392578
local_output_nid generation:  0.006239891052246094
local_in_edges_tensor generation:  0.0033392906188964844
mini_batch_src_global generation:  0.0041348934173583984
r_  generation:  0.048595428466796875
local_output_nid generation:  0.006196260452270508
local_in_edges_tensor generation:  0.0033659934997558594
mini_batch_src_global generation:  0.0040853023529052734
r_  generation:  0.04900932312011719
----------------------check_connections_block total spend ----------------------------- 0.5955283641815186
generate_one_block  0.06766629219055176
generate_one_block  0.060637712478637695
generate_one_block  0.06092667579650879
generate_one_block  0.06141042709350586
generate_one_block  0.06195068359375
generate_one_block  0.061276912689208984
generate_one_block  0.06473731994628906
generate_one_block  0.06264877319335938
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03722548484802246
gen group dst list time:  0.015259742736816406
time for parepare:  0.018891334533691406
local_output_nid generation:  0.014661550521850586
local_in_edges_tensor generation:  0.0314481258392334
mini_batch_src_global generation:  0.03706502914428711
r_  generation:  0.35898566246032715
local_output_nid generation:  0.020970821380615234
local_in_edges_tensor generation:  0.02730107307434082
mini_batch_src_global generation:  0.0450894832611084
r_  generation:  0.37245702743530273
local_output_nid generation:  0.020826101303100586
local_in_edges_tensor generation:  0.020787954330444336
mini_batch_src_global generation:  0.044008731842041016
r_  generation:  0.37158989906311035
local_output_nid generation:  0.02038884162902832
local_in_edges_tensor generation:  0.02022409439086914
mini_batch_src_global generation:  0.04486894607543945
r_  generation:  0.3739795684814453
local_output_nid generation:  0.020712614059448242
local_in_edges_tensor generation:  0.020197629928588867
mini_batch_src_global generation:  0.04718589782714844
r_  generation:  0.38265323638916016
local_output_nid generation:  0.020932912826538086
local_in_edges_tensor generation:  0.020615577697753906
mini_batch_src_global generation:  0.04578375816345215
r_  generation:  0.38026905059814453
local_output_nid generation:  0.020174741744995117
local_in_edges_tensor generation:  0.021960735321044922
mini_batch_src_global generation:  0.04569816589355469
r_  generation:  0.38019752502441406
local_output_nid generation:  0.01974654197692871
local_in_edges_tensor generation:  0.021923542022705078
mini_batch_src_global generation:  0.046648502349853516
r_  generation:  0.38365960121154785
----------------------check_connections_block total spend ----------------------------- 4.351595640182495
generate_one_block  0.485187292098999
generate_one_block  0.4869413375854492
generate_one_block  0.4830746650695801
generate_one_block  0.4831671714782715
generate_one_block  0.4894428253173828
generate_one_block  0.48572492599487305
generate_one_block  0.48436784744262695
generate_one_block  0.5219590663909912
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03298306465148926
gen group dst list time:  0.03821516036987305
time for parepare:  0.018904447555541992
local_output_nid generation:  0.029946327209472656
local_in_edges_tensor generation:  0.03886556625366211
mini_batch_src_global generation:  0.04293084144592285
r_  generation:  0.4767279624938965
local_output_nid generation:  0.03625965118408203
local_in_edges_tensor generation:  0.03499197959899902
mini_batch_src_global generation:  0.05524635314941406
r_  generation:  0.4820725917816162
local_output_nid generation:  0.035675764083862305
local_in_edges_tensor generation:  0.036051034927368164
mini_batch_src_global generation:  0.05399036407470703
r_  generation:  0.4933438301086426
local_output_nid generation:  0.03615450859069824
local_in_edges_tensor generation:  0.03866314888000488
mini_batch_src_global generation:  0.05328059196472168
r_  generation:  0.4944906234741211
local_output_nid generation:  0.03627777099609375
local_in_edges_tensor generation:  0.036638498306274414
mini_batch_src_global generation:  0.05403399467468262
r_  generation:  0.4956631660461426
local_output_nid generation:  0.03601717948913574
local_in_edges_tensor generation:  0.03225827217102051
mini_batch_src_global generation:  0.05402708053588867
r_  generation:  0.499298095703125
local_output_nid generation:  0.036901235580444336
local_in_edges_tensor generation:  0.035439491271972656
mini_batch_src_global generation:  0.05374336242675781
r_  generation:  0.4980008602142334
local_output_nid generation:  0.03715109825134277
local_in_edges_tensor generation:  0.03398323059082031
mini_batch_src_global generation:  0.05689573287963867
r_  generation:  0.5013992786407471
----------------------check_connections_block total spend ----------------------------- 5.834784746170044
generate_one_block  0.6177413463592529
generate_one_block  0.6110439300537109
generate_one_block  0.6180329322814941
generate_one_block  0.6202225685119629
generate_one_block  0.6158967018127441
generate_one_block  0.6203951835632324
generate_one_block  0.6186733245849609
generate_one_block  0.6210575103759766
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13784551620483398  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

connection checking time:  10.186380386352539
block generation total time  8.862928628921509
average batch blocks generation time:  1.1078660786151886
block dataloader generation time/epoch 21.631492761465218
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1040806770324707  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9497170448303223  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10529613494873047  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9512300491333008  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1042947769165039  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9489927291870117  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.105743408203125  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9518342018127441  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10449886322021484  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9497032165527344  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10522270202636719  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.950502872467041  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10459327697753906  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9490342140197754  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1056528091430664  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9528155326843262  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08162802457809448 |0.017125070095062256 |0.003440380096435547 |9.140372276306152e-05 |0.0032724738121032715 |0.0017175674438476562 |
----------------------------------------------------------pseudo_mini_loss sum 1.3015053272247314
Total (block generation + training)time/epoch 22.57778217242314
Training time/epoch 0.9254684448242188
Training time without block to device /epoch 0.7884678840637207
Training time without total dataloading part /epoch 0.056151628494262695
load block tensor time/epoch 0.6530241966247559
block to device time/epoch 0.13700056076049805
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 22 |
Number of nodes for computation during this epoch:  3052697
Number of first layer input nodes during this epoch:  1297177
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13828516006469727  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02236628532409668
random selection method range initialization spend 0.0054514408111572266
time for parepare:  0.01688671112060547
local_output_nid generation:  0.004472970962524414
local_in_edges_tensor generation:  0.006542205810546875
mini_batch_src_global generation:  0.0032672882080078125
r_  generation:  0.044107675552368164
local_output_nid generation:  0.005970478057861328
local_in_edges_tensor generation:  0.0036389827728271484
mini_batch_src_global generation:  0.00505375862121582
r_  generation:  0.04661226272583008
local_output_nid generation:  0.006067514419555664
local_in_edges_tensor generation:  0.003379344940185547
mini_batch_src_global generation:  0.0037021636962890625
r_  generation:  0.045805931091308594
local_output_nid generation:  0.006099224090576172
local_in_edges_tensor generation:  0.003313302993774414
mini_batch_src_global generation:  0.0035829544067382812
r_  generation:  0.04720664024353027
local_output_nid generation:  0.006165027618408203
local_in_edges_tensor generation:  0.0033037662506103516
mini_batch_src_global generation:  0.003880739212036133
r_  generation:  0.048273324966430664
local_output_nid generation:  0.006204843521118164
local_in_edges_tensor generation:  0.003408193588256836
mini_batch_src_global generation:  0.00402522087097168
r_  generation:  0.0485835075378418
local_output_nid generation:  0.006093740463256836
local_in_edges_tensor generation:  0.0034406185150146484
mini_batch_src_global generation:  0.004120588302612305
r_  generation:  0.04769396781921387
local_output_nid generation:  0.006117105484008789
local_in_edges_tensor generation:  0.003366231918334961
mini_batch_src_global generation:  0.00411224365234375
r_  generation:  0.0490567684173584
----------------------check_connections_block total spend ----------------------------- 0.5921616554260254
generate_one_block  0.05879783630371094
generate_one_block  0.0626370906829834
generate_one_block  0.06687569618225098
generate_one_block  0.06425929069519043
generate_one_block  0.06299448013305664
generate_one_block  0.06187772750854492
generate_one_block  0.06440877914428711
generate_one_block  0.06415915489196777
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03346824645996094
gen group dst list time:  0.015271425247192383
time for parepare:  0.019002437591552734
local_output_nid generation:  0.014455080032348633
local_in_edges_tensor generation:  0.03100872039794922
mini_batch_src_global generation:  0.03619050979614258
r_  generation:  0.3621394634246826
local_output_nid generation:  0.021066904067993164
local_in_edges_tensor generation:  0.02610468864440918
mini_batch_src_global generation:  0.04480910301208496
r_  generation:  0.3827855587005615
local_output_nid generation:  0.023703336715698242
local_in_edges_tensor generation:  0.028270244598388672
mini_batch_src_global generation:  0.043799638748168945
r_  generation:  0.38295793533325195
local_output_nid generation:  0.023379802703857422
local_in_edges_tensor generation:  0.0339047908782959
mini_batch_src_global generation:  0.04426693916320801
r_  generation:  0.39724254608154297
local_output_nid generation:  0.02365708351135254
local_in_edges_tensor generation:  0.025907516479492188
mini_batch_src_global generation:  0.04550290107727051
r_  generation:  0.38452744483947754
local_output_nid generation:  0.03199911117553711
local_in_edges_tensor generation:  0.02118825912475586
mini_batch_src_global generation:  0.046010494232177734
r_  generation:  0.38422632217407227
local_output_nid generation:  0.0203249454498291
local_in_edges_tensor generation:  0.02219867706298828
mini_batch_src_global generation:  0.047376394271850586
r_  generation:  0.383497953414917
local_output_nid generation:  0.021143674850463867
local_in_edges_tensor generation:  0.02478957176208496
mini_batch_src_global generation:  0.046378374099731445
r_  generation:  0.3849625587463379
----------------------check_connections_block total spend ----------------------------- 4.4734625816345215
generate_one_block  0.50351881980896
generate_one_block  0.5045647621154785
generate_one_block  0.49047160148620605
generate_one_block  0.4879450798034668
generate_one_block  0.5116283893585205
generate_one_block  0.48976874351501465
generate_one_block  0.4849114418029785
generate_one_block  0.5280883312225342
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.038805246353149414
gen group dst list time:  0.04046344757080078
time for parepare:  0.01946115493774414
local_output_nid generation:  0.030247211456298828
local_in_edges_tensor generation:  0.05184650421142578
mini_batch_src_global generation:  0.04569745063781738
r_  generation:  0.48174595832824707
local_output_nid generation:  0.03708195686340332
local_in_edges_tensor generation:  0.04008793830871582
mini_batch_src_global generation:  0.06015372276306152
r_  generation:  0.485659122467041
local_output_nid generation:  0.03589940071105957
local_in_edges_tensor generation:  0.03586769104003906
mini_batch_src_global generation:  0.05806851387023926
r_  generation:  0.4906606674194336
local_output_nid generation:  0.036177635192871094
local_in_edges_tensor generation:  0.03990340232849121
mini_batch_src_global generation:  0.05256843566894531
r_  generation:  0.5114009380340576
local_output_nid generation:  0.038063764572143555
local_in_edges_tensor generation:  0.0386509895324707
mini_batch_src_global generation:  0.056444406509399414
r_  generation:  0.4993157386779785
local_output_nid generation:  0.03738045692443848
local_in_edges_tensor generation:  0.03352475166320801
mini_batch_src_global generation:  0.05344986915588379
r_  generation:  0.49973416328430176
local_output_nid generation:  0.03654026985168457
local_in_edges_tensor generation:  0.03727579116821289
mini_batch_src_global generation:  0.05313420295715332
r_  generation:  0.501378059387207
local_output_nid generation:  0.037114858627319336
local_in_edges_tensor generation:  0.0383760929107666
mini_batch_src_global generation:  0.05381131172180176
r_  generation:  0.5061039924621582
----------------------check_connections_block total spend ----------------------------- 5.922149419784546
generate_one_block  0.621917724609375
generate_one_block  0.6337575912475586
generate_one_block  0.6162247657775879
generate_one_block  0.6173992156982422
generate_one_block  0.6172714233398438
generate_one_block  0.6155321598052979
generate_one_block  0.6263010501861572
generate_one_block  0.6174840927124023
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13828516006469727  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

connection checking time:  10.395612001419067
block generation total time  8.966785192489624
average batch blocks generation time:  1.120848149061203
block dataloader generation time/epoch 21.62040913105011
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10363531112670898  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.948143482208252  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1053767204284668  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9550490379333496  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1041560173034668  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9495840072631836  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1051778793334961  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9504222869873047  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10443496704101562  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9487590789794922  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10492134094238281  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9508876800537109  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1044774055480957  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9490346908569336  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10579490661621094  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9544711112976074  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08241981267929077 |0.017116189002990723 |0.00347331166267395 |9.042024612426758e-05 |0.0035957694053649902 |0.001299142837524414 |
----------------------------------------------------------pseudo_mini_loss sum 1.283692479133606
Total (block generation + training)time/epoch 22.5656943832125
Training time/epoch 0.9319684505462646
Training time without block to device /epoch 0.7950389385223389
Training time without total dataloading part /epoch 0.05857515335083008
load block tensor time/epoch 0.6593585014343262
block to device time/epoch 0.13692951202392578
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 23 |
Number of nodes for computation during this epoch:  3054737
Number of first layer input nodes during this epoch:  1297964
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1382603645324707  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028635025024414062
random selection method range initialization spend 0.0071260929107666016
time for parepare:  0.018854618072509766
local_output_nid generation:  0.004488229751586914
local_in_edges_tensor generation:  0.0072672367095947266
mini_batch_src_global generation:  0.005582094192504883
r_  generation:  0.045185089111328125
local_output_nid generation:  0.005959987640380859
local_in_edges_tensor generation:  0.0039825439453125
mini_batch_src_global generation:  0.005070924758911133
r_  generation:  0.04824113845825195
local_output_nid generation:  0.006692171096801758
local_in_edges_tensor generation:  0.003343343734741211
mini_batch_src_global generation:  0.0036978721618652344
r_  generation:  0.04711294174194336
local_output_nid generation:  0.0061948299407958984
local_in_edges_tensor generation:  0.003323793411254883
mini_batch_src_global generation:  0.005855560302734375
r_  generation:  0.046579837799072266
local_output_nid generation:  0.006169557571411133
local_in_edges_tensor generation:  0.003331899642944336
mini_batch_src_global generation:  0.0038919448852539062
r_  generation:  0.051625728607177734
local_output_nid generation:  0.006828784942626953
local_in_edges_tensor generation:  0.0032863616943359375
mini_batch_src_global generation:  0.004143953323364258
r_  generation:  0.04881644248962402
local_output_nid generation:  0.007903814315795898
local_in_edges_tensor generation:  0.003476381301879883
mini_batch_src_global generation:  0.005710124969482422
r_  generation:  0.048215389251708984
local_output_nid generation:  0.006203889846801758
local_in_edges_tensor generation:  0.003255605697631836
mini_batch_src_global generation:  0.004122257232666016
r_  generation:  0.0508723258972168
----------------------check_connections_block total spend ----------------------------- 0.617145299911499
generate_one_block  0.06119799613952637
generate_one_block  0.061304330825805664
generate_one_block  0.06194806098937988
generate_one_block  0.060512542724609375
generate_one_block  0.06052064895629883
generate_one_block  0.061890602111816406
generate_one_block  0.06580662727355957
generate_one_block  0.06205010414123535
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0388646125793457
gen group dst list time:  0.015503168106079102
time for parepare:  0.01979684829711914
local_output_nid generation:  0.015022754669189453
local_in_edges_tensor generation:  0.03421974182128906
mini_batch_src_global generation:  0.03774094581604004
r_  generation:  0.36266279220581055
local_output_nid generation:  0.021172523498535156
local_in_edges_tensor generation:  0.02591252326965332
mini_batch_src_global generation:  0.0449678897857666
r_  generation:  0.3730437755584717
local_output_nid generation:  0.02083301544189453
local_in_edges_tensor generation:  0.02253127098083496
mini_batch_src_global generation:  0.04704594612121582
r_  generation:  0.3807826042175293
local_output_nid generation:  0.020435333251953125
local_in_edges_tensor generation:  0.021512746810913086
mini_batch_src_global generation:  0.04541611671447754
r_  generation:  0.3746035099029541
local_output_nid generation:  0.020738601684570312
local_in_edges_tensor generation:  0.02077031135559082
mini_batch_src_global generation:  0.0469818115234375
r_  generation:  0.3815920352935791
local_output_nid generation:  0.020842313766479492
local_in_edges_tensor generation:  0.022360563278198242
mini_batch_src_global generation:  0.0468294620513916
r_  generation:  0.38823771476745605
local_output_nid generation:  0.020015716552734375
local_in_edges_tensor generation:  0.020761728286743164
mini_batch_src_global generation:  0.04575610160827637
r_  generation:  0.3864293098449707
local_output_nid generation:  0.019804000854492188
local_in_edges_tensor generation:  0.021394729614257812
mini_batch_src_global generation:  0.048887014389038086
r_  generation:  0.38848233222961426
----------------------check_connections_block total spend ----------------------------- 4.4014222621917725
generate_one_block  0.5199346542358398
generate_one_block  0.5002012252807617
generate_one_block  0.49701952934265137
generate_one_block  0.490750789642334
generate_one_block  0.4845592975616455
generate_one_block  0.5038161277770996
generate_one_block  0.4877786636352539
generate_one_block  0.5308003425598145
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03189539909362793
gen group dst list time:  0.03827953338623047
time for parepare:  0.020504236221313477
local_output_nid generation:  0.030681848526000977
local_in_edges_tensor generation:  0.04972982406616211
mini_batch_src_global generation:  0.04606294631958008
r_  generation:  0.4864661693572998
local_output_nid generation:  0.036312103271484375
local_in_edges_tensor generation:  0.03960990905761719
mini_batch_src_global generation:  0.055802106857299805
r_  generation:  0.5004301071166992
local_output_nid generation:  0.03608298301696777
local_in_edges_tensor generation:  0.0356903076171875
mini_batch_src_global generation:  0.054108381271362305
r_  generation:  0.4918074607849121
local_output_nid generation:  0.036348819732666016
local_in_edges_tensor generation:  0.03375363349914551
mini_batch_src_global generation:  0.05240774154663086
r_  generation:  0.5037260055541992
local_output_nid generation:  0.036676645278930664
local_in_edges_tensor generation:  0.037941932678222656
mini_batch_src_global generation:  0.05345463752746582
r_  generation:  0.5003662109375
local_output_nid generation:  0.03800177574157715
local_in_edges_tensor generation:  0.037628173828125
mini_batch_src_global generation:  0.05359363555908203
r_  generation:  0.5060815811157227
local_output_nid generation:  0.03637075424194336
local_in_edges_tensor generation:  0.03388214111328125
mini_batch_src_global generation:  0.05583381652832031
r_  generation:  0.5078773498535156
local_output_nid generation:  0.03770804405212402
local_in_edges_tensor generation:  0.0444948673248291
mini_batch_src_global generation:  0.05640530586242676
r_  generation:  0.5253403186798096
----------------------check_connections_block total spend ----------------------------- 5.9705810546875
generate_one_block  0.6341104507446289
generate_one_block  0.6222724914550781
generate_one_block  0.6208951473236084
generate_one_block  0.6194987297058105
generate_one_block  0.6212983131408691
generate_one_block  0.6265373229980469
generate_one_block  0.6308703422546387
generate_one_block  0.6303656101226807
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1382603645324707  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

connection checking time:  10.372003316879272
block generation total time  9.020709037780762
average batch blocks generation time:  1.1275886297225952
block dataloader generation time/epoch 21.610105832417805
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1042776107788086  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9543023109436035  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10497283935546875  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9525260925292969  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10429811477661133  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9510760307312012  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10493755340576172  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9487261772155762  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1044154167175293  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9457273483276367  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10547208786010742  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9507584571838379  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10420751571655273  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9490671157836914  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10565853118896484  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9521589279174805  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08236727118492126 |0.017172783613204956 |0.0035687685012817383 |9.292364120483398e-05 |0.0035036206245422363 |0.0029189586639404297 |
----------------------------------------------------------pseudo_mini_loss sum 1.2703630924224854
Total (block generation + training)time/epoch 22.554415925343832
Training time/epoch 0.9303843975067139
Training time without block to device /epoch 0.7930021286010742
Training time without total dataloading part /epoch 0.0602414608001709
load block tensor time/epoch 0.6589381694793701
block to device time/epoch 0.13738226890563965
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 24 |
Number of nodes for computation during this epoch:  3054508
Number of first layer input nodes during this epoch:  1297663
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1383967399597168  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02471613883972168
random selection method range initialization spend 0.0054168701171875
time for parepare:  0.018640518188476562
local_output_nid generation:  0.004534006118774414
local_in_edges_tensor generation:  0.008766412734985352
mini_batch_src_global generation:  0.003307819366455078
r_  generation:  0.04610753059387207
local_output_nid generation:  0.005918741226196289
local_in_edges_tensor generation:  0.0036306381225585938
mini_batch_src_global generation:  0.005230903625488281
r_  generation:  0.04616904258728027
local_output_nid generation:  0.006148099899291992
local_in_edges_tensor generation:  0.0033211708068847656
mini_batch_src_global generation:  0.003621339797973633
r_  generation:  0.04812169075012207
local_output_nid generation:  0.006126880645751953
local_in_edges_tensor generation:  0.0052263736724853516
mini_batch_src_global generation:  0.004014730453491211
r_  generation:  0.04800224304199219
local_output_nid generation:  0.006147861480712891
local_in_edges_tensor generation:  0.0034520626068115234
mini_batch_src_global generation:  0.004061698913574219
r_  generation:  0.04864907264709473
local_output_nid generation:  0.006127595901489258
local_in_edges_tensor generation:  0.0033729076385498047
mini_batch_src_global generation:  0.003993988037109375
r_  generation:  0.048938751220703125
local_output_nid generation:  0.006129264831542969
local_in_edges_tensor generation:  0.0034208297729492188
mini_batch_src_global generation:  0.004230976104736328
r_  generation:  0.04879307746887207
local_output_nid generation:  0.006193637847900391
local_in_edges_tensor generation:  0.003309488296508789
mini_batch_src_global generation:  0.004073143005371094
r_  generation:  0.04880094528198242
----------------------check_connections_block total spend ----------------------------- 0.6059703826904297
generate_one_block  0.06082320213317871
generate_one_block  0.06121468544006348
generate_one_block  0.06168794631958008
generate_one_block  0.06329703330993652
generate_one_block  0.062306880950927734
generate_one_block  0.06256222724914551
generate_one_block  0.06655573844909668
generate_one_block  0.06281614303588867
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04156041145324707
gen group dst list time:  0.015580177307128906
time for parepare:  0.02109384536743164
local_output_nid generation:  0.01504659652709961
local_in_edges_tensor generation:  0.03369283676147461
mini_batch_src_global generation:  0.03673505783081055
r_  generation:  0.35834574699401855
local_output_nid generation:  0.021306753158569336
local_in_edges_tensor generation:  0.031208515167236328
mini_batch_src_global generation:  0.0462651252746582
r_  generation:  0.3772871494293213
local_output_nid generation:  0.020978212356567383
local_in_edges_tensor generation:  0.025812864303588867
mini_batch_src_global generation:  0.04352712631225586
r_  generation:  0.3853163719177246
local_output_nid generation:  0.020903825759887695
local_in_edges_tensor generation:  0.022919416427612305
mini_batch_src_global generation:  0.0490870475769043
r_  generation:  0.4037339687347412
local_output_nid generation:  0.023522377014160156
local_in_edges_tensor generation:  0.024574756622314453
mini_batch_src_global generation:  0.045557498931884766
r_  generation:  0.38220739364624023
local_output_nid generation:  0.021555185317993164
local_in_edges_tensor generation:  0.02210211753845215
mini_batch_src_global generation:  0.045941829681396484
r_  generation:  0.3810436725616455
local_output_nid generation:  0.020990610122680664
local_in_edges_tensor generation:  0.02267289161682129
mini_batch_src_global generation:  0.04579663276672363
r_  generation:  0.3851776123046875
local_output_nid generation:  0.020191431045532227
local_in_edges_tensor generation:  0.020867109298706055
mini_batch_src_global generation:  0.045421600341796875
r_  generation:  0.37596774101257324
----------------------check_connections_block total spend ----------------------------- 4.433212757110596
generate_one_block  0.4885380268096924
generate_one_block  0.49846863746643066
generate_one_block  0.49712610244750977
generate_one_block  0.49634575843811035
generate_one_block  0.49169301986694336
generate_one_block  0.49291491508483887
generate_one_block  0.4979839324951172
generate_one_block  0.5239365100860596
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03542590141296387
gen group dst list time:  0.03979659080505371
time for parepare:  0.020699739456176758
local_output_nid generation:  0.031104564666748047
local_in_edges_tensor generation:  0.04642891883850098
mini_batch_src_global generation:  0.04653453826904297
r_  generation:  0.5038878917694092
local_output_nid generation:  0.03988504409790039
local_in_edges_tensor generation:  0.04075360298156738
mini_batch_src_global generation:  0.05745053291320801
r_  generation:  0.48914408683776855
local_output_nid generation:  0.03707313537597656
local_in_edges_tensor generation:  0.04025435447692871
mini_batch_src_global generation:  0.05436515808105469
r_  generation:  0.4969453811645508
local_output_nid generation:  0.037194252014160156
local_in_edges_tensor generation:  0.03904414176940918
mini_batch_src_global generation:  0.05551910400390625
r_  generation:  0.4999735355377197
local_output_nid generation:  0.037108421325683594
local_in_edges_tensor generation:  0.034963369369506836
mini_batch_src_global generation:  0.05367755889892578
r_  generation:  0.502507209777832
local_output_nid generation:  0.03746533393859863
local_in_edges_tensor generation:  0.03430747985839844
mini_batch_src_global generation:  0.05382084846496582
r_  generation:  0.5150988101959229
local_output_nid generation:  0.03775954246520996
local_in_edges_tensor generation:  0.03414583206176758
mini_batch_src_global generation:  0.05354881286621094
r_  generation:  0.5118417739868164
local_output_nid generation:  0.03919672966003418
local_in_edges_tensor generation:  0.0358583927154541
mini_batch_src_global generation:  0.05469799041748047
r_  generation:  0.5060524940490723
----------------------check_connections_block total spend ----------------------------- 5.970016002655029
generate_one_block  0.628587007522583
generate_one_block  0.6206939220428467
generate_one_block  0.6300187110900879
generate_one_block  0.6342229843139648
generate_one_block  0.6183981895446777
generate_one_block  0.6166269779205322
generate_one_block  0.6242566108703613
generate_one_block  0.6207005977630615
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1383967399597168  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

connection checking time:  10.403228759765625
block generation total time  8.980511903762817
average batch blocks generation time:  1.1225639879703522
block dataloader generation time/epoch 21.6014913469553
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10413789749145508  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9473881721496582  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10492610931396484  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9515032768249512  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10434532165527344  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9498124122619629  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10541439056396484  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9588642120361328  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10366058349609375  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9470534324645996  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10496807098388672  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9485478401184082  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10436773300170898  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9517765045166016  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10484790802001953  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9481077194213867  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07807114720344543 |0.018102169036865234 |0.0036024749279022217 |9.307265281677246e-05 |0.008537769317626953 |0.00151824951171875 |
----------------------------------------------------------pseudo_mini_loss sum 1.2596137523651123
Total (block generation + training)time/epoch 22.545928448438644
Training time/epoch 0.9460868835449219
Training time without block to device /epoch 0.80126953125
Training time without total dataloading part /epoch 0.09938478469848633
load block tensor time/epoch 0.6245691776275635
block to device time/epoch 0.14481735229492188
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 25 |
Number of nodes for computation during this epoch:  3053178
Number of first layer input nodes during this epoch:  1297716
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13797378540039062  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024579286575317383
random selection method range initialization spend 0.00554347038269043
time for parepare:  0.017029762268066406
local_output_nid generation:  0.004601716995239258
local_in_edges_tensor generation:  0.00643467903137207
mini_batch_src_global generation:  0.0033316612243652344
r_  generation:  0.04635763168334961
local_output_nid generation:  0.006014585494995117
local_in_edges_tensor generation:  0.0035104751586914062
mini_batch_src_global generation:  0.005072832107543945
r_  generation:  0.045737504959106445
local_output_nid generation:  0.0061457157135009766
local_in_edges_tensor generation:  0.0033125877380371094
mini_batch_src_global generation:  0.0037543773651123047
r_  generation:  0.04824233055114746
local_output_nid generation:  0.006241321563720703
local_in_edges_tensor generation:  0.0034220218658447266
mini_batch_src_global generation:  0.0038285255432128906
r_  generation:  0.047586679458618164
local_output_nid generation:  0.006204843521118164
local_in_edges_tensor generation:  0.0033321380615234375
mini_batch_src_global generation:  0.004113197326660156
r_  generation:  0.04858112335205078
local_output_nid generation:  0.0062007904052734375
local_in_edges_tensor generation:  0.0033941268920898438
mini_batch_src_global generation:  0.004098415374755859
r_  generation:  0.048758506774902344
local_output_nid generation:  0.006227970123291016
local_in_edges_tensor generation:  0.0035409927368164062
mini_batch_src_global generation:  0.0043790340423583984
r_  generation:  0.04878044128417969
local_output_nid generation:  0.006180763244628906
local_in_edges_tensor generation:  0.003293752670288086
mini_batch_src_global generation:  0.00413966178894043
r_  generation:  0.04918098449707031
----------------------check_connections_block total spend ----------------------------- 0.6027264595031738
generate_one_block  0.0639963150024414
generate_one_block  0.06157708168029785
generate_one_block  0.0629725456237793
generate_one_block  0.06197190284729004
generate_one_block  0.06219172477722168
generate_one_block  0.06273531913757324
generate_one_block  0.06551313400268555
generate_one_block  0.06279540061950684
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03795957565307617
gen group dst list time:  0.01545405387878418
time for parepare:  0.02072620391845703
local_output_nid generation:  0.015115976333618164
local_in_edges_tensor generation:  0.030987024307250977
mini_batch_src_global generation:  0.03706192970275879
r_  generation:  0.36017870903015137
local_output_nid generation:  0.020966053009033203
local_in_edges_tensor generation:  0.021971702575683594
mini_batch_src_global generation:  0.04455924034118652
r_  generation:  0.3699982166290283
local_output_nid generation:  0.021083354949951172
local_in_edges_tensor generation:  0.022489547729492188
mini_batch_src_global generation:  0.04443645477294922
r_  generation:  0.37964415550231934
local_output_nid generation:  0.02019667625427246
local_in_edges_tensor generation:  0.02020883560180664
mini_batch_src_global generation:  0.04547309875488281
r_  generation:  0.38793349266052246
local_output_nid generation:  0.02221202850341797
local_in_edges_tensor generation:  0.03157806396484375
mini_batch_src_global generation:  0.04798722267150879
r_  generation:  0.3998258113861084
local_output_nid generation:  0.021408796310424805
local_in_edges_tensor generation:  0.02999424934387207
mini_batch_src_global generation:  0.050283193588256836
r_  generation:  0.39316701889038086
local_output_nid generation:  0.021797657012939453
local_in_edges_tensor generation:  0.024745941162109375
mini_batch_src_global generation:  0.04767632484436035
r_  generation:  0.38542819023132324
local_output_nid generation:  0.0202486515045166
local_in_edges_tensor generation:  0.020305395126342773
mini_batch_src_global generation:  0.04665231704711914
r_  generation:  0.3850889205932617
----------------------check_connections_block total spend ----------------------------- 4.460800647735596
generate_one_block  0.4916698932647705
generate_one_block  0.4860343933105469
generate_one_block  0.49158811569213867
generate_one_block  0.5062687397003174
generate_one_block  0.5015044212341309
generate_one_block  0.499286413192749
generate_one_block  0.4998188018798828
generate_one_block  0.5458669662475586
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03660774230957031
gen group dst list time:  0.04286360740661621
time for parepare:  0.020833253860473633
local_output_nid generation:  0.03144335746765137
local_in_edges_tensor generation:  0.05238175392150879
mini_batch_src_global generation:  0.043745994567871094
r_  generation:  0.4861297607421875
local_output_nid generation:  0.036472320556640625
local_in_edges_tensor generation:  0.04105567932128906
mini_batch_src_global generation:  0.05527901649475098
r_  generation:  0.491375207901001
local_output_nid generation:  0.03639364242553711
local_in_edges_tensor generation:  0.036536455154418945
mini_batch_src_global generation:  0.056654930114746094
r_  generation:  0.49110865592956543
local_output_nid generation:  0.03627347946166992
local_in_edges_tensor generation:  0.036739349365234375
mini_batch_src_global generation:  0.053205251693725586
r_  generation:  0.4950220584869385
local_output_nid generation:  0.03625965118408203
local_in_edges_tensor generation:  0.03428244590759277
mini_batch_src_global generation:  0.05395984649658203
r_  generation:  0.5015690326690674
local_output_nid generation:  0.03621625900268555
local_in_edges_tensor generation:  0.04025745391845703
mini_batch_src_global generation:  0.05431795120239258
r_  generation:  0.5146403312683105
local_output_nid generation:  0.03659391403198242
local_in_edges_tensor generation:  0.03655052185058594
mini_batch_src_global generation:  0.05500602722167969
r_  generation:  0.5091419219970703
local_output_nid generation:  0.03641486167907715
local_in_edges_tensor generation:  0.03406572341918945
mini_batch_src_global generation:  0.05487060546875
r_  generation:  0.5054404735565186
----------------------check_connections_block total spend ----------------------------- 5.925292730331421
generate_one_block  0.6202952861785889
generate_one_block  0.6203746795654297
generate_one_block  0.6276826858520508
generate_one_block  0.6193621158599854
generate_one_block  0.6218950748443604
generate_one_block  0.6266210079193115
generate_one_block  0.6314067840576172
generate_one_block  0.6290063858032227
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13797378540039062  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

connection checking time:  10.386093378067017
block generation total time  9.018681764602661
average batch blocks generation time:  1.1273352205753326
block dataloader generation time/epoch 21.595339508617627
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10397958755493164  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9464840888977051  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10498619079589844  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9502058029174805  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10478973388671875  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9511394500732422  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10515499114990234  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9500455856323242  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10508394241333008  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9521541595458984  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10383939743041992  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9514918327331543  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10500335693359375  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9526214599609375  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1041874885559082  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9488744735717773  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08187603950500488 |0.02021545171737671 |0.0036316215991973877 |9.587407112121582e-05 |0.0035834014415740967 |0.0029273033142089844 |
----------------------------------------------------------pseudo_mini_loss sum 1.2465405464172363
Total (block generation + training)time/epoch 22.540264886968277
Training time/epoch 0.9525556564331055
Training time without block to device /epoch 0.7908320426940918
Training time without total dataloading part /epoch 0.061414480209350586
load block tensor time/epoch 0.6550083160400391
block to device time/epoch 0.16172361373901367
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 26 |
Number of nodes for computation during this epoch:  3053747
Number of first layer input nodes during this epoch:  1297792
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13741397857666016  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023732423782348633
random selection method range initialization spend 0.005362749099731445
time for parepare:  0.017750978469848633
local_output_nid generation:  0.004522085189819336
local_in_edges_tensor generation:  0.009326696395874023
mini_batch_src_global generation:  0.0034096240997314453
r_  generation:  0.04470944404602051
local_output_nid generation:  0.0059757232666015625
local_in_edges_tensor generation:  0.003312349319458008
mini_batch_src_global generation:  0.006578683853149414
r_  generation:  0.04763984680175781
local_output_nid generation:  0.006187915802001953
local_in_edges_tensor generation:  0.003465890884399414
mini_batch_src_global generation:  0.003998279571533203
r_  generation:  0.04704570770263672
local_output_nid generation:  0.0061724185943603516
local_in_edges_tensor generation:  0.0033545494079589844
mini_batch_src_global generation:  0.003889799118041992
r_  generation:  0.04812312126159668
local_output_nid generation:  0.006166934967041016
local_in_edges_tensor generation:  0.0033354759216308594
mini_batch_src_global generation:  0.004105806350708008
r_  generation:  0.04787921905517578
local_output_nid generation:  0.006192445755004883
local_in_edges_tensor generation:  0.003489971160888672
mini_batch_src_global generation:  0.004253387451171875
r_  generation:  0.04888510704040527
local_output_nid generation:  0.0061376094818115234
local_in_edges_tensor generation:  0.0033104419708251953
mini_batch_src_global generation:  0.004294395446777344
r_  generation:  0.0492854118347168
local_output_nid generation:  0.00616455078125
local_in_edges_tensor generation:  0.003403902053833008
mini_batch_src_global generation:  0.004145622253417969
r_  generation:  0.04792642593383789
----------------------check_connections_block total spend ----------------------------- 0.6077377796173096
generate_one_block  0.05986928939819336
generate_one_block  0.06196093559265137
generate_one_block  0.06121373176574707
generate_one_block  0.0626523494720459
generate_one_block  0.06156611442565918
generate_one_block  0.062207937240600586
generate_one_block  0.06584405899047852
generate_one_block  0.0616302490234375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03901410102844238
gen group dst list time:  0.015030384063720703
time for parepare:  0.019248008728027344
local_output_nid generation:  0.014992475509643555
local_in_edges_tensor generation:  0.03202462196350098
mini_batch_src_global generation:  0.03681015968322754
r_  generation:  0.3573117256164551
local_output_nid generation:  0.02098703384399414
local_in_edges_tensor generation:  0.026842832565307617
mini_batch_src_global generation:  0.04668259620666504
r_  generation:  0.37673187255859375
local_output_nid generation:  0.020793437957763672
local_in_edges_tensor generation:  0.02593207359313965
mini_batch_src_global generation:  0.0461125373840332
r_  generation:  0.3773970603942871
local_output_nid generation:  0.02071094512939453
local_in_edges_tensor generation:  0.02245187759399414
mini_batch_src_global generation:  0.04706406593322754
r_  generation:  0.3815650939941406
local_output_nid generation:  0.020900249481201172
local_in_edges_tensor generation:  0.020893573760986328
mini_batch_src_global generation:  0.04575490951538086
r_  generation:  0.3815128803253174
local_output_nid generation:  0.020964860916137695
local_in_edges_tensor generation:  0.020543336868286133
mini_batch_src_global generation:  0.04617929458618164
r_  generation:  0.38254690170288086
local_output_nid generation:  0.02035832405090332
local_in_edges_tensor generation:  0.02059197425842285
mini_batch_src_global generation:  0.04663276672363281
r_  generation:  0.3866548538208008
local_output_nid generation:  0.019643306732177734
local_in_edges_tensor generation:  0.020420074462890625
mini_batch_src_global generation:  0.04972362518310547
r_  generation:  0.3765420913696289
----------------------check_connections_block total spend ----------------------------- 4.385537147521973
generate_one_block  0.49251556396484375
generate_one_block  0.4891011714935303
generate_one_block  0.4920179843902588
generate_one_block  0.5027618408203125
generate_one_block  0.5010550022125244
generate_one_block  0.5186750888824463
generate_one_block  0.5079960823059082
generate_one_block  0.5192220211029053
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03469085693359375
gen group dst list time:  0.03953075408935547
time for parepare:  0.020177364349365234
local_output_nid generation:  0.030914306640625
local_in_edges_tensor generation:  0.04886126518249512
mini_batch_src_global generation:  0.04374551773071289
r_  generation:  0.48301124572753906
local_output_nid generation:  0.03682684898376465
local_in_edges_tensor generation:  0.04167747497558594
mini_batch_src_global generation:  0.05556488037109375
r_  generation:  0.4875657558441162
local_output_nid generation:  0.036322832107543945
local_in_edges_tensor generation:  0.03592395782470703
mini_batch_src_global generation:  0.05662846565246582
r_  generation:  0.4971127510070801
local_output_nid generation:  0.03629016876220703
local_in_edges_tensor generation:  0.03284859657287598
mini_batch_src_global generation:  0.06449580192565918
r_  generation:  0.5012552738189697
local_output_nid generation:  0.03817129135131836
local_in_edges_tensor generation:  0.03746294975280762
mini_batch_src_global generation:  0.0534367561340332
r_  generation:  0.5031483173370361
local_output_nid generation:  0.036638736724853516
local_in_edges_tensor generation:  0.04699110984802246
mini_batch_src_global generation:  0.05453062057495117
r_  generation:  0.5055990219116211
local_output_nid generation:  0.03710675239562988
local_in_edges_tensor generation:  0.03760576248168945
mini_batch_src_global generation:  0.054602622985839844
r_  generation:  0.5179932117462158
local_output_nid generation:  0.03902292251586914
local_in_edges_tensor generation:  0.03766059875488281
mini_batch_src_global generation:  0.05558156967163086
r_  generation:  0.501345157623291
----------------------check_connections_block total spend ----------------------------- 5.972835063934326
generate_one_block  0.6240735054016113
generate_one_block  0.6218297481536865
generate_one_block  0.6207273006439209
generate_one_block  0.627587080001831
generate_one_block  0.6380884647369385
generate_one_block  0.6249802112579346
generate_one_block  0.6217505931854248
generate_one_block  0.6187574863433838
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13741397857666016  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

connection checking time:  10.358372211456299
block generation total time  9.021139144897461
average batch blocks generation time:  1.1276423931121826
block dataloader generation time/epoch 21.5875352885988
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10492134094238281  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9516749382019043  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10444927215576172  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9502716064453125  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1051492691040039  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9518518447875977  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10445785522460938  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9517335891723633  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10370826721191406  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9510669708251953  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10522747039794922  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9512190818786621  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10434675216674805  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9504756927490234  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10489559173583984  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9502763748168945  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0827363133430481 |0.018541604280471802 |0.0035053789615631104 |9.238719940185547e-05 |0.003551274538040161 |0.0019419193267822266 |
----------------------------------------------------------pseudo_mini_loss sum 1.2382272481918335
Total (block generation + training)time/epoch 22.532514055569965
Training time/epoch 0.9456000328063965
Training time without block to device /epoch 0.7972671985626221
Training time without total dataloading part /epoch 0.05913424491882324
load block tensor time/epoch 0.6618905067443848
block to device time/epoch 0.14833283424377441
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 27 |
Number of nodes for computation during this epoch:  3055094
Number of first layer input nodes during this epoch:  1297828
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13878250122070312  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021849393844604492
random selection method range initialization spend 0.005576610565185547
time for parepare:  0.01920628547668457
local_output_nid generation:  0.004456281661987305
local_in_edges_tensor generation:  0.009297847747802734
mini_batch_src_global generation:  0.004254579544067383
r_  generation:  0.04496908187866211
local_output_nid generation:  0.005976438522338867
local_in_edges_tensor generation:  0.0035212039947509766
mini_batch_src_global generation:  0.005018711090087891
r_  generation:  0.04683232307434082
local_output_nid generation:  0.006114959716796875
local_in_edges_tensor generation:  0.003444671630859375
mini_batch_src_global generation:  0.003864765167236328
r_  generation:  0.0462188720703125
local_output_nid generation:  0.006146430969238281
local_in_edges_tensor generation:  0.0033369064331054688
mini_batch_src_global generation:  0.0037984848022460938
r_  generation:  0.04748654365539551
local_output_nid generation:  0.006138324737548828
local_in_edges_tensor generation:  0.0033178329467773438
mini_batch_src_global generation:  0.0041162967681884766
r_  generation:  0.04770660400390625
local_output_nid generation:  0.006121158599853516
local_in_edges_tensor generation:  0.0033452510833740234
mini_batch_src_global generation:  0.004158973693847656
r_  generation:  0.049674272537231445
local_output_nid generation:  0.006142139434814453
local_in_edges_tensor generation:  0.003553152084350586
mini_batch_src_global generation:  0.004314422607421875
r_  generation:  0.049265384674072266
local_output_nid generation:  0.006160736083984375
local_in_edges_tensor generation:  0.0034224987030029297
mini_batch_src_global generation:  0.004033565521240234
r_  generation:  0.0476527214050293
----------------------check_connections_block total spend ----------------------------- 0.6030664443969727
generate_one_block  0.060337066650390625
generate_one_block  0.06236004829406738
generate_one_block  0.06065630912780762
generate_one_block  0.06168198585510254
generate_one_block  0.06214451789855957
generate_one_block  0.06259441375732422
generate_one_block  0.06614947319030762
generate_one_block  0.061040639877319336
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.036452531814575195
gen group dst list time:  0.015291213989257812
time for parepare:  0.019146203994750977
local_output_nid generation:  0.015000581741333008
local_in_edges_tensor generation:  0.03096175193786621
mini_batch_src_global generation:  0.03729844093322754
r_  generation:  0.3617825508117676
local_output_nid generation:  0.02127552032470703
local_in_edges_tensor generation:  0.02777838706970215
mini_batch_src_global generation:  0.047716617584228516
r_  generation:  0.37764549255371094
local_output_nid generation:  0.020675182342529297
local_in_edges_tensor generation:  0.0214235782623291
mini_batch_src_global generation:  0.044260501861572266
r_  generation:  0.3777744770050049
local_output_nid generation:  0.02250194549560547
local_in_edges_tensor generation:  0.022437095642089844
mini_batch_src_global generation:  0.047506093978881836
r_  generation:  0.3816852569580078
local_output_nid generation:  0.021407604217529297
local_in_edges_tensor generation:  0.020443439483642578
mini_batch_src_global generation:  0.04765820503234863
r_  generation:  0.38899850845336914
local_output_nid generation:  0.021376371383666992
local_in_edges_tensor generation:  0.022642135620117188
mini_batch_src_global generation:  0.046849966049194336
r_  generation:  0.3889327049255371
local_output_nid generation:  0.02413177490234375
local_in_edges_tensor generation:  0.022152423858642578
mini_batch_src_global generation:  0.04663491249084473
r_  generation:  0.39357686042785645
local_output_nid generation:  0.020755290985107422
local_in_edges_tensor generation:  0.025378704071044922
mini_batch_src_global generation:  0.04767727851867676
r_  generation:  0.38124847412109375
----------------------check_connections_block total spend ----------------------------- 4.436658620834351
generate_one_block  0.5217492580413818
generate_one_block  0.5094084739685059
generate_one_block  0.4862174987792969
generate_one_block  0.4994034767150879
generate_one_block  0.5164368152618408
generate_one_block  0.4956378936767578
generate_one_block  0.49619531631469727
generate_one_block  0.5176365375518799
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.031430721282958984
gen group dst list time:  0.039320945739746094
time for parepare:  0.022454261779785156
local_output_nid generation:  0.031688690185546875
local_in_edges_tensor generation:  0.05229306221008301
mini_batch_src_global generation:  0.04557156562805176
r_  generation:  0.4865262508392334
local_output_nid generation:  0.03641796112060547
local_in_edges_tensor generation:  0.04183554649353027
mini_batch_src_global generation:  0.05589032173156738
r_  generation:  0.48798465728759766
local_output_nid generation:  0.03674602508544922
local_in_edges_tensor generation:  0.03817343711853027
mini_batch_src_global generation:  0.05418682098388672
r_  generation:  0.4938948154449463
local_output_nid generation:  0.03675484657287598
local_in_edges_tensor generation:  0.04473304748535156
mini_batch_src_global generation:  0.056781768798828125
r_  generation:  0.514082670211792
local_output_nid generation:  0.04027295112609863
local_in_edges_tensor generation:  0.03551077842712402
mini_batch_src_global generation:  0.05767083168029785
r_  generation:  0.5005009174346924
local_output_nid generation:  0.03747057914733887
local_in_edges_tensor generation:  0.035520315170288086
mini_batch_src_global generation:  0.05565237998962402
r_  generation:  0.5067291259765625
local_output_nid generation:  0.03872323036193848
local_in_edges_tensor generation:  0.03451728820800781
mini_batch_src_global generation:  0.05485367774963379
r_  generation:  0.5075149536132812
local_output_nid generation:  0.03783893585205078
local_in_edges_tensor generation:  0.033857107162475586
mini_batch_src_global generation:  0.055542707443237305
r_  generation:  0.5074145793914795
----------------------check_connections_block total spend ----------------------------- 5.97563910484314
generate_one_block  0.6381838321685791
generate_one_block  0.6190462112426758
generate_one_block  0.6231482028961182
generate_one_block  0.6255931854248047
generate_one_block  0.6234927177429199
generate_one_block  0.6267240047454834
generate_one_block  0.6245949268341064
generate_one_block  0.6184482574462891
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13878250122070312  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

connection checking time:  10.41229772567749
block generation total time  9.041916608810425
average batch blocks generation time:  1.130239576101303
block dataloader generation time/epoch 21.583787052254927
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.105010986328125  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9497084617614746  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10549068450927734  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9524059295654297  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10346126556396484  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9416365623474121  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10525798797607422  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9534769058227539  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10433721542358398  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9502143859863281  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10516929626464844  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9525637626647949  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10416221618652344  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9527792930603027  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1048269271850586  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9458160400390625  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08074936270713806 |0.01641184091567993 |0.0035142898559570312 |9.247660636901855e-05 |0.003568202257156372 |0.0029363632202148438 |
----------------------------------------------------------pseudo_mini_loss sum 1.2228995561599731
Total (block generation + training)time/epoch 22.527089896954987
Training time/epoch 0.912956714630127
Training time without block to device /epoch 0.7816619873046875
Training time without total dataloading part /epoch 0.06033611297607422
load block tensor time/epoch 0.6459949016571045
block to device time/epoch 0.13129472732543945
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 28 |
Number of nodes for computation during this epoch:  3053550
Number of first layer input nodes during this epoch:  1297482
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13877201080322266  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025104999542236328
random selection method range initialization spend 0.005452871322631836
time for parepare:  0.018059253692626953
local_output_nid generation:  0.004469156265258789
local_in_edges_tensor generation:  0.0064427852630615234
mini_batch_src_global generation:  0.0033888816833496094
r_  generation:  0.04398536682128906
local_output_nid generation:  0.005951881408691406
local_in_edges_tensor generation:  0.0032546520233154297
mini_batch_src_global generation:  0.00512242317199707
r_  generation:  0.04535555839538574
local_output_nid generation:  0.0061109066009521484
local_in_edges_tensor generation:  0.0033545494079589844
mini_batch_src_global generation:  0.00402069091796875
r_  generation:  0.04607129096984863
local_output_nid generation:  0.006103992462158203
local_in_edges_tensor generation:  0.0032601356506347656
mini_batch_src_global generation:  0.003927707672119141
r_  generation:  0.04775214195251465
local_output_nid generation:  0.006079912185668945
local_in_edges_tensor generation:  0.0033714771270751953
mini_batch_src_global generation:  0.004087924957275391
r_  generation:  0.050330400466918945
local_output_nid generation:  0.006043434143066406
local_in_edges_tensor generation:  0.0033636093139648438
mini_batch_src_global generation:  0.004139423370361328
r_  generation:  0.046758413314819336
local_output_nid generation:  0.0060999393463134766
local_in_edges_tensor generation:  0.003287076950073242
mini_batch_src_global generation:  0.004278421401977539
r_  generation:  0.04889631271362305
local_output_nid generation:  0.00609898567199707
local_in_edges_tensor generation:  0.0033059120178222656
mini_batch_src_global generation:  0.004196882247924805
r_  generation:  0.04825735092163086
----------------------check_connections_block total spend ----------------------------- 0.5947203636169434
generate_one_block  0.05847930908203125
generate_one_block  0.06083035469055176
generate_one_block  0.060387611389160156
generate_one_block  0.06230425834655762
generate_one_block  0.06154751777648926
generate_one_block  0.060402631759643555
generate_one_block  0.06587028503417969
generate_one_block  0.06258630752563477
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0377650260925293
gen group dst list time:  0.0149078369140625
time for parepare:  0.020943880081176758
local_output_nid generation:  0.015241622924804688
local_in_edges_tensor generation:  0.031514883041381836
mini_batch_src_global generation:  0.03714346885681152
r_  generation:  0.3525373935699463
local_output_nid generation:  0.021079540252685547
local_in_edges_tensor generation:  0.02655196189880371
mini_batch_src_global generation:  0.044899940490722656
r_  generation:  0.37052178382873535
local_output_nid generation:  0.021413803100585938
local_in_edges_tensor generation:  0.02207040786743164
mini_batch_src_global generation:  0.044359445571899414
r_  generation:  0.3803718090057373
local_output_nid generation:  0.020662307739257812
local_in_edges_tensor generation:  0.022196054458618164
mini_batch_src_global generation:  0.04857206344604492
r_  generation:  0.3780515193939209
local_output_nid generation:  0.021376371383666992
local_in_edges_tensor generation:  0.020709991455078125
mini_batch_src_global generation:  0.04569268226623535
r_  generation:  0.3935978412628174
local_output_nid generation:  0.0232236385345459
local_in_edges_tensor generation:  0.020258665084838867
mini_batch_src_global generation:  0.04586482048034668
r_  generation:  0.37728047370910645
local_output_nid generation:  0.02139878273010254
local_in_edges_tensor generation:  0.02063441276550293
mini_batch_src_global generation:  0.04857945442199707
r_  generation:  0.3842332363128662
local_output_nid generation:  0.020050048828125
local_in_edges_tensor generation:  0.021807432174682617
mini_batch_src_global generation:  0.04661417007446289
r_  generation:  0.37923550605773926
----------------------check_connections_block total spend ----------------------------- 4.385549068450928
generate_one_block  0.47907376289367676
generate_one_block  0.4809103012084961
generate_one_block  0.48505520820617676
generate_one_block  0.4907703399658203
generate_one_block  0.4879307746887207
generate_one_block  0.4781463146209717
generate_one_block  0.49167871475219727
generate_one_block  0.5172357559204102
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.031008481979370117
gen group dst list time:  0.03772282600402832
time for parepare:  0.018583059310913086
local_output_nid generation:  0.02979898452758789
local_in_edges_tensor generation:  0.046129703521728516
mini_batch_src_global generation:  0.04495739936828613
r_  generation:  0.48134779930114746
local_output_nid generation:  0.03624725341796875
local_in_edges_tensor generation:  0.0389103889465332
mini_batch_src_global generation:  0.05524897575378418
r_  generation:  0.48089075088500977
local_output_nid generation:  0.036098480224609375
local_in_edges_tensor generation:  0.03699898719787598
mini_batch_src_global generation:  0.05387377738952637
r_  generation:  0.4899864196777344
local_output_nid generation:  0.03651785850524902
local_in_edges_tensor generation:  0.03468823432922363
mini_batch_src_global generation:  0.05242300033569336
r_  generation:  0.4945247173309326
local_output_nid generation:  0.03607940673828125
local_in_edges_tensor generation:  0.03678297996520996
mini_batch_src_global generation:  0.05572509765625
r_  generation:  0.5033771991729736
local_output_nid generation:  0.036057233810424805
local_in_edges_tensor generation:  0.032773733139038086
mini_batch_src_global generation:  0.05428433418273926
r_  generation:  0.4995284080505371
local_output_nid generation:  0.0361936092376709
local_in_edges_tensor generation:  0.034529685974121094
mini_batch_src_global generation:  0.053983449935913086
r_  generation:  0.5026531219482422
local_output_nid generation:  0.03596043586730957
local_in_edges_tensor generation:  0.034792184829711914
mini_batch_src_global generation:  0.05540633201599121
r_  generation:  0.5005788803100586
----------------------check_connections_block total spend ----------------------------- 5.867976427078247
generate_one_block  0.6133644580841064
generate_one_block  0.6111676692962646
generate_one_block  0.613283634185791
generate_one_block  0.6099855899810791
generate_one_block  0.6183297634124756
generate_one_block  0.6133639812469482
generate_one_block  0.6113700866699219
generate_one_block  0.6114459037780762
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13877201080322266  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

connection checking time:  10.253525495529175
block generation total time  8.813112258911133
average batch blocks generation time:  1.1016390323638916
block dataloader generation time/epoch 21.559677171707154
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10445642471313477  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9486122131347656  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10526466369628906  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9510469436645508  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10426712036132812  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9489274024963379  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10565662384033203  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9513068199157715  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10430383682250977  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9512310028076172  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10507965087890625  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9515643119812012  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10491800308227539  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9537897109985352  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10491275787353516  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9514222145080566  GigaBytes
Max Memory Allocated: 1.1040143966674805  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07762563228607178 |0.012474626302719116 |0.004163116216659546 |0.00015360116958618164 |0.0029713213443756104 |0.0027854442596435547 |
----------------------------------------------------------pseudo_mini_loss sum 1.215441107749939
Total (block generation + training)time/epoch 22.49843372106552
Training time/epoch 0.8521966934204102
Training time without block to device /epoch 0.7523996829986572
Training time without total dataloading part /epoch 0.06108975410461426
load block tensor time/epoch 0.6210050582885742
block to device time/epoch 0.09979701042175293
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 29 |
Number of nodes for computation during this epoch:  3054550
Number of first layer input nodes during this epoch:  1297534
