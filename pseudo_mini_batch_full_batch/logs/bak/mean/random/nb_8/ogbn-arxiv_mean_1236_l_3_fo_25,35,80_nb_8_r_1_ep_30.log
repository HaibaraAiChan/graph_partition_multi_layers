Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1647754662.041795
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027332544326782227
random selection method range initialization spend 0.006284475326538086
time for parepare:  0.018383502960205078
local_output_nid generation:  0.0042188167572021484
local_in_edges_tensor generation:  0.006788730621337891
mini_batch_src_global generation:  0.0037784576416015625
r_  generation:  0.04143548011779785
local_output_nid generation:  0.005606889724731445
local_in_edges_tensor generation:  0.0032439231872558594
mini_batch_src_global generation:  0.004914760589599609
r_  generation:  0.04389333724975586
local_output_nid generation:  0.005993843078613281
local_in_edges_tensor generation:  0.003361940383911133
mini_batch_src_global generation:  0.003250598907470703
r_  generation:  0.043450117111206055
local_output_nid generation:  0.0060214996337890625
local_in_edges_tensor generation:  0.003329038619995117
mini_batch_src_global generation:  0.0032198429107666016
r_  generation:  0.044138431549072266
local_output_nid generation:  0.006132364273071289
local_in_edges_tensor generation:  0.0033152103424072266
mini_batch_src_global generation:  0.0038056373596191406
r_  generation:  0.04640626907348633
local_output_nid generation:  0.006024360656738281
local_in_edges_tensor generation:  0.0033185482025146484
mini_batch_src_global generation:  0.0037970542907714844
r_  generation:  0.04577350616455078
local_output_nid generation:  0.006046295166015625
local_in_edges_tensor generation:  0.00325775146484375
mini_batch_src_global generation:  0.003854990005493164
r_  generation:  0.04672956466674805
local_output_nid generation:  0.006026029586791992
local_in_edges_tensor generation:  0.003352642059326172
mini_batch_src_global generation:  0.00392460823059082
r_  generation:  0.04737138748168945
----------------------check_connections_block total spend ----------------------------- 0.5686631202697754
generate_one_block  0.0621337890625
generate_one_block  0.06334304809570312
generate_one_block  0.06165933609008789
generate_one_block  0.06051993370056152
generate_one_block  0.0652613639831543
generate_one_block  0.06186676025390625
generate_one_block  0.06155896186828613
generate_one_block  0.06100153923034668
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.039046525955200195
gen group dst list time:  0.016509294509887695
time for parepare:  0.02028179168701172
local_output_nid generation:  0.014865636825561523
local_in_edges_tensor generation:  0.032848358154296875
mini_batch_src_global generation:  0.030433177947998047
r_  generation:  0.3259437084197998
local_output_nid generation:  0.0234830379486084
local_in_edges_tensor generation:  0.03454995155334473
mini_batch_src_global generation:  0.0391545295715332
r_  generation:  0.34172725677490234
local_output_nid generation:  0.02361440658569336
local_in_edges_tensor generation:  0.030504465103149414
mini_batch_src_global generation:  0.03800654411315918
r_  generation:  0.344341516494751
local_output_nid generation:  0.023440122604370117
local_in_edges_tensor generation:  0.024901390075683594
mini_batch_src_global generation:  0.04156351089477539
r_  generation:  0.35743141174316406
local_output_nid generation:  0.023648738861083984
local_in_edges_tensor generation:  0.045719146728515625
mini_batch_src_global generation:  0.04927659034729004
r_  generation:  0.33825039863586426
local_output_nid generation:  0.020277976989746094
local_in_edges_tensor generation:  0.02663707733154297
mini_batch_src_global generation:  0.040618896484375
r_  generation:  0.3355684280395508
local_output_nid generation:  0.02016615867614746
local_in_edges_tensor generation:  0.026158571243286133
mini_batch_src_global generation:  0.04301023483276367
r_  generation:  0.33813977241516113
local_output_nid generation:  0.020029783248901367
local_in_edges_tensor generation:  0.02213764190673828
mini_batch_src_global generation:  0.041147470474243164
r_  generation:  0.33637070655822754
----------------------check_connections_block total spend ----------------------------- 4.070041179656982
generate_one_block  0.4451119899749756
generate_one_block  0.4527246952056885
generate_one_block  0.4352090358734131
generate_one_block  0.42873239517211914
generate_one_block  0.4402296543121338
generate_one_block  0.4832761287689209
generate_one_block  0.4605672359466553
generate_one_block  0.43984556198120117
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.06704092025756836
gen group dst list time:  0.04295039176940918
time for parepare:  0.01905369758605957
local_output_nid generation:  0.028589963912963867
local_in_edges_tensor generation:  0.05482125282287598
mini_batch_src_global generation:  0.04721641540527344
r_  generation:  0.488875150680542
local_output_nid generation:  0.03482532501220703
local_in_edges_tensor generation:  0.04979872703552246
mini_batch_src_global generation:  0.05354952812194824
r_  generation:  0.49427056312561035
local_output_nid generation:  0.03566694259643555
local_in_edges_tensor generation:  0.04688072204589844
mini_batch_src_global generation:  0.05093979835510254
r_  generation:  0.5074844360351562
local_output_nid generation:  0.03584480285644531
local_in_edges_tensor generation:  0.042398929595947266
mini_batch_src_global generation:  0.06418967247009277
r_  generation:  0.48696088790893555
local_output_nid generation:  0.03778958320617676
local_in_edges_tensor generation:  0.04027390480041504
mini_batch_src_global generation:  0.05304598808288574
r_  generation:  0.49434733390808105
local_output_nid generation:  0.035768985748291016
local_in_edges_tensor generation:  0.04160594940185547
mini_batch_src_global generation:  0.05713820457458496
r_  generation:  0.4865727424621582
local_output_nid generation:  0.035538434982299805
local_in_edges_tensor generation:  0.03701376914978027
mini_batch_src_global generation:  0.053240299224853516
r_  generation:  0.49672508239746094
local_output_nid generation:  0.035398006439208984
local_in_edges_tensor generation:  0.036371707916259766
mini_batch_src_global generation:  0.054685354232788086
r_  generation:  0.49009180068969727
----------------------check_connections_block total spend ----------------------------- 5.90504789352417
generate_one_block  0.6224606037139893
generate_one_block  0.6525094509124756
generate_one_block  0.6155447959899902
generate_one_block  0.608626127243042
generate_one_block  0.6015360355377197
generate_one_block  0.6272742748260498
generate_one_block  0.6441283226013184
generate_one_block  0.6071381568908691
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  9.975089073181152
block generation total time  8.564914464950562
average batch blocks generation time:  1.0706143081188202
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.09805679321289062  GigaBytes
Max Memory Allocated: 0.09805679321289062  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4510498046875 GB
    Memory Allocated: 0.9355387687683105  GigaBytes
Max Memory Allocated: 1.0016942024230957  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8123779296875 GB
    Memory Allocated: 0.10081148147583008  GigaBytes
Max Memory Allocated: 1.0761866569519043  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8123779296875 GB
    Memory Allocated: 0.9394402503967285  GigaBytes
Max Memory Allocated: 1.0761866569519043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9510498046875 GB
    Memory Allocated: 0.10005807876586914  GigaBytes
Max Memory Allocated: 1.0807175636291504  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9510498046875 GB
    Memory Allocated: 0.9339127540588379  GigaBytes
Max Memory Allocated: 1.0807175636291504  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9510498046875 GB
    Memory Allocated: 0.10055398941040039  GigaBytes
Max Memory Allocated: 1.0807175636291504  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9510498046875 GB
    Memory Allocated: 0.9310483932495117  GigaBytes
Max Memory Allocated: 1.0807175636291504  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9510498046875 GB
    Memory Allocated: 0.10107278823852539  GigaBytes
Max Memory Allocated: 1.0807175636291504  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9510498046875 GB
    Memory Allocated: 0.9342923164367676  GigaBytes
Max Memory Allocated: 1.0807175636291504  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9510498046875 GB
    Memory Allocated: 0.10118627548217773  GigaBytes
Max Memory Allocated: 1.0807175636291504  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.9365057945251465  GigaBytes
Max Memory Allocated: 1.0807175636291504  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6463623046875 GB
    Memory Allocated: 0.10070276260375977  GigaBytes
Max Memory Allocated: 1.0807175636291504  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6463623046875 GB
    Memory Allocated: 0.936119556427002  GigaBytes
Max Memory Allocated: 1.0807175636291504  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6463623046875 GB
    Memory Allocated: 0.10064268112182617  GigaBytes
Max Memory Allocated: 1.0807175636291504  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6463623046875 GB
    Memory Allocated: 0.9349842071533203  GigaBytes
Max Memory Allocated: 1.0807175636291504  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06747874617576599 |0.0549599826335907 |0.10112062096595764 |0.00010433793067932129 |0.01526227593421936 |0.0019545555114746094 |
----------------------------------------------------------pseudo_mini_loss sum 6.2325215339660645
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3019756
Number of first layer input nodes during this epoch:  1287580
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6463623046875 GB
    Memory Allocated: 0.13329792022705078  GigaBytes
Max Memory Allocated: 1.0807175636291504  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021656274795532227
random selection method range initialization spend 0.004908084869384766
time for parepare:  0.017647981643676758
local_output_nid generation:  0.004470109939575195
local_in_edges_tensor generation:  0.010380744934082031
mini_batch_src_global generation:  0.0038220882415771484
r_  generation:  0.04247093200683594
local_output_nid generation:  0.005945920944213867
local_in_edges_tensor generation:  0.0034160614013671875
mini_batch_src_global generation:  0.004840850830078125
r_  generation:  0.04711723327636719
local_output_nid generation:  0.006079196929931641
local_in_edges_tensor generation:  0.003475666046142578
mini_batch_src_global generation:  0.0032842159271240234
r_  generation:  0.045122623443603516
local_output_nid generation:  0.00616908073425293
local_in_edges_tensor generation:  0.0032973289489746094
mini_batch_src_global generation:  0.003564119338989258
r_  generation:  0.0463564395904541
local_output_nid generation:  0.006130218505859375
local_in_edges_tensor generation:  0.0033986568450927734
mini_batch_src_global generation:  0.0036416053771972656
r_  generation:  0.04950356483459473
local_output_nid generation:  0.0061681270599365234
local_in_edges_tensor generation:  0.003381013870239258
mini_batch_src_global generation:  0.003938198089599609
r_  generation:  0.04624629020690918
local_output_nid generation:  0.006074666976928711
local_in_edges_tensor generation:  0.003269672393798828
mini_batch_src_global generation:  0.00404047966003418
r_  generation:  0.05032467842102051
local_output_nid generation:  0.0068247318267822266
local_in_edges_tensor generation:  0.007909059524536133
mini_batch_src_global generation:  0.0056781768798828125
r_  generation:  0.04732108116149902
----------------------check_connections_block total spend ----------------------------- 0.6098408699035645
generate_one_block  0.06396126747131348
generate_one_block  0.06297183036804199
generate_one_block  0.0643165111541748
generate_one_block  0.06151986122131348
generate_one_block  0.06350016593933105
generate_one_block  0.06193208694458008
generate_one_block  0.06754636764526367
generate_one_block  0.06173086166381836
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0511782169342041
gen group dst list time:  0.01675701141357422
time for parepare:  0.018937349319458008
local_output_nid generation:  0.014671564102172852
local_in_edges_tensor generation:  0.047521352767944336
mini_batch_src_global generation:  0.03357195854187012
r_  generation:  0.3196892738342285
local_output_nid generation:  0.02038860321044922
local_in_edges_tensor generation:  0.032706499099731445
mini_batch_src_global generation:  0.04264521598815918
r_  generation:  0.3347764015197754
local_output_nid generation:  0.019646406173706055
local_in_edges_tensor generation:  0.02738809585571289
mini_batch_src_global generation:  0.04024791717529297
r_  generation:  0.33480072021484375
local_output_nid generation:  0.021105289459228516
local_in_edges_tensor generation:  0.025720834732055664
mini_batch_src_global generation:  0.03961372375488281
r_  generation:  0.3390965461730957
local_output_nid generation:  0.01954483985900879
local_in_edges_tensor generation:  0.023257732391357422
mini_batch_src_global generation:  0.04006528854370117
r_  generation:  0.344221830368042
local_output_nid generation:  0.0196835994720459
local_in_edges_tensor generation:  0.027337312698364258
mini_batch_src_global generation:  0.042784690856933594
r_  generation:  0.3452575206756592
local_output_nid generation:  0.019536495208740234
local_in_edges_tensor generation:  0.02683258056640625
mini_batch_src_global generation:  0.04323148727416992
r_  generation:  0.3480644226074219
local_output_nid generation:  0.019469022750854492
local_in_edges_tensor generation:  0.0203855037689209
mini_batch_src_global generation:  0.04240727424621582
r_  generation:  0.3422737121582031
----------------------check_connections_block total spend ----------------------------- 4.0225231647491455
generate_one_block  0.4558722972869873
generate_one_block  0.44435954093933105
generate_one_block  0.4340648651123047
generate_one_block  0.4317500591278076
generate_one_block  0.43314456939697266
generate_one_block  0.44221997261047363
generate_one_block  0.4626755714416504
generate_one_block  0.47136974334716797
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.07053828239440918
gen group dst list time:  0.04184699058532715
time for parepare:  0.022478342056274414
local_output_nid generation:  0.028649568557739258
local_in_edges_tensor generation:  0.06044936180114746
mini_batch_src_global generation:  0.04769444465637207
r_  generation:  0.47281908988952637
local_output_nid generation:  0.036937713623046875
local_in_edges_tensor generation:  0.051247596740722656
mini_batch_src_global generation:  0.05401873588562012
r_  generation:  0.4822731018066406
local_output_nid generation:  0.03589606285095215
local_in_edges_tensor generation:  0.04294419288635254
mini_batch_src_global generation:  0.05079913139343262
r_  generation:  0.4925353527069092
local_output_nid generation:  0.03612947463989258
local_in_edges_tensor generation:  0.03861045837402344
mini_batch_src_global generation:  0.05346393585205078
r_  generation:  0.49442315101623535
local_output_nid generation:  0.03558969497680664
local_in_edges_tensor generation:  0.03381681442260742
mini_batch_src_global generation:  0.05427718162536621
r_  generation:  0.5151982307434082
local_output_nid generation:  0.03610634803771973
local_in_edges_tensor generation:  0.042389869689941406
mini_batch_src_global generation:  0.05430960655212402
r_  generation:  0.5030553340911865
local_output_nid generation:  0.036057233810424805
local_in_edges_tensor generation:  0.05436205863952637
mini_batch_src_global generation:  0.056821346282958984
r_  generation:  0.527540922164917
local_output_nid generation:  0.03948640823364258
local_in_edges_tensor generation:  0.04373788833618164
mini_batch_src_global generation:  0.05679178237915039
r_  generation:  0.4928457736968994
----------------------check_connections_block total spend ----------------------------- 5.973860025405884
generate_one_block  0.6225600242614746
generate_one_block  0.6164147853851318
generate_one_block  0.6213321685791016
generate_one_block  0.6256575584411621
generate_one_block  0.6257517337799072
generate_one_block  0.6229755878448486
generate_one_block  0.6333272457122803
generate_one_block  0.6178922653198242
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6463623046875 GB
    Memory Allocated: 0.13329792022705078  GigaBytes
Max Memory Allocated: 1.0807175636291504  GigaBytes

connection checking time:  9.99638319015503
block generation total time  8.561367988586426
average batch blocks generation time:  1.0701709985733032
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6463623046875 GB
    Memory Allocated: 0.10265922546386719  GigaBytes
Max Memory Allocated: 1.0807175636291504  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9405612945556641  GigaBytes
Max Memory Allocated: 1.0807175636291504  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10177803039550781  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9389591217041016  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1022939682006836  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9372248649597168  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10226726531982422  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9350366592407227  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10243940353393555  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9359045028686523  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10253715515136719  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9369769096374512  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10246944427490234  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9393706321716309  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1016688346862793  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9361810684204102  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08370092511177063 |0.02000725269317627 |0.00369223952293396 |9.390711784362793e-05 |0.0037686526775360107 |0.0030281543731689453 |
----------------------------------------------------------pseudo_mini_loss sum 3.251927375793457
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3020930
Number of first layer input nodes during this epoch:  1286797
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1331348419189453  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02795267105102539
random selection method range initialization spend 0.005865335464477539
time for parepare:  0.019402503967285156
local_output_nid generation:  0.0045397281646728516
local_in_edges_tensor generation:  0.009244918823242188
mini_batch_src_global generation:  0.004045248031616211
r_  generation:  0.04240107536315918
local_output_nid generation:  0.0060460567474365234
local_in_edges_tensor generation:  0.0033235549926757812
mini_batch_src_global generation:  0.004896879196166992
r_  generation:  0.04511427879333496
local_output_nid generation:  0.006106853485107422
local_in_edges_tensor generation:  0.0034728050231933594
mini_batch_src_global generation:  0.0032312870025634766
r_  generation:  0.04596686363220215
local_output_nid generation:  0.006235599517822266
local_in_edges_tensor generation:  0.0033621788024902344
mini_batch_src_global generation:  0.0035109519958496094
r_  generation:  0.047653913497924805
local_output_nid generation:  0.006160736083984375
local_in_edges_tensor generation:  0.0033130645751953125
mini_batch_src_global generation:  0.003717660903930664
r_  generation:  0.048911333084106445
local_output_nid generation:  0.006173849105834961
local_in_edges_tensor generation:  0.0033524036407470703
mini_batch_src_global generation:  0.003928661346435547
r_  generation:  0.04795694351196289
local_output_nid generation:  0.006188869476318359
local_in_edges_tensor generation:  0.003379344940185547
mini_batch_src_global generation:  0.003986358642578125
r_  generation:  0.04697537422180176
local_output_nid generation:  0.006195545196533203
local_in_edges_tensor generation:  0.0033271312713623047
mini_batch_src_global generation:  0.004107475280761719
r_  generation:  0.04968738555908203
----------------------check_connections_block total spend ----------------------------- 0.5954010486602783
generate_one_block  0.06069350242614746
generate_one_block  0.06051468849182129
generate_one_block  0.06055927276611328
generate_one_block  0.061582326889038086
generate_one_block  0.06296658515930176
generate_one_block  0.06210613250732422
generate_one_block  0.0640099048614502
generate_one_block  0.06352019309997559
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04087042808532715
gen group dst list time:  0.016643762588500977
time for parepare:  0.019187450408935547
local_output_nid generation:  0.015019893646240234
local_in_edges_tensor generation:  0.03114771842956543
mini_batch_src_global generation:  0.032492637634277344
r_  generation:  0.31989526748657227
local_output_nid generation:  0.02084636688232422
local_in_edges_tensor generation:  0.02438044548034668
mini_batch_src_global generation:  0.03890037536621094
r_  generation:  0.33271288871765137
local_output_nid generation:  0.02086639404296875
local_in_edges_tensor generation:  0.02152729034423828
mini_batch_src_global generation:  0.040224313735961914
r_  generation:  0.3385279178619385
local_output_nid generation:  0.021332263946533203
local_in_edges_tensor generation:  0.021310091018676758
mini_batch_src_global generation:  0.03974771499633789
r_  generation:  0.3424191474914551
local_output_nid generation:  0.019972562789916992
local_in_edges_tensor generation:  0.02184438705444336
mini_batch_src_global generation:  0.04139971733093262
r_  generation:  0.3473701477050781
local_output_nid generation:  0.020003080368041992
local_in_edges_tensor generation:  0.030074596405029297
mini_batch_src_global generation:  0.04420185089111328
r_  generation:  0.35093164443969727
local_output_nid generation:  0.021032094955444336
local_in_edges_tensor generation:  0.02423691749572754
mini_batch_src_global generation:  0.04518747329711914
r_  generation:  0.3499929904937744
local_output_nid generation:  0.021503686904907227
local_in_edges_tensor generation:  0.021567821502685547
mini_batch_src_global generation:  0.04101300239562988
r_  generation:  0.34327125549316406
----------------------check_connections_block total spend ----------------------------- 4.016113996505737
generate_one_block  0.4406116008758545
generate_one_block  0.4302828311920166
generate_one_block  0.4307422637939453
generate_one_block  0.4388737678527832
generate_one_block  0.44676733016967773
generate_one_block  0.4399869441986084
generate_one_block  0.43235301971435547
generate_one_block  0.46939730644226074
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.040172576904296875
gen group dst list time:  0.039133548736572266
time for parepare:  0.02164292335510254
local_output_nid generation:  0.030233144760131836
local_in_edges_tensor generation:  0.0739903450012207
mini_batch_src_global generation:  0.04691052436828613
r_  generation:  0.49385595321655273
local_output_nid generation:  0.03901338577270508
local_in_edges_tensor generation:  0.04462027549743652
mini_batch_src_global generation:  0.05482625961303711
r_  generation:  0.4859175682067871
local_output_nid generation:  0.03701639175415039
local_in_edges_tensor generation:  0.03838157653808594
mini_batch_src_global generation:  0.05167341232299805
r_  generation:  0.49494481086730957
local_output_nid generation:  0.03677868843078613
local_in_edges_tensor generation:  0.03891587257385254
mini_batch_src_global generation:  0.0558011531829834
r_  generation:  0.48836350440979004
local_output_nid generation:  0.0368809700012207
local_in_edges_tensor generation:  0.03756141662597656
mini_batch_src_global generation:  0.05330801010131836
r_  generation:  0.5089387893676758
local_output_nid generation:  0.03678011894226074
local_in_edges_tensor generation:  0.03871345520019531
mini_batch_src_global generation:  0.054935455322265625
r_  generation:  0.5047032833099365
local_output_nid generation:  0.036995887756347656
local_in_edges_tensor generation:  0.034974098205566406
mini_batch_src_global generation:  0.05362296104431152
r_  generation:  0.5075466632843018
local_output_nid generation:  0.03891777992248535
local_in_edges_tensor generation:  0.036863088607788086
mini_batch_src_global generation:  0.05726218223571777
r_  generation:  0.5004260540008545
----------------------check_connections_block total spend ----------------------------- 5.937985181808472
generate_one_block  0.6354238986968994
generate_one_block  0.6291508674621582
generate_one_block  0.6218087673187256
generate_one_block  0.6383626461029053
generate_one_block  0.6305415630340576
generate_one_block  0.6241424083709717
generate_one_block  0.6111299991607666
generate_one_block  0.6274013519287109
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1331348419189453  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

connection checking time:  9.954099178314209
block generation total time  8.546976566314697
average batch blocks generation time:  1.0683720707893372
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10219049453735352  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9374580383300781  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1021890640258789  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.936180591583252  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10248899459838867  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9360532760620117  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10257816314697266  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9367280006408691  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10259103775024414  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9396014213562012  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1017160415649414  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.936368465423584  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10210704803466797  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9333529472351074  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10277175903320312  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9387497901916504  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08089077472686768 |0.016193896532058716 |0.0037037134170532227 |9.578466415405273e-05 |0.0035523176193237305 |0.002971172332763672 |
----------------------------------------------------------pseudo_mini_loss sum 2.615119218826294
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  3018896
Number of first layer input nodes during this epoch:  1286782
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13324689865112305  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02487015724182129
random selection method range initialization spend 0.005961418151855469
time for parepare:  0.017281055450439453
local_output_nid generation:  0.004545927047729492
local_in_edges_tensor generation:  0.006979703903198242
mini_batch_src_global generation:  0.0039997100830078125
r_  generation:  0.04385733604431152
local_output_nid generation:  0.0060808658599853516
local_in_edges_tensor generation:  0.003326892852783203
mini_batch_src_global generation:  0.004999399185180664
r_  generation:  0.04516911506652832
local_output_nid generation:  0.006228446960449219
local_in_edges_tensor generation:  0.0034019947052001953
mini_batch_src_global generation:  0.003259420394897461
r_  generation:  0.04485130310058594
local_output_nid generation:  0.006222724914550781
local_in_edges_tensor generation:  0.003409147262573242
mini_batch_src_global generation:  0.0034461021423339844
r_  generation:  0.04878497123718262
local_output_nid generation:  0.006250143051147461
local_in_edges_tensor generation:  0.0038423538208007812
mini_batch_src_global generation:  0.003712892532348633
r_  generation:  0.048377275466918945
local_output_nid generation:  0.006308794021606445
local_in_edges_tensor generation:  0.0035507678985595703
mini_batch_src_global generation:  0.004042148590087891
r_  generation:  0.048123836517333984
local_output_nid generation:  0.0064165592193603516
local_in_edges_tensor generation:  0.0037665367126464844
mini_batch_src_global generation:  0.003947019577026367
r_  generation:  0.04776191711425781
local_output_nid generation:  0.0063326358795166016
local_in_edges_tensor generation:  0.0034775733947753906
mini_batch_src_global generation:  0.0040395259857177734
r_  generation:  0.04850888252258301
----------------------check_connections_block total spend ----------------------------- 0.5985972881317139
generate_one_block  0.0654606819152832
generate_one_block  0.07294917106628418
generate_one_block  0.06098461151123047
generate_one_block  0.06127190589904785
generate_one_block  0.06232452392578125
generate_one_block  0.06193256378173828
generate_one_block  0.06479382514953613
generate_one_block  0.06238508224487305
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04009366035461426
gen group dst list time:  0.016265869140625
time for parepare:  0.020404338836669922
local_output_nid generation:  0.015157699584960938
local_in_edges_tensor generation:  0.0320892333984375
mini_batch_src_global generation:  0.032195091247558594
r_  generation:  0.3199808597564697
local_output_nid generation:  0.02082204818725586
local_in_edges_tensor generation:  0.030367612838745117
mini_batch_src_global generation:  0.041582345962524414
r_  generation:  0.350205659866333
local_output_nid generation:  0.023888826370239258
local_in_edges_tensor generation:  0.021002531051635742
mini_batch_src_global generation:  0.040387630462646484
r_  generation:  0.3297276496887207
local_output_nid generation:  0.020082950592041016
local_in_edges_tensor generation:  0.02145671844482422
mini_batch_src_global generation:  0.03952455520629883
r_  generation:  0.3323335647583008
local_output_nid generation:  0.019600391387939453
local_in_edges_tensor generation:  0.021210908889770508
mini_batch_src_global generation:  0.04062294960021973
r_  generation:  0.33600544929504395
local_output_nid generation:  0.01992321014404297
local_in_edges_tensor generation:  0.020685911178588867
mini_batch_src_global generation:  0.04119563102722168
r_  generation:  0.3364536762237549
local_output_nid generation:  0.019817829132080078
local_in_edges_tensor generation:  0.021092891693115234
mini_batch_src_global generation:  0.04052400588989258
r_  generation:  0.3333930969238281
local_output_nid generation:  0.01996636390686035
local_in_edges_tensor generation:  0.020802021026611328
mini_batch_src_global generation:  0.04085350036621094
r_  generation:  0.3371856212615967
----------------------check_connections_block total spend ----------------------------- 3.939351797103882
generate_one_block  0.44789838790893555
generate_one_block  0.43448781967163086
generate_one_block  0.43373823165893555
generate_one_block  0.4307715892791748
generate_one_block  0.43690967559814453
generate_one_block  0.43134379386901855
generate_one_block  0.42212605476379395
generate_one_block  0.4562528133392334
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03219127655029297
gen group dst list time:  0.03779125213623047
time for parepare:  0.021597862243652344
local_output_nid generation:  0.02977776527404785
local_in_edges_tensor generation:  0.05172252655029297
mini_batch_src_global generation:  0.04400372505187988
r_  generation:  0.46842026710510254
local_output_nid generation:  0.03457832336425781
local_in_edges_tensor generation:  0.04091310501098633
mini_batch_src_global generation:  0.05395340919494629
r_  generation:  0.47896456718444824
local_output_nid generation:  0.034853458404541016
local_in_edges_tensor generation:  0.0344388484954834
mini_batch_src_global generation:  0.054370880126953125
r_  generation:  0.49539637565612793
local_output_nid generation:  0.03513741493225098
local_in_edges_tensor generation:  0.03417158126831055
mini_batch_src_global generation:  0.054544687271118164
r_  generation:  0.5023066997528076
local_output_nid generation:  0.034812211990356445
local_in_edges_tensor generation:  0.0343937873840332
mini_batch_src_global generation:  0.053070783615112305
r_  generation:  0.5076553821563721
local_output_nid generation:  0.03525853157043457
local_in_edges_tensor generation:  0.04132413864135742
mini_batch_src_global generation:  0.055298805236816406
r_  generation:  0.49518322944641113
local_output_nid generation:  0.0351259708404541
local_in_edges_tensor generation:  0.03238987922668457
mini_batch_src_global generation:  0.05330777168273926
r_  generation:  0.5046632289886475
local_output_nid generation:  0.03608584403991699
local_in_edges_tensor generation:  0.03454017639160156
mini_batch_src_global generation:  0.0573122501373291
r_  generation:  0.4963216781616211
----------------------check_connections_block total spend ----------------------------- 5.852437257766724
generate_one_block  0.6426601409912109
generate_one_block  0.6143243312835693
generate_one_block  0.6243610382080078
generate_one_block  0.616107702255249
generate_one_block  0.6134352684020996
generate_one_block  0.6301651000976562
generate_one_block  0.6055915355682373
generate_one_block  0.6106228828430176
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13324689865112305  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

connection checking time:  9.791789054870605
block generation total time  8.450796365737915
average batch blocks generation time:  1.0563495457172394
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10164642333984375  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9367585182189941  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10250091552734375  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9394001960754395  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10181903839111328  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.935755729675293  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10225391387939453  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9354982376098633  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10257577896118164  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9373378753662109  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10239362716674805  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9395203590393066  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10160636901855469  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9350929260253906  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10218477249145508  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9374814033508301  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08444306254386902 |0.016247928142547607 |0.0034946799278259277 |9.191036224365234e-05 |0.0037765800952911377 |0.0018992424011230469 |
----------------------------------------------------------pseudo_mini_loss sum 2.37631893157959
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  3019965
Number of first layer input nodes during this epoch:  1287049
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1326742172241211  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027974843978881836
random selection method range initialization spend 0.00664067268371582
time for parepare:  0.01810932159423828
local_output_nid generation:  0.0044934749603271484
local_in_edges_tensor generation:  0.008147716522216797
mini_batch_src_global generation:  0.004015207290649414
r_  generation:  0.042215585708618164
local_output_nid generation:  0.008125066757202148
local_in_edges_tensor generation:  0.003469228744506836
mini_batch_src_global generation:  0.004949808120727539
r_  generation:  0.044361114501953125
local_output_nid generation:  0.006116628646850586
local_in_edges_tensor generation:  0.003596067428588867
mini_batch_src_global generation:  0.0033388137817382812
r_  generation:  0.04648423194885254
local_output_nid generation:  0.007444858551025391
local_in_edges_tensor generation:  0.003662109375
mini_batch_src_global generation:  0.0035865306854248047
r_  generation:  0.04996299743652344
local_output_nid generation:  0.006323337554931641
local_in_edges_tensor generation:  0.003810405731201172
mini_batch_src_global generation:  0.0037658214569091797
r_  generation:  0.047318458557128906
local_output_nid generation:  0.0062749385833740234
local_in_edges_tensor generation:  0.003536224365234375
mini_batch_src_global generation:  0.0038733482360839844
r_  generation:  0.04747605323791504
local_output_nid generation:  0.006273031234741211
local_in_edges_tensor generation:  0.003649473190307617
mini_batch_src_global generation:  0.003995418548583984
r_  generation:  0.04748034477233887
local_output_nid generation:  0.00627899169921875
local_in_edges_tensor generation:  0.0036745071411132812
mini_batch_src_global generation:  0.003996133804321289
r_  generation:  0.04790902137756348
----------------------check_connections_block total spend ----------------------------- 0.5969483852386475
generate_one_block  0.061921119689941406
generate_one_block  0.06159162521362305
generate_one_block  0.060857295989990234
generate_one_block  0.06269121170043945
generate_one_block  0.06285476684570312
generate_one_block  0.06175398826599121
generate_one_block  0.06518054008483887
generate_one_block  0.0626530647277832
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03385114669799805
gen group dst list time:  0.01577138900756836
time for parepare:  0.018801450729370117
local_output_nid generation:  0.0148773193359375
local_in_edges_tensor generation:  0.030640602111816406
mini_batch_src_global generation:  0.03188323974609375
r_  generation:  0.31628918647766113
local_output_nid generation:  0.02073359489440918
local_in_edges_tensor generation:  0.02411484718322754
mini_batch_src_global generation:  0.03969287872314453
r_  generation:  0.32992124557495117
local_output_nid generation:  0.0207669734954834
local_in_edges_tensor generation:  0.0193483829498291
mini_batch_src_global generation:  0.03838682174682617
r_  generation:  0.33440232276916504
local_output_nid generation:  0.02031397819519043
local_in_edges_tensor generation:  0.021112680435180664
mini_batch_src_global generation:  0.03929710388183594
r_  generation:  0.33371973037719727
local_output_nid generation:  0.019667387008666992
local_in_edges_tensor generation:  0.021119356155395508
mini_batch_src_global generation:  0.04187154769897461
r_  generation:  0.3428325653076172
local_output_nid generation:  0.019501209259033203
local_in_edges_tensor generation:  0.021066904067993164
mini_batch_src_global generation:  0.04069638252258301
r_  generation:  0.3378775119781494
local_output_nid generation:  0.019547224044799805
local_in_edges_tensor generation:  0.02077627182006836
mini_batch_src_global generation:  0.040167808532714844
r_  generation:  0.33951640129089355
local_output_nid generation:  0.019852161407470703
local_in_edges_tensor generation:  0.02337026596069336
mini_batch_src_global generation:  0.04100775718688965
r_  generation:  0.34770727157592773
----------------------check_connections_block total spend ----------------------------- 3.922614336013794
generate_one_block  0.4533357620239258
generate_one_block  0.45054078102111816
generate_one_block  0.44850683212280273
generate_one_block  0.43762826919555664
generate_one_block  0.4386422634124756
generate_one_block  0.4352278709411621
generate_one_block  0.432431697845459
generate_one_block  0.4608597755432129
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03491926193237305
gen group dst list time:  0.03928709030151367
time for parepare:  0.019409894943237305
local_output_nid generation:  0.030147790908813477
local_in_edges_tensor generation:  0.04870891571044922
mini_batch_src_global generation:  0.045584917068481445
r_  generation:  0.484027624130249
local_output_nid generation:  0.03630685806274414
local_in_edges_tensor generation:  0.040862083435058594
mini_batch_src_global generation:  0.05627155303955078
r_  generation:  0.5001709461212158
local_output_nid generation:  0.0372776985168457
local_in_edges_tensor generation:  0.04198455810546875
mini_batch_src_global generation:  0.05762124061584473
r_  generation:  0.501861572265625
local_output_nid generation:  0.03641080856323242
local_in_edges_tensor generation:  0.04623913764953613
mini_batch_src_global generation:  0.06699991226196289
r_  generation:  0.5022430419921875
local_output_nid generation:  0.03833508491516113
local_in_edges_tensor generation:  0.032665252685546875
mini_batch_src_global generation:  0.05745196342468262
r_  generation:  0.5083222389221191
local_output_nid generation:  0.03722214698791504
local_in_edges_tensor generation:  0.034708499908447266
mini_batch_src_global generation:  0.05714821815490723
r_  generation:  0.49845027923583984
local_output_nid generation:  0.03738045692443848
local_in_edges_tensor generation:  0.03420615196228027
mini_batch_src_global generation:  0.05763435363769531
r_  generation:  0.5062274932861328
local_output_nid generation:  0.03760528564453125
local_in_edges_tensor generation:  0.034000396728515625
mini_batch_src_global generation:  0.05767822265625
r_  generation:  0.5080618858337402
----------------------check_connections_block total spend ----------------------------- 5.980090141296387
generate_one_block  0.6225199699401855
generate_one_block  0.6136553287506104
generate_one_block  0.6186652183532715
generate_one_block  0.6058046817779541
generate_one_block  0.6184964179992676
generate_one_block  0.6147458553314209
generate_one_block  0.6177332401275635
generate_one_block  0.6264185905456543
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1326742172241211  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

connection checking time:  9.90270447731018
block generation total time  8.49521255493164
average batch blocks generation time:  1.061901569366455
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10222578048706055  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9374814033508301  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10253143310546875  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9384922981262207  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10165739059448242  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.936436653137207  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10216665267944336  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9369316101074219  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10245752334594727  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9374251365661621  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10247468948364258  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9366178512573242  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1025853157043457  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9364237785339355  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1026301383972168  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9389400482177734  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08447343111038208 |0.020012378692626953 |0.0036233067512512207 |9.40859317779541e-05 |0.0038135945796966553 |0.001996755599975586 |
----------------------------------------------------------pseudo_mini_loss sum 2.102222442626953
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  3020815
Number of first layer input nodes during this epoch:  1287064
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13315582275390625  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.041471004486083984
random selection method range initialization spend 0.0066988468170166016
time for parepare:  0.020281553268432617
local_output_nid generation:  0.0044057369232177734
local_in_edges_tensor generation:  0.009934663772583008
mini_batch_src_global generation:  0.004437685012817383
r_  generation:  0.04300379753112793
local_output_nid generation:  0.006087303161621094
local_in_edges_tensor generation:  0.0033409595489501953
mini_batch_src_global generation:  0.009111404418945312
r_  generation:  0.04955410957336426
local_output_nid generation:  0.009115934371948242
local_in_edges_tensor generation:  0.004538297653198242
mini_batch_src_global generation:  0.003509521484375
r_  generation:  0.04815268516540527
local_output_nid generation:  0.009074211120605469
local_in_edges_tensor generation:  0.004443645477294922
mini_batch_src_global generation:  0.0038330554962158203
r_  generation:  0.049222469329833984
local_output_nid generation:  0.009120941162109375
local_in_edges_tensor generation:  0.004449605941772461
mini_batch_src_global generation:  0.0038683414459228516
r_  generation:  0.05099177360534668
local_output_nid generation:  0.012349128723144531
local_in_edges_tensor generation:  0.004631996154785156
mini_batch_src_global generation:  0.010077714920043945
r_  generation:  0.052872419357299805
local_output_nid generation:  0.007673025131225586
local_in_edges_tensor generation:  0.003711223602294922
mini_batch_src_global generation:  0.005218029022216797
r_  generation:  0.05176830291748047
local_output_nid generation:  0.006945610046386719
local_in_edges_tensor generation:  0.0034668445587158203
mini_batch_src_global generation:  0.005251169204711914
r_  generation:  0.05080533027648926
----------------------check_connections_block total spend ----------------------------- 0.6803891658782959
generate_one_block  0.058916568756103516
generate_one_block  0.06110429763793945
generate_one_block  0.061585187911987305
generate_one_block  0.0751800537109375
generate_one_block  0.06536674499511719
generate_one_block  0.06540036201477051
generate_one_block  0.07112669944763184
generate_one_block  0.06796050071716309
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04856276512145996
gen group dst list time:  0.017824888229370117
time for parepare:  0.02149820327758789
local_output_nid generation:  0.017299413681030273
local_in_edges_tensor generation:  0.03600120544433594
mini_batch_src_global generation:  0.04390120506286621
r_  generation:  0.3313455581665039
local_output_nid generation:  0.027689695358276367
local_in_edges_tensor generation:  0.03723859786987305
mini_batch_src_global generation:  0.045554161071777344
r_  generation:  0.352583646774292
local_output_nid generation:  0.03189849853515625
local_in_edges_tensor generation:  0.023430347442626953
mini_batch_src_global generation:  0.042832136154174805
r_  generation:  0.3564929962158203
local_output_nid generation:  0.027414798736572266
local_in_edges_tensor generation:  0.02310657501220703
mini_batch_src_global generation:  0.044209957122802734
r_  generation:  0.36064791679382324
local_output_nid generation:  0.025087356567382812
local_in_edges_tensor generation:  0.024161577224731445
mini_batch_src_global generation:  0.045723676681518555
r_  generation:  0.37181544303894043
local_output_nid generation:  0.02767157554626465
local_in_edges_tensor generation:  0.02638983726501465
mini_batch_src_global generation:  0.045536041259765625
r_  generation:  0.37864136695861816
local_output_nid generation:  0.0286557674407959
local_in_edges_tensor generation:  0.030678272247314453
mini_batch_src_global generation:  0.0466310977935791
r_  generation:  0.36217403411865234
local_output_nid generation:  0.0247652530670166
local_in_edges_tensor generation:  0.025312423706054688
mini_batch_src_global generation:  0.04414987564086914
r_  generation:  0.3520679473876953
----------------------check_connections_block total spend ----------------------------- 4.3164894580841064
generate_one_block  0.4308896064758301
generate_one_block  0.4298124313354492
generate_one_block  0.43388795852661133
generate_one_block  0.43918728828430176
generate_one_block  0.4577977657318115
generate_one_block  0.43831467628479004
generate_one_block  0.4487886428833008
generate_one_block  0.4612419605255127
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.033380746841430664
gen group dst list time:  0.0391690731048584
time for parepare:  0.019294023513793945
local_output_nid generation:  0.03310561180114746
local_in_edges_tensor generation:  0.05125021934509277
mini_batch_src_global generation:  0.046289682388305664
r_  generation:  0.4912996292114258
local_output_nid generation:  0.038403987884521484
local_in_edges_tensor generation:  0.04188227653503418
mini_batch_src_global generation:  0.054778099060058594
r_  generation:  0.4834315776824951
local_output_nid generation:  0.03688931465148926
local_in_edges_tensor generation:  0.03681015968322754
mini_batch_src_global generation:  0.05150914192199707
r_  generation:  0.49469447135925293
local_output_nid generation:  0.03707456588745117
local_in_edges_tensor generation:  0.03304696083068848
mini_batch_src_global generation:  0.05387759208679199
r_  generation:  0.48827481269836426
local_output_nid generation:  0.03652524948120117
local_in_edges_tensor generation:  0.03464913368225098
mini_batch_src_global generation:  0.05298614501953125
r_  generation:  0.5017378330230713
local_output_nid generation:  0.0368046760559082
local_in_edges_tensor generation:  0.03770780563354492
mini_batch_src_global generation:  0.05460071563720703
r_  generation:  0.4949030876159668
local_output_nid generation:  0.03699684143066406
local_in_edges_tensor generation:  0.036698341369628906
mini_batch_src_global generation:  0.054819583892822266
r_  generation:  0.5103592872619629
local_output_nid generation:  0.037045955657958984
local_in_edges_tensor generation:  0.035593509674072266
mini_batch_src_global generation:  0.0553286075592041
r_  generation:  0.49466872215270996
----------------------check_connections_block total spend ----------------------------- 5.896918773651123
generate_one_block  0.6211304664611816
generate_one_block  0.6096158027648926
generate_one_block  0.619687557220459
generate_one_block  0.6200978755950928
generate_one_block  0.6206076145172119
generate_one_block  0.6150784492492676
generate_one_block  0.6245853900909424
generate_one_block  0.6121094226837158
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13315582275390625  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

connection checking time:  10.21340823173523
block generation total time  8.482832908630371
average batch blocks generation time:  1.0603541135787964
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1013803482055664  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9278354644775391  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10223245620727539  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9366054534912109  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1026911735534668  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9388961791992188  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10169410705566406  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9369854927062988  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10248279571533203  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.940885066986084  GigaBytes
Max Memory Allocated: 1.0815820693969727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10176658630371094  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9372358322143555  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10253381729125977  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9386053085327148  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10154199600219727  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.934943675994873  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08372372388839722 |0.016167670488357544 |0.005922824144363403 |9.733438491821289e-05 |0.0037021636962890625 |0.00147247314453125 |
----------------------------------------------------------pseudo_mini_loss sum 1.9558740854263306
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  3018778
Number of first layer input nodes during this epoch:  1286927
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1330404281616211  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02588820457458496
random selection method range initialization spend 0.005940914154052734
time for parepare:  0.016983985900878906
local_output_nid generation:  0.0044443607330322266
local_in_edges_tensor generation:  0.009051084518432617
mini_batch_src_global generation:  0.006354093551635742
r_  generation:  0.04219460487365723
local_output_nid generation:  0.005968570709228516
local_in_edges_tensor generation:  0.0037894248962402344
mini_batch_src_global generation:  0.005045175552368164
r_  generation:  0.04608345031738281
local_output_nid generation:  0.006110429763793945
local_in_edges_tensor generation:  0.003312349319458008
mini_batch_src_global generation:  0.0033638477325439453
r_  generation:  0.047609806060791016
local_output_nid generation:  0.006142616271972656
local_in_edges_tensor generation:  0.003352642059326172
mini_batch_src_global generation:  0.0035736560821533203
r_  generation:  0.04857659339904785
local_output_nid generation:  0.0061266422271728516
local_in_edges_tensor generation:  0.003444671630859375
mini_batch_src_global generation:  0.0037496089935302734
r_  generation:  0.04788804054260254
local_output_nid generation:  0.006194353103637695
local_in_edges_tensor generation:  0.003485441207885742
mini_batch_src_global generation:  0.003942966461181641
r_  generation:  0.05103754997253418
local_output_nid generation:  0.006716489791870117
local_in_edges_tensor generation:  0.003733396530151367
mini_batch_src_global generation:  0.0044138431549072266
r_  generation:  0.04726719856262207
local_output_nid generation:  0.006126880645751953
local_in_edges_tensor generation:  0.0036458969116210938
mini_batch_src_global generation:  0.006199836730957031
r_  generation:  0.049523115158081055
----------------------check_connections_block total spend ----------------------------- 0.607520341873169
generate_one_block  0.06671977043151855
generate_one_block  0.06219077110290527
generate_one_block  0.06214761734008789
generate_one_block  0.06293368339538574
generate_one_block  0.061780452728271484
generate_one_block  0.06179690361022949
generate_one_block  0.06378579139709473
generate_one_block  0.06300950050354004
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03608059883117676
gen group dst list time:  0.016141176223754883
time for parepare:  0.020328521728515625
local_output_nid generation:  0.015154838562011719
local_in_edges_tensor generation:  0.03223371505737305
mini_batch_src_global generation:  0.030620336532592773
r_  generation:  0.32511281967163086
local_output_nid generation:  0.02734375
local_in_edges_tensor generation:  0.026561498641967773
mini_batch_src_global generation:  0.04935431480407715
r_  generation:  0.3470156192779541
local_output_nid generation:  0.02133798599243164
local_in_edges_tensor generation:  0.021052122116088867
mini_batch_src_global generation:  0.038698434829711914
r_  generation:  0.3407471179962158
local_output_nid generation:  0.020728349685668945
local_in_edges_tensor generation:  0.022412538528442383
mini_batch_src_global generation:  0.043184757232666016
r_  generation:  0.339275598526001
local_output_nid generation:  0.020801544189453125
local_in_edges_tensor generation:  0.019927978515625
mini_batch_src_global generation:  0.04060029983520508
r_  generation:  0.3442392349243164
local_output_nid generation:  0.020705461502075195
local_in_edges_tensor generation:  0.02125692367553711
mini_batch_src_global generation:  0.0418238639831543
r_  generation:  0.34227848052978516
local_output_nid generation:  0.019925832748413086
local_in_edges_tensor generation:  0.020027875900268555
mini_batch_src_global generation:  0.040547847747802734
r_  generation:  0.33513379096984863
local_output_nid generation:  0.020341157913208008
local_in_edges_tensor generation:  0.019680261611938477
mini_batch_src_global generation:  0.042862653732299805
r_  generation:  0.3556663990020752
----------------------check_connections_block total spend ----------------------------- 4.006628513336182
generate_one_block  0.4465179443359375
generate_one_block  0.4433162212371826
generate_one_block  0.440598726272583
generate_one_block  0.44019579887390137
generate_one_block  0.4443655014038086
generate_one_block  0.43528199195861816
generate_one_block  0.4258584976196289
generate_one_block  0.4645357131958008
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03377032279968262
gen group dst list time:  0.038268089294433594
time for parepare:  0.020786046981811523
local_output_nid generation:  0.030544042587280273
local_in_edges_tensor generation:  0.05662703514099121
mini_batch_src_global generation:  0.047419071197509766
r_  generation:  0.4748077392578125
local_output_nid generation:  0.035691261291503906
local_in_edges_tensor generation:  0.04022049903869629
mini_batch_src_global generation:  0.05632352828979492
r_  generation:  0.48551011085510254
local_output_nid generation:  0.03566741943359375
local_in_edges_tensor generation:  0.03460955619812012
mini_batch_src_global generation:  0.051306962966918945
r_  generation:  0.5076694488525391
local_output_nid generation:  0.03613448143005371
local_in_edges_tensor generation:  0.0365452766418457
mini_batch_src_global generation:  0.05420041084289551
r_  generation:  0.5011212825775146
local_output_nid generation:  0.03615736961364746
local_in_edges_tensor generation:  0.039643287658691406
mini_batch_src_global generation:  0.05680584907531738
r_  generation:  0.5047340393066406
local_output_nid generation:  0.03687715530395508
local_in_edges_tensor generation:  0.03859424591064453
mini_batch_src_global generation:  0.054791927337646484
r_  generation:  0.49941062927246094
local_output_nid generation:  0.03642678260803223
local_in_edges_tensor generation:  0.036800384521484375
mini_batch_src_global generation:  0.05419421195983887
r_  generation:  0.5142052173614502
local_output_nid generation:  0.036330223083496094
local_in_edges_tensor generation:  0.044497013092041016
mini_batch_src_global generation:  0.05627894401550293
r_  generation:  0.5179579257965088
----------------------check_connections_block total spend ----------------------------- 5.9486706256866455
generate_one_block  0.6324207782745361
generate_one_block  0.6211600303649902
generate_one_block  0.6132419109344482
generate_one_block  0.6147661209106445
generate_one_block  0.6187796592712402
generate_one_block  0.6228249073028564
generate_one_block  0.6139907836914062
generate_one_block  0.6178481578826904
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1330404281616211  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

connection checking time:  9.955299139022827
block generation total time  8.495702743530273
average batch blocks generation time:  1.0619628429412842
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10219335556030273  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9356675148010254  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10277223587036133  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9400973320007324  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10242938995361328  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9365983009338379  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10261249542236328  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9386463165283203  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10172128677368164  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9365277290344238  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10223913192749023  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9363551139831543  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1022181510925293  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9284381866455078  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10293006896972656  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9392366409301758  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07889565825462341 |0.01691296696662903 |0.003702014684677124 |9.608268737792969e-05 |0.0034254789352416992 |0.001756429672241211 |
----------------------------------------------------------pseudo_mini_loss sum 1.8719592094421387
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  3019798
Number of first layer input nodes during this epoch:  1287371
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1332716941833496  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024109363555908203
random selection method range initialization spend 0.005799055099487305
time for parepare:  0.018159866333007812
local_output_nid generation:  0.004518032073974609
local_in_edges_tensor generation:  0.006792545318603516
mini_batch_src_global generation:  0.003876209259033203
r_  generation:  0.046106576919555664
local_output_nid generation:  0.006078243255615234
local_in_edges_tensor generation:  0.0033359527587890625
mini_batch_src_global generation:  0.005034208297729492
r_  generation:  0.04550623893737793
local_output_nid generation:  0.006097555160522461
local_in_edges_tensor generation:  0.003590106964111328
mini_batch_src_global generation:  0.0036466121673583984
r_  generation:  0.04681277275085449
local_output_nid generation:  0.006112337112426758
local_in_edges_tensor generation:  0.003364086151123047
mini_batch_src_global generation:  0.003618955612182617
r_  generation:  0.051352739334106445
local_output_nid generation:  0.007378101348876953
local_in_edges_tensor generation:  0.0033838748931884766
mini_batch_src_global generation:  0.0038383007049560547
r_  generation:  0.04761958122253418
local_output_nid generation:  0.006220579147338867
local_in_edges_tensor generation:  0.0033130645751953125
mini_batch_src_global generation:  0.009370803833007812
r_  generation:  0.04903268814086914
local_output_nid generation:  0.006281852722167969
local_in_edges_tensor generation:  0.003568887710571289
mini_batch_src_global generation:  0.01847243309020996
r_  generation:  0.04849529266357422
local_output_nid generation:  0.006232023239135742
local_in_edges_tensor generation:  0.0034568309783935547
mini_batch_src_global generation:  0.004096269607543945
r_  generation:  0.04901885986328125
----------------------check_connections_block total spend ----------------------------- 0.642570972442627
generate_one_block  0.061894893646240234
generate_one_block  0.06128406524658203
generate_one_block  0.07906436920166016
generate_one_block  0.07139015197753906
generate_one_block  0.06381916999816895
generate_one_block  0.06267547607421875
generate_one_block  0.06609296798706055
generate_one_block  0.0777428150177002
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06347179412841797
gen group dst list time:  0.0178682804107666
time for parepare:  0.02250981330871582
local_output_nid generation:  0.01736617088317871
local_in_edges_tensor generation:  0.04098796844482422
mini_batch_src_global generation:  0.034632205963134766
r_  generation:  0.35639381408691406
local_output_nid generation:  0.025931596755981445
local_in_edges_tensor generation:  0.02872180938720703
mini_batch_src_global generation:  0.05865979194641113
r_  generation:  0.34641361236572266
local_output_nid generation:  0.025497913360595703
local_in_edges_tensor generation:  0.02296733856201172
mini_batch_src_global generation:  0.045516252517700195
r_  generation:  0.3520078659057617
local_output_nid generation:  0.025155067443847656
local_in_edges_tensor generation:  0.02272963523864746
mini_batch_src_global generation:  0.042765140533447266
r_  generation:  0.3459131717681885
local_output_nid generation:  0.025441884994506836
local_in_edges_tensor generation:  0.021920204162597656
mini_batch_src_global generation:  0.04482316970825195
r_  generation:  0.36063694953918457
local_output_nid generation:  0.024259090423583984
local_in_edges_tensor generation:  0.024695873260498047
mini_batch_src_global generation:  0.0446321964263916
r_  generation:  0.3633723258972168
local_output_nid generation:  0.024517059326171875
local_in_edges_tensor generation:  0.02426457405090332
mini_batch_src_global generation:  0.04415774345397949
r_  generation:  0.3634955883026123
local_output_nid generation:  0.02460193634033203
local_in_edges_tensor generation:  0.022814512252807617
mini_batch_src_global generation:  0.04611635208129883
r_  generation:  0.35706424713134766
----------------------check_connections_block total spend ----------------------------- 4.264280319213867
generate_one_block  0.4360220432281494
generate_one_block  0.4259331226348877
generate_one_block  0.43271708488464355
generate_one_block  0.4347867965698242
generate_one_block  0.4459047317504883
generate_one_block  0.4512755870819092
generate_one_block  0.4392540454864502
generate_one_block  0.4717278480529785
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03514719009399414
gen group dst list time:  0.03949236869812012
time for parepare:  0.020731449127197266
local_output_nid generation:  0.03134799003601074
local_in_edges_tensor generation:  0.061304330825805664
mini_batch_src_global generation:  0.04581093788146973
r_  generation:  0.47693943977355957
local_output_nid generation:  0.036675214767456055
local_in_edges_tensor generation:  0.040607452392578125
mini_batch_src_global generation:  0.05418896675109863
r_  generation:  0.487581729888916
local_output_nid generation:  0.03638577461242676
local_in_edges_tensor generation:  0.03817915916442871
mini_batch_src_global generation:  0.051377058029174805
r_  generation:  0.512392520904541
local_output_nid generation:  0.037953853607177734
local_in_edges_tensor generation:  0.036507368087768555
mini_batch_src_global generation:  0.0542759895324707
r_  generation:  0.5067365169525146
local_output_nid generation:  0.04025459289550781
local_in_edges_tensor generation:  0.04259800910949707
mini_batch_src_global generation:  0.05340385437011719
r_  generation:  0.5129978656768799
local_output_nid generation:  0.0367436408996582
local_in_edges_tensor generation:  0.041165828704833984
mini_batch_src_global generation:  0.06893181800842285
r_  generation:  0.5088222026824951
local_output_nid generation:  0.039067983627319336
local_in_edges_tensor generation:  0.037656545639038086
mini_batch_src_global generation:  0.05454134941101074
r_  generation:  0.5055487155914307
local_output_nid generation:  0.03792572021484375
local_in_edges_tensor generation:  0.03483748435974121
mini_batch_src_global generation:  0.05777621269226074
r_  generation:  0.5117430686950684
----------------------check_connections_block total spend ----------------------------- 5.98892879486084
generate_one_block  0.6359868049621582
generate_one_block  0.6254925727844238
generate_one_block  0.6155929565429688
generate_one_block  0.6179308891296387
generate_one_block  0.627009391784668
generate_one_block  0.6359570026397705
generate_one_block  0.6179990768432617
generate_one_block  0.6183376312255859
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1332716941833496  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

connection checking time:  10.253209114074707
block generation total time  8.531927585601807
average batch blocks generation time:  1.0664909482002258
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10190010070800781  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9400405883789062  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10224103927612305  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9363861083984375  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10246562957763672  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9361505508422852  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10268068313598633  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9330801963806152  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10283803939819336  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9365816116333008  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10270023345947266  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9378190040588379  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1022958755493164  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9375009536743164  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10254335403442383  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9375853538513184  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08148735761642456 |0.01955518126487732 |0.0038327276706695557 |0.00010079145431518555 |0.003599703311920166 |0.002885103225708008 |
----------------------------------------------------------pseudo_mini_loss sum 1.7920873165130615
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  3019687
Number of first layer input nodes during this epoch:  1287546
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13317298889160156  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02573704719543457
random selection method range initialization spend 0.005652904510498047
time for parepare:  0.01700448989868164
local_output_nid generation:  0.004590034484863281
local_in_edges_tensor generation:  0.00673222541809082
mini_batch_src_global generation:  0.003764629364013672
r_  generation:  0.044609785079956055
local_output_nid generation:  0.006135463714599609
local_in_edges_tensor generation:  0.0032978057861328125
mini_batch_src_global generation:  0.004943370819091797
r_  generation:  0.04518389701843262
local_output_nid generation:  0.006155729293823242
local_in_edges_tensor generation:  0.003353118896484375
mini_batch_src_global generation:  0.0034477710723876953
r_  generation:  0.046477317810058594
local_output_nid generation:  0.006220340728759766
local_in_edges_tensor generation:  0.003265857696533203
mini_batch_src_global generation:  0.0034394264221191406
r_  generation:  0.04950141906738281
local_output_nid generation:  0.006194353103637695
local_in_edges_tensor generation:  0.0033261775970458984
mini_batch_src_global generation:  0.0038840770721435547
r_  generation:  0.04842948913574219
local_output_nid generation:  0.006170988082885742
local_in_edges_tensor generation:  0.00336456298828125
mini_batch_src_global generation:  0.004045724868774414
r_  generation:  0.04866814613342285
local_output_nid generation:  0.006224155426025391
local_in_edges_tensor generation:  0.003411531448364258
mini_batch_src_global generation:  0.004079341888427734
r_  generation:  0.04928708076477051
local_output_nid generation:  0.0062351226806640625
local_in_edges_tensor generation:  0.003327608108520508
mini_batch_src_global generation:  0.004124164581298828
r_  generation:  0.04934883117675781
----------------------check_connections_block total spend ----------------------------- 0.6017096042633057
generate_one_block  0.06848025321960449
generate_one_block  0.0627737045288086
generate_one_block  0.06279253959655762
generate_one_block  0.06303834915161133
generate_one_block  0.06465435028076172
generate_one_block  0.06177639961242676
generate_one_block  0.06793642044067383
generate_one_block  0.06244087219238281
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03708767890930176
gen group dst list time:  0.0157318115234375
time for parepare:  0.019443273544311523
local_output_nid generation:  0.01485586166381836
local_in_edges_tensor generation:  0.0283811092376709
mini_batch_src_global generation:  0.03168487548828125
r_  generation:  0.3261451721191406
local_output_nid generation:  0.0220029354095459
local_in_edges_tensor generation:  0.023721694946289062
mini_batch_src_global generation:  0.042116403579711914
r_  generation:  0.3349940776824951
local_output_nid generation:  0.021269559860229492
local_in_edges_tensor generation:  0.03211402893066406
mini_batch_src_global generation:  0.04034900665283203
r_  generation:  0.36396336555480957
local_output_nid generation:  0.023672819137573242
local_in_edges_tensor generation:  0.021691560745239258
mini_batch_src_global generation:  0.03971242904663086
r_  generation:  0.33852481842041016
local_output_nid generation:  0.021808385848999023
local_in_edges_tensor generation:  0.024749755859375
mini_batch_src_global generation:  0.04059171676635742
r_  generation:  0.3455235958099365
local_output_nid generation:  0.020366668701171875
local_in_edges_tensor generation:  0.020745038986206055
mini_batch_src_global generation:  0.043715715408325195
r_  generation:  0.33820414543151855
local_output_nid generation:  0.020602941513061523
local_in_edges_tensor generation:  0.0201718807220459
mini_batch_src_global generation:  0.040622711181640625
r_  generation:  0.34842824935913086
local_output_nid generation:  0.020355224609375
local_in_edges_tensor generation:  0.021189212799072266
mini_batch_src_global generation:  0.04126739501953125
r_  generation:  0.34136295318603516
----------------------check_connections_block total spend ----------------------------- 4.0154852867126465
generate_one_block  0.4451453685760498
generate_one_block  0.43780994415283203
generate_one_block  0.4404430389404297
generate_one_block  0.4431788921356201
generate_one_block  0.44315552711486816
generate_one_block  0.4365878105163574
generate_one_block  0.43216538429260254
generate_one_block  0.4588911533355713
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03556060791015625
gen group dst list time:  0.03804659843444824
time for parepare:  0.021097183227539062
local_output_nid generation:  0.030811786651611328
local_in_edges_tensor generation:  0.054160356521606445
mini_batch_src_global generation:  0.04830217361450195
r_  generation:  0.4825398921966553
local_output_nid generation:  0.03622889518737793
local_in_edges_tensor generation:  0.03938460350036621
mini_batch_src_global generation:  0.05453777313232422
r_  generation:  0.48496437072753906
local_output_nid generation:  0.03566741943359375
local_in_edges_tensor generation:  0.03585219383239746
mini_batch_src_global generation:  0.05111575126647949
r_  generation:  0.5027370452880859
local_output_nid generation:  0.035906076431274414
local_in_edges_tensor generation:  0.04150652885437012
mini_batch_src_global generation:  0.05331134796142578
r_  generation:  0.5035676956176758
local_output_nid generation:  0.036035776138305664
local_in_edges_tensor generation:  0.0349884033203125
mini_batch_src_global generation:  0.05472993850708008
r_  generation:  0.5056858062744141
local_output_nid generation:  0.03577280044555664
local_in_edges_tensor generation:  0.0378117561340332
mini_batch_src_global generation:  0.054979801177978516
r_  generation:  0.49687814712524414
local_output_nid generation:  0.03640151023864746
local_in_edges_tensor generation:  0.03532981872558594
mini_batch_src_global generation:  0.052909135818481445
r_  generation:  0.5163514614105225
local_output_nid generation:  0.036144256591796875
local_in_edges_tensor generation:  0.03527402877807617
mini_batch_src_global generation:  0.056743621826171875
r_  generation:  0.4946253299713135
----------------------check_connections_block total spend ----------------------------- 5.903354167938232
generate_one_block  0.6312670707702637
generate_one_block  0.6229197978973389
generate_one_block  0.6186902523040771
generate_one_block  0.6159982681274414
generate_one_block  0.6337919235229492
generate_one_block  0.6084504127502441
generate_one_block  0.6188604831695557
generate_one_block  0.6156158447265625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13317298889160156  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

connection checking time:  9.918839454650879
block generation total time  8.502971172332764
average batch blocks generation time:  1.0628713965415955
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1020970344543457  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9334259033203125  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1025996208190918  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9352564811706543  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10272979736328125  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9393305778503418  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10175037384033203  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9370193481445312  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1026315689086914  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9397335052490234  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10165929794311523  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9358963966369629  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10228586196899414  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9380154609680176  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10236263275146484  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9366803169250488  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08124449849128723 |0.016580313444137573 |0.003545910120010376 |0.0002720355987548828 |0.003569990396499634 |0.0013720989227294922 |
----------------------------------------------------------pseudo_mini_loss sum 1.7121840715408325
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  3019962
Number of first layer input nodes during this epoch:  1287352
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13328170776367188  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024813175201416016
random selection method range initialization spend 0.0053501129150390625
time for parepare:  0.01711583137512207
local_output_nid generation:  0.004579782485961914
local_in_edges_tensor generation:  0.010402202606201172
mini_batch_src_global generation:  0.0038406848907470703
r_  generation:  0.04781627655029297
local_output_nid generation:  0.006047725677490234
local_in_edges_tensor generation:  0.003965616226196289
mini_batch_src_global generation:  0.005086421966552734
r_  generation:  0.04802393913269043
local_output_nid generation:  0.0067064762115478516
local_in_edges_tensor generation:  0.00664067268371582
mini_batch_src_global generation:  0.003529071807861328
r_  generation:  0.04563570022583008
local_output_nid generation:  0.006118297576904297
local_in_edges_tensor generation:  0.0035190582275390625
mini_batch_src_global generation:  0.0036971569061279297
r_  generation:  0.04740643501281738
local_output_nid generation:  0.0062024593353271484
local_in_edges_tensor generation:  0.0034759044647216797
mini_batch_src_global generation:  0.003977537155151367
r_  generation:  0.04712224006652832
local_output_nid generation:  0.0061244964599609375
local_in_edges_tensor generation:  0.0034055709838867188
mini_batch_src_global generation:  0.003907918930053711
r_  generation:  0.047271728515625
local_output_nid generation:  0.0061492919921875
local_in_edges_tensor generation:  0.0033278465270996094
mini_batch_src_global generation:  0.0041255950927734375
r_  generation:  0.04922676086425781
local_output_nid generation:  0.0062940120697021484
local_in_edges_tensor generation:  0.0033826828002929688
mini_batch_src_global generation:  0.0041961669921875
r_  generation:  0.04905223846435547
----------------------check_connections_block total spend ----------------------------- 0.610964298248291
generate_one_block  0.06094169616699219
generate_one_block  0.06189107894897461
generate_one_block  0.061200857162475586
generate_one_block  0.0627431869506836
generate_one_block  0.06135129928588867
generate_one_block  0.06139421463012695
generate_one_block  0.06646919250488281
generate_one_block  0.06269478797912598
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.031720876693725586
gen group dst list time:  0.01616668701171875
time for parepare:  0.01973414421081543
local_output_nid generation:  0.015273809432983398
local_in_edges_tensor generation:  0.032474517822265625
mini_batch_src_global generation:  0.03198075294494629
r_  generation:  0.31992554664611816
local_output_nid generation:  0.020995140075683594
local_in_edges_tensor generation:  0.02560710906982422
mini_batch_src_global generation:  0.03868985176086426
r_  generation:  0.3381662368774414
local_output_nid generation:  0.020757198333740234
local_in_edges_tensor generation:  0.0248565673828125
mini_batch_src_global generation:  0.03901529312133789
r_  generation:  0.34099745750427246
local_output_nid generation:  0.023817062377929688
local_in_edges_tensor generation:  0.02287602424621582
mini_batch_src_global generation:  0.04130744934082031
r_  generation:  0.33902621269226074
local_output_nid generation:  0.021574735641479492
local_in_edges_tensor generation:  0.025102615356445312
mini_batch_src_global generation:  0.04085087776184082
r_  generation:  0.33973264694213867
local_output_nid generation:  0.020205974578857422
local_in_edges_tensor generation:  0.020111799240112305
mini_batch_src_global generation:  0.0407867431640625
r_  generation:  0.3347809314727783
local_output_nid generation:  0.02032327651977539
local_in_edges_tensor generation:  0.01978754997253418
mini_batch_src_global generation:  0.04275870323181152
r_  generation:  0.34183192253112793
local_output_nid generation:  0.020524263381958008
local_in_edges_tensor generation:  0.021910667419433594
mini_batch_src_global generation:  0.04175233840942383
r_  generation:  0.344897985458374
----------------------check_connections_block total spend ----------------------------- 3.978933811187744
generate_one_block  0.43639302253723145
generate_one_block  0.43632936477661133
generate_one_block  0.4243183135986328
generate_one_block  0.4453125
generate_one_block  0.4461243152618408
generate_one_block  0.43169236183166504
generate_one_block  0.44185972213745117
generate_one_block  0.478560209274292
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03621220588684082
gen group dst list time:  0.03892683982849121
time for parepare:  0.02011728286743164
local_output_nid generation:  0.030218124389648438
local_in_edges_tensor generation:  0.05300450325012207
mini_batch_src_global generation:  0.04736161231994629
r_  generation:  0.4786837100982666
local_output_nid generation:  0.035390377044677734
local_in_edges_tensor generation:  0.040883541107177734
mini_batch_src_global generation:  0.05517292022705078
r_  generation:  0.4836132526397705
local_output_nid generation:  0.03582906723022461
local_in_edges_tensor generation:  0.033997297286987305
mini_batch_src_global generation:  0.05116128921508789
r_  generation:  0.4967978000640869
local_output_nid generation:  0.036025285720825195
local_in_edges_tensor generation:  0.037114858627319336
mini_batch_src_global generation:  0.05798172950744629
r_  generation:  0.49794650077819824
local_output_nid generation:  0.0357973575592041
local_in_edges_tensor generation:  0.034776926040649414
mini_batch_src_global generation:  0.053923606872558594
r_  generation:  0.5081729888916016
local_output_nid generation:  0.036192893981933594
local_in_edges_tensor generation:  0.0360102653503418
mini_batch_src_global generation:  0.05551552772521973
r_  generation:  0.495743989944458
local_output_nid generation:  0.036184072494506836
local_in_edges_tensor generation:  0.03497004508972168
mini_batch_src_global generation:  0.05636882781982422
r_  generation:  0.512702465057373
local_output_nid generation:  0.03743290901184082
local_in_edges_tensor generation:  0.03287696838378906
mini_batch_src_global generation:  0.05640530586242676
r_  generation:  0.49963927268981934
----------------------check_connections_block total spend ----------------------------- 5.903302907943726
generate_one_block  0.6377077102661133
generate_one_block  0.6365163326263428
generate_one_block  0.614774227142334
generate_one_block  0.6154510974884033
generate_one_block  0.6181836128234863
generate_one_block  0.6153123378753662
generate_one_block  0.6090106964111328
generate_one_block  0.6201214790344238
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13328170776367188  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

connection checking time:  9.88223671913147
block generation total time  8.507667303085327
average batch blocks generation time:  1.063458412885666
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10257577896118164  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9386358261108398  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1017446517944336  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9365768432617188  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10245800018310547  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9298000335693359  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10292530059814453  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9407839775085449  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10175180435180664  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9369597434997559  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10245466232299805  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9357404708862305  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10257434844970703  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9363870620727539  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10275411605834961  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9377398490905762  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08314076066017151 |0.015205293893814087 |0.005765199661254883 |9.039044380187988e-05 |0.003770500421524048 |0.0017690658569335938 |
----------------------------------------------------------pseudo_mini_loss sum 1.6356549263000488
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  3019520
Number of first layer input nodes during this epoch:  1287534
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1333308219909668  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03516960144042969
random selection method range initialization spend 0.006462574005126953
time for parepare:  0.01701664924621582
local_output_nid generation:  0.004420042037963867
local_in_edges_tensor generation:  0.009704351425170898
mini_batch_src_global generation:  0.0036208629608154297
r_  generation:  0.04316830635070801
local_output_nid generation:  0.005891084671020508
local_in_edges_tensor generation:  0.0034542083740234375
mini_batch_src_global generation:  0.006849527359008789
r_  generation:  0.04555106163024902
local_output_nid generation:  0.006064414978027344
local_in_edges_tensor generation:  0.0035042762756347656
mini_batch_src_global generation:  0.0035490989685058594
r_  generation:  0.04544520378112793
local_output_nid generation:  0.00609898567199707
local_in_edges_tensor generation:  0.003539562225341797
mini_batch_src_global generation:  0.0033469200134277344
r_  generation:  0.04669809341430664
local_output_nid generation:  0.006161928176879883
local_in_edges_tensor generation:  0.003448963165283203
mini_batch_src_global generation:  0.003757476806640625
r_  generation:  0.047544240951538086
local_output_nid generation:  0.006134510040283203
local_in_edges_tensor generation:  0.003499269485473633
mini_batch_src_global generation:  0.003889322280883789
r_  generation:  0.04807710647583008
local_output_nid generation:  0.00612187385559082
local_in_edges_tensor generation:  0.0035660266876220703
mini_batch_src_global generation:  0.00397944450378418
r_  generation:  0.04805326461791992
local_output_nid generation:  0.006158590316772461
local_in_edges_tensor generation:  0.0034973621368408203
mini_batch_src_global generation:  0.004120588302612305
r_  generation:  0.04857373237609863
----------------------check_connections_block total spend ----------------------------- 0.5931422710418701
generate_one_block  0.06398987770080566
generate_one_block  0.061089277267456055
generate_one_block  0.06051754951477051
generate_one_block  0.06051969528198242
generate_one_block  0.0610659122467041
generate_one_block  0.06162881851196289
generate_one_block  0.06463503837585449
generate_one_block  0.06189846992492676
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03245997428894043
gen group dst list time:  0.015579938888549805
time for parepare:  0.019352197647094727
local_output_nid generation:  0.014863014221191406
local_in_edges_tensor generation:  0.0300753116607666
mini_batch_src_global generation:  0.031099557876586914
r_  generation:  0.3223745822906494
local_output_nid generation:  0.0207369327545166
local_in_edges_tensor generation:  0.023975372314453125
mini_batch_src_global generation:  0.039071083068847656
r_  generation:  0.3315260410308838
local_output_nid generation:  0.020636558532714844
local_in_edges_tensor generation:  0.021224260330200195
mini_batch_src_global generation:  0.03872227668762207
r_  generation:  0.3330521583557129
local_output_nid generation:  0.020073413848876953
local_in_edges_tensor generation:  0.01950359344482422
mini_batch_src_global generation:  0.0389707088470459
r_  generation:  0.33273911476135254
local_output_nid generation:  0.020632266998291016
local_in_edges_tensor generation:  0.020365238189697266
mini_batch_src_global generation:  0.04016995429992676
r_  generation:  0.3418419361114502
local_output_nid generation:  0.01986980438232422
local_in_edges_tensor generation:  0.022562742233276367
mini_batch_src_global generation:  0.04029655456542969
r_  generation:  0.33866453170776367
local_output_nid generation:  0.019317150115966797
local_in_edges_tensor generation:  0.019757747650146484
mini_batch_src_global generation:  0.04048562049865723
r_  generation:  0.33719444274902344
local_output_nid generation:  0.01933574676513672
local_in_edges_tensor generation:  0.021025657653808594
mini_batch_src_global generation:  0.04348444938659668
r_  generation:  0.3400750160217285
----------------------check_connections_block total spend ----------------------------- 3.9077389240264893
generate_one_block  0.42843008041381836
generate_one_block  0.42960524559020996
generate_one_block  0.4251210689544678
generate_one_block  0.42150306701660156
generate_one_block  0.4284348487854004
generate_one_block  0.4233269691467285
generate_one_block  0.42626476287841797
generate_one_block  0.45560336112976074
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.026695966720581055
gen group dst list time:  0.03819918632507324
time for parepare:  0.01975393295288086
local_output_nid generation:  0.0321803092956543
local_in_edges_tensor generation:  0.03923821449279785
mini_batch_src_global generation:  0.0455167293548584
r_  generation:  0.4768862724304199
local_output_nid generation:  0.03550863265991211
local_in_edges_tensor generation:  0.03811311721801758
mini_batch_src_global generation:  0.056359291076660156
r_  generation:  0.48027801513671875
local_output_nid generation:  0.03548765182495117
local_in_edges_tensor generation:  0.036771535873413086
mini_batch_src_global generation:  0.04974246025085449
r_  generation:  0.4979069232940674
local_output_nid generation:  0.03560590744018555
local_in_edges_tensor generation:  0.031683921813964844
mini_batch_src_global generation:  0.053185462951660156
r_  generation:  0.4867556095123291
local_output_nid generation:  0.03534197807312012
local_in_edges_tensor generation:  0.03629350662231445
mini_batch_src_global generation:  0.05180644989013672
r_  generation:  0.5059623718261719
local_output_nid generation:  0.035575151443481445
local_in_edges_tensor generation:  0.03447103500366211
mini_batch_src_global generation:  0.05499434471130371
r_  generation:  0.4927520751953125
local_output_nid generation:  0.03596234321594238
local_in_edges_tensor generation:  0.03651785850524902
mini_batch_src_global generation:  0.05321335792541504
r_  generation:  0.508681058883667
local_output_nid generation:  0.036829233169555664
local_in_edges_tensor generation:  0.03739213943481445
mini_batch_src_global generation:  0.05559897422790527
r_  generation:  0.49576735496520996
----------------------check_connections_block total spend ----------------------------- 5.825705051422119
generate_one_block  0.6108717918395996
generate_one_block  0.6165804862976074
generate_one_block  0.6104581356048584
generate_one_block  0.6082196235656738
generate_one_block  0.6125397682189941
generate_one_block  0.6095197200775146
generate_one_block  0.6076574325561523
generate_one_block  0.6093316078186035
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1333308219909668  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

connection checking time:  9.733443975448608
block generation total time  8.32346796989441
average batch blocks generation time:  1.0404334962368011
block dataloader generation time/epoch 20.07469630241394
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10249185562133789  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9389333724975586  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10177278518676758  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9372544288635254  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10232734680175781  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9366841316223145  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10239028930664062  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9334192276000977  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10271120071411133  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9369049072265625  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10248708724975586  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9365944862365723  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10252237319946289  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.937502384185791  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10230636596679688  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9380660057067871  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0832868218421936 |0.01596367359161377 |0.0035634636878967285 |9.611248970031738e-05 |0.0038121938705444336 |0.002769947052001953 |
----------------------------------------------------------pseudo_mini_loss sum 1.5969444513320923
Total (block generation + training)time/epoch 21.004517316818237
Training time/epoch 0.9295651912689209
Training time without block to device /epoch 0.8018558025360107
Training time without total dataloading part /epoch 0.06254410743713379
load block tensor time/epoch 0.6662945747375488
block to device time/epoch 0.12770938873291016
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  3019749
Number of first layer input nodes during this epoch:  1287312
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1332235336303711  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023813724517822266
random selection method range initialization spend 0.005771636962890625
time for parepare:  0.017715930938720703
local_output_nid generation:  0.004553318023681641
local_in_edges_tensor generation:  0.011005401611328125
mini_batch_src_global generation:  0.0034580230712890625
r_  generation:  0.04476428031921387
local_output_nid generation:  0.0061190128326416016
local_in_edges_tensor generation:  0.0066204071044921875
mini_batch_src_global generation:  0.005461454391479492
r_  generation:  0.04897809028625488
local_output_nid generation:  0.006231546401977539
local_in_edges_tensor generation:  0.003742694854736328
mini_batch_src_global generation:  0.003972291946411133
r_  generation:  0.045958757400512695
local_output_nid generation:  0.006211519241333008
local_in_edges_tensor generation:  0.0035500526428222656
mini_batch_src_global generation:  0.003328561782836914
r_  generation:  0.04722714424133301
local_output_nid generation:  0.006220340728759766
local_in_edges_tensor generation:  0.003633260726928711
mini_batch_src_global generation:  0.003873109817504883
r_  generation:  0.051164865493774414
local_output_nid generation:  0.006219387054443359
local_in_edges_tensor generation:  0.0035924911499023438
mini_batch_src_global generation:  0.0040476322174072266
r_  generation:  0.048562049865722656
local_output_nid generation:  0.006172657012939453
local_in_edges_tensor generation:  0.0033626556396484375
mini_batch_src_global generation:  0.005463600158691406
r_  generation:  0.049428701400756836
local_output_nid generation:  0.006292581558227539
local_in_edges_tensor generation:  0.003554821014404297
mini_batch_src_global generation:  0.004439592361450195
r_  generation:  0.05231618881225586
----------------------check_connections_block total spend ----------------------------- 0.6193556785583496
generate_one_block  0.06626677513122559
generate_one_block  0.06547880172729492
generate_one_block  0.06327319145202637
generate_one_block  0.06170344352722168
generate_one_block  0.0657048225402832
generate_one_block  0.06244778633117676
generate_one_block  0.07203936576843262
generate_one_block  0.06691288948059082
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03394961357116699
gen group dst list time:  0.017217397689819336
time for parepare:  0.021052122116088867
local_output_nid generation:  0.015537738800048828
local_in_edges_tensor generation:  0.04062628746032715
mini_batch_src_global generation:  0.03297114372253418
r_  generation:  0.32000136375427246
local_output_nid generation:  0.021037817001342773
local_in_edges_tensor generation:  0.027284860610961914
mini_batch_src_global generation:  0.040555477142333984
r_  generation:  0.34237027168273926
local_output_nid generation:  0.020762205123901367
local_in_edges_tensor generation:  0.021460533142089844
mini_batch_src_global generation:  0.038495779037475586
r_  generation:  0.33400440216064453
local_output_nid generation:  0.02061319351196289
local_in_edges_tensor generation:  0.022373199462890625
mini_batch_src_global generation:  0.03883862495422363
r_  generation:  0.3354918956756592
local_output_nid generation:  0.02077007293701172
local_in_edges_tensor generation:  0.02357196807861328
mini_batch_src_global generation:  0.04011845588684082
r_  generation:  0.34328675270080566
local_output_nid generation:  0.020509719848632812
local_in_edges_tensor generation:  0.02275681495666504
mini_batch_src_global generation:  0.040535926818847656
r_  generation:  0.34665369987487793
local_output_nid generation:  0.019541025161743164
local_in_edges_tensor generation:  0.02308821678161621
mini_batch_src_global generation:  0.04148149490356445
r_  generation:  0.34110379219055176
local_output_nid generation:  0.021290063858032227
local_in_edges_tensor generation:  0.021569252014160156
mini_batch_src_global generation:  0.04098773002624512
r_  generation:  0.3552722930908203
----------------------check_connections_block total spend ----------------------------- 3.9884462356567383
generate_one_block  0.44164323806762695
generate_one_block  0.43819499015808105
generate_one_block  0.4391961097717285
generate_one_block  0.4421370029449463
generate_one_block  0.43659043312072754
generate_one_block  0.4335453510284424
generate_one_block  0.43172669410705566
generate_one_block  0.46741414070129395
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03398752212524414
gen group dst list time:  0.03867220878601074
time for parepare:  0.01933598518371582
local_output_nid generation:  0.029452085494995117
local_in_edges_tensor generation:  0.05070924758911133
mini_batch_src_global generation:  0.04642605781555176
r_  generation:  0.49741458892822266
local_output_nid generation:  0.03882741928100586
local_in_edges_tensor generation:  0.04256129264831543
mini_batch_src_global generation:  0.05416297912597656
r_  generation:  0.48804640769958496
local_output_nid generation:  0.036978960037231445
local_in_edges_tensor generation:  0.035579681396484375
mini_batch_src_global generation:  0.05090761184692383
r_  generation:  0.5042598247528076
local_output_nid generation:  0.0372471809387207
local_in_edges_tensor generation:  0.0342259407043457
mini_batch_src_global generation:  0.0543515682220459
r_  generation:  0.49239182472229004
local_output_nid generation:  0.036763906478881836
local_in_edges_tensor generation:  0.03516888618469238
mini_batch_src_global generation:  0.05183744430541992
r_  generation:  0.5065310001373291
local_output_nid generation:  0.0366978645324707
local_in_edges_tensor generation:  0.03741049766540527
mini_batch_src_global generation:  0.05522346496582031
r_  generation:  0.5056536197662354
local_output_nid generation:  0.03696322441101074
local_in_edges_tensor generation:  0.037224531173706055
mini_batch_src_global generation:  0.05788612365722656
r_  generation:  0.5091438293457031
local_output_nid generation:  0.03710794448852539
local_in_edges_tensor generation:  0.03357124328613281
mini_batch_src_global generation:  0.054633140563964844
r_  generation:  0.5094485282897949
----------------------check_connections_block total spend ----------------------------- 5.92795991897583
generate_one_block  0.6378724575042725
generate_one_block  0.6304969787597656
generate_one_block  0.632030725479126
generate_one_block  0.6230401992797852
generate_one_block  0.6271777153015137
generate_one_block  0.6183679103851318
generate_one_block  0.6162605285644531
generate_one_block  0.620258092880249
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1332235336303711  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

connection checking time:  9.916406154632568
block generation total time  8.5359525680542
average batch blocks generation time:  1.066994071006775
block dataloader generation time/epoch 20.306190252304077
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1022496223449707  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9370026588439941  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10240507125854492  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9382534027099609  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10150814056396484  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.930936336517334  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10207271575927734  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9330472946166992  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10256338119506836  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9356265068054199  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10277080535888672  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9379692077636719  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10235023498535156  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9370341300964355  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1025857925415039  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9406919479370117  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08450573682785034 |0.016345202922821045 |0.003623276948928833 |9.498000144958496e-05 |0.0038148462772369385 |0.001641988754272461 |
----------------------------------------------------------pseudo_mini_loss sum 1.5547254085540771
Total (block generation + training)time/epoch 21.23929226398468
Training time/epoch 0.9361875057220459
Training time without block to device /epoch 0.8054258823394775
Training time without total dataloading part /epoch 0.06190681457519531
load block tensor time/epoch 0.6760458946228027
block to device time/epoch 0.13076162338256836
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  3016869
Number of first layer input nodes during this epoch:  1286216
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1333932876586914  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02515101432800293
random selection method range initialization spend 0.005739450454711914
time for parepare:  0.017255306243896484
local_output_nid generation:  0.004585742950439453
local_in_edges_tensor generation:  0.006521463394165039
mini_batch_src_global generation:  0.003505229949951172
r_  generation:  0.04305911064147949
local_output_nid generation:  0.005970954895019531
local_in_edges_tensor generation:  0.0033452510833740234
mini_batch_src_global generation:  0.005157470703125
r_  generation:  0.04616904258728027
local_output_nid generation:  0.006100654602050781
local_in_edges_tensor generation:  0.003380298614501953
mini_batch_src_global generation:  0.0036513805389404297
r_  generation:  0.04568839073181152
local_output_nid generation:  0.0061092376708984375
local_in_edges_tensor generation:  0.0033087730407714844
mini_batch_src_global generation:  0.003381967544555664
r_  generation:  0.046855926513671875
local_output_nid generation:  0.0061893463134765625
local_in_edges_tensor generation:  0.0034093856811523438
mini_batch_src_global generation:  0.003955364227294922
r_  generation:  0.04862332344055176
local_output_nid generation:  0.006085395812988281
local_in_edges_tensor generation:  0.003293752670288086
mini_batch_src_global generation:  0.004076719284057617
r_  generation:  0.0485990047454834
local_output_nid generation:  0.006096839904785156
local_in_edges_tensor generation:  0.0034432411193847656
mini_batch_src_global generation:  0.004283428192138672
r_  generation:  0.04979515075683594
local_output_nid generation:  0.006210803985595703
local_in_edges_tensor generation:  0.003440380096435547
mini_batch_src_global generation:  0.004054069519042969
r_  generation:  0.04843449592590332
----------------------check_connections_block total spend ----------------------------- 0.5945019721984863
generate_one_block  0.06265974044799805
generate_one_block  0.06257343292236328
generate_one_block  0.06093335151672363
generate_one_block  0.060775041580200195
generate_one_block  0.06269288063049316
generate_one_block  0.06210446357727051
generate_one_block  0.06670761108398438
generate_one_block  0.06177234649658203
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03297281265258789
gen group dst list time:  0.016074180603027344
time for parepare:  0.01931452751159668
local_output_nid generation:  0.015253305435180664
local_in_edges_tensor generation:  0.027512073516845703
mini_batch_src_global generation:  0.03256702423095703
r_  generation:  0.31602978706359863
local_output_nid generation:  0.02136397361755371
local_in_edges_tensor generation:  0.027160167694091797
mini_batch_src_global generation:  0.04086017608642578
r_  generation:  0.3368721008300781
local_output_nid generation:  0.02100515365600586
local_in_edges_tensor generation:  0.020514488220214844
mini_batch_src_global generation:  0.039058685302734375
r_  generation:  0.3325159549713135
local_output_nid generation:  0.02071070671081543
local_in_edges_tensor generation:  0.021704912185668945
mini_batch_src_global generation:  0.03904271125793457
r_  generation:  0.3377411365509033
local_output_nid generation:  0.021427631378173828
local_in_edges_tensor generation:  0.023381471633911133
mini_batch_src_global generation:  0.041327476501464844
r_  generation:  0.34693074226379395
local_output_nid generation:  0.020518064498901367
local_in_edges_tensor generation:  0.02066183090209961
mini_batch_src_global generation:  0.04340696334838867
r_  generation:  0.3406693935394287
local_output_nid generation:  0.01999187469482422
local_in_edges_tensor generation:  0.020623207092285156
mini_batch_src_global generation:  0.041718244552612305
r_  generation:  0.3483400344848633
local_output_nid generation:  0.01973247528076172
local_in_edges_tensor generation:  0.020580053329467773
mini_batch_src_global generation:  0.040709733963012695
r_  generation:  0.346280574798584
----------------------check_connections_block total spend ----------------------------- 3.9604034423828125
generate_one_block  0.4381890296936035
generate_one_block  0.44283366203308105
generate_one_block  0.4326636791229248
generate_one_block  0.4321575164794922
generate_one_block  0.44686102867126465
generate_one_block  0.4333512783050537
generate_one_block  0.4386866092681885
generate_one_block  0.46186327934265137
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03244805335998535
gen group dst list time:  0.039322853088378906
time for parepare:  0.020989656448364258
local_output_nid generation:  0.030182600021362305
local_in_edges_tensor generation:  0.04642677307128906
mini_batch_src_global generation:  0.04595613479614258
r_  generation:  0.48807549476623535
local_output_nid generation:  0.035889387130737305
local_in_edges_tensor generation:  0.04048800468444824
mini_batch_src_global generation:  0.05603790283203125
r_  generation:  0.49399638175964355
local_output_nid generation:  0.035936832427978516
local_in_edges_tensor generation:  0.040152788162231445
mini_batch_src_global generation:  0.05101633071899414
r_  generation:  0.5004398822784424
local_output_nid generation:  0.03591632843017578
local_in_edges_tensor generation:  0.033895015716552734
mini_batch_src_global generation:  0.05564475059509277
r_  generation:  0.48987603187561035
local_output_nid generation:  0.03586888313293457
local_in_edges_tensor generation:  0.04110527038574219
mini_batch_src_global generation:  0.06055569648742676
r_  generation:  0.5053248405456543
local_output_nid generation:  0.03605055809020996
local_in_edges_tensor generation:  0.03379964828491211
mini_batch_src_global generation:  0.06526780128479004
r_  generation:  0.5020558834075928
local_output_nid generation:  0.03853654861450195
local_in_edges_tensor generation:  0.03725242614746094
mini_batch_src_global generation:  0.05433201789855957
r_  generation:  0.5287585258483887
local_output_nid generation:  0.03768563270568848
local_in_edges_tensor generation:  0.03897738456726074
mini_batch_src_global generation:  0.05545830726623535
r_  generation:  0.5013794898986816
----------------------check_connections_block total spend ----------------------------- 5.957192659378052
generate_one_block  0.62322998046875
generate_one_block  0.6141815185546875
generate_one_block  0.6086604595184326
generate_one_block  0.6189846992492676
generate_one_block  0.6167895793914795
generate_one_block  0.6240315437316895
generate_one_block  0.6233487129211426
generate_one_block  0.6219291687011719
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1333932876586914  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

connection checking time:  9.917596101760864
block generation total time  8.47776174545288
average batch blocks generation time:  1.05972021818161
block dataloader generation time/epoch 20.343869129816692
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10159873962402344  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9351334571838379  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10238170623779297  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9402909278869629  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10216283798217773  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9329452514648438  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10247564315795898  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9347991943359375  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10274124145507812  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9397621154785156  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1018223762512207  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9370489120483398  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10268592834472656  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9407668113708496  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10224342346191406  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9360766410827637  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08017978072166443 |0.0147075355052948 |0.0034859180450439453 |9.292364120483398e-05 |0.0030831992626190186 |0.0018792152404785156 |
----------------------------------------------------------pseudo_mini_loss sum 1.5162200927734375
Total (block generation + training)time/epoch 21.26180370648702
Training time/epoch 0.8873372077941895
Training time without block to device /epoch 0.769676923751831
Training time without total dataloading part /epoch 0.0551755428314209
load block tensor time/epoch 0.6414382457733154
block to device time/epoch 0.1176602840423584
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  3021039
Number of first layer input nodes during this epoch:  1287258
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13327884674072266  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023043155670166016
random selection method range initialization spend 0.005776643753051758
time for parepare:  0.016955137252807617
local_output_nid generation:  0.004680633544921875
local_in_edges_tensor generation:  0.006994962692260742
mini_batch_src_global generation:  0.0032148361206054688
r_  generation:  0.043773651123046875
local_output_nid generation:  0.005953311920166016
local_in_edges_tensor generation:  0.0038099288940429688
mini_batch_src_global generation:  0.004962444305419922
r_  generation:  0.04499936103820801
local_output_nid generation:  0.006178140640258789
local_in_edges_tensor generation:  0.0041692256927490234
mini_batch_src_global generation:  0.003633737564086914
r_  generation:  0.04662442207336426
local_output_nid generation:  0.006190776824951172
local_in_edges_tensor generation:  0.0038764476776123047
mini_batch_src_global generation:  0.0036017894744873047
r_  generation:  0.04743051528930664
local_output_nid generation:  0.006120204925537109
local_in_edges_tensor generation:  0.0038242340087890625
mini_batch_src_global generation:  0.003976345062255859
r_  generation:  0.048413991928100586
local_output_nid generation:  0.0061419010162353516
local_in_edges_tensor generation:  0.0038869380950927734
mini_batch_src_global generation:  0.004117012023925781
r_  generation:  0.0485842227935791
local_output_nid generation:  0.006221771240234375
local_in_edges_tensor generation:  0.004160881042480469
mini_batch_src_global generation:  0.004357337951660156
r_  generation:  0.049344539642333984
local_output_nid generation:  0.006171703338623047
local_in_edges_tensor generation:  0.003827810287475586
mini_batch_src_global generation:  0.004304409027099609
r_  generation:  0.0493621826171875
----------------------check_connections_block total spend ----------------------------- 0.6034622192382812
generate_one_block  0.060517311096191406
generate_one_block  0.06050419807434082
generate_one_block  0.06108260154724121
generate_one_block  0.06210947036743164
generate_one_block  0.062476396560668945
generate_one_block  0.0611271858215332
generate_one_block  0.0657341480255127
generate_one_block  0.062398433685302734
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.035077571868896484
gen group dst list time:  0.015558719635009766
time for parepare:  0.019672155380249023
local_output_nid generation:  0.014739274978637695
local_in_edges_tensor generation:  0.027828693389892578
mini_batch_src_global generation:  0.033229827880859375
r_  generation:  0.32385897636413574
local_output_nid generation:  0.022249698638916016
local_in_edges_tensor generation:  0.02271580696105957
mini_batch_src_global generation:  0.04361867904663086
r_  generation:  0.3416872024536133
local_output_nid generation:  0.020748138427734375
local_in_edges_tensor generation:  0.020949125289916992
mini_batch_src_global generation:  0.04203963279724121
r_  generation:  0.3347482681274414
local_output_nid generation:  0.02072906494140625
local_in_edges_tensor generation:  0.023334741592407227
mini_batch_src_global generation:  0.03986787796020508
r_  generation:  0.34174680709838867
local_output_nid generation:  0.021297693252563477
local_in_edges_tensor generation:  0.022344112396240234
mini_batch_src_global generation:  0.04187178611755371
r_  generation:  0.3478081226348877
local_output_nid generation:  0.021214723587036133
local_in_edges_tensor generation:  0.020353078842163086
mini_batch_src_global generation:  0.04138827323913574
r_  generation:  0.3458230495452881
local_output_nid generation:  0.02032613754272461
local_in_edges_tensor generation:  0.02600383758544922
mini_batch_src_global generation:  0.04629683494567871
r_  generation:  0.34537267684936523
local_output_nid generation:  0.020057201385498047
local_in_edges_tensor generation:  0.022500276565551758
mini_batch_src_global generation:  0.04397892951965332
r_  generation:  0.35016655921936035
----------------------check_connections_block total spend ----------------------------- 4.009209632873535
generate_one_block  0.4295952320098877
generate_one_block  0.43791627883911133
generate_one_block  0.4366011619567871
generate_one_block  0.4380836486816406
generate_one_block  0.4354207515716553
generate_one_block  0.4345052242279053
generate_one_block  0.44059228897094727
generate_one_block  0.4664123058319092
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028780698776245117
gen group dst list time:  0.03937053680419922
time for parepare:  0.020117521286010742
local_output_nid generation:  0.030316591262817383
local_in_edges_tensor generation:  0.04881572723388672
mini_batch_src_global generation:  0.04639768600463867
r_  generation:  0.4830513000488281
local_output_nid generation:  0.03587770462036133
local_in_edges_tensor generation:  0.04249429702758789
mini_batch_src_global generation:  0.054238080978393555
r_  generation:  0.48383665084838867
local_output_nid generation:  0.03587031364440918
local_in_edges_tensor generation:  0.03792595863342285
mini_batch_src_global generation:  0.05035996437072754
r_  generation:  0.4950416088104248
local_output_nid generation:  0.035802364349365234
local_in_edges_tensor generation:  0.03367471694946289
mini_batch_src_global generation:  0.055043697357177734
r_  generation:  0.491619348526001
local_output_nid generation:  0.03645825386047363
local_in_edges_tensor generation:  0.03784966468811035
mini_batch_src_global generation:  0.052748680114746094
r_  generation:  0.508981466293335
local_output_nid generation:  0.036086082458496094
local_in_edges_tensor generation:  0.037642478942871094
mini_batch_src_global generation:  0.054618120193481445
r_  generation:  0.49886393547058105
local_output_nid generation:  0.036224365234375
local_in_edges_tensor generation:  0.03366255760192871
mini_batch_src_global generation:  0.05357837677001953
r_  generation:  0.5110065937042236
local_output_nid generation:  0.03640556335449219
local_in_edges_tensor generation:  0.03549528121948242
mini_batch_src_global generation:  0.05654597282409668
r_  generation:  0.4966917037963867
----------------------check_connections_block total spend ----------------------------- 5.8787007331848145
generate_one_block  0.6193423271179199
generate_one_block  0.619941234588623
generate_one_block  0.6236858367919922
generate_one_block  0.6137111186981201
generate_one_block  0.6202661991119385
generate_one_block  0.6105751991271973
generate_one_block  0.6151061058044434
generate_one_block  0.6169071197509766
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13327884674072266  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

connection checking time:  9.88791036605835
block generation total time  8.458662033081055
average batch blocks generation time:  1.0573327541351318
block dataloader generation time/epoch 20.350523829460144
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1024775505065918  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9347782135009766  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10268306732177734  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9367508888244629  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10247421264648438  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9358549118041992  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10256385803222656  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9388570785522461  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1018061637878418  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.937690258026123  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1020803451538086  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9359250068664551  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10264301300048828  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9373817443847656  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10227680206298828  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9378113746643066  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08051949739456177 |0.012100398540496826 |0.0034325718879699707 |9.292364120483398e-05 |0.003557264804840088 |0.0027923583984375 |
----------------------------------------------------------pseudo_mini_loss sum 1.4855684041976929
Total (block generation + training)time/epoch 21.25704598426819
Training time/epoch 0.8721053600311279
Training time without block to device /epoch 0.7753021717071533
Training time without total dataloading part /epoch 0.05945444107055664
load block tensor time/epoch 0.6441559791564941
block to device time/epoch 0.09680318832397461
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  3018317
Number of first layer input nodes during this epoch:  1286879
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13316917419433594  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02459239959716797
random selection method range initialization spend 0.005795001983642578
time for parepare:  0.017068147659301758
local_output_nid generation:  0.00458526611328125
local_in_edges_tensor generation:  0.00648188591003418
mini_batch_src_global generation:  0.0034744739532470703
r_  generation:  0.04213404655456543
local_output_nid generation:  0.005999565124511719
local_in_edges_tensor generation:  0.0033593177795410156
mini_batch_src_global generation:  0.005221128463745117
r_  generation:  0.04624056816101074
local_output_nid generation:  0.0060825347900390625
local_in_edges_tensor generation:  0.0032646656036376953
mini_batch_src_global generation:  0.003694772720336914
r_  generation:  0.04726719856262207
local_output_nid generation:  0.006147861480712891
local_in_edges_tensor generation:  0.00337982177734375
mini_batch_src_global generation:  0.0035941600799560547
r_  generation:  0.04701399803161621
local_output_nid generation:  0.006128072738647461
local_in_edges_tensor generation:  0.0033478736877441406
mini_batch_src_global generation:  0.0038559436798095703
r_  generation:  0.047144412994384766
local_output_nid generation:  0.006170511245727539
local_in_edges_tensor generation:  0.0032815933227539062
mini_batch_src_global generation:  0.004095792770385742
r_  generation:  0.048435211181640625
local_output_nid generation:  0.0061187744140625
local_in_edges_tensor generation:  0.0033130645751953125
mini_batch_src_global generation:  0.0042951107025146484
r_  generation:  0.049407958984375
local_output_nid generation:  0.006191253662109375
local_in_edges_tensor generation:  0.003408193588256836
mini_batch_src_global generation:  0.004288196563720703
r_  generation:  0.04925274848937988
----------------------check_connections_block total spend ----------------------------- 0.5943660736083984
generate_one_block  0.05849051475524902
generate_one_block  0.06174874305725098
generate_one_block  0.06231188774108887
generate_one_block  0.061434268951416016
generate_one_block  0.0610651969909668
generate_one_block  0.06205940246582031
generate_one_block  0.06662201881408691
generate_one_block  0.06264233589172363
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03208327293395996
gen group dst list time:  0.015846967697143555
time for parepare:  0.019282102584838867
local_output_nid generation:  0.014770030975341797
local_in_edges_tensor generation:  0.029112577438354492
mini_batch_src_global generation:  0.032562971115112305
r_  generation:  0.3196077346801758
local_output_nid generation:  0.020923376083374023
local_in_edges_tensor generation:  0.02577066421508789
mini_batch_src_global generation:  0.03986001014709473
r_  generation:  0.3429539203643799
local_output_nid generation:  0.02097153663635254
local_in_edges_tensor generation:  0.020447492599487305
mini_batch_src_global generation:  0.04100441932678223
r_  generation:  0.33818793296813965
local_output_nid generation:  0.020623445510864258
local_in_edges_tensor generation:  0.01973438262939453
mini_batch_src_global generation:  0.04003000259399414
r_  generation:  0.3379940986633301
local_output_nid generation:  0.02062082290649414
local_in_edges_tensor generation:  0.019376277923583984
mini_batch_src_global generation:  0.04098057746887207
r_  generation:  0.33585643768310547
local_output_nid generation:  0.020149707794189453
local_in_edges_tensor generation:  0.01945948600769043
mini_batch_src_global generation:  0.041116952896118164
r_  generation:  0.34057044982910156
local_output_nid generation:  0.019761323928833008
local_in_edges_tensor generation:  0.02114391326904297
mini_batch_src_global generation:  0.041909217834472656
r_  generation:  0.35065531730651855
local_output_nid generation:  0.019956350326538086
local_in_edges_tensor generation:  0.019685029983520508
mini_batch_src_global generation:  0.041344642639160156
r_  generation:  0.3400144577026367
----------------------check_connections_block total spend ----------------------------- 3.9480385780334473
generate_one_block  0.4180471897125244
generate_one_block  0.4357006549835205
generate_one_block  0.4364781379699707
generate_one_block  0.434725284576416
generate_one_block  0.4268803596496582
generate_one_block  0.43170666694641113
generate_one_block  0.4382932186126709
generate_one_block  0.4535796642303467
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.026457548141479492
gen group dst list time:  0.03882908821105957
time for parepare:  0.018688201904296875
local_output_nid generation:  0.029297590255737305
local_in_edges_tensor generation:  0.038767337799072266
mini_batch_src_global generation:  0.044045209884643555
r_  generation:  0.4784507751464844
local_output_nid generation:  0.03577280044555664
local_in_edges_tensor generation:  0.036097049713134766
mini_batch_src_global generation:  0.05975985527038574
r_  generation:  0.481778621673584
local_output_nid generation:  0.03567314147949219
local_in_edges_tensor generation:  0.0350499153137207
mini_batch_src_global generation:  0.05078482627868652
r_  generation:  0.4954969882965088
local_output_nid generation:  0.036376953125
local_in_edges_tensor generation:  0.03319835662841797
mini_batch_src_global generation:  0.0548403263092041
r_  generation:  0.5030453205108643
local_output_nid generation:  0.03582882881164551
local_in_edges_tensor generation:  0.04312610626220703
mini_batch_src_global generation:  0.053406715393066406
r_  generation:  0.5120909214019775
local_output_nid generation:  0.03619551658630371
local_in_edges_tensor generation:  0.032700538635253906
mini_batch_src_global generation:  0.05771827697753906
r_  generation:  0.4915940761566162
local_output_nid generation:  0.0359959602355957
local_in_edges_tensor generation:  0.035881757736206055
mini_batch_src_global generation:  0.053407907485961914
r_  generation:  0.5039234161376953
local_output_nid generation:  0.03578639030456543
local_in_edges_tensor generation:  0.0331273078918457
mini_batch_src_global generation:  0.056160926818847656
r_  generation:  0.4975094795227051
----------------------check_connections_block total spend ----------------------------- 5.852710247039795
generate_one_block  0.6095232963562012
generate_one_block  0.6172864437103271
generate_one_block  0.616879940032959
generate_one_block  0.620934247970581
generate_one_block  0.6141817569732666
generate_one_block  0.6131110191345215
generate_one_block  0.619124174118042
generate_one_block  0.6109974384307861
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13316917419433594  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

connection checking time:  9.800748825073242
block generation total time  8.397449493408203
average batch blocks generation time:  1.0496811866760254
block dataloader generation time/epoch 20.32098059654236
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10208988189697266  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9306931495666504  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10295963287353516  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9398956298828125  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10186100006103516  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.939934253692627  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10232019424438477  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9369125366210938  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10233068466186523  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9325566291809082  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10276508331298828  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9369664192199707  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1026468276977539  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9408359527587891  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10155630111694336  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9358811378479004  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.078116774559021 |0.013935834169387817 |0.0034518539905548096 |8.749961853027344e-05 |0.003087073564529419 |0.0017762184143066406 |
----------------------------------------------------------pseudo_mini_loss sum 1.453542947769165
Total (block generation + training)time/epoch 21.219030952453615
Training time/epoch 0.8639531135559082
Training time without block to device /epoch 0.7524664402008057
Training time without total dataloading part /epoch 0.054787635803222656
load block tensor time/epoch 0.624934196472168
block to device time/epoch 0.11148667335510254
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  3019096
Number of first layer input nodes during this epoch:  1287349
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13295602798461914  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024450063705444336
random selection method range initialization spend 0.0061376094818115234
time for parepare:  0.020058155059814453
local_output_nid generation:  0.004452943801879883
local_in_edges_tensor generation:  0.00720977783203125
mini_batch_src_global generation:  0.004085540771484375
r_  generation:  0.04646873474121094
local_output_nid generation:  0.006026029586791992
local_in_edges_tensor generation:  0.0035707950592041016
mini_batch_src_global generation:  0.0051422119140625
r_  generation:  0.04587411880493164
local_output_nid generation:  0.0061702728271484375
local_in_edges_tensor generation:  0.003342866897583008
mini_batch_src_global generation:  0.0036950111389160156
r_  generation:  0.04690885543823242
local_output_nid generation:  0.006147146224975586
local_in_edges_tensor generation:  0.003353595733642578
mini_batch_src_global generation:  0.0035865306854248047
r_  generation:  0.047039031982421875
local_output_nid generation:  0.006161928176879883
local_in_edges_tensor generation:  0.003309488296508789
mini_batch_src_global generation:  0.003869771957397461
r_  generation:  0.04766988754272461
local_output_nid generation:  0.006131649017333984
local_in_edges_tensor generation:  0.0032987594604492188
mini_batch_src_global generation:  0.004052639007568359
r_  generation:  0.049471378326416016
local_output_nid generation:  0.0062618255615234375
local_in_edges_tensor generation:  0.0033915042877197266
mini_batch_src_global generation:  0.004171133041381836
r_  generation:  0.04773569107055664
local_output_nid generation:  0.0062389373779296875
local_in_edges_tensor generation:  0.003262042999267578
mini_batch_src_global generation:  0.0041141510009765625
r_  generation:  0.04847240447998047
----------------------check_connections_block total spend ----------------------------- 0.6005818843841553
generate_one_block  0.059874773025512695
generate_one_block  0.061348676681518555
generate_one_block  0.062029123306274414
generate_one_block  0.0617671012878418
generate_one_block  0.061652183532714844
generate_one_block  0.06291508674621582
generate_one_block  0.06445527076721191
generate_one_block  0.06171989440917969
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0414423942565918
gen group dst list time:  0.015750885009765625
time for parepare:  0.021952390670776367
local_output_nid generation:  0.015152215957641602
local_in_edges_tensor generation:  0.03055548667907715
mini_batch_src_global generation:  0.031517982482910156
r_  generation:  0.3204026222229004
local_output_nid generation:  0.02086806297302246
local_in_edges_tensor generation:  0.024288415908813477
mini_batch_src_global generation:  0.03929710388183594
r_  generation:  0.33404970169067383
local_output_nid generation:  0.020906686782836914
local_in_edges_tensor generation:  0.021079540252685547
mini_batch_src_global generation:  0.03988337516784668
r_  generation:  0.338320255279541
local_output_nid generation:  0.020370960235595703
local_in_edges_tensor generation:  0.022324085235595703
mini_batch_src_global generation:  0.04018211364746094
r_  generation:  0.3380858898162842
local_output_nid generation:  0.02109241485595703
local_in_edges_tensor generation:  0.019618988037109375
mini_batch_src_global generation:  0.04097580909729004
r_  generation:  0.3397495746612549
local_output_nid generation:  0.020853281021118164
local_in_edges_tensor generation:  0.021040678024291992
mini_batch_src_global generation:  0.04177427291870117
r_  generation:  0.344754695892334
local_output_nid generation:  0.0198361873626709
local_in_edges_tensor generation:  0.02257370948791504
mini_batch_src_global generation:  0.04113936424255371
r_  generation:  0.34216737747192383
local_output_nid generation:  0.019457340240478516
local_in_edges_tensor generation:  0.02053666114807129
mini_batch_src_global generation:  0.04142141342163086
r_  generation:  0.3428201675415039
----------------------check_connections_block total spend ----------------------------- 3.950742721557617
generate_one_block  0.4332613945007324
generate_one_block  0.4284517765045166
generate_one_block  0.4378044605255127
generate_one_block  0.4485452175140381
generate_one_block  0.43007731437683105
generate_one_block  0.4383556842803955
generate_one_block  0.43142104148864746
generate_one_block  0.45961666107177734
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03187251091003418
gen group dst list time:  0.03933835029602051
time for parepare:  0.022125720977783203
local_output_nid generation:  0.031246423721313477
local_in_edges_tensor generation:  0.04506254196166992
mini_batch_src_global generation:  0.04359126091003418
r_  generation:  0.49208760261535645
local_output_nid generation:  0.036113739013671875
local_in_edges_tensor generation:  0.0399322509765625
mini_batch_src_global generation:  0.061490774154663086
r_  generation:  0.5102212429046631
local_output_nid generation:  0.039734601974487305
local_in_edges_tensor generation:  0.045584917068481445
mini_batch_src_global generation:  0.0625770092010498
r_  generation:  0.5118105411529541
local_output_nid generation:  0.03980827331542969
local_in_edges_tensor generation:  0.040766000747680664
mini_batch_src_global generation:  0.053986549377441406
r_  generation:  0.4913601875305176
local_output_nid generation:  0.03662562370300293
local_in_edges_tensor generation:  0.0333561897277832
mini_batch_src_global generation:  0.0529026985168457
r_  generation:  0.5044543743133545
local_output_nid generation:  0.03647923469543457
local_in_edges_tensor generation:  0.03669548034667969
mini_batch_src_global generation:  0.05554080009460449
r_  generation:  0.494779109954834
local_output_nid generation:  0.03682827949523926
local_in_edges_tensor generation:  0.035596609115600586
mini_batch_src_global generation:  0.05402803421020508
r_  generation:  0.5207390785217285
local_output_nid generation:  0.0367274284362793
local_in_edges_tensor generation:  0.035109519958496094
mini_batch_src_global generation:  0.05509543418884277
r_  generation:  0.5041830539703369
----------------------check_connections_block total spend ----------------------------- 5.981957912445068
generate_one_block  0.630220890045166
generate_one_block  0.6143906116485596
generate_one_block  0.6169061660766602
generate_one_block  0.6230709552764893
generate_one_block  0.6143019199371338
generate_one_block  0.6230616569519043
generate_one_block  0.6218593120574951
generate_one_block  0.6181583404541016
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13295602798461914  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

connection checking time:  9.932700634002686
block generation total time  8.469503402709961
average batch blocks generation time:  1.0586879253387451
block dataloader generation time/epoch 20.34425489107768
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10214996337890625  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.935732364654541  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10261678695678711  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9364070892333984  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10276460647583008  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9388875961303711  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10176944732666016  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9370903968811035  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1022806167602539  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9360933303833008  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10277414321899414  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9412212371826172  GigaBytes
Max Memory Allocated: 1.082202434539795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10162353515625  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9360380172729492  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1021113395690918  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9366583824157715  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08289816975593567 |0.0193651020526886 |0.005934953689575195 |9.706616401672363e-05 |0.00379788875579834 |0.0017349720001220703 |
----------------------------------------------------------pseudo_mini_loss sum 1.4280190467834473
Total (block generation + training)time/epoch 21.254733006159466
Training time/epoch 0.9724221229553223
Training time without block to device /epoch 0.8175013065338135
Training time without total dataloading part /epoch 0.08037424087524414
load block tensor time/epoch 0.6631853580474854
block to device time/epoch 0.1549208164215088
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  3019377
Number of first layer input nodes during this epoch:  1286820
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13287830352783203  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.029799461364746094
random selection method range initialization spend 0.005944967269897461
time for parepare:  0.01938009262084961
local_output_nid generation:  0.004439592361450195
local_in_edges_tensor generation:  0.009129762649536133
mini_batch_src_global generation:  0.004192829132080078
r_  generation:  0.043968915939331055
local_output_nid generation:  0.006068706512451172
local_in_edges_tensor generation:  0.0033142566680908203
mini_batch_src_global generation:  0.0050106048583984375
r_  generation:  0.045546770095825195
local_output_nid generation:  0.006172895431518555
local_in_edges_tensor generation:  0.003425121307373047
mini_batch_src_global generation:  0.0036020278930664062
r_  generation:  0.04713749885559082
local_output_nid generation:  0.0061566829681396484
local_in_edges_tensor generation:  0.0033593177795410156
mini_batch_src_global generation:  0.0035886764526367188
r_  generation:  0.04735612869262695
local_output_nid generation:  0.006228208541870117
local_in_edges_tensor generation:  0.0033736228942871094
mini_batch_src_global generation:  0.0039441585540771484
r_  generation:  0.0478365421295166
local_output_nid generation:  0.006195068359375
local_in_edges_tensor generation:  0.003349781036376953
mini_batch_src_global generation:  0.003951549530029297
r_  generation:  0.04811573028564453
local_output_nid generation:  0.006163597106933594
local_in_edges_tensor generation:  0.0033714771270751953
mini_batch_src_global generation:  0.004188060760498047
r_  generation:  0.0485689640045166
local_output_nid generation:  0.0062291622161865234
local_in_edges_tensor generation:  0.003354787826538086
mini_batch_src_global generation:  0.00408625602722168
r_  generation:  0.04857993125915527
----------------------check_connections_block total spend ----------------------------- 0.5999889373779297
generate_one_block  0.06083106994628906
generate_one_block  0.06103348731994629
generate_one_block  0.06195330619812012
generate_one_block  0.06151938438415527
generate_one_block  0.06200766563415527
generate_one_block  0.06164741516113281
generate_one_block  0.06601762771606445
generate_one_block  0.06226611137390137
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0370783805847168
gen group dst list time:  0.015709638595581055
time for parepare:  0.019465923309326172
local_output_nid generation:  0.015417098999023438
local_in_edges_tensor generation:  0.03223705291748047
mini_batch_src_global generation:  0.03353238105773926
r_  generation:  0.3210279941558838
local_output_nid generation:  0.02111506462097168
local_in_edges_tensor generation:  0.02527618408203125
mini_batch_src_global generation:  0.03958773612976074
r_  generation:  0.3395376205444336
local_output_nid generation:  0.0211637020111084
local_in_edges_tensor generation:  0.021767616271972656
mini_batch_src_global generation:  0.04275178909301758
r_  generation:  0.34441709518432617
local_output_nid generation:  0.020703554153442383
local_in_edges_tensor generation:  0.01987600326538086
mini_batch_src_global generation:  0.04015636444091797
r_  generation:  0.34218406677246094
local_output_nid generation:  0.021372556686401367
local_in_edges_tensor generation:  0.0194551944732666
mini_batch_src_global generation:  0.04226231575012207
r_  generation:  0.34146809577941895
local_output_nid generation:  0.020910263061523438
local_in_edges_tensor generation:  0.01993846893310547
mini_batch_src_global generation:  0.04138374328613281
r_  generation:  0.3412935733795166
local_output_nid generation:  0.019988298416137695
local_in_edges_tensor generation:  0.022847414016723633
mini_batch_src_global generation:  0.043426513671875
r_  generation:  0.34529566764831543
local_output_nid generation:  0.020273208618164062
local_in_edges_tensor generation:  0.019766569137573242
mini_batch_src_global generation:  0.041626930236816406
r_  generation:  0.3432800769805908
----------------------check_connections_block total spend ----------------------------- 3.981534719467163
generate_one_block  0.45754361152648926
generate_one_block  0.4445340633392334
generate_one_block  0.45159125328063965
generate_one_block  0.43306422233581543
generate_one_block  0.43229031562805176
generate_one_block  0.4358696937561035
generate_one_block  0.43639421463012695
generate_one_block  0.46425557136535645
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04002213478088379
gen group dst list time:  0.03888392448425293
time for parepare:  0.019855260848999023
local_output_nid generation:  0.030274629592895508
local_in_edges_tensor generation:  0.08069133758544922
mini_batch_src_global generation:  0.04467320442199707
r_  generation:  0.48435521125793457
local_output_nid generation:  0.03629493713378906
local_in_edges_tensor generation:  0.04297757148742676
mini_batch_src_global generation:  0.055739402770996094
r_  generation:  0.4974935054779053
local_output_nid generation:  0.03566122055053711
local_in_edges_tensor generation:  0.041983604431152344
mini_batch_src_global generation:  0.052730560302734375
r_  generation:  0.5010533332824707
local_output_nid generation:  0.03705644607543945
local_in_edges_tensor generation:  0.04916572570800781
mini_batch_src_global generation:  0.06539082527160645
r_  generation:  0.49204254150390625
local_output_nid generation:  0.038488149642944336
local_in_edges_tensor generation:  0.03774881362915039
mini_batch_src_global generation:  0.05301523208618164
r_  generation:  0.5026593208312988
local_output_nid generation:  0.037213802337646484
local_in_edges_tensor generation:  0.034693002700805664
mini_batch_src_global generation:  0.054209232330322266
r_  generation:  0.49433016777038574
local_output_nid generation:  0.037435293197631836
local_in_edges_tensor generation:  0.03588557243347168
mini_batch_src_global generation:  0.056105613708496094
r_  generation:  0.5050771236419678
local_output_nid generation:  0.03733205795288086
local_in_edges_tensor generation:  0.03685140609741211
mini_batch_src_global generation:  0.05494976043701172
r_  generation:  0.4998199939727783
----------------------check_connections_block total spend ----------------------------- 5.978621244430542
generate_one_block  0.6143381595611572
generate_one_block  0.6140210628509521
generate_one_block  0.6303637027740479
generate_one_block  0.6116154193878174
generate_one_block  0.6151716709136963
generate_one_block  0.6198315620422363
generate_one_block  0.620424747467041
generate_one_block  0.6222033500671387
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13287830352783203  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

connection checking time:  9.960155963897705
block generation total time  8.503512620925903
average batch blocks generation time:  1.062939077615738
block dataloader generation time/epoch 20.37907644680568
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1025533676147461  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9394841194152832  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10167407989501953  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9366459846496582  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1027517318725586  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9397773742675781  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10169124603271484  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9357147216796875  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10211038589477539  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9357109069824219  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.102447509765625  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9348254203796387  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10269880294799805  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9371471405029297  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10240793228149414  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.937218189239502  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08386275172233582 |0.022514283657073975 |0.0035314857959747314 |9.632110595703125e-05 |0.003765583038330078 |0.002802133560180664 |
----------------------------------------------------------pseudo_mini_loss sum 1.3975427150726318
Total (block generation + training)time/epoch 21.299984795706614
Training time/epoch 0.983299970626831
Training time without block to device /epoch 0.8031857013702393
Training time without total dataloading part /epoch 0.06194925308227539
load block tensor time/epoch 0.6709020137786865
block to device time/epoch 0.1801142692565918
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  3019605
Number of first layer input nodes during this epoch:  1287144
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1333179473876953  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02729630470275879
random selection method range initialization spend 0.0056993961334228516
time for parepare:  0.018677949905395508
local_output_nid generation:  0.004524946212768555
local_in_edges_tensor generation:  0.006432771682739258
mini_batch_src_global generation:  0.004103660583496094
r_  generation:  0.043457984924316406
local_output_nid generation:  0.005985736846923828
local_in_edges_tensor generation:  0.003192901611328125
mini_batch_src_global generation:  0.005143404006958008
r_  generation:  0.04558849334716797
local_output_nid generation:  0.006133317947387695
local_in_edges_tensor generation:  0.0034399032592773438
mini_batch_src_global generation:  0.003648042678833008
r_  generation:  0.04638671875
local_output_nid generation:  0.006144285202026367
local_in_edges_tensor generation:  0.0034172534942626953
mini_batch_src_global generation:  0.0035750865936279297
r_  generation:  0.04756426811218262
local_output_nid generation:  0.006077289581298828
local_in_edges_tensor generation:  0.003285646438598633
mini_batch_src_global generation:  0.004032611846923828
r_  generation:  0.04993772506713867
local_output_nid generation:  0.00618290901184082
local_in_edges_tensor generation:  0.0033288002014160156
mini_batch_src_global generation:  0.004049062728881836
r_  generation:  0.04913449287414551
local_output_nid generation:  0.006147146224975586
local_in_edges_tensor generation:  0.0033304691314697266
mini_batch_src_global generation:  0.004229068756103516
r_  generation:  0.047452688217163086
local_output_nid generation:  0.006088972091674805
local_in_edges_tensor generation:  0.0033464431762695312
mini_batch_src_global generation:  0.004303455352783203
r_  generation:  0.0486302375793457
----------------------check_connections_block total spend ----------------------------- 0.5991525650024414
generate_one_block  0.06763291358947754
generate_one_block  0.0620875358581543
generate_one_block  0.06147909164428711
generate_one_block  0.06202292442321777
generate_one_block  0.06213712692260742
generate_one_block  0.06255769729614258
generate_one_block  0.06463313102722168
generate_one_block  0.06177926063537598
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03259158134460449
gen group dst list time:  0.015622377395629883
time for parepare:  0.019724369049072266
local_output_nid generation:  0.015364885330200195
local_in_edges_tensor generation:  0.03180098533630371
mini_batch_src_global generation:  0.03239703178405762
r_  generation:  0.3160860538482666
local_output_nid generation:  0.021210670471191406
local_in_edges_tensor generation:  0.021095752716064453
mini_batch_src_global generation:  0.03954339027404785
r_  generation:  0.34062886238098145
local_output_nid generation:  0.020964384078979492
local_in_edges_tensor generation:  0.0225675106048584
mini_batch_src_global generation:  0.03932905197143555
r_  generation:  0.3410964012145996
local_output_nid generation:  0.021457910537719727
local_in_edges_tensor generation:  0.027134418487548828
mini_batch_src_global generation:  0.0415651798248291
r_  generation:  0.34408092498779297
local_output_nid generation:  0.021358251571655273
local_in_edges_tensor generation:  0.0229184627532959
mini_batch_src_global generation:  0.04495525360107422
r_  generation:  0.357332706451416
local_output_nid generation:  0.020762205123901367
local_in_edges_tensor generation:  0.027673006057739258
mini_batch_src_global generation:  0.04387021064758301
r_  generation:  0.3683452606201172
local_output_nid generation:  0.022196054458618164
local_in_edges_tensor generation:  0.020080089569091797
mini_batch_src_global generation:  0.042311668395996094
r_  generation:  0.33918023109436035
local_output_nid generation:  0.020462989807128906
local_in_edges_tensor generation:  0.019902944564819336
mini_batch_src_global generation:  0.04160928726196289
r_  generation:  0.34415388107299805
----------------------check_connections_block total spend ----------------------------- 4.032999038696289
generate_one_block  0.42687487602233887
generate_one_block  0.43660807609558105
generate_one_block  0.4374275207519531
generate_one_block  0.43468761444091797
generate_one_block  0.4371349811553955
generate_one_block  0.44030094146728516
generate_one_block  0.44373130798339844
generate_one_block  0.4662356376647949
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.034857749938964844
gen group dst list time:  0.03851652145385742
time for parepare:  0.021613121032714844
local_output_nid generation:  0.03005194664001465
local_in_edges_tensor generation:  0.05320262908935547
mini_batch_src_global generation:  0.04644036293029785
r_  generation:  0.4814941883087158
local_output_nid generation:  0.03726458549499512
local_in_edges_tensor generation:  0.04430222511291504
mini_batch_src_global generation:  0.054248809814453125
r_  generation:  0.4903702735900879
local_output_nid generation:  0.035887956619262695
local_in_edges_tensor generation:  0.038446903228759766
mini_batch_src_global generation:  0.05073118209838867
r_  generation:  0.5036630630493164
local_output_nid generation:  0.036530494689941406
local_in_edges_tensor generation:  0.03887939453125
mini_batch_src_global generation:  0.06194424629211426
r_  generation:  0.4968268871307373
local_output_nid generation:  0.036479949951171875
local_in_edges_tensor generation:  0.04243969917297363
mini_batch_src_global generation:  0.05277562141418457
r_  generation:  0.5299124717712402
local_output_nid generation:  0.0393366813659668
local_in_edges_tensor generation:  0.037508249282836914
mini_batch_src_global generation:  0.059316158294677734
r_  generation:  0.49527621269226074
local_output_nid generation:  0.03690457344055176
local_in_edges_tensor generation:  0.03358006477355957
mini_batch_src_global generation:  0.05377602577209473
r_  generation:  0.5090408325195312
local_output_nid generation:  0.03706812858581543
local_in_edges_tensor generation:  0.0357508659362793
mini_batch_src_global generation:  0.05781364440917969
r_  generation:  0.5018868446350098
----------------------check_connections_block total spend ----------------------------- 5.962697267532349
generate_one_block  0.6335930824279785
generate_one_block  0.6103358268737793
generate_one_block  0.6138384342193604
generate_one_block  0.6205892562866211
generate_one_block  0.6296272277832031
generate_one_block  0.6135292053222656
generate_one_block  0.6094892024993896
generate_one_block  0.6140236854553223
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1333179473876953  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

connection checking time:  9.995696306228638
block generation total time  8.468026876449585
average batch blocks generation time:  1.0585033595561981
block dataloader generation time/epoch 20.397160232067108
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10233736038208008  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9350285530090332  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10277605056762695  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9404592514038086  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10167169570922852  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9363346099853516  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1022500991821289  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9365358352661133  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1026296615600586  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9377355575561523  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1022191047668457  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9373083114624023  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1023855209350586  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9332427978515625  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10280370712280273  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9392118453979492  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0841013491153717 |0.015582293272018433 |0.003801107406616211 |9.620189666748047e-05 |0.003762185573577881 |0.0012960433959960938 |
----------------------------------------------------------pseudo_mini_loss sum 1.369673252105713
Total (block generation + training)time/epoch 21.31944113969803
Training time/epoch 0.931704044342041
Training time without block to device /epoch 0.8070456981658936
Training time without total dataloading part /epoch 0.06257200241088867
load block tensor time/epoch 0.6728107929229736
block to device time/epoch 0.12465834617614746
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  3020071
Number of first layer input nodes during this epoch:  1287552
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13324975967407227  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02504754066467285
random selection method range initialization spend 0.005372762680053711
time for parepare:  0.018423795700073242
local_output_nid generation:  0.004416227340698242
local_in_edges_tensor generation:  0.01000213623046875
mini_batch_src_global generation:  0.003608226776123047
r_  generation:  0.04571247100830078
local_output_nid generation:  0.006022453308105469
local_in_edges_tensor generation:  0.0033168792724609375
mini_batch_src_global generation:  0.005175590515136719
r_  generation:  0.0447077751159668
local_output_nid generation:  0.006142616271972656
local_in_edges_tensor generation:  0.0034356117248535156
mini_batch_src_global generation:  0.0037758350372314453
r_  generation:  0.04753756523132324
local_output_nid generation:  0.006209373474121094
local_in_edges_tensor generation:  0.003299713134765625
mini_batch_src_global generation:  0.003713369369506836
r_  generation:  0.047067880630493164
local_output_nid generation:  0.0061187744140625
local_in_edges_tensor generation:  0.003362417221069336
mini_batch_src_global generation:  0.003952980041503906
r_  generation:  0.048090457916259766
local_output_nid generation:  0.006145477294921875
local_in_edges_tensor generation:  0.0034177303314208984
mini_batch_src_global generation:  0.005537509918212891
r_  generation:  0.04863166809082031
local_output_nid generation:  0.0061130523681640625
local_in_edges_tensor generation:  0.003395557403564453
mini_batch_src_global generation:  0.004271507263183594
r_  generation:  0.04883718490600586
local_output_nid generation:  0.00614166259765625
local_in_edges_tensor generation:  0.003478527069091797
mini_batch_src_global generation:  0.004258155822753906
r_  generation:  0.04870319366455078
----------------------check_connections_block total spend ----------------------------- 0.6037087440490723
generate_one_block  0.06091809272766113
generate_one_block  0.06080031394958496
generate_one_block  0.061438798904418945
generate_one_block  0.06126260757446289
generate_one_block  0.06114482879638672
generate_one_block  0.06284332275390625
generate_one_block  0.06544661521911621
generate_one_block  0.06278419494628906
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.036975860595703125
gen group dst list time:  0.01571035385131836
time for parepare:  0.019631147384643555
local_output_nid generation:  0.01654505729675293
local_in_edges_tensor generation:  0.032106637954711914
mini_batch_src_global generation:  0.03406262397766113
r_  generation:  0.32912588119506836
local_output_nid generation:  0.020958423614501953
local_in_edges_tensor generation:  0.023278236389160156
mini_batch_src_global generation:  0.039597511291503906
r_  generation:  0.3356623649597168
local_output_nid generation:  0.020860910415649414
local_in_edges_tensor generation:  0.02538323402404785
mini_batch_src_global generation:  0.03965353965759277
r_  generation:  0.3414773941040039
local_output_nid generation:  0.02058243751525879
local_in_edges_tensor generation:  0.019576311111450195
mini_batch_src_global generation:  0.03969740867614746
r_  generation:  0.3393869400024414
local_output_nid generation:  0.02154397964477539
local_in_edges_tensor generation:  0.02341914176940918
mini_batch_src_global generation:  0.0436406135559082
r_  generation:  0.343731164932251
local_output_nid generation:  0.02089405059814453
local_in_edges_tensor generation:  0.02263021469116211
mini_batch_src_global generation:  0.04143404960632324
r_  generation:  0.3452169895172119
local_output_nid generation:  0.019499778747558594
local_in_edges_tensor generation:  0.021654605865478516
mini_batch_src_global generation:  0.04120469093322754
r_  generation:  0.35854387283325195
local_output_nid generation:  0.022240877151489258
local_in_edges_tensor generation:  0.020535945892333984
mini_batch_src_global generation:  0.04222869873046875
r_  generation:  0.34309887886047363
----------------------check_connections_block total spend ----------------------------- 4.003238916397095
generate_one_block  0.4374220371246338
generate_one_block  0.43350791931152344
generate_one_block  0.4388234615325928
generate_one_block  0.43040990829467773
generate_one_block  0.4236569404602051
generate_one_block  0.4361085891723633
generate_one_block  0.43119239807128906
generate_one_block  0.4592454433441162
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03445577621459961
gen group dst list time:  0.03836345672607422
time for parepare:  0.019495725631713867
local_output_nid generation:  0.029430627822875977
local_in_edges_tensor generation:  0.05357813835144043
mini_batch_src_global generation:  0.04501748085021973
r_  generation:  0.4857151508331299
local_output_nid generation:  0.036208152770996094
local_in_edges_tensor generation:  0.0381319522857666
mini_batch_src_global generation:  0.054894208908081055
r_  generation:  0.48711490631103516
local_output_nid generation:  0.0356135368347168
local_in_edges_tensor generation:  0.03516268730163574
mini_batch_src_global generation:  0.051036834716796875
r_  generation:  0.5003066062927246
local_output_nid generation:  0.03606247901916504
local_in_edges_tensor generation:  0.037564754486083984
mini_batch_src_global generation:  0.05404305458068848
r_  generation:  0.4907369613647461
local_output_nid generation:  0.03634333610534668
local_in_edges_tensor generation:  0.03266429901123047
mini_batch_src_global generation:  0.05282878875732422
r_  generation:  0.5072953701019287
local_output_nid generation:  0.03744649887084961
local_in_edges_tensor generation:  0.03432440757751465
mini_batch_src_global generation:  0.05545520782470703
r_  generation:  0.4937453269958496
local_output_nid generation:  0.035668373107910156
local_in_edges_tensor generation:  0.03779959678649902
mini_batch_src_global generation:  0.05314183235168457
r_  generation:  0.5063858032226562
local_output_nid generation:  0.035724639892578125
local_in_edges_tensor generation:  0.031983137130737305
mini_batch_src_global generation:  0.05767560005187988
r_  generation:  0.4951951503753662
----------------------check_connections_block total spend ----------------------------- 5.862971782684326
generate_one_block  0.61448073387146
generate_one_block  0.6118793487548828
generate_one_block  0.6125102043151855
generate_one_block  0.6115198135375977
generate_one_block  0.6144492626190186
generate_one_block  0.6122331619262695
generate_one_block  0.611842155456543
generate_one_block  0.6170897483825684
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13324975967407227  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

connection checking time:  9.866210699081421
block generation total time  8.396371126174927
average batch blocks generation time:  1.0495463907718658
block dataloader generation time/epoch 20.387389447953964
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10194730758666992  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9447989463806152  GigaBytes
Max Memory Allocated: 1.0824885368347168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10219907760620117  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9356327056884766  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10257482528686523  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9374899864196777  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10219430923461914  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9364972114562988  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10241365432739258  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9349684715270996  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10268831253051758  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9394245147705078  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10156869888305664  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9335269927978516  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10213136672973633  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9367704391479492  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07705962657928467 |0.012105822563171387 |0.006183326244354248 |9.423494338989258e-05 |0.0033123791217803955 |0.0030393600463867188 |
----------------------------------------------------------pseudo_mini_loss sum 1.3489842414855957
Total (block generation + training)time/epoch 21.303411616219414
Training time/epoch 0.8656723499298096
Training time without block to device /epoch 0.7688257694244385
Training time without total dataloading part /epoch 0.07975888252258301
load block tensor time/epoch 0.6164770126342773
block to device time/epoch 0.0968465805053711
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  3019366
Number of first layer input nodes during this epoch:  1286648
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1328597068786621  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020120620727539062
random selection method range initialization spend 0.005400419235229492
time for parepare:  0.017407655715942383
local_output_nid generation:  0.00457000732421875
local_in_edges_tensor generation:  0.005757808685302734
mini_batch_src_global generation:  0.0033118724822998047
r_  generation:  0.04314064979553223
local_output_nid generation:  0.00596308708190918
local_in_edges_tensor generation:  0.003339052200317383
mini_batch_src_global generation:  0.004866600036621094
r_  generation:  0.04420304298400879
local_output_nid generation:  0.006105184555053711
local_in_edges_tensor generation:  0.0035126209259033203
mini_batch_src_global generation:  0.0036363601684570312
r_  generation:  0.046488285064697266
local_output_nid generation:  0.006209611892700195
local_in_edges_tensor generation:  0.0033609867095947266
mini_batch_src_global generation:  0.0035762786865234375
r_  generation:  0.04717612266540527
local_output_nid generation:  0.006173610687255859
local_in_edges_tensor generation:  0.0033016204833984375
mini_batch_src_global generation:  0.0038726329803466797
r_  generation:  0.04729509353637695
local_output_nid generation:  0.006176471710205078
local_in_edges_tensor generation:  0.0033876895904541016
mini_batch_src_global generation:  0.0040514469146728516
r_  generation:  0.04969215393066406
local_output_nid generation:  0.0060808658599853516
local_in_edges_tensor generation:  0.0034325122833251953
mini_batch_src_global generation:  0.00421142578125
r_  generation:  0.04813575744628906
local_output_nid generation:  0.0061452388763427734
local_in_edges_tensor generation:  0.0034143924713134766
mini_batch_src_global generation:  0.004129648208618164
r_  generation:  0.04963994026184082
----------------------check_connections_block total spend ----------------------------- 0.5920274257659912
generate_one_block  0.05982518196105957
generate_one_block  0.06063199043273926
generate_one_block  0.06221914291381836
generate_one_block  0.061634063720703125
generate_one_block  0.06113696098327637
generate_one_block  0.06348371505737305
generate_one_block  0.06683731079101562
generate_one_block  0.06329154968261719
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03209567070007324
gen group dst list time:  0.015766382217407227
time for parepare:  0.019315242767333984
local_output_nid generation:  0.014754533767700195
local_in_edges_tensor generation:  0.026256799697875977
mini_batch_src_global generation:  0.03165006637573242
r_  generation:  0.31473231315612793
local_output_nid generation:  0.0208282470703125
local_in_edges_tensor generation:  0.025127172470092773
mini_batch_src_global generation:  0.03873562812805176
r_  generation:  0.32767367362976074
local_output_nid generation:  0.020908832550048828
local_in_edges_tensor generation:  0.022517919540405273
mini_batch_src_global generation:  0.038751840591430664
r_  generation:  0.3360118865966797
local_output_nid generation:  0.02318549156188965
local_in_edges_tensor generation:  0.020277976989746094
mini_batch_src_global generation:  0.039494991302490234
r_  generation:  0.3379018306732178
local_output_nid generation:  0.020965099334716797
local_in_edges_tensor generation:  0.019728422164916992
mini_batch_src_global generation:  0.040375471115112305
r_  generation:  0.33750128746032715
local_output_nid generation:  0.02093982696533203
local_in_edges_tensor generation:  0.020245790481567383
mini_batch_src_global generation:  0.04189872741699219
r_  generation:  0.3473796844482422
local_output_nid generation:  0.01950812339782715
local_in_edges_tensor generation:  0.01949453353881836
mini_batch_src_global generation:  0.04098391532897949
r_  generation:  0.34096217155456543
local_output_nid generation:  0.019791603088378906
local_in_edges_tensor generation:  0.021067380905151367
mini_batch_src_global generation:  0.04234480857849121
r_  generation:  0.3439028263092041
----------------------check_connections_block total spend ----------------------------- 3.9271950721740723
generate_one_block  0.42375993728637695
generate_one_block  0.4292275905609131
generate_one_block  0.4355349540710449
generate_one_block  0.432570219039917
generate_one_block  0.42530107498168945
generate_one_block  0.4427366256713867
generate_one_block  0.4263632297515869
generate_one_block  0.4640939235687256
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030976533889770508
gen group dst list time:  0.038916826248168945
time for parepare:  0.019210338592529297
local_output_nid generation:  0.029704809188842773
local_in_edges_tensor generation:  0.04326152801513672
mini_batch_src_global generation:  0.04665803909301758
r_  generation:  0.4814283847808838
local_output_nid generation:  0.03585624694824219
local_in_edges_tensor generation:  0.03907179832458496
mini_batch_src_global generation:  0.05531740188598633
r_  generation:  0.4846181869506836
local_output_nid generation:  0.03580045700073242
local_in_edges_tensor generation:  0.03724837303161621
mini_batch_src_global generation:  0.05081892013549805
r_  generation:  0.5005979537963867
local_output_nid generation:  0.03623509407043457
local_in_edges_tensor generation:  0.03998160362243652
mini_batch_src_global generation:  0.053674936294555664
r_  generation:  0.49109554290771484
local_output_nid generation:  0.03602409362792969
local_in_edges_tensor generation:  0.035123586654663086
mini_batch_src_global generation:  0.05279898643493652
r_  generation:  0.5052297115325928
local_output_nid generation:  0.035820960998535156
local_in_edges_tensor generation:  0.035704612731933594
mini_batch_src_global generation:  0.05495095252990723
r_  generation:  0.4916656017303467
local_output_nid generation:  0.03577923774719238
local_in_edges_tensor generation:  0.03325986862182617
mini_batch_src_global generation:  0.05372047424316406
r_  generation:  0.5068457126617432
local_output_nid generation:  0.03568434715270996
local_in_edges_tensor generation:  0.032507896423339844
mini_batch_src_global generation:  0.05816531181335449
r_  generation:  0.5010051727294922
----------------------check_connections_block total spend ----------------------------- 5.8540449142456055
generate_one_block  0.622114896774292
generate_one_block  0.6385185718536377
generate_one_block  0.6201026439666748
generate_one_block  0.6238803863525391
generate_one_block  0.6124742031097412
generate_one_block  0.619269847869873
generate_one_block  0.6152112483978271
generate_one_block  0.6158461570739746
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1328597068786621  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

connection checking time:  9.781239986419678
block generation total time  8.4470055103302
average batch blocks generation time:  1.055875688791275
block dataloader generation time/epoch 20.370738172531127
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10243368148803711  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.934990406036377  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10264062881469727  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9366765022277832  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1026010513305664  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9372096061706543  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10253620147705078  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9373922348022461  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10239744186401367  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9352254867553711  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10277175903320312  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9411520957946777  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10162544250488281  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9358229637145996  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10226678848266602  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9386916160583496  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08439871668815613 |0.015389680862426758 |0.0035052597522735596 |8.913874626159668e-05 |0.0037286579608917236 |0.0014958381652832031 |
----------------------------------------------------------pseudo_mini_loss sum 1.3380945920944214
Total (block generation + training)time/epoch 21.288244462013246
Training time/epoch 0.930598258972168
Training time without block to device /epoch 0.8074808120727539
Training time without total dataloading part /epoch 0.06008028984069824
load block tensor time/epoch 0.675189733505249
block to device time/epoch 0.12311744689941406
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  3021041
Number of first layer input nodes during this epoch:  1287724
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13304424285888672  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02112269401550293
random selection method range initialization spend 0.005368709564208984
time for parepare:  0.018679141998291016
local_output_nid generation:  0.004564762115478516
local_in_edges_tensor generation:  0.009822368621826172
mini_batch_src_global generation:  0.003542661666870117
r_  generation:  0.044657230377197266
local_output_nid generation:  0.006089925765991211
local_in_edges_tensor generation:  0.003336668014526367
mini_batch_src_global generation:  0.005114316940307617
r_  generation:  0.045807838439941406
local_output_nid generation:  0.006100654602050781
local_in_edges_tensor generation:  0.0033600330352783203
mini_batch_src_global generation:  0.0034804344177246094
r_  generation:  0.04658627510070801
local_output_nid generation:  0.006175518035888672
local_in_edges_tensor generation:  0.0034444332122802734
mini_batch_src_global generation:  0.003741025924682617
r_  generation:  0.04799532890319824
local_output_nid generation:  0.0061490535736083984
local_in_edges_tensor generation:  0.003390073776245117
mini_batch_src_global generation:  0.00388336181640625
r_  generation:  0.047733306884765625
local_output_nid generation:  0.006198406219482422
local_in_edges_tensor generation:  0.0033729076385498047
mini_batch_src_global generation:  0.004154205322265625
r_  generation:  0.04821133613586426
local_output_nid generation:  0.006155490875244141
local_in_edges_tensor generation:  0.0033719539642333984
mini_batch_src_global generation:  0.0040111541748046875
r_  generation:  0.04838705062866211
local_output_nid generation:  0.006165027618408203
local_in_edges_tensor generation:  0.003348827362060547
mini_batch_src_global generation:  0.004071950912475586
r_  generation:  0.048451900482177734
----------------------check_connections_block total spend ----------------------------- 0.5996866226196289
generate_one_block  0.06060147285461426
generate_one_block  0.0621337890625
generate_one_block  0.06143045425415039
generate_one_block  0.06247377395629883
generate_one_block  0.06212639808654785
generate_one_block  0.06525921821594238
generate_one_block  0.06517386436462402
generate_one_block  0.06203651428222656
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03604459762573242
gen group dst list time:  0.015935420989990234
time for parepare:  0.019474029541015625
local_output_nid generation:  0.015055656433105469
local_in_edges_tensor generation:  0.02732253074645996
mini_batch_src_global generation:  0.032155752182006836
r_  generation:  0.3214700222015381
local_output_nid generation:  0.021190404891967773
local_in_edges_tensor generation:  0.02431797981262207
mini_batch_src_global generation:  0.03960061073303223
r_  generation:  0.3352370262145996
local_output_nid generation:  0.022416114807128906
local_in_edges_tensor generation:  0.021064043045043945
mini_batch_src_global generation:  0.0397791862487793
r_  generation:  0.33500075340270996
local_output_nid generation:  0.020981788635253906
local_in_edges_tensor generation:  0.01994919776916504
mini_batch_src_global generation:  0.03980898857116699
r_  generation:  0.33917808532714844
local_output_nid generation:  0.0209047794342041
local_in_edges_tensor generation:  0.019550085067749023
mini_batch_src_global generation:  0.041090965270996094
r_  generation:  0.3351109027862549
local_output_nid generation:  0.020538806915283203
local_in_edges_tensor generation:  0.019205093383789062
mini_batch_src_global generation:  0.040425777435302734
r_  generation:  0.3395066261291504
local_output_nid generation:  0.019610166549682617
local_in_edges_tensor generation:  0.0202486515045166
mini_batch_src_global generation:  0.04113578796386719
r_  generation:  0.3418107032775879
local_output_nid generation:  0.019567251205444336
local_in_edges_tensor generation:  0.01934361457824707
mini_batch_src_global generation:  0.04038643836975098
r_  generation:  0.33670949935913086
----------------------check_connections_block total spend ----------------------------- 3.9232873916625977
generate_one_block  0.4316377639770508
generate_one_block  0.4374051094055176
generate_one_block  0.42916297912597656
generate_one_block  0.434323787689209
generate_one_block  0.4283742904663086
generate_one_block  0.43262290954589844
generate_one_block  0.43259429931640625
generate_one_block  0.45241618156433105
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02723217010498047
gen group dst list time:  0.03866243362426758
time for parepare:  0.018891572952270508
local_output_nid generation:  0.029734134674072266
local_in_edges_tensor generation:  0.0393826961517334
mini_batch_src_global generation:  0.04372072219848633
r_  generation:  0.48230791091918945
local_output_nid generation:  0.03559136390686035
local_in_edges_tensor generation:  0.03468132019042969
mini_batch_src_global generation:  0.05393648147583008
r_  generation:  0.4823615550994873
local_output_nid generation:  0.035674333572387695
local_in_edges_tensor generation:  0.03268885612487793
mini_batch_src_global generation:  0.05086636543273926
r_  generation:  0.495619535446167
local_output_nid generation:  0.03591609001159668
local_in_edges_tensor generation:  0.03897500038146973
mini_batch_src_global generation:  0.053185224533081055
r_  generation:  0.49190211296081543
local_output_nid generation:  0.03588366508483887
local_in_edges_tensor generation:  0.03315234184265137
mini_batch_src_global generation:  0.052387237548828125
r_  generation:  0.49886560440063477
local_output_nid generation:  0.035746097564697266
local_in_edges_tensor generation:  0.03209638595581055
mini_batch_src_global generation:  0.05420207977294922
r_  generation:  0.49053311347961426
local_output_nid generation:  0.03609323501586914
local_in_edges_tensor generation:  0.034581661224365234
mini_batch_src_global generation:  0.05565237998962402
r_  generation:  0.5071725845336914
local_output_nid generation:  0.03601479530334473
local_in_edges_tensor generation:  0.03327012062072754
mini_batch_src_global generation:  0.05489182472229004
r_  generation:  0.49571776390075684
----------------------check_connections_block total spend ----------------------------- 5.81303596496582
generate_one_block  0.608149528503418
generate_one_block  0.6114914417266846
generate_one_block  0.609915018081665
generate_one_block  0.6122844219207764
generate_one_block  0.6105513572692871
generate_one_block  0.6104180812835693
generate_one_block  0.6261975765228271
generate_one_block  0.6188645362854004
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13304424285888672  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

connection checking time:  9.736323356628418
block generation total time  8.386409282684326
average batch blocks generation time:  1.0483011603355408
block dataloader generation time/epoch 20.34865834496238
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10253000259399414  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9389119148254395  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1018209457397461  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.937589168548584  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10224771499633789  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9376144409179688  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10262060165405273  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9387712478637695  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10166168212890625  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9356493949890137  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10222005844116211  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9357662200927734  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10260629653930664  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9371190071105957  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1023869514465332  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9361939430236816  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08316776156425476 |0.012025117874145508 |0.0034863948822021484 |9.369850158691406e-05 |0.0037703216075897217 |0.0028319358825683594 |
----------------------------------------------------------pseudo_mini_loss sum 1.3260051012039185
Total (block generation + training)time/epoch 21.263830293308605
Training time/epoch 0.8916060924530029
Training time without block to device /epoch 0.7954051494598389
Training time without total dataloading part /epoch 0.06163525581359863
load block tensor time/epoch 0.6653420925140381
block to device time/epoch 0.09620094299316406
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 20 |
Number of nodes for computation during this epoch:  3021151
Number of first layer input nodes during this epoch:  1287973
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1333141326904297  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020855426788330078
random selection method range initialization spend 0.005577802658081055
time for parepare:  0.018266916275024414
local_output_nid generation:  0.004629611968994141
local_in_edges_tensor generation:  0.005652427673339844
mini_batch_src_global generation:  0.0033087730407714844
r_  generation:  0.045475006103515625
local_output_nid generation:  0.0059359073638916016
local_in_edges_tensor generation:  0.003375530242919922
mini_batch_src_global generation:  0.004967451095581055
r_  generation:  0.04562067985534668
local_output_nid generation:  0.006075143814086914
local_in_edges_tensor generation:  0.0033884048461914062
mini_batch_src_global generation:  0.003641366958618164
r_  generation:  0.04739880561828613
local_output_nid generation:  0.006119966506958008
local_in_edges_tensor generation:  0.003522157669067383
mini_batch_src_global generation:  0.003614664077758789
r_  generation:  0.04739737510681152
local_output_nid generation:  0.006142139434814453
local_in_edges_tensor generation:  0.003368377685546875
mini_batch_src_global generation:  0.00399327278137207
r_  generation:  0.04930567741394043
local_output_nid generation:  0.0061299800872802734
local_in_edges_tensor generation:  0.003384828567504883
mini_batch_src_global generation:  0.004084110260009766
r_  generation:  0.04940223693847656
local_output_nid generation:  0.006112813949584961
local_in_edges_tensor generation:  0.003477334976196289
mini_batch_src_global generation:  0.004209280014038086
r_  generation:  0.050243377685546875
local_output_nid generation:  0.006134033203125
local_in_edges_tensor generation:  0.0033521652221679688
mini_batch_src_global generation:  0.004033088684082031
r_  generation:  0.04781365394592285
----------------------check_connections_block total spend ----------------------------- 0.5998575687408447
generate_one_block  0.06004905700683594
generate_one_block  0.06072235107421875
generate_one_block  0.06091809272766113
generate_one_block  0.06110191345214844
generate_one_block  0.062044382095336914
generate_one_block  0.06306910514831543
generate_one_block  0.06588029861450195
generate_one_block  0.060973167419433594
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03081345558166504
gen group dst list time:  0.01547694206237793
time for parepare:  0.01967930793762207
local_output_nid generation:  0.015160322189331055
local_in_edges_tensor generation:  0.02580881118774414
mini_batch_src_global generation:  0.032057762145996094
r_  generation:  0.31903815269470215
local_output_nid generation:  0.021168947219848633
local_in_edges_tensor generation:  0.020853757858276367
mini_batch_src_global generation:  0.039037466049194336
r_  generation:  0.3375556468963623
local_output_nid generation:  0.021741151809692383
local_in_edges_tensor generation:  0.024220705032348633
mini_batch_src_global generation:  0.03924226760864258
r_  generation:  0.33322978019714355
local_output_nid generation:  0.02089238166809082
local_in_edges_tensor generation:  0.022006750106811523
mini_batch_src_global generation:  0.03913569450378418
r_  generation:  0.3360581398010254
local_output_nid generation:  0.02103710174560547
local_in_edges_tensor generation:  0.021392345428466797
mini_batch_src_global generation:  0.04033160209655762
r_  generation:  0.34299516677856445
local_output_nid generation:  0.02090930938720703
local_in_edges_tensor generation:  0.022186994552612305
mini_batch_src_global generation:  0.041341543197631836
r_  generation:  0.34835219383239746
local_output_nid generation:  0.019811630249023438
local_in_edges_tensor generation:  0.02070331573486328
mini_batch_src_global generation:  0.04180598258972168
r_  generation:  0.34935617446899414
local_output_nid generation:  0.019680500030517578
local_in_edges_tensor generation:  0.019572734832763672
mini_batch_src_global generation:  0.0408174991607666
r_  generation:  0.33670783042907715
----------------------check_connections_block total spend ----------------------------- 3.947754383087158
generate_one_block  0.42989635467529297
generate_one_block  0.4345533847808838
generate_one_block  0.42796826362609863
generate_one_block  0.4274892807006836
generate_one_block  0.42886805534362793
generate_one_block  0.43804240226745605
generate_one_block  0.4325122833251953
generate_one_block  0.4470343589782715
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0235898494720459
gen group dst list time:  0.03884005546569824
time for parepare:  0.018713951110839844
local_output_nid generation:  0.029577970504760742
local_in_edges_tensor generation:  0.04040384292602539
mini_batch_src_global generation:  0.04410815238952637
r_  generation:  0.47859859466552734
local_output_nid generation:  0.03545975685119629
local_in_edges_tensor generation:  0.03226637840270996
mini_batch_src_global generation:  0.05390024185180664
r_  generation:  0.4833385944366455
local_output_nid generation:  0.035521745681762695
local_in_edges_tensor generation:  0.0325925350189209
mini_batch_src_global generation:  0.050966739654541016
r_  generation:  0.4959871768951416
local_output_nid generation:  0.03528571128845215
local_in_edges_tensor generation:  0.032941341400146484
mini_batch_src_global generation:  0.05400967597961426
r_  generation:  0.48985981941223145
local_output_nid generation:  0.03554272651672363
local_in_edges_tensor generation:  0.03484392166137695
mini_batch_src_global generation:  0.052297353744506836
r_  generation:  0.5035409927368164
local_output_nid generation:  0.03570699691772461
local_in_edges_tensor generation:  0.03500676155090332
mini_batch_src_global generation:  0.05507946014404297
r_  generation:  0.5011212825775146
local_output_nid generation:  0.035650014877319336
local_in_edges_tensor generation:  0.038155555725097656
mini_batch_src_global generation:  0.05383467674255371
r_  generation:  0.5202846527099609
local_output_nid generation:  0.03526711463928223
local_in_edges_tensor generation:  0.03254961967468262
mini_batch_src_global generation:  0.055020809173583984
r_  generation:  0.4911620616912842
----------------------check_connections_block total spend ----------------------------- 5.829413652420044
generate_one_block  0.6129631996154785
generate_one_block  0.6104261875152588
generate_one_block  0.6229233741760254
generate_one_block  0.6218264102935791
generate_one_block  0.609976053237915
generate_one_block  0.6234383583068848
generate_one_block  0.6136519908905029
generate_one_block  0.6126136779785156
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1333141326904297  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

connection checking time:  9.777168035507202
block generation total time  8.39418363571167
average batch blocks generation time:  1.0492729544639587
block dataloader generation time/epoch 20.331981658935547
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10255861282348633  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9370832443237305  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10244226455688477  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9369649887084961  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10253477096557617  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9362592697143555  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1025247573852539  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9355521202087402  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10261774063110352  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9371824264526367  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10255813598632812  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.94146728515625  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10224151611328125  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9372663497924805  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10222148895263672  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9322733879089355  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08388218283653259 |0.015180885791778564 |0.00343245267868042 |8.717179298400879e-05 |0.0036719441413879395 |0.0015227794647216797 |
----------------------------------------------------------pseudo_mini_loss sum 1.3090546131134033
Total (block generation + training)time/epoch 21.24829105536143
Training time/epoch 0.9286143779754639
Training time without block to device /epoch 0.8071672916412354
Training time without total dataloading part /epoch 0.059055328369140625
load block tensor time/epoch 0.6710574626922607
block to device time/epoch 0.12144708633422852
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 21 |
Number of nodes for computation during this epoch:  3020312
Number of first layer input nodes during this epoch:  1287449
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1334381103515625  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02823948860168457
random selection method range initialization spend 0.005588054656982422
time for parepare:  0.018529653549194336
local_output_nid generation:  0.004498004913330078
local_in_edges_tensor generation:  0.008023500442504883
mini_batch_src_global generation:  0.004114866256713867
r_  generation:  0.04466724395751953
local_output_nid generation:  0.0059163570404052734
local_in_edges_tensor generation:  0.003362417221069336
mini_batch_src_global generation:  0.005018711090087891
r_  generation:  0.045656681060791016
local_output_nid generation:  0.0061492919921875
local_in_edges_tensor generation:  0.0034177303314208984
mini_batch_src_global generation:  0.0035741329193115234
r_  generation:  0.0468137264251709
local_output_nid generation:  0.006095170974731445
local_in_edges_tensor generation:  0.003393411636352539
mini_batch_src_global generation:  0.0036056041717529297
r_  generation:  0.047708749771118164
local_output_nid generation:  0.006134510040283203
local_in_edges_tensor generation:  0.003438234329223633
mini_batch_src_global generation:  0.00394892692565918
r_  generation:  0.04806637763977051
local_output_nid generation:  0.006132841110229492
local_in_edges_tensor generation:  0.0034856796264648438
mini_batch_src_global generation:  0.004073143005371094
r_  generation:  0.04857683181762695
local_output_nid generation:  0.006204128265380859
local_in_edges_tensor generation:  0.0035185813903808594
mini_batch_src_global generation:  0.004148960113525391
r_  generation:  0.048725128173828125
local_output_nid generation:  0.006127357482910156
local_in_edges_tensor generation:  0.0033953189849853516
mini_batch_src_global generation:  0.004139423370361328
r_  generation:  0.04917788505554199
----------------------check_connections_block total spend ----------------------------- 0.6005003452301025
generate_one_block  0.06018805503845215
generate_one_block  0.06127643585205078
generate_one_block  0.06134462356567383
generate_one_block  0.06287598609924316
generate_one_block  0.06252717971801758
generate_one_block  0.06145954132080078
generate_one_block  0.06522989273071289
generate_one_block  0.06249380111694336
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030356407165527344
gen group dst list time:  0.01579427719116211
time for parepare:  0.019231557846069336
local_output_nid generation:  0.014801025390625
local_in_edges_tensor generation:  0.027157068252563477
mini_batch_src_global generation:  0.03301072120666504
r_  generation:  0.3201417922973633
local_output_nid generation:  0.02093982696533203
local_in_edges_tensor generation:  0.024335861206054688
mini_batch_src_global generation:  0.039075374603271484
r_  generation:  0.334780216217041
local_output_nid generation:  0.020940303802490234
local_in_edges_tensor generation:  0.021425247192382812
mini_batch_src_global generation:  0.03812456130981445
r_  generation:  0.3342163562774658
local_output_nid generation:  0.02094578742980957
local_in_edges_tensor generation:  0.021210670471191406
mini_batch_src_global generation:  0.0413815975189209
r_  generation:  0.33794212341308594
local_output_nid generation:  0.02099919319152832
local_in_edges_tensor generation:  0.021254539489746094
mini_batch_src_global generation:  0.04069399833679199
r_  generation:  0.3430943489074707
local_output_nid generation:  0.021045923233032227
local_in_edges_tensor generation:  0.021254777908325195
mini_batch_src_global generation:  0.04120135307312012
r_  generation:  0.34804558753967285
local_output_nid generation:  0.020380020141601562
local_in_edges_tensor generation:  0.021189451217651367
mini_batch_src_global generation:  0.041039466857910156
r_  generation:  0.34147143363952637
local_output_nid generation:  0.02056431770324707
local_in_edges_tensor generation:  0.021833419799804688
mini_batch_src_global generation:  0.04281497001647949
r_  generation:  0.3460721969604492
----------------------check_connections_block total spend ----------------------------- 3.9519805908203125
generate_one_block  0.4379160404205322
generate_one_block  0.4325735569000244
generate_one_block  0.4235494136810303
generate_one_block  0.42823338508605957
generate_one_block  0.43175482749938965
generate_one_block  0.4285597801208496
generate_one_block  0.4305562973022461
generate_one_block  0.46460437774658203
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.024445056915283203
gen group dst list time:  0.0392765998840332
time for parepare:  0.019662857055664062
local_output_nid generation:  0.028911590576171875
local_in_edges_tensor generation:  0.04093146324157715
mini_batch_src_global generation:  0.04432988166809082
r_  generation:  0.48149847984313965
local_output_nid generation:  0.03561878204345703
local_in_edges_tensor generation:  0.03463935852050781
mini_batch_src_global generation:  0.05717158317565918
r_  generation:  0.48814892768859863
local_output_nid generation:  0.03639960289001465
local_in_edges_tensor generation:  0.0380246639251709
mini_batch_src_global generation:  0.05300140380859375
r_  generation:  0.5014715194702148
local_output_nid generation:  0.03580832481384277
local_in_edges_tensor generation:  0.034554481506347656
mini_batch_src_global generation:  0.05359363555908203
r_  generation:  0.4899170398712158
local_output_nid generation:  0.03554940223693848
local_in_edges_tensor generation:  0.03503990173339844
mini_batch_src_global generation:  0.05409049987792969
r_  generation:  0.5011279582977295
local_output_nid generation:  0.03551506996154785
local_in_edges_tensor generation:  0.03374528884887695
mini_batch_src_global generation:  0.05472970008850098
r_  generation:  0.49286413192749023
local_output_nid generation:  0.03557753562927246
local_in_edges_tensor generation:  0.03573012351989746
mini_batch_src_global generation:  0.053841352462768555
r_  generation:  0.5036547183990479
local_output_nid generation:  0.03550362586975098
local_in_edges_tensor generation:  0.042212724685668945
mini_batch_src_global generation:  0.05446147918701172
r_  generation:  0.49860215187072754
----------------------check_connections_block total spend ----------------------------- 5.858311653137207
generate_one_block  0.6235170364379883
generate_one_block  0.6126863956451416
generate_one_block  0.6191940307617188
generate_one_block  0.6149075031280518
generate_one_block  0.6156344413757324
generate_one_block  0.6268620491027832
generate_one_block  0.6100466251373291
generate_one_block  0.6318974494934082
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1334381103515625  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

connection checking time:  9.81029224395752
block generation total time  8.432493209838867
average batch blocks generation time:  1.0540616512298584
block dataloader generation time/epoch 20.324184747842644
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10273361206054688  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9365372657775879  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1025996208190918  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9370737075805664  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10242033004760742  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.934882640838623  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10253715515136719  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9366273880004883  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1025094985961914  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9365677833557129  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10264062881469727  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9361777305603027  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10245561599731445  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.935786247253418  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.102630615234375  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9391794204711914  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0818672776222229 |0.01590898633003235 |0.003554403781890869 |9.521842002868652e-05 |0.0034469962120056152 |0.0014944076538085938 |
----------------------------------------------------------pseudo_mini_loss sum 1.294185996055603
Total (block generation + training)time/epoch 21.240464265529926
Training time/epoch 0.915708065032959
Training time without block to device /epoch 0.7884361743927002
Training time without total dataloading part /epoch 0.05826735496520996
load block tensor time/epoch 0.6549382209777832
block to device time/epoch 0.1272718906402588
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 22 |
Number of nodes for computation during this epoch:  3018345
Number of first layer input nodes during this epoch:  1287027
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13322210311889648  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02340865135192871
random selection method range initialization spend 0.0067501068115234375
time for parepare:  0.01817035675048828
local_output_nid generation:  0.004571437835693359
local_in_edges_tensor generation:  0.009576082229614258
mini_batch_src_global generation:  0.00406193733215332
r_  generation:  0.04434776306152344
local_output_nid generation:  0.006017446517944336
local_in_edges_tensor generation:  0.003721952438354492
mini_batch_src_global generation:  0.005255460739135742
r_  generation:  0.046434879302978516
local_output_nid generation:  0.006097078323364258
local_in_edges_tensor generation:  0.003355741500854492
mini_batch_src_global generation:  0.0036346912384033203
r_  generation:  0.04591083526611328
local_output_nid generation:  0.006109714508056641
local_in_edges_tensor generation:  0.003407001495361328
mini_batch_src_global generation:  0.0035996437072753906
r_  generation:  0.04808330535888672
local_output_nid generation:  0.006133079528808594
local_in_edges_tensor generation:  0.0034770965576171875
mini_batch_src_global generation:  0.00397491455078125
r_  generation:  0.0494692325592041
local_output_nid generation:  0.006284475326538086
local_in_edges_tensor generation:  0.0033905506134033203
mini_batch_src_global generation:  0.0040361881256103516
r_  generation:  0.0491790771484375
local_output_nid generation:  0.00612640380859375
local_in_edges_tensor generation:  0.0033719539642333984
mini_batch_src_global generation:  0.004147529602050781
r_  generation:  0.04753589630126953
local_output_nid generation:  0.006160736083984375
local_in_edges_tensor generation:  0.003435850143432617
mini_batch_src_global generation:  0.004149675369262695
r_  generation:  0.0491335391998291
----------------------check_connections_block total spend ----------------------------- 0.6044681072235107
generate_one_block  0.0640108585357666
generate_one_block  0.06282544136047363
generate_one_block  0.06501293182373047
generate_one_block  0.0610508918762207
generate_one_block  0.06208491325378418
generate_one_block  0.06246066093444824
generate_one_block  0.06518197059631348
generate_one_block  0.06300592422485352
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03415703773498535
gen group dst list time:  0.015498876571655273
time for parepare:  0.02032017707824707
local_output_nid generation:  0.014757633209228516
local_in_edges_tensor generation:  0.029306411743164062
mini_batch_src_global generation:  0.03272414207458496
r_  generation:  0.3190767765045166
local_output_nid generation:  0.021213769912719727
local_in_edges_tensor generation:  0.024419307708740234
mini_batch_src_global generation:  0.03971076011657715
r_  generation:  0.3360757827758789
local_output_nid generation:  0.02095770835876465
local_in_edges_tensor generation:  0.02231764793395996
mini_batch_src_global generation:  0.03882169723510742
r_  generation:  0.3346579074859619
local_output_nid generation:  0.021313905715942383
local_in_edges_tensor generation:  0.019843101501464844
mini_batch_src_global generation:  0.039342403411865234
r_  generation:  0.3367595672607422
local_output_nid generation:  0.020975828170776367
local_in_edges_tensor generation:  0.01926422119140625
mini_batch_src_global generation:  0.04055452346801758
r_  generation:  0.3457021713256836
local_output_nid generation:  0.020862102508544922
local_in_edges_tensor generation:  0.019550561904907227
mini_batch_src_global generation:  0.04118084907531738
r_  generation:  0.3400275707244873
local_output_nid generation:  0.01984715461730957
local_in_edges_tensor generation:  0.019571304321289062
mini_batch_src_global generation:  0.041216373443603516
r_  generation:  0.33811187744140625
local_output_nid generation:  0.02007007598876953
local_in_edges_tensor generation:  0.01984548568725586
mini_batch_src_global generation:  0.04242086410522461
r_  generation:  0.3427879810333252
----------------------check_connections_block total spend ----------------------------- 3.9365322589874268
generate_one_block  0.4257967472076416
generate_one_block  0.43569183349609375
generate_one_block  0.4324188232421875
generate_one_block  0.4284207820892334
generate_one_block  0.4324958324432373
generate_one_block  0.429370641708374
generate_one_block  0.42551445960998535
generate_one_block  0.4593818187713623
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03528714179992676
gen group dst list time:  0.03816628456115723
time for parepare:  0.018849849700927734
local_output_nid generation:  0.029654502868652344
local_in_edges_tensor generation:  0.04001045227050781
mini_batch_src_global generation:  0.04357647895812988
r_  generation:  0.4778141975402832
local_output_nid generation:  0.03628182411193848
local_in_edges_tensor generation:  0.03749227523803711
mini_batch_src_global generation:  0.054769277572631836
r_  generation:  0.489260196685791
local_output_nid generation:  0.03571820259094238
local_in_edges_tensor generation:  0.03401017189025879
mini_batch_src_global generation:  0.05072331428527832
r_  generation:  0.4998176097869873
local_output_nid generation:  0.035791873931884766
local_in_edges_tensor generation:  0.03339791297912598
mini_batch_src_global generation:  0.053963661193847656
r_  generation:  0.49219512939453125
local_output_nid generation:  0.035704851150512695
local_in_edges_tensor generation:  0.03505301475524902
mini_batch_src_global generation:  0.05296134948730469
r_  generation:  0.5037791728973389
local_output_nid generation:  0.03588581085205078
local_in_edges_tensor generation:  0.03485727310180664
mini_batch_src_global generation:  0.05525779724121094
r_  generation:  0.4958498477935791
local_output_nid generation:  0.03598666191101074
local_in_edges_tensor generation:  0.03280329704284668
mini_batch_src_global generation:  0.05308818817138672
r_  generation:  0.5056667327880859
local_output_nid generation:  0.03598976135253906
local_in_edges_tensor generation:  0.035083770751953125
mini_batch_src_global generation:  0.05721139907836914
r_  generation:  0.49735164642333984
----------------------check_connections_block total spend ----------------------------- 5.8337178230285645
generate_one_block  0.6114847660064697
generate_one_block  0.6112520694732666
generate_one_block  0.6057064533233643
generate_one_block  0.6084084510803223
generate_one_block  0.6091887950897217
generate_one_block  0.6105515956878662
generate_one_block  0.6074931621551514
generate_one_block  0.6079549789428711
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13322210311889648  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

connection checking time:  9.770250082015991
block generation total time  8.341131210327148
average batch blocks generation time:  1.0426414012908936
block dataloader generation time/epoch 20.312485490526473
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10166263580322266  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.934664249420166  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10236978530883789  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9402036666870117  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1022195816040039  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9354829788208008  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10248613357543945  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9361453056335449  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10258626937866211  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9371814727783203  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10239124298095703  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9373621940612793  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10242605209350586  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9349994659423828  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10277891159057617  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9398984909057617  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08013030886650085 |0.01360321044921875 |0.0034713447093963623 |9.021162986755371e-05 |0.0031396150588989258 |0.002707242965698242 |
----------------------------------------------------------pseudo_mini_loss sum 1.280253291130066
Total (block generation + training)time/epoch 21.225806048938207
Training time/epoch 0.8746347427368164
Training time without block to device /epoch 0.7658090591430664
Training time without total dataloading part /epoch 0.05631661415100098
load block tensor time/epoch 0.6410424709320068
block to device time/epoch 0.10882568359375
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 23 |
Number of nodes for computation during this epoch:  3019877
Number of first layer input nodes during this epoch:  1287514
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13329076766967773  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02434086799621582
random selection method range initialization spend 0.005323171615600586
time for parepare:  0.01865363121032715
local_output_nid generation:  0.004448413848876953
local_in_edges_tensor generation:  0.005556583404541016
mini_batch_src_global generation:  0.003450155258178711
r_  generation:  0.04635334014892578
local_output_nid generation:  0.00596165657043457
local_in_edges_tensor generation:  0.0033419132232666016
mini_batch_src_global generation:  0.005144357681274414
r_  generation:  0.04590582847595215
local_output_nid generation:  0.00608515739440918
local_in_edges_tensor generation:  0.003376483917236328
mini_batch_src_global generation:  0.0036461353302001953
r_  generation:  0.04739737510681152
local_output_nid generation:  0.006099224090576172
local_in_edges_tensor generation:  0.003300905227661133
mini_batch_src_global generation:  0.003651857376098633
r_  generation:  0.04706740379333496
local_output_nid generation:  0.006211996078491211
local_in_edges_tensor generation:  0.0033419132232666016
mini_batch_src_global generation:  0.003962039947509766
r_  generation:  0.04710817337036133
local_output_nid generation:  0.0061092376708984375
local_in_edges_tensor generation:  0.0033936500549316406
mini_batch_src_global generation:  0.0040323734283447266
r_  generation:  0.04887247085571289
local_output_nid generation:  0.0060842037200927734
local_in_edges_tensor generation:  0.003343820571899414
mini_batch_src_global generation:  0.00422215461730957
r_  generation:  0.04854130744934082
local_output_nid generation:  0.006709098815917969
local_in_edges_tensor generation:  0.0034134387969970703
mini_batch_src_global generation:  0.0040738582611083984
r_  generation:  0.04878997802734375
----------------------check_connections_block total spend ----------------------------- 0.6041276454925537
generate_one_block  0.060816049575805664
generate_one_block  0.0617823600769043
generate_one_block  0.062131404876708984
generate_one_block  0.06285762786865234
generate_one_block  0.060837745666503906
generate_one_block  0.062386274337768555
generate_one_block  0.0671696662902832
generate_one_block  0.06248593330383301
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.032892704010009766
gen group dst list time:  0.016870975494384766
time for parepare:  0.021117448806762695
local_output_nid generation:  0.015281915664672852
local_in_edges_tensor generation:  0.0320124626159668
mini_batch_src_global generation:  0.033173322677612305
r_  generation:  0.32183051109313965
local_output_nid generation:  0.02108454704284668
local_in_edges_tensor generation:  0.026064157485961914
mini_batch_src_global generation:  0.03970170021057129
r_  generation:  0.33409643173217773
local_output_nid generation:  0.020992279052734375
local_in_edges_tensor generation:  0.021376848220825195
mini_batch_src_global generation:  0.03902721405029297
r_  generation:  0.33941102027893066
local_output_nid generation:  0.02053380012512207
local_in_edges_tensor generation:  0.02106308937072754
mini_batch_src_global generation:  0.03896927833557129
r_  generation:  0.33635854721069336
local_output_nid generation:  0.020668745040893555
local_in_edges_tensor generation:  0.02084970474243164
mini_batch_src_global generation:  0.03979849815368652
r_  generation:  0.34029197692871094
local_output_nid generation:  0.02111053466796875
local_in_edges_tensor generation:  0.019932270050048828
mini_batch_src_global generation:  0.04249453544616699
r_  generation:  0.3469388484954834
local_output_nid generation:  0.0198366641998291
local_in_edges_tensor generation:  0.020038366317749023
mini_batch_src_global generation:  0.04060935974121094
r_  generation:  0.3408665657043457
local_output_nid generation:  0.019719600677490234
local_in_edges_tensor generation:  0.019985437393188477
mini_batch_src_global generation:  0.04123854637145996
r_  generation:  0.34703636169433594
----------------------check_connections_block total spend ----------------------------- 3.956455945968628
generate_one_block  0.4361579418182373
generate_one_block  0.4329521656036377
generate_one_block  0.43122243881225586
generate_one_block  0.42591238021850586
generate_one_block  0.42789196968078613
generate_one_block  0.4335031509399414
generate_one_block  0.4273972511291504
generate_one_block  0.458770751953125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03217649459838867
gen group dst list time:  0.038645267486572266
time for parepare:  0.020468473434448242
local_output_nid generation:  0.02954578399658203
local_in_edges_tensor generation:  0.0415036678314209
mini_batch_src_global generation:  0.04496312141418457
r_  generation:  0.48427486419677734
local_output_nid generation:  0.03574347496032715
local_in_edges_tensor generation:  0.034017086029052734
mini_batch_src_global generation:  0.05490469932556152
r_  generation:  0.4871985912322998
local_output_nid generation:  0.03530597686767578
local_in_edges_tensor generation:  0.03418588638305664
mini_batch_src_global generation:  0.05282258987426758
r_  generation:  0.5011718273162842
local_output_nid generation:  0.03564453125
local_in_edges_tensor generation:  0.031900644302368164
mini_batch_src_global generation:  0.05428433418273926
r_  generation:  0.4967923164367676
local_output_nid generation:  0.03596162796020508
local_in_edges_tensor generation:  0.03478074073791504
mini_batch_src_global generation:  0.05279874801635742
r_  generation:  0.5065455436706543
local_output_nid generation:  0.03568768501281738
local_in_edges_tensor generation:  0.03447985649108887
mini_batch_src_global generation:  0.05500149726867676
r_  generation:  0.5028095245361328
local_output_nid generation:  0.03603410720825195
local_in_edges_tensor generation:  0.03829765319824219
mini_batch_src_global generation:  0.05393171310424805
r_  generation:  0.5062651634216309
local_output_nid generation:  0.036069393157958984
local_in_edges_tensor generation:  0.033060312271118164
mini_batch_src_global generation:  0.05541515350341797
r_  generation:  0.49932003021240234
----------------------check_connections_block total spend ----------------------------- 5.862687110900879
generate_one_block  0.6121668815612793
generate_one_block  0.6165931224822998
generate_one_block  0.6108686923980713
generate_one_block  0.6124451160430908
generate_one_block  0.6163568496704102
generate_one_block  0.6125695705413818
generate_one_block  0.6081788539886475
generate_one_block  0.619011402130127
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13329076766967773  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

connection checking time:  9.819143056869507
block generation total time  8.381998538970947
average batch blocks generation time:  1.0477498173713684
block dataloader generation time/epoch 20.30566258430481
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10186386108398438  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9410758018493652  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10222721099853516  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9381842613220215  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10235929489135742  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9386930465698242  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10153722763061523  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9349331855773926  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10212326049804688  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9322953224182129  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10275125503540039  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9373378753662109  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10223531723022461  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9358816146850586  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1027226448059082  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9374098777770996  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08185666799545288 |0.01171112060546875 |0.0034973621368408203 |9.313225746154785e-05 |0.0032778680324554443 |0.0013625621795654297 |
----------------------------------------------------------pseudo_mini_loss sum 1.270493984222412
Total (block generation + training)time/epoch 21.216750780741375
Training time/epoch 0.8796467781066895
Training time without block to device /epoch 0.7859578132629395
Training time without total dataloading part /epoch 0.05630946159362793
load block tensor time/epoch 0.654853343963623
block to device time/epoch 0.09368896484375
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 24 |
Number of nodes for computation during this epoch:  3019082
Number of first layer input nodes during this epoch:  1286935
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13338518142700195  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021348953247070312
random selection method range initialization spend 0.005876064300537109
time for parepare:  0.017066478729248047
local_output_nid generation:  0.004683971405029297
local_in_edges_tensor generation:  0.005818605422973633
mini_batch_src_global generation:  0.0032806396484375
r_  generation:  0.04385948181152344
local_output_nid generation:  0.005975484848022461
local_in_edges_tensor generation:  0.0032196044921875
mini_batch_src_global generation:  0.0051119327545166016
r_  generation:  0.0453183650970459
local_output_nid generation:  0.00611114501953125
local_in_edges_tensor generation:  0.0032486915588378906
mini_batch_src_global generation:  0.003627777099609375
r_  generation:  0.04699516296386719
local_output_nid generation:  0.00623011589050293
local_in_edges_tensor generation:  0.0033788681030273438
mini_batch_src_global generation:  0.003731966018676758
r_  generation:  0.04793429374694824
local_output_nid generation:  0.006173372268676758
local_in_edges_tensor generation:  0.003437519073486328
mini_batch_src_global generation:  0.004033803939819336
r_  generation:  0.04825162887573242
local_output_nid generation:  0.00615692138671875
local_in_edges_tensor generation:  0.0034186840057373047
mini_batch_src_global generation:  0.003972530364990234
r_  generation:  0.04840493202209473
local_output_nid generation:  0.006171464920043945
local_in_edges_tensor generation:  0.003293275833129883
mini_batch_src_global generation:  0.004342555999755859
r_  generation:  0.04845619201660156
local_output_nid generation:  0.006188392639160156
local_in_edges_tensor generation:  0.0033118724822998047
mini_batch_src_global generation:  0.004113912582397461
r_  generation:  0.04880237579345703
----------------------check_connections_block total spend ----------------------------- 0.5947737693786621
generate_one_block  0.059179067611694336
generate_one_block  0.0613558292388916
generate_one_block  0.061403751373291016
generate_one_block  0.062465667724609375
generate_one_block  0.06218457221984863
generate_one_block  0.061824798583984375
generate_one_block  0.0657353401184082
generate_one_block  0.0628349781036377
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.033554792404174805
gen group dst list time:  0.015533208847045898
time for parepare:  0.019479751586914062
local_output_nid generation:  0.014786005020141602
local_in_edges_tensor generation:  0.02837204933166504
mini_batch_src_global generation:  0.03200364112854004
r_  generation:  0.31570887565612793
local_output_nid generation:  0.020928144454956055
local_in_edges_tensor generation:  0.027799606323242188
mini_batch_src_global generation:  0.03951001167297363
r_  generation:  0.33480381965637207
local_output_nid generation:  0.020887374877929688
local_in_edges_tensor generation:  0.021488666534423828
mini_batch_src_global generation:  0.039568424224853516
r_  generation:  0.3396725654602051
local_output_nid generation:  0.020624160766601562
local_in_edges_tensor generation:  0.022193431854248047
mini_batch_src_global generation:  0.04306602478027344
r_  generation:  0.34606003761291504
local_output_nid generation:  0.02078866958618164
local_in_edges_tensor generation:  0.024596691131591797
mini_batch_src_global generation:  0.040960073471069336
r_  generation:  0.339404821395874
local_output_nid generation:  0.020990610122680664
local_in_edges_tensor generation:  0.021725893020629883
mini_batch_src_global generation:  0.04090762138366699
r_  generation:  0.34012675285339355
local_output_nid generation:  0.019974708557128906
local_in_edges_tensor generation:  0.022964000701904297
mini_batch_src_global generation:  0.041869401931762695
r_  generation:  0.3405773639678955
local_output_nid generation:  0.01942753791809082
local_in_edges_tensor generation:  0.021533489227294922
mini_batch_src_global generation:  0.04114556312561035
r_  generation:  0.33620500564575195
----------------------check_connections_block total spend ----------------------------- 3.954774856567383
generate_one_block  0.4266326427459717
generate_one_block  0.438291072845459
generate_one_block  0.43518614768981934
generate_one_block  0.43556690216064453
generate_one_block  0.42894554138183594
generate_one_block  0.4263160228729248
generate_one_block  0.429415225982666
generate_one_block  0.4467904567718506
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03463888168334961
gen group dst list time:  0.03873038291931152
time for parepare:  0.019028663635253906
local_output_nid generation:  0.029360055923461914
local_in_edges_tensor generation:  0.04363679885864258
mini_batch_src_global generation:  0.04437589645385742
r_  generation:  0.47692227363586426
local_output_nid generation:  0.03616666793823242
local_in_edges_tensor generation:  0.04282736778259277
mini_batch_src_global generation:  0.056256771087646484
r_  generation:  0.48217272758483887
local_output_nid generation:  0.03598904609680176
local_in_edges_tensor generation:  0.033563852310180664
mini_batch_src_global generation:  0.05379366874694824
r_  generation:  0.49509119987487793
local_output_nid generation:  0.03622937202453613
local_in_edges_tensor generation:  0.03372693061828613
mini_batch_src_global generation:  0.05581378936767578
r_  generation:  0.49078845977783203
local_output_nid generation:  0.03572821617126465
local_in_edges_tensor generation:  0.033249616622924805
mini_batch_src_global generation:  0.053072214126586914
r_  generation:  0.5012805461883545
local_output_nid generation:  0.03570723533630371
local_in_edges_tensor generation:  0.03446769714355469
mini_batch_src_global generation:  0.05488252639770508
r_  generation:  0.4959275722503662
local_output_nid generation:  0.03592371940612793
local_in_edges_tensor generation:  0.033042192459106445
mini_batch_src_global generation:  0.053636789321899414
r_  generation:  0.5077106952667236
local_output_nid generation:  0.03639936447143555
local_in_edges_tensor generation:  0.03822827339172363
mini_batch_src_global generation:  0.05599546432495117
r_  generation:  0.49321794509887695
----------------------check_connections_block total spend ----------------------------- 5.838216543197632
generate_one_block  0.6191627979278564
generate_one_block  0.6143417358398438
generate_one_block  0.611370325088501
generate_one_block  0.613426685333252
generate_one_block  0.6141366958618164
generate_one_block  0.6173126697540283
generate_one_block  0.6107399463653564
generate_one_block  0.6305451393127441
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13338518142700195  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

connection checking time:  9.792991399765015
block generation total time  8.39818000793457
average batch blocks generation time:  1.0497725009918213
block dataloader generation time/epoch 20.298824101686478
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10227203369140625  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9355683326721191  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10269975662231445  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.937222957611084  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1024007797241211  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9371323585510254  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10274744033813477  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9424223899841309  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1021580696105957  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.935636043548584  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10246849060058594  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9351224899291992  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10264396667480469  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.937469482421875  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10219526290893555  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9345831871032715  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07840466499328613 |0.017851263284683228 |0.003439664840698242 |9.074807167053223e-05 |0.008718162775039673 |0.001569986343383789 |
----------------------------------------------------------pseudo_mini_loss sum 1.2579156160354614
Total (block generation + training)time/epoch 21.21183142066002
Training time/epoch 0.9415791034698486
Training time without block to device /epoch 0.7987689971923828
Training time without total dataloading part /epoch 0.09955859184265137
load block tensor time/epoch 0.6272373199462891
block to device time/epoch 0.14281010627746582
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 25 |
Number of nodes for computation during this epoch:  3018515
Number of first layer input nodes during this epoch:  1287334
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1334061622619629  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026085615158081055
random selection method range initialization spend 0.005698204040527344
time for parepare:  0.017427444458007812
local_output_nid generation:  0.004566669464111328
local_in_edges_tensor generation:  0.005986213684082031
mini_batch_src_global generation:  0.0033941268920898438
r_  generation:  0.044797420501708984
local_output_nid generation:  0.006041526794433594
local_in_edges_tensor generation:  0.003989219665527344
mini_batch_src_global generation:  0.005258083343505859
r_  generation:  0.04669308662414551
local_output_nid generation:  0.00614166259765625
local_in_edges_tensor generation:  0.003868579864501953
mini_batch_src_global generation:  0.0038678646087646484
r_  generation:  0.04775190353393555
local_output_nid generation:  0.0061359405517578125
local_in_edges_tensor generation:  0.0038177967071533203
mini_batch_src_global generation:  0.0037240982055664062
r_  generation:  0.047792911529541016
local_output_nid generation:  0.006171226501464844
local_in_edges_tensor generation:  0.0038034915924072266
mini_batch_src_global generation:  0.004040718078613281
r_  generation:  0.049104928970336914
local_output_nid generation:  0.006117582321166992
local_in_edges_tensor generation:  0.003922700881958008
mini_batch_src_global generation:  0.0040264129638671875
r_  generation:  0.04922986030578613
local_output_nid generation:  0.006166219711303711
local_in_edges_tensor generation:  0.004007816314697266
mini_batch_src_global generation:  0.004250526428222656
r_  generation:  0.04860496520996094
local_output_nid generation:  0.006180286407470703
local_in_edges_tensor generation:  0.0038635730743408203
mini_batch_src_global generation:  0.00413823127746582
r_  generation:  0.0496370792388916
----------------------check_connections_block total spend ----------------------------- 0.6052341461181641
generate_one_block  0.05935335159301758
generate_one_block  0.061158180236816406
generate_one_block  0.0664677619934082
generate_one_block  0.061220407485961914
generate_one_block  0.06253671646118164
generate_one_block  0.06202864646911621
generate_one_block  0.06612396240234375
generate_one_block  0.06246757507324219
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.032018184661865234
gen group dst list time:  0.01694631576538086
time for parepare:  0.02100658416748047
local_output_nid generation:  0.014562368392944336
local_in_edges_tensor generation:  0.031091928482055664
mini_batch_src_global generation:  0.03300023078918457
r_  generation:  0.3181033134460449
local_output_nid generation:  0.020489215850830078
local_in_edges_tensor generation:  0.02393174171447754
mini_batch_src_global generation:  0.03850984573364258
r_  generation:  0.32975292205810547
local_output_nid generation:  0.02071356773376465
local_in_edges_tensor generation:  0.02133488655090332
mini_batch_src_global generation:  0.03950786590576172
r_  generation:  0.3366677761077881
local_output_nid generation:  0.020054340362548828
local_in_edges_tensor generation:  0.021232128143310547
mini_batch_src_global generation:  0.03992605209350586
r_  generation:  0.3398854732513428
local_output_nid generation:  0.021146535873413086
local_in_edges_tensor generation:  0.021399974822998047
mini_batch_src_global generation:  0.04150390625
r_  generation:  0.34546709060668945
local_output_nid generation:  0.021164655685424805
local_in_edges_tensor generation:  0.021167755126953125
mini_batch_src_global generation:  0.04143786430358887
r_  generation:  0.3433065414428711
local_output_nid generation:  0.020444631576538086
local_in_edges_tensor generation:  0.0211946964263916
mini_batch_src_global generation:  0.0414278507232666
r_  generation:  0.3431999683380127
local_output_nid generation:  0.019914627075195312
local_in_edges_tensor generation:  0.01978921890258789
mini_batch_src_global generation:  0.04178881645202637
r_  generation:  0.34107375144958496
----------------------check_connections_block total spend ----------------------------- 3.94942569732666
generate_one_block  0.4266932010650635
generate_one_block  0.4230020046234131
generate_one_block  0.4280712604522705
generate_one_block  0.4274754524230957
generate_one_block  0.4345242977142334
generate_one_block  0.4298229217529297
generate_one_block  0.43694615364074707
generate_one_block  0.459547758102417
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.026228666305541992
gen group dst list time:  0.03867816925048828
time for parepare:  0.018959760665893555
local_output_nid generation:  0.029522418975830078
local_in_edges_tensor generation:  0.044695377349853516
mini_batch_src_global generation:  0.04358673095703125
r_  generation:  0.4791450500488281
local_output_nid generation:  0.03530740737915039
local_in_edges_tensor generation:  0.035469770431518555
mini_batch_src_global generation:  0.05591893196105957
r_  generation:  0.48358988761901855
local_output_nid generation:  0.03557109832763672
local_in_edges_tensor generation:  0.037053585052490234
mini_batch_src_global generation:  0.05054187774658203
r_  generation:  0.5010986328125
local_output_nid generation:  0.03580307960510254
local_in_edges_tensor generation:  0.03607988357543945
mini_batch_src_global generation:  0.05358481407165527
r_  generation:  0.48992252349853516
local_output_nid generation:  0.0357818603515625
local_in_edges_tensor generation:  0.03277158737182617
mini_batch_src_global generation:  0.05232429504394531
r_  generation:  0.5130469799041748
local_output_nid generation:  0.03722357749938965
local_in_edges_tensor generation:  0.034864187240600586
mini_batch_src_global generation:  0.05517745018005371
r_  generation:  0.4974799156188965
local_output_nid generation:  0.035834312438964844
local_in_edges_tensor generation:  0.032982826232910156
mini_batch_src_global generation:  0.052932024002075195
r_  generation:  0.5091240406036377
local_output_nid generation:  0.03545093536376953
local_in_edges_tensor generation:  0.037090301513671875
mini_batch_src_global generation:  0.05459427833557129
r_  generation:  0.4940338134765625
----------------------check_connections_block total spend ----------------------------- 5.84228515625
generate_one_block  0.6124179363250732
generate_one_block  0.604346513748169
generate_one_block  0.6127402782440186
generate_one_block  0.6119203567504883
generate_one_block  0.6136984825134277
generate_one_block  0.6123385429382324
generate_one_block  0.6143245697021484
generate_one_block  0.6094794273376465
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1334061622619629  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

connection checking time:  9.79171085357666
block generation total time  8.357349157333374
average batch blocks generation time:  1.0446686446666718
block dataloader generation time/epoch 20.289398684221155
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10248422622680664  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9298181533813477  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1025686264038086  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9355950355529785  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10258626937866211  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9367942810058594  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1024012565612793  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.935187816619873  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10273361206054688  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9391031265258789  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10181379318237305  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9372749328613281  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10243701934814453  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.937840461730957  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10228395462036133  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9369864463806152  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08532112836837769 |0.011792212724685669 |0.0035054683685302734 |9.131431579589844e-05 |0.00376969575881958 |0.0018422603607177734 |
----------------------------------------------------------pseudo_mini_loss sum 1.2446001768112183
Total (block generation + training)time/epoch 21.20228348058813
Training time/epoch 0.9106559753417969
Training time without block to device /epoch 0.8163182735443115
Training time without total dataloading part /epoch 0.06077408790588379
load block tensor time/epoch 0.6825690269470215
block to device time/epoch 0.09433770179748535
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 26 |
Number of nodes for computation during this epoch:  3017750
Number of first layer input nodes during this epoch:  1287087
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13333797454833984  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018244266510009766
random selection method range initialization spend 0.005811214447021484
time for parepare:  0.017364025115966797
local_output_nid generation:  0.004593372344970703
local_in_edges_tensor generation:  0.00574183464050293
mini_batch_src_global generation:  0.003398418426513672
r_  generation:  0.04473137855529785
local_output_nid generation:  0.005954265594482422
local_in_edges_tensor generation:  0.0035495758056640625
mini_batch_src_global generation:  0.0053081512451171875
r_  generation:  0.04626798629760742
local_output_nid generation:  0.0061070919036865234
local_in_edges_tensor generation:  0.0033752918243408203
mini_batch_src_global generation:  0.0037779808044433594
r_  generation:  0.04743051528930664
local_output_nid generation:  0.0061492919921875
local_in_edges_tensor generation:  0.0034143924713134766
mini_batch_src_global generation:  0.0038237571716308594
r_  generation:  0.04866337776184082
local_output_nid generation:  0.0061168670654296875
local_in_edges_tensor generation:  0.0034513473510742188
mini_batch_src_global generation:  0.004030704498291016
r_  generation:  0.04812431335449219
local_output_nid generation:  0.006206035614013672
local_in_edges_tensor generation:  0.003392934799194336
mini_batch_src_global generation:  0.00413966178894043
r_  generation:  0.04918217658996582
local_output_nid generation:  0.006201744079589844
local_in_edges_tensor generation:  0.0033597946166992188
mini_batch_src_global generation:  0.004199028015136719
r_  generation:  0.049160003662109375
local_output_nid generation:  0.006134986877441406
local_in_edges_tensor generation:  0.0034630298614501953
mini_batch_src_global generation:  0.004022836685180664
r_  generation:  0.04857349395751953
----------------------check_connections_block total spend ----------------------------- 0.6002910137176514
generate_one_block  0.06192469596862793
generate_one_block  0.06265830993652344
generate_one_block  0.06193423271179199
generate_one_block  0.06285524368286133
generate_one_block  0.06192922592163086
generate_one_block  0.062486886978149414
generate_one_block  0.06614947319030762
generate_one_block  0.062001943588256836
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02728557586669922
gen group dst list time:  0.015479326248168945
time for parepare:  0.01951742172241211
local_output_nid generation:  0.015017509460449219
local_in_edges_tensor generation:  0.029984235763549805
mini_batch_src_global generation:  0.03314971923828125
r_  generation:  0.3188974857330322
local_output_nid generation:  0.021184682846069336
local_in_edges_tensor generation:  0.023451805114746094
mini_batch_src_global generation:  0.03933286666870117
r_  generation:  0.3354816436767578
local_output_nid generation:  0.020639896392822266
local_in_edges_tensor generation:  0.021031618118286133
mini_batch_src_global generation:  0.039381980895996094
r_  generation:  0.3384521007537842
local_output_nid generation:  0.020667314529418945
local_in_edges_tensor generation:  0.022217988967895508
mini_batch_src_global generation:  0.040190696716308594
r_  generation:  0.34354209899902344
local_output_nid generation:  0.020858049392700195
local_in_edges_tensor generation:  0.021146297454833984
mini_batch_src_global generation:  0.04086041450500488
r_  generation:  0.3413517475128174
local_output_nid generation:  0.021140336990356445
local_in_edges_tensor generation:  0.02066493034362793
mini_batch_src_global generation:  0.04099130630493164
r_  generation:  0.33988308906555176
local_output_nid generation:  0.02027440071105957
local_in_edges_tensor generation:  0.020597219467163086
mini_batch_src_global generation:  0.04120469093322754
r_  generation:  0.34044885635375977
local_output_nid generation:  0.01971125602722168
local_in_edges_tensor generation:  0.021376609802246094
mini_batch_src_global generation:  0.0406801700592041
r_  generation:  0.33554959297180176
----------------------check_connections_block total spend ----------------------------- 3.942422389984131
generate_one_block  0.42677831649780273
generate_one_block  0.42826271057128906
generate_one_block  0.42906737327575684
generate_one_block  0.4302785396575928
generate_one_block  0.42595529556274414
generate_one_block  0.4297153949737549
generate_one_block  0.4254798889160156
generate_one_block  0.4466688632965088
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02670598030090332
gen group dst list time:  0.03889822959899902
time for parepare:  0.01847982406616211
local_output_nid generation:  0.029756784439086914
local_in_edges_tensor generation:  0.039327144622802734
mini_batch_src_global generation:  0.043611764907836914
r_  generation:  0.4797627925872803
local_output_nid generation:  0.03596949577331543
local_in_edges_tensor generation:  0.0341954231262207
mini_batch_src_global generation:  0.055042266845703125
r_  generation:  0.5000360012054443
local_output_nid generation:  0.03609967231750488
local_in_edges_tensor generation:  0.0328676700592041
mini_batch_src_global generation:  0.05078244209289551
r_  generation:  0.4980785846710205
local_output_nid generation:  0.035738229751586914
local_in_edges_tensor generation:  0.033585309982299805
mini_batch_src_global generation:  0.05406951904296875
r_  generation:  0.4910917282104492
local_output_nid generation:  0.03565406799316406
local_in_edges_tensor generation:  0.0328829288482666
mini_batch_src_global generation:  0.05307769775390625
r_  generation:  0.5067465305328369
local_output_nid generation:  0.03580451011657715
local_in_edges_tensor generation:  0.032598018646240234
mini_batch_src_global generation:  0.05566120147705078
r_  generation:  0.4906198978424072
local_output_nid generation:  0.036199331283569336
local_in_edges_tensor generation:  0.0327908992767334
mini_batch_src_global generation:  0.05350518226623535
r_  generation:  0.5044505596160889
local_output_nid generation:  0.03542351722717285
local_in_edges_tensor generation:  0.03377485275268555
mini_batch_src_global generation:  0.05576038360595703
r_  generation:  0.4933035373687744
----------------------check_connections_block total spend ----------------------------- 5.829164028167725
generate_one_block  0.616466760635376
generate_one_block  0.6094682216644287
generate_one_block  0.6111884117126465
generate_one_block  0.6119928359985352
generate_one_block  0.6132314205169678
generate_one_block  0.6093323230743408
generate_one_block  0.6089005470275879
generate_one_block  0.6103205680847168
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13333797454833984  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

connection checking time:  9.771586418151855
block generation total time  8.333107471466064
average batch blocks generation time:  1.041638433933258
block dataloader generation time/epoch 20.277923610475327
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10255670547485352  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9369683265686035  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1025547981262207  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9372153282165527  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1025700569152832  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9378437995910645  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10255765914916992  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9390063285827637  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10169744491577148  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9367928504943848  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10259628295898438  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9374332427978516  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1024479866027832  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9372644424438477  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10220718383789062  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9356513023376465  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08385580778121948 |0.013291418552398682 |0.003455430269241333 |8.818507194519043e-05 |0.0037629008293151855 |0.001306295394897461 |
----------------------------------------------------------pseudo_mini_loss sum 1.2347241640090942
Total (block generation + training)time/epoch 21.190485265519882
Training time/epoch 0.9069435596466064
Training time without block to device /epoch 0.800612211227417
Training time without total dataloading part /epoch 0.05975842475891113
load block tensor time/epoch 0.6708464622497559
block to device time/epoch 0.10633134841918945
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 27 |
Number of nodes for computation during this epoch:  3021007
Number of first layer input nodes during this epoch:  1287859
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13335227966308594  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024857282638549805
random selection method range initialization spend 0.005794525146484375
time for parepare:  0.01758551597595215
local_output_nid generation:  0.004473686218261719
local_in_edges_tensor generation:  0.006559133529663086
mini_batch_src_global generation:  0.003473997116088867
r_  generation:  0.045105934143066406
local_output_nid generation:  0.006020069122314453
local_in_edges_tensor generation:  0.003335714340209961
mini_batch_src_global generation:  0.0053386688232421875
r_  generation:  0.04660820960998535
local_output_nid generation:  0.006197452545166016
local_in_edges_tensor generation:  0.0035338401794433594
mini_batch_src_global generation:  0.0038182735443115234
r_  generation:  0.04601931571960449
local_output_nid generation:  0.006165981292724609
local_in_edges_tensor generation:  0.0034041404724121094
mini_batch_src_global generation:  0.0037958621978759766
r_  generation:  0.047852516174316406
local_output_nid generation:  0.006319284439086914
local_in_edges_tensor generation:  0.003406524658203125
mini_batch_src_global generation:  0.004071474075317383
r_  generation:  0.04870271682739258
local_output_nid generation:  0.006171226501464844
local_in_edges_tensor generation:  0.0032923221588134766
mini_batch_src_global generation:  0.004136800765991211
r_  generation:  0.05018901824951172
local_output_nid generation:  0.006334543228149414
local_in_edges_tensor generation:  0.0033795833587646484
mini_batch_src_global generation:  0.004342317581176758
r_  generation:  0.04998779296875
local_output_nid generation:  0.006270647048950195
local_in_edges_tensor generation:  0.0036826133728027344
mini_batch_src_global generation:  0.004422187805175781
r_  generation:  0.048217058181762695
----------------------check_connections_block total spend ----------------------------- 0.6042373180389404
generate_one_block  0.060690879821777344
generate_one_block  0.06289196014404297
generate_one_block  0.06015324592590332
generate_one_block  0.06164121627807617
generate_one_block  0.06207275390625
generate_one_block  0.06331634521484375
generate_one_block  0.06600379943847656
generate_one_block  0.06173396110534668
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.036678314208984375
gen group dst list time:  0.017575979232788086
time for parepare:  0.019528627395629883
local_output_nid generation:  0.015608787536621094
local_in_edges_tensor generation:  0.029930591583251953
mini_batch_src_global generation:  0.03388714790344238
r_  generation:  0.32990455627441406
local_output_nid generation:  0.02206277847290039
local_in_edges_tensor generation:  0.026174306869506836
mini_batch_src_global generation:  0.041579484939575195
r_  generation:  0.33774876594543457
local_output_nid generation:  0.021503925323486328
local_in_edges_tensor generation:  0.019694089889526367
mini_batch_src_global generation:  0.03979611396789551
r_  generation:  0.3357353210449219
local_output_nid generation:  0.021591901779174805
local_in_edges_tensor generation:  0.022570133209228516
mini_batch_src_global generation:  0.039847373962402344
r_  generation:  0.3411445617675781
local_output_nid generation:  0.021413087844848633
local_in_edges_tensor generation:  0.02081775665283203
mini_batch_src_global generation:  0.041745901107788086
r_  generation:  0.34682798385620117
local_output_nid generation:  0.02147388458251953
local_in_edges_tensor generation:  0.02109384536743164
mini_batch_src_global generation:  0.041411399841308594
r_  generation:  0.34820055961608887
local_output_nid generation:  0.021028757095336914
local_in_edges_tensor generation:  0.01986837387084961
mini_batch_src_global generation:  0.04281210899353027
r_  generation:  0.34887051582336426
local_output_nid generation:  0.020221471786499023
local_in_edges_tensor generation:  0.019794940948486328
mini_batch_src_global generation:  0.044487714767456055
r_  generation:  0.3497157096862793
----------------------check_connections_block total spend ----------------------------- 4.000880479812622
generate_one_block  0.4323875904083252
generate_one_block  0.43312931060791016
generate_one_block  0.42162513732910156
generate_one_block  0.43459486961364746
generate_one_block  0.4338967800140381
generate_one_block  0.43309998512268066
generate_one_block  0.4327967166900635
generate_one_block  0.4478182792663574
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.039277076721191406
gen group dst list time:  0.038543701171875
time for parepare:  0.01871633529663086
local_output_nid generation:  0.029462337493896484
local_in_edges_tensor generation:  0.044811248779296875
mini_batch_src_global generation:  0.044182538986206055
r_  generation:  0.4861123561859131
local_output_nid generation:  0.03642725944519043
local_in_edges_tensor generation:  0.04107069969177246
mini_batch_src_global generation:  0.05627298355102539
r_  generation:  0.49304723739624023
local_output_nid generation:  0.035842180252075195
local_in_edges_tensor generation:  0.0336461067199707
mini_batch_src_global generation:  0.05030345916748047
r_  generation:  0.49852800369262695
local_output_nid generation:  0.03599238395690918
local_in_edges_tensor generation:  0.032655954360961914
mini_batch_src_global generation:  0.05663752555847168
r_  generation:  0.49320316314697266
local_output_nid generation:  0.035958051681518555
local_in_edges_tensor generation:  0.03948855400085449
mini_batch_src_global generation:  0.05203986167907715
r_  generation:  0.5078592300415039
local_output_nid generation:  0.03651618957519531
local_in_edges_tensor generation:  0.03339886665344238
mini_batch_src_global generation:  0.055284976959228516
r_  generation:  0.49709463119506836
local_output_nid generation:  0.036657094955444336
local_in_edges_tensor generation:  0.035214900970458984
mini_batch_src_global generation:  0.05317544937133789
r_  generation:  0.5095093250274658
local_output_nid generation:  0.03638315200805664
local_in_edges_tensor generation:  0.032578468322753906
mini_batch_src_global generation:  0.054739952087402344
r_  generation:  0.5022866725921631
----------------------check_connections_block total spend ----------------------------- 5.873937129974365
generate_one_block  0.6100966930389404
generate_one_block  0.6195557117462158
generate_one_block  0.6086487770080566
generate_one_block  0.6176009178161621
generate_one_block  0.6153442859649658
generate_one_block  0.6134724617004395
generate_one_block  0.633275032043457
generate_one_block  0.6148464679718018
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.13335227966308594  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

connection checking time:  9.874817609786987
block generation total time  8.402189016342163
average batch blocks generation time:  1.0502736270427704
block dataloader generation time/epoch 20.278020908958034
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10263395309448242  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.936281681060791  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10285711288452148  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9388527870178223  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10143375396728516  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9287757873535156  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10227680206298828  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9381985664367676  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10242700576782227  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9369673728942871  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10256719589233398  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9386801719665527  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10175323486328125  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.939727783203125  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1020808219909668  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9323201179504395  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08280134201049805 |0.013136029243469238 |0.0035492777824401855 |9.521842002868652e-05 |0.0038106441497802734 |0.0014476776123046875 |
----------------------------------------------------------pseudo_mini_loss sum 1.2231281995773315
Total (block generation + training)time/epoch 21.190112101404292
Training time/epoch 0.9033575057983398
Training time without block to device /epoch 0.7982692718505859
Training time without total dataloading part /epoch 0.06108880043029785
load block tensor time/epoch 0.6624107360839844
block to device time/epoch 0.1050882339477539
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 28 |
Number of nodes for computation during this epoch:  3018181
Number of first layer input nodes during this epoch:  1287029
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1327676773071289  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02247762680053711
random selection method range initialization spend 0.005434513092041016
time for parepare:  0.0169525146484375
local_output_nid generation:  0.004524946212768555
local_in_edges_tensor generation:  0.005648374557495117
mini_batch_src_global generation:  0.0032651424407958984
r_  generation:  0.04411745071411133
local_output_nid generation:  0.005974531173706055
local_in_edges_tensor generation:  0.003477334976196289
mini_batch_src_global generation:  0.009267330169677734
r_  generation:  0.04635190963745117
local_output_nid generation:  0.006706714630126953
local_in_edges_tensor generation:  0.003421306610107422
mini_batch_src_global generation:  0.0037682056427001953
r_  generation:  0.04642915725708008
local_output_nid generation:  0.0061376094818115234
local_in_edges_tensor generation:  0.0033426284790039062
mini_batch_src_global generation:  0.003675699234008789
r_  generation:  0.04869437217712402
local_output_nid generation:  0.0062122344970703125
local_in_edges_tensor generation:  0.0036330223083496094
mini_batch_src_global generation:  0.004056453704833984
r_  generation:  0.04831862449645996
local_output_nid generation:  0.0061702728271484375
local_in_edges_tensor generation:  0.0033113956451416016
mini_batch_src_global generation:  0.0040318965911865234
r_  generation:  0.04772138595581055
local_output_nid generation:  0.0061299800872802734
local_in_edges_tensor generation:  0.0033257007598876953
mini_batch_src_global generation:  0.004439115524291992
r_  generation:  0.05066728591918945
local_output_nid generation:  0.00619816780090332
local_in_edges_tensor generation:  0.003415346145629883
mini_batch_src_global generation:  0.0041353702545166016
r_  generation:  0.049017906188964844
----------------------check_connections_block total spend ----------------------------- 0.6057467460632324
generate_one_block  0.05944943428039551
generate_one_block  0.06128048896789551
generate_one_block  0.06153535842895508
generate_one_block  0.06371593475341797
generate_one_block  0.06263327598571777
generate_one_block  0.06166195869445801
generate_one_block  0.0667562484741211
generate_one_block  0.06280112266540527
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.038283348083496094
gen group dst list time:  0.018411874771118164
time for parepare:  0.01945328712463379
local_output_nid generation:  0.014902591705322266
local_in_edges_tensor generation:  0.03224897384643555
mini_batch_src_global generation:  0.03297090530395508
r_  generation:  0.3165318965911865
local_output_nid generation:  0.020793676376342773
local_in_edges_tensor generation:  0.024822473526000977
mini_batch_src_global generation:  0.03960466384887695
r_  generation:  0.3306901454925537
local_output_nid generation:  0.02047276496887207
local_in_edges_tensor generation:  0.020967483520507812
mini_batch_src_global generation:  0.03939986228942871
r_  generation:  0.33916807174682617
local_output_nid generation:  0.02062821388244629
local_in_edges_tensor generation:  0.019927024841308594
mini_batch_src_global generation:  0.03964853286743164
r_  generation:  0.34295201301574707
local_output_nid generation:  0.02077460289001465
local_in_edges_tensor generation:  0.021222352981567383
mini_batch_src_global generation:  0.04067635536193848
r_  generation:  0.3412501811981201
local_output_nid generation:  0.020851850509643555
local_in_edges_tensor generation:  0.02121257781982422
mini_batch_src_global generation:  0.04063272476196289
r_  generation:  0.34029293060302734
local_output_nid generation:  0.020392656326293945
local_in_edges_tensor generation:  0.021315336227416992
mini_batch_src_global generation:  0.04189038276672363
r_  generation:  0.34819555282592773
local_output_nid generation:  0.019962549209594727
local_in_edges_tensor generation:  0.01972365379333496
mini_batch_src_global generation:  0.04152512550354004
r_  generation:  0.3422839641571045
----------------------check_connections_block total spend ----------------------------- 3.952468156814575
generate_one_block  0.43413376808166504
generate_one_block  0.43251943588256836
generate_one_block  0.4298567771911621
generate_one_block  0.4358701705932617
generate_one_block  0.4362320899963379
generate_one_block  0.42768096923828125
generate_one_block  0.439652681350708
generate_one_block  0.46001148223876953
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03163504600524902
gen group dst list time:  0.038654327392578125
time for parepare:  0.01907968521118164
local_output_nid generation:  0.030224323272705078
local_in_edges_tensor generation:  0.04812216758728027
mini_batch_src_global generation:  0.04482626914978027
r_  generation:  0.4785759449005127
local_output_nid generation:  0.03593587875366211
local_in_edges_tensor generation:  0.036350250244140625
mini_batch_src_global generation:  0.055104732513427734
r_  generation:  0.4874448776245117
local_output_nid generation:  0.0356907844543457
local_in_edges_tensor generation:  0.032224178314208984
mini_batch_src_global generation:  0.051563262939453125
r_  generation:  0.496964693069458
local_output_nid generation:  0.03929495811462402
local_in_edges_tensor generation:  0.039517879486083984
mini_batch_src_global generation:  0.05438041687011719
r_  generation:  0.4933619499206543
local_output_nid generation:  0.037447452545166016
local_in_edges_tensor generation:  0.04048871994018555
mini_batch_src_global generation:  0.05583643913269043
r_  generation:  0.5013015270233154
local_output_nid generation:  0.03607654571533203
local_in_edges_tensor generation:  0.0327916145324707
mini_batch_src_global generation:  0.0550684928894043
r_  generation:  0.4937622547149658
local_output_nid generation:  0.03592872619628906
local_in_edges_tensor generation:  0.03270220756530762
mini_batch_src_global generation:  0.05652356147766113
r_  generation:  0.5020596981048584
local_output_nid generation:  0.03588509559631348
local_in_edges_tensor generation:  0.036741018295288086
mini_batch_src_global generation:  0.05543994903564453
r_  generation:  0.4956784248352051
----------------------check_connections_block total spend ----------------------------- 5.857309341430664
generate_one_block  0.6066620349884033
generate_one_block  0.6058776378631592
generate_one_block  0.6118409633636475
generate_one_block  0.6153666973114014
generate_one_block  0.6179876327514648
generate_one_block  0.6099586486816406
generate_one_block  0.6217312812805176
generate_one_block  0.6089389324188232
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1327676773071289  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

connection checking time:  9.80977749824524
block generation total time  8.394321203231812
average batch blocks generation time:  1.0492901504039764
block dataloader generation time/epoch 20.27604559659958
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10257196426391602  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.935060977935791  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10268640518188477  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9370865821838379  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10236787796020508  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9363970756530762  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1025848388671875  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9374117851257324  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10238885879516602  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9376668930053711  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1024465560913086  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9357929229736328  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.1027216911315918  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9405598640441895  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10163450241088867  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9370312690734863  GigaBytes
Max Memory Allocated: 1.087834358215332  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08482357859611511 |0.01196300983428955 |0.003516972064971924 |9.167194366455078e-05 |0.0037984848022460938 |0.0012958049774169922 |
----------------------------------------------------------pseudo_mini_loss sum 1.213551640510559
Total (block generation + training)time/epoch 21.187929213047028
Training time/epoch 0.907677412033081
Training time without block to device /epoch 0.8119733333587646
Training time without total dataloading part /epoch 0.06055283546447754
load block tensor time/epoch 0.6785886287689209
block to device time/epoch 0.0957040786743164
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 29 |
Number of nodes for computation during this epoch:  3019588
Number of first layer input nodes during this epoch:  1287029
