Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1646718209.5201344
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3580906391143799
range selection method range initialization spend 0.03164172172546387
time for parepare:  0.2767753601074219
local_output_nid generation:  0.024535179138183594
local_in_edges_tensor generation:  0.08750104904174805
mini_batch_src_global generation:  0.11665177345275879
r_  generation:  1.8045954704284668
local_output_nid generation:  0.02694845199584961
local_in_edges_tensor generation:  0.06459307670593262
mini_batch_src_global generation:  0.15057659149169922
r_  generation:  2.015984058380127
----------------------check_connections_block total spend ----------------------------- 5.156126022338867
generate_one_block  7.559075832366943
generate_one_block  2.422408103942871
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.0146937370300293
gen group dst list time:  0.06441235542297363
time for parepare:  0.4888145923614502
local_output_nid generation:  0.1803128719329834
local_in_edges_tensor generation:  0.7579476833343506
mini_batch_src_global generation:  1.0258419513702393
r_  generation:  15.532568216323853
local_output_nid generation:  0.5029442310333252
local_in_edges_tensor generation:  1.0541715621948242
mini_batch_src_global generation:  1.3367478847503662
r_  generation:  14.779987573623657
----------------------check_connections_block total spend ----------------------------- 40.53227710723877
generate_one_block  18.926820993423462
generate_one_block  19.046814441680908
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.282228708267212
gen group dst list time:  0.20967388153076172
time for parepare:  0.4913797378540039
local_output_nid generation:  0.41054224967956543
local_in_edges_tensor generation:  1.0610072612762451
mini_batch_src_global generation:  1.2735989093780518
r_  generation:  18.37800669670105
local_output_nid generation:  0.6542403697967529
local_in_edges_tensor generation:  1.3084464073181152
mini_batch_src_global generation:  1.59914231300354
r_  generation:  18.175395250320435
----------------------check_connections_block total spend ----------------------------- 49.70611095428467
generate_one_block  23.386512756347656
generate_one_block  23.048863887786865
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

connection checking time:  90.23838806152344
block generation total time  84.40901207923889
average batch blocks generation time:  42.204506039619446
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4959716796875 GB
    Memory Allocated: 1.4096403121948242  GigaBytes
Max Memory Allocated: 1.4096403121948242  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6326904296875 GB
    Memory Allocated: 3.9837546348571777  GigaBytes
Max Memory Allocated: 4.227200031280518  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.3885498046875 GB
    Memory Allocated: 1.4266834259033203  GigaBytes
Max Memory Allocated: 4.527637481689453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.3885498046875 GB
    Memory Allocated: 3.9847464561462402  GigaBytes
Max Memory Allocated: 4.527637481689453  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 8.79820442199707
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.20it/s] 16%|█▌        | 4/25 [00:00<00:01, 15.69it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.19it/s] 32%|███▏      | 8/25 [00:00<00:01, 15.66it/s] 40%|████      | 10/25 [00:00<00:00, 16.46it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.05it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.36it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.57it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.76it/s] 80%|████████  | 20/25 [00:01<00:00, 17.91it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.99it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.10it/s]100%|██████████| 25/25 [00:01<00:00, 17.55it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.11it/s]  8%|▊         | 2/25 [00:00<00:04,  4.82it/s] 12%|█▏        | 3/25 [00:00<00:04,  4.92it/s] 16%|█▌        | 4/25 [00:00<00:04,  4.80it/s] 20%|██        | 5/25 [00:01<00:04,  4.73it/s] 24%|██▍       | 6/25 [00:01<00:04,  4.62it/s] 28%|██▊       | 7/25 [00:01<00:03,  4.58it/s] 32%|███▏      | 8/25 [00:01<00:03,  4.75it/s] 36%|███▌      | 9/25 [00:01<00:03,  4.87it/s] 40%|████      | 10/25 [00:02<00:02,  5.00it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.13it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.20it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.25it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.24it/s] 60%|██████    | 15/25 [00:03<00:01,  5.25it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.25it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.15it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.12it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.17it/s] 80%|████████  | 20/25 [00:03<00:00,  5.19it/s] 84%|████████▍ | 21/25 [00:04<00:00,  5.14it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.18it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.22it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.21it/s]100%|██████████| 25/25 [00:04<00:00,  5.79it/s]100%|██████████| 25/25 [00:04<00:00,  5.13it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.12it/s]  8%|▊         | 2/25 [00:00<00:04,  4.99it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.07it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.17it/s] 20%|██        | 5/25 [00:00<00:03,  5.17it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.20it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.21it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.19it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.22it/s] 40%|████      | 10/25 [00:01<00:02,  5.23it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.22it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.24it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.24it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.24it/s] 60%|██████    | 15/25 [00:02<00:01,  5.25it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.28it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.26it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.26it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.27it/s] 80%|████████  | 20/25 [00:03<00:00,  5.27it/s] 84%|████████▍ | 21/25 [00:04<00:00,  5.29it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.30it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.29it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.30it/s]100%|██████████| 25/25 [00:04<00:00,  5.93it/s]100%|██████████| 25/25 [00:04<00:00,  5.31it/s]
Run 00 | Epoch 00000 | Loss 8.7982 | Train 0.0328 | Val 0.0312 | Test 0.0275
Number of nodes during this epoch:  4499026
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 16.1170654296875 GB
    Memory Allocated: 2.5986080169677734  GigaBytes
Max Memory Allocated: 10.38294792175293  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.4137871265411377
range selection method range initialization spend 0.03918290138244629
time for parepare:  0.29408788681030273
local_output_nid generation:  0.024449586868286133
local_in_edges_tensor generation:  0.09150815010070801
mini_batch_src_global generation:  0.11769890785217285
r_  generation:  1.9175336360931396
local_output_nid generation:  0.027642250061035156
local_in_edges_tensor generation:  0.0725398063659668
mini_batch_src_global generation:  0.1535947322845459
r_  generation:  2.053600788116455
----------------------check_connections_block total spend ----------------------------- 5.395310878753662
generate_one_block  2.9090147018432617
generate_one_block  2.9389686584472656
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.2236852645874023
gen group dst list time:  0.06891512870788574
time for parepare:  0.49205565452575684
local_output_nid generation:  0.1815352439880371
local_in_edges_tensor generation:  0.7552828788757324
mini_batch_src_global generation:  1.0412755012512207
r_  generation:  15.111690282821655
local_output_nid generation:  0.3516075611114502
local_in_edges_tensor generation:  0.9408807754516602
mini_batch_src_global generation:  1.3920297622680664
r_  generation:  15.162388801574707
----------------------check_connections_block total spend ----------------------------- 40.31093788146973
generate_one_block  19.319137573242188
generate_one_block  19.002976179122925
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.4325177669525146
gen group dst list time:  0.1540539264678955
time for parepare:  0.4871988296508789
local_output_nid generation:  0.3966548442840576
local_in_edges_tensor generation:  1.0771167278289795
mini_batch_src_global generation:  1.234360694885254
r_  generation:  18.334667205810547
local_output_nid generation:  0.6448886394500732
local_in_edges_tensor generation:  1.388275384902954
mini_batch_src_global generation:  1.604276180267334
r_  generation:  18.3390531539917
----------------------check_connections_block total spend ----------------------------- 49.66039490699768
generate_one_block  23.511382579803467
generate_one_block  23.942044258117676
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 16.1170654296875 GB
    Memory Allocated: 2.5986080169677734  GigaBytes
Max Memory Allocated: 10.38294792175293  GigaBytes

connection checking time:  89.97133278846741
block generation total time  85.77554059028625
average batch blocks generation time:  42.88777029514313
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1170654296875 GB
    Memory Allocated: 1.4266510009765625  GigaBytes
Max Memory Allocated: 10.38294792175293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1170654296875 GB
    Memory Allocated: 3.983522415161133  GigaBytes
Max Memory Allocated: 10.38294792175293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1170654296875 GB
    Memory Allocated: 1.4274487495422363  GigaBytes
Max Memory Allocated: 10.38294792175293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1170654296875 GB
    Memory Allocated: 3.9886879920959473  GigaBytes
Max Memory Allocated: 10.38294792175293  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.157959461212158
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 16.10it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.94it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.55it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.90it/s] 40%|████      | 10/25 [00:00<00:00, 17.95it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.96it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.08it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.17it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.29it/s] 80%|████████  | 20/25 [00:01<00:00, 18.28it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.19it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.25it/s]100%|██████████| 25/25 [00:01<00:00, 18.27it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.36it/s]  8%|▊         | 2/25 [00:00<00:04,  5.34it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.31it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.35it/s] 20%|██        | 5/25 [00:00<00:03,  5.33it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.37it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.36it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.38it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.36it/s] 40%|████      | 10/25 [00:01<00:02,  5.38it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.38it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.39it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.40it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.39it/s] 60%|██████    | 15/25 [00:02<00:01,  5.39it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.39it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.37it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.37it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.36it/s] 80%|████████  | 20/25 [00:03<00:00,  5.31it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.29it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.31it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.32it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.20it/s]100%|██████████| 25/25 [00:04<00:00,  5.69it/s]100%|██████████| 25/25 [00:04<00:00,  5.39it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.65it/s]  8%|▊         | 2/25 [00:00<00:04,  5.03it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.14it/s] 16%|█▌        | 4/25 [00:00<00:04,  4.96it/s] 20%|██        | 5/25 [00:00<00:03,  5.05it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.10it/s] 28%|██▊       | 7/25 [00:01<00:03,  4.94it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.05it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.11it/s] 40%|████      | 10/25 [00:01<00:02,  5.16it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.15it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.20it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.22it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.24it/s] 60%|██████    | 15/25 [00:02<00:02,  4.98it/s] 64%|██████▍   | 16/25 [00:03<00:01,  4.86it/s] 68%|██████▊   | 17/25 [00:03<00:01,  4.89it/s] 72%|███████▏  | 18/25 [00:03<00:01,  4.98it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.01it/s] 80%|████████  | 20/25 [00:03<00:00,  5.09it/s] 84%|████████▍ | 21/25 [00:04<00:00,  5.14it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.18it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.23it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.20it/s]100%|██████████| 25/25 [00:04<00:00,  5.86it/s]100%|██████████| 25/25 [00:04<00:00,  5.17it/s]
Run 00 | Epoch 00001 | Loss 5.1580 | Train 0.0903 | Val 0.0852 | Test 0.0657
Number of nodes during this epoch:  4499215
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.600698947906494  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.37827324867248535
range selection method range initialization spend 0.032621145248413086
time for parepare:  0.25989627838134766
local_output_nid generation:  0.024084091186523438
local_in_edges_tensor generation:  0.05708575248718262
mini_batch_src_global generation:  0.11358094215393066
r_  generation:  1.7996199131011963
local_output_nid generation:  0.02714252471923828
local_in_edges_tensor generation:  0.044595956802368164
mini_batch_src_global generation:  0.15279674530029297
r_  generation:  1.9156510829925537
----------------------check_connections_block total spend ----------------------------- 4.976594686508179
generate_one_block  2.6890130043029785
generate_one_block  2.3173961639404297
The real block id is  1
get_global_graph_edges_ids_block function  spend 1.9389121532440186
gen group dst list time:  0.0672461986541748
time for parepare:  0.4560115337371826
local_output_nid generation:  0.19804120063781738
local_in_edges_tensor generation:  0.8185410499572754
mini_batch_src_global generation:  1.0483474731445312
r_  generation:  14.622262954711914
local_output_nid generation:  0.3520793914794922
local_in_edges_tensor generation:  1.004091501235962
mini_batch_src_global generation:  1.4254300594329834
r_  generation:  14.409485101699829
----------------------check_connections_block total spend ----------------------------- 39.40650129318237
generate_one_block  19.09666633605957
generate_one_block  19.090444326400757
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.2473037242889404
gen group dst list time:  0.1573326587677002
time for parepare:  0.45345187187194824
local_output_nid generation:  0.3831956386566162
local_in_edges_tensor generation:  1.0419411659240723
mini_batch_src_global generation:  1.2839293479919434
r_  generation:  18.619850158691406
local_output_nid generation:  0.6764101982116699
local_in_edges_tensor generation:  1.3870530128479004
mini_batch_src_global generation:  1.6892480850219727
r_  generation:  18.30227565765381
----------------------check_connections_block total spend ----------------------------- 49.9298152923584
generate_one_block  23.439672708511353
generate_one_block  23.794729471206665
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.600698947906494  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

connection checking time:  89.33631658554077
block generation total time  85.42151284217834
average batch blocks generation time:  42.71075642108917
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.4273419380187988  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.986104965209961  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.4269757270812988  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.985517978668213  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.722501754760742
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 16.63it/s] 16%|█▌        | 4/25 [00:00<00:01, 17.51it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.71it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.98it/s] 40%|████      | 10/25 [00:00<00:00, 18.09it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.08it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.03it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.98it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.88it/s] 80%|████████  | 20/25 [00:01<00:00, 17.85it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.95it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.07it/s]100%|██████████| 25/25 [00:01<00:00, 18.19it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.37it/s]  8%|▊         | 2/25 [00:00<00:04,  5.37it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.36it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.32it/s] 20%|██        | 5/25 [00:00<00:03,  5.35it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.31it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.29it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.31it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.32it/s] 40%|████      | 10/25 [00:01<00:02,  5.30it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.30it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.32it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.31it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.28it/s] 60%|██████    | 15/25 [00:02<00:01,  5.28it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.30it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.31it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.29it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.28it/s] 80%|████████  | 20/25 [00:03<00:00,  5.31it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.27it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.28it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.26it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.20it/s]100%|██████████| 25/25 [00:04<00:00,  5.87it/s]100%|██████████| 25/25 [00:04<00:00,  5.37it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.07it/s]  8%|▊         | 2/25 [00:00<00:04,  5.19it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.20it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.21it/s] 20%|██        | 5/25 [00:00<00:03,  5.20it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.21it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.23it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.23it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.22it/s] 40%|████      | 10/25 [00:01<00:02,  5.22it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.22it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.20it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.21it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.22it/s] 60%|██████    | 15/25 [00:02<00:01,  5.21it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.23it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.21it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.23it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.23it/s] 80%|████████  | 20/25 [00:03<00:00,  5.22it/s] 84%|████████▍ | 21/25 [00:04<00:00,  5.23it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.24it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.22it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.23it/s]100%|██████████| 25/25 [00:04<00:00,  5.85it/s]100%|██████████| 25/25 [00:04<00:00,  5.29it/s]
Run 00 | Epoch 00002 | Loss 3.7225 | Train 0.2001 | Val 0.1895 | Test 0.1400
Number of nodes during this epoch:  4499647
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.598860263824463  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.21587347984313965
range selection method range initialization spend 0.035401105880737305
time for parepare:  0.26307129859924316
local_output_nid generation:  0.024205446243286133
local_in_edges_tensor generation:  0.04572010040283203
mini_batch_src_global generation:  0.11431288719177246
r_  generation:  1.809323787689209
local_output_nid generation:  0.02630019187927246
local_in_edges_tensor generation:  0.04812884330749512
mini_batch_src_global generation:  0.14821314811706543
r_  generation:  1.904691219329834
----------------------check_connections_block total spend ----------------------------- 4.9760003089904785
generate_one_block  2.33423113822937
generate_one_block  2.2900545597076416
The real block id is  1
get_global_graph_edges_ids_block function  spend 1.984792709350586
gen group dst list time:  0.0615696907043457
time for parepare:  0.4320549964904785
local_output_nid generation:  0.1777019500732422
local_in_edges_tensor generation:  0.7408089637756348
mini_batch_src_global generation:  1.0133380889892578
r_  generation:  13.925297975540161
local_output_nid generation:  0.3136153221130371
local_in_edges_tensor generation:  0.9235491752624512
mini_batch_src_global generation:  1.278195858001709
r_  generation:  14.314878702163696
----------------------check_connections_block total spend ----------------------------- 37.83056044578552
generate_one_block  18.967738151550293
generate_one_block  18.9714035987854
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.265486717224121
gen group dst list time:  0.16440653800964355
time for parepare:  0.43111467361450195
local_output_nid generation:  0.3711209297180176
local_in_edges_tensor generation:  1.1231920719146729
mini_batch_src_global generation:  1.2288885116577148
r_  generation:  18.222839832305908
local_output_nid generation:  0.6593739986419678
local_in_edges_tensor generation:  1.3493776321411133
mini_batch_src_global generation:  1.747161865234375
r_  generation:  18.391098976135254
----------------------check_connections_block total spend ----------------------------- 49.62273812294006
generate_one_block  23.310054063796997
generate_one_block  23.572577476501465
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.598860263824463  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

connection checking time:  87.45329856872559
block generation total time  84.82177329063416
average batch blocks generation time:  42.41088664531708
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.4273433685302734  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.984732151031494  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.4268884658813477  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.984963893890381  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.135571002960205
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 16.77it/s] 16%|█▌        | 4/25 [00:00<00:01, 17.07it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.09it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.12it/s] 40%|████      | 10/25 [00:00<00:00, 16.97it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.31it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.56it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.88it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.11it/s] 80%|████████  | 20/25 [00:01<00:00, 18.21it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.29it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.31it/s]100%|██████████| 25/25 [00:01<00:00, 17.99it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.15it/s]  8%|▊         | 2/25 [00:00<00:03,  6.03it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.01it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.94it/s] 20%|██        | 5/25 [00:00<00:03,  5.51it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.50it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.52it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.52it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.51it/s] 40%|████      | 10/25 [00:01<00:02,  5.51it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.50it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.45it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.47it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.46it/s] 60%|██████    | 15/25 [00:02<00:01,  5.46it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.40it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.42it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.37it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.39it/s] 80%|████████  | 20/25 [00:03<00:00,  5.38it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.38it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.37it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.37it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.35it/s]100%|██████████| 25/25 [00:04<00:00,  6.00it/s]100%|██████████| 25/25 [00:04<00:00,  5.56it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.23it/s]  8%|▊         | 2/25 [00:00<00:04,  5.26it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.23it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.27it/s] 20%|██        | 5/25 [00:00<00:03,  5.22it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.22it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.24it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.25it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.26it/s] 40%|████      | 10/25 [00:01<00:02,  5.25it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.25it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.26it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.26it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.26it/s] 60%|██████    | 15/25 [00:02<00:01,  5.26it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.26it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.24it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.25it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.23it/s] 80%|████████  | 20/25 [00:03<00:00,  5.19it/s] 84%|████████▍ | 21/25 [00:04<00:00,  5.19it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.21it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.24it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.25it/s]100%|██████████| 25/25 [00:04<00:00,  5.82it/s]100%|██████████| 25/25 [00:04<00:00,  5.31it/s]
Run 00 | Epoch 00003 | Loss 3.1356 | Train 0.2874 | Val 0.2739 | Test 0.2001
Number of nodes during this epoch:  4498789
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.5989418029785156  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3123033046722412
range selection method range initialization spend 0.030640602111816406
time for parepare:  0.3129901885986328
local_output_nid generation:  0.025388717651367188
local_in_edges_tensor generation:  0.062322378158569336
mini_batch_src_global generation:  0.12161016464233398
r_  generation:  1.882493495941162
local_output_nid generation:  0.02834939956665039
local_in_edges_tensor generation:  0.059038400650024414
mini_batch_src_global generation:  0.14737462997436523
r_  generation:  2.014317274093628
----------------------check_connections_block total spend ----------------------------- 5.298746824264526
generate_one_block  2.810842275619507
generate_one_block  2.356102466583252
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.197221040725708
gen group dst list time:  0.0638127326965332
time for parepare:  0.41848111152648926
local_output_nid generation:  0.18494367599487305
local_in_edges_tensor generation:  0.738206148147583
mini_batch_src_global generation:  1.037876844406128
r_  generation:  15.005248308181763
local_output_nid generation:  0.35587430000305176
local_in_edges_tensor generation:  0.9818341732025146
mini_batch_src_global generation:  1.4457898139953613
r_  generation:  14.389546394348145
----------------------check_connections_block total spend ----------------------------- 39.6659038066864
generate_one_block  18.918145418167114
generate_one_block  19.136230945587158
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.2785990238189697
gen group dst list time:  0.19598650932312012
time for parepare:  0.48734307289123535
local_output_nid generation:  0.3967771530151367
local_in_edges_tensor generation:  1.0735135078430176
mini_batch_src_global generation:  1.248211145401001
r_  generation:  18.418588399887085
local_output_nid generation:  0.6550962924957275
local_in_edges_tensor generation:  1.318354606628418
mini_batch_src_global generation:  1.7597758769989014
r_  generation:  18.310591220855713
----------------------check_connections_block total spend ----------------------------- 49.82698655128479
generate_one_block  23.272310972213745
generate_one_block  23.648674726486206
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.5989418029785156  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

connection checking time:  89.49289035797119
block generation total time  84.97536206245422
average batch blocks generation time:  42.48768103122711
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.4267001152038574  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.984428882598877  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.4276933670043945  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.9862403869628906  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.6915435791015625
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 16.87it/s] 16%|█▌        | 4/25 [00:00<00:01, 17.65it/s] 24%|██▍       | 6/25 [00:00<00:01, 18.02it/s] 32%|███▏      | 8/25 [00:00<00:00, 18.21it/s] 40%|████      | 10/25 [00:00<00:00, 18.13it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.24it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.31it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.43it/s] 72%|███████▏  | 18/25 [00:00<00:00, 18.50it/s] 80%|████████  | 20/25 [00:01<00:00, 18.51it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.38it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.39it/s]100%|██████████| 25/25 [00:01<00:00, 18.57it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.24it/s]  8%|▊         | 2/25 [00:00<00:04,  5.25it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.32it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.36it/s] 20%|██        | 5/25 [00:00<00:03,  5.36it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.38it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.40it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.37it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.40it/s] 40%|████      | 10/25 [00:01<00:02,  5.38it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.36it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.31it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.33it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.35it/s] 60%|██████    | 15/25 [00:02<00:01,  5.26it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.30it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.30it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.30it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.33it/s] 80%|████████  | 20/25 [00:03<00:00,  5.32it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.34it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.32it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.32it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.32it/s]100%|██████████| 25/25 [00:04<00:00,  5.98it/s]100%|██████████| 25/25 [00:04<00:00,  5.41it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.25it/s]  8%|▊         | 2/25 [00:00<00:04,  5.25it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.18it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.22it/s] 20%|██        | 5/25 [00:00<00:03,  5.24it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.25it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.23it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.25it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.25it/s] 40%|████      | 10/25 [00:01<00:02,  5.27it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.27it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.26it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.27it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.24it/s] 60%|██████    | 15/25 [00:02<00:01,  5.22it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.22it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.23it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.23it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.24it/s] 80%|████████  | 20/25 [00:03<00:00,  5.24it/s] 84%|████████▍ | 21/25 [00:04<00:00,  5.23it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.23it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.22it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.22it/s]100%|██████████| 25/25 [00:04<00:00,  5.87it/s]100%|██████████| 25/25 [00:04<00:00,  5.31it/s]
Run 00 | Epoch 00004 | Loss 2.6915 | Train 0.3470 | Val 0.3293 | Test 0.2402
Number of nodes during this epoch:  4500019
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.599968910217285  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.21964240074157715
range selection method range initialization spend 0.04002833366394043
time for parepare:  0.30011963844299316
local_output_nid generation:  0.024570941925048828
local_in_edges_tensor generation:  0.0604701042175293
mini_batch_src_global generation:  0.11191415786743164
r_  generation:  1.8492927551269531
local_output_nid generation:  0.026703357696533203
local_in_edges_tensor generation:  0.055109500885009766
mini_batch_src_global generation:  0.1470470428466797
r_  generation:  1.9719569683074951
----------------------check_connections_block total spend ----------------------------- 5.155716419219971
generate_one_block  2.745586395263672
generate_one_block  2.347719669342041
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.1321613788604736
gen group dst list time:  0.06487846374511719
time for parepare:  0.5222492218017578
local_output_nid generation:  0.21313762664794922
local_in_edges_tensor generation:  0.7882499694824219
mini_batch_src_global generation:  1.0489532947540283
r_  generation:  14.445012092590332
local_output_nid generation:  0.41672539710998535
local_in_edges_tensor generation:  0.961860179901123
mini_batch_src_global generation:  1.44545578956604
r_  generation:  14.20043396949768
----------------------check_connections_block total spend ----------------------------- 39.021345376968384
generate_one_block  18.782980918884277
generate_one_block  19.076054334640503
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.1425111293792725
gen group dst list time:  0.16544127464294434
time for parepare:  0.447887659072876
local_output_nid generation:  0.37674808502197266
local_in_edges_tensor generation:  1.0889182090759277
mini_batch_src_global generation:  1.2554748058319092
r_  generation:  18.390274047851562
local_output_nid generation:  0.6489226818084717
local_in_edges_tensor generation:  1.33298921585083
mini_batch_src_global generation:  1.7319352626800537
r_  generation:  18.324655055999756
----------------------check_connections_block total spend ----------------------------- 49.84144163131714
generate_one_block  23.228907346725464
generate_one_block  23.73879909515381
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.599968910217285  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

connection checking time:  88.86278700828552
block generation total time  84.82674169540405
average batch blocks generation time:  42.413370847702026
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.4270362854003906  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.9854912757873535  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.428812026977539  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.986689567565918  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.4025940895080566
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 16.53it/s] 16%|█▌        | 4/25 [00:00<00:01, 17.42it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.80it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.92it/s] 40%|████      | 10/25 [00:00<00:00, 18.09it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.22it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.28it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.34it/s] 72%|███████▏  | 18/25 [00:00<00:00, 18.41it/s] 80%|████████  | 20/25 [00:01<00:00, 18.41it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.43it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.35it/s]100%|██████████| 25/25 [00:01<00:00, 18.47it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.29it/s]  8%|▊         | 2/25 [00:00<00:04,  5.25it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.27it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.32it/s] 20%|██        | 5/25 [00:00<00:03,  5.30it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.31it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.32it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.35it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.40it/s] 40%|████      | 10/25 [00:01<00:02,  5.42it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.43it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.40it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.40it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.39it/s] 60%|██████    | 15/25 [00:02<00:01,  5.35it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.37it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.39it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.36it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.37it/s] 80%|████████  | 20/25 [00:03<00:00,  5.35it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.37it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.29it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.32it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.32it/s]100%|██████████| 25/25 [00:04<00:00,  6.04it/s]100%|██████████| 25/25 [00:04<00:00,  5.44it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.21it/s]  8%|▊         | 2/25 [00:00<00:04,  5.24it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.22it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.26it/s] 20%|██        | 5/25 [00:00<00:03,  5.26it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.27it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.29it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.26it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.22it/s] 40%|████      | 10/25 [00:01<00:02,  5.24it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.24it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.23it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.21it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.21it/s] 60%|██████    | 15/25 [00:02<00:01,  5.23it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.24it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.23it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.22it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.24it/s] 80%|████████  | 20/25 [00:03<00:00,  5.22it/s] 84%|████████▍ | 21/25 [00:04<00:00,  5.22it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.21it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.24it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.21it/s]100%|██████████| 25/25 [00:04<00:00,  5.87it/s]100%|██████████| 25/25 [00:04<00:00,  5.31it/s]
Run 00 | Epoch 00005 | Loss 2.4026 | Train 0.3878 | Val 0.3689 | Test 0.2689
Number of nodes during this epoch:  4500332
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.6003689765930176  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.2862427234649658
range selection method range initialization spend 0.03248763084411621
time for parepare:  0.2829909324645996
local_output_nid generation:  0.02469015121459961
local_in_edges_tensor generation:  0.06609392166137695
mini_batch_src_global generation:  0.11343216896057129
r_  generation:  1.8197619915008545
local_output_nid generation:  0.031077146530151367
local_in_edges_tensor generation:  0.04120039939880371
mini_batch_src_global generation:  0.14248204231262207
r_  generation:  1.9956274032592773
----------------------check_connections_block total spend ----------------------------- 5.1197428703308105
generate_one_block  2.6963419914245605
generate_one_block  2.298881769180298
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.103295087814331
gen group dst list time:  0.07440805435180664
time for parepare:  0.4551107883453369
local_output_nid generation:  0.193770170211792
local_in_edges_tensor generation:  0.776465892791748
mini_batch_src_global generation:  1.0311808586120605
r_  generation:  14.518139123916626
local_output_nid generation:  0.353665828704834
local_in_edges_tensor generation:  0.9716958999633789
mini_batch_src_global generation:  1.336909532546997
r_  generation:  14.616293907165527
----------------------check_connections_block total spend ----------------------------- 39.103636503219604
generate_one_block  19.110727548599243
generate_one_block  19.140023708343506
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.2659072875976562
gen group dst list time:  0.15413236618041992
time for parepare:  0.43057966232299805
local_output_nid generation:  0.38046979904174805
local_in_edges_tensor generation:  1.0613031387329102
mini_batch_src_global generation:  1.2817022800445557
r_  generation:  18.500770330429077
local_output_nid generation:  0.6447470188140869
local_in_edges_tensor generation:  1.4508028030395508
mini_batch_src_global generation:  1.7484192848205566
r_  generation:  18.480371713638306
----------------------check_connections_block total spend ----------------------------- 50.12509298324585
generate_one_block  23.368879795074463
generate_one_block  23.609994411468506
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.6003689765930176  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

connection checking time:  89.22872948646545
block generation total time  85.22962546348572
average batch blocks generation time:  42.61481273174286
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.4270315170288086  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.987079620361328  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.4268693923950195  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.983673095703125  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.1761550903320312
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.93it/s] 16%|█▌        | 4/25 [00:00<00:01, 17.13it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.63it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.99it/s] 40%|████      | 10/25 [00:00<00:00, 18.00it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.21it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.34it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.34it/s] 72%|███████▏  | 18/25 [00:00<00:00, 18.46it/s] 80%|████████  | 20/25 [00:01<00:00, 18.33it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.43it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.46it/s]100%|██████████| 25/25 [00:01<00:00, 18.45it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.28it/s]  8%|▊         | 2/25 [00:00<00:04,  5.25it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.31it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.31it/s] 20%|██        | 5/25 [00:00<00:03,  5.29it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.31it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.29it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.30it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.25it/s] 40%|████      | 10/25 [00:01<00:02,  5.27it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.31it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.27it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.28it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.30it/s] 60%|██████    | 15/25 [00:02<00:01,  5.26it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.27it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.29it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.23it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.25it/s] 80%|████████  | 20/25 [00:03<00:00,  5.26it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.28it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.30it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.29it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.31it/s]100%|██████████| 25/25 [00:04<00:00,  5.96it/s]100%|██████████| 25/25 [00:04<00:00,  5.36it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.22it/s]  8%|▊         | 2/25 [00:00<00:04,  5.26it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.27it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.27it/s] 20%|██        | 5/25 [00:00<00:03,  5.22it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.24it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.25it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.26it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.25it/s] 40%|████      | 10/25 [00:01<00:02,  5.26it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.26it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.25it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.24it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.27it/s] 60%|██████    | 15/25 [00:02<00:01,  5.27it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.26it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.25it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.24it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.22it/s] 80%|████████  | 20/25 [00:03<00:00,  5.23it/s] 84%|████████▍ | 21/25 [00:04<00:00,  5.23it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.22it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.23it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.24it/s]100%|██████████| 25/25 [00:04<00:00,  5.90it/s]100%|██████████| 25/25 [00:04<00:00,  5.32it/s]
Run 00 | Epoch 00006 | Loss 2.1762 | Train 0.4182 | Val 0.3972 | Test 0.2913
Number of nodes during this epoch:  4497886
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.5980234146118164  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.2149217128753662
range selection method range initialization spend 0.03335428237915039
time for parepare:  0.2799389362335205
local_output_nid generation:  0.024423599243164062
local_in_edges_tensor generation:  0.05571722984313965
mini_batch_src_global generation:  0.11642289161682129
r_  generation:  1.8046672344207764
local_output_nid generation:  0.026741981506347656
local_in_edges_tensor generation:  0.04345703125
mini_batch_src_global generation:  0.14366817474365234
r_  generation:  1.9281435012817383
----------------------check_connections_block total spend ----------------------------- 5.014308214187622
generate_one_block  2.3165881633758545
generate_one_block  2.29793643951416
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.015627861022949
gen group dst list time:  0.06232094764709473
time for parepare:  0.4273529052734375
local_output_nid generation:  0.1827073097229004
local_in_edges_tensor generation:  0.7334713935852051
mini_batch_src_global generation:  1.0156152248382568
r_  generation:  13.99799633026123
local_output_nid generation:  0.3136270046234131
local_in_edges_tensor generation:  0.9618320465087891
mini_batch_src_global generation:  1.3110175132751465
r_  generation:  14.294307231903076
----------------------check_connections_block total spend ----------------------------- 37.90189814567566
generate_one_block  18.81331205368042
generate_one_block  18.55143642425537
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.234555244445801
gen group dst list time:  0.2031562328338623
time for parepare:  0.47115492820739746
local_output_nid generation:  0.3935105800628662
local_in_edges_tensor generation:  1.0510969161987305
mini_batch_src_global generation:  1.318629503250122
r_  generation:  18.52848744392395
local_output_nid generation:  0.6502225399017334
local_in_edges_tensor generation:  1.3167176246643066
mini_batch_src_global generation:  1.757413387298584
r_  generation:  18.454901933670044
----------------------check_connections_block total spend ----------------------------- 50.151922941207886
generate_one_block  23.34792423248291
generate_one_block  23.73766803741455
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.5980234146118164  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

connection checking time:  88.05382108688354
block generation total time  84.45034074783325
average batch blocks generation time:  42.225170373916626
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.426971435546875  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.9855380058288574  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.4274201393127441  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.9844369888305664  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.0023932456970215
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 16.44it/s] 16%|█▌        | 4/25 [00:00<00:01, 17.01it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.31it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.49it/s] 40%|████      | 10/25 [00:00<00:00, 17.52it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.48it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.23it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.59it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.71it/s] 80%|████████  | 20/25 [00:01<00:00, 17.90it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.85it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.80it/s]100%|██████████| 25/25 [00:01<00:00, 17.88it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.03it/s]  8%|▊         | 2/25 [00:00<00:03,  6.07it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.06it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.93it/s] 20%|██        | 5/25 [00:00<00:03,  5.56it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.50it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.44it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.41it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.40it/s] 40%|████      | 10/25 [00:01<00:02,  5.39it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.40it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.41it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.40it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.40it/s] 60%|██████    | 15/25 [00:02<00:01,  5.39it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.38it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.38it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.37it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.36it/s] 80%|████████  | 20/25 [00:03<00:00,  5.36it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.36it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.36it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.34it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.32it/s]100%|██████████| 25/25 [00:04<00:00,  5.96it/s]100%|██████████| 25/25 [00:04<00:00,  5.51it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.21it/s]  8%|▊         | 2/25 [00:00<00:04,  5.19it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.23it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.25it/s] 20%|██        | 5/25 [00:00<00:03,  5.26it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.25it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.22it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.22it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.22it/s] 40%|████      | 10/25 [00:01<00:02,  5.23it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.21it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.23it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.21it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.20it/s] 60%|██████    | 15/25 [00:02<00:01,  5.21it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.22it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.24it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.24it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.24it/s] 80%|████████  | 20/25 [00:03<00:00,  5.25it/s] 84%|████████▍ | 21/25 [00:04<00:00,  5.25it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.23it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.20it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.19it/s]100%|██████████| 25/25 [00:04<00:00,  5.77it/s]100%|██████████| 25/25 [00:04<00:00,  5.29it/s]
Run 00 | Epoch 00007 | Loss 2.0024 | Train 0.4406 | Val 0.4204 | Test 0.3097
Number of nodes during this epoch:  4499276
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.598715305328369  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3023500442504883
range selection method range initialization spend 0.03248119354248047
time for parepare:  0.2666008472442627
local_output_nid generation:  0.024576902389526367
local_in_edges_tensor generation:  0.06196475028991699
mini_batch_src_global generation:  0.1153416633605957
r_  generation:  1.7913801670074463
local_output_nid generation:  0.026569843292236328
local_in_edges_tensor generation:  0.04079413414001465
mini_batch_src_global generation:  0.1422111988067627
r_  generation:  1.9137296676635742
----------------------check_connections_block total spend ----------------------------- 4.96827507019043
generate_one_block  2.722933530807495
generate_one_block  2.340015172958374
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.049377918243408
gen group dst list time:  0.06312179565429688
time for parepare:  0.4348454475402832
local_output_nid generation:  0.1851787567138672
local_in_edges_tensor generation:  0.8758499622344971
mini_batch_src_global generation:  1.052199363708496
r_  generation:  14.28420639038086
local_output_nid generation:  0.35074710845947266
local_in_edges_tensor generation:  1.0108203887939453
mini_batch_src_global generation:  1.3300564289093018
r_  generation:  14.464885234832764
----------------------check_connections_block total spend ----------------------------- 38.83704447746277
generate_one_block  18.862350940704346
generate_one_block  18.84517002105713
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.226095676422119
gen group dst list time:  0.14965558052062988
time for parepare:  0.4123103618621826
local_output_nid generation:  0.35504865646362305
local_in_edges_tensor generation:  0.9941949844360352
mini_batch_src_global generation:  1.2107751369476318
r_  generation:  17.646342515945435
local_output_nid generation:  0.5919792652130127
local_in_edges_tensor generation:  1.254026174545288
mini_batch_src_global generation:  1.6306633949279785
r_  generation:  17.753917694091797
----------------------check_connections_block total spend ----------------------------- 47.90158653259277
generate_one_block  22.92175817489624
generate_one_block  23.55105996131897
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.598715305328369  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

connection checking time:  86.73863101005554
block generation total time  84.18033909797668
average batch blocks generation time:  42.09016954898834
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.4270777702331543  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.986053466796875  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.427112102508545  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.985135078430176  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8580143451690674
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.87it/s] 16%|█▌        | 4/25 [00:00<00:01, 17.08it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.63it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.97it/s] 40%|████      | 10/25 [00:00<00:00, 17.97it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.00it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.20it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.31it/s] 72%|███████▏  | 18/25 [00:00<00:00, 18.39it/s] 80%|████████  | 20/25 [00:01<00:00, 18.36it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.43it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.29it/s]100%|██████████| 25/25 [00:01<00:00, 18.35it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.30it/s]  8%|▊         | 2/25 [00:00<00:04,  5.27it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.28it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.32it/s] 20%|██        | 5/25 [00:00<00:03,  5.30it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.31it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.33it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.32it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.31it/s] 40%|████      | 10/25 [00:01<00:02,  5.33it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.33it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.30it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.34it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.34it/s] 60%|██████    | 15/25 [00:02<00:01,  5.34it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.31it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.29it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.29it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.30it/s] 80%|████████  | 20/25 [00:03<00:00,  5.22it/s] 84%|████████▍ | 21/25 [00:03<00:00,  4.99it/s] 88%|████████▊ | 22/25 [00:04<00:00,  4.82it/s] 92%|█████████▏| 23/25 [00:04<00:00,  4.80it/s] 96%|█████████▌| 24/25 [00:04<00:00,  4.68it/s]100%|██████████| 25/25 [00:04<00:00,  5.00it/s]100%|██████████| 25/25 [00:04<00:00,  5.18it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.13it/s]  8%|▊         | 2/25 [00:00<00:04,  5.18it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.20it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.22it/s] 20%|██        | 5/25 [00:00<00:03,  5.20it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.20it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.21it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.20it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.22it/s] 40%|████      | 10/25 [00:01<00:02,  5.18it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.16it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.15it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.16it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.20it/s] 60%|██████    | 15/25 [00:02<00:01,  5.21it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.22it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.22it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.21it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.19it/s] 80%|████████  | 20/25 [00:03<00:00,  5.18it/s] 84%|████████▍ | 21/25 [00:04<00:00,  5.19it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.17it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.20it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.20it/s]100%|██████████| 25/25 [00:04<00:00,  5.83it/s]100%|██████████| 25/25 [00:04<00:00,  5.27it/s]
Run 00 | Epoch 00008 | Loss 1.8580 | Train 0.4585 | Val 0.4393 | Test 0.3251
Number of nodes during this epoch:  4499475
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.5989885330200195  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.2922840118408203
range selection method range initialization spend 0.03304100036621094
time for parepare:  0.2598378658294678
local_output_nid generation:  0.02421879768371582
local_in_edges_tensor generation:  0.05281257629394531
mini_batch_src_global generation:  0.11431169509887695
r_  generation:  1.8256006240844727
local_output_nid generation:  0.026250839233398438
local_in_edges_tensor generation:  0.050429344177246094
mini_batch_src_global generation:  0.1442887783050537
r_  generation:  1.9302570819854736
----------------------check_connections_block total spend ----------------------------- 5.024746894836426
generate_one_block  2.7413523197174072
generate_one_block  2.328336000442505
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.2606849670410156
gen group dst list time:  0.06198525428771973
time for parepare:  0.43709826469421387
local_output_nid generation:  0.18603730201721191
local_in_edges_tensor generation:  0.7483956813812256
mini_batch_src_global generation:  1.0314319133758545
r_  generation:  14.390437602996826
local_output_nid generation:  0.364715576171875
local_in_edges_tensor generation:  0.9650671482086182
mini_batch_src_global generation:  1.4405758380889893
r_  generation:  14.408693552017212
----------------------check_connections_block total spend ----------------------------- 38.90152978897095
generate_one_block  18.85354256629944
generate_one_block  19.05902099609375
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.305986166000366
gen group dst list time:  0.16289258003234863
time for parepare:  0.4609684944152832
local_output_nid generation:  0.3912627696990967
local_in_edges_tensor generation:  1.077970027923584
mini_batch_src_global generation:  1.313547134399414
r_  generation:  18.53127121925354
local_output_nid generation:  0.6576886177062988
local_in_edges_tensor generation:  1.3400905132293701
mini_batch_src_global generation:  1.7660064697265625
r_  generation:  18.409887313842773
----------------------check_connections_block total spend ----------------------------- 50.12674617767334
generate_one_block  23.29093837738037
generate_one_block  23.77493405342102
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.5989885330200195  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

connection checking time:  89.02827596664429
block generation total time  84.97843599319458
average batch blocks generation time:  42.48921799659729
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.4270195960998535  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.984342098236084  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.4274730682373047  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.986051559448242  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7289490699768066
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 16.46it/s] 16%|█▌        | 4/25 [00:00<00:01, 17.39it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.74it/s] 32%|███▏      | 8/25 [00:00<00:00, 18.10it/s] 40%|████      | 10/25 [00:00<00:00, 18.30it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.23it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.08it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.97it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.88it/s] 80%|████████  | 20/25 [00:01<00:00, 17.70it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.42it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.52it/s]100%|██████████| 25/25 [00:01<00:00, 17.92it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.31it/s]  8%|▊         | 2/25 [00:00<00:04,  5.37it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.33it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.25it/s] 20%|██        | 5/25 [00:00<00:03,  5.23it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.28it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.32it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.32it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.34it/s] 40%|████      | 10/25 [00:01<00:02,  5.23it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.27it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.30it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.29it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.26it/s] 60%|██████    | 15/25 [00:02<00:01,  5.24it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.24it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.24it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.25it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.26it/s] 80%|████████  | 20/25 [00:03<00:00,  5.27it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.29it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.27it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.28it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.29it/s]100%|██████████| 25/25 [00:04<00:00,  5.95it/s]100%|██████████| 25/25 [00:04<00:00,  5.36it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.26it/s]  8%|▊         | 2/25 [00:00<00:04,  5.26it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.22it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.24it/s] 20%|██        | 5/25 [00:00<00:03,  5.24it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.22it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.25it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.24it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.21it/s] 40%|████      | 10/25 [00:01<00:02,  5.21it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.22it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.22it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.22it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.21it/s] 60%|██████    | 15/25 [00:02<00:01,  5.21it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.18it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.16it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.15it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.19it/s] 80%|████████  | 20/25 [00:03<00:00,  5.19it/s] 84%|████████▍ | 21/25 [00:04<00:00,  5.21it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.23it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.22it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.21it/s]100%|██████████| 25/25 [00:04<00:00,  5.82it/s]100%|██████████| 25/25 [00:04<00:00,  5.29it/s]
Run 00 | Epoch 00009 | Loss 1.7289 | Train 0.4737 | Val 0.4562 | Test 0.3381
Number of nodes during this epoch:  4500288
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.599524974822998  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3342733383178711
range selection method range initialization spend 0.0325469970703125
time for parepare:  0.27976250648498535
local_output_nid generation:  0.024753570556640625
local_in_edges_tensor generation:  0.06907248497009277
mini_batch_src_global generation:  0.11800813674926758
r_  generation:  1.8043298721313477
local_output_nid generation:  0.027940750122070312
local_in_edges_tensor generation:  0.03353238105773926
mini_batch_src_global generation:  0.1459667682647705
r_  generation:  2.022400140762329
----------------------check_connections_block total spend ----------------------------- 5.129824876785278
generate_one_block  2.70509672164917
generate_one_block  2.3977224826812744
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.059781312942505
gen group dst list time:  0.06840229034423828
time for parepare:  0.44089794158935547
local_output_nid generation:  0.1880183219909668
local_in_edges_tensor generation:  0.8023166656494141
mini_batch_src_global generation:  1.056006908416748
r_  generation:  14.734216213226318
local_output_nid generation:  0.36263489723205566
local_in_edges_tensor generation:  0.9496734142303467
mini_batch_src_global generation:  1.4018800258636475
r_  generation:  14.461036443710327
----------------------check_connections_block total spend ----------------------------- 39.33624196052551
generate_one_block  18.979496479034424
generate_one_block  19.2145037651062
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.0628561973571777
gen group dst list time:  0.1540508270263672
time for parepare:  0.429384708404541
local_output_nid generation:  0.3723030090332031
local_in_edges_tensor generation:  1.0015130043029785
mini_batch_src_global generation:  1.2150540351867676
r_  generation:  17.86219811439514
local_output_nid generation:  0.6032497882843018
local_in_edges_tensor generation:  1.3605055809020996
mini_batch_src_global generation:  1.5988163948059082
r_  generation:  18.035114288330078
----------------------check_connections_block total spend ----------------------------- 48.58523392677307
generate_one_block  23.23182201385498
generate_one_block  23.76398777961731
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.599524974822998  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

connection checking time:  87.92147588729858
block generation total time  85.18981003761292
average batch blocks generation time:  42.59490501880646
block dataloader generation time/epoch 199.7376787662506
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.4273300170898438  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.985424041748047  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.427520751953125  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.9870104789733887  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.6321202516555786
Total (block generation + training)time/epoch 202.1409387588501
Training 1 time/epoch 2.40326189994812
Training time/epoch 2.403090476989746
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 16.66it/s] 16%|█▌        | 4/25 [00:00<00:01, 17.00it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.44it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.89it/s] 40%|████      | 10/25 [00:00<00:00, 17.94it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.92it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.71it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.81it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.77it/s] 80%|████████  | 20/25 [00:01<00:00, 17.66it/s] 88%|████████▊ | 22/25 [00:01<00:00, 16.31it/s] 96%|█████████▌| 24/25 [00:01<00:00, 16.61it/s]100%|██████████| 25/25 [00:01<00:00, 17.46it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.24it/s]  8%|▊         | 2/25 [00:00<00:04,  5.37it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.42it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.43it/s] 20%|██        | 5/25 [00:00<00:03,  5.42it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.41it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.43it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.40it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.41it/s] 40%|████      | 10/25 [00:01<00:03,  4.66it/s] 44%|████▍     | 11/25 [00:02<00:02,  4.86it/s] 48%|████▊     | 12/25 [00:02<00:02,  4.98it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.10it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.19it/s] 60%|██████    | 15/25 [00:02<00:01,  5.24it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.24it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.23it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.22it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.23it/s] 80%|████████  | 20/25 [00:03<00:00,  5.25it/s] 84%|████████▍ | 21/25 [00:04<00:00,  5.27it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.28it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.28it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.30it/s]100%|██████████| 25/25 [00:04<00:00,  5.89it/s]100%|██████████| 25/25 [00:04<00:00,  5.31it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.16it/s]  8%|▊         | 2/25 [00:00<00:04,  5.19it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.15it/s] 16%|█▌        | 4/25 [00:00<00:04,  4.78it/s] 20%|██        | 5/25 [00:01<00:04,  4.43it/s] 24%|██▍       | 6/25 [00:01<00:04,  4.52it/s] 28%|██▊       | 7/25 [00:01<00:04,  4.05it/s] 32%|███▏      | 8/25 [00:01<00:03,  4.36it/s] 36%|███▌      | 9/25 [00:01<00:03,  4.60it/s] 40%|████      | 10/25 [00:02<00:03,  4.78it/s] 44%|████▍     | 11/25 [00:02<00:03,  4.39it/s] 48%|████▊     | 12/25 [00:02<00:02,  4.60it/s] 52%|█████▏    | 13/25 [00:02<00:02,  4.75it/s] 56%|█████▌    | 14/25 [00:03<00:02,  4.88it/s] 60%|██████    | 15/25 [00:03<00:02,  4.97it/s] 64%|██████▍   | 16/25 [00:03<00:01,  4.98it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.05it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.08it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.09it/s] 80%|████████  | 20/25 [00:04<00:00,  5.09it/s] 84%|████████▍ | 21/25 [00:04<00:00,  5.14it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.19it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.20it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.22it/s]100%|██████████| 25/25 [00:05<00:00,  5.88it/s]100%|██████████| 25/25 [00:05<00:00,  4.95it/s]
Run 00 | Epoch 00010 | Loss 1.6321 | Train 0.4882 | Val 0.4707 | Test 0.3499
Number of nodes during this epoch:  4501147
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.5994157791137695  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3375818729400635
range selection method range initialization spend 0.03226494789123535
time for parepare:  0.284832239151001
local_output_nid generation:  0.024347543716430664
local_in_edges_tensor generation:  0.06343913078308105
mini_batch_src_global generation:  0.11880993843078613
r_  generation:  1.9073116779327393
local_output_nid generation:  0.02812337875366211
local_in_edges_tensor generation:  0.043921470642089844
mini_batch_src_global generation:  0.14247512817382812
r_  generation:  1.9371941089630127
----------------------check_connections_block total spend ----------------------------- 5.160064935684204
generate_one_block  2.8610990047454834
generate_one_block  2.696136951446533
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.171491861343384
gen group dst list time:  0.06210589408874512
time for parepare:  0.4283180236816406
local_output_nid generation:  0.18845295906066895
local_in_edges_tensor generation:  0.7548034191131592
mini_batch_src_global generation:  1.0575757026672363
r_  generation:  14.468762636184692
local_output_nid generation:  0.3525705337524414
local_in_edges_tensor generation:  0.9762160778045654
mini_batch_src_global generation:  1.4842753410339355
r_  generation:  14.315369367599487
----------------------check_connections_block total spend ----------------------------- 38.97766184806824
generate_one_block  18.70254683494568
generate_one_block  19.006841897964478
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.175305128097534
gen group dst list time:  0.16128230094909668
time for parepare:  0.45976710319519043
local_output_nid generation:  0.3883097171783447
local_in_edges_tensor generation:  1.1814241409301758
mini_batch_src_global generation:  1.288444995880127
r_  generation:  18.43640422821045
local_output_nid generation:  0.6510720252990723
local_in_edges_tensor generation:  1.319702386856079
mini_batch_src_global generation:  1.7463109493255615
r_  generation:  18.42909288406372
----------------------check_connections_block total spend ----------------------------- 50.04990911483765
generate_one_block  23.391475200653076
generate_one_block  23.706355333328247
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.5994157791137695  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

connection checking time:  89.02757096290588
block generation total time  84.80721926689148
average batch blocks generation time:  42.40360963344574
block dataloader generation time/epoch 200.5771437883377
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.4277091026306152  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.9864697456359863  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.4270291328430176  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.9852147102355957  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.5447516441345215
Total (block generation + training)time/epoch 202.8142809867859
Training 1 time/epoch 2.071014881134033
Training time/epoch 2.0708727836608887
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 16.27it/s] 16%|█▌        | 4/25 [00:00<00:01, 17.29it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.55it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.90it/s] 40%|████      | 10/25 [00:00<00:00, 18.06it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.24it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.32it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.36it/s] 72%|███████▏  | 18/25 [00:00<00:00, 18.38it/s] 80%|████████  | 20/25 [00:01<00:00, 18.45it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.47it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.53it/s]100%|██████████| 25/25 [00:01<00:00, 18.49it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.35it/s]  8%|▊         | 2/25 [00:00<00:04,  5.27it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.33it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.34it/s] 20%|██        | 5/25 [00:00<00:03,  5.28it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.30it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.32it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.30it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.29it/s] 40%|████      | 10/25 [00:01<00:02,  5.28it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.31it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.26it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.29it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.29it/s] 60%|██████    | 15/25 [00:02<00:01,  5.31it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.30it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.30it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.23it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.26it/s] 80%|████████  | 20/25 [00:03<00:00,  5.27it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.26it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.28it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.30it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.32it/s]100%|██████████| 25/25 [00:04<00:00,  5.98it/s]100%|██████████| 25/25 [00:04<00:00,  5.37it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.14it/s]  8%|▊         | 2/25 [00:00<00:04,  5.20it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.24it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.27it/s] 20%|██        | 5/25 [00:00<00:03,  5.25it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.25it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.22it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.23it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.25it/s] 40%|████      | 10/25 [00:01<00:02,  5.24it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.22it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.23it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.20it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.23it/s] 60%|██████    | 15/25 [00:02<00:01,  5.22it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.23it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.22it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.22it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.23it/s] 80%|████████  | 20/25 [00:03<00:00,  5.24it/s] 84%|████████▍ | 21/25 [00:04<00:00,  5.23it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.23it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.22it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.22it/s]100%|██████████| 25/25 [00:04<00:00,  5.82it/s]100%|██████████| 25/25 [00:04<00:00,  5.30it/s]
Run 00 | Epoch 00011 | Loss 1.5448 | Train 0.5017 | Val 0.4852 | Test 0.3611
Number of nodes during this epoch:  4500752
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.5988330841064453  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.2259502410888672
range selection method range initialization spend 0.03127169609069824
time for parepare:  0.27744388580322266
local_output_nid generation:  0.025220870971679688
local_in_edges_tensor generation:  0.0534060001373291
mini_batch_src_global generation:  0.11567378044128418
r_  generation:  1.7906043529510498
local_output_nid generation:  0.026740550994873047
local_in_edges_tensor generation:  0.038964033126831055
mini_batch_src_global generation:  0.14360451698303223
r_  generation:  1.925964593887329
----------------------check_connections_block total spend ----------------------------- 4.998389720916748
generate_one_block  2.3211209774017334
generate_one_block  2.309342384338379
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.018529176712036
gen group dst list time:  0.06253266334533691
time for parepare:  0.4338996410369873
local_output_nid generation:  0.18452024459838867
local_in_edges_tensor generation:  0.8150942325592041
mini_batch_src_global generation:  1.048255443572998
r_  generation:  14.547058582305908
local_output_nid generation:  0.35070204734802246
local_in_edges_tensor generation:  1.032343864440918
mini_batch_src_global generation:  1.4474177360534668
r_  generation:  14.311819314956665
----------------------check_connections_block total spend ----------------------------- 39.17929816246033
generate_one_block  18.801718950271606
generate_one_block  19.062854528427124
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.2463765144348145
gen group dst list time:  0.16463065147399902
time for parepare:  0.4756436347961426
local_output_nid generation:  0.4140961170196533
local_in_edges_tensor generation:  1.0320007801055908
mini_batch_src_global generation:  1.2691154479980469
r_  generation:  18.34965682029724
local_output_nid generation:  0.659761905670166
local_in_edges_tensor generation:  1.3785035610198975
mini_batch_src_global generation:  1.755291223526001
r_  generation:  18.313599109649658
----------------------check_connections_block total spend ----------------------------- 49.68310809135437
generate_one_block  23.112725257873535
generate_one_block  23.3194317817688
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.5988330841064453  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

connection checking time:  88.8624062538147
block generation total time  84.29673051834106
average batch blocks generation time:  42.14836525917053
block dataloader generation time/epoch 200.15821957588196
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.4275031089782715  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.984731674194336  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.4269466400146484  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.9865894317626953  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.4692795276641846
Total (block generation + training)time/epoch 202.44648027420044
Training 1 time/epoch 2.390507459640503
Training time/epoch 2.3903679847717285
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 16.19it/s] 16%|█▌        | 4/25 [00:00<00:01, 17.09it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.39it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.49it/s] 40%|████      | 10/25 [00:00<00:00, 17.37it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.44it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.49it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.57it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.43it/s] 80%|████████  | 20/25 [00:01<00:00, 17.32it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.65it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.88it/s]100%|██████████| 25/25 [00:01<00:00, 17.82it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.34it/s]  8%|▊         | 2/25 [00:00<00:04,  5.39it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.39it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.36it/s] 20%|██        | 5/25 [00:00<00:03,  5.35it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.35it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.35it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.33it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.33it/s] 40%|████      | 10/25 [00:01<00:02,  5.28it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.27it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.24it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.26it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.30it/s] 60%|██████    | 15/25 [00:02<00:01,  5.31it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.31it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.29it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.31it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.31it/s] 80%|████████  | 20/25 [00:03<00:00,  5.29it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.30it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.30it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.28it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.27it/s]100%|██████████| 25/25 [00:04<00:00,  5.87it/s]100%|██████████| 25/25 [00:04<00:00,  5.38it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.06it/s]  8%|▊         | 2/25 [00:00<00:04,  5.19it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.22it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.23it/s] 20%|██        | 5/25 [00:00<00:03,  5.22it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.21it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.22it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.23it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.22it/s] 40%|████      | 10/25 [00:01<00:02,  5.24it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.23it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.20it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.22it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.23it/s] 60%|██████    | 15/25 [00:02<00:01,  5.22it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.22it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.21it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.21it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.23it/s] 80%|████████  | 20/25 [00:03<00:00,  5.23it/s] 84%|████████▍ | 21/25 [00:04<00:00,  5.24it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.23it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.21it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.20it/s]100%|██████████| 25/25 [00:04<00:00,  5.79it/s]100%|██████████| 25/25 [00:04<00:00,  5.29it/s]
Run 00 | Epoch 00012 | Loss 1.4693 | Train 0.5150 | Val 0.4976 | Test 0.3717
Number of nodes during this epoch:  4500017
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.598536491394043  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.2874634265899658
range selection method range initialization spend 0.03248953819274902
time for parepare:  0.2932755947113037
local_output_nid generation:  0.02475118637084961
local_in_edges_tensor generation:  0.06187725067138672
mini_batch_src_global generation:  0.11365270614624023
r_  generation:  1.842777967453003
local_output_nid generation:  0.026551008224487305
local_in_edges_tensor generation:  0.03793668746948242
mini_batch_src_global generation:  0.16003847122192383
r_  generation:  2.0561928749084473
----------------------check_connections_block total spend ----------------------------- 5.273471355438232
generate_one_block  2.766444206237793
generate_one_block  2.3766160011291504
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.2212350368499756
gen group dst list time:  0.0900413990020752
time for parepare:  0.45312929153442383
local_output_nid generation:  0.2013545036315918
local_in_edges_tensor generation:  0.7538161277770996
mini_batch_src_global generation:  1.02335786819458
r_  generation:  14.276020526885986
local_output_nid generation:  0.35956621170043945
local_in_edges_tensor generation:  0.9876527786254883
mini_batch_src_global generation:  1.6094157695770264
r_  generation:  15.020402908325195
----------------------check_connections_block total spend ----------------------------- 39.471447467803955
generate_one_block  18.935606002807617
generate_one_block  18.969290494918823
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.1926724910736084
gen group dst list time:  0.16123628616333008
time for parepare:  0.458709716796875
local_output_nid generation:  0.39025020599365234
local_in_edges_tensor generation:  1.0447964668273926
mini_batch_src_global generation:  1.2686026096343994
r_  generation:  19.024147510528564
local_output_nid generation:  0.646662712097168
local_in_edges_tensor generation:  1.3233554363250732
mini_batch_src_global generation:  1.6722784042358398
r_  generation:  18.599787712097168
----------------------check_connections_block total spend ----------------------------- 50.618582010269165
generate_one_block  23.383477449417114
generate_one_block  23.77394151687622
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.598536491394043  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

connection checking time:  90.09002947807312
block generation total time  85.06231546401978
average batch blocks generation time:  42.53115773200989
block dataloader generation time/epoch 200.7484337091446
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.4268817901611328  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.984654426574707  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.4269499778747559  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.9842519760131836  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.4022475481033325
Total (block generation + training)time/epoch 202.98071682453156
Training 1 time/epoch 2.0643506050109863
Training time/epoch 2.0642080307006836
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 16.20it/s] 16%|█▌        | 4/25 [00:00<00:01, 17.25it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.72it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.93it/s] 40%|████      | 10/25 [00:00<00:00, 18.16it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.06it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.21it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.32it/s] 72%|███████▏  | 18/25 [00:00<00:00, 18.35it/s] 80%|████████  | 20/25 [00:01<00:00, 18.44it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.46it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.32it/s]100%|██████████| 25/25 [00:01<00:00, 18.42it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.20it/s]  8%|▊         | 2/25 [00:00<00:04,  5.30it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.25it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.30it/s] 20%|██        | 5/25 [00:00<00:03,  5.34it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.30it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.32it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.33it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.53it/s] 40%|████      | 10/25 [00:01<00:02,  5.63it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.73it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.83it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.82it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.87it/s] 60%|██████    | 15/25 [00:02<00:01,  5.93it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.98it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.99it/s] 72%|███████▏  | 18/25 [00:03<00:01,  6.00it/s] 76%|███████▌  | 19/25 [00:03<00:00,  6.00it/s] 80%|████████  | 20/25 [00:03<00:00,  6.03it/s] 84%|████████▍ | 21/25 [00:03<00:00,  6.01it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.95it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.97it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.98it/s]100%|██████████| 25/25 [00:04<00:00,  6.69it/s]100%|██████████| 25/25 [00:04<00:00,  5.83it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.36it/s]  8%|▊         | 2/25 [00:00<00:04,  5.18it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.25it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.26it/s] 20%|██        | 5/25 [00:00<00:03,  5.28it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.32it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.28it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.30it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.31it/s] 40%|████      | 10/25 [00:01<00:02,  5.31it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.52it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.46it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.40it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.36it/s] 60%|██████    | 15/25 [00:02<00:01,  5.35it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.33it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.29it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.29it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.27it/s] 80%|████████  | 20/25 [00:03<00:00,  5.27it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.28it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.28it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.26it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.26it/s]100%|██████████| 25/25 [00:04<00:00,  5.89it/s]100%|██████████| 25/25 [00:04<00:00,  5.38it/s]
Run 00 | Epoch 00013 | Loss 1.4022 | Train 0.5265 | Val 0.5114 | Test 0.3819
Number of nodes during this epoch:  4498489
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.5986814498901367  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.32097554206848145
range selection method range initialization spend 0.031879425048828125
time for parepare:  0.28073716163635254
local_output_nid generation:  0.024537086486816406
local_in_edges_tensor generation:  0.0574793815612793
mini_batch_src_global generation:  0.11228084564208984
r_  generation:  1.8143534660339355
local_output_nid generation:  0.028783559799194336
local_in_edges_tensor generation:  0.04890704154968262
mini_batch_src_global generation:  0.15151309967041016
r_  generation:  1.9727013111114502
----------------------check_connections_block total spend ----------------------------- 5.103440761566162
generate_one_block  2.7563822269439697
generate_one_block  2.731510877609253
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.059321880340576
gen group dst list time:  0.0651547908782959
time for parepare:  0.4217336177825928
local_output_nid generation:  0.18466973304748535
local_in_edges_tensor generation:  0.7717733383178711
mini_batch_src_global generation:  1.0964233875274658
r_  generation:  14.452157020568848
local_output_nid generation:  0.3520052433013916
local_in_edges_tensor generation:  0.9389162063598633
mini_batch_src_global generation:  1.476433515548706
r_  generation:  14.16497015953064
----------------------check_connections_block total spend ----------------------------- 38.86101531982422
generate_one_block  18.752420663833618
generate_one_block  18.977559089660645
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.1631150245666504
gen group dst list time:  0.1678171157836914
time for parepare:  0.47779011726379395
local_output_nid generation:  0.3954329490661621
local_in_edges_tensor generation:  1.0819714069366455
mini_batch_src_global generation:  1.2756800651550293
r_  generation:  19.059560537338257
local_output_nid generation:  0.7344837188720703
local_in_edges_tensor generation:  1.3271665573120117
mini_batch_src_global generation:  1.7174303531646729
r_  generation:  18.468895435333252
----------------------check_connections_block total spend ----------------------------- 50.775185346603394
generate_one_block  23.420976400375366
generate_one_block  23.6476628780365
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.5986814498901367  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

connection checking time:  89.63620066642761
block generation total time  84.79861903190613
average batch blocks generation time:  42.399309515953064
block dataloader generation time/epoch 201.04290833473206
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.4273266792297363  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.9867939949035645  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.4269018173217773  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.983394145965576  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3461087942123413
Total (block generation + training)time/epoch 203.2813178062439
Training 1 time/epoch 2.2629144191741943
Training time/epoch 2.2627670764923096
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 16.21it/s] 16%|█▌        | 4/25 [00:00<00:01, 17.17it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.77it/s] 32%|███▏      | 8/25 [00:00<00:00, 18.06it/s] 40%|████      | 10/25 [00:00<00:00, 18.26it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.33it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.57it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.23it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.11it/s] 80%|████████  | 20/25 [00:01<00:00, 17.44it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.60it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.85it/s]100%|██████████| 25/25 [00:01<00:00, 17.92it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.38it/s]  8%|▊         | 2/25 [00:00<00:04,  5.38it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.41it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.40it/s] 20%|██        | 5/25 [00:00<00:03,  5.42it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.43it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.43it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.41it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.42it/s] 40%|████      | 10/25 [00:01<00:02,  5.43it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.43it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.42it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.43it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.38it/s] 60%|██████    | 15/25 [00:02<00:01,  5.63it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.73it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.82it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.79it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.92it/s] 80%|████████  | 20/25 [00:03<00:00,  5.95it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.96it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.66it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.58it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.56it/s]100%|██████████| 25/25 [00:04<00:00,  6.22it/s]100%|██████████| 25/25 [00:04<00:00,  5.65it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.10it/s]  8%|▊         | 2/25 [00:00<00:04,  5.25it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.28it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.33it/s] 20%|██        | 5/25 [00:00<00:03,  5.34it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.57it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.48it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.43it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.40it/s] 40%|████      | 10/25 [00:01<00:02,  5.36it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.37it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.33it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.30it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.26it/s] 60%|██████    | 15/25 [00:02<00:01,  5.27it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.29it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.27it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.29it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.28it/s] 80%|████████  | 20/25 [00:03<00:00,  5.23it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.23it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.26it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.22it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.19it/s]100%|██████████| 25/25 [00:04<00:00,  5.77it/s]100%|██████████| 25/25 [00:04<00:00,  5.37it/s]
Run 00 | Epoch 00014 | Loss 1.3461 | Train 0.5380 | Val 0.5229 | Test 0.3919
Number of nodes during this epoch:  4498466
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.5982441902160645  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3020169734954834
range selection method range initialization spend 0.032929420471191406
time for parepare:  0.2787916660308838
local_output_nid generation:  0.026300907135009766
local_in_edges_tensor generation:  0.0645442008972168
mini_batch_src_global generation:  0.11364316940307617
r_  generation:  1.8327662944793701
local_output_nid generation:  0.026068687438964844
local_in_edges_tensor generation:  0.04454302787780762
mini_batch_src_global generation:  0.14969277381896973
r_  generation:  1.9492981433868408
----------------------check_connections_block total spend ----------------------------- 5.100633382797241
generate_one_block  2.7036070823669434
generate_one_block  2.3162033557891846
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.1570615768432617
gen group dst list time:  0.06816411018371582
time for parepare:  0.4401862621307373
local_output_nid generation:  0.19872808456420898
local_in_edges_tensor generation:  0.7865092754364014
mini_batch_src_global generation:  1.1060948371887207
r_  generation:  14.568589210510254
local_output_nid generation:  0.3509178161621094
local_in_edges_tensor generation:  0.9814314842224121
mini_batch_src_global generation:  1.4863812923431396
r_  generation:  14.437859296798706
----------------------check_connections_block total spend ----------------------------- 39.37917709350586
generate_one_block  19.01054310798645
generate_one_block  19.16617512702942
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.132158041000366
gen group dst list time:  0.16569924354553223
time for parepare:  0.4577045440673828
local_output_nid generation:  0.37470149993896484
local_in_edges_tensor generation:  1.0698492527008057
mini_batch_src_global generation:  1.2787554264068604
r_  generation:  18.37717843055725
local_output_nid generation:  0.654456615447998
local_in_edges_tensor generation:  1.3323020935058594
mini_batch_src_global generation:  1.732335090637207
r_  generation:  18.354112148284912
----------------------check_connections_block total spend ----------------------------- 49.792519330978394
generate_one_block  23.375224113464355
generate_one_block  23.856904983520508
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.5982441902160645  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

connection checking time:  89.17169642448425
block generation total time  85.40884733200073
average batch blocks generation time:  42.704423666000366
block dataloader generation time/epoch 201.14423422018686
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.426928997039795  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.9845080375671387  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.427262783050537  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.9853062629699707  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.28428053855896
Total (block generation + training)time/epoch 203.38711229960123
Training 1 time/epoch 2.26522159576416
Training time/epoch 2.2650814056396484
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 16.85it/s] 16%|█▌        | 4/25 [00:00<00:01, 17.62it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.61it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.58it/s] 40%|████      | 10/25 [00:00<00:00, 17.66it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.69it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.61it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.80it/s] 72%|███████▏  | 18/25 [00:01<00:00, 17.91it/s] 80%|████████  | 20/25 [00:01<00:00, 17.65it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.88it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.08it/s]100%|██████████| 25/25 [00:01<00:00, 18.12it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.35it/s]  8%|▊         | 2/25 [00:00<00:04,  5.28it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.26it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.24it/s] 20%|██        | 5/25 [00:00<00:03,  5.42it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.40it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.35it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.32it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.33it/s] 40%|████      | 10/25 [00:01<00:02,  5.33it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.59it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.74it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.51it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.44it/s] 60%|██████    | 15/25 [00:02<00:01,  5.40it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.38it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.36it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.35it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.33it/s] 80%|████████  | 20/25 [00:03<00:00,  5.33it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.31it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.28it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.26it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.24it/s]100%|██████████| 25/25 [00:04<00:00,  5.89it/s]100%|██████████| 25/25 [00:04<00:00,  5.43it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.12it/s]  8%|▊         | 2/25 [00:00<00:04,  5.21it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.26it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.24it/s] 20%|██        | 5/25 [00:00<00:03,  5.50it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.41it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.26it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.21it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.23it/s] 40%|████      | 10/25 [00:01<00:02,  5.26it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.26it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.23it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.24it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.25it/s] 60%|██████    | 15/25 [00:02<00:01,  5.25it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.26it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.27it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.50it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.34it/s] 80%|████████  | 20/25 [00:03<00:00,  5.31it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.30it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.29it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.29it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.32it/s]100%|██████████| 25/25 [00:04<00:00,  5.91it/s]100%|██████████| 25/25 [00:04<00:00,  5.36it/s]
Run 00 | Epoch 00015 | Loss 1.2843 | Train 0.5491 | Val 0.5344 | Test 0.4013
Number of nodes during this epoch:  4499480
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.598874568939209  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.32335686683654785
range selection method range initialization spend 0.036386966705322266
time for parepare:  0.2957124710083008
local_output_nid generation:  0.024866342544555664
local_in_edges_tensor generation:  0.0724031925201416
mini_batch_src_global generation:  0.13112926483154297
r_  generation:  1.8924365043640137
local_output_nid generation:  0.026309967041015625
local_in_edges_tensor generation:  0.04004049301147461
mini_batch_src_global generation:  0.1538088321685791
r_  generation:  1.9922783374786377
----------------------check_connections_block total spend ----------------------------- 5.27673602104187
generate_one_block  2.8076722621917725
generate_one_block  2.5588576793670654
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.1198887825012207
gen group dst list time:  0.0633234977722168
time for parepare:  0.42271971702575684
local_output_nid generation:  0.18120336532592773
local_in_edges_tensor generation:  0.7461323738098145
mini_batch_src_global generation:  1.0196192264556885
r_  generation:  14.346950769424438
local_output_nid generation:  0.3483593463897705
local_in_edges_tensor generation:  0.9429547786712646
mini_batch_src_global generation:  1.296135663986206
r_  generation:  14.534404754638672
----------------------check_connections_block total spend ----------------------------- 38.64309048652649
generate_one_block  18.84721279144287
generate_one_block  18.99584126472473
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.191713333129883
gen group dst list time:  0.1543266773223877
time for parepare:  0.43076491355895996
local_output_nid generation:  0.41614413261413574
local_in_edges_tensor generation:  1.0620365142822266
mini_batch_src_global generation:  1.280524492263794
r_  generation:  18.500961780548096
local_output_nid generation:  0.6738016605377197
local_in_edges_tensor generation:  1.4186036586761475
mini_batch_src_global generation:  1.7495200634002686
r_  generation:  18.53473711013794
----------------------check_connections_block total spend ----------------------------- 50.30171060562134
generate_one_block  23.38485074043274
generate_one_block  23.912344217300415
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.598874568939209  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

connection checking time:  88.94480109214783
block generation total time  85.14024901390076
average batch blocks generation time:  42.57012450695038
block dataloader generation time/epoch 201.2169052192143
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.4268875122070312  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.9847683906555176  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.427194595336914  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.9844369888305664  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2355778217315674
Total (block generation + training)time/epoch 203.49267860821314
Training 1 time/epoch 2.473146438598633
Training time/epoch 2.473005771636963
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.83it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.94it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.50it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.98it/s] 40%|████      | 10/25 [00:00<00:00, 17.95it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.00it/s] 56%|█████▌    | 14/25 [00:00<00:00, 14.53it/s] 64%|██████▍   | 16/25 [00:00<00:00, 15.57it/s] 72%|███████▏  | 18/25 [00:01<00:00, 16.37it/s] 80%|████████  | 20/25 [00:01<00:00, 16.97it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.42it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.76it/s]100%|██████████| 25/25 [00:01<00:00, 17.35it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.35it/s]  8%|▊         | 2/25 [00:00<00:04,  5.28it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.31it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.35it/s] 20%|██        | 5/25 [00:00<00:03,  5.30it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.31it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.34it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.30it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.31it/s] 40%|████      | 10/25 [00:01<00:02,  5.34it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.33it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.34it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.34it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.35it/s] 60%|██████    | 15/25 [00:02<00:01,  5.33it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.33it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.30it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.23it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.25it/s] 80%|████████  | 20/25 [00:03<00:00,  5.26it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.24it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.26it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.28it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.29it/s]100%|██████████| 25/25 [00:04<00:00,  5.95it/s]100%|██████████| 25/25 [00:04<00:00,  5.38it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.19it/s]  8%|▊         | 2/25 [00:00<00:04,  5.24it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.16it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.22it/s] 20%|██        | 5/25 [00:00<00:03,  5.24it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.23it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.22it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.23it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.23it/s] 40%|████      | 10/25 [00:01<00:02,  5.23it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.23it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.22it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.22it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.23it/s] 60%|██████    | 15/25 [00:02<00:01,  5.20it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.22it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.23it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.23it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.24it/s] 80%|████████  | 20/25 [00:03<00:00,  5.24it/s] 84%|████████▍ | 21/25 [00:04<00:00,  5.25it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.25it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.25it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.23it/s]100%|██████████| 25/25 [00:04<00:00,  5.88it/s]100%|██████████| 25/25 [00:04<00:00,  5.31it/s]
Run 00 | Epoch 00016 | Loss 1.2356 | Train 0.5598 | Val 0.5447 | Test 0.4106
Number of nodes during this epoch:  4499125
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.5989580154418945  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3089773654937744
range selection method range initialization spend 0.032030582427978516
time for parepare:  0.2750399112701416
local_output_nid generation:  0.025115013122558594
local_in_edges_tensor generation:  0.05634713172912598
mini_batch_src_global generation:  0.11395454406738281
r_  generation:  1.7960867881774902
local_output_nid generation:  0.029015302658081055
local_in_edges_tensor generation:  0.03847217559814453
mini_batch_src_global generation:  0.14419937133789062
r_  generation:  1.916548252105713
----------------------check_connections_block total spend ----------------------------- 4.99083948135376
generate_one_block  2.3805835247039795
generate_one_block  2.303982973098755
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.0229811668395996
gen group dst list time:  0.06265139579772949
time for parepare:  0.4394822120666504
local_output_nid generation:  0.17916226387023926
local_in_edges_tensor generation:  0.7477631568908691
mini_batch_src_global generation:  1.0176122188568115
r_  generation:  14.193435668945312
local_output_nid generation:  0.3133673667907715
local_in_edges_tensor generation:  1.1119616031646729
mini_batch_src_global generation:  1.2928824424743652
r_  generation:  14.47282338142395
----------------------check_connections_block total spend ----------------------------- 38.49816584587097
generate_one_block  18.988213300704956
generate_one_block  18.61333656311035
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.143747568130493
gen group dst list time:  0.15881967544555664
time for parepare:  0.4643876552581787
local_output_nid generation:  0.3816080093383789
local_in_edges_tensor generation:  1.0157179832458496
mini_batch_src_global generation:  1.2204504013061523
r_  generation:  17.95625352859497
local_output_nid generation:  0.6368775367736816
local_in_edges_tensor generation:  1.3098032474517822
mini_batch_src_global generation:  1.6021628379821777
r_  generation:  18.392198085784912
----------------------check_connections_block total spend ----------------------------- 49.036478757858276
generate_one_block  23.62224245071411
generate_one_block  23.9951434135437
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.5989580154418945  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

connection checking time:  87.53464460372925
block generation total time  85.21893572807312
average batch blocks generation time:  42.60946786403656
block dataloader generation time/epoch 200.9522721171379
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.4277997016906738  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.9880900382995605  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.42686128616333  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.98342227935791  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1844654083251953
Total (block generation + training)time/epoch 203.25020962953568
Training 1 time/epoch 2.4530868530273438
Training time/epoch 2.4529452323913574
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.24it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.56it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.99it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.60it/s] 40%|████      | 10/25 [00:00<00:00, 17.93it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.09it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.22it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.26it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.35it/s] 80%|████████  | 20/25 [00:01<00:00, 18.43it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.15it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.99it/s]100%|██████████| 25/25 [00:01<00:00, 18.17it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.51it/s]  8%|▊         | 2/25 [00:00<00:03,  5.76it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.62it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.55it/s] 20%|██        | 5/25 [00:00<00:03,  5.55it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.54it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.53it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.50it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.52it/s] 40%|████      | 10/25 [00:01<00:02,  5.52it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.52it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.52it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.46it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.64it/s] 60%|██████    | 15/25 [00:02<00:01,  5.70it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.60it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.55it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.53it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.49it/s] 80%|████████  | 20/25 [00:03<00:00,  5.50it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.47it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.46it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.42it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.45it/s]100%|██████████| 25/25 [00:04<00:00,  6.11it/s]100%|██████████| 25/25 [00:04<00:00,  5.60it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.76it/s]  8%|▊         | 2/25 [00:00<00:03,  5.84it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.82it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.59it/s] 20%|██        | 5/25 [00:00<00:03,  5.52it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.46it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.42it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.66it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.63it/s] 40%|████      | 10/25 [00:01<00:02,  5.49it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.43it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.36it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.31it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.29it/s] 60%|██████    | 15/25 [00:02<00:01,  5.29it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.32it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.28it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.28it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.29it/s] 80%|████████  | 20/25 [00:03<00:00,  5.28it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.30it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.27it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.23it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.32it/s]100%|██████████| 25/25 [00:04<00:00,  5.77it/s]100%|██████████| 25/25 [00:04<00:00,  5.45it/s]
Run 00 | Epoch 00017 | Loss 1.1845 | Train 0.5702 | Val 0.5556 | Test 0.4196
Number of nodes during this epoch:  4500280
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.5985660552978516  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.42061328887939453
range selection method range initialization spend 0.03102588653564453
time for parepare:  0.2855701446533203
local_output_nid generation:  0.024472713470458984
local_in_edges_tensor generation:  0.07608509063720703
mini_batch_src_global generation:  0.11724424362182617
r_  generation:  1.8793582916259766
local_output_nid generation:  0.030930519104003906
local_in_edges_tensor generation:  0.04518866539001465
mini_batch_src_global generation:  0.15869355201721191
r_  generation:  2.0117785930633545
----------------------check_connections_block total spend ----------------------------- 5.277799606323242
generate_one_block  2.816596746444702
generate_one_block  2.5186052322387695
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.128046989440918
gen group dst list time:  0.062262773513793945
time for parepare:  0.4460761547088623
local_output_nid generation:  0.18616700172424316
local_in_edges_tensor generation:  0.7635807991027832
mini_batch_src_global generation:  1.0366034507751465
r_  generation:  14.852977275848389
local_output_nid generation:  0.3581223487854004
local_in_edges_tensor generation:  0.969245195388794
mini_batch_src_global generation:  1.4424452781677246
r_  generation:  14.525848388671875
----------------------check_connections_block total spend ----------------------------- 39.75050663948059
generate_one_block  19.127094268798828
generate_one_block  19.423820972442627
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.1257662773132324
gen group dst list time:  0.15425729751586914
time for parepare:  0.44655704498291016
local_output_nid generation:  0.37396836280822754
local_in_edges_tensor generation:  1.047530174255371
mini_batch_src_global generation:  1.2191927433013916
r_  generation:  17.778614282608032
local_output_nid generation:  0.5951442718505859
local_in_edges_tensor generation:  1.5143086910247803
mini_batch_src_global generation:  1.630913496017456
r_  generation:  18.31495189666748
----------------------check_connections_block total spend ----------------------------- 49.13472771644592
generate_one_block  23.455637216567993
generate_one_block  23.90169858932495
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.5985660552978516  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

connection checking time:  88.88523435592651
block generation total time  85.9082510471344
average batch blocks generation time:  42.9541255235672
block dataloader generation time/epoch 201.1216864850786
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.426581859588623  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.9855189323425293  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.4275007247924805  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.985959529876709  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1466894149780273
Total (block generation + training)time/epoch 203.4284110069275
Training 1 time/epoch 2.377020835876465
Training time/epoch 2.376878023147583
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 16.86it/s] 16%|█▌        | 4/25 [00:00<00:01, 17.40it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.78it/s] 32%|███▏      | 8/25 [00:00<00:00, 18.10it/s] 40%|████      | 10/25 [00:00<00:00, 18.13it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.16it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.25it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.40it/s] 72%|███████▏  | 18/25 [00:00<00:00, 18.44it/s] 80%|████████  | 20/25 [00:01<00:00, 18.51it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.49it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.57it/s]100%|██████████| 25/25 [00:01<00:00, 18.55it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.36it/s]  8%|▊         | 2/25 [00:00<00:04,  5.40it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.39it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.36it/s] 20%|██        | 5/25 [00:00<00:03,  5.36it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.37it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.35it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.37it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.39it/s] 40%|████      | 10/25 [00:01<00:02,  5.41it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.36it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.36it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.38it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.36it/s] 60%|██████    | 15/25 [00:02<00:01,  5.39it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.35it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.34it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.37it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.38it/s] 80%|████████  | 20/25 [00:03<00:00,  5.36it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.38it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.37it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.36it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.36it/s]100%|██████████| 25/25 [00:04<00:00,  6.04it/s]100%|██████████| 25/25 [00:04<00:00,  5.45it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.22it/s]  8%|▊         | 2/25 [00:00<00:04,  5.75it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.84it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.62it/s] 20%|██        | 5/25 [00:00<00:03,  5.45it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.37it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.34it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.34it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.35it/s] 40%|████      | 10/25 [00:01<00:02,  5.33it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.33it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.31it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.27it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.23it/s] 60%|██████    | 15/25 [00:02<00:01,  5.21it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.22it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.25it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.25it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.23it/s] 80%|████████  | 20/25 [00:03<00:00,  5.22it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.20it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.14it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.17it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.17it/s]100%|██████████| 25/25 [00:04<00:00,  5.76it/s]100%|██████████| 25/25 [00:04<00:00,  5.36it/s]
Run 00 | Epoch 00018 | Loss 1.1467 | Train 0.5803 | Val 0.5667 | Test 0.4283
Number of nodes during this epoch:  4499265
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.599832534790039  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.29897284507751465
range selection method range initialization spend 0.02965235710144043
time for parepare:  0.2909977436065674
local_output_nid generation:  0.024769306182861328
local_in_edges_tensor generation:  0.060410261154174805
mini_batch_src_global generation:  0.11043810844421387
r_  generation:  1.8369965553283691
local_output_nid generation:  0.02694392204284668
local_in_edges_tensor generation:  0.05552029609680176
mini_batch_src_global generation:  0.1513962745666504
r_  generation:  1.9679057598114014
----------------------check_connections_block total spend ----------------------------- 5.149723052978516
generate_one_block  2.7801334857940674
generate_one_block  2.3323917388916016
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.1521763801574707
gen group dst list time:  0.0692296028137207
time for parepare:  0.4775733947753906
local_output_nid generation:  0.2094743251800537
local_in_edges_tensor generation:  0.8160037994384766
mini_batch_src_global generation:  1.1089341640472412
r_  generation:  14.526859521865845
local_output_nid generation:  0.4010477066040039
local_in_edges_tensor generation:  1.0775055885314941
mini_batch_src_global generation:  1.366774082183838
r_  generation:  14.487556457519531
----------------------check_connections_block total spend ----------------------------- 39.55384826660156
generate_one_block  19.167227029800415
generate_one_block  19.288774251937866
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.27329683303833
gen group dst list time:  0.170884370803833
time for parepare:  0.4291081428527832
local_output_nid generation:  0.4045279026031494
local_in_edges_tensor generation:  1.0421967506408691
mini_batch_src_global generation:  1.2535312175750732
r_  generation:  18.51145029067993
local_output_nid generation:  0.6356914043426514
local_in_edges_tensor generation:  1.4205760955810547
mini_batch_src_global generation:  1.6498291492462158
r_  generation:  18.396661043167114
----------------------check_connections_block total spend ----------------------------- 49.943081855773926
generate_one_block  23.169482231140137
generate_one_block  23.50144100189209
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.599832534790039  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

connection checking time:  89.49693012237549
block generation total time  85.12692451477051
average batch blocks generation time:  42.563462257385254
block dataloader generation time/epoch 201.22192318439483
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.4268999099731445  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.9846715927124023  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.4274282455444336  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.9874324798583984  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1056122779846191
Total (block generation + training)time/epoch 203.50142207145691
Training 1 time/epoch 2.034468173980713
Training time/epoch 2.034327268600464
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 16.43it/s] 16%|█▌        | 4/25 [00:00<00:01, 17.09it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.40it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.73it/s] 40%|████      | 10/25 [00:00<00:00, 18.08it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.27it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.01it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.22it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.33it/s] 80%|████████  | 20/25 [00:01<00:00, 18.42it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.50it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.54it/s]100%|██████████| 25/25 [00:01<00:00, 18.44it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.37it/s]  8%|▊         | 2/25 [00:00<00:04,  5.32it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.39it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.33it/s] 20%|██        | 5/25 [00:00<00:03,  5.34it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.36it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.33it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.36it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.35it/s] 40%|████      | 10/25 [00:01<00:02,  5.32it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.34it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.35it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.33it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.32it/s] 60%|██████    | 15/25 [00:02<00:01,  5.35it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.35it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.33it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.35it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.35it/s] 80%|████████  | 20/25 [00:03<00:00,  5.36it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.34it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.38it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.38it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.35it/s]100%|██████████| 25/25 [00:04<00:00,  5.97it/s]100%|██████████| 25/25 [00:04<00:00,  5.42it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.31it/s]  8%|▊         | 2/25 [00:00<00:04,  5.29it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.33it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.31it/s] 20%|██        | 5/25 [00:00<00:03,  5.33it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.35it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.33it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.34it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.34it/s] 40%|████      | 10/25 [00:01<00:02,  5.34it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.36it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.31it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.29it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.32it/s] 60%|██████    | 15/25 [00:02<00:01,  5.22it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.25it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.30it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.30it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.31it/s] 80%|████████  | 20/25 [00:03<00:00,  5.30it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.30it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.30it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.32it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.32it/s]100%|██████████| 25/25 [00:04<00:00,  6.15it/s]100%|██████████| 25/25 [00:04<00:00,  5.41it/s]
Run 00 | Epoch 00019 | Loss 1.1056 | Train 0.5908 | Val 0.5772 | Test 0.4368
Number of nodes during this epoch:  4499291
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.5999503135681152  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.32475996017456055
range selection method range initialization spend 0.03177475929260254
time for parepare:  0.2813718318939209
local_output_nid generation:  0.024828433990478516
local_in_edges_tensor generation:  0.060230255126953125
mini_batch_src_global generation:  0.11084198951721191
r_  generation:  1.8642845153808594
local_output_nid generation:  0.027151823043823242
local_in_edges_tensor generation:  0.0472869873046875
mini_batch_src_global generation:  0.15444087982177734
r_  generation:  1.9837207794189453
----------------------check_connections_block total spend ----------------------------- 5.165374994277954
generate_one_block  2.763664960861206
generate_one_block  2.7426085472106934
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.0140902996063232
gen group dst list time:  0.06663250923156738
time for parepare:  0.424152135848999
local_output_nid generation:  0.18016386032104492
local_in_edges_tensor generation:  0.7495629787445068
mini_batch_src_global generation:  1.1098341941833496
r_  generation:  14.825406312942505
local_output_nid generation:  0.3579072952270508
local_in_edges_tensor generation:  1.0624806880950928
mini_batch_src_global generation:  1.4373488426208496
r_  generation:  14.523131370544434
----------------------check_connections_block total spend ----------------------------- 39.682703733444214
generate_one_block  19.012832641601562
generate_one_block  19.315561056137085
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.2604079246520996
gen group dst list time:  0.17402029037475586
time for parepare:  0.42479634284973145
local_output_nid generation:  0.39501428604125977
local_in_edges_tensor generation:  1.0821282863616943
mini_batch_src_global generation:  1.2713894844055176
r_  generation:  18.48019814491272
local_output_nid generation:  0.644575834274292
local_in_edges_tensor generation:  1.2928242683410645
mini_batch_src_global generation:  1.7042579650878906
r_  generation:  18.596325397491455
----------------------check_connections_block total spend ----------------------------- 50.09485125541687
generate_one_block  23.377866506576538
generate_one_block  23.98594355583191
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.5999503135681152  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

connection checking time:  89.77755498886108
block generation total time  85.6922037601471
average batch blocks generation time:  42.84610188007355
block dataloader generation time/epoch 201.38180778243324
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.427474021911621  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.98891019821167  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.4272642135620117  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.9839930534362793  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.071573257446289
Total (block generation + training)time/epoch 203.67890366640958
Training 1 time/epoch 2.473067045211792
Training time/epoch 2.4729292392730713
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 16.41it/s] 16%|█▌        | 4/25 [00:00<00:01, 17.55it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.85it/s] 32%|███▏      | 8/25 [00:00<00:00, 18.15it/s] 40%|████      | 10/25 [00:00<00:00, 18.19it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.33it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.96it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.10it/s] 72%|███████▏  | 18/25 [00:00<00:00, 18.26it/s] 80%|████████  | 20/25 [00:01<00:00, 18.32it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.37it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.38it/s]100%|██████████| 25/25 [00:01<00:00, 18.42it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.03it/s]  8%|▊         | 2/25 [00:00<00:04,  5.15it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.18it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.25it/s] 20%|██        | 5/25 [00:00<00:03,  5.32it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.34it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.32it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.32it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.34it/s] 40%|████      | 10/25 [00:01<00:02,  5.35it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.60it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.40it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.38it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.36it/s] 60%|██████    | 15/25 [00:02<00:01,  5.39it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.38it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.38it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.55it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.49it/s] 80%|████████  | 20/25 [00:03<00:00,  5.41it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.40it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.42it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.43it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.45it/s]100%|██████████| 25/25 [00:04<00:00,  6.13it/s]100%|██████████| 25/25 [00:04<00:00,  5.47it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.32it/s]  8%|▊         | 2/25 [00:00<00:04,  5.17it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.20it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.21it/s] 20%|██        | 5/25 [00:00<00:03,  5.24it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.28it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.31it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.34it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.34it/s] 40%|████      | 10/25 [00:01<00:02,  5.37it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.39it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.38it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.39it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.37it/s] 60%|██████    | 15/25 [00:02<00:01,  5.33it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.26it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.46it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.57it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.42it/s] 80%|████████  | 20/25 [00:03<00:00,  5.38it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.40it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.41it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.42it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.44it/s]100%|██████████| 25/25 [00:04<00:00,  6.06it/s]100%|██████████| 25/25 [00:04<00:00,  5.44it/s]
Run 00 | Epoch 00020 | Loss 1.0716 | Train 0.6007 | Val 0.5872 | Test 0.4448
Number of nodes during this epoch:  4500857
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.5987186431884766  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.30556797981262207
range selection method range initialization spend 0.03166699409484863
time for parepare:  0.2919747829437256
local_output_nid generation:  0.025544166564941406
local_in_edges_tensor generation:  0.059000253677368164
mini_batch_src_global generation:  0.1194295883178711
r_  generation:  1.9299185276031494
local_output_nid generation:  0.026499271392822266
local_in_edges_tensor generation:  0.05279374122619629
mini_batch_src_global generation:  0.1438887119293213
r_  generation:  2.024224042892456
----------------------check_connections_block total spend ----------------------------- 5.28598427772522
generate_one_block  2.7763006687164307
generate_one_block  2.341470241546631
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.0549046993255615
gen group dst list time:  0.06622767448425293
time for parepare:  0.42748212814331055
local_output_nid generation:  0.17736005783081055
local_in_edges_tensor generation:  0.7253525257110596
mini_batch_src_global generation:  1.1262011528015137
r_  generation:  15.010324239730835
local_output_nid generation:  0.3556180000305176
local_in_edges_tensor generation:  1.100165843963623
mini_batch_src_global generation:  1.4569931030273438
r_  generation:  14.676687240600586
----------------------check_connections_block total spend ----------------------------- 40.119404315948486
generate_one_block  19.302722692489624
generate_one_block  19.51877999305725
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.1635043621063232
gen group dst list time:  0.1629633903503418
time for parepare:  0.4692239761352539
local_output_nid generation:  0.4069559574127197
local_in_edges_tensor generation:  1.021498680114746
mini_batch_src_global generation:  1.282667636871338
r_  generation:  18.647948503494263
local_output_nid generation:  0.6729364395141602
local_in_edges_tensor generation:  1.3985013961791992
mini_batch_src_global generation:  1.7943708896636963
r_  generation:  18.595205545425415
----------------------check_connections_block total spend ----------------------------- 50.577757596969604
generate_one_block  23.640085697174072
generate_one_block  23.697919368743896
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.5987186431884766  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

connection checking time:  90.69716191291809
block generation total time  86.15950775146484
average batch blocks generation time:  43.07975387573242
block dataloader generation time/epoch 201.64110231399536
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.4268798828125  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.9846620559692383  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.42716646194458  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.9859981536865234  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0379232168197632
Total (block generation + training)time/epoch 203.95555692911148
Training 1 time/epoch 2.5054008960723877
Training time/epoch 2.505260467529297
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 16.90it/s] 16%|█▌        | 4/25 [00:00<00:01, 17.67it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.82it/s] 32%|███▏      | 8/25 [00:00<00:00, 18.17it/s] 40%|████      | 10/25 [00:00<00:00, 18.23it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.36it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.29it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.36it/s] 72%|███████▏  | 18/25 [00:00<00:00, 18.22it/s] 80%|████████  | 20/25 [00:01<00:00, 18.34it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.43it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.45it/s]100%|██████████| 25/25 [00:01<00:00, 18.52it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.25it/s]  8%|▊         | 2/25 [00:00<00:04,  5.32it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.35it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.34it/s] 20%|██        | 5/25 [00:00<00:03,  5.36it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.38it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.37it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.37it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.38it/s] 40%|████      | 10/25 [00:01<00:02,  5.40it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.34it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.32it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.34it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.28it/s] 60%|██████    | 15/25 [00:02<00:01,  5.32it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.33it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.33it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.30it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.27it/s] 80%|████████  | 20/25 [00:03<00:00,  5.28it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.29it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.31it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.31it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.32it/s]100%|██████████| 25/25 [00:04<00:00,  5.98it/s]100%|██████████| 25/25 [00:04<00:00,  5.41it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.23it/s]  8%|▊         | 2/25 [00:00<00:04,  5.21it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.24it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.23it/s] 20%|██        | 5/25 [00:00<00:03,  5.26it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.24it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.24it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.24it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.25it/s] 40%|████      | 10/25 [00:01<00:02,  5.26it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.27it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.25it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.24it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.25it/s] 60%|██████    | 15/25 [00:02<00:01,  5.25it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.26it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.27it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.27it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.27it/s] 80%|████████  | 20/25 [00:03<00:00,  5.27it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.24it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.24it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.22it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.21it/s]100%|██████████| 25/25 [00:04<00:00,  5.84it/s]100%|██████████| 25/25 [00:04<00:00,  5.32it/s]
Run 00 | Epoch 00021 | Loss 1.0379 | Train 0.6100 | Val 0.5963 | Test 0.4525
Number of nodes during this epoch:  4497880
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.5999341011047363  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.2209770679473877
range selection method range initialization spend 0.03284931182861328
time for parepare:  0.27343082427978516
local_output_nid generation:  0.024642229080200195
local_in_edges_tensor generation:  0.05479598045349121
mini_batch_src_global generation:  0.1083230972290039
r_  generation:  1.824167013168335
local_output_nid generation:  0.026615381240844727
local_in_edges_tensor generation:  0.049719810485839844
mini_batch_src_global generation:  0.15223312377929688
r_  generation:  1.9587607383728027
----------------------check_connections_block total spend ----------------------------- 5.07166314125061
generate_one_block  2.418652057647705
generate_one_block  2.296393632888794
The real block id is  1
get_global_graph_edges_ids_block function  spend 1.9904460906982422
gen group dst list time:  0.06604146957397461
time for parepare:  0.46170711517333984
local_output_nid generation:  0.18599987030029297
local_in_edges_tensor generation:  0.7682645320892334
mini_batch_src_global generation:  1.0483698844909668
r_  generation:  14.752578020095825
local_output_nid generation:  0.3684983253479004
local_in_edges_tensor generation:  0.9743988513946533
mini_batch_src_global generation:  1.496138095855713
r_  generation:  14.38559103012085
----------------------check_connections_block total spend ----------------------------- 39.4551887512207
generate_one_block  19.091569662094116
generate_one_block  19.220656394958496
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.3289382457733154
gen group dst list time:  0.15697503089904785
time for parepare:  0.45212292671203613
local_output_nid generation:  0.3955836296081543
local_in_edges_tensor generation:  1.0915882587432861
mini_batch_src_global generation:  1.3336546421051025
r_  generation:  18.829477071762085
local_output_nid generation:  0.675769567489624
local_in_edges_tensor generation:  1.3134922981262207
mini_batch_src_global generation:  1.7581562995910645
r_  generation:  18.417351722717285
----------------------check_connections_block total spend ----------------------------- 50.51191520690918
generate_one_block  23.635937929153442
generate_one_block  23.885465383529663
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.5999341011047363  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

connection checking time:  89.96710395812988
block generation total time  85.83362936973572
average batch blocks generation time:  42.91681468486786
block dataloader generation time/epoch 201.68416991600623
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.427232265472412  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.9850969314575195  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.4269556999206543  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.9851598739624023  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.9996687173843384
Total (block generation + training)time/epoch 204.01033997535706
Training 1 time/epoch 2.4667553901672363
Training time/epoch 2.4666123390197754
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 16.54it/s] 16%|█▌        | 4/25 [00:00<00:01, 17.15it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.52it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.63it/s] 40%|████      | 10/25 [00:00<00:00, 17.38it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.33it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.49it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.83it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.05it/s] 80%|████████  | 20/25 [00:01<00:00, 18.05it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.18it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.25it/s]100%|██████████| 25/25 [00:01<00:00, 18.07it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.19it/s]  8%|▊         | 2/25 [00:00<00:04,  5.12it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.22it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.28it/s] 20%|██        | 5/25 [00:00<00:03,  5.30it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.32it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.31it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.28it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.29it/s] 40%|████      | 10/25 [00:01<00:02,  5.32it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.34it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.35it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.36it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.34it/s] 60%|██████    | 15/25 [00:02<00:01,  5.31it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.32it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.32it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.31it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.32it/s] 80%|████████  | 20/25 [00:03<00:00,  5.32it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.30it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.29it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.29it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.28it/s]100%|██████████| 25/25 [00:04<00:00,  5.93it/s]100%|██████████| 25/25 [00:04<00:00,  5.38it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.10it/s]  8%|▊         | 2/25 [00:00<00:04,  5.17it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.19it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.22it/s] 20%|██        | 5/25 [00:00<00:03,  5.20it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.22it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.24it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.24it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.23it/s] 40%|████      | 10/25 [00:01<00:02,  5.23it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.23it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.21it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.17it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.18it/s] 60%|██████    | 15/25 [00:02<00:01,  5.20it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.19it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.22it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.23it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.22it/s] 80%|████████  | 20/25 [00:03<00:00,  5.23it/s] 84%|████████▍ | 21/25 [00:04<00:00,  5.23it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.21it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.20it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.22it/s]100%|██████████| 25/25 [00:04<00:00,  5.83it/s]100%|██████████| 25/25 [00:04<00:00,  5.29it/s]
Run 00 | Epoch 00022 | Loss 0.9997 | Train 0.6190 | Val 0.6054 | Test 0.4598
Number of nodes during this epoch:  4499468
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.598656177520752  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3015470504760742
range selection method range initialization spend 0.03202199935913086
time for parepare:  0.26448488235473633
local_output_nid generation:  0.024690628051757812
local_in_edges_tensor generation:  0.05030465126037598
mini_batch_src_global generation:  0.11362481117248535
r_  generation:  1.8140218257904053
local_output_nid generation:  0.026392221450805664
local_in_edges_tensor generation:  0.045005083084106445
mini_batch_src_global generation:  0.14390969276428223
r_  generation:  1.9504508972167969
----------------------check_connections_block total spend ----------------------------- 5.01661491394043
generate_one_block  2.727123975753784
generate_one_block  2.351943016052246
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.0626015663146973
gen group dst list time:  0.06611442565917969
time for parepare:  0.43799805641174316
local_output_nid generation:  0.18679046630859375
local_in_edges_tensor generation:  0.8969249725341797
mini_batch_src_global generation:  1.0553722381591797
r_  generation:  14.816559076309204
local_output_nid generation:  0.3569645881652832
local_in_edges_tensor generation:  1.028898000717163
mini_batch_src_global generation:  1.380882978439331
r_  generation:  14.919336080551147
----------------------check_connections_block total spend ----------------------------- 39.91773581504822
generate_one_block  19.343541145324707
generate_one_block  19.283692359924316
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.2368557453155518
gen group dst list time:  0.15335440635681152
time for parepare:  0.43808627128601074
local_output_nid generation:  0.39580368995666504
local_in_edges_tensor generation:  1.0215003490447998
mini_batch_src_global generation:  1.338073492050171
r_  generation:  18.776317596435547
local_output_nid generation:  0.6496224403381348
local_in_edges_tensor generation:  1.371673345565796
mini_batch_src_global generation:  1.653104543685913
r_  generation:  18.46252703666687
----------------------check_connections_block total spend ----------------------------- 50.4063982963562
generate_one_block  23.372151374816895
generate_one_block  24.07049298286438
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.598656177520752  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

connection checking time:  90.32413411140442
block generation total time  86.0698778629303
average batch blocks generation time:  43.03493893146515
block dataloader generation time/epoch 201.8003796339035
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.4272098541259766  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.9843196868896484  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.4270992279052734  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.986311912536621  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.9681074023246765
Total (block generation + training)time/epoch 204.12024784088135
Training 1 time/epoch 2.2379438877105713
Training time/epoch 2.2378013134002686
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 14.28it/s] 16%|█▌        | 4/25 [00:00<00:01, 15.50it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.54it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.30it/s] 40%|████      | 10/25 [00:00<00:00, 17.72it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.94it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.10it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.19it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.23it/s] 80%|████████  | 20/25 [00:01<00:00, 18.32it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.41it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.45it/s]100%|██████████| 25/25 [00:01<00:00, 18.12it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.79it/s]  8%|▊         | 2/25 [00:00<00:03,  5.90it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.94it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.92it/s] 20%|██        | 5/25 [00:00<00:03,  5.88it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.92it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.93it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.93it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.90it/s] 40%|████      | 10/25 [00:01<00:02,  5.92it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.94it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.94it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.88it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.89it/s] 60%|██████    | 15/25 [00:02<00:01,  5.92it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.88it/s] 68%|██████▊   | 17/25 [00:02<00:01,  5.90it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.92it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.94it/s] 80%|████████  | 20/25 [00:03<00:00,  5.95it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.96it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.98it/s] 92%|█████████▏| 23/25 [00:03<00:00,  5.98it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.99it/s]100%|██████████| 25/25 [00:04<00:00,  6.75it/s]100%|██████████| 25/25 [00:04<00:00,  6.02it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.48it/s]  8%|▊         | 2/25 [00:00<00:04,  5.25it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.28it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.53it/s] 20%|██        | 5/25 [00:00<00:03,  5.43it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.38it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.36it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.38it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.37it/s] 40%|████      | 10/25 [00:01<00:02,  5.34it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.36it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.35it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.34it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.33it/s] 60%|██████    | 15/25 [00:02<00:01,  5.34it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.48it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.42it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.37it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.37it/s] 80%|████████  | 20/25 [00:03<00:00,  5.37it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.34it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.31it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.20it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.24it/s]100%|██████████| 25/25 [00:04<00:00,  6.00it/s]100%|██████████| 25/25 [00:04<00:00,  5.43it/s]
Run 00 | Epoch 00023 | Loss 0.9681 | Train 0.6275 | Val 0.6133 | Test 0.4666
Number of nodes during this epoch:  4499796
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.5991764068603516  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3407590389251709
range selection method range initialization spend 0.03185224533081055
time for parepare:  0.2954230308532715
local_output_nid generation:  0.024809598922729492
local_in_edges_tensor generation:  0.06129312515258789
mini_batch_src_global generation:  0.12077593803405762
r_  generation:  1.8972582817077637
local_output_nid generation:  0.02783656120300293
local_in_edges_tensor generation:  0.04674077033996582
mini_batch_src_global generation:  0.14837265014648438
r_  generation:  1.951599359512329
----------------------check_connections_block total spend ----------------------------- 5.195920705795288
generate_one_block  2.803215503692627
generate_one_block  2.559823989868164
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.0484848022460938
gen group dst list time:  0.06439447402954102
time for parepare:  0.4304921627044678
local_output_nid generation:  0.1860344409942627
local_in_edges_tensor generation:  0.7518975734710693
mini_batch_src_global generation:  1.0478496551513672
r_  generation:  14.834796905517578
local_output_nid generation:  0.3670966625213623
local_in_edges_tensor generation:  1.1109592914581299
mini_batch_src_global generation:  1.4908742904663086
r_  generation:  14.336018562316895
----------------------check_connections_block total spend ----------------------------- 39.645344972610474
generate_one_block  18.926533937454224
generate_one_block  19.469561338424683
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.1614489555358887
gen group dst list time:  0.15105104446411133
time for parepare:  0.4382047653198242
local_output_nid generation:  0.36228370666503906
local_in_edges_tensor generation:  1.0075018405914307
mini_batch_src_global generation:  1.2136399745941162
r_  generation:  17.83039617538452
local_output_nid generation:  0.6012923717498779
local_in_edges_tensor generation:  1.260929822921753
mini_batch_src_global generation:  1.6372761726379395
r_  generation:  17.937910318374634
----------------------check_connections_block total spend ----------------------------- 48.24415183067322
generate_one_block  23.11088514328003
generate_one_block  23.66679286956787
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.5991764068603516  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

connection checking time:  87.88949680328369
block generation total time  85.1737732887268
average batch blocks generation time:  42.5868866443634
block dataloader generation time/epoch 201.74026562372845
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.427070140838623  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.985128402709961  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.4268674850463867  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.983510971069336  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.9365493655204773
Total (block generation + training)time/epoch 204.0593197822571
Training 1 time/epoch 2.3076577186584473
Training time/epoch 2.307506561279297
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.72it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.55it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.95it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.37it/s] 40%|████      | 10/25 [00:00<00:00, 17.77it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.01it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.71it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.09it/s] 72%|███████▏  | 18/25 [00:01<00:00, 15.89it/s] 80%|████████  | 20/25 [00:01<00:00, 15.69it/s] 88%|████████▊ | 22/25 [00:01<00:00, 16.24it/s] 96%|█████████▌| 24/25 [00:01<00:00, 16.69it/s]100%|██████████| 25/25 [00:01<00:00, 17.06it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.81it/s]  8%|▊         | 2/25 [00:00<00:03,  5.83it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.83it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.70it/s] 20%|██        | 5/25 [00:00<00:03,  5.53it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.49it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.47it/s] 32%|███▏      | 8/25 [00:01<00:02,  5.72it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.83it/s] 40%|████      | 10/25 [00:01<00:02,  5.91it/s] 44%|████▍     | 11/25 [00:01<00:02,  5.96it/s] 48%|████▊     | 12/25 [00:02<00:02,  6.00it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.65it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.50it/s] 60%|██████    | 15/25 [00:02<00:01,  5.42it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.38it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.35it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.34it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.29it/s] 80%|████████  | 20/25 [00:03<00:00,  5.20it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.26it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.29it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.31it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.32it/s]100%|██████████| 25/25 [00:04<00:00,  5.99it/s]100%|██████████| 25/25 [00:04<00:00,  5.58it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.17it/s]  8%|▊         | 2/25 [00:00<00:04,  5.27it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.26it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.24it/s] 20%|██        | 5/25 [00:00<00:03,  5.25it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.26it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.28it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.28it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.27it/s] 40%|████      | 10/25 [00:01<00:02,  5.25it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.26it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.26it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.27it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.26it/s] 60%|██████    | 15/25 [00:02<00:01,  5.24it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.25it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.25it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.25it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.24it/s] 80%|████████  | 20/25 [00:03<00:00,  5.23it/s] 84%|████████▍ | 21/25 [00:04<00:00,  5.16it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.15it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.09it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.13it/s]100%|██████████| 25/25 [00:04<00:00,  5.78it/s]100%|██████████| 25/25 [00:04<00:00,  5.30it/s]
Run 00 | Epoch 00024 | Loss 0.9365 | Train 0.6350 | Val 0.6211 | Test 0.4729
Number of nodes during this epoch:  4497796
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.598503589630127  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.30838942527770996
range selection method range initialization spend 0.029132843017578125
time for parepare:  0.2740061283111572
local_output_nid generation:  0.024452924728393555
local_in_edges_tensor generation:  0.05482339859008789
mini_batch_src_global generation:  0.10855340957641602
r_  generation:  1.7977304458618164
local_output_nid generation:  0.025976181030273438
local_in_edges_tensor generation:  0.04339790344238281
mini_batch_src_global generation:  0.14766716957092285
r_  generation:  1.9356253147125244
----------------------check_connections_block total spend ----------------------------- 4.998332977294922
generate_one_block  2.7476508617401123
generate_one_block  2.3497800827026367
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.3155148029327393
gen group dst list time:  0.06232333183288574
time for parepare:  0.4592857360839844
local_output_nid generation:  0.19479942321777344
local_in_edges_tensor generation:  0.7663006782531738
mini_batch_src_global generation:  1.0319302082061768
r_  generation:  14.469412803649902
local_output_nid generation:  0.35577917098999023
local_in_edges_tensor generation:  0.9545333385467529
mini_batch_src_global generation:  1.3970506191253662
r_  generation:  14.82930612564087
----------------------check_connections_block total spend ----------------------------- 39.251291275024414
generate_one_block  19.161865949630737
generate_one_block  19.115633726119995
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.2633023262023926
gen group dst list time:  0.16479063034057617
time for parepare:  0.44887280464172363
local_output_nid generation:  0.37723875045776367
local_in_edges_tensor generation:  1.0964832305908203
mini_batch_src_global generation:  1.2488648891448975
r_  generation:  18.536814212799072
local_output_nid generation:  0.6688308715820312
local_in_edges_tensor generation:  1.3046224117279053
mini_batch_src_global generation:  1.725304126739502
r_  generation:  18.4321129322052
----------------------check_connections_block total spend ----------------------------- 50.09023666381836
generate_one_block  23.516098976135254
generate_one_block  23.73453116416931
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.598503589630127  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

connection checking time:  89.34152793884277
block generation total time  85.5281298160553
average batch blocks generation time:  42.76406490802765
block dataloader generation time/epoch 201.79009827971458
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.4268221855163574  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.985189914703369  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.427708625793457  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.9864864349365234  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.9056959748268127
Total (block generation + training)time/epoch 204.10526314377785
Training 1 time/epoch 2.2568259239196777
Training time/epoch 2.2566797733306885
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 16.80it/s] 16%|█▌        | 4/25 [00:00<00:01, 17.67it/s] 24%|██▍       | 6/25 [00:00<00:01, 18.00it/s] 32%|███▏      | 8/25 [00:00<00:00, 18.21it/s] 40%|████      | 10/25 [00:00<00:00, 18.36it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.39it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.46it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.47it/s] 72%|███████▏  | 18/25 [00:00<00:00, 18.54it/s] 80%|████████  | 20/25 [00:01<00:00, 18.52it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.56it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.55it/s]100%|██████████| 25/25 [00:01<00:00, 18.62it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.22it/s]  8%|▊         | 2/25 [00:00<00:04,  5.25it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.35it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.35it/s] 20%|██        | 5/25 [00:00<00:03,  5.36it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.38it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.35it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.36it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.36it/s] 40%|████      | 10/25 [00:01<00:02,  5.35it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.35it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.31it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.29it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.26it/s] 60%|██████    | 15/25 [00:02<00:01,  5.27it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.28it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.30it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.28it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.28it/s] 80%|████████  | 20/25 [00:03<00:00,  5.31it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.34it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.31it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.29it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.31it/s]100%|██████████| 25/25 [00:04<00:00,  5.88it/s]100%|██████████| 25/25 [00:04<00:00,  5.38it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.20it/s]  8%|▊         | 2/25 [00:00<00:04,  5.21it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.20it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.14it/s] 20%|██        | 5/25 [00:00<00:03,  5.16it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.16it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.19it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.22it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.24it/s] 40%|████      | 10/25 [00:01<00:02,  5.27it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.24it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.22it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.19it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.18it/s] 60%|██████    | 15/25 [00:02<00:01,  5.21it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.22it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.22it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.20it/s] 76%|███████▌  | 19/25 [00:03<00:01,  4.60it/s] 80%|████████  | 20/25 [00:03<00:01,  4.53it/s] 84%|████████▍ | 21/25 [00:04<00:00,  4.64it/s] 88%|████████▊ | 22/25 [00:04<00:00,  4.78it/s] 92%|█████████▏| 23/25 [00:04<00:00,  4.92it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.02it/s]100%|██████████| 25/25 [00:04<00:00,  5.61it/s]100%|██████████| 25/25 [00:04<00:00,  5.13it/s]
Run 00 | Epoch 00025 | Loss 0.9057 | Train 0.6420 | Val 0.6282 | Test 0.4785
Number of nodes during this epoch:  4500391
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.6005859375  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3202824592590332
range selection method range initialization spend 0.02902841567993164
time for parepare:  0.27928733825683594
local_output_nid generation:  0.024630069732666016
local_in_edges_tensor generation:  0.06438875198364258
mini_batch_src_global generation:  0.11364579200744629
r_  generation:  1.841111660003662
local_output_nid generation:  0.026097536087036133
local_in_edges_tensor generation:  0.04445910453796387
mini_batch_src_global generation:  0.14785408973693848
r_  generation:  1.9763143062591553
----------------------check_connections_block total spend ----------------------------- 5.120172500610352
generate_one_block  2.7525134086608887
generate_one_block  2.328996181488037
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.157013416290283
gen group dst list time:  0.06796813011169434
time for parepare:  0.4724876880645752
local_output_nid generation:  0.1979508399963379
local_in_edges_tensor generation:  0.7880046367645264
mini_batch_src_global generation:  1.033714771270752
r_  generation:  14.826472043991089
local_output_nid generation:  0.36140966415405273
local_in_edges_tensor generation:  1.0259571075439453
mini_batch_src_global generation:  1.5117342472076416
r_  generation:  14.303319692611694
----------------------check_connections_block total spend ----------------------------- 39.451998710632324
generate_one_block  18.86875009536743
generate_one_block  19.242750883102417
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.21059250831604
gen group dst list time:  0.15148401260375977
time for parepare:  0.45348453521728516
local_output_nid generation:  0.37410688400268555
local_in_edges_tensor generation:  1.050903081893921
mini_batch_src_global generation:  1.3004860877990723
r_  generation:  18.731128931045532
local_output_nid generation:  0.6562168598175049
local_in_edges_tensor generation:  1.3547539710998535
mini_batch_src_global generation:  1.7336394786834717
r_  generation:  18.509169578552246
----------------------check_connections_block total spend ----------------------------- 50.34072518348694
generate_one_block  23.76080012321472
generate_one_block  24.09741497039795
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.6005859375  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

connection checking time:  89.79272389411926
block generation total time  85.96971607208252
average batch blocks generation time:  42.98485803604126
block dataloader generation time/epoch 201.84255943578833
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.4272456169128418  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.9862799644470215  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.4271693229675293  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.985748767852783  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.8803969621658325
Total (block generation + training)time/epoch 204.16151571273804
Training 1 time/epoch 2.3796188831329346
Training time/epoch 2.3794760704040527
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 16.00it/s] 16%|█▌        | 4/25 [00:00<00:01, 17.03it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.70it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.92it/s] 40%|████      | 10/25 [00:00<00:00, 18.08it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.24it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.74it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.12it/s] 72%|███████▏  | 18/25 [00:01<00:00, 16.84it/s] 80%|████████  | 20/25 [00:01<00:00, 16.70it/s] 88%|████████▊ | 22/25 [00:01<00:00, 16.31it/s] 96%|█████████▌| 24/25 [00:01<00:00, 16.05it/s]100%|██████████| 25/25 [00:01<00:00, 17.00it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.34it/s]  8%|▊         | 2/25 [00:00<00:04,  5.39it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.41it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.45it/s] 20%|██        | 5/25 [00:00<00:03,  5.72it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.48it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.41it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.39it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.42it/s] 40%|████      | 10/25 [00:01<00:02,  5.44it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.43it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.44it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.43it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.41it/s] 60%|██████    | 15/25 [00:02<00:01,  5.41it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.59it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.49it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.45it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.41it/s] 80%|████████  | 20/25 [00:03<00:00,  5.38it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.38it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.33it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.27it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.22it/s]100%|██████████| 25/25 [00:04<00:00,  5.85it/s]100%|██████████| 25/25 [00:04<00:00,  5.47it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.22it/s]  8%|▊         | 2/25 [00:00<00:04,  5.29it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.27it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.29it/s] 20%|██        | 5/25 [00:00<00:03,  5.27it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.29it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.29it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.25it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.23it/s] 40%|████      | 10/25 [00:01<00:02,  5.25it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.24it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.23it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.20it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.23it/s] 60%|██████    | 15/25 [00:02<00:01,  5.23it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.22it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.23it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.22it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.12it/s] 80%|████████  | 20/25 [00:03<00:01,  4.60it/s] 84%|████████▍ | 21/25 [00:04<00:00,  4.66it/s] 88%|████████▊ | 22/25 [00:04<00:00,  4.73it/s] 92%|█████████▏| 23/25 [00:04<00:00,  4.85it/s] 96%|█████████▌| 24/25 [00:04<00:00,  4.93it/s]100%|██████████| 25/25 [00:04<00:00,  5.62it/s]100%|██████████| 25/25 [00:04<00:00,  5.18it/s]
Run 00 | Epoch 00026 | Loss 0.8804 | Train 0.6482 | Val 0.6341 | Test 0.4836
Number of nodes during this epoch:  4500079
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.5991005897521973  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.32333827018737793
range selection method range initialization spend 0.030843734741210938
time for parepare:  0.30028343200683594
local_output_nid generation:  0.02434825897216797
local_in_edges_tensor generation:  0.07949352264404297
mini_batch_src_global generation:  0.11892843246459961
r_  generation:  1.834453821182251
local_output_nid generation:  0.026416301727294922
local_in_edges_tensor generation:  0.035091400146484375
mini_batch_src_global generation:  0.14813852310180664
r_  generation:  1.9833729267120361
----------------------check_connections_block total spend ----------------------------- 5.170613050460815
generate_one_block  2.7052364349365234
generate_one_block  2.3143107891082764
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.3153648376464844
gen group dst list time:  0.0686655044555664
time for parepare:  0.44878411293029785
local_output_nid generation:  0.19022130966186523
local_in_edges_tensor generation:  0.7902207374572754
mini_batch_src_global generation:  1.0828511714935303
r_  generation:  14.8710298538208
local_output_nid generation:  0.35449910163879395
local_in_edges_tensor generation:  0.9683277606964111
mini_batch_src_global generation:  1.492098331451416
r_  generation:  14.383682489395142
----------------------check_connections_block total spend ----------------------------- 39.550551652908325
generate_one_block  18.910049200057983
generate_one_block  19.219013452529907
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.140864372253418
gen group dst list time:  0.15845990180969238
time for parepare:  0.45697498321533203
local_output_nid generation:  0.41104555130004883
local_in_edges_tensor generation:  1.0653877258300781
mini_batch_src_global generation:  1.2831501960754395
r_  generation:  18.722261905670166
local_output_nid generation:  0.6641204357147217
local_in_edges_tensor generation:  1.3270957469940186
mini_batch_src_global generation:  1.7946884632110596
r_  generation:  19.337421655654907
----------------------check_connections_block total spend ----------------------------- 51.77528619766235
generate_one_block  23.49817419052124
generate_one_block  24.118231296539307
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.5991005897521973  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

connection checking time:  91.32583785057068
block generation total time  85.74546813964844
average batch blocks generation time:  42.87273406982422
block dataloader generation time/epoch 201.97871755229102
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.4268932342529297  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.9816083908081055  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.4278082847595215  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.9899282455444336  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.8540382385253906
Total (block generation + training)time/epoch 204.29807133144803
Training 1 time/epoch 2.32611083984375
Training time/epoch 2.3259663581848145
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.72it/s] 16%|█▌        | 4/25 [00:00<00:01, 17.00it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.56it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.91it/s] 40%|████      | 10/25 [00:00<00:00, 18.11it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.26it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.19it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.27it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.26it/s] 80%|████████  | 20/25 [00:01<00:00, 18.32it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.40it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.28it/s]100%|██████████| 25/25 [00:01<00:00, 18.33it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.30it/s]  8%|▊         | 2/25 [00:00<00:04,  5.38it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.29it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.28it/s] 20%|██        | 5/25 [00:00<00:03,  5.27it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.24it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.26it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.30it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.31it/s] 40%|████      | 10/25 [00:01<00:02,  5.28it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.32it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.32it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.29it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.32it/s] 60%|██████    | 15/25 [00:02<00:01,  5.32it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.28it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.28it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.31it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.30it/s] 80%|████████  | 20/25 [00:03<00:00,  5.29it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.29it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.31it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.24it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.28it/s]100%|██████████| 25/25 [00:04<00:00,  5.95it/s]100%|██████████| 25/25 [00:04<00:00,  5.37it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.10it/s]  8%|▊         | 2/25 [00:00<00:04,  5.21it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.24it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.22it/s] 20%|██        | 5/25 [00:00<00:03,  5.23it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.20it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.23it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.21it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.21it/s] 40%|████      | 10/25 [00:01<00:02,  5.22it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.24it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.23it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.23it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.22it/s] 60%|██████    | 15/25 [00:02<00:01,  5.22it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.22it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.22it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.22it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.23it/s] 80%|████████  | 20/25 [00:03<00:00,  5.22it/s] 84%|████████▍ | 21/25 [00:04<00:00,  5.19it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.22it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.24it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.24it/s]100%|██████████| 25/25 [00:04<00:00,  5.87it/s]100%|██████████| 25/25 [00:04<00:00,  5.30it/s]
Run 00 | Epoch 00027 | Loss 0.8540 | Train 0.6542 | Val 0.6396 | Test 0.4882
Number of nodes during this epoch:  4499119
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.601041793823242  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.21833586692810059
range selection method range initialization spend 0.03242635726928711
time for parepare:  0.27797722816467285
local_output_nid generation:  0.025828123092651367
local_in_edges_tensor generation:  0.054431915283203125
mini_batch_src_global generation:  0.11415219306945801
r_  generation:  1.7968952655792236
local_output_nid generation:  0.026563167572021484
local_in_edges_tensor generation:  0.0447237491607666
mini_batch_src_global generation:  0.14286351203918457
r_  generation:  1.9340362548828125
----------------------check_connections_block total spend ----------------------------- 5.010117053985596
generate_one_block  2.3185875415802
generate_one_block  2.34061861038208
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.0157201290130615
gen group dst list time:  0.06024742126464844
time for parepare:  0.42461490631103516
local_output_nid generation:  0.17821264266967773
local_in_edges_tensor generation:  0.7233600616455078
mini_batch_src_global generation:  1.0135207176208496
r_  generation:  13.926246881484985
local_output_nid generation:  0.3218045234680176
local_in_edges_tensor generation:  0.9696991443634033
mini_batch_src_global generation:  1.313523530960083
r_  generation:  14.238410234451294
----------------------check_connections_block total spend ----------------------------- 37.76674270629883
generate_one_block  19.03058934211731
generate_one_block  18.557588577270508
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.349928140640259
gen group dst list time:  0.16733956336975098
time for parepare:  0.4828002452850342
local_output_nid generation:  0.39484739303588867
local_in_edges_tensor generation:  1.095611572265625
mini_batch_src_global generation:  1.2391448020935059
r_  generation:  18.513266801834106
local_output_nid generation:  0.6565630435943604
local_in_edges_tensor generation:  1.291236162185669
mini_batch_src_global generation:  1.700270175933838
r_  generation:  18.605468034744263
----------------------check_connections_block total spend ----------------------------- 50.05333924293518
generate_one_block  23.337787628173828
generate_one_block  24.017725944519043
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.601041793823242  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

connection checking time:  87.82008194923401
block generation total time  84.94369149208069
average batch blocks generation time:  42.471845746040344
block dataloader generation time/epoch 201.84439527361016
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.4272031784057617  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.98576021194458  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.4268875122070312  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.9848241806030273  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.8309616446495056
Total (block generation + training)time/epoch 204.16244612242045
Training 1 time/epoch 2.29459810256958
Training time/epoch 2.2944555282592773
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 15.83it/s] 16%|█▌        | 4/25 [00:00<00:01, 17.19it/s] 24%|██▍       | 6/25 [00:00<00:01, 16.96it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.28it/s] 40%|████      | 10/25 [00:00<00:00, 17.72it/s] 48%|████▊     | 12/25 [00:00<00:00, 17.99it/s] 56%|█████▌    | 14/25 [00:00<00:00, 17.92it/s] 64%|██████▍   | 16/25 [00:00<00:00, 17.97it/s] 72%|███████▏  | 18/25 [00:01<00:00, 18.14it/s] 80%|████████  | 20/25 [00:01<00:00, 17.94it/s] 88%|████████▊ | 22/25 [00:01<00:00, 17.86it/s] 96%|█████████▌| 24/25 [00:01<00:00, 17.80it/s]100%|██████████| 25/25 [00:01<00:00, 17.93it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.25it/s]  8%|▊         | 2/25 [00:00<00:04,  5.29it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.38it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.42it/s] 20%|██        | 5/25 [00:00<00:03,  5.42it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.34it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.34it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.38it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.38it/s] 40%|████      | 10/25 [00:01<00:02,  5.38it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.40it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.37it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.37it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.30it/s] 60%|██████    | 15/25 [00:02<00:01,  5.33it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.34it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.34it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.35it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.35it/s] 80%|████████  | 20/25 [00:03<00:00,  5.36it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.37it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.36it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.35it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.32it/s]100%|██████████| 25/25 [00:04<00:00,  5.98it/s]100%|██████████| 25/25 [00:04<00:00,  5.43it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.16it/s]  8%|▊         | 2/25 [00:00<00:04,  5.18it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.18it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.20it/s] 20%|██        | 5/25 [00:00<00:03,  5.20it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.21it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.22it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.23it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.23it/s] 40%|████      | 10/25 [00:01<00:02,  5.23it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.22it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.23it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.23it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.21it/s] 60%|██████    | 15/25 [00:02<00:01,  5.23it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.22it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.21it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.23it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.21it/s] 80%|████████  | 20/25 [00:03<00:00,  5.23it/s] 84%|████████▍ | 21/25 [00:04<00:00,  5.22it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.21it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.23it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.23it/s]100%|██████████| 25/25 [00:04<00:00,  5.85it/s]100%|██████████| 25/25 [00:04<00:00,  5.29it/s]
Run 00 | Epoch 00028 | Loss 0.8310 | Train 0.6590 | Val 0.6436 | Test 0.4921
Number of nodes during this epoch:  4498453
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.598827838897705  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.30847954750061035
range selection method range initialization spend 0.036841630935668945
time for parepare:  0.28063082695007324
local_output_nid generation:  0.024382352828979492
local_in_edges_tensor generation:  0.05161404609680176
mini_batch_src_global generation:  0.11339712142944336
r_  generation:  1.8744494915008545
local_output_nid generation:  0.027014970779418945
local_in_edges_tensor generation:  0.05777597427368164
mini_batch_src_global generation:  0.1531085968017578
r_  generation:  2.081540107727051
----------------------check_connections_block total spend ----------------------------- 5.297322034835815
generate_one_block  2.7762787342071533
generate_one_block  2.3985536098480225
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.226569175720215
gen group dst list time:  0.06111931800842285
time for parepare:  0.424837589263916
local_output_nid generation:  0.19486474990844727
local_in_edges_tensor generation:  0.7355237007141113
mini_batch_src_global generation:  1.0552256107330322
r_  generation:  15.61176609992981
local_output_nid generation:  0.3587057590484619
local_in_edges_tensor generation:  0.9599823951721191
mini_batch_src_global generation:  1.4566395282745361
r_  generation:  14.59807014465332
----------------------check_connections_block total spend ----------------------------- 40.55789136886597
generate_one_block  18.998594760894775
generate_one_block  19.35921812057495
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.1252903938293457
gen group dst list time:  0.1567370891571045
time for parepare:  0.4572131633758545
local_output_nid generation:  0.38453102111816406
local_in_edges_tensor generation:  1.070183277130127
mini_batch_src_global generation:  1.2733502388000488
r_  generation:  19.065118551254272
local_output_nid generation:  0.6684343814849854
local_in_edges_tensor generation:  1.3213067054748535
mini_batch_src_global generation:  1.7571206092834473
r_  generation:  18.531095266342163
----------------------check_connections_block total spend ----------------------------- 50.7748486995697
generate_one_block  23.490529537200928
generate_one_block  23.980271577835083
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 2.598827838897705  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

connection checking time:  91.33274006843567
block generation total time  85.82861399650574
average batch blocks generation time:  42.91430699825287
block dataloader generation time/epoch 201.99547867774965
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.4272356033325195  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.985602378845215  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 1.4270896911621094  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0389404296875 GB
    Memory Allocated: 3.9862465858459473  GigaBytes
Max Memory Allocated: 10.387556076049805  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.8074678182601929
Total (block generation + training)time/epoch 204.31045632362367
Training 1 time/epoch 2.256587266921997
Training time/epoch 2.256443738937378
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 16.29it/s] 16%|█▌        | 4/25 [00:00<00:01, 16.87it/s] 24%|██▍       | 6/25 [00:00<00:01, 17.56it/s] 32%|███▏      | 8/25 [00:00<00:00, 17.93it/s] 40%|████      | 10/25 [00:00<00:00, 18.13it/s] 48%|████▊     | 12/25 [00:00<00:00, 18.30it/s] 56%|█████▌    | 14/25 [00:00<00:00, 18.36it/s] 64%|██████▍   | 16/25 [00:00<00:00, 18.43it/s] 72%|███████▏  | 18/25 [00:00<00:00, 18.46it/s] 80%|████████  | 20/25 [00:01<00:00, 18.49it/s] 88%|████████▊ | 22/25 [00:01<00:00, 18.46it/s] 96%|█████████▌| 24/25 [00:01<00:00, 18.41it/s]100%|██████████| 25/25 [00:01<00:00, 18.44it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.15it/s]  8%|▊         | 2/25 [00:00<00:04,  5.23it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.30it/s] 16%|█▌        | 4/25 [00:00<00:03,  5.28it/s] 20%|██        | 5/25 [00:00<00:03,  5.25it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.27it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.27it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.28it/s] 36%|███▌      | 9/25 [00:01<00:03,  5.28it/s] 40%|████      | 10/25 [00:01<00:02,  5.24it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.26it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.27it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.29it/s] 56%|█████▌    | 14/25 [00:02<00:02,  5.30it/s] 60%|██████    | 15/25 [00:02<00:01,  5.31it/s] 64%|██████▍   | 16/25 [00:03<00:01,  5.31it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.30it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.28it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.28it/s] 80%|████████  | 20/25 [00:03<00:00,  5.30it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.31it/s] 88%|████████▊ | 22/25 [00:04<00:00,  5.31it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.32it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.31it/s]100%|██████████| 25/25 [00:04<00:00,  5.96it/s]100%|██████████| 25/25 [00:04<00:00,  5.36it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.10it/s]  8%|▊         | 2/25 [00:00<00:04,  4.97it/s] 12%|█▏        | 3/25 [00:00<00:04,  5.10it/s] 16%|█▌        | 4/25 [00:00<00:04,  5.18it/s] 20%|██        | 5/25 [00:00<00:03,  5.24it/s] 24%|██▍       | 6/25 [00:01<00:03,  5.26it/s] 28%|██▊       | 7/25 [00:01<00:03,  5.30it/s] 32%|███▏      | 8/25 [00:01<00:03,  5.30it/s] 36%|███▌      | 9/25 [00:01<00:02,  5.55it/s] 40%|████      | 10/25 [00:01<00:02,  5.68it/s] 44%|████▍     | 11/25 [00:02<00:02,  5.72it/s] 48%|████▊     | 12/25 [00:02<00:02,  5.78it/s] 52%|█████▏    | 13/25 [00:02<00:02,  5.83it/s] 56%|█████▌    | 14/25 [00:02<00:01,  5.87it/s] 60%|██████    | 15/25 [00:02<00:01,  5.83it/s] 64%|██████▍   | 16/25 [00:02<00:01,  5.87it/s] 68%|██████▊   | 17/25 [00:03<00:01,  5.89it/s] 72%|███████▏  | 18/25 [00:03<00:01,  5.90it/s] 76%|███████▌  | 19/25 [00:03<00:01,  5.77it/s] 80%|████████  | 20/25 [00:03<00:00,  5.83it/s] 84%|████████▍ | 21/25 [00:03<00:00,  5.86it/s] 88%|████████▊ | 22/25 [00:03<00:00,  5.79it/s] 92%|█████████▏| 23/25 [00:04<00:00,  5.65it/s] 96%|█████████▌| 24/25 [00:04<00:00,  5.58it/s]100%|██████████| 25/25 [00:04<00:00,  6.19it/s]100%|██████████| 25/25 [00:04<00:00,  5.68it/s]
Run 00 | Epoch 00029 | Loss 0.8075 | Train 0.6632 | Val 0.6488 | Test 0.4956
Number of nodes during this epoch:  4498994
The number of model layers:  3
Run 01:
Highest Train: 66.32
Highest Valid: 64.88
  Final Train: 66.32
   Final Test: 49.56
The number of model layers:  3
All runs:
Highest Train: 66.32 ± nan
Highest Valid: 64.88 ± nan
  Final Train: 66.32 ± nan
   Final Test: 49.56 ± nan
