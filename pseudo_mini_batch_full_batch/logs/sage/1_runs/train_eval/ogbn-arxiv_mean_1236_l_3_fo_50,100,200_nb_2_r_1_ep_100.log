Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1647072373.4916444
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.031819820404052734
range selection method range initialization spend 0.013910055160522461
time for parepare:  0.0180666446685791
local_output_nid generation:  0.010557174682617188
local_in_edges_tensor generation:  0.009265899658203125
mini_batch_src_global generation:  0.017015695571899414
r_  generation:  0.20827221870422363
local_output_nid generation:  0.011740684509277344
local_in_edges_tensor generation:  0.012538909912109375
mini_batch_src_global generation:  0.0222623348236084
r_  generation:  0.21794342994689941
----------------------check_connections_block total spend ----------------------------- 0.6095092296600342
generate_one_block  0.24666285514831543
generate_one_block  0.24879741668701172
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04337024688720703
gen group dst list time:  0.008063077926635742
time for parepare:  0.019399166107177734
local_output_nid generation:  0.01743006706237793
local_in_edges_tensor generation:  0.040430545806884766
mini_batch_src_global generation:  0.05453824996948242
r_  generation:  0.582566499710083
local_output_nid generation:  0.027708768844604492
local_in_edges_tensor generation:  0.05399298667907715
mini_batch_src_global generation:  0.06809186935424805
r_  generation:  0.5980401039123535
----------------------check_connections_block total spend ----------------------------- 1.718872308731079
generate_one_block  0.7859854698181152
generate_one_block  0.8153524398803711
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04374957084655762
gen group dst list time:  0.015109539031982422
time for parepare:  0.019643068313598633
local_output_nid generation:  0.02218151092529297
local_in_edges_tensor generation:  0.05469799041748047
mini_batch_src_global generation:  0.052939653396606445
r_  generation:  0.576685905456543
local_output_nid generation:  0.03119516372680664
local_in_edges_tensor generation:  0.052469730377197266
mini_batch_src_global generation:  0.06725692749023438
r_  generation:  0.5866575241088867
----------------------check_connections_block total spend ----------------------------- 1.7305171489715576
generate_one_block  0.769932746887207
generate_one_block  0.7447640895843506
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  3.4493894577026367
block generation total time  3.116034746170044
average batch blocks generation time:  1.558017373085022
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2010498046875 GB
    Memory Allocated: 0.11306524276733398  GigaBytes
Max Memory Allocated: 0.11306524276733398  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9295654296875 GB
    Memory Allocated: 1.3347864151000977  GigaBytes
Max Memory Allocated: 1.452507495880127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5623779296875 GB
    Memory Allocated: 0.1206369400024414  GigaBytes
Max Memory Allocated: 1.605018138885498  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5623779296875 GB
    Memory Allocated: 1.3306384086608887  GigaBytes
Max Memory Allocated: 1.605018138885498  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05509984493255615 |0.17749834060668945 |0.3854104280471802 |0.0006111860275268555 |0.032506465911865234 |0.0022139549255371094 |
----------------------------------------------------------pseudo_mini_loss sum 6.087927341461182
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.14it/s]100%|██████████| 4/4 [00:00<00:00, 27.72it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.58it/s]100%|██████████| 4/4 [00:00<00:00, 11.94it/s]100%|██████████| 4/4 [00:00<00:00, 11.87it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.40it/s]100%|██████████| 4/4 [00:00<00:00, 17.64it/s]100%|██████████| 4/4 [00:00<00:00, 17.59it/s]
Run 00 | Epoch 00000 | Loss 6.0879 | Train 0.2929 | Val 0.3118 | Test 0.2857
Number of nodes during this epoch:  335640
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5701904296875 GB
    Memory Allocated: 0.17539358139038086  GigaBytes
Max Memory Allocated: 1.605018138885498  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024970293045043945
range selection method range initialization spend 0.016950130462646484
time for parepare:  0.020726680755615234
local_output_nid generation:  0.010541677474975586
local_in_edges_tensor generation:  0.015146255493164062
mini_batch_src_global generation:  0.01998448371887207
r_  generation:  0.21014809608459473
local_output_nid generation:  0.011675119400024414
local_in_edges_tensor generation:  0.012749433517456055
mini_batch_src_global generation:  0.023380041122436523
r_  generation:  0.22238945960998535
----------------------check_connections_block total spend ----------------------------- 0.629185676574707
generate_one_block  0.25681447982788086
generate_one_block  0.2523674964904785
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04396843910217285
gen group dst list time:  0.007957220077514648
time for parepare:  0.019482851028442383
local_output_nid generation:  0.017335891723632812
local_in_edges_tensor generation:  0.04855155944824219
mini_batch_src_global generation:  0.05495762825012207
r_  generation:  0.6088144779205322
local_output_nid generation:  0.033747196197509766
local_in_edges_tensor generation:  0.057623863220214844
mini_batch_src_global generation:  0.07816123962402344
r_  generation:  0.6276631355285645
----------------------check_connections_block total spend ----------------------------- 1.8098866939544678
generate_one_block  0.7927405834197998
generate_one_block  0.7904839515686035
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04393625259399414
gen group dst list time:  0.014736652374267578
time for parepare:  0.01869821548461914
local_output_nid generation:  0.021231651306152344
local_in_edges_tensor generation:  0.04815411567687988
mini_batch_src_global generation:  0.05550408363342285
r_  generation:  0.6025776863098145
local_output_nid generation:  0.036466360092163086
local_in_edges_tensor generation:  0.06119346618652344
mini_batch_src_global generation:  0.07374739646911621
r_  generation:  0.5834262371063232
----------------------check_connections_block total spend ----------------------------- 1.7713463306427002
generate_one_block  0.7663209438323975
generate_one_block  0.7764613628387451
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5701904296875 GB
    Memory Allocated: 0.17539358139038086  GigaBytes
Max Memory Allocated: 1.605018138885498  GigaBytes

connection checking time:  3.581233024597168
block generation total time  3.126006841659546
average batch blocks generation time:  1.563003420829773
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5701904296875 GB
    Memory Allocated: 0.12225770950317383  GigaBytes
Max Memory Allocated: 1.605018138885498  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5701904296875 GB
    Memory Allocated: 1.3364372253417969  GigaBytes
Max Memory Allocated: 1.605018138885498  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5701904296875 GB
    Memory Allocated: 0.12226152420043945  GigaBytes
Max Memory Allocated: 1.6073689460754395  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3365836143493652  GigaBytes
Max Memory Allocated: 1.6073689460754395  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08889079093933105 |0.030945777893066406 |0.004412055015563965 |0.0004981756210327148 |0.003832578659057617 |0.003175497055053711 |
----------------------------------------------------------pseudo_mini_loss sum 3.237175941467285
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.83it/s]100%|██████████| 4/4 [00:00<00:00, 29.39it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.46it/s]100%|██████████| 4/4 [00:00<00:00, 12.62it/s]100%|██████████| 4/4 [00:00<00:00, 12.42it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.16it/s]100%|██████████| 4/4 [00:00<00:00, 17.59it/s]100%|██████████| 4/4 [00:00<00:00, 17.50it/s]
Run 00 | Epoch 00001 | Loss 3.2372 | Train 0.3388 | Val 0.4029 | Test 0.4407
Number of nodes during this epoch:  335620
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17533540725708008  GigaBytes
Max Memory Allocated: 1.607642650604248  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026575088500976562
range selection method range initialization spend 0.013200759887695312
time for parepare:  0.01756906509399414
local_output_nid generation:  0.01049184799194336
local_in_edges_tensor generation:  0.010041475296020508
mini_batch_src_global generation:  0.017625808715820312
r_  generation:  0.20704936981201172
local_output_nid generation:  0.011581897735595703
local_in_edges_tensor generation:  0.0077741146087646484
mini_batch_src_global generation:  0.023015260696411133
r_  generation:  0.22494220733642578
----------------------check_connections_block total spend ----------------------------- 0.612762451171875
generate_one_block  0.24844932556152344
generate_one_block  0.24911975860595703
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.051618099212646484
gen group dst list time:  0.007847785949707031
time for parepare:  0.020502328872680664
local_output_nid generation:  0.018128633499145508
local_in_edges_tensor generation:  0.03902459144592285
mini_batch_src_global generation:  0.07065010070800781
r_  generation:  0.5805568695068359
local_output_nid generation:  0.030071496963500977
local_in_edges_tensor generation:  0.036577463150024414
mini_batch_src_global generation:  0.06828999519348145
r_  generation:  0.5929760932922363
----------------------check_connections_block total spend ----------------------------- 1.7096898555755615
generate_one_block  0.7589747905731201
generate_one_block  0.7938251495361328
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03391909599304199
gen group dst list time:  0.014884710311889648
time for parepare:  0.019431114196777344
local_output_nid generation:  0.022825956344604492
local_in_edges_tensor generation:  0.04613685607910156
mini_batch_src_global generation:  0.05682182312011719
r_  generation:  0.5749995708465576
local_output_nid generation:  0.03261518478393555
local_in_edges_tensor generation:  0.03980851173400879
mini_batch_src_global generation:  0.06839156150817871
r_  generation:  0.585167407989502
----------------------check_connections_block total spend ----------------------------- 1.712672233581543
generate_one_block  0.7273306846618652
generate_one_block  0.745957612991333
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17533540725708008  GigaBytes
Max Memory Allocated: 1.607642650604248  GigaBytes

connection checking time:  3.4223620891571045
block generation total time  3.026088237762451
average batch blocks generation time:  1.5130441188812256
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1222233772277832  GigaBytes
Max Memory Allocated: 1.607642650604248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3363385200500488  GigaBytes
Max Memory Allocated: 1.607642650604248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12231588363647461  GigaBytes
Max Memory Allocated: 1.607642650604248  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.336719036102295  GigaBytes
Max Memory Allocated: 1.607642650604248  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08564352989196777 |0.029720425605773926 |0.004104495048522949 |0.0005050897598266602 |0.0032862424850463867 |0.0013916492462158203 |
----------------------------------------------------------pseudo_mini_loss sum 2.6230454444885254
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 61.37it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.22it/s]100%|██████████| 4/4 [00:00<00:00, 18.97it/s]100%|██████████| 4/4 [00:00<00:00, 18.83it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.33it/s]100%|██████████| 4/4 [00:00<00:00, 23.03it/s]
Run 00 | Epoch 00002 | Loss 2.6230 | Train 0.2944 | Val 0.2964 | Test 0.3479
Number of nodes during this epoch:  335657
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17540597915649414  GigaBytes
Max Memory Allocated: 1.6078824996948242  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03261423110961914
range selection method range initialization spend 0.012326717376708984
time for parepare:  0.017616748809814453
local_output_nid generation:  0.01049184799194336
local_in_edges_tensor generation:  0.009412765502929688
mini_batch_src_global generation:  0.017800331115722656
r_  generation:  0.20444107055664062
local_output_nid generation:  0.011706352233886719
local_in_edges_tensor generation:  0.006495237350463867
mini_batch_src_global generation:  0.02222752571105957
r_  generation:  0.22246170043945312
----------------------check_connections_block total spend ----------------------------- 0.605236291885376
generate_one_block  0.24557733535766602
generate_one_block  0.2478351593017578
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04079246520996094
gen group dst list time:  0.007647991180419922
time for parepare:  0.019689083099365234
local_output_nid generation:  0.0181276798248291
local_in_edges_tensor generation:  0.030858755111694336
mini_batch_src_global generation:  0.05449390411376953
r_  generation:  0.5912399291992188
local_output_nid generation:  0.026942014694213867
local_in_edges_tensor generation:  0.030475139617919922
mini_batch_src_global generation:  0.06865310668945312
r_  generation:  0.5982155799865723
----------------------check_connections_block total spend ----------------------------- 1.6911871433258057
generate_one_block  0.7506635189056396
generate_one_block  0.7501668930053711
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030877351760864258
gen group dst list time:  0.012995004653930664
time for parepare:  0.018634557723999023
local_output_nid generation:  0.02202892303466797
local_in_edges_tensor generation:  0.03653359413146973
mini_batch_src_global generation:  0.052837371826171875
r_  generation:  0.5836122035980225
local_output_nid generation:  0.033445119857788086
local_in_edges_tensor generation:  0.034743547439575195
mini_batch_src_global generation:  0.07817840576171875
r_  generation:  0.6034657955169678
----------------------check_connections_block total spend ----------------------------- 1.7453844547271729
generate_one_block  0.7422401905059814
generate_one_block  0.733527421951294
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17540597915649414  GigaBytes
Max Memory Allocated: 1.6078824996948242  GigaBytes

connection checking time:  3.4365715980529785
block generation total time  2.976598024368286
average batch blocks generation time:  1.488299012184143
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12226247787475586  GigaBytes
Max Memory Allocated: 1.6078824996948242  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3366050720214844  GigaBytes
Max Memory Allocated: 1.6078824996948242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12226533889770508  GigaBytes
Max Memory Allocated: 1.6078824996948242  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.336479663848877  GigaBytes
Max Memory Allocated: 1.6078824996948242  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0887000560760498 |0.029678702354431152 |0.004058837890625 |0.0004937648773193359 |0.0032067298889160156 |0.001619577407836914 |
----------------------------------------------------------pseudo_mini_loss sum 2.3984925746917725
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 51.74it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.26it/s]100%|██████████| 4/4 [00:00<00:00, 15.70it/s]100%|██████████| 4/4 [00:00<00:00, 15.61it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.38it/s]100%|██████████| 4/4 [00:00<00:00, 17.95it/s]100%|██████████| 4/4 [00:00<00:00, 17.84it/s]
Run 00 | Epoch 00003 | Loss 2.3985 | Train 0.4169 | Val 0.4775 | Test 0.5077
Number of nodes during this epoch:  335595
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17540359497070312  GigaBytes
Max Memory Allocated: 1.6078824996948242  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0233612060546875
range selection method range initialization spend 0.012431144714355469
time for parepare:  0.017702579498291016
local_output_nid generation:  0.010436296463012695
local_in_edges_tensor generation:  0.011530637741088867
mini_batch_src_global generation:  0.016997098922729492
r_  generation:  0.2071247100830078
local_output_nid generation:  0.011574983596801758
local_in_edges_tensor generation:  0.007306337356567383
mini_batch_src_global generation:  0.022240161895751953
r_  generation:  0.22348952293395996
----------------------check_connections_block total spend ----------------------------- 0.6115970611572266
generate_one_block  0.2508125305175781
generate_one_block  0.2499217987060547
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03604745864868164
gen group dst list time:  0.00765681266784668
time for parepare:  0.019783496856689453
local_output_nid generation:  0.017951488494873047
local_in_edges_tensor generation:  0.03986549377441406
mini_batch_src_global generation:  0.06005358695983887
r_  generation:  0.5810437202453613
local_output_nid generation:  0.028017759323120117
local_in_edges_tensor generation:  0.032831668853759766
mini_batch_src_global generation:  0.06787109375
r_  generation:  0.5961618423461914
----------------------check_connections_block total spend ----------------------------- 1.694627285003662
generate_one_block  0.7483747005462646
generate_one_block  0.7544894218444824
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03000330924987793
gen group dst list time:  0.012867927551269531
time for parepare:  0.018735647201538086
local_output_nid generation:  0.022119998931884766
local_in_edges_tensor generation:  0.03327035903930664
mini_batch_src_global generation:  0.052425384521484375
r_  generation:  0.5837404727935791
local_output_nid generation:  0.032404184341430664
local_in_edges_tensor generation:  0.03733563423156738
mini_batch_src_global generation:  0.06937980651855469
r_  generation:  0.5879290103912354
----------------------check_connections_block total spend ----------------------------- 1.703657627105713
generate_one_block  0.7601079940795898
generate_one_block  0.7618606090545654
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17540359497070312  GigaBytes
Max Memory Allocated: 1.6078824996948242  GigaBytes

connection checking time:  3.398284912109375
block generation total time  3.0248327255249023
average batch blocks generation time:  1.5124163627624512
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12224149703979492  GigaBytes
Max Memory Allocated: 1.6078824996948242  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3364343643188477  GigaBytes
Max Memory Allocated: 1.6078824996948242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12228631973266602  GigaBytes
Max Memory Allocated: 1.6078824996948242  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3366765975952148  GigaBytes
Max Memory Allocated: 1.6078824996948242  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08397781848907471 |0.03006112575531006 |0.004078388214111328 |0.0004973411560058594 |0.04294848442077637 |0.002965211868286133 |
----------------------------------------------------------pseudo_mini_loss sum 2.1249752044677734
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 47.99it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.44it/s]100%|██████████| 4/4 [00:00<00:00, 18.82it/s]100%|██████████| 4/4 [00:00<00:00, 18.74it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.84it/s]100%|██████████| 4/4 [00:00<00:00, 23.44it/s]
Run 00 | Epoch 00004 | Loss 2.1250 | Train 0.4307 | Val 0.4415 | Test 0.4321
Number of nodes during this epoch:  335665
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17535781860351562  GigaBytes
Max Memory Allocated: 1.6078824996948242  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023393869400024414
range selection method range initialization spend 0.01210784912109375
time for parepare:  0.018196821212768555
local_output_nid generation:  0.010409355163574219
local_in_edges_tensor generation:  0.012861967086791992
mini_batch_src_global generation:  0.017016887664794922
r_  generation:  0.20418977737426758
local_output_nid generation:  0.011446475982666016
local_in_edges_tensor generation:  0.007321357727050781
mini_batch_src_global generation:  0.022452116012573242
r_  generation:  0.22004055976867676
----------------------check_connections_block total spend ----------------------------- 0.6098949909210205
generate_one_block  0.24546551704406738
generate_one_block  0.2469162940979004
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03313279151916504
gen group dst list time:  0.007694244384765625
time for parepare:  0.01975393295288086
local_output_nid generation:  0.017490863800048828
local_in_edges_tensor generation:  0.03654599189758301
mini_batch_src_global generation:  0.05462193489074707
r_  generation:  0.5866439342498779
local_output_nid generation:  0.02623271942138672
local_in_edges_tensor generation:  0.034836530685424805
mini_batch_src_global generation:  0.0783681869506836
r_  generation:  0.596320629119873
----------------------check_connections_block total spend ----------------------------- 1.700406789779663
generate_one_block  0.7566826343536377
generate_one_block  0.745018720626831
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028926849365234375
gen group dst list time:  0.013728141784667969
time for parepare:  0.018778085708618164
local_output_nid generation:  0.021525144577026367
local_in_edges_tensor generation:  0.033963918685913086
mini_batch_src_global generation:  0.05234527587890625
r_  generation:  0.5790462493896484
local_output_nid generation:  0.03165578842163086
local_in_edges_tensor generation:  0.0343625545501709
mini_batch_src_global generation:  0.06807923316955566
r_  generation:  0.5920758247375488
----------------------check_connections_block total spend ----------------------------- 1.6944944858551025
generate_one_block  0.7241733074188232
generate_one_block  0.7287473678588867
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17535781860351562  GigaBytes
Max Memory Allocated: 1.6078824996948242  GigaBytes

connection checking time:  3.3949012756347656
block generation total time  2.9546220302581787
average batch blocks generation time:  1.4773110151290894
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12224817276000977  GigaBytes
Max Memory Allocated: 1.6078824996948242  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3365225791931152  GigaBytes
Max Memory Allocated: 1.6078824996948242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12226438522338867  GigaBytes
Max Memory Allocated: 1.6078824996948242  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3364753723144531  GigaBytes
Max Memory Allocated: 1.6078824996948242  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09112882614135742 |0.023589730262756348 |0.004024028778076172 |0.0004913806915283203 |0.003683924674987793 |0.0017821788787841797 |
----------------------------------------------------------pseudo_mini_loss sum 1.978143334388733
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 54.81it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.40it/s]100%|██████████| 4/4 [00:00<00:00, 18.12it/s]100%|██████████| 4/4 [00:00<00:00, 17.82it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.70it/s]100%|██████████| 4/4 [00:00<00:00, 20.72it/s]
Run 00 | Epoch 00005 | Loss 1.9781 | Train 0.4301 | Val 0.4184 | Test 0.3930
Number of nodes during this epoch:  335664
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17540693283081055  GigaBytes
Max Memory Allocated: 1.6078824996948242  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02512645721435547
range selection method range initialization spend 0.012484073638916016
time for parepare:  0.017844438552856445
local_output_nid generation:  0.010454177856445312
local_in_edges_tensor generation:  0.012368202209472656
mini_batch_src_global generation:  0.01850295066833496
r_  generation:  0.21723294258117676
local_output_nid generation:  0.011761665344238281
local_in_edges_tensor generation:  0.006590127944946289
mini_batch_src_global generation:  0.021886825561523438
r_  generation:  0.22359585762023926
----------------------check_connections_block total spend ----------------------------- 0.6228885650634766
generate_one_block  0.24880599975585938
generate_one_block  0.24623680114746094
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0372161865234375
gen group dst list time:  0.007738590240478516
time for parepare:  0.02041029930114746
local_output_nid generation:  0.018083810806274414
local_in_edges_tensor generation:  0.03508806228637695
mini_batch_src_global generation:  0.05620241165161133
r_  generation:  0.590479850769043
local_output_nid generation:  0.027422666549682617
local_in_edges_tensor generation:  0.038704872131347656
mini_batch_src_global generation:  0.06779742240905762
r_  generation:  0.6004655361175537
----------------------check_connections_block total spend ----------------------------- 1.7058792114257812
generate_one_block  0.7517654895782471
generate_one_block  0.7478904724121094
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0295565128326416
gen group dst list time:  0.012479305267333984
time for parepare:  0.019111156463623047
local_output_nid generation:  0.021634817123413086
local_in_edges_tensor generation:  0.03397178649902344
mini_batch_src_global generation:  0.05288100242614746
r_  generation:  0.571835994720459
local_output_nid generation:  0.032442569732666016
local_in_edges_tensor generation:  0.03183865547180176
mini_batch_src_global generation:  0.06806135177612305
r_  generation:  0.5805292129516602
----------------------check_connections_block total spend ----------------------------- 1.6773765087127686
generate_one_block  0.7283623218536377
generate_one_block  0.726884126663208
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17540693283081055  GigaBytes
Max Memory Allocated: 1.6078824996948242  GigaBytes

connection checking time:  3.38325572013855
block generation total time  2.954902410507202
average batch blocks generation time:  1.477451205253601
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12230730056762695  GigaBytes
Max Memory Allocated: 1.6078824996948242  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.336585521697998  GigaBytes
Max Memory Allocated: 1.6078824996948242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1222233772277832  GigaBytes
Max Memory Allocated: 1.6078824996948242  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3365535736083984  GigaBytes
Max Memory Allocated: 1.6078824996948242  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09104049205780029 |0.018378853797912598 |0.004168868064880371 |0.0005133152008056641 |0.0416865348815918 |0.0032029151916503906 |
----------------------------------------------------------pseudo_mini_loss sum 1.8933099508285522
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 56.83it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.14it/s]100%|██████████| 4/4 [00:00<00:00, 18.96it/s]100%|██████████| 4/4 [00:00<00:00, 18.81it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.79it/s]100%|██████████| 4/4 [00:00<00:00, 23.46it/s]
Run 00 | Epoch 00006 | Loss 1.8933 | Train 0.4324 | Val 0.4252 | Test 0.3978
Number of nodes during this epoch:  335706
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17527103424072266  GigaBytes
Max Memory Allocated: 1.6078824996948242  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022085905075073242
range selection method range initialization spend 0.011656999588012695
time for parepare:  0.017775774002075195
local_output_nid generation:  0.010721921920776367
local_in_edges_tensor generation:  0.009178400039672852
mini_batch_src_global generation:  0.017476558685302734
r_  generation:  0.20657658576965332
local_output_nid generation:  0.0117034912109375
local_in_edges_tensor generation:  0.00641632080078125
mini_batch_src_global generation:  0.02194666862487793
r_  generation:  0.21868181228637695
----------------------check_connections_block total spend ----------------------------- 0.6033763885498047
generate_one_block  0.2462303638458252
generate_one_block  0.24742937088012695
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03423142433166504
gen group dst list time:  0.007689952850341797
time for parepare:  0.019719362258911133
local_output_nid generation:  0.017830848693847656
local_in_edges_tensor generation:  0.031365156173706055
mini_batch_src_global generation:  0.054949283599853516
r_  generation:  0.5763101577758789
local_output_nid generation:  0.027106523513793945
local_in_edges_tensor generation:  0.03179478645324707
mini_batch_src_global generation:  0.07212424278259277
r_  generation:  0.6089293956756592
----------------------check_connections_block total spend ----------------------------- 1.6921393871307373
generate_one_block  0.7577238082885742
generate_one_block  0.7739152908325195
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.034284114837646484
gen group dst list time:  0.01282501220703125
time for parepare:  0.01866292953491211
local_output_nid generation:  0.022434473037719727
local_in_edges_tensor generation:  0.04565072059631348
mini_batch_src_global generation:  0.06447100639343262
r_  generation:  0.5821959972381592
local_output_nid generation:  0.03776121139526367
local_in_edges_tensor generation:  0.042757511138916016
mini_batch_src_global generation:  0.06777286529541016
r_  generation:  0.5833332538604736
----------------------check_connections_block total spend ----------------------------- 1.7282650470733643
generate_one_block  0.7268891334533691
generate_one_block  0.7367262840270996
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17527103424072266  GigaBytes
Max Memory Allocated: 1.6078824996948242  GigaBytes

connection checking time:  3.4204044342041016
block generation total time  2.9952545166015625
average batch blocks generation time:  1.4976272583007812
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12226533889770508  GigaBytes
Max Memory Allocated: 1.6078824996948242  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3363146781921387  GigaBytes
Max Memory Allocated: 1.6078824996948242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12225484848022461  GigaBytes
Max Memory Allocated: 1.6078824996948242  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.336648941040039  GigaBytes
Max Memory Allocated: 1.6078824996948242  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0899803638458252 |0.02396214008331299 |0.004064798355102539 |0.0005079507827758789 |0.0032515525817871094 |0.001409769058227539 |
----------------------------------------------------------pseudo_mini_loss sum 1.8105547428131104
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 59.06it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.93it/s]100%|██████████| 4/4 [00:00<00:00, 15.39it/s]100%|██████████| 4/4 [00:00<00:00, 15.31it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.34it/s]100%|██████████| 4/4 [00:00<00:00, 17.45it/s]100%|██████████| 4/4 [00:00<00:00, 17.42it/s]
Run 00 | Epoch 00007 | Loss 1.8106 | Train 0.4336 | Val 0.4430 | Test 0.4229
Number of nodes during this epoch:  335599
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17527532577514648  GigaBytes
Max Memory Allocated: 1.6078824996948242  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02931499481201172
range selection method range initialization spend 0.012029170989990234
time for parepare:  0.017714262008666992
local_output_nid generation:  0.010649442672729492
local_in_edges_tensor generation:  0.010380268096923828
mini_batch_src_global generation:  0.020370006561279297
r_  generation:  0.20686054229736328
local_output_nid generation:  0.012053966522216797
local_in_edges_tensor generation:  0.007385730743408203
mini_batch_src_global generation:  0.02306842803955078
r_  generation:  0.22318744659423828
----------------------check_connections_block total spend ----------------------------- 0.6150217056274414
generate_one_block  0.2503166198730469
generate_one_block  0.25144362449645996
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.032928466796875
gen group dst list time:  0.0076792240142822266
time for parepare:  0.019876956939697266
local_output_nid generation:  0.018069744110107422
local_in_edges_tensor generation:  0.03716611862182617
mini_batch_src_global generation:  0.054981231689453125
r_  generation:  0.5962765216827393
local_output_nid generation:  0.027595996856689453
local_in_edges_tensor generation:  0.03501296043395996
mini_batch_src_global generation:  0.07081460952758789
r_  generation:  0.5959112644195557
----------------------check_connections_block total spend ----------------------------- 1.709364652633667
generate_one_block  0.7530481815338135
generate_one_block  0.7602760791778564
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03139543533325195
gen group dst list time:  0.012653589248657227
time for parepare:  0.018999814987182617
local_output_nid generation:  0.021869897842407227
local_in_edges_tensor generation:  0.03485918045043945
mini_batch_src_global generation:  0.05292916297912598
r_  generation:  0.5780613422393799
local_output_nid generation:  0.032213449478149414
local_in_edges_tensor generation:  0.04521608352661133
mini_batch_src_global generation:  0.06702995300292969
r_  generation:  0.5851266384124756
----------------------check_connections_block total spend ----------------------------- 1.6997952461242676
generate_one_block  0.7325398921966553
generate_one_block  0.7454817295074463
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17527532577514648  GigaBytes
Max Memory Allocated: 1.6078824996948242  GigaBytes

connection checking time:  3.4091598987579346
block generation total time  2.9913458824157715
average batch blocks generation time:  1.4956729412078857
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12217378616333008  GigaBytes
Max Memory Allocated: 1.6078824996948242  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3313379287719727  GigaBytes
Max Memory Allocated: 1.6078824996948242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1223454475402832  GigaBytes
Max Memory Allocated: 1.6078824996948242  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3368816375732422  GigaBytes
Max Memory Allocated: 1.6078824996948242  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08137249946594238 |0.021657109260559082 |0.01679408550262451 |0.00048661231994628906 |0.003619551658630371 |0.0019228458404541016 |
----------------------------------------------------------pseudo_mini_loss sum 1.7194346189498901
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 63.66it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.91it/s]100%|██████████| 4/4 [00:00<00:00, 17.39it/s]100%|██████████| 4/4 [00:00<00:00, 17.30it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.06it/s]100%|██████████| 4/4 [00:00<00:00, 22.86it/s]
Run 00 | Epoch 00008 | Loss 1.7194 | Train 0.4327 | Val 0.4772 | Test 0.4716
Number of nodes during this epoch:  335650
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17543745040893555  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02565789222717285
range selection method range initialization spend 0.012008428573608398
time for parepare:  0.018063068389892578
local_output_nid generation:  0.010478734970092773
local_in_edges_tensor generation:  0.014340639114379883
mini_batch_src_global generation:  0.018258333206176758
r_  generation:  0.21819114685058594
local_output_nid generation:  0.012315750122070312
local_in_edges_tensor generation:  0.007353782653808594
mini_batch_src_global generation:  0.022270679473876953
r_  generation:  0.2204723358154297
----------------------check_connections_block total spend ----------------------------- 0.6302986145019531
generate_one_block  0.2502589225769043
generate_one_block  0.24853277206420898
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.040663719177246094
gen group dst list time:  0.007696628570556641
time for parepare:  0.019817590713500977
local_output_nid generation:  0.01880788803100586
local_in_edges_tensor generation:  0.04269981384277344
mini_batch_src_global generation:  0.055983781814575195
r_  generation:  0.5853276252746582
local_output_nid generation:  0.0283355712890625
local_in_edges_tensor generation:  0.042432308197021484
mini_batch_src_global generation:  0.07076621055603027
r_  generation:  0.6026480197906494
----------------------check_connections_block total spend ----------------------------- 1.7208232879638672
generate_one_block  0.7569870948791504
generate_one_block  0.7570757865905762
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.039594411849975586
gen group dst list time:  0.012342691421508789
time for parepare:  0.018900394439697266
local_output_nid generation:  0.022158145904541016
local_in_edges_tensor generation:  0.03300142288208008
mini_batch_src_global generation:  0.05301928520202637
r_  generation:  0.5760900974273682
local_output_nid generation:  0.032671451568603516
local_in_edges_tensor generation:  0.040514230728149414
mini_batch_src_global generation:  0.06752777099609375
r_  generation:  0.5827438831329346
----------------------check_connections_block total spend ----------------------------- 1.6904146671295166
generate_one_block  0.7254481315612793
generate_one_block  0.7336680889129639
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17543745040893555  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

connection checking time:  3.411237955093384
block generation total time  2.9731791019439697
average batch blocks generation time:  1.4865895509719849
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12230062484741211  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3368287086486816  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12222814559936523  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3322057723999023  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0493009090423584 |0.018877387046813965 |0.004131674766540527 |0.0005035400390625 |0.045146822929382324 |0.0015397071838378906 |
----------------------------------------------------------pseudo_mini_loss sum 1.6408792734146118
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 49.09it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.89it/s]100%|██████████| 4/4 [00:00<00:00, 15.30it/s]100%|██████████| 4/4 [00:00<00:00, 15.22it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.29it/s]100%|██████████| 4/4 [00:00<00:00, 17.57it/s]100%|██████████| 4/4 [00:00<00:00, 17.50it/s]
Run 00 | Epoch 00009 | Loss 1.6409 | Train 0.4362 | Val 0.5123 | Test 0.5256
Number of nodes during this epoch:  335765
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17540931701660156  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022058725357055664
range selection method range initialization spend 0.012022972106933594
time for parepare:  0.019954204559326172
local_output_nid generation:  0.010915279388427734
local_in_edges_tensor generation:  0.00938558578491211
mini_batch_src_global generation:  0.01729297637939453
r_  generation:  0.2063448429107666
local_output_nid generation:  0.011949539184570312
local_in_edges_tensor generation:  0.006609201431274414
mini_batch_src_global generation:  0.022229909896850586
r_  generation:  0.219085693359375
----------------------check_connections_block total spend ----------------------------- 0.6065070629119873
generate_one_block  0.24706578254699707
generate_one_block  0.2462925910949707
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03237485885620117
gen group dst list time:  0.0077555179595947266
time for parepare:  0.019738435745239258
local_output_nid generation:  0.018157958984375
local_in_edges_tensor generation:  0.03330683708190918
mini_batch_src_global generation:  0.05460715293884277
r_  generation:  0.5847492218017578
local_output_nid generation:  0.027165651321411133
local_in_edges_tensor generation:  0.03521847724914551
mini_batch_src_global generation:  0.06853485107421875
r_  generation:  0.5943026542663574
----------------------check_connections_block total spend ----------------------------- 1.6877784729003906
generate_one_block  0.750901460647583
generate_one_block  0.7538325786590576
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.032164812088012695
gen group dst list time:  0.012410163879394531
time for parepare:  0.018917322158813477
local_output_nid generation:  0.02262568473815918
local_in_edges_tensor generation:  0.0332944393157959
mini_batch_src_global generation:  0.05360054969787598
r_  generation:  0.5802657604217529
local_output_nid generation:  0.03221273422241211
local_in_edges_tensor generation:  0.03772568702697754
mini_batch_src_global generation:  0.06783032417297363
r_  generation:  0.5854203701019287
----------------------check_connections_block total spend ----------------------------- 1.6981804370880127
generate_one_block  0.7315535545349121
generate_one_block  0.734006404876709
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17540931701660156  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

connection checking time:  3.3859589099884033
block generation total time  2.9702939987182617
average batch blocks generation time:  1.4851469993591309
block dataloader generation time/epoch 8.23895812034607
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1223292350769043  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3368749618530273  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12220144271850586  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3323345184326172  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08645689487457275 |0.01954782009124756 |0.0039490461349487305 |0.0005022287368774414 |0.0026227235794067383 |0.0012972354888916016 |
----------------------------------------------------------pseudo_mini_loss sum 1.6018061637878418
Total (block generation + training)time/epoch 8.586843967437744
Training time/epoch 0.3477957248687744
Training time without block to device /epoch 0.3087000846862793
Training time without total dataloading part /epoch 0.015445232391357422
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 67.24it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.04it/s]100%|██████████| 4/4 [00:00<00:00, 15.27it/s]100%|██████████| 4/4 [00:00<00:00, 15.22it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.24it/s]100%|██████████| 4/4 [00:00<00:00, 17.38it/s]100%|██████████| 4/4 [00:00<00:00, 17.34it/s]
Run 00 | Epoch 00010 | Loss 1.6018 | Train 0.4378 | Val 0.5256 | Test 0.5436
Number of nodes during this epoch:  335695
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1753368377685547  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02410602569580078
range selection method range initialization spend 0.011879205703735352
time for parepare:  0.017772436141967773
local_output_nid generation:  0.010737419128417969
local_in_edges_tensor generation:  0.010049104690551758
mini_batch_src_global generation:  0.017332077026367188
r_  generation:  0.21148324012756348
local_output_nid generation:  0.01192021369934082
local_in_edges_tensor generation:  0.0072574615478515625
mini_batch_src_global generation:  0.022011280059814453
r_  generation:  0.22138261795043945
----------------------check_connections_block total spend ----------------------------- 0.6132056713104248
generate_one_block  0.2498917579650879
generate_one_block  0.24735760688781738
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.037116289138793945
gen group dst list time:  0.007680416107177734
time for parepare:  0.019956588745117188
local_output_nid generation:  0.018184900283813477
local_in_edges_tensor generation:  0.04095745086669922
mini_batch_src_global generation:  0.0562283992767334
r_  generation:  0.5900478363037109
local_output_nid generation:  0.027945756912231445
local_in_edges_tensor generation:  0.03091740608215332
mini_batch_src_global generation:  0.06868362426757812
r_  generation:  0.5967352390289307
----------------------check_connections_block total spend ----------------------------- 1.7028090953826904
generate_one_block  0.7727611064910889
generate_one_block  0.7721033096313477
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03285646438598633
gen group dst list time:  0.014216184616088867
time for parepare:  0.018918275833129883
local_output_nid generation:  0.02203655242919922
local_in_edges_tensor generation:  0.038633108139038086
mini_batch_src_global generation:  0.0561830997467041
r_  generation:  0.5798852443695068
local_output_nid generation:  0.03288888931274414
local_in_edges_tensor generation:  0.04392051696777344
mini_batch_src_global generation:  0.06762242317199707
r_  generation:  0.5885965824127197
----------------------check_connections_block total spend ----------------------------- 1.712458610534668
generate_one_block  0.7303102016448975
generate_one_block  0.7447874546051025
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1753368377685547  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

connection checking time:  3.4152677059173584
block generation total time  3.0199620723724365
average batch blocks generation time:  1.5099810361862183
block dataloader generation time/epoch 8.28872013092041
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12232255935668945  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3366293907165527  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12220430374145508  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.336381435394287  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08259725570678711 |0.019143223762512207 |0.004056572914123535 |0.0005043745040893555 |0.00298154354095459 |0.0016756057739257812 |
----------------------------------------------------------pseudo_mini_loss sum 1.554060697555542
Total (block generation + training)time/epoch 8.630345344543457
Training time/epoch 0.3352077007293701
Training time without block to device /epoch 0.2969212532043457
Training time without total dataloading part /epoch 0.016760587692260742
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 48.29it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.02it/s]100%|██████████| 4/4 [00:00<00:00, 15.33it/s]100%|██████████| 4/4 [00:00<00:00, 15.26it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.41it/s]100%|██████████| 4/4 [00:00<00:00, 17.28it/s]100%|██████████| 4/4 [00:00<00:00, 17.28it/s]
Run 00 | Epoch 00011 | Loss 1.5541 | Train 0.4373 | Val 0.5191 | Test 0.5295
Number of nodes during this epoch:  335643
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17529821395874023  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022669076919555664
range selection method range initialization spend 0.01216435432434082
time for parepare:  0.01827239990234375
local_output_nid generation:  0.010468006134033203
local_in_edges_tensor generation:  0.009192228317260742
mini_batch_src_global generation:  0.01723766326904297
r_  generation:  0.20535755157470703
local_output_nid generation:  0.011915922164916992
local_in_edges_tensor generation:  0.007310152053833008
mini_batch_src_global generation:  0.022205114364624023
r_  generation:  0.22327899932861328
----------------------check_connections_block total spend ----------------------------- 0.6084849834442139
generate_one_block  0.24760818481445312
generate_one_block  0.2517404556274414
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03221845626831055
gen group dst list time:  0.007729291915893555
time for parepare:  0.019668102264404297
local_output_nid generation:  0.017951011657714844
local_in_edges_tensor generation:  0.03141379356384277
mini_batch_src_global generation:  0.05841517448425293
r_  generation:  0.5924806594848633
local_output_nid generation:  0.027620315551757812
local_in_edges_tensor generation:  0.035391807556152344
mini_batch_src_global generation:  0.06761598587036133
r_  generation:  0.60935378074646
----------------------check_connections_block total spend ----------------------------- 1.711737871170044
generate_one_block  0.7569630146026611
generate_one_block  0.7528736591339111
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029644250869750977
gen group dst list time:  0.012409210205078125
time for parepare:  0.01884627342224121
local_output_nid generation:  0.021831274032592773
local_in_edges_tensor generation:  0.033490657806396484
mini_batch_src_global generation:  0.05252480506896973
r_  generation:  0.5800826549530029
local_output_nid generation:  0.032331228256225586
local_in_edges_tensor generation:  0.03281688690185547
mini_batch_src_global generation:  0.06768441200256348
r_  generation:  0.588493824005127
----------------------check_connections_block total spend ----------------------------- 1.6921648979187012
generate_one_block  0.7287263870239258
generate_one_block  0.7296938896179199
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17529821395874023  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

connection checking time:  3.403902769088745
block generation total time  2.968256950378418
average batch blocks generation time:  1.484128475189209
block dataloader generation time/epoch 8.280662218729654
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12227773666381836  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3366641998291016  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12224721908569336  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3364648818969727  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08861112594604492 |0.01865077018737793 |0.004016757011413574 |0.0005067586898803711 |0.0026770830154418945 |0.0016837120056152344 |
----------------------------------------------------------pseudo_mini_loss sum 1.5184962749481201
Total (block generation + training)time/epoch 8.62389357884725
Training time/epoch 0.34634876251220703
Training time without block to device /epoch 0.30904722213745117
Training time without total dataloading part /epoch 0.016084909439086914
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 64.55it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.94it/s]100%|██████████| 4/4 [00:00<00:00, 15.32it/s]100%|██████████| 4/4 [00:00<00:00, 15.24it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.44it/s]100%|██████████| 4/4 [00:00<00:00, 17.52it/s]100%|██████████| 4/4 [00:00<00:00, 17.48it/s]
Run 00 | Epoch 00012 | Loss 1.5185 | Train 0.4330 | Val 0.5090 | Test 0.5111
Number of nodes during this epoch:  335693
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17536640167236328  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020371198654174805
range selection method range initialization spend 0.011684656143188477
time for parepare:  0.01786661148071289
local_output_nid generation:  0.010633468627929688
local_in_edges_tensor generation:  0.009307146072387695
mini_batch_src_global generation:  0.017114877700805664
r_  generation:  0.20689749717712402
local_output_nid generation:  0.011617183685302734
local_in_edges_tensor generation:  0.006627321243286133
mini_batch_src_global generation:  0.02196645736694336
r_  generation:  0.22191190719604492
----------------------check_connections_block total spend ----------------------------- 0.6068744659423828
generate_one_block  0.24838566780090332
generate_one_block  0.2481832504272461
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03239583969116211
gen group dst list time:  0.007727146148681641
time for parepare:  0.01990675926208496
local_output_nid generation:  0.01811075210571289
local_in_edges_tensor generation:  0.031011104583740234
mini_batch_src_global generation:  0.05435061454772949
r_  generation:  0.5798540115356445
local_output_nid generation:  0.027113914489746094
local_in_edges_tensor generation:  0.030269861221313477
mini_batch_src_global generation:  0.06732439994812012
r_  generation:  0.59049391746521
----------------------check_connections_block total spend ----------------------------- 1.6704750061035156
generate_one_block  0.756554365158081
generate_one_block  0.7825644016265869
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028847694396972656
gen group dst list time:  0.012464046478271484
time for parepare:  0.019007205963134766
local_output_nid generation:  0.022324323654174805
local_in_edges_tensor generation:  0.03309297561645508
mini_batch_src_global generation:  0.05279088020324707
r_  generation:  0.5799908638000488
local_output_nid generation:  0.03241324424743652
local_in_edges_tensor generation:  0.03365063667297363
mini_batch_src_global generation:  0.06751894950866699
r_  generation:  0.5860059261322021
----------------------check_connections_block total spend ----------------------------- 1.6911323070526123
generate_one_block  0.743596076965332
generate_one_block  0.7410275936126709
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17536640167236328  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

connection checking time:  3.361607313156128
block generation total time  3.023742437362671
average batch blocks generation time:  1.5118712186813354
block dataloader generation time/epoch 8.275135695934296
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12225770950317383  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.336484432220459  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12226629257202148  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3365998268127441  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0874481201171875 |0.023565292358398438 |0.0038698911666870117 |0.0004990100860595703 |0.002585291862487793 |0.0028464794158935547 |
----------------------------------------------------------pseudo_mini_loss sum 1.492614507675171
Total (block generation + training)time/epoch 8.619129002094269
Training time/epoch 0.34619879722595215
Training time without block to device /epoch 0.2990682125091553
Training time without total dataloading part /epoch 0.016754865646362305
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 64.50it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.93it/s]100%|██████████| 4/4 [00:00<00:00, 15.32it/s]100%|██████████| 4/4 [00:00<00:00, 15.25it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.11it/s]100%|██████████| 4/4 [00:00<00:00, 17.58it/s]100%|██████████| 4/4 [00:00<00:00, 17.49it/s]
Run 00 | Epoch 00013 | Loss 1.4926 | Train 0.4273 | Val 0.5112 | Test 0.5114
Number of nodes during this epoch:  335632
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17533493041992188  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024896860122680664
range selection method range initialization spend 0.011885643005371094
time for parepare:  0.018400907516479492
local_output_nid generation:  0.010730266571044922
local_in_edges_tensor generation:  0.009974956512451172
mini_batch_src_global generation:  0.01703667640686035
r_  generation:  0.21134209632873535
local_output_nid generation:  0.01204371452331543
local_in_edges_tensor generation:  0.007388591766357422
mini_batch_src_global generation:  0.02222728729248047
r_  generation:  0.22990942001342773
----------------------check_connections_block total spend ----------------------------- 0.623204231262207
generate_one_block  0.2508232593536377
generate_one_block  0.24968290328979492
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03697657585144043
gen group dst list time:  0.007654905319213867
time for parepare:  0.02003788948059082
local_output_nid generation:  0.01785874366760254
local_in_edges_tensor generation:  0.04607510566711426
mini_batch_src_global generation:  0.055767059326171875
r_  generation:  0.5843636989593506
local_output_nid generation:  0.028651952743530273
local_in_edges_tensor generation:  0.043900251388549805
mini_batch_src_global generation:  0.06802225112915039
r_  generation:  0.6035745143890381
----------------------check_connections_block total spend ----------------------------- 1.7298424243927002
generate_one_block  0.7489268779754639
generate_one_block  0.7645189762115479
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03114485740661621
gen group dst list time:  0.0144805908203125
time for parepare:  0.019225358963012695
local_output_nid generation:  0.022313356399536133
local_in_edges_tensor generation:  0.052813053131103516
mini_batch_src_global generation:  0.05353975296020508
r_  generation:  0.5808796882629395
local_output_nid generation:  0.03435254096984863
local_in_edges_tensor generation:  0.036428213119506836
mini_batch_src_global generation:  0.06767845153808594
r_  generation:  0.5904967784881592
----------------------check_connections_block total spend ----------------------------- 1.7235321998596191
generate_one_block  0.7272875308990479
generate_one_block  0.7362897396087646
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17533493041992188  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

connection checking time:  3.4533746242523193
block generation total time  2.977023124694824
average batch blocks generation time:  1.488511562347412
block dataloader generation time/epoch 8.288642406463623
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12225675582885742  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3366446495056152  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12226343154907227  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3317112922668457  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08491396903991699 |0.019047021865844727 |0.004133820533752441 |0.0005067586898803711 |0.003170490264892578 |0.0013513565063476562 |
----------------------------------------------------------pseudo_mini_loss sum 1.4572741985321045
Total (block generation + training)time/epoch 8.633308744430542
Training time/epoch 0.347226619720459
Training time without block to device /epoch 0.30913257598876953
Training time without total dataloading part /epoch 0.016973495483398438
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 57.57it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.08it/s]100%|██████████| 4/4 [00:00<00:00, 18.85it/s]100%|██████████| 4/4 [00:00<00:00, 18.71it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.60it/s]100%|██████████| 4/4 [00:00<00:00, 23.32it/s]
Run 00 | Epoch 00014 | Loss 1.4573 | Train 0.4182 | Val 0.5207 | Test 0.5258
Number of nodes during this epoch:  335667
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17547941207885742  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023880958557128906
range selection method range initialization spend 0.011683225631713867
time for parepare:  0.019377470016479492
local_output_nid generation:  0.010858535766601562
local_in_edges_tensor generation:  0.009191513061523438
mini_batch_src_global generation:  0.017067670822143555
r_  generation:  0.20511078834533691
local_output_nid generation:  0.011898994445800781
local_in_edges_tensor generation:  0.006880521774291992
mini_batch_src_global generation:  0.022167205810546875
r_  generation:  0.22331857681274414
----------------------check_connections_block total spend ----------------------------- 0.6094551086425781
generate_one_block  0.2499558925628662
generate_one_block  0.24862241744995117
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03481793403625488
gen group dst list time:  0.0076711177825927734
time for parepare:  0.019817352294921875
local_output_nid generation:  0.01779651641845703
local_in_edges_tensor generation:  0.030712127685546875
mini_batch_src_global generation:  0.05644059181213379
r_  generation:  0.5905790328979492
local_output_nid generation:  0.02714395523071289
local_in_edges_tensor generation:  0.030618667602539062
mini_batch_src_global generation:  0.06759524345397949
r_  generation:  0.5974147319793701
----------------------check_connections_block total spend ----------------------------- 1.6886298656463623
generate_one_block  0.7460224628448486
generate_one_block  0.7479605674743652
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029330015182495117
gen group dst list time:  0.01249384880065918
time for parepare:  0.018890857696533203
local_output_nid generation:  0.02217555046081543
local_in_edges_tensor generation:  0.03255271911621094
mini_batch_src_global generation:  0.05266547203063965
r_  generation:  0.5836069583892822
local_output_nid generation:  0.033124685287475586
local_in_edges_tensor generation:  0.033118486404418945
mini_batch_src_global generation:  0.06749391555786133
r_  generation:  0.5877115726470947
----------------------check_connections_block total spend ----------------------------- 1.6948437690734863
generate_one_block  0.7320156097412109
generate_one_block  0.7337567806243896
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17547941207885742  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

connection checking time:  3.3834736347198486
block generation total time  2.9597554206848145
average batch blocks generation time:  1.4798777103424072
block dataloader generation time/epoch 8.280235966046652
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12224435806274414  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3364019393920898  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12229299545288086  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3367276191711426  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08186817169189453 |0.018478989601135254 |0.0038601160049438477 |0.0005023479461669922 |0.0025107860565185547 |0.0015823841094970703 |
----------------------------------------------------------pseudo_mini_loss sum 1.4270212650299072
Total (block generation + training)time/epoch 8.623263279596964
Training time/epoch 0.334749698638916
Training time without block to device /epoch 0.2977917194366455
Training time without total dataloading part /epoch 0.01532888412475586
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 65.03it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.24it/s]100%|██████████| 4/4 [00:00<00:00, 15.41it/s]100%|██████████| 4/4 [00:00<00:00, 15.37it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.42it/s]100%|██████████| 4/4 [00:00<00:00, 17.39it/s]100%|██████████| 4/4 [00:00<00:00, 17.38it/s]
Run 00 | Epoch 00015 | Loss 1.4270 | Train 0.4078 | Val 0.5290 | Test 0.5453
Number of nodes during this epoch:  335679
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17534112930297852  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021976470947265625
range selection method range initialization spend 0.011789083480834961
time for parepare:  0.01765298843383789
local_output_nid generation:  0.01074981689453125
local_in_edges_tensor generation:  0.009104013442993164
mini_batch_src_global generation:  0.017239093780517578
r_  generation:  0.2066035270690918
local_output_nid generation:  0.011990785598754883
local_in_edges_tensor generation:  0.006583213806152344
mini_batch_src_global generation:  0.02170109748840332
r_  generation:  0.2240309715270996
----------------------check_connections_block total spend ----------------------------- 0.6090795993804932
generate_one_block  0.25148820877075195
generate_one_block  0.24989771842956543
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03295445442199707
gen group dst list time:  0.007659196853637695
time for parepare:  0.019967079162597656
local_output_nid generation:  0.01913928985595703
local_in_edges_tensor generation:  0.0309598445892334
mini_batch_src_global generation:  0.05513191223144531
r_  generation:  0.5892338752746582
local_output_nid generation:  0.029285907745361328
local_in_edges_tensor generation:  0.02966022491455078
mini_batch_src_global generation:  0.06788778305053711
r_  generation:  0.6002850532531738
----------------------check_connections_block total spend ----------------------------- 1.6944239139556885
generate_one_block  0.7588956356048584
generate_one_block  0.7511715888977051
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029429197311401367
gen group dst list time:  0.012441158294677734
time for parepare:  0.019154071807861328
local_output_nid generation:  0.022847414016723633
local_in_edges_tensor generation:  0.03385639190673828
mini_batch_src_global generation:  0.05252695083618164
r_  generation:  0.5854120254516602
local_output_nid generation:  0.03293299674987793
local_in_edges_tensor generation:  0.032460689544677734
mini_batch_src_global generation:  0.0683443546295166
r_  generation:  0.5919370651245117
----------------------check_connections_block total spend ----------------------------- 1.7044179439544678
generate_one_block  0.7317278385162354
generate_one_block  0.7424850463867188
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17534112930297852  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

connection checking time:  3.3988418579101562
block generation total time  2.9842801094055176
average batch blocks generation time:  1.4921400547027588
block dataloader generation time/epoch 8.279725176947457
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1222529411315918  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.336461067199707  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12226724624633789  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.336564064025879  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08777570724487305 |0.03067636489868164 |0.0037974119186401367 |0.0004825592041015625 |0.003363966941833496 |0.0015850067138671875 |
----------------------------------------------------------pseudo_mini_loss sum 1.3920316696166992
Total (block generation + training)time/epoch 8.625944784709386
Training time/epoch 0.36528849601745605
Training time without block to device /epoch 0.3039357662200928
Training time without total dataloading part /epoch 0.016872882843017578
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 58.56it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.27it/s]100%|██████████| 4/4 [00:00<00:00, 15.58it/s]100%|██████████| 4/4 [00:00<00:00, 15.52it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.17it/s]100%|██████████| 4/4 [00:00<00:00, 17.65it/s]100%|██████████| 4/4 [00:00<00:00, 17.56it/s]
Run 00 | Epoch 00016 | Loss 1.3920 | Train 0.3917 | Val 0.5237 | Test 0.5513
Number of nodes during this epoch:  335668
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17538022994995117  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023439407348632812
range selection method range initialization spend 0.011859893798828125
time for parepare:  0.017359495162963867
local_output_nid generation:  0.010674238204956055
local_in_edges_tensor generation:  0.012670040130615234
mini_batch_src_global generation:  0.017379283905029297
r_  generation:  0.20749473571777344
local_output_nid generation:  0.012092113494873047
local_in_edges_tensor generation:  0.007292747497558594
mini_batch_src_global generation:  0.0223081111907959
r_  generation:  0.2231433391571045
----------------------check_connections_block total spend ----------------------------- 0.613335132598877
generate_one_block  0.24562954902648926
generate_one_block  0.25111865997314453
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03637290000915527
gen group dst list time:  0.007453203201293945
time for parepare:  0.02013421058654785
local_output_nid generation:  0.018497943878173828
local_in_edges_tensor generation:  0.033409833908081055
mini_batch_src_global generation:  0.05489301681518555
r_  generation:  0.580796480178833
local_output_nid generation:  0.02780938148498535
local_in_edges_tensor generation:  0.03140711784362793
mini_batch_src_global generation:  0.07122182846069336
r_  generation:  0.5918996334075928
----------------------check_connections_block total spend ----------------------------- 1.68204927444458
generate_one_block  0.7523467540740967
generate_one_block  0.7601003646850586
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029750585556030273
gen group dst list time:  0.012495756149291992
time for parepare:  0.019129037857055664
local_output_nid generation:  0.022805452346801758
local_in_edges_tensor generation:  0.03524494171142578
mini_batch_src_global generation:  0.05317354202270508
r_  generation:  0.5773158073425293
local_output_nid generation:  0.03306913375854492
local_in_edges_tensor generation:  0.05085110664367676
mini_batch_src_global generation:  0.06890034675598145
r_  generation:  0.5953688621520996
----------------------check_connections_block total spend ----------------------------- 1.7201452255249023
generate_one_block  0.7310268878936768
generate_one_block  0.7487154006958008
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17538022994995117  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

connection checking time:  3.4021944999694824
block generation total time  2.992189407348633
average batch blocks generation time:  1.4960947036743164
block dataloader generation time/epoch 8.284128189086914
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12224912643432617  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3364949226379395  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12227296829223633  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3366179466247559  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08947610855102539 |0.018935084342956543 |0.004016995429992676 |0.0005028247833251953 |0.0030208826065063477 |0.0018248558044433594 |
----------------------------------------------------------pseudo_mini_loss sum 1.3709640502929688
Total (block generation + training)time/epoch 8.631444990634918
Training time/epoch 0.35489630699157715
Training time without block to device /epoch 0.31702613830566406
Training time without total dataloading part /epoch 0.016906261444091797
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 60.82it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.93it/s]100%|██████████| 4/4 [00:00<00:00, 15.26it/s]100%|██████████| 4/4 [00:00<00:00, 15.20it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.34it/s]100%|██████████| 4/4 [00:00<00:00, 17.58it/s]100%|██████████| 4/4 [00:00<00:00, 17.52it/s]
Run 00 | Epoch 00017 | Loss 1.3710 | Train 0.3717 | Val 0.5007 | Test 0.5375
Number of nodes during this epoch:  335630
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17534494400024414  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022790908813476562
range selection method range initialization spend 0.011748313903808594
time for parepare:  0.017613649368286133
local_output_nid generation:  0.010640621185302734
local_in_edges_tensor generation:  0.009353399276733398
mini_batch_src_global generation:  0.01818108558654785
r_  generation:  0.21131420135498047
local_output_nid generation:  0.011801004409790039
local_in_edges_tensor generation:  0.006612300872802734
mini_batch_src_global generation:  0.02193450927734375
r_  generation:  0.22598958015441895
----------------------check_connections_block total spend ----------------------------- 0.6183381080627441
generate_one_block  0.253643274307251
generate_one_block  0.254716157913208
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03835606575012207
gen group dst list time:  0.007476329803466797
time for parepare:  0.020906925201416016
local_output_nid generation:  0.019611597061157227
local_in_edges_tensor generation:  0.04450178146362305
mini_batch_src_global generation:  0.05536198616027832
r_  generation:  0.6110472679138184
local_output_nid generation:  0.03344082832336426
local_in_edges_tensor generation:  0.0469975471496582
mini_batch_src_global generation:  0.0679025650024414
r_  generation:  0.5978035926818848
----------------------check_connections_block total spend ----------------------------- 1.7584972381591797
generate_one_block  0.7522530555725098
generate_one_block  0.7539136409759521
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03206896781921387
gen group dst list time:  0.012458086013793945
time for parepare:  0.01876997947692871
local_output_nid generation:  0.022602319717407227
local_in_edges_tensor generation:  0.04545736312866211
mini_batch_src_global generation:  0.05331826210021973
r_  generation:  0.6034073829650879
local_output_nid generation:  0.0332331657409668
local_in_edges_tensor generation:  0.0399167537689209
mini_batch_src_global generation:  0.06991314888000488
r_  generation:  0.610938310623169
----------------------check_connections_block total spend ----------------------------- 1.777048110961914
generate_one_block  0.7620115280151367
generate_one_block  0.7345602512359619
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17534494400024414  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

connection checking time:  3.5355453491210938
block generation total time  3.0027384757995605
average batch blocks generation time:  1.5013692378997803
block dataloader generation time/epoch 8.302850935194227
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12229299545288086  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3366279602050781  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12224626541137695  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.336616039276123  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08514392375946045 |0.03022181987762451 |0.004035234451293945 |0.0005159378051757812 |0.004010558128356934 |0.0015981197357177734 |
----------------------------------------------------------pseudo_mini_loss sum 1.3564302921295166
Total (block generation + training)time/epoch 8.651521444320679
Training time/epoch 0.35934948921203613
Training time without block to device /epoch 0.2989058494567871
Training time without total dataloading part /epoch 0.018721580505371094
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 46.76it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.88it/s]100%|██████████| 4/4 [00:00<00:00, 15.36it/s]100%|██████████| 4/4 [00:00<00:00, 15.27it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.82it/s]100%|██████████| 4/4 [00:00<00:00, 17.68it/s]100%|██████████| 4/4 [00:00<00:00, 17.68it/s]
Run 00 | Epoch 00018 | Loss 1.3564 | Train 0.3574 | Val 0.4806 | Test 0.5210
Number of nodes during this epoch:  335785
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17528724670410156  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023999691009521484
range selection method range initialization spend 0.011811256408691406
time for parepare:  0.01726508140563965
local_output_nid generation:  0.010434627532958984
local_in_edges_tensor generation:  0.011204719543457031
mini_batch_src_global generation:  0.018030405044555664
r_  generation:  0.20879888534545898
local_output_nid generation:  0.011930465698242188
local_in_edges_tensor generation:  0.006819009780883789
mini_batch_src_global generation:  0.022425174713134766
r_  generation:  0.22714805603027344
----------------------check_connections_block total spend ----------------------------- 0.6172738075256348
generate_one_block  0.2577080726623535
generate_one_block  0.2513415813446045
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.039202213287353516
gen group dst list time:  0.007322788238525391
time for parepare:  0.019995450973510742
local_output_nid generation:  0.018381834030151367
local_in_edges_tensor generation:  0.03973031044006348
mini_batch_src_global generation:  0.056662559509277344
r_  generation:  0.5956742763519287
local_output_nid generation:  0.030498266220092773
local_in_edges_tensor generation:  0.03260231018066406
mini_batch_src_global generation:  0.06759023666381836
r_  generation:  0.6096560955047607
----------------------check_connections_block total spend ----------------------------- 1.7315969467163086
generate_one_block  0.7760472297668457
generate_one_block  0.7846782207489014
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03023672103881836
gen group dst list time:  0.014117002487182617
time for parepare:  0.019441843032836914
local_output_nid generation:  0.023239850997924805
local_in_edges_tensor generation:  0.04347991943359375
mini_batch_src_global generation:  0.05285048484802246
r_  generation:  0.5833661556243896
local_output_nid generation:  0.032462358474731445
local_in_edges_tensor generation:  0.042549848556518555
mini_batch_src_global generation:  0.06762313842773438
r_  generation:  0.5838921070098877
----------------------check_connections_block total spend ----------------------------- 1.710843801498413
generate_one_block  0.749791145324707
generate_one_block  0.7560906410217285
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17528724670410156  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

connection checking time:  3.4424407482147217
block generation total time  3.0666072368621826
average batch blocks generation time:  1.5333036184310913
block dataloader generation time/epoch 8.317722368240357
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12220430374145508  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3316950798034668  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12230920791625977  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.336693286895752  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08991444110870361 |0.0241163969039917 |0.004125475883483887 |0.0005019903182983398 |0.003925681114196777 |0.003058910369873047 |
----------------------------------------------------------pseudo_mini_loss sum 1.3406729698181152
Total (block generation + training)time/epoch 8.668502640724181
Training time/epoch 0.36961984634399414
Training time without block to device /epoch 0.32138705253601074
Training time without total dataloading part /epoch 0.020165205001831055
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 49.85it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.76it/s]100%|██████████| 4/4 [00:00<00:00, 15.26it/s]100%|██████████| 4/4 [00:00<00:00, 15.17it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.61it/s]100%|██████████| 4/4 [00:00<00:00, 17.71it/s]100%|██████████| 4/4 [00:00<00:00, 17.68it/s]
Run 00 | Epoch 00019 | Loss 1.3407 | Train 0.3530 | Val 0.4760 | Test 0.5168
Number of nodes during this epoch:  335699
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1754131317138672  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028113126754760742
range selection method range initialization spend 0.011871099472045898
time for parepare:  0.017292261123657227
local_output_nid generation:  0.010659456253051758
local_in_edges_tensor generation:  0.01127171516418457
mini_batch_src_global generation:  0.016933917999267578
r_  generation:  0.20558810234069824
local_output_nid generation:  0.012092828750610352
local_in_edges_tensor generation:  0.0073125362396240234
mini_batch_src_global generation:  0.022205591201782227
r_  generation:  0.22371268272399902
----------------------check_connections_block total spend ----------------------------- 0.6098220348358154
generate_one_block  0.2503387928009033
generate_one_block  0.24976277351379395
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0424191951751709
gen group dst list time:  0.007197380065917969
time for parepare:  0.019956111907958984
local_output_nid generation:  0.01889967918395996
local_in_edges_tensor generation:  0.03929305076599121
mini_batch_src_global generation:  0.05634593963623047
r_  generation:  0.5933957099914551
local_output_nid generation:  0.0293576717376709
local_in_edges_tensor generation:  0.03858017921447754
mini_batch_src_global generation:  0.07028365135192871
r_  generation:  0.600121021270752
----------------------check_connections_block total spend ----------------------------- 1.7205736637115479
generate_one_block  0.7704718112945557
generate_one_block  0.7751092910766602
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03020930290222168
gen group dst list time:  0.01468348503112793
time for parepare:  0.018979549407958984
local_output_nid generation:  0.023136138916015625
local_in_edges_tensor generation:  0.051358699798583984
mini_batch_src_global generation:  0.05367231369018555
r_  generation:  0.5829968452453613
local_output_nid generation:  0.0351564884185791
local_in_edges_tensor generation:  0.04102659225463867
mini_batch_src_global generation:  0.06760430335998535
r_  generation:  0.5895061492919922
----------------------check_connections_block total spend ----------------------------- 1.72890043258667
generate_one_block  0.7322115898132324
generate_one_block  0.7624461650848389
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1754131317138672  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

connection checking time:  3.4494740962982178
block generation total time  3.040238857269287
average batch blocks generation time:  1.5201194286346436
block dataloader generation time/epoch 8.329839944839478
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1222681999206543  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3366665840148926  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12226629257202148  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3325366973876953  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08787453174591064 |0.029569625854492188 |0.0041980743408203125 |0.0005146265029907227 |0.0033414363861083984 |0.002925395965576172 |
----------------------------------------------------------pseudo_mini_loss sum 1.332936406135559
Total (block generation + training)time/epoch 8.682173317128962
Training time/epoch 0.3677229881286621
Training time without block to device /epoch 0.30858373641967773
Training time without total dataloading part /epoch 0.01903367042541504
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 50.78it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.86it/s]100%|██████████| 4/4 [00:00<00:00, 14.87it/s]100%|██████████| 4/4 [00:00<00:00, 14.86it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.52it/s]100%|██████████| 4/4 [00:00<00:00, 17.52it/s]100%|██████████| 4/4 [00:00<00:00, 17.50it/s]
Run 00 | Epoch 00020 | Loss 1.3329 | Train 0.3564 | Val 0.4830 | Test 0.5201
Number of nodes during this epoch:  335694
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17543983459472656  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026108741760253906
range selection method range initialization spend 0.011834383010864258
time for parepare:  0.017512798309326172
local_output_nid generation:  0.010843753814697266
local_in_edges_tensor generation:  0.012038707733154297
mini_batch_src_global generation:  0.01742386817932129
r_  generation:  0.21467852592468262
local_output_nid generation:  0.012239456176757812
local_in_edges_tensor generation:  0.008649826049804688
mini_batch_src_global generation:  0.0248870849609375
r_  generation:  0.22368597984313965
----------------------check_connections_block total spend ----------------------------- 0.624861478805542
generate_one_block  0.256497859954834
generate_one_block  0.2507176399230957
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.036397695541381836
gen group dst list time:  0.007186174392700195
time for parepare:  0.020668745040893555
local_output_nid generation:  0.01812744140625
local_in_edges_tensor generation:  0.03829026222229004
mini_batch_src_global generation:  0.05551028251647949
r_  generation:  0.5898230075836182
local_output_nid generation:  0.030556440353393555
local_in_edges_tensor generation:  0.04222226142883301
mini_batch_src_global generation:  0.07066702842712402
r_  generation:  0.6109654903411865
----------------------check_connections_block total spend ----------------------------- 1.7350025177001953
generate_one_block  0.8012402057647705
generate_one_block  0.7732753753662109
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030237913131713867
gen group dst list time:  0.014456033706665039
time for parepare:  0.01914501190185547
local_output_nid generation:  0.022866487503051758
local_in_edges_tensor generation:  0.05234336853027344
mini_batch_src_global generation:  0.05354499816894531
r_  generation:  0.578770637512207
local_output_nid generation:  0.034759521484375
local_in_edges_tensor generation:  0.04088163375854492
mini_batch_src_global generation:  0.06811189651489258
r_  generation:  0.5950219631195068
----------------------check_connections_block total spend ----------------------------- 1.7318453788757324
generate_one_block  0.7405591011047363
generate_one_block  0.7695469856262207
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17543983459472656  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

connection checking time:  3.4668478965759277
block generation total time  3.0846216678619385
average batch blocks generation time:  1.5423108339309692
block dataloader generation time/epoch 8.345439871152243
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12230348587036133  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3367867469787598  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12222719192504883  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3363299369812012  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08382511138916016 |0.02403402328491211 |0.0042459964752197266 |0.0005283355712890625 |0.003847360610961914 |0.0014615058898925781 |
----------------------------------------------------------pseudo_mini_loss sum 1.307072639465332
Total (block generation + training)time/epoch 8.696764369805654
Training time/epoch 0.34008288383483887
Training time without block to device /epoch 0.29201483726501465
Training time without total dataloading part /epoch 0.018704891204833984
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 53.04it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.43it/s]100%|██████████| 4/4 [00:00<00:00, 15.03it/s]100%|██████████| 4/4 [00:00<00:00, 14.93it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.35it/s]100%|██████████| 4/4 [00:00<00:00, 17.53it/s]100%|██████████| 4/4 [00:00<00:00, 17.48it/s]
Run 00 | Epoch 00021 | Loss 1.3071 | Train 0.3615 | Val 0.4896 | Test 0.5234
Number of nodes during this epoch:  335662
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17538213729858398  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02789759635925293
range selection method range initialization spend 0.011867523193359375
time for parepare:  0.0171658992767334
local_output_nid generation:  0.010858535766601562
local_in_edges_tensor generation:  0.009966373443603516
mini_batch_src_global generation:  0.017980337142944336
r_  generation:  0.20931696891784668
local_output_nid generation:  0.011953115463256836
local_in_edges_tensor generation:  0.006360530853271484
mini_batch_src_global generation:  0.021835803985595703
r_  generation:  0.22395563125610352
----------------------check_connections_block total spend ----------------------------- 0.6127381324768066
generate_one_block  0.2459428310394287
generate_one_block  0.2467944622039795
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.038864850997924805
gen group dst list time:  0.007208824157714844
time for parepare:  0.02278304100036621
local_output_nid generation:  0.018807172775268555
local_in_edges_tensor generation:  0.038820505142211914
mini_batch_src_global generation:  0.05541658401489258
r_  generation:  0.5851385593414307
local_output_nid generation:  0.027982711791992188
local_in_edges_tensor generation:  0.03757834434509277
mini_batch_src_global generation:  0.06779003143310547
r_  generation:  0.6221318244934082
----------------------check_connections_block total spend ----------------------------- 1.7318310737609863
generate_one_block  0.7489559650421143
generate_one_block  0.7533280849456787
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03182792663574219
gen group dst list time:  0.01315927505493164
time for parepare:  0.018828868865966797
local_output_nid generation:  0.022904634475708008
local_in_edges_tensor generation:  0.03753304481506348
mini_batch_src_global generation:  0.05231523513793945
r_  generation:  0.5769484043121338
local_output_nid generation:  0.0322723388671875
local_in_edges_tensor generation:  0.03497004508972168
mini_batch_src_global generation:  0.06775355339050293
r_  generation:  0.5816409587860107
----------------------check_connections_block total spend ----------------------------- 1.6860551834106445
generate_one_block  0.7307600975036621
generate_one_block  0.7464654445648193
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17538213729858398  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

connection checking time:  3.417886257171631
block generation total time  2.9795095920562744
average batch blocks generation time:  1.4897547960281372
block dataloader generation time/epoch 8.346309130008404
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12228155136108398  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3367953300476074  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12224721908569336  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3363804817199707  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05134844779968262 |0.019080281257629395 |0.0041768550872802734 |0.0005165338516235352 |0.04452693462371826 |0.0018208026885986328 |
----------------------------------------------------------pseudo_mini_loss sum 1.2960293292999268
Total (block generation + training)time/epoch 8.697698409740742
Training time/epoch 0.3520231246948242
Training time without block to device /epoch 0.31386256217956543
Training time without total dataloading part /epoch 0.10026144981384277
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 52.40it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.93it/s]100%|██████████| 4/4 [00:00<00:00, 15.20it/s]100%|██████████| 4/4 [00:00<00:00, 15.14it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.15it/s]100%|██████████| 4/4 [00:00<00:00, 17.53it/s]100%|██████████| 4/4 [00:00<00:00, 17.46it/s]
Run 00 | Epoch 00022 | Loss 1.2960 | Train 0.3678 | Val 0.4942 | Test 0.5255
Number of nodes during this epoch:  335667
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17541933059692383  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022042274475097656
range selection method range initialization spend 0.011688232421875
time for parepare:  0.01695990562438965
local_output_nid generation:  0.010673999786376953
local_in_edges_tensor generation:  0.00944828987121582
mini_batch_src_global generation:  0.017915010452270508
r_  generation:  0.20943760871887207
local_output_nid generation:  0.011804342269897461
local_in_edges_tensor generation:  0.006679534912109375
mini_batch_src_global generation:  0.025818586349487305
r_  generation:  0.22558212280273438
----------------------check_connections_block total spend ----------------------------- 0.6201076507568359
generate_one_block  0.24630522727966309
generate_one_block  0.2475285530090332
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03424787521362305
gen group dst list time:  0.007121086120605469
time for parepare:  0.01984262466430664
local_output_nid generation:  0.01834726333618164
local_in_edges_tensor generation:  0.032663583755493164
mini_batch_src_global generation:  0.057364702224731445
r_  generation:  0.5820894241333008
local_output_nid generation:  0.027555465698242188
local_in_edges_tensor generation:  0.030462026596069336
mini_batch_src_global generation:  0.06768512725830078
r_  generation:  0.5966620445251465
----------------------check_connections_block total spend ----------------------------- 1.6861248016357422
generate_one_block  0.7599191665649414
generate_one_block  0.7526438236236572
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02887248992919922
gen group dst list time:  0.012409210205078125
time for parepare:  0.018604278564453125
local_output_nid generation:  0.022618532180786133
local_in_edges_tensor generation:  0.03962421417236328
mini_batch_src_global generation:  0.052686452865600586
r_  generation:  0.5770528316497803
local_output_nid generation:  0.03298330307006836
local_in_edges_tensor generation:  0.03748345375061035
mini_batch_src_global generation:  0.07377243041992188
r_  generation:  0.5973923206329346
----------------------check_connections_block total spend ----------------------------- 1.7190277576446533
generate_one_block  0.7367987632751465
generate_one_block  0.7405979633331299
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17541933059692383  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

connection checking time:  3.4051525592803955
block generation total time  2.989959716796875
average batch blocks generation time:  1.4949798583984375
block dataloader generation time/epoch 8.343745112419128
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1222681999206543  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.336634635925293  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12226152420043945  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3364605903625488  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08219015598297119 |0.02060079574584961 |0.0039026737213134766 |0.0004925727844238281 |0.003638744354248047 |0.0020678043365478516 |
----------------------------------------------------------pseudo_mini_loss sum 1.279818058013916
Total (block generation + training)time/epoch 8.694279943193708
Training time/epoch 0.33934664726257324
Training time without block to device /epoch 0.298145055770874
Training time without total dataloading part /epoch 0.018135786056518555
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 47.97it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 12.53it/s]100%|██████████| 4/4 [00:00<00:00, 13.53it/s]100%|██████████| 4/4 [00:00<00:00, 13.36it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.11it/s]100%|██████████| 4/4 [00:00<00:00, 17.00it/s]100%|██████████| 4/4 [00:00<00:00, 16.99it/s]
Run 00 | Epoch 00023 | Loss 1.2798 | Train 0.3750 | Val 0.4977 | Test 0.5277
Number of nodes during this epoch:  335720
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17542171478271484  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024538516998291016
range selection method range initialization spend 0.01195526123046875
time for parepare:  0.01735210418701172
local_output_nid generation:  0.010793924331665039
local_in_edges_tensor generation:  0.01342916488647461
mini_batch_src_global generation:  0.017393827438354492
r_  generation:  0.20662784576416016
local_output_nid generation:  0.01166677474975586
local_in_edges_tensor generation:  0.008156776428222656
mini_batch_src_global generation:  0.023144960403442383
r_  generation:  0.22171640396118164
----------------------check_connections_block total spend ----------------------------- 0.6139383316040039
generate_one_block  0.24962520599365234
generate_one_block  0.2505767345428467
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03568410873413086
gen group dst list time:  0.007030963897705078
time for parepare:  0.019933700561523438
local_output_nid generation:  0.018702983856201172
local_in_edges_tensor generation:  0.039101362228393555
mini_batch_src_global generation:  0.05638694763183594
r_  generation:  0.5880184173583984
local_output_nid generation:  0.027971506118774414
local_in_edges_tensor generation:  0.033812761306762695
mini_batch_src_global generation:  0.0701603889465332
r_  generation:  0.6015806198120117
----------------------check_connections_block total spend ----------------------------- 1.710827112197876
generate_one_block  0.765636682510376
generate_one_block  0.7988791465759277
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03232431411743164
gen group dst list time:  0.014758825302124023
time for parepare:  0.01826763153076172
local_output_nid generation:  0.023326635360717773
local_in_edges_tensor generation:  0.04891395568847656
mini_batch_src_global generation:  0.05331897735595703
r_  generation:  0.5804741382598877
local_output_nid generation:  0.032691001892089844
local_in_edges_tensor generation:  0.040596961975097656
mini_batch_src_global generation:  0.06731104850769043
r_  generation:  0.5873725414276123
----------------------check_connections_block total spend ----------------------------- 1.7183036804199219
generate_one_block  0.7259402275085449
generate_one_block  0.7998788356781006
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17542171478271484  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

connection checking time:  3.429130792617798
block generation total time  3.090334892272949
average batch blocks generation time:  1.5451674461364746
block dataloader generation time/epoch 8.352126264572144
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12225675582885742  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3365755081176758  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12227678298950195  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.336552619934082  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08394896984100342 |0.026329874992370605 |0.004219412803649902 |0.00051116943359375 |0.003362417221069336 |0.001665353775024414 |
----------------------------------------------------------pseudo_mini_loss sum 1.271423578262329
Total (block generation + training)time/epoch 8.703367217381794
Training time/epoch 0.3609809875488281
Training time without block to device /epoch 0.3083212375640869
Training time without total dataloading part /epoch 0.01785135269165039
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 50.19it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 12.84it/s]100%|██████████| 4/4 [00:00<00:00, 13.65it/s]100%|██████████| 4/4 [00:00<00:00, 13.51it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.38it/s]100%|██████████| 4/4 [00:00<00:00, 17.31it/s]100%|██████████| 4/4 [00:00<00:00, 17.30it/s]
Run 00 | Epoch 00024 | Loss 1.2714 | Train 0.3828 | Val 0.5009 | Test 0.5302
Number of nodes during this epoch:  335664
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17542123794555664  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026340723037719727
range selection method range initialization spend 0.012297391891479492
time for parepare:  0.01725912094116211
local_output_nid generation:  0.010937929153442383
local_in_edges_tensor generation:  0.010829925537109375
mini_batch_src_global generation:  0.01768803596496582
r_  generation:  0.20439505577087402
local_output_nid generation:  0.011985301971435547
local_in_edges_tensor generation:  0.007557392120361328
mini_batch_src_global generation:  0.0221560001373291
r_  generation:  0.2227640151977539
----------------------check_connections_block total spend ----------------------------- 0.6093499660491943
generate_one_block  0.24678826332092285
generate_one_block  0.24981975555419922
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03731417655944824
gen group dst list time:  0.0070459842681884766
time for parepare:  0.019983530044555664
local_output_nid generation:  0.018983125686645508
local_in_edges_tensor generation:  0.03321385383605957
mini_batch_src_global generation:  0.05823040008544922
r_  generation:  0.5854058265686035
local_output_nid generation:  0.028019189834594727
local_in_edges_tensor generation:  0.03832077980041504
mini_batch_src_global generation:  0.07112240791320801
r_  generation:  0.6061432361602783
----------------------check_connections_block total spend ----------------------------- 1.715787410736084
generate_one_block  0.767613410949707
generate_one_block  0.800804853439331
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03787851333618164
gen group dst list time:  0.015073537826538086
time for parepare:  0.01828622817993164
local_output_nid generation:  0.022835254669189453
local_in_edges_tensor generation:  0.049704790115356445
mini_batch_src_global generation:  0.05348539352416992
r_  generation:  0.5748875141143799
local_output_nid generation:  0.03210926055908203
local_in_edges_tensor generation:  0.05357837677001953
mini_batch_src_global generation:  0.06834077835083008
r_  generation:  0.587477445602417
----------------------check_connections_block total spend ----------------------------- 1.7261817455291748
generate_one_block  0.7265486717224121
generate_one_block  0.7603504657745361
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17542123794555664  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

connection checking time:  3.441969156265259
block generation total time  3.0553174018859863
average batch blocks generation time:  1.5276587009429932
block dataloader generation time/epoch 8.35838320851326
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12223958969116211  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3364462852478027  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12227678298950195  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3366351127624512  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08393478393554688 |0.0305861234664917 |0.004142284393310547 |0.0005195140838623047 |0.003298640251159668 |0.0016918182373046875 |
----------------------------------------------------------pseudo_mini_loss sum 1.2563178539276123
Total (block generation + training)time/epoch 8.710675343871117
Training time/epoch 0.3679080009460449
Training time without block to device /epoch 0.3067357540130615
Training time without total dataloading part /epoch 0.017612695693969727
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 53.80it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.78it/s]100%|██████████| 4/4 [00:00<00:00, 14.79it/s]100%|██████████| 4/4 [00:00<00:00, 14.77it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.21it/s]100%|██████████| 4/4 [00:00<00:00, 17.28it/s]100%|██████████| 4/4 [00:00<00:00, 17.25it/s]
Run 00 | Epoch 00025 | Loss 1.2563 | Train 0.3909 | Val 0.5052 | Test 0.5329
Number of nodes during this epoch:  335647
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17534303665161133  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027491092681884766
range selection method range initialization spend 0.012059211730957031
time for parepare:  0.017200231552124023
local_output_nid generation:  0.010662317276000977
local_in_edges_tensor generation:  0.013456344604492188
mini_batch_src_global generation:  0.018507719039916992
r_  generation:  0.20797085762023926
local_output_nid generation:  0.011720657348632812
local_in_edges_tensor generation:  0.007051944732666016
mini_batch_src_global generation:  0.02217721939086914
r_  generation:  0.2200162410736084
----------------------check_connections_block total spend ----------------------------- 0.6115379333496094
generate_one_block  0.24863052368164062
generate_one_block  0.24608516693115234
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03681588172912598
gen group dst list time:  0.007202625274658203
time for parepare:  0.020038127899169922
local_output_nid generation:  0.01858043670654297
local_in_edges_tensor generation:  0.036920785903930664
mini_batch_src_global generation:  0.05806326866149902
r_  generation:  0.5838415622711182
local_output_nid generation:  0.027469158172607422
local_in_edges_tensor generation:  0.04047894477844238
mini_batch_src_global generation:  0.06786322593688965
r_  generation:  0.6069016456604004
----------------------check_connections_block total spend ----------------------------- 1.7129449844360352
generate_one_block  0.7774436473846436
generate_one_block  0.7550265789031982
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02817249298095703
gen group dst list time:  0.01250600814819336
time for parepare:  0.01880645751953125
local_output_nid generation:  0.022103309631347656
local_in_edges_tensor generation:  0.033476829528808594
mini_batch_src_global generation:  0.0527498722076416
r_  generation:  0.5887060165405273
local_output_nid generation:  0.03475069999694824
local_in_edges_tensor generation:  0.04779195785522461
mini_batch_src_global generation:  0.06714105606079102
r_  generation:  0.6074116230010986
----------------------check_connections_block total spend ----------------------------- 1.7505064010620117
generate_one_block  0.7454166412353516
generate_one_block  0.7382440567016602
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17534303665161133  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

connection checking time:  3.463451385498047
block generation total time  3.0161309242248535
average batch blocks generation time:  1.5080654621124268
block dataloader generation time/epoch 8.362280677346622
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1223301887512207  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3367996215820312  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12219476699829102  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.336301326751709  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08822000026702881 |0.030899763107299805 |0.004027605056762695 |0.0005013942718505859 |0.003612995147705078 |0.0016019344329833984 |
----------------------------------------------------------pseudo_mini_loss sum 1.241349697113037
Total (block generation + training)time/epoch 8.715624753166647
Training time/epoch 0.37003016471862793
Training time without block to device /epoch 0.3082306385040283
Training time without total dataloading part /epoch 0.017885923385620117
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 51.60it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.86it/s]100%|██████████| 4/4 [00:00<00:00, 15.06it/s]100%|██████████| 4/4 [00:00<00:00, 15.02it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.46it/s]100%|██████████| 4/4 [00:00<00:00, 17.61it/s]100%|██████████| 4/4 [00:00<00:00, 17.57it/s]
Run 00 | Epoch 00026 | Loss 1.2413 | Train 0.3979 | Val 0.5066 | Test 0.5333
Number of nodes during this epoch:  335651
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17531347274780273  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022106409072875977
range selection method range initialization spend 0.011764287948608398
time for parepare:  0.017019271850585938
local_output_nid generation:  0.010617256164550781
local_in_edges_tensor generation:  0.010080814361572266
mini_batch_src_global generation:  0.017841577529907227
r_  generation:  0.2077169418334961
local_output_nid generation:  0.01200246810913086
local_in_edges_tensor generation:  0.006603717803955078
mini_batch_src_global generation:  0.02194523811340332
r_  generation:  0.22421026229858398
----------------------check_connections_block total spend ----------------------------- 0.6138522624969482
generate_one_block  0.25496935844421387
generate_one_block  0.2527921199798584
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04393410682678223
gen group dst list time:  0.007113933563232422
time for parepare:  0.019945621490478516
local_output_nid generation:  0.01865863800048828
local_in_edges_tensor generation:  0.03896522521972656
mini_batch_src_global generation:  0.05558347702026367
r_  generation:  0.5875363349914551
local_output_nid generation:  0.027608156204223633
local_in_edges_tensor generation:  0.031003236770629883
mini_batch_src_global generation:  0.06898641586303711
r_  generation:  0.6007781028747559
----------------------check_connections_block total spend ----------------------------- 1.7023499011993408
generate_one_block  0.7681970596313477
generate_one_block  0.7819278240203857
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03497600555419922
gen group dst list time:  0.014351844787597656
time for parepare:  0.018436670303344727
local_output_nid generation:  0.022295475006103516
local_in_edges_tensor generation:  0.044403791427612305
mini_batch_src_global generation:  0.053397417068481445
r_  generation:  0.5783848762512207
local_output_nid generation:  0.032068490982055664
local_in_edges_tensor generation:  0.040390968322753906
mini_batch_src_global generation:  0.06703925132751465
r_  generation:  0.586132287979126
----------------------check_connections_block total spend ----------------------------- 1.707108974456787
generate_one_block  0.7259559631347656
generate_one_block  0.7400264739990234
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17531347274780273  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

connection checking time:  3.409458875656128
block generation total time  3.0161073207855225
average batch blocks generation time:  1.5080536603927612
block dataloader generation time/epoch 8.363375319374931
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12223482131958008  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3364124298095703  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12228536605834961  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3366389274597168  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08532357215881348 |0.021110177040100098 |0.004220724105834961 |0.0005151033401489258 |0.00317227840423584 |0.0031960010528564453 |
----------------------------------------------------------pseudo_mini_loss sum 1.2311758995056152
Total (block generation + training)time/epoch 8.716278950373331
Training time/epoch 0.34526705741882324
Training time without block to device /epoch 0.30304670333862305
Training time without total dataloading part /epoch 0.0190122127532959
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 50.09it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.86it/s]100%|██████████| 4/4 [00:00<00:00, 15.33it/s]100%|██████████| 4/4 [00:00<00:00, 15.24it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.07it/s]100%|██████████| 4/4 [00:00<00:00, 17.64it/s]100%|██████████| 4/4 [00:00<00:00, 17.53it/s]
Run 00 | Epoch 00027 | Loss 1.2312 | Train 0.4053 | Val 0.5083 | Test 0.5321
Number of nodes during this epoch:  335675
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17538738250732422  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02563619613647461
range selection method range initialization spend 0.01186060905456543
time for parepare:  0.016945838928222656
local_output_nid generation:  0.010653018951416016
local_in_edges_tensor generation:  0.01044464111328125
mini_batch_src_global generation:  0.0180814266204834
r_  generation:  0.2079765796661377
local_output_nid generation:  0.011801481246948242
local_in_edges_tensor generation:  0.0073359012603759766
mini_batch_src_global generation:  0.021923065185546875
r_  generation:  0.22265219688415527
----------------------check_connections_block total spend ----------------------------- 0.611536979675293
generate_one_block  0.2505910396575928
generate_one_block  0.25313639640808105
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.034363746643066406
gen group dst list time:  0.007157325744628906
time for parepare:  0.019915342330932617
local_output_nid generation:  0.017945289611816406
local_in_edges_tensor generation:  0.03248929977416992
mini_batch_src_global generation:  0.054906606674194336
r_  generation:  0.5973248481750488
local_output_nid generation:  0.02753734588623047
local_in_edges_tensor generation:  0.048569440841674805
mini_batch_src_global generation:  0.07303214073181152
r_  generation:  0.6223375797271729
----------------------check_connections_block total spend ----------------------------- 1.7588403224945068
generate_one_block  0.7598202228546143
generate_one_block  0.7550139427185059
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030155658721923828
gen group dst list time:  0.013227462768554688
time for parepare:  0.018548250198364258
local_output_nid generation:  0.022687673568725586
local_in_edges_tensor generation:  0.0443882942199707
mini_batch_src_global generation:  0.05662703514099121
r_  generation:  0.5764729976654053
local_output_nid generation:  0.032762765884399414
local_in_edges_tensor generation:  0.03700137138366699
mini_batch_src_global generation:  0.06734323501586914
r_  generation:  0.58840012550354
----------------------check_connections_block total spend ----------------------------- 1.7100348472595215
generate_one_block  0.7594552040100098
generate_one_block  0.7458493709564209
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17538738250732422  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

connection checking time:  3.4688751697540283
block generation total time  3.020138740539551
average batch blocks generation time:  1.5100693702697754
block dataloader generation time/epoch 8.366046654550653
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12230539321899414  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3368549346923828  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12223291397094727  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3363227844238281  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04275071620941162 |0.021627306938171387 |0.00417017936706543 |0.0005130767822265625 |0.04495680332183838 |0.0016829967498779297 |
----------------------------------------------------------pseudo_mini_loss sum 1.2227904796600342
Total (block generation + training)time/epoch 8.718706808592144
Training time/epoch 0.34813499450683594
Training time without block to device /epoch 0.30488038063049316
Training time without total dataloading part /epoch 0.10096311569213867
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 55.14it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.77it/s]100%|██████████| 4/4 [00:00<00:00, 15.24it/s]100%|██████████| 4/4 [00:00<00:00, 15.15it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.27it/s]100%|██████████| 4/4 [00:00<00:00, 17.60it/s]100%|██████████| 4/4 [00:00<00:00, 17.53it/s]
Run 00 | Epoch 00028 | Loss 1.2228 | Train 0.4086 | Val 0.5083 | Test 0.5291
Number of nodes during this epoch:  335676
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17540264129638672  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022218942642211914
range selection method range initialization spend 0.01160883903503418
time for parepare:  0.017016887664794922
local_output_nid generation:  0.010762691497802734
local_in_edges_tensor generation:  0.011387348175048828
mini_batch_src_global generation:  0.017106056213378906
r_  generation:  0.20684409141540527
local_output_nid generation:  0.011852741241455078
local_in_edges_tensor generation:  0.00736689567565918
mini_batch_src_global generation:  0.022203922271728516
r_  generation:  0.2231426239013672
----------------------check_connections_block total spend ----------------------------- 0.6113300323486328
generate_one_block  0.2504434585571289
generate_one_block  0.24651479721069336
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04343557357788086
gen group dst list time:  0.007163047790527344
time for parepare:  0.023169755935668945
local_output_nid generation:  0.017781734466552734
local_in_edges_tensor generation:  0.03648233413696289
mini_batch_src_global generation:  0.0572965145111084
r_  generation:  0.5831327438354492
local_output_nid generation:  0.027370929718017578
local_in_edges_tensor generation:  0.04404163360595703
mini_batch_src_global generation:  0.06784367561340332
r_  generation:  0.6176309585571289
----------------------check_connections_block total spend ----------------------------- 1.7355530261993408
generate_one_block  0.7586808204650879
generate_one_block  0.7540104389190674
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.033979177474975586
gen group dst list time:  0.013190269470214844
time for parepare:  0.018580913543701172
local_output_nid generation:  0.022939205169677734
local_in_edges_tensor generation:  0.04110431671142578
mini_batch_src_global generation:  0.05520892143249512
r_  generation:  0.5734210014343262
local_output_nid generation:  0.03207564353942871
local_in_edges_tensor generation:  0.037691354751586914
mini_batch_src_global generation:  0.06743741035461426
r_  generation:  0.580866813659668
----------------------check_connections_block total spend ----------------------------- 1.6910841464996338
generate_one_block  0.7300286293029785
generate_one_block  0.7492268085479736
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17540264129638672  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

connection checking time:  3.4266371726989746
block generation total time  2.9919466972351074
average batch blocks generation time:  1.4959733486175537
block dataloader generation time/epoch 8.364670300483704
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12227964401245117  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3367505073547363  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12224340438842773  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3363938331604004  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.049752116203308105 |0.02158224582672119 |0.004171133041381836 |0.000517725944519043 |0.04391133785247803 |0.0030350685119628906 |
----------------------------------------------------------pseudo_mini_loss sum 1.2119877338409424
Total (block generation + training)time/epoch 8.717265927791596
Training time/epoch 0.35121917724609375
Training time without block to device /epoch 0.30805468559265137
Training time without total dataloading part /epoch 0.1002354621887207
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 52.90it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.89it/s]100%|██████████| 4/4 [00:00<00:00, 15.30it/s]100%|██████████| 4/4 [00:00<00:00, 15.22it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.28it/s]100%|██████████| 4/4 [00:00<00:00, 17.44it/s]100%|██████████| 4/4 [00:00<00:00, 17.40it/s]
Run 00 | Epoch 00029 | Loss 1.2120 | Train 0.4089 | Val 0.5069 | Test 0.5264
Number of nodes during this epoch:  335729
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17538166046142578  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022748231887817383
range selection method range initialization spend 0.011691570281982422
time for parepare:  0.017027616500854492
local_output_nid generation:  0.010620355606079102
local_in_edges_tensor generation:  0.00991511344909668
mini_batch_src_global generation:  0.01809406280517578
r_  generation:  0.20729422569274902
local_output_nid generation:  0.011634111404418945
local_in_edges_tensor generation:  0.006522178649902344
mini_batch_src_global generation:  0.022237300872802734
r_  generation:  0.21958303451538086
----------------------check_connections_block total spend ----------------------------- 0.6074116230010986
generate_one_block  0.2462770938873291
generate_one_block  0.24508452415466309
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03468179702758789
gen group dst list time:  0.007295846939086914
time for parepare:  0.020565509796142578
local_output_nid generation:  0.01858067512512207
local_in_edges_tensor generation:  0.03372049331665039
mini_batch_src_global generation:  0.054628610610961914
r_  generation:  0.5851037502288818
local_output_nid generation:  0.028568506240844727
local_in_edges_tensor generation:  0.03804636001586914
mini_batch_src_global generation:  0.07030129432678223
r_  generation:  0.6029720306396484
----------------------check_connections_block total spend ----------------------------- 1.7076263427734375
generate_one_block  0.7907860279083252
generate_one_block  0.7571139335632324
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.033663034439086914
gen group dst list time:  0.014171600341796875
time for parepare:  0.018062353134155273
local_output_nid generation:  0.022711515426635742
local_in_edges_tensor generation:  0.045133113861083984
mini_batch_src_global generation:  0.05754446983337402
r_  generation:  0.5734436511993408
local_output_nid generation:  0.03302764892578125
local_in_edges_tensor generation:  0.04160332679748535
mini_batch_src_global generation:  0.06649303436279297
r_  generation:  0.5820116996765137
----------------------check_connections_block total spend ----------------------------- 1.7018530368804932
generate_one_block  0.7233810424804688
generate_one_block  0.733583927154541
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17538166046142578  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

connection checking time:  3.4094793796539307
block generation total time  3.0048649311065674
average batch blocks generation time:  1.5024324655532837
block dataloader generation time/epoch 8.362842798233032
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12227773666381836  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3365955352783203  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1222386360168457  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3364863395690918  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08360636234283447 |0.023615360260009766 |0.00413668155670166 |0.0005186796188354492 |0.0028085708618164062 |0.0014095306396484375 |
----------------------------------------------------------pseudo_mini_loss sum 1.1991121768951416
Total (block generation + training)time/epoch 8.715027831849598
Training time/epoch 0.34381723403930664
Training time without block to device /epoch 0.2965865135192871
Training time without total dataloading part /epoch 0.01633739471435547
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 52.54it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.95it/s]100%|██████████| 4/4 [00:00<00:00, 15.45it/s]100%|██████████| 4/4 [00:00<00:00, 15.35it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.78it/s]100%|██████████| 4/4 [00:00<00:00, 18.06it/s]100%|██████████| 4/4 [00:00<00:00, 18.00it/s]
Run 00 | Epoch 00030 | Loss 1.1991 | Train 0.4090 | Val 0.5066 | Test 0.5213
Number of nodes during this epoch:  335664
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17532634735107422  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022578954696655273
range selection method range initialization spend 0.011561393737792969
time for parepare:  0.016887426376342773
local_output_nid generation:  0.01064443588256836
local_in_edges_tensor generation:  0.009820699691772461
mini_batch_src_global generation:  0.017402172088623047
r_  generation:  0.20812296867370605
local_output_nid generation:  0.01180267333984375
local_in_edges_tensor generation:  0.006422758102416992
mini_batch_src_global generation:  0.022075653076171875
r_  generation:  0.22393369674682617
----------------------check_connections_block total spend ----------------------------- 0.6106972694396973
generate_one_block  0.25221824645996094
generate_one_block  0.25242114067077637
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.031476736068725586
gen group dst list time:  0.0070345401763916016
time for parepare:  0.02008223533630371
local_output_nid generation:  0.018352985382080078
local_in_edges_tensor generation:  0.03313589096069336
mini_batch_src_global generation:  0.057530879974365234
r_  generation:  0.5820600986480713
local_output_nid generation:  0.02753305435180664
local_in_edges_tensor generation:  0.03707623481750488
mini_batch_src_global generation:  0.06747221946716309
r_  generation:  0.5932140350341797
----------------------check_connections_block total spend ----------------------------- 1.6913087368011475
generate_one_block  0.7533049583435059
generate_one_block  0.7566299438476562
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030460834503173828
gen group dst list time:  0.012360095977783203
time for parepare:  0.019063949584960938
local_output_nid generation:  0.022220849990844727
local_in_edges_tensor generation:  0.04006385803222656
mini_batch_src_global generation:  0.0533452033996582
r_  generation:  0.5799210071563721
local_output_nid generation:  0.034970998764038086
local_in_edges_tensor generation:  0.03429675102233887
mini_batch_src_global generation:  0.06737995147705078
r_  generation:  0.5860567092895508
----------------------check_connections_block total spend ----------------------------- 1.703230857849121
generate_one_block  0.7434895038604736
generate_one_block  0.7524263858795166
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17532634735107422  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

connection checking time:  3.3945395946502686
block generation total time  3.0058507919311523
average batch blocks generation time:  1.5029253959655762
block dataloader generation time/epoch 8.360644654794173
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12230348587036133  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3366246223449707  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12221288681030273  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3364124298095703  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08229577541351318 |0.029801011085510254 |0.0037636756896972656 |0.0004925727844238281 |0.003214240074157715 |0.0014700889587402344 |
----------------------------------------------------------pseudo_mini_loss sum 1.1934722661972046
Total (block generation + training)time/epoch 8.713282942771912
Training time/epoch 0.36207151412963867
Training time without block to device /epoch 0.30246949195861816
Training time without total dataloading part /epoch 0.01641106605529785
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 51.79it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.28it/s]100%|██████████| 4/4 [00:00<00:00, 15.32it/s]100%|██████████| 4/4 [00:00<00:00, 15.30it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.93it/s]100%|██████████| 4/4 [00:00<00:00, 17.98it/s]100%|██████████| 4/4 [00:00<00:00, 17.95it/s]
Run 00 | Epoch 00031 | Loss 1.1935 | Train 0.4085 | Val 0.5059 | Test 0.5168
Number of nodes during this epoch:  335694
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17531394958496094  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020747661590576172
range selection method range initialization spend 0.012168169021606445
time for parepare:  0.017127037048339844
local_output_nid generation:  0.010729551315307617
local_in_edges_tensor generation:  0.011320829391479492
mini_batch_src_global generation:  0.017298221588134766
r_  generation:  0.20737361907958984
local_output_nid generation:  0.01174616813659668
local_in_edges_tensor generation:  0.007253408432006836
mini_batch_src_global generation:  0.02439737319946289
r_  generation:  0.21857833862304688
----------------------check_connections_block total spend ----------------------------- 0.6088709831237793
generate_one_block  0.2568216323852539
generate_one_block  0.2477715015411377
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04876399040222168
gen group dst list time:  0.007001399993896484
time for parepare:  0.02254629135131836
local_output_nid generation:  0.018826961517333984
local_in_edges_tensor generation:  0.03426027297973633
mini_batch_src_global generation:  0.0574798583984375
r_  generation:  0.5792951583862305
local_output_nid generation:  0.027688026428222656
local_in_edges_tensor generation:  0.03592061996459961
mini_batch_src_global generation:  0.06822562217712402
r_  generation:  0.5990288257598877
----------------------check_connections_block total spend ----------------------------- 1.695634365081787
generate_one_block  0.7596075534820557
generate_one_block  0.7565226554870605
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025328636169433594
gen group dst list time:  0.012134552001953125
time for parepare:  0.019961118698120117
local_output_nid generation:  0.023166894912719727
local_in_edges_tensor generation:  0.03393983840942383
mini_batch_src_global generation:  0.052016496658325195
r_  generation:  0.5761933326721191
local_output_nid generation:  0.03261065483093262
local_in_edges_tensor generation:  0.03382158279418945
mini_batch_src_global generation:  0.0666801929473877
r_  generation:  0.5868785381317139
----------------------check_connections_block total spend ----------------------------- 1.689807653427124
generate_one_block  0.7451965808868408
generate_one_block  0.7454366683959961
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17531394958496094  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

connection checking time:  3.385442018508911
block generation total time  3.006763458251953
average batch blocks generation time:  1.5033817291259766
block dataloader generation time/epoch 8.354334655015364
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12231588363647461  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.336686611175537  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12220621109008789  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3364081382751465  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08731663227081299 |0.019594550132751465 |0.004042625427246094 |0.043347835540771484 |0.0033693313598632812 |0.0018954277038574219 |
----------------------------------------------------------pseudo_mini_loss sum 1.1848163604736328
Total (block generation + training)time/epoch 8.70857196268828
Training time/epoch 0.3892672061920166
Training time without block to device /epoch 0.35007810592651367
Training time without total dataloading part /epoch 0.10341501235961914
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 56.10it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.20it/s]100%|██████████| 4/4 [00:00<00:00, 14.47it/s]100%|██████████| 4/4 [00:00<00:00, 14.57it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.98it/s]100%|██████████| 4/4 [00:00<00:00, 16.12it/s]100%|██████████| 4/4 [00:00<00:00, 16.23it/s]
Run 00 | Epoch 00032 | Loss 1.1848 | Train 0.4084 | Val 0.5049 | Test 0.5130
Number of nodes during this epoch:  335672
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17528295516967773  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023157119750976562
range selection method range initialization spend 0.01200413703918457
time for parepare:  0.017670154571533203
local_output_nid generation:  0.010871648788452148
local_in_edges_tensor generation:  0.015254020690917969
mini_batch_src_global generation:  0.017522096633911133
r_  generation:  0.20841479301452637
local_output_nid generation:  0.012061119079589844
local_in_edges_tensor generation:  0.008304357528686523
mini_batch_src_global generation:  0.02202749252319336
r_  generation:  0.2228250503540039
----------------------check_connections_block total spend ----------------------------- 0.6195812225341797
generate_one_block  0.2475605010986328
generate_one_block  0.2462320327758789
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0375218391418457
gen group dst list time:  0.0068280696868896484
time for parepare:  0.019976139068603516
local_output_nid generation:  0.018604516983032227
local_in_edges_tensor generation:  0.04225754737854004
mini_batch_src_global generation:  0.057799339294433594
r_  generation:  0.5860757827758789
local_output_nid generation:  0.02811264991760254
local_in_edges_tensor generation:  0.052291154861450195
mini_batch_src_global generation:  0.0685725212097168
r_  generation:  0.5990016460418701
----------------------check_connections_block total spend ----------------------------- 1.7251734733581543
generate_one_block  0.748755693435669
generate_one_block  0.7578942775726318
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02879023551940918
gen group dst list time:  0.012044429779052734
time for parepare:  0.018489599227905273
local_output_nid generation:  0.022788524627685547
local_in_edges_tensor generation:  0.03622007369995117
mini_batch_src_global generation:  0.05299091339111328
r_  generation:  0.5837240219116211
local_output_nid generation:  0.0325469970703125
local_in_edges_tensor generation:  0.041713714599609375
mini_batch_src_global generation:  0.0688178539276123
r_  generation:  0.5839424133300781
----------------------check_connections_block total spend ----------------------------- 1.7108955383300781
generate_one_block  0.7375690937042236
generate_one_block  0.7351436614990234
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17528295516967773  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

connection checking time:  3.4360690116882324
block generation total time  2.979362726211548
average batch blocks generation time:  1.489681363105774
block dataloader generation time/epoch 8.349943300088247
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12229394912719727  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3366246223449707  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12223100662231445  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3364033699035645  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09016668796539307 |0.018291115760803223 |0.003947257995605469 |0.000510096549987793 |0.002501964569091797 |0.0021963119506835938 |
----------------------------------------------------------pseudo_mini_loss sum 1.1732497215270996
Total (block generation + training)time/epoch 8.703891932964325
Training time/epoch 0.34715700149536133
Training time without block to device /epoch 0.3105747699737549
Training time without total dataloading part /epoch 0.01611495018005371
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 55.10it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.00it/s]100%|██████████| 4/4 [00:00<00:00, 15.40it/s]100%|██████████| 4/4 [00:00<00:00, 15.32it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.73it/s]100%|██████████| 4/4 [00:00<00:00, 17.66it/s]100%|██████████| 4/4 [00:00<00:00, 17.65it/s]
Run 00 | Epoch 00033 | Loss 1.1732 | Train 0.4080 | Val 0.5037 | Test 0.5109
Number of nodes during this epoch:  335664
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17536306381225586  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02036452293395996
range selection method range initialization spend 0.011657476425170898
time for parepare:  0.01869988441467285
local_output_nid generation:  0.010896444320678711
local_in_edges_tensor generation:  0.010309457778930664
mini_batch_src_global generation:  0.017736434936523438
r_  generation:  0.20344781875610352
local_output_nid generation:  0.011757373809814453
local_in_edges_tensor generation:  0.006517887115478516
mini_batch_src_global generation:  0.021947860717773438
r_  generation:  0.22635722160339355
----------------------check_connections_block total spend ----------------------------- 0.611168622970581
generate_one_block  0.24895429611206055
generate_one_block  0.25362348556518555
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03542971611022949
gen group dst list time:  0.006925344467163086
time for parepare:  0.019936800003051758
local_output_nid generation:  0.018373489379882812
local_in_edges_tensor generation:  0.0348358154296875
mini_batch_src_global generation:  0.05696725845336914
r_  generation:  0.5813930034637451
local_output_nid generation:  0.027801513671875
local_in_edges_tensor generation:  0.03503918647766113
mini_batch_src_global generation:  0.06824827194213867
r_  generation:  0.5965368747711182
----------------------check_connections_block total spend ----------------------------- 1.6935250759124756
generate_one_block  0.7539987564086914
generate_one_block  0.7526335716247559
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03287220001220703
gen group dst list time:  0.012317895889282227
time for parepare:  0.018433570861816406
local_output_nid generation:  0.02234625816345215
local_in_edges_tensor generation:  0.03565859794616699
mini_batch_src_global generation:  0.05266833305358887
r_  generation:  0.5804629325866699
local_output_nid generation:  0.03208613395690918
local_in_edges_tensor generation:  0.034732818603515625
mini_batch_src_global generation:  0.0706324577331543
r_  generation:  0.598522424697876
----------------------check_connections_block total spend ----------------------------- 1.7133278846740723
generate_one_block  0.7460856437683105
generate_one_block  0.7471392154693604
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17536306381225586  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

connection checking time:  3.406852960586548
block generation total time  2.999857187271118
average batch blocks generation time:  1.499928593635559
block dataloader generation time/epoch 8.34778920173645
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12219762802124023  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3363361358642578  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12231969833374023  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3366589546203613  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0915536880493164 |0.02767479419708252 |0.004127860069274902 |0.000506281852722168 |0.003892183303833008 |0.002841949462890625 |
----------------------------------------------------------pseudo_mini_loss sum 1.1710186004638672
Total (block generation + training)time/epoch 8.702734870910644
Training time/epoch 0.37879467010498047
Training time without block to device /epoch 0.32344508171081543
Training time without total dataloading part /epoch 0.01989459991455078
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 56.16it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.04it/s]100%|██████████| 4/4 [00:00<00:00, 15.41it/s]100%|██████████| 4/4 [00:00<00:00, 15.34it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.53it/s]100%|██████████| 4/4 [00:00<00:00, 17.70it/s]100%|██████████| 4/4 [00:00<00:00, 17.65it/s]
Run 00 | Epoch 00034 | Loss 1.1710 | Train 0.4072 | Val 0.5022 | Test 0.5096
Number of nodes during this epoch:  335706
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17546796798706055  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020894527435302734
range selection method range initialization spend 0.011851072311401367
time for parepare:  0.017129898071289062
local_output_nid generation:  0.010813236236572266
local_in_edges_tensor generation:  0.013040542602539062
mini_batch_src_global generation:  0.01801776885986328
r_  generation:  0.20705533027648926
local_output_nid generation:  0.011922359466552734
local_in_edges_tensor generation:  0.007554054260253906
mini_batch_src_global generation:  0.022251367568969727
r_  generation:  0.22334575653076172
----------------------check_connections_block total spend ----------------------------- 0.6143267154693604
generate_one_block  0.25129055976867676
generate_one_block  0.24860286712646484
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03654170036315918
gen group dst list time:  0.006933689117431641
time for parepare:  0.019996166229248047
local_output_nid generation:  0.018643617630004883
local_in_edges_tensor generation:  0.04117012023925781
mini_batch_src_global generation:  0.05577802658081055
r_  generation:  0.5869185924530029
local_output_nid generation:  0.02755427360534668
local_in_edges_tensor generation:  0.03117823600769043
mini_batch_src_global generation:  0.07151079177856445
r_  generation:  0.5988514423370361
----------------------check_connections_block total spend ----------------------------- 1.7042412757873535
generate_one_block  0.7606258392333984
generate_one_block  0.762958288192749
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03016376495361328
gen group dst list time:  0.012330055236816406
time for parepare:  0.019509553909301758
local_output_nid generation:  0.023400068283081055
local_in_edges_tensor generation:  0.03664374351501465
mini_batch_src_global generation:  0.052744388580322266
r_  generation:  0.5789000988006592
local_output_nid generation:  0.03290724754333496
local_in_edges_tensor generation:  0.03703141212463379
mini_batch_src_global generation:  0.0674600601196289
r_  generation:  0.5911812782287598
----------------------check_connections_block total spend ----------------------------- 1.7031469345092773
generate_one_block  0.7334990501403809
generate_one_block  0.734915018081665
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17546796798706055  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

connection checking time:  3.407388210296631
block generation total time  2.9919981956481934
average batch blocks generation time:  1.4959990978240967
block dataloader generation time/epoch 8.345606932273277
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12223291397094727  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3364992141723633  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12229013442993164  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3365850448608398  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07942581176757812 |0.018287181854248047 |0.003971576690673828 |0.0005238056182861328 |0.0029751062393188477 |0.0016317367553710938 |
----------------------------------------------------------pseudo_mini_loss sum 1.160334825515747
Total (block generation + training)time/epoch 8.69937539100647
Training time/epoch 0.32424426078796387
Training time without block to device /epoch 0.2876698970794678
Training time without total dataloading part /epoch 0.01657271385192871
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.60it/s]100%|██████████| 4/4 [00:00<00:00, 29.42it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.48it/s]100%|██████████| 4/4 [00:00<00:00, 12.66it/s]100%|██████████| 4/4 [00:00<00:00, 12.46it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.95it/s]100%|██████████| 4/4 [00:00<00:00, 23.36it/s]
Run 00 | Epoch 00035 | Loss 1.1603 | Train 0.4065 | Val 0.5025 | Test 0.5096
Number of nodes during this epoch:  335677
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17540502548217773  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021049976348876953
range selection method range initialization spend 0.011688470840454102
time for parepare:  0.017114877700805664
local_output_nid generation:  0.010837793350219727
local_in_edges_tensor generation:  0.009039640426635742
mini_batch_src_global generation:  0.017403125762939453
r_  generation:  0.20320487022399902
local_output_nid generation:  0.011867761611938477
local_in_edges_tensor generation:  0.006485939025878906
mini_batch_src_global generation:  0.02230215072631836
r_  generation:  0.2254199981689453
----------------------check_connections_block total spend ----------------------------- 0.6075291633605957
generate_one_block  0.24492383003234863
generate_one_block  0.25078654289245605
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.033798933029174805
gen group dst list time:  0.00685572624206543
time for parepare:  0.02014470100402832
local_output_nid generation:  0.018920421600341797
local_in_edges_tensor generation:  0.03016805648803711
mini_batch_src_global generation:  0.05518817901611328
r_  generation:  0.5842030048370361
local_output_nid generation:  0.029090166091918945
local_in_edges_tensor generation:  0.029974699020385742
mini_batch_src_global generation:  0.0705118179321289
r_  generation:  0.599616289138794
----------------------check_connections_block total spend ----------------------------- 1.6962802410125732
generate_one_block  0.7448675632476807
generate_one_block  0.7590157985687256
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03747391700744629
gen group dst list time:  0.012337207794189453
time for parepare:  0.02006077766418457
local_output_nid generation:  0.02312779426574707
local_in_edges_tensor generation:  0.043207645416259766
mini_batch_src_global generation:  0.05715537071228027
r_  generation:  0.585411548614502
local_output_nid generation:  0.032825469970703125
local_in_edges_tensor generation:  0.04314446449279785
mini_batch_src_global generation:  0.06822562217712402
r_  generation:  0.5867581367492676
----------------------check_connections_block total spend ----------------------------- 1.7288134098052979
generate_one_block  0.7412827014923096
generate_one_block  0.748746395111084
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17540502548217773  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

connection checking time:  3.425093650817871
block generation total time  2.9939124584198
average batch blocks generation time:  1.4969562292099
block dataloader generation time/epoch 8.343498706817627
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1221919059753418  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3364648818969727  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12235021591186523  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3368220329284668  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0856705904006958 |0.034018754959106445 |0.0039520263671875 |0.0004954338073730469 |0.003374457359313965 |0.0013458728790283203 |
----------------------------------------------------------pseudo_mini_loss sum 1.1533992290496826
Total (block generation + training)time/epoch 8.697835701483267
Training time/epoch 0.36898112297058105
Training time without block to device /epoch 0.30094361305236816
Training time without total dataloading part /epoch 0.016989707946777344
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 61.09it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.05it/s]100%|██████████| 4/4 [00:00<00:00, 16.55it/s]100%|██████████| 4/4 [00:00<00:00, 16.29it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.59it/s]100%|██████████| 4/4 [00:00<00:00, 18.89it/s]100%|██████████| 4/4 [00:00<00:00, 18.66it/s]
Run 00 | Epoch 00036 | Loss 1.1534 | Train 0.4056 | Val 0.5018 | Test 0.5107
Number of nodes during this epoch:  335727
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17545270919799805  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025570154190063477
range selection method range initialization spend 0.011548042297363281
time for parepare:  0.01812291145324707
local_output_nid generation:  0.010896444320678711
local_in_edges_tensor generation:  0.01062464714050293
mini_batch_src_global generation:  0.017008543014526367
r_  generation:  0.2054595947265625
local_output_nid generation:  0.011971473693847656
local_in_edges_tensor generation:  0.007221221923828125
mini_batch_src_global generation:  0.02183222770690918
r_  generation:  0.21975994110107422
----------------------check_connections_block total spend ----------------------------- 0.6064865589141846
generate_one_block  0.25177597999572754
generate_one_block  0.2461395263671875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03814435005187988
gen group dst list time:  0.006722450256347656
time for parepare:  0.019652366638183594
local_output_nid generation:  0.01855635643005371
local_in_edges_tensor generation:  0.041764259338378906
mini_batch_src_global generation:  0.05566287040710449
r_  generation:  0.5913641452789307
local_output_nid generation:  0.027631759643554688
local_in_edges_tensor generation:  0.04002857208251953
mini_batch_src_global generation:  0.06811404228210449
r_  generation:  0.5996494293212891
----------------------check_connections_block total spend ----------------------------- 1.7156622409820557
generate_one_block  0.7448551654815674
generate_one_block  0.7433891296386719
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.031056880950927734
gen group dst list time:  0.011981010437011719
time for parepare:  0.018323183059692383
local_output_nid generation:  0.022360563278198242
local_in_edges_tensor generation:  0.03613710403442383
mini_batch_src_global generation:  0.052986860275268555
r_  generation:  0.5741925239562988
local_output_nid generation:  0.0324552059173584
local_in_edges_tensor generation:  0.032624006271362305
mini_batch_src_global generation:  0.06815099716186523
r_  generation:  0.5854566097259521
----------------------check_connections_block total spend ----------------------------- 1.6894207000732422
generate_one_block  0.7235689163208008
generate_one_block  0.7251904010772705
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17545270919799805  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

connection checking time:  3.405082941055298
block generation total time  2.9370036125183105
average batch blocks generation time:  1.4685018062591553
block dataloader generation time/epoch 8.339158288070134
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12225675582885742  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3365721702575684  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1222681999206543  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3365988731384277  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08169758319854736 |0.018181324005126953 |0.004026174545288086 |0.0005035400390625 |0.002449631690979004 |0.0020036697387695312 |
----------------------------------------------------------pseudo_mini_loss sum 1.146327257156372
Total (block generation + training)time/epoch 8.6927775485175
Training time/epoch 0.33414530754089355
Training time without block to device /epoch 0.29778265953063965
Training time without total dataloading part /epoch 0.01596236228942871
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 65.05it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.03it/s]100%|██████████| 4/4 [00:00<00:00, 18.71it/s]100%|██████████| 4/4 [00:00<00:00, 18.59it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.85it/s]100%|██████████| 4/4 [00:00<00:00, 23.15it/s]
Run 00 | Epoch 00037 | Loss 1.1463 | Train 0.4060 | Val 0.5018 | Test 0.5117
Number of nodes during this epoch:  335725
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17535734176635742  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021165132522583008
range selection method range initialization spend 0.012169837951660156
time for parepare:  0.017050504684448242
local_output_nid generation:  0.010709285736083984
local_in_edges_tensor generation:  0.009195089340209961
mini_batch_src_global generation:  0.017024993896484375
r_  generation:  0.20656514167785645
local_output_nid generation:  0.01194453239440918
local_in_edges_tensor generation:  0.010676383972167969
mini_batch_src_global generation:  0.02316141128540039
r_  generation:  0.2244114875793457
----------------------check_connections_block total spend ----------------------------- 0.6215214729309082
generate_one_block  0.24608707427978516
generate_one_block  0.25145435333251953
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03319358825683594
gen group dst list time:  0.0067729949951171875
time for parepare:  0.019659996032714844
local_output_nid generation:  0.018642902374267578
local_in_edges_tensor generation:  0.0424199104309082
mini_batch_src_global generation:  0.05679941177368164
r_  generation:  0.5788013935089111
local_output_nid generation:  0.02763962745666504
local_in_edges_tensor generation:  0.029065847396850586
mini_batch_src_global generation:  0.06849026679992676
r_  generation:  0.5939700603485107
----------------------check_connections_block total spend ----------------------------- 1.6937901973724365
generate_one_block  0.7555203437805176
generate_one_block  0.7646284103393555
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030826330184936523
gen group dst list time:  0.012354373931884766
time for parepare:  0.01827263832092285
local_output_nid generation:  0.023131370544433594
local_in_edges_tensor generation:  0.04584908485412598
mini_batch_src_global generation:  0.05630898475646973
r_  generation:  0.5817317962646484
local_output_nid generation:  0.03285551071166992
local_in_edges_tensor generation:  0.03803110122680664
mini_batch_src_global generation:  0.06747174263000488
r_  generation:  0.5905585289001465
----------------------check_connections_block total spend ----------------------------- 1.7324495315551758
generate_one_block  0.7265543937683105
generate_one_block  0.7320811748504639
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17535734176635742  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

connection checking time:  3.4262397289276123
block generation total time  2.9787843227386475
average batch blocks generation time:  1.4893921613693237
block dataloader generation time/epoch 8.337094068527222
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12222146987915039  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3364267349243164  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12229776382446289  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3366851806640625  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08352506160736084 |0.01932823657989502 |0.004040122032165527 |0.0005028247833251953 |0.0037459135055541992 |0.0015125274658203125 |
----------------------------------------------------------pseudo_mini_loss sum 1.1378788948059082
Total (block generation + training)time/epoch 8.690560316217356
Training time/epoch 0.3490445613861084
Training time without block to device /epoch 0.31038808822631836
Training time without total dataloading part /epoch 0.018090248107910156
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 49.67it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.75it/s]100%|██████████| 4/4 [00:00<00:00, 14.91it/s]100%|██████████| 4/4 [00:00<00:00, 14.87it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.23it/s]100%|██████████| 4/4 [00:00<00:00, 17.63it/s]100%|██████████| 4/4 [00:00<00:00, 17.55it/s]
Run 00 | Epoch 00038 | Loss 1.1379 | Train 0.4073 | Val 0.5022 | Test 0.5126
Number of nodes during this epoch:  335658
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17538785934448242  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02117180824279785
range selection method range initialization spend 0.011736154556274414
time for parepare:  0.016858577728271484
local_output_nid generation:  0.010732412338256836
local_in_edges_tensor generation:  0.01260519027709961
mini_batch_src_global generation:  0.016942739486694336
r_  generation:  0.20510149002075195
local_output_nid generation:  0.011727571487426758
local_in_edges_tensor generation:  0.0065538883209228516
mini_batch_src_global generation:  0.021814823150634766
r_  generation:  0.22060704231262207
----------------------check_connections_block total spend ----------------------------- 0.6063299179077148
generate_one_block  0.24883174896240234
generate_one_block  0.2512056827545166
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0338592529296875
gen group dst list time:  0.006780147552490234
time for parepare:  0.019849538803100586
local_output_nid generation:  0.018597841262817383
local_in_edges_tensor generation:  0.04081463813781738
mini_batch_src_global generation:  0.060779571533203125
r_  generation:  0.5883095264434814
local_output_nid generation:  0.02789139747619629
local_in_edges_tensor generation:  0.030767202377319336
mini_batch_src_global generation:  0.06749224662780762
r_  generation:  0.5938186645507812
----------------------check_connections_block total spend ----------------------------- 1.6999492645263672
generate_one_block  0.7442846298217773
generate_one_block  0.7419741153717041
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030950546264648438
gen group dst list time:  0.012032508850097656
time for parepare:  0.018367528915405273
local_output_nid generation:  0.022851943969726562
local_in_edges_tensor generation:  0.0367581844329834
mini_batch_src_global generation:  0.052338361740112305
r_  generation:  0.5830681324005127
local_output_nid generation:  0.03275609016418457
local_in_edges_tensor generation:  0.034226417541503906
mini_batch_src_global generation:  0.0668487548828125
r_  generation:  0.5903639793395996
----------------------check_connections_block total spend ----------------------------- 1.6993203163146973
generate_one_block  0.7204809188842773
generate_one_block  0.7404148578643799
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17538785934448242  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

connection checking time:  3.3992695808410645
block generation total time  2.9471545219421387
average batch blocks generation time:  1.4735772609710693
block dataloader generation time/epoch 8.333430473009745
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12225008010864258  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3364448547363281  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12228155136108398  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.336629867553711  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0805438756942749 |0.018467426300048828 |0.004018306732177734 |0.000529170036315918 |0.0035358667373657227 |0.0012698173522949219 |
----------------------------------------------------------pseudo_mini_loss sum 1.139136791229248
Total (block generation + training)time/epoch 8.686106165250143
Training time/epoch 0.3296535015106201
Training time without block to device /epoch 0.29271864891052246
Training time without total dataloading part /epoch 0.017436504364013672
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 63.48it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.82it/s]100%|██████████| 4/4 [00:00<00:00, 15.33it/s]100%|██████████| 4/4 [00:00<00:00, 15.23it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.43it/s]100%|██████████| 4/4 [00:00<00:00, 17.65it/s]100%|██████████| 4/4 [00:00<00:00, 17.60it/s]
Run 00 | Epoch 00039 | Loss 1.1391 | Train 0.4083 | Val 0.5018 | Test 0.5124
Number of nodes during this epoch:  335652
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17537784576416016  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019393444061279297
range selection method range initialization spend 0.012051105499267578
time for parepare:  0.016983509063720703
local_output_nid generation:  0.01079702377319336
local_in_edges_tensor generation:  0.009594202041625977
mini_batch_src_global generation:  0.016950130462646484
r_  generation:  0.20720171928405762
local_output_nid generation:  0.011767148971557617
local_in_edges_tensor generation:  0.006541728973388672
mini_batch_src_global generation:  0.022383689880371094
r_  generation:  0.2246096134185791
----------------------check_connections_block total spend ----------------------------- 0.6101589202880859
generate_one_block  0.24738025665283203
generate_one_block  0.24920344352722168
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03215956687927246
gen group dst list time:  0.006781816482543945
time for parepare:  0.019945859909057617
local_output_nid generation:  0.018759489059448242
local_in_edges_tensor generation:  0.030584335327148438
mini_batch_src_global generation:  0.054642677307128906
r_  generation:  0.5905337333679199
local_output_nid generation:  0.029783964157104492
local_in_edges_tensor generation:  0.03380465507507324
mini_batch_src_global generation:  0.06943249702453613
r_  generation:  0.6310122013092041
----------------------check_connections_block total spend ----------------------------- 1.7413136959075928
generate_one_block  0.7725937366485596
generate_one_block  0.7570421695709229
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030939817428588867
gen group dst list time:  0.01335000991821289
time for parepare:  0.018358230590820312
local_output_nid generation:  0.02245950698852539
local_in_edges_tensor generation:  0.04814910888671875
mini_batch_src_global generation:  0.0531773567199707
r_  generation:  0.573312520980835
local_output_nid generation:  0.03200840950012207
local_in_edges_tensor generation:  0.04048728942871094
mini_batch_src_global generation:  0.06766724586486816
r_  generation:  0.5834784507751465
----------------------check_connections_block total spend ----------------------------- 1.706192970275879
generate_one_block  0.7389366626739502
generate_one_block  0.7539763450622559
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17537784576416016  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

connection checking time:  3.4475066661834717
block generation total time  3.0225489139556885
average batch blocks generation time:  1.5112744569778442
block dataloader generation time/epoch 8.333568557616204
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12223482131958008  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.336571216583252  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12229394912719727  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.336559772491455  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09196949005126953 |0.022044062614440918 |0.00424802303314209 |0.0005230903625488281 |0.0039893388748168945 |0.0019164085388183594 |
----------------------------------------------------------pseudo_mini_loss sum 1.1300830841064453
Total (block generation + training)time/epoch 8.68673353041372
Training time/epoch 0.3676939010620117
Training time without block to device /epoch 0.3236057758331299
Training time without total dataloading part /epoch 0.019437313079833984
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 51.31it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 13.88it/s]100%|██████████| 4/4 [00:00<00:00, 14.76it/s]100%|██████████| 4/4 [00:00<00:00, 14.61it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.04it/s]100%|██████████| 4/4 [00:00<00:00, 15.63it/s]100%|██████████| 4/4 [00:00<00:00, 15.52it/s]
Run 00 | Epoch 00040 | Loss 1.1301 | Train 0.4086 | Val 0.5010 | Test 0.5112
Number of nodes during this epoch:  335672
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17544031143188477  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021709918975830078
range selection method range initialization spend 0.01196742057800293
time for parepare:  0.01731276512145996
local_output_nid generation:  0.010814428329467773
local_in_edges_tensor generation:  0.011321067810058594
mini_batch_src_global generation:  0.0169527530670166
r_  generation:  0.20812678337097168
local_output_nid generation:  0.012003898620605469
local_in_edges_tensor generation:  0.009119033813476562
mini_batch_src_global generation:  0.0222628116607666
r_  generation:  0.22084736824035645
----------------------check_connections_block total spend ----------------------------- 0.6121697425842285
generate_one_block  0.24663853645324707
generate_one_block  0.24478936195373535
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.034087181091308594
gen group dst list time:  0.006788969039916992
time for parepare:  0.020971059799194336
local_output_nid generation:  0.018716812133789062
local_in_edges_tensor generation:  0.04013848304748535
mini_batch_src_global generation:  0.0551915168762207
r_  generation:  0.5823099613189697
local_output_nid generation:  0.02740168571472168
local_in_edges_tensor generation:  0.04169464111328125
mini_batch_src_global generation:  0.06835627555847168
r_  generation:  0.6026766300201416
----------------------check_connections_block total spend ----------------------------- 1.7136948108673096
generate_one_block  0.7646138668060303
generate_one_block  0.7614214420318604
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03078937530517578
gen group dst list time:  0.012479305267333984
time for parepare:  0.019810199737548828
local_output_nid generation:  0.022800445556640625
local_in_edges_tensor generation:  0.039283037185668945
mini_batch_src_global generation:  0.0524601936340332
r_  generation:  0.6065640449523926
local_output_nid generation:  0.03612208366394043
local_in_edges_tensor generation:  0.05073380470275879
mini_batch_src_global generation:  0.07037878036499023
r_  generation:  0.5872397422790527
----------------------check_connections_block total spend ----------------------------- 1.7528398036956787
generate_one_block  0.7312171459197998
generate_one_block  0.7321686744689941
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17544031143188477  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

connection checking time:  3.4665346145629883
block generation total time  2.9894211292266846
average batch blocks generation time:  1.4947105646133423
block dataloader generation time/epoch 8.335069425404072
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12229394912719727  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3367462158203125  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12221860885620117  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3321151733398438  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08540499210357666 |0.030173778533935547 |0.003995299339294434 |0.0004972219467163086 |0.004031181335449219 |0.0027735233306884766 |
----------------------------------------------------------pseudo_mini_loss sum 1.1235454082489014
Total (block generation + training)time/epoch 8.68854484707117
Training time/epoch 0.3629322052001953
Training time without block to device /epoch 0.3025846481323242
Training time without total dataloading part /epoch 0.0198209285736084
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 55.53it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.53it/s]100%|██████████| 4/4 [00:00<00:00, 14.94it/s]100%|██████████| 4/4 [00:00<00:00, 14.86it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.07it/s]100%|██████████| 4/4 [00:00<00:00, 17.50it/s]100%|██████████| 4/4 [00:00<00:00, 17.41it/s]
Run 00 | Epoch 00041 | Loss 1.1235 | Train 0.4075 | Val 0.4981 | Test 0.5077
Number of nodes during this epoch:  335640
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17539691925048828  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02338862419128418
range selection method range initialization spend 0.011816978454589844
time for parepare:  0.016843795776367188
local_output_nid generation:  0.010930061340332031
local_in_edges_tensor generation:  0.010262012481689453
mini_batch_src_global generation:  0.016659021377563477
r_  generation:  0.20253825187683105
local_output_nid generation:  0.011847257614135742
local_in_edges_tensor generation:  0.007375478744506836
mini_batch_src_global generation:  0.022432804107666016
r_  generation:  0.2225174903869629
----------------------check_connections_block total spend ----------------------------- 0.6049506664276123
generate_one_block  0.24801063537597656
generate_one_block  0.25046586990356445
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03559446334838867
gen group dst list time:  0.006691694259643555
time for parepare:  0.01984262466430664
local_output_nid generation:  0.018715381622314453
local_in_edges_tensor generation:  0.03517413139343262
mini_batch_src_global generation:  0.055196523666381836
r_  generation:  0.5842740535736084
local_output_nid generation:  0.029708385467529297
local_in_edges_tensor generation:  0.039002180099487305
mini_batch_src_global generation:  0.06949973106384277
r_  generation:  0.6120760440826416
----------------------check_connections_block total spend ----------------------------- 1.7199909687042236
generate_one_block  0.7937798500061035
generate_one_block  0.7601604461669922
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0300140380859375
gen group dst list time:  0.01403355598449707
time for parepare:  0.018446683883666992
local_output_nid generation:  0.022414445877075195
local_in_edges_tensor generation:  0.044267892837524414
mini_batch_src_global generation:  0.05344724655151367
r_  generation:  0.5746514797210693
local_output_nid generation:  0.03223085403442383
local_in_edges_tensor generation:  0.03960895538330078
mini_batch_src_global generation:  0.06687021255493164
r_  generation:  0.5823414325714111
----------------------check_connections_block total spend ----------------------------- 1.6994433403015137
generate_one_block  0.7452683448791504
generate_one_block  0.7838914394378662
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17539691925048828  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

connection checking time:  3.4194343090057373
block generation total time  3.0831000804901123
average batch blocks generation time:  1.5415500402450562
block dataloader generation time/epoch 8.337196906407675
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12221193313598633  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.336496353149414  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12232637405395508  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3366446495056152  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08855414390563965 |0.030851006507873535 |0.004145145416259766 |0.0005002021789550781 |0.004069805145263672 |0.0013837814331054688 |
----------------------------------------------------------pseudo_mini_loss sum 1.116929292678833
Total (block generation + training)time/epoch 8.691561099254724
Training time/epoch 0.3826568126678467
Training time without block to device /epoch 0.3209547996520996
Training time without total dataloading part /epoch 0.0188140869140625
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 48.69it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.83it/s]100%|██████████| 4/4 [00:00<00:00, 15.39it/s]100%|██████████| 4/4 [00:00<00:00, 15.29it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.13it/s]100%|██████████| 4/4 [00:00<00:00, 17.28it/s]100%|██████████| 4/4 [00:00<00:00, 17.24it/s]
Run 00 | Epoch 00042 | Loss 1.1169 | Train 0.4044 | Val 0.4925 | Test 0.5017
Number of nodes during this epoch:  335698
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17546701431274414  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02409052848815918
range selection method range initialization spend 0.011910438537597656
time for parepare:  0.016733169555664062
local_output_nid generation:  0.011045217514038086
local_in_edges_tensor generation:  0.011300086975097656
mini_batch_src_global generation:  0.017849445343017578
r_  generation:  0.2048177719116211
local_output_nid generation:  0.012031793594360352
local_in_edges_tensor generation:  0.00807046890258789
mini_batch_src_global generation:  0.021782875061035156
r_  generation:  0.22028398513793945
----------------------check_connections_block total spend ----------------------------- 0.6077220439910889
generate_one_block  0.24593853950500488
generate_one_block  0.24959683418273926
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04148507118225098
gen group dst list time:  0.006583690643310547
time for parepare:  0.020209789276123047
local_output_nid generation:  0.018823862075805664
local_in_edges_tensor generation:  0.03860306739807129
mini_batch_src_global generation:  0.05537104606628418
r_  generation:  0.58487868309021
local_output_nid generation:  0.027987957000732422
local_in_edges_tensor generation:  0.03563642501831055
mini_batch_src_global generation:  0.06775045394897461
r_  generation:  0.5894594192504883
----------------------check_connections_block total spend ----------------------------- 1.6917009353637695
generate_one_block  0.7546734809875488
generate_one_block  0.7513115406036377
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028914690017700195
gen group dst list time:  0.012017250061035156
time for parepare:  0.018579721450805664
local_output_nid generation:  0.02305006980895996
local_in_edges_tensor generation:  0.03406405448913574
mini_batch_src_global generation:  0.05264472961425781
r_  generation:  0.5814487934112549
local_output_nid generation:  0.03270912170410156
local_in_edges_tensor generation:  0.039489030838012695
mini_batch_src_global generation:  0.06944489479064941
r_  generation:  0.5880703926086426
----------------------check_connections_block total spend ----------------------------- 1.7046387195587158
generate_one_block  0.7558162212371826
generate_one_block  0.7643487453460693
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17546701431274414  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

connection checking time:  3.3963396549224854
block generation total time  3.0261499881744385
average batch blocks generation time:  1.5130749940872192
block dataloader generation time/epoch 8.337163960232454
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12225770950317383  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3365049362182617  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12226629257202148  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3364906311035156  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08390367031097412 |0.02725684642791748 |0.004055500030517578 |0.0004942417144775391 |0.00392603874206543 |0.0013766288757324219 |
----------------------------------------------------------pseudo_mini_loss sum 1.111985206604004
Total (block generation + training)time/epoch 8.691843600834117
Training time/epoch 0.36494016647338867
Training time without block to device /epoch 0.3104264736175537
Training time without total dataloading part /epoch 0.018328189849853516
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 52.02it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.90it/s]100%|██████████| 4/4 [00:00<00:00, 15.28it/s]100%|██████████| 4/4 [00:00<00:00, 15.20it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.43it/s]100%|██████████| 4/4 [00:00<00:00, 17.47it/s]100%|██████████| 4/4 [00:00<00:00, 17.44it/s]
Run 00 | Epoch 00043 | Loss 1.1120 | Train 0.4004 | Val 0.4839 | Test 0.4928
Number of nodes during this epoch:  335683
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1754136085510254  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024149179458618164
range selection method range initialization spend 0.011873960494995117
time for parepare:  0.017062902450561523
local_output_nid generation:  0.0112152099609375
local_in_edges_tensor generation:  0.01244044303894043
mini_batch_src_global generation:  0.01777052879333496
r_  generation:  0.20726776123046875
local_output_nid generation:  0.011607170104980469
local_in_edges_tensor generation:  0.006588459014892578
mini_batch_src_global generation:  0.021668434143066406
r_  generation:  0.21965575218200684
----------------------check_connections_block total spend ----------------------------- 0.6090037822723389
generate_one_block  0.24534058570861816
generate_one_block  0.2499549388885498
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03387331962585449
gen group dst list time:  0.006790876388549805
time for parepare:  0.019809484481811523
local_output_nid generation:  0.018567562103271484
local_in_edges_tensor generation:  0.042940616607666016
mini_batch_src_global generation:  0.05532360076904297
r_  generation:  0.5884466171264648
local_output_nid generation:  0.02843785285949707
local_in_edges_tensor generation:  0.04025387763977051
mini_batch_src_global generation:  0.06779146194458008
r_  generation:  0.5979831218719482
----------------------check_connections_block total spend ----------------------------- 1.7156822681427002
generate_one_block  0.762615442276001
generate_one_block  0.7925014495849609
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03571343421936035
gen group dst list time:  0.014951467514038086
time for parepare:  0.018211841583251953
local_output_nid generation:  0.022897005081176758
local_in_edges_tensor generation:  0.04645395278930664
mini_batch_src_global generation:  0.0533299446105957
r_  generation:  0.5743398666381836
local_output_nid generation:  0.03225541114807129
local_in_edges_tensor generation:  0.04220747947692871
mini_batch_src_global generation:  0.0670313835144043
r_  generation:  0.5817556381225586
----------------------check_connections_block total spend ----------------------------- 1.7035791873931885
generate_one_block  0.7252745628356934
generate_one_block  0.7351429462432861
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1754136085510254  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

connection checking time:  3.4192614555358887
block generation total time  3.0155344009399414
average batch blocks generation time:  1.5077672004699707
block dataloader generation time/epoch 8.337133237293788
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12231016159057617  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3368196487426758  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1222376823425293  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3364853858947754  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0916907787322998 |0.02450859546661377 |0.004123091697692871 |0.0005054473876953125 |0.003948807716369629 |0.00176239013671875 |
----------------------------------------------------------pseudo_mini_loss sum 1.1135835647583008
Total (block generation + training)time/epoch 8.692369481495449
Training time/epoch 0.3740119934082031
Training time without block to device /epoch 0.3249948024749756
Training time without total dataloading part /epoch 0.018917083740234375
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 59.50it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.18it/s]100%|██████████| 4/4 [00:00<00:00, 15.48it/s]100%|██████████| 4/4 [00:00<00:00, 15.42it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.42it/s]100%|██████████| 4/4 [00:00<00:00, 17.53it/s]100%|██████████| 4/4 [00:00<00:00, 17.50it/s]
Run 00 | Epoch 00044 | Loss 1.1136 | Train 0.3960 | Val 0.4734 | Test 0.4813
Number of nodes during this epoch:  335727
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17534542083740234  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0195467472076416
range selection method range initialization spend 0.011774539947509766
time for parepare:  0.016870498657226562
local_output_nid generation:  0.010996818542480469
local_in_edges_tensor generation:  0.009731531143188477
mini_batch_src_global generation:  0.016920089721679688
r_  generation:  0.2052919864654541
local_output_nid generation:  0.011729001998901367
local_in_edges_tensor generation:  0.006562471389770508
mini_batch_src_global generation:  0.021581172943115234
r_  generation:  0.22018837928771973
----------------------check_connections_block total spend ----------------------------- 0.6031484603881836
generate_one_block  0.24499964714050293
generate_one_block  0.2483980655670166
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.035016536712646484
gen group dst list time:  0.00659632682800293
time for parepare:  0.019775867462158203
local_output_nid generation:  0.0183866024017334
local_in_edges_tensor generation:  0.033591270446777344
mini_batch_src_global generation:  0.05697178840637207
r_  generation:  0.5794627666473389
local_output_nid generation:  0.02870488166809082
local_in_edges_tensor generation:  0.03780937194824219
mini_batch_src_global generation:  0.0672600269317627
r_  generation:  0.6012914180755615
----------------------check_connections_block total spend ----------------------------- 1.7006280422210693
generate_one_block  0.7586929798126221
generate_one_block  0.7658495903015137
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04105997085571289
gen group dst list time:  0.01354074478149414
time for parepare:  0.018593788146972656
local_output_nid generation:  0.023473262786865234
local_in_edges_tensor generation:  0.04002118110656738
mini_batch_src_global generation:  0.05828976631164551
r_  generation:  0.5955109596252441
local_output_nid generation:  0.035283803939819336
local_in_edges_tensor generation:  0.043860673904418945
mini_batch_src_global generation:  0.06754779815673828
r_  generation:  0.5840370655059814
----------------------check_connections_block total spend ----------------------------- 1.7382850646972656
generate_one_block  0.7271111011505127
generate_one_block  0.7292017936706543
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17534542083740234  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

connection checking time:  3.438913106918335
block generation total time  2.9808554649353027
average batch blocks generation time:  1.4904277324676514
block dataloader generation time/epoch 8.33635656701194
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12225008010864258  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3364176750183105  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12228059768676758  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3367738723754883  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09043395519256592 |0.023583650588989258 |0.004119992256164551 |0.0005080699920654297 |0.0033074617385864258 |0.003075838088989258 |
----------------------------------------------------------pseudo_mini_loss sum 1.104527473449707
Total (block generation + training)time/epoch 8.691505233446756
Training time/epoch 0.3519408702850342
Training time without block to device /epoch 0.30477356910705566
Training time without total dataloading part /epoch 0.01894688606262207
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 52.16it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.84it/s]100%|██████████| 4/4 [00:00<00:00, 15.38it/s]100%|██████████| 4/4 [00:00<00:00, 15.28it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.80it/s]100%|██████████| 4/4 [00:00<00:00, 17.56it/s]100%|██████████| 4/4 [00:00<00:00, 17.42it/s]
Run 00 | Epoch 00045 | Loss 1.1045 | Train 0.3917 | Val 0.4622 | Test 0.4690
Number of nodes during this epoch:  335691
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17532873153686523  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024292707443237305
range selection method range initialization spend 0.011851787567138672
time for parepare:  0.017017602920532227
local_output_nid generation:  0.011031389236450195
local_in_edges_tensor generation:  0.011060714721679688
mini_batch_src_global generation:  0.017227888107299805
r_  generation:  0.20366740226745605
local_output_nid generation:  0.01186227798461914
local_in_edges_tensor generation:  0.008196592330932617
mini_batch_src_global generation:  0.0220489501953125
r_  generation:  0.22200775146484375
----------------------check_connections_block total spend ----------------------------- 0.6078824996948242
generate_one_block  0.2432389259338379
generate_one_block  0.2510824203491211
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04363274574279785
gen group dst list time:  0.006746053695678711
time for parepare:  0.02008819580078125
local_output_nid generation:  0.018886089324951172
local_in_edges_tensor generation:  0.031798601150512695
mini_batch_src_global generation:  0.059212446212768555
r_  generation:  0.5884742736816406
local_output_nid generation:  0.028306007385253906
local_in_edges_tensor generation:  0.03521370887756348
mini_batch_src_global generation:  0.0678865909576416
r_  generation:  0.6021289825439453
----------------------check_connections_block total spend ----------------------------- 1.7062454223632812
generate_one_block  0.7765746116638184
generate_one_block  0.7800161838531494
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030162572860717773
gen group dst list time:  0.014517545700073242
time for parepare:  0.01833963394165039
local_output_nid generation:  0.0238494873046875
local_in_edges_tensor generation:  0.050008535385131836
mini_batch_src_global generation:  0.05352354049682617
r_  generation:  0.5818619728088379
local_output_nid generation:  0.033539533615112305
local_in_edges_tensor generation:  0.04149603843688965
mini_batch_src_global generation:  0.07029557228088379
r_  generation:  0.5861401557922363
----------------------check_connections_block total spend ----------------------------- 1.7279016971588135
generate_one_block  0.7311766147613525
generate_one_block  0.7438111305236816
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17532873153686523  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

connection checking time:  3.4341471195220947
block generation total time  3.031578540802002
average batch blocks generation time:  1.515789270401001
block dataloader generation time/epoch 8.336981090339455
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12221574783325195  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3363409042358398  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12232351303100586  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3368945121765137  GigaBytes
Max Memory Allocated: 1.60823392868042  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08954572677612305 |0.021748781204223633 |0.0041588544845581055 |0.0005183219909667969 |0.003196120262145996 |0.001436471939086914 |
----------------------------------------------------------pseudo_mini_loss sum 1.0962082147598267
Total (block generation + training)time/epoch 8.692114121205098
Training time/epoch 0.3544135093688965
Training time without block to device /epoch 0.3109159469604492
Training time without total dataloading part /epoch 0.01718306541442871
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 56.14it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.23it/s]100%|██████████| 4/4 [00:00<00:00, 15.36it/s]100%|██████████| 4/4 [00:00<00:00, 15.33it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.05it/s]100%|██████████| 4/4 [00:00<00:00, 17.51it/s]100%|██████████| 4/4 [00:00<00:00, 17.42it/s]
Run 00 | Epoch 00046 | Loss 1.0962 | Train 0.3876 | Val 0.4500 | Test 0.4546
Number of nodes during this epoch:  335711
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1754002571105957  GigaBytes
Max Memory Allocated: 1.6082563400268555  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020993471145629883
range selection method range initialization spend 0.011738300323486328
time for parepare:  0.01685190200805664
local_output_nid generation:  0.011032581329345703
local_in_edges_tensor generation:  0.009442329406738281
mini_batch_src_global generation:  0.017510175704956055
r_  generation:  0.2101752758026123
local_output_nid generation:  0.012086868286132812
local_in_edges_tensor generation:  0.006962299346923828
mini_batch_src_global generation:  0.021952152252197266
r_  generation:  0.22044944763183594
----------------------check_connections_block total spend ----------------------------- 0.610884428024292
generate_one_block  0.25367307662963867
generate_one_block  0.2482302188873291
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03324437141418457
gen group dst list time:  0.006592273712158203
time for parepare:  0.0199429988861084
local_output_nid generation:  0.019495487213134766
local_in_edges_tensor generation:  0.03825736045837402
mini_batch_src_global generation:  0.0579681396484375
r_  generation:  0.5915622711181641
local_output_nid generation:  0.029615163803100586
local_in_edges_tensor generation:  0.03627800941467285
mini_batch_src_global generation:  0.06701374053955078
r_  generation:  0.6013820171356201
----------------------check_connections_block total spend ----------------------------- 1.7142977714538574
generate_one_block  0.7640953063964844
generate_one_block  0.7646753787994385
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030689477920532227
gen group dst list time:  0.015272140502929688
time for parepare:  0.02135157585144043
local_output_nid generation:  0.027580976486206055
local_in_edges_tensor generation:  0.03619503974914551
mini_batch_src_global generation:  0.053205013275146484
r_  generation:  0.5809402465820312
local_output_nid generation:  0.03292036056518555
local_in_edges_tensor generation:  0.03969836235046387
mini_batch_src_global generation:  0.06953763961791992
r_  generation:  0.5888359546661377
----------------------check_connections_block total spend ----------------------------- 1.720560073852539
generate_one_block  0.7588810920715332
generate_one_block  0.7535412311553955
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1754002571105957  GigaBytes
Max Memory Allocated: 1.6082563400268555  GigaBytes

connection checking time:  3.4348578453063965
block generation total time  3.0411930084228516
average batch blocks generation time:  1.5205965042114258
block dataloader generation time/epoch 8.338466732125534
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12234735488891602  GigaBytes
Max Memory Allocated: 1.6082563400268555  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.336918830871582  GigaBytes
Max Memory Allocated: 1.6082563400268555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12217473983764648  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3300585746765137  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0795973539352417 |0.027699708938598633 |0.016811728477478027 |0.0004912614822387695 |0.0031342506408691406 |0.0013806819915771484 |
----------------------------------------------------------pseudo_mini_loss sum 1.0945744514465332
Total (block generation + training)time/epoch 8.694037318229675
Training time/epoch 0.37162208557128906
Training time without block to device /epoch 0.3162226676940918
Training time without total dataloading part /epoch 0.04225516319274902
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.98it/s]100%|██████████| 4/4 [00:00<00:00, 29.24it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.48it/s]100%|██████████| 4/4 [00:00<00:00, 12.61it/s]100%|██████████| 4/4 [00:00<00:00, 12.42it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.09it/s]100%|██████████| 4/4 [00:00<00:00, 17.26it/s]100%|██████████| 4/4 [00:00<00:00, 17.22it/s]
Run 00 | Epoch 00047 | Loss 1.0946 | Train 0.3829 | Val 0.4390 | Test 0.4411
Number of nodes during this epoch:  335688
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17541217803955078  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022776365280151367
range selection method range initialization spend 0.012166738510131836
time for parepare:  0.017008543014526367
local_output_nid generation:  0.01116943359375
local_in_edges_tensor generation:  0.011377811431884766
mini_batch_src_global generation:  0.017570972442626953
r_  generation:  0.20827674865722656
local_output_nid generation:  0.012303590774536133
local_in_edges_tensor generation:  0.008374929428100586
mini_batch_src_global generation:  0.02195143699645996
r_  generation:  0.22198271751403809
----------------------check_connections_block total spend ----------------------------- 0.6140453815460205
generate_one_block  0.2474651336669922
generate_one_block  0.2480454444885254
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.035744428634643555
gen group dst list time:  0.0065155029296875
time for parepare:  0.020159006118774414
local_output_nid generation:  0.019275426864624023
local_in_edges_tensor generation:  0.03418564796447754
mini_batch_src_global generation:  0.05546736717224121
r_  generation:  0.5833530426025391
local_output_nid generation:  0.029288291931152344
local_in_edges_tensor generation:  0.035468101501464844
mini_batch_src_global generation:  0.06816530227661133
r_  generation:  0.5936369895935059
----------------------check_connections_block total spend ----------------------------- 1.692826509475708
generate_one_block  0.753122091293335
generate_one_block  0.7724905014038086
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028684616088867188
gen group dst list time:  0.012303590774536133
time for parepare:  0.019166231155395508
local_output_nid generation:  0.024446487426757812
local_in_edges_tensor generation:  0.0373685359954834
mini_batch_src_global generation:  0.05319380760192871
r_  generation:  0.5855481624603271
local_output_nid generation:  0.03376603126525879
local_in_edges_tensor generation:  0.0364069938659668
mini_batch_src_global generation:  0.0680992603302002
r_  generation:  0.5855495929718018
----------------------check_connections_block total spend ----------------------------- 1.710906982421875
generate_one_block  0.7321093082427979
generate_one_block  0.7494649887084961
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17541217803955078  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.403733491897583
block generation total time  3.0071868896484375
average batch blocks generation time:  1.5035934448242188
block dataloader generation time/epoch 8.337700904944004
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12228250503540039  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3364362716674805  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12223291397094727  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3365836143493652  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07932472229003906 |0.019900798797607422 |0.0038918256759643555 |0.0005025863647460938 |0.0037746429443359375 |0.0014290809631347656 |
----------------------------------------------------------pseudo_mini_loss sum 1.0906527042388916
Total (block generation + training)time/epoch 8.692839127320509
Training time/epoch 0.3386106491088867
Training time without block to device /epoch 0.2988090515136719
Training time without total dataloading part /epoch 0.01776719093322754
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 64.07it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.73it/s]100%|██████████| 4/4 [00:00<00:00, 15.37it/s]100%|██████████| 4/4 [00:00<00:00, 15.25it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.32it/s]100%|██████████| 4/4 [00:00<00:00, 17.37it/s]100%|██████████| 4/4 [00:00<00:00, 17.34it/s]
Run 00 | Epoch 00048 | Loss 1.0907 | Train 0.3781 | Val 0.4278 | Test 0.4279
Number of nodes during this epoch:  335678
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17525768280029297  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019100427627563477
range selection method range initialization spend 0.012034177780151367
time for parepare:  0.017024517059326172
local_output_nid generation:  0.010950803756713867
local_in_edges_tensor generation:  0.009436845779418945
mini_batch_src_global generation:  0.017159461975097656
r_  generation:  0.21139025688171387
local_output_nid generation:  0.011964559555053711
local_in_edges_tensor generation:  0.00671696662902832
mini_batch_src_global generation:  0.022027015686035156
r_  generation:  0.2263951301574707
----------------------check_connections_block total spend ----------------------------- 0.6167449951171875
generate_one_block  0.24775004386901855
generate_one_block  0.24822783470153809
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.035231590270996094
gen group dst list time:  0.006620168685913086
time for parepare:  0.020541906356811523
local_output_nid generation:  0.01897597312927246
local_in_edges_tensor generation:  0.031089067459106445
mini_batch_src_global generation:  0.05444955825805664
r_  generation:  0.6161034107208252
local_output_nid generation:  0.033837080001831055
local_in_edges_tensor generation:  0.04370546340942383
mini_batch_src_global generation:  0.0839073657989502
r_  generation:  0.5948078632354736
----------------------check_connections_block total spend ----------------------------- 1.7522029876708984
generate_one_block  0.7697744369506836
generate_one_block  0.7701222896575928
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029619216918945312
gen group dst list time:  0.012584686279296875
time for parepare:  0.018317222595214844
local_output_nid generation:  0.023329496383666992
local_in_edges_tensor generation:  0.04744863510131836
mini_batch_src_global generation:  0.0541229248046875
r_  generation:  0.593442440032959
local_output_nid generation:  0.03445911407470703
local_in_edges_tensor generation:  0.04086875915527344
mini_batch_src_global generation:  0.06731057167053223
r_  generation:  0.5959246158599854
----------------------check_connections_block total spend ----------------------------- 1.7450439929962158
generate_one_block  0.7657129764556885
generate_one_block  0.7632951736450195
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17525768280029297  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.4972469806671143
block generation total time  3.0689048767089844
average batch blocks generation time:  1.5344524383544922
block dataloader generation time/epoch 8.340860062837601
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12229204177856445  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.336616039276123  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12224435806274414  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3365559577941895  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09226465225219727 |0.027538299560546875 |0.004041314125061035 |0.0005048513412475586 |0.004109740257263184 |0.001569986343383789 |
----------------------------------------------------------pseudo_mini_loss sum 1.085240364074707
Total (block generation + training)time/epoch 8.696305239200592
Training time/epoch 0.3672597408294678
Training time without block to device /epoch 0.312183141708374
Training time without total dataloading part /epoch 0.018881797790527344
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 49.25it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.05it/s]100%|██████████| 4/4 [00:00<00:00, 15.16it/s]100%|██████████| 4/4 [00:00<00:00, 15.13it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.24it/s]100%|██████████| 4/4 [00:00<00:00, 17.34it/s]100%|██████████| 4/4 [00:00<00:00, 17.30it/s]
Run 00 | Epoch 00049 | Loss 1.0852 | Train 0.3741 | Val 0.4202 | Test 0.4191
Number of nodes during this epoch:  335654
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1753077507019043  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0215146541595459
range selection method range initialization spend 0.011903047561645508
time for parepare:  0.016866683959960938
local_output_nid generation:  0.01106882095336914
local_in_edges_tensor generation:  0.011287689208984375
mini_batch_src_global generation:  0.017386674880981445
r_  generation:  0.21035456657409668
local_output_nid generation:  0.01214599609375
local_in_edges_tensor generation:  0.00758814811706543
mini_batch_src_global generation:  0.02166152000427246
r_  generation:  0.22089433670043945
----------------------check_connections_block total spend ----------------------------- 0.6138310432434082
generate_one_block  0.24841809272766113
generate_one_block  0.25290369987487793
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03420734405517578
gen group dst list time:  0.0066165924072265625
time for parepare:  0.020225048065185547
local_output_nid generation:  0.01936054229736328
local_in_edges_tensor generation:  0.03744173049926758
mini_batch_src_global generation:  0.05985069274902344
r_  generation:  0.5901124477386475
local_output_nid generation:  0.028961658477783203
local_in_edges_tensor generation:  0.03813767433166504
mini_batch_src_global generation:  0.06792211532592773
r_  generation:  0.6045553684234619
----------------------check_connections_block total spend ----------------------------- 1.726989507675171
generate_one_block  0.7810876369476318
generate_one_block  0.762967586517334
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030846834182739258
gen group dst list time:  0.014624595642089844
time for parepare:  0.018174409866333008
local_output_nid generation:  0.024088144302368164
local_in_edges_tensor generation:  0.04620933532714844
mini_batch_src_global generation:  0.05325675010681152
r_  generation:  0.5811212062835693
local_output_nid generation:  0.0340571403503418
local_in_edges_tensor generation:  0.042038917541503906
mini_batch_src_global generation:  0.06727170944213867
r_  generation:  0.5880832672119141
----------------------check_connections_block total spend ----------------------------- 1.7203054428100586
generate_one_block  0.7373247146606445
generate_one_block  0.7669475078582764
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1753077507019043  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.4472949504852295
block generation total time  3.0483274459838867
average batch blocks generation time:  1.5241637229919434
block dataloader generation time/epoch 8.34292758383402
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12231683731079102  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3367514610290527  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12221574783325195  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3364739418029785  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08506596088409424 |0.02152729034423828 |0.004183411598205566 |0.0005300045013427734 |0.0038852691650390625 |0.0020368099212646484 |
----------------------------------------------------------pseudo_mini_loss sum 1.0778217315673828
Total (block generation + training)time/epoch 8.698367717789441
Training time/epoch 0.35509371757507324
Training time without block to device /epoch 0.3120391368865967
Training time without total dataloading part /epoch 0.019234180450439453
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 53.00it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.77it/s]100%|██████████| 4/4 [00:00<00:00, 15.27it/s]100%|██████████| 4/4 [00:00<00:00, 15.18it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.57it/s]100%|██████████| 4/4 [00:00<00:00, 16.89it/s]100%|██████████| 4/4 [00:00<00:00, 16.82it/s]
Run 00 | Epoch 00050 | Loss 1.0778 | Train 0.3700 | Val 0.4146 | Test 0.4118
Number of nodes during this epoch:  335692
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17528867721557617  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02229166030883789
range selection method range initialization spend 0.012276411056518555
time for parepare:  0.01748037338256836
local_output_nid generation:  0.010981082916259766
local_in_edges_tensor generation:  0.01224207878112793
mini_batch_src_global generation:  0.01771402359008789
r_  generation:  0.2083735466003418
local_output_nid generation:  0.011936664581298828
local_in_edges_tensor generation:  0.007488727569580078
mini_batch_src_global generation:  0.021796226501464844
r_  generation:  0.2201826572418213
----------------------check_connections_block total spend ----------------------------- 0.6121056079864502
generate_one_block  0.2516908645629883
generate_one_block  0.25136733055114746
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04555225372314453
gen group dst list time:  0.00650477409362793
time for parepare:  0.020237445831298828
local_output_nid generation:  0.01877593994140625
local_in_edges_tensor generation:  0.03929424285888672
mini_batch_src_global generation:  0.05576777458190918
r_  generation:  0.5858058929443359
local_output_nid generation:  0.02845621109008789
local_in_edges_tensor generation:  0.04126286506652832
mini_batch_src_global generation:  0.0673372745513916
r_  generation:  0.597273588180542
----------------------check_connections_block total spend ----------------------------- 1.7076287269592285
generate_one_block  0.7619843482971191
generate_one_block  0.7674577236175537
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028540611267089844
gen group dst list time:  0.01230764389038086
time for parepare:  0.018410682678222656
local_output_nid generation:  0.024433374404907227
local_in_edges_tensor generation:  0.03944063186645508
mini_batch_src_global generation:  0.052706241607666016
r_  generation:  0.6024279594421387
local_output_nid generation:  0.03334212303161621
local_in_edges_tensor generation:  0.04566621780395508
mini_batch_src_global generation:  0.06816935539245605
r_  generation:  0.5951368808746338
----------------------check_connections_block total spend ----------------------------- 1.7505552768707275
generate_one_block  0.7721049785614014
generate_one_block  0.7439968585968018
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17528867721557617  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.458184003829956
block generation total time  3.045543909072876
average batch blocks generation time:  1.522771954536438
block dataloader generation time/epoch 8.345582439785911
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12233591079711914  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3369178771972656  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12220430374145508  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3318243026733398  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08685743808746338 |0.02777683734893799 |0.004108548164367676 |0.0005089044570922852 |0.003872990608215332 |0.0029706954956054688 |
----------------------------------------------------------pseudo_mini_loss sum 1.077154278755188
Total (block generation + training)time/epoch 8.701142640340896
Training time/epoch 0.3603336811065674
Training time without block to device /epoch 0.3047800064086914
Training time without total dataloading part /epoch 0.019951581954956055
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 49.52it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.01it/s]100%|██████████| 4/4 [00:00<00:00, 15.38it/s]100%|██████████| 4/4 [00:00<00:00, 15.31it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.39it/s]100%|██████████| 4/4 [00:00<00:00, 17.61it/s]100%|██████████| 4/4 [00:00<00:00, 17.56it/s]
Run 00 | Epoch 00051 | Loss 1.0772 | Train 0.3668 | Val 0.4105 | Test 0.4063
Number of nodes during this epoch:  335650
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17538022994995117  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023846864700317383
range selection method range initialization spend 0.011754035949707031
time for parepare:  0.017133235931396484
local_output_nid generation:  0.01088857650756836
local_in_edges_tensor generation:  0.011136054992675781
mini_batch_src_global generation:  0.017614364624023438
r_  generation:  0.21617817878723145
local_output_nid generation:  0.01176762580871582
local_in_edges_tensor generation:  0.006792783737182617
mini_batch_src_global generation:  0.022089719772338867
r_  generation:  0.22785139083862305
----------------------check_connections_block total spend ----------------------------- 0.6256058216094971
generate_one_block  0.25489377975463867
generate_one_block  0.25077390670776367
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04278683662414551
gen group dst list time:  0.006512880325317383
time for parepare:  0.02035665512084961
local_output_nid generation:  0.018581151962280273
local_in_edges_tensor generation:  0.034125328063964844
mini_batch_src_global generation:  0.06022167205810547
r_  generation:  0.5962467193603516
local_output_nid generation:  0.030555248260498047
local_in_edges_tensor generation:  0.03619384765625
mini_batch_src_global generation:  0.06778240203857422
r_  generation:  0.6074073314666748
----------------------check_connections_block total spend ----------------------------- 1.7239868640899658
generate_one_block  0.7575621604919434
generate_one_block  0.7615585327148438
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03058791160583496
gen group dst list time:  0.013278961181640625
time for parepare:  0.018042325973510742
local_output_nid generation:  0.02332782745361328
local_in_edges_tensor generation:  0.045966148376464844
mini_batch_src_global generation:  0.053887367248535156
r_  generation:  0.5989890098571777
local_output_nid generation:  0.035703182220458984
local_in_edges_tensor generation:  0.0476832389831543
mini_batch_src_global generation:  0.06893205642700195
r_  generation:  0.5853140354156494
----------------------check_connections_block total spend ----------------------------- 1.7482905387878418
generate_one_block  0.7265377044677734
generate_one_block  0.7381513118743896
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17538022994995117  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.4722774028778076
block generation total time  2.98380970954895
average batch blocks generation time:  1.491904854774475
block dataloader generation time/epoch 8.346487494402153
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12223386764526367  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.336421012878418  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12229204177856445  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.336580753326416  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0873270034790039 |0.027271151542663574 |0.0041429996490478516 |0.0005137920379638672 |0.0033322572708129883 |0.003159046173095703 |
----------------------------------------------------------pseudo_mini_loss sum 1.075136661529541
Total (block generation + training)time/epoch 8.702215860056322
Training time/epoch 0.3626418113708496
Training time without block to device /epoch 0.30809950828552246
Training time without total dataloading part /epoch 0.019137144088745117
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 51.66it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.25it/s]100%|██████████| 4/4 [00:00<00:00, 16.14it/s]100%|██████████| 4/4 [00:00<00:00, 15.99it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.19it/s]100%|██████████| 4/4 [00:00<00:00, 18.73it/s]100%|██████████| 4/4 [00:00<00:00, 18.46it/s]
Run 00 | Epoch 00052 | Loss 1.0751 | Train 0.3645 | Val 0.4057 | Test 0.4021
Number of nodes during this epoch:  335698
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17543888092041016  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025367259979248047
range selection method range initialization spend 0.011701822280883789
time for parepare:  0.017285585403442383
local_output_nid generation:  0.01106715202331543
local_in_edges_tensor generation:  0.01316523551940918
mini_batch_src_global generation:  0.017311573028564453
r_  generation:  0.2063155174255371
local_output_nid generation:  0.011817455291748047
local_in_edges_tensor generation:  0.008903741836547852
mini_batch_src_global generation:  0.022225141525268555
r_  generation:  0.22219276428222656
----------------------check_connections_block total spend ----------------------------- 0.6163883209228516
generate_one_block  0.24840021133422852
generate_one_block  0.2548336982727051
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03148198127746582
gen group dst list time:  0.0065805912017822266
time for parepare:  0.020528316497802734
local_output_nid generation:  0.019308090209960938
local_in_edges_tensor generation:  0.046669960021972656
mini_batch_src_global generation:  0.05658221244812012
r_  generation:  0.5872721672058105
local_output_nid generation:  0.029056787490844727
local_in_edges_tensor generation:  0.03811955451965332
mini_batch_src_global generation:  0.06733393669128418
r_  generation:  0.6071054935455322
----------------------check_connections_block total spend ----------------------------- 1.7292110919952393
generate_one_block  0.7559700012207031
generate_one_block  0.7806580066680908
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04204130172729492
gen group dst list time:  0.013025522232055664
time for parepare:  0.018631696701049805
local_output_nid generation:  0.02383136749267578
local_in_edges_tensor generation:  0.040152549743652344
mini_batch_src_global generation:  0.05494070053100586
r_  generation:  0.6001005172729492
local_output_nid generation:  0.035277605056762695
local_in_edges_tensor generation:  0.04139852523803711
mini_batch_src_global generation:  0.0696260929107666
r_  generation:  0.5854794979095459
----------------------check_connections_block total spend ----------------------------- 1.745877742767334
generate_one_block  0.7287094593048096
generate_one_block  0.7350480556488037
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17543888092041016  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.4750888347625732
block generation total time  3.0003855228424072
average batch blocks generation time:  1.5001927614212036
block dataloader generation time/epoch 8.347574510357596
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12221765518188477  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3363256454467773  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12230253219604492  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.336719036102295  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08894813060760498 |0.024625420570373535 |0.004182696342468262 |0.0005183219909667969 |0.0033828020095825195 |0.0029935836791992188 |
----------------------------------------------------------pseudo_mini_loss sum 1.068009614944458
Total (block generation + training)time/epoch 8.703522405841134
Training time/epoch 0.36524176597595215
Training time without block to device /epoch 0.3159909248352051
Training time without total dataloading part /epoch 0.019161224365234375
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 59.89it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.14it/s]100%|██████████| 4/4 [00:00<00:00, 15.55it/s]100%|██████████| 4/4 [00:00<00:00, 15.47it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.65it/s]100%|██████████| 4/4 [00:00<00:00, 17.82it/s]100%|██████████| 4/4 [00:00<00:00, 17.77it/s]
Run 00 | Epoch 00053 | Loss 1.0680 | Train 0.3619 | Val 0.4021 | Test 0.3967
Number of nodes during this epoch:  335711
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17539024353027344  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020459413528442383
range selection method range initialization spend 0.011647701263427734
time for parepare:  0.016787290573120117
local_output_nid generation:  0.010969161987304688
local_in_edges_tensor generation:  0.013673543930053711
mini_batch_src_global generation:  0.01757955551147461
r_  generation:  0.20514345169067383
local_output_nid generation:  0.011936187744140625
local_in_edges_tensor generation:  0.006985902786254883
mini_batch_src_global generation:  0.021785736083984375
r_  generation:  0.22187352180480957
----------------------check_connections_block total spend ----------------------------- 0.6114659309387207
generate_one_block  0.246079683303833
generate_one_block  0.24973344802856445
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.031839609146118164
gen group dst list time:  0.006675004959106445
time for parepare:  0.020207881927490234
local_output_nid generation:  0.018621206283569336
local_in_edges_tensor generation:  0.03355765342712402
mini_batch_src_global generation:  0.05732893943786621
r_  generation:  0.5869293212890625
local_output_nid generation:  0.0280606746673584
local_in_edges_tensor generation:  0.038065433502197266
mini_batch_src_global generation:  0.06940579414367676
r_  generation:  0.6000761985778809
----------------------check_connections_block total spend ----------------------------- 1.7049102783203125
generate_one_block  0.7697534561157227
generate_one_block  0.7712423801422119
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.031586647033691406
gen group dst list time:  0.013417243957519531
time for parepare:  0.018270254135131836
local_output_nid generation:  0.023723125457763672
local_in_edges_tensor generation:  0.03658294677734375
mini_batch_src_global generation:  0.05913352966308594
r_  generation:  0.6018064022064209
local_output_nid generation:  0.03610491752624512
local_in_edges_tensor generation:  0.04304099082946777
mini_batch_src_global generation:  0.06864237785339355
r_  generation:  0.5839235782623291
----------------------check_connections_block total spend ----------------------------- 1.7516067028045654
generate_one_block  0.7433338165283203
generate_one_block  0.7451925277709961
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17539024353027344  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.456516981124878
block generation total time  3.029522180557251
average batch blocks generation time:  1.5147610902786255
block dataloader generation time/epoch 8.348154438866509
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12227201461791992  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.33662748336792  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1222529411315918  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3365073204040527  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09096574783325195 |0.02824234962463379 |0.004256486892700195 |0.0005067586898803711 |0.0033788681030273438 |0.0017364025115966797 |
----------------------------------------------------------pseudo_mini_loss sum 1.0655932426452637
Total (block generation + training)time/epoch 8.704622157414754
Training time/epoch 0.3791835308074951
Training time without block to device /epoch 0.32269883155822754
Training time without total dataloading part /epoch 0.0180206298828125
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 52.83it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.03it/s]100%|██████████| 4/4 [00:00<00:00, 15.44it/s]100%|██████████| 4/4 [00:00<00:00, 15.37it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.43it/s]100%|██████████| 4/4 [00:00<00:00, 17.54it/s]100%|██████████| 4/4 [00:00<00:00, 17.50it/s]
Run 00 | Epoch 00054 | Loss 1.0656 | Train 0.3593 | Val 0.3979 | Test 0.3921
Number of nodes during this epoch:  335693
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17535114288330078  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022859811782836914
range selection method range initialization spend 0.01218557357788086
time for parepare:  0.01676797866821289
local_output_nid generation:  0.011256694793701172
local_in_edges_tensor generation:  0.011913299560546875
mini_batch_src_global generation:  0.017338275909423828
r_  generation:  0.20355820655822754
local_output_nid generation:  0.01187586784362793
local_in_edges_tensor generation:  0.0076863765716552734
mini_batch_src_global generation:  0.02265143394470215
r_  generation:  0.2222445011138916
----------------------check_connections_block total spend ----------------------------- 0.6109850406646729
generate_one_block  0.24901437759399414
generate_one_block  0.25066685676574707
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.035855770111083984
gen group dst list time:  0.006676197052001953
time for parepare:  0.020055770874023438
local_output_nid generation:  0.01853346824645996
local_in_edges_tensor generation:  0.03780961036682129
mini_batch_src_global generation:  0.05884671211242676
r_  generation:  0.5850095748901367
local_output_nid generation:  0.0282137393951416
local_in_edges_tensor generation:  0.03918790817260742
mini_batch_src_global generation:  0.06887149810791016
r_  generation:  0.6074368953704834
----------------------check_connections_block total spend ----------------------------- 1.7193517684936523
generate_one_block  0.7587158679962158
generate_one_block  0.7567968368530273
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02879047393798828
gen group dst list time:  0.012450695037841797
time for parepare:  0.01827836036682129
local_output_nid generation:  0.023302793502807617
local_in_edges_tensor generation:  0.03360772132873535
mini_batch_src_global generation:  0.05369305610656738
r_  generation:  0.5780551433563232
local_output_nid generation:  0.03267073631286621
local_in_edges_tensor generation:  0.0397796630859375
mini_batch_src_global generation:  0.07025027275085449
r_  generation:  0.5951309204101562
----------------------check_connections_block total spend ----------------------------- 1.7126572132110596
generate_one_block  0.7488629817962646
generate_one_block  0.7528924942016602
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17535114288330078  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.432008981704712
block generation total time  3.017268180847168
average batch blocks generation time:  1.508634090423584
block dataloader generation time/epoch 8.348343196122542
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12217950820922852  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3320741653442383  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12233209609985352  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3367581367492676  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08628392219543457 |0.031685471534729004 |0.003931403160095215 |0.0005016326904296875 |0.003978848457336426 |0.0013461112976074219 |
----------------------------------------------------------pseudo_mini_loss sum 1.0638978481292725
Total (block generation + training)time/epoch 8.705189974411674
Training time/epoch 0.3738210201263428
Training time without block to device /epoch 0.31045007705688477
Training time without total dataloading part /epoch 0.018169879913330078
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 52.68it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 12.51it/s]100%|██████████| 4/4 [00:00<00:00, 14.14it/s]100%|██████████| 4/4 [00:00<00:00, 13.85it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.47it/s]100%|██████████| 4/4 [00:00<00:00, 16.20it/s]100%|██████████| 4/4 [00:00<00:00, 15.90it/s]
Run 00 | Epoch 00055 | Loss 1.0639 | Train 0.3567 | Val 0.3939 | Test 0.3880
Number of nodes during this epoch:  335587
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17543649673461914  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021678686141967773
range selection method range initialization spend 0.012018918991088867
time for parepare:  0.01762676239013672
local_output_nid generation:  0.01310420036315918
local_in_edges_tensor generation:  0.020735502243041992
mini_batch_src_global generation:  0.017685651779174805
r_  generation:  0.20697546005249023
local_output_nid generation:  0.011893510818481445
local_in_edges_tensor generation:  0.0075457096099853516
mini_batch_src_global generation:  0.023210525512695312
r_  generation:  0.2222747802734375
----------------------check_connections_block total spend ----------------------------- 0.6260166168212891
generate_one_block  0.24923062324523926
generate_one_block  0.2522008419036865
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03958463668823242
gen group dst list time:  0.006598472595214844
time for parepare:  0.019974470138549805
local_output_nid generation:  0.01909804344177246
local_in_edges_tensor generation:  0.04099678993225098
mini_batch_src_global generation:  0.05687236785888672
r_  generation:  0.5870223045349121
local_output_nid generation:  0.02854156494140625
local_in_edges_tensor generation:  0.03716468811035156
mini_batch_src_global generation:  0.06839919090270996
r_  generation:  0.5957872867584229
----------------------check_connections_block total spend ----------------------------- 1.7074058055877686
generate_one_block  0.7527036666870117
generate_one_block  0.7500367164611816
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029012203216552734
gen group dst list time:  0.012334108352661133
time for parepare:  0.018377304077148438
local_output_nid generation:  0.023232460021972656
local_in_edges_tensor generation:  0.037876129150390625
mini_batch_src_global generation:  0.055208683013916016
r_  generation:  0.5746147632598877
local_output_nid generation:  0.03232526779174805
local_in_edges_tensor generation:  0.03720855712890625
mini_batch_src_global generation:  0.06880831718444824
r_  generation:  0.5912227630615234
----------------------check_connections_block total spend ----------------------------- 1.706909418106079
generate_one_block  0.7299723625183105
generate_one_block  0.7383866310119629
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17543649673461914  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.4143152236938477
block generation total time  2.971099376678467
average batch blocks generation time:  1.4855496883392334
block dataloader generation time/epoch 8.347152928088574
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12227392196655273  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3366475105285645  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12225770950317383  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3365349769592285  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08374035358428955 |0.018464088439941406 |0.004050254821777344 |0.0005129575729370117 |0.003726363182067871 |0.0014820098876953125 |
----------------------------------------------------------pseudo_mini_loss sum 1.0619820356369019
Total (block generation + training)time/epoch 8.703666631211625
Training time/epoch 0.34104490280151367
Training time without block to device /epoch 0.30411672592163086
Training time without total dataloading part /epoch 0.018061161041259766
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 55.68it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.27it/s]100%|██████████| 4/4 [00:00<00:00, 19.02it/s]100%|██████████| 4/4 [00:00<00:00, 18.88it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.66it/s]100%|██████████| 4/4 [00:00<00:00, 22.48it/s]
Run 00 | Epoch 00056 | Loss 1.0620 | Train 0.3534 | Val 0.3900 | Test 0.3830
Number of nodes during this epoch:  335671
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17537450790405273  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021792888641357422
range selection method range initialization spend 0.012014627456665039
time for parepare:  0.02115345001220703
local_output_nid generation:  0.011017084121704102
local_in_edges_tensor generation:  0.01085519790649414
mini_batch_src_global generation:  0.01862192153930664
r_  generation:  0.20879030227661133
local_output_nid generation:  0.012323379516601562
local_in_edges_tensor generation:  0.008292198181152344
mini_batch_src_global generation:  0.022848844528198242
r_  generation:  0.2217397689819336
----------------------check_connections_block total spend ----------------------------- 0.620816707611084
generate_one_block  0.24876880645751953
generate_one_block  0.24691557884216309
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.041777849197387695
gen group dst list time:  0.006622314453125
time for parepare:  0.02032613754272461
local_output_nid generation:  0.018897294998168945
local_in_edges_tensor generation:  0.04047060012817383
mini_batch_src_global generation:  0.05997300148010254
r_  generation:  0.5825040340423584
local_output_nid generation:  0.02806401252746582
local_in_edges_tensor generation:  0.04084014892578125
mini_batch_src_global generation:  0.06818699836730957
r_  generation:  0.5929114818572998
----------------------check_connections_block total spend ----------------------------- 1.7070426940917969
generate_one_block  0.7527725696563721
generate_one_block  0.7681169509887695
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02950739860534668
gen group dst list time:  0.01238250732421875
time for parepare:  0.018395662307739258
local_output_nid generation:  0.02324390411376953
local_in_edges_tensor generation:  0.03777146339416504
mini_batch_src_global generation:  0.055428266525268555
r_  generation:  0.5883138179779053
local_output_nid generation:  0.03235960006713867
local_in_edges_tensor generation:  0.042952537536621094
mini_batch_src_global generation:  0.06790924072265625
r_  generation:  0.5870602130889893
----------------------check_connections_block total spend ----------------------------- 1.7195701599121094
generate_one_block  0.7464988231658936
generate_one_block  0.7630455493927002
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17537450790405273  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.4266128540039062
block generation total time  3.0304338932037354
average batch blocks generation time:  1.5152169466018677
block dataloader generation time/epoch 8.348866552114487
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12228536605834961  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.336695671081543  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12223386764526367  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3363165855407715  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08682024478912354 |0.02916562557220459 |0.0040961503982543945 |0.000493168830871582 |0.0039490461349487305 |0.003426074981689453 |
----------------------------------------------------------pseudo_mini_loss sum 1.0563430786132812
Total (block generation + training)time/epoch 8.705545405546824
Training time/epoch 0.36427950859069824
Training time without block to device /epoch 0.30594825744628906
Training time without total dataloading part /epoch 0.020502805709838867
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 58.56it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.05it/s]100%|██████████| 4/4 [00:00<00:00, 15.33it/s]100%|██████████| 4/4 [00:00<00:00, 15.27it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.40it/s]100%|██████████| 4/4 [00:00<00:00, 17.36it/s]100%|██████████| 4/4 [00:00<00:00, 17.35it/s]
Run 00 | Epoch 00057 | Loss 1.0563 | Train 0.3502 | Val 0.3862 | Test 0.3779
Number of nodes during this epoch:  335673
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17540836334228516  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02129507064819336
range selection method range initialization spend 0.011783599853515625
time for parepare:  0.016782522201538086
local_output_nid generation:  0.011040687561035156
local_in_edges_tensor generation:  0.014294624328613281
mini_batch_src_global generation:  0.017535924911499023
r_  generation:  0.20543909072875977
local_output_nid generation:  0.012089967727661133
local_in_edges_tensor generation:  0.006720066070556641
mini_batch_src_global generation:  0.02217268943786621
r_  generation:  0.22463297843933105
----------------------check_connections_block total spend ----------------------------- 0.6153233051300049
generate_one_block  0.2464306354522705
generate_one_block  0.2530782222747803
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.039812326431274414
gen group dst list time:  0.0065190792083740234
time for parepare:  0.020241260528564453
local_output_nid generation:  0.018762588500976562
local_in_edges_tensor generation:  0.03927493095397949
mini_batch_src_global generation:  0.0606226921081543
r_  generation:  0.5916330814361572
local_output_nid generation:  0.028593778610229492
local_in_edges_tensor generation:  0.037859201431274414
mini_batch_src_global generation:  0.07037067413330078
r_  generation:  0.627934455871582
----------------------check_connections_block total spend ----------------------------- 1.7618393898010254
generate_one_block  0.7764086723327637
generate_one_block  0.7604892253875732
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03326725959777832
gen group dst list time:  0.014157772064208984
time for parepare:  0.018369674682617188
local_output_nid generation:  0.023613452911376953
local_in_edges_tensor generation:  0.05537295341491699
mini_batch_src_global generation:  0.055045127868652344
r_  generation:  0.5794081687927246
local_output_nid generation:  0.03291130065917969
local_in_edges_tensor generation:  0.04042840003967285
mini_batch_src_global generation:  0.06817960739135742
r_  generation:  0.5816149711608887
----------------------check_connections_block total spend ----------------------------- 1.72123384475708
generate_one_block  0.746856689453125
generate_one_block  0.7657036781311035
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17540836334228516  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.4830732345581055
block generation total time  3.0494582653045654
average batch blocks generation time:  1.5247291326522827
block dataloader generation time/epoch 8.35105510633819
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12224912643432617  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3365163803100586  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12227964401245117  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3365850448608398  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08684921264648438 |0.024243831634521484 |0.004216790199279785 |0.0005261898040771484 |0.003507375717163086 |0.0021250247955322266 |
----------------------------------------------------------pseudo_mini_loss sum 1.052412509918213
Total (block generation + training)time/epoch 8.707828220056028
Training time/epoch 0.3611409664154053
Training time without block to device /epoch 0.3126533031463623
Training time without total dataloading part /epoch 0.018625736236572266
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 49.41it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 12.58it/s]100%|██████████| 4/4 [00:00<00:00, 14.19it/s]100%|██████████| 4/4 [00:00<00:00, 13.91it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.30it/s]100%|██████████| 4/4 [00:00<00:00, 17.56it/s]100%|██████████| 4/4 [00:00<00:00, 17.50it/s]
Run 00 | Epoch 00058 | Loss 1.0524 | Train 0.3468 | Val 0.3814 | Test 0.3718
Number of nodes during this epoch:  335633
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17537927627563477  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027398109436035156
range selection method range initialization spend 0.012248992919921875
time for parepare:  0.017345428466796875
local_output_nid generation:  0.01111745834350586
local_in_edges_tensor generation:  0.011427879333496094
mini_batch_src_global generation:  0.018692731857299805
r_  generation:  0.2105095386505127
local_output_nid generation:  0.012142419815063477
local_in_edges_tensor generation:  0.007540702819824219
mini_batch_src_global generation:  0.02248978614807129
r_  generation:  0.22039532661437988
----------------------check_connections_block total spend ----------------------------- 0.6162314414978027
generate_one_block  0.24834585189819336
generate_one_block  0.24919772148132324
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.041936397552490234
gen group dst list time:  0.0066449642181396484
time for parepare:  0.02067089080810547
local_output_nid generation:  0.01952338218688965
local_in_edges_tensor generation:  0.03952431678771973
mini_batch_src_global generation:  0.05657696723937988
r_  generation:  0.5857486724853516
local_output_nid generation:  0.02907729148864746
local_in_edges_tensor generation:  0.03598761558532715
mini_batch_src_global generation:  0.06840872764587402
r_  generation:  0.5978250503540039
----------------------check_connections_block total spend ----------------------------- 1.7061817646026611
generate_one_block  0.7677083015441895
generate_one_block  0.7594003677368164
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028549671173095703
gen group dst list time:  0.012339115142822266
time for parepare:  0.018346786499023438
local_output_nid generation:  0.0237576961517334
local_in_edges_tensor generation:  0.03646445274353027
mini_batch_src_global generation:  0.05442953109741211
r_  generation:  0.5970430374145508
local_output_nid generation:  0.034702301025390625
local_in_edges_tensor generation:  0.04302859306335449
mini_batch_src_global generation:  0.06884074211120605
r_  generation:  0.594632625579834
----------------------check_connections_block total spend ----------------------------- 1.737264633178711
generate_one_block  0.755859375
generate_one_block  0.7439894676208496
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17537927627563477  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.443446397781372
block generation total time  3.0269575119018555
average batch blocks generation time:  1.5134787559509277
block dataloader generation time/epoch 8.352379174232484
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12231206893920898  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3366575241088867  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12222623825073242  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.33648681640625  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08887374401092529 |0.03396809101104736 |0.004084348678588867 |0.0004985332489013672 |0.004202604293823242 |0.0015366077423095703 |
----------------------------------------------------------pseudo_mini_loss sum 1.049343466758728
Total (block generation + training)time/epoch 8.709491519927978
Training time/epoch 0.3735842704772949
Training time without block to device /epoch 0.3056480884552002
Training time without total dataloading part /epoch 0.019107580184936523
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 57.23it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.10it/s]100%|██████████| 4/4 [00:00<00:00, 15.36it/s]100%|██████████| 4/4 [00:00<00:00, 15.30it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.33it/s]100%|██████████| 4/4 [00:00<00:00, 17.60it/s]100%|██████████| 4/4 [00:00<00:00, 17.54it/s]
Run 00 | Epoch 00059 | Loss 1.0493 | Train 0.3438 | Val 0.3764 | Test 0.3655
Number of nodes during this epoch:  335698
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17529821395874023  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02251911163330078
range selection method range initialization spend 0.011700868606567383
time for parepare:  0.018180370330810547
local_output_nid generation:  0.01080942153930664
local_in_edges_tensor generation:  0.01033926010131836
mini_batch_src_global generation:  0.017374277114868164
r_  generation:  0.20833325386047363
local_output_nid generation:  0.011897563934326172
local_in_edges_tensor generation:  0.009177923202514648
mini_batch_src_global generation:  0.02209019660949707
r_  generation:  0.22589826583862305
----------------------check_connections_block total spend ----------------------------- 0.6207869052886963
generate_one_block  0.2566664218902588
generate_one_block  0.2503786087036133
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.035375356674194336
gen group dst list time:  0.0065233707427978516
time for parepare:  0.019965171813964844
local_output_nid generation:  0.01846027374267578
local_in_edges_tensor generation:  0.03651714324951172
mini_batch_src_global generation:  0.05518698692321777
r_  generation:  0.5845439434051514
local_output_nid generation:  0.02860403060913086
local_in_edges_tensor generation:  0.03183484077453613
mini_batch_src_global generation:  0.06804823875427246
r_  generation:  0.5988068580627441
----------------------check_connections_block total spend ----------------------------- 1.6989390850067139
generate_one_block  0.7532308101654053
generate_one_block  0.7588069438934326
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02873849868774414
gen group dst list time:  0.012257099151611328
time for parepare:  0.01844048500061035
local_output_nid generation:  0.023212671279907227
local_in_edges_tensor generation:  0.036699533462524414
mini_batch_src_global generation:  0.055330514907836914
r_  generation:  0.5829792022705078
local_output_nid generation:  0.03259992599487305
local_in_edges_tensor generation:  0.034064292907714844
mini_batch_src_global generation:  0.06771421432495117
r_  generation:  0.5908961296081543
----------------------check_connections_block total spend ----------------------------- 1.717170000076294
generate_one_block  0.7442536354064941
generate_one_block  0.758225679397583
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17529821395874023  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.416109085083008
block generation total time  3.014517068862915
average batch blocks generation time:  1.5072585344314575
block dataloader generation time/epoch 8.35262664159139
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12228631973266602  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3366069793701172  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12224435806274414  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3365812301635742  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08997523784637451 |0.03441810607910156 |0.003940582275390625 |0.000492095947265625 |0.003960013389587402 |0.003366708755493164 |
----------------------------------------------------------pseudo_mini_loss sum 1.0462355613708496
Total (block generation + training)time/epoch 8.710314133588005
Training time/epoch 0.3863506317138672
Training time without block to device /epoch 0.31751441955566406
Training time without total dataloading part /epoch 0.02015209197998047
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 49.51it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.56it/s]100%|██████████| 4/4 [00:00<00:00, 15.07it/s]100%|██████████| 4/4 [00:00<00:00, 14.98it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.30it/s]100%|██████████| 4/4 [00:00<00:00, 17.46it/s]100%|██████████| 4/4 [00:00<00:00, 17.42it/s]
Run 00 | Epoch 00060 | Loss 1.0462 | Train 0.3410 | Val 0.3714 | Test 0.3595
Number of nodes during this epoch:  335635
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17529821395874023  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022451400756835938
range selection method range initialization spend 0.012174844741821289
time for parepare:  0.017103910446166992
local_output_nid generation:  0.011096477508544922
local_in_edges_tensor generation:  0.012216806411743164
mini_batch_src_global generation:  0.018055200576782227
r_  generation:  0.20782256126403809
local_output_nid generation:  0.012543916702270508
local_in_edges_tensor generation:  0.0070536136627197266
mini_batch_src_global generation:  0.022223949432373047
r_  generation:  0.2211894989013672
----------------------check_connections_block total spend ----------------------------- 0.6135263442993164
generate_one_block  0.2481834888458252
generate_one_block  0.24759483337402344
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.032833099365234375
gen group dst list time:  0.006670236587524414
time for parepare:  0.019946813583374023
local_output_nid generation:  0.019047260284423828
local_in_edges_tensor generation:  0.034201622009277344
mini_batch_src_global generation:  0.0573117733001709
r_  generation:  0.5849251747131348
local_output_nid generation:  0.028737783432006836
local_in_edges_tensor generation:  0.03404068946838379
mini_batch_src_global generation:  0.06987643241882324
r_  generation:  0.5925774574279785
----------------------check_connections_block total spend ----------------------------- 1.6941719055175781
generate_one_block  0.7523744106292725
generate_one_block  0.7507143020629883
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028577804565429688
gen group dst list time:  0.012263774871826172
time for parepare:  0.018822431564331055
local_output_nid generation:  0.023804903030395508
local_in_edges_tensor generation:  0.03450751304626465
mini_batch_src_global generation:  0.05290508270263672
r_  generation:  0.5792381763458252
local_output_nid generation:  0.03316211700439453
local_in_edges_tensor generation:  0.04087328910827637
mini_batch_src_global generation:  0.06827759742736816
r_  generation:  0.5844175815582275
----------------------check_connections_block total spend ----------------------------- 1.7033822536468506
generate_one_block  0.7317719459533691
generate_one_block  0.7419250011444092
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17529821395874023  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.3975541591644287
block generation total time  2.976785659790039
average batch blocks generation time:  1.4883928298950195
block dataloader generation time/epoch 8.351314402543581
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12228727340698242  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3365826606750488  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12223196029663086  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3364839553833008  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08188450336456299 |0.018841862678527832 |0.003936648368835449 |0.0004968643188476562 |0.0023764371871948242 |0.0013964176177978516 |
----------------------------------------------------------pseudo_mini_loss sum 1.0431182384490967
Total (block generation + training)time/epoch 8.708513278227587
Training time/epoch 0.33217430114746094
Training time without block to device /epoch 0.2944905757904053
Training time without total dataloading part /epoch 0.015016317367553711
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 61.15it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.29it/s]100%|██████████| 4/4 [00:00<00:00, 15.60it/s]100%|██████████| 4/4 [00:00<00:00, 15.54it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.61it/s]100%|██████████| 4/4 [00:00<00:00, 17.69it/s]100%|██████████| 4/4 [00:00<00:00, 17.65it/s]
Run 00 | Epoch 00061 | Loss 1.0431 | Train 0.3389 | Val 0.3680 | Test 0.3544
Number of nodes during this epoch:  335687
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17531394958496094  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02006244659423828
range selection method range initialization spend 0.011615991592407227
time for parepare:  0.016985177993774414
local_output_nid generation:  0.011288881301879883
local_in_edges_tensor generation:  0.011496543884277344
mini_batch_src_global generation:  0.0173492431640625
r_  generation:  0.21015429496765137
local_output_nid generation:  0.011861801147460938
local_in_edges_tensor generation:  0.008580207824707031
mini_batch_src_global generation:  0.022566795349121094
r_  generation:  0.2298417091369629
----------------------check_connections_block total spend ----------------------------- 0.6273465156555176
generate_one_block  0.25580811500549316
generate_one_block  0.25371241569519043
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0434877872467041
gen group dst list time:  0.006612539291381836
time for parepare:  0.02068305015563965
local_output_nid generation:  0.017924785614013672
local_in_edges_tensor generation:  0.04045438766479492
mini_batch_src_global generation:  0.0570223331451416
r_  generation:  0.5909888744354248
local_output_nid generation:  0.028139591217041016
local_in_edges_tensor generation:  0.04099607467651367
mini_batch_src_global generation:  0.06739020347595215
r_  generation:  0.5956916809082031
----------------------check_connections_block total spend ----------------------------- 1.713578701019287
generate_one_block  0.7470247745513916
generate_one_block  0.7684831619262695
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030322551727294922
gen group dst list time:  0.012285232543945312
time for parepare:  0.018193483352661133
local_output_nid generation:  0.025376319885253906
local_in_edges_tensor generation:  0.038483381271362305
mini_batch_src_global generation:  0.05274176597595215
r_  generation:  0.5787670612335205
local_output_nid generation:  0.040262699127197266
local_in_edges_tensor generation:  0.03492283821105957
mini_batch_src_global generation:  0.0696725845336914
r_  generation:  0.5882549285888672
----------------------check_connections_block total spend ----------------------------- 1.7185521125793457
generate_one_block  0.7730011940002441
generate_one_block  0.7396073341369629
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17531394958496094  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.432130813598633
block generation total time  3.028116464614868
average batch blocks generation time:  1.514058232307434
block dataloader generation time/epoch 8.35164231174397
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12222909927368164  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.33644437789917  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12230634689331055  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3368744850158691  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0917433500289917 |0.027893900871276855 |0.004166364669799805 |0.0005044937133789062 |0.003911733627319336 |0.003026723861694336 |
----------------------------------------------------------pseudo_mini_loss sum 1.0412571430206299
Total (block generation + training)time/epoch 8.709061649610412
Training time/epoch 0.3687295913696289
Training time without block to device /epoch 0.3129417896270752
Training time without total dataloading part /epoch 0.02019190788269043
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 50.30it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.17it/s]100%|██████████| 4/4 [00:00<00:00, 15.55it/s]100%|██████████| 4/4 [00:00<00:00, 15.48it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.58it/s]100%|██████████| 4/4 [00:00<00:00, 17.62it/s]100%|██████████| 4/4 [00:00<00:00, 17.60it/s]
Run 00 | Epoch 00062 | Loss 1.0413 | Train 0.3373 | Val 0.3642 | Test 0.3501
Number of nodes during this epoch:  335725
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17537736892700195  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025239229202270508
range selection method range initialization spend 0.012183427810668945
time for parepare:  0.016495227813720703
local_output_nid generation:  0.011054515838623047
local_in_edges_tensor generation:  0.012319326400756836
mini_batch_src_global generation:  0.01715707778930664
r_  generation:  0.21093010902404785
local_output_nid generation:  0.011789321899414062
local_in_edges_tensor generation:  0.006748676300048828
mini_batch_src_global generation:  0.02193450927734375
r_  generation:  0.22645258903503418
----------------------check_connections_block total spend ----------------------------- 0.6190128326416016
generate_one_block  0.24413251876831055
generate_one_block  0.25454020500183105
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.034698486328125
gen group dst list time:  0.006624937057495117
time for parepare:  0.02193284034729004
local_output_nid generation:  0.019175291061401367
local_in_edges_tensor generation:  0.03912496566772461
mini_batch_src_global generation:  0.058261871337890625
r_  generation:  0.6015536785125732
local_output_nid generation:  0.030368566513061523
local_in_edges_tensor generation:  0.040728092193603516
mini_batch_src_global generation:  0.0698850154876709
r_  generation:  0.6387233734130859
----------------------check_connections_block total spend ----------------------------- 1.7828412055969238
generate_one_block  0.782459020614624
generate_one_block  0.775216817855835
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028202056884765625
gen group dst list time:  0.014656305313110352
time for parepare:  0.018114328384399414
local_output_nid generation:  0.023800373077392578
local_in_edges_tensor generation:  0.04866981506347656
mini_batch_src_global generation:  0.05580496788024902
r_  generation:  0.5780465602874756
local_output_nid generation:  0.03292274475097656
local_in_edges_tensor generation:  0.04043889045715332
mini_batch_src_global generation:  0.07076454162597656
r_  generation:  0.5871365070343018
----------------------check_connections_block total spend ----------------------------- 1.7235722541809082
generate_one_block  0.7505722045898438
generate_one_block  0.7639358043670654
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17537736892700195  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.506413459777832
block generation total time  3.072183847427368
average batch blocks generation time:  1.536091923713684
block dataloader generation time/epoch 8.354438649283516
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12222051620483398  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3364877700805664  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12230443954467773  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3365716934204102  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0888906717300415 |0.025623321533203125 |0.004207253456115723 |0.000506281852722168 |0.0033701658248901367 |0.0036029815673828125 |
----------------------------------------------------------pseudo_mini_loss sum 1.0412055253982544
Total (block generation + training)time/epoch 8.711954359655026
Training time/epoch 0.3624711036682129
Training time without block to device /epoch 0.31122446060180664
Training time without total dataloading part /epoch 0.019770383834838867
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 41.58it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.28it/s]100%|██████████| 4/4 [00:00<00:00, 15.13it/s]100%|██████████| 4/4 [00:00<00:00, 14.98it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.26it/s]100%|██████████| 4/4 [00:00<00:00, 17.85it/s]100%|██████████| 4/4 [00:00<00:00, 17.74it/s]
Run 00 | Epoch 00063 | Loss 1.0412 | Train 0.3354 | Val 0.3610 | Test 0.3464
Number of nodes during this epoch:  335665
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17544078826904297  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.030985593795776367
range selection method range initialization spend 0.012060403823852539
time for parepare:  0.01737809181213379
local_output_nid generation:  0.011001110076904297
local_in_edges_tensor generation:  0.018381118774414062
mini_batch_src_global generation:  0.01746964454650879
r_  generation:  0.20682573318481445
local_output_nid generation:  0.012017488479614258
local_in_edges_tensor generation:  0.008525371551513672
mini_batch_src_global generation:  0.021836042404174805
r_  generation:  0.22146344184875488
----------------------check_connections_block total spend ----------------------------- 0.6187889575958252
generate_one_block  0.24765491485595703
generate_one_block  0.24738788604736328
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03744316101074219
gen group dst list time:  0.006592988967895508
time for parepare:  0.020423173904418945
local_output_nid generation:  0.019366979598999023
local_in_edges_tensor generation:  0.034578561782836914
mini_batch_src_global generation:  0.057720184326171875
r_  generation:  0.5804564952850342
local_output_nid generation:  0.028827190399169922
local_in_edges_tensor generation:  0.040376901626586914
mini_batch_src_global generation:  0.07007312774658203
r_  generation:  0.6067259311676025
----------------------check_connections_block total spend ----------------------------- 1.7100768089294434
generate_one_block  0.7841262817382812
generate_one_block  0.7501003742218018
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028349876403808594
gen group dst list time:  0.01237177848815918
time for parepare:  0.01833510398864746
local_output_nid generation:  0.023494243621826172
local_in_edges_tensor generation:  0.03620171546936035
mini_batch_src_global generation:  0.053276777267456055
r_  generation:  0.5866856575012207
local_output_nid generation:  0.03536677360534668
local_in_edges_tensor generation:  0.03497433662414551
mini_batch_src_global generation:  0.06737947463989258
r_  generation:  0.5952281951904297
----------------------check_connections_block total spend ----------------------------- 1.7150726318359375
generate_one_block  0.7405974864959717
generate_one_block  0.741091251373291
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17544078826904297  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.425149440765381
block generation total time  3.0159153938293457
average batch blocks generation time:  1.5079576969146729
block dataloader generation time/epoch 8.354674668745561
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1222681999206543  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3365225791931152  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1222529411315918  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3366203308105469  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0934152603149414 |0.019682645797729492 |0.00404667854309082 |0.0005086660385131836 |0.0028793811798095703 |0.003014087677001953 |
----------------------------------------------------------pseudo_mini_loss sum 1.0347577333450317
Total (block generation + training)time/epoch 8.71213361566717
Training time/epoch 0.35428929328918457
Training time without block to device /epoch 0.3149240016937256
Training time without total dataloading part /epoch 0.0178835391998291
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 48.90it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 10.78it/s]100%|██████████| 4/4 [00:00<00:00, 12.22it/s]100%|██████████| 4/4 [00:00<00:00, 11.97it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.48it/s]100%|██████████| 4/4 [00:00<00:00, 17.54it/s]100%|██████████| 4/4 [00:00<00:00, 17.51it/s]
Run 00 | Epoch 00064 | Loss 1.0348 | Train 0.3332 | Val 0.3582 | Test 0.3434
Number of nodes during this epoch:  335705
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1753215789794922  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02167057991027832
range selection method range initialization spend 0.012036323547363281
time for parepare:  0.01738762855529785
local_output_nid generation:  0.011142492294311523
local_in_edges_tensor generation:  0.011136531829833984
mini_batch_src_global generation:  0.017661094665527344
r_  generation:  0.20677971839904785
local_output_nid generation:  0.011967658996582031
local_in_edges_tensor generation:  0.00950765609741211
mini_batch_src_global generation:  0.021843910217285156
r_  generation:  0.22200608253479004
----------------------check_connections_block total spend ----------------------------- 0.6141068935394287
generate_one_block  0.24730920791625977
generate_one_block  0.2516152858734131
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03639650344848633
gen group dst list time:  0.006503105163574219
time for parepare:  0.020078420639038086
local_output_nid generation:  0.01910543441772461
local_in_edges_tensor generation:  0.03178048133850098
mini_batch_src_global generation:  0.05570554733276367
r_  generation:  0.5917701721191406
local_output_nid generation:  0.028768301010131836
local_in_edges_tensor generation:  0.037204742431640625
mini_batch_src_global generation:  0.0679788589477539
r_  generation:  0.5943751335144043
----------------------check_connections_block total spend ----------------------------- 1.6994833946228027
generate_one_block  0.7585079669952393
generate_one_block  0.7582681179046631
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02653789520263672
gen group dst list time:  0.012342691421508789
time for parepare:  0.018362045288085938
local_output_nid generation:  0.0232698917388916
local_in_edges_tensor generation:  0.03667187690734863
mini_batch_src_global generation:  0.055681705474853516
r_  generation:  0.5793628692626953
local_output_nid generation:  0.034433603286743164
local_in_edges_tensor generation:  0.03778839111328125
mini_batch_src_global generation:  0.06773805618286133
r_  generation:  0.5896391868591309
----------------------check_connections_block total spend ----------------------------- 1.7116594314575195
generate_one_block  0.7418172359466553
generate_one_block  0.758692741394043
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1753215789794922  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.4111428260803223
block generation total time  3.0172860622406006
average batch blocks generation time:  1.5086430311203003
block dataloader generation time/epoch 8.354460639613015
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12226343154907227  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3364386558532715  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1222681999206543  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3365769386291504  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09198832511901855 |0.02482593059539795 |0.004032731056213379 |0.0004919767379760742 |0.004056692123413086 |0.0015690326690673828 |
----------------------------------------------------------pseudo_mini_loss sum 1.0300137996673584
Total (block generation + training)time/epoch 8.712043302399772
Training time/epoch 0.36428308486938477
Training time without block to device /epoch 0.31463122367858887
Training time without total dataloading part /epoch 0.01873183250427246
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 51.13it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.20it/s]100%|██████████| 4/4 [00:00<00:00, 13.60it/s]100%|██████████| 4/4 [00:00<00:00, 13.68it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.42it/s]100%|██████████| 4/4 [00:00<00:00, 17.19it/s]100%|██████████| 4/4 [00:00<00:00, 17.05it/s]
Run 00 | Epoch 00065 | Loss 1.0300 | Train 0.3318 | Val 0.3554 | Test 0.3405
Number of nodes during this epoch:  335623
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1753706932067871  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020592212677001953
range selection method range initialization spend 0.01190948486328125
time for parepare:  0.017544031143188477
local_output_nid generation:  0.011107444763183594
local_in_edges_tensor generation:  0.010892868041992188
mini_batch_src_global generation:  0.017699718475341797
r_  generation:  0.21013331413269043
local_output_nid generation:  0.011765241622924805
local_in_edges_tensor generation:  0.008532047271728516
mini_batch_src_global generation:  0.02292466163635254
r_  generation:  0.2229022979736328
----------------------check_connections_block total spend ----------------------------- 0.6181604862213135
generate_one_block  0.24771428108215332
generate_one_block  0.2509796619415283
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03296852111816406
gen group dst list time:  0.006601572036743164
time for parepare:  0.020689010620117188
local_output_nid generation:  0.018728017807006836
local_in_edges_tensor generation:  0.04033970832824707
mini_batch_src_global generation:  0.05914163589477539
r_  generation:  0.5858166217803955
local_output_nid generation:  0.028302431106567383
local_in_edges_tensor generation:  0.04006195068359375
mini_batch_src_global generation:  0.06833577156066895
r_  generation:  0.6010677814483643
----------------------check_connections_block total spend ----------------------------- 1.717315435409546
generate_one_block  0.7581195831298828
generate_one_block  0.7688813209533691
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025899410247802734
gen group dst list time:  0.012310504913330078
time for parepare:  0.01807856559753418
local_output_nid generation:  0.023287057876586914
local_in_edges_tensor generation:  0.03870391845703125
mini_batch_src_global generation:  0.05460691452026367
r_  generation:  0.5812833309173584
local_output_nid generation:  0.032375335693359375
local_in_edges_tensor generation:  0.04036664962768555
mini_batch_src_global generation:  0.0705409049987793
r_  generation:  0.5899662971496582
----------------------check_connections_block total spend ----------------------------- 1.7178521156311035
generate_one_block  0.7304184436798096
generate_one_block  0.7358672618865967
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1753706932067871  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.4351675510406494
block generation total time  2.993286609649658
average batch blocks generation time:  1.496643304824829
block dataloader generation time/epoch 8.354294856389364
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12227869033813477  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.336568832397461  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12225103378295898  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.336555004119873  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08977222442626953 |0.02127397060394287 |0.004092097282409668 |0.0004876852035522461 |0.0034890174865722656 |0.0017232894897460938 |
----------------------------------------------------------pseudo_mini_loss sum 1.0298571586608887
Total (block generation + training)time/epoch 8.71192241133305
Training time/epoch 0.36003613471984863
Training time without block to device /epoch 0.3174881935119629
Training time without total dataloading part /epoch 0.017860889434814453
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 55.23it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.80it/s]100%|██████████| 4/4 [00:00<00:00, 15.43it/s]100%|██████████| 4/4 [00:00<00:00, 15.32it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.03it/s]100%|██████████| 4/4 [00:00<00:00, 17.86it/s]100%|██████████| 4/4 [00:00<00:00, 17.86it/s]
Run 00 | Epoch 00066 | Loss 1.0299 | Train 0.3303 | Val 0.3519 | Test 0.3365
Number of nodes during this epoch:  335665
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17533016204833984  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02163076400756836
range selection method range initialization spend 0.011952638626098633
time for parepare:  0.017000198364257812
local_output_nid generation:  0.01128530502319336
local_in_edges_tensor generation:  0.009617805480957031
mini_batch_src_global generation:  0.017606019973754883
r_  generation:  0.2138059139251709
local_output_nid generation:  0.012052297592163086
local_in_edges_tensor generation:  0.008495569229125977
mini_batch_src_global generation:  0.021820783615112305
r_  generation:  0.22561120986938477
----------------------check_connections_block total spend ----------------------------- 0.6228299140930176
generate_one_block  0.24673724174499512
generate_one_block  0.24559950828552246
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03213214874267578
gen group dst list time:  0.006670475006103516
time for parepare:  0.02047896385192871
local_output_nid generation:  0.01904463768005371
local_in_edges_tensor generation:  0.03333115577697754
mini_batch_src_global generation:  0.057735443115234375
r_  generation:  0.5810763835906982
local_output_nid generation:  0.02861499786376953
local_in_edges_tensor generation:  0.03563237190246582
mini_batch_src_global generation:  0.06738972663879395
r_  generation:  0.6085777282714844
----------------------check_connections_block total spend ----------------------------- 1.713418960571289
generate_one_block  0.7673776149749756
generate_one_block  0.7727072238922119
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.026509523391723633
gen group dst list time:  0.014326810836791992
time for parepare:  0.01814103126525879
local_output_nid generation:  0.02332139015197754
local_in_edges_tensor generation:  0.04262804985046387
mini_batch_src_global generation:  0.05474090576171875
r_  generation:  0.5853958129882812
local_output_nid generation:  0.0331418514251709
local_in_edges_tensor generation:  0.04008150100708008
mini_batch_src_global generation:  0.06762242317199707
r_  generation:  0.5876920223236084
----------------------check_connections_block total spend ----------------------------- 1.72027587890625
generate_one_block  0.7327964305877686
generate_one_block  0.7475025653839111
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17533016204833984  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.433694839477539
block generation total time  3.020383834838867
average batch blocks generation time:  1.5101919174194336
block dataloader generation time/epoch 8.354050998030038
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12228059768676758  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3365097045898438  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12224817276000977  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3365869522094727  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08759355545043945 |0.020128369331359863 |0.004113316535949707 |0.0005174875259399414 |0.0030862092971801758 |0.0014758110046386719 |
----------------------------------------------------------pseudo_mini_loss sum 1.0248916149139404
Total (block generation + training)time/epoch 8.711550798909418
Training time/epoch 0.3500659465789795
Training time without block to device /epoch 0.30980920791625977
Training time without total dataloading part /epoch 0.01690983772277832
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 51.47it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.97it/s]100%|██████████| 4/4 [00:00<00:00, 15.50it/s]100%|██████████| 4/4 [00:00<00:00, 15.40it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.59it/s]100%|██████████| 4/4 [00:00<00:00, 17.61it/s]100%|██████████| 4/4 [00:00<00:00, 17.58it/s]
Run 00 | Epoch 00067 | Loss 1.0249 | Train 0.3287 | Val 0.3485 | Test 0.3325
Number of nodes during this epoch:  335654
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17530012130737305  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019692182540893555
range selection method range initialization spend 0.014785289764404297
time for parepare:  0.017375946044921875
local_output_nid generation:  0.011102437973022461
local_in_edges_tensor generation:  0.014320135116577148
mini_batch_src_global generation:  0.017670869827270508
r_  generation:  0.21089482307434082
local_output_nid generation:  0.01559305191040039
local_in_edges_tensor generation:  0.010767221450805664
mini_batch_src_global generation:  0.022867441177368164
r_  generation:  0.23087668418884277
----------------------check_connections_block total spend ----------------------------- 0.6376307010650635
generate_one_block  0.2534048557281494
generate_one_block  0.2503697872161865
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.037694454193115234
gen group dst list time:  0.006470680236816406
time for parepare:  0.02130413055419922
local_output_nid generation:  0.019037723541259766
local_in_edges_tensor generation:  0.04238271713256836
mini_batch_src_global generation:  0.05818796157836914
r_  generation:  0.5800297260284424
local_output_nid generation:  0.0296480655670166
local_in_edges_tensor generation:  0.04156684875488281
mini_batch_src_global generation:  0.06816673278808594
r_  generation:  0.5928642749786377
----------------------check_connections_block total spend ----------------------------- 1.7047240734100342
generate_one_block  0.7603211402893066
generate_one_block  0.7680051326751709
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02707076072692871
gen group dst list time:  0.01228642463684082
time for parepare:  0.018316030502319336
local_output_nid generation:  0.023079633712768555
local_in_edges_tensor generation:  0.041289567947387695
mini_batch_src_global generation:  0.05762290954589844
r_  generation:  0.5902016162872314
local_output_nid generation:  0.0326695442199707
local_in_edges_tensor generation:  0.03721308708190918
mini_batch_src_global generation:  0.06912374496459961
r_  generation:  0.5904426574707031
----------------------check_connections_block total spend ----------------------------- 1.7264940738677979
generate_one_block  0.7723071575164795
generate_one_block  0.7406611442565918
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17530012130737305  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.431218147277832
block generation total time  3.041294574737549
average batch blocks generation time:  1.5206472873687744
block dataloader generation time/epoch 8.355010602433802
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12228059768676758  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3366408348083496  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12224054336547852  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3364334106445312  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08856213092803955 |0.030846238136291504 |0.004102945327758789 |0.0004972219467163086 |0.0040209293365478516 |0.0014607906341552734 |
----------------------------------------------------------pseudo_mini_loss sum 1.0271693468093872
Total (block generation + training)time/epoch 8.712893696154579
Training time/epoch 0.3799598217010498
Training time without block to device /epoch 0.3182673454284668
Training time without total dataloading part /epoch 0.018702983856201172
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 53.37it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.13it/s]100%|██████████| 4/4 [00:00<00:00, 15.45it/s]100%|██████████| 4/4 [00:00<00:00, 15.39it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.47it/s]100%|██████████| 4/4 [00:00<00:00, 17.67it/s]100%|██████████| 4/4 [00:00<00:00, 17.62it/s]
Run 00 | Epoch 00068 | Loss 1.0272 | Train 0.3269 | Val 0.3446 | Test 0.3279
Number of nodes during this epoch:  335623
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17534399032592773  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026427268981933594
range selection method range initialization spend 0.011611461639404297
time for parepare:  0.017161130905151367
local_output_nid generation:  0.010923147201538086
local_in_edges_tensor generation:  0.010364770889282227
mini_batch_src_global generation:  0.018105268478393555
r_  generation:  0.2116551399230957
local_output_nid generation:  0.011896610260009766
local_in_edges_tensor generation:  0.006690263748168945
mini_batch_src_global generation:  0.02167201042175293
r_  generation:  0.22631621360778809
----------------------check_connections_block total spend ----------------------------- 0.6191515922546387
generate_one_block  0.251101016998291
generate_one_block  0.24863886833190918
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0319974422454834
gen group dst list time:  0.0065882205963134766
time for parepare:  0.020124197006225586
local_output_nid generation:  0.019083738327026367
local_in_edges_tensor generation:  0.03667950630187988
mini_batch_src_global generation:  0.05543375015258789
r_  generation:  0.5920653343200684
local_output_nid generation:  0.028979063034057617
local_in_edges_tensor generation:  0.032221317291259766
mini_batch_src_global generation:  0.0668785572052002
r_  generation:  0.6058032512664795
----------------------check_connections_block total spend ----------------------------- 1.7087123394012451
generate_one_block  0.7501723766326904
generate_one_block  0.7629082202911377
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02820277214050293
gen group dst list time:  0.012067794799804688
time for parepare:  0.01863884925842285
local_output_nid generation:  0.023479461669921875
local_in_edges_tensor generation:  0.0339808464050293
mini_batch_src_global generation:  0.052124977111816406
r_  generation:  0.578944206237793
local_output_nid generation:  0.03285527229309082
local_in_edges_tensor generation:  0.03669309616088867
mini_batch_src_global generation:  0.06765270233154297
r_  generation:  0.5929610729217529
----------------------check_connections_block total spend ----------------------------- 1.7047646045684814
generate_one_block  0.7326993942260742
generate_one_block  0.7370657920837402
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17534399032592773  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.4134769439697266
block generation total time  2.9828457832336426
average batch blocks generation time:  1.4914228916168213
block dataloader generation time/epoch 8.354203196366628
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12227106094360352  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3365492820739746  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12224149703979492  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3364481925964355  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08831000328063965 |0.019101262092590332 |0.005305767059326172 |0.0005320310592651367 |0.0027856826782226562 |0.0017521381378173828 |
----------------------------------------------------------pseudo_mini_loss sum 1.0194079875946045
Total (block generation + training)time/epoch 8.71195172071457
Training time/epoch 0.34971117973327637
Training time without block to device /epoch 0.3115086555480957
Training time without total dataloading part /epoch 0.018999099731445312
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 59.69it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.97it/s]100%|██████████| 4/4 [00:00<00:00, 15.42it/s]100%|██████████| 4/4 [00:00<00:00, 15.33it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.92it/s]100%|██████████| 4/4 [00:00<00:00, 17.18it/s]100%|██████████| 4/4 [00:00<00:00, 17.12it/s]
Run 00 | Epoch 00069 | Loss 1.0194 | Train 0.3245 | Val 0.3409 | Test 0.3237
Number of nodes during this epoch:  335647
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17534255981445312  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023805856704711914
range selection method range initialization spend 0.012002229690551758
time for parepare:  0.017310619354248047
local_output_nid generation:  0.011184930801391602
local_in_edges_tensor generation:  0.011207818984985352
mini_batch_src_global generation:  0.017872095108032227
r_  generation:  0.2101438045501709
local_output_nid generation:  0.01241755485534668
local_in_edges_tensor generation:  0.008417844772338867
mini_batch_src_global generation:  0.021845102310180664
r_  generation:  0.22276878356933594
----------------------check_connections_block total spend ----------------------------- 0.6171889305114746
generate_one_block  0.24672675132751465
generate_one_block  0.2492997646331787
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.033414602279663086
gen group dst list time:  0.006506204605102539
time for parepare:  0.019725322723388672
local_output_nid generation:  0.01935887336730957
local_in_edges_tensor generation:  0.03957629203796387
mini_batch_src_global generation:  0.05804729461669922
r_  generation:  0.5862760543823242
local_output_nid generation:  0.02975630760192871
local_in_edges_tensor generation:  0.04280233383178711
mini_batch_src_global generation:  0.06798124313354492
r_  generation:  0.59759521484375
----------------------check_connections_block total spend ----------------------------- 1.7148716449737549
generate_one_block  0.7476100921630859
generate_one_block  0.7537219524383545
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028629302978515625
gen group dst list time:  0.012024164199829102
time for parepare:  0.01854848861694336
local_output_nid generation:  0.024046897888183594
local_in_edges_tensor generation:  0.03436923027038574
mini_batch_src_global generation:  0.05282020568847656
r_  generation:  0.5758450031280518
local_output_nid generation:  0.03306078910827637
local_in_edges_tensor generation:  0.042554616928100586
mini_batch_src_global generation:  0.06766414642333984
r_  generation:  0.5825142860412598
----------------------check_connections_block total spend ----------------------------- 1.6990525722503662
generate_one_block  0.7334237098693848
generate_one_block  0.7515783309936523
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17534255981445312  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.413924217224121
block generation total time  2.9863340854644775
average batch blocks generation time:  1.4931670427322388
block dataloader generation time/epoch 8.353618328688574
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12226438522338867  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3366012573242188  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1222691535949707  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.336629867553711  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08601260185241699 |0.01950216293334961 |0.004082798957824707 |0.0005080699920654297 |0.0033189058303833008 |0.0017213821411132812 |
----------------------------------------------------------pseudo_mini_loss sum 1.021406888961792
Total (block generation + training)time/epoch 8.711106968707726
Training time/epoch 0.3417372703552246
Training time without block to device /epoch 0.3027329444885254
Training time without total dataloading part /epoch 0.017540931701660156
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 53.15it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.01it/s]100%|██████████| 4/4 [00:00<00:00, 15.41it/s]100%|██████████| 4/4 [00:00<00:00, 15.34it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.23it/s]100%|██████████| 4/4 [00:00<00:00, 17.35it/s]100%|██████████| 4/4 [00:00<00:00, 17.32it/s]
Run 00 | Epoch 00070 | Loss 1.0214 | Train 0.3215 | Val 0.3361 | Test 0.3173
Number of nodes during this epoch:  335689
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17533159255981445  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02427077293395996
range selection method range initialization spend 0.012061357498168945
time for parepare:  0.01728987693786621
local_output_nid generation:  0.011154651641845703
local_in_edges_tensor generation:  0.010597467422485352
mini_batch_src_global generation:  0.01768946647644043
r_  generation:  0.21688389778137207
local_output_nid generation:  0.012748479843139648
local_in_edges_tensor generation:  0.009669303894042969
mini_batch_src_global generation:  0.022193193435668945
r_  generation:  0.23189401626586914
----------------------check_connections_block total spend ----------------------------- 0.6477029323577881
generate_one_block  0.2472705841064453
generate_one_block  0.2508382797241211
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03791403770446777
gen group dst list time:  0.00662684440612793
time for parepare:  0.019969463348388672
local_output_nid generation:  0.01911163330078125
local_in_edges_tensor generation:  0.04013824462890625
mini_batch_src_global generation:  0.05784726142883301
r_  generation:  0.5868034362792969
local_output_nid generation:  0.02859640121459961
local_in_edges_tensor generation:  0.04101419448852539
mini_batch_src_global generation:  0.06680798530578613
r_  generation:  0.6050665378570557
----------------------check_connections_block total spend ----------------------------- 1.7168395519256592
generate_one_block  0.748598575592041
generate_one_block  0.7660071849822998
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02974557876586914
gen group dst list time:  0.012144088745117188
time for parepare:  0.018445968627929688
local_output_nid generation:  0.025469303131103516
local_in_edges_tensor generation:  0.0362391471862793
mini_batch_src_global generation:  0.05247378349304199
r_  generation:  0.5853073596954346
local_output_nid generation:  0.03389286994934082
local_in_edges_tensor generation:  0.0349881649017334
mini_batch_src_global generation:  0.06676864624023438
r_  generation:  0.5926833152770996
----------------------check_connections_block total spend ----------------------------- 1.7127492427825928
generate_one_block  0.7431004047393799
generate_one_block  0.7656669616699219
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17533159255981445  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.429588794708252
block generation total time  3.0233731269836426
average batch blocks generation time:  1.5116865634918213
block dataloader generation time/epoch 8.354577260632668
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12221956253051758  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3363637924194336  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12230539321899414  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3366904258728027  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09224534034729004 |0.03211402893066406 |0.004132390022277832 |0.0005285739898681641 |0.004039883613586426 |0.003286600112915039 |
----------------------------------------------------------pseudo_mini_loss sum 1.016525149345398
Total (block generation + training)time/epoch 8.712625007475577
Training time/epoch 0.3919949531555176
Training time without block to device /epoch 0.32776689529418945
Training time without total dataloading part /epoch 0.020688295364379883
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 56.70it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.26it/s]100%|██████████| 4/4 [00:00<00:00, 15.66it/s]100%|██████████| 4/4 [00:00<00:00, 15.59it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.45it/s]100%|██████████| 4/4 [00:00<00:00, 17.65it/s]100%|██████████| 4/4 [00:00<00:00, 17.60it/s]
Run 00 | Epoch 00071 | Loss 1.0165 | Train 0.3181 | Val 0.3298 | Test 0.3100
Number of nodes during this epoch:  335624
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17538976669311523  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020917177200317383
range selection method range initialization spend 0.011754512786865234
time for parepare:  0.01746344566345215
local_output_nid generation:  0.011103391647338867
local_in_edges_tensor generation:  0.011274576187133789
mini_batch_src_global generation:  0.017102479934692383
r_  generation:  0.20974111557006836
local_output_nid generation:  0.012917757034301758
local_in_edges_tensor generation:  0.009979963302612305
mini_batch_src_global generation:  0.021752595901489258
r_  generation:  0.2220447063446045
----------------------check_connections_block total spend ----------------------------- 0.6175510883331299
generate_one_block  0.2491142749786377
generate_one_block  0.2578444480895996
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.035874366760253906
gen group dst list time:  0.006537914276123047
time for parepare:  0.02266383171081543
local_output_nid generation:  0.0187227725982666
local_in_edges_tensor generation:  0.03753781318664551
mini_batch_src_global generation:  0.05972123146057129
r_  generation:  0.6043386459350586
local_output_nid generation:  0.030358314514160156
local_in_edges_tensor generation:  0.04056072235107422
mini_batch_src_global generation:  0.06966066360473633
r_  generation:  0.6213603019714355
----------------------check_connections_block total spend ----------------------------- 1.784461259841919
generate_one_block  0.7690246105194092
generate_one_block  0.7647190093994141
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030509471893310547
gen group dst list time:  0.013405561447143555
time for parepare:  0.017946958541870117
local_output_nid generation:  0.02368927001953125
local_in_edges_tensor generation:  0.04198408126831055
mini_batch_src_global generation:  0.05287766456604004
r_  generation:  0.5752007961273193
local_output_nid generation:  0.03335976600646973
local_in_edges_tensor generation:  0.04404616355895996
mini_batch_src_global generation:  0.0669562816619873
r_  generation:  0.5862522125244141
----------------------check_connections_block total spend ----------------------------- 1.7067265510559082
generate_one_block  0.7476241588592529
generate_one_block  0.7733016014099121
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17538976669311523  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.491187810897827
block generation total time  3.0546693801879883
average batch blocks generation time:  1.5273346900939941
block dataloader generation time/epoch 8.356388727823893
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12227201461791992  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.336735725402832  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12225961685180664  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3364849090576172  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.10155022144317627 |0.023465633392333984 |0.004089832305908203 |0.000507354736328125 |0.003918290138244629 |0.0014014244079589844 |
----------------------------------------------------------pseudo_mini_loss sum 1.0146613121032715
Total (block generation + training)time/epoch 8.714877824934701
Training time/epoch 0.3856947422027588
Training time without block to device /epoch 0.3387634754180908
Training time without total dataloading part /epoch 0.0184323787689209
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 42.34it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 13.80it/s]100%|██████████| 4/4 [00:00<00:00, 14.63it/s]100%|██████████| 4/4 [00:00<00:00, 14.48it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.52it/s]100%|██████████| 4/4 [00:00<00:00, 17.41it/s]100%|██████████| 4/4 [00:00<00:00, 17.41it/s]
Run 00 | Epoch 00072 | Loss 1.0147 | Train 0.3141 | Val 0.3233 | Test 0.3026
Number of nodes during this epoch:  335678
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17541265487670898  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024462223052978516
range selection method range initialization spend 0.011721134185791016
time for parepare:  0.017279386520385742
local_output_nid generation:  0.010889053344726562
local_in_edges_tensor generation:  0.01208043098449707
mini_batch_src_global generation:  0.017900466918945312
r_  generation:  0.20543241500854492
local_output_nid generation:  0.012025117874145508
local_in_edges_tensor generation:  0.008408069610595703
mini_batch_src_global generation:  0.021662235260009766
r_  generation:  0.2203540802001953
----------------------check_connections_block total spend ----------------------------- 0.609837532043457
generate_one_block  0.2489488124847412
generate_one_block  0.2470531463623047
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04110240936279297
gen group dst list time:  0.0065212249755859375
time for parepare:  0.020160675048828125
local_output_nid generation:  0.01862168312072754
local_in_edges_tensor generation:  0.03713417053222656
mini_batch_src_global generation:  0.05493307113647461
r_  generation:  0.5800914764404297
local_output_nid generation:  0.03049015998840332
local_in_edges_tensor generation:  0.03286552429199219
mini_batch_src_global generation:  0.07198095321655273
r_  generation:  0.5958261489868164
----------------------check_connections_block total spend ----------------------------- 1.694805383682251
generate_one_block  0.7594912052154541
generate_one_block  0.7641894817352295
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029512643814086914
gen group dst list time:  0.012273788452148438
time for parepare:  0.018671035766601562
local_output_nid generation:  0.02316451072692871
local_in_edges_tensor generation:  0.03447580337524414
mini_batch_src_global generation:  0.05486774444580078
r_  generation:  0.579099178314209
local_output_nid generation:  0.0344691276550293
local_in_edges_tensor generation:  0.03734707832336426
mini_batch_src_global generation:  0.07239508628845215
r_  generation:  0.5848448276519775
----------------------check_connections_block total spend ----------------------------- 1.7046258449554443
generate_one_block  0.7419779300689697
generate_one_block  0.747833251953125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17541265487670898  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.3994312286376953
block generation total time  3.0134918689727783
average batch blocks generation time:  1.5067459344863892
block dataloader generation time/epoch 8.356019757688046
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12224817276000977  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3321847915649414  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12228822708129883  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3368797302246094  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0892258882522583 |0.022812366485595703 |0.004001021385192871 |0.0005164146423339844 |0.04037797451019287 |0.0032699108123779297 |
----------------------------------------------------------pseudo_mini_loss sum 1.013124942779541
Total (block generation + training)time/epoch 8.714481610804796
Training time/epoch 0.35665011405944824
Training time without block to device /epoch 0.31102538108825684
Training time without total dataloading part /epoch 0.09306073188781738
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 58.15it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 13.93it/s]100%|██████████| 4/4 [00:00<00:00, 12.95it/s]100%|██████████| 4/4 [00:00<00:00, 13.08it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.34it/s]100%|██████████| 4/4 [00:00<00:00, 16.18it/s]100%|██████████| 4/4 [00:00<00:00, 16.33it/s]
Run 00 | Epoch 00073 | Loss 1.0131 | Train 0.3110 | Val 0.3162 | Test 0.2959
Number of nodes during this epoch:  335676
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1753387451171875  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02366161346435547
range selection method range initialization spend 0.012025594711303711
time for parepare:  0.018769025802612305
local_output_nid generation:  0.010870695114135742
local_in_edges_tensor generation:  0.018021821975708008
mini_batch_src_global generation:  0.017608642578125
r_  generation:  0.20780372619628906
local_output_nid generation:  0.011855840682983398
local_in_edges_tensor generation:  0.008361577987670898
mini_batch_src_global generation:  0.02237677574157715
r_  generation:  0.21799254417419434
----------------------check_connections_block total spend ----------------------------- 0.619926929473877
generate_one_block  0.2473618984222412
generate_one_block  0.25110483169555664
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03450942039489746
gen group dst list time:  0.006551027297973633
time for parepare:  0.03118753433227539
local_output_nid generation:  0.03500843048095703
local_in_edges_tensor generation:  0.04713940620422363
mini_batch_src_global generation:  0.05669760704040527
r_  generation:  0.6055722236633301
local_output_nid generation:  0.03360557556152344
local_in_edges_tensor generation:  0.040679931640625
mini_batch_src_global generation:  0.0689535140991211
r_  generation:  0.6128215789794922
----------------------check_connections_block total spend ----------------------------- 1.796147346496582
generate_one_block  0.8111898899078369
generate_one_block  0.77581787109375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03285551071166992
gen group dst list time:  0.014516592025756836
time for parepare:  0.0178530216217041
local_output_nid generation:  0.02361750602722168
local_in_edges_tensor generation:  0.04510498046875
mini_batch_src_global generation:  0.057977914810180664
r_  generation:  0.6181697845458984
local_output_nid generation:  0.032979488372802734
local_in_edges_tensor generation:  0.04320120811462402
mini_batch_src_global generation:  0.06941080093383789
r_  generation:  0.59403395652771
----------------------check_connections_block total spend ----------------------------- 1.7797203063964844
generate_one_block  0.7682902812957764
generate_one_block  0.7420542240142822
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1753387451171875  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.5758676528930664
block generation total time  3.0973522663116455
average batch blocks generation time:  1.5486761331558228
block dataloader generation time/epoch 8.359583025712233
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12232351303100586  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3367886543273926  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1222233772277832  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.336413860321045  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09108531475067139 |0.027507781982421875 |0.004312634468078613 |0.0005238056182861328 |0.0035442113876342773 |0.001979351043701172 |
----------------------------------------------------------pseudo_mini_loss sum 1.0069688558578491
Total (block generation + training)time/epoch 8.718238654503455
Training time/epoch 0.37090229988098145
Training time without block to device /epoch 0.3158867359161377
Training time without total dataloading part /epoch 0.01874065399169922
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 52.44it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.97it/s]100%|██████████| 4/4 [00:00<00:00, 15.23it/s]100%|██████████| 4/4 [00:00<00:00, 15.18it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.78it/s]100%|██████████| 4/4 [00:00<00:00, 17.22it/s]100%|██████████| 4/4 [00:00<00:00, 17.14it/s]
Run 00 | Epoch 00074 | Loss 1.0070 | Train 0.3088 | Val 0.3091 | Test 0.2884
Number of nodes during this epoch:  335672
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17533636093139648  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024725914001464844
range selection method range initialization spend 0.012144327163696289
time for parepare:  0.01694035530090332
local_output_nid generation:  0.011260986328125
local_in_edges_tensor generation:  0.012257099151611328
mini_batch_src_global generation:  0.018139362335205078
r_  generation:  0.20780014991760254
local_output_nid generation:  0.012229681015014648
local_in_edges_tensor generation:  0.00789499282836914
mini_batch_src_global generation:  0.023271799087524414
r_  generation:  0.22493934631347656
----------------------check_connections_block total spend ----------------------------- 0.6216325759887695
generate_one_block  0.2545468807220459
generate_one_block  0.25145936012268066
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.037590742111206055
gen group dst list time:  0.0065610408782958984
time for parepare:  0.02004528045654297
local_output_nid generation:  0.019731521606445312
local_in_edges_tensor generation:  0.03491520881652832
mini_batch_src_global generation:  0.055152177810668945
r_  generation:  0.598029375076294
local_output_nid generation:  0.029224157333374023
local_in_edges_tensor generation:  0.03391313552856445
mini_batch_src_global generation:  0.06846237182617188
r_  generation:  0.6065757274627686
----------------------check_connections_block total spend ----------------------------- 1.719935655593872
generate_one_block  0.7552471160888672
generate_one_block  0.7616126537322998
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03301668167114258
gen group dst list time:  0.012998580932617188
time for parepare:  0.018321514129638672
local_output_nid generation:  0.023756980895996094
local_in_edges_tensor generation:  0.0393831729888916
mini_batch_src_global generation:  0.05645322799682617
r_  generation:  0.5873668193817139
local_output_nid generation:  0.03269767761230469
local_in_edges_tensor generation:  0.048024892807006836
mini_batch_src_global generation:  0.07175946235656738
r_  generation:  0.6050479412078857
----------------------check_connections_block total spend ----------------------------- 1.755948543548584
generate_one_block  0.7518558502197266
generate_one_block  0.7478573322296143
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17533636093139648  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.475884199142456
block generation total time  3.016572952270508
average batch blocks generation time:  1.508286476135254
block dataloader generation time/epoch 8.360796516591853
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12224149703979492  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3364200592041016  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12229585647583008  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3366804122924805  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08330488204956055 |0.029147624969482422 |0.004027962684631348 |0.0005172491073608398 |0.003901362419128418 |0.002941131591796875 |
----------------------------------------------------------pseudo_mini_loss sum 1.0076196193695068
Total (block generation + training)time/epoch 8.719384601621917
Training time/epoch 0.35405564308166504
Training time without block to device /epoch 0.2957603931427002
Training time without total dataloading part /epoch 0.019834280014038086
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 51.43it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.76it/s]100%|██████████| 4/4 [00:00<00:00, 15.15it/s]100%|██████████| 4/4 [00:00<00:00, 15.08it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.29it/s]100%|██████████| 4/4 [00:00<00:00, 17.58it/s]100%|██████████| 4/4 [00:00<00:00, 17.51it/s]
Run 00 | Epoch 00075 | Loss 1.0076 | Train 0.3063 | Val 0.3021 | Test 0.2806
Number of nodes during this epoch:  335678
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1753702163696289  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025270938873291016
range selection method range initialization spend 0.011670351028442383
time for parepare:  0.018117666244506836
local_output_nid generation:  0.011049270629882812
local_in_edges_tensor generation:  0.013195514678955078
mini_batch_src_global generation:  0.017485380172729492
r_  generation:  0.20852947235107422
local_output_nid generation:  0.012203693389892578
local_in_edges_tensor generation:  0.007604122161865234
mini_batch_src_global generation:  0.02227497100830078
r_  generation:  0.22295093536376953
----------------------check_connections_block total spend ----------------------------- 0.621657133102417
generate_one_block  0.2543931007385254
generate_one_block  0.2491297721862793
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.032988786697387695
gen group dst list time:  0.006646871566772461
time for parepare:  0.02016425132751465
local_output_nid generation:  0.0189971923828125
local_in_edges_tensor generation:  0.034577131271362305
mini_batch_src_global generation:  0.05629706382751465
r_  generation:  0.579941987991333
local_output_nid generation:  0.028641700744628906
local_in_edges_tensor generation:  0.031757354736328125
mini_batch_src_global generation:  0.06762862205505371
r_  generation:  0.5956974029541016
----------------------check_connections_block total spend ----------------------------- 1.6927659511566162
generate_one_block  0.753648042678833
generate_one_block  0.7537627220153809
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028470754623413086
gen group dst list time:  0.012310266494750977
time for parepare:  0.018392562866210938
local_output_nid generation:  0.022896289825439453
local_in_edges_tensor generation:  0.04403257369995117
mini_batch_src_global generation:  0.054517507553100586
r_  generation:  0.5733251571655273
local_output_nid generation:  0.03253006935119629
local_in_edges_tensor generation:  0.03433847427368164
mini_batch_src_global generation:  0.06852269172668457
r_  generation:  0.5827088356018066
----------------------check_connections_block total spend ----------------------------- 1.7001938819885254
generate_one_block  0.7271316051483154
generate_one_block  0.7329747676849365
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1753702163696289  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.3929598331451416
block generation total time  2.967517137527466
average batch blocks generation time:  1.483758568763733
block dataloader generation time/epoch 8.359570859083489
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12225008010864258  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3364715576171875  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12229108810424805  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3367705345153809  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0824819803237915 |0.01938498020172119 |0.003917694091796875 |0.0005013942718505859 |0.003047347068786621 |0.0013844966888427734 |
----------------------------------------------------------pseudo_mini_loss sum 1.0010403394699097
Total (block generation + training)time/epoch 8.717832188108074
Training time/epoch 0.3365955352783203
Training time without block to device /epoch 0.29782557487487793
Training time without total dataloading part /epoch 0.016317367553710938
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 65.16it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.00it/s]100%|██████████| 4/4 [00:00<00:00, 16.46it/s]100%|██████████| 4/4 [00:00<00:00, 16.21it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.14it/s]100%|██████████| 4/4 [00:00<00:00, 18.70it/s]
Run 00 | Epoch 00076 | Loss 1.0010 | Train 0.3034 | Val 0.2951 | Test 0.2730
Number of nodes during this epoch:  335686
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17534446716308594  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021910905838012695
range selection method range initialization spend 0.011951684951782227
time for parepare:  0.016402006149291992
local_output_nid generation:  0.01122140884399414
local_in_edges_tensor generation:  0.009395837783813477
mini_batch_src_global generation:  0.017750024795532227
r_  generation:  0.2110288143157959
local_output_nid generation:  0.011996269226074219
local_in_edges_tensor generation:  0.007472991943359375
mini_batch_src_global generation:  0.02365875244140625
r_  generation:  0.2213292121887207
----------------------check_connections_block total spend ----------------------------- 0.6153638362884521
generate_one_block  0.24819326400756836
generate_one_block  0.253115177154541
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03742694854736328
gen group dst list time:  0.0065228939056396484
time for parepare:  0.02047896385192871
local_output_nid generation:  0.01954483985900879
local_in_edges_tensor generation:  0.03389310836791992
mini_batch_src_global generation:  0.05883502960205078
r_  generation:  0.5883758068084717
local_output_nid generation:  0.028861284255981445
local_in_edges_tensor generation:  0.030106306076049805
mini_batch_src_global generation:  0.06806349754333496
r_  generation:  0.5996763706207275
----------------------check_connections_block total spend ----------------------------- 1.703129529953003
generate_one_block  0.7578823566436768
generate_one_block  0.768399715423584
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029735326766967773
gen group dst list time:  0.012556076049804688
time for parepare:  0.018245220184326172
local_output_nid generation:  0.024151086807250977
local_in_edges_tensor generation:  0.040244102478027344
mini_batch_src_global generation:  0.05440807342529297
r_  generation:  0.5867369174957275
local_output_nid generation:  0.03271913528442383
local_in_edges_tensor generation:  0.049918413162231445
mini_batch_src_global generation:  0.06902098655700684
r_  generation:  0.6034443378448486
----------------------check_connections_block total spend ----------------------------- 1.747326135635376
generate_one_block  0.7377040386199951
generate_one_block  0.7350358963012695
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17534446716308594  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.450455665588379
block generation total time  2.9990220069885254
average batch blocks generation time:  1.4995110034942627
block dataloader generation time/epoch 8.359250752364888
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12230634689331055  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3366880416870117  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12221860885620117  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3363761901855469  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08487486839294434 |0.026256442070007324 |0.004273533821105957 |0.0005298852920532227 |0.0033022165298461914 |0.003101825714111328 |
----------------------------------------------------------pseudo_mini_loss sum 0.9989508986473083
Total (block generation + training)time/epoch 8.717463952653548
Training time/epoch 0.35484886169433594
Training time without block to device /epoch 0.3023359775543213
Training time without total dataloading part /epoch 0.01931309700012207
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 54.10it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.73it/s]100%|██████████| 4/4 [00:00<00:00, 15.15it/s]100%|██████████| 4/4 [00:00<00:00, 15.07it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.16it/s]100%|██████████| 4/4 [00:00<00:00, 17.55it/s]100%|██████████| 4/4 [00:00<00:00, 17.47it/s]
Run 00 | Epoch 00077 | Loss 0.9990 | Train 0.2996 | Val 0.2869 | Test 0.2654
Number of nodes during this epoch:  335696
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1753368377685547  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025467395782470703
range selection method range initialization spend 0.01169729232788086
time for parepare:  0.01671004295349121
local_output_nid generation:  0.011000871658325195
local_in_edges_tensor generation:  0.010382890701293945
mini_batch_src_global generation:  0.018694162368774414
r_  generation:  0.21123743057250977
local_output_nid generation:  0.012007951736450195
local_in_edges_tensor generation:  0.006766319274902344
mini_batch_src_global generation:  0.024989604949951172
r_  generation:  0.2254490852355957
----------------------check_connections_block total spend ----------------------------- 0.6224441528320312
generate_one_block  0.2587320804595947
generate_one_block  0.2501695156097412
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03734755516052246
gen group dst list time:  0.006407976150512695
time for parepare:  0.020128726959228516
local_output_nid generation:  0.020059823989868164
local_in_edges_tensor generation:  0.03806042671203613
mini_batch_src_global generation:  0.0597681999206543
r_  generation:  0.5971612930297852
local_output_nid generation:  0.03302145004272461
local_in_edges_tensor generation:  0.04714083671569824
mini_batch_src_global generation:  0.07783055305480957
r_  generation:  0.6131508350372314
----------------------check_connections_block total spend ----------------------------- 1.7840993404388428
generate_one_block  0.7592976093292236
generate_one_block  0.7591583728790283
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03513145446777344
gen group dst list time:  0.013245582580566406
time for parepare:  0.0182497501373291
local_output_nid generation:  0.0230562686920166
local_in_edges_tensor generation:  0.0529782772064209
mini_batch_src_global generation:  0.05476188659667969
r_  generation:  0.5805315971374512
local_output_nid generation:  0.033072710037231445
local_in_edges_tensor generation:  0.03458666801452637
mini_batch_src_global generation:  0.06878352165222168
r_  generation:  0.5839138031005859
----------------------check_connections_block total spend ----------------------------- 1.715404748916626
generate_one_block  0.7299163341522217
generate_one_block  0.7612926959991455
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1753368377685547  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.4995040893554688
block generation total time  3.009665012359619
average batch blocks generation time:  1.5048325061798096
block dataloader generation time/epoch 8.360421733579773
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12230730056762695  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.33677339553833  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12221956253051758  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3363752365112305  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09165191650390625 |0.0228806734085083 |0.004158377647399902 |0.0005023479461669922 |0.003342270851135254 |0.0019533634185791016 |
----------------------------------------------------------pseudo_mini_loss sum 0.9993705153465271
Total (block generation + training)time/epoch 8.718780424283898
Training time/epoch 0.36809468269348145
Training time without block to device /epoch 0.32233333587646484
Training time without total dataloading part /epoch 0.0179593563079834
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 63.82it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.02it/s]100%|██████████| 4/4 [00:00<00:00, 15.21it/s]100%|██████████| 4/4 [00:00<00:00, 15.17it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.42it/s]100%|██████████| 4/4 [00:00<00:00, 17.02it/s]100%|██████████| 4/4 [00:00<00:00, 16.91it/s]
Run 00 | Epoch 00078 | Loss 0.9994 | Train 0.2967 | Val 0.2815 | Test 0.2594
Number of nodes during this epoch:  335670
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17533445358276367  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024493694305419922
range selection method range initialization spend 0.012459039688110352
time for parepare:  0.018010616302490234
local_output_nid generation:  0.01111602783203125
local_in_edges_tensor generation:  0.012019634246826172
mini_batch_src_global generation:  0.017273664474487305
r_  generation:  0.2130870819091797
local_output_nid generation:  0.012584209442138672
local_in_edges_tensor generation:  0.008439302444458008
mini_batch_src_global generation:  0.025061607360839844
r_  generation:  0.2259979248046875
----------------------check_connections_block total spend ----------------------------- 0.6305830478668213
generate_one_block  0.2507925033569336
generate_one_block  0.25358057022094727
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04367852210998535
gen group dst list time:  0.006433963775634766
time for parepare:  0.02043938636779785
local_output_nid generation:  0.018884658813476562
local_in_edges_tensor generation:  0.04074811935424805
mini_batch_src_global generation:  0.056610822677612305
r_  generation:  0.5836062431335449
local_output_nid generation:  0.029089927673339844
local_in_edges_tensor generation:  0.04177594184875488
mini_batch_src_global generation:  0.06789541244506836
r_  generation:  0.5988047122955322
----------------------check_connections_block total spend ----------------------------- 1.7118899822235107
generate_one_block  0.7511990070343018
generate_one_block  0.7636880874633789
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029160022735595703
gen group dst list time:  0.012250185012817383
time for parepare:  0.018691062927246094
local_output_nid generation:  0.02339625358581543
local_in_edges_tensor generation:  0.040262699127197266
mini_batch_src_global generation:  0.054692745208740234
r_  generation:  0.5768966674804688
local_output_nid generation:  0.03284335136413574
local_in_edges_tensor generation:  0.03548383712768555
mini_batch_src_global generation:  0.0680241584777832
r_  generation:  0.582707405090332
----------------------check_connections_block total spend ----------------------------- 1.6987535953521729
generate_one_block  0.7355372905731201
generate_one_block  0.7426083087921143
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17533445358276367  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.4106435775756836
block generation total time  2.993032693862915
average batch blocks generation time:  1.4965163469314575
block dataloader generation time/epoch 8.360615284102304
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1222538948059082  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.336623191833496  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12227678298950195  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3365850448608398  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09079885482788086 |0.018602728843688965 |0.0041457414627075195 |0.00051116943359375 |0.003185749053955078 |0.0019986629486083984 |
----------------------------------------------------------pseudo_mini_loss sum 0.9978389739990234
Total (block generation + training)time/epoch 8.71887594972338
Training time/epoch 0.35133981704711914
Training time without block to device /epoch 0.3141343593597412
Training time without total dataloading part /epoch 0.017683982849121094
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 57.47it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.12it/s]100%|██████████| 4/4 [00:00<00:00, 15.10it/s]100%|██████████| 4/4 [00:00<00:00, 15.09it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.20it/s]100%|██████████| 4/4 [00:00<00:00, 17.40it/s]100%|██████████| 4/4 [00:00<00:00, 17.35it/s]
Run 00 | Epoch 00079 | Loss 0.9978 | Train 0.2936 | Val 0.2741 | Test 0.2530
Number of nodes during this epoch:  335719
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17538881301879883  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021173477172851562
range selection method range initialization spend 0.011998414993286133
time for parepare:  0.016428709030151367
local_output_nid generation:  0.010962486267089844
local_in_edges_tensor generation:  0.009541988372802734
mini_batch_src_global generation:  0.01780557632446289
r_  generation:  0.20734739303588867
local_output_nid generation:  0.012047529220581055
local_in_edges_tensor generation:  0.007564544677734375
mini_batch_src_global generation:  0.022274494171142578
r_  generation:  0.22046613693237305
----------------------check_connections_block total spend ----------------------------- 0.6087188720703125
generate_one_block  0.24887871742248535
generate_one_block  0.24828052520751953
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.033997297286987305
gen group dst list time:  0.006479978561401367
time for parepare:  0.020415782928466797
local_output_nid generation:  0.018767833709716797
local_in_edges_tensor generation:  0.03581666946411133
mini_batch_src_global generation:  0.056369781494140625
r_  generation:  0.5896046161651611
local_output_nid generation:  0.02926945686340332
local_in_edges_tensor generation:  0.03313899040222168
mini_batch_src_global generation:  0.0682532787322998
r_  generation:  0.601163387298584
----------------------check_connections_block total spend ----------------------------- 1.7076177597045898
generate_one_block  0.7758753299713135
generate_one_block  0.7676999568939209
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03995871543884277
gen group dst list time:  0.013717174530029297
time for parepare:  0.017958402633666992
local_output_nid generation:  0.02375340461730957
local_in_edges_tensor generation:  0.04181170463562012
mini_batch_src_global generation:  0.05756235122680664
r_  generation:  0.5947005748748779
local_output_nid generation:  0.03507256507873535
local_in_edges_tensor generation:  0.03935742378234863
mini_batch_src_global generation:  0.06811642646789551
r_  generation:  0.5869550704956055
----------------------check_connections_block total spend ----------------------------- 1.733098030090332
generate_one_block  0.7296061515808105
generate_one_block  0.7366859912872314
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17538881301879883  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.440715789794922
block generation total time  3.0098674297332764
average batch blocks generation time:  1.5049337148666382
block dataloader generation time/epoch 8.360499650659696
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12228822708129883  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3365840911865234  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12223196029663086  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3364715576171875  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08430957794189453 |0.02664053440093994 |0.003993391990661621 |0.0005189180374145508 |0.003972053527832031 |0.0017244815826416016 |
----------------------------------------------------------pseudo_mini_loss sum 0.9929741621017456
Total (block generation + training)time/epoch 8.718734982987526
Training time/epoch 0.3563241958618164
Training time without block to device /epoch 0.3030431270599365
Training time without total dataloading part /epoch 0.018693208694458008
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 53.51it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.85it/s]100%|██████████| 4/4 [00:00<00:00, 15.31it/s]100%|██████████| 4/4 [00:00<00:00, 15.23it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.09it/s]100%|██████████| 4/4 [00:00<00:00, 17.13it/s]100%|██████████| 4/4 [00:00<00:00, 17.10it/s]
Run 00 | Epoch 00080 | Loss 0.9930 | Train 0.2907 | Val 0.2672 | Test 0.2462
Number of nodes during this epoch:  335689
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17531967163085938  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022876977920532227
range selection method range initialization spend 0.011615276336669922
time for parepare:  0.016681432723999023
local_output_nid generation:  0.010960817337036133
local_in_edges_tensor generation:  0.00976419448852539
mini_batch_src_global generation:  0.01769089698791504
r_  generation:  0.2060997486114502
local_output_nid generation:  0.011838436126708984
local_in_edges_tensor generation:  0.007585287094116211
mini_batch_src_global generation:  0.02294135093688965
r_  generation:  0.21915912628173828
----------------------check_connections_block total spend ----------------------------- 0.6079046726226807
generate_one_block  0.24485349655151367
generate_one_block  0.2493748664855957
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03433680534362793
gen group dst list time:  0.006534099578857422
time for parepare:  0.020253896713256836
local_output_nid generation:  0.018254756927490234
local_in_edges_tensor generation:  0.031678199768066406
mini_batch_src_global generation:  0.06163787841796875
r_  generation:  0.591660737991333
local_output_nid generation:  0.029445409774780273
local_in_edges_tensor generation:  0.04021620750427246
mini_batch_src_global generation:  0.07319307327270508
r_  generation:  0.62253737449646
----------------------check_connections_block total spend ----------------------------- 1.7485299110412598
generate_one_block  0.7689223289489746
generate_one_block  0.7537453174591064
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029047727584838867
gen group dst list time:  0.012245893478393555
time for parepare:  0.01816534996032715
local_output_nid generation:  0.022377729415893555
local_in_edges_tensor generation:  0.03695249557495117
mini_batch_src_global generation:  0.05517411231994629
r_  generation:  0.57663893699646
local_output_nid generation:  0.033951520919799805
local_in_edges_tensor generation:  0.03207135200500488
mini_batch_src_global generation:  0.06807398796081543
r_  generation:  0.5861475467681885
----------------------check_connections_block total spend ----------------------------- 1.6952424049377441
generate_one_block  0.7278954982757568
generate_one_block  0.7395260334014893
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17531967163085938  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.443772315979004
block generation total time  2.990089178085327
average batch blocks generation time:  1.4950445890426636
block dataloader generation time/epoch 8.360003663433922
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12226629257202148  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3364739418029785  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12227201461791992  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3366413116455078  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08707118034362793 |0.0191347599029541 |0.004015326499938965 |0.0005072355270385742 |0.0032579898834228516 |0.0016484260559082031 |
----------------------------------------------------------pseudo_mini_loss sum 0.9940565824508667
Total (block generation + training)time/epoch 8.718167152669695
Training time/epoch 0.35295653343200684
Training time without block to device /epoch 0.31468701362609863
Training time without total dataloading part /epoch 0.017209529876708984
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 61.21it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.08it/s]100%|██████████| 4/4 [00:00<00:00, 15.41it/s]100%|██████████| 4/4 [00:00<00:00, 15.34it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.59it/s]100%|██████████| 4/4 [00:00<00:00, 17.60it/s]100%|██████████| 4/4 [00:00<00:00, 17.58it/s]
Run 00 | Epoch 00081 | Loss 0.9941 | Train 0.2882 | Val 0.2615 | Test 0.2394
Number of nodes during this epoch:  335642
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17532825469970703  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022987842559814453
range selection method range initialization spend 0.011853933334350586
time for parepare:  0.016841650009155273
local_output_nid generation:  0.0111846923828125
local_in_edges_tensor generation:  0.010592222213745117
mini_batch_src_global generation:  0.017760515213012695
r_  generation:  0.21363282203674316
local_output_nid generation:  0.012160539627075195
local_in_edges_tensor generation:  0.006867408752441406
mini_batch_src_global generation:  0.022170305252075195
r_  generation:  0.22849082946777344
----------------------check_connections_block total spend ----------------------------- 0.6255574226379395
generate_one_block  0.24832606315612793
generate_one_block  0.24654769897460938
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0323948860168457
gen group dst list time:  0.0064394474029541016
time for parepare:  0.020006179809570312
local_output_nid generation:  0.018916606903076172
local_in_edges_tensor generation:  0.0311586856842041
mini_batch_src_global generation:  0.05605340003967285
r_  generation:  0.5991387367248535
local_output_nid generation:  0.02895975112915039
local_in_edges_tensor generation:  0.03184103965759277
mini_batch_src_global generation:  0.06933712959289551
r_  generation:  0.6424314975738525
----------------------check_connections_block total spend ----------------------------- 1.7660338878631592
generate_one_block  0.77579665184021
generate_one_block  0.7747609615325928
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03689169883728027
gen group dst list time:  0.013288259506225586
time for parepare:  0.018067359924316406
local_output_nid generation:  0.023218154907226562
local_in_edges_tensor generation:  0.04827070236206055
mini_batch_src_global generation:  0.05591535568237305
r_  generation:  0.5861425399780273
local_output_nid generation:  0.03245687484741211
local_in_edges_tensor generation:  0.03270530700683594
mini_batch_src_global generation:  0.07052016258239746
r_  generation:  0.589879035949707
----------------------check_connections_block total spend ----------------------------- 1.7274303436279297
generate_one_block  0.7451791763305664
generate_one_block  0.7529416084289551
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17532825469970703  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.493464231491089
block generation total time  3.048678398132324
average batch blocks generation time:  1.524339199066162
block dataloader generation time/epoch 8.36097512179858
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12225198745727539  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.336573600769043  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12226533889770508  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3364801406860352  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08910644054412842 |0.028722643852233887 |0.004103183746337891 |0.0005030632019042969 |0.003914237022399902 |0.001506805419921875 |
----------------------------------------------------------pseudo_mini_loss sum 0.9906792640686035
Total (block generation + training)time/epoch 8.719270774762924
Training time/epoch 0.36765217781066895
Training time without block to device /epoch 0.31020689010620117
Training time without total dataloading part /epoch 0.018547773361206055
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 51.07it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.27it/s]100%|██████████| 4/4 [00:00<00:00, 15.51it/s]100%|██████████| 4/4 [00:00<00:00, 15.46it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.67it/s]100%|██████████| 4/4 [00:00<00:00, 17.63it/s]100%|██████████| 4/4 [00:00<00:00, 17.62it/s]
Run 00 | Epoch 00082 | Loss 0.9907 | Train 0.2856 | Val 0.2557 | Test 0.2344
Number of nodes during this epoch:  335700
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17540359497070312  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0236208438873291
range selection method range initialization spend 0.011869192123413086
time for parepare:  0.018544912338256836
local_output_nid generation:  0.010967016220092773
local_in_edges_tensor generation:  0.012845039367675781
mini_batch_src_global generation:  0.017833471298217773
r_  generation:  0.2061021327972412
local_output_nid generation:  0.011869430541992188
local_in_edges_tensor generation:  0.009109973907470703
mini_batch_src_global generation:  0.022826433181762695
r_  generation:  0.22031855583190918
----------------------check_connections_block total spend ----------------------------- 0.6156222820281982
generate_one_block  0.24599575996398926
generate_one_block  0.24955415725708008
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03663802146911621
gen group dst list time:  0.0064411163330078125
time for parepare:  0.020485877990722656
local_output_nid generation:  0.019682645797729492
local_in_edges_tensor generation:  0.04054450988769531
mini_batch_src_global generation:  0.05682682991027832
r_  generation:  0.580040454864502
local_output_nid generation:  0.029280900955200195
local_in_edges_tensor generation:  0.03590512275695801
mini_batch_src_global generation:  0.0826723575592041
r_  generation:  0.5963525772094727
----------------------check_connections_block total spend ----------------------------- 1.7142648696899414
generate_one_block  0.7526004314422607
generate_one_block  0.7558190822601318
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029439687728881836
gen group dst list time:  0.01228475570678711
time for parepare:  0.018695831298828125
local_output_nid generation:  0.02372455596923828
local_in_edges_tensor generation:  0.03801727294921875
mini_batch_src_global generation:  0.05668783187866211
r_  generation:  0.5948302745819092
local_output_nid generation:  0.033048391342163086
local_in_edges_tensor generation:  0.037563323974609375
mini_batch_src_global generation:  0.06836676597595215
r_  generation:  0.6197528839111328
----------------------check_connections_block total spend ----------------------------- 1.7568342685699463
generate_one_block  0.7303471565246582
generate_one_block  0.7349023818969727
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17540359497070312  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.4710991382598877
block generation total time  2.9736690521240234
average batch blocks generation time:  1.4868345260620117
block dataloader generation time/epoch 8.361042367445457
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12227201461791992  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.336606502532959  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12224817276000977  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3365287780761719  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0838463306427002 |0.019100189208984375 |0.003919243812561035 |0.0005153417587280273 |0.002947092056274414 |0.0016927719116210938 |
----------------------------------------------------------pseudo_mini_loss sum 0.9882327318191528
Total (block generation + training)time/epoch 8.719148107477137
Training time/epoch 0.3441331386566162
Training time without block to device /epoch 0.30593276023864746
Training time without total dataloading part /epoch 0.016456127166748047
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 56.50it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.09it/s]100%|██████████| 4/4 [00:00<00:00, 15.22it/s]100%|██████████| 4/4 [00:00<00:00, 15.19it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.23it/s]100%|██████████| 4/4 [00:00<00:00, 17.27it/s]100%|██████████| 4/4 [00:00<00:00, 17.09it/s]
Run 00 | Epoch 00083 | Loss 0.9882 | Train 0.2832 | Val 0.2504 | Test 0.2294
Number of nodes during this epoch:  335677
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1753230094909668  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02524852752685547
range selection method range initialization spend 0.01221609115600586
time for parepare:  0.017449378967285156
local_output_nid generation:  0.011022567749023438
local_in_edges_tensor generation:  0.01462101936340332
mini_batch_src_global generation:  0.01840376853942871
r_  generation:  0.20646905899047852
local_output_nid generation:  0.012029170989990234
local_in_edges_tensor generation:  0.009279966354370117
mini_batch_src_global generation:  0.022566556930541992
r_  generation:  0.22480511665344238
----------------------check_connections_block total spend ----------------------------- 0.6229162216186523
generate_one_block  0.24452686309814453
generate_one_block  0.2527956962585449
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04013633728027344
gen group dst list time:  0.0064547061920166016
time for parepare:  0.02013254165649414
local_output_nid generation:  0.018887758255004883
local_in_edges_tensor generation:  0.04219937324523926
mini_batch_src_global generation:  0.0594477653503418
r_  generation:  0.586728572845459
local_output_nid generation:  0.029208898544311523
local_in_edges_tensor generation:  0.03864479064941406
mini_batch_src_global generation:  0.0684964656829834
r_  generation:  0.6033499240875244
----------------------check_connections_block total spend ----------------------------- 1.721982717514038
generate_one_block  0.7542529106140137
generate_one_block  0.7621650695800781
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.031566619873046875
gen group dst list time:  0.012289047241210938
time for parepare:  0.018207788467407227
local_output_nid generation:  0.023564815521240234
local_in_edges_tensor generation:  0.035413503646850586
mini_batch_src_global generation:  0.054778099060058594
r_  generation:  0.5817341804504395
local_output_nid generation:  0.03323554992675781
local_in_edges_tensor generation:  0.037438154220581055
mini_batch_src_global generation:  0.06907343864440918
r_  generation:  0.5940687656402588
----------------------check_connections_block total spend ----------------------------- 1.718954086303711
generate_one_block  0.7420539855957031
generate_one_block  0.7517595291137695
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1753230094909668  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.440936803817749
block generation total time  3.0102314949035645
average batch blocks generation time:  1.5051157474517822
block dataloader generation time/epoch 8.361575158437093
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12221574783325195  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3363418579101562  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1223149299621582  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3367886543273926  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0907907485961914 |0.018833041191101074 |0.004131436347961426 |0.0005213022232055664 |0.004016757011413574 |0.0014789104461669922 |
----------------------------------------------------------pseudo_mini_loss sum 0.9859789609909058
Total (block generation + training)time/epoch 8.719670019149781
Training time/epoch 0.35714054107666016
Training time without block to device /epoch 0.319474458694458
Training time without total dataloading part /epoch 0.018817901611328125
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 55.17it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.67it/s]100%|██████████| 4/4 [00:00<00:00, 13.97it/s]100%|██████████| 4/4 [00:00<00:00, 14.06it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.10it/s]100%|██████████| 4/4 [00:00<00:00, 16.88it/s]100%|██████████| 4/4 [00:00<00:00, 16.74it/s]
Run 00 | Epoch 00084 | Loss 0.9860 | Train 0.2800 | Val 0.2448 | Test 0.2232
Number of nodes during this epoch:  335683
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1753840446472168  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02335834503173828
range selection method range initialization spend 0.01230931282043457
time for parepare:  0.01873493194580078
local_output_nid generation:  0.010824203491210938
local_in_edges_tensor generation:  0.01142573356628418
mini_batch_src_global generation:  0.01858973503112793
r_  generation:  0.20659089088439941
local_output_nid generation:  0.01193857192993164
local_in_edges_tensor generation:  0.0075991153717041016
mini_batch_src_global generation:  0.022355079650878906
r_  generation:  0.2211010456085205
----------------------check_connections_block total spend ----------------------------- 0.6141433715820312
generate_one_block  0.24672627449035645
generate_one_block  0.24620366096496582
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03977012634277344
gen group dst list time:  0.006404876708984375
time for parepare:  0.02008676528930664
local_output_nid generation:  0.018756389617919922
local_in_edges_tensor generation:  0.039752960205078125
mini_batch_src_global generation:  0.056595802307128906
r_  generation:  0.591367244720459
local_output_nid generation:  0.02898097038269043
local_in_edges_tensor generation:  0.0360260009765625
mini_batch_src_global generation:  0.06842875480651855
r_  generation:  0.6029760837554932
----------------------check_connections_block total spend ----------------------------- 1.716820240020752
generate_one_block  0.7653872966766357
generate_one_block  0.7561407089233398
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02875375747680664
gen group dst list time:  0.012283563613891602
time for parepare:  0.0182340145111084
local_output_nid generation:  0.023226022720336914
local_in_edges_tensor generation:  0.03769207000732422
mini_batch_src_global generation:  0.05858206748962402
r_  generation:  0.6075863838195801
local_output_nid generation:  0.03419017791748047
local_in_edges_tensor generation:  0.04165005683898926
mini_batch_src_global generation:  0.06898236274719238
r_  generation:  0.60546875
----------------------check_connections_block total spend ----------------------------- 1.7862601280212402
generate_one_block  0.752105712890625
generate_one_block  0.7406692504882812
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1753840446472168  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.503080368041992
block generation total time  3.014302968978882
average batch blocks generation time:  1.507151484489441
block dataloader generation time/epoch 8.362803343095278
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12230443954467773  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.336745262145996  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12223291397094727  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.336453914642334  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09000170230865479 |0.02844870090484619 |0.004107952117919922 |0.000530242919921875 |0.0034083127975463867 |0.0029125213623046875 |
----------------------------------------------------------pseudo_mini_loss sum 0.9836006164550781
Total (block generation + training)time/epoch 8.721171924942418
Training time/epoch 0.3787393569946289
Training time without block to device /epoch 0.3218419551849365
Training time without total dataloading part /epoch 0.019005537033081055
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 49.95it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.20it/s]100%|██████████| 4/4 [00:00<00:00, 15.20it/s]100%|██████████| 4/4 [00:00<00:00, 15.19it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.36it/s]100%|██████████| 4/4 [00:00<00:00, 17.38it/s]100%|██████████| 4/4 [00:00<00:00, 17.36it/s]
Run 00 | Epoch 00085 | Loss 0.9836 | Train 0.2773 | Val 0.2395 | Test 0.2182
Number of nodes during this epoch:  335699
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17532825469970703  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02872943878173828
range selection method range initialization spend 0.011947154998779297
time for parepare:  0.0161590576171875
local_output_nid generation:  0.010834932327270508
local_in_edges_tensor generation:  0.014328956604003906
mini_batch_src_global generation:  0.017815828323364258
r_  generation:  0.20568203926086426
local_output_nid generation:  0.012392759323120117
local_in_edges_tensor generation:  0.009772062301635742
mini_batch_src_global generation:  0.02237081527709961
r_  generation:  0.2218153476715088
----------------------check_connections_block total spend ----------------------------- 0.6163523197174072
generate_one_block  0.2537221908569336
generate_one_block  0.2536170482635498
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0333554744720459
gen group dst list time:  0.0063707828521728516
time for parepare:  0.02000141143798828
local_output_nid generation:  0.019176483154296875
local_in_edges_tensor generation:  0.04016375541687012
mini_batch_src_global generation:  0.05672049522399902
r_  generation:  0.5823931694030762
local_output_nid generation:  0.02982330322265625
local_in_edges_tensor generation:  0.038736820220947266
mini_batch_src_global generation:  0.0678260326385498
r_  generation:  0.6051077842712402
----------------------check_connections_block total spend ----------------------------- 1.7129013538360596
generate_one_block  0.7519021034240723
generate_one_block  0.7564084529876709
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028557538986206055
gen group dst list time:  0.012254476547241211
time for parepare:  0.018137454986572266
local_output_nid generation:  0.023190736770629883
local_in_edges_tensor generation:  0.03580355644226074
mini_batch_src_global generation:  0.05381131172180176
r_  generation:  0.5843183994293213
local_output_nid generation:  0.03266620635986328
local_in_edges_tensor generation:  0.04056739807128906
mini_batch_src_global generation:  0.0680997371673584
r_  generation:  0.5941498279571533
----------------------check_connections_block total spend ----------------------------- 1.719559669494629
generate_one_block  0.7460103034973145
generate_one_block  0.7518355846405029
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17532825469970703  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.4324610233306885
block generation total time  3.0061564445495605
average batch blocks generation time:  1.5030782222747803
block dataloader generation time/epoch 8.362911224365234
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12224721908569336  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3364429473876953  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12227487564086914  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3366351127624512  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08784091472625732 |0.027767181396484375 |0.00393986701965332 |0.000493168830871582 |0.004015564918518066 |0.003045320510864258 |
----------------------------------------------------------pseudo_mini_loss sum 0.9817301034927368
Total (block generation + training)time/epoch 8.721381246269523
Training time/epoch 0.36608219146728516
Training time without block to device /epoch 0.3105478286743164
Training time without total dataloading part /epoch 0.019942522048950195
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 54.64it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.83it/s]100%|██████████| 4/4 [00:00<00:00, 14.93it/s]100%|██████████| 4/4 [00:00<00:00, 14.90it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.58it/s]100%|██████████| 4/4 [00:00<00:00, 17.59it/s]100%|██████████| 4/4 [00:00<00:00, 17.57it/s]
Run 00 | Epoch 00086 | Loss 0.9817 | Train 0.2748 | Val 0.2346 | Test 0.2139
Number of nodes during this epoch:  335664
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17533397674560547  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024544954299926758
range selection method range initialization spend 0.011869430541992188
time for parepare:  0.018963336944580078
local_output_nid generation:  0.011009454727172852
local_in_edges_tensor generation:  0.010587215423583984
mini_batch_src_global generation:  0.01730942726135254
r_  generation:  0.20746326446533203
local_output_nid generation:  0.012385129928588867
local_in_edges_tensor generation:  0.010592460632324219
mini_batch_src_global generation:  0.0229647159576416
r_  generation:  0.2232799530029297
----------------------check_connections_block total spend ----------------------------- 0.6196043491363525
generate_one_block  0.24573755264282227
generate_one_block  0.24863147735595703
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03323173522949219
gen group dst list time:  0.0065305233001708984
time for parepare:  0.019990205764770508
local_output_nid generation:  0.01911139488220215
local_in_edges_tensor generation:  0.03976178169250488
mini_batch_src_global generation:  0.0574190616607666
r_  generation:  0.5847146511077881
local_output_nid generation:  0.03009033203125
local_in_edges_tensor generation:  0.03312563896179199
mini_batch_src_global generation:  0.06772899627685547
r_  generation:  0.5958561897277832
----------------------check_connections_block total spend ----------------------------- 1.703331708908081
generate_one_block  0.7563986778259277
generate_one_block  0.7648375034332275
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028306961059570312
gen group dst list time:  0.012197732925415039
time for parepare:  0.018820524215698242
local_output_nid generation:  0.023970603942871094
local_in_edges_tensor generation:  0.03675484657287598
mini_batch_src_global generation:  0.0537109375
r_  generation:  0.575761079788208
local_output_nid generation:  0.0354609489440918
local_in_edges_tensor generation:  0.03738069534301758
mini_batch_src_global generation:  0.06893372535705566
r_  generation:  0.5872583389282227
----------------------check_connections_block total spend ----------------------------- 1.7076191902160645
generate_one_block  0.730294942855835
generate_one_block  0.7385246753692627
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17533397674560547  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.4109508991241455
block generation total time  2.990055799484253
average batch blocks generation time:  1.4950278997421265
block dataloader generation time/epoch 8.362175981203714
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12226438522338867  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3366012573242188  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12227392196655273  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.336580753326416  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08846819400787354 |0.01929616928100586 |0.003977298736572266 |0.0005127191543579102 |0.002627730369567871 |0.0016238689422607422 |
----------------------------------------------------------pseudo_mini_loss sum 0.9816060066223145
Total (block generation + training)time/epoch 8.72054362602723
Training time/epoch 0.35037994384765625
Training time without block to device /epoch 0.31178760528564453
Training time without total dataloading part /epoch 0.015859365463256836
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 63.80it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.01it/s]100%|██████████| 4/4 [00:00<00:00, 15.37it/s]100%|██████████| 4/4 [00:00<00:00, 15.30it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.87it/s]100%|██████████| 4/4 [00:00<00:00, 17.36it/s]100%|██████████| 4/4 [00:00<00:00, 17.27it/s]
Run 00 | Epoch 00087 | Loss 0.9816 | Train 0.2725 | Val 0.2298 | Test 0.2078
Number of nodes during this epoch:  335658
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17536354064941406  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021225929260253906
range selection method range initialization spend 0.011678695678710938
time for parepare:  0.01700115203857422
local_output_nid generation:  0.010985612869262695
local_in_edges_tensor generation:  0.00959467887878418
mini_batch_src_global generation:  0.017757654190063477
r_  generation:  0.2073674201965332
local_output_nid generation:  0.012455463409423828
local_in_edges_tensor generation:  0.00695347785949707
mini_batch_src_global generation:  0.022478342056274414
r_  generation:  0.22159552574157715
----------------------check_connections_block total spend ----------------------------- 0.6121373176574707
generate_one_block  0.24677824974060059
generate_one_block  0.24914026260375977
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.034735679626464844
gen group dst list time:  0.006663322448730469
time for parepare:  0.020710229873657227
local_output_nid generation:  0.018999099731445312
local_in_edges_tensor generation:  0.03099822998046875
mini_batch_src_global generation:  0.05638241767883301
r_  generation:  0.5832605361938477
local_output_nid generation:  0.03164339065551758
local_in_edges_tensor generation:  0.030541419982910156
mini_batch_src_global generation:  0.06899690628051758
r_  generation:  0.5996897220611572
----------------------check_connections_block total spend ----------------------------- 1.696108341217041
generate_one_block  0.7556822299957275
generate_one_block  0.7545557022094727
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029673337936401367
gen group dst list time:  0.012868165969848633
time for parepare:  0.018459081649780273
local_output_nid generation:  0.02375507354736328
local_in_edges_tensor generation:  0.03523588180541992
mini_batch_src_global generation:  0.05469369888305664
r_  generation:  0.5799944400787354
local_output_nid generation:  0.03573489189147949
local_in_edges_tensor generation:  0.03421974182128906
mini_batch_src_global generation:  0.08245706558227539
r_  generation:  0.5916945934295654
----------------------check_connections_block total spend ----------------------------- 1.7226998805999756
generate_one_block  0.7462196350097656
generate_one_block  0.7486667633056641
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17536354064941406  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.4188082218170166
block generation total time  3.00512433052063
average batch blocks generation time:  1.502562165260315
block dataloader generation time/epoch 8.361336629601974
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12226629257202148  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3364944458007812  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12226724624633789  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3366150856018066  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08742094039916992 |0.03143572807312012 |0.003739476203918457 |0.00048661231994628906 |0.0037238597869873047 |0.0016238689422607422 |
----------------------------------------------------------pseudo_mini_loss sum 0.9747824668884277
Total (block generation + training)time/epoch 8.719833573208579
Training time/epoch 0.3684992790222168
Training time without block to device /epoch 0.30562782287597656
Training time without total dataloading part /epoch 0.017523765563964844
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 60.04it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.04it/s]100%|██████████| 4/4 [00:00<00:00, 15.85it/s]100%|██████████| 4/4 [00:00<00:00, 15.71it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.44it/s]100%|██████████| 4/4 [00:00<00:00, 18.85it/s]100%|██████████| 4/4 [00:00<00:00, 18.61it/s]
Run 00 | Epoch 00088 | Loss 0.9748 | Train 0.2698 | Val 0.2252 | Test 0.2021
Number of nodes during this epoch:  335639
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17533445358276367  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02492213249206543
range selection method range initialization spend 0.011908292770385742
time for parepare:  0.01856231689453125
local_output_nid generation:  0.011240720748901367
local_in_edges_tensor generation:  0.011167764663696289
mini_batch_src_global generation:  0.01807427406311035
r_  generation:  0.20753741264343262
local_output_nid generation:  0.012430191040039062
local_in_edges_tensor generation:  0.008408546447753906
mini_batch_src_global generation:  0.023163795471191406
r_  generation:  0.22195076942443848
----------------------check_connections_block total spend ----------------------------- 0.6176393032073975
generate_one_block  0.2474231719970703
generate_one_block  0.2469651699066162
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04275345802307129
gen group dst list time:  0.006391286849975586
time for parepare:  0.021116256713867188
local_output_nid generation:  0.019342660903930664
local_in_edges_tensor generation:  0.031604766845703125
mini_batch_src_global generation:  0.05703091621398926
r_  generation:  0.5852491855621338
local_output_nid generation:  0.029880762100219727
local_in_edges_tensor generation:  0.029985904693603516
mini_batch_src_global generation:  0.06824398040771484
r_  generation:  0.5999014377593994
----------------------check_connections_block total spend ----------------------------- 1.6982300281524658
generate_one_block  0.7525124549865723
generate_one_block  0.7481362819671631
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028384685516357422
gen group dst list time:  0.012282609939575195
time for parepare:  0.018406152725219727
local_output_nid generation:  0.023275136947631836
local_in_edges_tensor generation:  0.042569875717163086
mini_batch_src_global generation:  0.05548715591430664
r_  generation:  0.5844120979309082
local_output_nid generation:  0.03270769119262695
local_in_edges_tensor generation:  0.03630185127258301
mini_batch_src_global generation:  0.06868648529052734
r_  generation:  0.5871453285217285
----------------------check_connections_block total spend ----------------------------- 1.7144484519958496
generate_one_block  0.747093677520752
generate_one_block  0.737403392791748
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17533445358276367  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.4126784801483154
block generation total time  2.9851458072662354
average batch blocks generation time:  1.4925729036331177
block dataloader generation time/epoch 8.360594350099564
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12228822708129883  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.33656644821167  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12223291397094727  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3365106582641602  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0888296365737915 |0.01870250701904297 |0.003999829292297363 |0.0005168914794921875 |0.0032411813735961914 |0.0014033317565917969 |
----------------------------------------------------------pseudo_mini_loss sum 0.9773370027542114
Total (block generation + training)time/epoch 8.718998804688454
Training time/epoch 0.35094237327575684
Training time without block to device /epoch 0.3135373592376709
Training time without total dataloading part /epoch 0.01691913604736328
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 63.80it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.31it/s]100%|██████████| 4/4 [00:00<00:00, 15.42it/s]100%|██████████| 4/4 [00:00<00:00, 15.39it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.88it/s]100%|██████████| 4/4 [00:00<00:00, 17.34it/s]100%|██████████| 4/4 [00:00<00:00, 17.25it/s]
Run 00 | Epoch 00089 | Loss 0.9773 | Train 0.2669 | Val 0.2195 | Test 0.1966
Number of nodes during this epoch:  335629
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17530488967895508  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020519495010375977
range selection method range initialization spend 0.011809110641479492
time for parepare:  0.016218185424804688
local_output_nid generation:  0.010698556900024414
local_in_edges_tensor generation:  0.009587287902832031
mini_batch_src_global generation:  0.01729607582092285
r_  generation:  0.2061138153076172
local_output_nid generation:  0.012129068374633789
local_in_edges_tensor generation:  0.007036447525024414
mini_batch_src_global generation:  0.022518396377563477
r_  generation:  0.22439217567443848
----------------------check_connections_block total spend ----------------------------- 0.6117334365844727
generate_one_block  0.24527478218078613
generate_one_block  0.25112366676330566
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03343391418457031
gen group dst list time:  0.00631403923034668
time for parepare:  0.020200014114379883
local_output_nid generation:  0.01866006851196289
local_in_edges_tensor generation:  0.0338132381439209
mini_batch_src_global generation:  0.056145429611206055
r_  generation:  0.5955872535705566
local_output_nid generation:  0.02987837791442871
local_in_edges_tensor generation:  0.03124833106994629
mini_batch_src_global generation:  0.07002997398376465
r_  generation:  0.6138255596160889
----------------------check_connections_block total spend ----------------------------- 1.7291593551635742
generate_one_block  0.8069441318511963
generate_one_block  0.76446533203125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03203725814819336
gen group dst list time:  0.014428138732910156
time for parepare:  0.018171072006225586
local_output_nid generation:  0.023851633071899414
local_in_edges_tensor generation:  0.04511094093322754
mini_batch_src_global generation:  0.057657480239868164
r_  generation:  0.5781850814819336
local_output_nid generation:  0.033294677734375
local_in_edges_tensor generation:  0.04381680488586426
mini_batch_src_global generation:  0.06783819198608398
r_  generation:  0.5878689289093018
----------------------check_connections_block total spend ----------------------------- 1.722949743270874
generate_one_block  0.7484662532806396
generate_one_block  0.7519838809967041
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17530488967895508  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.4521090984344482
block generation total time  3.07185959815979
average batch blocks generation time:  1.535929799079895
block dataloader generation time/epoch 8.361277209387886
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12221384048461914  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3365254402160645  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1222996711730957  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3365435600280762  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09108662605285645 |0.02300441265106201 |0.004138469696044922 |0.000516057014465332 |0.003287792205810547 |0.0029823780059814453 |
----------------------------------------------------------pseudo_mini_loss sum 0.9723761081695557
Total (block generation + training)time/epoch 8.719699950865758
Training time/epoch 0.3597283363342285
Training time without block to device /epoch 0.3137195110321045
Training time without total dataloading part /epoch 0.018867015838623047
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 50.16it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.50it/s]100%|██████████| 4/4 [00:00<00:00, 13.98it/s]100%|██████████| 4/4 [00:00<00:00, 14.18it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.14it/s]100%|██████████| 4/4 [00:00<00:00, 16.43it/s]100%|██████████| 4/4 [00:00<00:00, 16.20it/s]
Run 00 | Epoch 00090 | Loss 0.9724 | Train 0.2647 | Val 0.2149 | Test 0.1925
Number of nodes during this epoch:  335722
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1754446029663086  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027299880981445312
range selection method range initialization spend 0.011790752410888672
time for parepare:  0.018218040466308594
local_output_nid generation:  0.010886430740356445
local_in_edges_tensor generation:  0.015087127685546875
mini_batch_src_global generation:  0.017757892608642578
r_  generation:  0.2065267562866211
local_output_nid generation:  0.012424707412719727
local_in_edges_tensor generation:  0.008360624313354492
mini_batch_src_global generation:  0.022863149642944336
r_  generation:  0.2221698760986328
----------------------check_connections_block total spend ----------------------------- 0.6193516254425049
generate_one_block  0.24863123893737793
generate_one_block  0.24843358993530273
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03427481651306152
gen group dst list time:  0.006422996520996094
time for parepare:  0.02038121223449707
local_output_nid generation:  0.018531322479248047
local_in_edges_tensor generation:  0.041759490966796875
mini_batch_src_global generation:  0.06356453895568848
r_  generation:  0.593735933303833
local_output_nid generation:  0.028979778289794922
local_in_edges_tensor generation:  0.035089969635009766
mini_batch_src_global generation:  0.0696706771850586
r_  generation:  0.6062829494476318
----------------------check_connections_block total spend ----------------------------- 1.7327961921691895
generate_one_block  0.7661342620849609
generate_one_block  0.7600581645965576
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028368711471557617
gen group dst list time:  0.012153863906860352
time for parepare:  0.0187685489654541
local_output_nid generation:  0.022945880889892578
local_in_edges_tensor generation:  0.036826372146606445
mini_batch_src_global generation:  0.054270267486572266
r_  generation:  0.5959022045135498
local_output_nid generation:  0.03453350067138672
local_in_edges_tensor generation:  0.0383305549621582
mini_batch_src_global generation:  0.06867170333862305
r_  generation:  0.6041684150695801
----------------------check_connections_block total spend ----------------------------- 1.7425343990325928
generate_one_block  0.7340712547302246
generate_one_block  0.7429900169372559
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1754446029663086  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.4753305912017822
block generation total time  3.003253698348999
average batch blocks generation time:  1.5016268491744995
block dataloader generation time/epoch 8.361879372015231
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12229013442993164  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3366613388061523  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12223577499389648  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3364629745483398  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08979415893554688 |0.020529866218566895 |0.00416719913482666 |0.0005208253860473633 |0.0028268098831176758 |0.0018205642700195312 |
----------------------------------------------------------pseudo_mini_loss sum 0.9708267450332642
Total (block generation + training)time/epoch 8.720369638466254
Training time/epoch 0.36380696296691895
Training time without block to device /epoch 0.32274723052978516
Training time without total dataloading part /epoch 0.01685023307800293
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 54.69it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.84it/s]100%|██████████| 4/4 [00:00<00:00, 15.20it/s]100%|██████████| 4/4 [00:00<00:00, 15.13it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.58it/s]100%|██████████| 4/4 [00:00<00:00, 17.73it/s]100%|██████████| 4/4 [00:00<00:00, 17.69it/s]
Run 00 | Epoch 00091 | Loss 0.9708 | Train 0.2628 | Val 0.2108 | Test 0.1880
Number of nodes during this epoch:  335672
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17531585693359375  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02548956871032715
range selection method range initialization spend 0.011872053146362305
time for parepare:  0.01746225357055664
local_output_nid generation:  0.01079106330871582
local_in_edges_tensor generation:  0.010948657989501953
mini_batch_src_global generation:  0.018630504608154297
r_  generation:  0.21514225006103516
local_output_nid generation:  0.012458324432373047
local_in_edges_tensor generation:  0.008491277694702148
mini_batch_src_global generation:  0.02283000946044922
r_  generation:  0.2218785285949707
----------------------check_connections_block total spend ----------------------------- 0.631066083908081
generate_one_block  0.24848556518554688
generate_one_block  0.253664493560791
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03802967071533203
gen group dst list time:  0.00648808479309082
time for parepare:  0.020152807235717773
local_output_nid generation:  0.019834280014038086
local_in_edges_tensor generation:  0.04138326644897461
mini_batch_src_global generation:  0.05937623977661133
r_  generation:  0.5841584205627441
local_output_nid generation:  0.03063511848449707
local_in_edges_tensor generation:  0.04002809524536133
mini_batch_src_global generation:  0.06861066818237305
r_  generation:  0.5967755317687988
----------------------check_connections_block total spend ----------------------------- 1.719334363937378
generate_one_block  0.7500512599945068
generate_one_block  0.764493465423584
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028627634048461914
gen group dst list time:  0.01221776008605957
time for parepare:  0.01821279525756836
local_output_nid generation:  0.024250030517578125
local_in_edges_tensor generation:  0.04455924034118652
mini_batch_src_global generation:  0.05440807342529297
r_  generation:  0.5768897533416748
local_output_nid generation:  0.03394651412963867
local_in_edges_tensor generation:  0.041014909744262695
mini_batch_src_global generation:  0.06818222999572754
r_  generation:  0.585552453994751
----------------------check_connections_block total spend ----------------------------- 1.712195873260498
generate_one_block  0.7396855354309082
generate_one_block  0.7335724830627441
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17531585693359375  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.431530237197876
block generation total time  2.987802743911743
average batch blocks generation time:  1.4939013719558716
block dataloader generation time/epoch 8.361971137035324
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12228822708129883  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3365373611450195  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1222386360168457  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3365464210510254  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08629703521728516 |0.018836259841918945 |0.004085540771484375 |0.0005118846893310547 |0.002562999725341797 |0.0018894672393798828 |
----------------------------------------------------------pseudo_mini_loss sum 0.9714571833610535
Total (block generation + training)time/epoch 8.720374753676266
Training time/epoch 0.35113954544067383
Training time without block to device /epoch 0.31346702575683594
Training time without total dataloading part /epoch 0.016210317611694336
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 56.15it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.87it/s]100%|██████████| 4/4 [00:00<00:00, 16.18it/s]100%|██████████| 4/4 [00:00<00:00, 15.95it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.27it/s]100%|██████████| 4/4 [00:00<00:00, 18.76it/s]
Run 00 | Epoch 00092 | Loss 0.9715 | Train 0.2608 | Val 0.2069 | Test 0.1840
Number of nodes during this epoch:  335671
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17528915405273438  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02269268035888672
range selection method range initialization spend 0.011836051940917969
time for parepare:  0.0168607234954834
local_output_nid generation:  0.010996341705322266
local_in_edges_tensor generation:  0.009381532669067383
mini_batch_src_global generation:  0.017905235290527344
r_  generation:  0.20781326293945312
local_output_nid generation:  0.01199960708618164
local_in_edges_tensor generation:  0.007058858871459961
mini_batch_src_global generation:  0.022156715393066406
r_  generation:  0.22250151634216309
----------------------check_connections_block total spend ----------------------------- 0.6115987300872803
generate_one_block  0.24985170364379883
generate_one_block  0.24826312065124512
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.041275739669799805
gen group dst list time:  0.006418943405151367
time for parepare:  0.019950151443481445
local_output_nid generation:  0.019028902053833008
local_in_edges_tensor generation:  0.031155109405517578
mini_batch_src_global generation:  0.05894279479980469
r_  generation:  0.5959396362304688
local_output_nid generation:  0.0297091007232666
local_in_edges_tensor generation:  0.03308272361755371
mini_batch_src_global generation:  0.06889033317565918
r_  generation:  0.5965964794158936
----------------------check_connections_block total spend ----------------------------- 1.711782693862915
generate_one_block  0.755263090133667
generate_one_block  0.7537953853607178
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029076576232910156
gen group dst list time:  0.012413501739501953
time for parepare:  0.018248558044433594
local_output_nid generation:  0.023797035217285156
local_in_edges_tensor generation:  0.03695511817932129
mini_batch_src_global generation:  0.05652499198913574
r_  generation:  0.583543062210083
local_output_nid generation:  0.0330510139465332
local_in_edges_tensor generation:  0.03445935249328613
mini_batch_src_global generation:  0.07096552848815918
r_  generation:  0.6055388450622559
----------------------check_connections_block total spend ----------------------------- 1.7350149154663086
generate_one_block  0.73410964012146
generate_one_block  0.7284154891967773
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17528915405273438  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.4467976093292236
block generation total time  2.971583604812622
average batch blocks generation time:  1.485791802406311
block dataloader generation time/epoch 8.36149574745269
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12227106094360352  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3365087509155273  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12225580215454102  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3364973068237305  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08814609050750732 |0.02406132221221924 |0.0039042234420776367 |0.00048351287841796875 |0.002962827682495117 |0.0012924671173095703 |
----------------------------------------------------------pseudo_mini_loss sum 0.9705322980880737
Total (block generation + training)time/epoch 8.719805433636619
Training time/epoch 0.3504297733306885
Training time without block to device /epoch 0.30230712890625
Training time without total dataloading part /epoch 0.015993595123291016
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 50.88it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.04it/s]100%|██████████| 4/4 [00:00<00:00, 15.30it/s]100%|██████████| 4/4 [00:00<00:00, 15.25it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.38it/s]100%|██████████| 4/4 [00:00<00:00, 17.26it/s]100%|██████████| 4/4 [00:00<00:00, 17.26it/s]
Run 00 | Epoch 00093 | Loss 0.9705 | Train 0.2599 | Val 0.2028 | Test 0.1809
Number of nodes during this epoch:  335601
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17536449432373047  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0274350643157959
range selection method range initialization spend 0.012035608291625977
time for parepare:  0.01681828498840332
local_output_nid generation:  0.010889768600463867
local_in_edges_tensor generation:  0.009297609329223633
mini_batch_src_global generation:  0.01849651336669922
r_  generation:  0.20826005935668945
local_output_nid generation:  0.012717008590698242
local_in_edges_tensor generation:  0.007892847061157227
mini_batch_src_global generation:  0.022126197814941406
r_  generation:  0.22572898864746094
----------------------check_connections_block total spend ----------------------------- 0.6226420402526855
generate_one_block  0.2521250247955322
generate_one_block  0.2508738040924072
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0448613166809082
gen group dst list time:  0.006412982940673828
time for parepare:  0.020389556884765625
local_output_nid generation:  0.019236087799072266
local_in_edges_tensor generation:  0.03841114044189453
mini_batch_src_global generation:  0.05779409408569336
r_  generation:  0.5918715000152588
local_output_nid generation:  0.029442787170410156
local_in_edges_tensor generation:  0.04167056083679199
mini_batch_src_global generation:  0.07106494903564453
r_  generation:  0.600801944732666
----------------------check_connections_block total spend ----------------------------- 1.7243216037750244
generate_one_block  0.755427360534668
generate_one_block  0.7625114917755127
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030918359756469727
gen group dst list time:  0.012239933013916016
time for parepare:  0.018425941467285156
local_output_nid generation:  0.02357625961303711
local_in_edges_tensor generation:  0.0405735969543457
mini_batch_src_global generation:  0.05585193634033203
r_  generation:  0.5872542858123779
local_output_nid generation:  0.03319048881530762
local_in_edges_tensor generation:  0.037119388580322266
mini_batch_src_global generation:  0.06890368461608887
r_  generation:  0.5910444259643555
----------------------check_connections_block total spend ----------------------------- 1.7223846912384033
generate_one_block  0.7370612621307373
generate_one_block  0.7436463832855225
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17536449432373047  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.4467062950134277
block generation total time  2.9986464977264404
average batch blocks generation time:  1.4993232488632202
block dataloader generation time/epoch 8.361603865903966
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1222376823425293  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3364200592041016  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1222691535949707  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3366694450378418  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09019684791564941 |0.018915414810180664 |0.004187464714050293 |0.0005137920379638672 |0.003280162811279297 |0.00136566162109375 |
----------------------------------------------------------pseudo_mini_loss sum 0.9665120840072632
Total (block generation + training)time/epoch 8.71980362779954
Training time/epoch 0.3488137722015381
Training time without block to device /epoch 0.31098294258117676
Training time without total dataloading part /epoch 0.017328500747680664
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 55.78it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.93it/s]100%|██████████| 4/4 [00:00<00:00, 15.58it/s]100%|██████████| 4/4 [00:00<00:00, 15.46it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.17it/s]100%|██████████| 4/4 [00:00<00:00, 17.89it/s]100%|██████████| 4/4 [00:00<00:00, 17.76it/s]
Run 00 | Epoch 00094 | Loss 0.9665 | Train 0.2588 | Val 0.2002 | Test 0.1787
Number of nodes during this epoch:  335647
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17531824111938477  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019608497619628906
range selection method range initialization spend 0.012102842330932617
time for parepare:  0.017820119857788086
local_output_nid generation:  0.010816097259521484
local_in_edges_tensor generation:  0.009256124496459961
mini_batch_src_global generation:  0.017824649810791016
r_  generation:  0.210282564163208
local_output_nid generation:  0.011979818344116211
local_in_edges_tensor generation:  0.007880926132202148
mini_batch_src_global generation:  0.0222928524017334
r_  generation:  0.22413301467895508
----------------------check_connections_block total spend ----------------------------- 0.6175963878631592
generate_one_block  0.25159406661987305
generate_one_block  0.24842214584350586
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03925728797912598
gen group dst list time:  0.006371736526489258
time for parepare:  0.0202639102935791
local_output_nid generation:  0.019318103790283203
local_in_edges_tensor generation:  0.03132438659667969
mini_batch_src_global generation:  0.0564723014831543
r_  generation:  0.5835695266723633
local_output_nid generation:  0.029285430908203125
local_in_edges_tensor generation:  0.03144955635070801
mini_batch_src_global generation:  0.07121491432189941
r_  generation:  0.5924625396728516
----------------------check_connections_block total spend ----------------------------- 1.690352201461792
generate_one_block  0.7609043121337891
generate_one_block  0.759967565536499
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03299212455749512
gen group dst list time:  0.012229442596435547
time for parepare:  0.01819777488708496
local_output_nid generation:  0.02350449562072754
local_in_edges_tensor generation:  0.03416085243225098
mini_batch_src_global generation:  0.05438375473022461
r_  generation:  0.5775368213653564
local_output_nid generation:  0.03280019760131836
local_in_edges_tensor generation:  0.036766767501831055
mini_batch_src_global generation:  0.0687556266784668
r_  generation:  0.5849869251251221
----------------------check_connections_block total spend ----------------------------- 1.6984226703643799
generate_one_block  0.7326486110687256
generate_one_block  0.7351138591766357
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17531824111938477  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.388774871826172
block generation total time  2.9886343479156494
average batch blocks generation time:  1.4943171739578247
block dataloader generation time/epoch 8.360716875209365
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12232542037963867  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3367633819580078  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12220525741577148  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.336453914642334  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08413195610046387 |0.018635272979736328 |0.004048824310302734 |0.0005075931549072266 |0.0026689767837524414 |0.0029921531677246094 |
----------------------------------------------------------pseudo_mini_loss sum 0.965683102607727
Total (block generation + training)time/epoch 8.718747723934262
Training time/epoch 0.3435854911804199
Training time without block to device /epoch 0.30631494522094727
Training time without total dataloading part /epoch 0.017442941665649414
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 64.40it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.99it/s]100%|██████████| 4/4 [00:00<00:00, 15.18it/s]100%|██████████| 4/4 [00:00<00:00, 15.14it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.53it/s]100%|██████████| 4/4 [00:00<00:00, 17.42it/s]100%|██████████| 4/4 [00:00<00:00, 17.42it/s]
Run 00 | Epoch 00095 | Loss 0.9657 | Train 0.2588 | Val 0.1991 | Test 0.1767
Number of nodes during this epoch:  335754
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1752486228942871  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028519153594970703
range selection method range initialization spend 0.012766599655151367
time for parepare:  0.016177892684936523
local_output_nid generation:  0.011012077331542969
local_in_edges_tensor generation:  0.012133598327636719
mini_batch_src_global generation:  0.018599987030029297
r_  generation:  0.22092080116271973
local_output_nid generation:  0.013577938079833984
local_in_edges_tensor generation:  0.010753870010375977
mini_batch_src_global generation:  0.022282838821411133
r_  generation:  0.22439026832580566
----------------------check_connections_block total spend ----------------------------- 0.6409423351287842
generate_one_block  0.24894142150878906
generate_one_block  0.24677705764770508
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04507255554199219
gen group dst list time:  0.0062978267669677734
time for parepare:  0.0203397274017334
local_output_nid generation:  0.01903367042541504
local_in_edges_tensor generation:  0.041333675384521484
mini_batch_src_global generation:  0.05662870407104492
r_  generation:  0.5813136100769043
local_output_nid generation:  0.029293298721313477
local_in_edges_tensor generation:  0.043642520904541016
mini_batch_src_global generation:  0.06926155090332031
r_  generation:  0.5955548286437988
----------------------check_connections_block total spend ----------------------------- 1.710179328918457
generate_one_block  0.7501306533813477
generate_one_block  0.7708773612976074
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03012681007385254
gen group dst list time:  0.01220393180847168
time for parepare:  0.018525123596191406
local_output_nid generation:  0.02353668212890625
local_in_edges_tensor generation:  0.03864574432373047
mini_batch_src_global generation:  0.05463695526123047
r_  generation:  0.583254337310791
local_output_nid generation:  0.03283047676086426
local_in_edges_tensor generation:  0.0398409366607666
mini_batch_src_global generation:  0.07086920738220215
r_  generation:  0.5872652530670166
----------------------check_connections_block total spend ----------------------------- 1.7183647155761719
generate_one_block  0.7494540214538574
generate_one_block  0.7751193046569824
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.1752486228942871  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.428544044494629
block generation total time  3.045581340789795
average batch blocks generation time:  1.5227906703948975
block dataloader generation time/epoch 8.361508769550543
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12231206893920898  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.336771011352539  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12222909927368164  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.336397647857666  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09025871753692627 |0.03153848648071289 |0.004155635833740234 |0.0005043745040893555 |0.0033947229385375977 |0.001542806625366211 |
----------------------------------------------------------pseudo_mini_loss sum 0.9604220390319824
Total (block generation + training)time/epoch 8.71978975712568
Training time/epoch 0.3796272277832031
Training time without block to device /epoch 0.31655025482177734
Training time without total dataloading part /epoch 0.017652273178100586
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 47.11it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.92it/s]100%|██████████| 4/4 [00:00<00:00, 15.44it/s]100%|██████████| 4/4 [00:00<00:00, 15.35it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.41it/s]100%|██████████| 4/4 [00:00<00:00, 17.22it/s]100%|██████████| 4/4 [00:00<00:00, 17.23it/s]
Run 00 | Epoch 00096 | Loss 0.9604 | Train 0.2587 | Val 0.1984 | Test 0.1758
Number of nodes during this epoch:  335664
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17536211013793945  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02519965171813965
range selection method range initialization spend 0.011874675750732422
time for parepare:  0.017864465713500977
local_output_nid generation:  0.010795831680297852
local_in_edges_tensor generation:  0.013495922088623047
mini_batch_src_global generation:  0.017581462860107422
r_  generation:  0.207350492477417
local_output_nid generation:  0.01186060905456543
local_in_edges_tensor generation:  0.007222414016723633
mini_batch_src_global generation:  0.022414684295654297
r_  generation:  0.2204136848449707
----------------------check_connections_block total spend ----------------------------- 0.6139979362487793
generate_one_block  0.24733424186706543
generate_one_block  0.24710893630981445
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03971695899963379
gen group dst list time:  0.006384372711181641
time for parepare:  0.020046234130859375
local_output_nid generation:  0.01884007453918457
local_in_edges_tensor generation:  0.04435276985168457
mini_batch_src_global generation:  0.05927681922912598
r_  generation:  0.587308406829834
local_output_nid generation:  0.031899213790893555
local_in_edges_tensor generation:  0.03583550453186035
mini_batch_src_global generation:  0.06871604919433594
r_  generation:  0.6007242202758789
----------------------check_connections_block total spend ----------------------------- 1.7236392498016357
generate_one_block  0.7615616321563721
generate_one_block  0.756324291229248
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028162717819213867
gen group dst list time:  0.012069463729858398
time for parepare:  0.018352985382080078
local_output_nid generation:  0.025136947631835938
local_in_edges_tensor generation:  0.040784597396850586
mini_batch_src_global generation:  0.05476975440979004
r_  generation:  0.5953290462493896
local_output_nid generation:  0.03381180763244629
local_in_edges_tensor generation:  0.033125877380371094
mini_batch_src_global generation:  0.06856536865234375
r_  generation:  0.593956708908081
----------------------check_connections_block total spend ----------------------------- 1.7295863628387451
generate_one_block  0.7483577728271484
generate_one_block  0.7431004047393799
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17536211013793945  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.453225612640381
block generation total time  3.0093441009521484
average batch blocks generation time:  1.5046720504760742
block dataloader generation time/epoch 8.361744658513503
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12229108810424805  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3365988731384277  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12224054336547852  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3364877700805664  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08336365222930908 |0.025008440017700195 |0.0039103031158447266 |0.0005096197128295898 |0.0032002925872802734 |0.0013802051544189453 |
----------------------------------------------------------pseudo_mini_loss sum 0.9630241990089417
Total (block generation + training)time/epoch 8.719889123331416
Training time/epoch 0.34615230560302734
Training time without block to device /epoch 0.29613542556762695
Training time without total dataloading part /epoch 0.016620635986328125
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 51.65it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.06it/s]100%|██████████| 4/4 [00:00<00:00, 14.88it/s]100%|██████████| 4/4 [00:00<00:00, 14.89it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.02it/s]100%|██████████| 4/4 [00:00<00:00, 18.54it/s]
Run 00 | Epoch 00097 | Loss 0.9630 | Train 0.2584 | Val 0.1972 | Test 0.1747
Number of nodes during this epoch:  335604
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17535161972045898  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02437734603881836
range selection method range initialization spend 0.012071847915649414
time for parepare:  0.016147375106811523
local_output_nid generation:  0.01070404052734375
local_in_edges_tensor generation:  0.010298490524291992
mini_batch_src_global generation:  0.018266677856445312
r_  generation:  0.20724964141845703
local_output_nid generation:  0.01210165023803711
local_in_edges_tensor generation:  0.008356809616088867
mini_batch_src_global generation:  0.02210712432861328
r_  generation:  0.22088980674743652
----------------------check_connections_block total spend ----------------------------- 0.6105251312255859
generate_one_block  0.24548125267028809
generate_one_block  0.2464447021484375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03257155418395996
gen group dst list time:  0.006375551223754883
time for parepare:  0.02027583122253418
local_output_nid generation:  0.018314123153686523
local_in_edges_tensor generation:  0.04410099983215332
mini_batch_src_global generation:  0.05535387992858887
r_  generation:  0.633927583694458
local_output_nid generation:  0.03307938575744629
local_in_edges_tensor generation:  0.04121255874633789
mini_batch_src_global generation:  0.07173633575439453
r_  generation:  0.6008272171020508
----------------------check_connections_block total spend ----------------------------- 1.7765214443206787
generate_one_block  0.7564148902893066
generate_one_block  0.7508642673492432
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.031438589096069336
gen group dst list time:  0.012187004089355469
time for parepare:  0.01819586753845215
local_output_nid generation:  0.023309707641601562
local_in_edges_tensor generation:  0.03944683074951172
mini_batch_src_global generation:  0.061929941177368164
r_  generation:  0.5829110145568848
local_output_nid generation:  0.03295087814331055
local_in_edges_tensor generation:  0.035651445388793945
mini_batch_src_global generation:  0.06745409965515137
r_  generation:  0.5885765552520752
----------------------check_connections_block total spend ----------------------------- 1.7170145511627197
generate_one_block  0.730161190032959
generate_one_block  0.7320115566253662
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17535161972045898  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.4935359954833984
block generation total time  2.969451904296875
average batch blocks generation time:  1.4847259521484375
block dataloader generation time/epoch 8.36181207453267
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12227487564086914  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3365254402160645  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12224435806274414  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3324785232543945  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08189988136291504 |0.019429683685302734 |0.004049420356750488 |0.0005178451538085938 |0.00339353084564209 |0.0019533634185791016 |
----------------------------------------------------------pseudo_mini_loss sum 0.9580967426300049
Total (block generation + training)time/epoch 8.719635049948531
Training time/epoch 0.32937192916870117
Training time without block to device /epoch 0.2905125617980957
Training time without total dataloading part /epoch 0.017874956130981445
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 65.12it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.79it/s]100%|██████████| 4/4 [00:00<00:00, 15.07it/s]100%|██████████| 4/4 [00:00<00:00, 15.01it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.25it/s]100%|██████████| 4/4 [00:00<00:00, 17.14it/s]100%|██████████| 4/4 [00:00<00:00, 17.14it/s]
Run 00 | Epoch 00098 | Loss 0.9581 | Train 0.2581 | Val 0.1971 | Test 0.1743
Number of nodes during this epoch:  335688
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17539644241333008  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021821022033691406
range selection method range initialization spend 0.011991262435913086
time for parepare:  0.01630425453186035
local_output_nid generation:  0.011024713516235352
local_in_edges_tensor generation:  0.00952005386352539
mini_batch_src_global generation:  0.017169713973999023
r_  generation:  0.20787405967712402
local_output_nid generation:  0.012306451797485352
local_in_edges_tensor generation:  0.009214401245117188
mini_batch_src_global generation:  0.022263050079345703
r_  generation:  0.22951531410217285
----------------------check_connections_block total spend ----------------------------- 0.6220505237579346
generate_one_block  0.25540971755981445
generate_one_block  0.2690863609313965
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04910469055175781
gen group dst list time:  0.006304025650024414
time for parepare:  0.020823001861572266
local_output_nid generation:  0.02147531509399414
local_in_edges_tensor generation:  0.04709815979003906
mini_batch_src_global generation:  0.05948781967163086
r_  generation:  0.5897970199584961
local_output_nid generation:  0.030905961990356445
local_in_edges_tensor generation:  0.04249095916748047
mini_batch_src_global generation:  0.07253384590148926
r_  generation:  0.6016848087310791
----------------------check_connections_block total spend ----------------------------- 1.7445571422576904
generate_one_block  0.7568149566650391
generate_one_block  0.7611336708068848
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.035829782485961914
gen group dst list time:  0.012150764465332031
time for parepare:  0.018558263778686523
local_output_nid generation:  0.024134159088134766
local_in_edges_tensor generation:  0.04855513572692871
mini_batch_src_global generation:  0.05344653129577637
r_  generation:  0.5786423683166504
local_output_nid generation:  0.03297233581542969
local_in_edges_tensor generation:  0.04811573028564453
mini_batch_src_global generation:  0.0671072006225586
r_  generation:  0.5885438919067383
----------------------check_connections_block total spend ----------------------------- 1.728273868560791
generate_one_block  0.744473934173584
generate_one_block  0.7698142528533936
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.17539644241333008  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

connection checking time:  3.4728310108184814
block generation total time  3.0322368144989014
average batch blocks generation time:  1.5161184072494507
block dataloader generation time/epoch 8.362987282541063
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12224817276000977  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.336618423461914  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.12227106094360352  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.3364057540893555  GigaBytes
Max Memory Allocated: 1.6083927154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0840139389038086 |0.02123391628265381 |0.0041474103927612305 |0.0005183219909667969 |0.0037883520126342773 |0.003094196319580078 |
----------------------------------------------------------pseudo_mini_loss sum 0.9567899703979492
Total (block generation + training)time/epoch 8.720669232474433
Training time/epoch 0.3449678421020508
Training time without block to device /epoch 0.30250000953674316
Training time without total dataloading part /epoch 0.020002365112304688
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 51.06it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.49it/s]100%|██████████| 4/4 [00:00<00:00, 15.12it/s]100%|██████████| 4/4 [00:00<00:00, 15.00it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.28it/s]100%|██████████| 4/4 [00:00<00:00, 17.21it/s]100%|██████████| 4/4 [00:00<00:00, 17.20it/s]
Run 00 | Epoch 00099 | Loss 0.9568 | Train 0.2578 | Val 0.1980 | Test 0.1748
Number of nodes during this epoch:  335642
The number of model layers:  3
Run 01:
Highest Train: 43.78
Highest Valid: 52.90
  Final Train: 40.78
   Final Test: 54.53
The number of model layers:  3
All runs:
Highest Train: 43.78 ± nan
Highest Valid: 52.90 ± nan
  Final Train: 40.78 ± nan
   Final Test: 54.53 ± nan
