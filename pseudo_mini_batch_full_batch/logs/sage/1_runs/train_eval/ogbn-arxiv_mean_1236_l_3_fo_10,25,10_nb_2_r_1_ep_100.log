Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1647068684.6540585
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01316523551940918
range selection method range initialization spend 0.013907670974731445
time for parepare:  0.01709604263305664
local_output_nid generation:  0.010576248168945312
local_in_edges_tensor generation:  0.007333517074584961
mini_batch_src_global generation:  0.007839202880859375
r_  generation:  0.11489248275756836
local_output_nid generation:  0.011654853820800781
local_in_edges_tensor generation:  0.005079984664916992
mini_batch_src_global generation:  0.01071310043334961
r_  generation:  0.12423372268676758
----------------------check_connections_block total spend ----------------------------- 0.35706424713134766
generate_one_block  0.131242036819458
generate_one_block  0.1324605941772461
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03104567527770996
gen group dst list time:  0.0063359737396240234
time for parepare:  0.019574880599975586
local_output_nid generation:  0.014064311981201172
local_in_edges_tensor generation:  0.03572559356689453
mini_batch_src_global generation:  0.03609871864318848
r_  generation:  0.38117074966430664
local_output_nid generation:  0.023564577102661133
local_in_edges_tensor generation:  0.03508734703063965
mini_batch_src_global generation:  0.04165983200073242
r_  generation:  0.39261484146118164
----------------------check_connections_block total spend ----------------------------- 1.1493473052978516
generate_one_block  0.49314308166503906
generate_one_block  0.49671339988708496
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.020872116088867188
gen group dst list time:  0.011382341384887695
time for parepare:  0.01904296875
local_output_nid generation:  0.021414995193481445
local_in_edges_tensor generation:  0.03132987022399902
mini_batch_src_global generation:  0.02948474884033203
r_  generation:  0.37125468254089355
local_output_nid generation:  0.029436826705932617
local_in_edges_tensor generation:  0.03847312927246094
mini_batch_src_global generation:  0.03640341758728027
r_  generation:  0.38372111320495605
----------------------check_connections_block total spend ----------------------------- 1.1235973834991455
generate_one_block  0.469545841217041
generate_one_block  0.45201539993286133
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  2.272944688796997
block generation total time  1.9114177227020264
average batch blocks generation time:  0.9557088613510132
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1834716796875 GB
    Memory Allocated: 0.0975794792175293  GigaBytes
Max Memory Allocated: 0.0975794792175293  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7186279296875 GB
    Memory Allocated: 1.1695032119750977  GigaBytes
Max Memory Allocated: 1.2636852264404297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1541748046875 GB
    Memory Allocated: 0.1060638427734375  GigaBytes
Max Memory Allocated: 1.3849387168884277  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1541748046875 GB
    Memory Allocated: 1.1718153953552246  GigaBytes
Max Memory Allocated: 1.3849387168884277  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.046296119689941406 |0.15435075759887695 |0.4041299819946289 |0.0005986690521240234 |0.02479267120361328 |0.0037703514099121094 |
----------------------------------------------------------pseudo_mini_loss sum 6.036078453063965
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.01it/s]100%|██████████| 4/4 [00:00<00:00, 27.96it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.59it/s]100%|██████████| 4/4 [00:00<00:00, 11.97it/s]100%|██████████| 4/4 [00:00<00:00, 11.90it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.19it/s]100%|██████████| 4/4 [00:00<00:00, 17.88it/s]100%|██████████| 4/4 [00:00<00:00, 17.75it/s]
Run 00 | Epoch 00000 | Loss 6.0361 | Train 0.2925 | Val 0.3114 | Test 0.2851
Number of nodes during this epoch:  328616
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1619873046875 GB
    Memory Allocated: 0.13907432556152344  GigaBytes
Max Memory Allocated: 1.3872013092041016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018100261688232422
range selection method range initialization spend 0.023642778396606445
time for parepare:  0.020074129104614258
local_output_nid generation:  0.010756492614746094
local_in_edges_tensor generation:  0.029039382934570312
mini_batch_src_global generation:  0.007839202880859375
r_  generation:  0.11920809745788574
local_output_nid generation:  0.011594057083129883
local_in_edges_tensor generation:  0.009243249893188477
mini_batch_src_global generation:  0.010387420654296875
r_  generation:  0.12873435020446777
----------------------check_connections_block total spend ----------------------------- 0.4040951728820801
generate_one_block  0.13142013549804688
generate_one_block  0.13256502151489258
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0790712833404541
gen group dst list time:  0.006254911422729492
time for parepare:  0.02266097068786621
local_output_nid generation:  0.01401519775390625
local_in_edges_tensor generation:  0.05830526351928711
mini_batch_src_global generation:  0.05450320243835449
r_  generation:  0.38143134117126465
local_output_nid generation:  0.020786046981811523
local_in_edges_tensor generation:  0.034531593322753906
mini_batch_src_global generation:  0.0418543815612793
r_  generation:  0.3985748291015625
----------------------check_connections_block total spend ----------------------------- 1.1963872909545898
generate_one_block  0.506706953048706
generate_one_block  0.5086977481842041
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03334641456604004
gen group dst list time:  0.013184547424316406
time for parepare:  0.020366907119750977
local_output_nid generation:  0.021537065505981445
local_in_edges_tensor generation:  0.03892827033996582
mini_batch_src_global generation:  0.029732227325439453
r_  generation:  0.383026123046875
local_output_nid generation:  0.030200719833374023
local_in_edges_tensor generation:  0.04015755653381348
mini_batch_src_global generation:  0.04521989822387695
r_  generation:  0.40271735191345215
----------------------check_connections_block total spend ----------------------------- 1.1850833892822266
generate_one_block  0.49654603004455566
generate_one_block  0.4884934425354004
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1619873046875 GB
    Memory Allocated: 0.13907432556152344  GigaBytes
Max Memory Allocated: 1.3872013092041016  GigaBytes

connection checking time:  2.3814706802368164
block generation total time  2.000444173812866
average batch blocks generation time:  1.000222086906433
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1619873046875 GB
    Memory Allocated: 0.10683202743530273  GigaBytes
Max Memory Allocated: 1.3872013092041016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1619873046875 GB
    Memory Allocated: 1.1718549728393555  GigaBytes
Max Memory Allocated: 1.3872013092041016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1619873046875 GB
    Memory Allocated: 0.10680770874023438  GigaBytes
Max Memory Allocated: 1.3872013092041016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1619873046875 GB
    Memory Allocated: 1.1716761589050293  GigaBytes
Max Memory Allocated: 1.3872013092041016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08352327346801758 |0.019858479499816895 |0.014378070831298828 |0.0005085468292236328 |0.0036101341247558594 |0.0017042160034179688 |
----------------------------------------------------------pseudo_mini_loss sum 3.2405219078063965
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.37it/s]100%|██████████| 4/4 [00:00<00:00, 29.90it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.50it/s]100%|██████████| 4/4 [00:00<00:00, 12.73it/s]100%|██████████| 4/4 [00:00<00:00, 12.52it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.37it/s]100%|██████████| 4/4 [00:00<00:00, 21.02it/s]
Run 00 | Epoch 00001 | Loss 3.2405 | Train 0.3319 | Val 0.3752 | Test 0.4175
Number of nodes during this epoch:  328727
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13762903213500977  GigaBytes
Max Memory Allocated: 1.3872013092041016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.015174388885498047
range selection method range initialization spend 0.012861967086791992
time for parepare:  0.016614675521850586
local_output_nid generation:  0.010766744613647461
local_in_edges_tensor generation:  0.009861469268798828
mini_batch_src_global generation:  0.007991552352905273
r_  generation:  0.12673115730285645
local_output_nid generation:  0.012548685073852539
local_in_edges_tensor generation:  0.007872581481933594
mini_batch_src_global generation:  0.010810375213623047
r_  generation:  0.13356590270996094
----------------------check_connections_block total spend ----------------------------- 0.38893938064575195
generate_one_block  0.1345536708831787
generate_one_block  0.14313650131225586
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0351102352142334
gen group dst list time:  0.006192207336425781
time for parepare:  0.02020263671875
local_output_nid generation:  0.015333890914916992
local_in_edges_tensor generation:  0.043077707290649414
mini_batch_src_global generation:  0.034731149673461914
r_  generation:  0.41542673110961914
local_output_nid generation:  0.02204585075378418
local_in_edges_tensor generation:  0.03219938278198242
mini_batch_src_global generation:  0.052626848220825195
r_  generation:  0.4243004322052002
----------------------check_connections_block total spend ----------------------------- 1.2432887554168701
generate_one_block  0.5051412582397461
generate_one_block  0.5038864612579346
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.021073102951049805
gen group dst list time:  0.01239156723022461
time for parepare:  0.02035832405090332
local_output_nid generation:  0.0226595401763916
local_in_edges_tensor generation:  0.03516578674316406
mini_batch_src_global generation:  0.03042125701904297
r_  generation:  0.3744041919708252
local_output_nid generation:  0.030030488967895508
local_in_edges_tensor generation:  0.029984712600708008
mini_batch_src_global generation:  0.042502641677856445
r_  generation:  0.38773512840270996
----------------------check_connections_block total spend ----------------------------- 1.1392028331756592
generate_one_block  0.4716763496398926
generate_one_block  0.48057055473327637
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13762903213500977  GigaBytes
Max Memory Allocated: 1.3872013092041016  GigaBytes

connection checking time:  2.3824915885925293
block generation total time  1.9612746238708496
average batch blocks generation time:  0.9806373119354248
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10679006576538086  GigaBytes
Max Memory Allocated: 1.3872013092041016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1712665557861328  GigaBytes
Max Memory Allocated: 1.3872013092041016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10770750045776367  GigaBytes
Max Memory Allocated: 1.3872013092041016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1732230186462402  GigaBytes
Max Memory Allocated: 1.3872013092041016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07245099544525146 |0.023682475090026855 |0.004073500633239746 |0.0005053281784057617 |0.0035971403121948242 |0.0014042854309082031 |
----------------------------------------------------------pseudo_mini_loss sum 2.6500821113586426
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 57.46it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.45it/s]100%|██████████| 4/4 [00:00<00:00, 12.40it/s]100%|██████████| 4/4 [00:00<00:00, 12.24it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.94it/s]100%|██████████| 4/4 [00:00<00:00, 17.04it/s]100%|██████████| 4/4 [00:00<00:00, 17.00it/s]
Run 00 | Epoch 00002 | Loss 2.6501 | Train 0.3246 | Val 0.3342 | Test 0.3856
Number of nodes during this epoch:  328672
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1391162872314453  GigaBytes
Max Memory Allocated: 1.3884940147399902  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.011716604232788086
range selection method range initialization spend 0.012321949005126953
time for parepare:  0.016886234283447266
local_output_nid generation:  0.010790824890136719
local_in_edges_tensor generation:  0.00838923454284668
mini_batch_src_global generation:  0.010521173477172852
r_  generation:  0.11612677574157715
local_output_nid generation:  0.011697053909301758
local_in_edges_tensor generation:  0.005051136016845703
mini_batch_src_global generation:  0.01056361198425293
r_  generation:  0.12597274780273438
----------------------check_connections_block total spend ----------------------------- 0.36545491218566895
generate_one_block  0.1342484951019287
generate_one_block  0.13200807571411133
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028447628021240234
gen group dst list time:  0.006144285202026367
time for parepare:  0.0211944580078125
local_output_nid generation:  0.015529870986938477
local_in_edges_tensor generation:  0.027991771697998047
mini_batch_src_global generation:  0.03561592102050781
r_  generation:  0.3923459053039551
local_output_nid generation:  0.020834922790527344
local_in_edges_tensor generation:  0.024187564849853516
mini_batch_src_global generation:  0.04288601875305176
r_  generation:  0.4134938716888428
----------------------check_connections_block total spend ----------------------------- 1.1697580814361572
generate_one_block  0.5116024017333984
generate_one_block  0.5048341751098633
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.022742748260498047
gen group dst list time:  0.013106822967529297
time for parepare:  0.020542621612548828
local_output_nid generation:  0.02219533920288086
local_in_edges_tensor generation:  0.03679656982421875
mini_batch_src_global generation:  0.030986309051513672
r_  generation:  0.3771097660064697
local_output_nid generation:  0.030556678771972656
local_in_edges_tensor generation:  0.027719497680664062
mini_batch_src_global generation:  0.04489946365356445
r_  generation:  0.4035637378692627
----------------------check_connections_block total spend ----------------------------- 1.205310344696045
generate_one_block  0.4736752510070801
generate_one_block  0.45586419105529785
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1391162872314453  GigaBytes
Max Memory Allocated: 1.3884940147399902  GigaBytes

connection checking time:  2.375068426132202
block generation total time  1.9459760189056396
average batch blocks generation time:  0.9729880094528198
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10684347152709961  GigaBytes
Max Memory Allocated: 1.3884940147399902  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1710963249206543  GigaBytes
Max Memory Allocated: 1.3884940147399902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10680675506591797  GigaBytes
Max Memory Allocated: 1.3884940147399902  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1722264289855957  GigaBytes
Max Memory Allocated: 1.3884940147399902  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04531431198120117 |0.021029233932495117 |0.015342950820922852 |0.0004978179931640625 |0.03708505630493164 |0.0017542839050292969 |
----------------------------------------------------------pseudo_mini_loss sum 2.423368453979492
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.79it/s]100%|██████████| 4/4 [00:00<00:00, 28.89it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.31it/s]100%|██████████| 4/4 [00:00<00:00, 12.48it/s]100%|██████████| 4/4 [00:00<00:00, 12.28it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.11it/s]100%|██████████| 4/4 [00:00<00:00, 17.49it/s]100%|██████████| 4/4 [00:00<00:00, 17.41it/s]
Run 00 | Epoch 00003 | Loss 2.4234 | Train 0.4552 | Val 0.4971 | Test 0.5087
Number of nodes during this epoch:  328686
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13764238357543945  GigaBytes
Max Memory Allocated: 1.3884940147399902  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01199197769165039
range selection method range initialization spend 0.012270927429199219
time for parepare:  0.016632795333862305
local_output_nid generation:  0.010591506958007812
local_in_edges_tensor generation:  0.010390520095825195
mini_batch_src_global generation:  0.007912158966064453
r_  generation:  0.11891746520996094
local_output_nid generation:  0.011971473693847656
local_in_edges_tensor generation:  0.005407571792602539
mini_batch_src_global generation:  0.013211250305175781
r_  generation:  0.12587714195251465
----------------------check_connections_block total spend ----------------------------- 0.3695700168609619
generate_one_block  0.13779282569885254
generate_one_block  0.1326451301574707
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02985405921936035
gen group dst list time:  0.0061740875244140625
time for parepare:  0.019548892974853516
local_output_nid generation:  0.015818357467651367
local_in_edges_tensor generation:  0.0402989387512207
mini_batch_src_global generation:  0.03667283058166504
r_  generation:  0.4047667980194092
local_output_nid generation:  0.022086143493652344
local_in_edges_tensor generation:  0.024611949920654297
mini_batch_src_global generation:  0.043996572494506836
r_  generation:  0.4007384777069092
----------------------check_connections_block total spend ----------------------------- 1.1785860061645508
generate_one_block  0.49816131591796875
generate_one_block  0.4906177520751953
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02144765853881836
gen group dst list time:  0.011954784393310547
time for parepare:  0.019137144088745117
local_output_nid generation:  0.022797107696533203
local_in_edges_tensor generation:  0.03545045852661133
mini_batch_src_global generation:  0.03026270866394043
r_  generation:  0.37804365158081055
local_output_nid generation:  0.03318214416503906
local_in_edges_tensor generation:  0.029898881912231445
mini_batch_src_global generation:  0.03928065299987793
r_  generation:  0.3848536014556885
----------------------check_connections_block total spend ----------------------------- 1.136376142501831
generate_one_block  0.4514017105102539
generate_one_block  0.46912288665771484
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13764238357543945  GigaBytes
Max Memory Allocated: 1.3884940147399902  GigaBytes

connection checking time:  2.314962148666382
block generation total time  1.9093036651611328
average batch blocks generation time:  0.9546518325805664
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10769319534301758  GigaBytes
Max Memory Allocated: 1.3884940147399902  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1733851432800293  GigaBytes
Max Memory Allocated: 1.3884940147399902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10767698287963867  GigaBytes
Max Memory Allocated: 1.3887252807617188  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.173166275024414  GigaBytes
Max Memory Allocated: 1.3887252807617188  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09440028667449951 |0.021436214447021484 |0.00394439697265625 |0.0005179643630981445 |0.003128647804260254 |0.0015687942504882812 |
----------------------------------------------------------pseudo_mini_loss sum 2.120584011077881
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.23it/s]100%|██████████| 4/4 [00:00<00:00, 29.64it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.17it/s]100%|██████████| 4/4 [00:00<00:00, 12.24it/s]100%|██████████| 4/4 [00:00<00:00, 12.06it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.20it/s]100%|██████████| 4/4 [00:00<00:00, 19.04it/s]100%|██████████| 4/4 [00:00<00:00, 18.88it/s]
Run 00 | Epoch 00004 | Loss 2.1206 | Train 0.4479 | Val 0.4402 | Test 0.4163
Number of nodes during this epoch:  328628
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13904762268066406  GigaBytes
Max Memory Allocated: 1.3887252807617188  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.014245986938476562
range selection method range initialization spend 0.015816450119018555
time for parepare:  0.016649484634399414
local_output_nid generation:  0.010641336441040039
local_in_edges_tensor generation:  0.008714914321899414
mini_batch_src_global generation:  0.009662866592407227
r_  generation:  0.11896252632141113
local_output_nid generation:  0.011769533157348633
local_in_edges_tensor generation:  0.005048036575317383
mini_batch_src_global generation:  0.012340068817138672
r_  generation:  0.12540054321289062
----------------------check_connections_block total spend ----------------------------- 0.3689558506011963
generate_one_block  0.13864707946777344
generate_one_block  0.13280558586120605
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028299331665039062
gen group dst list time:  0.0061838626861572266
time for parepare:  0.01952648162841797
local_output_nid generation:  0.01588606834411621
local_in_edges_tensor generation:  0.02405381202697754
mini_batch_src_global generation:  0.03403306007385254
r_  generation:  0.38938069343566895
local_output_nid generation:  0.021674633026123047
local_in_edges_tensor generation:  0.02486276626586914
mini_batch_src_global generation:  0.042630910873413086
r_  generation:  0.41106390953063965
----------------------check_connections_block total spend ----------------------------- 1.1592717170715332
generate_one_block  0.5108997821807861
generate_one_block  0.5182554721832275
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0207064151763916
gen group dst list time:  0.013233423233032227
time for parepare:  0.020464181900024414
local_output_nid generation:  0.02358412742614746
local_in_edges_tensor generation:  0.04536247253417969
mini_batch_src_global generation:  0.031503915786743164
r_  generation:  0.39635276794433594
local_output_nid generation:  0.030895709991455078
local_in_edges_tensor generation:  0.03145480155944824
mini_batch_src_global generation:  0.038343191146850586
r_  generation:  0.38855695724487305
----------------------check_connections_block total spend ----------------------------- 1.1738417148590088
generate_one_block  0.466350793838501
generate_one_block  0.4762992858886719
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13904762268066406  GigaBytes
Max Memory Allocated: 1.3887252807617188  GigaBytes

connection checking time:  2.333113431930542
block generation total time  1.9718053340911865
average batch blocks generation time:  0.9859026670455933
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10682106018066406  GigaBytes
Max Memory Allocated: 1.3887252807617188  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.172938346862793  GigaBytes
Max Memory Allocated: 1.3887252807617188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10677671432495117  GigaBytes
Max Memory Allocated: 1.3887252807617188  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.171259880065918  GigaBytes
Max Memory Allocated: 1.3887252807617188  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0648113489151001 |0.01768660545349121 |0.016540884971618652 |0.0005676746368408203 |0.0034941434860229492 |0.0033156871795654297 |
----------------------------------------------------------pseudo_mini_loss sum 1.993056058883667
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 47.91it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.10it/s]100%|██████████| 4/4 [00:00<00:00, 15.26it/s]100%|██████████| 4/4 [00:00<00:00, 15.22it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.02it/s]100%|██████████| 4/4 [00:00<00:00, 17.69it/s]100%|██████████| 4/4 [00:00<00:00, 17.57it/s]
Run 00 | Epoch 00005 | Loss 1.9931 | Train 0.4420 | Val 0.4273 | Test 0.3952
Number of nodes during this epoch:  328577
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13761615753173828  GigaBytes
Max Memory Allocated: 1.3887252807617188  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.014559268951416016
range selection method range initialization spend 0.01204061508178711
time for parepare:  0.016818761825561523
local_output_nid generation:  0.01056361198425293
local_in_edges_tensor generation:  0.008745193481445312
mini_batch_src_global generation:  0.007979154586791992
r_  generation:  0.1170496940612793
local_output_nid generation:  0.011850833892822266
local_in_edges_tensor generation:  0.004992008209228516
mini_batch_src_global generation:  0.012956619262695312
r_  generation:  0.1265885829925537
----------------------check_connections_block total spend ----------------------------- 0.3656346797943115
generate_one_block  0.13556957244873047
generate_one_block  0.13155889511108398
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02783823013305664
gen group dst list time:  0.00615382194519043
time for parepare:  0.021317243576049805
local_output_nid generation:  0.015518665313720703
local_in_edges_tensor generation:  0.024532556533813477
mini_batch_src_global generation:  0.035361528396606445
r_  generation:  0.3918900489807129
local_output_nid generation:  0.024109363555908203
local_in_edges_tensor generation:  0.026166439056396484
mini_batch_src_global generation:  0.042742013931274414
r_  generation:  0.42832374572753906
----------------------check_connections_block total spend ----------------------------- 1.189122200012207
generate_one_block  0.5060763359069824
generate_one_block  0.5049183368682861
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.020940303802490234
gen group dst list time:  0.012103796005249023
time for parepare:  0.01881861686706543
local_output_nid generation:  0.021934032440185547
local_in_edges_tensor generation:  0.04696369171142578
mini_batch_src_global generation:  0.030321836471557617
r_  generation:  0.3883383274078369
local_output_nid generation:  0.030022382736206055
local_in_edges_tensor generation:  0.03177952766418457
mini_batch_src_global generation:  0.03756117820739746
r_  generation:  0.38744187355041504
----------------------check_connections_block total spend ----------------------------- 1.1591265201568604
generate_one_block  0.4566669464111328
generate_one_block  0.46944260597229004
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13761615753173828  GigaBytes
Max Memory Allocated: 1.3887252807617188  GigaBytes

connection checking time:  2.3482487201690674
block generation total time  1.9371042251586914
average batch blocks generation time:  0.9685521125793457
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10681676864624023  GigaBytes
Max Memory Allocated: 1.3887252807617188  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1718740463256836  GigaBytes
Max Memory Allocated: 1.3887252807617188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10765695571899414  GigaBytes
Max Memory Allocated: 1.3887252807617188  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1734910011291504  GigaBytes
Max Memory Allocated: 1.3887252807617188  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0878673791885376 |0.020946741104125977 |0.004311561584472656 |0.0005087852478027344 |0.0033997297286987305 |0.0014531612396240234 |
----------------------------------------------------------pseudo_mini_loss sum 1.899766445159912
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.29it/s]100%|██████████| 4/4 [00:00<00:00, 30.86it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.49it/s]100%|██████████| 4/4 [00:00<00:00, 12.58it/s]100%|██████████| 4/4 [00:00<00:00, 12.39it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.40it/s]100%|██████████| 4/4 [00:00<00:00, 17.56it/s]100%|██████████| 4/4 [00:00<00:00, 17.52it/s]
Run 00 | Epoch 00006 | Loss 1.8998 | Train 0.4389 | Val 0.4328 | Test 0.4016
Number of nodes during this epoch:  328549
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13899707794189453  GigaBytes
Max Memory Allocated: 1.3889131546020508  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.011799335479736328
range selection method range initialization spend 0.011979103088378906
time for parepare:  0.016845226287841797
local_output_nid generation:  0.010643243789672852
local_in_edges_tensor generation:  0.008759498596191406
mini_batch_src_global generation:  0.008068323135375977
r_  generation:  0.1153719425201416
local_output_nid generation:  0.011816978454589844
local_in_edges_tensor generation:  0.00507807731628418
mini_batch_src_global generation:  0.010564088821411133
r_  generation:  0.12222838401794434
----------------------check_connections_block total spend ----------------------------- 0.3570291996002197
generate_one_block  0.13371801376342773
generate_one_block  0.1316220760345459
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02906060218811035
gen group dst list time:  0.006337642669677734
time for parepare:  0.022419214248657227
local_output_nid generation:  0.018288135528564453
local_in_edges_tensor generation:  0.027226686477661133
mini_batch_src_global generation:  0.03435802459716797
r_  generation:  0.4118800163269043
local_output_nid generation:  0.020981311798095703
local_in_edges_tensor generation:  0.023622512817382812
mini_batch_src_global generation:  0.04248929023742676
r_  generation:  0.398240327835083
----------------------check_connections_block total spend ----------------------------- 1.171410083770752
generate_one_block  0.4850747585296631
generate_one_block  0.48534536361694336
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.017426252365112305
gen group dst list time:  0.011375188827514648
time for parepare:  0.019166946411132812
local_output_nid generation:  0.022813796997070312
local_in_edges_tensor generation:  0.030785083770751953
mini_batch_src_global generation:  0.02983379364013672
r_  generation:  0.37445974349975586
local_output_nid generation:  0.029651165008544922
local_in_edges_tensor generation:  0.028825759887695312
mini_batch_src_global generation:  0.03681468963623047
r_  generation:  0.3794217109680176
----------------------check_connections_block total spend ----------------------------- 1.1170463562011719
generate_one_block  0.4478483200073242
generate_one_block  0.4593064785003662
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13899707794189453  GigaBytes
Max Memory Allocated: 1.3889131546020508  GigaBytes

connection checking time:  2.288456439971924
block generation total time  1.8775749206542969
average batch blocks generation time:  0.9387874603271484
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10683012008666992  GigaBytes
Max Memory Allocated: 1.3889131546020508  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1694731712341309  GigaBytes
Max Memory Allocated: 1.3889131546020508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10680627822875977  GigaBytes
Max Memory Allocated: 1.3889131546020508  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1722187995910645  GigaBytes
Max Memory Allocated: 1.3889131546020508  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07407939434051514 |0.01448512077331543 |0.0043604373931884766 |0.0006086826324462891 |0.0032618045806884766 |0.0015766620635986328 |
----------------------------------------------------------pseudo_mini_loss sum 1.8169527053833008
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.84it/s]100%|██████████| 4/4 [00:00<00:00, 20.84it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.10it/s]100%|██████████| 4/4 [00:00<00:00, 12.27it/s]100%|██████████| 4/4 [00:00<00:00, 12.07it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.60it/s]100%|██████████| 4/4 [00:00<00:00, 20.26it/s]
Run 00 | Epoch 00007 | Loss 1.8170 | Train 0.4416 | Val 0.4523 | Test 0.4245
Number of nodes during this epoch:  328622
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13760852813720703  GigaBytes
Max Memory Allocated: 1.3889131546020508  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.011839151382446289
range selection method range initialization spend 0.012310028076171875
time for parepare:  0.017272233963012695
local_output_nid generation:  0.010912656784057617
local_in_edges_tensor generation:  0.012826204299926758
mini_batch_src_global generation:  0.0086669921875
r_  generation:  0.1174614429473877
local_output_nid generation:  0.012079954147338867
local_in_edges_tensor generation:  0.0069310665130615234
mini_batch_src_global generation:  0.010938882827758789
r_  generation:  0.13505816459655762
----------------------check_connections_block total spend ----------------------------- 0.3822166919708252
generate_one_block  0.13962388038635254
generate_one_block  0.13530731201171875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029205799102783203
gen group dst list time:  0.0065767765045166016
time for parepare:  0.02154231071472168
local_output_nid generation:  0.016314029693603516
local_in_edges_tensor generation:  0.026671648025512695
mini_batch_src_global generation:  0.04010772705078125
r_  generation:  0.3908092975616455
local_output_nid generation:  0.0223391056060791
local_in_edges_tensor generation:  0.03367948532104492
mini_batch_src_global generation:  0.062081336975097656
r_  generation:  0.4149947166442871
----------------------check_connections_block total spend ----------------------------- 1.2070660591125488
generate_one_block  0.513664722442627
generate_one_block  0.5091979503631592
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02135920524597168
gen group dst list time:  0.012527942657470703
time for parepare:  0.019388437271118164
local_output_nid generation:  0.02211165428161621
local_in_edges_tensor generation:  0.03571438789367676
mini_batch_src_global generation:  0.030331134796142578
r_  generation:  0.39423322677612305
local_output_nid generation:  0.031011104583740234
local_in_edges_tensor generation:  0.03209257125854492
mini_batch_src_global generation:  0.037616729736328125
r_  generation:  0.39275550842285156
----------------------check_connections_block total spend ----------------------------- 1.1566886901855469
generate_one_block  0.44376182556152344
generate_one_block  0.4626119136810303
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13760852813720703  GigaBytes
Max Memory Allocated: 1.3889131546020508  GigaBytes

connection checking time:  2.3637547492980957
block generation total time  1.9292364120483398
average batch blocks generation time:  0.9646182060241699
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10669469833374023  GigaBytes
Max Memory Allocated: 1.3889131546020508  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1671476364135742  GigaBytes
Max Memory Allocated: 1.3889131546020508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10771608352661133  GigaBytes
Max Memory Allocated: 1.3889131546020508  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1781001091003418  GigaBytes
Max Memory Allocated: 1.3889131546020508  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07581555843353271 |0.012796401977539062 |0.016298532485961914 |0.0005431175231933594 |0.003757476806640625 |0.0017461776733398438 |
----------------------------------------------------------pseudo_mini_loss sum 1.7229442596435547
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 55.49it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.31it/s]100%|██████████| 4/4 [00:00<00:00, 16.34it/s]100%|██████████| 4/4 [00:00<00:00, 16.31it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 13.93it/s]100%|██████████| 4/4 [00:00<00:00, 14.43it/s]100%|██████████| 4/4 [00:00<00:00, 14.33it/s]
Run 00 | Epoch 00008 | Loss 1.7229 | Train 0.4454 | Val 0.4812 | Test 0.4650
Number of nodes during this epoch:  328509
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13921737670898438  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.010726213455200195
range selection method range initialization spend 0.012365579605102539
time for parepare:  0.01672959327697754
local_output_nid generation:  0.010599851608276367
local_in_edges_tensor generation:  0.007995128631591797
mini_batch_src_global generation:  0.008493423461914062
r_  generation:  0.11673855781555176
local_output_nid generation:  0.01191091537475586
local_in_edges_tensor generation:  0.005404949188232422
mini_batch_src_global generation:  0.010809183120727539
r_  generation:  0.12826824188232422
----------------------check_connections_block total spend ----------------------------- 0.3672783374786377
generate_one_block  0.13308334350585938
generate_one_block  0.13153791427612305
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028308629989624023
gen group dst list time:  0.006209135055541992
time for parepare:  0.020630359649658203
local_output_nid generation:  0.015563726425170898
local_in_edges_tensor generation:  0.027219772338867188
mini_batch_src_global generation:  0.03464770317077637
r_  generation:  0.38988518714904785
local_output_nid generation:  0.021729230880737305
local_in_edges_tensor generation:  0.02516484260559082
mini_batch_src_global generation:  0.04375481605529785
r_  generation:  0.4146153926849365
----------------------check_connections_block total spend ----------------------------- 1.167804479598999
generate_one_block  0.49817800521850586
generate_one_block  0.5015945434570312
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01911640167236328
gen group dst list time:  0.01205587387084961
time for parepare:  0.018910646438598633
local_output_nid generation:  0.0221560001373291
local_in_edges_tensor generation:  0.028470993041992188
mini_batch_src_global generation:  0.030704021453857422
r_  generation:  0.37256479263305664
local_output_nid generation:  0.03254508972167969
local_in_edges_tensor generation:  0.031371355056762695
mini_batch_src_global generation:  0.03739571571350098
r_  generation:  0.39041709899902344
----------------------check_connections_block total spend ----------------------------- 1.1340749263763428
generate_one_block  0.4606614112854004
generate_one_block  0.445497989654541
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13921737670898438  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

connection checking time:  2.301879405975342
block generation total time  1.9059319496154785
average batch blocks generation time:  0.9529659748077393
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10676145553588867  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1715326309204102  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10676431655883789  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1682305335998535  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07897317409515381 |0.016706109046936035 |0.00416409969329834 |0.0005270242691040039 |0.003739476203918457 |0.0013713836669921875 |
----------------------------------------------------------pseudo_mini_loss sum 1.6513608694076538
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 51.20it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.81it/s]100%|██████████| 4/4 [00:00<00:00, 16.82it/s]100%|██████████| 4/4 [00:00<00:00, 16.64it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.04it/s]100%|██████████| 4/4 [00:00<00:00, 21.83it/s]
Run 00 | Epoch 00009 | Loss 1.6514 | Train 0.4518 | Val 0.5083 | Test 0.5039
Number of nodes during this epoch:  328426
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13773632049560547  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.013220071792602539
range selection method range initialization spend 0.01578378677368164
time for parepare:  0.016299009323120117
local_output_nid generation:  0.012150764465332031
local_in_edges_tensor generation:  0.010489702224731445
mini_batch_src_global generation:  0.008271217346191406
r_  generation:  0.11903190612792969
local_output_nid generation:  0.011913776397705078
local_in_edges_tensor generation:  0.005087614059448242
mini_batch_src_global generation:  0.01057577133178711
r_  generation:  0.12804484367370605
----------------------check_connections_block total spend ----------------------------- 0.3698463439941406
generate_one_block  0.1353161334991455
generate_one_block  0.13319873809814453
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.026759624481201172
gen group dst list time:  0.006178617477416992
time for parepare:  0.019700050354003906
local_output_nid generation:  0.01563239097595215
local_in_edges_tensor generation:  0.027516841888427734
mini_batch_src_global generation:  0.034169912338256836
r_  generation:  0.3999934196472168
local_output_nid generation:  0.02118515968322754
local_in_edges_tensor generation:  0.025367021560668945
mini_batch_src_global generation:  0.04847884178161621
r_  generation:  0.41992616653442383
----------------------check_connections_block total spend ----------------------------- 1.1964774131774902
generate_one_block  0.5100347995758057
generate_one_block  0.48650193214416504
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02060723304748535
gen group dst list time:  0.012789487838745117
time for parepare:  0.019352197647094727
local_output_nid generation:  0.022269248962402344
local_in_edges_tensor generation:  0.0415647029876709
mini_batch_src_global generation:  0.03000354766845703
r_  generation:  0.371748685836792
local_output_nid generation:  0.03023505210876465
local_in_edges_tensor generation:  0.029784679412841797
mini_batch_src_global generation:  0.03744649887084961
r_  generation:  0.43683505058288574
----------------------check_connections_block total spend ----------------------------- 1.1851115226745605
generate_one_block  0.4798588752746582
generate_one_block  0.46195006370544434
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13773632049560547  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

connection checking time:  2.381588935852051
block generation total time  1.9383456707000732
average batch blocks generation time:  0.9691728353500366
block dataloader generation time/epoch 5.671036958694458
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10692501068115234  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1767182350158691  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.107635498046875  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1685047149658203  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04607057571411133 |0.012256503105163574 |0.004126787185668945 |0.0005120038986206055 |0.03738236427307129 |0.0014660358428955078 |
----------------------------------------------------------pseudo_mini_loss sum 1.6131534576416016
Total (block generation + training)time/epoch 5.973679065704346
Training time/epoch 0.3024632930755615
Training time without block to device /epoch 0.2779502868652344
Training time without total dataloading part /epoch 0.08550834655761719
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.69it/s]100%|██████████| 4/4 [00:00<00:00, 30.07it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.65it/s]100%|██████████| 4/4 [00:00<00:00, 12.64it/s]100%|██████████| 4/4 [00:00<00:00, 12.47it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.50it/s]100%|██████████| 4/4 [00:00<00:00, 17.71it/s]100%|██████████| 4/4 [00:00<00:00, 17.66it/s]
Run 00 | Epoch 00010 | Loss 1.6132 | Train 0.4590 | Val 0.5205 | Test 0.5176
Number of nodes during this epoch:  328712
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13889789581298828  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.012135028839111328
range selection method range initialization spend 0.012003660202026367
time for parepare:  0.01682567596435547
local_output_nid generation:  0.01048421859741211
local_in_edges_tensor generation:  0.011148929595947266
mini_batch_src_global generation:  0.008073568344116211
r_  generation:  0.11578512191772461
local_output_nid generation:  0.011690616607666016
local_in_edges_tensor generation:  0.005109310150146484
mini_batch_src_global generation:  0.01043701171875
r_  generation:  0.1262037754058838
----------------------check_connections_block total spend ----------------------------- 0.36663031578063965
generate_one_block  0.12987160682678223
generate_one_block  0.13139843940734863
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.026693344116210938
gen group dst list time:  0.0061604976654052734
time for parepare:  0.020951271057128906
local_output_nid generation:  0.01548457145690918
local_in_edges_tensor generation:  0.030778884887695312
mini_batch_src_global generation:  0.03412318229675293
r_  generation:  0.38840818405151367
local_output_nid generation:  0.021213054656982422
local_in_edges_tensor generation:  0.023668766021728516
mini_batch_src_global generation:  0.04243040084838867
r_  generation:  0.40006470680236816
----------------------check_connections_block total spend ----------------------------- 1.147731065750122
generate_one_block  0.5020229816436768
generate_one_block  0.49001383781433105
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0169064998626709
gen group dst list time:  0.011500835418701172
time for parepare:  0.018964290618896484
local_output_nid generation:  0.022246599197387695
local_in_edges_tensor generation:  0.029488563537597656
mini_batch_src_global generation:  0.0318300724029541
r_  generation:  0.3878483772277832
local_output_nid generation:  0.03136634826660156
local_in_edges_tensor generation:  0.03067612648010254
mini_batch_src_global generation:  0.03770256042480469
r_  generation:  0.42485618591308594
----------------------check_connections_block total spend ----------------------------- 1.178835153579712
generate_one_block  0.4712815284729004
generate_one_block  0.46011900901794434
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13889789581298828  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

connection checking time:  2.326566219329834
block generation total time  1.9234373569488525
average batch blocks generation time:  0.9617186784744263
block dataloader generation time/epoch 5.619343638420105
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10685491561889648  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1682367324829102  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10678291320800781  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1713600158691406  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07148277759552002 |0.012473106384277344 |0.004015564918518066 |0.0005125999450683594 |0.003582477569580078 |0.0014617443084716797 |
----------------------------------------------------------pseudo_mini_loss sum 1.5535705089569092
Total (block generation + training)time/epoch 5.913737177848816
Training time/epoch 0.2859926223754883
Training time without block to device /epoch 0.2610464096069336
Training time without total dataloading part /epoch 0.017683029174804688
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 60.34it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.13it/s]100%|██████████| 4/4 [00:00<00:00, 17.18it/s]100%|██████████| 4/4 [00:00<00:00, 16.80it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.90it/s]100%|██████████| 4/4 [00:00<00:00, 17.74it/s]100%|██████████| 4/4 [00:00<00:00, 17.74it/s]
Run 00 | Epoch 00011 | Loss 1.5536 | Train 0.4624 | Val 0.5195 | Test 0.5128
Number of nodes during this epoch:  328511
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1375136375427246  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.011078357696533203
range selection method range initialization spend 0.01197195053100586
time for parepare:  0.01685357093811035
local_output_nid generation:  0.010969877243041992
local_in_edges_tensor generation:  0.010925531387329102
mini_batch_src_global generation:  0.008254528045654297
r_  generation:  0.11624908447265625
local_output_nid generation:  0.011902093887329102
local_in_edges_tensor generation:  0.005379199981689453
mini_batch_src_global generation:  0.010776281356811523
r_  generation:  0.12628793716430664
----------------------check_connections_block total spend ----------------------------- 0.3667147159576416
generate_one_block  0.12839674949645996
generate_one_block  0.13238024711608887
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02760934829711914
gen group dst list time:  0.006206989288330078
time for parepare:  0.0204317569732666
local_output_nid generation:  0.015800952911376953
local_in_edges_tensor generation:  0.027814388275146484
mini_batch_src_global generation:  0.03403496742248535
r_  generation:  0.4065132141113281
local_output_nid generation:  0.02187323570251465
local_in_edges_tensor generation:  0.020978450775146484
mini_batch_src_global generation:  0.04281187057495117
r_  generation:  0.4010348320007324
----------------------check_connections_block total spend ----------------------------- 1.1634645462036133
generate_one_block  0.49135613441467285
generate_one_block  0.5044271945953369
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.019116640090942383
gen group dst list time:  0.013393878936767578
time for parepare:  0.019170045852661133
local_output_nid generation:  0.02258920669555664
local_in_edges_tensor generation:  0.02861499786376953
mini_batch_src_global generation:  0.03001689910888672
r_  generation:  0.38207268714904785
local_output_nid generation:  0.031641244888305664
local_in_edges_tensor generation:  0.03381228446960449
mini_batch_src_global generation:  0.03802800178527832
r_  generation:  0.38660192489624023
----------------------check_connections_block total spend ----------------------------- 1.1346545219421387
generate_one_block  0.4630415439605713
generate_one_block  0.4522080421447754
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1375136375427246  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

connection checking time:  2.298119068145752
block generation total time  1.9110329151153564
average batch blocks generation time:  0.9555164575576782
block dataloader generation time/epoch 5.596604983011882
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10764455795288086  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1726274490356445  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10768651962280273  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1736068725585938  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07832491397857666 |0.011268019676208496 |0.004065871238708496 |0.0005328655242919922 |0.0036848783493041992 |0.0013957023620605469 |
----------------------------------------------------------pseudo_mini_loss sum 1.5192391872406006
Total (block generation + training)time/epoch 5.88677962621053
Training time/epoch 0.2815885543823242
Training time without block to device /epoch 0.2590525150299072
Training time without total dataloading part /epoch 0.017962932586669922
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 49.87it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.25it/s]100%|██████████| 4/4 [00:00<00:00, 17.84it/s]100%|██████████| 4/4 [00:00<00:00, 18.01it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.72it/s]100%|██████████| 4/4 [00:00<00:00, 19.68it/s]100%|██████████| 4/4 [00:00<00:00, 19.65it/s]
Run 00 | Epoch 00012 | Loss 1.5192 | Train 0.4579 | Val 0.5162 | Test 0.5062
Number of nodes during this epoch:  328569
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13904953002929688  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.010899066925048828
range selection method range initialization spend 0.011679649353027344
time for parepare:  0.01870870590209961
local_output_nid generation:  0.010650873184204102
local_in_edges_tensor generation:  0.00832819938659668
mini_batch_src_global generation:  0.008454561233520508
r_  generation:  0.12385439872741699
local_output_nid generation:  0.012703180313110352
local_in_edges_tensor generation:  0.005350351333618164
mini_batch_src_global generation:  0.010773420333862305
r_  generation:  0.12653112411499023
----------------------check_connections_block total spend ----------------------------- 0.3745279312133789
generate_one_block  0.1308753490447998
generate_one_block  0.13166522979736328
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0275423526763916
gen group dst list time:  0.006190776824951172
time for parepare:  0.021374940872192383
local_output_nid generation:  0.015275239944458008
local_in_edges_tensor generation:  0.029872894287109375
mini_batch_src_global generation:  0.036051034927368164
r_  generation:  0.38435816764831543
local_output_nid generation:  0.020981311798095703
local_in_edges_tensor generation:  0.02577495574951172
mini_batch_src_global generation:  0.04270482063293457
r_  generation:  0.3972361087799072
----------------------check_connections_block total spend ----------------------------- 1.142958164215088
generate_one_block  0.4824254512786865
generate_one_block  0.48523879051208496
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.019862651824951172
gen group dst list time:  0.01160740852355957
time for parepare:  0.019591569900512695
local_output_nid generation:  0.022317171096801758
local_in_edges_tensor generation:  0.029677867889404297
mini_batch_src_global generation:  0.030040264129638672
r_  generation:  0.37102413177490234
local_output_nid generation:  0.031803131103515625
local_in_edges_tensor generation:  0.027466297149658203
mini_batch_src_global generation:  0.037467002868652344
r_  generation:  0.3798329830169678
----------------------check_connections_block total spend ----------------------------- 1.1106717586517334
generate_one_block  0.45018863677978516
generate_one_block  0.44508814811706543
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13904953002929688  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

connection checking time:  2.2536299228668213
block generation total time  1.862941026687622
average batch blocks generation time:  0.931470513343811
block dataloader generation time/epoch 5.563358426094055
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10684347152709961  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1719379425048828  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10679864883422852  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1723213195800781  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07856869697570801 |0.010904073715209961 |0.004125237464904785 |0.0005463361740112305 |0.0038334131240844727 |0.00293731689453125 |
----------------------------------------------------------pseudo_mini_loss sum 1.4889087677001953
Total (block generation + training)time/epoch 5.852293252944946
Training time/epoch 0.2850656509399414
Training time without block to device /epoch 0.2632575035095215
Training time without total dataloading part /epoch 0.019947290420532227
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 52.79it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.03it/s]100%|██████████| 4/4 [00:00<00:00, 15.27it/s]100%|██████████| 4/4 [00:00<00:00, 15.22it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.15it/s]100%|██████████| 4/4 [00:00<00:00, 17.52it/s]100%|██████████| 4/4 [00:00<00:00, 17.44it/s]
Run 00 | Epoch 00013 | Loss 1.4889 | Train 0.4432 | Val 0.5104 | Test 0.5040
Number of nodes during this epoch:  328654
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13762950897216797  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.011622428894042969
range selection method range initialization spend 0.011842966079711914
time for parepare:  0.01694011688232422
local_output_nid generation:  0.01069951057434082
local_in_edges_tensor generation:  0.010614395141601562
mini_batch_src_global generation:  0.008203506469726562
r_  generation:  0.1159822940826416
local_output_nid generation:  0.0118865966796875
local_in_edges_tensor generation:  0.00500798225402832
mini_batch_src_global generation:  0.010574102401733398
r_  generation:  0.1261136531829834
----------------------check_connections_block total spend ----------------------------- 0.36446142196655273
generate_one_block  0.12955665588378906
generate_one_block  0.13124442100524902
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.027755022048950195
gen group dst list time:  0.006040811538696289
time for parepare:  0.022200345993041992
local_output_nid generation:  0.01606917381286621
local_in_edges_tensor generation:  0.03025364875793457
mini_batch_src_global generation:  0.035552024841308594
r_  generation:  0.38541460037231445
local_output_nid generation:  0.02129197120666504
local_in_edges_tensor generation:  0.02542901039123535
mini_batch_src_global generation:  0.04269051551818848
r_  generation:  0.40013599395751953
----------------------check_connections_block total spend ----------------------------- 1.1490623950958252
generate_one_block  0.48133420944213867
generate_one_block  0.48771023750305176
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02129817008972168
gen group dst list time:  0.011662721633911133
time for parepare:  0.019297361373901367
local_output_nid generation:  0.021511554718017578
local_in_edges_tensor generation:  0.029668807983398438
mini_batch_src_global generation:  0.03006911277770996
r_  generation:  0.37279295921325684
local_output_nid generation:  0.02996993064880371
local_in_edges_tensor generation:  0.03157186508178711
mini_batch_src_global generation:  0.037216901779174805
r_  generation:  0.3812844753265381
----------------------check_connections_block total spend ----------------------------- 1.1152002811431885
generate_one_block  0.45358800888061523
generate_one_block  0.45428895950317383
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13762950897216797  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

connection checking time:  2.2642626762390137
block generation total time  1.8769214153289795
average batch blocks generation time:  0.9384607076644897
block dataloader generation time/epoch 5.545683431625366
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10682344436645508  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.172037124633789  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10769462585449219  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1683955192565918  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07975029945373535 |0.011728286743164062 |0.0041817426681518555 |0.0005373954772949219 |0.0030755996704101562 |0.0014202594757080078 |
----------------------------------------------------------pseudo_mini_loss sum 1.4528083801269531
Total (block generation + training)time/epoch 5.835339498519898
Training time/epoch 0.292360782623291
Training time without block to device /epoch 0.2689042091369629
Training time without total dataloading part /epoch 0.017009735107421875
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.40it/s]100%|██████████| 4/4 [00:00<00:00, 29.94it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.47it/s]100%|██████████| 4/4 [00:00<00:00, 12.59it/s]100%|██████████| 4/4 [00:00<00:00, 12.39it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.30it/s]100%|██████████| 4/4 [00:00<00:00, 17.30it/s]100%|██████████| 4/4 [00:00<00:00, 17.28it/s]
Run 00 | Epoch 00014 | Loss 1.4528 | Train 0.4250 | Val 0.5107 | Test 0.5094
Number of nodes during this epoch:  328720
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1390237808227539  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.011603593826293945
range selection method range initialization spend 0.0124053955078125
time for parepare:  0.016556262969970703
local_output_nid generation:  0.010679483413696289
local_in_edges_tensor generation:  0.01137852668762207
mini_batch_src_global generation:  0.008202314376831055
r_  generation:  0.11977791786193848
local_output_nid generation:  0.011708498001098633
local_in_edges_tensor generation:  0.00536346435546875
mini_batch_src_global generation:  0.011685609817504883
r_  generation:  0.12504982948303223
----------------------check_connections_block total spend ----------------------------- 0.36926960945129395
generate_one_block  0.13050413131713867
generate_one_block  0.13095402717590332
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028408288955688477
gen group dst list time:  0.006114006042480469
time for parepare:  0.01988053321838379
local_output_nid generation:  0.01589488983154297
local_in_edges_tensor generation:  0.03466916084289551
mini_batch_src_global generation:  0.03589463233947754
r_  generation:  0.38607263565063477
local_output_nid generation:  0.021330595016479492
local_in_edges_tensor generation:  0.028417110443115234
mini_batch_src_global generation:  0.04474449157714844
r_  generation:  0.4040226936340332
----------------------check_connections_block total spend ----------------------------- 1.1617822647094727
generate_one_block  0.483447790145874
generate_one_block  0.4907224178314209
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.017633914947509766
gen group dst list time:  0.011687517166137695
time for parepare:  0.019548892974853516
local_output_nid generation:  0.022373199462890625
local_in_edges_tensor generation:  0.02980804443359375
mini_batch_src_global generation:  0.030843496322631836
r_  generation:  0.3721179962158203
local_output_nid generation:  0.02987813949584961
local_in_edges_tensor generation:  0.02676868438720703
mini_batch_src_global generation:  0.03741168975830078
r_  generation:  0.388685941696167
----------------------check_connections_block total spend ----------------------------- 1.1206409931182861
generate_one_block  0.45373058319091797
generate_one_block  0.45565056800842285
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1390237808227539  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

connection checking time:  2.282423257827759
block generation total time  1.8835513591766357
average batch blocks generation time:  0.9417756795883179
block dataloader generation time/epoch 5.534775575002034
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10686731338500977  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1712446212768555  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10683393478393555  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1722488403320312  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08174359798431396 |0.011030435562133789 |0.004125118255615234 |0.0005292892456054688 |0.001958131790161133 |0.0013704299926757812 |
----------------------------------------------------------pseudo_mini_loss sum 1.425307035446167
Total (block generation + training)time/epoch 5.825054446856181
Training time/epoch 0.2932407855987549
Training time without block to device /epoch 0.2711799144744873
Training time without total dataloading part /epoch 0.014595508575439453
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 53.37it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.89it/s]100%|██████████| 4/4 [00:00<00:00, 15.36it/s]100%|██████████| 4/4 [00:00<00:00, 15.27it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.21it/s]100%|██████████| 4/4 [00:00<00:00, 17.46it/s]100%|██████████| 4/4 [00:00<00:00, 17.41it/s]
Run 00 | Epoch 00015 | Loss 1.4253 | Train 0.4044 | Val 0.5110 | Test 0.5186
Number of nodes during this epoch:  328638
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13765335083007812  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.011973142623901367
range selection method range initialization spend 0.01158761978149414
time for parepare:  0.01691460609436035
local_output_nid generation:  0.010462284088134766
local_in_edges_tensor generation:  0.007791757583618164
mini_batch_src_global generation:  0.00838160514831543
r_  generation:  0.11950159072875977
local_output_nid generation:  0.011727571487426758
local_in_edges_tensor generation:  0.0052928924560546875
mini_batch_src_global generation:  0.011131525039672852
r_  generation:  0.12560248374938965
----------------------check_connections_block total spend ----------------------------- 0.3661613464355469
generate_one_block  0.12896370887756348
generate_one_block  0.13548564910888672
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.049198150634765625
gen group dst list time:  0.0060956478118896484
time for parepare:  0.019814252853393555
local_output_nid generation:  0.015231609344482422
local_in_edges_tensor generation:  0.023445606231689453
mini_batch_src_global generation:  0.034856557846069336
r_  generation:  0.3992767333984375
local_output_nid generation:  0.021317720413208008
local_in_edges_tensor generation:  0.02104353904724121
mini_batch_src_global generation:  0.04732036590576172
r_  generation:  0.40314221382141113
----------------------check_connections_block total spend ----------------------------- 1.1584758758544922
generate_one_block  0.49071621894836426
generate_one_block  0.5013952255249023
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.020936250686645508
gen group dst list time:  0.011759757995605469
time for parepare:  0.02029109001159668
local_output_nid generation:  0.021555185317993164
local_in_edges_tensor generation:  0.03726077079772949
mini_batch_src_global generation:  0.03104233741760254
r_  generation:  0.374666690826416
local_output_nid generation:  0.032063961029052734
local_in_edges_tensor generation:  0.03198504447937012
mini_batch_src_global generation:  0.03969573974609375
r_  generation:  0.38051629066467285
----------------------check_connections_block total spend ----------------------------- 1.1334538459777832
generate_one_block  0.4450387954711914
generate_one_block  0.45084571838378906
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13765335083007812  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

connection checking time:  2.2919297218322754
block generation total time  1.887995958328247
average batch blocks generation time:  0.9439979791641235
block dataloader generation time/epoch 5.5309441430228095
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1076502799987793  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.173161506652832  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10772705078125  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.173633098602295  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0781787633895874 |0.01468205451965332 |0.004024147987365723 |0.0005118846893310547 |0.0024901628494262695 |0.0013709068298339844 |
----------------------------------------------------------pseudo_mini_loss sum 1.392927885055542
Total (block generation + training)time/epoch 5.822507926395962
Training time/epoch 0.29911351203918457
Training time without block to device /epoch 0.26974940299987793
Training time without total dataloading part /epoch 0.015423297882080078
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.36it/s]100%|██████████| 4/4 [00:00<00:00, 30.39it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.35it/s]100%|██████████| 4/4 [00:00<00:00, 12.61it/s]100%|██████████| 4/4 [00:00<00:00, 12.40it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.21it/s]100%|██████████| 4/4 [00:00<00:00, 17.37it/s]100%|██████████| 4/4 [00:00<00:00, 17.33it/s]
Run 00 | Epoch 00016 | Loss 1.3929 | Train 0.3904 | Val 0.5124 | Test 0.5308
Number of nodes during this epoch:  328649
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13910245895385742  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.011226415634155273
range selection method range initialization spend 0.011761188507080078
time for parepare:  0.0169064998626709
local_output_nid generation:  0.010565996170043945
local_in_edges_tensor generation:  0.010828733444213867
mini_batch_src_global generation:  0.008248329162597656
r_  generation:  0.11580848693847656
local_output_nid generation:  0.012233495712280273
local_in_edges_tensor generation:  0.005170345306396484
mini_batch_src_global generation:  0.010895729064941406
r_  generation:  0.12501740455627441
----------------------check_connections_block total spend ----------------------------- 0.3638617992401123
generate_one_block  0.12979722023010254
generate_one_block  0.13181400299072266
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030093908309936523
gen group dst list time:  0.0060999393463134766
time for parepare:  0.01974630355834961
local_output_nid generation:  0.015607595443725586
local_in_edges_tensor generation:  0.030065536499023438
mini_batch_src_global generation:  0.034685373306274414
r_  generation:  0.38315773010253906
local_output_nid generation:  0.021253585815429688
local_in_edges_tensor generation:  0.021243572235107422
mini_batch_src_global generation:  0.04300713539123535
r_  generation:  0.39963555335998535
----------------------check_connections_block total spend ----------------------------- 1.1395888328552246
generate_one_block  0.4890933036804199
generate_one_block  0.48560667037963867
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.017324209213256836
gen group dst list time:  0.011611223220825195
time for parepare:  0.019170761108398438
local_output_nid generation:  0.022449970245361328
local_in_edges_tensor generation:  0.02919793128967285
mini_batch_src_global generation:  0.030562400817871094
r_  generation:  0.3701171875
local_output_nid generation:  0.03052997589111328
local_in_edges_tensor generation:  0.02561163902282715
mini_batch_src_global generation:  0.03831958770751953
r_  generation:  0.3789525032043457
----------------------check_connections_block total spend ----------------------------- 1.1081914901733398
generate_one_block  0.44019627571105957
generate_one_block  0.4489614963531494
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13910245895385742  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

connection checking time:  2.2477803230285645
block generation total time  1.8638577461242676
average batch blocks generation time:  0.9319288730621338
block dataloader generation time/epoch 5.51590234041214
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10677242279052734  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1723451614379883  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10687685012817383  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1716079711914062  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07590079307556152 |0.010735511779785156 |0.0038323402404785156 |0.0005135536193847656 |0.0020569562911987305 |0.0012960433959960938 |
----------------------------------------------------------pseudo_mini_loss sum 1.3731002807617188
Total (block generation + training)time/epoch 5.8057335913181305
Training time/epoch 0.2776181697845459
Training time without block to device /epoch 0.2561471462249756
Training time without total dataloading part /epoch 0.014101743698120117
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 66.90it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.04it/s]100%|██████████| 4/4 [00:00<00:00, 15.33it/s]100%|██████████| 4/4 [00:00<00:00, 15.27it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.22it/s]100%|██████████| 4/4 [00:00<00:00, 17.66it/s]100%|██████████| 4/4 [00:00<00:00, 17.57it/s]
Run 00 | Epoch 00017 | Loss 1.3731 | Train 0.3806 | Val 0.5119 | Test 0.5394
Number of nodes during this epoch:  328711
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13772344589233398  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.010735750198364258
range selection method range initialization spend 0.011772871017456055
time for parepare:  0.016376495361328125
local_output_nid generation:  0.010493993759155273
local_in_edges_tensor generation:  0.007075786590576172
mini_batch_src_global generation:  0.008085966110229492
r_  generation:  0.11507868766784668
local_output_nid generation:  0.01164698600769043
local_in_edges_tensor generation:  0.005024909973144531
mini_batch_src_global generation:  0.010504961013793945
r_  generation:  0.12388968467712402
----------------------check_connections_block total spend ----------------------------- 0.35825634002685547
generate_one_block  0.12892961502075195
generate_one_block  0.1326127052307129
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029343128204345703
gen group dst list time:  0.005921125411987305
time for parepare:  0.02059769630432129
local_output_nid generation:  0.015729904174804688
local_in_edges_tensor generation:  0.023316383361816406
mini_batch_src_global generation:  0.035491228103637695
r_  generation:  0.38726234436035156
local_output_nid generation:  0.021607637405395508
local_in_edges_tensor generation:  0.021779298782348633
mini_batch_src_global generation:  0.04677176475524902
r_  generation:  0.39977526664733887
----------------------check_connections_block total spend ----------------------------- 1.1447224617004395
generate_one_block  0.4902627468109131
generate_one_block  0.48435306549072266
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.018464088439941406
gen group dst list time:  0.011478900909423828
time for parepare:  0.01915717124938965
local_output_nid generation:  0.022519826889038086
local_in_edges_tensor generation:  0.03130602836608887
mini_batch_src_global generation:  0.03163480758666992
r_  generation:  0.3842000961303711
local_output_nid generation:  0.03198695182800293
local_in_edges_tensor generation:  0.03334641456604004
mini_batch_src_global generation:  0.04866671562194824
r_  generation:  0.38242244720458984
----------------------check_connections_block total spend ----------------------------- 1.1530520915985107
generate_one_block  0.4522826671600342
generate_one_block  0.4596548080444336
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13772344589233398  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

connection checking time:  2.29777455329895
block generation total time  1.8865532875061035
average batch blocks generation time:  0.9432766437530518
block dataloader generation time/epoch 5.507089879777697
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10678434371948242  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1714019775390625  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10772943496704102  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1740970611572266  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07377684116363525 |0.016295194625854492 |0.003913164138793945 |0.0005022287368774414 |0.002176046371459961 |0.0012922286987304688 |
----------------------------------------------------------pseudo_mini_loss sum 1.3582980632781982
Total (block generation + training)time/epoch 5.796948141521877
Training time/epoch 0.28990960121154785
Training time without block to device /epoch 0.25731921195983887
Training time without total dataloading part /epoch 0.014475107192993164
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 57.35it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.77it/s]100%|██████████| 4/4 [00:00<00:00, 15.19it/s]100%|██████████| 4/4 [00:00<00:00, 15.11it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.81it/s]100%|██████████| 4/4 [00:00<00:00, 17.16it/s]100%|██████████| 4/4 [00:00<00:00, 17.08it/s]
Run 00 | Epoch 00018 | Loss 1.3583 | Train 0.3731 | Val 0.5090 | Test 0.5397
Number of nodes during this epoch:  328649
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13906240463256836  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.010811090469360352
range selection method range initialization spend 0.012061834335327148
time for parepare:  0.015865325927734375
local_output_nid generation:  0.010554790496826172
local_in_edges_tensor generation:  0.011418819427490234
mini_batch_src_global generation:  0.008304834365844727
r_  generation:  0.11753344535827637
local_output_nid generation:  0.011609315872192383
local_in_edges_tensor generation:  0.005025386810302734
mini_batch_src_global generation:  0.01087641716003418
r_  generation:  0.1253643035888672
----------------------check_connections_block total spend ----------------------------- 0.3643801212310791
generate_one_block  0.127899169921875
generate_one_block  0.13236665725708008
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02914881706237793
gen group dst list time:  0.005830287933349609
time for parepare:  0.019812583923339844
local_output_nid generation:  0.015596866607666016
local_in_edges_tensor generation:  0.030383586883544922
mini_batch_src_global generation:  0.03467988967895508
r_  generation:  0.38422656059265137
local_output_nid generation:  0.02120518684387207
local_in_edges_tensor generation:  0.021620750427246094
mini_batch_src_global generation:  0.04306221008300781
r_  generation:  0.399716854095459
----------------------check_connections_block total spend ----------------------------- 1.140976905822754
generate_one_block  0.4892849922180176
generate_one_block  0.4900698661804199
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.018788576126098633
gen group dst list time:  0.011507272720336914
time for parepare:  0.01923823356628418
local_output_nid generation:  0.022901535034179688
local_in_edges_tensor generation:  0.029897451400756836
mini_batch_src_global generation:  0.031117916107177734
r_  generation:  0.37556934356689453
local_output_nid generation:  0.030913829803466797
local_in_edges_tensor generation:  0.025964021682739258
mini_batch_src_global generation:  0.038071632385253906
r_  generation:  0.37906646728515625
----------------------check_connections_block total spend ----------------------------- 1.114985466003418
generate_one_block  0.44564080238342285
generate_one_block  0.4520585536956787
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13906240463256836  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

connection checking time:  2.255962371826172
block generation total time  1.877054214477539
average batch blocks generation time:  0.9385271072387695
block dataloader generation time/epoch 5.497672080993652
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10677385330200195  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.170705795288086  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10689783096313477  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1726837158203125  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07704997062683105 |0.010825514793395996 |0.003915309906005859 |0.0005220174789428711 |0.0021349191665649414 |0.0013241767883300781 |
----------------------------------------------------------pseudo_mini_loss sum 1.3492908477783203
Total (block generation + training)time/epoch 5.78739173412323
Training time/epoch 0.2883782386779785
Training time without block to device /epoch 0.2667272090911865
Training time without total dataloading part /epoch 0.014468669891357422
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 60.81it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.98it/s]100%|██████████| 4/4 [00:00<00:00, 15.23it/s]100%|██████████| 4/4 [00:00<00:00, 15.17it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.05it/s]100%|██████████| 4/4 [00:00<00:00, 17.29it/s]100%|██████████| 4/4 [00:00<00:00, 17.24it/s]
Run 00 | Epoch 00019 | Loss 1.3493 | Train 0.3677 | Val 0.5063 | Test 0.5376
Number of nodes during this epoch:  328700
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13777637481689453  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.010591745376586914
range selection method range initialization spend 0.011702537536621094
time for parepare:  0.016605854034423828
local_output_nid generation:  0.010776996612548828
local_in_edges_tensor generation:  0.00705265998840332
mini_batch_src_global generation:  0.008340120315551758
r_  generation:  0.1179800033569336
local_output_nid generation:  0.012112855911254883
local_in_edges_tensor generation:  0.005100250244140625
mini_batch_src_global generation:  0.01094818115234375
r_  generation:  0.127701997756958
----------------------check_connections_block total spend ----------------------------- 0.36519813537597656
generate_one_block  0.12939000129699707
generate_one_block  0.13239121437072754
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0247194766998291
gen group dst list time:  0.0058705806732177734
time for parepare:  0.02007460594177246
local_output_nid generation:  0.015605449676513672
local_in_edges_tensor generation:  0.02372598648071289
mini_batch_src_global generation:  0.03505516052246094
r_  generation:  0.3876168727874756
local_output_nid generation:  0.022147655487060547
local_in_edges_tensor generation:  0.02135443687438965
mini_batch_src_global generation:  0.042723894119262695
r_  generation:  0.39928197860717773
----------------------check_connections_block total spend ----------------------------- 1.1401464939117432
generate_one_block  0.4977748394012451
generate_one_block  0.5146501064300537
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01891350746154785
gen group dst list time:  0.011487483978271484
time for parepare:  0.020179271697998047
local_output_nid generation:  0.024278640747070312
local_in_edges_tensor generation:  0.031514644622802734
mini_batch_src_global generation:  0.03091263771057129
r_  generation:  0.37567853927612305
local_output_nid generation:  0.031076669692993164
local_in_edges_tensor generation:  0.02607107162475586
mini_batch_src_global generation:  0.03815627098083496
r_  generation:  0.37853550910949707
----------------------check_connections_block total spend ----------------------------- 1.1187679767608643
generate_one_block  0.4471759796142578
generate_one_block  0.4475538730621338
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13777637481689453  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

connection checking time:  2.2589144706726074
block generation total time  1.9071547985076904
average batch blocks generation time:  0.9535773992538452
block dataloader generation time/epoch 5.491079352118752
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10769271850585938  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1736879348754883  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10768747329711914  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1724467277526855  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07570779323577881 |0.010984420776367188 |0.0038182735443115234 |0.0005199909210205078 |0.002045869827270508 |0.0012810230255126953 |
----------------------------------------------------------pseudo_mini_loss sum 1.331841230392456
Total (block generation + training)time/epoch 5.78087685324929
Training time/epoch 0.2904930114746094
Training time without block to device /epoch 0.268524169921875
Training time without total dataloading part /epoch 0.014049291610717773
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.05it/s]100%|██████████| 4/4 [00:00<00:00, 31.16it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.58it/s]100%|██████████| 4/4 [00:00<00:00, 12.63it/s]100%|██████████| 4/4 [00:00<00:00, 12.45it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.19it/s]100%|██████████| 4/4 [00:00<00:00, 17.39it/s]100%|██████████| 4/4 [00:00<00:00, 17.34it/s]
Run 00 | Epoch 00020 | Loss 1.3318 | Train 0.3674 | Val 0.5050 | Test 0.5364
Number of nodes during this epoch:  328665
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13905906677246094  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.009851217269897461
range selection method range initialization spend 0.011578798294067383
time for parepare:  0.01676154136657715
local_output_nid generation:  0.010658025741577148
local_in_edges_tensor generation:  0.00713348388671875
mini_batch_src_global generation:  0.008199691772460938
r_  generation:  0.1152806282043457
local_output_nid generation:  0.011922597885131836
local_in_edges_tensor generation:  0.005050182342529297
mini_batch_src_global generation:  0.010541915893554688
r_  generation:  0.12402701377868652
----------------------check_connections_block total spend ----------------------------- 0.35812973976135254
generate_one_block  0.12844038009643555
generate_one_block  0.13118767738342285
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.024260997772216797
gen group dst list time:  0.00579380989074707
time for parepare:  0.01978158950805664
local_output_nid generation:  0.016045808792114258
local_in_edges_tensor generation:  0.024835824966430664
mini_batch_src_global generation:  0.03473019599914551
r_  generation:  0.3840975761413574
local_output_nid generation:  0.021742820739746094
local_in_edges_tensor generation:  0.023967742919921875
mini_batch_src_global generation:  0.04294753074645996
r_  generation:  0.4046304225921631
----------------------check_connections_block total spend ----------------------------- 1.1439955234527588
generate_one_block  0.4880332946777344
generate_one_block  0.48755431175231934
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01806497573852539
gen group dst list time:  0.01142263412475586
time for parepare:  0.018994569778442383
local_output_nid generation:  0.02579045295715332
local_in_edges_tensor generation:  0.03167009353637695
mini_batch_src_global generation:  0.030785799026489258
r_  generation:  0.374514102935791
local_output_nid generation:  0.031740427017211914
local_in_edges_tensor generation:  0.0267333984375
mini_batch_src_global generation:  0.0377655029296875
r_  generation:  0.37979555130004883
----------------------check_connections_block total spend ----------------------------- 1.1200079917907715
generate_one_block  0.44733619689941406
generate_one_block  0.4551112651824951
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13905906677246094  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

connection checking time:  2.2640035152435303
block generation total time  1.878035068511963
average batch blocks generation time:  0.9390175342559814
block dataloader generation time/epoch 5.482653458913167
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10685873031616211  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.171656608581543  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10676383972167969  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1692147254943848  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07698929309844971 |0.012203812599182129 |0.0038312673568725586 |0.0005080699920654297 |0.0021942853927612305 |0.0012831687927246094 |
----------------------------------------------------------pseudo_mini_loss sum 1.308853030204773
Total (block generation + training)time/epoch 5.771846373875936
Training time/epoch 0.28246021270751953
Training time without block to device /epoch 0.2580525875091553
Training time without total dataloading part /epoch 0.014350414276123047
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 67.00it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.23it/s]100%|██████████| 4/4 [00:00<00:00, 15.35it/s]100%|██████████| 4/4 [00:00<00:00, 15.31it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.21it/s]100%|██████████| 4/4 [00:00<00:00, 17.19it/s]100%|██████████| 4/4 [00:00<00:00, 17.17it/s]
Run 00 | Epoch 00021 | Loss 1.3089 | Train 0.3700 | Val 0.5051 | Test 0.5361
Number of nodes during this epoch:  328547
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13759565353393555  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.009675979614257812
range selection method range initialization spend 0.011686086654663086
time for parepare:  0.015623331069946289
local_output_nid generation:  0.011177539825439453
local_in_edges_tensor generation:  0.007547616958618164
mini_batch_src_global generation:  0.008162975311279297
r_  generation:  0.11536431312561035
local_output_nid generation:  0.01170802116394043
local_in_edges_tensor generation:  0.0051364898681640625
mini_batch_src_global generation:  0.010591745376586914
r_  generation:  0.1247098445892334
----------------------check_connections_block total spend ----------------------------- 0.3591268062591553
generate_one_block  0.12926912307739258
generate_one_block  0.131483793258667
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.024538755416870117
gen group dst list time:  0.005665302276611328
time for parepare:  0.01970076560974121
local_output_nid generation:  0.015323638916015625
local_in_edges_tensor generation:  0.02378535270690918
mini_batch_src_global generation:  0.03471231460571289
r_  generation:  0.3916890621185303
local_output_nid generation:  0.021561145782470703
local_in_edges_tensor generation:  0.022718429565429688
mini_batch_src_global generation:  0.04480910301208496
r_  generation:  0.43059301376342773
----------------------check_connections_block total spend ----------------------------- 1.1794376373291016
generate_one_block  0.505620002746582
generate_one_block  0.4896280765533447
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.017878055572509766
gen group dst list time:  0.011328935623168945
time for parepare:  0.018900632858276367
local_output_nid generation:  0.02516651153564453
local_in_edges_tensor generation:  0.03717184066772461
mini_batch_src_global generation:  0.03124833106994629
r_  generation:  0.37704944610595703
local_output_nid generation:  0.030669212341308594
local_in_edges_tensor generation:  0.029352664947509766
mini_batch_src_global generation:  0.03770136833190918
r_  generation:  0.3785393238067627
----------------------check_connections_block total spend ----------------------------- 1.1312930583953857
generate_one_block  0.4454829692840576
generate_one_block  0.4624197483062744
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13759565353393555  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

connection checking time:  2.3107306957244873
block generation total time  1.9031507968902588
average batch blocks generation time:  0.9515753984451294
block dataloader generation time/epoch 5.481838171298687
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10766363143920898  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1739115715026855  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10765838623046875  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1737771034240723  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07405197620391846 |0.017064332962036133 |0.0037325620651245117 |0.0005095005035400391 |0.0019408464431762695 |0.0012633800506591797 |
----------------------------------------------------------pseudo_mini_loss sum 1.2921802997589111
Total (block generation + training)time/epoch 5.771345303608821
Training time/epoch 0.29318976402282715
Training time without block to device /epoch 0.2590610980987549
Training time without total dataloading part /epoch 0.01362919807434082
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 67.13it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.88it/s]100%|██████████| 4/4 [00:00<00:00, 15.29it/s]100%|██████████| 4/4 [00:00<00:00, 15.21it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.30it/s]100%|██████████| 4/4 [00:00<00:00, 17.45it/s]100%|██████████| 4/4 [00:00<00:00, 17.41it/s]
Run 00 | Epoch 00022 | Loss 1.2922 | Train 0.3740 | Val 0.5053 | Test 0.5353
Number of nodes during this epoch:  328534
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13904047012329102  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.010042905807495117
range selection method range initialization spend 0.011612415313720703
time for parepare:  0.01658010482788086
local_output_nid generation:  0.010452985763549805
local_in_edges_tensor generation:  0.010417938232421875
mini_batch_src_global generation:  0.008169412612915039
r_  generation:  0.11758232116699219
local_output_nid generation:  0.011862993240356445
local_in_edges_tensor generation:  0.0050737857818603516
mini_batch_src_global generation:  0.010641336441040039
r_  generation:  0.1265571117401123
----------------------check_connections_block total spend ----------------------------- 0.36577677726745605
generate_one_block  0.1300036907196045
generate_one_block  0.1330108642578125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0317385196685791
gen group dst list time:  0.00574803352355957
time for parepare:  0.019697904586791992
local_output_nid generation:  0.015554666519165039
local_in_edges_tensor generation:  0.028029918670654297
mini_batch_src_global generation:  0.03534579277038574
r_  generation:  0.3870880603790283
local_output_nid generation:  0.02147221565246582
local_in_edges_tensor generation:  0.021244525909423828
mini_batch_src_global generation:  0.04760575294494629
r_  generation:  0.39811062812805176
----------------------check_connections_block total spend ----------------------------- 1.146275281906128
generate_one_block  0.48829174041748047
generate_one_block  0.48705458641052246
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.019072294235229492
gen group dst list time:  0.011417388916015625
time for parepare:  0.01931595802307129
local_output_nid generation:  0.023396968841552734
local_in_edges_tensor generation:  0.030170202255249023
mini_batch_src_global generation:  0.031094789505004883
r_  generation:  0.37178897857666016
local_output_nid generation:  0.03103780746459961
local_in_edges_tensor generation:  0.027056217193603516
mini_batch_src_global generation:  0.037511587142944336
r_  generation:  0.38039493560791016
----------------------check_connections_block total spend ----------------------------- 1.1143310070037842
generate_one_block  0.44493961334228516
generate_one_block  0.44810032844543457
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13904047012329102  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

connection checking time:  2.260606288909912
block generation total time  1.8683862686157227
average batch blocks generation time:  0.9341931343078613
block dataloader generation time/epoch 5.476272106170654
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10681772232055664  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1723275184631348  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10683727264404297  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1707773208618164  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08176255226135254 |0.0107344388961792 |0.0039942264556884766 |0.0005207061767578125 |0.002375006675720215 |0.0013308525085449219 |
----------------------------------------------------------pseudo_mini_loss sum 1.2821831703186035
Total (block generation + training)time/epoch 5.7657623291015625
Training time/epoch 0.28912806510925293
Training time without block to device /epoch 0.26765918731689453
Training time without total dataloading part /epoch 0.01511073112487793
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 58.37it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.95it/s]100%|██████████| 4/4 [00:00<00:00, 15.47it/s]100%|██████████| 4/4 [00:00<00:00, 15.37it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.66it/s]100%|██████████| 4/4 [00:00<00:00, 17.80it/s]100%|██████████| 4/4 [00:00<00:00, 17.76it/s]
Run 00 | Epoch 00023 | Loss 1.2822 | Train 0.3785 | Val 0.5058 | Test 0.5342
Number of nodes during this epoch:  328669
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13767623901367188  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00969076156616211
range selection method range initialization spend 0.011552810668945312
time for parepare:  0.016185522079467773
local_output_nid generation:  0.010689973831176758
local_in_edges_tensor generation:  0.007128715515136719
mini_batch_src_global generation:  0.0082855224609375
r_  generation:  0.11530518531799316
local_output_nid generation:  0.011842489242553711
local_in_edges_tensor generation:  0.0051496028900146484
mini_batch_src_global generation:  0.010534286499023438
r_  generation:  0.1240379810333252
----------------------check_connections_block total spend ----------------------------- 0.3576548099517822
generate_one_block  0.13298845291137695
generate_one_block  0.1342921257019043
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.023759126663208008
gen group dst list time:  0.005820274353027344
time for parepare:  0.019756078720092773
local_output_nid generation:  0.015560626983642578
local_in_edges_tensor generation:  0.02307581901550293
mini_batch_src_global generation:  0.03542160987854004
r_  generation:  0.38509511947631836
local_output_nid generation:  0.022033214569091797
local_in_edges_tensor generation:  0.022978544235229492
mini_batch_src_global generation:  0.042571306228637695
r_  generation:  0.40043020248413086
----------------------check_connections_block total spend ----------------------------- 1.1368379592895508
generate_one_block  0.48603343963623047
generate_one_block  0.49253273010253906
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.017266273498535156
gen group dst list time:  0.011522054672241211
time for parepare:  0.01914191246032715
local_output_nid generation:  0.022705793380737305
local_in_edges_tensor generation:  0.029115915298461914
mini_batch_src_global generation:  0.03136563301086426
r_  generation:  0.37287425994873047
local_output_nid generation:  0.03059244155883789
local_in_edges_tensor generation:  0.027028322219848633
mini_batch_src_global generation:  0.037409067153930664
r_  generation:  0.38469791412353516
----------------------check_connections_block total spend ----------------------------- 1.1196441650390625
generate_one_block  0.44933390617370605
generate_one_block  0.4533109664916992
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13767623901367188  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

connection checking time:  2.2564821243286133
block generation total time  1.8812110424041748
average batch blocks generation time:  0.9406055212020874
block dataloader generation time/epoch 5.471697664260864
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10683488845825195  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.172029972076416  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10768747329711914  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1737289428710938  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0729302167892456 |0.0108109712600708 |0.0037764310836791992 |0.0004996061325073242 |0.0018314123153686523 |0.0012958049774169922 |
----------------------------------------------------------pseudo_mini_loss sum 1.265590786933899
Total (block generation + training)time/epoch 5.760649506251017
Training time/epoch 0.28133201599121094
Training time without block to device /epoch 0.25971007347106934
Training time without total dataloading part /epoch 0.013510704040527344
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 66.97it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.36it/s]100%|██████████| 4/4 [00:00<00:00, 15.29it/s]100%|██████████| 4/4 [00:00<00:00, 15.29it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.21it/s]100%|██████████| 4/4 [00:00<00:00, 17.46it/s]100%|██████████| 4/4 [00:00<00:00, 17.40it/s]
Run 00 | Epoch 00024 | Loss 1.2656 | Train 0.3831 | Val 0.5053 | Test 0.5322
Number of nodes during this epoch:  328650
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1390829086303711  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.011051416397094727
range selection method range initialization spend 0.011677265167236328
time for parepare:  0.01692986488342285
local_output_nid generation:  0.010717153549194336
local_in_edges_tensor generation:  0.007241487503051758
mini_batch_src_global generation:  0.008251190185546875
r_  generation:  0.11595797538757324
local_output_nid generation:  0.01167917251586914
local_in_edges_tensor generation:  0.005013465881347656
mini_batch_src_global generation:  0.010690927505493164
r_  generation:  0.126800537109375
----------------------check_connections_block total spend ----------------------------- 0.36179566383361816
generate_one_block  0.12868499755859375
generate_one_block  0.13115668296813965
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.022513866424560547
gen group dst list time:  0.0057468414306640625
time for parepare:  0.020075082778930664
local_output_nid generation:  0.01548147201538086
local_in_edges_tensor generation:  0.02317953109741211
mini_batch_src_global generation:  0.03523993492126465
r_  generation:  0.38471245765686035
local_output_nid generation:  0.021420001983642578
local_in_edges_tensor generation:  0.022334575653076172
mini_batch_src_global generation:  0.04361248016357422
r_  generation:  0.4360206127166748
----------------------check_connections_block total spend ----------------------------- 1.171785831451416
generate_one_block  0.4904036521911621
generate_one_block  0.49472618103027344
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.019591808319091797
gen group dst list time:  0.011426210403442383
time for parepare:  0.019824743270874023
local_output_nid generation:  0.022923946380615234
local_in_edges_tensor generation:  0.028410911560058594
mini_batch_src_global generation:  0.030795812606811523
r_  generation:  0.3744819164276123
local_output_nid generation:  0.03043365478515625
local_in_edges_tensor generation:  0.027331113815307617
mini_batch_src_global generation:  0.04051947593688965
r_  generation:  0.37824296951293945
----------------------check_connections_block total spend ----------------------------- 1.1146271228790283
generate_one_block  0.4448521137237549
generate_one_block  0.44431614875793457
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1390829086303711  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

connection checking time:  2.2864129543304443
block generation total time  1.874298095703125
average batch blocks generation time:  0.9371490478515625
block dataloader generation time/epoch 5.46769680082798
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10687017440795898  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1734733581542969  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10680723190307617  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1715068817138672  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07422232627868652 |0.011977553367614746 |0.003911256790161133 |0.0005221366882324219 |0.002094268798828125 |0.001291513442993164 |
----------------------------------------------------------pseudo_mini_loss sum 1.2527879476547241
Total (block generation + training)time/epoch 5.756724774837494
Training time/epoch 0.2900717258453369
Training time without block to device /epoch 0.2661166191101074
Training time without total dataloading part /epoch 0.014346837997436523
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 55.79it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.06it/s]100%|██████████| 4/4 [00:00<00:00, 15.48it/s]100%|██████████| 4/4 [00:00<00:00, 15.40it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.50it/s]100%|██████████| 4/4 [00:00<00:00, 17.55it/s]100%|██████████| 4/4 [00:00<00:00, 17.52it/s]
Run 00 | Epoch 00025 | Loss 1.2528 | Train 0.3884 | Val 0.5047 | Test 0.5312
Number of nodes during this epoch:  328676
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1376652717590332  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.014343976974487305
range selection method range initialization spend 0.011711597442626953
time for parepare:  0.01574230194091797
local_output_nid generation:  0.010504484176635742
local_in_edges_tensor generation:  0.008312225341796875
mini_batch_src_global generation:  0.008255958557128906
r_  generation:  0.11604475975036621
local_output_nid generation:  0.011919021606445312
local_in_edges_tensor generation:  0.005205392837524414
mini_batch_src_global generation:  0.010598421096801758
r_  generation:  0.1258244514465332
----------------------check_connections_block total spend ----------------------------- 0.3616042137145996
generate_one_block  0.13004541397094727
generate_one_block  0.13243603706359863
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.025044918060302734
gen group dst list time:  0.005644321441650391
time for parepare:  0.02206730842590332
local_output_nid generation:  0.015378236770629883
local_in_edges_tensor generation:  0.034932613372802734
mini_batch_src_global generation:  0.036972761154174805
r_  generation:  0.3860645294189453
local_output_nid generation:  0.021761417388916016
local_in_edges_tensor generation:  0.02094435691833496
mini_batch_src_global generation:  0.042311668395996094
r_  generation:  0.40123987197875977
----------------------check_connections_block total spend ----------------------------- 1.154524564743042
generate_one_block  0.49085378646850586
generate_one_block  0.4987034797668457
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.016543865203857422
gen group dst list time:  0.011438846588134766
time for parepare:  0.019044876098632812
local_output_nid generation:  0.022937774658203125
local_in_edges_tensor generation:  0.029091358184814453
mini_batch_src_global generation:  0.03088665008544922
r_  generation:  0.39591217041015625
local_output_nid generation:  0.030944347381591797
local_in_edges_tensor generation:  0.03189992904663086
mini_batch_src_global generation:  0.037459611892700195
r_  generation:  0.4213986396789551
----------------------check_connections_block total spend ----------------------------- 1.1855323314666748
generate_one_block  0.45265674591064453
generate_one_block  0.4555637836456299
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1376652717590332  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

connection checking time:  2.340056896209717
block generation total time  1.897777795791626
average batch blocks generation time:  0.948888897895813
block dataloader generation time/epoch 5.470600548912497
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10684776306152344  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1734271049499512  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10767126083374023  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1725945472717285  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08058750629425049 |0.011095404624938965 |0.004101753234863281 |0.0005439519882202148 |0.0023316144943237305 |0.001360177993774414 |
----------------------------------------------------------pseudo_mini_loss sum 1.2448959350585938
Total (block generation + training)time/epoch 5.759603163775275
Training time/epoch 0.28844213485717773
Training time without block to device /epoch 0.2662513256072998
Training time without total dataloading part /epoch 0.015314817428588867
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 57.40it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.80it/s]100%|██████████| 4/4 [00:00<00:00, 15.22it/s]100%|██████████| 4/4 [00:00<00:00, 15.14it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.81it/s]100%|██████████| 4/4 [00:00<00:00, 17.51it/s]100%|██████████| 4/4 [00:00<00:00, 17.54it/s]
Run 00 | Epoch 00026 | Loss 1.2449 | Train 0.3970 | Val 0.5068 | Test 0.5298
Number of nodes during this epoch:  328640
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13895893096923828  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01153421401977539
range selection method range initialization spend 0.011830806732177734
time for parepare:  0.015827417373657227
local_output_nid generation:  0.010758161544799805
local_in_edges_tensor generation:  0.007814645767211914
mini_batch_src_global generation:  0.008461475372314453
r_  generation:  0.1178901195526123
local_output_nid generation:  0.011783361434936523
local_in_edges_tensor generation:  0.005370616912841797
mini_batch_src_global generation:  0.01123046875
r_  generation:  0.12382102012634277
----------------------check_connections_block total spend ----------------------------- 0.361652135848999
generate_one_block  0.12948131561279297
generate_one_block  0.13118839263916016
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02633953094482422
gen group dst list time:  0.00564885139465332
time for parepare:  0.019634008407592773
local_output_nid generation:  0.015347719192504883
local_in_edges_tensor generation:  0.025425195693969727
mini_batch_src_global generation:  0.03536868095397949
r_  generation:  0.3875744342803955
local_output_nid generation:  0.0214691162109375
local_in_edges_tensor generation:  0.02388596534729004
mini_batch_src_global generation:  0.04292583465576172
r_  generation:  0.4005911350250244
----------------------check_connections_block total spend ----------------------------- 1.1437656879425049
generate_one_block  0.48717212677001953
generate_one_block  0.48712611198425293
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.019276142120361328
gen group dst list time:  0.01139068603515625
time for parepare:  0.018805742263793945
local_output_nid generation:  0.022644758224487305
local_in_edges_tensor generation:  0.030910968780517578
mini_batch_src_global generation:  0.0313410758972168
r_  generation:  0.38931727409362793
local_output_nid generation:  0.030790328979492188
local_in_edges_tensor generation:  0.027411222457885742
mini_batch_src_global generation:  0.037912607192993164
r_  generation:  0.3788645267486572
----------------------check_connections_block total spend ----------------------------- 1.1363282203674316
generate_one_block  0.4451131820678711
generate_one_block  0.4500424861907959
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13895893096923828  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

connection checking time:  2.2800939083099365
block generation total time  1.8694539070129395
average batch blocks generation time:  0.9347269535064697
block dataloader generation time/epoch 5.468921290503608
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10682249069213867  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1717596054077148  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1068563461303711  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1711668968200684  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07615029811859131 |0.010960936546325684 |0.0037964582443237305 |0.0005189180374145508 |0.0024186372756958008 |0.001285552978515625 |
----------------------------------------------------------pseudo_mini_loss sum 1.2306967973709106
Total (block generation + training)time/epoch 5.7574573622809515
Training time/epoch 0.2805213928222656
Training time without block to device /epoch 0.25859951972961426
Training time without total dataloading part /epoch 0.014753580093383789
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 64.23it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.87it/s]100%|██████████| 4/4 [00:00<00:00, 15.22it/s]100%|██████████| 4/4 [00:00<00:00, 15.15it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.86it/s]100%|██████████| 4/4 [00:00<00:00, 17.34it/s]100%|██████████| 4/4 [00:00<00:00, 17.25it/s]
Run 00 | Epoch 00027 | Loss 1.2307 | Train 0.4076 | Val 0.5074 | Test 0.5285
Number of nodes during this epoch:  328675
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13765382766723633  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.010257959365844727
range selection method range initialization spend 0.011610746383666992
time for parepare:  0.016490936279296875
local_output_nid generation:  0.010529041290283203
local_in_edges_tensor generation:  0.007354259490966797
mini_batch_src_global generation:  0.008117437362670898
r_  generation:  0.1167135238647461
local_output_nid generation:  0.01210474967956543
local_in_edges_tensor generation:  0.005078315734863281
mini_batch_src_global generation:  0.015051603317260742
r_  generation:  0.12958455085754395
----------------------check_connections_block total spend ----------------------------- 0.37143468856811523
generate_one_block  0.1293950080871582
generate_one_block  0.13304996490478516
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.027359485626220703
gen group dst list time:  0.005715608596801758
time for parepare:  0.020041227340698242
local_output_nid generation:  0.01519775390625
local_in_edges_tensor generation:  0.0263211727142334
mini_batch_src_global generation:  0.0352940559387207
r_  generation:  0.38948941230773926
local_output_nid generation:  0.022338151931762695
local_in_edges_tensor generation:  0.02669811248779297
mini_batch_src_global generation:  0.04812335968017578
r_  generation:  0.4219541549682617
----------------------check_connections_block total spend ----------------------------- 1.187342643737793
generate_one_block  0.5004959106445312
generate_one_block  0.4902350902557373
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.018892526626586914
gen group dst list time:  0.012312173843383789
time for parepare:  0.0194094181060791
local_output_nid generation:  0.021306514739990234
local_in_edges_tensor generation:  0.036737918853759766
mini_batch_src_global generation:  0.033925771713256836
r_  generation:  0.3730173110961914
local_output_nid generation:  0.029836177825927734
local_in_edges_tensor generation:  0.031951189041137695
mini_batch_src_global generation:  0.03768277168273926
r_  generation:  0.38289928436279297
----------------------check_connections_block total spend ----------------------------- 1.1305358409881592
generate_one_block  0.4430685043334961
generate_one_block  0.45096540451049805
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13765382766723633  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

connection checking time:  2.317878484725952
block generation total time  1.8847649097442627
average batch blocks generation time:  0.9423824548721313
block dataloader generation time/epoch 5.469096271615279
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10775375366210938  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1744132041931152  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1076345443725586  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.172043800354004  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.046930551528930664 |0.01173710823059082 |0.0040378570556640625 |0.0005216598510742188 |0.03599512577056885 |0.0013306140899658203 |
----------------------------------------------------------pseudo_mini_loss sum 1.2247438430786133
Total (block generation + training)time/epoch 5.757943642766852
Training time/epoch 0.2942960262298584
Training time without block to device /epoch 0.27082180976867676
Training time without total dataloading part /epoch 0.08243989944458008
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 47.52it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.99it/s]100%|██████████| 4/4 [00:00<00:00, 15.35it/s]100%|██████████| 4/4 [00:00<00:00, 15.28it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.95it/s]100%|██████████| 4/4 [00:00<00:00, 17.08it/s]100%|██████████| 4/4 [00:00<00:00, 17.05it/s]
Run 00 | Epoch 00028 | Loss 1.2247 | Train 0.4162 | Val 0.5067 | Test 0.5258
Number of nodes during this epoch:  328673
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13895750045776367  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.011404275894165039
range selection method range initialization spend 0.01177358627319336
time for parepare:  0.01590442657470703
local_output_nid generation:  0.01087188720703125
local_in_edges_tensor generation:  0.007238864898681641
mini_batch_src_global generation:  0.008229255676269531
r_  generation:  0.11699318885803223
local_output_nid generation:  0.011791467666625977
local_in_edges_tensor generation:  0.0050811767578125
mini_batch_src_global generation:  0.013350248336791992
r_  generation:  0.1307976245880127
----------------------check_connections_block total spend ----------------------------- 0.3693873882293701
generate_one_block  0.13468050956726074
generate_one_block  0.13182973861694336
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.027858972549438477
gen group dst list time:  0.005678415298461914
time for parepare:  0.019813060760498047
local_output_nid generation:  0.015472173690795898
local_in_edges_tensor generation:  0.024893522262573242
mini_batch_src_global generation:  0.03477311134338379
r_  generation:  0.39098095893859863
local_output_nid generation:  0.021627187728881836
local_in_edges_tensor generation:  0.021885395050048828
mini_batch_src_global generation:  0.04547619819641113
r_  generation:  0.39952516555786133
----------------------check_connections_block total spend ----------------------------- 1.14463210105896
generate_one_block  0.4890613555908203
generate_one_block  0.4883599281311035
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01840353012084961
gen group dst list time:  0.011531829833984375
time for parepare:  0.019151687622070312
local_output_nid generation:  0.022625207901000977
local_in_edges_tensor generation:  0.029062271118164062
mini_batch_src_global generation:  0.03100109100341797
r_  generation:  0.3768656253814697
local_output_nid generation:  0.030789852142333984
local_in_edges_tensor generation:  0.02606940269470215
mini_batch_src_global generation:  0.03811788558959961
r_  generation:  0.3869807720184326
----------------------check_connections_block total spend ----------------------------- 1.1242072582244873
generate_one_block  0.451416015625
generate_one_block  0.45624709129333496
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13895750045776367  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

connection checking time:  2.2688393592834473
block generation total time  1.8850843906402588
average batch blocks generation time:  0.9425421953201294
block dataloader generation time/epoch 5.4686687111854555
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10692691802978516  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.171919345855713  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1068415641784668  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1729669570922852  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0771867036819458 |0.012296795845031738 |0.0038930177688598633 |0.0005003213882446289 |0.002099156379699707 |0.001323699951171875 |
----------------------------------------------------------pseudo_mini_loss sum 1.2151777744293213
Total (block generation + training)time/epoch 5.757857084274292
Training time/epoch 0.29558515548706055
Training time without block to device /epoch 0.27099156379699707
Training time without total dataloading part /epoch 0.014308691024780273
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.65it/s]100%|██████████| 4/4 [00:00<00:00, 31.02it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.57it/s]100%|██████████| 4/4 [00:00<00:00, 10.23it/s]100%|██████████| 4/4 [00:00<00:00, 10.40it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.05it/s]100%|██████████| 4/4 [00:00<00:00, 17.30it/s]100%|██████████| 4/4 [00:00<00:00, 17.24it/s]
Run 00 | Epoch 00029 | Loss 1.2152 | Train 0.4219 | Val 0.5056 | Test 0.5216
Number of nodes during this epoch:  328741
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13770389556884766  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01324915885925293
range selection method range initialization spend 0.01345515251159668
time for parepare:  0.016155242919921875
local_output_nid generation:  0.010737180709838867
local_in_edges_tensor generation:  0.011270284652709961
mini_batch_src_global generation:  0.008317708969116211
r_  generation:  0.11649918556213379
local_output_nid generation:  0.011885404586791992
local_in_edges_tensor generation:  0.005064487457275391
mini_batch_src_global generation:  0.010643482208251953
r_  generation:  0.12627601623535156
----------------------check_connections_block total spend ----------------------------- 0.3657557964324951
generate_one_block  0.13071417808532715
generate_one_block  0.13237810134887695
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03498029708862305
gen group dst list time:  0.0056493282318115234
time for parepare:  0.020016908645629883
local_output_nid generation:  0.015526056289672852
local_in_edges_tensor generation:  0.03504610061645508
mini_batch_src_global generation:  0.037384986877441406
r_  generation:  0.3835151195526123
local_output_nid generation:  0.023188352584838867
local_in_edges_tensor generation:  0.021886110305786133
mini_batch_src_global generation:  0.04269719123840332
r_  generation:  0.4028615951538086
----------------------check_connections_block total spend ----------------------------- 1.1545369625091553
generate_one_block  0.48795032501220703
generate_one_block  0.48815274238586426
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.018085479736328125
gen group dst list time:  0.01139378547668457
time for parepare:  0.019952774047851562
local_output_nid generation:  0.022914886474609375
local_in_edges_tensor generation:  0.030490398406982422
mini_batch_src_global generation:  0.030779123306274414
r_  generation:  0.3706395626068115
local_output_nid generation:  0.032366037368774414
local_in_edges_tensor generation:  0.027210712432861328
mini_batch_src_global generation:  0.04040074348449707
r_  generation:  0.38532018661499023
----------------------check_connections_block total spend ----------------------------- 1.1245207786560059
generate_one_block  0.45963597297668457
generate_one_block  0.45853662490844727
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13770389556884766  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

connection checking time:  2.279057741165161
block generation total time  1.8942756652832031
average batch blocks generation time:  0.9471378326416016
block dataloader generation time/epoch 5.469501733779907
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10767602920532227  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1744561195373535  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10769033432006836  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.172935962677002  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08053922653198242 |0.012302994728088379 |0.00403439998626709 |0.0005176067352294922 |0.0023893117904663086 |0.001382589340209961 |
----------------------------------------------------------pseudo_mini_loss sum 1.204009771347046
Total (block generation + training)time/epoch 5.759090207871937
Training time/epoch 0.297435998916626
Training time without block to device /epoch 0.2728300094604492
Training time without total dataloading part /epoch 0.015265226364135742
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.56it/s]100%|██████████| 4/4 [00:00<00:00, 28.04it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.44it/s]100%|██████████| 4/4 [00:00<00:00, 11.90it/s]100%|██████████| 4/4 [00:00<00:00, 11.82it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.86it/s]100%|██████████| 4/4 [00:00<00:00, 17.22it/s]100%|██████████| 4/4 [00:00<00:00, 17.14it/s]
Run 00 | Epoch 00030 | Loss 1.2040 | Train 0.4244 | Val 0.5045 | Test 0.5178
Number of nodes during this epoch:  328616
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13902902603149414  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.011287450790405273
range selection method range initialization spend 0.011799097061157227
time for parepare:  0.01762866973876953
local_output_nid generation:  0.010813474655151367
local_in_edges_tensor generation:  0.00732421875
mini_batch_src_global generation:  0.008160829544067383
r_  generation:  0.11598372459411621
local_output_nid generation:  0.011647224426269531
local_in_edges_tensor generation:  0.005012989044189453
mini_batch_src_global generation:  0.010614395141601562
r_  generation:  0.12690424919128418
----------------------check_connections_block total spend ----------------------------- 0.36367130279541016
generate_one_block  0.13026213645935059
generate_one_block  0.1320791244506836
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02626204490661621
gen group dst list time:  0.005553483963012695
time for parepare:  0.019818782806396484
local_output_nid generation:  0.01573920249938965
local_in_edges_tensor generation:  0.03186917304992676
mini_batch_src_global generation:  0.035457611083984375
r_  generation:  0.39015913009643555
local_output_nid generation:  0.02193927764892578
local_in_edges_tensor generation:  0.023372650146484375
mini_batch_src_global generation:  0.042970895767211914
r_  generation:  0.4012868404388428
----------------------check_connections_block total spend ----------------------------- 1.152679443359375
generate_one_block  0.4881269931793213
generate_one_block  0.48665523529052734
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02616262435913086
gen group dst list time:  0.011462926864624023
time for parepare:  0.019184589385986328
local_output_nid generation:  0.022921323776245117
local_in_edges_tensor generation:  0.030133962631225586
mini_batch_src_global generation:  0.030939817428588867
r_  generation:  0.371110200881958
local_output_nid generation:  0.030321359634399414
local_in_edges_tensor generation:  0.026045560836791992
mini_batch_src_global generation:  0.03786969184875488
r_  generation:  0.37947702407836914
----------------------check_connections_block total spend ----------------------------- 1.1102869510650635
generate_one_block  0.44976282119750977
generate_one_block  0.44990992546081543
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13902902603149414  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

connection checking time:  2.2629663944244385
block generation total time  1.8744549751281738
average batch blocks generation time:  0.9372274875640869
block dataloader generation time/epoch 5.467838861725547
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10681915283203125  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1714553833007812  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10682535171508789  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1712932586669922  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07684528827667236 |0.01075887680053711 |0.003790616989135742 |0.0005109310150146484 |0.002104640007019043 |0.0012965202331542969 |
----------------------------------------------------------pseudo_mini_loss sum 1.1968636512756348
Total (block generation + training)time/epoch 5.757585753094066
Training time/epoch 0.29299163818359375
Training time without block to device /epoch 0.27147388458251953
Training time without total dataloading part /epoch 0.014108896255493164
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.92it/s]100%|██████████| 4/4 [00:00<00:00, 31.30it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.51it/s]100%|██████████| 4/4 [00:00<00:00, 12.61it/s]100%|██████████| 4/4 [00:00<00:00, 12.42it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.25it/s]100%|██████████| 4/4 [00:00<00:00, 17.45it/s]100%|██████████| 4/4 [00:00<00:00, 17.40it/s]
Run 00 | Epoch 00031 | Loss 1.1969 | Train 0.4249 | Val 0.5049 | Test 0.5161
Number of nodes during this epoch:  328697
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13759231567382812  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.010884523391723633
range selection method range initialization spend 0.011660099029541016
time for parepare:  0.01568770408630371
local_output_nid generation:  0.011060714721679688
local_in_edges_tensor generation:  0.007345914840698242
mini_batch_src_global generation:  0.00817728042602539
r_  generation:  0.11627554893493652
local_output_nid generation:  0.011675834655761719
local_in_edges_tensor generation:  0.004972696304321289
mini_batch_src_global generation:  0.010762929916381836
r_  generation:  0.12665462493896484
----------------------check_connections_block total spend ----------------------------- 0.36159229278564453
generate_one_block  0.13318324089050293
generate_one_block  0.1318359375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.025310516357421875
gen group dst list time:  0.005504608154296875
time for parepare:  0.01981067657470703
local_output_nid generation:  0.015959978103637695
local_in_edges_tensor generation:  0.023897647857666016
mini_batch_src_global generation:  0.035633087158203125
r_  generation:  0.38742733001708984
local_output_nid generation:  0.022217512130737305
local_in_edges_tensor generation:  0.02152848243713379
mini_batch_src_global generation:  0.043158769607543945
r_  generation:  0.4005599021911621
----------------------check_connections_block total spend ----------------------------- 1.141158103942871
generate_one_block  0.4874148368835449
generate_one_block  0.4831061363220215
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.018575668334960938
gen group dst list time:  0.011258602142333984
time for parepare:  0.019098997116088867
local_output_nid generation:  0.022917985916137695
local_in_edges_tensor generation:  0.028787851333618164
mini_batch_src_global generation:  0.03094172477722168
r_  generation:  0.37552356719970703
local_output_nid generation:  0.02959728240966797
local_in_edges_tensor generation:  0.026233196258544922
mini_batch_src_global generation:  0.03755044937133789
r_  generation:  0.37897396087646484
----------------------check_connections_block total spend ----------------------------- 1.1119585037231445
generate_one_block  0.44381260871887207
generate_one_block  0.47025227546691895
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13759231567382812  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

connection checking time:  2.2531166076660156
block generation total time  1.8845858573913574
average batch blocks generation time:  0.9422929286956787
block dataloader generation time/epoch 5.461040082185165
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10770797729492188  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.178983211517334  GigaBytes
Max Memory Allocated: 1.3952689170837402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10770654678344727  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1721220016479492  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07758486270904541 |0.010777115821838379 |0.003758668899536133 |0.03128337860107422 |0.002341628074645996 |0.0011909008026123047 |
----------------------------------------------------------pseudo_mini_loss sum 1.1868095397949219
Total (block generation + training)time/epoch 5.75153402660204
Training time/epoch 0.30684638023376465
Training time without block to device /epoch 0.2852921485900879
Training time without total dataloading part /epoch 0.075958251953125
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 65.09it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.68it/s]100%|██████████| 4/4 [00:00<00:00, 15.28it/s]100%|██████████| 4/4 [00:00<00:00, 15.17it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.43it/s]100%|██████████| 4/4 [00:00<00:00, 17.50it/s]100%|██████████| 4/4 [00:00<00:00, 17.47it/s]
Run 00 | Epoch 00032 | Loss 1.1868 | Train 0.4228 | Val 0.5050 | Test 0.5146
Number of nodes during this epoch:  328729
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1389775276184082  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01038050651550293
range selection method range initialization spend 0.011672258377075195
time for parepare:  0.015493154525756836
local_output_nid generation:  0.010905027389526367
local_in_edges_tensor generation:  0.007406473159790039
mini_batch_src_global generation:  0.00810384750366211
r_  generation:  0.11570525169372559
local_output_nid generation:  0.011638402938842773
local_in_edges_tensor generation:  0.005156040191650391
mini_batch_src_global generation:  0.010640382766723633
r_  generation:  0.12421941757202148
----------------------check_connections_block total spend ----------------------------- 0.3581206798553467
generate_one_block  0.1287708282470703
generate_one_block  0.13203978538513184
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02287435531616211
gen group dst list time:  0.005451202392578125
time for parepare:  0.01967167854309082
local_output_nid generation:  0.015343427658081055
local_in_edges_tensor generation:  0.02310466766357422
mini_batch_src_global generation:  0.03431582450866699
r_  generation:  0.38521766662597656
local_output_nid generation:  0.02243518829345703
local_in_edges_tensor generation:  0.02213764190673828
mini_batch_src_global generation:  0.04267287254333496
r_  generation:  0.39705991744995117
----------------------check_connections_block total spend ----------------------------- 1.1323413848876953
generate_one_block  0.48357629776000977
generate_one_block  0.4906346797943115
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01726055145263672
gen group dst list time:  0.011762380599975586
time for parepare:  0.01923823356628418
local_output_nid generation:  0.023239850997924805
local_in_edges_tensor generation:  0.030867576599121094
mini_batch_src_global generation:  0.030519723892211914
r_  generation:  0.3709146976470947
local_output_nid generation:  0.03001856803894043
local_in_edges_tensor generation:  0.02785015106201172
mini_batch_src_global generation:  0.03691673278808594
r_  generation:  0.3764059543609619
----------------------check_connections_block total spend ----------------------------- 1.1096999645233154
generate_one_block  0.44651079177856445
generate_one_block  0.4475674629211426
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1389775276184082  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.2420413494110107
block generation total time  1.8682892322540283
average batch blocks generation time:  0.9341446161270142
block dataloader generation time/epoch 5.453205982844035
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10680484771728516  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.171513557434082  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10677528381347656  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1720352172851562  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07602214813232422 |0.012141704559326172 |0.0037572383880615234 |0.0005247592926025391 |0.001857161521911621 |0.0012736320495605469 |
----------------------------------------------------------pseudo_mini_loss sum 1.177936315536499
Total (block generation + training)time/epoch 5.743841807047526
Training time/epoch 0.29381275177001953
Training time without block to device /epoch 0.2695293426513672
Training time without total dataloading part /epoch 0.013551950454711914
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 65.12it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.39it/s]100%|██████████| 4/4 [00:00<00:00, 15.53it/s]100%|██████████| 4/4 [00:00<00:00, 15.50it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.09it/s]100%|██████████| 4/4 [00:00<00:00, 17.65it/s]100%|██████████| 4/4 [00:00<00:00, 17.55it/s]
Run 00 | Epoch 00033 | Loss 1.1779 | Train 0.4211 | Val 0.5056 | Test 0.5135
Number of nodes during this epoch:  328490
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13759946823120117  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.010004758834838867
range selection method range initialization spend 0.011977434158325195
time for parepare:  0.0160214900970459
local_output_nid generation:  0.011231660842895508
local_in_edges_tensor generation:  0.007450580596923828
mini_batch_src_global generation:  0.008278608322143555
r_  generation:  0.11943244934082031
local_output_nid generation:  0.01201486587524414
local_in_edges_tensor generation:  0.005339860916137695
mini_batch_src_global generation:  0.01089620590209961
r_  generation:  0.12753677368164062
----------------------check_connections_block total spend ----------------------------- 0.3681783676147461
generate_one_block  0.12960433959960938
generate_one_block  0.13213896751403809
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.025360584259033203
gen group dst list time:  0.005511045455932617
time for parepare:  0.02009129524230957
local_output_nid generation:  0.01601123809814453
local_in_edges_tensor generation:  0.023583173751831055
mini_batch_src_global generation:  0.03451848030090332
r_  generation:  0.3861103057861328
local_output_nid generation:  0.022822141647338867
local_in_edges_tensor generation:  0.025273799896240234
mini_batch_src_global generation:  0.04230093955993652
r_  generation:  0.4026143550872803
----------------------check_connections_block total spend ----------------------------- 1.144428014755249
generate_one_block  0.5051083564758301
generate_one_block  0.4965858459472656
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01591777801513672
gen group dst list time:  0.012912511825561523
time for parepare:  0.019173622131347656
local_output_nid generation:  0.02656269073486328
local_in_edges_tensor generation:  0.03402066230773926
mini_batch_src_global generation:  0.032155513763427734
r_  generation:  0.3720698356628418
local_output_nid generation:  0.03012871742248535
local_in_edges_tensor generation:  0.02830052375793457
mini_batch_src_global generation:  0.037137746810913086
r_  generation:  0.3813822269439697
----------------------check_connections_block total spend ----------------------------- 1.1238727569580078
generate_one_block  0.4469594955444336
generate_one_block  0.4508354663848877
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13759946823120117  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.268300771713257
block generation total time  1.899489164352417
average batch blocks generation time:  0.9497445821762085
block dataloader generation time/epoch 5.451456098556519
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1077260971069336  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1731452941894531  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1076650619506836  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.169377326965332  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08040404319763184 |0.013714909553527832 |0.004039645195007324 |0.0005192756652832031 |0.0020328760147094727 |0.0020821094512939453 |
----------------------------------------------------------pseudo_mini_loss sum 1.1691405773162842
Total (block generation + training)time/epoch 5.742598571777344
Training time/epoch 0.3032221794128418
Training time without block to device /epoch 0.27579236030578613
Training time without total dataloading part /epoch 0.015265703201293945
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 53.67it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.17it/s]100%|██████████| 4/4 [00:00<00:00, 15.61it/s]100%|██████████| 4/4 [00:00<00:00, 15.52it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.96it/s]100%|██████████| 4/4 [00:00<00:00, 17.86it/s]100%|██████████| 4/4 [00:00<00:00, 17.85it/s]
Run 00 | Epoch 00034 | Loss 1.1691 | Train 0.4202 | Val 0.5059 | Test 0.5129
Number of nodes during this epoch:  328688
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13904953002929688  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.009633779525756836
range selection method range initialization spend 0.011677980422973633
time for parepare:  0.015769243240356445
local_output_nid generation:  0.011017322540283203
local_in_edges_tensor generation:  0.007638692855834961
mini_batch_src_global generation:  0.008265018463134766
r_  generation:  0.11660933494567871
local_output_nid generation:  0.01168966293334961
local_in_edges_tensor generation:  0.005227088928222656
mini_batch_src_global generation:  0.010869026184082031
r_  generation:  0.1251206398010254
----------------------check_connections_block total spend ----------------------------- 0.361499547958374
generate_one_block  0.1290454864501953
generate_one_block  0.1303117275238037
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.025292634963989258
gen group dst list time:  0.005364179611206055
time for parepare:  0.019804954528808594
local_output_nid generation:  0.015674591064453125
local_in_edges_tensor generation:  0.023795127868652344
mini_batch_src_global generation:  0.034745216369628906
r_  generation:  0.3932981491088867
local_output_nid generation:  0.022394180297851562
local_in_edges_tensor generation:  0.021500825881958008
mini_batch_src_global generation:  0.04199481010437012
r_  generation:  0.41686367988586426
----------------------check_connections_block total spend ----------------------------- 1.160829782485962
generate_one_block  0.5007648468017578
generate_one_block  0.48511600494384766
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.019274234771728516
gen group dst list time:  0.011420965194702148
time for parepare:  0.018946409225463867
local_output_nid generation:  0.023085594177246094
local_in_edges_tensor generation:  0.028898239135742188
mini_batch_src_global generation:  0.03054070472717285
r_  generation:  0.36696553230285645
local_output_nid generation:  0.03039836883544922
local_in_edges_tensor generation:  0.026981115341186523
mini_batch_src_global generation:  0.03685712814331055
r_  generation:  0.37538981437683105
----------------------check_connections_block total spend ----------------------------- 1.1002399921417236
generate_one_block  0.4424715042114258
generate_one_block  0.44390082359313965
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13904953002929688  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.2610697746276855
block generation total time  1.872253179550171
average batch blocks generation time:  0.9361265897750854
block dataloader generation time/epoch 5.448513801281269
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10691165924072266  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1724591255187988  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10679292678833008  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1719918251037598  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0759209394454956 |0.010887861251831055 |0.0037822723388671875 |0.0005129575729370117 |0.0019996166229248047 |0.0012903213500976562 |
----------------------------------------------------------pseudo_mini_loss sum 1.1623594760894775
Total (block generation + training)time/epoch 5.739034414291382
Training time/epoch 0.27488040924072266
Training time without block to device /epoch 0.25310468673706055
Training time without total dataloading part /epoch 0.013880014419555664
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 68.74it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.40it/s]100%|██████████| 4/4 [00:00<00:00, 15.49it/s]100%|██████████| 4/4 [00:00<00:00, 15.46it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.10it/s]100%|██████████| 4/4 [00:00<00:00, 17.38it/s]100%|██████████| 4/4 [00:00<00:00, 17.32it/s]
Run 00 | Epoch 00035 | Loss 1.1624 | Train 0.4204 | Val 0.5062 | Test 0.5139
Number of nodes during this epoch:  328666
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13759803771972656  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.013019084930419922
range selection method range initialization spend 0.011774063110351562
time for parepare:  0.015350818634033203
local_output_nid generation:  0.011267900466918945
local_in_edges_tensor generation:  0.007523059844970703
mini_batch_src_global generation:  0.00808858871459961
r_  generation:  0.11659502983093262
local_output_nid generation:  0.011807680130004883
local_in_edges_tensor generation:  0.0051746368408203125
mini_batch_src_global generation:  0.013039112091064453
r_  generation:  0.12250399589538574
----------------------check_connections_block total spend ----------------------------- 0.3604302406311035
generate_one_block  0.13240623474121094
generate_one_block  0.1343684196472168
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.022580623626708984
gen group dst list time:  0.005370616912841797
time for parepare:  0.019472122192382812
local_output_nid generation:  0.015674829483032227
local_in_edges_tensor generation:  0.023197174072265625
mini_batch_src_global generation:  0.034946441650390625
r_  generation:  0.38025927543640137
local_output_nid generation:  0.02223968505859375
local_in_edges_tensor generation:  0.021420717239379883
mini_batch_src_global generation:  0.04253721237182617
r_  generation:  0.3973405361175537
----------------------check_connections_block total spend ----------------------------- 1.1271488666534424
generate_one_block  0.48020505905151367
generate_one_block  0.48343753814697266
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.016835451126098633
gen group dst list time:  0.01146841049194336
time for parepare:  0.0193331241607666
local_output_nid generation:  0.0224761962890625
local_in_edges_tensor generation:  0.028953075408935547
mini_batch_src_global generation:  0.030634641647338867
r_  generation:  0.36925458908081055
local_output_nid generation:  0.030130863189697266
local_in_edges_tensor generation:  0.025266170501708984
mini_batch_src_global generation:  0.0367436408996582
r_  generation:  0.37551116943359375
----------------------check_connections_block total spend ----------------------------- 1.0997223854064941
generate_one_block  0.4415714740753174
generate_one_block  0.4430654048919678
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13759803771972656  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.2268712520599365
block generation total time  1.8482794761657715
average batch blocks generation time:  0.9241397380828857
block dataloader generation time/epoch 5.443332495512785
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1076664924621582  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1731586456298828  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10768795013427734  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.174178123474121  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07688140869140625 |0.010732889175415039 |0.0037992000579833984 |0.0005125999450683594 |0.001941680908203125 |0.001306295394897461 |
----------------------------------------------------------pseudo_mini_loss sum 1.1556674242019653
Total (block generation + training)time/epoch 5.733933060257523
Training time/epoch 0.29259610176086426
Training time without block to device /epoch 0.2711303234100342
Training time without total dataloading part /epoch 0.013813257217407227
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 66.14it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.30it/s]100%|██████████| 4/4 [00:00<00:00, 15.56it/s]100%|██████████| 4/4 [00:00<00:00, 15.51it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.44it/s]100%|██████████| 4/4 [00:00<00:00, 17.74it/s]100%|██████████| 4/4 [00:00<00:00, 17.67it/s]
Run 00 | Epoch 00036 | Loss 1.1557 | Train 0.4201 | Val 0.5056 | Test 0.5132
Number of nodes during this epoch:  328587
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1391444206237793  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.009527206420898438
range selection method range initialization spend 0.011586427688598633
time for parepare:  0.015807390213012695
local_output_nid generation:  0.011077642440795898
local_in_edges_tensor generation:  0.0074770450592041016
mini_batch_src_global generation:  0.008173227310180664
r_  generation:  0.11465930938720703
local_output_nid generation:  0.011887311935424805
local_in_edges_tensor generation:  0.00517725944519043
mini_batch_src_global generation:  0.010942220687866211
r_  generation:  0.12399864196777344
----------------------check_connections_block total spend ----------------------------- 0.3582749366760254
generate_one_block  0.128037691116333
generate_one_block  0.13056468963623047
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.022122859954833984
gen group dst list time:  0.005440711975097656
time for parepare:  0.019602298736572266
local_output_nid generation:  0.015784740447998047
local_in_edges_tensor generation:  0.023389101028442383
mini_batch_src_global generation:  0.03535771369934082
r_  generation:  0.38307952880859375
local_output_nid generation:  0.022281169891357422
local_in_edges_tensor generation:  0.02126932144165039
mini_batch_src_global generation:  0.042324066162109375
r_  generation:  0.3958003520965576
----------------------check_connections_block total spend ----------------------------- 1.1299951076507568
generate_one_block  0.48235583305358887
generate_one_block  0.4857919216156006
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.016683340072631836
gen group dst list time:  0.011448860168457031
time for parepare:  0.018668651580810547
local_output_nid generation:  0.022607088088989258
local_in_edges_tensor generation:  0.028902053833007812
mini_batch_src_global generation:  0.031188249588012695
r_  generation:  0.37116312980651855
local_output_nid generation:  0.030448198318481445
local_in_edges_tensor generation:  0.02547001838684082
mini_batch_src_global generation:  0.03759050369262695
r_  generation:  0.37847328186035156
----------------------check_connections_block total spend ----------------------------- 1.106889247894287
generate_one_block  0.4417421817779541
generate_one_block  0.4421956539154053
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1391444206237793  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.236884355545044
block generation total time  1.8520855903625488
average batch blocks generation time:  0.9260427951812744
block dataloader generation time/epoch 5.438278641019549
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1067667007446289  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.171895980834961  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10681533813476562  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.172339916229248  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07655811309814453 |0.01084589958190918 |0.0037615299224853516 |0.0005123615264892578 |0.0022401809692382812 |0.00127410888671875 |
----------------------------------------------------------pseudo_mini_loss sum 1.1488333940505981
Total (block generation + training)time/epoch 5.7289388690676
Training time/epoch 0.2921864986419678
Training time without block to device /epoch 0.2704946994781494
Training time without total dataloading part /epoch 0.014302253723144531
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 67.34it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.07it/s]100%|██████████| 4/4 [00:00<00:00, 15.62it/s]100%|██████████| 4/4 [00:00<00:00, 15.52it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.37it/s]100%|██████████| 4/4 [00:00<00:00, 17.82it/s]100%|██████████| 4/4 [00:00<00:00, 17.74it/s]
Run 00 | Epoch 00037 | Loss 1.1488 | Train 0.4179 | Val 0.5041 | Test 0.5104
Number of nodes during this epoch:  328544
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13767623901367188  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.009998083114624023
range selection method range initialization spend 0.011563777923583984
time for parepare:  0.015589714050292969
local_output_nid generation:  0.011461973190307617
local_in_edges_tensor generation:  0.007321596145629883
mini_batch_src_global generation:  0.008177995681762695
r_  generation:  0.11700201034545898
local_output_nid generation:  0.012114524841308594
local_in_edges_tensor generation:  0.005128145217895508
mini_batch_src_global generation:  0.010872602462768555
r_  generation:  0.12802600860595703
----------------------check_connections_block total spend ----------------------------- 0.3652305603027344
generate_one_block  0.13006067276000977
generate_one_block  0.13194775581359863
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.022661447525024414
gen group dst list time:  0.005354881286621094
time for parepare:  0.020300626754760742
local_output_nid generation:  0.015237569808959961
local_in_edges_tensor generation:  0.023400306701660156
mini_batch_src_global generation:  0.03509330749511719
r_  generation:  0.39336299896240234
local_output_nid generation:  0.021604299545288086
local_in_edges_tensor generation:  0.021405458450317383
mini_batch_src_global generation:  0.04294300079345703
r_  generation:  0.39807891845703125
----------------------check_connections_block total spend ----------------------------- 1.1418685913085938
generate_one_block  0.48413848876953125
generate_one_block  0.482799768447876
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.016856670379638672
gen group dst list time:  0.011391401290893555
time for parepare:  0.018718957901000977
local_output_nid generation:  0.02213883399963379
local_in_edges_tensor generation:  0.029012441635131836
mini_batch_src_global generation:  0.03075122833251953
r_  generation:  0.37114524841308594
local_output_nid generation:  0.029537439346313477
local_in_edges_tensor generation:  0.02557063102722168
mini_batch_src_global generation:  0.03760957717895508
r_  generation:  0.38135218620300293
----------------------check_connections_block total spend ----------------------------- 1.108447790145874
generate_one_block  0.4470980167388916
generate_one_block  0.447906494140625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13767623901367188  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.2503163814544678
block generation total time  1.8619427680969238
average batch blocks generation time:  0.9309713840484619
block dataloader generation time/epoch 5.434766621425234
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10677671432495117  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1689696311950684  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10767889022827148  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1732077598571777  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07735109329223633 |0.010783910751342773 |0.0037652254104614258 |0.0005210638046264648 |0.0020259618759155273 |0.0012712478637695312 |
----------------------------------------------------------pseudo_mini_loss sum 1.1421763896942139
Total (block generation + training)time/epoch 5.7251697408741915
Training time/epoch 0.283123254776001
Training time without block to device /epoch 0.26155543327331543
Training time without total dataloading part /epoch 0.013895750045776367
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.35it/s]100%|██████████| 4/4 [00:00<00:00, 31.86it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.68it/s]100%|██████████| 4/4 [00:00<00:00, 12.79it/s]100%|██████████| 4/4 [00:00<00:00, 12.60it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.58it/s]100%|██████████| 4/4 [00:00<00:00, 17.76it/s]100%|██████████| 4/4 [00:00<00:00, 17.71it/s]
Run 00 | Epoch 00038 | Loss 1.1422 | Train 0.4140 | Val 0.5002 | Test 0.5064
Number of nodes during this epoch:  328563
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13903522491455078  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.009557247161865234
range selection method range initialization spend 0.011703014373779297
time for parepare:  0.015579938888549805
local_output_nid generation:  0.010983705520629883
local_in_edges_tensor generation:  0.007433891296386719
mini_batch_src_global generation:  0.008228302001953125
r_  generation:  0.11603760719299316
local_output_nid generation:  0.01200413703918457
local_in_edges_tensor generation:  0.005232572555541992
mini_batch_src_global generation:  0.010884523391723633
r_  generation:  0.1263422966003418
----------------------check_connections_block total spend ----------------------------- 0.3614683151245117
generate_one_block  0.12868428230285645
generate_one_block  0.13158392906188965
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.022812604904174805
gen group dst list time:  0.005421638488769531
time for parepare:  0.019780635833740234
local_output_nid generation:  0.015571355819702148
local_in_edges_tensor generation:  0.023193836212158203
mini_batch_src_global generation:  0.0351109504699707
r_  generation:  0.38819146156311035
local_output_nid generation:  0.022322654724121094
local_in_edges_tensor generation:  0.020862817764282227
mini_batch_src_global generation:  0.0421147346496582
r_  generation:  0.396939754486084
----------------------check_connections_block total spend ----------------------------- 1.1367065906524658
generate_one_block  0.4848918914794922
generate_one_block  0.4829230308532715
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.019436120986938477
gen group dst list time:  0.011362314224243164
time for parepare:  0.019024372100830078
local_output_nid generation:  0.022905349731445312
local_in_edges_tensor generation:  0.02940511703491211
mini_batch_src_global generation:  0.030443668365478516
r_  generation:  0.3722257614135742
local_output_nid generation:  0.03019428253173828
local_in_edges_tensor generation:  0.025540828704833984
mini_batch_src_global generation:  0.037645578384399414
r_  generation:  0.38072824478149414
----------------------check_connections_block total spend ----------------------------- 1.1113672256469727
generate_one_block  0.45150041580200195
generate_one_block  0.4454305171966553
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13903522491455078  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.2480738162994385
block generation total time  1.864745855331421
average batch blocks generation time:  0.9323729276657104
block dataloader generation time/epoch 5.431505560874939
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10677385330200195  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1714482307434082  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10681915283203125  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1712474822998047  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07514560222625732 |0.01136326789855957 |0.0037889480590820312 |0.0005066394805908203 |0.0019202232360839844 |0.0012688636779785156 |
----------------------------------------------------------pseudo_mini_loss sum 1.1385866403579712
Total (block generation + training)time/epoch 5.721530278523763
Training time/epoch 0.27896904945373535
Training time without block to device /epoch 0.2562425136566162
Training time without total dataloading part /epoch 0.013700485229492188
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.41it/s]100%|██████████| 4/4 [00:00<00:00, 31.50it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.25it/s]100%|██████████| 4/4 [00:00<00:00, 10.83it/s]100%|██████████| 4/4 [00:00<00:00, 10.89it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.26it/s]100%|██████████| 4/4 [00:00<00:00, 15.25it/s]100%|██████████| 4/4 [00:00<00:00, 15.50it/s]
Run 00 | Epoch 00039 | Loss 1.1386 | Train 0.4097 | Val 0.4942 | Test 0.5005
Number of nodes during this epoch:  328625
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13765859603881836  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.009921073913574219
range selection method range initialization spend 0.01203775405883789
time for parepare:  0.01667618751525879
local_output_nid generation:  0.011067628860473633
local_in_edges_tensor generation:  0.012732505798339844
mini_batch_src_global generation:  0.008133411407470703
r_  generation:  0.1170651912689209
local_output_nid generation:  0.012057781219482422
local_in_edges_tensor generation:  0.005692958831787109
mini_batch_src_global generation:  0.011001825332641602
r_  generation:  0.12361264228820801
----------------------check_connections_block total spend ----------------------------- 0.36779260635375977
generate_one_block  0.12756824493408203
generate_one_block  0.1303262710571289
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02648186683654785
gen group dst list time:  0.005464792251586914
time for parepare:  0.019757509231567383
local_output_nid generation:  0.016000986099243164
local_in_edges_tensor generation:  0.027505159378051758
mini_batch_src_global generation:  0.03566408157348633
r_  generation:  0.3955838680267334
local_output_nid generation:  0.023140668869018555
local_in_edges_tensor generation:  0.022307395935058594
mini_batch_src_global generation:  0.04361677169799805
r_  generation:  0.4106459617614746
----------------------check_connections_block total spend ----------------------------- 1.1690518856048584
generate_one_block  0.48581933975219727
generate_one_block  0.4895927906036377
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01833319664001465
gen group dst list time:  0.011368513107299805
time for parepare:  0.018854141235351562
local_output_nid generation:  0.023888349533081055
local_in_edges_tensor generation:  0.02981710433959961
mini_batch_src_global generation:  0.03199195861816406
r_  generation:  0.3726632595062256
local_output_nid generation:  0.0312802791595459
local_in_edges_tensor generation:  0.03216409683227539
mini_batch_src_global generation:  0.04061293601989746
r_  generation:  0.3842966556549072
----------------------check_connections_block total spend ----------------------------- 1.1311933994293213
generate_one_block  0.455718994140625
generate_one_block  0.4568667411804199
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13765859603881836  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.3002452850341797
block generation total time  1.8879978656768799
average batch blocks generation time:  0.9439989328384399
block dataloader generation time/epoch 5.432129329250705
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10678720474243164  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1714882850646973  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10765981674194336  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1734004020690918  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08101558685302734 |0.010904788970947266 |0.004033803939819336 |0.000540614128112793 |0.0018742084503173828 |0.0013530254364013672 |
----------------------------------------------------------pseudo_mini_loss sum 1.1328842639923096
Total (block generation + training)time/epoch 5.721925904673915
Training time/epoch 0.28278589248657227
Training time without block to device /epoch 0.26097631454467773
Training time without total dataloading part /epoch 0.01425027847290039
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 60.75it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.19it/s]100%|██████████| 4/4 [00:00<00:00, 15.55it/s]100%|██████████| 4/4 [00:00<00:00, 15.48it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.96it/s]100%|██████████| 4/4 [00:00<00:00, 18.02it/s]100%|██████████| 4/4 [00:00<00:00, 17.99it/s]
Run 00 | Epoch 00040 | Loss 1.1329 | Train 0.4047 | Val 0.4874 | Test 0.4929
Number of nodes during this epoch:  328552
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13905763626098633  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.009723424911499023
range selection method range initialization spend 0.011749029159545898
time for parepare:  0.01559901237487793
local_output_nid generation:  0.010784387588500977
local_in_edges_tensor generation:  0.007299184799194336
mini_batch_src_global generation:  0.008288383483886719
r_  generation:  0.11552095413208008
local_output_nid generation:  0.011795759201049805
local_in_edges_tensor generation:  0.005263805389404297
mini_batch_src_global generation:  0.010954618453979492
r_  generation:  0.12941861152648926
----------------------check_connections_block total spend ----------------------------- 0.36463117599487305
generate_one_block  0.12918543815612793
generate_one_block  0.13267970085144043
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02622509002685547
gen group dst list time:  0.005517482757568359
time for parepare:  0.019687891006469727
local_output_nid generation:  0.015399456024169922
local_in_edges_tensor generation:  0.025174379348754883
mini_batch_src_global generation:  0.03598833084106445
r_  generation:  0.38235998153686523
local_output_nid generation:  0.022748470306396484
local_in_edges_tensor generation:  0.021585464477539062
mini_batch_src_global generation:  0.04266476631164551
r_  generation:  0.40225696563720703
----------------------check_connections_block total spend ----------------------------- 1.1398851871490479
generate_one_block  0.4868347644805908
generate_one_block  0.4878857135772705
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01752758026123047
gen group dst list time:  0.011418819427490234
time for parepare:  0.018983840942382812
local_output_nid generation:  0.02348780632019043
local_in_edges_tensor generation:  0.028910398483276367
mini_batch_src_global generation:  0.03201603889465332
r_  generation:  0.3746943473815918
local_output_nid generation:  0.030931711196899414
local_in_edges_tensor generation:  0.02740025520324707
mini_batch_src_global generation:  0.0389256477355957
r_  generation:  0.37616419792175293
----------------------check_connections_block total spend ----------------------------- 1.1177632808685303
generate_one_block  0.4432053565979004
generate_one_block  0.4516148567199707
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13905763626098633  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.257648468017578
block generation total time  1.8695406913757324
average batch blocks generation time:  0.9347703456878662
block dataloader generation time/epoch 5.430339686572552
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10681009292602539  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1713924407958984  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10677385330200195  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1724185943603516  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07831013202667236 |0.011021852493286133 |0.0038164854049682617 |0.0005208253860473633 |0.0018661022186279297 |0.0012905597686767578 |
----------------------------------------------------------pseudo_mini_loss sum 1.1248540878295898
Total (block generation + training)time/epoch 5.720271356403828
Training time/epoch 0.2940208911895752
Training time without block to device /epoch 0.27197718620300293
Training time without total dataloading part /epoch 0.013697385787963867
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 68.14it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.33it/s]100%|██████████| 4/4 [00:00<00:00, 15.70it/s]100%|██████████| 4/4 [00:00<00:00, 15.63it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.27it/s]100%|██████████| 4/4 [00:00<00:00, 17.78it/s]100%|██████████| 4/4 [00:00<00:00, 17.68it/s]
Run 00 | Epoch 00041 | Loss 1.1249 | Train 0.4005 | Val 0.4778 | Test 0.4836
Number of nodes during this epoch:  328525
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13760662078857422  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.010016202926635742
range selection method range initialization spend 0.011605501174926758
time for parepare:  0.015737056732177734
local_output_nid generation:  0.01098012924194336
local_in_edges_tensor generation:  0.0073125362396240234
mini_batch_src_global generation:  0.00818181037902832
r_  generation:  0.11605453491210938
local_output_nid generation:  0.011848211288452148
local_in_edges_tensor generation:  0.005349397659301758
mini_batch_src_global generation:  0.010965347290039062
r_  generation:  0.12370920181274414
----------------------check_connections_block total spend ----------------------------- 0.3595430850982666
generate_one_block  0.1292438507080078
generate_one_block  0.13173127174377441
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.022348403930664062
gen group dst list time:  0.005491018295288086
time for parepare:  0.01968240737915039
local_output_nid generation:  0.015749692916870117
local_in_edges_tensor generation:  0.022986412048339844
mini_batch_src_global generation:  0.034741878509521484
r_  generation:  0.3831920623779297
local_output_nid generation:  0.02298140525817871
local_in_edges_tensor generation:  0.020804166793823242
mini_batch_src_global generation:  0.043032169342041016
r_  generation:  0.4000132083892822
----------------------check_connections_block total spend ----------------------------- 1.1379303932189941
generate_one_block  0.4861021041870117
generate_one_block  0.4990725517272949
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.018685102462768555
gen group dst list time:  0.011751174926757812
time for parepare:  0.019063472747802734
local_output_nid generation:  0.02289605140686035
local_in_edges_tensor generation:  0.029575586318969727
mini_batch_src_global generation:  0.031031131744384766
r_  generation:  0.37857842445373535
local_output_nid generation:  0.03083515167236328
local_in_edges_tensor generation:  0.026712656021118164
mini_batch_src_global generation:  0.037201881408691406
r_  generation:  0.38124942779541016
----------------------check_connections_block total spend ----------------------------- 1.1209053993225098
generate_one_block  0.4532196521759033
generate_one_block  0.4507606029510498
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13760662078857422  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.258835792541504
block generation total time  1.8891549110412598
average batch blocks generation time:  0.9445774555206299
block dataloader generation time/epoch 5.4285368124643965
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10764408111572266  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1732616424560547  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10767602920532227  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1735806465148926  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07132339477539062 |0.0123826265335083 |0.0037728548049926758 |0.0005021095275878906 |0.0019001960754394531 |0.0012638568878173828 |
----------------------------------------------------------pseudo_mini_loss sum 1.1233365535736084
Total (block generation + training)time/epoch 5.717964837045381
Training time/epoch 0.27322912216186523
Training time without block to device /epoch 0.24846386909484863
Training time without total dataloading part /epoch 0.013614177703857422
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 68.20it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.36it/s]100%|██████████| 4/4 [00:00<00:00, 15.61it/s]100%|██████████| 4/4 [00:00<00:00, 15.56it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.27it/s]100%|██████████| 4/4 [00:00<00:00, 17.78it/s]100%|██████████| 4/4 [00:00<00:00, 17.68it/s]
Run 00 | Epoch 00042 | Loss 1.1233 | Train 0.3959 | Val 0.4673 | Test 0.4727
Number of nodes during this epoch:  328522
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13911104202270508  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.010172605514526367
range selection method range initialization spend 0.011826038360595703
time for parepare:  0.01566791534423828
local_output_nid generation:  0.010961771011352539
local_in_edges_tensor generation:  0.007285118103027344
mini_batch_src_global generation:  0.008240461349487305
r_  generation:  0.11493849754333496
local_output_nid generation:  0.011889219284057617
local_in_edges_tensor generation:  0.005379676818847656
mini_batch_src_global generation:  0.010562658309936523
r_  generation:  0.12471771240234375
----------------------check_connections_block total spend ----------------------------- 0.35900354385375977
generate_one_block  0.12732958793640137
generate_one_block  0.13109946250915527
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.022597551345825195
gen group dst list time:  0.005495548248291016
time for parepare:  0.0207364559173584
local_output_nid generation:  0.015795469284057617
local_in_edges_tensor generation:  0.02463674545288086
mini_batch_src_global generation:  0.03534245491027832
r_  generation:  0.38141679763793945
local_output_nid generation:  0.02277684211730957
local_in_edges_tensor generation:  0.021572351455688477
mini_batch_src_global generation:  0.04282379150390625
r_  generation:  0.39697980880737305
----------------------check_connections_block total spend ----------------------------- 1.1348204612731934
generate_one_block  0.48313069343566895
generate_one_block  0.4849398136138916
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01699090003967285
gen group dst list time:  0.011318683624267578
time for parepare:  0.018941402435302734
local_output_nid generation:  0.022820711135864258
local_in_edges_tensor generation:  0.02925872802734375
mini_batch_src_global generation:  0.03129839897155762
r_  generation:  0.3661372661590576
local_output_nid generation:  0.02980637550354004
local_in_edges_tensor generation:  0.025270462036132812
mini_batch_src_global generation:  0.03725433349609375
r_  generation:  0.3780026435852051
----------------------check_connections_block total spend ----------------------------- 1.1029257774353027
generate_one_block  0.4451155662536621
generate_one_block  0.4424934387207031
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13911104202270508  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.237746238708496
block generation total time  1.8556795120239258
average batch blocks generation time:  0.9278397560119629
block dataloader generation time/epoch 5.4250034234103035
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10675048828125  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1681632995605469  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10685157775878906  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.171724796295166  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07754528522491455 |0.012964367866516113 |0.0036802291870117188 |0.0004899501800537109 |0.0021921396255493164 |0.0012683868408203125 |
----------------------------------------------------------pseudo_mini_loss sum 1.1145906448364258
Total (block generation + training)time/epoch 5.7146128556307625
Training time/epoch 0.29551196098327637
Training time without block to device /epoch 0.26958322525024414
Training time without total dataloading part /epoch 0.013993024826049805
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 65.68it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.24it/s]100%|██████████| 4/4 [00:00<00:00, 15.64it/s]100%|██████████| 4/4 [00:00<00:00, 15.56it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.25it/s]100%|██████████| 4/4 [00:00<00:00, 17.74it/s]100%|██████████| 4/4 [00:00<00:00, 17.65it/s]
Run 00 | Epoch 00043 | Loss 1.1146 | Train 0.3910 | Val 0.4563 | Test 0.4592
Number of nodes during this epoch:  328628
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13766717910766602  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.009885787963867188
range selection method range initialization spend 0.011596202850341797
time for parepare:  0.015305519104003906
local_output_nid generation:  0.010721206665039062
local_in_edges_tensor generation:  0.007213115692138672
mini_batch_src_global generation:  0.008223295211791992
r_  generation:  0.1146554946899414
local_output_nid generation:  0.011748075485229492
local_in_edges_tensor generation:  0.005749702453613281
mini_batch_src_global generation:  0.01423335075378418
r_  generation:  0.1246337890625
----------------------check_connections_block total spend ----------------------------- 0.3618767261505127
generate_one_block  0.1278688907623291
generate_one_block  0.13207054138183594
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0336761474609375
gen group dst list time:  0.005644798278808594
time for parepare:  0.019971132278442383
local_output_nid generation:  0.015718936920166016
local_in_edges_tensor generation:  0.029102802276611328
mini_batch_src_global generation:  0.03692817687988281
r_  generation:  0.379838228225708
local_output_nid generation:  0.022647857666015625
local_in_edges_tensor generation:  0.02817392349243164
mini_batch_src_global generation:  0.04378795623779297
r_  generation:  0.4080836772918701
----------------------check_connections_block total spend ----------------------------- 1.1567575931549072
generate_one_block  0.49302196502685547
generate_one_block  0.49854040145874023
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.017435073852539062
gen group dst list time:  0.01123952865600586
time for parepare:  0.01951289176940918
local_output_nid generation:  0.02272963523864746
local_in_edges_tensor generation:  0.0302731990814209
mini_batch_src_global generation:  0.031517982482910156
r_  generation:  0.3717219829559326
local_output_nid generation:  0.03103041648864746
local_in_edges_tensor generation:  0.030538320541381836
mini_batch_src_global generation:  0.04053997993469238
r_  generation:  0.38635969161987305
----------------------check_connections_block total spend ----------------------------- 1.130014419555664
generate_one_block  0.46888136863708496
generate_one_block  0.4542269706726074
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13766717910766602  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.2867720127105713
block generation total time  1.914670705795288
average batch blocks generation time:  0.957335352897644
block dataloader generation time/epoch 5.425615324292864
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10683107376098633  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1721429824829102  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10766315460205078  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1736421585083008  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07902634143829346 |0.010825395584106445 |0.004099845886230469 |0.0005319118499755859 |0.0020655393600463867 |0.0013718605041503906 |
----------------------------------------------------------pseudo_mini_loss sum 1.108825922012329
Total (block generation + training)time/epoch 5.715328277860369
Training time/epoch 0.2930738925933838
Training time without block to device /epoch 0.2714231014251709
Training time without total dataloading part /epoch 0.014766454696655273
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 52.60it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.21it/s]100%|██████████| 4/4 [00:00<00:00, 15.47it/s]100%|██████████| 4/4 [00:00<00:00, 15.41it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.48it/s]100%|██████████| 4/4 [00:00<00:00, 17.81it/s]100%|██████████| 4/4 [00:00<00:00, 17.74it/s]
Run 00 | Epoch 00044 | Loss 1.1088 | Train 0.3855 | Val 0.4437 | Test 0.4459
Number of nodes during this epoch:  328633
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1390519142150879  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.012936592102050781
range selection method range initialization spend 0.011679887771606445
time for parepare:  0.01624464988708496
local_output_nid generation:  0.011445760726928711
local_in_edges_tensor generation:  0.007460117340087891
mini_batch_src_global generation:  0.008201837539672852
r_  generation:  0.11581134796142578
local_output_nid generation:  0.01209115982055664
local_in_edges_tensor generation:  0.00539398193359375
mini_batch_src_global generation:  0.010513782501220703
r_  generation:  0.12395954132080078
----------------------check_connections_block total spend ----------------------------- 0.3605334758758545
generate_one_block  0.12938952445983887
generate_one_block  0.1306769847869873
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.023253202438354492
gen group dst list time:  0.00555109977722168
time for parepare:  0.019426822662353516
local_output_nid generation:  0.015816688537597656
local_in_edges_tensor generation:  0.026131391525268555
mini_batch_src_global generation:  0.03508806228637695
r_  generation:  0.3838307857513428
local_output_nid generation:  0.022645235061645508
local_in_edges_tensor generation:  0.021416664123535156
mini_batch_src_global generation:  0.04650473594665527
r_  generation:  0.3996927738189697
----------------------check_connections_block total spend ----------------------------- 1.1418089866638184
generate_one_block  0.4997596740722656
generate_one_block  0.4989902973175049
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.020048141479492188
gen group dst list time:  0.01130366325378418
time for parepare:  0.02033066749572754
local_output_nid generation:  0.02548837661743164
local_in_edges_tensor generation:  0.03137540817260742
mini_batch_src_global generation:  0.03191399574279785
r_  generation:  0.3721647262573242
local_output_nid generation:  0.03063225746154785
local_in_edges_tensor generation:  0.027670621871948242
mini_batch_src_global generation:  0.037458181381225586
r_  generation:  0.3764169216156006
----------------------check_connections_block total spend ----------------------------- 1.118758201599121
generate_one_block  0.4445526599884033
generate_one_block  0.4432227611541748
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1390519142150879  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.2605671882629395
block generation total time  1.8865253925323486
average batch blocks generation time:  0.9432626962661743
block dataloader generation time/epoch 5.42510508828693
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10679292678833008  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1689486503601074  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1068267822265625  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1721839904785156  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07604360580444336 |0.012162446975708008 |0.003850579261779785 |0.0004978179931640625 |0.0020526647567749023 |0.0012822151184082031 |
----------------------------------------------------------pseudo_mini_loss sum 1.1022894382476807
Total (block generation + training)time/epoch 5.714589185184902
Training time/epoch 0.2813887596130371
Training time without block to device /epoch 0.2570638656616211
Training time without total dataloading part /epoch 0.014084339141845703
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 67.71it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.00it/s]100%|██████████| 4/4 [00:00<00:00, 15.61it/s]100%|██████████| 4/4 [00:00<00:00, 15.50it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.17it/s]100%|██████████| 4/4 [00:00<00:00, 17.67it/s]100%|██████████| 4/4 [00:00<00:00, 17.57it/s]
Run 00 | Epoch 00045 | Loss 1.1023 | Train 0.3795 | Val 0.4318 | Test 0.4335
Number of nodes during this epoch:  328585
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1376662254333496  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.010943889617919922
range selection method range initialization spend 0.011728286743164062
time for parepare:  0.015484094619750977
local_output_nid generation:  0.011078119277954102
local_in_edges_tensor generation:  0.007571697235107422
mini_batch_src_global generation:  0.008355379104614258
r_  generation:  0.12164545059204102
local_output_nid generation:  0.012735843658447266
local_in_edges_tensor generation:  0.0054819583892822266
mini_batch_src_global generation:  0.011359691619873047
r_  generation:  0.12902498245239258
----------------------check_connections_block total spend ----------------------------- 0.375673770904541
generate_one_block  0.13556241989135742
generate_one_block  0.13716650009155273
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.022609949111938477
gen group dst list time:  0.005585908889770508
time for parepare:  0.020018815994262695
local_output_nid generation:  0.015941143035888672
local_in_edges_tensor generation:  0.023103952407836914
mini_batch_src_global generation:  0.03672933578491211
r_  generation:  0.4032752513885498
local_output_nid generation:  0.022808551788330078
local_in_edges_tensor generation:  0.02180004119873047
mini_batch_src_global generation:  0.043450355529785156
r_  generation:  0.40900278091430664
----------------------check_connections_block total spend ----------------------------- 1.1750707626342773
generate_one_block  0.5140161514282227
generate_one_block  0.49882030487060547
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.017933368682861328
gen group dst list time:  0.011282920837402344
time for parepare:  0.018906831741333008
local_output_nid generation:  0.023523330688476562
local_in_edges_tensor generation:  0.03560209274291992
mini_batch_src_global generation:  0.03140449523925781
r_  generation:  0.37433838844299316
local_output_nid generation:  0.030744314193725586
local_in_edges_tensor generation:  0.026069164276123047
mini_batch_src_global generation:  0.03854060173034668
r_  generation:  0.4444847106933594
----------------------check_connections_block total spend ----------------------------- 1.197338342666626
generate_one_block  0.48877477645874023
generate_one_block  0.4608438014984131
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1376662254333496  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.3724091053009033
block generation total time  1.9624550342559814
average batch blocks generation time:  0.9812275171279907
block dataloader generation time/epoch 5.431121826171875
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10679435729980469  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1722846031188965  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10776710510253906  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.17457914352417  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07063376903533936 |0.01630544662475586 |0.003571629524230957 |0.0004892349243164062 |0.0016884803771972656 |0.0012040138244628906 |
----------------------------------------------------------pseudo_mini_loss sum 1.099861979484558
Total (block generation + training)time/epoch 5.7203269842508675
Training time/epoch 0.2790796756744385
Training time without block to device /epoch 0.24646878242492676
Training time without total dataloading part /epoch 0.012702703475952148
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 58.63it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.16it/s]100%|██████████| 4/4 [00:00<00:00, 15.58it/s]100%|██████████| 4/4 [00:00<00:00, 15.50it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.43it/s]100%|██████████| 4/4 [00:00<00:00, 17.91it/s]100%|██████████| 4/4 [00:00<00:00, 17.82it/s]
Run 00 | Epoch 00046 | Loss 1.0999 | Train 0.3738 | Val 0.4205 | Test 0.4214
Number of nodes during this epoch:  328733
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1391611099243164  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.010850191116333008
range selection method range initialization spend 0.01163339614868164
time for parepare:  0.015799522399902344
local_output_nid generation:  0.011594772338867188
local_in_edges_tensor generation:  0.008145570755004883
mini_batch_src_global generation:  0.008469343185424805
r_  generation:  0.12044739723205566
local_output_nid generation:  0.012427806854248047
local_in_edges_tensor generation:  0.005493640899658203
mini_batch_src_global generation:  0.01118326187133789
r_  generation:  0.1305551528930664
----------------------check_connections_block total spend ----------------------------- 0.3749537467956543
generate_one_block  0.13196492195129395
generate_one_block  0.12973999977111816
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03245067596435547
gen group dst list time:  0.00566864013671875
time for parepare:  0.019501209259033203
local_output_nid generation:  0.015460729598999023
local_in_edges_tensor generation:  0.023882627487182617
mini_batch_src_global generation:  0.035616397857666016
r_  generation:  0.4001898765563965
local_output_nid generation:  0.025864124298095703
local_in_edges_tensor generation:  0.023066043853759766
mini_batch_src_global generation:  0.04310035705566406
r_  generation:  0.39649415016174316
----------------------check_connections_block total spend ----------------------------- 1.156371831893921
generate_one_block  0.4879131317138672
generate_one_block  0.48030781745910645
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.018686294555664062
gen group dst list time:  0.011329174041748047
time for parepare:  0.019368410110473633
local_output_nid generation:  0.023101091384887695
local_in_edges_tensor generation:  0.03066873550415039
mini_batch_src_global generation:  0.030739545822143555
r_  generation:  0.36975741386413574
local_output_nid generation:  0.030133962631225586
local_in_edges_tensor generation:  0.0254819393157959
mini_batch_src_global generation:  0.03755593299865723
r_  generation:  0.3729526996612549
----------------------check_connections_block total spend ----------------------------- 1.1030800342559814
generate_one_block  0.44413065910339355
generate_one_block  0.45385003089904785
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1391611099243164  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.2594518661499023
block generation total time  1.866201639175415
average batch blocks generation time:  0.9331008195877075
block dataloader generation time/epoch 5.430077132425811
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10689496994018555  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1770033836364746  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10674238204956055  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1664133071899414  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06904458999633789 |0.01052391529083252 |0.01603984832763672 |0.0005151033401489258 |0.0029053688049316406 |0.001360177993774414 |
----------------------------------------------------------pseudo_mini_loss sum 1.0983705520629883
Total (block generation + training)time/epoch 5.719578498288205
Training time/epoch 0.3003056049346924
Training time without block to device /epoch 0.27925777435302734
Training time without total dataloading part /epoch 0.040280818939208984
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 53.67it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.58it/s]100%|██████████| 4/4 [00:00<00:00, 16.26it/s]100%|██████████| 4/4 [00:00<00:00, 16.42it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.10it/s]100%|██████████| 4/4 [00:00<00:00, 17.36it/s]100%|██████████| 4/4 [00:00<00:00, 17.30it/s]
Run 00 | Epoch 00047 | Loss 1.0984 | Train 0.3693 | Val 0.4125 | Test 0.4114
Number of nodes during this epoch:  328628
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1376194953918457  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.013126373291015625
range selection method range initialization spend 0.011691808700561523
time for parepare:  0.015172958374023438
local_output_nid generation:  0.011195659637451172
local_in_edges_tensor generation:  0.007820606231689453
mini_batch_src_global generation:  0.010663747787475586
r_  generation:  0.11858439445495605
local_output_nid generation:  0.012862920761108398
local_in_edges_tensor generation:  0.006216287612915039
mini_batch_src_global generation:  0.011528253555297852
r_  generation:  0.13131284713745117
----------------------check_connections_block total spend ----------------------------- 0.37696361541748047
generate_one_block  0.13581585884094238
generate_one_block  0.13872981071472168
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02917027473449707
gen group dst list time:  0.005541086196899414
time for parepare:  0.020183086395263672
local_output_nid generation:  0.016252994537353516
local_in_edges_tensor generation:  0.03594231605529785
mini_batch_src_global generation:  0.03659200668334961
r_  generation:  0.3946218490600586
local_output_nid generation:  0.022807836532592773
local_in_edges_tensor generation:  0.03172636032104492
mini_batch_src_global generation:  0.04404115676879883
r_  generation:  0.406968355178833
----------------------check_connections_block total spend ----------------------------- 1.1849372386932373
generate_one_block  0.503241777420044
generate_one_block  0.4996211528778076
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.018526792526245117
gen group dst list time:  0.01125025749206543
time for parepare:  0.01971268653869629
local_output_nid generation:  0.023891210556030273
local_in_edges_tensor generation:  0.03235149383544922
mini_batch_src_global generation:  0.03200244903564453
r_  generation:  0.3806428909301758
local_output_nid generation:  0.0318760871887207
local_in_edges_tensor generation:  0.031243324279785156
mini_batch_src_global generation:  0.03813481330871582
r_  generation:  0.42159104347229004
----------------------check_connections_block total spend ----------------------------- 1.1871600151062012
generate_one_block  0.4813690185546875
generate_one_block  0.46776628494262695
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1376194953918457  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.3720972537994385
block generation total time  1.951998233795166
average batch blocks generation time:  0.975999116897583
block dataloader generation time/epoch 5.43632408288809
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10686540603637695  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.172563076019287  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10763263702392578  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.173323631286621  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07812023162841797 |0.016458511352539062 |0.0041348934173583984 |0.0005335807800292969 |0.001968979835510254 |0.0013914108276367188 |
----------------------------------------------------------pseudo_mini_loss sum 1.0922846794128418
Total (block generation + training)time/epoch 5.725980618061164
Training time/epoch 0.2953910827636719
Training time without block to device /epoch 0.26247406005859375
Training time without total dataloading part /epoch 0.014666318893432617
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 49.38it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.07it/s]100%|██████████| 4/4 [00:00<00:00, 15.31it/s]100%|██████████| 4/4 [00:00<00:00, 15.26it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.17it/s]100%|██████████| 4/4 [00:00<00:00, 17.52it/s]100%|██████████| 4/4 [00:00<00:00, 17.44it/s]
Run 00 | Epoch 00048 | Loss 1.0923 | Train 0.3662 | Val 0.4047 | Test 0.4031
Number of nodes during this epoch:  328577
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13897132873535156  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01090693473815918
range selection method range initialization spend 0.011742591857910156
time for parepare:  0.01596975326538086
local_output_nid generation:  0.01126861572265625
local_in_edges_tensor generation:  0.01158905029296875
mini_batch_src_global generation:  0.008178949356079102
r_  generation:  0.11676454544067383
local_output_nid generation:  0.01256251335144043
local_in_edges_tensor generation:  0.005502223968505859
mini_batch_src_global generation:  0.010801553726196289
r_  generation:  0.12589597702026367
----------------------check_connections_block total spend ----------------------------- 0.36834216117858887
generate_one_block  0.1289665699005127
generate_one_block  0.13212037086486816
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02586054801940918
gen group dst list time:  0.005579471588134766
time for parepare:  0.020932912826538086
local_output_nid generation:  0.01552438735961914
local_in_edges_tensor generation:  0.027378082275390625
mini_batch_src_global generation:  0.035582780838012695
r_  generation:  0.38289952278137207
local_output_nid generation:  0.022484779357910156
local_in_edges_tensor generation:  0.022215843200683594
mini_batch_src_global generation:  0.04302644729614258
r_  generation:  0.40125560760498047
----------------------check_connections_block total spend ----------------------------- 1.142444133758545
generate_one_block  0.49340248107910156
generate_one_block  0.4907691478729248
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01839923858642578
gen group dst list time:  0.011246681213378906
time for parepare:  0.020577430725097656
local_output_nid generation:  0.023795127868652344
local_in_edges_tensor generation:  0.029619455337524414
mini_batch_src_global generation:  0.0320734977722168
r_  generation:  0.3731064796447754
local_output_nid generation:  0.030283689498901367
local_in_edges_tensor generation:  0.02782273292541504
mini_batch_src_global generation:  0.03929567337036133
r_  generation:  0.3817710876464844
----------------------check_connections_block total spend ----------------------------- 1.1228342056274414
generate_one_block  0.4525306224822998
generate_one_block  0.46362924575805664
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13897132873535156  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.2652783393859863
block generation total time  1.9003314971923828
average batch blocks generation time:  0.9501657485961914
block dataloader generation time/epoch 5.4365097224712375
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10677623748779297  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1680426597595215  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10682153701782227  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.172177791595459  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07513177394866943 |0.010944724082946777 |0.0038504600524902344 |0.0005269050598144531 |0.0028624534606933594 |0.0012888908386230469 |
----------------------------------------------------------pseudo_mini_loss sum 1.0900883674621582
Total (block generation + training)time/epoch 5.725917810201645
Training time/epoch 0.2796192169189453
Training time without block to device /epoch 0.25772976875305176
Training time without total dataloading part /epoch 0.01576852798461914
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 59.96it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.94it/s]100%|██████████| 4/4 [00:00<00:00, 15.25it/s]100%|██████████| 4/4 [00:00<00:00, 15.18it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.93it/s]100%|██████████| 4/4 [00:00<00:00, 17.50it/s]100%|██████████| 4/4 [00:00<00:00, 17.39it/s]
Run 00 | Epoch 00049 | Loss 1.0901 | Train 0.3632 | Val 0.3986 | Test 0.3956
Number of nodes during this epoch:  328581
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13767528533935547  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.011403799057006836
range selection method range initialization spend 0.01168060302734375
time for parepare:  0.015494346618652344
local_output_nid generation:  0.011055946350097656
local_in_edges_tensor generation:  0.007555246353149414
mini_batch_src_global generation:  0.008302450180053711
r_  generation:  0.11947321891784668
local_output_nid generation:  0.012908697128295898
local_in_edges_tensor generation:  0.0064084529876708984
mini_batch_src_global generation:  0.011266231536865234
r_  generation:  0.1249074935913086
----------------------check_connections_block total spend ----------------------------- 0.3683140277862549
generate_one_block  0.13006019592285156
generate_one_block  0.1375422477722168
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02713298797607422
gen group dst list time:  0.00554656982421875
time for parepare:  0.02054738998413086
local_output_nid generation:  0.015835046768188477
local_in_edges_tensor generation:  0.03232765197753906
mini_batch_src_global generation:  0.03718066215515137
r_  generation:  0.39978718757629395
local_output_nid generation:  0.0254364013671875
local_in_edges_tensor generation:  0.027980327606201172
mini_batch_src_global generation:  0.044782161712646484
r_  generation:  0.4020209312438965
----------------------check_connections_block total spend ----------------------------- 1.1808464527130127
generate_one_block  0.48691344261169434
generate_one_block  0.4930429458618164
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02072930335998535
gen group dst list time:  0.011818647384643555
time for parepare:  0.0196380615234375
local_output_nid generation:  0.023576736450195312
local_in_edges_tensor generation:  0.033410072326660156
mini_batch_src_global generation:  0.03142547607421875
r_  generation:  0.4138646125793457
local_output_nid generation:  0.03173375129699707
local_in_edges_tensor generation:  0.02857494354248047
mini_batch_src_global generation:  0.037250518798828125
r_  generation:  0.3805270195007324
----------------------check_connections_block total spend ----------------------------- 1.1650211811065674
generate_one_block  0.44884157180786133
generate_one_block  0.45795750617980957
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13767528533935547  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.34586763381958
block generation total time  1.8867554664611816
average batch blocks generation time:  0.9433777332305908
block dataloader generation time/epoch 5.43807105320256
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10681772232055664  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.172670841217041  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10766887664794922  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1733794212341309  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08102738857269287 |0.011608362197875977 |0.004086613655090332 |0.0005193948745727539 |0.002085447311401367 |0.0013587474822998047 |
----------------------------------------------------------pseudo_mini_loss sum 1.0833077430725098
Total (block generation + training)time/epoch 5.727814668562354
Training time/epoch 0.3030061721801758
Training time without block to device /epoch 0.27978944778442383
Training time without total dataloading part /epoch 0.014741659164428711
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.15it/s]100%|██████████| 4/4 [00:00<00:00, 30.32it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.53it/s]100%|██████████| 4/4 [00:00<00:00, 12.52it/s]100%|██████████| 4/4 [00:00<00:00, 12.35it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.95it/s]100%|██████████| 4/4 [00:00<00:00, 17.49it/s]100%|██████████| 4/4 [00:00<00:00, 17.39it/s]
Run 00 | Epoch 00050 | Loss 1.0833 | Train 0.3609 | Val 0.3937 | Test 0.3899
Number of nodes during this epoch:  328588
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13903522491455078  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.015348196029663086
range selection method range initialization spend 0.013130903244018555
time for parepare:  0.017926931381225586
local_output_nid generation:  0.01184988021850586
local_in_edges_tensor generation:  0.00816655158996582
mini_batch_src_global generation:  0.008652210235595703
r_  generation:  0.1421217918395996
local_output_nid generation:  0.012190103530883789
local_in_edges_tensor generation:  0.006350278854370117
mini_batch_src_global generation:  0.011960029602050781
r_  generation:  0.1311173439025879
----------------------check_connections_block total spend ----------------------------- 0.40203356742858887
generate_one_block  0.12950539588928223
generate_one_block  0.13308453559875488
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.025803089141845703
gen group dst list time:  0.005573749542236328
time for parepare:  0.02121734619140625
local_output_nid generation:  0.016282081604003906
local_in_edges_tensor generation:  0.027553558349609375
mini_batch_src_global generation:  0.035384178161621094
r_  generation:  0.39284372329711914
local_output_nid generation:  0.026226043701171875
local_in_edges_tensor generation:  0.02219247817993164
mini_batch_src_global generation:  0.04299521446228027
r_  generation:  0.4099760055541992
----------------------check_connections_block total spend ----------------------------- 1.1741838455200195
generate_one_block  0.5253121852874756
generate_one_block  0.5006744861602783
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.026272296905517578
gen group dst list time:  0.013093948364257812
time for parepare:  0.01974201202392578
local_output_nid generation:  0.023942947387695312
local_in_edges_tensor generation:  0.04215407371520996
mini_batch_src_global generation:  0.03351616859436035
r_  generation:  0.37241482734680176
local_output_nid generation:  0.03051161766052246
local_in_edges_tensor generation:  0.0283505916595459
mini_batch_src_global generation:  0.03770756721496582
r_  generation:  0.3813776969909668
----------------------check_connections_block total spend ----------------------------- 1.1386253833770752
generate_one_block  0.44640493392944336
generate_one_block  0.4616687297821045
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13903522491455078  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.3128092288970947
block generation total time  1.9340603351593018
average batch blocks generation time:  0.9670301675796509
block dataloader generation time/epoch 5.443953883080256
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10682964324951172  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1727805137634277  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10676431655883789  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1670422554016113  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08013045787811279 |0.012096881866455078 |0.004105329513549805 |0.0005099773406982422 |0.0020765066146850586 |0.0013539791107177734 |
----------------------------------------------------------pseudo_mini_loss sum 1.0834975242614746
Total (block generation + training)time/epoch 5.733857381911505
Training time/epoch 0.2963070869445801
Training time without block to device /epoch 0.2721133232116699
Training time without total dataloading part /epoch 0.014737606048583984
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.04it/s]100%|██████████| 4/4 [00:00<00:00, 26.95it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.28it/s]100%|██████████| 4/4 [00:00<00:00, 11.87it/s]100%|██████████| 4/4 [00:00<00:00, 11.77it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.48it/s]100%|██████████| 4/4 [00:00<00:00, 17.22it/s]100%|██████████| 4/4 [00:00<00:00, 17.24it/s]
Run 00 | Epoch 00051 | Loss 1.0835 | Train 0.3570 | Val 0.3875 | Test 0.3835
Number of nodes during this epoch:  328581
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1377124786376953  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.012003898620605469
range selection method range initialization spend 0.01182103157043457
time for parepare:  0.015177726745605469
local_output_nid generation:  0.011034488677978516
local_in_edges_tensor generation:  0.007656097412109375
mini_batch_src_global generation:  0.008218765258789062
r_  generation:  0.11717891693115234
local_output_nid generation:  0.012044191360473633
local_in_edges_tensor generation:  0.005435943603515625
mini_batch_src_global generation:  0.010873794555664062
r_  generation:  0.12952518463134766
----------------------check_connections_block total spend ----------------------------- 0.3673577308654785
generate_one_block  0.13111114501953125
generate_one_block  0.13448524475097656
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.027789592742919922
gen group dst list time:  0.005441188812255859
time for parepare:  0.019802331924438477
local_output_nid generation:  0.01589035987854004
local_in_edges_tensor generation:  0.02789759635925293
mini_batch_src_global generation:  0.03876781463623047
r_  generation:  0.38670897483825684
local_output_nid generation:  0.02249002456665039
local_in_edges_tensor generation:  0.023084163665771484
mini_batch_src_global generation:  0.044106245040893555
r_  generation:  0.41114020347595215
----------------------check_connections_block total spend ----------------------------- 1.1644783020019531
generate_one_block  0.4925107955932617
generate_one_block  0.5081720352172852
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025388002395629883
gen group dst list time:  0.012185335159301758
time for parepare:  0.02078866958618164
local_output_nid generation:  0.02592754364013672
local_in_edges_tensor generation:  0.033136844635009766
mini_batch_src_global generation:  0.031526803970336914
r_  generation:  0.3876032829284668
local_output_nid generation:  0.033904314041137695
local_in_edges_tensor generation:  0.0347902774810791
mini_batch_src_global generation:  0.038736820220947266
r_  generation:  0.38279151916503906
----------------------check_connections_block total spend ----------------------------- 1.164839267730713
generate_one_block  0.4520103931427002
generate_one_block  0.45849609375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1377124786376953  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.329317569732666
block generation total time  1.911189317703247
average batch blocks generation time:  0.9555946588516235
block dataloader generation time/epoch 5.446560693341632
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10679769515991211  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1704583168029785  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10776996612548828  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1743173599243164  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08031415939331055 |0.014791011810302734 |0.004066586494445801 |0.0005124807357788086 |0.0023485422134399414 |0.0013742446899414062 |
----------------------------------------------------------pseudo_mini_loss sum 1.076819658279419
Total (block generation + training)time/epoch 5.736791144969851
Training time/epoch 0.3038148880004883
Training time without block to device /epoch 0.2742328643798828
Training time without total dataloading part /epoch 0.015229463577270508
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 53.07it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.96it/s]100%|██████████| 4/4 [00:00<00:00, 15.19it/s]100%|██████████| 4/4 [00:00<00:00, 15.14it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.28it/s]100%|██████████| 4/4 [00:00<00:00, 17.36it/s]100%|██████████| 4/4 [00:00<00:00, 17.33it/s]
Run 00 | Epoch 00052 | Loss 1.0768 | Train 0.3532 | Val 0.3820 | Test 0.3780
Number of nodes during this epoch:  328837
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13919305801391602  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.011141300201416016
range selection method range initialization spend 0.011617660522460938
time for parepare:  0.015354156494140625
local_output_nid generation:  0.010959386825561523
local_in_edges_tensor generation:  0.008808612823486328
mini_batch_src_global generation:  0.008300304412841797
r_  generation:  0.11861491203308105
local_output_nid generation:  0.012117385864257812
local_in_edges_tensor generation:  0.005529880523681641
mini_batch_src_global generation:  0.01076364517211914
r_  generation:  0.12594175338745117
----------------------check_connections_block total spend ----------------------------- 0.3655996322631836
generate_one_block  0.12942028045654297
generate_one_block  0.1327817440032959
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.024666309356689453
gen group dst list time:  0.005540609359741211
time for parepare:  0.019884347915649414
local_output_nid generation:  0.015824317932128906
local_in_edges_tensor generation:  0.025907278060913086
mini_batch_src_global generation:  0.036446332931518555
r_  generation:  0.38987040519714355
local_output_nid generation:  0.02258014678955078
local_in_edges_tensor generation:  0.020757675170898438
mini_batch_src_global generation:  0.0433957576751709
r_  generation:  0.4029526710510254
----------------------check_connections_block total spend ----------------------------- 1.152312994003296
generate_one_block  0.49374985694885254
generate_one_block  0.49571824073791504
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01770806312561035
gen group dst list time:  0.01118159294128418
time for parepare:  0.019796371459960938
local_output_nid generation:  0.02336287498474121
local_in_edges_tensor generation:  0.03278231620788574
mini_batch_src_global generation:  0.031522274017333984
r_  generation:  0.37403059005737305
local_output_nid generation:  0.030112743377685547
local_in_edges_tensor generation:  0.02702188491821289
mini_batch_src_global generation:  0.03754830360412598
r_  generation:  0.38526344299316406
----------------------check_connections_block total spend ----------------------------- 1.125537633895874
generate_one_block  0.4475216865539551
generate_one_block  0.44736623764038086
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13919305801391602  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.27785062789917
block generation total time  1.8843560218811035
average batch blocks generation time:  0.9421780109405518
block dataloader generation time/epoch 5.446132822470232
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10676288604736328  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1686677932739258  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10680675506591797  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1714744567871094  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07733273506164551 |0.010734915733337402 |0.00396728515625 |0.0005285739898681641 |0.002051711082458496 |0.0013387203216552734 |
----------------------------------------------------------pseudo_mini_loss sum 1.0747177600860596
Total (block generation + training)time/epoch 5.736281541260806
Training time/epoch 0.2865307331085205
Training time without block to device /epoch 0.2650609016418457
Training time without total dataloading part /epoch 0.014433860778808594
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.73it/s]100%|██████████| 4/4 [00:00<00:00, 27.19it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.52it/s]100%|██████████| 4/4 [00:00<00:00, 11.95it/s]100%|██████████| 4/4 [00:00<00:00, 11.88it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.95it/s]100%|██████████| 4/4 [00:00<00:00, 17.41it/s]100%|██████████| 4/4 [00:00<00:00, 17.32it/s]
Run 00 | Epoch 00053 | Loss 1.0747 | Train 0.3499 | Val 0.3775 | Test 0.3730
Number of nodes during this epoch:  328508
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1376643180847168  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.013186216354370117
range selection method range initialization spend 0.011610984802246094
time for parepare:  0.015623092651367188
local_output_nid generation:  0.01085972785949707
local_in_edges_tensor generation:  0.007425785064697266
mini_batch_src_global generation:  0.010803937911987305
r_  generation:  0.11630916595458984
local_output_nid generation:  0.011998653411865234
local_in_edges_tensor generation:  0.006856441497802734
mini_batch_src_global generation:  0.010667085647583008
r_  generation:  0.1257929801940918
----------------------check_connections_block total spend ----------------------------- 0.36614513397216797
generate_one_block  0.13067054748535156
generate_one_block  0.13320016860961914
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.027508258819580078
gen group dst list time:  0.005578279495239258
time for parepare:  0.020285606384277344
local_output_nid generation:  0.016410112380981445
local_in_edges_tensor generation:  0.026976823806762695
mini_batch_src_global generation:  0.03552079200744629
r_  generation:  0.3937375545501709
local_output_nid generation:  0.02729058265686035
local_in_edges_tensor generation:  0.026354312896728516
mini_batch_src_global generation:  0.04338502883911133
r_  generation:  0.4078357219696045
----------------------check_connections_block total spend ----------------------------- 1.1739637851715088
generate_one_block  0.5103983879089355
generate_one_block  0.5014266967773438
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02050185203552246
gen group dst list time:  0.012925148010253906
time for parepare:  0.021672725677490234
local_output_nid generation:  0.023914098739624023
local_in_edges_tensor generation:  0.04098629951477051
mini_batch_src_global generation:  0.032791852951049805
r_  generation:  0.3793942928314209
local_output_nid generation:  0.03187203407287598
local_in_edges_tensor generation:  0.03168654441833496
mini_batch_src_global generation:  0.039118051528930664
r_  generation:  0.38342761993408203
----------------------check_connections_block total spend ----------------------------- 1.1494383811950684
generate_one_block  0.44841814041137695
generate_one_block  0.44957756996154785
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1376643180847168  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.323402166366577
block generation total time  1.909820795059204
average batch blocks generation time:  0.954910397529602
block dataloader generation time/epoch 5.447660636901856
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10675525665283203  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1716980934143066  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10769939422607422  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1743855476379395  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07907772064208984 |0.011937379837036133 |0.004042387008666992 |0.0005395412445068359 |0.0021671056747436523 |0.001337289810180664 |
----------------------------------------------------------pseudo_mini_loss sum 1.0708820819854736
Total (block generation + training)time/epoch 5.737765460544162
Training time/epoch 0.28802967071533203
Training time without block to device /epoch 0.26415491104125977
Training time without total dataloading part /epoch 0.014835357666015625
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.09it/s]100%|██████████| 4/4 [00:00<00:00, 30.04it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.58it/s]100%|██████████| 4/4 [00:00<00:00, 12.54it/s]100%|██████████| 4/4 [00:00<00:00, 12.37it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.11it/s]100%|██████████| 4/4 [00:00<00:00, 17.43it/s]100%|██████████| 4/4 [00:00<00:00, 17.37it/s]
Run 00 | Epoch 00054 | Loss 1.0709 | Train 0.3464 | Val 0.3713 | Test 0.3669
Number of nodes during this epoch:  328587
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13909578323364258  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01253652572631836
range selection method range initialization spend 0.011546611785888672
time for parepare:  0.014991998672485352
local_output_nid generation:  0.010981321334838867
local_in_edges_tensor generation:  0.007760047912597656
mini_batch_src_global generation:  0.008748054504394531
r_  generation:  0.1168212890625
local_output_nid generation:  0.011995077133178711
local_in_edges_tensor generation:  0.005465984344482422
mini_batch_src_global generation:  0.010926246643066406
r_  generation:  0.12842893600463867
----------------------check_connections_block total spend ----------------------------- 0.3656485080718994
generate_one_block  0.13327813148498535
generate_one_block  0.13254237174987793
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02869391441345215
gen group dst list time:  0.005500316619873047
time for parepare:  0.019855976104736328
local_output_nid generation:  0.015854835510253906
local_in_edges_tensor generation:  0.023070096969604492
mini_batch_src_global generation:  0.03557467460632324
r_  generation:  0.38854336738586426
local_output_nid generation:  0.023068666458129883
local_in_edges_tensor generation:  0.02559185028076172
mini_batch_src_global generation:  0.04372453689575195
r_  generation:  0.4043905735015869
----------------------check_connections_block total spend ----------------------------- 1.1520943641662598
generate_one_block  0.4924502372741699
generate_one_block  0.49440884590148926
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.018096923828125
gen group dst list time:  0.011380434036254883
time for parepare:  0.01936626434326172
local_output_nid generation:  0.024106264114379883
local_in_edges_tensor generation:  0.03113079071044922
mini_batch_src_global generation:  0.03174281120300293
r_  generation:  0.3724493980407715
local_output_nid generation:  0.03132033348083496
local_in_edges_tensor generation:  0.026305437088012695
mini_batch_src_global generation:  0.03934073448181152
r_  generation:  0.3797881603240967
----------------------check_connections_block total spend ----------------------------- 1.1199588775634766
generate_one_block  0.4478330612182617
generate_one_block  0.44992971420288086
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13909578323364258  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.2720532417297363
block generation total time  1.8846218585968018
average batch blocks generation time:  0.9423109292984009
block dataloader generation time/epoch 5.44745699737383
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1067800521850586  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1719646453857422  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10680866241455078  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1686410903930664  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07724583148956299 |0.010740876197814941 |0.0038574934005737305 |0.0005232095718383789 |0.002347707748413086 |0.0013110637664794922 |
----------------------------------------------------------pseudo_mini_loss sum 1.0675859451293945
Total (block generation + training)time/epoch 5.737575541371885
Training time/epoch 0.2906522750854492
Training time without block to device /epoch 0.26917052268981934
Training time without total dataloading part /epoch 0.014767885208129883
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 66.29it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.94it/s]100%|██████████| 4/4 [00:00<00:00, 15.29it/s]100%|██████████| 4/4 [00:00<00:00, 15.22it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.47it/s]100%|██████████| 4/4 [00:00<00:00, 17.64it/s]100%|██████████| 4/4 [00:00<00:00, 17.59it/s]
Run 00 | Epoch 00055 | Loss 1.0676 | Train 0.3437 | Val 0.3659 | Test 0.3607
Number of nodes during this epoch:  328510
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13776826858520508  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.010143756866455078
range selection method range initialization spend 0.011731863021850586
time for parepare:  0.01514887809753418
local_output_nid generation:  0.011102914810180664
local_in_edges_tensor generation:  0.0073740482330322266
mini_batch_src_global generation:  0.008348464965820312
r_  generation:  0.11607217788696289
local_output_nid generation:  0.012086629867553711
local_in_edges_tensor generation:  0.0053369998931884766
mini_batch_src_global generation:  0.010706424713134766
r_  generation:  0.12675881385803223
----------------------check_connections_block total spend ----------------------------- 0.36240720748901367
generate_one_block  0.13270902633666992
generate_one_block  0.1323690414428711
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02705836296081543
gen group dst list time:  0.005598306655883789
time for parepare:  0.019899368286132812
local_output_nid generation:  0.015843629837036133
local_in_edges_tensor generation:  0.022764205932617188
mini_batch_src_global generation:  0.035980224609375
r_  generation:  0.38979601860046387
local_output_nid generation:  0.022766590118408203
local_in_edges_tensor generation:  0.02102351188659668
mini_batch_src_global generation:  0.04319620132446289
r_  generation:  0.4015388488769531
----------------------check_connections_block total spend ----------------------------- 1.1472606658935547
generate_one_block  0.4969043731689453
generate_one_block  0.494495153427124
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.020653247833251953
gen group dst list time:  0.011320114135742188
time for parepare:  0.019794464111328125
local_output_nid generation:  0.024027585983276367
local_in_edges_tensor generation:  0.028365373611450195
mini_batch_src_global generation:  0.03139662742614746
r_  generation:  0.37429308891296387
local_output_nid generation:  0.03374958038330078
local_in_edges_tensor generation:  0.02640366554260254
mini_batch_src_global generation:  0.03765130043029785
r_  generation:  0.38434362411499023
----------------------check_connections_block total spend ----------------------------- 1.1248390674591064
generate_one_block  0.46141886711120605
generate_one_block  0.45842790603637695
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13776826858520508  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.272099733352661
block generation total time  1.9112462997436523
average batch blocks generation time:  0.9556231498718262
block dataloader generation time/epoch 5.4470572775982795
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10678482055664062  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1712946891784668  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10767698287963867  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1730666160583496  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07868397235870361 |0.016187071800231934 |0.003826737403869629 |0.0005192756652832031 |0.0018756389617919922 |0.0012836456298828125 |
----------------------------------------------------------pseudo_mini_loss sum 1.0644701719284058
Total (block generation + training)time/epoch 5.737500023334585
Training time/epoch 0.3052680492401123
Training time without block to device /epoch 0.27289390563964844
Training time without total dataloading part /epoch 0.013726949691772461
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 56.11it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.99it/s]100%|██████████| 4/4 [00:00<00:00, 15.31it/s]100%|██████████| 4/4 [00:00<00:00, 15.25it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.31it/s]100%|██████████| 4/4 [00:00<00:00, 17.61it/s]100%|██████████| 4/4 [00:00<00:00, 17.54it/s]
Run 00 | Epoch 00056 | Loss 1.0645 | Train 0.3416 | Val 0.3617 | Test 0.3556
Number of nodes during this epoch:  328598
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13899803161621094  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00994729995727539
range selection method range initialization spend 0.01176595687866211
time for parepare:  0.016237497329711914
local_output_nid generation:  0.011303901672363281
local_in_edges_tensor generation:  0.008771181106567383
mini_batch_src_global generation:  0.008233070373535156
r_  generation:  0.11721634864807129
local_output_nid generation:  0.012184619903564453
local_in_edges_tensor generation:  0.0053021907806396484
mini_batch_src_global generation:  0.011066913604736328
r_  generation:  0.12633228302001953
----------------------check_connections_block total spend ----------------------------- 0.36606550216674805
generate_one_block  0.13077116012573242
generate_one_block  0.13207483291625977
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02528691291809082
gen group dst list time:  0.005569934844970703
time for parepare:  0.019845008850097656
local_output_nid generation:  0.01593327522277832
local_in_edges_tensor generation:  0.0348203182220459
mini_batch_src_global generation:  0.03632473945617676
r_  generation:  0.3880331516265869
local_output_nid generation:  0.0244293212890625
local_in_edges_tensor generation:  0.023926734924316406
mini_batch_src_global generation:  0.04327654838562012
r_  generation:  0.4066355228424072
----------------------check_connections_block total spend ----------------------------- 1.1662046909332275
generate_one_block  0.48955512046813965
generate_one_block  0.49309301376342773
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02044367790222168
gen group dst list time:  0.01133418083190918
time for parepare:  0.019486427307128906
local_output_nid generation:  0.024003267288208008
local_in_edges_tensor generation:  0.029772520065307617
mini_batch_src_global generation:  0.03195834159851074
r_  generation:  0.37789082527160645
local_output_nid generation:  0.03279519081115723
local_in_edges_tensor generation:  0.027474403381347656
mini_batch_src_global generation:  0.038266658782958984
r_  generation:  0.39400291442871094
----------------------check_connections_block total spend ----------------------------- 1.1437153816223145
generate_one_block  0.4526214599609375
generate_one_block  0.45470142364501953
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13899803161621094  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.309920072555542
block generation total time  1.8899710178375244
average batch blocks generation time:  0.9449855089187622
block dataloader generation time/epoch 5.447730273008347
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1068577766418457  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1723103523254395  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10675287246704102  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1703205108642578  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07649922370910645 |0.010950446128845215 |0.003973960876464844 |0.000529170036315918 |0.002356886863708496 |0.0012998580932617188 |
----------------------------------------------------------pseudo_mini_loss sum 1.0634273290634155
Total (block generation + training)time/epoch 5.738058124979337
Training time/epoch 0.28481221199035645
Training time without block to device /epoch 0.262911319732666
Training time without total dataloading part /epoch 0.015019893646240234
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.71it/s]100%|██████████| 4/4 [00:00<00:00, 31.18it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.49it/s]100%|██████████| 4/4 [00:00<00:00, 12.63it/s]100%|██████████| 4/4 [00:00<00:00, 12.44it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.40it/s]100%|██████████| 4/4 [00:00<00:00, 17.57it/s]100%|██████████| 4/4 [00:00<00:00, 17.52it/s]
Run 00 | Epoch 00057 | Loss 1.0634 | Train 0.3394 | Val 0.3589 | Test 0.3514
Number of nodes during this epoch:  328644
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1376185417175293  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.010491371154785156
range selection method range initialization spend 0.011826753616333008
time for parepare:  0.01549673080444336
local_output_nid generation:  0.010975837707519531
local_in_edges_tensor generation:  0.007413387298583984
mini_batch_src_global generation:  0.008306264877319336
r_  generation:  0.1152191162109375
local_output_nid generation:  0.012005090713500977
local_in_edges_tensor generation:  0.0053179264068603516
mini_batch_src_global generation:  0.013198137283325195
r_  generation:  0.13733625411987305
----------------------check_connections_block total spend ----------------------------- 0.375241756439209
generate_one_block  0.13613605499267578
generate_one_block  0.1374199390411377
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.024265289306640625
gen group dst list time:  0.0055713653564453125
time for parepare:  0.02242875099182129
local_output_nid generation:  0.016173839569091797
local_in_edges_tensor generation:  0.02248382568359375
mini_batch_src_global generation:  0.035956621170043945
r_  generation:  0.413954496383667
local_output_nid generation:  0.02263927459716797
local_in_edges_tensor generation:  0.021498441696166992
mini_batch_src_global generation:  0.043689727783203125
r_  generation:  0.40212512016296387
----------------------check_connections_block total spend ----------------------------- 1.1751914024353027
generate_one_block  0.48566174507141113
generate_one_block  0.486602783203125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.017586708068847656
gen group dst list time:  0.011175394058227539
time for parepare:  0.019046783447265625
local_output_nid generation:  0.023409366607666016
local_in_edges_tensor generation:  0.030007362365722656
mini_batch_src_global generation:  0.03119063377380371
r_  generation:  0.3703956604003906
local_output_nid generation:  0.0308072566986084
local_in_edges_tensor generation:  0.029841899871826172
mini_batch_src_global generation:  0.03739428520202637
r_  generation:  0.37906527519226074
----------------------check_connections_block total spend ----------------------------- 1.1142644882202148
generate_one_block  0.4468235969543457
generate_one_block  0.4553663730621338
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1376185417175293  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.2894558906555176
block generation total time  1.8744544982910156
average batch blocks generation time:  0.9372272491455078
block dataloader generation time/epoch 5.447206803730556
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10680818557739258  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1716408729553223  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1077113151550293  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1742773056030273  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07596826553344727 |0.0107344388961792 |0.0038061141967773438 |0.0005115270614624023 |0.0020908117294311523 |0.0012807846069335938 |
----------------------------------------------------------pseudo_mini_loss sum 1.055332064628601
Total (block generation + training)time/epoch 5.737555119456077
Training time/epoch 0.2912452220916748
Training time without block to device /epoch 0.2697763442993164
Training time without total dataloading part /epoch 0.01409769058227539
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 67.51it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.20it/s]100%|██████████| 4/4 [00:00<00:00, 15.31it/s]100%|██████████| 4/4 [00:00<00:00, 15.28it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.26it/s]100%|██████████| 4/4 [00:00<00:00, 17.50it/s]100%|██████████| 4/4 [00:00<00:00, 17.44it/s]
Run 00 | Epoch 00058 | Loss 1.0553 | Train 0.3361 | Val 0.3543 | Test 0.3464
Number of nodes during this epoch:  328677
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13911867141723633  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.010126352310180664
range selection method range initialization spend 0.011810302734375
time for parepare:  0.015247106552124023
local_output_nid generation:  0.011013031005859375
local_in_edges_tensor generation:  0.007694244384765625
mini_batch_src_global generation:  0.008356809616088867
r_  generation:  0.11552858352661133
local_output_nid generation:  0.012109756469726562
local_in_edges_tensor generation:  0.005362272262573242
mini_batch_src_global generation:  0.010631084442138672
r_  generation:  0.12595891952514648
----------------------check_connections_block total spend ----------------------------- 0.3614950180053711
generate_one_block  0.1286914348602295
generate_one_block  0.13167619705200195
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.026050329208374023
gen group dst list time:  0.0055692195892333984
time for parepare:  0.019960641860961914
local_output_nid generation:  0.01679253578186035
local_in_edges_tensor generation:  0.024022579193115234
mini_batch_src_global generation:  0.03568267822265625
r_  generation:  0.39133119583129883
local_output_nid generation:  0.02292943000793457
local_in_edges_tensor generation:  0.02166914939880371
mini_batch_src_global generation:  0.04302501678466797
r_  generation:  0.3995838165283203
----------------------check_connections_block total spend ----------------------------- 1.1472275257110596
generate_one_block  0.48811888694763184
generate_one_block  0.4886453151702881
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0176239013671875
gen group dst list time:  0.0117950439453125
time for parepare:  0.019581317901611328
local_output_nid generation:  0.024613618850708008
local_in_edges_tensor generation:  0.028752565383911133
mini_batch_src_global generation:  0.03128314018249512
r_  generation:  0.36981773376464844
local_output_nid generation:  0.03090047836303711
local_in_edges_tensor generation:  0.02595233917236328
mini_batch_src_global generation:  0.037952423095703125
r_  generation:  0.3807034492492676
----------------------check_connections_block total spend ----------------------------- 1.1130053997039795
generate_one_block  0.4489302635192871
generate_one_block  0.44724106788635254
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13911867141723633  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.260232925415039
block generation total time  1.8729355335235596
average batch blocks generation time:  0.9364677667617798
block dataloader generation time/epoch 5.446147127151489
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1068277359008789  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1731061935424805  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10677003860473633  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.171617031097412  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07665145397186279 |0.011540055274963379 |0.0038039684295654297 |0.0005170106887817383 |0.002035856246948242 |0.0012843608856201172 |
----------------------------------------------------------pseudo_mini_loss sum 1.0527162551879883
Total (block generation + training)time/epoch 5.7363153123855595
Training time/epoch 0.2812530994415283
Training time without block to device /epoch 0.25817298889160156
Training time without total dataloading part /epoch 0.013998031616210938
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 66.98it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.08it/s]100%|██████████| 4/4 [00:00<00:00, 15.16it/s]100%|██████████| 4/4 [00:00<00:00, 15.14it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.98it/s]100%|██████████| 4/4 [00:00<00:00, 17.68it/s]100%|██████████| 4/4 [00:00<00:00, 17.55it/s]
Run 00 | Epoch 00059 | Loss 1.0527 | Train 0.3325 | Val 0.3483 | Test 0.3403
Number of nodes during this epoch:  328547
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1375880241394043  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.010882854461669922
range selection method range initialization spend 0.011833429336547852
time for parepare:  0.015392065048217773
local_output_nid generation:  0.010941743850708008
local_in_edges_tensor generation:  0.007385730743408203
mini_batch_src_global generation:  0.008388996124267578
r_  generation:  0.11764025688171387
local_output_nid generation:  0.012249946594238281
local_in_edges_tensor generation:  0.006800651550292969
mini_batch_src_global generation:  0.010893821716308594
r_  generation:  0.12804317474365234
----------------------check_connections_block total spend ----------------------------- 0.3674471378326416
generate_one_block  0.12893009185791016
generate_one_block  0.13117313385009766
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030054330825805664
gen group dst list time:  0.005558013916015625
time for parepare:  0.01965498924255371
local_output_nid generation:  0.016070842742919922
local_in_edges_tensor generation:  0.025099754333496094
mini_batch_src_global generation:  0.03516554832458496
r_  generation:  0.38654613494873047
local_output_nid generation:  0.022858381271362305
local_in_edges_tensor generation:  0.020619869232177734
mini_batch_src_global generation:  0.04293560981750488
r_  generation:  0.3994271755218506
----------------------check_connections_block total spend ----------------------------- 1.1405837535858154
generate_one_block  0.4869260787963867
generate_one_block  0.4907083511352539
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.018976688385009766
gen group dst list time:  0.011284112930297852
time for parepare:  0.02162766456604004
local_output_nid generation:  0.024533510208129883
local_in_edges_tensor generation:  0.03389549255371094
mini_batch_src_global generation:  0.0313413143157959
r_  generation:  0.36885619163513184
local_output_nid generation:  0.030321598052978516
local_in_edges_tensor generation:  0.025845050811767578
mini_batch_src_global generation:  0.03762936592102051
r_  generation:  0.37689638137817383
----------------------check_connections_block total spend ----------------------------- 1.1152005195617676
generate_one_block  0.4559025764465332
generate_one_block  0.44881105422973633
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1375880241394043  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.255784273147583
block generation total time  1.8823480606079102
average batch blocks generation time:  0.9411740303039551
block dataloader generation time/epoch 5.445172936308618
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10680103302001953  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.171950340270996  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10770130157470703  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1735777854919434  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07788729667663574 |0.015789270401000977 |0.003729104995727539 |0.0004967451095581055 |0.0020711421966552734 |0.001251220703125 |
----------------------------------------------------------pseudo_mini_loss sum 1.0489625930786133
Total (block generation + training)time/epoch 5.735432550018909
Training time/epoch 0.29474544525146484
Training time without block to device /epoch 0.2631669044494629
Training time without total dataloading part /epoch 0.013845205307006836
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.04it/s]100%|██████████| 4/4 [00:00<00:00, 28.01it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.59it/s]100%|██████████| 4/4 [00:00<00:00, 11.99it/s]100%|██████████| 4/4 [00:00<00:00, 11.92it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.36it/s]100%|██████████| 4/4 [00:00<00:00, 17.22it/s]100%|██████████| 4/4 [00:00<00:00, 17.22it/s]
Run 00 | Epoch 00060 | Loss 1.0490 | Train 0.3290 | Val 0.3424 | Test 0.3322
Number of nodes during this epoch:  328623
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13907718658447266  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.009451150894165039
range selection method range initialization spend 0.011839866638183594
time for parepare:  0.015787124633789062
local_output_nid generation:  0.010789632797241211
local_in_edges_tensor generation:  0.007873296737670898
mini_batch_src_global generation:  0.008178949356079102
r_  generation:  0.11641263961791992
local_output_nid generation:  0.011913537979125977
local_in_edges_tensor generation:  0.005295276641845703
mini_batch_src_global generation:  0.01080322265625
r_  generation:  0.12347984313964844
----------------------check_connections_block total spend ----------------------------- 0.3595602512359619
generate_one_block  0.12818074226379395
generate_one_block  0.13057303428649902
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.026611804962158203
gen group dst list time:  0.005507230758666992
time for parepare:  0.020931243896484375
local_output_nid generation:  0.01574993133544922
local_in_edges_tensor generation:  0.026424884796142578
mini_batch_src_global generation:  0.03619050979614258
r_  generation:  0.3962745666503906
local_output_nid generation:  0.025168418884277344
local_in_edges_tensor generation:  0.02711200714111328
mini_batch_src_global generation:  0.04256081581115723
r_  generation:  0.3928534984588623
----------------------check_connections_block total spend ----------------------------- 1.1545569896697998
generate_one_block  0.4825260639190674
generate_one_block  0.48476266860961914
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01740264892578125
gen group dst list time:  0.011121749877929688
time for parepare:  0.019503116607666016
local_output_nid generation:  0.02332139015197754
local_in_edges_tensor generation:  0.043677568435668945
mini_batch_src_global generation:  0.03116130828857422
r_  generation:  0.3675656318664551
local_output_nid generation:  0.030262231826782227
local_in_edges_tensor generation:  0.027910947799682617
mini_batch_src_global generation:  0.03735470771789551
r_  generation:  0.37561631202697754
----------------------check_connections_block total spend ----------------------------- 1.119030475616455
generate_one_block  0.442188024520874
generate_one_block  0.4448814392089844
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13907718658447266  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.273587465286255
block generation total time  1.854358196258545
average batch blocks generation time:  0.9271790981292725
block dataloader generation time/epoch 5.443772072975452
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10684967041015625  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1723146438598633  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10683870315551758  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1707520484924316  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07856035232543945 |0.010615229606628418 |0.003943681716918945 |0.0005290508270263672 |0.0019443035125732422 |0.0013163089752197266 |
----------------------------------------------------------pseudo_mini_loss sum 1.05125892162323
Total (block generation + training)time/epoch 5.734074762234321
Training time/epoch 0.2923569679260254
Training time without block to device /epoch 0.27112650871276855
Training time without total dataloading part /epoch 0.014150381088256836
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 66.37it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.43it/s]100%|██████████| 4/4 [00:00<00:00, 15.35it/s]100%|██████████| 4/4 [00:00<00:00, 15.35it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.49it/s]100%|██████████| 4/4 [00:00<00:00, 17.83it/s]100%|██████████| 4/4 [00:00<00:00, 17.76it/s]
Run 00 | Epoch 00061 | Loss 1.0513 | Train 0.3269 | Val 0.3355 | Test 0.3250
Number of nodes during this epoch:  328775
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13765764236450195  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.009975910186767578
range selection method range initialization spend 0.011771202087402344
time for parepare:  0.015120267868041992
local_output_nid generation:  0.01095890998840332
local_in_edges_tensor generation:  0.007585048675537109
mini_batch_src_global generation:  0.008251667022705078
r_  generation:  0.11614394187927246
local_output_nid generation:  0.011910200119018555
local_in_edges_tensor generation:  0.005339145660400391
mini_batch_src_global generation:  0.010702371597290039
r_  generation:  0.12380337715148926
----------------------check_connections_block total spend ----------------------------- 0.35886335372924805
generate_one_block  0.1283564567565918
generate_one_block  0.13080739974975586
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02919769287109375
gen group dst list time:  0.005469799041748047
time for parepare:  0.019643306732177734
local_output_nid generation:  0.01567864418029785
local_in_edges_tensor generation:  0.0228269100189209
mini_batch_src_global generation:  0.03443551063537598
r_  generation:  0.38353967666625977
local_output_nid generation:  0.02275371551513672
local_in_edges_tensor generation:  0.021408796310424805
mini_batch_src_global generation:  0.04278373718261719
r_  generation:  0.39570116996765137
----------------------check_connections_block total spend ----------------------------- 1.1282637119293213
generate_one_block  0.4794449806213379
generate_one_block  0.48040103912353516
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.017904043197631836
gen group dst list time:  0.011108160018920898
time for parepare:  0.01880478858947754
local_output_nid generation:  0.023411989212036133
local_in_edges_tensor generation:  0.0297548770904541
mini_batch_src_global generation:  0.030515432357788086
r_  generation:  0.3683021068572998
local_output_nid generation:  0.03026270866394043
local_in_edges_tensor generation:  0.02926182746887207
mini_batch_src_global generation:  0.03763604164123535
r_  generation:  0.3716695308685303
----------------------check_connections_block total spend ----------------------------- 1.1022629737854004
generate_one_block  0.44359350204467773
generate_one_block  0.4405982494354248
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13765764236450195  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.2305266857147217
block generation total time  1.8440377712249756
average batch blocks generation time:  0.9220188856124878
block dataloader generation time/epoch 5.441351544182256
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10680007934570312  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1728167533874512  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10769033432006836  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.173050880432129  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07725369930267334 |0.010507464408874512 |0.003852367401123047 |0.0005184412002563477 |0.001822352409362793 |0.0016858577728271484 |
----------------------------------------------------------pseudo_mini_loss sum 1.045323371887207
Total (block generation + training)time/epoch 5.731693474751599
Training time/epoch 0.2922823429107666
Training time without block to device /epoch 0.2712674140930176
Training time without total dataloading part /epoch 0.014072179794311523
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 66.81it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.32it/s]100%|██████████| 4/4 [00:00<00:00, 15.31it/s]100%|██████████| 4/4 [00:00<00:00, 15.30it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.02it/s]100%|██████████| 4/4 [00:00<00:00, 17.58it/s]100%|██████████| 4/4 [00:00<00:00, 17.47it/s]
Run 00 | Epoch 00062 | Loss 1.0453 | Train 0.3244 | Val 0.3276 | Test 0.3167
Number of nodes during this epoch:  328606
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13903331756591797  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01198267936706543
range selection method range initialization spend 0.011595010757446289
time for parepare:  0.015113592147827148
local_output_nid generation:  0.011142730712890625
local_in_edges_tensor generation:  0.007408857345581055
mini_batch_src_global generation:  0.008130550384521484
r_  generation:  0.11728310585021973
local_output_nid generation:  0.012463092803955078
local_in_edges_tensor generation:  0.005414247512817383
mini_batch_src_global generation:  0.010632991790771484
r_  generation:  0.12797856330871582
----------------------check_connections_block total spend ----------------------------- 0.3656642436981201
generate_one_block  0.13080477714538574
generate_one_block  0.13292360305786133
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02459430694580078
gen group dst list time:  0.0055315494537353516
time for parepare:  0.019828319549560547
local_output_nid generation:  0.015832901000976562
local_in_edges_tensor generation:  0.022449731826782227
mini_batch_src_global generation:  0.03505897521972656
r_  generation:  0.38700389862060547
local_output_nid generation:  0.02278423309326172
local_in_edges_tensor generation:  0.021431446075439453
mini_batch_src_global generation:  0.04315447807312012
r_  generation:  0.39885926246643066
----------------------check_connections_block total spend ----------------------------- 1.1382012367248535
generate_one_block  0.48407649993896484
generate_one_block  0.48754334449768066
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.019313812255859375
gen group dst list time:  0.011127233505249023
time for parepare:  0.018978118896484375
local_output_nid generation:  0.02383136749267578
local_in_edges_tensor generation:  0.028115034103393555
mini_batch_src_global generation:  0.030452966690063477
r_  generation:  0.3762822151184082
local_output_nid generation:  0.03059530258178711
local_in_edges_tensor generation:  0.0264279842376709
mini_batch_src_global generation:  0.03748679161071777
r_  generation:  0.38205790519714355
----------------------check_connections_block total spend ----------------------------- 1.1181299686431885
generate_one_block  0.44865942001342773
generate_one_block  0.4660799503326416
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13903331756591797  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.256331205368042
block generation total time  1.8863592147827148
average batch blocks generation time:  0.9431796073913574
block dataloader generation time/epoch 5.440535576255233
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10683107376098633  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1717033386230469  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.106842041015625  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1711626052856445  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07655668258666992 |0.010723114013671875 |0.003796815872192383 |0.0005154609680175781 |0.002869129180908203 |0.001294851303100586 |
----------------------------------------------------------pseudo_mini_loss sum 1.0387673377990723
Total (block generation + training)time/epoch 5.7309038109249535
Training time/epoch 0.29167723655700684
Training time without block to device /epoch 0.2702310085296631
Training time without total dataloading part /epoch 0.015657663345336914
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.57it/s]100%|██████████| 4/4 [00:00<00:00, 30.97it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.72it/s]100%|██████████| 4/4 [00:00<00:00, 12.72it/s]100%|██████████| 4/4 [00:00<00:00, 12.55it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.16it/s]100%|██████████| 4/4 [00:00<00:00, 17.69it/s]100%|██████████| 4/4 [00:00<00:00, 17.59it/s]
Run 00 | Epoch 00063 | Loss 1.0388 | Train 0.3229 | Val 0.3234 | Test 0.3111
Number of nodes during this epoch:  328701
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13770723342895508  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.011177301406860352
range selection method range initialization spend 0.011642217636108398
time for parepare:  0.014986991882324219
local_output_nid generation:  0.010845422744750977
local_in_edges_tensor generation:  0.007317304611206055
mini_batch_src_global generation:  0.008115530014038086
r_  generation:  0.11395907402038574
local_output_nid generation:  0.012218952178955078
local_in_edges_tensor generation:  0.0052907466888427734
mini_batch_src_global generation:  0.01089334487915039
r_  generation:  0.12347793579101562
----------------------check_connections_block total spend ----------------------------- 0.35634851455688477
generate_one_block  0.128464937210083
generate_one_block  0.13217449188232422
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.024979829788208008
gen group dst list time:  0.00555729866027832
time for parepare:  0.019589900970458984
local_output_nid generation:  0.01562047004699707
local_in_edges_tensor generation:  0.022591114044189453
mini_batch_src_global generation:  0.034945011138916016
r_  generation:  0.3821601867675781
local_output_nid generation:  0.0225980281829834
local_in_edges_tensor generation:  0.020719289779663086
mini_batch_src_global generation:  0.042691707611083984
r_  generation:  0.4015188217163086
----------------------check_connections_block total spend ----------------------------- 1.1335563659667969
generate_one_block  0.4915642738342285
generate_one_block  0.4942295551300049
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.019043684005737305
gen group dst list time:  0.011011838912963867
time for parepare:  0.019377946853637695
local_output_nid generation:  0.023420095443725586
local_in_edges_tensor generation:  0.029170513153076172
mini_batch_src_global generation:  0.031084299087524414
r_  generation:  0.36820173263549805
local_output_nid generation:  0.0314333438873291
local_in_edges_tensor generation:  0.025385141372680664
mini_batch_src_global generation:  0.037534475326538086
r_  generation:  0.37796449661254883
----------------------check_connections_block total spend ----------------------------- 1.1073565483093262
generate_one_block  0.4497809410095215
generate_one_block  0.44648075103759766
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13770723342895508  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.240912914276123
block generation total time  1.8820555210113525
average batch blocks generation time:  0.9410277605056763
block dataloader generation time/epoch 5.43884221423756
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1067972183227539  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1722807884216309  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10774087905883789  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.174558162689209  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07748723030090332 |0.01064002513885498 |0.00379180908203125 |0.0005155801773071289 |0.0030117034912109375 |0.0012736320495605469 |
----------------------------------------------------------pseudo_mini_loss sum 1.0397305488586426
Total (block generation + training)time/epoch 5.729252633181486
Training time/epoch 0.2926044464111328
Training time without block to device /epoch 0.27132439613342285
Training time without total dataloading part /epoch 0.01591181755065918
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 64.33it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.15it/s]100%|██████████| 4/4 [00:00<00:00, 15.53it/s]100%|██████████| 4/4 [00:00<00:00, 15.46it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.35it/s]100%|██████████| 4/4 [00:00<00:00, 17.54it/s]100%|██████████| 4/4 [00:00<00:00, 17.49it/s]
Run 00 | Epoch 00064 | Loss 1.0397 | Train 0.3207 | Val 0.3185 | Test 0.3063
Number of nodes during this epoch:  328688
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13913917541503906  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.010375022888183594
range selection method range initialization spend 0.01159358024597168
time for parepare:  0.015099048614501953
local_output_nid generation:  0.011038541793823242
local_in_edges_tensor generation:  0.007575273513793945
mini_batch_src_global generation:  0.008354663848876953
r_  generation:  0.11776423454284668
local_output_nid generation:  0.012347936630249023
local_in_edges_tensor generation:  0.005374908447265625
mini_batch_src_global generation:  0.010861396789550781
r_  generation:  0.1273200511932373
----------------------check_connections_block total spend ----------------------------- 0.36511826515197754
generate_one_block  0.13085317611694336
generate_one_block  0.13252949714660645
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.024436235427856445
gen group dst list time:  0.0055141448974609375
time for parepare:  0.019685029983520508
local_output_nid generation:  0.015593767166137695
local_in_edges_tensor generation:  0.023320913314819336
mini_batch_src_global generation:  0.03745222091674805
r_  generation:  0.38678812980651855
local_output_nid generation:  0.022179126739501953
local_in_edges_tensor generation:  0.021643877029418945
mini_batch_src_global generation:  0.042679548263549805
r_  generation:  0.3961913585662842
----------------------check_connections_block total spend ----------------------------- 1.1372151374816895
generate_one_block  0.4862363338470459
generate_one_block  0.4852170944213867
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.018444299697875977
gen group dst list time:  0.011116743087768555
time for parepare:  0.019318342208862305
local_output_nid generation:  0.023435354232788086
local_in_edges_tensor generation:  0.030291080474853516
mini_batch_src_global generation:  0.03125286102294922
r_  generation:  0.368560791015625
local_output_nid generation:  0.030306339263916016
local_in_edges_tensor generation:  0.02593684196472168
mini_batch_src_global generation:  0.03900742530822754
r_  generation:  0.37981748580932617
----------------------check_connections_block total spend ----------------------------- 1.1124815940856934
generate_one_block  0.4474339485168457
generate_one_block  0.44806718826293945
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13913917541503906  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.249696731567383
block generation total time  1.8669545650482178
average batch blocks generation time:  0.9334772825241089
block dataloader generation time/epoch 5.437327086925507
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10687685012817383  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.173473834991455  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10678672790527344  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1708106994628906  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07686507701873779 |0.010402202606201172 |0.0037578344345092773 |0.0005096197128295898 |0.00202178955078125 |0.001291036605834961 |
----------------------------------------------------------pseudo_mini_loss sum 1.0357638597488403
Total (block generation + training)time/epoch 5.72760306085859
Training time/epoch 0.2827794551849365
Training time without block to device /epoch 0.2619750499725342
Training time without total dataloading part /epoch 0.013869524002075195
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 64.02it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.75it/s]100%|██████████| 4/4 [00:00<00:00, 18.35it/s]100%|██████████| 4/4 [00:00<00:00, 18.07it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.66it/s]100%|██████████| 4/4 [00:00<00:00, 21.91it/s]
Run 00 | Epoch 00065 | Loss 1.0358 | Train 0.3185 | Val 0.3153 | Test 0.3028
Number of nodes during this epoch:  328677
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1375741958618164  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.012063264846801758
range selection method range initialization spend 0.012260675430297852
time for parepare:  0.017106056213378906
local_output_nid generation:  0.011964082717895508
local_in_edges_tensor generation:  0.008412599563598633
mini_batch_src_global generation:  0.008375883102416992
r_  generation:  0.11994600296020508
local_output_nid generation:  0.01429128646850586
local_in_edges_tensor generation:  0.005808591842651367
mini_batch_src_global generation:  0.01043248176574707
r_  generation:  0.1291821002960205
----------------------check_connections_block total spend ----------------------------- 0.37674498558044434
generate_one_block  0.13979840278625488
generate_one_block  0.14237356185913086
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.026375532150268555
gen group dst list time:  0.006940364837646484
time for parepare:  0.021591901779174805
local_output_nid generation:  0.018566131591796875
local_in_edges_tensor generation:  0.02621626853942871
mini_batch_src_global generation:  0.035335540771484375
r_  generation:  0.3917727470397949
local_output_nid generation:  0.02972126007080078
local_in_edges_tensor generation:  0.02555704116821289
mini_batch_src_global generation:  0.043820858001708984
r_  generation:  0.40563106536865234
----------------------check_connections_block total spend ----------------------------- 1.1776258945465088
generate_one_block  0.510826826095581
generate_one_block  0.5145473480224609
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.020423412322998047
gen group dst list time:  0.012166261672973633
time for parepare:  0.02240157127380371
local_output_nid generation:  0.029367685317993164
local_in_edges_tensor generation:  0.033234357833862305
mini_batch_src_global generation:  0.030607938766479492
r_  generation:  0.3803415298461914
local_output_nid generation:  0.041582584381103516
local_in_edges_tensor generation:  0.031935691833496094
mini_batch_src_global generation:  0.03823447227478027
r_  generation:  0.3839099407196045
----------------------check_connections_block total spend ----------------------------- 1.1650078296661377
generate_one_block  0.46917223930358887
generate_one_block  0.46859002113342285
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1375741958618164  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.3426337242126465
block generation total time  1.9631364345550537
average batch blocks generation time:  0.9815682172775269
block dataloader generation time/epoch 5.44160563067386
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10682487487792969  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1725592613220215  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10772466659545898  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.173813819885254  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0734485387802124 |0.011005997657775879 |0.004006624221801758 |0.00052642822265625 |0.002406001091003418 |0.0013010501861572266 |
----------------------------------------------------------pseudo_mini_loss sum 1.0322864055633545
Total (block generation + training)time/epoch 5.731801091578969
Training time/epoch 0.2855722904205322
Training time without block to device /epoch 0.26356029510498047
Training time without total dataloading part /epoch 0.015179157257080078
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 66.76it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.30it/s]100%|██████████| 4/4 [00:00<00:00, 15.70it/s]100%|██████████| 4/4 [00:00<00:00, 15.62it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.27it/s]100%|██████████| 4/4 [00:00<00:00, 17.55it/s]100%|██████████| 4/4 [00:00<00:00, 17.49it/s]
Run 00 | Epoch 00066 | Loss 1.0323 | Train 0.3164 | Val 0.3126 | Test 0.2998
Number of nodes during this epoch:  328699
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13909196853637695  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.010715484619140625
range selection method range initialization spend 0.011829614639282227
time for parepare:  0.015656709671020508
local_output_nid generation:  0.011000394821166992
local_in_edges_tensor generation:  0.007440805435180664
mini_batch_src_global generation:  0.00831460952758789
r_  generation:  0.11759233474731445
local_output_nid generation:  0.012064695358276367
local_in_edges_tensor generation:  0.005356311798095703
mini_batch_src_global generation:  0.011008977890014648
r_  generation:  0.12468814849853516
----------------------check_connections_block total spend ----------------------------- 0.3626058101654053
generate_one_block  0.130723237991333
generate_one_block  0.13294649124145508
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02521061897277832
gen group dst list time:  0.005526542663574219
time for parepare:  0.020006895065307617
local_output_nid generation:  0.015982627868652344
local_in_edges_tensor generation:  0.02419590950012207
mini_batch_src_global generation:  0.03580498695373535
r_  generation:  0.3932929039001465
local_output_nid generation:  0.0236203670501709
local_in_edges_tensor generation:  0.021158933639526367
mini_batch_src_global generation:  0.04287362098693848
r_  generation:  0.4059317111968994
----------------------check_connections_block total spend ----------------------------- 1.1554956436157227
generate_one_block  0.4900217056274414
generate_one_block  0.4883434772491455
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.019348859786987305
gen group dst list time:  0.01123189926147461
time for parepare:  0.019921064376831055
local_output_nid generation:  0.024461746215820312
local_in_edges_tensor generation:  0.030110836029052734
mini_batch_src_global generation:  0.03119492530822754
r_  generation:  0.3713397979736328
local_output_nid generation:  0.031108617782592773
local_in_edges_tensor generation:  0.026302337646484375
mini_batch_src_global generation:  0.037988901138305664
r_  generation:  0.37970566749572754
----------------------check_connections_block total spend ----------------------------- 1.1161613464355469
generate_one_block  0.4465370178222656
generate_one_block  0.4486424922943115
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13909196853637695  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.2716569900512695
block generation total time  1.873544692993164
average batch blocks generation time:  0.936772346496582
block dataloader generation time/epoch 5.440909060938605
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10678339004516602  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1720032691955566  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1068577766418457  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1720962524414062  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07673335075378418 |0.01190173625946045 |0.0037109851837158203 |0.0004987716674804688 |0.0018849372863769531 |0.0012674331665039062 |
----------------------------------------------------------pseudo_mini_loss sum 1.0295155048370361
Total (block generation + training)time/epoch 5.731137127711855
Training time/epoch 0.29200172424316406
Training time without block to device /epoch 0.26819825172424316
Training time without total dataloading part /epoch 0.01345682144165039
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 69.34it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.25it/s]100%|██████████| 4/4 [00:00<00:00, 15.42it/s]100%|██████████| 4/4 [00:00<00:00, 15.38it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.52it/s]100%|██████████| 4/4 [00:00<00:00, 17.66it/s]100%|██████████| 4/4 [00:00<00:00, 17.62it/s]
Run 00 | Epoch 00067 | Loss 1.0295 | Train 0.3147 | Val 0.3091 | Test 0.2965
Number of nodes during this epoch:  328636
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13770246505737305  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.010795831680297852
range selection method range initialization spend 0.011739492416381836
time for parepare:  0.015184879302978516
local_output_nid generation:  0.010799169540405273
local_in_edges_tensor generation:  0.007989645004272461
mini_batch_src_global generation:  0.008265256881713867
r_  generation:  0.11499238014221191
local_output_nid generation:  0.012217521667480469
local_in_edges_tensor generation:  0.0053577423095703125
mini_batch_src_global generation:  0.010761737823486328
r_  generation:  0.12592434883117676
----------------------check_connections_block total spend ----------------------------- 0.3612985610961914
generate_one_block  0.12993502616882324
generate_one_block  0.13317108154296875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02620077133178711
gen group dst list time:  0.005484104156494141
time for parepare:  0.021555423736572266
local_output_nid generation:  0.015702247619628906
local_in_edges_tensor generation:  0.023786067962646484
mini_batch_src_global generation:  0.03508448600769043
r_  generation:  0.3864433765411377
local_output_nid generation:  0.023502826690673828
local_in_edges_tensor generation:  0.021558284759521484
mini_batch_src_global generation:  0.04320335388183594
r_  generation:  0.39692044258117676
----------------------check_connections_block total spend ----------------------------- 1.1384706497192383
generate_one_block  0.48686790466308594
generate_one_block  0.48622584342956543
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0194394588470459
gen group dst list time:  0.011035680770874023
time for parepare:  0.019446372985839844
local_output_nid generation:  0.02501511573791504
local_in_edges_tensor generation:  0.029753923416137695
mini_batch_src_global generation:  0.031246662139892578
r_  generation:  0.3707311153411865
local_output_nid generation:  0.034895896911621094
local_in_edges_tensor generation:  0.026079177856445312
mini_batch_src_global generation:  0.03751683235168457
r_  generation:  0.37641143798828125
----------------------check_connections_block total spend ----------------------------- 1.1174836158752441
generate_one_block  0.4436655044555664
generate_one_block  0.44292473793029785
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13770246505737305  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.2559542655944824
block generation total time  1.8596839904785156
average batch blocks generation time:  0.9298419952392578
block dataloader generation time/epoch 5.439508559340138
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10682868957519531  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.171799659729004  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10765790939331055  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1708831787109375  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07538163661956787 |0.010982036590576172 |0.0037708282470703125 |0.0005131959915161133 |0.0030874013900756836 |0.001264333724975586 |
----------------------------------------------------------pseudo_mini_loss sum 1.0263268947601318
Total (block generation + training)time/epoch 5.729684635744256
Training time/epoch 0.2870762348175049
Training time without block to device /epoch 0.26511216163635254
Training time without total dataloading part /epoch 0.016007184982299805
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 67.74it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.06it/s]100%|██████████| 4/4 [00:00<00:00, 15.31it/s]100%|██████████| 4/4 [00:00<00:00, 15.26it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.05it/s]100%|██████████| 4/4 [00:00<00:00, 17.45it/s]100%|██████████| 4/4 [00:00<00:00, 17.37it/s]
Run 00 | Epoch 00068 | Loss 1.0263 | Train 0.3138 | Val 0.3072 | Test 0.2938
Number of nodes during this epoch:  328576
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13905000686645508  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.011326789855957031
range selection method range initialization spend 0.011588096618652344
time for parepare:  0.015639543533325195
local_output_nid generation:  0.010726451873779297
local_in_edges_tensor generation:  0.007333278656005859
mini_batch_src_global generation:  0.008172273635864258
r_  generation:  0.11675119400024414
local_output_nid generation:  0.012027502059936523
local_in_edges_tensor generation:  0.005331754684448242
mini_batch_src_global generation:  0.010836601257324219
r_  generation:  0.12699365615844727
----------------------check_connections_block total spend ----------------------------- 0.3637523651123047
generate_one_block  0.12975478172302246
generate_one_block  0.13229107856750488
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.024448394775390625
gen group dst list time:  0.005457639694213867
time for parepare:  0.01993250846862793
local_output_nid generation:  0.015164375305175781
local_in_edges_tensor generation:  0.02825617790222168
mini_batch_src_global generation:  0.03726458549499512
r_  generation:  0.38283848762512207
local_output_nid generation:  0.022343873977661133
local_in_edges_tensor generation:  0.024137020111083984
mini_batch_src_global generation:  0.04360604286193848
r_  generation:  0.40024590492248535
----------------------check_connections_block total spend ----------------------------- 1.1462552547454834
generate_one_block  0.483931303024292
generate_one_block  0.500495433807373
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.017575740814208984
gen group dst list time:  0.012447834014892578
time for parepare:  0.01928424835205078
local_output_nid generation:  0.023639440536499023
local_in_edges_tensor generation:  0.030070781707763672
mini_batch_src_global generation:  0.03123760223388672
r_  generation:  0.37064528465270996
local_output_nid generation:  0.030762195587158203
local_in_edges_tensor generation:  0.027976036071777344
mini_batch_src_global generation:  0.03773021697998047
r_  generation:  0.37822961807250977
----------------------check_connections_block total spend ----------------------------- 1.1140213012695312
generate_one_block  0.44417691230773926
generate_one_block  0.45485401153564453
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13905000686645508  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.2602765560150146
block generation total time  1.8834576606750488
average batch blocks generation time:  0.9417288303375244
block dataloader generation time/epoch 5.438853017489115
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10684633255004883  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1715688705444336  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10677385330200195  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1722278594970703  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07843577861785889 |0.010693073272705078 |0.0037659406661987305 |0.0005156993865966797 |0.0020765066146850586 |0.0012705326080322266 |
----------------------------------------------------------pseudo_mini_loss sum 1.0259621143341064
Total (block generation + training)time/epoch 5.7291325012842815
Training time/epoch 0.2962963581085205
Training time without block to device /epoch 0.27491021156311035
Training time without total dataloading part /epoch 0.013986825942993164
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 43.37it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.74it/s]100%|██████████| 4/4 [00:00<00:00, 15.89it/s]100%|██████████| 4/4 [00:00<00:00, 15.85it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.43it/s]100%|██████████| 4/4 [00:00<00:00, 20.58it/s]
Run 00 | Epoch 00069 | Loss 1.0260 | Train 0.3120 | Val 0.3037 | Test 0.2891
Number of nodes during this epoch:  328612
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1376504898071289  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.011320352554321289
range selection method range initialization spend 0.015213251113891602
time for parepare:  0.014452934265136719
local_output_nid generation:  0.010620832443237305
local_in_edges_tensor generation:  0.013684511184692383
mini_batch_src_global generation:  0.012210607528686523
r_  generation:  0.11993265151977539
local_output_nid generation:  0.014242172241210938
local_in_edges_tensor generation:  0.005864143371582031
mini_batch_src_global generation:  0.01063990592956543
r_  generation:  0.1288769245147705
----------------------check_connections_block total spend ----------------------------- 0.3831355571746826
generate_one_block  0.14634156227111816
generate_one_block  0.14041852951049805
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03191781044006348
gen group dst list time:  0.0066986083984375
time for parepare:  0.02175450325012207
local_output_nid generation:  0.01878976821899414
local_in_edges_tensor generation:  0.030534982681274414
mini_batch_src_global generation:  0.03510403633117676
r_  generation:  0.4120666980743408
local_output_nid generation:  0.02808856964111328
local_in_edges_tensor generation:  0.02581167221069336
mini_batch_src_global generation:  0.0471799373626709
r_  generation:  0.4164085388183594
----------------------check_connections_block total spend ----------------------------- 1.24383544921875
generate_one_block  0.5021107196807861
generate_one_block  0.5019927024841309
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.018500328063964844
gen group dst list time:  0.011043310165405273
time for parepare:  0.018904685974121094
local_output_nid generation:  0.024280548095703125
local_in_edges_tensor generation:  0.030337095260620117
mini_batch_src_global generation:  0.03163409233093262
r_  generation:  0.3768279552459717
local_output_nid generation:  0.03160810470581055
local_in_edges_tensor generation:  0.025979042053222656
mini_batch_src_global generation:  0.03771495819091797
r_  generation:  0.3814353942871094
----------------------check_connections_block total spend ----------------------------- 1.1259417533874512
generate_one_block  0.4523963928222656
generate_one_block  0.4539377689361572
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1376504898071289  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.369777202606201
block generation total time  1.9104375839233398
average batch blocks generation time:  0.9552187919616699
block dataloader generation time/epoch 5.443011506659086
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10688018798828125  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1728081703186035  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10770463943481445  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1736326217651367  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07692337036132812 |0.010560035705566406 |0.004045248031616211 |0.0005352497100830078 |0.002454400062561035 |0.0013556480407714844 |
----------------------------------------------------------pseudo_mini_loss sum 1.024872064590454
Total (block generation + training)time/epoch 5.733254706273313
Training time/epoch 0.28793978691101074
Training time without block to device /epoch 0.26681971549987793
Training time without total dataloading part /epoch 0.015425443649291992
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.37it/s]100%|██████████| 4/4 [00:00<00:00, 27.95it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.68it/s]100%|██████████| 4/4 [00:00<00:00, 12.28it/s]100%|██████████| 4/4 [00:00<00:00, 12.18it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.70it/s]100%|██████████| 4/4 [00:00<00:00, 17.16it/s]100%|██████████| 4/4 [00:00<00:00, 17.22it/s]
Run 00 | Epoch 00070 | Loss 1.0249 | Train 0.3101 | Val 0.2987 | Test 0.2838
Number of nodes during this epoch:  328756
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13909196853637695  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.009715795516967773
range selection method range initialization spend 0.011675596237182617
time for parepare:  0.014925956726074219
local_output_nid generation:  0.010874748229980469
local_in_edges_tensor generation:  0.007664918899536133
mini_batch_src_global generation:  0.008192062377929688
r_  generation:  0.11652994155883789
local_output_nid generation:  0.011926889419555664
local_in_edges_tensor generation:  0.005347013473510742
mini_batch_src_global generation:  0.010986089706420898
r_  generation:  0.12642407417297363
----------------------check_connections_block total spend ----------------------------- 0.36266064643859863
generate_one_block  0.12862229347229004
generate_one_block  0.13316106796264648
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02556586265563965
gen group dst list time:  0.005547046661376953
time for parepare:  0.019933700561523438
local_output_nid generation:  0.015842676162719727
local_in_edges_tensor generation:  0.022696495056152344
mini_batch_src_global generation:  0.03564143180847168
r_  generation:  0.383805513381958
local_output_nid generation:  0.024123191833496094
local_in_edges_tensor generation:  0.0209197998046875
mini_batch_src_global generation:  0.04373788833618164
r_  generation:  0.4073340892791748
----------------------check_connections_block total spend ----------------------------- 1.1532115936279297
generate_one_block  0.5194520950317383
generate_one_block  0.5010795593261719
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02135181427001953
gen group dst list time:  0.012772560119628906
time for parepare:  0.021431446075439453
local_output_nid generation:  0.0247344970703125
local_in_edges_tensor generation:  0.04003262519836426
mini_batch_src_global generation:  0.032885074615478516
r_  generation:  0.37903785705566406
local_output_nid generation:  0.032184600830078125
local_in_edges_tensor generation:  0.037012338638305664
mini_batch_src_global generation:  0.03787422180175781
r_  generation:  0.38813185691833496
----------------------check_connections_block total spend ----------------------------- 1.1624577045440674
generate_one_block  0.4595649242401123
generate_one_block  0.4588792324066162
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13909196853637695  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.315669298171997
block generation total time  1.9389758110046387
average batch blocks generation time:  0.9694879055023193
block dataloader generation time/epoch 5.4444033715032765
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10676097869873047  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1713919639587402  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10682439804077148  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1727023124694824  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07415175437927246 |0.012080669403076172 |0.004082679748535156 |0.0005115270614624023 |0.00208282470703125 |0.001367330551147461 |
----------------------------------------------------------pseudo_mini_loss sum 1.0210282802581787
Total (block generation + training)time/epoch 5.734590407340757
Training time/epoch 0.2866027355194092
Training time without block to device /epoch 0.26244139671325684
Training time without total dataloading part /epoch 0.014721393585205078
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 66.85it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.34it/s]100%|██████████| 4/4 [00:00<00:00, 15.56it/s]100%|██████████| 4/4 [00:00<00:00, 15.52it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.72it/s]100%|██████████| 4/4 [00:00<00:00, 17.76it/s]100%|██████████| 4/4 [00:00<00:00, 17.73it/s]
Run 00 | Epoch 00071 | Loss 1.0210 | Train 0.3076 | Val 0.2941 | Test 0.2786
Number of nodes during this epoch:  328519
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13776445388793945  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.009918928146362305
range selection method range initialization spend 0.011748552322387695
time for parepare:  0.01487588882446289
local_output_nid generation:  0.010630369186401367
local_in_edges_tensor generation:  0.007447719573974609
mini_batch_src_global generation:  0.008289813995361328
r_  generation:  0.11585378646850586
local_output_nid generation:  0.012016773223876953
local_in_edges_tensor generation:  0.005739450454711914
mini_batch_src_global generation:  0.011062145233154297
r_  generation:  0.12751078605651855
----------------------check_connections_block total spend ----------------------------- 0.3652329444885254
generate_one_block  0.13120198249816895
generate_one_block  0.1319572925567627
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.026020050048828125
gen group dst list time:  0.005381107330322266
time for parepare:  0.019945144653320312
local_output_nid generation:  0.01590251922607422
local_in_edges_tensor generation:  0.02512812614440918
mini_batch_src_global generation:  0.035421133041381836
r_  generation:  0.3883788585662842
local_output_nid generation:  0.02294135093688965
local_in_edges_tensor generation:  0.02157449722290039
mini_batch_src_global generation:  0.04310345649719238
r_  generation:  0.39976000785827637
----------------------check_connections_block total spend ----------------------------- 1.14384126663208
generate_one_block  0.48693013191223145
generate_one_block  0.4856860637664795
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.018300533294677734
gen group dst list time:  0.01093912124633789
time for parepare:  0.01903676986694336
local_output_nid generation:  0.024146556854248047
local_in_edges_tensor generation:  0.0294802188873291
mini_batch_src_global generation:  0.03128767013549805
r_  generation:  0.3715705871582031
local_output_nid generation:  0.030729055404663086
local_in_edges_tensor generation:  0.026824235916137695
mini_batch_src_global generation:  0.037807464599609375
r_  generation:  0.37856364250183105
----------------------check_connections_block total spend ----------------------------- 1.1129720211029053
generate_one_block  0.44974255561828613
generate_one_block  0.4492506980895996
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13776445388793945  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.2568132877349854
block generation total time  1.8716094493865967
average batch blocks generation time:  0.9358047246932983
block dataloader generation time/epoch 5.443738558935741
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10688257217407227  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1728439331054688  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10765409469604492  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1734209060668945  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07642078399658203 |0.011699795722961426 |0.0038634538650512695 |0.0005210638046264648 |0.0020639896392822266 |0.0012943744659423828 |
----------------------------------------------------------pseudo_mini_loss sum 1.0179201364517212
Total (block generation + training)time/epoch 5.733917103873359
Training time/epoch 0.2895674705505371
Training time without block to device /epoch 0.26616787910461426
Training time without total dataloading part /epoch 0.014191389083862305
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.20it/s]100%|██████████| 4/4 [00:00<00:00, 31.72it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.61it/s]100%|██████████| 4/4 [00:00<00:00, 12.79it/s]100%|██████████| 4/4 [00:00<00:00, 12.59it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.27it/s]100%|██████████| 4/4 [00:00<00:00, 17.79it/s]100%|██████████| 4/4 [00:00<00:00, 17.69it/s]
Run 00 | Epoch 00072 | Loss 1.0179 | Train 0.3048 | Val 0.2902 | Test 0.2735
Number of nodes during this epoch:  328679
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1390218734741211  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.011105060577392578
range selection method range initialization spend 0.011575460433959961
time for parepare:  0.01538538932800293
local_output_nid generation:  0.010825395584106445
local_in_edges_tensor generation:  0.008454322814941406
mini_batch_src_global generation:  0.00831747055053711
r_  generation:  0.11713409423828125
local_output_nid generation:  0.011972665786743164
local_in_edges_tensor generation:  0.005721569061279297
mini_batch_src_global generation:  0.010622739791870117
r_  generation:  0.12755298614501953
----------------------check_connections_block total spend ----------------------------- 0.3654921054840088
generate_one_block  0.13048887252807617
generate_one_block  0.13381743431091309
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.034912824630737305
gen group dst list time:  0.006977558135986328
time for parepare:  0.022400856018066406
local_output_nid generation:  0.01580190658569336
local_in_edges_tensor generation:  0.03941607475280762
mini_batch_src_global generation:  0.037363290786743164
r_  generation:  0.3888125419616699
local_output_nid generation:  0.02343440055847168
local_in_edges_tensor generation:  0.023334264755249023
mini_batch_src_global generation:  0.0428614616394043
r_  generation:  0.399507999420166
----------------------check_connections_block total spend ----------------------------- 1.1653695106506348
generate_one_block  0.48821330070495605
generate_one_block  0.4894857406616211
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01974773406982422
gen group dst list time:  0.01100778579711914
time for parepare:  0.018731355667114258
local_output_nid generation:  0.023033618927001953
local_in_edges_tensor generation:  0.03474140167236328
mini_batch_src_global generation:  0.031510114669799805
r_  generation:  0.3713974952697754
local_output_nid generation:  0.03042435646057129
local_in_edges_tensor generation:  0.027685880661010742
mini_batch_src_global generation:  0.037508249282836914
r_  generation:  0.3793351650238037
----------------------check_connections_block total spend ----------------------------- 1.1188559532165527
generate_one_block  0.4482383728027344
generate_one_block  0.451810359954834
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1390218734741211  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.2842254638671875
block generation total time  1.8777477741241455
average batch blocks generation time:  0.9388738870620728
block dataloader generation time/epoch 5.4437592178583145
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10673713684082031  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.167912483215332  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10686874389648438  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1730623245239258  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07901263236999512 |0.010980963706970215 |0.0040814876556396484 |0.0005375146865844727 |0.03093695640563965 |0.0023050308227539062 |
----------------------------------------------------------pseudo_mini_loss sum 1.0130741596221924
Total (block generation + training)time/epoch 5.73392728343606
Training time/epoch 0.289339542388916
Training time without block to device /epoch 0.2673776149749756
Training time without total dataloading part /epoch 0.07341694831848145
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 59.26it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.98it/s]100%|██████████| 4/4 [00:00<00:00, 15.33it/s]100%|██████████| 4/4 [00:00<00:00, 15.26it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.30it/s]100%|██████████| 4/4 [00:00<00:00, 17.65it/s]100%|██████████| 4/4 [00:00<00:00, 17.58it/s]
Run 00 | Epoch 00073 | Loss 1.0131 | Train 0.3010 | Val 0.2850 | Test 0.2676
Number of nodes during this epoch:  328592
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13768625259399414  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.010468482971191406
range selection method range initialization spend 0.01196908950805664
time for parepare:  0.014932632446289062
local_output_nid generation:  0.010704755783081055
local_in_edges_tensor generation:  0.0076520442962646484
mini_batch_src_global generation:  0.0081787109375
r_  generation:  0.11693811416625977
local_output_nid generation:  0.012050867080688477
local_in_edges_tensor generation:  0.005261659622192383
mini_batch_src_global generation:  0.010876893997192383
r_  generation:  0.12589645385742188
----------------------check_connections_block total spend ----------------------------- 0.3618297576904297
generate_one_block  0.13032102584838867
generate_one_block  0.1325535774230957
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.027035951614379883
gen group dst list time:  0.005408048629760742
time for parepare:  0.019707202911376953
local_output_nid generation:  0.015410423278808594
local_in_edges_tensor generation:  0.02358078956604004
mini_batch_src_global generation:  0.03519177436828613
r_  generation:  0.3842658996582031
local_output_nid generation:  0.02235126495361328
local_in_edges_tensor generation:  0.023868560791015625
mini_batch_src_global generation:  0.043694257736206055
r_  generation:  0.40320849418640137
----------------------check_connections_block total spend ----------------------------- 1.1427736282348633
generate_one_block  0.4863569736480713
generate_one_block  0.4849402904510498
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01791834831237793
gen group dst list time:  0.010903358459472656
time for parepare:  0.01894998550415039
local_output_nid generation:  0.023690223693847656
local_in_edges_tensor generation:  0.03014063835144043
mini_batch_src_global generation:  0.03103184700012207
r_  generation:  0.37100720405578613
local_output_nid generation:  0.02978801727294922
local_in_edges_tensor generation:  0.026314735412597656
mini_batch_src_global generation:  0.03813028335571289
r_  generation:  0.378307580947876
----------------------check_connections_block total spend ----------------------------- 1.1113371849060059
generate_one_block  0.44602346420288086
generate_one_block  0.44536662101745605
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13768625259399414  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.254110813140869
block generation total time  1.862687349319458
average batch blocks generation time:  0.931343674659729
block dataloader generation time/epoch 5.442756069623507
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10766887664794922  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1712255477905273  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10764408111572266  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.172898292541504  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07498741149902344 |0.010806918144226074 |0.0038291215896606445 |0.0005179643630981445 |0.002258896827697754 |0.0012955665588378906 |
----------------------------------------------------------pseudo_mini_loss sum 1.014058232307434
Total (block generation + training)time/epoch 5.732881945830125
Training time/epoch 0.2873408794403076
Training time without block to device /epoch 0.26572704315185547
Training time without total dataloading part /epoch 0.014507532119750977
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 64.00it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.94it/s]100%|██████████| 4/4 [00:00<00:00, 15.43it/s]100%|██████████| 4/4 [00:00<00:00, 15.34it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.04it/s]100%|██████████| 4/4 [00:00<00:00, 17.41it/s]100%|██████████| 4/4 [00:00<00:00, 17.33it/s]
Run 00 | Epoch 00074 | Loss 1.0141 | Train 0.2982 | Val 0.2806 | Test 0.2620
Number of nodes during this epoch:  328502
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13895225524902344  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.012082576751708984
range selection method range initialization spend 0.015391349792480469
time for parepare:  0.01452779769897461
local_output_nid generation:  0.010847330093383789
local_in_edges_tensor generation:  0.008173704147338867
mini_batch_src_global generation:  0.009958267211914062
r_  generation:  0.11785602569580078
local_output_nid generation:  0.012042999267578125
local_in_edges_tensor generation:  0.005298137664794922
mini_batch_src_global generation:  0.010971784591674805
r_  generation:  0.12450265884399414
----------------------check_connections_block total spend ----------------------------- 0.36449670791625977
generate_one_block  0.12994647026062012
generate_one_block  0.13236117362976074
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.025541305541992188
gen group dst list time:  0.0053899288177490234
time for parepare:  0.019989013671875
local_output_nid generation:  0.015827417373657227
local_in_edges_tensor generation:  0.02337789535522461
mini_batch_src_global generation:  0.03575253486633301
r_  generation:  0.39377450942993164
local_output_nid generation:  0.022906780242919922
local_in_edges_tensor generation:  0.021540164947509766
mini_batch_src_global generation:  0.044209957122802734
r_  generation:  0.40506720542907715
----------------------check_connections_block total spend ----------------------------- 1.1557164192199707
generate_one_block  0.5001745223999023
generate_one_block  0.49664783477783203
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.019570112228393555
gen group dst list time:  0.011080026626586914
time for parepare:  0.01916193962097168
local_output_nid generation:  0.024152278900146484
local_in_edges_tensor generation:  0.03227639198303223
mini_batch_src_global generation:  0.03201413154602051
r_  generation:  0.37606000900268555
local_output_nid generation:  0.03087615966796875
local_in_edges_tensor generation:  0.026296138763427734
mini_batch_src_global generation:  0.038156986236572266
r_  generation:  0.3809819221496582
----------------------check_connections_block total spend ----------------------------- 1.125788688659668
generate_one_block  0.45267653465270996
generate_one_block  0.45857930183410645
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13895225524902344  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.2815051078796387
block generation total time  1.9080781936645508
average batch blocks generation time:  0.9540390968322754
block dataloader generation time/epoch 5.44275595925071
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10678482055664062  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.172438621520996  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10682106018066406  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1719989776611328  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0759584903717041 |0.014574527740478516 |0.0038576126098632812 |0.0004912614822387695 |0.0020265579223632812 |0.0012733936309814453 |
----------------------------------------------------------pseudo_mini_loss sum 1.010376214981079
Total (block generation + training)time/epoch 5.732974554553176
Training time/epoch 0.2961592674255371
Training time without block to device /epoch 0.2670102119445801
Training time without total dataloading part /epoch 0.01402425765991211
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 49.07it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.91it/s]100%|██████████| 4/4 [00:00<00:00, 15.45it/s]100%|██████████| 4/4 [00:00<00:00, 15.35it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.34it/s]100%|██████████| 4/4 [00:00<00:00, 15.98it/s]100%|██████████| 4/4 [00:00<00:00, 16.15it/s]
Run 00 | Epoch 00075 | Loss 1.0104 | Train 0.2969 | Val 0.2764 | Test 0.2577
Number of nodes during this epoch:  328560
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13770627975463867  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.012928962707519531
range selection method range initialization spend 0.012004613876342773
time for parepare:  0.015424728393554688
local_output_nid generation:  0.010850191116333008
local_in_edges_tensor generation:  0.007412910461425781
mini_batch_src_global generation:  0.008170604705810547
r_  generation:  0.12225127220153809
local_output_nid generation:  0.012744426727294922
local_in_edges_tensor generation:  0.005303382873535156
mini_batch_src_global generation:  0.010954141616821289
r_  generation:  0.12462306022644043
----------------------check_connections_block total spend ----------------------------- 0.3686792850494385
generate_one_block  0.12902212142944336
generate_one_block  0.13176345825195312
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.026059627532958984
gen group dst list time:  0.005455732345581055
time for parepare:  0.019973039627075195
local_output_nid generation:  0.015364646911621094
local_in_edges_tensor generation:  0.03417611122131348
mini_batch_src_global generation:  0.036743879318237305
r_  generation:  0.3880629539489746
local_output_nid generation:  0.022791147232055664
local_in_edges_tensor generation:  0.024442434310913086
mini_batch_src_global generation:  0.0434877872467041
r_  generation:  0.40352392196655273
----------------------check_connections_block total spend ----------------------------- 1.1614630222320557
generate_one_block  0.4867987632751465
generate_one_block  0.49042534828186035
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.017548561096191406
gen group dst list time:  0.011084318161010742
time for parepare:  0.01963949203491211
local_output_nid generation:  0.023439645767211914
local_in_edges_tensor generation:  0.02983546257019043
mini_batch_src_global generation:  0.03111100196838379
r_  generation:  0.3714613914489746
local_output_nid generation:  0.03040289878845215
local_in_edges_tensor generation:  0.027263879776000977
mini_batch_src_global generation:  0.03815913200378418
r_  generation:  0.37787437438964844
----------------------check_connections_block total spend ----------------------------- 1.1133787631988525
generate_one_block  0.44605040550231934
generate_one_block  0.44954538345336914
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13770627975463867  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.274841785430908
block generation total time  1.8728199005126953
average batch blocks generation time:  0.9364099502563477
block dataloader generation time/epoch 5.442232409519936
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10677480697631836  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1715049743652344  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10774421691894531  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.178184986114502  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0791935920715332 |0.010907769203186035 |0.004091858863830566 |0.0005260705947875977 |0.0019230842590332031 |0.0013806819915771484 |
----------------------------------------------------------pseudo_mini_loss sum 1.01094388961792
Total (block generation + training)time/epoch 5.732451104406101
Training time/epoch 0.29006433486938477
Training time without block to device /epoch 0.2682487964630127
Training time without total dataloading part /epoch 0.014462709426879883
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.40it/s]100%|██████████| 4/4 [00:00<00:00, 31.45it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.32it/s]100%|██████████| 4/4 [00:00<00:00, 12.57it/s]100%|██████████| 4/4 [00:00<00:00, 12.35it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.44it/s]100%|██████████| 4/4 [00:00<00:00, 17.44it/s]100%|██████████| 4/4 [00:00<00:00, 17.42it/s]
Run 00 | Epoch 00076 | Loss 1.0109 | Train 0.2960 | Val 0.2728 | Test 0.2550
Number of nodes during this epoch:  328661
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1391921043395996  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01311945915222168
range selection method range initialization spend 0.011568307876586914
time for parepare:  0.015208244323730469
local_output_nid generation:  0.010578393936157227
local_in_edges_tensor generation:  0.007424354553222656
mini_batch_src_global generation:  0.008309364318847656
r_  generation:  0.1174020767211914
local_output_nid generation:  0.011923789978027344
local_in_edges_tensor generation:  0.005349159240722656
mini_batch_src_global generation:  0.010912895202636719
r_  generation:  0.12489485740661621
----------------------check_connections_block total spend ----------------------------- 0.36174607276916504
generate_one_block  0.13088178634643555
generate_one_block  0.13240981101989746
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.024580955505371094
gen group dst list time:  0.005387544631958008
time for parepare:  0.020033836364746094
local_output_nid generation:  0.015409231185913086
local_in_edges_tensor generation:  0.024954795837402344
mini_batch_src_global generation:  0.03799581527709961
r_  generation:  0.38776469230651855
local_output_nid generation:  0.022492170333862305
local_in_edges_tensor generation:  0.021586179733276367
mini_batch_src_global generation:  0.04378080368041992
r_  generation:  0.39638400077819824
----------------------check_connections_block total spend ----------------------------- 1.1419260501861572
generate_one_block  0.4899582862854004
generate_one_block  0.48964929580688477
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02749919891357422
gen group dst list time:  0.01100468635559082
time for parepare:  0.018886804580688477
local_output_nid generation:  0.02378702163696289
local_in_edges_tensor generation:  0.030107736587524414
mini_batch_src_global generation:  0.03177762031555176
r_  generation:  0.37168383598327637
local_output_nid generation:  0.03013157844543457
local_in_edges_tensor generation:  0.028839111328125
mini_batch_src_global generation:  0.03760361671447754
r_  generation:  0.3782482147216797
----------------------check_connections_block total spend ----------------------------- 1.1150140762329102
generate_one_block  0.4492948055267334
generate_one_block  0.4480626583099365
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1391921043395996  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.2569401264190674
block generation total time  1.876965045928955
average batch blocks generation time:  0.9384825229644775
block dataloader generation time/epoch 5.441839060362647
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10684919357299805  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.17252779006958  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1067967414855957  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1713008880615234  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07685232162475586 |0.010760903358459473 |0.0038040876388549805 |0.0005170106887817383 |0.0027767419815063477 |0.001283407211303711 |
----------------------------------------------------------pseudo_mini_loss sum 1.0034559965133667
Total (block generation + training)time/epoch 5.732072318301482
Training time/epoch 0.2911238670349121
Training time without block to device /epoch 0.26960206031799316
Training time without total dataloading part /epoch 0.015479087829589844
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 65.64it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.87it/s]100%|██████████| 4/4 [00:00<00:00, 15.22it/s]100%|██████████| 4/4 [00:00<00:00, 15.16it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.23it/s]100%|██████████| 4/4 [00:00<00:00, 17.34it/s]100%|██████████| 4/4 [00:00<00:00, 17.31it/s]
Run 00 | Epoch 00077 | Loss 1.0035 | Train 0.2953 | Val 0.2698 | Test 0.2520
Number of nodes during this epoch:  328674
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1376819610595703  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.010270118713378906
range selection method range initialization spend 0.011833429336547852
time for parepare:  0.015002965927124023
local_output_nid generation:  0.010738134384155273
local_in_edges_tensor generation:  0.007336854934692383
mini_batch_src_global generation:  0.00823354721069336
r_  generation:  0.1160285472869873
local_output_nid generation:  0.011926412582397461
local_in_edges_tensor generation:  0.005262613296508789
mini_batch_src_global generation:  0.010950326919555664
r_  generation:  0.12508010864257812
----------------------check_connections_block total spend ----------------------------- 0.36001133918762207
generate_one_block  0.12978410720825195
generate_one_block  0.1330854892730713
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.024504423141479492
gen group dst list time:  0.005336284637451172
time for parepare:  0.02016925811767578
local_output_nid generation:  0.015720844268798828
local_in_edges_tensor generation:  0.023240089416503906
mini_batch_src_global generation:  0.036084651947021484
r_  generation:  0.3925457000732422
local_output_nid generation:  0.022506237030029297
local_in_edges_tensor generation:  0.02164912223815918
mini_batch_src_global generation:  0.04300498962402344
r_  generation:  0.40502119064331055
----------------------check_connections_block total spend ----------------------------- 1.1510510444641113
generate_one_block  0.4953923225402832
generate_one_block  0.48983311653137207
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.018336057662963867
gen group dst list time:  0.01089334487915039
time for parepare:  0.019202470779418945
local_output_nid generation:  0.02386188507080078
local_in_edges_tensor generation:  0.029268503189086914
mini_batch_src_global generation:  0.03202533721923828
r_  generation:  0.37371397018432617
local_output_nid generation:  0.030605316162109375
local_in_edges_tensor generation:  0.02620100975036621
mini_batch_src_global generation:  0.037687063217163086
r_  generation:  0.37995243072509766
----------------------check_connections_block total spend ----------------------------- 1.1163382530212402
generate_one_block  0.447613000869751
generate_one_block  0.45064234733581543
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1376819610595703  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.2673892974853516
block generation total time  1.8834807872772217
average batch blocks generation time:  0.9417403936386108
block dataloader generation time/epoch 5.440954426060552
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10686111450195312  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1734819412231445  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1076507568359375  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1697354316711426  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07578849792480469 |0.01090538501739502 |0.0038193464279174805 |0.000518798828125 |0.0018646717071533203 |0.0012879371643066406 |
----------------------------------------------------------pseudo_mini_loss sum 0.9998438358306885
Total (block generation + training)time/epoch 5.731048660001893
Training time/epoch 0.28055334091186523
Training time without block to device /epoch 0.2587425708770752
Training time without total dataloading part /epoch 0.013693571090698242
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 66.55it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.97it/s]100%|██████████| 4/4 [00:00<00:00, 15.27it/s]100%|██████████| 4/4 [00:00<00:00, 15.21it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.23it/s]100%|██████████| 4/4 [00:00<00:00, 17.29it/s]100%|██████████| 4/4 [00:00<00:00, 17.26it/s]
Run 00 | Epoch 00078 | Loss 0.9998 | Train 0.2925 | Val 0.2642 | Test 0.2471
Number of nodes during this epoch:  328604
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13897085189819336  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.013419628143310547
range selection method range initialization spend 0.011726617813110352
time for parepare:  0.015243053436279297
local_output_nid generation:  0.011158227920532227
local_in_edges_tensor generation:  0.007549762725830078
mini_batch_src_global generation:  0.008758306503295898
r_  generation:  0.11480307579040527
local_output_nid generation:  0.011966943740844727
local_in_edges_tensor generation:  0.005432844161987305
mini_batch_src_global generation:  0.010733604431152344
r_  generation:  0.1276710033416748
----------------------check_connections_block total spend ----------------------------- 0.36402201652526855
generate_one_block  0.13045668601989746
generate_one_block  0.13318753242492676
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.024940013885498047
gen group dst list time:  0.005440473556518555
time for parepare:  0.019864559173583984
local_output_nid generation:  0.015686988830566406
local_in_edges_tensor generation:  0.027121305465698242
mini_batch_src_global generation:  0.035141706466674805
r_  generation:  0.38529109954833984
local_output_nid generation:  0.02285289764404297
local_in_edges_tensor generation:  0.021652936935424805
mini_batch_src_global generation:  0.04327964782714844
r_  generation:  0.39992833137512207
----------------------check_connections_block total spend ----------------------------- 1.1427550315856934
generate_one_block  0.4890098571777344
generate_one_block  0.492779016494751
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.017861366271972656
gen group dst list time:  0.010972976684570312
time for parepare:  0.01914691925048828
local_output_nid generation:  0.024172067642211914
local_in_edges_tensor generation:  0.03055858612060547
mini_batch_src_global generation:  0.03134441375732422
r_  generation:  0.3759167194366455
local_output_nid generation:  0.030715227127075195
local_in_edges_tensor generation:  0.02641129493713379
mini_batch_src_global generation:  0.03789353370666504
r_  generation:  0.3839693069458008
----------------------check_connections_block total spend ----------------------------- 1.1265099048614502
generate_one_block  0.4476585388183594
generate_one_block  0.44508814811706543
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13897085189819336  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.2692649364471436
block generation total time  1.8745355606079102
average batch blocks generation time:  0.9372677803039551
block dataloader generation time/epoch 5.440310352189201
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10684967041015625  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.172126293182373  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10682010650634766  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1721997261047363  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0766974687576294 |0.011082172393798828 |0.0038260221481323242 |0.0005223751068115234 |0.0018821954727172852 |0.0012750625610351562 |
----------------------------------------------------------pseudo_mini_loss sum 0.9973857402801514
Total (block generation + training)time/epoch 5.73040417262486
Training time/epoch 0.2899775505065918
Training time without block to device /epoch 0.26781320571899414
Training time without total dataloading part /epoch 0.013736248016357422
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 66.50it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.88it/s]100%|██████████| 4/4 [00:00<00:00, 15.32it/s]100%|██████████| 4/4 [00:00<00:00, 15.24it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.07it/s]100%|██████████| 4/4 [00:00<00:00, 17.47it/s]100%|██████████| 4/4 [00:00<00:00, 17.39it/s]
Run 00 | Epoch 00079 | Loss 0.9974 | Train 0.2892 | Val 0.2578 | Test 0.2400
Number of nodes during this epoch:  328621
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13764333724975586  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.010129213333129883
range selection method range initialization spend 0.011619329452514648
time for parepare:  0.01543569564819336
local_output_nid generation:  0.010923624038696289
local_in_edges_tensor generation:  0.0074689388275146484
mini_batch_src_global generation:  0.008194923400878906
r_  generation:  0.11522269248962402
local_output_nid generation:  0.011993885040283203
local_in_edges_tensor generation:  0.006842136383056641
mini_batch_src_global generation:  0.010712146759033203
r_  generation:  0.12699294090270996
----------------------check_connections_block total spend ----------------------------- 0.3638167381286621
generate_one_block  0.1339280605316162
generate_one_block  0.13659930229187012
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02814173698425293
gen group dst list time:  0.0055999755859375
time for parepare:  0.021048545837402344
local_output_nid generation:  0.016679048538208008
local_in_edges_tensor generation:  0.029081106185913086
mini_batch_src_global generation:  0.03998684883117676
r_  generation:  0.4068119525909424
local_output_nid generation:  0.025664567947387695
local_in_edges_tensor generation:  0.026105165481567383
mini_batch_src_global generation:  0.04350113868713379
r_  generation:  0.4016387462615967
----------------------check_connections_block total spend ----------------------------- 1.1837997436523438
generate_one_block  0.4878265857696533
generate_one_block  0.49477672576904297
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.017626047134399414
gen group dst list time:  0.011180877685546875
time for parepare:  0.01928257942199707
local_output_nid generation:  0.024598360061645508
local_in_edges_tensor generation:  0.03762531280517578
mini_batch_src_global generation:  0.03158283233642578
r_  generation:  0.37090182304382324
local_output_nid generation:  0.03069472312927246
local_in_edges_tensor generation:  0.028568744659423828
mini_batch_src_global generation:  0.03721809387207031
r_  generation:  0.3783681392669678
----------------------check_connections_block total spend ----------------------------- 1.1231236457824707
generate_one_block  0.44788646697998047
generate_one_block  0.44791102409362793
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13764333724975586  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.3069233894348145
block generation total time  1.8784008026123047
average batch blocks generation time:  0.9392004013061523
block dataloader generation time/epoch 5.4405048061424575
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1076970100402832  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1741085052490234  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10764551162719727  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1733894348144531  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07801473140716553 |0.010948777198791504 |0.0039702653884887695 |0.0005270242691040039 |0.00207364559173584 |0.0013325214385986328 |
----------------------------------------------------------pseudo_mini_loss sum 0.9961627125740051
Total (block generation + training)time/epoch 5.730616660185263
Training time/epoch 0.2912266254425049
Training time without block to device /epoch 0.2693290710449219
Training time without total dataloading part /epoch 0.01447439193725586
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 57.47it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.98it/s]100%|██████████| 4/4 [00:00<00:00, 15.35it/s]100%|██████████| 4/4 [00:00<00:00, 15.28it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.63it/s]100%|██████████| 4/4 [00:00<00:00, 17.45it/s]100%|██████████| 4/4 [00:00<00:00, 17.46it/s]
Run 00 | Epoch 00080 | Loss 0.9962 | Train 0.2862 | Val 0.2519 | Test 0.2339
Number of nodes during this epoch:  328553
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13900995254516602  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.010807991027832031
range selection method range initialization spend 0.011868000030517578
time for parepare:  0.0153045654296875
local_output_nid generation:  0.011036872863769531
local_in_edges_tensor generation:  0.007622480392456055
mini_batch_src_global generation:  0.008212089538574219
r_  generation:  0.11809968948364258
local_output_nid generation:  0.011976480484008789
local_in_edges_tensor generation:  0.005262851715087891
mini_batch_src_global generation:  0.010900020599365234
r_  generation:  0.12497591972351074
----------------------check_connections_block total spend ----------------------------- 0.3631291389465332
generate_one_block  0.12854671478271484
generate_one_block  0.13288092613220215
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028522968292236328
gen group dst list time:  0.005295991897583008
time for parepare:  0.019805431365966797
local_output_nid generation:  0.01609182357788086
local_in_edges_tensor generation:  0.02899336814880371
mini_batch_src_global generation:  0.035033226013183594
r_  generation:  0.38330674171447754
local_output_nid generation:  0.022792577743530273
local_in_edges_tensor generation:  0.02241992950439453
mini_batch_src_global generation:  0.04277753829956055
r_  generation:  0.4026145935058594
----------------------check_connections_block total spend ----------------------------- 1.1450393199920654
generate_one_block  0.48805809020996094
generate_one_block  0.48684167861938477
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.018182992935180664
gen group dst list time:  0.010845422744750977
time for parepare:  0.018879175186157227
local_output_nid generation:  0.024387359619140625
local_in_edges_tensor generation:  0.029721736907958984
mini_batch_src_global generation:  0.030972957611083984
r_  generation:  0.37004661560058594
local_output_nid generation:  0.030089139938354492
local_in_edges_tensor generation:  0.02648472785949707
mini_batch_src_global generation:  0.03792929649353027
r_  generation:  0.38020896911621094
----------------------check_connections_block total spend ----------------------------- 1.1118557453155518
generate_one_block  0.44310426712036133
generate_one_block  0.45060300827026367
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13900995254516602  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.256895065307617
block generation total time  1.8686070442199707
average batch blocks generation time:  0.9343035221099854
block dataloader generation time/epoch 5.439651078648037
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10678529739379883  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1721124649047852  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10682392120361328  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1719732284545898  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0764162540435791 |0.01083219051361084 |0.003890514373779297 |0.0005332231521606445 |0.0020754337310791016 |0.00131988525390625 |
----------------------------------------------------------pseudo_mini_loss sum 0.9991457462310791
Total (block generation + training)time/epoch 5.7297930551899805
Training time/epoch 0.2921745777130127
Training time without block to device /epoch 0.270510196685791
Training time without total dataloading part /epoch 0.014318227767944336
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 67.05it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.06it/s]100%|██████████| 4/4 [00:00<00:00, 15.16it/s]100%|██████████| 4/4 [00:00<00:00, 15.13it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.02it/s]100%|██████████| 4/4 [00:00<00:00, 17.41it/s]100%|██████████| 4/4 [00:00<00:00, 17.33it/s]
Run 00 | Epoch 00081 | Loss 0.9991 | Train 0.2839 | Val 0.2471 | Test 0.2290
Number of nodes during this epoch:  328589
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13770580291748047  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01015162467956543
range selection method range initialization spend 0.01186513900756836
time for parepare:  0.015073299407958984
local_output_nid generation:  0.010796785354614258
local_in_edges_tensor generation:  0.00765228271484375
mini_batch_src_global generation:  0.00809335708618164
r_  generation:  0.11788415908813477
local_output_nid generation:  0.01209878921508789
local_in_edges_tensor generation:  0.005375385284423828
mini_batch_src_global generation:  0.010943174362182617
r_  generation:  0.12776446342468262
----------------------check_connections_block total spend ----------------------------- 0.3652522563934326
generate_one_block  0.1302201747894287
generate_one_block  0.1330273151397705
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.025598526000976562
gen group dst list time:  0.00539088249206543
time for parepare:  0.019910097122192383
local_output_nid generation:  0.01609063148498535
local_in_edges_tensor generation:  0.023905277252197266
mini_batch_src_global generation:  0.03647351264953613
r_  generation:  0.3873012065887451
local_output_nid generation:  0.022962570190429688
local_in_edges_tensor generation:  0.021636009216308594
mini_batch_src_global generation:  0.04517698287963867
r_  generation:  0.40241312980651855
----------------------check_connections_block total spend ----------------------------- 1.1469898223876953
generate_one_block  0.48698949813842773
generate_one_block  0.4902150630950928
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.018969058990478516
gen group dst list time:  0.010961532592773438
time for parepare:  0.019228458404541016
local_output_nid generation:  0.025670528411865234
local_in_edges_tensor generation:  0.04320049285888672
mini_batch_src_global generation:  0.033991336822509766
r_  generation:  0.38380885124206543
local_output_nid generation:  0.030280113220214844
local_in_edges_tensor generation:  0.02591395378112793
mini_batch_src_global generation:  0.039999961853027344
r_  generation:  0.37741637229919434
----------------------check_connections_block total spend ----------------------------- 1.1459410190582275
generate_one_block  0.46242594718933105
generate_one_block  0.4442310333251953
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13770580291748047  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.292930841445923
block generation total time  1.8838615417480469
average batch blocks generation time:  0.9419307708740234
block dataloader generation time/epoch 5.439476153621935
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10683298110961914  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1712651252746582  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10771656036376953  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1746420860290527  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07661712169647217 |0.010892510414123535 |0.003816843032836914 |0.0005205869674682617 |0.001546621322631836 |0.0012595653533935547 |
----------------------------------------------------------pseudo_mini_loss sum 0.9998519420623779
Total (block generation + training)time/epoch 5.729551772548728
Training time/epoch 0.28521180152893066
Training time without block to device /epoch 0.2634267807006836
Training time without total dataloading part /epoch 0.013027667999267578
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.67it/s]100%|██████████| 4/4 [00:00<00:00, 31.71it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.81it/s]100%|██████████| 4/4 [00:00<00:00, 12.80it/s]100%|██████████| 4/4 [00:00<00:00, 12.63it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.12it/s]100%|██████████| 4/4 [00:00<00:00, 17.37it/s]100%|██████████| 4/4 [00:00<00:00, 17.31it/s]
Run 00 | Epoch 00082 | Loss 0.9999 | Train 0.2822 | Val 0.2439 | Test 0.2258
Number of nodes during this epoch:  328726
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13915491104125977  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.011890888214111328
range selection method range initialization spend 0.011997461318969727
time for parepare:  0.014898061752319336
local_output_nid generation:  0.010750532150268555
local_in_edges_tensor generation:  0.007330656051635742
mini_batch_src_global generation:  0.008222341537475586
r_  generation:  0.11467790603637695
local_output_nid generation:  0.011902570724487305
local_in_edges_tensor generation:  0.005272626876831055
mini_batch_src_global generation:  0.010843992233276367
r_  generation:  0.12152647972106934
----------------------check_connections_block total spend ----------------------------- 0.3541443347930908
generate_one_block  0.12832903861999512
generate_one_block  0.1314563751220703
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0246732234954834
gen group dst list time:  0.0053751468658447266
time for parepare:  0.01953744888305664
local_output_nid generation:  0.016005992889404297
local_in_edges_tensor generation:  0.02383875846862793
mini_batch_src_global generation:  0.034880876541137695
r_  generation:  0.37952685356140137
local_output_nid generation:  0.02309441566467285
local_in_edges_tensor generation:  0.020473957061767578
mini_batch_src_global generation:  0.04196906089782715
r_  generation:  0.3941795825958252
----------------------check_connections_block total spend ----------------------------- 1.1225440502166748
generate_one_block  0.48769521713256836
generate_one_block  0.48560452461242676
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.018501996994018555
gen group dst list time:  0.010882377624511719
time for parepare:  0.019017934799194336
local_output_nid generation:  0.024252891540527344
local_in_edges_tensor generation:  0.02872633934020996
mini_batch_src_global generation:  0.031478166580200195
r_  generation:  0.40154290199279785
local_output_nid generation:  0.030952930450439453
local_in_edges_tensor generation:  0.02679920196533203
mini_batch_src_global generation:  0.03815603256225586
r_  generation:  0.38411474227905273
----------------------check_connections_block total spend ----------------------------- 1.151174783706665
generate_one_block  0.44297075271606445
generate_one_block  0.4486539363861084
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13915491104125977  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.27371883392334
block generation total time  1.864924430847168
average batch blocks generation time:  0.932462215423584
block dataloader generation time/epoch 5.438644489726505
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10684537887573242  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1728081703186035  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10684728622436523  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1718401908874512  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07621538639068604 |0.019348859786987305 |0.003756284713745117 |0.0005161762237548828 |0.0014603137969970703 |0.0011382102966308594 |
----------------------------------------------------------pseudo_mini_loss sum 0.9909228086471558
Total (block generation + training)time/epoch 5.728941256935532
Training time/epoch 0.30635571479797363
Training time without block to device /epoch 0.267657995223999
Training time without total dataloading part /epoch 0.012603759765625
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 42.95it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.40it/s]100%|██████████| 4/4 [00:00<00:00, 15.73it/s]100%|██████████| 4/4 [00:00<00:00, 15.66it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.41it/s]100%|██████████| 4/4 [00:00<00:00, 19.78it/s]
Run 00 | Epoch 00083 | Loss 0.9909 | Train 0.2805 | Val 0.2401 | Test 0.2218
Number of nodes during this epoch:  328722
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13768815994262695  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.011588573455810547
range selection method range initialization spend 0.01570272445678711
time for parepare:  0.016208171844482422
local_output_nid generation:  0.011087179183959961
local_in_edges_tensor generation:  0.008537769317626953
mini_batch_src_global generation:  0.008297920227050781
r_  generation:  0.11668968200683594
local_output_nid generation:  0.011879682540893555
local_in_edges_tensor generation:  0.0056591033935546875
mini_batch_src_global generation:  0.011036872863769531
r_  generation:  0.12786269187927246
----------------------check_connections_block total spend ----------------------------- 0.367480993270874
generate_one_block  0.12986016273498535
generate_one_block  0.13414907455444336
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.027631521224975586
gen group dst list time:  0.005439281463623047
time for parepare:  0.021392107009887695
local_output_nid generation:  0.015796899795532227
local_in_edges_tensor generation:  0.03160357475280762
mini_batch_src_global generation:  0.03624224662780762
r_  generation:  0.38566088676452637
local_output_nid generation:  0.02294325828552246
local_in_edges_tensor generation:  0.024929285049438477
mini_batch_src_global generation:  0.04481101036071777
r_  generation:  0.40023279190063477
----------------------check_connections_block total spend ----------------------------- 1.1578068733215332
generate_one_block  0.4958500862121582
generate_one_block  0.5105621814727783
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01997518539428711
gen group dst list time:  0.011045217514038086
time for parepare:  0.019208669662475586
local_output_nid generation:  0.02514338493347168
local_in_edges_tensor generation:  0.029393672943115234
mini_batch_src_global generation:  0.03179621696472168
r_  generation:  0.39638328552246094
local_output_nid generation:  0.0328211784362793
local_in_edges_tensor generation:  0.02826690673828125
mini_batch_src_global generation:  0.042023420333862305
r_  generation:  0.40700531005859375
----------------------check_connections_block total spend ----------------------------- 1.2037320137023926
generate_one_block  0.4646761417388916
generate_one_block  0.4669928550720215
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13768815994262695  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.361538887023926
block generation total time  1.9380812644958496
average batch blocks generation time:  0.9690406322479248
block dataloader generation time/epoch 5.441494156519572
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10677337646484375  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.171175479888916  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10768985748291016  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1739211082458496  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07860398292541504 |0.01784515380859375 |0.004193544387817383 |0.0005301237106323242 |0.0023075342178344727 |0.0013647079467773438 |
----------------------------------------------------------pseudo_mini_loss sum 0.9920437335968018
Total (block generation + training)time/epoch 5.732056090037028
Training time/epoch 0.31002140045166016
Training time without block to device /epoch 0.27433109283447266
Training time without total dataloading part /epoch 0.015427112579345703
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 48.07it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.58it/s]100%|██████████| 4/4 [00:00<00:00, 15.77it/s]100%|██████████| 4/4 [00:00<00:00, 15.73it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.83it/s]100%|██████████| 4/4 [00:00<00:00, 19.00it/s]100%|██████████| 4/4 [00:00<00:00, 18.79it/s]
Run 00 | Epoch 00084 | Loss 0.9920 | Train 0.2784 | Val 0.2365 | Test 0.2172
Number of nodes during this epoch:  328615
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13909053802490234  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.010964632034301758
range selection method range initialization spend 0.012048959732055664
time for parepare:  0.01535940170288086
local_output_nid generation:  0.010961055755615234
local_in_edges_tensor generation:  0.012233972549438477
mini_batch_src_global generation:  0.008425712585449219
r_  generation:  0.1173250675201416
local_output_nid generation:  0.012170076370239258
local_in_edges_tensor generation:  0.005269765853881836
mini_batch_src_global generation:  0.010919332504272461
r_  generation:  0.12677383422851562
----------------------check_connections_block total spend ----------------------------- 0.36910510063171387
generate_one_block  0.12894988059997559
generate_one_block  0.13207769393920898
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.027652740478515625
gen group dst list time:  0.0054166316986083984
time for parepare:  0.01995706558227539
local_output_nid generation:  0.016242265701293945
local_in_edges_tensor generation:  0.029891014099121094
mini_batch_src_global generation:  0.03651738166809082
r_  generation:  0.39399218559265137
local_output_nid generation:  0.023108720779418945
local_in_edges_tensor generation:  0.021312475204467773
mini_batch_src_global generation:  0.04290962219238281
r_  generation:  0.414675235748291
----------------------check_connections_block total spend ----------------------------- 1.174957275390625
generate_one_block  0.5210344791412354
generate_one_block  0.5027599334716797
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01970839500427246
gen group dst list time:  0.012901544570922852
time for parepare:  0.019292116165161133
local_output_nid generation:  0.02433180809020996
local_in_edges_tensor generation:  0.041632652282714844
mini_batch_src_global generation:  0.03312492370605469
r_  generation:  0.38245511054992676
local_output_nid generation:  0.03165173530578613
local_in_edges_tensor generation:  0.030615806579589844
mini_batch_src_global generation:  0.03823280334472656
r_  generation:  0.3843855857849121
----------------------check_connections_block total spend ----------------------------- 1.2036690711975098
generate_one_block  0.4604513645172119
generate_one_block  0.47547173500061035
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13909053802490234  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.3786263465881348
block generation total time  1.9597175121307373
average batch blocks generation time:  0.9798587560653687
block dataloader generation time/epoch 5.444446152762363
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10688114166259766  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.172835350036621  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10681629180908203  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1718535423278809  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08012926578521729 |0.013647794723510742 |0.004087090492248535 |0.0005153417587280273 |0.0020257234573364258 |0.0013706684112548828 |
----------------------------------------------------------pseudo_mini_loss sum 0.9884666204452515
Total (block generation + training)time/epoch 5.735076088654368
Training time/epoch 0.29557156562805176
Training time without block to device /epoch 0.2682759761810303
Training time without total dataloading part /epoch 0.01462697982788086
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.59it/s]100%|██████████| 4/4 [00:00<00:00, 26.09it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.67it/s]100%|██████████| 4/4 [00:00<00:00, 12.88it/s]100%|██████████| 4/4 [00:00<00:00, 12.67it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.33it/s]100%|██████████| 4/4 [00:00<00:00, 17.50it/s]100%|██████████| 4/4 [00:00<00:00, 17.45it/s]
Run 00 | Epoch 00085 | Loss 0.9885 | Train 0.2766 | Val 0.2325 | Test 0.2135
Number of nodes during this epoch:  328756
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13762474060058594  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.011237382888793945
range selection method range initialization spend 0.012072563171386719
time for parepare:  0.01484537124633789
local_output_nid generation:  0.011242866516113281
local_in_edges_tensor generation:  0.007602691650390625
mini_batch_src_global generation:  0.008205413818359375
r_  generation:  0.12044620513916016
local_output_nid generation:  0.01214909553527832
local_in_edges_tensor generation:  0.005343198776245117
mini_batch_src_global generation:  0.010984659194946289
r_  generation:  0.12478518486022949
----------------------check_connections_block total spend ----------------------------- 0.3652970790863037
generate_one_block  0.12972164154052734
generate_one_block  0.13481926918029785
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02647256851196289
gen group dst list time:  0.005387544631958008
time for parepare:  0.022808313369750977
local_output_nid generation:  0.016389846801757812
local_in_edges_tensor generation:  0.027220487594604492
mini_batch_src_global generation:  0.038092613220214844
r_  generation:  0.39850831031799316
local_output_nid generation:  0.024413585662841797
local_in_edges_tensor generation:  0.023740530014038086
mini_batch_src_global generation:  0.04346060752868652
r_  generation:  0.4317648410797119
----------------------check_connections_block total spend ----------------------------- 1.2104473114013672
generate_one_block  0.5109848976135254
generate_one_block  0.5100588798522949
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.023453712463378906
gen group dst list time:  0.011855602264404297
time for parepare:  0.020233154296875
local_output_nid generation:  0.02454066276550293
local_in_edges_tensor generation:  0.03849506378173828
mini_batch_src_global generation:  0.03283548355102539
r_  generation:  0.3803138732910156
local_output_nid generation:  0.030940771102905273
local_in_edges_tensor generation:  0.029050111770629883
mini_batch_src_global generation:  0.037481069564819336
r_  generation:  0.3860325813293457
----------------------check_connections_block total spend ----------------------------- 1.1539182662963867
generate_one_block  0.45705747604370117
generate_one_block  0.4763517379760742
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13762474060058594  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.364365577697754
block generation total time  1.9544529914855957
average batch blocks generation time:  0.9772264957427979
block dataloader generation time/epoch 5.4467173489657315
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10677862167358398  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1712675094604492  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1077260971069336  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1745381355285645  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08410263061523438 |0.01657247543334961 |0.004267573356628418 |0.0005319118499755859 |0.0019488334655761719 |0.0013356208801269531 |
----------------------------------------------------------pseudo_mini_loss sum 0.9894187450408936
Total (block generation + training)time/epoch 5.73769972231481
Training time/epoch 0.3176088333129883
Training time without block to device /epoch 0.28446388244628906
Training time without total dataloading part /epoch 0.014832258224487305
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 58.72it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.08it/s]100%|██████████| 4/4 [00:00<00:00, 15.50it/s]100%|██████████| 4/4 [00:00<00:00, 15.42it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.29it/s]100%|██████████| 4/4 [00:00<00:00, 17.72it/s]100%|██████████| 4/4 [00:00<00:00, 17.63it/s]
Run 00 | Epoch 00086 | Loss 0.9894 | Train 0.2743 | Val 0.2275 | Test 0.2090
Number of nodes during this epoch:  328629
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1391291618347168  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.011026382446289062
range selection method range initialization spend 0.011969566345214844
time for parepare:  0.015003204345703125
local_output_nid generation:  0.01081085205078125
local_in_edges_tensor generation:  0.011056661605834961
mini_batch_src_global generation:  0.008192062377929688
r_  generation:  0.11719322204589844
local_output_nid generation:  0.011911392211914062
local_in_edges_tensor generation:  0.0052947998046875
mini_batch_src_global generation:  0.010712862014770508
r_  generation:  0.127333402633667
----------------------check_connections_block total spend ----------------------------- 0.3662850856781006
generate_one_block  0.12952375411987305
generate_one_block  0.13188743591308594
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.025097131729125977
gen group dst list time:  0.005421876907348633
time for parepare:  0.01976919174194336
local_output_nid generation:  0.016157865524291992
local_in_edges_tensor generation:  0.030098915100097656
mini_batch_src_global generation:  0.03452754020690918
r_  generation:  0.3879570960998535
local_output_nid generation:  0.02361607551574707
local_in_edges_tensor generation:  0.0243685245513916
mini_batch_src_global generation:  0.04319119453430176
r_  generation:  0.4010918140411377
----------------------check_connections_block total spend ----------------------------- 1.1518230438232422
generate_one_block  0.49263882637023926
generate_one_block  0.4997711181640625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.021863937377929688
gen group dst list time:  0.010956764221191406
time for parepare:  0.018965959548950195
local_output_nid generation:  0.024876117706298828
local_in_edges_tensor generation:  0.033469438552856445
mini_batch_src_global generation:  0.031002521514892578
r_  generation:  0.373307466506958
local_output_nid generation:  0.03119063377380371
local_in_edges_tensor generation:  0.02803969383239746
mini_batch_src_global generation:  0.03763246536254883
r_  generation:  0.3789403438568115
----------------------check_connections_block total spend ----------------------------- 1.1205735206604004
generate_one_block  0.44987988471984863
generate_one_block  0.4517793655395508
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1391291618347168  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.2723965644836426
block generation total time  1.8940691947937012
average batch blocks generation time:  0.9470345973968506
block dataloader generation time/epoch 5.446872130418435
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10682535171508789  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1734566688537598  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10676765441894531  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1668782234191895  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07746565341949463 |0.011538028717041016 |0.003926873207092285 |0.000519871711730957 |0.0018900632858276367 |0.0013294219970703125 |
----------------------------------------------------------pseudo_mini_loss sum 0.9849182367324829
Total (block generation + training)time/epoch 5.7378716468811035
Training time/epoch 0.29221677780151367
Training time without block to device /epoch 0.26914072036743164
Training time without total dataloading part /epoch 0.01400303840637207
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 62.84it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.90it/s]100%|██████████| 4/4 [00:00<00:00, 15.68it/s]100%|██████████| 4/4 [00:00<00:00, 15.53it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.31it/s]100%|██████████| 4/4 [00:00<00:00, 17.62it/s]100%|██████████| 4/4 [00:00<00:00, 17.56it/s]
Run 00 | Epoch 00087 | Loss 0.9849 | Train 0.2728 | Val 0.2247 | Test 0.2057
Number of nodes during this epoch:  328579
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1376323699951172  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01828312873840332
range selection method range initialization spend 0.012999773025512695
time for parepare:  0.01715826988220215
local_output_nid generation:  0.010734796524047852
local_in_edges_tensor generation:  0.011158466339111328
mini_batch_src_global generation:  0.008211851119995117
r_  generation:  0.12424588203430176
local_output_nid generation:  0.012258052825927734
local_in_edges_tensor generation:  0.005572795867919922
mini_batch_src_global generation:  0.010570526123046875
r_  generation:  0.12613248825073242
----------------------check_connections_block total spend ----------------------------- 0.3758373260498047
generate_one_block  0.13115620613098145
generate_one_block  0.13238096237182617
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028409957885742188
gen group dst list time:  0.005403041839599609
time for parepare:  0.019733428955078125
local_output_nid generation:  0.01629328727722168
local_in_edges_tensor generation:  0.037149667739868164
mini_batch_src_global generation:  0.034659624099731445
r_  generation:  0.38733983039855957
local_output_nid generation:  0.02286386489868164
local_in_edges_tensor generation:  0.026117801666259766
mini_batch_src_global generation:  0.04321908950805664
r_  generation:  0.4008297920227051
----------------------check_connections_block total spend ----------------------------- 1.1614561080932617
generate_one_block  0.4854423999786377
generate_one_block  0.4871788024902344
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.018710851669311523
gen group dst list time:  0.010837078094482422
time for parepare:  0.019011974334716797
local_output_nid generation:  0.024487733840942383
local_in_edges_tensor generation:  0.03436732292175293
mini_batch_src_global generation:  0.030601024627685547
r_  generation:  0.37193918228149414
local_output_nid generation:  0.031122684478759766
local_in_edges_tensor generation:  0.027693510055541992
mini_batch_src_global generation:  0.03723454475402832
r_  generation:  0.3846700191497803
----------------------check_connections_block total spend ----------------------------- 1.1250526905059814
generate_one_block  0.455049991607666
generate_one_block  0.45115160942077637
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1376323699951172  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.286508798599243
block generation total time  1.8788228034973145
average batch blocks generation time:  0.9394114017486572
block dataloader generation time/epoch 5.447296616397327
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10679960250854492  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1722230911254883  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10769987106323242  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1735563278198242  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08021700382232666 |0.011148691177368164 |0.004165768623352051 |0.000552058219909668 |0.0021060705184936523 |0.0013866424560546875 |
----------------------------------------------------------pseudo_mini_loss sum 0.9815912842750549
Total (block generation + training)time/epoch 5.738308643992943
Training time/epoch 0.2918262481689453
Training time without block to device /epoch 0.269528865814209
Training time without total dataloading part /epoch 0.01503443717956543
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.86it/s]100%|██████████| 4/4 [00:00<00:00, 29.12it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.42it/s]100%|██████████| 4/4 [00:00<00:00, 12.50it/s]100%|██████████| 4/4 [00:00<00:00, 12.31it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.91it/s]100%|██████████| 4/4 [00:00<00:00, 17.29it/s]100%|██████████| 4/4 [00:00<00:00, 17.21it/s]
Run 00 | Epoch 00088 | Loss 0.9816 | Train 0.2716 | Val 0.2216 | Test 0.2027
Number of nodes during this epoch:  328612
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1390671730041504  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.012660026550292969
range selection method range initialization spend 0.012192487716674805
time for parepare:  0.01567864418029785
local_output_nid generation:  0.01082158088684082
local_in_edges_tensor generation:  0.008014678955078125
mini_batch_src_global generation:  0.008089303970336914
r_  generation:  0.12169027328491211
local_output_nid generation:  0.011893272399902344
local_in_edges_tensor generation:  0.0054781436920166016
mini_batch_src_global generation:  0.01113581657409668
r_  generation:  0.1334083080291748
----------------------check_connections_block total spend ----------------------------- 0.3775038719177246
generate_one_block  0.12941670417785645
generate_one_block  0.13364267349243164
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0317838191986084
gen group dst list time:  0.005383014678955078
time for parepare:  0.019913673400878906
local_output_nid generation:  0.016484737396240234
local_in_edges_tensor generation:  0.03674721717834473
mini_batch_src_global generation:  0.03610539436340332
r_  generation:  0.39574551582336426
local_output_nid generation:  0.022925376892089844
local_in_edges_tensor generation:  0.02666306495666504
mini_batch_src_global generation:  0.042667388916015625
r_  generation:  0.39866018295288086
----------------------check_connections_block total spend ----------------------------- 1.1670949459075928
generate_one_block  0.4843297004699707
generate_one_block  0.48781704902648926
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.019623756408691406
gen group dst list time:  0.010784387588500977
time for parepare:  0.019162654876708984
local_output_nid generation:  0.024068117141723633
local_in_edges_tensor generation:  0.03326916694641113
mini_batch_src_global generation:  0.03019547462463379
r_  generation:  0.3745448589324951
local_output_nid generation:  0.03049302101135254
local_in_edges_tensor generation:  0.026826143264770508
mini_batch_src_global generation:  0.03766345977783203
r_  generation:  0.3860907554626465
----------------------check_connections_block total spend ----------------------------- 1.1250410079956055
generate_one_block  0.457073450088501
generate_one_block  0.45386672019958496
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1390671730041504  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.2921359539031982
block generation total time  1.883086919784546
average batch blocks generation time:  0.941543459892273
block dataloader generation time/epoch 5.447820782661438
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10687065124511719  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1721882820129395  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1067495346069336  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1714458465576172  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07605671882629395 |0.01071178913116455 |0.004101276397705078 |0.0005230903625488281 |0.0020647048950195312 |0.0013780593872070312 |
----------------------------------------------------------pseudo_mini_loss sum 0.982636570930481
Total (block generation + training)time/epoch 5.738817474246025
Training time/epoch 0.2896077632904053
Training time without block to device /epoch 0.26818418502807617
Training time without total dataloading part /epoch 0.014756202697753906
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 59.71it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.21it/s]100%|██████████| 4/4 [00:00<00:00, 15.39it/s]100%|██████████| 4/4 [00:00<00:00, 15.35it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.44it/s]100%|██████████| 4/4 [00:00<00:00, 17.62it/s]100%|██████████| 4/4 [00:00<00:00, 17.57it/s]
Run 00 | Epoch 00089 | Loss 0.9826 | Train 0.2709 | Val 0.2199 | Test 0.2014
Number of nodes during this epoch:  328618
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1376023292541504  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01168203353881836
range selection method range initialization spend 0.01175236701965332
time for parepare:  0.015334606170654297
local_output_nid generation:  0.010839462280273438
local_in_edges_tensor generation:  0.007295370101928711
mini_batch_src_global generation:  0.008117437362670898
r_  generation:  0.11694908142089844
local_output_nid generation:  0.011927127838134766
local_in_edges_tensor generation:  0.005743980407714844
mini_batch_src_global generation:  0.010695219039916992
r_  generation:  0.12648701667785645
----------------------check_connections_block total spend ----------------------------- 0.36345672607421875
generate_one_block  0.13021564483642578
generate_one_block  0.13156723976135254
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02578449249267578
gen group dst list time:  0.005438089370727539
time for parepare:  0.01982283592224121
local_output_nid generation:  0.016350269317626953
local_in_edges_tensor generation:  0.02419257164001465
mini_batch_src_global generation:  0.03491973876953125
r_  generation:  0.38669729232788086
local_output_nid generation:  0.023138999938964844
local_in_edges_tensor generation:  0.02120041847229004
mini_batch_src_global generation:  0.043134450912475586
r_  generation:  0.4060356616973877
----------------------check_connections_block total spend ----------------------------- 1.151576042175293
generate_one_block  0.4994781017303467
generate_one_block  0.49954700469970703
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02399134635925293
gen group dst list time:  0.011014223098754883
time for parepare:  0.019021987915039062
local_output_nid generation:  0.024896860122680664
local_in_edges_tensor generation:  0.03551220893859863
mini_batch_src_global generation:  0.030543804168701172
r_  generation:  0.38297438621520996
local_output_nid generation:  0.030256271362304688
local_in_edges_tensor generation:  0.03285789489746094
mini_batch_src_global generation:  0.03812217712402344
r_  generation:  0.4033515453338623
----------------------check_connections_block total spend ----------------------------- 1.1671910285949707
generate_one_block  0.45086002349853516
generate_one_block  0.46021509170532227
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1376023292541504  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.3187670707702637
block generation total time  1.9101002216339111
average batch blocks generation time:  0.9550501108169556
block dataloader generation time/epoch 5.448621258323575
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10676097869873047  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.172126293182373  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10767984390258789  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1701202392578125  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07986986637115479 |0.01587808132171631 |0.004021167755126953 |0.0005125999450683594 |0.002047419548034668 |0.0013496875762939453 |
----------------------------------------------------------pseudo_mini_loss sum 0.9790889024734497
Total (block generation + training)time/epoch 5.73970193038752
Training time/epoch 0.2976498603820801
Training time without block to device /epoch 0.26589369773864746
Training time without total dataloading part /epoch 0.014512062072753906
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.17it/s]100%|██████████| 4/4 [00:00<00:00, 30.03it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.59it/s]100%|██████████| 4/4 [00:00<00:00, 12.58it/s]100%|██████████| 4/4 [00:00<00:00, 12.41it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.37it/s]100%|██████████| 4/4 [00:00<00:00, 17.80it/s]100%|██████████| 4/4 [00:00<00:00, 17.71it/s]
Run 00 | Epoch 00090 | Loss 0.9791 | Train 0.2700 | Val 0.2180 | Test 0.1993
Number of nodes during this epoch:  328540
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1390838623046875  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.010663509368896484
range selection method range initialization spend 0.011828184127807617
time for parepare:  0.01613593101501465
local_output_nid generation:  0.010902881622314453
local_in_edges_tensor generation:  0.008399724960327148
mini_batch_src_global generation:  0.00864720344543457
r_  generation:  0.11869215965270996
local_output_nid generation:  0.012303590774536133
local_in_edges_tensor generation:  0.00568842887878418
mini_batch_src_global generation:  0.010561704635620117
r_  generation:  0.12724733352661133
----------------------check_connections_block total spend ----------------------------- 0.3681519031524658
generate_one_block  0.13292193412780762
generate_one_block  0.14099454879760742
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02954721450805664
gen group dst list time:  0.005361795425415039
time for parepare:  0.020148754119873047
local_output_nid generation:  0.015825986862182617
local_in_edges_tensor generation:  0.02790069580078125
mini_batch_src_global generation:  0.03432941436767578
r_  generation:  0.39059925079345703
local_output_nid generation:  0.023121356964111328
local_in_edges_tensor generation:  0.025888919830322266
mini_batch_src_global generation:  0.06273102760314941
r_  generation:  0.4095587730407715
----------------------check_connections_block total spend ----------------------------- 1.189424753189087
generate_one_block  0.4966130256652832
generate_one_block  0.49179649353027344
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.018955469131469727
gen group dst list time:  0.011093616485595703
time for parepare:  0.019436120986938477
local_output_nid generation:  0.023912906646728516
local_in_edges_tensor generation:  0.031002283096313477
mini_batch_src_global generation:  0.030365467071533203
r_  generation:  0.37331533432006836
local_output_nid generation:  0.030623435974121094
local_in_edges_tensor generation:  0.027811050415039062
mini_batch_src_global generation:  0.037192583084106445
r_  generation:  0.3789513111114502
----------------------check_connections_block total spend ----------------------------- 1.1174049377441406
generate_one_block  0.44783782958984375
generate_one_block  0.4500856399536133
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1390838623046875  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.3068296909332275
block generation total time  1.8863329887390137
average batch blocks generation time:  0.9431664943695068
block dataloader generation time/epoch 5.449118660717476
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10688161849975586  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1722946166992188  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10679006576538086  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1718978881835938  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07744026184082031 |0.01051795482635498 |0.003945112228393555 |0.0005209445953369141 |0.0021458864212036133 |0.0013318061828613281 |
----------------------------------------------------------pseudo_mini_loss sum 0.9762381315231323
Total (block generation + training)time/epoch 5.74009021607841
Training time/epoch 0.2820308208465576
Training time without block to device /epoch 0.26099491119384766
Training time without total dataloading part /epoch 0.014555692672729492
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 65.04it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.57it/s]100%|██████████| 4/4 [00:00<00:00, 15.77it/s]100%|██████████| 4/4 [00:00<00:00, 15.72it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.62it/s]100%|██████████| 4/4 [00:00<00:00, 19.87it/s]
Run 00 | Epoch 00091 | Loss 0.9762 | Train 0.2686 | Val 0.2148 | Test 0.1960
Number of nodes during this epoch:  328658
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1375741958618164  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.010635137557983398
range selection method range initialization spend 0.011754035949707031
time for parepare:  0.015625476837158203
local_output_nid generation:  0.011146783828735352
local_in_edges_tensor generation:  0.007454872131347656
mini_batch_src_global generation:  0.008543252944946289
r_  generation:  0.11711454391479492
local_output_nid generation:  0.012097835540771484
local_in_edges_tensor generation:  0.0053348541259765625
mini_batch_src_global generation:  0.010634899139404297
r_  generation:  0.1293790340423584
----------------------check_connections_block total spend ----------------------------- 0.36757850646972656
generate_one_block  0.13436102867126465
generate_one_block  0.13547158241271973
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02610635757446289
gen group dst list time:  0.0054492950439453125
time for parepare:  0.020503997802734375
local_output_nid generation:  0.016469478607177734
local_in_edges_tensor generation:  0.025931835174560547
mini_batch_src_global generation:  0.035666465759277344
r_  generation:  0.40073728561401367
local_output_nid generation:  0.023464441299438477
local_in_edges_tensor generation:  0.028970003128051758
mini_batch_src_global generation:  0.048819541931152344
r_  generation:  0.4296700954437256
----------------------check_connections_block total spend ----------------------------- 1.2154698371887207
generate_one_block  0.5084586143493652
generate_one_block  0.5007045269012451
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.020694255828857422
gen group dst list time:  0.01179647445678711
time for parepare:  0.019407272338867188
local_output_nid generation:  0.024144887924194336
local_in_edges_tensor generation:  0.03871345520019531
mini_batch_src_global generation:  0.032595157623291016
r_  generation:  0.3738410472869873
local_output_nid generation:  0.030835390090942383
local_in_edges_tensor generation:  0.031651973724365234
mini_batch_src_global generation:  0.03756880760192871
r_  generation:  0.3809659481048584
----------------------check_connections_block total spend ----------------------------- 1.1353352069854736
generate_one_block  0.4502108097076416
generate_one_block  0.4513223171234131
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1375741958618164  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.3508050441741943
block generation total time  1.910696268081665
average batch blocks generation time:  0.9553481340408325
block dataloader generation time/epoch 5.450382824403694
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10768318176269531  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1737675666809082  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1077280044555664  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.173929214477539  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07816886901855469 |0.012725472450256348 |0.0041141510009765625 |0.0005205869674682617 |0.0022531747817993164 |0.0013828277587890625 |
----------------------------------------------------------pseudo_mini_loss sum 0.977053165435791
Total (block generation + training)time/epoch 5.741363582840885
Training time/epoch 0.2915787696838379
Training time without block to device /epoch 0.2661278247833252
Training time without total dataloading part /epoch 0.015158653259277344
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 56.32it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.94it/s]100%|██████████| 4/4 [00:00<00:00, 15.38it/s]100%|██████████| 4/4 [00:00<00:00, 15.30it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.32it/s]100%|██████████| 4/4 [00:00<00:00, 17.78it/s]100%|██████████| 4/4 [00:00<00:00, 17.69it/s]
Run 00 | Epoch 00092 | Loss 0.9771 | Train 0.2667 | Val 0.2120 | Test 0.1920
Number of nodes during this epoch:  328702
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13906335830688477  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.009936332702636719
range selection method range initialization spend 0.01217198371887207
time for parepare:  0.01790022850036621
local_output_nid generation:  0.01096200942993164
local_in_edges_tensor generation:  0.007893800735473633
mini_batch_src_global generation:  0.008300304412841797
r_  generation:  0.11664843559265137
local_output_nid generation:  0.011930465698242188
local_in_edges_tensor generation:  0.005296468734741211
mini_batch_src_global generation:  0.010748863220214844
r_  generation:  0.12650108337402344
----------------------check_connections_block total spend ----------------------------- 0.3668665885925293
generate_one_block  0.13018465042114258
generate_one_block  0.13291382789611816
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.026686668395996094
gen group dst list time:  0.005445718765258789
time for parepare:  0.019788742065429688
local_output_nid generation:  0.016327857971191406
local_in_edges_tensor generation:  0.02420353889465332
mini_batch_src_global generation:  0.038146018981933594
r_  generation:  0.38747072219848633
local_output_nid generation:  0.023079395294189453
local_in_edges_tensor generation:  0.026361942291259766
mini_batch_src_global generation:  0.043332576751708984
r_  generation:  0.41102004051208496
----------------------check_connections_block total spend ----------------------------- 1.1656906604766846
generate_one_block  0.5049383640289307
generate_one_block  0.4951643943786621
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025170087814331055
gen group dst list time:  0.012591123580932617
time for parepare:  0.020192623138427734
local_output_nid generation:  0.023973703384399414
local_in_edges_tensor generation:  0.0399932861328125
mini_batch_src_global generation:  0.03124833106994629
r_  generation:  0.3712446689605713
local_output_nid generation:  0.031179428100585938
local_in_edges_tensor generation:  0.031157255172729492
mini_batch_src_global generation:  0.03748631477355957
r_  generation:  0.37986040115356445
----------------------check_connections_block total spend ----------------------------- 1.1289527416229248
generate_one_block  0.4453463554382324
generate_one_block  0.4451014995574951
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13906335830688477  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.2946434020996094
block generation total time  1.8905506134033203
average batch blocks generation time:  0.9452753067016602
block dataloader generation time/epoch 5.450705973874955
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1068115234375  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1727452278137207  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10682535171508789  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1713838577270508  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07909095287322998 |0.014583826065063477 |0.003988981246948242 |0.0005189180374145508 |0.0030645132064819336 |0.0013129711151123047 |
----------------------------------------------------------pseudo_mini_loss sum 0.9719300270080566
Total (block generation + training)time/epoch 5.741832097371419
Training time/epoch 0.30304598808288574
Training time without block to device /epoch 0.2738783359527588
Training time without total dataloading part /epoch 0.016457796096801758
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 53.22it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.98it/s]100%|██████████| 4/4 [00:00<00:00, 15.50it/s]100%|██████████| 4/4 [00:00<00:00, 15.40it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.33it/s]100%|██████████| 4/4 [00:00<00:00, 17.68it/s]100%|██████████| 4/4 [00:00<00:00, 17.61it/s]
Run 00 | Epoch 00093 | Loss 0.9719 | Train 0.2651 | Val 0.2088 | Test 0.1887
Number of nodes during this epoch:  328629
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13771724700927734  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01227879524230957
range selection method range initialization spend 0.012309789657592773
time for parepare:  0.016976356506347656
local_output_nid generation:  0.011115550994873047
local_in_edges_tensor generation:  0.01063227653503418
mini_batch_src_global generation:  0.008360862731933594
r_  generation:  0.11626124382019043
local_output_nid generation:  0.012110233306884766
local_in_edges_tensor generation:  0.005468606948852539
mini_batch_src_global generation:  0.010712146759033203
r_  generation:  0.12746286392211914
----------------------check_connections_block total spend ----------------------------- 0.36848020553588867
generate_one_block  0.13086390495300293
generate_one_block  0.13231801986694336
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02489757537841797
gen group dst list time:  0.0054018497467041016
time for parepare:  0.020908832550048828
local_output_nid generation:  0.016747713088989258
local_in_edges_tensor generation:  0.0318145751953125
mini_batch_src_global generation:  0.034538984298706055
r_  generation:  0.39411473274230957
local_output_nid generation:  0.02397012710571289
local_in_edges_tensor generation:  0.022564411163330078
mini_batch_src_global generation:  0.04244637489318848
r_  generation:  0.4039304256439209
----------------------check_connections_block total spend ----------------------------- 1.1626155376434326
generate_one_block  0.4863169193267822
generate_one_block  0.4887123107910156
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.019159793853759766
gen group dst list time:  0.011022806167602539
time for parepare:  0.02133655548095703
local_output_nid generation:  0.024849653244018555
local_in_edges_tensor generation:  0.029786109924316406
mini_batch_src_global generation:  0.03051161766052246
r_  generation:  0.3754000663757324
local_output_nid generation:  0.03253364562988281
local_in_edges_tensor generation:  0.027598857879638672
mini_batch_src_global generation:  0.037488460540771484
r_  generation:  0.3859989643096924
----------------------check_connections_block total spend ----------------------------- 1.1280803680419922
generate_one_block  0.45176267623901367
generate_one_block  0.4891791343688965
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13771724700927734  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.290695905685425
block generation total time  1.915971040725708
average batch blocks generation time:  0.957985520362854
block dataloader generation time/epoch 5.451244458030252
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1068110466003418  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1724214553833008  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10771846771240234  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1737327575683594  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07688724994659424 |0.01822042465209961 |0.003896951675415039 |0.0005289316177368164 |0.002785205841064453 |0.0012767314910888672 |
----------------------------------------------------------pseudo_mini_loss sum 0.9700838327407837
Total (block generation + training)time/epoch 5.742439135383157
Training time/epoch 0.29686689376831055
Training time without block to device /epoch 0.26042604446411133
Training time without total dataloading part /epoch 0.015698909759521484
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 41.08it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.78it/s]100%|██████████| 4/4 [00:00<00:00, 15.28it/s]100%|██████████| 4/4 [00:00<00:00, 15.19it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.08it/s]100%|██████████| 4/4 [00:00<00:00, 17.30it/s]100%|██████████| 4/4 [00:00<00:00, 17.25it/s]
Run 00 | Epoch 00094 | Loss 0.9701 | Train 0.2645 | Val 0.2071 | Test 0.1868
Number of nodes during this epoch:  328695
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1390671730041504  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.010831594467163086
range selection method range initialization spend 0.011929512023925781
time for parepare:  0.01671910285949707
local_output_nid generation:  0.01099085807800293
local_in_edges_tensor generation:  0.009332656860351562
mini_batch_src_global generation:  0.0084686279296875
r_  generation:  0.1174006462097168
local_output_nid generation:  0.012331247329711914
local_in_edges_tensor generation:  0.00543665885925293
mini_batch_src_global generation:  0.011107683181762695
r_  generation:  0.1263597011566162
----------------------check_connections_block total spend ----------------------------- 0.36748337745666504
generate_one_block  0.12974166870117188
generate_one_block  0.13200974464416504
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028681039810180664
gen group dst list time:  0.005387067794799805
time for parepare:  0.01982283592224121
local_output_nid generation:  0.01597738265991211
local_in_edges_tensor generation:  0.028867006301879883
mini_batch_src_global generation:  0.03499126434326172
r_  generation:  0.39110779762268066
local_output_nid generation:  0.02279043197631836
local_in_edges_tensor generation:  0.026551246643066406
mini_batch_src_global generation:  0.04250836372375488
r_  generation:  0.4068024158477783
----------------------check_connections_block total spend ----------------------------- 1.1607275009155273
generate_one_block  0.5018825531005859
generate_one_block  0.4902019500732422
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01799464225769043
gen group dst list time:  0.011062383651733398
time for parepare:  0.019190073013305664
local_output_nid generation:  0.024152278900146484
local_in_edges_tensor generation:  0.028969287872314453
mini_batch_src_global generation:  0.031145095825195312
r_  generation:  0.3730349540710449
local_output_nid generation:  0.03184676170349121
local_in_edges_tensor generation:  0.02630615234375
mini_batch_src_global generation:  0.03754281997680664
r_  generation:  0.3826134204864502
----------------------check_connections_block total spend ----------------------------- 1.118767261505127
generate_one_block  0.4579901695251465
generate_one_block  0.4498467445373535
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1390671730041504  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.2794947624206543
block generation total time  1.8999214172363281
average batch blocks generation time:  0.9499607086181641
block dataloader generation time/epoch 5.451386753902879
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10686302185058594  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.173346996307373  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10675382614135742  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1710686683654785  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08276665210723877 |0.011034250259399414 |0.003986716270446777 |0.0005260705947875977 |0.0021219253540039062 |0.00131988525390625 |
----------------------------------------------------------pseudo_mini_loss sum 0.9689239263534546
Total (block generation + training)time/epoch 5.742659599282021
Training time/epoch 0.2978081703186035
Training time without block to device /epoch 0.2757396697998047
Training time without total dataloading part /epoch 0.014589309692382812
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.28it/s]100%|██████████| 4/4 [00:00<00:00, 28.14it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.41it/s]100%|██████████| 4/4 [00:00<00:00, 11.84it/s]100%|██████████| 4/4 [00:00<00:00, 11.76it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.28it/s]100%|██████████| 4/4 [00:00<00:00, 17.28it/s]100%|██████████| 4/4 [00:00<00:00, 17.26it/s]
Run 00 | Epoch 00095 | Loss 0.9689 | Train 0.2645 | Val 0.2056 | Test 0.1855
Number of nodes during this epoch:  328603
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13754749298095703  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.009954452514648438
range selection method range initialization spend 0.011754512786865234
time for parepare:  0.01529383659362793
local_output_nid generation:  0.010750055313110352
local_in_edges_tensor generation:  0.007345676422119141
mini_batch_src_global generation:  0.008408069610595703
r_  generation:  0.11758089065551758
local_output_nid generation:  0.011837244033813477
local_in_edges_tensor generation:  0.005251169204711914
mini_batch_src_global generation:  0.010963678359985352
r_  generation:  0.12460517883300781
----------------------check_connections_block total spend ----------------------------- 0.36161231994628906
generate_one_block  0.13100290298461914
generate_one_block  0.1337144374847412
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02356863021850586
gen group dst list time:  0.005310773849487305
time for parepare:  0.01994776725769043
local_output_nid generation:  0.01523447036743164
local_in_edges_tensor generation:  0.02622222900390625
mini_batch_src_global generation:  0.03461503982543945
r_  generation:  0.3854389190673828
local_output_nid generation:  0.022509336471557617
local_in_edges_tensor generation:  0.022910356521606445
mini_batch_src_global generation:  0.04300045967102051
r_  generation:  0.40270495414733887
----------------------check_connections_block total spend ----------------------------- 1.1436378955841064
generate_one_block  0.4865849018096924
generate_one_block  0.48684072494506836
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.016538143157958984
gen group dst list time:  0.010935544967651367
time for parepare:  0.018938302993774414
local_output_nid generation:  0.023653745651245117
local_in_edges_tensor generation:  0.02895522117614746
mini_batch_src_global generation:  0.03069901466369629
r_  generation:  0.37109971046447754
local_output_nid generation:  0.030263423919677734
local_in_edges_tensor generation:  0.0257720947265625
mini_batch_src_global generation:  0.03746318817138672
r_  generation:  0.3791804313659668
----------------------check_connections_block total spend ----------------------------- 1.1083626747131348
generate_one_block  0.4432089328765869
generate_one_block  0.4528007507324219
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13754749298095703  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.252000570297241
block generation total time  1.8694353103637695
average batch blocks generation time:  0.9347176551818848
block dataloader generation time/epoch 5.450512400988875
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10681962966918945  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1717066764831543  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10771417617797852  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1744322776794434  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0761258602142334 |0.010852336883544922 |0.0038129091262817383 |0.0005161762237548828 |0.002415776252746582 |0.0013034343719482422 |
----------------------------------------------------------pseudo_mini_loss sum 0.9674533605575562
Total (block generation + training)time/epoch 5.741721325907214
Training time/epoch 0.28562331199645996
Training time without block to device /epoch 0.2639186382293701
Training time without total dataloading part /epoch 0.014793157577514648
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 67.13it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.09it/s]100%|██████████| 4/4 [00:00<00:00, 15.33it/s]100%|██████████| 4/4 [00:00<00:00, 15.28it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.16it/s]100%|██████████| 4/4 [00:00<00:00, 17.40it/s]100%|██████████| 4/4 [00:00<00:00, 17.35it/s]
Run 00 | Epoch 00096 | Loss 0.9675 | Train 0.2641 | Val 0.2036 | Test 0.1836
Number of nodes during this epoch:  328677
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13911008834838867  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.013166666030883789
range selection method range initialization spend 0.011949300765991211
time for parepare:  0.015318632125854492
local_output_nid generation:  0.010944128036499023
local_in_edges_tensor generation:  0.007624626159667969
mini_batch_src_global generation:  0.008161544799804688
r_  generation:  0.1167752742767334
local_output_nid generation:  0.011997222900390625
local_in_edges_tensor generation:  0.005550861358642578
mini_batch_src_global generation:  0.010718345642089844
r_  generation:  0.12569713592529297
----------------------check_connections_block total spend ----------------------------- 0.3628103733062744
generate_one_block  0.13123726844787598
generate_one_block  0.13428521156311035
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.025177478790283203
gen group dst list time:  0.005410432815551758
time for parepare:  0.02008652687072754
local_output_nid generation:  0.015866756439208984
local_in_edges_tensor generation:  0.025559186935424805
mini_batch_src_global generation:  0.034523725509643555
r_  generation:  0.38499927520751953
local_output_nid generation:  0.023937463760375977
local_in_edges_tensor generation:  0.020917177200317383
mini_batch_src_global generation:  0.04333996772766113
r_  generation:  0.40356993675231934
----------------------check_connections_block total spend ----------------------------- 1.1449530124664307
generate_one_block  0.4889087677001953
generate_one_block  0.4923858642578125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.019993305206298828
gen group dst list time:  0.011075735092163086
time for parepare:  0.01970815658569336
local_output_nid generation:  0.024557113647460938
local_in_edges_tensor generation:  0.0420069694519043
mini_batch_src_global generation:  0.03131580352783203
r_  generation:  0.37889766693115234
local_output_nid generation:  0.031655073165893555
local_in_edges_tensor generation:  0.03388047218322754
mini_batch_src_global generation:  0.03870439529418945
r_  generation:  0.3822817802429199
----------------------check_connections_block total spend ----------------------------- 1.1475348472595215
generate_one_block  0.45609617233276367
generate_one_block  0.4537513256072998
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13911008834838867  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.292487859725952
block generation total time  1.8911421298980713
average batch blocks generation time:  0.9455710649490356
block dataloader generation time/epoch 5.4505073075944726
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10682916641235352  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1717677116394043  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10683298110961914  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1714367866516113  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07895040512084961 |0.015798330307006836 |0.0039708614349365234 |0.0005093812942504883 |0.0018987655639648438 |0.00128936767578125 |
----------------------------------------------------------pseudo_mini_loss sum 0.9645739793777466
Total (block generation + training)time/epoch 5.741856095465747
Training time/epoch 0.3033735752105713
Training time without block to device /epoch 0.2717769145965576
Training time without total dataloading part /epoch 0.014047384262084961
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.19it/s]100%|██████████| 4/4 [00:00<00:00, 27.72it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.50it/s]100%|██████████| 4/4 [00:00<00:00, 11.89it/s]100%|██████████| 4/4 [00:00<00:00, 11.82it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.09it/s]100%|██████████| 4/4 [00:00<00:00, 17.32it/s]100%|██████████| 4/4 [00:00<00:00, 17.27it/s]
Run 00 | Epoch 00097 | Loss 0.9646 | Train 0.2635 | Val 0.2020 | Test 0.1817
Number of nodes during this epoch:  328658
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13767337799072266  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.011468887329101562
range selection method range initialization spend 0.011613607406616211
time for parepare:  0.015584945678710938
local_output_nid generation:  0.010908126831054688
local_in_edges_tensor generation:  0.011654376983642578
mini_batch_src_global generation:  0.008176565170288086
r_  generation:  0.11775469779968262
local_output_nid generation:  0.012091398239135742
local_in_edges_tensor generation:  0.0052759647369384766
mini_batch_src_global generation:  0.010813474655151367
r_  generation:  0.1265244483947754
----------------------check_connections_block total spend ----------------------------- 0.36809229850769043
generate_one_block  0.12943315505981445
generate_one_block  0.13250279426574707
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.027439117431640625
gen group dst list time:  0.005350828170776367
time for parepare:  0.021569252014160156
local_output_nid generation:  0.015414953231811523
local_in_edges_tensor generation:  0.028951644897460938
mini_batch_src_global generation:  0.03499197959899902
r_  generation:  0.38448023796081543
local_output_nid generation:  0.02211594581604004
local_in_edges_tensor generation:  0.026610136032104492
mini_batch_src_global generation:  0.04476499557495117
r_  generation:  0.4009063243865967
----------------------check_connections_block total spend ----------------------------- 1.1508285999298096
generate_one_block  0.48368406295776367
generate_one_block  0.4874844551086426
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.017662525177001953
gen group dst list time:  0.010915994644165039
time for parepare:  0.019112825393676758
local_output_nid generation:  0.02332472801208496
local_in_edges_tensor generation:  0.030142784118652344
mini_batch_src_global generation:  0.03129148483276367
r_  generation:  0.3694422245025635
local_output_nid generation:  0.02977466583251953
local_in_edges_tensor generation:  0.0259091854095459
mini_batch_src_global generation:  0.03760862350463867
r_  generation:  0.3787214756011963
----------------------check_connections_block total spend ----------------------------- 1.1108546257019043
generate_one_block  0.4665353298187256
generate_one_block  0.46501970291137695
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13767337799072266  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.261683225631714
block generation total time  1.9027235507965088
average batch blocks generation time:  0.9513617753982544
block dataloader generation time/epoch 5.450425158725696
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10765838623046875  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.17256498336792  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10768270492553711  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1721148490905762  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07733786106109619 |0.010938167572021484 |0.003920078277587891 |0.0005279779434204102 |0.0021102428436279297 |0.0013232231140136719 |
----------------------------------------------------------pseudo_mini_loss sum 0.9609708786010742
Total (block generation + training)time/epoch 5.741799475101942
Training time/epoch 0.2935190200805664
Training time without block to device /epoch 0.27164268493652344
Training time without total dataloading part /epoch 0.014439821243286133
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.18it/s]100%|██████████| 4/4 [00:00<00:00, 31.06it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.41it/s]100%|██████████| 4/4 [00:00<00:00, 12.51it/s]100%|██████████| 4/4 [00:00<00:00, 12.32it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.01it/s]100%|██████████| 4/4 [00:00<00:00, 17.46it/s]100%|██████████| 4/4 [00:00<00:00, 17.37it/s]
Run 00 | Epoch 00098 | Loss 0.9610 | Train 0.2625 | Val 0.1995 | Test 0.1796
Number of nodes during this epoch:  328605
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13901329040527344  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.011042118072509766
range selection method range initialization spend 0.011882781982421875
time for parepare:  0.015467643737792969
local_output_nid generation:  0.01095724105834961
local_in_edges_tensor generation:  0.007295846939086914
mini_batch_src_global generation:  0.008158445358276367
r_  generation:  0.11824202537536621
local_output_nid generation:  0.012269020080566406
local_in_edges_tensor generation:  0.005302906036376953
mini_batch_src_global generation:  0.013842105865478516
r_  generation:  0.12769627571105957
----------------------check_connections_block total spend ----------------------------- 0.3699533939361572
generate_one_block  0.1314537525177002
generate_one_block  0.13484525680541992
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.025188684463500977
gen group dst list time:  0.006621122360229492
time for parepare:  0.021135568618774414
local_output_nid generation:  0.015813827514648438
local_in_edges_tensor generation:  0.02343583106994629
mini_batch_src_global generation:  0.034508705139160156
r_  generation:  0.3865363597869873
local_output_nid generation:  0.022316455841064453
local_in_edges_tensor generation:  0.020785093307495117
mini_batch_src_global generation:  0.0428318977355957
r_  generation:  0.4076712131500244
----------------------check_connections_block total spend ----------------------------- 1.146270751953125
generate_one_block  0.4859747886657715
generate_one_block  0.486560583114624
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.017998933792114258
gen group dst list time:  0.010997772216796875
time for parepare:  0.018907785415649414
local_output_nid generation:  0.02448296546936035
local_in_edges_tensor generation:  0.028688907623291016
mini_batch_src_global generation:  0.03058004379272461
r_  generation:  0.37998151779174805
local_output_nid generation:  0.030472755432128906
local_in_edges_tensor generation:  0.025990724563598633
mini_batch_src_global generation:  0.037392377853393555
r_  generation:  0.3760640621185303
----------------------check_connections_block total spend ----------------------------- 1.117527723312378
generate_one_block  0.44428491592407227
generate_one_block  0.4482560157775879
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.13901329040527344  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

connection checking time:  2.263798475265503
block generation total time  1.8650763034820557
average batch blocks generation time:  0.9325381517410278
block dataloader generation time/epoch 5.44979468981425
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.10687112808227539  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1722412109375  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 0.1067500114440918  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1639404296875 GB
    Memory Allocated: 1.1677212715148926  GigaBytes
Max Memory Allocated: 1.3960790634155273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07610690593719482 |0.010870218276977539 |0.0038253068923950195 |0.0005141496658325195 |0.0020421743392944336 |0.0012884140014648438 |
----------------------------------------------------------pseudo_mini_loss sum 0.9618264436721802
Total (block generation + training)time/epoch 5.741027940644158
Training time/epoch 0.2785933017730713
Training time without block to device /epoch 0.2568528652191162
Training time without total dataloading part /epoch 0.014051675796508789
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 65.44it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.25it/s]100%|██████████| 4/4 [00:00<00:00, 15.27it/s]100%|██████████| 4/4 [00:00<00:00, 15.25it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.21it/s]100%|██████████| 4/4 [00:00<00:00, 17.35it/s]100%|██████████| 4/4 [00:00<00:00, 17.31it/s]
Run 00 | Epoch 00099 | Loss 0.9618 | Train 0.2613 | Val 0.1973 | Test 0.1773
Number of nodes during this epoch:  328602
The number of model layers:  3
Run 01:
Highest Train: 46.24
Highest Valid: 52.05
  Final Train: 45.90
   Final Test: 51.76
The number of model layers:  3
All runs:
Highest Train: 46.24 ± nan
Highest Valid: 52.05 ± nan
  Final Train: 45.90 ± nan
   Final Test: 51.76 ± nan
