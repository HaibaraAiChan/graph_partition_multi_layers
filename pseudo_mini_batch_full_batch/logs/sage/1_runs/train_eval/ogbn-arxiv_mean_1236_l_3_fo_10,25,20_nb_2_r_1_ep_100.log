Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1647070034.5133529
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018257856369018555
range selection method range initialization spend 0.013700723648071289
time for parepare:  0.017316818237304688
local_output_nid generation:  0.010376691818237305
local_in_edges_tensor generation:  0.008348226547241211
mini_batch_src_global generation:  0.010425806045532227
r_  generation:  0.14351224899291992
local_output_nid generation:  0.011356592178344727
local_in_edges_tensor generation:  0.007505655288696289
mini_batch_src_global generation:  0.013593912124633789
r_  generation:  0.15385103225708008
----------------------check_connections_block total spend ----------------------------- 0.4350152015686035
generate_one_block  0.16942095756530762
generate_one_block  0.1688709259033203
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03411602973937988
gen group dst list time:  0.0070803165435791016
time for parepare:  0.019225120544433594
local_output_nid generation:  0.015874147415161133
local_in_edges_tensor generation:  0.03711342811584473
mini_batch_src_global generation:  0.03995347023010254
r_  generation:  0.41664576530456543
local_output_nid generation:  0.02362799644470215
local_in_edges_tensor generation:  0.0399324893951416
mini_batch_src_global generation:  0.04622912406921387
r_  generation:  0.43340015411376953
----------------------check_connections_block total spend ----------------------------- 1.2592310905456543
generate_one_block  0.5373630523681641
generate_one_block  0.547400712966919
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02662491798400879
gen group dst list time:  0.0117950439453125
time for parepare:  0.01875925064086914
local_output_nid generation:  0.021459579467773438
local_in_edges_tensor generation:  0.030453920364379883
mini_batch_src_global generation:  0.030078411102294922
r_  generation:  0.36642909049987793
local_output_nid generation:  0.030892372131347656
local_in_edges_tensor generation:  0.037303924560546875
mini_batch_src_global generation:  0.039093732833862305
r_  generation:  0.3785521984100342
----------------------check_connections_block total spend ----------------------------- 1.115412712097168
generate_one_block  0.47446584701538086
generate_one_block  0.45409464836120605
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  2.3746438026428223
block generation total time  2.01332426071167
average batch blocks generation time:  1.006662130355835
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1815185546875 GB
    Memory Allocated: 0.10076570510864258  GigaBytes
Max Memory Allocated: 0.10076570510864258  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 1.225480079650879  GigaBytes
Max Memory Allocated: 1.3298349380493164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3787841796875 GB
    Memory Allocated: 0.10723543167114258  GigaBytes
Max Memory Allocated: 1.4641594886779785  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3787841796875 GB
    Memory Allocated: 1.2246317863464355  GigaBytes
Max Memory Allocated: 1.4641594886779785  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04757356643676758 |0.1505582332611084 |0.3918260335922241 |0.0006093978881835938 |0.027241945266723633 |0.001966238021850586 |
----------------------------------------------------------pseudo_mini_loss sum 6.062517166137695
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.45it/s]100%|██████████| 4/4 [00:00<00:00, 28.08it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.42it/s]100%|██████████| 4/4 [00:00<00:00, 11.84it/s]100%|██████████| 4/4 [00:00<00:00, 11.77it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.18it/s]100%|██████████| 4/4 [00:00<00:00, 17.73it/s]100%|██████████| 4/4 [00:00<00:00, 17.63it/s]
Run 00 | Epoch 00000 | Loss 6.0625 | Train 0.2962 | Val 0.3149 | Test 0.2907
Number of nodes during this epoch:  329666
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.3865966796875 GB
    Memory Allocated: 0.14421319961547852  GigaBytes
Max Memory Allocated: 1.4641594886779785  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.044011831283569336
range selection method range initialization spend 0.013979196548461914
time for parepare:  0.019972801208496094
local_output_nid generation:  0.014377593994140625
local_in_edges_tensor generation:  0.029495954513549805
mini_batch_src_global generation:  0.010361433029174805
r_  generation:  0.1456432342529297
local_output_nid generation:  0.012931585311889648
local_in_edges_tensor generation:  0.011575460433959961
mini_batch_src_global generation:  0.013796806335449219
r_  generation:  0.15423083305358887
----------------------check_connections_block total spend ----------------------------- 0.4719836711883545
generate_one_block  0.17255544662475586
generate_one_block  0.17433595657348633
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06475138664245605
gen group dst list time:  0.0071392059326171875
time for parepare:  0.019724369049072266
local_output_nid generation:  0.015371561050415039
local_in_edges_tensor generation:  0.04434919357299805
mini_batch_src_global generation:  0.03775334358215332
r_  generation:  0.4180426597595215
local_output_nid generation:  0.026522159576416016
local_in_edges_tensor generation:  0.03929781913757324
mini_batch_src_global generation:  0.05014753341674805
r_  generation:  0.43457460403442383
----------------------check_connections_block total spend ----------------------------- 1.2739193439483643
generate_one_block  0.5545566082000732
generate_one_block  0.5737528800964355
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04418635368347168
gen group dst list time:  0.011800289154052734
time for parepare:  0.01974177360534668
local_output_nid generation:  0.021991252899169922
local_in_edges_tensor generation:  0.03287315368652344
mini_batch_src_global generation:  0.03041386604309082
r_  generation:  0.37080836296081543
local_output_nid generation:  0.03402066230773926
local_in_edges_tensor generation:  0.03422904014587402
mini_batch_src_global generation:  0.03791189193725586
r_  generation:  0.3872568607330322
----------------------check_connections_block total spend ----------------------------- 1.1350889205932617
generate_one_block  0.4624195098876953
generate_one_block  0.48802709579467773
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.3865966796875 GB
    Memory Allocated: 0.14421319961547852  GigaBytes
Max Memory Allocated: 1.4641594886779785  GigaBytes

connection checking time:  2.409008264541626
block generation total time  2.078756093978882
average batch blocks generation time:  1.039378046989441
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3865966796875 GB
    Memory Allocated: 0.10979223251342773  GigaBytes
Max Memory Allocated: 1.4641594886779785  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3865966796875 GB
    Memory Allocated: 1.226736068725586  GigaBytes
Max Memory Allocated: 1.4641594886779785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3865966796875 GB
    Memory Allocated: 0.10980796813964844  GigaBytes
Max Memory Allocated: 1.465259075164795  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6365966796875 GB
    Memory Allocated: 1.2291812896728516  GigaBytes
Max Memory Allocated: 1.465259075164795  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08486807346343994 |0.026303768157958984 |0.015260815620422363 |0.0004998445510864258 |0.004847168922424316 |0.002043485641479492 |
----------------------------------------------------------pseudo_mini_loss sum 3.23592472076416
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.18it/s]100%|██████████| 4/4 [00:00<00:00, 30.20it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.53it/s]100%|██████████| 4/4 [00:00<00:00, 12.88it/s]100%|██████████| 4/4 [00:00<00:00, 12.65it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.68it/s]100%|██████████| 4/4 [00:00<00:00, 17.55it/s]100%|██████████| 4/4 [00:00<00:00, 17.22it/s]
Run 00 | Epoch 00001 | Loss 3.2359 | Train 0.3233 | Val 0.3640 | Test 0.4086
Number of nodes during this epoch:  329693
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1465911865234375  GigaBytes
Max Memory Allocated: 1.4681963920593262  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.016277074813842773
range selection method range initialization spend 0.013627767562866211
time for parepare:  0.01699995994567871
local_output_nid generation:  0.010519266128540039
local_in_edges_tensor generation:  0.010692596435546875
mini_batch_src_global generation:  0.01072835922241211
r_  generation:  0.150221586227417
local_output_nid generation:  0.011575698852539062
local_in_edges_tensor generation:  0.006111621856689453
mini_batch_src_global generation:  0.014293670654296875
r_  generation:  0.15798354148864746
----------------------check_connections_block total spend ----------------------------- 0.44815897941589355
generate_one_block  0.18171954154968262
generate_one_block  0.17266607284545898
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02794480323791504
gen group dst list time:  0.0069162845611572266
time for parepare:  0.019463539123535156
local_output_nid generation:  0.016677379608154297
local_in_edges_tensor generation:  0.03602266311645508
mini_batch_src_global generation:  0.03983139991760254
r_  generation:  0.4285252094268799
local_output_nid generation:  0.02390432357788086
local_in_edges_tensor generation:  0.028322696685791016
mini_batch_src_global generation:  0.04821658134460449
r_  generation:  0.44846534729003906
----------------------check_connections_block total spend ----------------------------- 1.2775039672851562
generate_one_block  0.5460612773895264
generate_one_block  0.5473165512084961
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02330636978149414
gen group dst list time:  0.011783361434936523
time for parepare:  0.01912069320678711
local_output_nid generation:  0.022231578826904297
local_in_edges_tensor generation:  0.031156539916992188
mini_batch_src_global generation:  0.03168058395385742
r_  generation:  0.3812839984893799
local_output_nid generation:  0.03276181221008301
local_in_edges_tensor generation:  0.031381845474243164
mini_batch_src_global generation:  0.03771853446960449
r_  generation:  0.3945739269256592
----------------------check_connections_block total spend ----------------------------- 1.1456310749053955
generate_one_block  0.4555246829986572
generate_one_block  0.4614567756652832
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1465911865234375  GigaBytes
Max Memory Allocated: 1.4681963920593262  GigaBytes

connection checking time:  2.4231350421905518
block generation total time  2.010359287261963
average batch blocks generation time:  1.0051796436309814
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.11063909530639648  GigaBytes
Max Memory Allocated: 1.4681963920593262  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2280383110046387  GigaBytes
Max Memory Allocated: 1.4681963920593262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10982418060302734  GigaBytes
Max Memory Allocated: 1.4681963920593262  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2276315689086914  GigaBytes
Max Memory Allocated: 1.4681963920593262  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04306483268737793 |0.015227317810058594 |0.0039070844650268555 |0.0005034208297729492 |0.039502859115600586 |0.0016298294067382812 |
----------------------------------------------------------pseudo_mini_loss sum 2.621669292449951
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 66.46it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.98it/s]100%|██████████| 4/4 [00:00<00:00, 16.19it/s]100%|██████████| 4/4 [00:00<00:00, 16.14it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.67it/s]100%|██████████| 4/4 [00:00<00:00, 18.57it/s]100%|██████████| 4/4 [00:00<00:00, 18.56it/s]
Run 00 | Epoch 00002 | Loss 2.6217 | Train 0.3074 | Val 0.3043 | Test 0.3547
Number of nodes during this epoch:  329781
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1468057632446289  GigaBytes
Max Memory Allocated: 1.4681963920593262  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022164106369018555
range selection method range initialization spend 0.014571905136108398
time for parepare:  0.016980409622192383
local_output_nid generation:  0.010640382766723633
local_in_edges_tensor generation:  0.017089128494262695
mini_batch_src_global generation:  0.011185884475708008
r_  generation:  0.15607571601867676
local_output_nid generation:  0.012534379959106445
local_in_edges_tensor generation:  0.006240367889404297
mini_batch_src_global generation:  0.021578073501586914
r_  generation:  0.21320819854736328
----------------------check_connections_block total spend ----------------------------- 0.5274477005004883
generate_one_block  0.168257474899292
generate_one_block  0.18193578720092773
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.032028913497924805
gen group dst list time:  0.008267879486083984
time for parepare:  0.022085905075073242
local_output_nid generation:  0.017256498336791992
local_in_edges_tensor generation:  0.04104185104370117
mini_batch_src_global generation:  0.05050206184387207
r_  generation:  0.42544007301330566
local_output_nid generation:  0.02483367919921875
local_in_edges_tensor generation:  0.036108970642089844
mini_batch_src_global generation:  0.049184322357177734
r_  generation:  0.43952345848083496
----------------------check_connections_block total spend ----------------------------- 1.2938265800476074
generate_one_block  0.5452008247375488
generate_one_block  0.5514132976531982
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.022042274475097656
gen group dst list time:  0.0124359130859375
time for parepare:  0.02053689956665039
local_output_nid generation:  0.023756742477416992
local_in_edges_tensor generation:  0.03815507888793945
mini_batch_src_global generation:  0.029963970184326172
r_  generation:  0.377042293548584
local_output_nid generation:  0.03313565254211426
local_in_edges_tensor generation:  0.03667616844177246
mini_batch_src_global generation:  0.03793144226074219
r_  generation:  0.39330530166625977
----------------------check_connections_block total spend ----------------------------- 1.160548210144043
generate_one_block  0.4552600383758545
generate_one_block  0.4573960304260254
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1468057632446289  GigaBytes
Max Memory Allocated: 1.4681963920593262  GigaBytes

connection checking time:  2.4543747901916504
block generation total time  2.009270191192627
average batch blocks generation time:  1.0046350955963135
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1090388298034668  GigaBytes
Max Memory Allocated: 1.4681963920593262  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2269716262817383  GigaBytes
Max Memory Allocated: 1.4681963920593262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10977363586425781  GigaBytes
Max Memory Allocated: 1.4681963920593262  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2291359901428223  GigaBytes
Max Memory Allocated: 1.4681963920593262  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08988773822784424 |0.021813273429870605 |0.014610886573791504 |0.0005000829696655273 |0.003970980644226074 |0.001676321029663086 |
----------------------------------------------------------pseudo_mini_loss sum 2.3985486030578613
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.12it/s]100%|██████████| 4/4 [00:00<00:00, 30.25it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.62it/s]100%|██████████| 4/4 [00:00<00:00, 12.80it/s]100%|██████████| 4/4 [00:00<00:00, 12.60it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.55it/s]100%|██████████| 4/4 [00:00<00:00, 18.07it/s]100%|██████████| 4/4 [00:00<00:00, 17.97it/s]
Run 00 | Epoch 00003 | Loss 2.3985 | Train 0.4422 | Val 0.5111 | Test 0.5380
Number of nodes during this epoch:  329646
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14632701873779297  GigaBytes
Max Memory Allocated: 1.46821928024292  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.015432119369506836
range selection method range initialization spend 0.012699604034423828
time for parepare:  0.016720294952392578
local_output_nid generation:  0.010456085205078125
local_in_edges_tensor generation:  0.01067495346069336
mini_batch_src_global generation:  0.010734081268310547
r_  generation:  0.1437363624572754
local_output_nid generation:  0.011605978012084961
local_in_edges_tensor generation:  0.0065534114837646484
mini_batch_src_global generation:  0.014093875885009766
r_  generation:  0.15557193756103516
----------------------check_connections_block total spend ----------------------------- 0.4391188621520996
generate_one_block  0.1664433479309082
generate_one_block  0.1689777374267578
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03255510330200195
gen group dst list time:  0.006976604461669922
time for parepare:  0.019484758377075195
local_output_nid generation:  0.016809940338134766
local_in_edges_tensor generation:  0.029007911682128906
mini_batch_src_global generation:  0.03793740272521973
r_  generation:  0.4239926338195801
local_output_nid generation:  0.02461552619934082
local_in_edges_tensor generation:  0.02704334259033203
mini_batch_src_global generation:  0.05190157890319824
r_  generation:  0.4408128261566162
----------------------check_connections_block total spend ----------------------------- 1.2604081630706787
generate_one_block  0.5535259246826172
generate_one_block  0.579352855682373
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.022513628005981445
gen group dst list time:  0.013814926147460938
time for parepare:  0.02032756805419922
local_output_nid generation:  0.025252103805541992
local_in_edges_tensor generation:  0.04345107078552246
mini_batch_src_global generation:  0.030463457107543945
r_  generation:  0.3802788257598877
local_output_nid generation:  0.03210592269897461
local_in_edges_tensor generation:  0.03332233428955078
mini_batch_src_global generation:  0.04284548759460449
r_  generation:  0.37825870513916016
----------------------check_connections_block total spend ----------------------------- 1.1480388641357422
generate_one_block  0.460033655166626
generate_one_block  0.4668562412261963
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14632701873779297  GigaBytes
Max Memory Allocated: 1.46821928024292  GigaBytes

connection checking time:  2.408447027206421
block generation total time  2.0597686767578125
average batch blocks generation time:  1.0298843383789062
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.11056709289550781  GigaBytes
Max Memory Allocated: 1.46821928024292  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.227978229522705  GigaBytes
Max Memory Allocated: 1.46821928024292  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10984277725219727  GigaBytes
Max Memory Allocated: 1.46821928024292  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2297954559326172  GigaBytes
Max Memory Allocated: 1.46821928024292  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0826185941696167 |0.03720736503601074 |0.004110097885131836 |0.0004940032958984375 |0.038809776306152344 |0.003147125244140625 |
----------------------------------------------------------pseudo_mini_loss sum 2.116905689239502
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 51.57it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.06it/s]100%|██████████| 4/4 [00:00<00:00, 15.35it/s]100%|██████████| 4/4 [00:00<00:00, 15.29it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.71it/s]100%|██████████| 4/4 [00:00<00:00, 17.86it/s]100%|██████████| 4/4 [00:00<00:00, 17.82it/s]
Run 00 | Epoch 00004 | Loss 2.1169 | Train 0.4541 | Val 0.4612 | Test 0.4477
Number of nodes during this epoch:  329854
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14658784866333008  GigaBytes
Max Memory Allocated: 1.4688200950622559  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01654052734375
range selection method range initialization spend 0.012696027755737305
time for parepare:  0.016970157623291016
local_output_nid generation:  0.01057744026184082
local_in_edges_tensor generation:  0.009228706359863281
mini_batch_src_global generation:  0.010722160339355469
r_  generation:  0.14647650718688965
local_output_nid generation:  0.011665582656860352
local_in_edges_tensor generation:  0.00600886344909668
mini_batch_src_global generation:  0.013926506042480469
r_  generation:  0.15518522262573242
----------------------check_connections_block total spend ----------------------------- 0.4399068355560303
generate_one_block  0.167832612991333
generate_one_block  0.16721343994140625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02921891212463379
gen group dst list time:  0.006771087646484375
time for parepare:  0.01917266845703125
local_output_nid generation:  0.01618170738220215
local_in_edges_tensor generation:  0.029076814651489258
mini_batch_src_global generation:  0.0373227596282959
r_  generation:  0.42560839653015137
local_output_nid generation:  0.023279428482055664
local_in_edges_tensor generation:  0.023732900619506836
mini_batch_src_global generation:  0.048349618911743164
r_  generation:  0.43012189865112305
----------------------check_connections_block total spend ----------------------------- 1.2383005619049072
generate_one_block  0.5407183170318604
generate_one_block  0.5289473533630371
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.018962383270263672
gen group dst list time:  0.011600494384765625
time for parepare:  0.018657684326171875
local_output_nid generation:  0.021785497665405273
local_in_edges_tensor generation:  0.030104398727416992
mini_batch_src_global generation:  0.029331445693969727
r_  generation:  0.3771803379058838
local_output_nid generation:  0.03040313720703125
local_in_edges_tensor generation:  0.028789758682250977
mini_batch_src_global generation:  0.038884878158569336
r_  generation:  0.37624406814575195
----------------------check_connections_block total spend ----------------------------- 1.1131110191345215
generate_one_block  0.4422183036804199
generate_one_block  0.4489312171936035
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14658784866333008  GigaBytes
Max Memory Allocated: 1.4688200950622559  GigaBytes

connection checking time:  2.3514115810394287
block generation total time  1.960815191268921
average batch blocks generation time:  0.9804075956344604
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.11063575744628906  GigaBytes
Max Memory Allocated: 1.4688200950622559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2277536392211914  GigaBytes
Max Memory Allocated: 1.4688200950622559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10981130599975586  GigaBytes
Max Memory Allocated: 1.4688200950622559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2278265953063965  GigaBytes
Max Memory Allocated: 1.4688200950622559  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0789719820022583 |0.01188349723815918 |0.0040084123611450195 |0.0005230903625488281 |0.0037473440170288086 |0.0014290809631347656 |
----------------------------------------------------------pseudo_mini_loss sum 1.9783005714416504
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 61.33it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.28it/s]100%|██████████| 4/4 [00:00<00:00, 15.55it/s]100%|██████████| 4/4 [00:00<00:00, 15.50it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.45it/s]100%|██████████| 4/4 [00:00<00:00, 17.52it/s]100%|██████████| 4/4 [00:00<00:00, 17.49it/s]
Run 00 | Epoch 00005 | Loss 1.9783 | Train 0.4486 | Val 0.4391 | Test 0.4119
Number of nodes during this epoch:  329819
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14586448669433594  GigaBytes
Max Memory Allocated: 1.4688200950622559  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.016049861907958984
range selection method range initialization spend 0.012749433517456055
time for parepare:  0.016878366470336914
local_output_nid generation:  0.010535240173339844
local_in_edges_tensor generation:  0.007756233215332031
mini_batch_src_global generation:  0.011281728744506836
r_  generation:  0.1468493938446045
local_output_nid generation:  0.011932134628295898
local_in_edges_tensor generation:  0.005996227264404297
mini_batch_src_global generation:  0.014152765274047852
r_  generation:  0.15520596504211426
----------------------check_connections_block total spend ----------------------------- 0.43916940689086914
generate_one_block  0.17016172409057617
generate_one_block  0.16888999938964844
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030154705047607422
gen group dst list time:  0.006910562515258789
time for parepare:  0.019689083099365234
local_output_nid generation:  0.016709089279174805
local_in_edges_tensor generation:  0.042958736419677734
mini_batch_src_global generation:  0.04000139236450195
r_  generation:  0.4317770004272461
local_output_nid generation:  0.026190996170043945
local_in_edges_tensor generation:  0.028486967086791992
mini_batch_src_global generation:  0.04758882522583008
r_  generation:  0.434537410736084
----------------------check_connections_block total spend ----------------------------- 1.2863445281982422
generate_one_block  0.5341808795928955
generate_one_block  0.536768913269043
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02031564712524414
gen group dst list time:  0.011863946914672852
time for parepare:  0.018726110458374023
local_output_nid generation:  0.021901845932006836
local_in_edges_tensor generation:  0.03117060661315918
mini_batch_src_global generation:  0.029838085174560547
r_  generation:  0.3709752559661865
local_output_nid generation:  0.031004667282104492
local_in_edges_tensor generation:  0.02990102767944336
mini_batch_src_global generation:  0.040480613708496094
r_  generation:  0.3787562847137451
----------------------check_connections_block total spend ----------------------------- 1.1141636371612549
generate_one_block  0.44179773330688477
generate_one_block  0.4446587562561035
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14586448669433594  GigaBytes
Max Memory Allocated: 1.4688200950622559  GigaBytes

connection checking time:  2.400508165359497
block generation total time  1.9574062824249268
average batch blocks generation time:  0.9787031412124634
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10907220840454102  GigaBytes
Max Memory Allocated: 1.4688200950622559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.226813793182373  GigaBytes
Max Memory Allocated: 1.4688200950622559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10980367660522461  GigaBytes
Max Memory Allocated: 1.4688200950622559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.228177547454834  GigaBytes
Max Memory Allocated: 1.4688200950622559  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0823523998260498 |0.012285947799682617 |0.004188895225524902 |0.0005043745040893555 |0.0037649869918823242 |0.0029621124267578125 |
----------------------------------------------------------pseudo_mini_loss sum 1.8828942775726318
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 51.02it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.96it/s]100%|██████████| 4/4 [00:00<00:00, 15.41it/s]100%|██████████| 4/4 [00:00<00:00, 15.33it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.21it/s]100%|██████████| 4/4 [00:00<00:00, 17.88it/s]100%|██████████| 4/4 [00:00<00:00, 17.76it/s]
Run 00 | Epoch 00006 | Loss 1.8829 | Train 0.4388 | Val 0.4379 | Test 0.4126
Number of nodes during this epoch:  329739
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14580059051513672  GigaBytes
Max Memory Allocated: 1.4688200950622559  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.014025688171386719
range selection method range initialization spend 0.01198887825012207
time for parepare:  0.017403125762939453
local_output_nid generation:  0.010564565658569336
local_in_edges_tensor generation:  0.007849931716918945
mini_batch_src_global generation:  0.01085042953491211
r_  generation:  0.14533424377441406
local_output_nid generation:  0.011641979217529297
local_in_edges_tensor generation:  0.005511045455932617
mini_batch_src_global generation:  0.013932228088378906
r_  generation:  0.15660500526428223
----------------------check_connections_block total spend ----------------------------- 0.43892574310302734
generate_one_block  0.16776180267333984
generate_one_block  0.1692354679107666
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02616739273071289
gen group dst list time:  0.007034778594970703
time for parepare:  0.019896984100341797
local_output_nid generation:  0.016626358032226562
local_in_edges_tensor generation:  0.025684833526611328
mini_batch_src_global generation:  0.037676334381103516
r_  generation:  0.43570947647094727
local_output_nid generation:  0.023932218551635742
local_in_edges_tensor generation:  0.025269031524658203
mini_batch_src_global generation:  0.04715561866760254
r_  generation:  0.4535486698150635
----------------------check_connections_block total spend ----------------------------- 1.2742445468902588
generate_one_block  0.5735816955566406
generate_one_block  0.5526235103607178
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.031250953674316406
gen group dst list time:  0.014592885971069336
time for parepare:  0.0188446044921875
local_output_nid generation:  0.021497726440429688
local_in_edges_tensor generation:  0.037017822265625
mini_batch_src_global generation:  0.032746076583862305
r_  generation:  0.37690019607543945
local_output_nid generation:  0.03051161766052246
local_in_edges_tensor generation:  0.029836416244506836
mini_batch_src_global generation:  0.03865838050842285
r_  generation:  0.37976717948913574
----------------------check_connections_block total spend ----------------------------- 1.1360194683074951
generate_one_block  0.4584939479827881
generate_one_block  0.4693295955657959
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14580059051513672  GigaBytes
Max Memory Allocated: 1.4688200950622559  GigaBytes

connection checking time:  2.410264015197754
block generation total time  2.0540287494659424
average batch blocks generation time:  1.0270143747329712
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10905075073242188  GigaBytes
Max Memory Allocated: 1.4688200950622559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2266831398010254  GigaBytes
Max Memory Allocated: 1.4688200950622559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1098484992980957  GigaBytes
Max Memory Allocated: 1.4688200950622559  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2303380966186523  GigaBytes
Max Memory Allocated: 1.4688200950622559  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08234560489654541 |0.019684433937072754 |0.014649391174316406 |0.000492095947265625 |0.025174379348754883 |0.00304412841796875 |
----------------------------------------------------------pseudo_mini_loss sum 1.8000562191009521
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 51.39it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.15it/s]100%|██████████| 4/4 [00:00<00:00, 15.38it/s]100%|██████████| 4/4 [00:00<00:00, 15.33it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.41it/s]100%|██████████| 4/4 [00:00<00:00, 17.65it/s]100%|██████████| 4/4 [00:00<00:00, 17.59it/s]
Run 00 | Epoch 00007 | Loss 1.8001 | Train 0.4329 | Val 0.4564 | Test 0.4373
Number of nodes during this epoch:  329812
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14597129821777344  GigaBytes
Max Memory Allocated: 1.469573974609375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.015287637710571289
range selection method range initialization spend 0.012950897216796875
time for parepare:  0.017383575439453125
local_output_nid generation:  0.010741472244262695
local_in_edges_tensor generation:  0.009079694747924805
mini_batch_src_global generation:  0.010987520217895508
r_  generation:  0.14652323722839355
local_output_nid generation:  0.011884689331054688
local_in_edges_tensor generation:  0.005900144577026367
mini_batch_src_global generation:  0.01426243782043457
r_  generation:  0.15689659118652344
----------------------check_connections_block total spend ----------------------------- 0.44334840774536133
generate_one_block  0.16661453247070312
generate_one_block  0.1713240146636963
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03179192543029785
gen group dst list time:  0.00709843635559082
time for parepare:  0.02017354965209961
local_output_nid generation:  0.016927242279052734
local_in_edges_tensor generation:  0.02504420280456543
mini_batch_src_global generation:  0.03828549385070801
r_  generation:  0.4274468421936035
local_output_nid generation:  0.02555227279663086
local_in_edges_tensor generation:  0.02778315544128418
mini_batch_src_global generation:  0.0476231575012207
r_  generation:  0.45052194595336914
----------------------check_connections_block total spend ----------------------------- 1.266834020614624
generate_one_block  0.5410900115966797
generate_one_block  0.5462863445281982
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.018739700317382812
gen group dst list time:  0.01230621337890625
time for parepare:  0.019319772720336914
local_output_nid generation:  0.022971391677856445
local_in_edges_tensor generation:  0.02838897705078125
mini_batch_src_global generation:  0.030416488647460938
r_  generation:  0.3684523105621338
local_output_nid generation:  0.03402590751647949
local_in_edges_tensor generation:  0.03275179862976074
mini_batch_src_global generation:  0.03790450096130371
r_  generation:  0.38784146308898926
----------------------check_connections_block total spend ----------------------------- 1.125685214996338
generate_one_block  0.4482848644256592
generate_one_block  0.45837855339050293
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14597129821777344  GigaBytes
Max Memory Allocated: 1.469573974609375  GigaBytes

connection checking time:  2.392519235610962
block generation total time  1.99403977394104
average batch blocks generation time:  0.99701988697052
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10938739776611328  GigaBytes
Max Memory Allocated: 1.469573974609375  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2260169982910156  GigaBytes
Max Memory Allocated: 1.469573974609375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10896825790405273  GigaBytes
Max Memory Allocated: 1.469573974609375  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2291507720947266  GigaBytes
Max Memory Allocated: 1.469573974609375  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07970261573791504 |0.01203608512878418 |0.016397833824157715 |0.0004916191101074219 |0.003841400146484375 |0.002886533737182617 |
----------------------------------------------------------pseudo_mini_loss sum 1.7154202461242676
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 66.32it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.28it/s]100%|██████████| 4/4 [00:00<00:00, 15.52it/s]100%|██████████| 4/4 [00:00<00:00, 15.46it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.64it/s]100%|██████████| 4/4 [00:00<00:00, 17.85it/s]100%|██████████| 4/4 [00:00<00:00, 17.79it/s]
Run 00 | Epoch 00008 | Loss 1.7154 | Train 0.4413 | Val 0.4923 | Test 0.4834
Number of nodes during this epoch:  329728
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14446020126342773  GigaBytes
Max Memory Allocated: 1.469573974609375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.013805389404296875
range selection method range initialization spend 0.012268543243408203
time for parepare:  0.017356395721435547
local_output_nid generation:  0.010700464248657227
local_in_edges_tensor generation:  0.008169174194335938
mini_batch_src_global generation:  0.011267662048339844
r_  generation:  0.14707303047180176
local_output_nid generation:  0.011954307556152344
local_in_edges_tensor generation:  0.005890846252441406
mini_batch_src_global generation:  0.014208316802978516
r_  generation:  0.15728163719177246
----------------------check_connections_block total spend ----------------------------- 0.4440643787384033
generate_one_block  0.16854500770568848
generate_one_block  0.1688833236694336
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0264894962310791
gen group dst list time:  0.007040739059448242
time for parepare:  0.019784212112426758
local_output_nid generation:  0.016436100006103516
local_in_edges_tensor generation:  0.02520751953125
mini_batch_src_global generation:  0.03851938247680664
r_  generation:  0.43399691581726074
local_output_nid generation:  0.02334451675415039
local_in_edges_tensor generation:  0.024429798126220703
mini_batch_src_global generation:  0.04743790626525879
r_  generation:  0.44905853271484375
----------------------check_connections_block total spend ----------------------------- 1.26609206199646
generate_one_block  0.5612361431121826
generate_one_block  0.5475788116455078
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.020803451538085938
gen group dst list time:  0.013205766677856445
time for parepare:  0.01900768280029297
local_output_nid generation:  0.02220439910888672
local_in_edges_tensor generation:  0.032599687576293945
mini_batch_src_global generation:  0.030447959899902344
r_  generation:  0.38029050827026367
local_output_nid generation:  0.033663034439086914
local_in_edges_tensor generation:  0.03165626525878906
mini_batch_src_global generation:  0.037470340728759766
r_  generation:  0.3832724094390869
----------------------check_connections_block total spend ----------------------------- 1.139219045639038
generate_one_block  0.46287965774536133
generate_one_block  0.4524800777435303
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14446020126342773  GigaBytes
Max Memory Allocated: 1.469573974609375  GigaBytes

connection checking time:  2.405311107635498
block generation total time  2.024174690246582
average batch blocks generation time:  1.012087345123291
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10997915267944336  GigaBytes
Max Memory Allocated: 1.469573974609375  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2294821739196777  GigaBytes
Max Memory Allocated: 1.469573974609375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.11133813858032227  GigaBytes
Max Memory Allocated: 1.469573974609375  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2277846336364746  GigaBytes
Max Memory Allocated: 1.469573974609375  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08077621459960938 |0.0188218355178833 |0.004181861877441406 |0.0005208253860473633 |0.0037821531295776367 |0.0014357566833496094 |
----------------------------------------------------------pseudo_mini_loss sum 1.6523432731628418
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 50.81it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.18it/s]100%|██████████| 4/4 [00:00<00:00, 15.48it/s]100%|██████████| 4/4 [00:00<00:00, 15.42it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.61it/s]100%|██████████| 4/4 [00:00<00:00, 17.73it/s]100%|██████████| 4/4 [00:00<00:00, 17.69it/s]
Run 00 | Epoch 00009 | Loss 1.6523 | Train 0.4556 | Val 0.5273 | Test 0.5283
Number of nodes during this epoch:  329688
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1466512680053711  GigaBytes
Max Memory Allocated: 1.469573974609375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.014748573303222656
range selection method range initialization spend 0.012493610382080078
time for parepare:  0.01735210418701172
local_output_nid generation:  0.010559797286987305
local_in_edges_tensor generation:  0.009221553802490234
mini_batch_src_global generation:  0.011228084564208984
r_  generation:  0.14844131469726562
local_output_nid generation:  0.011766910552978516
local_in_edges_tensor generation:  0.00561833381652832
mini_batch_src_global generation:  0.014343976974487305
r_  generation:  0.15631413459777832
----------------------check_connections_block total spend ----------------------------- 0.44471120834350586
generate_one_block  0.1681067943572998
generate_one_block  0.16975736618041992
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029537200927734375
gen group dst list time:  0.007077217102050781
time for parepare:  0.020214557647705078
local_output_nid generation:  0.017104387283325195
local_in_edges_tensor generation:  0.028399944305419922
mini_batch_src_global generation:  0.03843402862548828
r_  generation:  0.42679786682128906
local_output_nid generation:  0.02592158317565918
local_in_edges_tensor generation:  0.024498939514160156
mini_batch_src_global generation:  0.04730486869812012
r_  generation:  0.442763090133667
----------------------check_connections_block total spend ----------------------------- 1.262326717376709
generate_one_block  0.5503120422363281
generate_one_block  0.5520169734954834
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02104496955871582
gen group dst list time:  0.012957334518432617
time for parepare:  0.019804716110229492
local_output_nid generation:  0.0247344970703125
local_in_edges_tensor generation:  0.0327298641204834
mini_batch_src_global generation:  0.03085803985595703
r_  generation:  0.3959665298461914
local_output_nid generation:  0.03627276420593262
local_in_edges_tensor generation:  0.034966230392456055
mini_batch_src_global generation:  0.03761410713195801
r_  generation:  0.37837934494018555
----------------------check_connections_block total spend ----------------------------- 1.1593847274780273
generate_one_block  0.46820664405822754
generate_one_block  0.4628305435180664
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1466512680053711  GigaBytes
Max Memory Allocated: 1.469573974609375  GigaBytes

connection checking time:  2.4217114448547363
block generation total time  2.0333662033081055
average batch blocks generation time:  1.0166831016540527
block dataloader generation time/epoch 5.926158666610718
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10910844802856445  GigaBytes
Max Memory Allocated: 1.469573974609375  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.232313632965088  GigaBytes
Max Memory Allocated: 1.469573974609375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10878419876098633  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2262625694274902  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.047563791275024414 |0.018824219703674316 |0.004212856292724609 |0.0005096197128295898 |0.04052317142486572 |0.0015077590942382812 |
----------------------------------------------------------pseudo_mini_loss sum 1.5987862348556519
Total (block generation + training)time/epoch 6.258528470993042
Training time/epoch 0.3322141170501709
Training time without block to device /epoch 0.29456567764282227
Training time without total dataloading part /epoch 0.09199905395507812
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 52.30it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.06it/s]100%|██████████| 4/4 [00:00<00:00, 15.49it/s]100%|██████████| 4/4 [00:00<00:00, 15.40it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.56it/s]100%|██████████| 4/4 [00:00<00:00, 17.85it/s]100%|██████████| 4/4 [00:00<00:00, 17.78it/s]
Run 00 | Epoch 00010 | Loss 1.5988 | Train 0.4563 | Val 0.5321 | Test 0.5354
Number of nodes during this epoch:  329872
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14411497116088867  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.013470172882080078
range selection method range initialization spend 0.012179374694824219
time for parepare:  0.01787877082824707
local_output_nid generation:  0.010544300079345703
local_in_edges_tensor generation:  0.008714675903320312
mini_batch_src_global generation:  0.011205673217773438
r_  generation:  0.14712882041931152
local_output_nid generation:  0.011724233627319336
local_in_edges_tensor generation:  0.005493640899658203
mini_batch_src_global generation:  0.014476299285888672
r_  generation:  0.1570882797241211
----------------------check_connections_block total spend ----------------------------- 0.4446289539337158
generate_one_block  0.16932010650634766
generate_one_block  0.1688692569732666
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.027904748916625977
gen group dst list time:  0.007121086120605469
time for parepare:  0.01986837387084961
local_output_nid generation:  0.016403913497924805
local_in_edges_tensor generation:  0.025528669357299805
mini_batch_src_global generation:  0.0386202335357666
r_  generation:  0.4338569641113281
local_output_nid generation:  0.023624897003173828
local_in_edges_tensor generation:  0.02689671516418457
mini_batch_src_global generation:  0.047510623931884766
r_  generation:  0.4423370361328125
----------------------check_connections_block total spend ----------------------------- 1.2679224014282227
generate_one_block  0.5590691566467285
generate_one_block  0.5468049049377441
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02334141731262207
gen group dst list time:  0.01413416862487793
time for parepare:  0.018970966339111328
local_output_nid generation:  0.021654129028320312
local_in_edges_tensor generation:  0.03438067436218262
mini_batch_src_global generation:  0.030686140060424805
r_  generation:  0.37552356719970703
local_output_nid generation:  0.03177165985107422
local_in_edges_tensor generation:  0.032193899154663086
mini_batch_src_global generation:  0.03765392303466797
r_  generation:  0.38458847999572754
----------------------check_connections_block total spend ----------------------------- 1.1293420791625977
generate_one_block  0.45690441131591797
generate_one_block  0.4488687515258789
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14411497116088867  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

connection checking time:  2.3972644805908203
block generation total time  2.0116472244262695
average batch blocks generation time:  1.0058236122131348
block dataloader generation time/epoch 5.910500407218933
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1090693473815918  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2273597717285156  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1097874641418457  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2275400161743164  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08113563060760498 |0.01291954517364502 |0.004258394241333008 |0.0005254745483398438 |0.003740072250366211 |0.0015950202941894531 |
----------------------------------------------------------pseudo_mini_loss sum 1.553788661956787
Total (block generation + training)time/epoch 6.228755831718445
Training time/epoch 0.30396175384521484
Training time without block to device /epoch 0.2781226634979248
Training time without total dataloading part /epoch 0.018642902374267578
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 50.20it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.12it/s]100%|██████████| 4/4 [00:00<00:00, 15.41it/s]100%|██████████| 4/4 [00:00<00:00, 15.35it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.17it/s]100%|██████████| 4/4 [00:00<00:00, 17.71it/s]100%|██████████| 4/4 [00:00<00:00, 17.61it/s]
Run 00 | Epoch 00011 | Loss 1.5538 | Train 0.4471 | Val 0.5242 | Test 0.5225
Number of nodes during this epoch:  329658
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1460094451904297  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.015550613403320312
range selection method range initialization spend 0.011860370635986328
time for parepare:  0.017028093338012695
local_output_nid generation:  0.010524988174438477
local_in_edges_tensor generation:  0.007799863815307617
mini_batch_src_global generation:  0.011092185974121094
r_  generation:  0.14704275131225586
local_output_nid generation:  0.011725902557373047
local_in_edges_tensor generation:  0.005425691604614258
mini_batch_src_global generation:  0.014565467834472656
r_  generation:  0.15766263008117676
----------------------check_connections_block total spend ----------------------------- 0.44390392303466797
generate_one_block  0.16812419891357422
generate_one_block  0.1698591709136963
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.026660919189453125
gen group dst list time:  0.007079124450683594
time for parepare:  0.0197451114654541
local_output_nid generation:  0.016781330108642578
local_in_edges_tensor generation:  0.025287866592407227
mini_batch_src_global generation:  0.03880763053894043
r_  generation:  0.4271891117095947
local_output_nid generation:  0.02412700653076172
local_in_edges_tensor generation:  0.02696847915649414
mini_batch_src_global generation:  0.047364234924316406
r_  generation:  0.44179463386535645
----------------------check_connections_block total spend ----------------------------- 1.2554354667663574
generate_one_block  0.5430221557617188
generate_one_block  0.5432014465332031
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.017521381378173828
gen group dst list time:  0.012229204177856445
time for parepare:  0.018947124481201172
local_output_nid generation:  0.02185678482055664
local_in_edges_tensor generation:  0.02762150764465332
mini_batch_src_global generation:  0.03098464012145996
r_  generation:  0.3735952377319336
local_output_nid generation:  0.031197309494018555
local_in_edges_tensor generation:  0.026534080505371094
mini_batch_src_global generation:  0.0376286506652832
r_  generation:  0.3814728260040283
----------------------check_connections_block total spend ----------------------------- 1.1168067455291748
generate_one_block  0.44904351234436035
generate_one_block  0.45253801345825195
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1460094451904297  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

connection checking time:  2.3722422122955322
block generation total time  1.9878051280975342
average batch blocks generation time:  0.9939025640487671
block dataloader generation time/epoch 5.8807603518168134
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1090693473815918  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2273473739624023  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10981130599975586  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2276711463928223  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07670116424560547 |0.015237808227539062 |0.004101395606994629 |0.0005195140838623047 |0.003418445587158203 |0.001329660415649414 |
----------------------------------------------------------pseudo_mini_loss sum 1.5210886001586914
Total (block generation + training)time/epoch 6.193615039189656
Training time/epoch 0.3019700050354004
Training time without block to device /epoch 0.27149438858032227
Training time without total dataloading part /epoch 0.017408370971679688
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 49.77it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.25it/s]100%|██████████| 4/4 [00:00<00:00, 14.34it/s]100%|██████████| 4/4 [00:00<00:00, 14.46it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.80it/s]100%|██████████| 4/4 [00:00<00:00, 16.79it/s]100%|██████████| 4/4 [00:00<00:00, 16.61it/s]
Run 00 | Epoch 00012 | Loss 1.5211 | Train 0.4388 | Val 0.5167 | Test 0.5127
Number of nodes during this epoch:  329736
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14671087265014648  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0169525146484375
range selection method range initialization spend 0.012181520462036133
time for parepare:  0.0173184871673584
local_output_nid generation:  0.010654211044311523
local_in_edges_tensor generation:  0.009818792343139648
mini_batch_src_global generation:  0.011140108108520508
r_  generation:  0.14910101890563965
local_output_nid generation:  0.011815071105957031
local_in_edges_tensor generation:  0.006601095199584961
mini_batch_src_global generation:  0.014668703079223633
r_  generation:  0.1583080291748047
----------------------check_connections_block total spend ----------------------------- 0.449923038482666
generate_one_block  0.17539525032043457
generate_one_block  0.17114734649658203
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028053760528564453
gen group dst list time:  0.006966352462768555
time for parepare:  0.019819259643554688
local_output_nid generation:  0.01690983772277832
local_in_edges_tensor generation:  0.02783656120300293
mini_batch_src_global generation:  0.03901815414428711
r_  generation:  0.4282960891723633
local_output_nid generation:  0.024196147918701172
local_in_edges_tensor generation:  0.027934789657592773
mini_batch_src_global generation:  0.04735875129699707
r_  generation:  0.4446706771850586
----------------------check_connections_block total spend ----------------------------- 1.267688274383545
generate_one_block  0.552659273147583
generate_one_block  0.5697193145751953
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03204178810119629
gen group dst list time:  0.014452219009399414
time for parepare:  0.020534992218017578
local_output_nid generation:  0.0226900577545166
local_in_edges_tensor generation:  0.03169369697570801
mini_batch_src_global generation:  0.032582759857177734
r_  generation:  0.3686525821685791
local_output_nid generation:  0.03339385986328125
local_in_edges_tensor generation:  0.030892372131347656
mini_batch_src_global generation:  0.03757786750793457
r_  generation:  0.37992286682128906
----------------------check_connections_block total spend ----------------------------- 1.1218385696411133
generate_one_block  0.46598315238952637
generate_one_block  0.4524660110473633
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14671087265014648  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

connection checking time:  2.389526844024658
block generation total time  2.040827751159668
average batch blocks generation time:  1.020413875579834
block dataloader generation time/epoch 5.899225056171417
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10906791687011719  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.227076530456543  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10980510711669922  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.229421615600586  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08219873905181885 |0.016344785690307617 |0.004243969917297363 |0.0005263090133666992 |0.0038225650787353516 |0.0030586719512939453 |
----------------------------------------------------------pseudo_mini_loss sum 1.4813628196716309
Total (block generation + training)time/epoch 6.213500678539276
Training time/epoch 0.31839561462402344
Training time without block to device /epoch 0.2857060432434082
Training time without total dataloading part /epoch 0.020244359970092773
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.11it/s]100%|██████████| 4/4 [00:00<00:00, 29.95it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.60it/s]100%|██████████| 4/4 [00:00<00:00, 12.69it/s]100%|██████████| 4/4 [00:00<00:00, 12.50it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.21it/s]100%|██████████| 4/4 [00:00<00:00, 17.65it/s]100%|██████████| 4/4 [00:00<00:00, 17.57it/s]
Run 00 | Epoch 00013 | Loss 1.4814 | Train 0.4334 | Val 0.5183 | Test 0.5166
Number of nodes during this epoch:  329765
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1465139389038086  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.014498233795166016
range selection method range initialization spend 0.011876106262207031
time for parepare:  0.018416404724121094
local_output_nid generation:  0.01087641716003418
local_in_edges_tensor generation:  0.007875680923461914
mini_batch_src_global generation:  0.011097908020019531
r_  generation:  0.14537978172302246
local_output_nid generation:  0.011768341064453125
local_in_edges_tensor generation:  0.005556344985961914
mini_batch_src_global generation:  0.014646291732788086
r_  generation:  0.15693926811218262
----------------------check_connections_block total spend ----------------------------- 0.44242262840270996
generate_one_block  0.16727209091186523
generate_one_block  0.16972804069519043
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029526233673095703
gen group dst list time:  0.006860256195068359
time for parepare:  0.01991891860961914
local_output_nid generation:  0.016813278198242188
local_in_edges_tensor generation:  0.02889251708984375
mini_batch_src_global generation:  0.038954734802246094
r_  generation:  0.43296122550964355
local_output_nid generation:  0.02457118034362793
local_in_edges_tensor generation:  0.030976533889770508
mini_batch_src_global generation:  0.04929184913635254
r_  generation:  0.4676520824432373
----------------------check_connections_block total spend ----------------------------- 1.303060531616211
generate_one_block  0.5579702854156494
generate_one_block  0.5566320419311523
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.023248910903930664
gen group dst list time:  0.01320505142211914
time for parepare:  0.01918339729309082
local_output_nid generation:  0.022953271865844727
local_in_edges_tensor generation:  0.03546619415283203
mini_batch_src_global generation:  0.032120704650878906
r_  generation:  0.37094664573669434
local_output_nid generation:  0.03259110450744629
local_in_edges_tensor generation:  0.029410839080810547
mini_batch_src_global generation:  0.0371706485748291
r_  generation:  0.38252782821655273
----------------------check_connections_block total spend ----------------------------- 1.1258528232574463
generate_one_block  0.4499630928039551
generate_one_block  0.455885648727417
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1465139389038086  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

connection checking time:  2.4289133548736572
block generation total time  2.020451068878174
average batch blocks generation time:  1.010225534439087
block dataloader generation time/epoch 5.903601741790771
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1106257438659668  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2295913696289062  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10886621475219727  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2258939743041992  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08246767520904541 |0.016732454299926758 |0.00420987606048584 |0.0005221366882324219 |0.003862619400024414 |0.001477956771850586 |
----------------------------------------------------------pseudo_mini_loss sum 1.4502568244934082
Total (block generation + training)time/epoch 6.217527866363525
Training time/epoch 0.312359094619751
Training time without block to device /epoch 0.27889418601989746
Training time without total dataloading part /epoch 0.018667221069335938
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 54.88it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.11it/s]100%|██████████| 4/4 [00:00<00:00, 15.46it/s]100%|██████████| 4/4 [00:00<00:00, 15.39it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.89it/s]100%|██████████| 4/4 [00:00<00:00, 17.47it/s]100%|██████████| 4/4 [00:00<00:00, 17.36it/s]
Run 00 | Epoch 00014 | Loss 1.4503 | Train 0.4232 | Val 0.5248 | Test 0.5275
Number of nodes during this epoch:  329794
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14477968215942383  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.014729738235473633
range selection method range initialization spend 0.012358427047729492
time for parepare:  0.017150163650512695
local_output_nid generation:  0.01079702377319336
local_in_edges_tensor generation:  0.008070707321166992
mini_batch_src_global generation:  0.011189699172973633
r_  generation:  0.14641833305358887
local_output_nid generation:  0.011837959289550781
local_in_edges_tensor generation:  0.005858898162841797
mini_batch_src_global generation:  0.014516353607177734
r_  generation:  0.15855717658996582
----------------------check_connections_block total spend ----------------------------- 0.4461250305175781
generate_one_block  0.16755366325378418
generate_one_block  0.17518925666809082
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.025144100189208984
gen group dst list time:  0.007032155990600586
time for parepare:  0.020961284637451172
local_output_nid generation:  0.016881465911865234
local_in_edges_tensor generation:  0.029881000518798828
mini_batch_src_global generation:  0.03845810890197754
r_  generation:  0.43871498107910156
local_output_nid generation:  0.0238955020904541
local_in_edges_tensor generation:  0.0316767692565918
mini_batch_src_global generation:  0.04994964599609375
r_  generation:  0.4524197578430176
----------------------check_connections_block total spend ----------------------------- 1.3067946434020996
generate_one_block  0.5456540584564209
generate_one_block  0.5479757785797119
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02555394172668457
gen group dst list time:  0.01318979263305664
time for parepare:  0.018829822540283203
local_output_nid generation:  0.023135900497436523
local_in_edges_tensor generation:  0.03932952880859375
mini_batch_src_global generation:  0.03122568130493164
r_  generation:  0.36936450004577637
local_output_nid generation:  0.03184914588928223
local_in_edges_tensor generation:  0.02701878547668457
mini_batch_src_global generation:  0.03775739669799805
r_  generation:  0.37867212295532227
----------------------check_connections_block total spend ----------------------------- 1.1195509433746338
generate_one_block  0.44640254974365234
generate_one_block  0.44994592666625977
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14477968215942383  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

connection checking time:  2.4263455867767334
block generation total time  1.989978313446045
average batch blocks generation time:  0.9949891567230225
block dataloader generation time/epoch 5.903991222381592
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10977602005004883  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2277708053588867  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10980415344238281  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2299213409423828  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08224737644195557 |0.011859774589538574 |0.004247784614562988 |0.0005246400833129883 |0.003745436668395996 |0.0028748512268066406 |
----------------------------------------------------------pseudo_mini_loss sum 1.4132814407348633
Total (block generation + training)time/epoch 6.217482169469197
Training time/epoch 0.3111729621887207
Training time without block to device /epoch 0.28745341300964355
Training time without total dataloading part /epoch 0.019910573959350586
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.39it/s]100%|██████████| 4/4 [00:00<00:00, 29.47it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.48it/s]100%|██████████| 4/4 [00:00<00:00, 12.67it/s]100%|██████████| 4/4 [00:00<00:00, 12.46it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.03it/s]100%|██████████| 4/4 [00:00<00:00, 17.58it/s]100%|██████████| 4/4 [00:00<00:00, 17.48it/s]
Run 00 | Epoch 00015 | Loss 1.4133 | Train 0.4054 | Val 0.5252 | Test 0.5394
Number of nodes during this epoch:  329723
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14615583419799805  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.014771461486816406
range selection method range initialization spend 0.012073755264282227
time for parepare:  0.01686573028564453
local_output_nid generation:  0.010612249374389648
local_in_edges_tensor generation:  0.007720470428466797
mini_batch_src_global generation:  0.011218070983886719
r_  generation:  0.1453876495361328
local_output_nid generation:  0.011717796325683594
local_in_edges_tensor generation:  0.0053751468658447266
mini_batch_src_global generation:  0.014111518859863281
r_  generation:  0.15638136863708496
----------------------check_connections_block total spend ----------------------------- 0.4396860599517822
generate_one_block  0.16716504096984863
generate_one_block  0.17000198364257812
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029424667358398438
gen group dst list time:  0.006883382797241211
time for parepare:  0.019853830337524414
local_output_nid generation:  0.016602516174316406
local_in_edges_tensor generation:  0.025849342346191406
mini_batch_src_global generation:  0.03835868835449219
r_  generation:  0.42447829246520996
local_output_nid generation:  0.023719310760498047
local_in_edges_tensor generation:  0.02382946014404297
mini_batch_src_global generation:  0.04886484146118164
r_  generation:  0.44796204566955566
----------------------check_connections_block total spend ----------------------------- 1.2597486972808838
generate_one_block  0.5758130550384521
generate_one_block  0.5508534908294678
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02145552635192871
gen group dst list time:  0.014079809188842773
time for parepare:  0.018987417221069336
local_output_nid generation:  0.022624492645263672
local_in_edges_tensor generation:  0.041313886642456055
mini_batch_src_global generation:  0.03316235542297363
r_  generation:  0.37031078338623047
local_output_nid generation:  0.030980348587036133
local_in_edges_tensor generation:  0.02742481231689453
mini_batch_src_global generation:  0.03747987747192383
r_  generation:  0.38364315032958984
----------------------check_connections_block total spend ----------------------------- 1.1305222511291504
generate_one_block  0.45784902572631836
generate_one_block  0.4555628299713135
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14615583419799805  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

connection checking time:  2.390270948410034
block generation total time  2.0400784015655518
average batch blocks generation time:  1.0200392007827759
block dataloader generation time/epoch 5.902799674442837
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.11036539077758789  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2280158996582031  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10983800888061523  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2293338775634766  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08091700077056885 |0.01614689826965332 |0.00423586368560791 |0.0005182027816772461 |0.0038280487060546875 |0.0015709400177001953 |
----------------------------------------------------------pseudo_mini_loss sum 1.39206862449646
Total (block generation + training)time/epoch 6.217462199074881
Training time/epoch 0.32154297828674316
Training time without block to device /epoch 0.2892491817474365
Training time without total dataloading part /epoch 0.018735170364379883
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.73it/s]100%|██████████| 4/4 [00:00<00:00, 29.31it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.62it/s]100%|██████████| 4/4 [00:00<00:00, 12.64it/s]100%|██████████| 4/4 [00:00<00:00, 12.47it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.46it/s]100%|██████████| 4/4 [00:00<00:00, 17.53it/s]100%|██████████| 4/4 [00:00<00:00, 17.49it/s]
Run 00 | Epoch 00016 | Loss 1.3921 | Train 0.3897 | Val 0.5222 | Test 0.5495
Number of nodes during this epoch:  329865
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14678573608398438  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.016325712203979492
range selection method range initialization spend 0.011927127838134766
time for parepare:  0.01779937744140625
local_output_nid generation:  0.010861873626708984
local_in_edges_tensor generation:  0.007696866989135742
mini_batch_src_global generation:  0.011020898818969727
r_  generation:  0.14644241333007812
local_output_nid generation:  0.011929512023925781
local_in_edges_tensor generation:  0.0054531097412109375
mini_batch_src_global generation:  0.01427006721496582
r_  generation:  0.15685629844665527
----------------------check_connections_block total spend ----------------------------- 0.44292330741882324
generate_one_block  0.1683638095855713
generate_one_block  0.17115116119384766
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03368020057678223
gen group dst list time:  0.00705718994140625
time for parepare:  0.021724224090576172
local_output_nid generation:  0.016425132751464844
local_in_edges_tensor generation:  0.024413108825683594
mini_batch_src_global generation:  0.0390474796295166
r_  generation:  0.4238250255584717
local_output_nid generation:  0.024906396865844727
local_in_edges_tensor generation:  0.03436899185180664
mini_batch_src_global generation:  0.049803972244262695
r_  generation:  0.4508836269378662
----------------------check_connections_block total spend ----------------------------- 1.287736177444458
generate_one_block  0.543602705001831
generate_one_block  0.549288272857666
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0228731632232666
gen group dst list time:  0.013069868087768555
time for parepare:  0.01885390281677246
local_output_nid generation:  0.021968841552734375
local_in_edges_tensor generation:  0.031162500381469727
mini_batch_src_global generation:  0.031290531158447266
r_  generation:  0.3744173049926758
local_output_nid generation:  0.030875205993652344
local_in_edges_tensor generation:  0.02925562858581543
mini_batch_src_global generation:  0.037526607513427734
r_  generation:  0.3797478675842285
----------------------check_connections_block total spend ----------------------------- 1.1186187267303467
generate_one_block  0.44809532165527344
generate_one_block  0.44878411293029785
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14678573608398438  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

connection checking time:  2.4063549041748047
block generation total time  1.9897704124450684
average batch blocks generation time:  0.9948852062225342
block dataloader generation time/epoch 5.899694740772247
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.11070489883422852  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.227489948272705  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10983896255493164  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2293510437011719  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08314359188079834 |0.013496041297912598 |0.004229068756103516 |0.0005301237106323242 |0.00377500057220459 |0.0015745162963867188 |
----------------------------------------------------------pseudo_mini_loss sum 1.3695921897888184
Total (block generation + training)time/epoch 6.215264111757278
Training time/epoch 0.3217768669128418
Training time without block to device /epoch 0.2947847843170166
Training time without total dataloading part /epoch 0.018642902374267578
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 49.73it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.22it/s]100%|██████████| 4/4 [00:00<00:00, 15.29it/s]100%|██████████| 4/4 [00:00<00:00, 15.26it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.44it/s]100%|██████████| 4/4 [00:00<00:00, 17.96it/s]100%|██████████| 4/4 [00:00<00:00, 17.86it/s]
Run 00 | Epoch 00017 | Loss 1.3696 | Train 0.3784 | Val 0.5156 | Test 0.5483
Number of nodes during this epoch:  329681
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14652538299560547  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.012844324111938477
range selection method range initialization spend 0.01199030876159668
time for parepare:  0.01670551300048828
local_output_nid generation:  0.010618448257446289
local_in_edges_tensor generation:  0.007683753967285156
mini_batch_src_global generation:  0.011137008666992188
r_  generation:  0.14553284645080566
local_output_nid generation:  0.01174616813659668
local_in_edges_tensor generation:  0.005402803421020508
mini_batch_src_global generation:  0.01420140266418457
r_  generation:  0.15696501731872559
----------------------check_connections_block total spend ----------------------------- 0.4400162696838379
generate_one_block  0.16886019706726074
generate_one_block  0.17047858238220215
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.034759521484375
gen group dst list time:  0.006754636764526367
time for parepare:  0.019867658615112305
local_output_nid generation:  0.01763916015625
local_in_edges_tensor generation:  0.02725076675415039
mini_batch_src_global generation:  0.039232730865478516
r_  generation:  0.4233975410461426
local_output_nid generation:  0.024211645126342773
local_in_edges_tensor generation:  0.027579307556152344
mini_batch_src_global generation:  0.04689812660217285
r_  generation:  0.43620824813842773
----------------------check_connections_block total spend ----------------------------- 1.2508866786956787
generate_one_block  0.5442752838134766
generate_one_block  0.542269229888916
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.017024993896484375
gen group dst list time:  0.012049674987792969
time for parepare:  0.023917436599731445
local_output_nid generation:  0.023356914520263672
local_in_edges_tensor generation:  0.028489351272583008
mini_batch_src_global generation:  0.03192472457885742
r_  generation:  0.3746936321258545
local_output_nid generation:  0.03169059753417969
local_in_edges_tensor generation:  0.026390790939331055
mini_batch_src_global generation:  0.03957962989807129
r_  generation:  0.38016271591186523
----------------------check_connections_block total spend ----------------------------- 1.1228187084197998
generate_one_block  0.45711469650268555
generate_one_block  0.457486629486084
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14652538299560547  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

connection checking time:  2.3737053871154785
block generation total time  2.001145839691162
average batch blocks generation time:  1.000572919845581
block dataloader generation time/epoch 5.893228186501397
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.11059808731079102  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.227736473083496  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10984325408935547  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2297062873840332  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0818629264831543 |0.021702289581298828 |0.0038940906524658203 |0.000494837760925293 |0.002628922462463379 |0.0013172626495361328 |
----------------------------------------------------------pseudo_mini_loss sum 1.3538997173309326
Total (block generation + training)time/epoch 6.209882047441271
Training time/epoch 0.32524633407592773
Training time without block to device /epoch 0.2818417549133301
Training time without total dataloading part /epoch 0.015352964401245117
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 51.11it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.98it/s]100%|██████████| 4/4 [00:00<00:00, 15.21it/s]100%|██████████| 4/4 [00:00<00:00, 15.16it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.90it/s]100%|██████████| 4/4 [00:00<00:00, 17.23it/s]100%|██████████| 4/4 [00:00<00:00, 17.16it/s]
Run 00 | Epoch 00018 | Loss 1.3539 | Train 0.3718 | Val 0.5078 | Test 0.5424
Number of nodes during this epoch:  329784
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14633655548095703  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021054744720458984
range selection method range initialization spend 0.012036323547363281
time for parepare:  0.01743793487548828
local_output_nid generation:  0.010782957077026367
local_in_edges_tensor generation:  0.011594772338867188
mini_batch_src_global generation:  0.011066675186157227
r_  generation:  0.14426589012145996
local_output_nid generation:  0.011988401412963867
local_in_edges_tensor generation:  0.006047725677490234
mini_batch_src_global generation:  0.014524459838867188
r_  generation:  0.15513014793395996
----------------------check_connections_block total spend ----------------------------- 0.4432070255279541
generate_one_block  0.17113113403320312
generate_one_block  0.1712665557861328
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.027678966522216797
gen group dst list time:  0.006833553314208984
time for parepare:  0.020795345306396484
local_output_nid generation:  0.016858577728271484
local_in_edges_tensor generation:  0.027964353561401367
mini_batch_src_global generation:  0.03921222686767578
r_  generation:  0.4306163787841797
local_output_nid generation:  0.023712873458862305
local_in_edges_tensor generation:  0.026814937591552734
mini_batch_src_global generation:  0.04755282402038574
r_  generation:  0.43556737899780273
----------------------check_connections_block total spend ----------------------------- 1.2578468322753906
generate_one_block  0.5390963554382324
generate_one_block  0.538902997970581
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.017449140548706055
gen group dst list time:  0.013488531112670898
time for parepare:  0.01894402503967285
local_output_nid generation:  0.02294015884399414
local_in_edges_tensor generation:  0.02849745750427246
mini_batch_src_global generation:  0.03128647804260254
r_  generation:  0.3696272373199463
local_output_nid generation:  0.03034663200378418
local_in_edges_tensor generation:  0.027586936950683594
mini_batch_src_global generation:  0.03850150108337402
r_  generation:  0.3799855709075928
----------------------check_connections_block total spend ----------------------------- 1.1103191375732422
generate_one_block  0.44727373123168945
generate_one_block  0.4524054527282715
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14633655548095703  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

connection checking time:  2.368165969848633
block generation total time  1.9776785373687744
average batch blocks generation time:  0.9888392686843872
block dataloader generation time/epoch 5.886244797706604
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.11053848266601562  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2277803421020508  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10891294479370117  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2272157669067383  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07992208003997803 |0.011863112449645996 |0.004056453704833984 |0.00052642822265625 |0.003715038299560547 |0.001483917236328125 |
----------------------------------------------------------pseudo_mini_loss sum 1.3423621654510498
Total (block generation + training)time/epoch 6.2012779951095585
Training time/epoch 0.30033349990844727
Training time without block to device /epoch 0.2766072750091553
Training time without total dataloading part /epoch 0.018079757690429688
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 59.75it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.28it/s]100%|██████████| 4/4 [00:00<00:00, 15.45it/s]100%|██████████| 4/4 [00:00<00:00, 15.40it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.31it/s]100%|██████████| 4/4 [00:00<00:00, 17.53it/s]100%|██████████| 4/4 [00:00<00:00, 17.48it/s]
Run 00 | Epoch 00019 | Loss 1.3424 | Train 0.3695 | Val 0.5037 | Test 0.5397
Number of nodes during this epoch:  329830
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1447772979736328  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.015470266342163086
range selection method range initialization spend 0.011854410171508789
time for parepare:  0.01658916473388672
local_output_nid generation:  0.01106715202331543
local_in_edges_tensor generation:  0.007872819900512695
mini_batch_src_global generation:  0.011039972305297852
r_  generation:  0.1435079574584961
local_output_nid generation:  0.011826038360595703
local_in_edges_tensor generation:  0.005417585372924805
mini_batch_src_global generation:  0.014664411544799805
r_  generation:  0.1572399139404297
----------------------check_connections_block total spend ----------------------------- 0.43918395042419434
generate_one_block  0.16678690910339355
generate_one_block  0.1705620288848877
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.026624679565429688
gen group dst list time:  0.006649971008300781
time for parepare:  0.020116567611694336
local_output_nid generation:  0.01652693748474121
local_in_edges_tensor generation:  0.02536797523498535
mini_batch_src_global generation:  0.03907370567321777
r_  generation:  0.4244863986968994
local_output_nid generation:  0.0240936279296875
local_in_edges_tensor generation:  0.023635387420654297
mini_batch_src_global generation:  0.047568321228027344
r_  generation:  0.4347269535064697
----------------------check_connections_block total spend ----------------------------- 1.2439746856689453
generate_one_block  0.5396981239318848
generate_one_block  0.5514435768127441
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.017655372619628906
gen group dst list time:  0.012041568756103516
time for parepare:  0.019092559814453125
local_output_nid generation:  0.02277851104736328
local_in_edges_tensor generation:  0.02887272834777832
mini_batch_src_global generation:  0.031108379364013672
r_  generation:  0.3712916374206543
local_output_nid generation:  0.031209230422973633
local_in_edges_tensor generation:  0.026204347610473633
mini_batch_src_global generation:  0.03769969940185547
r_  generation:  0.38279080390930176
----------------------check_connections_block total spend ----------------------------- 1.1124811172485352
generate_one_block  0.44889068603515625
generate_one_block  0.4582045078277588
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1447772979736328  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

connection checking time:  2.3564558029174805
block generation total time  1.998236894607544
average batch blocks generation time:  0.999118447303772
block dataloader generation time/epoch 5.8776914206418125
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10997915267944336  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2297959327697754  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.11128902435302734  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2283048629760742  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08019042015075684 |0.01393580436706543 |0.003962516784667969 |0.0005245208740234375 |0.003590226173400879 |0.001359701156616211 |
----------------------------------------------------------pseudo_mini_loss sum 1.3235609531402588
Total (block generation + training)time/epoch 6.192262541164052
Training time/epoch 0.30987071990966797
Training time without block to device /epoch 0.2819991111755371
Training time without total dataloading part /epoch 0.01751422882080078
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.71it/s]100%|██████████| 4/4 [00:00<00:00, 28.56it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.84it/s]100%|██████████| 4/4 [00:00<00:00, 13.17it/s]100%|██████████| 4/4 [00:00<00:00, 12.94it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.08it/s]100%|██████████| 4/4 [00:00<00:00, 18.51it/s]100%|██████████| 4/4 [00:00<00:00, 18.42it/s]
Run 00 | Epoch 00020 | Loss 1.3236 | Train 0.3724 | Val 0.5060 | Test 0.5404
Number of nodes during this epoch:  329839
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14647960662841797  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.014712810516357422
range selection method range initialization spend 0.013319253921508789
time for parepare:  0.016300439834594727
local_output_nid generation:  0.0104827880859375
local_in_edges_tensor generation:  0.007648944854736328
mini_batch_src_global generation:  0.011193513870239258
r_  generation:  0.15281438827514648
local_output_nid generation:  0.011796951293945312
local_in_edges_tensor generation:  0.007988214492797852
mini_batch_src_global generation:  0.015109062194824219
r_  generation:  0.1682882308959961
----------------------check_connections_block total spend ----------------------------- 0.46393537521362305
generate_one_block  0.1699085235595703
generate_one_block  0.171494722366333
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030734777450561523
gen group dst list time:  0.006607770919799805
time for parepare:  0.019695520401000977
local_output_nid generation:  0.016608476638793945
local_in_edges_tensor generation:  0.036063194274902344
mini_batch_src_global generation:  0.04134035110473633
r_  generation:  0.4355781078338623
local_output_nid generation:  0.024159908294677734
local_in_edges_tensor generation:  0.031625986099243164
mini_batch_src_global generation:  0.05081486701965332
r_  generation:  0.43855834007263184
----------------------check_connections_block total spend ----------------------------- 1.282721996307373
generate_one_block  0.5483608245849609
generate_one_block  0.5508744716644287
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.022098541259765625
gen group dst list time:  0.013091802597045898
time for parepare:  0.020255565643310547
local_output_nid generation:  0.023040294647216797
local_in_edges_tensor generation:  0.03395652770996094
mini_batch_src_global generation:  0.031332969665527344
r_  generation:  0.3728926181793213
local_output_nid generation:  0.03328061103820801
local_in_edges_tensor generation:  0.031240463256835938
mini_batch_src_global generation:  0.03778386116027832
r_  generation:  0.4040853977203369
----------------------check_connections_block total spend ----------------------------- 1.1558141708374023
generate_one_block  0.45902371406555176
generate_one_block  0.4579615592956543
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14647960662841797  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

connection checking time:  2.4385361671447754
block generation total time  2.0162205696105957
average batch blocks generation time:  1.0081102848052979
block dataloader generation time/epoch 5.885615348815918
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10905313491821289  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.22723388671875  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10979938507080078  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2275018692016602  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07886135578155518 |0.020999789237976074 |0.0041501522064208984 |0.0004998445510864258 |0.003992557525634766 |0.0029153823852539062 |
----------------------------------------------------------pseudo_mini_loss sum 1.3058257102966309
Total (block generation + training)time/epoch 6.200360635916392
Training time/epoch 0.3165125846862793
Training time without block to device /epoch 0.27451300621032715
Training time without total dataloading part /epoch 0.020200490951538086
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.17it/s]100%|██████████| 4/4 [00:00<00:00, 30.54it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 12.52it/s]100%|██████████| 4/4 [00:00<00:00, 13.29it/s]100%|██████████| 4/4 [00:00<00:00, 13.15it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.63it/s]100%|██████████| 4/4 [00:00<00:00, 19.30it/s]100%|██████████| 4/4 [00:00<00:00, 19.17it/s]
Run 00 | Epoch 00021 | Loss 1.3058 | Train 0.3773 | Val 0.5095 | Test 0.5417
Number of nodes during this epoch:  329835
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14576292037963867  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.015285730361938477
range selection method range initialization spend 0.015640974044799805
time for parepare:  0.016386985778808594
local_output_nid generation:  0.010698795318603516
local_in_edges_tensor generation:  0.02077627182006836
mini_batch_src_global generation:  0.012510538101196289
r_  generation:  0.152390718460083
local_output_nid generation:  0.01369786262512207
local_in_edges_tensor generation:  0.006334781646728516
mini_batch_src_global generation:  0.014089584350585938
r_  generation:  0.1632556915283203
----------------------check_connections_block total spend ----------------------------- 0.47254371643066406
generate_one_block  0.18549823760986328
generate_one_block  0.17216157913208008
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.026090383529663086
gen group dst list time:  0.006798505783081055
time for parepare:  0.019968271255493164
local_output_nid generation:  0.017195940017700195
local_in_edges_tensor generation:  0.03307652473449707
mini_batch_src_global generation:  0.03982067108154297
r_  generation:  0.42922329902648926
local_output_nid generation:  0.024045944213867188
local_in_edges_tensor generation:  0.03040289878845215
mini_batch_src_global generation:  0.047782182693481445
r_  generation:  0.4431920051574707
----------------------check_connections_block total spend ----------------------------- 1.2749202251434326
generate_one_block  0.557288646697998
generate_one_block  0.559302806854248
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01994800567626953
gen group dst list time:  0.015898704528808594
time for parepare:  0.020220518112182617
local_output_nid generation:  0.023218154907226562
local_in_edges_tensor generation:  0.03638339042663574
mini_batch_src_global generation:  0.031136035919189453
r_  generation:  0.3837149143218994
local_output_nid generation:  0.032601118087768555
local_in_edges_tensor generation:  0.03299260139465332
mini_batch_src_global generation:  0.038002729415893555
r_  generation:  0.38227176666259766
----------------------check_connections_block total spend ----------------------------- 1.1438102722167969
generate_one_block  0.4703249931335449
generate_one_block  0.4645199775695801
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14576292037963867  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

connection checking time:  2.4187304973602295
block generation total time  2.051436424255371
average batch blocks generation time:  1.0257182121276855
block dataloader generation time/epoch 5.901049302174495
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10905742645263672  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2282323837280273  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10980796813964844  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2286648750305176  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0809856653213501 |0.017870783805847168 |0.004242420196533203 |0.0005242824554443359 |0.0038601160049438477 |0.0036859512329101562 |
----------------------------------------------------------pseudo_mini_loss sum 1.2933449745178223
Total (block generation + training)time/epoch 6.21569327207712
Training time/epoch 0.3132517337799072
Training time without block to device /epoch 0.2775101661682129
Training time without total dataloading part /epoch 0.02093958854675293
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.23it/s]100%|██████████| 4/4 [00:00<00:00, 29.69it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.87it/s]100%|██████████| 4/4 [00:00<00:00, 13.10it/s]100%|██████████| 4/4 [00:00<00:00, 12.89it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.00it/s]100%|██████████| 4/4 [00:00<00:00, 19.52it/s]
Run 00 | Epoch 00022 | Loss 1.2933 | Train 0.3830 | Val 0.5124 | Test 0.5443
Number of nodes during this epoch:  329782
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14638805389404297  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.015228033065795898
range selection method range initialization spend 0.012106180191040039
time for parepare:  0.01651787757873535
local_output_nid generation:  0.010639429092407227
local_in_edges_tensor generation:  0.00969839096069336
mini_batch_src_global generation:  0.011483907699584961
r_  generation:  0.1450943946838379
local_output_nid generation:  0.011673212051391602
local_in_edges_tensor generation:  0.0053730010986328125
mini_batch_src_global generation:  0.014797210693359375
r_  generation:  0.15612363815307617
----------------------check_connections_block total spend ----------------------------- 0.4419536590576172
generate_one_block  0.16711211204528809
generate_one_block  0.16918230056762695
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02917027473449707
gen group dst list time:  0.006786823272705078
time for parepare:  0.020171642303466797
local_output_nid generation:  0.01825118064880371
local_in_edges_tensor generation:  0.026378870010375977
mini_batch_src_global generation:  0.038753509521484375
r_  generation:  0.4295003414154053
local_output_nid generation:  0.024888038635253906
local_in_edges_tensor generation:  0.02550673484802246
mini_batch_src_global generation:  0.05031013488769531
r_  generation:  0.43618083000183105
----------------------check_connections_block total spend ----------------------------- 1.2567598819732666
generate_one_block  0.5438797473907471
generate_one_block  0.5459451675415039
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.018093585968017578
gen group dst list time:  0.012063980102539062
time for parepare:  0.01937103271484375
local_output_nid generation:  0.02536463737487793
local_in_edges_tensor generation:  0.028150558471679688
mini_batch_src_global generation:  0.031009674072265625
r_  generation:  0.37519216537475586
local_output_nid generation:  0.035980939865112305
local_in_edges_tensor generation:  0.027772188186645508
mini_batch_src_global generation:  0.039629459381103516
r_  generation:  0.3999166488647461
----------------------check_connections_block total spend ----------------------------- 1.1541354656219482
generate_one_block  0.46146607398986816
generate_one_block  0.4718184471130371
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14638805389404297  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

connection checking time:  2.410895347595215
block generation total time  2.0231094360351562
average batch blocks generation time:  1.0115547180175781
block dataloader generation time/epoch 5.902277759143284
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10906696319580078  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2278785705566406  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10981225967407227  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2283825874328613  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0826345682144165 |0.018056273460388184 |0.004221677780151367 |0.0005203485488891602 |0.002594470977783203 |0.0016021728515625 |
----------------------------------------------------------pseudo_mini_loss sum 1.277472972869873
Total (block generation + training)time/epoch 6.216956155640738
Training time/epoch 0.31498003005981445
Training time without block to device /epoch 0.2788674831390381
Training time without total dataloading part /epoch 0.01627516746520996
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.04it/s]100%|██████████| 4/4 [00:00<00:00, 29.01it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.70it/s]100%|██████████| 4/4 [00:00<00:00, 12.98it/s]100%|██████████| 4/4 [00:00<00:00, 12.76it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.14it/s]100%|██████████| 4/4 [00:00<00:00, 18.30it/s]100%|██████████| 4/4 [00:00<00:00, 18.26it/s]
Run 00 | Epoch 00023 | Loss 1.2775 | Train 0.3894 | Val 0.5165 | Test 0.5464
Number of nodes during this epoch:  329758
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14546775817871094  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.015897512435913086
range selection method range initialization spend 0.011888504028320312
time for parepare:  0.01710820198059082
local_output_nid generation:  0.01076364517211914
local_in_edges_tensor generation:  0.008625984191894531
mini_batch_src_global generation:  0.011111021041870117
r_  generation:  0.14730191230773926
local_output_nid generation:  0.011895895004272461
local_in_edges_tensor generation:  0.005414009094238281
mini_batch_src_global generation:  0.014304399490356445
r_  generation:  0.15603208541870117
----------------------check_connections_block total spend ----------------------------- 0.4425652027130127
generate_one_block  0.16734623908996582
generate_one_block  0.16971063613891602
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.027657270431518555
gen group dst list time:  0.0066759586334228516
time for parepare:  0.020115137100219727
local_output_nid generation:  0.016921043395996094
local_in_edges_tensor generation:  0.03343462944030762
mini_batch_src_global generation:  0.038613319396972656
r_  generation:  0.4368896484375
local_output_nid generation:  0.024449825286865234
local_in_edges_tensor generation:  0.026006221771240234
mini_batch_src_global generation:  0.05076122283935547
r_  generation:  0.4418778419494629
----------------------check_connections_block total spend ----------------------------- 1.278148889541626
generate_one_block  0.5674712657928467
generate_one_block  0.5487680435180664
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0224764347076416
gen group dst list time:  0.013987064361572266
time for parepare:  0.018733978271484375
local_output_nid generation:  0.0223236083984375
local_in_edges_tensor generation:  0.03901076316833496
mini_batch_src_global generation:  0.032853126525878906
r_  generation:  0.3811910152435303
local_output_nid generation:  0.03054523468017578
local_in_edges_tensor generation:  0.02671027183532715
mini_batch_src_global generation:  0.03905034065246582
r_  generation:  0.37885093688964844
----------------------check_connections_block total spend ----------------------------- 1.1338047981262207
generate_one_block  0.45500731468200684
generate_one_block  0.4541773796081543
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14546775817871094  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

connection checking time:  2.4119536876678467
block generation total time  2.025424003601074
average batch blocks generation time:  1.012712001800537
block dataloader generation time/epoch 5.903988949457804
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10905170440673828  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2276577949523926  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10984992980957031  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2283029556274414  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08354413509368896 |0.013011574745178223 |0.004229426383972168 |0.0005179643630981445 |0.0034028291702270508 |0.0024242401123046875 |
----------------------------------------------------------pseudo_mini_loss sum 1.2630113363265991
Total (block generation + training)time/epoch 6.218152729670207
Training time/epoch 0.30681777000427246
Training time without block to device /epoch 0.280794620513916
Training time without total dataloading part /epoch 0.018724679946899414
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 51.17it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.89it/s]100%|██████████| 4/4 [00:00<00:00, 15.52it/s]100%|██████████| 4/4 [00:00<00:00, 15.40it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.80it/s]100%|██████████| 4/4 [00:00<00:00, 17.79it/s]100%|██████████| 4/4 [00:00<00:00, 17.77it/s]
Run 00 | Epoch 00024 | Loss 1.2630 | Train 0.3963 | Val 0.5198 | Test 0.5478
Number of nodes during this epoch:  329878
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14670515060424805  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.012941360473632812
range selection method range initialization spend 0.012145519256591797
time for parepare:  0.01650238037109375
local_output_nid generation:  0.010582685470581055
local_in_edges_tensor generation:  0.007988691329956055
mini_batch_src_global generation:  0.011037349700927734
r_  generation:  0.14453601837158203
local_output_nid generation:  0.011614799499511719
local_in_edges_tensor generation:  0.005450725555419922
mini_batch_src_global generation:  0.014203071594238281
r_  generation:  0.1644132137298584
----------------------check_connections_block total spend ----------------------------- 0.4468374252319336
generate_one_block  0.17643165588378906
generate_one_block  0.17749643325805664
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02569890022277832
gen group dst list time:  0.00656890869140625
time for parepare:  0.019913434982299805
local_output_nid generation:  0.018209218978881836
local_in_edges_tensor generation:  0.028131723403930664
mini_batch_src_global generation:  0.03898358345031738
r_  generation:  0.4323582649230957
local_output_nid generation:  0.02472829818725586
local_in_edges_tensor generation:  0.025141239166259766
mini_batch_src_global generation:  0.047568321228027344
r_  generation:  0.4563882350921631
----------------------check_connections_block total spend ----------------------------- 1.286576271057129
generate_one_block  0.5897524356842041
generate_one_block  0.5603635311126709
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028224468231201172
gen group dst list time:  0.014431953430175781
time for parepare:  0.01967310905456543
local_output_nid generation:  0.023847341537475586
local_in_edges_tensor generation:  0.04079794883728027
mini_batch_src_global generation:  0.031381845474243164
r_  generation:  0.37819957733154297
local_output_nid generation:  0.03229117393493652
local_in_edges_tensor generation:  0.03101372718811035
mini_batch_src_global generation:  0.03726649284362793
r_  generation:  0.3874812126159668
----------------------check_connections_block total spend ----------------------------- 1.1480352878570557
generate_one_block  0.4631474018096924
generate_one_block  0.4756653308868408
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14670515060424805  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

connection checking time:  2.4346115589141846
block generation total time  2.088928699493408
average batch blocks generation time:  1.044464349746704
block dataloader generation time/epoch 5.911301895976067
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1090550422668457  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2269878387451172  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10981559753417969  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2292537689208984  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09723758697509766 |0.021493196487426758 |0.00438237190246582 |0.0004966259002685547 |0.0024193525314331055 |0.0017807483673095703 |
----------------------------------------------------------pseudo_mini_loss sum 1.2571251392364502
Total (block generation + training)time/epoch 6.22782301902771
Training time/epoch 0.3517458438873291
Training time without block to device /epoch 0.3087594509124756
Training time without total dataloading part /epoch 0.01637744903564453
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 52.87it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.77it/s]100%|██████████| 4/4 [00:00<00:00, 15.48it/s]100%|██████████| 4/4 [00:00<00:00, 15.35it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.59it/s]100%|██████████| 4/4 [00:00<00:00, 17.84it/s]100%|██████████| 4/4 [00:00<00:00, 17.78it/s]
Run 00 | Epoch 00025 | Loss 1.2571 | Train 0.4030 | Val 0.5216 | Test 0.5486
Number of nodes during this epoch:  329791
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14668655395507812  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.016406774520874023
range selection method range initialization spend 0.012297630310058594
time for parepare:  0.016585350036621094
local_output_nid generation:  0.010628700256347656
local_in_edges_tensor generation:  0.010863780975341797
mini_batch_src_global generation:  0.011157989501953125
r_  generation:  0.14394330978393555
local_output_nid generation:  0.011749982833862305
local_in_edges_tensor generation:  0.005940437316894531
mini_batch_src_global generation:  0.014258384704589844
r_  generation:  0.15502452850341797
----------------------check_connections_block total spend ----------------------------- 0.4405848979949951
generate_one_block  0.1667788028717041
generate_one_block  0.16941237449645996
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028340578079223633
gen group dst list time:  0.006834745407104492
time for parepare:  0.01988840103149414
local_output_nid generation:  0.016903162002563477
local_in_edges_tensor generation:  0.03036046028137207
mini_batch_src_global generation:  0.04448533058166504
r_  generation:  0.4367532730102539
local_output_nid generation:  0.02431011199951172
local_in_edges_tensor generation:  0.024322509765625
mini_batch_src_global generation:  0.04698896408081055
r_  generation:  0.43700098991394043
----------------------check_connections_block total spend ----------------------------- 1.2703683376312256
generate_one_block  0.5499675273895264
generate_one_block  0.5409166812896729
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.021929264068603516
gen group dst list time:  0.014481782913208008
time for parepare:  0.01949763298034668
local_output_nid generation:  0.024442195892333984
local_in_edges_tensor generation:  0.03131866455078125
mini_batch_src_global generation:  0.03317832946777344
r_  generation:  0.37619829177856445
local_output_nid generation:  0.03191685676574707
local_in_edges_tensor generation:  0.02746725082397461
mini_batch_src_global generation:  0.041687965393066406
r_  generation:  0.38403749465942383
----------------------check_connections_block total spend ----------------------------- 1.1342356204986572
generate_one_block  0.4676506519317627
generate_one_block  0.4661867618560791
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14668655395507812  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

connection checking time:  2.404603958129883
block generation total time  2.024721622467041
average batch blocks generation time:  1.0123608112335205
block dataloader generation time/epoch 5.912709488588221
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.11068534851074219  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2300705909729004  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10882377624511719  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.225998878479004  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08376824855804443 |0.019537687301635742 |0.004328250885009766 |0.0005227327346801758 |0.00256955623626709 |0.0016663074493408203 |
----------------------------------------------------------pseudo_mini_loss sum 1.2391232252120972
Total (block generation + training)time/epoch 6.229551904341754
Training time/epoch 0.3218097686767578
Training time without block to device /epoch 0.28273439407348633
Training time without total dataloading part /epoch 0.016507387161254883
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 47.19it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.49it/s]100%|██████████| 4/4 [00:00<00:00, 15.43it/s]100%|██████████| 4/4 [00:00<00:00, 15.42it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.93it/s]100%|██████████| 4/4 [00:00<00:00, 17.33it/s]100%|██████████| 4/4 [00:00<00:00, 17.25it/s]
Run 00 | Epoch 00026 | Loss 1.2391 | Train 0.4099 | Val 0.5212 | Test 0.5468
Number of nodes during this epoch:  329813
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14368486404418945  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.014001131057739258
range selection method range initialization spend 0.013978958129882812
time for parepare:  0.016231298446655273
local_output_nid generation:  0.010843515396118164
local_in_edges_tensor generation:  0.011239051818847656
mini_batch_src_global generation:  0.01155710220336914
r_  generation:  0.14677739143371582
local_output_nid generation:  0.011701822280883789
local_in_edges_tensor generation:  0.006134033203125
mini_batch_src_global generation:  0.01461029052734375
r_  generation:  0.1560361385345459
----------------------check_connections_block total spend ----------------------------- 0.445237398147583
generate_one_block  0.16721129417419434
generate_one_block  0.16945314407348633
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.026312828063964844
gen group dst list time:  0.006661891937255859
time for parepare:  0.019716501235961914
local_output_nid generation:  0.01729416847229004
local_in_edges_tensor generation:  0.0310976505279541
mini_batch_src_global generation:  0.03884077072143555
r_  generation:  0.42566347122192383
local_output_nid generation:  0.02452707290649414
local_in_edges_tensor generation:  0.03154778480529785
mini_batch_src_global generation:  0.04760932922363281
r_  generation:  0.44211697578430176
----------------------check_connections_block total spend ----------------------------- 1.2667641639709473
generate_one_block  0.5533437728881836
generate_one_block  0.5664167404174805
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.022713184356689453
gen group dst list time:  0.014161348342895508
time for parepare:  0.02089548110961914
local_output_nid generation:  0.023720264434814453
local_in_edges_tensor generation:  0.039825439453125
mini_batch_src_global generation:  0.03603792190551758
r_  generation:  0.37279582023620605
local_output_nid generation:  0.03156781196594238
local_in_edges_tensor generation:  0.03271293640136719
mini_batch_src_global generation:  0.03899836540222168
r_  generation:  0.39444637298583984
----------------------check_connections_block total spend ----------------------------- 1.1561262607574463
generate_one_block  0.4627499580383301
generate_one_block  0.45896005630493164
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14368486404418945  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

connection checking time:  2.4228904247283936
block generation total time  2.041470527648926
average batch blocks generation time:  1.020735263824463
block dataloader generation time/epoch 5.915432612101237
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10973787307739258  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2279987335205078  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1098947525024414  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2315335273742676  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08779513835906982 |0.020066261291503906 |0.004162907600402832 |0.000512242317199707 |0.0038753747940063477 |0.0013871192932128906 |
----------------------------------------------------------pseudo_mini_loss sum 1.2307965755462646
Total (block generation + training)time/epoch 6.233001722229852
Training time/epoch 0.3297758102416992
Training time without block to device /epoch 0.2896432876586914
Training time without total dataloading part /epoch 0.018488168716430664
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.29it/s]100%|██████████| 4/4 [00:00<00:00, 29.89it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.81it/s]100%|██████████| 4/4 [00:00<00:00, 12.97it/s]100%|██████████| 4/4 [00:00<00:00, 12.77it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.33it/s]100%|██████████| 4/4 [00:00<00:00, 18.06it/s]100%|██████████| 4/4 [00:00<00:00, 17.92it/s]
Run 00 | Epoch 00027 | Loss 1.2308 | Train 0.4172 | Val 0.5210 | Test 0.5426
Number of nodes during this epoch:  329954
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14654159545898438  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01572394371032715
range selection method range initialization spend 0.012183666229248047
time for parepare:  0.017956972122192383
local_output_nid generation:  0.010579347610473633
local_in_edges_tensor generation:  0.007818222045898438
mini_batch_src_global generation:  0.011121749877929688
r_  generation:  0.17536664009094238
local_output_nid generation:  0.011627197265625
local_in_edges_tensor generation:  0.0053861141204833984
mini_batch_src_global generation:  0.014711380004882812
r_  generation:  0.1830730438232422
----------------------check_connections_block total spend ----------------------------- 0.5019466876983643
generate_one_block  0.18746089935302734
generate_one_block  0.17091727256774902
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03152608871459961
gen group dst list time:  0.00670933723449707
time for parepare:  0.021393537521362305
local_output_nid generation:  0.01735711097717285
local_in_edges_tensor generation:  0.027829647064208984
mini_batch_src_global generation:  0.04122734069824219
r_  generation:  0.4455704689025879
local_output_nid generation:  0.027295827865600586
local_in_edges_tensor generation:  0.031774044036865234
mini_batch_src_global generation:  0.048063039779663086
r_  generation:  0.4363362789154053
----------------------check_connections_block total spend ----------------------------- 1.2861645221710205
generate_one_block  0.5505976676940918
generate_one_block  0.5430448055267334
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.019109249114990234
gen group dst list time:  0.012081384658813477
time for parepare:  0.019415616989135742
local_output_nid generation:  0.023273229598999023
local_in_edges_tensor generation:  0.03490567207336426
mini_batch_src_global generation:  0.032135963439941406
r_  generation:  0.3714330196380615
local_output_nid generation:  0.031156539916992188
local_in_edges_tensor generation:  0.027029752731323242
mini_batch_src_global generation:  0.037751197814941406
r_  generation:  0.38405466079711914
----------------------check_connections_block total spend ----------------------------- 1.1263749599456787
generate_one_block  0.4591836929321289
generate_one_block  0.47022485733032227
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14654159545898438  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

connection checking time:  2.412539482116699
block generation total time  2.0230510234832764
average batch blocks generation time:  1.0115255117416382
block dataloader generation time/epoch 5.920652226397865
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10907697677612305  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2313385009765625  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10979318618774414  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2282910346984863  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04687678813934326 |0.02052760124206543 |0.004147768020629883 |0.0004947185516357422 |0.03973269462585449 |0.0019083023071289062 |
----------------------------------------------------------pseudo_mini_loss sum 1.2226495742797852
Total (block generation + training)time/epoch 6.2391739644502335
Training time/epoch 0.33550238609313965
Training time without block to device /epoch 0.2944471836090088
Training time without total dataloading part /epoch 0.09065866470336914
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 48.27it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.22it/s]100%|██████████| 4/4 [00:00<00:00, 15.62it/s]100%|██████████| 4/4 [00:00<00:00, 15.55it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.36it/s]100%|██████████| 4/4 [00:00<00:00, 17.92it/s]100%|██████████| 4/4 [00:00<00:00, 17.81it/s]
Run 00 | Epoch 00028 | Loss 1.2226 | Train 0.4213 | Val 0.5193 | Test 0.5369
Number of nodes during this epoch:  329932
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14545059204101562  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.014749288558959961
range selection method range initialization spend 0.011747121810913086
time for parepare:  0.01653313636779785
local_output_nid generation:  0.010782957077026367
local_in_edges_tensor generation:  0.013090848922729492
mini_batch_src_global generation:  0.011379241943359375
r_  generation:  0.14540553092956543
local_output_nid generation:  0.011821269989013672
local_in_edges_tensor generation:  0.005404233932495117
mini_batch_src_global generation:  0.0143890380859375
r_  generation:  0.1571059226989746
----------------------check_connections_block total spend ----------------------------- 0.446793794631958
generate_one_block  0.16767454147338867
generate_one_block  0.1703963279724121
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029642581939697266
gen group dst list time:  0.00648188591003418
time for parepare:  0.01981973648071289
local_output_nid generation:  0.01655101776123047
local_in_edges_tensor generation:  0.0319211483001709
mini_batch_src_global generation:  0.038836002349853516
r_  generation:  0.42642855644226074
local_output_nid generation:  0.024153947830200195
local_in_edges_tensor generation:  0.025597572326660156
mini_batch_src_global generation:  0.05072331428527832
r_  generation:  0.44010376930236816
----------------------check_connections_block total spend ----------------------------- 1.2615768909454346
generate_one_block  0.5478103160858154
generate_one_block  0.5401651859283447
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01999640464782715
gen group dst list time:  0.011950492858886719
time for parepare:  0.018828392028808594
local_output_nid generation:  0.02244734764099121
local_in_edges_tensor generation:  0.02874922752380371
mini_batch_src_global generation:  0.030770301818847656
r_  generation:  0.37107038497924805
local_output_nid generation:  0.031598567962646484
local_in_edges_tensor generation:  0.027258634567260742
mini_batch_src_global generation:  0.03801774978637695
r_  generation:  0.37833333015441895
----------------------check_connections_block total spend ----------------------------- 1.11140775680542
generate_one_block  0.4494814872741699
generate_one_block  0.4486062526702881
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14545059204101562  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

connection checking time:  2.3729846477508545
block generation total time  1.9860632419586182
average batch blocks generation time:  0.9930316209793091
block dataloader generation time/epoch 5.916889572143555
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10906410217285156  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2281932830810547  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10978555679321289  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2288470268249512  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07737135887145996 |0.01169741153717041 |0.004083514213562012 |0.0005363225936889648 |0.003754138946533203 |0.0014472007751464844 |
----------------------------------------------------------pseudo_mini_loss sum 1.2082104682922363
Total (block generation + training)time/epoch 6.234492015838623
Training time/epoch 0.30004405975341797
Training time without block to device /epoch 0.27664923667907715
Training time without total dataloading part /epoch 0.018195152282714844
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 68.74it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.12it/s]100%|██████████| 4/4 [00:00<00:00, 15.91it/s]100%|██████████| 4/4 [00:00<00:00, 15.92it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.31it/s]100%|██████████| 4/4 [00:00<00:00, 17.49it/s]100%|██████████| 4/4 [00:00<00:00, 17.44it/s]
Run 00 | Epoch 00029 | Loss 1.2082 | Train 0.4209 | Val 0.5162 | Test 0.5314
Number of nodes during this epoch:  329781
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14649248123168945  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.016930818557739258
range selection method range initialization spend 0.012352705001831055
time for parepare:  0.0164945125579834
local_output_nid generation:  0.013178586959838867
local_in_edges_tensor generation:  0.01006460189819336
mini_batch_src_global generation:  0.011136770248413086
r_  generation:  0.14626741409301758
local_output_nid generation:  0.013488292694091797
local_in_edges_tensor generation:  0.006925821304321289
mini_batch_src_global generation:  0.01472020149230957
r_  generation:  0.15737414360046387
----------------------check_connections_block total spend ----------------------------- 0.4519169330596924
generate_one_block  0.17449378967285156
generate_one_block  0.1705336570739746
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02844977378845215
gen group dst list time:  0.006450176239013672
time for parepare:  0.021110057830810547
local_output_nid generation:  0.01678919792175293
local_in_edges_tensor generation:  0.03583526611328125
mini_batch_src_global generation:  0.03957939147949219
r_  generation:  0.4278686046600342
local_output_nid generation:  0.023957252502441406
local_in_edges_tensor generation:  0.028385639190673828
mini_batch_src_global generation:  0.04769492149353027
r_  generation:  0.43869543075561523
----------------------check_connections_block total spend ----------------------------- 1.2682435512542725
generate_one_block  0.5381326675415039
generate_one_block  0.5493988990783691
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02054572105407715
gen group dst list time:  0.01308298110961914
time for parepare:  0.02026653289794922
local_output_nid generation:  0.022948265075683594
local_in_edges_tensor generation:  0.03458428382873535
mini_batch_src_global generation:  0.03148150444030762
r_  generation:  0.3889164924621582
local_output_nid generation:  0.03503894805908203
local_in_edges_tensor generation:  0.03626871109008789
mini_batch_src_global generation:  0.038373708724975586
r_  generation:  0.37955141067504883
----------------------check_connections_block total spend ----------------------------- 1.158036470413208
generate_one_block  0.45464086532592773
generate_one_block  0.464888334274292
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14649248123168945  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

connection checking time:  2.4262800216674805
block generation total time  2.0070607662200928
average batch blocks generation time:  1.0035303831100464
block dataloader generation time/epoch 5.917881670452299
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1106419563293457  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2289247512817383  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1089019775390625  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2267112731933594  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08088576793670654 |0.017890572547912598 |0.004240632057189941 |0.0005164146423339844 |0.0029354095458984375 |0.0018324851989746094 |
----------------------------------------------------------pseudo_mini_loss sum 1.1990461349487305
Total (block generation + training)time/epoch 6.235274996076312
Training time/epoch 0.313068151473999
Training time without block to device /epoch 0.27728700637817383
Training time without total dataloading part /epoch 0.017217397689819336
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 55.41it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.01it/s]100%|██████████| 4/4 [00:00<00:00, 15.39it/s]100%|██████████| 4/4 [00:00<00:00, 15.32it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.33it/s]100%|██████████| 4/4 [00:00<00:00, 17.68it/s]100%|██████████| 4/4 [00:00<00:00, 17.61it/s]
Run 00 | Epoch 00030 | Loss 1.1990 | Train 0.4191 | Val 0.5140 | Test 0.5266
Number of nodes during this epoch:  329821
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1455821990966797  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.014731168746948242
range selection method range initialization spend 0.01214742660522461
time for parepare:  0.016646146774291992
local_output_nid generation:  0.010637998580932617
local_in_edges_tensor generation:  0.01064610481262207
mini_batch_src_global generation:  0.011049985885620117
r_  generation:  0.14852023124694824
local_output_nid generation:  0.011706113815307617
local_in_edges_tensor generation:  0.005522012710571289
mini_batch_src_global generation:  0.014304161071777344
r_  generation:  0.15747618675231934
----------------------check_connections_block total spend ----------------------------- 0.44676661491394043
generate_one_block  0.1677234172821045
generate_one_block  0.17084479331970215
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.027904033660888672
gen group dst list time:  0.006470203399658203
time for parepare:  0.02005600929260254
local_output_nid generation:  0.01716780662536621
local_in_edges_tensor generation:  0.032604217529296875
mini_batch_src_global generation:  0.039032697677612305
r_  generation:  0.4337735176086426
local_output_nid generation:  0.024502992630004883
local_in_edges_tensor generation:  0.02438521385192871
mini_batch_src_global generation:  0.04758715629577637
r_  generation:  0.4410214424133301
----------------------check_connections_block total spend ----------------------------- 1.268824577331543
generate_one_block  0.5464065074920654
generate_one_block  0.5453798770904541
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01998615264892578
gen group dst list time:  0.012729644775390625
time for parepare:  0.018738746643066406
local_output_nid generation:  0.02206707000732422
local_in_edges_tensor generation:  0.030559778213500977
mini_batch_src_global generation:  0.0315394401550293
r_  generation:  0.383709192276001
local_output_nid generation:  0.03221583366394043
local_in_edges_tensor generation:  0.033860206604003906
mini_batch_src_global generation:  0.04307246208190918
r_  generation:  0.3958873748779297
----------------------check_connections_block total spend ----------------------------- 1.1622660160064697
generate_one_block  0.4532184600830078
generate_one_block  0.45501017570495605
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1455821990966797  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

connection checking time:  2.4310905933380127
block generation total time  2.0000150203704834
average batch blocks generation time:  1.0000075101852417
block dataloader generation time/epoch 5.917583552273837
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10979413986206055  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2281346321105957  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10982179641723633  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2279424667358398  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08984494209289551 |0.019050240516662598 |0.003988027572631836 |0.0004949569702148438 |0.003215789794921875 |0.0028085708618164062 |
----------------------------------------------------------pseudo_mini_loss sum 1.19126296043396
Total (block generation + training)time/epoch 6.235786958174272
Training time/epoch 0.33507490158081055
Training time without block to device /epoch 0.29697442054748535
Training time without total dataloading part /epoch 0.018206119537353516
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 51.33it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.55it/s]100%|██████████| 4/4 [00:00<00:00, 15.65it/s]100%|██████████| 4/4 [00:00<00:00, 15.62it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.77it/s]100%|██████████| 4/4 [00:00<00:00, 17.66it/s]100%|██████████| 4/4 [00:00<00:00, 17.66it/s]
Run 00 | Epoch 00031 | Loss 1.1913 | Train 0.4191 | Val 0.5142 | Test 0.5241
Number of nodes during this epoch:  329744
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14583063125610352  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.014368772506713867
range selection method range initialization spend 0.011910676956176758
time for parepare:  0.016406774520874023
local_output_nid generation:  0.010576486587524414
local_in_edges_tensor generation:  0.01126718521118164
mini_batch_src_global generation:  0.011208772659301758
r_  generation:  0.1472635269165039
local_output_nid generation:  0.011627912521362305
local_in_edges_tensor generation:  0.0059583187103271484
mini_batch_src_global generation:  0.014154672622680664
r_  generation:  0.15587162971496582
----------------------check_connections_block total spend ----------------------------- 0.4440500736236572
generate_one_block  0.1676619052886963
generate_one_block  0.16869425773620605
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02662372589111328
gen group dst list time:  0.006564140319824219
time for parepare:  0.019712448120117188
local_output_nid generation:  0.017071247100830078
local_in_edges_tensor generation:  0.02952289581298828
mini_batch_src_global generation:  0.040398597717285156
r_  generation:  0.43265819549560547
local_output_nid generation:  0.024669170379638672
local_in_edges_tensor generation:  0.027701616287231445
mini_batch_src_global generation:  0.047815561294555664
r_  generation:  0.47460222244262695
----------------------check_connections_block total spend ----------------------------- 1.3056132793426514
generate_one_block  0.5659065246582031
generate_one_block  0.5721762180328369
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.024323701858520508
gen group dst list time:  0.014165163040161133
time for parepare:  0.020134925842285156
local_output_nid generation:  0.023133039474487305
local_in_edges_tensor generation:  0.042138099670410156
mini_batch_src_global generation:  0.03278708457946777
r_  generation:  0.37903475761413574
local_output_nid generation:  0.03224921226501465
local_in_edges_tensor generation:  0.029155731201171875
mini_batch_src_global generation:  0.03785848617553711
r_  generation:  0.3826110363006592
----------------------check_connections_block total spend ----------------------------- 1.1566808223724365
generate_one_block  0.46065306663513184
generate_one_block  0.4640200138092041
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14583063125610352  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

connection checking time:  2.462294101715088
block generation total time  2.062755823135376
average batch blocks generation time:  1.031377911567688
block dataloader generation time/epoch 5.916856071223384
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1091156005859375  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.228989601135254  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10882568359375  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2276768684387207  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08217453956604004 |0.01994311809539795 |0.004075288772583008 |0.04272174835205078 |0.003718256950378418 |0.001413106918334961 |
----------------------------------------------------------pseudo_mini_loss sum 1.1836960315704346
Total (block generation + training)time/epoch 6.237146512321804
Training time/epoch 0.3660550117492676
Training time without block to device /epoch 0.3261687755584717
Training time without total dataloading part /epoch 0.10244369506835938
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 51.80it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.07it/s]100%|██████████| 4/4 [00:00<00:00, 15.45it/s]100%|██████████| 4/4 [00:00<00:00, 15.38it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.96it/s]100%|██████████| 4/4 [00:00<00:00, 16.49it/s]100%|██████████| 4/4 [00:00<00:00, 16.23it/s]
Run 00 | Epoch 00032 | Loss 1.1837 | Train 0.4196 | Val 0.5149 | Test 0.5227
Number of nodes during this epoch:  329762
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14441919326782227  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.013998031616210938
range selection method range initialization spend 0.012257814407348633
time for parepare:  0.016266584396362305
local_output_nid generation:  0.010760307312011719
local_in_edges_tensor generation:  0.008879661560058594
mini_batch_src_global generation:  0.011616706848144531
r_  generation:  0.14591336250305176
local_output_nid generation:  0.011595726013183594
local_in_edges_tensor generation:  0.00634455680847168
mini_batch_src_global generation:  0.014157772064208984
r_  generation:  0.1561741828918457
----------------------check_connections_block total spend ----------------------------- 0.44213151931762695
generate_one_block  0.1665205955505371
generate_one_block  0.16972613334655762
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029633522033691406
gen group dst list time:  0.00634312629699707
time for parepare:  0.019849538803100586
local_output_nid generation:  0.01716017723083496
local_in_edges_tensor generation:  0.025072813034057617
mini_batch_src_global generation:  0.038817405700683594
r_  generation:  0.435957670211792
local_output_nid generation:  0.025098800659179688
local_in_edges_tensor generation:  0.025789260864257812
mini_batch_src_global generation:  0.052030324935913086
r_  generation:  0.43885350227355957
----------------------check_connections_block total spend ----------------------------- 1.268317699432373
generate_one_block  0.5400710105895996
generate_one_block  0.5473103523254395
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.019494056701660156
gen group dst list time:  0.012256383895874023
time for parepare:  0.018602609634399414
local_output_nid generation:  0.022705078125
local_in_edges_tensor generation:  0.03566622734069824
mini_batch_src_global generation:  0.031050682067871094
r_  generation:  0.37062954902648926
local_output_nid generation:  0.031035900115966797
local_in_edges_tensor generation:  0.026881694793701172
mini_batch_src_global generation:  0.03760480880737305
r_  generation:  0.3781723976135254
----------------------check_connections_block total spend ----------------------------- 1.1157128810882568
generate_one_block  0.44698405265808105
generate_one_block  0.45531725883483887
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14441919326782227  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

connection checking time:  2.38403058052063
block generation total time  1.989682674407959
average batch blocks generation time:  0.9948413372039795
block dataloader generation time/epoch 5.909237066904704
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10905075073242188  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2279706001281738  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10981082916259766  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2276344299316406  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0823965072631836 |0.011818885803222656 |0.00419306755065918 |0.000527501106262207 |0.003214597702026367 |0.0029754638671875 |
----------------------------------------------------------pseudo_mini_loss sum 1.1712703704833984
Total (block generation + training)time/epoch 6.229297548532486
Training time/epoch 0.31462669372558594
Training time without block to device /epoch 0.2909889221191406
Training time without total dataloading part /epoch 0.018845796585083008
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.00it/s]100%|██████████| 4/4 [00:00<00:00, 31.24it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.67it/s]100%|██████████| 4/4 [00:00<00:00, 12.69it/s]100%|██████████| 4/4 [00:00<00:00, 12.51it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.23it/s]100%|██████████| 4/4 [00:00<00:00, 17.51it/s]100%|██████████| 4/4 [00:00<00:00, 17.44it/s]
Run 00 | Epoch 00033 | Loss 1.1713 | Train 0.4192 | Val 0.5156 | Test 0.5227
Number of nodes during this epoch:  329838
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14674949645996094  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.013617515563964844
range selection method range initialization spend 0.011719942092895508
time for parepare:  0.016520023345947266
local_output_nid generation:  0.010925054550170898
local_in_edges_tensor generation:  0.007948637008666992
mini_batch_src_global generation:  0.010985136032104492
r_  generation:  0.14469122886657715
local_output_nid generation:  0.011693954467773438
local_in_edges_tensor generation:  0.005512714385986328
mini_batch_src_global generation:  0.014626026153564453
r_  generation:  0.1569821834564209
----------------------check_connections_block total spend ----------------------------- 0.44071388244628906
generate_one_block  0.16680407524108887
generate_one_block  0.17078518867492676
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02585768699645996
gen group dst list time:  0.0064907073974609375
time for parepare:  0.019830703735351562
local_output_nid generation:  0.016917705535888672
local_in_edges_tensor generation:  0.028093576431274414
mini_batch_src_global generation:  0.03905773162841797
r_  generation:  0.42751073837280273
local_output_nid generation:  0.023894071578979492
local_in_edges_tensor generation:  0.028664827346801758
mini_batch_src_global generation:  0.05047273635864258
r_  generation:  0.45233750343322754
----------------------check_connections_block total spend ----------------------------- 1.2746589183807373
generate_one_block  0.5663130283355713
generate_one_block  0.5624327659606934
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.020228862762451172
gen group dst list time:  0.013972282409667969
time for parepare:  0.020101070404052734
local_output_nid generation:  0.023124217987060547
local_in_edges_tensor generation:  0.04572248458862305
mini_batch_src_global generation:  0.03136491775512695
r_  generation:  0.37963294982910156
local_output_nid generation:  0.03131461143493652
local_in_edges_tensor generation:  0.026861906051635742
mini_batch_src_global generation:  0.038825035095214844
r_  generation:  0.3860511779785156
----------------------check_connections_block total spend ----------------------------- 1.1482055187225342
generate_one_block  0.45607471466064453
generate_one_block  0.4584619998931885
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14674949645996094  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

connection checking time:  2.4228644371032715
block generation total time  2.0432825088500977
average batch blocks generation time:  1.0216412544250488
block dataloader generation time/epoch 5.9090345764160155
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10902738571166992  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.227159023284912  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10980033874511719  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.227555751800537  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08239030838012695 |0.014285445213317871 |0.004227757453918457 |0.0005182027816772461 |0.0029784440994262695 |0.0014851093292236328 |
----------------------------------------------------------pseudo_mini_loss sum 1.166912317276001
Total (block generation + training)time/epoch 6.2288423442840575
Training time/epoch 0.313596248626709
Training time without block to device /epoch 0.28502535820007324
Training time without total dataloading part /epoch 0.016933917999267578
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.95it/s]100%|██████████| 4/4 [00:00<00:00, 29.30it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.56it/s]100%|██████████| 4/4 [00:00<00:00, 12.64it/s]100%|██████████| 4/4 [00:00<00:00, 12.45it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.45it/s]100%|██████████| 4/4 [00:00<00:00, 17.52it/s]100%|██████████| 4/4 [00:00<00:00, 17.49it/s]
Run 00 | Epoch 00034 | Loss 1.1669 | Train 0.4186 | Val 0.5162 | Test 0.5237
Number of nodes during this epoch:  329776
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14596319198608398  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.017171859741210938
range selection method range initialization spend 0.011968374252319336
time for parepare:  0.016718149185180664
local_output_nid generation:  0.010746955871582031
local_in_edges_tensor generation:  0.008167266845703125
mini_batch_src_global generation:  0.011083126068115234
r_  generation:  0.1455068588256836
local_output_nid generation:  0.01182246208190918
local_in_edges_tensor generation:  0.005424976348876953
mini_batch_src_global generation:  0.014234066009521484
r_  generation:  0.15846848487854004
----------------------check_connections_block total spend ----------------------------- 0.4428136348724365
generate_one_block  0.16673588752746582
generate_one_block  0.17029356956481934
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029141902923583984
gen group dst list time:  0.006457805633544922
time for parepare:  0.019807815551757812
local_output_nid generation:  0.017017841339111328
local_in_edges_tensor generation:  0.025837421417236328
mini_batch_src_global generation:  0.0394442081451416
r_  generation:  0.42681050300598145
local_output_nid generation:  0.02449345588684082
local_in_edges_tensor generation:  0.03323173522949219
mini_batch_src_global generation:  0.06050276756286621
r_  generation:  0.4582548141479492
----------------------check_connections_block total spend ----------------------------- 1.2997608184814453
generate_one_block  0.5440919399261475
generate_one_block  0.5497870445251465
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0213778018951416
gen group dst list time:  0.01281881332397461
time for parepare:  0.01893782615661621
local_output_nid generation:  0.021987199783325195
local_in_edges_tensor generation:  0.043440818786621094
mini_batch_src_global generation:  0.03223133087158203
r_  generation:  0.3705868721008301
local_output_nid generation:  0.0311431884765625
local_in_edges_tensor generation:  0.030220508575439453
mini_batch_src_global generation:  0.03810548782348633
r_  generation:  0.38007235527038574
----------------------check_connections_block total spend ----------------------------- 1.1331799030303955
generate_one_block  0.45142507553100586
generate_one_block  0.45896434783935547
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14596319198608398  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

connection checking time:  2.432940721511841
block generation total time  2.0042684078216553
average batch blocks generation time:  1.0021342039108276
block dataloader generation time/epoch 5.9083794263693
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10906219482421875  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2312045097351074  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10981893539428711  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2286477088928223  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0832751989364624 |0.014710664749145508 |0.004212021827697754 |0.0005173683166503906 |0.0026072263717651367 |0.0029137134552001953 |
----------------------------------------------------------pseudo_mini_loss sum 1.1577928066253662
Total (block generation + training)time/epoch 6.228064573728121
Training time/epoch 0.31647729873657227
Training time without block to device /epoch 0.28705596923828125
Training time without total dataloading part /epoch 0.017586946487426758
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.03it/s]100%|██████████| 4/4 [00:00<00:00, 30.02it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.55it/s]100%|██████████| 4/4 [00:00<00:00, 12.70it/s]100%|██████████| 4/4 [00:00<00:00, 12.50it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.48it/s]100%|██████████| 4/4 [00:00<00:00, 17.93it/s]100%|██████████| 4/4 [00:00<00:00, 17.84it/s]
Run 00 | Epoch 00035 | Loss 1.1578 | Train 0.4174 | Val 0.5163 | Test 0.5234
Number of nodes during this epoch:  329865
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1454453468322754  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01404118537902832
range selection method range initialization spend 0.012037038803100586
time for parepare:  0.016521215438842773
local_output_nid generation:  0.010662078857421875
local_in_edges_tensor generation:  0.008041620254516602
mini_batch_src_global generation:  0.01110696792602539
r_  generation:  0.14545679092407227
local_output_nid generation:  0.011684179306030273
local_in_edges_tensor generation:  0.005939006805419922
mini_batch_src_global generation:  0.014258384704589844
r_  generation:  0.15718984603881836
----------------------check_connections_block total spend ----------------------------- 0.4421229362487793
generate_one_block  0.16687870025634766
generate_one_block  0.16935205459594727
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.027191638946533203
gen group dst list time:  0.00649714469909668
time for parepare:  0.020089387893676758
local_output_nid generation:  0.017182111740112305
local_in_edges_tensor generation:  0.0279233455657959
mini_batch_src_global generation:  0.03918623924255371
r_  generation:  0.4241626262664795
local_output_nid generation:  0.026113510131835938
local_in_edges_tensor generation:  0.02538299560546875
mini_batch_src_global generation:  0.048009634017944336
r_  generation:  0.45015740394592285
----------------------check_connections_block total spend ----------------------------- 1.2695894241333008
generate_one_block  0.565314531326294
generate_one_block  0.5569107532501221
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.024530649185180664
gen group dst list time:  0.01415705680847168
time for parepare:  0.018645048141479492
local_output_nid generation:  0.0231170654296875
local_in_edges_tensor generation:  0.04322171211242676
mini_batch_src_global generation:  0.03322649002075195
r_  generation:  0.37345051765441895
local_output_nid generation:  0.032808780670166016
local_in_edges_tensor generation:  0.02793431282043457
mini_batch_src_global generation:  0.03777265548706055
r_  generation:  0.3821086883544922
----------------------check_connections_block total spend ----------------------------- 1.135232925415039
generate_one_block  0.4608018398284912
generate_one_block  0.452730655670166
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1454453468322754  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

connection checking time:  2.40482234954834
block generation total time  2.0357577800750732
average batch blocks generation time:  1.0178788900375366
block dataloader generation time/epoch 5.907633958039461
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10902261734008789  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.231191635131836  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10982131958007812  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2296810150146484  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09248161315917969 |0.014082789421081543 |0.0040929317474365234 |0.0005164146423339844 |0.003238677978515625 |0.0014460086822509766 |
----------------------------------------------------------pseudo_mini_loss sum 1.151717185974121
Total (block generation + training)time/epoch 6.227876257013391
Training time/epoch 0.33458805084228516
Training time without block to device /epoch 0.30642247200012207
Training time without total dataloading part /epoch 0.017142057418823242
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 50.92it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.92it/s]100%|██████████| 4/4 [00:00<00:00, 15.33it/s]100%|██████████| 4/4 [00:00<00:00, 15.25it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.23it/s]100%|██████████| 4/4 [00:00<00:00, 17.50it/s]100%|██████████| 4/4 [00:00<00:00, 17.44it/s]
Run 00 | Epoch 00036 | Loss 1.1517 | Train 0.4161 | Val 0.5152 | Test 0.5216
Number of nodes during this epoch:  329881
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14593076705932617  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01806640625
range selection method range initialization spend 0.01194143295288086
time for parepare:  0.017049074172973633
local_output_nid generation:  0.010648488998413086
local_in_edges_tensor generation:  0.00865793228149414
mini_batch_src_global generation:  0.011033773422241211
r_  generation:  0.1440882682800293
local_output_nid generation:  0.011991500854492188
local_in_edges_tensor generation:  0.005490779876708984
mini_batch_src_global generation:  0.014298439025878906
r_  generation:  0.15658259391784668
----------------------check_connections_block total spend ----------------------------- 0.4398651123046875
generate_one_block  0.1660006046295166
generate_one_block  0.16918110847473145
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0292360782623291
gen group dst list time:  0.006380558013916016
time for parepare:  0.01968550682067871
local_output_nid generation:  0.016535043716430664
local_in_edges_tensor generation:  0.03206181526184082
mini_batch_src_global generation:  0.03900790214538574
r_  generation:  0.4344313144683838
local_output_nid generation:  0.024880170822143555
local_in_edges_tensor generation:  0.028136253356933594
mini_batch_src_global generation:  0.050484418869018555
r_  generation:  0.43833112716674805
----------------------check_connections_block total spend ----------------------------- 1.2723584175109863
generate_one_block  0.541353702545166
generate_one_block  0.5521121025085449
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.021022558212280273
gen group dst list time:  0.012265443801879883
time for parepare:  0.018463850021362305
local_output_nid generation:  0.022319793701171875
local_in_edges_tensor generation:  0.030544757843017578
mini_batch_src_global generation:  0.03278923034667969
r_  generation:  0.3651149272918701
local_output_nid generation:  0.030559539794921875
local_in_edges_tensor generation:  0.030188560485839844
mini_batch_src_global generation:  0.0388796329498291
r_  generation:  0.3760077953338623
----------------------check_connections_block total spend ----------------------------- 1.106112003326416
generate_one_block  0.4448556900024414
generate_one_block  0.4450492858886719
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14593076705932617  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

connection checking time:  2.3784704208374023
block generation total time  1.9833707809448242
average batch blocks generation time:  0.9916853904724121
block dataloader generation time/epoch 5.90425613948277
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.11042165756225586  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.227731704711914  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10981893539428711  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2299809455871582  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08365392684936523 |0.011775851249694824 |0.004216432571411133 |0.0005216598510742188 |0.00325775146484375 |0.0014622211456298828 |
----------------------------------------------------------pseudo_mini_loss sum 1.1458377838134766
Total (block generation + training)time/epoch 6.224127837589809
Training time/epoch 0.30971264839172363
Training time without block to device /epoch 0.286160945892334
Training time without total dataloading part /epoch 0.017453908920288086
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.61it/s]100%|██████████| 4/4 [00:00<00:00, 30.27it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.79it/s]100%|██████████| 4/4 [00:00<00:00, 12.79it/s]100%|██████████| 4/4 [00:00<00:00, 12.62it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.44it/s]100%|██████████| 4/4 [00:00<00:00, 17.88it/s]100%|██████████| 4/4 [00:00<00:00, 17.79it/s]
Run 00 | Epoch 00037 | Loss 1.1458 | Train 0.4156 | Val 0.5139 | Test 0.5200
Number of nodes during this epoch:  329762
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14641857147216797  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.013144493103027344
range selection method range initialization spend 0.011722326278686523
time for parepare:  0.01648998260498047
local_output_nid generation:  0.010664701461791992
local_in_edges_tensor generation:  0.008083820343017578
mini_batch_src_global generation:  0.011039495468139648
r_  generation:  0.14450645446777344
local_output_nid generation:  0.011597871780395508
local_in_edges_tensor generation:  0.006023883819580078
mini_batch_src_global generation:  0.014381647109985352
r_  generation:  0.15553498268127441
----------------------check_connections_block total spend ----------------------------- 0.43842148780822754
generate_one_block  0.16518330574035645
generate_one_block  0.16910600662231445
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02567601203918457
gen group dst list time:  0.0064046382904052734
time for parepare:  0.01978445053100586
local_output_nid generation:  0.016324281692504883
local_in_edges_tensor generation:  0.026284217834472656
mini_batch_src_global generation:  0.038778066635131836
r_  generation:  0.4231069087982178
local_output_nid generation:  0.023527860641479492
local_in_edges_tensor generation:  0.025925874710083008
mini_batch_src_global generation:  0.04724550247192383
r_  generation:  0.439211368560791
----------------------check_connections_block total spend ----------------------------- 1.2491285800933838
generate_one_block  0.5354135036468506
generate_one_block  0.5409526824951172
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.019301414489746094
gen group dst list time:  0.01256871223449707
time for parepare:  0.02019667625427246
local_output_nid generation:  0.02240300178527832
local_in_edges_tensor generation:  0.028586626052856445
mini_batch_src_global generation:  0.0316617488861084
r_  generation:  0.3692667484283447
local_output_nid generation:  0.03168082237243652
local_in_edges_tensor generation:  0.029005050659179688
mini_batch_src_global generation:  0.0375821590423584
r_  generation:  0.37743616104125977
----------------------check_connections_block total spend ----------------------------- 1.1136863231658936
generate_one_block  0.457902193069458
generate_one_block  0.46476101875305176
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14641857147216797  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

connection checking time:  2.3628149032592773
block generation total time  1.9990293979644775
average batch blocks generation time:  0.9995146989822388
block dataloader generation time/epoch 5.900428303356828
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.11056852340698242  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2279529571533203  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1098475456237793  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2282838821411133  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08148336410522461 |0.020672082901000977 |0.003886580467224121 |0.0004982948303222656 |0.003858327865600586 |0.0012943744659423828 |
----------------------------------------------------------pseudo_mini_loss sum 1.1431041955947876
Total (block generation + training)time/epoch 6.220329136684023
Training time/epoch 0.32062792778015137
Training time without block to device /epoch 0.2792837619781494
Training time without total dataloading part /epoch 0.017780780792236328
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 52.44it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.13it/s]100%|██████████| 4/4 [00:00<00:00, 15.35it/s]100%|██████████| 4/4 [00:00<00:00, 15.30it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.70it/s]100%|██████████| 4/4 [00:00<00:00, 17.72it/s]100%|██████████| 4/4 [00:00<00:00, 17.70it/s]
Run 00 | Epoch 00038 | Loss 1.1431 | Train 0.4144 | Val 0.5109 | Test 0.5176
Number of nodes during this epoch:  329726
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14659643173217773  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.017611265182495117
range selection method range initialization spend 0.012237310409545898
time for parepare:  0.01631450653076172
local_output_nid generation:  0.010548830032348633
local_in_edges_tensor generation:  0.012449979782104492
mini_batch_src_global generation:  0.011095762252807617
r_  generation:  0.14460372924804688
local_output_nid generation:  0.011523246765136719
local_in_edges_tensor generation:  0.00627589225769043
mini_batch_src_global generation:  0.014096736907958984
r_  generation:  0.1560499668121338
----------------------check_connections_block total spend ----------------------------- 0.44303393363952637
generate_one_block  0.16940975189208984
generate_one_block  0.16990256309509277
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02729177474975586
gen group dst list time:  0.006352901458740234
time for parepare:  0.019677400588989258
local_output_nid generation:  0.016518354415893555
local_in_edges_tensor generation:  0.031877994537353516
mini_batch_src_global generation:  0.0404050350189209
r_  generation:  0.4208400249481201
local_output_nid generation:  0.02383255958557129
local_in_edges_tensor generation:  0.02380657196044922
mini_batch_src_global generation:  0.048633575439453125
r_  generation:  0.43528127670288086
----------------------check_connections_block total spend ----------------------------- 1.2479281425476074
generate_one_block  0.5361945629119873
generate_one_block  0.5369553565979004
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01750946044921875
gen group dst list time:  0.011869668960571289
time for parepare:  0.018558263778686523
local_output_nid generation:  0.0216367244720459
local_in_edges_tensor generation:  0.029693126678466797
mini_batch_src_global generation:  0.03133893013000488
r_  generation:  0.3672776222229004
local_output_nid generation:  0.03003239631652832
local_in_edges_tensor generation:  0.028954267501831055
mini_batch_src_global generation:  0.03847765922546387
r_  generation:  0.37421464920043945
----------------------check_connections_block total spend ----------------------------- 1.1022777557373047
generate_one_block  0.44687366485595703
generate_one_block  0.45026111602783203
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14659643173217773  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

connection checking time:  2.350205898284912
block generation total time  1.9702847003936768
average batch blocks generation time:  0.9851423501968384
block dataloader generation time/epoch 5.895915166536967
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10905694961547852  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.226762294769287  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10981225967407227  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2281842231750488  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07728147506713867 |0.011745691299438477 |0.003992676734924316 |0.0005217790603637695 |0.0038224458694458008 |0.002778291702270508 |
----------------------------------------------------------pseudo_mini_loss sum 1.1322299242019653
Total (block generation + training)time/epoch 6.214944593111674
Training time/epoch 0.2936666011810303
Training time without block to device /epoch 0.2701752185821533
Training time without total dataloading part /epoch 0.01945209503173828
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 63.49it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.40it/s]100%|██████████| 4/4 [00:00<00:00, 15.49it/s]100%|██████████| 4/4 [00:00<00:00, 15.46it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.34it/s]100%|██████████| 4/4 [00:00<00:00, 17.85it/s]100%|██████████| 4/4 [00:00<00:00, 17.75it/s]
Run 00 | Epoch 00039 | Loss 1.1322 | Train 0.4126 | Val 0.5064 | Test 0.5126
Number of nodes during this epoch:  329702
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14660406112670898  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.013607263565063477
range selection method range initialization spend 0.01183629035949707
time for parepare:  0.016393661499023438
local_output_nid generation:  0.010764837265014648
local_in_edges_tensor generation:  0.008197307586669922
mini_batch_src_global generation:  0.011090517044067383
r_  generation:  0.1451127529144287
local_output_nid generation:  0.011614322662353516
local_in_edges_tensor generation:  0.005491018295288086
mini_batch_src_global generation:  0.014458417892456055
r_  generation:  0.15608954429626465
----------------------check_connections_block total spend ----------------------------- 0.4402892589569092
generate_one_block  0.16693472862243652
generate_one_block  0.1701350212097168
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02669978141784668
gen group dst list time:  0.006361722946166992
time for parepare:  0.019814491271972656
local_output_nid generation:  0.017310380935668945
local_in_edges_tensor generation:  0.027582883834838867
mini_batch_src_global generation:  0.04013419151306152
r_  generation:  0.42631006240844727
local_output_nid generation:  0.02615642547607422
local_in_edges_tensor generation:  0.023620128631591797
mini_batch_src_global generation:  0.0473790168762207
r_  generation:  0.44458842277526855
----------------------check_connections_block total spend ----------------------------- 1.262253999710083
generate_one_block  0.5811293125152588
generate_one_block  0.554006814956665
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.023732900619506836
gen group dst list time:  0.013964653015136719
time for parepare:  0.018570423126220703
local_output_nid generation:  0.02245616912841797
local_in_edges_tensor generation:  0.04046177864074707
mini_batch_src_global generation:  0.031514644622802734
r_  generation:  0.3728506565093994
local_output_nid generation:  0.03096938133239746
local_in_edges_tensor generation:  0.03271746635437012
mini_batch_src_global generation:  0.03738212585449219
r_  generation:  0.38846325874328613
----------------------check_connections_block total spend ----------------------------- 1.1405456066131592
generate_one_block  0.4586527347564697
generate_one_block  0.46480464935302734
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14660406112670898  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

connection checking time:  2.402799606323242
block generation total time  2.058593511581421
average batch blocks generation time:  1.0292967557907104
block dataloader generation time/epoch 5.8956817196261495
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10903787612915039  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2269001007080078  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10981369018554688  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2278327941894531  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08123373985290527 |0.020366430282592773 |0.0042105913162231445 |0.0005151033401489258 |0.003950834274291992 |0.0015110969543457031 |
----------------------------------------------------------pseudo_mini_loss sum 1.1290743350982666
Total (block generation + training)time/epoch 6.214707043863112
Training time/epoch 0.3187580108642578
Training time without block to device /epoch 0.27802515029907227
Training time without total dataloading part /epoch 0.018864154815673828
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 47.28it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.80it/s]100%|██████████| 4/4 [00:00<00:00, 15.23it/s]100%|██████████| 4/4 [00:00<00:00, 15.15it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.57it/s]100%|██████████| 4/4 [00:00<00:00, 17.50it/s]100%|██████████| 4/4 [00:00<00:00, 17.49it/s]
Run 00 | Epoch 00040 | Loss 1.1291 | Train 0.4085 | Val 0.4990 | Test 0.5051
Number of nodes during this epoch:  329745
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1457052230834961  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.017809391021728516
range selection method range initialization spend 0.01190185546875
time for parepare:  0.01813030242919922
local_output_nid generation:  0.010495424270629883
local_in_edges_tensor generation:  0.008061647415161133
mini_batch_src_global generation:  0.01110219955444336
r_  generation:  0.14417576789855957
local_output_nid generation:  0.011592388153076172
local_in_edges_tensor generation:  0.006416797637939453
mini_batch_src_global generation:  0.01427149772644043
r_  generation:  0.15862321853637695
----------------------check_connections_block total spend ----------------------------- 0.4435861110687256
generate_one_block  0.1684103012084961
generate_one_block  0.17066454887390137
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029627323150634766
gen group dst list time:  0.006327390670776367
time for parepare:  0.021298646926879883
local_output_nid generation:  0.017273902893066406
local_in_edges_tensor generation:  0.03636455535888672
mini_batch_src_global generation:  0.03962302207946777
r_  generation:  0.44295239448547363
local_output_nid generation:  0.025538206100463867
local_in_edges_tensor generation:  0.027762174606323242
mini_batch_src_global generation:  0.049790382385253906
r_  generation:  0.4420430660247803
----------------------check_connections_block total spend ----------------------------- 1.2942678928375244
generate_one_block  0.5469591617584229
generate_one_block  0.550936222076416
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01930546760559082
gen group dst list time:  0.012508630752563477
time for parepare:  0.018433332443237305
local_output_nid generation:  0.023317337036132812
local_in_edges_tensor generation:  0.03428792953491211
mini_batch_src_global generation:  0.03194785118103027
r_  generation:  0.37042737007141113
local_output_nid generation:  0.03302788734436035
local_in_edges_tensor generation:  0.026304960250854492
mini_batch_src_global generation:  0.03825259208679199
r_  generation:  0.38181161880493164
----------------------check_connections_block total spend ----------------------------- 1.1220579147338867
generate_one_block  0.44930100440979004
generate_one_block  0.45304393768310547
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1457052230834961  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

connection checking time:  2.416325807571411
block generation total time  2.0002403259277344
average batch blocks generation time:  1.0001201629638672
block dataloader generation time/epoch 5.894993104040623
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10905694961547852  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2274231910705566  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10982465744018555  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.228053092956543  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08283936977386475 |0.012127041816711426 |0.004216551780700684 |0.0005246400833129883 |0.003957033157348633 |0.001476287841796875 |
----------------------------------------------------------pseudo_mini_loss sum 1.122248888015747
Total (block generation + training)time/epoch 6.2138253301382065
Training time/epoch 0.31268739700317383
Training time without block to device /epoch 0.288433313369751
Training time without total dataloading part /epoch 0.018872737884521484
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 63.11it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.85it/s]100%|██████████| 4/4 [00:00<00:00, 15.27it/s]100%|██████████| 4/4 [00:00<00:00, 15.19it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.10it/s]100%|██████████| 4/4 [00:00<00:00, 17.75it/s]100%|██████████| 4/4 [00:00<00:00, 17.63it/s]
Run 00 | Epoch 00041 | Loss 1.1222 | Train 0.4039 | Val 0.4904 | Test 0.4954
Number of nodes during this epoch:  329834
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14661931991577148  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01286935806274414
range selection method range initialization spend 0.011959314346313477
time for parepare:  0.01647186279296875
local_output_nid generation:  0.010669231414794922
local_in_edges_tensor generation:  0.007843971252441406
mini_batch_src_global generation:  0.011008262634277344
r_  generation:  0.14364027976989746
local_output_nid generation:  0.01147150993347168
local_in_edges_tensor generation:  0.0054972171783447266
mini_batch_src_global generation:  0.014551162719726562
r_  generation:  0.1562514305114746
----------------------check_connections_block total spend ----------------------------- 0.43805909156799316
generate_one_block  0.16701817512512207
generate_one_block  0.17070960998535156
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02553868293762207
gen group dst list time:  0.006358146667480469
time for parepare:  0.020021677017211914
local_output_nid generation:  0.01724720001220703
local_in_edges_tensor generation:  0.025238752365112305
mini_batch_src_global generation:  0.03924727439880371
r_  generation:  0.42154455184936523
local_output_nid generation:  0.02592301368713379
local_in_edges_tensor generation:  0.027475833892822266
mini_batch_src_global generation:  0.04857921600341797
r_  generation:  0.4385852813720703
----------------------check_connections_block total spend ----------------------------- 1.2519595623016357
generate_one_block  0.5394885540008545
generate_one_block  0.546471118927002
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.020105838775634766
gen group dst list time:  0.012206077575683594
time for parepare:  0.01876974105834961
local_output_nid generation:  0.023557186126708984
local_in_edges_tensor generation:  0.028700590133666992
mini_batch_src_global generation:  0.03128767013549805
r_  generation:  0.372424840927124
local_output_nid generation:  0.03253769874572754
local_in_edges_tensor generation:  0.02631855010986328
mini_batch_src_global generation:  0.03744626045227051
r_  generation:  0.3802454471588135
----------------------check_connections_block total spend ----------------------------- 1.116443395614624
generate_one_block  0.46187829971313477
generate_one_block  0.4685680866241455
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14661931991577148  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

connection checking time:  2.3684029579162598
block generation total time  2.0164060592651367
average batch blocks generation time:  1.0082030296325684
block dataloader generation time/epoch 5.892655538790153
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10903167724609375  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.227250576019287  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10983419418334961  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2290401458740234  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0834813117980957 |0.01880812644958496 |0.0038061141967773438 |0.0005031824111938477 |0.003853917121887207 |0.0016596317291259766 |
----------------------------------------------------------pseudo_mini_loss sum 1.1157796382904053
Total (block generation + training)time/epoch 6.211774645429669
Training time/epoch 0.3282151222229004
Training time without block to device /epoch 0.29059886932373047
Training time without total dataloading part /epoch 0.017986059188842773
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.27it/s]100%|██████████| 4/4 [00:00<00:00, 29.80it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.44it/s]100%|██████████| 4/4 [00:00<00:00, 12.52it/s]100%|██████████| 4/4 [00:00<00:00, 12.33it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.26it/s]100%|██████████| 4/4 [00:00<00:00, 17.43it/s]100%|██████████| 4/4 [00:00<00:00, 17.39it/s]
Run 00 | Epoch 00042 | Loss 1.1158 | Train 0.3983 | Val 0.4778 | Test 0.4833
Number of nodes during this epoch:  329862
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1464366912841797  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01725149154663086
range selection method range initialization spend 0.01227712631225586
time for parepare:  0.016259431838989258
local_output_nid generation:  0.010895013809204102
local_in_edges_tensor generation:  0.009382963180541992
mini_batch_src_global generation:  0.011075258255004883
r_  generation:  0.14888215065002441
local_output_nid generation:  0.011704683303833008
local_in_edges_tensor generation:  0.007384300231933594
mini_batch_src_global generation:  0.01456761360168457
r_  generation:  0.15804076194763184
----------------------check_connections_block total spend ----------------------------- 0.44852495193481445
generate_one_block  0.17269039154052734
generate_one_block  0.17059540748596191
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03096747398376465
gen group dst list time:  0.0063364505767822266
time for parepare:  0.02015089988708496
local_output_nid generation:  0.017481088638305664
local_in_edges_tensor generation:  0.030524015426635742
mini_batch_src_global generation:  0.039721012115478516
r_  generation:  0.4324378967285156
local_output_nid generation:  0.024945735931396484
local_in_edges_tensor generation:  0.027596235275268555
mini_batch_src_global generation:  0.04759788513183594
r_  generation:  0.44910192489624023
----------------------check_connections_block total spend ----------------------------- 1.2803611755371094
generate_one_block  0.5537104606628418
generate_one_block  0.5697987079620361
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.024149656295776367
gen group dst list time:  0.01420736312866211
time for parepare:  0.018999814987182617
local_output_nid generation:  0.022850990295410156
local_in_edges_tensor generation:  0.039238691329956055
mini_batch_src_global generation:  0.03346133232116699
r_  generation:  0.37325620651245117
local_output_nid generation:  0.034043073654174805
local_in_edges_tensor generation:  0.027956008911132812
mini_batch_src_global generation:  0.038996219635009766
r_  generation:  0.38220691680908203
----------------------check_connections_block total spend ----------------------------- 1.1339197158813477
generate_one_block  0.4681844711303711
generate_one_block  0.459087610244751
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1464366912841797  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

connection checking time:  2.414280891418457
block generation total time  2.05078125
average batch blocks generation time:  1.025390625
block dataloader generation time/epoch 5.894598484039307
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.11059045791625977  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2270269393920898  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1089181900024414  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2268891334533691  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07995867729187012 |0.013705015182495117 |0.00421452522277832 |0.0005373954772949219 |0.0037816762924194336 |0.0030417442321777344 |
----------------------------------------------------------pseudo_mini_loss sum 1.1119747161865234
Total (block generation + training)time/epoch 6.213212300749386
Training time/epoch 0.30179309844970703
Training time without block to device /epoch 0.2743830680847168
Training time without total dataloading part /epoch 0.020108938217163086
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 57.47it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.02it/s]100%|██████████| 4/4 [00:00<00:00, 15.50it/s]100%|██████████| 4/4 [00:00<00:00, 15.41it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.50it/s]100%|██████████| 4/4 [00:00<00:00, 17.91it/s]100%|██████████| 4/4 [00:00<00:00, 17.82it/s]
Run 00 | Epoch 00043 | Loss 1.1120 | Train 0.3923 | Val 0.4645 | Test 0.4690
Number of nodes during this epoch:  329826
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14560508728027344  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01447153091430664
range selection method range initialization spend 0.012136459350585938
time for parepare:  0.017561912536621094
local_output_nid generation:  0.010690927505493164
local_in_edges_tensor generation:  0.008069038391113281
mini_batch_src_global generation:  0.011069297790527344
r_  generation:  0.147125244140625
local_output_nid generation:  0.011714935302734375
local_in_edges_tensor generation:  0.005991697311401367
mini_batch_src_global generation:  0.01427459716796875
r_  generation:  0.15755963325500488
----------------------check_connections_block total spend ----------------------------- 0.44469308853149414
generate_one_block  0.16794490814208984
generate_one_block  0.17067503929138184
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029608964920043945
gen group dst list time:  0.006365537643432617
time for parepare:  0.020589590072631836
local_output_nid generation:  0.016977548599243164
local_in_edges_tensor generation:  0.02761387825012207
mini_batch_src_global generation:  0.04046034812927246
r_  generation:  0.43213510513305664
local_output_nid generation:  0.025595426559448242
local_in_edges_tensor generation:  0.0262911319732666
mini_batch_src_global generation:  0.05090165138244629
r_  generation:  0.47810792922973633
----------------------check_connections_block total spend ----------------------------- 1.315650224685669
generate_one_block  0.5594162940979004
generate_one_block  0.5590410232543945
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.021209001541137695
gen group dst list time:  0.012810230255126953
time for parepare:  0.01861262321472168
local_output_nid generation:  0.02264237403869629
local_in_edges_tensor generation:  0.04336810111999512
mini_batch_src_global generation:  0.03242635726928711
r_  generation:  0.39225292205810547
local_output_nid generation:  0.03310346603393555
local_in_edges_tensor generation:  0.028832197189331055
mini_batch_src_global generation:  0.03778862953186035
r_  generation:  0.3895998001098633
----------------------check_connections_block total spend ----------------------------- 1.1631853580474854
generate_one_block  0.45961856842041016
generate_one_block  0.45580053329467773
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14560508728027344  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

connection checking time:  2.4788355827331543
block generation total time  2.033876419067383
average batch blocks generation time:  1.0169382095336914
block dataloader generation time/epoch 5.896712800434657
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10979986190795898  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2294034957885742  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10980701446533203  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2288756370544434  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08274245262145996 |0.01653432846069336 |0.00419008731842041 |0.0005246400833129883 |0.00393223762512207 |0.001520395278930664 |
----------------------------------------------------------pseudo_mini_loss sum 1.109493374824524
Total (block generation + training)time/epoch 6.21542045048305
Training time/epoch 0.3217508792877197
Training time without block to device /epoch 0.288682222366333
Training time without total dataloading part /epoch 0.0188143253326416
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 50.80it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.37it/s]100%|██████████| 4/4 [00:00<00:00, 15.65it/s]100%|██████████| 4/4 [00:00<00:00, 15.59it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.23it/s]100%|██████████| 4/4 [00:00<00:00, 17.76it/s]100%|██████████| 4/4 [00:00<00:00, 17.66it/s]
Run 00 | Epoch 00044 | Loss 1.1095 | Train 0.3865 | Val 0.4497 | Test 0.4545
Number of nodes during this epoch:  329770
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14543390274047852  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.014534950256347656
range selection method range initialization spend 0.012446403503417969
time for parepare:  0.016316890716552734
local_output_nid generation:  0.010890483856201172
local_in_edges_tensor generation:  0.008338212966918945
mini_batch_src_global generation:  0.011157035827636719
r_  generation:  0.14470577239990234
local_output_nid generation:  0.011618852615356445
local_in_edges_tensor generation:  0.005475282669067383
mini_batch_src_global generation:  0.014281511306762695
r_  generation:  0.15570950508117676
----------------------check_connections_block total spend ----------------------------- 0.43973851203918457
generate_one_block  0.16756939888000488
generate_one_block  0.16908621788024902
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.027918577194213867
gen group dst list time:  0.006251811981201172
time for parepare:  0.01984381675720215
local_output_nid generation:  0.016798734664916992
local_in_edges_tensor generation:  0.025858640670776367
mini_batch_src_global generation:  0.04027080535888672
r_  generation:  0.4502420425415039
local_output_nid generation:  0.024698257446289062
local_in_edges_tensor generation:  0.03494071960449219
mini_batch_src_global generation:  0.050066471099853516
r_  generation:  0.4435563087463379
----------------------check_connections_block total spend ----------------------------- 1.3024537563323975
generate_one_block  0.5496845245361328
generate_one_block  0.543515682220459
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.020917177200317383
gen group dst list time:  0.014355897903442383
time for parepare:  0.018158912658691406
local_output_nid generation:  0.022554397583007812
local_in_edges_tensor generation:  0.03282952308654785
mini_batch_src_global generation:  0.03123950958251953
r_  generation:  0.37860989570617676
local_output_nid generation:  0.031043052673339844
local_in_edges_tensor generation:  0.02866220474243164
mini_batch_src_global generation:  0.037644386291503906
r_  generation:  0.38146328926086426
----------------------check_connections_block total spend ----------------------------- 1.1252565383911133
generate_one_block  0.45361852645874023
generate_one_block  0.45277857780456543
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14543390274047852  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

connection checking time:  2.4277102947235107
block generation total time  1.9995973110198975
average batch blocks generation time:  0.9997986555099487
block dataloader generation time/epoch 5.896420664257473
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10905027389526367  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2259516716003418  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10895252227783203  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2281498908996582  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08456194400787354 |0.02132093906402588 |0.004207968711853027 |0.0005285739898681641 |0.0037556886672973633 |0.0020182132720947266 |
----------------------------------------------------------pseudo_mini_loss sum 1.1047712564468384
Total (block generation + training)time/epoch 6.215465982755025
Training time/epoch 0.3307199478149414
Training time without block to device /epoch 0.28807806968688965
Training time without total dataloading part /epoch 0.019002676010131836
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.09it/s]100%|██████████| 4/4 [00:00<00:00, 29.26it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.67it/s]100%|██████████| 4/4 [00:00<00:00, 12.71it/s]100%|██████████| 4/4 [00:00<00:00, 12.53it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.18it/s]100%|██████████| 4/4 [00:00<00:00, 17.80it/s]100%|██████████| 4/4 [00:00<00:00, 17.68it/s]
Run 00 | Epoch 00045 | Loss 1.1048 | Train 0.3817 | Val 0.4365 | Test 0.4386
Number of nodes during this epoch:  329730
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.144622802734375  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.017194032669067383
range selection method range initialization spend 0.012086629867553711
time for parepare:  0.017235517501831055
local_output_nid generation:  0.011138677597045898
local_in_edges_tensor generation:  0.008486032485961914
mini_batch_src_global generation:  0.01113748550415039
r_  generation:  0.14522409439086914
local_output_nid generation:  0.012124776840209961
local_in_edges_tensor generation:  0.006128072738647461
mini_batch_src_global generation:  0.014234542846679688
r_  generation:  0.15801024436950684
----------------------check_connections_block total spend ----------------------------- 0.44478631019592285
generate_one_block  0.1674332618713379
generate_one_block  0.1712651252746582
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02666759490966797
gen group dst list time:  0.006209373474121094
time for parepare:  0.01986837387084961
local_output_nid generation:  0.016707897186279297
local_in_edges_tensor generation:  0.028888463973999023
mini_batch_src_global generation:  0.0385289192199707
r_  generation:  0.449535608291626
local_output_nid generation:  0.028772354125976562
local_in_edges_tensor generation:  0.025635719299316406
mini_batch_src_global generation:  0.049402713775634766
r_  generation:  0.43553733825683594
----------------------check_connections_block total spend ----------------------------- 1.2834608554840088
generate_one_block  0.5454204082489014
generate_one_block  0.546177864074707
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01860952377319336
gen group dst list time:  0.011979103088378906
time for parepare:  0.018499135971069336
local_output_nid generation:  0.0231935977935791
local_in_edges_tensor generation:  0.038182735443115234
mini_batch_src_global generation:  0.04824471473693848
r_  generation:  0.3789939880371094
local_output_nid generation:  0.031395673751831055
local_in_edges_tensor generation:  0.0325922966003418
mini_batch_src_global generation:  0.039788007736206055
r_  generation:  0.3783583641052246
----------------------check_connections_block total spend ----------------------------- 1.151838779449463
generate_one_block  0.4438488483428955
generate_one_block  0.4508984088897705
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.144622802734375  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

connection checking time:  2.4352996349334717
block generation total time  1.9863455295562744
average batch blocks generation time:  0.9931727647781372
block dataloader generation time/epoch 5.895908162400529
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10997915267944336  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.229353904724121  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.11134719848632812  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2304797172546387  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0790858268737793 |0.01186978816986084 |0.005498647689819336 |0.0005154609680175781 |0.003612041473388672 |0.0014955997467041016 |
----------------------------------------------------------pseudo_mini_loss sum 1.0995053052902222
Total (block generation + training)time/epoch 6.214463665678695
Training time/epoch 0.30078125
Training time without block to device /epoch 0.2770416736602783
Training time without total dataloading part /epoch 0.020747900009155273
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 62.29it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.69it/s]100%|██████████| 4/4 [00:00<00:00, 15.97it/s]100%|██████████| 4/4 [00:00<00:00, 15.91it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.69it/s]100%|██████████| 4/4 [00:00<00:00, 18.24it/s]100%|██████████| 4/4 [00:00<00:00, 18.13it/s]
Run 00 | Epoch 00046 | Loss 1.0995 | Train 0.3755 | Val 0.4220 | Test 0.4242
Number of nodes during this epoch:  329699
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14690303802490234  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018587112426757812
range selection method range initialization spend 0.01570868492126465
time for parepare:  0.015752315521240234
local_output_nid generation:  0.011027097702026367
local_in_edges_tensor generation:  0.008630037307739258
mini_batch_src_global generation:  0.013277053833007812
r_  generation:  0.14751791954040527
local_output_nid generation:  0.011977434158325195
local_in_edges_tensor generation:  0.005666255950927734
mini_batch_src_global generation:  0.01646280288696289
r_  generation:  0.15960073471069336
----------------------check_connections_block total spend ----------------------------- 0.45055508613586426
generate_one_block  0.16707324981689453
generate_one_block  0.16663551330566406
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.026401519775390625
gen group dst list time:  0.006183624267578125
time for parepare:  0.020956039428710938
local_output_nid generation:  0.017081737518310547
local_in_edges_tensor generation:  0.028733491897583008
mini_batch_src_global generation:  0.03875088691711426
r_  generation:  0.4382500648498535
local_output_nid generation:  0.02493143081665039
local_in_edges_tensor generation:  0.024687767028808594
mini_batch_src_global generation:  0.0477604866027832
r_  generation:  0.44654083251953125
----------------------check_connections_block total spend ----------------------------- 1.2787425518035889
generate_one_block  0.5798132419586182
generate_one_block  0.5526683330535889
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.021291494369506836
gen group dst list time:  0.013962984085083008
time for parepare:  0.01829361915588379
local_output_nid generation:  0.0230865478515625
local_in_edges_tensor generation:  0.04275941848754883
mini_batch_src_global generation:  0.031007766723632812
r_  generation:  0.37674784660339355
local_output_nid generation:  0.03147530555725098
local_in_edges_tensor generation:  0.028167247772216797
mini_batch_src_global generation:  0.0375056266784668
r_  generation:  0.38016223907470703
----------------------check_connections_block total spend ----------------------------- 1.1332695484161377
generate_one_block  0.45420289039611816
generate_one_block  0.4695706367492676
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14690303802490234  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

connection checking time:  2.4120121002197266
block generation total time  2.0562551021575928
average batch blocks generation time:  1.0281275510787964
block dataloader generation time/epoch 5.897453352024681
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.11063766479492188  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2337360382080078  GigaBytes
Max Memory Allocated: 1.4725232124328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10883855819702148  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.225656509399414  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07039391994476318 |0.014459371566772461 |0.01652061939239502 |0.0005266666412353516 |0.003918647766113281 |0.002956867218017578 |
----------------------------------------------------------pseudo_mini_loss sum 1.0938377380371094
Total (block generation + training)time/epoch 6.215907391748931
Training time/epoch 0.3145275115966797
Training time without block to device /epoch 0.28560876846313477
Training time without total dataloading part /epoch 0.04488873481750488
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 52.29it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.29it/s]100%|██████████| 4/4 [00:00<00:00, 15.47it/s]100%|██████████| 4/4 [00:00<00:00, 15.43it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.53it/s]100%|██████████| 4/4 [00:00<00:00, 17.53it/s]100%|██████████| 4/4 [00:00<00:00, 17.51it/s]
Run 00 | Epoch 00047 | Loss 1.0938 | Train 0.3695 | Val 0.4091 | Test 0.4105
Number of nodes during this epoch:  329939
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1440272331237793  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01540231704711914
range selection method range initialization spend 0.012123823165893555
time for parepare:  0.01626133918762207
local_output_nid generation:  0.011056661605834961
local_in_edges_tensor generation:  0.008039712905883789
mini_batch_src_global generation:  0.01115107536315918
r_  generation:  0.14536142349243164
local_output_nid generation:  0.011795520782470703
local_in_edges_tensor generation:  0.006554365158081055
mini_batch_src_global generation:  0.014305591583251953
r_  generation:  0.15637993812561035
----------------------check_connections_block total spend ----------------------------- 0.44179368019104004
generate_one_block  0.16734671592712402
generate_one_block  0.16834378242492676
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03069448471069336
gen group dst list time:  0.00624847412109375
time for parepare:  0.01981639862060547
local_output_nid generation:  0.01710224151611328
local_in_edges_tensor generation:  0.027065277099609375
mini_batch_src_global generation:  0.03878498077392578
r_  generation:  0.42928194999694824
local_output_nid generation:  0.02541208267211914
local_in_edges_tensor generation:  0.037262678146362305
mini_batch_src_global generation:  0.0494081974029541
r_  generation:  0.4598731994628906
----------------------check_connections_block total spend ----------------------------- 1.302696943283081
generate_one_block  0.5526740550994873
generate_one_block  0.548607349395752
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.021425247192382812
gen group dst list time:  0.012931346893310547
time for parepare:  0.01844191551208496
local_output_nid generation:  0.022827863693237305
local_in_edges_tensor generation:  0.043109893798828125
mini_batch_src_global generation:  0.03157377243041992
r_  generation:  0.3721122741699219
local_output_nid generation:  0.031290292739868164
local_in_edges_tensor generation:  0.034104347229003906
mini_batch_src_global generation:  0.03805088996887207
r_  generation:  0.3810086250305176
----------------------check_connections_block total spend ----------------------------- 1.137524127960205
generate_one_block  0.4538874626159668
generate_one_block  0.45885396003723145
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1440272331237793  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

connection checking time:  2.440221071243286
block generation total time  2.0140228271484375
average batch blocks generation time:  1.0070114135742188
block dataloader generation time/epoch 5.89770831205906
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10976839065551758  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2279939651489258  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10982704162597656  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2284140586853027  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08092391490936279 |0.02142024040222168 |0.004265427589416504 |0.0005279779434204102 |0.003902435302734375 |0.0014340877532958984 |
----------------------------------------------------------pseudo_mini_loss sum 1.0913106203079224
Total (block generation + training)time/epoch 6.216268893999931
Training time/epoch 0.322460412979126
Training time without block to device /epoch 0.2796199321746826
Training time without total dataloading part /epoch 0.018825769424438477
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.21it/s]100%|██████████| 4/4 [00:00<00:00, 27.76it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.55it/s]100%|██████████| 4/4 [00:00<00:00, 12.01it/s]100%|██████████| 4/4 [00:00<00:00, 11.93it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.73it/s]100%|██████████| 4/4 [00:00<00:00, 17.55it/s]100%|██████████| 4/4 [00:00<00:00, 17.56it/s]
Run 00 | Epoch 00048 | Loss 1.0913 | Train 0.3644 | Val 0.3974 | Test 0.3990
Number of nodes during this epoch:  329830
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14657831192016602  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01913762092590332
range selection method range initialization spend 0.012428760528564453
time for parepare:  0.016006946563720703
local_output_nid generation:  0.010937213897705078
local_in_edges_tensor generation:  0.008065462112426758
mini_batch_src_global generation:  0.011041879653930664
r_  generation:  0.1436634063720703
local_output_nid generation:  0.011693716049194336
local_in_edges_tensor generation:  0.005652666091918945
mini_batch_src_global generation:  0.014899492263793945
r_  generation:  0.15461087226867676
----------------------check_connections_block total spend ----------------------------- 0.4376194477081299
generate_one_block  0.1671137809753418
generate_one_block  0.17058205604553223
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030501365661621094
gen group dst list time:  0.00613093376159668
time for parepare:  0.02138686180114746
local_output_nid generation:  0.01729440689086914
local_in_edges_tensor generation:  0.03275489807128906
mini_batch_src_global generation:  0.04106283187866211
r_  generation:  0.44111084938049316
local_output_nid generation:  0.028317689895629883
local_in_edges_tensor generation:  0.029613733291625977
mini_batch_src_global generation:  0.05011153221130371
r_  generation:  0.44174957275390625
----------------------check_connections_block total spend ----------------------------- 1.2952265739440918
generate_one_block  0.5485153198242188
generate_one_block  0.5533854961395264
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.023024797439575195
gen group dst list time:  0.011956930160522461
time for parepare:  0.018880605697631836
local_output_nid generation:  0.023324251174926758
local_in_edges_tensor generation:  0.03585505485534668
mini_batch_src_global generation:  0.03136301040649414
r_  generation:  0.3702549934387207
local_output_nid generation:  0.031575918197631836
local_in_edges_tensor generation:  0.027229785919189453
mini_batch_src_global generation:  0.0377497673034668
r_  generation:  0.38161277770996094
----------------------check_connections_block total spend ----------------------------- 1.126751184463501
generate_one_block  0.4608292579650879
generate_one_block  0.473527193069458
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14657831192016602  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

connection checking time:  2.4219777584075928
block generation total time  2.036257266998291
average batch blocks generation time:  1.0181286334991455
block dataloader generation time/epoch 5.898479324579239
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10905122756958008  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2269601821899414  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10985183715820312  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.230104923248291  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08066070079803467 |0.01997065544128418 |0.004359006881713867 |0.0005401372909545898 |0.0033038854598999023 |0.0016646385192871094 |
----------------------------------------------------------pseudo_mini_loss sum 1.0890955924987793
Total (block generation + training)time/epoch 6.217258089780808
Training time/epoch 0.327134370803833
Training time without block to device /epoch 0.28719305992126465
Training time without total dataloading part /epoch 0.018070697784423828
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 51.45it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.26it/s]100%|██████████| 4/4 [00:00<00:00, 15.62it/s]100%|██████████| 4/4 [00:00<00:00, 15.55it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.53it/s]100%|██████████| 4/4 [00:00<00:00, 17.85it/s]100%|██████████| 4/4 [00:00<00:00, 17.78it/s]
Run 00 | Epoch 00049 | Loss 1.0891 | Train 0.3599 | Val 0.3891 | Test 0.3894
Number of nodes during this epoch:  329816
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14634275436401367  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.016576528549194336
range selection method range initialization spend 0.012438058853149414
time for parepare:  0.0161588191986084
local_output_nid generation:  0.011063814163208008
local_in_edges_tensor generation:  0.01139974594116211
mini_batch_src_global generation:  0.01108241081237793
r_  generation:  0.14465045928955078
local_output_nid generation:  0.012048959732055664
local_in_edges_tensor generation:  0.00609135627746582
mini_batch_src_global generation:  0.014271020889282227
r_  generation:  0.15450358390808105
----------------------check_connections_block total spend ----------------------------- 0.44280481338500977
generate_one_block  0.1692826747894287
generate_one_block  0.1727137565612793
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02779364585876465
gen group dst list time:  0.006140708923339844
time for parepare:  0.019756078720092773
local_output_nid generation:  0.01752781867980957
local_in_edges_tensor generation:  0.035294532775878906
mini_batch_src_global generation:  0.04047203063964844
r_  generation:  0.4258272647857666
local_output_nid generation:  0.02557826042175293
local_in_edges_tensor generation:  0.023905038833618164
mini_batch_src_global generation:  0.0470578670501709
r_  generation:  0.4335019588470459
----------------------check_connections_block total spend ----------------------------- 1.25588059425354
generate_one_block  0.5455901622772217
generate_one_block  0.535353422164917
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01821279525756836
gen group dst list time:  0.011991739273071289
time for parepare:  0.01869940757751465
local_output_nid generation:  0.023096084594726562
local_in_edges_tensor generation:  0.030574560165405273
mini_batch_src_global generation:  0.03156256675720215
r_  generation:  0.37459635734558105
local_output_nid generation:  0.03156781196594238
local_in_edges_tensor generation:  0.027565956115722656
mini_batch_src_global generation:  0.03748798370361328
r_  generation:  0.375568151473999
----------------------check_connections_block total spend ----------------------------- 1.1152644157409668
generate_one_block  0.4471111297607422
generate_one_block  0.44952893257141113
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14634275436401367  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

connection checking time:  2.371145009994507
block generation total time  1.977583646774292
average batch blocks generation time:  0.988791823387146
block dataloader generation time/epoch 5.896345824730106
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.11053323745727539  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2294049263000488  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1088404655456543  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2264766693115234  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08004724979400635 |0.012339472770690918 |0.004055380821228027 |0.0005096197128295898 |0.0030955076217651367 |0.002805948257446289 |
----------------------------------------------------------pseudo_mini_loss sum 1.0839639902114868
Total (block generation + training)time/epoch 6.214807812760516
Training time/epoch 0.30570030212402344
Training time without block to device /epoch 0.2810213565826416
Training time without total dataloading part /epoch 0.018126964569091797
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 63.87it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.05it/s]100%|██████████| 4/4 [00:00<00:00, 15.23it/s]100%|██████████| 4/4 [00:00<00:00, 15.19it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.12it/s]100%|██████████| 4/4 [00:00<00:00, 17.37it/s]100%|██████████| 4/4 [00:00<00:00, 17.31it/s]
Run 00 | Epoch 00050 | Loss 1.0840 | Train 0.3571 | Val 0.3831 | Test 0.3821
Number of nodes during this epoch:  329767
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14464712142944336  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.013841390609741211
range selection method range initialization spend 0.012250900268554688
time for parepare:  0.016113996505737305
local_output_nid generation:  0.011277914047241211
local_in_edges_tensor generation:  0.007924318313598633
mini_batch_src_global generation:  0.011049985885620117
r_  generation:  0.1460864543914795
local_output_nid generation:  0.012049436569213867
local_in_edges_tensor generation:  0.006227016448974609
mini_batch_src_global generation:  0.015286445617675781
r_  generation:  0.17093348503112793
----------------------check_connections_block total spend ----------------------------- 0.46058177947998047
generate_one_block  0.1704854965209961
generate_one_block  0.17123079299926758
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03233504295349121
gen group dst list time:  0.006175518035888672
time for parepare:  0.019944429397583008
local_output_nid generation:  0.01774001121520996
local_in_edges_tensor generation:  0.03473496437072754
mini_batch_src_global generation:  0.0409696102142334
r_  generation:  0.4241371154785156
local_output_nid generation:  0.02562689781188965
local_in_edges_tensor generation:  0.031386613845825195
mini_batch_src_global generation:  0.04758095741271973
r_  generation:  0.43511271476745605
----------------------check_connections_block total spend ----------------------------- 1.2652993202209473
generate_one_block  0.534900426864624
generate_one_block  0.544560432434082
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.024453401565551758
gen group dst list time:  0.01196146011352539
time for parepare:  0.018746376037597656
local_output_nid generation:  0.023680925369262695
local_in_edges_tensor generation:  0.03274965286254883
mini_batch_src_global generation:  0.03248023986816406
r_  generation:  0.3722968101501465
local_output_nid generation:  0.03304743766784668
local_in_edges_tensor generation:  0.029914379119873047
mini_batch_src_global generation:  0.03770089149475098
r_  generation:  0.3817751407623291
----------------------check_connections_block total spend ----------------------------- 1.126525640487671
generate_one_block  0.4563720226287842
generate_one_block  0.4495694637298584
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14464712142944336  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

connection checking time:  2.391824960708618
block generation total time  1.9854023456573486
average batch blocks generation time:  0.9927011728286743
block dataloader generation time/epoch 5.895396942184085
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10975503921508789  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2282538414001465  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10984945297241211  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2276215553283691  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08319473266601562 |0.012276530265808105 |0.004266142845153809 |0.0005687475204467773 |0.002980828285217285 |0.0036423206329345703 |
----------------------------------------------------------pseudo_mini_loss sum 1.0822606086730957
Total (block generation + training)time/epoch 6.213602804002308
Training time/epoch 0.3075582981109619
Training time without block to device /epoch 0.2830052375793457
Training time without total dataloading part /epoch 0.019273757934570312
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.95it/s]100%|██████████| 4/4 [00:00<00:00, 30.19it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.68it/s]100%|██████████| 4/4 [00:00<00:00, 12.63it/s]100%|██████████| 4/4 [00:00<00:00, 12.46it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.59it/s]100%|██████████| 4/4 [00:00<00:00, 17.69it/s]100%|██████████| 4/4 [00:00<00:00, 17.66it/s]
Run 00 | Epoch 00051 | Loss 1.0823 | Train 0.3545 | Val 0.3783 | Test 0.3766
Number of nodes during this epoch:  329822
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14496564865112305  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019158601760864258
range selection method range initialization spend 0.01211690902709961
time for parepare:  0.0157930850982666
local_output_nid generation:  0.01104116439819336
local_in_edges_tensor generation:  0.008799314498901367
mini_batch_src_global generation:  0.011300325393676758
r_  generation:  0.14412879943847656
local_output_nid generation:  0.011960029602050781
local_in_edges_tensor generation:  0.0062694549560546875
mini_batch_src_global generation:  0.015201330184936523
r_  generation:  0.15489602088928223
----------------------check_connections_block total spend ----------------------------- 0.4418807029724121
generate_one_block  0.16674542427062988
generate_one_block  0.16988015174865723
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02711653709411621
gen group dst list time:  0.006276845932006836
time for parepare:  0.02064800262451172
local_output_nid generation:  0.017264842987060547
local_in_edges_tensor generation:  0.029363155364990234
mini_batch_src_global generation:  0.03865623474121094
r_  generation:  0.42534327507019043
local_output_nid generation:  0.02732706069946289
local_in_edges_tensor generation:  0.025824785232543945
mini_batch_src_global generation:  0.04775094985961914
r_  generation:  0.45158886909484863
----------------------check_connections_block total spend ----------------------------- 1.2766830921173096
generate_one_block  0.568007230758667
generate_one_block  0.5523159503936768
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02173137664794922
gen group dst list time:  0.014080524444580078
time for parepare:  0.020689964294433594
local_output_nid generation:  0.0242002010345459
local_in_edges_tensor generation:  0.03961658477783203
mini_batch_src_global generation:  0.031710147857666016
r_  generation:  0.37070679664611816
local_output_nid generation:  0.033165693283081055
local_in_edges_tensor generation:  0.029482126235961914
mini_batch_src_global generation:  0.03773999214172363
r_  generation:  0.37723851203918457
----------------------check_connections_block total spend ----------------------------- 1.1296656131744385
generate_one_block  0.4460568428039551
generate_one_block  0.44914698600769043
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14496564865112305  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

connection checking time:  2.406348705291748
block generation total time  2.0155270099639893
average batch blocks generation time:  1.0077635049819946
block dataloader generation time/epoch 5.894837628963382
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10900306701660156  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2257885932922363  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10982370376586914  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2298531532287598  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08211171627044678 |0.015869975090026855 |0.004276394844055176 |0.0005061626434326172 |0.002875208854675293 |0.0014090538024902344 |
----------------------------------------------------------pseudo_mini_loss sum 1.0751702785491943
Total (block generation + training)time/epoch 6.21311342993448
Training time/epoch 0.32106971740722656
Training time without block to device /epoch 0.28932976722717285
Training time without total dataloading part /epoch 0.016724586486816406
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 58.69it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.92it/s]100%|██████████| 4/4 [00:00<00:00, 15.39it/s]100%|██████████| 4/4 [00:00<00:00, 15.30it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.37it/s]100%|██████████| 4/4 [00:00<00:00, 17.64it/s]100%|██████████| 4/4 [00:00<00:00, 17.58it/s]
Run 00 | Epoch 00052 | Loss 1.0752 | Train 0.3517 | Val 0.3755 | Test 0.3726
Number of nodes during this epoch:  329701
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14632511138916016  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.016563892364501953
range selection method range initialization spend 0.011845111846923828
time for parepare:  0.016831159591674805
local_output_nid generation:  0.010945558547973633
local_in_edges_tensor generation:  0.008036375045776367
mini_batch_src_global generation:  0.01109457015991211
r_  generation:  0.1448373794555664
local_output_nid generation:  0.012767553329467773
local_in_edges_tensor generation:  0.005661487579345703
mini_batch_src_global generation:  0.01454615592956543
r_  generation:  0.15595126152038574
----------------------check_connections_block total spend ----------------------------- 0.4417240619659424
generate_one_block  0.1670074462890625
generate_one_block  0.1695706844329834
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0291750431060791
gen group dst list time:  0.006146907806396484
time for parepare:  0.020416259765625
local_output_nid generation:  0.01691150665283203
local_in_edges_tensor generation:  0.02913188934326172
mini_batch_src_global generation:  0.040357351303100586
r_  generation:  0.42469120025634766
local_output_nid generation:  0.027152299880981445
local_in_edges_tensor generation:  0.02727508544921875
mini_batch_src_global generation:  0.04747176170349121
r_  generation:  0.43841028213500977
----------------------check_connections_block total spend ----------------------------- 1.2617394924163818
generate_one_block  0.5438442230224609
generate_one_block  0.5407288074493408
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.017677783966064453
gen group dst list time:  0.011909008026123047
time for parepare:  0.020726919174194336
local_output_nid generation:  0.023017168045043945
local_in_edges_tensor generation:  0.02987837791442871
mini_batch_src_global generation:  0.0311892032623291
r_  generation:  0.3747084140777588
local_output_nid generation:  0.03335905075073242
local_in_edges_tensor generation:  0.02869701385498047
mini_batch_src_global generation:  0.040712833404541016
r_  generation:  0.37667059898376465
----------------------check_connections_block total spend ----------------------------- 1.124410629272461
generate_one_block  0.45138120651245117
generate_one_block  0.4477553367614746
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14632511138916016  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

connection checking time:  2.3861501216888428
block generation total time  1.9837095737457275
average batch blocks generation time:  0.9918547868728638
block dataloader generation time/epoch 5.893100137060339
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1105031967163086  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2270092964172363  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1089029312133789  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2268309593200684  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08432555198669434 |0.014820694923400879 |0.0039403438568115234 |0.0005090236663818359 |0.003464221954345703 |0.001844644546508789 |
----------------------------------------------------------pseudo_mini_loss sum 1.0685205459594727
Total (block generation + training)time/epoch 6.21132705970244
Training time/epoch 0.3160412311553955
Training time without block to device /epoch 0.28639984130859375
Training time without total dataloading part /epoch 0.017671823501586914
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 39.97it/s]100%|██████████| 4/4 [00:00<00:00, 39.88it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.65it/s]100%|██████████| 4/4 [00:00<00:00, 15.15it/s]100%|██████████| 4/4 [00:00<00:00, 15.06it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.53it/s]100%|██████████| 4/4 [00:00<00:00, 17.84it/s]100%|██████████| 4/4 [00:00<00:00, 17.77it/s]
Run 00 | Epoch 00053 | Loss 1.0685 | Train 0.3498 | Val 0.3743 | Test 0.3712
Number of nodes during this epoch:  329716
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14559078216552734  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.015865087509155273
range selection method range initialization spend 0.012279272079467773
time for parepare:  0.016849279403686523
local_output_nid generation:  0.012597799301147461
local_in_edges_tensor generation:  0.01126241683959961
mini_batch_src_global generation:  0.011209726333618164
r_  generation:  0.14388728141784668
local_output_nid generation:  0.013675212860107422
local_in_edges_tensor generation:  0.006313800811767578
mini_batch_src_global generation:  0.014110088348388672
r_  generation:  0.15477728843688965
----------------------check_connections_block total spend ----------------------------- 0.44728732109069824
generate_one_block  0.16842436790466309
generate_one_block  0.1698441505432129
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0247037410736084
gen group dst list time:  0.0061779022216796875
time for parepare:  0.020176172256469727
local_output_nid generation:  0.018045425415039062
local_in_edges_tensor generation:  0.03278851509094238
mini_batch_src_global generation:  0.038556575775146484
r_  generation:  0.4212977886199951
local_output_nid generation:  0.02823472023010254
local_in_edges_tensor generation:  0.025648832321166992
mini_batch_src_global generation:  0.047452688217163086
r_  generation:  0.4387032985687256
----------------------check_connections_block total spend ----------------------------- 1.2579686641693115
generate_one_block  0.5502490997314453
generate_one_block  0.5666658878326416
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.024249553680419922
gen group dst list time:  0.014005661010742188
time for parepare:  0.018938541412353516
local_output_nid generation:  0.023413419723510742
local_in_edges_tensor generation:  0.04558706283569336
mini_batch_src_global generation:  0.03986620903015137
r_  generation:  0.3666224479675293
local_output_nid generation:  0.03094625473022461
local_in_edges_tensor generation:  0.03276991844177246
mini_batch_src_global generation:  0.039151906967163086
r_  generation:  0.3762705326080322
----------------------check_connections_block total spend ----------------------------- 1.1363279819488525
generate_one_block  0.46262121200561523
generate_one_block  0.44555163383483887
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14559078216552734  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

connection checking time:  2.394296646118164
block generation total time  2.025087833404541
average batch blocks generation time:  1.0125439167022705
block dataloader generation time/epoch 5.892886437310112
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10977602005004883  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2278504371643066  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10983085632324219  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2297019958496094  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08177530765533447 |0.017057299613952637 |0.004179954528808594 |0.0005189180374145508 |0.0028188228607177734 |0.002608776092529297 |
----------------------------------------------------------pseudo_mini_loss sum 1.0667794942855835
Total (block generation + training)time/epoch 6.21124562157525
Training time/epoch 0.3240230083465576
Training time without block to device /epoch 0.28990840911865234
Training time without total dataloading part /epoch 0.017644166946411133
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.51it/s]100%|██████████| 4/4 [00:00<00:00, 29.98it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.79it/s]100%|██████████| 4/4 [00:00<00:00, 12.88it/s]100%|██████████| 4/4 [00:00<00:00, 12.69it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.74it/s]100%|██████████| 4/4 [00:00<00:00, 18.12it/s]100%|██████████| 4/4 [00:00<00:00, 18.05it/s]
Run 00 | Epoch 00054 | Loss 1.0668 | Train 0.3478 | Val 0.3716 | Test 0.3685
Number of nodes during this epoch:  329815
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14602279663085938  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.015028238296508789
range selection method range initialization spend 0.011773824691772461
time for parepare:  0.015731096267700195
local_output_nid generation:  0.010852336883544922
local_in_edges_tensor generation:  0.008102893829345703
mini_batch_src_global generation:  0.010975122451782227
r_  generation:  0.1437208652496338
local_output_nid generation:  0.012063980102539062
local_in_edges_tensor generation:  0.0056340694427490234
mini_batch_src_global generation:  0.01430058479309082
r_  generation:  0.15447783470153809
----------------------check_connections_block total spend ----------------------------- 0.4372584819793701
generate_one_block  0.1647651195526123
generate_one_block  0.1682724952697754
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029591083526611328
gen group dst list time:  0.006006479263305664
time for parepare:  0.019634246826171875
local_output_nid generation:  0.01620197296142578
local_in_edges_tensor generation:  0.030498743057250977
mini_batch_src_global generation:  0.03881502151489258
r_  generation:  0.4215414524078369
local_output_nid generation:  0.025875329971313477
local_in_edges_tensor generation:  0.0249936580657959
mini_batch_src_global generation:  0.04714369773864746
r_  generation:  0.44457030296325684
----------------------check_connections_block total spend ----------------------------- 1.2634475231170654
generate_one_block  0.5694935321807861
generate_one_block  0.5532882213592529
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02824854850769043
gen group dst list time:  0.01198124885559082
time for parepare:  0.01889324188232422
local_output_nid generation:  0.022825956344604492
local_in_edges_tensor generation:  0.0330348014831543
mini_batch_src_global generation:  0.031404733657836914
r_  generation:  0.37207770347595215
local_output_nid generation:  0.03356146812438965
local_in_edges_tensor generation:  0.03216433525085449
mini_batch_src_global generation:  0.03909420967102051
r_  generation:  0.3758506774902344
----------------------check_connections_block total spend ----------------------------- 1.134329080581665
generate_one_block  0.4417288303375244
generate_one_block  0.4469888210296631
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14602279663085938  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

connection checking time:  2.3977766036987305
block generation total time  2.0114994049072266
average batch blocks generation time:  1.0057497024536133
block dataloader generation time/epoch 5.89224868753682
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.11042594909667969  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2270607948303223  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10980653762817383  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.229644775390625  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08306097984313965 |0.021123409271240234 |0.004087567329406738 |0.0005117654800415039 |0.002958059310913086 |0.0017633438110351562 |
----------------------------------------------------------pseudo_mini_loss sum 1.0670301914215088
Total (block generation + training)time/epoch 6.210819104443425
Training time/epoch 0.3279294967651367
Training time without block to device /epoch 0.28568267822265625
Training time without total dataloading part /epoch 0.016878128051757812
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 52.48it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.16it/s]100%|██████████| 4/4 [00:00<00:00, 15.60it/s]100%|██████████| 4/4 [00:00<00:00, 15.51it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.37it/s]100%|██████████| 4/4 [00:00<00:00, 17.87it/s]100%|██████████| 4/4 [00:00<00:00, 17.77it/s]
Run 00 | Epoch 00055 | Loss 1.0670 | Train 0.3467 | Val 0.3698 | Test 0.3664
Number of nodes during this epoch:  329593
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1463637351989746  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.014274120330810547
range selection method range initialization spend 0.01173710823059082
time for parepare:  0.015525341033935547
local_output_nid generation:  0.010785818099975586
local_in_edges_tensor generation:  0.010277986526489258
mini_batch_src_global generation:  0.011003732681274414
r_  generation:  0.14465761184692383
local_output_nid generation:  0.011783599853515625
local_in_edges_tensor generation:  0.005755901336669922
mini_batch_src_global generation:  0.014310121536254883
r_  generation:  0.1532442569732666
----------------------check_connections_block total spend ----------------------------- 0.4379861354827881
generate_one_block  0.16534090042114258
generate_one_block  0.16765832901000977
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03209519386291504
gen group dst list time:  0.006148815155029297
time for parepare:  0.01953887939453125
local_output_nid generation:  0.016479969024658203
local_in_edges_tensor generation:  0.030411720275878906
mini_batch_src_global generation:  0.03996706008911133
r_  generation:  0.41652584075927734
local_output_nid generation:  0.02469325065612793
local_in_edges_tensor generation:  0.02401280403137207
mini_batch_src_global generation:  0.04726862907409668
r_  generation:  0.4286468029022217
----------------------check_connections_block total spend ----------------------------- 1.2351469993591309
generate_one_block  0.5354828834533691
generate_one_block  0.531700849533081
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02269268035888672
gen group dst list time:  0.011895895004272461
time for parepare:  0.01862359046936035
local_output_nid generation:  0.023265600204467773
local_in_edges_tensor generation:  0.0290071964263916
mini_batch_src_global generation:  0.03077864646911621
r_  generation:  0.3641672134399414
local_output_nid generation:  0.030614614486694336
local_in_edges_tensor generation:  0.026605606079101562
mini_batch_src_global generation:  0.037222862243652344
r_  generation:  0.370006799697876
----------------------check_connections_block total spend ----------------------------- 1.0940356254577637
generate_one_block  0.44222283363342285
generate_one_block  0.44083523750305176
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1463637351989746  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

connection checking time:  2.3291826248168945
block generation total time  1.9502418041229248
average batch blocks generation time:  0.9751209020614624
block dataloader generation time/epoch 5.888647886032754
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.11054754257202148  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2277288436889648  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10980367660522461  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2294392585754395  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08022201061248779 |0.011664390563964844 |0.003875732421875 |0.000518798828125 |0.0032808780670166016 |0.0014078617095947266 |
----------------------------------------------------------pseudo_mini_loss sum 1.0597947835922241
Total (block generation + training)time/epoch 6.206920436088075
Training time/epoch 0.3044891357421875
Training time without block to device /epoch 0.2811603546142578
Training time without total dataloading part /epoch 0.01675868034362793
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.40it/s]100%|██████████| 4/4 [00:00<00:00, 31.69it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.78it/s]100%|██████████| 4/4 [00:00<00:00, 12.83it/s]100%|██████████| 4/4 [00:00<00:00, 12.65it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.82it/s]100%|██████████| 4/4 [00:00<00:00, 17.70it/s]100%|██████████| 4/4 [00:00<00:00, 17.70it/s]
Run 00 | Epoch 00056 | Loss 1.0598 | Train 0.3446 | Val 0.3654 | Test 0.3614
Number of nodes during this epoch:  329714
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14650678634643555  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01434469223022461
range selection method range initialization spend 0.011853694915771484
time for parepare:  0.016640186309814453
local_output_nid generation:  0.011028289794921875
local_in_edges_tensor generation:  0.007940530776977539
mini_batch_src_global generation:  0.011113166809082031
r_  generation:  0.14399361610412598
local_output_nid generation:  0.012084484100341797
local_in_edges_tensor generation:  0.005642414093017578
mini_batch_src_global generation:  0.014557123184204102
r_  generation:  0.15445470809936523
----------------------check_connections_block total spend ----------------------------- 0.4389028549194336
generate_one_block  0.16569972038269043
generate_one_block  0.1675701141357422
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028347015380859375
gen group dst list time:  0.006157398223876953
time for parepare:  0.019678592681884766
local_output_nid generation:  0.017256975173950195
local_in_edges_tensor generation:  0.02452683448791504
mini_batch_src_global generation:  0.03894472122192383
r_  generation:  0.41925477981567383
local_output_nid generation:  0.025244474411010742
local_in_edges_tensor generation:  0.03855276107788086
mini_batch_src_global generation:  0.04712700843811035
r_  generation:  0.43198728561401367
----------------------check_connections_block total spend ----------------------------- 1.2503166198730469
generate_one_block  0.5309960842132568
generate_one_block  0.5453929901123047
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.020605802536010742
gen group dst list time:  0.012553930282592773
time for parepare:  0.018738985061645508
local_output_nid generation:  0.02306079864501953
local_in_edges_tensor generation:  0.029369831085205078
mini_batch_src_global generation:  0.031295061111450195
r_  generation:  0.3663599491119385
local_output_nid generation:  0.0307157039642334
local_in_edges_tensor generation:  0.026770591735839844
mini_batch_src_global generation:  0.037268638610839844
r_  generation:  0.38028931617736816
----------------------check_connections_block total spend ----------------------------- 1.1088142395019531
generate_one_block  0.4434022903442383
generate_one_block  0.4477074146270752
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14650678634643555  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

connection checking time:  2.359130859375
block generation total time  1.967498779296875
average batch blocks generation time:  0.9837493896484375
block dataloader generation time/epoch 5.88537135720253
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.11060476303100586  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2289061546325684  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10889577865600586  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.226247787475586  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08023762702941895 |0.013831496238708496 |0.0038356781005859375 |0.000496983528137207 |0.003540515899658203 |0.002841472625732422 |
----------------------------------------------------------pseudo_mini_loss sum 1.0603630542755127
Total (block generation + training)time/epoch 6.203347489237785
Training time/epoch 0.3039426803588867
Training time without block to device /epoch 0.2762796878814697
Training time without total dataloading part /epoch 0.018587827682495117
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.66it/s]100%|██████████| 4/4 [00:00<00:00, 30.57it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.72it/s]100%|██████████| 4/4 [00:00<00:00, 11.52it/s]100%|██████████| 4/4 [00:00<00:00, 11.54it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.04it/s]100%|██████████| 4/4 [00:00<00:00, 16.66it/s]100%|██████████| 4/4 [00:00<00:00, 16.38it/s]
Run 00 | Epoch 00057 | Loss 1.0604 | Train 0.3413 | Val 0.3598 | Test 0.3542
Number of nodes during this epoch:  329835
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14570856094360352  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01617431640625
range selection method range initialization spend 0.012429475784301758
time for parepare:  0.016762495040893555
local_output_nid generation:  0.01100468635559082
local_in_edges_tensor generation:  0.011583328247070312
mini_batch_src_global generation:  0.011085748672485352
r_  generation:  0.14556884765625
local_output_nid generation:  0.012061834335327148
local_in_edges_tensor generation:  0.00585627555847168
mini_batch_src_global generation:  0.014395952224731445
r_  generation:  0.15669584274291992
----------------------check_connections_block total spend ----------------------------- 0.4465646743774414
generate_one_block  0.16784095764160156
generate_one_block  0.17062735557556152
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028939008712768555
gen group dst list time:  0.006364107131958008
time for parepare:  0.02199721336364746
local_output_nid generation:  0.01761007308959961
local_in_edges_tensor generation:  0.03220176696777344
mini_batch_src_global generation:  0.03938412666320801
r_  generation:  0.4284331798553467
local_output_nid generation:  0.02542710304260254
local_in_edges_tensor generation:  0.02663874626159668
mini_batch_src_global generation:  0.04806947708129883
r_  generation:  0.44066476821899414
----------------------check_connections_block total spend ----------------------------- 1.2692348957061768
generate_one_block  0.5459029674530029
generate_one_block  0.5456912517547607
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02153325080871582
gen group dst list time:  0.011924982070922852
time for parepare:  0.019205093383789062
local_output_nid generation:  0.02447819709777832
local_in_edges_tensor generation:  0.03191971778869629
mini_batch_src_global generation:  0.031359195709228516
r_  generation:  0.3756251335144043
local_output_nid generation:  0.03157687187194824
local_in_edges_tensor generation:  0.02755570411682129
mini_batch_src_global generation:  0.03837084770202637
r_  generation:  0.38707756996154785
----------------------check_connections_block total spend ----------------------------- 1.1368067264556885
generate_one_block  0.4650604724884033
generate_one_block  0.4666602611541748
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14570856094360352  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

connection checking time:  2.4060416221618652
block generation total time  2.023314952850342
average batch blocks generation time:  1.011657476425171
block dataloader generation time/epoch 5.88552924078338
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10978841781616211  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2279162406921387  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1097865104675293  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2291383743286133  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07850527763366699 |0.020171761512756348 |0.004379868507385254 |0.0005277395248413086 |0.0030368566513061523 |0.001451253890991211 |
----------------------------------------------------------pseudo_mini_loss sum 1.0509939193725586
Total (block generation + training)time/epoch 6.203415992308636
Training time/epoch 0.31345200538635254
Training time without block to device /epoch 0.27310848236083984
Training time without total dataloading part /epoch 0.01734018325805664
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 43.91it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.49it/s]100%|██████████| 4/4 [00:00<00:00, 15.57it/s]100%|██████████| 4/4 [00:00<00:00, 15.54it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.13it/s]100%|██████████| 4/4 [00:00<00:00, 17.60it/s]100%|██████████| 4/4 [00:00<00:00, 17.51it/s]
Run 00 | Epoch 00058 | Loss 1.0510 | Train 0.3366 | Val 0.3510 | Test 0.3442
Number of nodes during this epoch:  329631
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1466364860534668  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.015501976013183594
range selection method range initialization spend 0.012059688568115234
time for parepare:  0.016176223754882812
local_output_nid generation:  0.010921001434326172
local_in_edges_tensor generation:  0.008908510208129883
mini_batch_src_global generation:  0.01108098030090332
r_  generation:  0.1442701816558838
local_output_nid generation:  0.012027502059936523
local_in_edges_tensor generation:  0.005783557891845703
mini_batch_src_global generation:  0.014303922653198242
r_  generation:  0.15975117683410645
----------------------check_connections_block total spend ----------------------------- 0.44478750228881836
generate_one_block  0.16629815101623535
generate_one_block  0.17009520530700684
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.027414321899414062
gen group dst list time:  0.0062465667724609375
time for parepare:  0.02139878273010254
local_output_nid generation:  0.017791032791137695
local_in_edges_tensor generation:  0.02990889549255371
mini_batch_src_global generation:  0.041120290756225586
r_  generation:  0.4293055534362793
local_output_nid generation:  0.027985811233520508
local_in_edges_tensor generation:  0.026002168655395508
mini_batch_src_global generation:  0.0482325553894043
r_  generation:  0.4417266845703125
----------------------check_connections_block total spend ----------------------------- 1.274085283279419
generate_one_block  0.5547397136688232
generate_one_block  0.5768318176269531
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01966238021850586
gen group dst list time:  0.014026641845703125
time for parepare:  0.020455360412597656
local_output_nid generation:  0.025047779083251953
local_in_edges_tensor generation:  0.04270029067993164
mini_batch_src_global generation:  0.034195661544799805
r_  generation:  0.37765932083129883
local_output_nid generation:  0.03173065185546875
local_in_edges_tensor generation:  0.02947711944580078
mini_batch_src_global generation:  0.03786611557006836
r_  generation:  0.3857696056365967
----------------------check_connections_block total spend ----------------------------- 1.1629233360290527
generate_one_block  0.46335625648498535
generate_one_block  0.4681692123413086
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1466364860534668  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

connection checking time:  2.4370086193084717
block generation total time  2.0630970001220703
average batch blocks generation time:  1.0315485000610352
block dataloader generation time/epoch 5.887158069610596
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1106710433959961  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2285118103027344  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1089177131652832  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2271146774291992  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08253264427185059 |0.017882227897644043 |0.004238724708557129 |0.0005252361297607422 |0.003933906555175781 |0.0015223026275634766 |
----------------------------------------------------------pseudo_mini_loss sum 1.0505553483963013
Total (block generation + training)time/epoch 6.2050219249725345
Training time/epoch 0.3165912628173828
Training time without block to device /epoch 0.2808268070220947
Training time without total dataloading part /epoch 0.01891803741455078
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 45.24it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.17it/s]100%|██████████| 4/4 [00:00<00:00, 15.47it/s]100%|██████████| 4/4 [00:00<00:00, 15.41it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.40it/s]100%|██████████| 4/4 [00:00<00:00, 17.63it/s]100%|██████████| 4/4 [00:00<00:00, 17.57it/s]
Run 00 | Epoch 00059 | Loss 1.0506 | Train 0.3321 | Val 0.3418 | Test 0.3341
Number of nodes during this epoch:  329802
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14543581008911133  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.015105247497558594
range selection method range initialization spend 0.012436866760253906
time for parepare:  0.016420364379882812
local_output_nid generation:  0.011070966720581055
local_in_edges_tensor generation:  0.008167743682861328
mini_batch_src_global generation:  0.011200428009033203
r_  generation:  0.14841651916503906
local_output_nid generation:  0.012152433395385742
local_in_edges_tensor generation:  0.005877971649169922
mini_batch_src_global generation:  0.014309167861938477
r_  generation:  0.15671896934509277
----------------------check_connections_block total spend ----------------------------- 0.44616270065307617
generate_one_block  0.1674966812133789
generate_one_block  0.17141437530517578
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02842235565185547
gen group dst list time:  0.006300687789916992
time for parepare:  0.01972508430480957
local_output_nid generation:  0.01731085777282715
local_in_edges_tensor generation:  0.026751041412353516
mini_batch_src_global generation:  0.04738593101501465
r_  generation:  0.44193243980407715
local_output_nid generation:  0.029417037963867188
local_in_edges_tensor generation:  0.024021387100219727
mini_batch_src_global generation:  0.04810667037963867
r_  generation:  0.4399700164794922
----------------------check_connections_block total spend ----------------------------- 1.2848880290985107
generate_one_block  0.5455210208892822
generate_one_block  0.5418822765350342
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02259063720703125
gen group dst list time:  0.012108564376831055
time for parepare:  0.019277095794677734
local_output_nid generation:  0.024027585983276367
local_in_edges_tensor generation:  0.037132978439331055
mini_batch_src_global generation:  0.031646728515625
r_  generation:  0.37009620666503906
local_output_nid generation:  0.031511545181274414
local_in_edges_tensor generation:  0.02655339241027832
mini_batch_src_global generation:  0.037810325622558594
r_  generation:  0.37812232971191406
----------------------check_connections_block total spend ----------------------------- 1.1197197437286377
generate_one_block  0.4483160972595215
generate_one_block  0.4511106014251709
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14543581008911133  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

connection checking time:  2.4046077728271484
block generation total time  1.9868299961090088
average batch blocks generation time:  0.9934149980545044
block dataloader generation time/epoch 5.886501639497046
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10980939865112305  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2279777526855469  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10980606079101562  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2297029495239258  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08409976959228516 |0.012056112289428711 |0.004220843315124512 |0.0005108118057250977 |0.0032324790954589844 |0.002942323684692383 |
----------------------------------------------------------pseudo_mini_loss sum 1.0465397834777832
Total (block generation + training)time/epoch 6.2042562307096
Training time/epoch 0.3121457099914551
Training time without block to device /epoch 0.28803348541259766
Training time without total dataloading part /epoch 0.01887059211730957
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.71it/s]100%|██████████| 4/4 [00:00<00:00, 30.61it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.53it/s]100%|██████████| 4/4 [00:00<00:00, 12.64it/s]100%|██████████| 4/4 [00:00<00:00, 12.45it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.70it/s]100%|██████████| 4/4 [00:00<00:00, 17.80it/s]100%|██████████| 4/4 [00:00<00:00, 17.77it/s]
Run 00 | Epoch 00060 | Loss 1.0465 | Train 0.3275 | Val 0.3321 | Test 0.3240
Number of nodes during this epoch:  329733
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14658832550048828  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.013289451599121094
range selection method range initialization spend 0.012030363082885742
time for parepare:  0.0158388614654541
local_output_nid generation:  0.011022806167602539
local_in_edges_tensor generation:  0.007915258407592773
mini_batch_src_global generation:  0.011183738708496094
r_  generation:  0.14560961723327637
local_output_nid generation:  0.012061834335327148
local_in_edges_tensor generation:  0.005745887756347656
mini_batch_src_global generation:  0.014745473861694336
r_  generation:  0.15560317039489746
----------------------check_connections_block total spend ----------------------------- 0.44102978706359863
generate_one_block  0.16783595085144043
generate_one_block  0.16923260688781738
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02919459342956543
gen group dst list time:  0.006247758865356445
time for parepare:  0.019839763641357422
local_output_nid generation:  0.01753377914428711
local_in_edges_tensor generation:  0.02743363380432129
mini_batch_src_global generation:  0.039118289947509766
r_  generation:  0.4298055171966553
local_output_nid generation:  0.025447607040405273
local_in_edges_tensor generation:  0.02380061149597168
mini_batch_src_global generation:  0.049721717834472656
r_  generation:  0.44094038009643555
----------------------check_connections_block total spend ----------------------------- 1.261387586593628
generate_one_block  0.5495569705963135
generate_one_block  0.5789632797241211
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.020891666412353516
gen group dst list time:  0.01398611068725586
time for parepare:  0.018799543380737305
local_output_nid generation:  0.024718761444091797
local_in_edges_tensor generation:  0.04202699661254883
mini_batch_src_global generation:  0.032830238342285156
r_  generation:  0.37113285064697266
local_output_nid generation:  0.0317380428314209
local_in_edges_tensor generation:  0.0325314998626709
mini_batch_src_global generation:  0.037683725357055664
r_  generation:  0.3823986053466797
----------------------check_connections_block total spend ----------------------------- 1.137855052947998
generate_one_block  0.4484286308288574
generate_one_block  0.44782376289367676
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14658832550048828  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

connection checking time:  2.399242639541626
block generation total time  2.0247726440429688
average batch blocks generation time:  1.0123863220214844
block dataloader generation time/epoch 5.886255245942336
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.11065340042114258  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2277684211730957  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10980033874511719  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2275443077087402  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0835118293762207 |0.015345096588134766 |0.004126906394958496 |0.0005142688751220703 |0.0027521848678588867 |0.001603841781616211 |
----------------------------------------------------------pseudo_mini_loss sum 1.0448262691497803
Total (block generation + training)time/epoch 6.20383097575261
Training time/epoch 0.30831289291381836
Training time without block to device /epoch 0.27762269973754883
Training time without total dataloading part /epoch 0.016390562057495117
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 56.86it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.84it/s]100%|██████████| 4/4 [00:00<00:00, 15.47it/s]100%|██████████| 4/4 [00:00<00:00, 15.36it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.38it/s]100%|██████████| 4/4 [00:00<00:00, 17.50it/s]100%|██████████| 4/4 [00:00<00:00, 17.46it/s]
Run 00 | Epoch 00061 | Loss 1.0448 | Train 0.3244 | Val 0.3246 | Test 0.3161
Number of nodes during this epoch:  329748
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14595556259155273  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.016585111618041992
range selection method range initialization spend 0.012588024139404297
time for parepare:  0.015903949737548828
local_output_nid generation:  0.010987520217895508
local_in_edges_tensor generation:  0.007867097854614258
mini_batch_src_global generation:  0.011118412017822266
r_  generation:  0.1449437141418457
local_output_nid generation:  0.011949300765991211
local_in_edges_tensor generation:  0.0057485103607177734
mini_batch_src_global generation:  0.014763832092285156
r_  generation:  0.15889191627502441
----------------------check_connections_block total spend ----------------------------- 0.44309425354003906
generate_one_block  0.16736412048339844
generate_one_block  0.17062807083129883
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02850055694580078
gen group dst list time:  0.00629425048828125
time for parepare:  0.020846128463745117
local_output_nid generation:  0.017950773239135742
local_in_edges_tensor generation:  0.02537226676940918
mini_batch_src_global generation:  0.03920888900756836
r_  generation:  0.43973398208618164
local_output_nid generation:  0.025523662567138672
local_in_edges_tensor generation:  0.02628183364868164
mini_batch_src_global generation:  0.04936337471008301
r_  generation:  0.4444451332092285
----------------------check_connections_block total spend ----------------------------- 1.2789151668548584
generate_one_block  0.5550012588500977
generate_one_block  0.5800378322601318
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02620387077331543
gen group dst list time:  0.014492273330688477
time for parepare:  0.018820524215698242
local_output_nid generation:  0.02504730224609375
local_in_edges_tensor generation:  0.04507040977478027
mini_batch_src_global generation:  0.03438282012939453
r_  generation:  0.3810539245605469
local_output_nid generation:  0.03229093551635742
local_in_edges_tensor generation:  0.03380775451660156
mini_batch_src_global generation:  0.03852963447570801
r_  generation:  0.38003993034362793
----------------------check_connections_block total spend ----------------------------- 1.1548008918762207
generate_one_block  0.44986820220947266
generate_one_block  0.4560718536376953
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14595556259155273  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

connection checking time:  2.433716058731079
block generation total time  2.0409791469573975
average batch blocks generation time:  1.0204895734786987
block dataloader generation time/epoch 5.887341773734902
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10906696319580078  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2280092239379883  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10983657836914062  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.228978157043457  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09906578063964844 |0.017273664474487305 |0.004772543907165527 |0.0006527900695800781 |0.00281679630279541 |0.0017778873443603516 |
----------------------------------------------------------pseudo_mini_loss sum 1.0403783321380615
Total (block generation + training)time/epoch 6.205390718747985
Training time/epoch 0.34250831604003906
Training time without block to device /epoch 0.30796098709106445
Training time without total dataloading part /epoch 0.018262147903442383
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.00it/s]100%|██████████| 4/4 [00:00<00:00, 29.02it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.83it/s]100%|██████████| 4/4 [00:00<00:00, 13.06it/s]100%|██████████| 4/4 [00:00<00:00, 12.85it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.07it/s]100%|██████████| 4/4 [00:00<00:00, 18.56it/s]100%|██████████| 4/4 [00:00<00:00, 18.47it/s]
Run 00 | Epoch 00062 | Loss 1.0404 | Train 0.3223 | Val 0.3198 | Test 0.3098
Number of nodes during this epoch:  329890
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14542675018310547  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.014438867568969727
range selection method range initialization spend 0.012777566909790039
time for parepare:  0.015787601470947266
local_output_nid generation:  0.010983943939208984
local_in_edges_tensor generation:  0.008034706115722656
mini_batch_src_global generation:  0.011105537414550781
r_  generation:  0.1466672420501709
local_output_nid generation:  0.012024402618408203
local_in_edges_tensor generation:  0.005667686462402344
mini_batch_src_global generation:  0.014339923858642578
r_  generation:  0.15578413009643555
----------------------check_connections_block total spend ----------------------------- 0.4417083263397217
generate_one_block  0.16646981239318848
generate_one_block  0.16858935356140137
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.027095317840576172
gen group dst list time:  0.006134510040283203
time for parepare:  0.02045440673828125
local_output_nid generation:  0.017230510711669922
local_in_edges_tensor generation:  0.036483049392700195
mini_batch_src_global generation:  0.038626670837402344
r_  generation:  0.4255030155181885
local_output_nid generation:  0.026926279067993164
local_in_edges_tensor generation:  0.02494525909423828
mini_batch_src_global generation:  0.04723167419433594
r_  generation:  0.4375040531158447
----------------------check_connections_block total spend ----------------------------- 1.2636449337005615
generate_one_block  0.5492510795593262
generate_one_block  0.569957971572876
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030117034912109375
gen group dst list time:  0.014083385467529297
time for parepare:  0.0188291072845459
local_output_nid generation:  0.024480342864990234
local_in_edges_tensor generation:  0.04022574424743652
mini_batch_src_global generation:  0.030848026275634766
r_  generation:  0.36907196044921875
local_output_nid generation:  0.030808687210083008
local_in_edges_tensor generation:  0.0330965518951416
mini_batch_src_global generation:  0.03908944129943848
r_  generation:  0.377457857131958
----------------------check_connections_block total spend ----------------------------- 1.1263532638549805
generate_one_block  0.44863057136535645
generate_one_block  0.4416980743408203
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14542675018310547  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

connection checking time:  2.389998197555542
block generation total time  2.009537696838379
average batch blocks generation time:  1.0047688484191895
block dataloader generation time/epoch 5.8869165314568415
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10906553268432617  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.228161334991455  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10887622833251953  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.225550651550293  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08179795742034912 |0.015715718269348145 |0.0041086673736572266 |0.0005203485488891602 |0.003856658935546875 |0.002887725830078125 |
----------------------------------------------------------pseudo_mini_loss sum 1.040708303451538
Total (block generation + training)time/epoch 6.2048849706296565
Training time/epoch 0.31355810165405273
Training time without block to device /epoch 0.28212666511535645
Training time without total dataloading part /epoch 0.01985907554626465
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.32it/s]100%|██████████| 4/4 [00:00<00:00, 30.29it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.70it/s]100%|██████████| 4/4 [00:00<00:00, 12.82it/s]100%|██████████| 4/4 [00:00<00:00, 12.63it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.14it/s]100%|██████████| 4/4 [00:00<00:00, 17.99it/s]100%|██████████| 4/4 [00:00<00:00, 17.99it/s]
Run 00 | Epoch 00063 | Loss 1.0407 | Train 0.3209 | Val 0.3159 | Test 0.3046
Number of nodes during this epoch:  329856
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14376068115234375  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.013765573501586914
range selection method range initialization spend 0.012360334396362305
time for parepare:  0.015812158584594727
local_output_nid generation:  0.010848522186279297
local_in_edges_tensor generation:  0.007918119430541992
mini_batch_src_global generation:  0.01119542121887207
r_  generation:  0.15244817733764648
local_output_nid generation:  0.012146472930908203
local_in_edges_tensor generation:  0.005796194076538086
mini_batch_src_global generation:  0.014242887496948242
r_  generation:  0.15870380401611328
----------------------check_connections_block total spend ----------------------------- 0.4518752098083496
generate_one_block  0.16811490058898926
generate_one_block  0.17019343376159668
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02862548828125
gen group dst list time:  0.0061223506927490234
time for parepare:  0.020688295364379883
local_output_nid generation:  0.017752647399902344
local_in_edges_tensor generation:  0.02816939353942871
mini_batch_src_global generation:  0.03825688362121582
r_  generation:  0.429445743560791
local_output_nid generation:  0.025531291961669922
local_in_edges_tensor generation:  0.025816679000854492
mini_batch_src_global generation:  0.04967379570007324
r_  generation:  0.44240379333496094
----------------------check_connections_block total spend ----------------------------- 1.2650976181030273
generate_one_block  0.553288459777832
generate_one_block  0.5762655735015869
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.026671409606933594
gen group dst list time:  0.01452016830444336
time for parepare:  0.0208895206451416
local_output_nid generation:  0.02527928352355957
local_in_edges_tensor generation:  0.048154354095458984
mini_batch_src_global generation:  0.031038522720336914
r_  generation:  0.37850284576416016
local_output_nid generation:  0.03134274482727051
local_in_edges_tensor generation:  0.031035661697387695
mini_batch_src_global generation:  0.03774070739746094
r_  generation:  0.3833491802215576
----------------------check_connections_block total spend ----------------------------- 1.153515100479126
generate_one_block  0.4671306610107422
generate_one_block  0.4561309814453125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14376068115234375  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

connection checking time:  2.4186127185821533
block generation total time  2.0528156757354736
average batch blocks generation time:  1.0264078378677368
block dataloader generation time/epoch 5.888035548817028
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10977697372436523  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2266931533813477  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10985326766967773  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2298974990844727  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08355259895324707 |0.019651055335998535 |0.004271745681762695 |0.0005277395248413086 |0.0026879310607910156 |0.0015437602996826172 |
----------------------------------------------------------pseudo_mini_loss sum 1.0339126586914062
Total (block generation + training)time/epoch 6.206058120727539
Training time/epoch 0.32079601287841797
Training time without block to device /epoch 0.2814939022064209
Training time without total dataloading part /epoch 0.016518592834472656
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 49.36it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.20it/s]100%|██████████| 4/4 [00:00<00:00, 15.49it/s]100%|██████████| 4/4 [00:00<00:00, 15.43it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.83it/s]100%|██████████| 4/4 [00:00<00:00, 17.74it/s]100%|██████████| 4/4 [00:00<00:00, 17.73it/s]
Run 00 | Epoch 00064 | Loss 1.0339 | Train 0.3203 | Val 0.3142 | Test 0.3036
Number of nodes during this epoch:  329750
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14676141738891602  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.016886234283447266
range selection method range initialization spend 0.01267099380493164
time for parepare:  0.016093969345092773
local_output_nid generation:  0.01125955581665039
local_in_edges_tensor generation:  0.008138418197631836
mini_batch_src_global generation:  0.011338949203491211
r_  generation:  0.1724398136138916
local_output_nid generation:  0.013111114501953125
local_in_edges_tensor generation:  0.006803274154663086
mini_batch_src_global generation:  0.028120040893554688
r_  generation:  0.17818927764892578
----------------------check_connections_block total spend ----------------------------- 0.5107190608978271
generate_one_block  0.18793654441833496
generate_one_block  0.19829940795898438
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029036760330200195
gen group dst list time:  0.0061070919036865234
time for parepare:  0.02158641815185547
local_output_nid generation:  0.017659664154052734
local_in_edges_tensor generation:  0.03063821792602539
mini_batch_src_global generation:  0.039562225341796875
r_  generation:  0.4591102600097656
local_output_nid generation:  0.030209064483642578
local_in_edges_tensor generation:  0.028464078903198242
mini_batch_src_global generation:  0.048601627349853516
r_  generation:  0.4692115783691406
----------------------check_connections_block total spend ----------------------------- 1.3428657054901123
generate_one_block  0.557276725769043
generate_one_block  0.5649633407592773
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0246889591217041
gen group dst list time:  0.01173543930053711
time for parepare:  0.01892995834350586
local_output_nid generation:  0.02461528778076172
local_in_edges_tensor generation:  0.03776741027832031
mini_batch_src_global generation:  0.03018665313720703
r_  generation:  0.40129995346069336
local_output_nid generation:  0.032558441162109375
local_in_edges_tensor generation:  0.030171871185302734
mini_batch_src_global generation:  0.03772234916687012
r_  generation:  0.4031181335449219
----------------------check_connections_block total spend ----------------------------- 1.1871647834777832
generate_one_block  0.4683082103729248
generate_one_block  0.4601271152496338
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14676141738891602  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

connection checking time:  2.5300304889678955
block generation total time  2.050675392150879
average batch blocks generation time:  1.0253376960754395
block dataloader generation time/epoch 5.893079216991152
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.11067962646484375  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2288765907287598  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1088418960571289  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.226572036743164  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08184635639190674 |0.013510823249816895 |0.004207253456115723 |0.0005298852920532227 |0.0031267404556274414 |0.001932382583618164 |
----------------------------------------------------------pseudo_mini_loss sum 1.0334404706954956
Total (block generation + training)time/epoch 6.2107961390699655
Training time/epoch 0.3007502555847168
Training time without block to device /epoch 0.273728609085083
Training time without total dataloading part /epoch 0.017660140991210938
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 62.44it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.05it/s]100%|██████████| 4/4 [00:00<00:00, 15.42it/s]100%|██████████| 4/4 [00:00<00:00, 15.35it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.80it/s]100%|██████████| 4/4 [00:00<00:00, 18.10it/s]100%|██████████| 4/4 [00:00<00:00, 18.03it/s]
Run 00 | Epoch 00065 | Loss 1.0334 | Train 0.3203 | Val 0.3149 | Test 0.3037
Number of nodes during this epoch:  329730
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14554166793823242  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.014991998672485352
range selection method range initialization spend 0.015547752380371094
time for parepare:  0.01565694808959961
local_output_nid generation:  0.011024236679077148
local_in_edges_tensor generation:  0.008239984512329102
mini_batch_src_global generation:  0.013142108917236328
r_  generation:  0.1548917293548584
local_output_nid generation:  0.012314319610595703
local_in_edges_tensor generation:  0.005799531936645508
mini_batch_src_global generation:  0.016364097595214844
r_  generation:  0.16407060623168945
----------------------check_connections_block total spend ----------------------------- 0.46286892890930176
generate_one_block  0.17195677757263184
generate_one_block  0.1786658763885498
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028368234634399414
gen group dst list time:  0.007601022720336914
time for parepare:  0.02179718017578125
local_output_nid generation:  0.019295215606689453
local_in_edges_tensor generation:  0.03821730613708496
mini_batch_src_global generation:  0.04147624969482422
r_  generation:  0.4723062515258789
local_output_nid generation:  0.026191234588623047
local_in_edges_tensor generation:  0.02673816680908203
mini_batch_src_global generation:  0.05025625228881836
r_  generation:  0.5228924751281738
----------------------check_connections_block total spend ----------------------------- 1.427351474761963
generate_one_block  0.5590071678161621
generate_one_block  0.5397598743438721
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01950979232788086
gen group dst list time:  0.014267683029174805
time for parepare:  0.02293252944946289
local_output_nid generation:  0.0251009464263916
local_in_edges_tensor generation:  0.032228708267211914
mini_batch_src_global generation:  0.030709028244018555
r_  generation:  0.3707854747772217
local_output_nid generation:  0.03195357322692871
local_in_edges_tensor generation:  0.026988744735717773
mini_batch_src_global generation:  0.037462711334228516
r_  generation:  0.37662768363952637
----------------------check_connections_block total spend ----------------------------- 1.1202313899993896
generate_one_block  0.4514753818511963
generate_one_block  0.45755720138549805
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14554166793823242  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

connection checking time:  2.5475828647613525
block generation total time  2.0077996253967285
average batch blocks generation time:  1.0038998126983643
block dataloader generation time/epoch 5.897275610973961
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10978937149047852  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2284049987792969  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10984325408935547  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2287683486938477  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08110439777374268 |0.020464658737182617 |0.0038557052612304688 |0.0005004405975341797 |0.003609180450439453 |0.0013148784637451172 |
----------------------------------------------------------pseudo_mini_loss sum 1.03102707862854
Total (block generation + training)time/epoch 6.215191652900295
Training time/epoch 0.3289833068847656
Training time without block to device /epoch 0.2880539894104004
Training time without total dataloading part /epoch 0.01724553108215332
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 51.57it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.28it/s]100%|██████████| 4/4 [00:00<00:00, 15.84it/s]100%|██████████| 4/4 [00:00<00:00, 15.73it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.14it/s]100%|██████████| 4/4 [00:00<00:00, 17.66it/s]100%|██████████| 4/4 [00:00<00:00, 17.56it/s]
Run 00 | Epoch 00066 | Loss 1.0310 | Train 0.3203 | Val 0.3150 | Test 0.3040
Number of nodes during this epoch:  329800
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14546775817871094  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.016049861907958984
range selection method range initialization spend 0.011995315551757812
time for parepare:  0.01640915870666504
local_output_nid generation:  0.011019229888916016
local_in_edges_tensor generation:  0.011610984802246094
mini_batch_src_global generation:  0.011090755462646484
r_  generation:  0.14598631858825684
local_output_nid generation:  0.01229405403137207
local_in_edges_tensor generation:  0.005669832229614258
mini_batch_src_global generation:  0.014337539672851562
r_  generation:  0.15636730194091797
----------------------check_connections_block total spend ----------------------------- 0.44527745246887207
generate_one_block  0.16687941551208496
generate_one_block  0.168320894241333
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029559850692749023
gen group dst list time:  0.0060901641845703125
time for parepare:  0.019713640213012695
local_output_nid generation:  0.01800537109375
local_in_edges_tensor generation:  0.02959728240966797
mini_batch_src_global generation:  0.038271427154541016
r_  generation:  0.4235811233520508
local_output_nid generation:  0.02566838264465332
local_in_edges_tensor generation:  0.024111032485961914
mini_batch_src_global generation:  0.0479123592376709
r_  generation:  0.4356560707092285
----------------------check_connections_block total spend ----------------------------- 1.2502961158752441
generate_one_block  0.5644466876983643
generate_one_block  0.5733592510223389
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0224001407623291
gen group dst list time:  0.011696815490722656
time for parepare:  0.019347429275512695
local_output_nid generation:  0.024822473526000977
local_in_edges_tensor generation:  0.0291440486907959
mini_batch_src_global generation:  0.030986785888671875
r_  generation:  0.3834991455078125
local_output_nid generation:  0.03176069259643555
local_in_edges_tensor generation:  0.027695655822753906
mini_batch_src_global generation:  0.03775739669799805
r_  generation:  0.37972211837768555
----------------------check_connections_block total spend ----------------------------- 1.1306512355804443
generate_one_block  0.4467761516571045
generate_one_block  0.4542694091796875
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14546775817871094  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

connection checking time:  2.3809473514556885
block generation total time  2.038851499557495
average batch blocks generation time:  1.0194257497787476
block dataloader generation time/epoch 5.8972475939783555
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1090540885925293  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.227736473083496  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10979318618774414  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2279448509216309  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08003592491149902 |0.011613845825195312 |0.00403439998626709 |0.0005296468734741211 |0.0036352872848510742 |0.001486063003540039 |
----------------------------------------------------------pseudo_mini_loss sum 1.0300030708312988
Total (block generation + training)time/epoch 6.214824540861722
Training time/epoch 0.29814863204956055
Training time without block to device /epoch 0.2749209403991699
Training time without total dataloading part /epoch 0.01788473129272461
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 61.91it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.13it/s]100%|██████████| 4/4 [00:00<00:00, 15.77it/s]100%|██████████| 4/4 [00:00<00:00, 15.65it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.80it/s]100%|██████████| 4/4 [00:00<00:00, 18.01it/s]100%|██████████| 4/4 [00:00<00:00, 17.96it/s]
Run 00 | Epoch 00067 | Loss 1.0300 | Train 0.3204 | Val 0.3162 | Test 0.3041
Number of nodes during this epoch:  329678
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14678430557250977  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01297140121459961
range selection method range initialization spend 0.011993885040283203
time for parepare:  0.016530275344848633
local_output_nid generation:  0.010765314102172852
local_in_edges_tensor generation:  0.008181095123291016
mini_batch_src_global generation:  0.011095285415649414
r_  generation:  0.14410924911499023
local_output_nid generation:  0.012086153030395508
local_in_edges_tensor generation:  0.005786895751953125
mini_batch_src_global generation:  0.014239072799682617
r_  generation:  0.15612316131591797
----------------------check_connections_block total spend ----------------------------- 0.43982696533203125
generate_one_block  0.1651773452758789
generate_one_block  0.1698625087738037
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.025482654571533203
gen group dst list time:  0.006064891815185547
time for parepare:  0.019891023635864258
local_output_nid generation:  0.017647743225097656
local_in_edges_tensor generation:  0.025719881057739258
mini_batch_src_global generation:  0.03933978080749512
r_  generation:  0.42335987091064453
local_output_nid generation:  0.025528669357299805
local_in_edges_tensor generation:  0.024493932723999023
mini_batch_src_global generation:  0.04878544807434082
r_  generation:  0.4375288486480713
----------------------check_connections_block total spend ----------------------------- 1.2497906684875488
generate_one_block  0.5404369831085205
generate_one_block  0.546067476272583
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.018453598022460938
gen group dst list time:  0.01164555549621582
time for parepare:  0.018861055374145508
local_output_nid generation:  0.024190187454223633
local_in_edges_tensor generation:  0.031165122985839844
mini_batch_src_global generation:  0.031071901321411133
r_  generation:  0.37035250663757324
local_output_nid generation:  0.03190350532531738
local_in_edges_tensor generation:  0.026145458221435547
mini_batch_src_global generation:  0.03822779655456543
r_  generation:  0.3973841667175293
----------------------check_connections_block total spend ----------------------------- 1.1335089206695557
generate_one_block  0.48063135147094727
generate_one_block  0.4533824920654297
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14678430557250977  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

connection checking time:  2.3832995891571045
block generation total time  2.0205183029174805
average batch blocks generation time:  1.0102591514587402
block dataloader generation time/epoch 5.895837137254618
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10905647277832031  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2269668579101562  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10982084274291992  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2296571731567383  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07820475101470947 |0.012293815612792969 |0.004392385482788086 |0.0005767345428466797 |0.002787470817565918 |0.0017657279968261719 |
----------------------------------------------------------pseudo_mini_loss sum 1.0245460271835327
Total (block generation + training)time/epoch 6.2132083844330355
Training time/epoch 0.30535888671875
Training time without block to device /epoch 0.28077125549316406
Training time without total dataloading part /epoch 0.01727890968322754
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.81it/s]100%|██████████| 4/4 [00:00<00:00, 30.19it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.54it/s]100%|██████████| 4/4 [00:00<00:00, 12.74it/s]100%|██████████| 4/4 [00:00<00:00, 12.53it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.16it/s]100%|██████████| 4/4 [00:00<00:00, 17.35it/s]100%|██████████| 4/4 [00:00<00:00, 17.30it/s]
Run 00 | Epoch 00068 | Loss 1.0245 | Train 0.3196 | Val 0.3138 | Test 0.3023
Number of nodes during this epoch:  329817
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14615392684936523  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.017969369888305664
range selection method range initialization spend 0.01244974136352539
time for parepare:  0.0168612003326416
local_output_nid generation:  0.01092076301574707
local_in_edges_tensor generation:  0.011915206909179688
mini_batch_src_global generation:  0.011111974716186523
r_  generation:  0.14625048637390137
local_output_nid generation:  0.012055635452270508
local_in_edges_tensor generation:  0.005720376968383789
mini_batch_src_global generation:  0.014225959777832031
r_  generation:  0.16029810905456543
----------------------check_connections_block total spend ----------------------------- 0.450772762298584
generate_one_block  0.17205333709716797
generate_one_block  0.17787694931030273
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03087902069091797
gen group dst list time:  0.006091594696044922
time for parepare:  0.02225804328918457
local_output_nid generation:  0.017769813537597656
local_in_edges_tensor generation:  0.0335996150970459
mini_batch_src_global generation:  0.04094862937927246
r_  generation:  0.43007540702819824
local_output_nid generation:  0.025501251220703125
local_in_edges_tensor generation:  0.02905559539794922
mini_batch_src_global generation:  0.04771113395690918
r_  generation:  0.4443016052246094
----------------------check_connections_block total spend ----------------------------- 1.2832074165344238
generate_one_block  0.5495316982269287
generate_one_block  0.5493474006652832
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02887892723083496
gen group dst list time:  0.012701272964477539
time for parepare:  0.020534038543701172
local_output_nid generation:  0.024988174438476562
local_in_edges_tensor generation:  0.034584760665893555
mini_batch_src_global generation:  0.031255245208740234
r_  generation:  0.3750953674316406
local_output_nid generation:  0.03395533561706543
local_in_edges_tensor generation:  0.027002334594726562
mini_batch_src_global generation:  0.04156064987182617
r_  generation:  0.398561954498291
----------------------check_connections_block total spend ----------------------------- 1.155261516571045
generate_one_block  0.4593818187713623
generate_one_block  0.4615051746368408
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14615392684936523  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

connection checking time:  2.4384689331054688
block generation total time  2.019766092300415
average batch blocks generation time:  1.0098830461502075
block dataloader generation time/epoch 5.897138233979543
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.11047792434692383  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2278947830200195  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10975408554077148  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2294235229492188  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08282434940338135 |0.018590807914733887 |0.0042724609375 |0.0005185604095458984 |0.003174901008605957 |0.0018215179443359375 |
----------------------------------------------------------pseudo_mini_loss sum 1.021873116493225
Total (block generation + training)time/epoch 6.214514203866323
Training time/epoch 0.3175034523010254
Training time without block to device /epoch 0.2803218364715576
Training time without total dataloading part /epoch 0.01775336265563965
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 56.17it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.42it/s]100%|██████████| 4/4 [00:00<00:00, 15.66it/s]100%|██████████| 4/4 [00:00<00:00, 15.61it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.53it/s]100%|██████████| 4/4 [00:00<00:00, 17.79it/s]100%|██████████| 4/4 [00:00<00:00, 17.73it/s]
Run 00 | Epoch 00069 | Loss 1.0219 | Train 0.3185 | Val 0.3101 | Test 0.2987
Number of nodes during this epoch:  329622
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1460409164428711  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01580524444580078
range selection method range initialization spend 0.012301921844482422
time for parepare:  0.015808820724487305
local_output_nid generation:  0.010951757431030273
local_in_edges_tensor generation:  0.011723518371582031
mini_batch_src_global generation:  0.011085748672485352
r_  generation:  0.14717793464660645
local_output_nid generation:  0.012175321578979492
local_in_edges_tensor generation:  0.005734682083129883
mini_batch_src_global generation:  0.014134407043457031
r_  generation:  0.15673255920410156
----------------------check_connections_block total spend ----------------------------- 0.44683218002319336
generate_one_block  0.16745567321777344
generate_one_block  0.1714787483215332
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.026100873947143555
gen group dst list time:  0.006129026412963867
time for parepare:  0.019863367080688477
local_output_nid generation:  0.017913103103637695
local_in_edges_tensor generation:  0.03466987609863281
mini_batch_src_global generation:  0.03908872604370117
r_  generation:  0.4253227710723877
local_output_nid generation:  0.025897502899169922
local_in_edges_tensor generation:  0.02551889419555664
mini_batch_src_global generation:  0.05048346519470215
r_  generation:  0.44431328773498535
----------------------check_connections_block total spend ----------------------------- 1.2736234664916992
generate_one_block  0.5451681613922119
generate_one_block  0.5435400009155273
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.022118091583251953
gen group dst list time:  0.0140380859375
time for parepare:  0.01839280128479004
local_output_nid generation:  0.024117231369018555
local_in_edges_tensor generation:  0.03358960151672363
mini_batch_src_global generation:  0.03129982948303223
r_  generation:  0.37049031257629395
local_output_nid generation:  0.031769752502441406
local_in_edges_tensor generation:  0.0262298583984375
mini_batch_src_global generation:  0.038481712341308594
r_  generation:  0.38300037384033203
----------------------check_connections_block total spend ----------------------------- 1.1225905418395996
generate_one_block  0.44861292839050293
generate_one_block  0.45952296257019043
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1460409164428711  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

connection checking time:  2.396214008331299
block generation total time  1.9968440532684326
average batch blocks generation time:  0.9984220266342163
block dataloader generation time/epoch 5.896823625095555
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.11046695709228516  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2283000946044922  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10982608795166016  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2282004356384277  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08022856712341309 |0.012263894081115723 |0.004213571548461914 |0.000584721565246582 |0.0033447742462158203 |0.003023386001586914 |
----------------------------------------------------------pseudo_mini_loss sum 1.0203654766082764
Total (block generation + training)time/epoch 6.2140386456348855
Training time/epoch 0.30747199058532715
Training time without block to device /epoch 0.2829442024230957
Training time without total dataloading part /epoch 0.019309520721435547
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 63.79it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.93it/s]100%|██████████| 4/4 [00:00<00:00, 15.31it/s]100%|██████████| 4/4 [00:00<00:00, 15.24it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.17it/s]100%|██████████| 4/4 [00:00<00:00, 17.41it/s]100%|██████████| 4/4 [00:00<00:00, 17.35it/s]
Run 00 | Epoch 00070 | Loss 1.0204 | Train 0.3158 | Val 0.3039 | Test 0.2915
Number of nodes during this epoch:  329888
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14662837982177734  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018174171447753906
range selection method range initialization spend 0.012802362442016602
time for parepare:  0.016941308975219727
local_output_nid generation:  0.010754108428955078
local_in_edges_tensor generation:  0.011276006698608398
mini_batch_src_global generation:  0.011304140090942383
r_  generation:  0.14651846885681152
local_output_nid generation:  0.011972427368164062
local_in_edges_tensor generation:  0.006812572479248047
mini_batch_src_global generation:  0.015604734420776367
r_  generation:  0.16157317161560059
----------------------check_connections_block total spend ----------------------------- 0.4542665481567383
generate_one_block  0.17881488800048828
generate_one_block  0.17373418807983398
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030893564224243164
gen group dst list time:  0.006104707717895508
time for parepare:  0.02152872085571289
local_output_nid generation:  0.01735973358154297
local_in_edges_tensor generation:  0.03910088539123535
mini_batch_src_global generation:  0.04811263084411621
r_  generation:  0.4282965660095215
local_output_nid generation:  0.027499914169311523
local_in_edges_tensor generation:  0.027788639068603516
mini_batch_src_global generation:  0.04957461357116699
r_  generation:  0.4447500705718994
----------------------check_connections_block total spend ----------------------------- 1.2936067581176758
generate_one_block  0.5547592639923096
generate_one_block  0.5600519180297852
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02123856544494629
gen group dst list time:  0.011763572692871094
time for parepare:  0.018869876861572266
local_output_nid generation:  0.024806737899780273
local_in_edges_tensor generation:  0.03910350799560547
mini_batch_src_global generation:  0.03169965744018555
r_  generation:  0.3913233280181885
local_output_nid generation:  0.03480863571166992
local_in_edges_tensor generation:  0.03231954574584961
mini_batch_src_global generation:  0.038880109786987305
r_  generation:  0.3783454895019531
----------------------check_connections_block total spend ----------------------------- 1.1551909446716309
generate_one_block  0.4574413299560547
generate_one_block  0.46086955070495605
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14662837982177734  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

connection checking time:  2.4487977027893066
block generation total time  2.0331220626831055
average batch blocks generation time:  1.0165610313415527
block dataloader generation time/epoch 5.898335645275731
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1090388298034668  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2270851135253906  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10984230041503906  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2294459342956543  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.10166585445404053 |0.017462491989135742 |0.003979086875915527 |0.0005152225494384766 |0.0031224489212036133 |0.0014848709106445312 |
----------------------------------------------------------pseudo_mini_loss sum 1.0191583633422852
Total (block generation + training)time/epoch 6.216346179285357
Training time/epoch 0.36638760566711426
Training time without block to device /epoch 0.3314626216888428
Training time without total dataloading part /epoch 0.016718387603759766
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 55.68it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.94it/s]100%|██████████| 4/4 [00:00<00:00, 14.84it/s]100%|██████████| 4/4 [00:00<00:00, 14.84it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.99it/s]100%|██████████| 4/4 [00:00<00:00, 17.52it/s]100%|██████████| 4/4 [00:00<00:00, 17.42it/s]
Run 00 | Epoch 00071 | Loss 1.0192 | Train 0.3127 | Val 0.2975 | Test 0.2839
Number of nodes during this epoch:  329788
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14656686782836914  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.014706611633300781
range selection method range initialization spend 0.012494564056396484
time for parepare:  0.01628255844116211
local_output_nid generation:  0.010793924331665039
local_in_edges_tensor generation:  0.012668132781982422
mini_batch_src_global generation:  0.011125564575195312
r_  generation:  0.14542365074157715
local_output_nid generation:  0.011945486068725586
local_in_edges_tensor generation:  0.0057146549224853516
mini_batch_src_global generation:  0.01416158676147461
r_  generation:  0.15636682510375977
----------------------check_connections_block total spend ----------------------------- 0.4455604553222656
generate_one_block  0.16721343994140625
generate_one_block  0.17046213150024414
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02650737762451172
gen group dst list time:  0.006102800369262695
time for parepare:  0.019944190979003906
local_output_nid generation:  0.017268657684326172
local_in_edges_tensor generation:  0.031194686889648438
mini_batch_src_global generation:  0.038945674896240234
r_  generation:  0.4330589771270752
local_output_nid generation:  0.02683401107788086
local_in_edges_tensor generation:  0.02871870994567871
mini_batch_src_global generation:  0.049475669860839844
r_  generation:  0.47936153411865234
----------------------check_connections_block total spend ----------------------------- 1.3187503814697266
generate_one_block  0.5627710819244385
generate_one_block  0.5547995567321777
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025310039520263672
gen group dst list time:  0.012706756591796875
time for parepare:  0.01840496063232422
local_output_nid generation:  0.02356123924255371
local_in_edges_tensor generation:  0.044170379638671875
mini_batch_src_global generation:  0.03304791450500488
r_  generation:  0.37148380279541016
local_output_nid generation:  0.030971527099609375
local_in_edges_tensor generation:  0.033702850341796875
mini_batch_src_global generation:  0.038222312927246094
r_  generation:  0.38683104515075684
----------------------check_connections_block total spend ----------------------------- 1.1466078758239746
generate_one_block  0.4515862464904785
generate_one_block  0.4541456699371338
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14656686782836914  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

connection checking time:  2.465358257293701
block generation total time  2.0233025550842285
average batch blocks generation time:  1.0116512775421143
block dataloader generation time/epoch 5.899222854583982
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.11062431335449219  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2294535636901855  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10885047912597656  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2267217636108398  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08172941207885742 |0.015493988990783691 |0.004275798797607422 |0.0005500316619873047 |0.004598855972290039 |0.0018913745880126953 |
----------------------------------------------------------pseudo_mini_loss sum 1.017520546913147
Total (block generation + training)time/epoch 6.217294076132396
Training time/epoch 0.3216874599456787
Training time without block to device /epoch 0.29069948196411133
Training time without total dataloading part /epoch 0.020740747451782227
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 50.64it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.27it/s]100%|██████████| 4/4 [00:00<00:00, 15.49it/s]100%|██████████| 4/4 [00:00<00:00, 15.44it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.12it/s]100%|██████████| 4/4 [00:00<00:00, 17.66it/s]100%|██████████| 4/4 [00:00<00:00, 17.56it/s]
Run 00 | Epoch 00072 | Loss 1.0175 | Train 0.3089 | Val 0.2898 | Test 0.2754
Number of nodes during this epoch:  329839
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14557123184204102  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.012662410736083984
range selection method range initialization spend 0.012303352355957031
time for parepare:  0.015692949295043945
local_output_nid generation:  0.010811090469360352
local_in_edges_tensor generation:  0.00810098648071289
mini_batch_src_global generation:  0.011078834533691406
r_  generation:  0.14787006378173828
local_output_nid generation:  0.01187586784362793
local_in_edges_tensor generation:  0.005795001983642578
mini_batch_src_global generation:  0.014191150665283203
r_  generation:  0.15732645988464355
----------------------check_connections_block total spend ----------------------------- 0.44411730766296387
generate_one_block  0.1674182415008545
generate_one_block  0.1703357696533203
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.026802778244018555
gen group dst list time:  0.006031036376953125
time for parepare:  0.020081758499145508
local_output_nid generation:  0.017373323440551758
local_in_edges_tensor generation:  0.027283906936645508
mini_batch_src_global generation:  0.03910708427429199
r_  generation:  0.4540519714355469
local_output_nid generation:  0.028233051300048828
local_in_edges_tensor generation:  0.02387857437133789
mini_batch_src_global generation:  0.04794025421142578
r_  generation:  0.44820070266723633
----------------------check_connections_block total spend ----------------------------- 1.3003182411193848
generate_one_block  0.5589454174041748
generate_one_block  0.5473241806030273
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02558732032775879
gen group dst list time:  0.013492584228515625
time for parepare:  0.01833057403564453
local_output_nid generation:  0.02332305908203125
local_in_edges_tensor generation:  0.04474759101867676
mini_batch_src_global generation:  0.031549692153930664
r_  generation:  0.3773624897003174
local_output_nid generation:  0.031061649322509766
local_in_edges_tensor generation:  0.02880692481994629
mini_batch_src_global generation:  0.038533926010131836
r_  generation:  0.37732982635498047
----------------------check_connections_block total spend ----------------------------- 1.1361005306243896
generate_one_block  0.44991278648376465
generate_one_block  0.45888519287109375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14557123184204102  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

connection checking time:  2.4364187717437744
block generation total time  2.0150675773620605
average batch blocks generation time:  1.0075337886810303
block dataloader generation time/epoch 5.899470426142216
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10979700088500977  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2266011238098145  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10990715026855469  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2337665557861328  GigaBytes
Max Memory Allocated: 1.4732227325439453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08337843418121338 |0.014223575592041016 |0.004241943359375 |0.0005121231079101562 |0.03451979160308838 |0.001973390579223633 |
----------------------------------------------------------pseudo_mini_loss sum 1.0147720575332642
Total (block generation + training)time/epoch 6.217463701963425
Training time/epoch 0.31292223930358887
Training time without block to device /epoch 0.28447508811950684
Training time without total dataloading part /epoch 0.0805211067199707
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 57.23it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.96it/s]100%|██████████| 4/4 [00:00<00:00, 15.59it/s]100%|██████████| 4/4 [00:00<00:00, 15.48it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.66it/s]100%|██████████| 4/4 [00:00<00:00, 17.72it/s]100%|██████████| 4/4 [00:00<00:00, 17.69it/s]
Run 00 | Epoch 00073 | Loss 1.0148 | Train 0.3054 | Val 0.2814 | Test 0.2658
Number of nodes during this epoch:  329816
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14587640762329102  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.016159772872924805
range selection method range initialization spend 0.01195669174194336
time for parepare:  0.016322612762451172
local_output_nid generation:  0.010930061340332031
local_in_edges_tensor generation:  0.007966279983520508
mini_batch_src_global generation:  0.01119089126586914
r_  generation:  0.14511585235595703
local_output_nid generation:  0.011921167373657227
local_in_edges_tensor generation:  0.00578618049621582
mini_batch_src_global generation:  0.014513254165649414
r_  generation:  0.15593576431274414
----------------------check_connections_block total spend ----------------------------- 0.44069766998291016
generate_one_block  0.16819405555725098
generate_one_block  0.1693565845489502
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.031792640686035156
gen group dst list time:  0.006077766418457031
time for parepare:  0.019726037979125977
local_output_nid generation:  0.017241716384887695
local_in_edges_tensor generation:  0.031139373779296875
mini_batch_src_global generation:  0.039037466049194336
r_  generation:  0.4306149482727051
local_output_nid generation:  0.025768756866455078
local_in_edges_tensor generation:  0.024607419967651367
mini_batch_src_global generation:  0.048433542251586914
r_  generation:  0.4385983943939209
----------------------check_connections_block total spend ----------------------------- 1.2646934986114502
generate_one_block  0.5402865409851074
generate_one_block  0.5406982898712158
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025304317474365234
gen group dst list time:  0.011593103408813477
time for parepare:  0.018599987030029297
local_output_nid generation:  0.02414083480834961
local_in_edges_tensor generation:  0.029070615768432617
mini_batch_src_global generation:  0.03137779235839844
r_  generation:  0.37825441360473633
local_output_nid generation:  0.03200840950012207
local_in_edges_tensor generation:  0.02783989906311035
mini_batch_src_global generation:  0.03805184364318848
r_  generation:  0.3894307613372803
----------------------check_connections_block total spend ----------------------------- 1.1352307796478271
generate_one_block  0.45041823387145996
generate_one_block  0.45372676849365234
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14587640762329102  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

connection checking time:  2.3999242782592773
block generation total time  1.9851298332214355
average batch blocks generation time:  0.9925649166107178
block dataloader generation time/epoch 5.898629415952242
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.11026954650878906  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.228837013244629  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10892724990844727  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2273335456848145  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07838189601898193 |0.013020157814025879 |0.0039550065994262695 |0.0005048513412475586 |0.0037113428115844727 |0.0013892650604248047 |
----------------------------------------------------------pseudo_mini_loss sum 1.010941505432129
Total (block generation + training)time/epoch 6.216278652044443
Training time/epoch 0.2955470085144043
Training time without block to device /epoch 0.26950669288635254
Training time without total dataloading part /epoch 0.017731666564941406
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.54it/s]100%|██████████| 4/4 [00:00<00:00, 31.50it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.41it/s]100%|██████████| 4/4 [00:00<00:00, 12.71it/s]100%|██████████| 4/4 [00:00<00:00, 12.49it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.07it/s]100%|██████████| 4/4 [00:00<00:00, 17.28it/s]100%|██████████| 4/4 [00:00<00:00, 17.23it/s]
Run 00 | Epoch 00074 | Loss 1.0109 | Train 0.3021 | Val 0.2734 | Test 0.2572
Number of nodes during this epoch:  329875
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1454305648803711  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0173337459564209
range selection method range initialization spend 0.013214826583862305
time for parepare:  0.017589569091796875
local_output_nid generation:  0.011198282241821289
local_in_edges_tensor generation:  0.01016998291015625
mini_batch_src_global generation:  0.0111236572265625
r_  generation:  0.14602208137512207
local_output_nid generation:  0.012130498886108398
local_in_edges_tensor generation:  0.005691051483154297
mini_batch_src_global generation:  0.014324665069580078
r_  generation:  0.15657997131347656
----------------------check_connections_block total spend ----------------------------- 0.4493985176086426
generate_one_block  0.17201447486877441
generate_one_block  0.17086052894592285
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029662609100341797
gen group dst list time:  0.006207466125488281
time for parepare:  0.02094745635986328
local_output_nid generation:  0.01833033561706543
local_in_edges_tensor generation:  0.03012537956237793
mini_batch_src_global generation:  0.04156184196472168
r_  generation:  0.4253346920013428
local_output_nid generation:  0.02586531639099121
local_in_edges_tensor generation:  0.029180288314819336
mini_batch_src_global generation:  0.048293113708496094
r_  generation:  0.44098329544067383
----------------------check_connections_block total spend ----------------------------- 1.2706825733184814
generate_one_block  0.546536922454834
generate_one_block  0.5489969253540039
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.022550582885742188
gen group dst list time:  0.011618852615356445
time for parepare:  0.018691062927246094
local_output_nid generation:  0.023811817169189453
local_in_edges_tensor generation:  0.03213357925415039
mini_batch_src_global generation:  0.03122115135192871
r_  generation:  0.37119245529174805
local_output_nid generation:  0.031182289123535156
local_in_edges_tensor generation:  0.027202844619750977
mini_batch_src_global generation:  0.038518428802490234
r_  generation:  0.37839508056640625
----------------------check_connections_block total spend ----------------------------- 1.1174874305725098
generate_one_block  0.44806671142578125
generate_one_block  0.4469137191772461
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1454305648803711  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

connection checking time:  2.388170003890991
block generation total time  1.9905142784118652
average batch blocks generation time:  0.9952571392059326
block dataloader generation time/epoch 5.89780748612953
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1098170280456543  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2279486656188965  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10981225967407227  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2291045188903809  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08179378509521484 |0.012094855308532715 |0.004257082939147949 |0.0005525350570678711 |0.0037158727645874023 |0.001495361328125 |
----------------------------------------------------------pseudo_mini_loss sum 1.0146758556365967
Total (block generation + training)time/epoch 6.215295264215181
Training time/epoch 0.3068423271179199
Training time without block to device /epoch 0.2826526165008545
Training time without total dataloading part /epoch 0.018546342849731445
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 59.33it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.12it/s]100%|██████████| 4/4 [00:00<00:00, 15.50it/s]100%|██████████| 4/4 [00:00<00:00, 15.43it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.47it/s]100%|██████████| 4/4 [00:00<00:00, 17.87it/s]100%|██████████| 4/4 [00:00<00:00, 17.79it/s]
Run 00 | Epoch 00075 | Loss 1.0147 | Train 0.2991 | Val 0.2651 | Test 0.2493
Number of nodes during this epoch:  329783
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1464977264404297  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.014107465744018555
range selection method range initialization spend 0.011859655380249023
time for parepare:  0.015566349029541016
local_output_nid generation:  0.011153459548950195
local_in_edges_tensor generation:  0.008109807968139648
mini_batch_src_global generation:  0.011115312576293945
r_  generation:  0.14633798599243164
local_output_nid generation:  0.012088775634765625
local_in_edges_tensor generation:  0.005774259567260742
mini_batch_src_global generation:  0.014411211013793945
r_  generation:  0.15715503692626953
----------------------check_connections_block total spend ----------------------------- 0.4429500102996826
generate_one_block  0.16853094100952148
generate_one_block  0.17209911346435547
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028392553329467773
gen group dst list time:  0.006139278411865234
time for parepare:  0.019692659378051758
local_output_nid generation:  0.017455101013183594
local_in_edges_tensor generation:  0.029493331909179688
mini_batch_src_global generation:  0.039620399475097656
r_  generation:  0.4309659004211426
local_output_nid generation:  0.02591705322265625
local_in_edges_tensor generation:  0.030600309371948242
mini_batch_src_global generation:  0.048451900482177734
r_  generation:  0.45147156715393066
----------------------check_connections_block total spend ----------------------------- 1.285961627960205
generate_one_block  0.5810060501098633
generate_one_block  0.551278829574585
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.024711132049560547
gen group dst list time:  0.013898849487304688
time for parepare:  0.01867222785949707
local_output_nid generation:  0.023715972900390625
local_in_edges_tensor generation:  0.04246163368225098
mini_batch_src_global generation:  0.03238654136657715
r_  generation:  0.394909143447876
local_output_nid generation:  0.03267788887023926
local_in_edges_tensor generation:  0.03138327598571777
mini_batch_src_global generation:  0.038776397705078125
r_  generation:  0.3871777057647705
----------------------check_connections_block total spend ----------------------------- 1.1700809001922607
generate_one_block  0.45914411544799805
generate_one_block  0.48056840896606445
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1464977264404297  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

connection checking time:  2.456042528152466
block generation total time  2.0719974040985107
average batch blocks generation time:  1.0359987020492554
block dataloader generation time/epoch 5.8992361097193475
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.11061906814575195  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.227705478668213  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10989522933959961  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2336878776550293  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08144605159759521 |0.0137481689453125 |0.004308223724365234 |0.0005464553833007812 |0.003882169723510742 |0.0014982223510742188 |
----------------------------------------------------------pseudo_mini_loss sum 1.0076385736465454
Total (block generation + training)time/epoch 6.216638710961413
Training time/epoch 0.3116343021392822
Training time without block to device /epoch 0.2841379642486572
Training time without total dataloading part /epoch 0.018971920013427734
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.16it/s]100%|██████████| 4/4 [00:00<00:00, 30.54it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.59it/s]100%|██████████| 4/4 [00:00<00:00, 12.65it/s]100%|██████████| 4/4 [00:00<00:00, 12.47it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.41it/s]100%|██████████| 4/4 [00:00<00:00, 17.81it/s]100%|██████████| 4/4 [00:00<00:00, 17.72it/s]
Run 00 | Epoch 00076 | Loss 1.0076 | Train 0.2955 | Val 0.2565 | Test 0.2408
Number of nodes during this epoch:  329863
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1458425521850586  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.014693498611450195
range selection method range initialization spend 0.012061834335327148
time for parepare:  0.015827655792236328
local_output_nid generation:  0.010876655578613281
local_in_edges_tensor generation:  0.007856369018554688
mini_batch_src_global generation:  0.011197566986083984
r_  generation:  0.1461620330810547
local_output_nid generation:  0.012121915817260742
local_in_edges_tensor generation:  0.005704402923583984
mini_batch_src_global generation:  0.014217138290405273
r_  generation:  0.16055941581726074
----------------------check_connections_block total spend ----------------------------- 0.4465177059173584
generate_one_block  0.1680140495300293
generate_one_block  0.17081165313720703
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028324365615844727
gen group dst list time:  0.006117105484008789
time for parepare:  0.020002365112304688
local_output_nid generation:  0.01718592643737793
local_in_edges_tensor generation:  0.036910295486450195
mini_batch_src_global generation:  0.03982973098754883
r_  generation:  0.4280879497528076
local_output_nid generation:  0.025416135787963867
local_in_edges_tensor generation:  0.02812671661376953
mini_batch_src_global generation:  0.04816699028015137
r_  generation:  0.43944334983825684
----------------------check_connections_block total spend ----------------------------- 1.2751526832580566
generate_one_block  0.5478911399841309
generate_one_block  0.5574815273284912
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.023493289947509766
gen group dst list time:  0.012122869491577148
time for parepare:  0.022286653518676758
local_output_nid generation:  0.02457571029663086
local_in_edges_tensor generation:  0.04228711128234863
mini_batch_src_global generation:  0.033890485763549805
r_  generation:  0.3924534320831299
local_output_nid generation:  0.03470778465270996
local_in_edges_tensor generation:  0.03472638130187988
mini_batch_src_global generation:  0.03970623016357422
r_  generation:  0.3826279640197754
----------------------check_connections_block total spend ----------------------------- 1.1757137775421143
generate_one_block  0.44856739044189453
generate_one_block  0.45217466354370117
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1458425521850586  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

connection checking time:  2.450866460800171
block generation total time  2.0061147212982178
average batch blocks generation time:  1.0030573606491089
block dataloader generation time/epoch 5.899873712483575
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1102604866027832  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2288331985473633  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10883092880249023  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2263374328613281  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08572828769683838 |0.018213987350463867 |0.004086732864379883 |0.0004858970642089844 |0.0037306547164916992 |0.0018308162689208984 |
----------------------------------------------------------pseudo_mini_loss sum 1.0032546520233154
Total (block generation + training)time/epoch 6.217315722914303
Training time/epoch 0.31993794441223145
Training time without block to device /epoch 0.2835099697113037
Training time without total dataloading part /epoch 0.01843738555908203
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 50.33it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.32it/s]100%|██████████| 4/4 [00:00<00:00, 15.66it/s]100%|██████████| 4/4 [00:00<00:00, 15.59it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.58it/s]100%|██████████| 4/4 [00:00<00:00, 17.89it/s]100%|██████████| 4/4 [00:00<00:00, 17.82it/s]
Run 00 | Epoch 00077 | Loss 1.0033 | Train 0.2928 | Val 0.2517 | Test 0.2359
Number of nodes during this epoch:  329664
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14554691314697266  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.014476537704467773
range selection method range initialization spend 0.012257099151611328
time for parepare:  0.01582479476928711
local_output_nid generation:  0.010884761810302734
local_in_edges_tensor generation:  0.011368274688720703
mini_batch_src_global generation:  0.011232852935791016
r_  generation:  0.1453564167022705
local_output_nid generation:  0.012103080749511719
local_in_edges_tensor generation:  0.0062122344970703125
mini_batch_src_global generation:  0.014550209045410156
r_  generation:  0.1567234992980957
----------------------check_connections_block total spend ----------------------------- 0.4452171325683594
generate_one_block  0.1675727367401123
generate_one_block  0.17007827758789062
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.033002376556396484
gen group dst list time:  0.006134748458862305
time for parepare:  0.019902944564819336
local_output_nid generation:  0.017481327056884766
local_in_edges_tensor generation:  0.032445430755615234
mini_batch_src_global generation:  0.03975796699523926
r_  generation:  0.42913079261779785
local_output_nid generation:  0.025495529174804688
local_in_edges_tensor generation:  0.025627851486206055
mini_batch_src_global generation:  0.04792523384094238
r_  generation:  0.45947861671447754
----------------------check_connections_block total spend ----------------------------- 1.288729190826416
generate_one_block  0.5730366706848145
generate_one_block  0.5846543312072754
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0263059139251709
gen group dst list time:  0.014377117156982422
time for parepare:  0.019723176956176758
local_output_nid generation:  0.024042844772338867
local_in_edges_tensor generation:  0.04274392127990723
mini_batch_src_global generation:  0.0346832275390625
r_  generation:  0.371631383895874
local_output_nid generation:  0.031024456024169922
local_in_edges_tensor generation:  0.029868364334106445
mini_batch_src_global generation:  0.03802943229675293
r_  generation:  0.3773837089538574
----------------------check_connections_block total spend ----------------------------- 1.1354293823242188
generate_one_block  0.45062708854675293
generate_one_block  0.4537010192871094
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14554691314697266  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

connection checking time:  2.4241585731506348
block generation total time  2.062019109725952
average batch blocks generation time:  1.031009554862976
block dataloader generation time/epoch 5.900699211203533
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1098170280456543  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2294602394104004  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10980224609375  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.228348731994629  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08016765117645264 |0.016211867332458496 |0.004165291786193848 |0.0005165338516235352 |0.00392758846282959 |0.0014960765838623047 |
----------------------------------------------------------pseudo_mini_loss sum 1.001410722732544
Total (block generation + training)time/epoch 6.218122706897017
Training time/epoch 0.3160133361816406
Training time without block to device /epoch 0.28358960151672363
Training time without total dataloading part /epoch 0.01871490478515625
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.13it/s]100%|██████████| 4/4 [00:00<00:00, 30.08it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.70it/s]100%|██████████| 4/4 [00:00<00:00, 12.78it/s]100%|██████████| 4/4 [00:00<00:00, 12.59it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.36it/s]100%|██████████| 4/4 [00:00<00:00, 17.79it/s]100%|██████████| 4/4 [00:00<00:00, 17.70it/s]
Run 00 | Epoch 00078 | Loss 1.0014 | Train 0.2911 | Val 0.2482 | Test 0.2324
Number of nodes during this epoch:  329775
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1454787254333496  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.014871358871459961
range selection method range initialization spend 0.012054443359375
time for parepare:  0.015602827072143555
local_output_nid generation:  0.010908126831054688
local_in_edges_tensor generation:  0.007858514785766602
mini_batch_src_global generation:  0.011084556579589844
r_  generation:  0.1450040340423584
local_output_nid generation:  0.012076377868652344
local_in_edges_tensor generation:  0.005708217620849609
mini_batch_src_global generation:  0.014285564422607422
r_  generation:  0.15502715110778809
----------------------check_connections_block total spend ----------------------------- 0.4394567012786865
generate_one_block  0.1666884422302246
generate_one_block  0.1699075698852539
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02779364585876465
gen group dst list time:  0.0061054229736328125
time for parepare:  0.01975536346435547
local_output_nid generation:  0.017107009887695312
local_in_edges_tensor generation:  0.0317535400390625
mini_batch_src_global generation:  0.04046797752380371
r_  generation:  0.42614293098449707
local_output_nid generation:  0.02536797523498535
local_in_edges_tensor generation:  0.027983665466308594
mini_batch_src_global generation:  0.04845237731933594
r_  generation:  0.438277006149292
----------------------check_connections_block total spend ----------------------------- 1.2655000686645508
generate_one_block  0.5499420166015625
generate_one_block  0.543654203414917
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.017543315887451172
gen group dst list time:  0.011769294738769531
time for parepare:  0.01878976821899414
local_output_nid generation:  0.023406028747558594
local_in_edges_tensor generation:  0.02786850929260254
mini_batch_src_global generation:  0.03155994415283203
r_  generation:  0.37334775924682617
local_output_nid generation:  0.032913923263549805
local_in_edges_tensor generation:  0.03097367286682129
mini_batch_src_global generation:  0.03909921646118164
r_  generation:  0.3794407844543457
----------------------check_connections_block total spend ----------------------------- 1.1237189769744873
generate_one_block  0.4656713008880615
generate_one_block  0.46224498748779297
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1454787254333496  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

connection checking time:  2.389219045639038
block generation total time  2.021512508392334
average batch blocks generation time:  1.010756254196167
block dataloader generation time/epoch 5.900154784747532
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1090693473815918  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2278251647949219  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10978031158447266  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2284736633300781  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0811767578125 |0.021445751190185547 |0.0041953325271606445 |0.0005223751068115234 |0.0033676624298095703 |0.0019121170043945312 |
----------------------------------------------------------pseudo_mini_loss sum 0.997624397277832
Total (block generation + training)time/epoch 6.21767304284232
Training time/epoch 0.32390713691711426
Training time without block to device /epoch 0.28101563453674316
Training time without total dataloading part /epoch 0.018082857131958008
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 52.43it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.02it/s]100%|██████████| 4/4 [00:00<00:00, 15.41it/s]100%|██████████| 4/4 [00:00<00:00, 15.33it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.14it/s]100%|██████████| 4/4 [00:00<00:00, 17.77it/s]100%|██████████| 4/4 [00:00<00:00, 17.65it/s]
Run 00 | Epoch 00079 | Loss 0.9976 | Train 0.2895 | Val 0.2440 | Test 0.2284
Number of nodes during this epoch:  329674
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14544153213500977  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.016628265380859375
range selection method range initialization spend 0.012076377868652344
time for parepare:  0.015587329864501953
local_output_nid generation:  0.011059999465942383
local_in_edges_tensor generation:  0.009268045425415039
mini_batch_src_global generation:  0.011086225509643555
r_  generation:  0.14257264137268066
local_output_nid generation:  0.011955499649047852
local_in_edges_tensor generation:  0.006883144378662109
mini_batch_src_global generation:  0.014243364334106445
r_  generation:  0.15394091606140137
----------------------check_connections_block total spend ----------------------------- 0.43735837936401367
generate_one_block  0.16574716567993164
generate_one_block  0.16892337799072266
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.025703907012939453
gen group dst list time:  0.006200551986694336
time for parepare:  0.019528865814208984
local_output_nid generation:  0.0164792537689209
local_in_edges_tensor generation:  0.027106285095214844
mini_batch_src_global generation:  0.03944206237792969
r_  generation:  0.4171009063720703
local_output_nid generation:  0.024240732192993164
local_in_edges_tensor generation:  0.023418188095092773
mini_batch_src_global generation:  0.05066180229187012
r_  generation:  0.43063998222351074
----------------------check_connections_block total spend ----------------------------- 1.2356116771697998
generate_one_block  0.5429699420928955
generate_one_block  0.5352332592010498
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01857900619506836
gen group dst list time:  0.01299905776977539
time for parepare:  0.018786191940307617
local_output_nid generation:  0.02288365364074707
local_in_edges_tensor generation:  0.02950000762939453
mini_batch_src_global generation:  0.031438350677490234
r_  generation:  0.3676891326904297
local_output_nid generation:  0.030713319778442383
local_in_edges_tensor generation:  0.026056766510009766
mini_batch_src_global generation:  0.03756260871887207
r_  generation:  0.37249755859375
----------------------check_connections_block total spend ----------------------------- 1.0995562076568604
generate_one_block  0.4441373348236084
generate_one_block  0.4471886157989502
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14544153213500977  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

connection checking time:  2.33516788482666
block generation total time  1.969529151916504
average batch blocks generation time:  0.984764575958252
block dataloader generation time/epoch 5.898029166208187
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10906505584716797  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2267646789550781  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10976219177246094  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.226461410522461  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07922303676605225 |0.011725783348083496 |0.004006505012512207 |0.0005285739898681641 |0.0037107467651367188 |0.001435995101928711 |
----------------------------------------------------------pseudo_mini_loss sum 0.9966089725494385
Total (block generation + training)time/epoch 6.215339932643192
Training time/epoch 0.30269360542297363
Training time without block to device /epoch 0.27924203872680664
Training time without total dataloading part /epoch 0.01792764663696289
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 65.36it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.42it/s]100%|██████████| 4/4 [00:00<00:00, 15.72it/s]100%|██████████| 4/4 [00:00<00:00, 15.66it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.38it/s]100%|██████████| 4/4 [00:00<00:00, 17.60it/s]100%|██████████| 4/4 [00:00<00:00, 17.54it/s]
Run 00 | Epoch 00080 | Loss 0.9966 | Train 0.2878 | Val 0.2404 | Test 0.2240
Number of nodes during this epoch:  329684
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14466047286987305  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.015512228012084961
range selection method range initialization spend 0.012159109115600586
time for parepare:  0.016356945037841797
local_output_nid generation:  0.010577201843261719
local_in_edges_tensor generation:  0.007981300354003906
mini_batch_src_global generation:  0.011006593704223633
r_  generation:  0.14404869079589844
local_output_nid generation:  0.011928319931030273
local_in_edges_tensor generation:  0.006242990493774414
mini_batch_src_global generation:  0.014407157897949219
r_  generation:  0.15448737144470215
----------------------check_connections_block total spend ----------------------------- 0.43904805183410645
generate_one_block  0.16724824905395508
generate_one_block  0.16867828369140625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02608489990234375
gen group dst list time:  0.00598907470703125
time for parepare:  0.019448041915893555
local_output_nid generation:  0.017203330993652344
local_in_edges_tensor generation:  0.027048349380493164
mini_batch_src_global generation:  0.038744449615478516
r_  generation:  0.434553861618042
local_output_nid generation:  0.025545358657836914
local_in_edges_tensor generation:  0.033522605895996094
mini_batch_src_global generation:  0.04940295219421387
r_  generation:  0.44777655601501465
----------------------check_connections_block total spend ----------------------------- 1.2884516716003418
generate_one_block  0.5399093627929688
generate_one_block  0.5406277179718018
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.018740177154541016
gen group dst list time:  0.012612104415893555
time for parepare:  0.018303394317626953
local_output_nid generation:  0.023241281509399414
local_in_edges_tensor generation:  0.04496335983276367
mini_batch_src_global generation:  0.03301858901977539
r_  generation:  0.36752796173095703
local_output_nid generation:  0.030508995056152344
local_in_edges_tensor generation:  0.0279693603515625
mini_batch_src_global generation:  0.038329362869262695
r_  generation:  0.3765997886657715
----------------------check_connections_block total spend ----------------------------- 1.1254968643188477
generate_one_block  0.44267702102661133
generate_one_block  0.44814348220825195
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14466047286987305  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

connection checking time:  2.4139485359191895
block generation total time  1.9713575839996338
average batch blocks generation time:  0.9856787919998169
block dataloader generation time/epoch 5.896826949384478
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10907125473022461  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2276983261108398  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10980844497680664  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2286653518676758  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08008122444152832 |0.012691497802734375 |0.004122138023376465 |0.0005034208297729492 |0.0036869049072265625 |0.0014395713806152344 |
----------------------------------------------------------pseudo_mini_loss sum 0.9971985816955566
Total (block generation + training)time/epoch 6.213892022768657
Training time/epoch 0.2994828224182129
Training time without block to device /epoch 0.27409982681274414
Training time without total dataloading part /epoch 0.018064498901367188
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 54.77it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.13it/s]100%|██████████| 4/4 [00:00<00:00, 15.64it/s]100%|██████████| 4/4 [00:00<00:00, 15.55it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.76it/s]100%|██████████| 4/4 [00:00<00:00, 18.02it/s]100%|██████████| 4/4 [00:00<00:00, 17.96it/s]
Run 00 | Epoch 00081 | Loss 0.9972 | Train 0.2853 | Val 0.2355 | Test 0.2188
Number of nodes during this epoch:  329710
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1454482078552246  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.014482736587524414
range selection method range initialization spend 0.011943578720092773
time for parepare:  0.016458749771118164
local_output_nid generation:  0.010762691497802734
local_in_edges_tensor generation:  0.007946968078613281
mini_batch_src_global generation:  0.010982513427734375
r_  generation:  0.1426694393157959
local_output_nid generation:  0.011851310729980469
local_in_edges_tensor generation:  0.0057218074798583984
mini_batch_src_global generation:  0.014259815216064453
r_  generation:  0.15367889404296875
----------------------check_connections_block total spend ----------------------------- 0.4349966049194336
generate_one_block  0.16481971740722656
generate_one_block  0.16849565505981445
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0278470516204834
gen group dst list time:  0.005954265594482422
time for parepare:  0.019620418548583984
local_output_nid generation:  0.01706552505493164
local_in_edges_tensor generation:  0.024886608123779297
mini_batch_src_global generation:  0.03962588310241699
r_  generation:  0.41532278060913086
local_output_nid generation:  0.02800297737121582
local_in_edges_tensor generation:  0.023560047149658203
mini_batch_src_global generation:  0.047653913497924805
r_  generation:  0.43172454833984375
----------------------check_connections_block total spend ----------------------------- 1.2344152927398682
generate_one_block  0.5374054908752441
generate_one_block  0.5399322509765625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02517414093017578
gen group dst list time:  0.011599063873291016
time for parepare:  0.018555402755737305
local_output_nid generation:  0.02365875244140625
local_in_edges_tensor generation:  0.029779911041259766
mini_batch_src_global generation:  0.031131505966186523
r_  generation:  0.36390137672424316
local_output_nid generation:  0.030734539031982422
local_in_edges_tensor generation:  0.025942087173461914
mini_batch_src_global generation:  0.03756237030029297
r_  generation:  0.37091708183288574
----------------------check_connections_block total spend ----------------------------- 1.0957868099212646
generate_one_block  0.4436502456665039
generate_one_block  0.45049023628234863
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1454482078552246  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

connection checking time:  2.330202102661133
block generation total time  1.9714782238006592
average batch blocks generation time:  0.9857391119003296
block dataloader generation time/epoch 5.894459332505318
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10904121398925781  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2269024848937988  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1098165512084961  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2292094230651855  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08145761489868164 |0.011700749397277832 |0.003985881805419922 |0.0005179643630981445 |0.003101348876953125 |0.0014543533325195312 |
----------------------------------------------------------pseudo_mini_loss sum 0.9903136491775513
Total (block generation + training)time/epoch 6.211457957960155
Training time/epoch 0.3121201992034912
Training time without block to device /epoch 0.28871870040893555
Training time without total dataloading part /epoch 0.016664743423461914
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.29it/s]100%|██████████| 4/4 [00:00<00:00, 31.85it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.68it/s]100%|██████████| 4/4 [00:00<00:00, 12.79it/s]100%|██████████| 4/4 [00:00<00:00, 12.60it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.75it/s]100%|██████████| 4/4 [00:00<00:00, 17.95it/s]100%|██████████| 4/4 [00:00<00:00, 17.90it/s]
Run 00 | Epoch 00082 | Loss 0.9903 | Train 0.2833 | Val 0.2307 | Test 0.2142
Number of nodes during this epoch:  329776
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14654159545898438  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.012944698333740234
range selection method range initialization spend 0.01178431510925293
time for parepare:  0.015249967575073242
local_output_nid generation:  0.011101484298706055
local_in_edges_tensor generation:  0.007985115051269531
mini_batch_src_global generation:  0.0111083984375
r_  generation:  0.1450331211090088
local_output_nid generation:  0.012090206146240234
local_in_edges_tensor generation:  0.00579524040222168
mini_batch_src_global generation:  0.014565229415893555
r_  generation:  0.15887928009033203
----------------------check_connections_block total spend ----------------------------- 0.4445688724517822
generate_one_block  0.1681053638458252
generate_one_block  0.16879916191101074
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.023256540298461914
gen group dst list time:  0.0059261322021484375
time for parepare:  0.01957535743713379
local_output_nid generation:  0.016898632049560547
local_in_edges_tensor generation:  0.02453160285949707
mini_batch_src_global generation:  0.03935050964355469
r_  generation:  0.428905725479126
local_output_nid generation:  0.025301218032836914
local_in_edges_tensor generation:  0.02446293830871582
mini_batch_src_global generation:  0.04688119888305664
r_  generation:  0.44776010513305664
----------------------check_connections_block total spend ----------------------------- 1.2624175548553467
generate_one_block  0.5411169528961182
generate_one_block  0.5425426959991455
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01670217514038086
gen group dst list time:  0.011477231979370117
time for parepare:  0.01853156089782715
local_output_nid generation:  0.0234832763671875
local_in_edges_tensor generation:  0.028574705123901367
mini_batch_src_global generation:  0.030826807022094727
r_  generation:  0.3754088878631592
local_output_nid generation:  0.031679391860961914
local_in_edges_tensor generation:  0.027336835861206055
mini_batch_src_global generation:  0.03807544708251953
r_  generation:  0.38370275497436523
----------------------check_connections_block total spend ----------------------------- 1.1234676837921143
generate_one_block  0.4501311779022217
generate_one_block  0.4584517478942871
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14654159545898438  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

connection checking time:  2.385885238647461
block generation total time  1.9922425746917725
average batch blocks generation time:  0.9961212873458862
block dataloader generation time/epoch 5.893105117050377
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.11062335968017578  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2289276123046875  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1088862419128418  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2269196510314941  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07725656032562256 |0.01346743106842041 |0.0038629770278930664 |0.0005030632019042969 |0.0029714107513427734 |0.0016818046569824219 |
----------------------------------------------------------pseudo_mini_loss sum 0.9893114566802979
Total (block generation + training)time/epoch 6.209860450512654
Training time/epoch 0.2989058494567871
Training time without block to device /epoch 0.2719709873199463
Training time without total dataloading part /epoch 0.016356706619262695
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.90it/s]100%|██████████| 4/4 [00:00<00:00, 31.44it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.68it/s]100%|██████████| 4/4 [00:00<00:00, 12.72it/s]100%|██████████| 4/4 [00:00<00:00, 12.54it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.28it/s]100%|██████████| 4/4 [00:00<00:00, 15.22it/s]100%|██████████| 4/4 [00:00<00:00, 15.35it/s]
Run 00 | Epoch 00083 | Loss 0.9893 | Train 0.2825 | Val 0.2284 | Test 0.2116
Number of nodes during this epoch:  329827
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14552640914916992  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019592761993408203
range selection method range initialization spend 0.012677907943725586
time for parepare:  0.017646074295043945
local_output_nid generation:  0.010919809341430664
local_in_edges_tensor generation:  0.009353399276733398
mini_batch_src_global generation:  0.01103067398071289
r_  generation:  0.1448361873626709
local_output_nid generation:  0.012034416198730469
local_in_edges_tensor generation:  0.005717754364013672
mini_batch_src_global generation:  0.014873266220092773
r_  generation:  0.15845274925231934
----------------------check_connections_block total spend ----------------------------- 0.44739508628845215
generate_one_block  0.1702718734741211
generate_one_block  0.17154741287231445
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02841782569885254
gen group dst list time:  0.006039857864379883
time for parepare:  0.020547866821289062
local_output_nid generation:  0.017136096954345703
local_in_edges_tensor generation:  0.03216218948364258
mini_batch_src_global generation:  0.03959369659423828
r_  generation:  0.4268467426300049
local_output_nid generation:  0.0248262882232666
local_in_edges_tensor generation:  0.02657341957092285
mini_batch_src_global generation:  0.04751896858215332
r_  generation:  0.4375801086425781
----------------------check_connections_block total spend ----------------------------- 1.2614953517913818
generate_one_block  0.5392377376556396
generate_one_block  0.5523135662078857
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.020239591598510742
gen group dst list time:  0.011616706848144531
time for parepare:  0.018723726272583008
local_output_nid generation:  0.023349761962890625
local_in_edges_tensor generation:  0.03490853309631348
mini_batch_src_global generation:  0.03182244300842285
r_  generation:  0.3722548484802246
local_output_nid generation:  0.03049182891845703
local_in_edges_tensor generation:  0.03036022186279297
mini_batch_src_global generation:  0.03783440589904785
r_  generation:  0.39313435554504395
----------------------check_connections_block total spend ----------------------------- 1.1392741203308105
generate_one_block  0.46877479553222656
generate_one_block  0.45502185821533203
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14552640914916992  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

connection checking time:  2.4007694721221924
block generation total time  2.015347957611084
average batch blocks generation time:  1.007673978805542
block dataloader generation time/epoch 5.893303295771281
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10975980758666992  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2277779579162598  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10980463027954102  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.229322910308838  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08267700672149658 |0.012819409370422363 |0.004124283790588379 |0.0005027055740356445 |0.002942204475402832 |0.0014536380767822266 |
----------------------------------------------------------pseudo_mini_loss sum 0.9903457164764404
Total (block generation + training)time/epoch 6.209888728459676
Training time/epoch 0.30390262603759766
Training time without block to device /epoch 0.27826380729675293
Training time without total dataloading part /epoch 0.016592025756835938
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.33it/s]100%|██████████| 4/4 [00:00<00:00, 28.25it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.74it/s]100%|██████████| 4/4 [00:00<00:00, 12.23it/s]100%|██████████| 4/4 [00:00<00:00, 12.15it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.47it/s]100%|██████████| 4/4 [00:00<00:00, 18.12it/s]100%|██████████| 4/4 [00:00<00:00, 18.00it/s]
Run 00 | Epoch 00084 | Loss 0.9903 | Train 0.2815 | Val 0.2251 | Test 0.2078
Number of nodes during this epoch:  329753
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14652442932128906  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.013245105743408203
range selection method range initialization spend 0.012201786041259766
time for parepare:  0.015262603759765625
local_output_nid generation:  0.010842323303222656
local_in_edges_tensor generation:  0.00804281234741211
mini_batch_src_global generation:  0.011075735092163086
r_  generation:  0.1434187889099121
local_output_nid generation:  0.01206207275390625
local_in_edges_tensor generation:  0.005865812301635742
mini_batch_src_global generation:  0.014334440231323242
r_  generation:  0.15900206565856934
----------------------check_connections_block total spend ----------------------------- 0.4414236545562744
generate_one_block  0.17160630226135254
generate_one_block  0.17018795013427734
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.11027407646179199
gen group dst list time:  0.0074615478515625
time for parepare:  0.020542144775390625
local_output_nid generation:  0.0168459415435791
local_in_edges_tensor generation:  0.03188753128051758
mini_batch_src_global generation:  0.042646169662475586
r_  generation:  0.4284951686859131
local_output_nid generation:  0.0253603458404541
local_in_edges_tensor generation:  0.02719593048095703
mini_batch_src_global generation:  0.04952359199523926
r_  generation:  0.46868085861206055
----------------------check_connections_block total spend ----------------------------- 1.308499813079834
generate_one_block  0.5516347885131836
generate_one_block  0.5442860126495361
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.021258831024169922
gen group dst list time:  0.015299081802368164
time for parepare:  0.017973899841308594
local_output_nid generation:  0.023667097091674805
local_in_edges_tensor generation:  0.0426785945892334
mini_batch_src_global generation:  0.031158924102783203
r_  generation:  0.36778688430786133
local_output_nid generation:  0.03127551078796387
local_in_edges_tensor generation:  0.03261423110961914
mini_batch_src_global generation:  0.03760719299316406
r_  generation:  0.39607858657836914
----------------------check_connections_block total spend ----------------------------- 1.1450839042663574
generate_one_block  0.44928479194641113
generate_one_block  0.44658565521240234
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14652442932128906  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

connection checking time:  2.4535837173461914
block generation total time  1.9917912483215332
average batch blocks generation time:  0.9958956241607666
block dataloader generation time/epoch 5.894448998727296
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.11060142517089844  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2282404899597168  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10978507995605469  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2294044494628906  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08654868602752686 |0.017300128936767578 |0.0038717985153198242 |0.0004851818084716797 |0.002367854118347168 |0.0014262199401855469 |
----------------------------------------------------------pseudo_mini_loss sum 0.9889400005340576
Total (block generation + training)time/epoch 6.211200798812666
Training time/epoch 0.32909178733825684
Training time without block to device /epoch 0.2944915294647217
Training time without total dataloading part /epoch 0.01487588882446289
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 53.99it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.30it/s]100%|██████████| 4/4 [00:00<00:00, 15.61it/s]100%|██████████| 4/4 [00:00<00:00, 15.55it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.98it/s]100%|██████████| 4/4 [00:00<00:00, 18.08it/s]100%|██████████| 4/4 [00:00<00:00, 18.05it/s]
Run 00 | Epoch 00085 | Loss 0.9889 | Train 0.2808 | Val 0.2236 | Test 0.2061
Number of nodes during this epoch:  329788
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1463336944580078  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01271963119506836
range selection method range initialization spend 0.011931180953979492
time for parepare:  0.015679597854614258
local_output_nid generation:  0.01070713996887207
local_in_edges_tensor generation:  0.007951736450195312
mini_batch_src_global generation:  0.011063814163208008
r_  generation:  0.14598655700683594
local_output_nid generation:  0.012010574340820312
local_in_edges_tensor generation:  0.005694389343261719
mini_batch_src_global generation:  0.014047622680664062
r_  generation:  0.15532326698303223
----------------------check_connections_block total spend ----------------------------- 0.4387032985687256
generate_one_block  0.16834735870361328
generate_one_block  0.16963601112365723
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.034319400787353516
gen group dst list time:  0.006024837493896484
time for parepare:  0.019596099853515625
local_output_nid generation:  0.01660919189453125
local_in_edges_tensor generation:  0.02869105339050293
mini_batch_src_global generation:  0.03827810287475586
r_  generation:  0.4250054359436035
local_output_nid generation:  0.027192354202270508
local_in_edges_tensor generation:  0.024834632873535156
mini_batch_src_global generation:  0.04775261878967285
r_  generation:  0.44048309326171875
----------------------check_connections_block total spend ----------------------------- 1.2577996253967285
generate_one_block  0.5487351417541504
generate_one_block  0.5700263977050781
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.021437883377075195
gen group dst list time:  0.013284683227539062
time for parepare:  0.021433591842651367
local_output_nid generation:  0.024063825607299805
local_in_edges_tensor generation:  0.04607033729553223
mini_batch_src_global generation:  0.03981447219848633
r_  generation:  0.3739752769470215
local_output_nid generation:  0.03186535835266113
local_in_edges_tensor generation:  0.03136110305786133
mini_batch_src_global generation:  0.037598609924316406
r_  generation:  0.38269925117492676
----------------------check_connections_block total spend ----------------------------- 1.1642160415649414
generate_one_block  0.4673151969909668
generate_one_block  0.4499990940093994
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1463336944580078  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

connection checking time:  2.42201566696167
block generation total time  2.0360758304595947
average batch blocks generation time:  1.0180379152297974
block dataloader generation time/epoch 5.894855982297427
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1105804443359375  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.227797508239746  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10980558395385742  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.229626178741455  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08025586605072021 |0.022128939628601074 |0.004052877426147461 |0.0005165338516235352 |0.00388944149017334 |0.0029256343841552734 |
----------------------------------------------------------pseudo_mini_loss sum 0.9855866432189941
Total (block generation + training)time/epoch 6.211655551737005
Training time/epoch 0.3202781677246094
Training time without block to device /epoch 0.2760202884674072
Training time without total dataloading part /epoch 0.019843339920043945
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.61it/s]100%|██████████| 4/4 [00:00<00:00, 28.44it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.61it/s]100%|██████████| 4/4 [00:00<00:00, 12.75it/s]100%|██████████| 4/4 [00:00<00:00, 12.56it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.17it/s]100%|██████████| 4/4 [00:00<00:00, 17.81it/s]100%|██████████| 4/4 [00:00<00:00, 17.69it/s]
Run 00 | Epoch 00086 | Loss 0.9856 | Train 0.2805 | Val 0.2223 | Test 0.2048
Number of nodes during this epoch:  329719
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14646148681640625  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.014868974685668945
range selection method range initialization spend 0.012042522430419922
time for parepare:  0.015614748001098633
local_output_nid generation:  0.010880231857299805
local_in_edges_tensor generation:  0.00867152214050293
mini_batch_src_global generation:  0.011069536209106445
r_  generation:  0.14420700073242188
local_output_nid generation:  0.01187896728515625
local_in_edges_tensor generation:  0.005716085433959961
mini_batch_src_global generation:  0.014161825180053711
r_  generation:  0.1542668342590332
----------------------check_connections_block total spend ----------------------------- 0.4372742176055908
generate_one_block  0.16637682914733887
generate_one_block  0.16815567016601562
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028903961181640625
gen group dst list time:  0.006062746047973633
time for parepare:  0.019759654998779297
local_output_nid generation:  0.018009185791015625
local_in_edges_tensor generation:  0.028906583786010742
mini_batch_src_global generation:  0.03897809982299805
r_  generation:  0.4373908042907715
local_output_nid generation:  0.027919530868530273
local_in_edges_tensor generation:  0.03175687789916992
mini_batch_src_global generation:  0.048650503158569336
r_  generation:  0.4345057010650635
----------------------check_connections_block total spend ----------------------------- 1.2775907516479492
generate_one_block  0.5465173721313477
generate_one_block  0.5384163856506348
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02482748031616211
gen group dst list time:  0.011970043182373047
time for parepare:  0.018891096115112305
local_output_nid generation:  0.023906946182250977
local_in_edges_tensor generation:  0.04587531089782715
mini_batch_src_global generation:  0.03171849250793457
r_  generation:  0.3668019771575928
local_output_nid generation:  0.03357338905334473
local_in_edges_tensor generation:  0.026427507400512695
mini_batch_src_global generation:  0.03761434555053711
r_  generation:  0.3742995262145996
----------------------check_connections_block total spend ----------------------------- 1.1219451427459717
generate_one_block  0.44135141372680664
generate_one_block  0.4465603828430176
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14646148681640625  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

connection checking time:  2.399535894393921
block generation total time  1.9728455543518066
average batch blocks generation time:  0.9864227771759033
block dataloader generation time/epoch 5.894052768364931
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.11059045791625977  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2288336753845215  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10887289047241211  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2259979248046875  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08276855945587158 |0.011895179748535156 |0.004157662391662598 |0.0005265474319458008 |0.003119349479675293 |0.0023241043090820312 |
----------------------------------------------------------pseudo_mini_loss sum 0.9809060096740723
Total (block generation + training)time/epoch 6.210685861416352
Training time/epoch 0.303663969039917
Training time without block to device /epoch 0.2798736095428467
Training time without total dataloading part /epoch 0.017931222915649414
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.34it/s]100%|██████████| 4/4 [00:00<00:00, 28.30it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.81it/s]100%|██████████| 4/4 [00:00<00:00, 12.27it/s]100%|██████████| 4/4 [00:00<00:00, 12.19it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.55it/s]100%|██████████| 4/4 [00:00<00:00, 17.61it/s]100%|██████████| 4/4 [00:00<00:00, 17.58it/s]
Run 00 | Epoch 00087 | Loss 0.9809 | Train 0.2791 | Val 0.2197 | Test 0.2023
Number of nodes during this epoch:  329834
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14476728439331055  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.015542745590209961
range selection method range initialization spend 0.011910200119018555
time for parepare:  0.015571117401123047
local_output_nid generation:  0.011243581771850586
local_in_edges_tensor generation:  0.008719682693481445
mini_batch_src_global generation:  0.011321306228637695
r_  generation:  0.14396071434020996
local_output_nid generation:  0.01201629638671875
local_in_edges_tensor generation:  0.005635499954223633
mini_batch_src_global generation:  0.014329671859741211
r_  generation:  0.15502047538757324
----------------------check_connections_block total spend ----------------------------- 0.43923282623291016
generate_one_block  0.16680073738098145
generate_one_block  0.1687171459197998
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.027629852294921875
gen group dst list time:  0.006133556365966797
time for parepare:  0.021147727966308594
local_output_nid generation:  0.016678333282470703
local_in_edges_tensor generation:  0.026258230209350586
mini_batch_src_global generation:  0.03924369812011719
r_  generation:  0.42070770263671875
local_output_nid generation:  0.026396512985229492
local_in_edges_tensor generation:  0.023669719696044922
mini_batch_src_global generation:  0.048038482666015625
r_  generation:  0.4456307888031006
----------------------check_connections_block total spend ----------------------------- 1.2592251300811768
generate_one_block  0.5771675109863281
generate_one_block  0.5527589321136475
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.031255245208740234
gen group dst list time:  0.01366877555847168
time for parepare:  0.018672704696655273
local_output_nid generation:  0.02272796630859375
local_in_edges_tensor generation:  0.04126477241516113
mini_batch_src_global generation:  0.03251314163208008
r_  generation:  0.37568092346191406
local_output_nid generation:  0.03083014488220215
local_in_edges_tensor generation:  0.02727675437927246
mini_batch_src_global generation:  0.03792715072631836
r_  generation:  0.38634681701660156
----------------------check_connections_block total spend ----------------------------- 1.1410067081451416
generate_one_block  0.4546811580657959
generate_one_block  0.4557814598083496
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14476728439331055  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

connection checking time:  2.4002318382263184
block generation total time  2.040389060974121
average batch blocks generation time:  1.0201945304870605
block dataloader generation time/epoch 5.894103186039985
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1097874641418457  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.22853422164917  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1098337173461914  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2289748191833496  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08197081089019775 |0.016213417053222656 |0.004209160804748535 |0.000523686408996582 |0.0030052661895751953 |0.0013780593872070312 |
----------------------------------------------------------pseudo_mini_loss sum 0.9786036014556885
Total (block generation + training)time/epoch 6.210725428182868
Training time/epoch 0.3156254291534424
Training time without block to device /epoch 0.28319859504699707
Training time without total dataloading part /epoch 0.016854286193847656
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.16it/s]100%|██████████| 4/4 [00:00<00:00, 29.36it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.65it/s]100%|██████████| 4/4 [00:00<00:00, 12.85it/s]100%|██████████| 4/4 [00:00<00:00, 12.64it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.20it/s]100%|██████████| 4/4 [00:00<00:00, 17.48it/s]100%|██████████| 4/4 [00:00<00:00, 17.41it/s]
Run 00 | Epoch 00088 | Loss 0.9786 | Train 0.2764 | Val 0.2150 | Test 0.1967
Number of nodes during this epoch:  329869
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14632415771484375  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01676177978515625
range selection method range initialization spend 0.012571573257446289
time for parepare:  0.01572871208190918
local_output_nid generation:  0.01078176498413086
local_in_edges_tensor generation:  0.008042573928833008
mini_batch_src_global generation:  0.011291265487670898
r_  generation:  0.14316058158874512
local_output_nid generation:  0.011833906173706055
local_in_edges_tensor generation:  0.00667262077331543
mini_batch_src_global generation:  0.014323711395263672
r_  generation:  0.15488147735595703
----------------------check_connections_block total spend ----------------------------- 0.43793725967407227
generate_one_block  0.16782498359680176
generate_one_block  0.16931366920471191
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030238628387451172
gen group dst list time:  0.006057262420654297
time for parepare:  0.01967930793762207
local_output_nid generation:  0.01779961585998535
local_in_edges_tensor generation:  0.027770280838012695
mini_batch_src_global generation:  0.04042196273803711
r_  generation:  0.4370455741882324
local_output_nid generation:  0.028061389923095703
local_in_edges_tensor generation:  0.03137564659118652
mini_batch_src_global generation:  0.04787087440490723
r_  generation:  0.4328908920288086
----------------------check_connections_block total spend ----------------------------- 1.2739744186401367
generate_one_block  0.5391747951507568
generate_one_block  0.5437221527099609
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.018230915069580078
gen group dst list time:  0.011588096618652344
time for parepare:  0.018543243408203125
local_output_nid generation:  0.02386641502380371
local_in_edges_tensor generation:  0.0472407341003418
mini_batch_src_global generation:  0.03208351135253906
r_  generation:  0.36936092376708984
local_output_nid generation:  0.03119826316833496
local_in_edges_tensor generation:  0.027326345443725586
mini_batch_src_global generation:  0.03806614875793457
r_  generation:  0.373546838760376
----------------------check_connections_block total spend ----------------------------- 1.126542091369629
generate_one_block  0.4423027038574219
generate_one_block  0.44405269622802734
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14632415771484375  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

connection checking time:  2.4005165100097656
block generation total time  1.969252347946167
average batch blocks generation time:  0.9846261739730835
block dataloader generation time/epoch 5.893313381075859
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1090688705444336  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2276639938354492  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10979223251342773  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2279243469238281  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08339738845825195 |0.01217198371887207 |0.004327297210693359 |0.0005346536636352539 |0.002554774284362793 |0.0014853477478027344 |
----------------------------------------------------------pseudo_mini_loss sum 0.9795887470245361
Total (block generation + training)time/epoch 6.209800332784653
Training time/epoch 0.30564045906066895
Training time without block to device /epoch 0.2812964916229248
Training time without total dataloading part /epoch 0.016318798065185547
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.27it/s]100%|██████████| 4/4 [00:00<00:00, 28.00it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.70it/s]100%|██████████| 4/4 [00:00<00:00, 12.22it/s]100%|██████████| 4/4 [00:00<00:00, 12.13it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.97it/s]100%|██████████| 4/4 [00:00<00:00, 17.72it/s]100%|██████████| 4/4 [00:00<00:00, 17.74it/s]
Run 00 | Epoch 00089 | Loss 0.9796 | Train 0.2740 | Val 0.2102 | Test 0.1920
Number of nodes during this epoch:  329761
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14673328399658203  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.012898445129394531
range selection method range initialization spend 0.01199483871459961
time for parepare:  0.015492916107177734
local_output_nid generation:  0.010751724243164062
local_in_edges_tensor generation:  0.007891178131103516
mini_batch_src_global generation:  0.011148691177368164
r_  generation:  0.14688491821289062
local_output_nid generation:  0.01184535026550293
local_in_edges_tensor generation:  0.005694389343261719
mini_batch_src_global generation:  0.014766931533813477
r_  generation:  0.1560213565826416
----------------------check_connections_block total spend ----------------------------- 0.4409677982330322
generate_one_block  0.16606402397155762
generate_one_block  0.16964936256408691
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.026329755783081055
gen group dst list time:  0.006030559539794922
time for parepare:  0.021021127700805664
local_output_nid generation:  0.01800537109375
local_in_edges_tensor generation:  0.0296018123626709
mini_batch_src_global generation:  0.03913259506225586
r_  generation:  0.4253852367401123
local_output_nid generation:  0.025693655014038086
local_in_edges_tensor generation:  0.024970531463623047
mini_batch_src_global generation:  0.04915142059326172
r_  generation:  0.44824886322021484
----------------------check_connections_block total spend ----------------------------- 1.2704532146453857
generate_one_block  0.5743920803070068
generate_one_block  0.5600466728210449
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.021967172622680664
gen group dst list time:  0.013529777526855469
time for parepare:  0.019760608673095703
local_output_nid generation:  0.023837566375732422
local_in_edges_tensor generation:  0.042299509048461914
mini_batch_src_global generation:  0.032947540283203125
r_  generation:  0.37127065658569336
local_output_nid generation:  0.03117990493774414
local_in_edges_tensor generation:  0.02995920181274414
mini_batch_src_global generation:  0.03756904602050781
r_  generation:  0.38043665885925293
----------------------check_connections_block total spend ----------------------------- 1.1339304447174072
generate_one_block  0.4644289016723633
generate_one_block  0.4519035816192627
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14673328399658203  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

connection checking time:  2.404383659362793
block generation total time  2.0507712364196777
average batch blocks generation time:  1.0253856182098389
block dataloader generation time/epoch 5.8934362258440185
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10904121398925781  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2270665168762207  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10977983474731445  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.227536678314209  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.091636061668396 |0.015699386596679688 |0.00452876091003418 |0.0006113052368164062 |0.0026720762252807617 |0.0021581649780273438 |
----------------------------------------------------------pseudo_mini_loss sum 0.9751580357551575
Total (block generation + training)time/epoch 6.210035886293576
Training time/epoch 0.32546329498291016
Training time without block to device /epoch 0.2940645217895508
Training time without total dataloading part /epoch 0.01778244972229004
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.67it/s]100%|██████████| 4/4 [00:00<00:00, 27.33it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.80it/s]100%|██████████| 4/4 [00:00<00:00, 12.90it/s]100%|██████████| 4/4 [00:00<00:00, 12.71it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.01it/s]100%|██████████| 4/4 [00:00<00:00, 17.51it/s]100%|██████████| 4/4 [00:00<00:00, 17.42it/s]
Run 00 | Epoch 00090 | Loss 0.9752 | Train 0.2719 | Val 0.2068 | Test 0.1875
Number of nodes during this epoch:  329662
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14682722091674805  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.013808250427246094
range selection method range initialization spend 0.012356042861938477
time for parepare:  0.015154123306274414
local_output_nid generation:  0.01080632209777832
local_in_edges_tensor generation:  0.007869243621826172
mini_batch_src_global generation:  0.011084794998168945
r_  generation:  0.17547845840454102
local_output_nid generation:  0.012192010879516602
local_in_edges_tensor generation:  0.0057904720306396484
mini_batch_src_global generation:  0.017022371292114258
r_  generation:  0.1579756736755371
----------------------check_connections_block total spend ----------------------------- 0.47516965866088867
generate_one_block  0.16767334938049316
generate_one_block  0.17003178596496582
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028018951416015625
gen group dst list time:  0.006134033203125
time for parepare:  0.020063400268554688
local_output_nid generation:  0.017942428588867188
local_in_edges_tensor generation:  0.03081226348876953
mini_batch_src_global generation:  0.040686607360839844
r_  generation:  0.4511563777923584
local_output_nid generation:  0.029060840606689453
local_in_edges_tensor generation:  0.033966064453125
mini_batch_src_global generation:  0.05025219917297363
r_  generation:  0.4423253536224365
----------------------check_connections_block total spend ----------------------------- 1.3101279735565186
generate_one_block  0.5542604923248291
generate_one_block  0.5419342517852783
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.022023916244506836
gen group dst list time:  0.011729717254638672
time for parepare:  0.01926398277282715
local_output_nid generation:  0.02599334716796875
local_in_edges_tensor generation:  0.03785586357116699
mini_batch_src_global generation:  0.030671358108520508
r_  generation:  0.3741934299468994
local_output_nid generation:  0.03232431411743164
local_in_edges_tensor generation:  0.030893564224243164
mini_batch_src_global generation:  0.03921341896057129
r_  generation:  0.38462257385253906
----------------------check_connections_block total spend ----------------------------- 1.139909267425537
generate_one_block  0.45307469367980957
generate_one_block  0.4633982181549072
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14682722091674805  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

connection checking time:  2.4500372409820557
block generation total time  2.012667655944824
average batch blocks generation time:  1.006333827972412
block dataloader generation time/epoch 5.894170807629097
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10908365249633789  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2274293899536133  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10975980758666992  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2290449142456055  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08371841907501221 |0.02141129970550537 |0.004244804382324219 |0.0005137920379638672 |0.003031134605407715 |0.0014383792877197266 |
----------------------------------------------------------pseudo_mini_loss sum 0.9720204472541809
Total (block generation + training)time/epoch 6.210903563150546
Training time/epoch 0.327362060546875
Training time without block to device /epoch 0.28453946113586426
Training time without total dataloading part /epoch 0.017017841339111328
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 52.79it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.48it/s]100%|██████████| 4/4 [00:00<00:00, 15.96it/s]100%|██████████| 4/4 [00:00<00:00, 15.87it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.71it/s]100%|██████████| 4/4 [00:00<00:00, 20.55it/s]
Run 00 | Epoch 00091 | Loss 0.9720 | Train 0.2711 | Val 0.2048 | Test 0.1850
Number of nodes during this epoch:  329785
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14646434783935547  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.013943910598754883
range selection method range initialization spend 0.01225733757019043
time for parepare:  0.017096757888793945
local_output_nid generation:  0.010907649993896484
local_in_edges_tensor generation:  0.01338338851928711
mini_batch_src_global generation:  0.01139974594116211
r_  generation:  0.14527034759521484
local_output_nid generation:  0.011845588684082031
local_in_edges_tensor generation:  0.00626373291015625
mini_batch_src_global generation:  0.014245748519897461
r_  generation:  0.1571340560913086
----------------------check_connections_block total spend ----------------------------- 0.44885969161987305
generate_one_block  0.16908597946166992
generate_one_block  0.17037320137023926
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.026883840560913086
gen group dst list time:  0.006083488464355469
time for parepare:  0.020621061325073242
local_output_nid generation:  0.017288684844970703
local_in_edges_tensor generation:  0.032379865646362305
mini_batch_src_global generation:  0.04072308540344238
r_  generation:  0.4249441623687744
local_output_nid generation:  0.026403188705444336
local_in_edges_tensor generation:  0.029445648193359375
mini_batch_src_global generation:  0.04780459403991699
r_  generation:  0.4409146308898926
----------------------check_connections_block total spend ----------------------------- 1.2710304260253906
generate_one_block  0.5508413314819336
generate_one_block  0.5423061847686768
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02498936653137207
gen group dst list time:  0.011614561080932617
time for parepare:  0.01861262321472168
local_output_nid generation:  0.02414703369140625
local_in_edges_tensor generation:  0.029399871826171875
mini_batch_src_global generation:  0.03109264373779297
r_  generation:  0.3695857524871826
local_output_nid generation:  0.031380653381347656
local_in_edges_tensor generation:  0.027521133422851562
mini_batch_src_global generation:  0.03784322738647461
r_  generation:  0.3830997943878174
----------------------check_connections_block total spend ----------------------------- 1.116786241531372
generate_one_block  0.45615577697753906
generate_one_block  0.45948004722595215
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14646434783935547  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

connection checking time:  2.3878166675567627
block generation total time  2.0087833404541016
average batch blocks generation time:  1.0043916702270508
block dataloader generation time/epoch 5.893977886222931
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.11063671112060547  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2269935607910156  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10980653762817383  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2295403480529785  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08275806903839111 |0.013014554977416992 |0.004247546195983887 |0.0005216598510742188 |0.0036815404891967773 |0.0014753341674804688 |
----------------------------------------------------------pseudo_mini_loss sum 0.9752917289733887
Total (block generation + training)time/epoch 6.21063788540392
Training time/epoch 0.3105442523956299
Training time without block to device /epoch 0.2845151424407959
Training time without total dataloading part /epoch 0.018376827239990234
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.11it/s]100%|██████████| 4/4 [00:00<00:00, 31.11it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.56it/s]100%|██████████| 4/4 [00:00<00:00, 12.82it/s]100%|██████████| 4/4 [00:00<00:00, 12.60it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.74it/s]100%|██████████| 4/4 [00:00<00:00, 17.83it/s]100%|██████████| 4/4 [00:00<00:00, 17.79it/s]
Run 00 | Epoch 00092 | Loss 0.9753 | Train 0.2710 | Val 0.2035 | Test 0.1835
Number of nodes during this epoch:  329620
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14658594131469727  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.013471603393554688
range selection method range initialization spend 0.012007951736450195
time for parepare:  0.01693439483642578
local_output_nid generation:  0.011236429214477539
local_in_edges_tensor generation:  0.008265018463134766
mini_batch_src_global generation:  0.011343955993652344
r_  generation:  0.14910292625427246
local_output_nid generation:  0.012386560440063477
local_in_edges_tensor generation:  0.005678415298461914
mini_batch_src_global generation:  0.014282464981079102
r_  generation:  0.1566917896270752
----------------------check_connections_block total spend ----------------------------- 0.4475700855255127
generate_one_block  0.16776275634765625
generate_one_block  0.1701033115386963
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02652430534362793
gen group dst list time:  0.00606536865234375
time for parepare:  0.019956111907958984
local_output_nid generation:  0.01793050765991211
local_in_edges_tensor generation:  0.026901960372924805
mini_batch_src_global generation:  0.03870034217834473
r_  generation:  0.42847299575805664
local_output_nid generation:  0.02908158302307129
local_in_edges_tensor generation:  0.03487515449523926
mini_batch_src_global generation:  0.05083489418029785
r_  generation:  0.46233654022216797
----------------------check_connections_block total spend ----------------------------- 1.301694393157959
generate_one_block  0.5503544807434082
generate_one_block  0.5455837249755859
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028488636016845703
gen group dst list time:  0.012541055679321289
time for parepare:  0.018939971923828125
local_output_nid generation:  0.023872852325439453
local_in_edges_tensor generation:  0.03655719757080078
mini_batch_src_global generation:  0.03111433982849121
r_  generation:  0.3757617473602295
local_output_nid generation:  0.03188323974609375
local_in_edges_tensor generation:  0.029095172882080078
mini_batch_src_global generation:  0.03780198097229004
r_  generation:  0.3793914318084717
----------------------check_connections_block total spend ----------------------------- 1.1281311511993408
generate_one_block  0.44970083236694336
generate_one_block  0.4494197368621826
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14658594131469727  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

connection checking time:  2.4298255443573
block generation total time  1.9950587749481201
average batch blocks generation time:  0.9975293874740601
block dataloader generation time/epoch 5.8939646908215115
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.11062002182006836  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2287745475769043  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10886955261230469  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.226121425628662  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08204102516174316 |0.012479066848754883 |0.004264473915100098 |0.0005285739898681641 |0.0037603378295898438 |0.001493215560913086 |
----------------------------------------------------------pseudo_mini_loss sum 0.9713566303253174
Total (block generation + training)time/epoch 6.210463617529188
Training time/epoch 0.30298805236816406
Training time without block to device /epoch 0.2780299186706543
Training time without total dataloading part /epoch 0.018599987030029297
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 57.39it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.33it/s]100%|██████████| 4/4 [00:00<00:00, 15.55it/s]100%|██████████| 4/4 [00:00<00:00, 15.50it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.90it/s]100%|██████████| 4/4 [00:00<00:00, 17.74it/s]100%|██████████| 4/4 [00:00<00:00, 17.75it/s]
Run 00 | Epoch 00093 | Loss 0.9714 | Train 0.2707 | Val 0.2023 | Test 0.1819
Number of nodes during this epoch:  329688
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1457347869873047  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.014210939407348633
range selection method range initialization spend 0.012016057968139648
time for parepare:  0.015591621398925781
local_output_nid generation:  0.011283397674560547
local_in_edges_tensor generation:  0.008046150207519531
mini_batch_src_global generation:  0.01107478141784668
r_  generation:  0.14696145057678223
local_output_nid generation:  0.011935949325561523
local_in_edges_tensor generation:  0.005708932876586914
mini_batch_src_global generation:  0.014203071594238281
r_  generation:  0.156541109085083
----------------------check_connections_block total spend ----------------------------- 0.4423971176147461
generate_one_block  0.16685032844543457
generate_one_block  0.17024445533752441
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02604818344116211
gen group dst list time:  0.006145477294921875
time for parepare:  0.019834518432617188
local_output_nid generation:  0.017458677291870117
local_in_edges_tensor generation:  0.026863574981689453
mini_batch_src_global generation:  0.04021596908569336
r_  generation:  0.42526984214782715
local_output_nid generation:  0.025653362274169922
local_in_edges_tensor generation:  0.02416515350341797
mini_batch_src_global generation:  0.04857468605041504
r_  generation:  0.4434061050415039
----------------------check_connections_block total spend ----------------------------- 1.2608261108398438
generate_one_block  0.5391445159912109
generate_one_block  0.5435483455657959
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.019012928009033203
gen group dst list time:  0.011594772338867188
time for parepare:  0.018585205078125
local_output_nid generation:  0.024804353713989258
local_in_edges_tensor generation:  0.029081106185913086
mini_batch_src_global generation:  0.03366804122924805
r_  generation:  0.376389741897583
local_output_nid generation:  0.032755136489868164
local_in_edges_tensor generation:  0.027063369750976562
mini_batch_src_global generation:  0.03804898262023926
r_  generation:  0.3849799633026123
----------------------check_connections_block total spend ----------------------------- 1.1320130825042725
generate_one_block  0.4564840793609619
generate_one_block  0.45815348625183105
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1457347869873047  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

connection checking time:  2.392839193344116
block generation total time  1.9973304271697998
average batch blocks generation time:  0.9986652135848999
block dataloader generation time/epoch 5.893305150200339
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10976266860961914  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2278261184692383  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10985374450683594  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2301788330078125  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08932268619537354 |0.02076864242553711 |0.0038709640502929688 |0.000498652458190918 |0.003797292709350586 |0.00142669677734375 |
----------------------------------------------------------pseudo_mini_loss sum 0.9682010412216187
Total (block generation + training)time/epoch 6.210026724198285
Training time/epoch 0.3353383541107178
Training time without block to device /epoch 0.29380106925964355
Training time without total dataloading part /epoch 0.017760515213012695
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 49.94it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.01it/s]100%|██████████| 4/4 [00:00<00:00, 15.44it/s]100%|██████████| 4/4 [00:00<00:00, 15.35it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.37it/s]100%|██████████| 4/4 [00:00<00:00, 17.50it/s]100%|██████████| 4/4 [00:00<00:00, 17.46it/s]
Run 00 | Epoch 00094 | Loss 0.9682 | Train 0.2710 | Val 0.2022 | Test 0.1817
Number of nodes during this epoch:  329762
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14624547958374023  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.016657352447509766
range selection method range initialization spend 0.012034416198730469
time for parepare:  0.016632080078125
local_output_nid generation:  0.011133909225463867
local_in_edges_tensor generation:  0.01174473762512207
mini_batch_src_global generation:  0.011168718338012695
r_  generation:  0.1458570957183838
local_output_nid generation:  0.011943817138671875
local_in_edges_tensor generation:  0.00617527961730957
mini_batch_src_global generation:  0.014376401901245117
r_  generation:  0.15567636489868164
----------------------check_connections_block total spend ----------------------------- 0.4453125
generate_one_block  0.16781067848205566
generate_one_block  0.16961121559143066
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030433177947998047
gen group dst list time:  0.00616908073425293
time for parepare:  0.02147054672241211
local_output_nid generation:  0.016881704330444336
local_in_edges_tensor generation:  0.03642916679382324
mini_batch_src_global generation:  0.04073643684387207
r_  generation:  0.43700313568115234
local_output_nid generation:  0.02538895606994629
local_in_edges_tensor generation:  0.027743816375732422
mini_batch_src_global generation:  0.04918217658996582
r_  generation:  0.4427471160888672
----------------------check_connections_block total spend ----------------------------- 1.2863738536834717
generate_one_block  0.5587680339813232
generate_one_block  0.5688204765319824
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.020836591720581055
gen group dst list time:  0.013817071914672852
time for parepare:  0.018381595611572266
local_output_nid generation:  0.02313089370727539
local_in_edges_tensor generation:  0.03616023063659668
mini_batch_src_global generation:  0.030853271484375
r_  generation:  0.3723752498626709
local_output_nid generation:  0.030660152435302734
local_in_edges_tensor generation:  0.03165435791015625
mini_batch_src_global generation:  0.03792595863342285
r_  generation:  0.38126707077026367
----------------------check_connections_block total spend ----------------------------- 1.1277871131896973
generate_one_block  0.4476280212402344
generate_one_block  0.45034003257751465
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14624547958374023  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

connection checking time:  2.414160966873169
block generation total time  2.0255565643310547
average batch blocks generation time:  1.0127782821655273
block dataloader generation time/epoch 5.893945990606796
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.11049556732177734  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2290349006652832  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1088409423828125  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2265105247497559  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09323620796203613 |0.0183030366897583 |0.004093289375305176 |0.0004941225051879883 |0.003937840461730957 |0.003140687942504883 |
----------------------------------------------------------pseudo_mini_loss sum 0.9669641256332397
Total (block generation + training)time/epoch 6.210929676543834
Training time/epoch 0.3391134738922119
Training time without block to device /epoch 0.3025074005126953
Training time without total dataloading part /epoch 0.020191192626953125
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 50.30it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.20it/s]100%|██████████| 4/4 [00:00<00:00, 15.42it/s]100%|██████████| 4/4 [00:00<00:00, 15.37it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.62it/s]100%|██████████| 4/4 [00:00<00:00, 17.61it/s]100%|██████████| 4/4 [00:00<00:00, 17.59it/s]
Run 00 | Epoch 00095 | Loss 0.9670 | Train 0.2704 | Val 0.2011 | Test 0.1805
Number of nodes during this epoch:  329772
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14558076858520508  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.015123605728149414
range selection method range initialization spend 0.01217198371887207
time for parepare:  0.015504837036132812
local_output_nid generation:  0.011125326156616211
local_in_edges_tensor generation:  0.00818777084350586
mini_batch_src_global generation:  0.01115870475769043
r_  generation:  0.14529705047607422
local_output_nid generation:  0.011997222900390625
local_in_edges_tensor generation:  0.00588536262512207
mini_batch_src_global generation:  0.014045000076293945
r_  generation:  0.15725088119506836
----------------------check_connections_block total spend ----------------------------- 0.44153666496276855
generate_one_block  0.16825056076049805
generate_one_block  0.1697702407836914
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028353452682495117
gen group dst list time:  0.006104707717895508
time for parepare:  0.019906282424926758
local_output_nid generation:  0.017555952072143555
local_in_edges_tensor generation:  0.028619766235351562
mini_batch_src_global generation:  0.03881335258483887
r_  generation:  0.4398915767669678
local_output_nid generation:  0.027836322784423828
local_in_edges_tensor generation:  0.024826765060424805
mini_batch_src_global generation:  0.04819893836975098
r_  generation:  0.44253063201904297
----------------------check_connections_block total spend ----------------------------- 1.2792634963989258
generate_one_block  0.5545885562896729
generate_one_block  0.5758254528045654
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.023859262466430664
gen group dst list time:  0.014427661895751953
time for parepare:  0.020229816436767578
local_output_nid generation:  0.0244901180267334
local_in_edges_tensor generation:  0.040776968002319336
mini_batch_src_global generation:  0.03230619430541992
r_  generation:  0.38365721702575684
local_output_nid generation:  0.03197479248046875
local_in_edges_tensor generation:  0.029328107833862305
mini_batch_src_global generation:  0.03819584846496582
r_  generation:  0.3857152462005615
----------------------check_connections_block total spend ----------------------------- 1.1641199588775635
generate_one_block  0.4685356616973877
generate_one_block  0.4621591567993164
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14558076858520508  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

connection checking time:  2.4433834552764893
block generation total time  2.0611088275909424
average batch blocks generation time:  1.0305544137954712
block dataloader generation time/epoch 5.894906296127144
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10977506637573242  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.228384017944336  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10980463027954102  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.227522373199463  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08128678798675537 |0.026581525802612305 |0.004119515419006348 |0.0005064010620117188 |0.003936052322387695 |0.0015244483947753906 |
----------------------------------------------------------pseudo_mini_loss sum 0.9655487537384033
Total (block generation + training)time/epoch 6.212037094708147
Training time/epoch 0.329632043838501
Training time without block to device /epoch 0.27646899223327637
Training time without total dataloading part /epoch 0.018648386001586914
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 49.90it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.23it/s]100%|██████████| 4/4 [00:00<00:00, 15.57it/s]100%|██████████| 4/4 [00:00<00:00, 15.50it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.36it/s]100%|██████████| 4/4 [00:00<00:00, 17.94it/s]100%|██████████| 4/4 [00:00<00:00, 17.83it/s]
Run 00 | Epoch 00096 | Loss 0.9655 | Train 0.2700 | Val 0.1994 | Test 0.1789
Number of nodes during this epoch:  329799
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1458282470703125  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.016788959503173828
range selection method range initialization spend 0.012369394302368164
time for parepare:  0.01719808578491211
local_output_nid generation:  0.011222362518310547
local_in_edges_tensor generation:  0.014220714569091797
mini_batch_src_global generation:  0.010894298553466797
r_  generation:  0.14607763290405273
local_output_nid generation:  0.011897563934326172
local_in_edges_tensor generation:  0.006284475326538086
mini_batch_src_global generation:  0.014469385147094727
r_  generation:  0.15720105171203613
----------------------check_connections_block total spend ----------------------------- 0.4501352310180664
generate_one_block  0.16902780532836914
generate_one_block  0.17006874084472656
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029328584671020508
gen group dst list time:  0.006114006042480469
time for parepare:  0.020399808883666992
local_output_nid generation:  0.018011808395385742
local_in_edges_tensor generation:  0.03602862358093262
mini_batch_src_global generation:  0.03978896141052246
r_  generation:  0.42438507080078125
local_output_nid generation:  0.02773761749267578
local_in_edges_tensor generation:  0.026196718215942383
mini_batch_src_global generation:  0.04747414588928223
r_  generation:  0.4393270015716553
----------------------check_connections_block total spend ----------------------------- 1.2699792385101318
generate_one_block  0.5359208583831787
generate_one_block  0.5377354621887207
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.023283720016479492
gen group dst list time:  0.01169276237487793
time for parepare:  0.019230365753173828
local_output_nid generation:  0.02416849136352539
local_in_edges_tensor generation:  0.03725314140319824
mini_batch_src_global generation:  0.030463218688964844
r_  generation:  0.36945676803588867
local_output_nid generation:  0.03174090385437012
local_in_edges_tensor generation:  0.027824878692626953
mini_batch_src_global generation:  0.03782773017883301
r_  generation:  0.3808882236480713
----------------------check_connections_block total spend ----------------------------- 1.1222259998321533
generate_one_block  0.4504561424255371
generate_one_block  0.45363616943359375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1458282470703125  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

connection checking time:  2.392205238342285
block generation total time  1.9777486324310303
average batch blocks generation time:  0.9888743162155151
block dataloader generation time/epoch 5.8944317833943805
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10904216766357422  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2268800735473633  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10979318618774414  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2279577255249023  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07780122756958008 |0.012523412704467773 |0.004498481750488281 |0.0005217790603637695 |0.003283977508544922 |0.0022478103637695312 |
----------------------------------------------------------pseudo_mini_loss sum 0.9648846387863159
Total (block generation + training)time/epoch 6.211379105394537
Training time/epoch 0.3008260726928711
Training time without block to device /epoch 0.27577924728393555
Training time without total dataloading part /epoch 0.018856287002563477
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.90it/s]100%|██████████| 4/4 [00:00<00:00, 27.86it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.80it/s]100%|██████████| 4/4 [00:00<00:00, 12.24it/s]100%|██████████| 4/4 [00:00<00:00, 12.16it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.61it/s]100%|██████████| 4/4 [00:00<00:00, 17.78it/s]100%|██████████| 4/4 [00:00<00:00, 17.73it/s]
Run 00 | Epoch 00097 | Loss 0.9649 | Train 0.2690 | Val 0.1975 | Test 0.1772
Number of nodes during this epoch:  329688
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14670515060424805  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01424860954284668
range selection method range initialization spend 0.011902332305908203
time for parepare:  0.01569962501525879
local_output_nid generation:  0.010847330093383789
local_in_edges_tensor generation:  0.00790858268737793
mini_batch_src_global generation:  0.011135101318359375
r_  generation:  0.14433646202087402
local_output_nid generation:  0.011943340301513672
local_in_edges_tensor generation:  0.005832672119140625
mini_batch_src_global generation:  0.01392221450805664
r_  generation:  0.15697860717773438
----------------------check_connections_block total spend ----------------------------- 0.43993234634399414
generate_one_block  0.17235326766967773
generate_one_block  0.17229032516479492
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.026575565338134766
gen group dst list time:  0.006106853485107422
time for parepare:  0.01986527442932129
local_output_nid generation:  0.017499685287475586
local_in_edges_tensor generation:  0.02485799789428711
mini_batch_src_global generation:  0.03823256492614746
r_  generation:  0.4275550842285156
local_output_nid generation:  0.025634288787841797
local_in_edges_tensor generation:  0.02499699592590332
mini_batch_src_global generation:  0.04840517044067383
r_  generation:  0.4454536437988281
----------------------check_connections_block total spend ----------------------------- 1.2618820667266846
generate_one_block  0.562328577041626
generate_one_block  0.559802770614624
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.020000696182250977
gen group dst list time:  0.014127016067504883
time for parepare:  0.01842665672302246
local_output_nid generation:  0.0238187313079834
local_in_edges_tensor generation:  0.03891420364379883
mini_batch_src_global generation:  0.03271889686584473
r_  generation:  0.37358951568603516
local_output_nid generation:  0.031417131423950195
local_in_edges_tensor generation:  0.029473304748535156
mini_batch_src_global generation:  0.04788470268249512
r_  generation:  0.3811211585998535
----------------------check_connections_block total spend ----------------------------- 1.1443085670471191
generate_one_block  0.460615873336792
generate_one_block  0.46235156059265137
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14670515060424805  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

connection checking time:  2.4061906337738037
block generation total time  2.0450987815856934
average batch blocks generation time:  1.0225493907928467
block dataloader generation time/epoch 5.894628420304716
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1090536117553711  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2274274826049805  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10982370376586914  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2275505065917969  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08784782886505127 |0.01917743682861328 |0.004178524017333984 |0.0005086660385131836 |0.0026782751083374023 |0.003325223922729492 |
----------------------------------------------------------pseudo_mini_loss sum 0.9619779586791992
Total (block generation + training)time/epoch 6.211838258786148
Training time/epoch 0.34013843536376953
Training time without block to device /epoch 0.30178356170654297
Training time without total dataloading part /epoch 0.018056154251098633
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.32it/s]100%|██████████| 4/4 [00:00<00:00, 29.99it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.67it/s]100%|██████████| 4/4 [00:00<00:00, 12.86it/s]100%|██████████| 4/4 [00:00<00:00, 12.65it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.11it/s]100%|██████████| 4/4 [00:00<00:00, 17.75it/s]100%|██████████| 4/4 [00:00<00:00, 17.63it/s]
Run 00 | Epoch 00098 | Loss 0.9620 | Train 0.2677 | Val 0.1954 | Test 0.1748
Number of nodes during this epoch:  329842
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14592313766479492  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.014861345291137695
range selection method range initialization spend 0.012799263000488281
time for parepare:  0.01575326919555664
local_output_nid generation:  0.01121377944946289
local_in_edges_tensor generation:  0.008271455764770508
mini_batch_src_global generation:  0.011127710342407227
r_  generation:  0.14846372604370117
local_output_nid generation:  0.012348413467407227
local_in_edges_tensor generation:  0.005783796310424805
mini_batch_src_global generation:  0.014330863952636719
r_  generation:  0.15857481956481934
----------------------check_connections_block total spend ----------------------------- 0.4469413757324219
generate_one_block  0.16660332679748535
generate_one_block  0.17092251777648926
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02652144432067871
gen group dst list time:  0.006155967712402344
time for parepare:  0.020982980728149414
local_output_nid generation:  0.017760038375854492
local_in_edges_tensor generation:  0.0331723690032959
mini_batch_src_global generation:  0.03856611251831055
r_  generation:  0.45260000228881836
local_output_nid generation:  0.028906583786010742
local_in_edges_tensor generation:  0.028011798858642578
mini_batch_src_global generation:  0.04764127731323242
r_  generation:  0.4369642734527588
----------------------check_connections_block total spend ----------------------------- 1.2934486865997314
generate_one_block  0.5396873950958252
generate_one_block  0.537895917892456
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.020727157592773438
gen group dst list time:  0.011621236801147461
time for parepare:  0.019184112548828125
local_output_nid generation:  0.023913860321044922
local_in_edges_tensor generation:  0.039029598236083984
mini_batch_src_global generation:  0.030962705612182617
r_  generation:  0.3813290596008301
local_output_nid generation:  0.03185319900512695
local_in_edges_tensor generation:  0.028347253799438477
mini_batch_src_global generation:  0.03812360763549805
r_  generation:  0.37857556343078613
----------------------check_connections_block total spend ----------------------------- 1.1352434158325195
generate_one_block  0.4544856548309326
generate_one_block  0.45776939392089844
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.14592313766479492  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

connection checking time:  2.428692102432251
block generation total time  1.9898383617401123
average batch blocks generation time:  0.9949191808700562
block dataloader generation time/epoch 5.894601035118103
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.1090540885925293  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.22837495803833  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.10979604721069336  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 1.2281146049499512  GigaBytes
Max Memory Allocated: 1.4732775688171387  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07894742488861084 |0.01184380054473877 |0.004217982292175293 |0.0005252361297607422 |0.0027887821197509766 |0.0014955997467041016 |
----------------------------------------------------------pseudo_mini_loss sum 0.9605552554130554
Total (block generation + training)time/epoch 6.211689972877503
Training time/epoch 0.30617713928222656
Training time without block to device /epoch 0.282489538192749
Training time without total dataloading part /epoch 0.016559600830078125
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 59.06it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.02it/s]100%|██████████| 4/4 [00:00<00:00, 15.41it/s]100%|██████████| 4/4 [00:00<00:00, 15.33it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.62it/s]100%|██████████| 4/4 [00:00<00:00, 17.80it/s]100%|██████████| 4/4 [00:00<00:00, 17.75it/s]
Run 00 | Epoch 00099 | Loss 0.9606 | Train 0.2658 | Val 0.1930 | Test 0.1719
Number of nodes during this epoch:  329811
The number of model layers:  3
Run 01:
Highest Train: 45.63
Highest Valid: 53.21
  Final Train: 45.63
   Final Test: 53.54
The number of model layers:  3
All runs:
Highest Train: 45.63 ± nan
Highest Valid: 53.21 ± nan
  Final Train: 45.63 ± nan
   Final Test: 53.54 ± nan
