Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1647071540.3709812
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025228023529052734
range selection method range initialization spend 0.013725519180297852
time for parepare:  0.018715858459472656
local_output_nid generation:  0.011127710342407227
local_in_edges_tensor generation:  0.010317802429199219
mini_batch_src_global generation:  0.01397395133972168
r_  generation:  0.18080544471740723
local_output_nid generation:  0.012378454208374023
local_in_edges_tensor generation:  0.01098942756652832
mini_batch_src_global generation:  0.018353700637817383
r_  generation:  0.1782550811767578
----------------------check_connections_block total spend ----------------------------- 0.5264499187469482
generate_one_block  0.20687651634216309
generate_one_block  0.2067573070526123
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04085969924926758
gen group dst list time:  0.007865428924560547
time for parepare:  0.01999640464782715
local_output_nid generation:  0.016270160675048828
local_in_edges_tensor generation:  0.04226040840148926
mini_batch_src_global generation:  0.044934749603271484
r_  generation:  0.48174285888671875
local_output_nid generation:  0.028047561645507812
local_in_edges_tensor generation:  0.04518246650695801
mini_batch_src_global generation:  0.05600571632385254
r_  generation:  0.48978662490844727
----------------------check_connections_block total spend ----------------------------- 1.43843412399292
generate_one_block  0.6283304691314697
generate_one_block  0.6271650791168213
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03254413604736328
gen group dst list time:  0.012116193771362305
time for parepare:  0.019238948822021484
local_output_nid generation:  0.02241063117980957
local_in_edges_tensor generation:  0.03846478462219238
mini_batch_src_global generation:  0.045232295989990234
r_  generation:  0.5065081119537354
local_output_nid generation:  0.03540802001953125
local_in_edges_tensor generation:  0.04886651039123535
mini_batch_src_global generation:  0.05708003044128418
r_  generation:  0.5206022262573242
----------------------check_connections_block total spend ----------------------------- 1.5170376300811768
generate_one_block  0.6667039394378662
generate_one_block  0.6463668346405029
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  2.9554717540740967
block generation total time  2.56856632232666
average batch blocks generation time:  1.28428316116333
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2010498046875 GB
    Memory Allocated: 0.10806798934936523  GigaBytes
Max Memory Allocated: 0.10806798934936523  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8416748046875 GB
    Memory Allocated: 1.2807278633117676  GigaBytes
Max Memory Allocated: 1.3923048973083496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3045654296875 GB
    Memory Allocated: 0.11447286605834961  GigaBytes
Max Memory Allocated: 1.5350251197814941  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3045654296875 GB
    Memory Allocated: 1.2794785499572754  GigaBytes
Max Memory Allocated: 1.5350251197814941  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.038701772689819336 |0.15526902675628662 |0.3732351064682007 |0.0005893707275390625 |0.0296860933303833 |0.004296064376831055 |
----------------------------------------------------------pseudo_mini_loss sum 6.0689592361450195
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.87it/s]100%|██████████| 4/4 [00:00<00:00, 28.57it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.71it/s]100%|██████████| 4/4 [00:00<00:00, 12.20it/s]100%|██████████| 4/4 [00:00<00:00, 12.12it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.77it/s]100%|██████████| 4/4 [00:00<00:00, 17.83it/s]100%|██████████| 4/4 [00:00<00:00, 17.80it/s]
Run 00 | Epoch 00000 | Loss 6.0690 | Train 0.2943 | Val 0.3125 | Test 0.2869
Number of nodes during this epoch:  332778
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4686279296875 GB
    Memory Allocated: 0.16068172454833984  GigaBytes
Max Memory Allocated: 1.5350251197814941  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01847553253173828
range selection method range initialization spend 0.01623225212097168
time for parepare:  0.017879247665405273
local_output_nid generation:  0.010729551315307617
local_in_edges_tensor generation:  0.009213924407958984
mini_batch_src_global generation:  0.013112783432006836
r_  generation:  0.17707538604736328
local_output_nid generation:  0.01195526123046875
local_in_edges_tensor generation:  0.010038375854492188
mini_batch_src_global generation:  0.016408443450927734
r_  generation:  0.18380260467529297
----------------------check_connections_block total spend ----------------------------- 0.5234217643737793
generate_one_block  0.2209155559539795
generate_one_block  0.22475361824035645
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.09428811073303223
gen group dst list time:  0.007695913314819336
time for parepare:  0.01980137825012207
local_output_nid generation:  0.016367435455322266
local_in_edges_tensor generation:  0.0520169734954834
mini_batch_src_global generation:  0.048648834228515625
r_  generation:  0.4905989170074463
local_output_nid generation:  0.025528430938720703
local_in_edges_tensor generation:  0.04660177230834961
mini_batch_src_global generation:  0.05492210388183594
r_  generation:  0.5000162124633789
----------------------check_connections_block total spend ----------------------------- 1.4696037769317627
generate_one_block  0.6294088363647461
generate_one_block  0.6578583717346191
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04245281219482422
gen group dst list time:  0.012616634368896484
time for parepare:  0.01948714256286621
local_output_nid generation:  0.022481918334960938
local_in_edges_tensor generation:  0.04795718193054199
mini_batch_src_global generation:  0.04654550552368164
r_  generation:  0.5281426906585693
local_output_nid generation:  0.03132033348083496
local_in_edges_tensor generation:  0.05091404914855957
mini_batch_src_global generation:  0.059020042419433594
r_  generation:  0.5500140190124512
----------------------check_connections_block total spend ----------------------------- 1.5846307277679443
generate_one_block  0.6651549339294434
generate_one_block  0.6801896095275879
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4686279296875 GB
    Memory Allocated: 0.16068172454833984  GigaBytes
Max Memory Allocated: 1.5350251197814941  GigaBytes

connection checking time:  3.054234504699707
block generation total time  2.6326117515563965
average batch blocks generation time:  1.3163058757781982
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4686279296875 GB
    Memory Allocated: 0.1168508529663086  GigaBytes
Max Memory Allocated: 1.5350251197814941  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4686279296875 GB
    Memory Allocated: 1.283444881439209  GigaBytes
Max Memory Allocated: 1.5350251197814941  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4686279296875 GB
    Memory Allocated: 0.11654043197631836  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.280601978302002  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08277332782745361 |0.022763848304748535 |0.004219532012939453 |0.0004942417144775391 |0.0036983489990234375 |0.0015616416931152344 |
----------------------------------------------------------pseudo_mini_loss sum 3.2194714546203613
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 53.61it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.51it/s]100%|██████████| 4/4 [00:00<00:00, 14.92it/s]100%|██████████| 4/4 [00:00<00:00, 14.84it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.49it/s]100%|██████████| 4/4 [00:00<00:00, 17.35it/s]100%|██████████| 4/4 [00:00<00:00, 17.35it/s]
Run 00 | Epoch 00001 | Loss 3.2195 | Train 0.3398 | Val 0.3950 | Test 0.4360
Number of nodes during this epoch:  332690
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16017866134643555  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02115011215209961
range selection method range initialization spend 0.012773752212524414
time for parepare:  0.01812434196472168
local_output_nid generation:  0.011177778244018555
local_in_edges_tensor generation:  0.01453542709350586
mini_batch_src_global generation:  0.014091968536376953
r_  generation:  0.17242693901062012
local_output_nid generation:  0.011959075927734375
local_in_edges_tensor generation:  0.009042501449584961
mini_batch_src_global generation:  0.017430543899536133
r_  generation:  0.18342137336730957
----------------------check_connections_block total spend ----------------------------- 0.5233473777770996
generate_one_block  0.19724154472351074
generate_one_block  0.19977450370788574
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03385758399963379
gen group dst list time:  0.007428646087646484
time for parepare:  0.019524574279785156
local_output_nid generation:  0.016562461853027344
local_in_edges_tensor generation:  0.03749251365661621
mini_batch_src_global generation:  0.04621767997741699
r_  generation:  0.49859142303466797
local_output_nid generation:  0.025000333786010742
local_in_edges_tensor generation:  0.03777289390563965
mini_batch_src_global generation:  0.05652499198913574
r_  generation:  0.510552167892456
----------------------check_connections_block total spend ----------------------------- 1.4632346630096436
generate_one_block  0.6478519439697266
generate_one_block  0.6459710597991943
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05938601493835449
gen group dst list time:  0.014042854309082031
time for parepare:  0.01930832862854004
local_output_nid generation:  0.021851062774658203
local_in_edges_tensor generation:  0.0440821647644043
mini_batch_src_global generation:  0.04827404022216797
r_  generation:  0.5169265270233154
local_output_nid generation:  0.031746625900268555
local_in_edges_tensor generation:  0.04525446891784668
mini_batch_src_global generation:  0.05688810348510742
r_  generation:  0.5313701629638672
----------------------check_connections_block total spend ----------------------------- 1.538426160812378
generate_one_block  0.655289888381958
generate_one_block  0.6507182121276855
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16017866134643555  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

connection checking time:  3.0016608238220215
block generation total time  2.5998311042785645
average batch blocks generation time:  1.2999155521392822
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11671686172485352  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2818584442138672  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11661243438720703  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2804756164550781  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08917748928070068 |0.020813465118408203 |0.00412142276763916 |0.0005095005035400391 |0.003300189971923828 |0.0014233589172363281 |
----------------------------------------------------------pseudo_mini_loss sum 2.619396448135376
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.16it/s]100%|██████████| 4/4 [00:00<00:00, 28.18it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 10.93it/s]100%|██████████| 4/4 [00:00<00:00, 12.16it/s]100%|██████████| 4/4 [00:00<00:00, 11.95it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.39it/s]100%|██████████| 4/4 [00:00<00:00, 16.98it/s]100%|██████████| 4/4 [00:00<00:00, 16.87it/s]
Run 00 | Epoch 00002 | Loss 2.6194 | Train 0.3143 | Val 0.3188 | Test 0.3706
Number of nodes during this epoch:  332796
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16117238998413086  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02506852149963379
range selection method range initialization spend 0.01374959945678711
time for parepare:  0.020155668258666992
local_output_nid generation:  0.010546445846557617
local_in_edges_tensor generation:  0.012789726257324219
mini_batch_src_global generation:  0.017899751663208008
r_  generation:  0.17056918144226074
local_output_nid generation:  0.011853694915771484
local_in_edges_tensor generation:  0.006635904312133789
mini_batch_src_global generation:  0.01998305320739746
r_  generation:  0.18405532836914062
----------------------check_connections_block total spend ----------------------------- 0.5252354145050049
generate_one_block  0.2026979923248291
generate_one_block  0.20538043975830078
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.039076805114746094
gen group dst list time:  0.007617473602294922
time for parepare:  0.02046513557434082
local_output_nid generation:  0.017204761505126953
local_in_edges_tensor generation:  0.040006160736083984
mini_batch_src_global generation:  0.04643988609313965
r_  generation:  0.5101180076599121
local_output_nid generation:  0.02550339698791504
local_in_edges_tensor generation:  0.033899784088134766
mini_batch_src_global generation:  0.059984683990478516
r_  generation:  0.508145809173584
----------------------check_connections_block total spend ----------------------------- 1.4775447845458984
generate_one_block  0.6270914077758789
generate_one_block  0.6431794166564941
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028578519821166992
gen group dst list time:  0.013708114624023438
time for parepare:  0.019939661026000977
local_output_nid generation:  0.023007631301879883
local_in_edges_tensor generation:  0.03858542442321777
mini_batch_src_global generation:  0.04737067222595215
r_  generation:  0.5335838794708252
local_output_nid generation:  0.03628849983215332
local_in_edges_tensor generation:  0.04500436782836914
mini_batch_src_global generation:  0.058122873306274414
r_  generation:  0.528536319732666
----------------------check_connections_block total spend ----------------------------- 1.554614782333374
generate_one_block  0.6506741046905518
generate_one_block  0.6646006107330322
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16117238998413086  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

connection checking time:  3.0321595668792725
block generation total time  2.585545539855957
average batch blocks generation time:  1.2927727699279785
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11672449111938477  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.282336711883545  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11656618118286133  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2809009552001953  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04503941535949707 |0.019611358642578125 |0.004182696342468262 |0.0005108118057250977 |0.04175388813018799 |0.0013568401336669922 |
----------------------------------------------------------pseudo_mini_loss sum 2.381115436553955
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 49.45it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.61it/s]100%|██████████| 4/4 [00:00<00:00, 15.71it/s]100%|██████████| 4/4 [00:00<00:00, 15.68it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.49it/s]100%|██████████| 4/4 [00:00<00:00, 17.45it/s]100%|██████████| 4/4 [00:00<00:00, 17.44it/s]
Run 00 | Epoch 00003 | Loss 2.3811 | Train 0.4364 | Val 0.5032 | Test 0.5317
Number of nodes during this epoch:  332924
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1611347198486328  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020447254180908203
range selection method range initialization spend 0.011885881423950195
time for parepare:  0.01745748519897461
local_output_nid generation:  0.010627985000610352
local_in_edges_tensor generation:  0.013860940933227539
mini_batch_src_global generation:  0.012966394424438477
r_  generation:  0.17257404327392578
local_output_nid generation:  0.012015342712402344
local_in_edges_tensor generation:  0.00856781005859375
mini_batch_src_global generation:  0.017066478729248047
r_  generation:  0.1835620403289795
----------------------check_connections_block total spend ----------------------------- 0.5178947448730469
generate_one_block  0.20046782493591309
generate_one_block  0.2071986198425293
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03570151329040527
gen group dst list time:  0.007645845413208008
time for parepare:  0.019281387329101562
local_output_nid generation:  0.01752638816833496
local_in_edges_tensor generation:  0.034906625747680664
mini_batch_src_global generation:  0.049733877182006836
r_  generation:  0.49260735511779785
local_output_nid generation:  0.0257108211517334
local_in_edges_tensor generation:  0.03304123878479004
mini_batch_src_global generation:  0.055173397064208984
r_  generation:  0.5018966197967529
----------------------check_connections_block total spend ----------------------------- 1.447028398513794
generate_one_block  0.6294875144958496
generate_one_block  0.637326717376709
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029270648956298828
gen group dst list time:  0.01584458351135254
time for parepare:  0.019382953643798828
local_output_nid generation:  0.02263808250427246
local_in_edges_tensor generation:  0.04512310028076172
mini_batch_src_global generation:  0.0631570816040039
r_  generation:  0.557410478591919
local_output_nid generation:  0.03609204292297363
local_in_edges_tensor generation:  0.0480043888092041
mini_batch_src_global generation:  0.06162858009338379
r_  generation:  0.5403225421905518
----------------------check_connections_block total spend ----------------------------- 1.662771224975586
generate_one_block  0.6442077159881592
generate_one_block  0.660240650177002
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1611347198486328  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

connection checking time:  3.10979962348938
block generation total time  2.5712625980377197
average batch blocks generation time:  1.2856312990188599
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11678075790405273  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2821893692016602  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11651134490966797  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2808623313903809  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0876162052154541 |0.022658705711364746 |0.004147529602050781 |0.0004936456680297852 |0.0028105974197387695 |0.002895832061767578 |
----------------------------------------------------------pseudo_mini_loss sum 2.111626625061035
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 53.76it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.00it/s]100%|██████████| 4/4 [00:00<00:00, 15.51it/s]100%|██████████| 4/4 [00:00<00:00, 15.41it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.94it/s]100%|██████████| 4/4 [00:00<00:00, 17.58it/s]100%|██████████| 4/4 [00:00<00:00, 17.46it/s]
Run 00 | Epoch 00004 | Loss 2.1116 | Train 0.4454 | Val 0.4532 | Test 0.4398
Number of nodes during this epoch:  332841
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16103506088256836  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020318269729614258
range selection method range initialization spend 0.012136220932006836
time for parepare:  0.0174558162689209
local_output_nid generation:  0.010669708251953125
local_in_edges_tensor generation:  0.010126352310180664
mini_batch_src_global generation:  0.013106107711791992
r_  generation:  0.17142152786254883
local_output_nid generation:  0.011810064315795898
local_in_edges_tensor generation:  0.006494283676147461
mini_batch_src_global generation:  0.0169675350189209
r_  generation:  0.18649792671203613
----------------------check_connections_block total spend ----------------------------- 0.5143420696258545
generate_one_block  0.2003641128540039
generate_one_block  0.2002410888671875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.037633419036865234
gen group dst list time:  0.00768280029296875
time for parepare:  0.01929783821105957
local_output_nid generation:  0.017212867736816406
local_in_edges_tensor generation:  0.03309822082519531
mini_batch_src_global generation:  0.04438281059265137
r_  generation:  0.486957311630249
local_output_nid generation:  0.02529311180114746
local_in_edges_tensor generation:  0.0354766845703125
mini_batch_src_global generation:  0.05611562728881836
r_  generation:  0.4976081848144531
----------------------check_connections_block total spend ----------------------------- 1.4300343990325928
generate_one_block  0.6240260601043701
generate_one_block  0.6368937492370605
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025582551956176758
gen group dst list time:  0.012414693832397461
time for parepare:  0.018760204315185547
local_output_nid generation:  0.021218538284301758
local_in_edges_tensor generation:  0.034209489822387695
mini_batch_src_global generation:  0.04708504676818848
r_  generation:  0.5176796913146973
local_output_nid generation:  0.033301353454589844
local_in_edges_tensor generation:  0.03697395324707031
mini_batch_src_global generation:  0.05640983581542969
r_  generation:  0.5276310443878174
----------------------check_connections_block total spend ----------------------------- 1.5163578987121582
generate_one_block  0.6401007175445557
generate_one_block  0.6702065467834473
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16103506088256836  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

connection checking time:  2.946392297744751
block generation total time  2.5712270736694336
average batch blocks generation time:  1.2856135368347168
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11674737930297852  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.282027244567871  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11648368835449219  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2802062034606934  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08644974231719971 |0.02438640594482422 |0.004290103912353516 |0.0005037784576416016 |0.0041457414627075195 |0.0022575855255126953 |
----------------------------------------------------------pseudo_mini_loss sum 1.969245195388794
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 49.15it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.79it/s]100%|██████████| 4/4 [00:00<00:00, 15.09it/s]100%|██████████| 4/4 [00:00<00:00, 15.03it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.22it/s]100%|██████████| 4/4 [00:00<00:00, 17.75it/s]100%|██████████| 4/4 [00:00<00:00, 17.65it/s]
Run 00 | Epoch 00005 | Loss 1.9692 | Train 0.4389 | Val 0.4315 | Test 0.4051
Number of nodes during this epoch:  332790
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1601710319519043  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01920938491821289
range selection method range initialization spend 0.012241840362548828
time for parepare:  0.017389774322509766
local_output_nid generation:  0.010696887969970703
local_in_edges_tensor generation:  0.010140419006347656
mini_batch_src_global generation:  0.013179779052734375
r_  generation:  0.21148967742919922
local_output_nid generation:  0.011672735214233398
local_in_edges_tensor generation:  0.005769014358520508
mini_batch_src_global generation:  0.01810741424560547
r_  generation:  0.18575716018676758
----------------------check_connections_block total spend ----------------------------- 0.5534453392028809
generate_one_block  0.19719481468200684
generate_one_block  0.19791173934936523
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03936767578125
gen group dst list time:  0.00762939453125
time for parepare:  0.019596338272094727
local_output_nid generation:  0.017533063888549805
local_in_edges_tensor generation:  0.03806591033935547
mini_batch_src_global generation:  0.045212507247924805
r_  generation:  0.4977414608001709
local_output_nid generation:  0.026827096939086914
local_in_edges_tensor generation:  0.030191898345947266
mini_batch_src_global generation:  0.05722522735595703
r_  generation:  0.5049538612365723
----------------------check_connections_block total spend ----------------------------- 1.4504685401916504
generate_one_block  0.6530141830444336
generate_one_block  0.6448724269866943
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030390501022338867
gen group dst list time:  0.015015363693237305
time for parepare:  0.01883554458618164
local_output_nid generation:  0.022225618362426758
local_in_edges_tensor generation:  0.05064892768859863
mini_batch_src_global generation:  0.04768538475036621
r_  generation:  0.5270299911499023
local_output_nid generation:  0.0323948860168457
local_in_edges_tensor generation:  0.03943920135498047
mini_batch_src_global generation:  0.05852985382080078
r_  generation:  0.5299112796783447
----------------------check_connections_block total spend ----------------------------- 1.5537538528442383
generate_one_block  0.6769037246704102
generate_one_block  0.6519627571105957
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1601710319519043  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

connection checking time:  3.0042223930358887
block generation total time  2.626753091812134
average batch blocks generation time:  1.313376545906067
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11679887771606445  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2819786071777344  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1164851188659668  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.280564785003662  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08521771430969238 |0.023445487022399902 |0.004115939140319824 |0.0004981756210327148 |0.0034383535385131836 |0.0013079643249511719 |
----------------------------------------------------------pseudo_mini_loss sum 1.8843376636505127
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 50.57it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.92it/s]100%|██████████| 4/4 [00:00<00:00, 15.16it/s]100%|██████████| 4/4 [00:00<00:00, 15.11it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.18it/s]100%|██████████| 4/4 [00:00<00:00, 17.57it/s]100%|██████████| 4/4 [00:00<00:00, 17.49it/s]
Run 00 | Epoch 00006 | Loss 1.8843 | Train 0.4321 | Val 0.4334 | Test 0.4071
Number of nodes during this epoch:  332766
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16106081008911133  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018590688705444336
range selection method range initialization spend 0.012247323989868164
time for parepare:  0.019057750701904297
local_output_nid generation:  0.010579347610473633
local_in_edges_tensor generation:  0.009319067001342773
mini_batch_src_global generation:  0.013144254684448242
r_  generation:  0.17175769805908203
local_output_nid generation:  0.011769771575927734
local_in_edges_tensor generation:  0.005815267562866211
mini_batch_src_global generation:  0.017127037048339844
r_  generation:  0.18546080589294434
----------------------check_connections_block total spend ----------------------------- 0.5131096839904785
generate_one_block  0.1990351676940918
generate_one_block  0.19921374320983887
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.038468360900878906
gen group dst list time:  0.008727788925170898
time for parepare:  0.019753217697143555
local_output_nid generation:  0.017050504684448242
local_in_edges_tensor generation:  0.03160381317138672
mini_batch_src_global generation:  0.04464292526245117
r_  generation:  0.49089694023132324
local_output_nid generation:  0.024947166442871094
local_in_edges_tensor generation:  0.03115057945251465
mini_batch_src_global generation:  0.05819869041442871
r_  generation:  0.5037496089935303
----------------------check_connections_block total spend ----------------------------- 1.4364774227142334
generate_one_block  0.628173828125
generate_one_block  0.6296617984771729
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.027239322662353516
gen group dst list time:  0.012697458267211914
time for parepare:  0.019176721572875977
local_output_nid generation:  0.021318435668945312
local_in_edges_tensor generation:  0.04170560836791992
mini_batch_src_global generation:  0.04783344268798828
r_  generation:  0.5136640071868896
local_output_nid generation:  0.03122735023498535
local_in_edges_tensor generation:  0.042022705078125
mini_batch_src_global generation:  0.05623483657836914
r_  generation:  0.534426212310791
----------------------check_connections_block total spend ----------------------------- 1.534621000289917
generate_one_block  0.6487298011779785
generate_one_block  0.6456692218780518
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16106081008911133  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

connection checking time:  2.9710984230041504
block generation total time  2.552234649658203
average batch blocks generation time:  1.2761173248291016
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11673498153686523  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.281423568725586  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11667871475219727  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2815556526184082  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08465445041656494 |0.02765214443206787 |0.01673281192779541 |0.0005807876586914062 |0.0028629302978515625 |0.002467632293701172 |
----------------------------------------------------------pseudo_mini_loss sum 1.8019729852676392
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 55.39it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.85it/s]100%|██████████| 4/4 [00:00<00:00, 15.39it/s]100%|██████████| 4/4 [00:00<00:00, 15.29it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.39it/s]100%|██████████| 4/4 [00:00<00:00, 17.73it/s]100%|██████████| 4/4 [00:00<00:00, 17.66it/s]
Run 00 | Epoch 00007 | Loss 1.8020 | Train 0.4287 | Val 0.4508 | Test 0.4311
Number of nodes during this epoch:  332774
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16107940673828125  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026095867156982422
range selection method range initialization spend 0.011694192886352539
time for parepare:  0.01830148696899414
local_output_nid generation:  0.010353803634643555
local_in_edges_tensor generation:  0.010999917984008789
mini_batch_src_global generation:  0.012969493865966797
r_  generation:  0.16876649856567383
local_output_nid generation:  0.011797666549682617
local_in_edges_tensor generation:  0.008356332778930664
mini_batch_src_global generation:  0.01785588264465332
r_  generation:  0.18441104888916016
----------------------check_connections_block total spend ----------------------------- 0.5132975578308105
generate_one_block  0.19848084449768066
generate_one_block  0.20569610595703125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.031269073486328125
gen group dst list time:  0.007680416107177734
time for parepare:  0.02005314826965332
local_output_nid generation:  0.016747713088989258
local_in_edges_tensor generation:  0.03418326377868652
mini_batch_src_global generation:  0.04462909698486328
r_  generation:  0.4921834468841553
local_output_nid generation:  0.02511739730834961
local_in_edges_tensor generation:  0.029234886169433594
mini_batch_src_global generation:  0.05581331253051758
r_  generation:  0.4987907409667969
----------------------check_connections_block total spend ----------------------------- 1.4326941967010498
generate_one_block  0.6177244186401367
generate_one_block  0.6295216083526611
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028188467025756836
gen group dst list time:  0.012492179870605469
time for parepare:  0.01945352554321289
local_output_nid generation:  0.02197408676147461
local_in_edges_tensor generation:  0.03180384635925293
mini_batch_src_global generation:  0.04533982276916504
r_  generation:  0.5141143798828125
local_output_nid generation:  0.03139042854309082
local_in_edges_tensor generation:  0.034470558166503906
mini_batch_src_global generation:  0.05669522285461426
r_  generation:  0.5263738632202148
----------------------check_connections_block total spend ----------------------------- 1.5040032863616943
generate_one_block  0.639289140701294
generate_one_block  0.6650824546813965
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16107940673828125  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

connection checking time:  2.936697483062744
block generation total time  2.5516176223754883
average batch blocks generation time:  1.2758088111877441
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11667108535766602  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.277472972869873  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11672735214233398  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2813067436218262  GigaBytes
Max Memory Allocated: 1.5373477935791016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0800328254699707 |0.015394091606140137 |0.016364097595214844 |0.0004905462265014648 |0.003733396530151367 |0.0013282299041748047 |
----------------------------------------------------------pseudo_mini_loss sum 1.7048368453979492
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 64.33it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.94it/s]100%|██████████| 4/4 [00:00<00:00, 15.32it/s]100%|██████████| 4/4 [00:00<00:00, 15.25it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.23it/s]100%|██████████| 4/4 [00:00<00:00, 17.53it/s]100%|██████████| 4/4 [00:00<00:00, 17.46it/s]
Run 00 | Epoch 00008 | Loss 1.7048 | Train 0.4312 | Val 0.4861 | Test 0.4804
Number of nodes during this epoch:  332761
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16219568252563477  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01969313621520996
range selection method range initialization spend 0.012039899826049805
time for parepare:  0.017389535903930664
local_output_nid generation:  0.010478496551513672
local_in_edges_tensor generation:  0.008584737777709961
mini_batch_src_global generation:  0.013729572296142578
r_  generation:  0.16829252243041992
local_output_nid generation:  0.011683464050292969
local_in_edges_tensor generation:  0.006981849670410156
mini_batch_src_global generation:  0.016883134841918945
r_  generation:  0.18004369735717773
----------------------check_connections_block total spend ----------------------------- 0.5031530857086182
generate_one_block  0.19804906845092773
generate_one_block  0.19958162307739258
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04089808464050293
gen group dst list time:  0.007681846618652344
time for parepare:  0.0196382999420166
local_output_nid generation:  0.01699090003967285
local_in_edges_tensor generation:  0.03490161895751953
mini_batch_src_global generation:  0.04452037811279297
r_  generation:  0.5014870166778564
local_output_nid generation:  0.028630733489990234
local_in_edges_tensor generation:  0.035590171813964844
mini_batch_src_global generation:  0.056139230728149414
r_  generation:  0.5030038356781006
----------------------check_connections_block total spend ----------------------------- 1.454113245010376
generate_one_block  0.6261048316955566
generate_one_block  0.6381978988647461
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.031842947006225586
gen group dst list time:  0.012564659118652344
time for parepare:  0.018927335739135742
local_output_nid generation:  0.021854877471923828
local_in_edges_tensor generation:  0.041719675064086914
mini_batch_src_global generation:  0.047821998596191406
r_  generation:  0.5096733570098877
local_output_nid generation:  0.03126025199890137
local_in_edges_tensor generation:  0.03864121437072754
mini_batch_src_global generation:  0.05693769454956055
r_  generation:  0.5192966461181641
----------------------check_connections_block total spend ----------------------------- 1.5083503723144531
generate_one_block  0.6355183124542236
generate_one_block  0.6423163414001465
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16219568252563477  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

connection checking time:  2.962463617324829
block generation total time  2.542137384414673
average batch blocks generation time:  1.2710686922073364
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1167607307434082  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2822237014770508  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11653852462768555  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2804036140441895  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08816313743591309 |0.015423774719238281 |0.004038333892822266 |0.0005130767822265625 |0.003702878952026367 |0.0014467239379882812 |
----------------------------------------------------------pseudo_mini_loss sum 1.637251853942871
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 54.27it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.72it/s]100%|██████████| 4/4 [00:00<00:00, 15.31it/s]100%|██████████| 4/4 [00:00<00:00, 15.20it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.11it/s]100%|██████████| 4/4 [00:00<00:00, 17.34it/s]100%|██████████| 4/4 [00:00<00:00, 17.29it/s]
Run 00 | Epoch 00009 | Loss 1.6373 | Train 0.4425 | Val 0.5216 | Test 0.5293
Number of nodes during this epoch:  332874
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1611490249633789  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01832270622253418
range selection method range initialization spend 0.012054681777954102
time for parepare:  0.017648935317993164
local_output_nid generation:  0.010499715805053711
local_in_edges_tensor generation:  0.008321523666381836
mini_batch_src_global generation:  0.01336216926574707
r_  generation:  0.16827845573425293
local_output_nid generation:  0.011657476425170898
local_in_edges_tensor generation:  0.006345510482788086
mini_batch_src_global generation:  0.01715397834777832
r_  generation:  0.1799466609954834
----------------------check_connections_block total spend ----------------------------- 0.5019330978393555
generate_one_block  0.20078372955322266
generate_one_block  0.2014787197113037
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029956817626953125
gen group dst list time:  0.007700204849243164
time for parepare:  0.019954442977905273
local_output_nid generation:  0.016904115676879883
local_in_edges_tensor generation:  0.02808237075805664
mini_batch_src_global generation:  0.04515361785888672
r_  generation:  0.4950234889984131
local_output_nid generation:  0.025263071060180664
local_in_edges_tensor generation:  0.028256654739379883
mini_batch_src_global generation:  0.055733442306518555
r_  generation:  0.5062966346740723
----------------------check_connections_block total spend ----------------------------- 1.4363434314727783
generate_one_block  0.6275200843811035
generate_one_block  0.6229465007781982
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025250911712646484
gen group dst list time:  0.01268315315246582
time for parepare:  0.018855571746826172
local_output_nid generation:  0.021343469619750977
local_in_edges_tensor generation:  0.032981157302856445
mini_batch_src_global generation:  0.0473172664642334
r_  generation:  0.515937089920044
local_output_nid generation:  0.03120899200439453
local_in_edges_tensor generation:  0.030664682388305664
mini_batch_src_global generation:  0.058553218841552734
r_  generation:  0.524200439453125
----------------------check_connections_block total spend ----------------------------- 1.5046002864837646
generate_one_block  0.6393616199493408
generate_one_block  0.6441943645477295
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1611490249633789  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

connection checking time:  2.940943717956543
block generation total time  2.534022569656372
average batch blocks generation time:  1.267011284828186
block dataloader generation time/epoch 7.125272512435913
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11681890487670898  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2827162742614746  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11628341674804688  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.275892734527588  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04700160026550293 |0.015199065208435059 |0.003779888153076172 |0.00048828125 |0.04311418533325195 |0.0012969970703125 |
----------------------------------------------------------pseudo_mini_loss sum 1.5923092365264893
Total (block generation + training)time/epoch 7.4541637897491455
Training time/epoch 0.32880544662475586
Training time without block to device /epoch 0.29840731620788574
Training time without total dataloading part /epoch 0.09606170654296875
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 62.14it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.80it/s]100%|██████████| 4/4 [00:00<00:00, 15.29it/s]100%|██████████| 4/4 [00:00<00:00, 15.20it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.11it/s]100%|██████████| 4/4 [00:00<00:00, 17.50it/s]100%|██████████| 4/4 [00:00<00:00, 17.42it/s]
Run 00 | Epoch 00010 | Loss 1.5923 | Train 0.4456 | Val 0.5317 | Test 0.5422
Number of nodes during this epoch:  332849
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16042661666870117  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.016849517822265625
range selection method range initialization spend 0.011900663375854492
time for parepare:  0.017694711685180664
local_output_nid generation:  0.010464668273925781
local_in_edges_tensor generation:  0.008451700210571289
mini_batch_src_global generation:  0.013584375381469727
r_  generation:  0.16912388801574707
local_output_nid generation:  0.011791467666625977
local_in_edges_tensor generation:  0.005788326263427734
mini_batch_src_global generation:  0.01721811294555664
r_  generation:  0.18142485618591309
----------------------check_connections_block total spend ----------------------------- 0.5040838718414307
generate_one_block  0.20357847213745117
generate_one_block  0.20149469375610352
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02875995635986328
gen group dst list time:  0.00767064094543457
time for parepare:  0.020109176635742188
local_output_nid generation:  0.016744375228881836
local_in_edges_tensor generation:  0.0276491641998291
mini_batch_src_global generation:  0.04471158981323242
r_  generation:  0.48866963386535645
local_output_nid generation:  0.025031566619873047
local_in_edges_tensor generation:  0.029991865158081055
mini_batch_src_global generation:  0.05563497543334961
r_  generation:  0.5034494400024414
----------------------check_connections_block total spend ----------------------------- 1.426513671875
generate_one_block  0.620030403137207
generate_one_block  0.6207563877105713
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025358200073242188
gen group dst list time:  0.012762069702148438
time for parepare:  0.01901412010192871
local_output_nid generation:  0.02122354507446289
local_in_edges_tensor generation:  0.03773927688598633
mini_batch_src_global generation:  0.04712414741516113
r_  generation:  0.5061602592468262
local_output_nid generation:  0.03170919418334961
local_in_edges_tensor generation:  0.03255414962768555
mini_batch_src_global generation:  0.0559840202331543
r_  generation:  0.5177147388458252
----------------------check_connections_block total spend ----------------------------- 1.490907907485962
generate_one_block  0.635631799697876
generate_one_block  0.6339676380157471
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16042661666870117  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

connection checking time:  2.917421579360962
block generation total time  2.5103862285614014
average batch blocks generation time:  1.2551931142807007
block dataloader generation time/epoch 7.0779958963394165
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1168065071105957  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2818398475646973  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1164555549621582  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2803797721862793  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08205902576446533 |0.017815232276916504 |0.0037431716918945312 |0.0005472898483276367 |0.0037261247634887695 |0.0012602806091308594 |
----------------------------------------------------------pseudo_mini_loss sum 1.5544617176055908
Total (block generation + training)time/epoch 7.40221095085144
Training time/epoch 0.3194575309753418
Training time without block to device /epoch 0.2838270664215088
Training time without total dataloading part /epoch 0.017293453216552734
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 66.77it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.96it/s]100%|██████████| 4/4 [00:00<00:00, 15.43it/s]100%|██████████| 4/4 [00:00<00:00, 15.35it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.06it/s]100%|██████████| 4/4 [00:00<00:00, 17.42it/s]100%|██████████| 4/4 [00:00<00:00, 17.34it/s]
Run 00 | Epoch 00011 | Loss 1.5545 | Train 0.4368 | Val 0.5177 | Test 0.5205
Number of nodes during this epoch:  332757
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16105127334594727  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.017110586166381836
range selection method range initialization spend 0.011563777923583984
time for parepare:  0.017699003219604492
local_output_nid generation:  0.010561466217041016
local_in_edges_tensor generation:  0.008806467056274414
mini_batch_src_global generation:  0.01389932632446289
r_  generation:  0.16699862480163574
local_output_nid generation:  0.011792898178100586
local_in_edges_tensor generation:  0.007669210433959961
mini_batch_src_global generation:  0.01816082000732422
r_  generation:  0.1824629306793213
----------------------check_connections_block total spend ----------------------------- 0.5072047710418701
generate_one_block  0.20099306106567383
generate_one_block  0.20197081565856934
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03538846969604492
gen group dst list time:  0.007635354995727539
time for parepare:  0.020195484161376953
local_output_nid generation:  0.01731562614440918
local_in_edges_tensor generation:  0.028803110122680664
mini_batch_src_global generation:  0.04669904708862305
r_  generation:  0.48590993881225586
local_output_nid generation:  0.024880409240722656
local_in_edges_tensor generation:  0.029504776000976562
mini_batch_src_global generation:  0.055853843688964844
r_  generation:  0.5051367282867432
----------------------check_connections_block total spend ----------------------------- 1.4304900169372559
generate_one_block  0.6208341121673584
generate_one_block  0.6304521560668945
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029811382293701172
gen group dst list time:  0.013602495193481445
time for parepare:  0.019192934036254883
local_output_nid generation:  0.021746397018432617
local_in_edges_tensor generation:  0.03987932205200195
mini_batch_src_global generation:  0.04733562469482422
r_  generation:  0.5101399421691895
local_output_nid generation:  0.0321195125579834
local_in_edges_tensor generation:  0.03442788124084473
mini_batch_src_global generation:  0.056520700454711914
r_  generation:  0.5143036842346191
----------------------check_connections_block total spend ----------------------------- 1.5004963874816895
generate_one_block  0.6340115070343018
generate_one_block  0.6360108852386475
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16105127334594727  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

connection checking time:  2.9309864044189453
block generation total time  2.521308660507202
average batch blocks generation time:  1.260654330253601
block dataloader generation time/epoch 7.08625062306722
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1167445182800293  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2821331024169922  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11652803421020508  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2804861068725586  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08514046669006348 |0.015292763710021973 |0.004029631614685059 |0.0005042552947998047 |0.003306150436401367 |0.00136566162109375 |
----------------------------------------------------------pseudo_mini_loss sum 1.5147409439086914
Total (block generation + training)time/epoch 7.412267367045085
Training time/epoch 0.3294558525085449
Training time without block to device /epoch 0.298870325088501
Training time without total dataloading part /epoch 0.01704573631286621
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 56.52it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.78it/s]100%|██████████| 4/4 [00:00<00:00, 15.25it/s]100%|██████████| 4/4 [00:00<00:00, 15.17it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.50it/s]100%|██████████| 4/4 [00:00<00:00, 17.62it/s]100%|██████████| 4/4 [00:00<00:00, 17.58it/s]
Run 00 | Epoch 00012 | Loss 1.5147 | Train 0.4268 | Val 0.5095 | Test 0.5086
Number of nodes during this epoch:  332863
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1611037254333496  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01740241050720215
range selection method range initialization spend 0.011690139770507812
time for parepare:  0.017428159713745117
local_output_nid generation:  0.01076197624206543
local_in_edges_tensor generation:  0.008163690567016602
mini_batch_src_global generation:  0.015121936798095703
r_  generation:  0.17012739181518555
local_output_nid generation:  0.011846065521240234
local_in_edges_tensor generation:  0.006422281265258789
mini_batch_src_global generation:  0.01697397232055664
r_  generation:  0.18065500259399414
----------------------check_connections_block total spend ----------------------------- 0.5057487487792969
generate_one_block  0.19680023193359375
generate_one_block  0.1982710361480713
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028229713439941406
gen group dst list time:  0.007658243179321289
time for parepare:  0.0196533203125
local_output_nid generation:  0.017163515090942383
local_in_edges_tensor generation:  0.028405189514160156
mini_batch_src_global generation:  0.04493403434753418
r_  generation:  0.4916856288909912
local_output_nid generation:  0.025336503982543945
local_in_edges_tensor generation:  0.026433944702148438
mini_batch_src_global generation:  0.05574369430541992
r_  generation:  0.4995131492614746
----------------------check_connections_block total spend ----------------------------- 1.4241957664489746
generate_one_block  0.6208086013793945
generate_one_block  0.6213626861572266
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025192975997924805
gen group dst list time:  0.012797117233276367
time for parepare:  0.018814802169799805
local_output_nid generation:  0.0219576358795166
local_in_edges_tensor generation:  0.03129005432128906
mini_batch_src_global generation:  0.044988393783569336
r_  generation:  0.5094802379608154
local_output_nid generation:  0.031662940979003906
local_in_edges_tensor generation:  0.036926984786987305
mini_batch_src_global generation:  0.05653500556945801
r_  generation:  0.5234191417694092
----------------------check_connections_block total spend ----------------------------- 1.4952592849731445
generate_one_block  0.6308310031890869
generate_one_block  0.636768102645874
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1611037254333496  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

connection checking time:  2.919455051422119
block generation total time  2.509770393371582
average batch blocks generation time:  1.254885196685791
block dataloader generation time/epoch 7.0800474882125854
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1167759895324707  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2819170951843262  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1165618896484375  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2809410095214844  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07808709144592285 |0.014999628067016602 |0.0037075281143188477 |0.0004944801330566406 |0.00269472599029541 |0.0012798309326171875 |
----------------------------------------------------------pseudo_mini_loss sum 1.4856765270233154
Total (block generation + training)time/epoch 7.402982831001282
Training time/epoch 0.3136107921600342
Training time without block to device /epoch 0.283611536026001
Training time without total dataloading part /epoch 0.015073299407958984
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 64.24it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.95it/s]100%|██████████| 4/4 [00:00<00:00, 15.38it/s]100%|██████████| 4/4 [00:00<00:00, 15.30it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.19it/s]100%|██████████| 4/4 [00:00<00:00, 17.34it/s]100%|██████████| 4/4 [00:00<00:00, 17.30it/s]
Run 00 | Epoch 00013 | Loss 1.4857 | Train 0.4194 | Val 0.5137 | Test 0.5106
Number of nodes during this epoch:  332797
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1611003875732422  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.017426490783691406
range selection method range initialization spend 0.011409521102905273
time for parepare:  0.017831802368164062
local_output_nid generation:  0.010510921478271484
local_in_edges_tensor generation:  0.00814056396484375
mini_batch_src_global generation:  0.013446807861328125
r_  generation:  0.16768860816955566
local_output_nid generation:  0.011796712875366211
local_in_edges_tensor generation:  0.005819082260131836
mini_batch_src_global generation:  0.01729106903076172
r_  generation:  0.18187999725341797
----------------------check_connections_block total spend ----------------------------- 0.5033576488494873
generate_one_block  0.19937491416931152
generate_one_block  0.20113134384155273
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02750229835510254
gen group dst list time:  0.007532358169555664
time for parepare:  0.02006673812866211
local_output_nid generation:  0.01714491844177246
local_in_edges_tensor generation:  0.029920339584350586
mini_batch_src_global generation:  0.0451509952545166
r_  generation:  0.48885464668273926
local_output_nid generation:  0.025547504425048828
local_in_edges_tensor generation:  0.02711200714111328
mini_batch_src_global generation:  0.055333852767944336
r_  generation:  0.49553990364074707
----------------------check_connections_block total spend ----------------------------- 1.418562412261963
generate_one_block  0.622199296951294
generate_one_block  0.6207747459411621
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025754690170288086
gen group dst list time:  0.012905120849609375
time for parepare:  0.01913142204284668
local_output_nid generation:  0.021473407745361328
local_in_edges_tensor generation:  0.03142285346984863
mini_batch_src_global generation:  0.04486441612243652
r_  generation:  0.507925271987915
local_output_nid generation:  0.032041311264038086
local_in_edges_tensor generation:  0.04350471496582031
mini_batch_src_global generation:  0.056789398193359375
r_  generation:  0.5164422988891602
----------------------check_connections_block total spend ----------------------------- 1.4954893589019775
generate_one_block  0.6296982765197754
generate_one_block  0.6431748867034912
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1611003875732422  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

connection checking time:  2.9140517711639404
block generation total time  2.5158472061157227
average batch blocks generation time:  1.2579236030578613
block dataloader generation time/epoch 7.070001888275146
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11676359176635742  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.282273769378662  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11636829376220703  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2757868766784668  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08142995834350586 |0.016068577766418457 |0.003528118133544922 |0.00047338008880615234 |0.002772808074951172 |0.0013124942779541016 |
----------------------------------------------------------pseudo_mini_loss sum 1.4507231712341309
Total (block generation + training)time/epoch 7.391523599624634
Training time/epoch 0.31575775146484375
Training time without block to device /epoch 0.28362059593200684
Training time without total dataloading part /epoch 0.014861106872558594
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 65.11it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.23it/s]100%|██████████| 4/4 [00:00<00:00, 17.39it/s]100%|██████████| 4/4 [00:00<00:00, 17.01it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.07it/s]100%|██████████| 4/4 [00:00<00:00, 22.03it/s]
Run 00 | Epoch 00014 | Loss 1.4507 | Train 0.4062 | Val 0.5181 | Test 0.5240
Number of nodes during this epoch:  332677
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16043806076049805  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018584489822387695
range selection method range initialization spend 0.011739492416381836
time for parepare:  0.019229412078857422
local_output_nid generation:  0.010664701461791992
local_in_edges_tensor generation:  0.008239507675170898
mini_batch_src_global generation:  0.013470649719238281
r_  generation:  0.17300653457641602
local_output_nid generation:  0.01208639144897461
local_in_edges_tensor generation:  0.0064394474029541016
mini_batch_src_global generation:  0.017717599868774414
r_  generation:  0.1832902431488037
----------------------check_connections_block total spend ----------------------------- 0.5163288116455078
generate_one_block  0.20484232902526855
generate_one_block  0.2052783966064453
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.039726972579956055
gen group dst list time:  0.007620096206665039
time for parepare:  0.019739151000976562
local_output_nid generation:  0.017103910446166992
local_in_edges_tensor generation:  0.03379464149475098
mini_batch_src_global generation:  0.04793405532836914
r_  generation:  0.48479461669921875
local_output_nid generation:  0.025211811065673828
local_in_edges_tensor generation:  0.035950660705566406
mini_batch_src_global generation:  0.05563926696777344
r_  generation:  0.49784278869628906
----------------------check_connections_block total spend ----------------------------- 1.432372808456421
generate_one_block  0.6189720630645752
generate_one_block  0.62978196144104
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029529809951782227
gen group dst list time:  0.012647628784179688
time for parepare:  0.01882624626159668
local_output_nid generation:  0.021245956420898438
local_in_edges_tensor generation:  0.03754258155822754
mini_batch_src_global generation:  0.04791593551635742
r_  generation:  0.5128493309020996
local_output_nid generation:  0.033646345138549805
local_in_edges_tensor generation:  0.04060983657836914
mini_batch_src_global generation:  0.05666685104370117
r_  generation:  0.5209040641784668
----------------------check_connections_block total spend ----------------------------- 1.515146017074585
generate_one_block  0.6502087116241455
generate_one_block  0.6553847789764404
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16043806076049805  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

connection checking time:  2.947518825531006
block generation total time  2.554347515106201
average batch blocks generation time:  1.2771737575531006
block dataloader generation time/epoch 7.088963270187378
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11674833297729492  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.28169584274292  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11659669876098633  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2807989120483398  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08558547496795654 |0.015651702880859375 |0.0041550397872924805 |0.0005085468292236328 |0.003734588623046875 |0.0013883113861083984 |
----------------------------------------------------------pseudo_mini_loss sum 1.421623706817627
Total (block generation + training)time/epoch 7.412533164024353
Training time/epoch 0.33367133140563965
Training time without block to device /epoch 0.3023679256439209
Training time without total dataloading part /epoch 0.018184661865234375
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 56.17it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.06it/s]100%|██████████| 4/4 [00:00<00:00, 14.47it/s]100%|██████████| 4/4 [00:00<00:00, 14.40it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.98it/s]100%|██████████| 4/4 [00:00<00:00, 17.14it/s]100%|██████████| 4/4 [00:00<00:00, 16.94it/s]
Run 00 | Epoch 00015 | Loss 1.4216 | Train 0.3868 | Val 0.5191 | Test 0.5384
Number of nodes during this epoch:  332758
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16118812561035156  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018466949462890625
range selection method range initialization spend 0.011922121047973633
time for parepare:  0.018831968307495117
local_output_nid generation:  0.010536432266235352
local_in_edges_tensor generation:  0.015306711196899414
mini_batch_src_global generation:  0.013361930847167969
r_  generation:  0.17115449905395508
local_output_nid generation:  0.011890172958374023
local_in_edges_tensor generation:  0.005860805511474609
mini_batch_src_global generation:  0.017459869384765625
r_  generation:  0.18137669563293457
----------------------check_connections_block total spend ----------------------------- 0.5147204399108887
generate_one_block  0.19892263412475586
generate_one_block  0.1999819278717041
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03005075454711914
gen group dst list time:  0.007485628128051758
time for parepare:  0.0198974609375
local_output_nid generation:  0.016864776611328125
local_in_edges_tensor generation:  0.03414177894592285
mini_batch_src_global generation:  0.05214500427246094
r_  generation:  0.4847385883331299
local_output_nid generation:  0.025678396224975586
local_in_edges_tensor generation:  0.03352069854736328
mini_batch_src_global generation:  0.055765628814697266
r_  generation:  0.4983341693878174
----------------------check_connections_block total spend ----------------------------- 1.4368171691894531
generate_one_block  0.6232774257659912
generate_one_block  0.6374092102050781
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02525782585144043
gen group dst list time:  0.012702465057373047
time for parepare:  0.01966691017150879
local_output_nid generation:  0.023119688034057617
local_in_edges_tensor generation:  0.035788774490356445
mini_batch_src_global generation:  0.04516005516052246
r_  generation:  0.5075359344482422
local_output_nid generation:  0.03085637092590332
local_in_edges_tensor generation:  0.03685593605041504
mini_batch_src_global generation:  0.0578150749206543
r_  generation:  0.521808385848999
----------------------check_connections_block total spend ----------------------------- 1.5005338191986084
generate_one_block  0.6346423625946045
generate_one_block  0.6351704597473145
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16118812561035156  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

connection checking time:  2.9373509883880615
block generation total time  2.5304994583129883
average batch blocks generation time:  1.2652497291564941
block dataloader generation time/epoch 7.096929141453335
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11674833297729492  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2819490432739258  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1165933609008789  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.280942440032959  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08197891712188721 |0.015451908111572266 |0.004035830497741699 |0.0005077123641967773 |0.0036863088607788086 |0.0018672943115234375 |
----------------------------------------------------------pseudo_mini_loss sum 1.3834009170532227
Total (block generation + training)time/epoch 7.420864548001971
Training time/epoch 0.3259916305541992
Training time without block to device /epoch 0.2950878143310547
Training time without total dataloading part /epoch 0.018326997756958008
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 60.67it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.00it/s]100%|██████████| 4/4 [00:00<00:00, 15.24it/s]100%|██████████| 4/4 [00:00<00:00, 15.19it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.23it/s]100%|██████████| 4/4 [00:00<00:00, 17.41it/s]100%|██████████| 4/4 [00:00<00:00, 17.36it/s]
Run 00 | Epoch 00016 | Loss 1.3834 | Train 0.3730 | Val 0.5153 | Test 0.5454
Number of nodes during this epoch:  332815
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16112661361694336  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019991159439086914
range selection method range initialization spend 0.011858701705932617
time for parepare:  0.01753687858581543
local_output_nid generation:  0.010750055313110352
local_in_edges_tensor generation:  0.012333869934082031
mini_batch_src_global generation:  0.013450860977172852
r_  generation:  0.1671309471130371
local_output_nid generation:  0.0119171142578125
local_in_edges_tensor generation:  0.007836580276489258
mini_batch_src_global generation:  0.018874168395996094
r_  generation:  0.18357181549072266
----------------------check_connections_block total spend ----------------------------- 0.5121650695800781
generate_one_block  0.1971573829650879
generate_one_block  0.20309758186340332
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0342252254486084
gen group dst list time:  0.00750732421875
time for parepare:  0.020008325576782227
local_output_nid generation:  0.017099618911743164
local_in_edges_tensor generation:  0.03425288200378418
mini_batch_src_global generation:  0.0469202995300293
r_  generation:  0.48944711685180664
local_output_nid generation:  0.025156497955322266
local_in_edges_tensor generation:  0.030814409255981445
mini_batch_src_global generation:  0.05584406852722168
r_  generation:  0.4982154369354248
----------------------check_connections_block total spend ----------------------------- 1.4332304000854492
generate_one_block  0.6353530883789062
generate_one_block  0.6668071746826172
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.024848461151123047
gen group dst list time:  0.012638092041015625
time for parepare:  0.019284725189208984
local_output_nid generation:  0.02149486541748047
local_in_edges_tensor generation:  0.03421592712402344
mini_batch_src_global generation:  0.0507049560546875
r_  generation:  0.5156283378601074
local_output_nid generation:  0.031249284744262695
local_in_edges_tensor generation:  0.03560066223144531
mini_batch_src_global generation:  0.05659747123718262
r_  generation:  0.5274455547332764
----------------------check_connections_block total spend ----------------------------- 1.5157239437103271
generate_one_block  0.6468150615692139
generate_one_block  0.6673452854156494
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16112661361694336  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

connection checking time:  2.9489543437957764
block generation total time  2.6163206100463867
average batch blocks generation time:  1.3081603050231934
block dataloader generation time/epoch 7.11788284778595
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11673212051391602  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.281881332397461  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1165914535522461  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2811861038208008  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08579146862030029 |0.03190934658050537 |0.004295468330383301 |0.000507354736328125 |0.004095792770385742 |0.0013470649719238281 |
----------------------------------------------------------pseudo_mini_loss sum 1.3681292533874512
Total (block generation + training)time/epoch 7.445664137601852
Training time/epoch 0.35454845428466797
Training time without block to device /epoch 0.2907297611236572
Training time without total dataloading part /epoch 0.019144296646118164
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 51.20it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.93it/s]100%|██████████| 4/4 [00:00<00:00, 15.03it/s]100%|██████████| 4/4 [00:00<00:00, 15.00it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.05it/s]100%|██████████| 4/4 [00:00<00:00, 17.43it/s]100%|██████████| 4/4 [00:00<00:00, 17.36it/s]
Run 00 | Epoch 00017 | Loss 1.3681 | Train 0.3604 | Val 0.5013 | Test 0.5378
Number of nodes during this epoch:  332787
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16110801696777344  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020949602127075195
range selection method range initialization spend 0.011810541152954102
time for parepare:  0.019010305404663086
local_output_nid generation:  0.01045083999633789
local_in_edges_tensor generation:  0.012361764907836914
mini_batch_src_global generation:  0.013743877410888672
r_  generation:  0.16999268531799316
local_output_nid generation:  0.011766672134399414
local_in_edges_tensor generation:  0.006228208541870117
mini_batch_src_global generation:  0.017244338989257812
r_  generation:  0.18098974227905273
----------------------check_connections_block total spend ----------------------------- 0.5113053321838379
generate_one_block  0.2013254165649414
generate_one_block  0.19834280014038086
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028348684310913086
gen group dst list time:  0.007418632507324219
time for parepare:  0.019807100296020508
local_output_nid generation:  0.01681995391845703
local_in_edges_tensor generation:  0.030480384826660156
mini_batch_src_global generation:  0.04467320442199707
r_  generation:  0.49053215980529785
local_output_nid generation:  0.025772809982299805
local_in_edges_tensor generation:  0.038995981216430664
mini_batch_src_global generation:  0.05846405029296875
r_  generation:  0.5022203922271729
----------------------check_connections_block total spend ----------------------------- 1.4426331520080566
generate_one_block  0.6255190372467041
generate_one_block  0.628272294998169
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.031003475189208984
gen group dst list time:  0.012923002243041992
time for parepare:  0.01933765411376953
local_output_nid generation:  0.022189855575561523
local_in_edges_tensor generation:  0.03606367111206055
mini_batch_src_global generation:  0.045494794845581055
r_  generation:  0.5155630111694336
local_output_nid generation:  0.033019065856933594
local_in_edges_tensor generation:  0.03681445121765137
mini_batch_src_global generation:  0.05662274360656738
r_  generation:  0.538931131362915
----------------------check_connections_block total spend ----------------------------- 1.5369012355804443
generate_one_block  0.6548242568969727
generate_one_block  0.6499104499816895
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16110801696777344  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

connection checking time:  2.979534387588501
block generation total time  2.558526039123535
average batch blocks generation time:  1.2792630195617676
block dataloader generation time/epoch 7.127584218978882
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11678361892700195  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2819228172302246  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11654043197631836  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2810120582580566  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08396053314208984 |0.022830724716186523 |0.0039958953857421875 |0.0004944801330566406 |0.00410008430480957 |0.0013229846954345703 |
----------------------------------------------------------pseudo_mini_loss sum 1.355726718902588
Total (block generation + training)time/epoch 7.456034209993151
Training time/epoch 0.33365726470947266
Training time without block to device /epoch 0.2879958152770996
Training time without total dataloading part /epoch 0.018503904342651367
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 51.06it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.00it/s]100%|██████████| 4/4 [00:00<00:00, 15.26it/s]100%|██████████| 4/4 [00:00<00:00, 15.21it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.83it/s]100%|██████████| 4/4 [00:00<00:00, 17.27it/s]100%|██████████| 4/4 [00:00<00:00, 17.18it/s]
Run 00 | Epoch 00018 | Loss 1.3557 | Train 0.3513 | Val 0.4873 | Test 0.5264
Number of nodes during this epoch:  332765
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1610698699951172  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019440174102783203
range selection method range initialization spend 0.012062788009643555
time for parepare:  0.017097949981689453
local_output_nid generation:  0.010577678680419922
local_in_edges_tensor generation:  0.010792016983032227
mini_batch_src_global generation:  0.013457059860229492
r_  generation:  0.16930770874023438
local_output_nid generation:  0.012059450149536133
local_in_edges_tensor generation:  0.006283998489379883
mini_batch_src_global generation:  0.01730489730834961
r_  generation:  0.18347454071044922
----------------------check_connections_block total spend ----------------------------- 0.5101983547210693
generate_one_block  0.20067691802978516
generate_one_block  0.20297837257385254
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03542184829711914
gen group dst list time:  0.007401227951049805
time for parepare:  0.019835233688354492
local_output_nid generation:  0.017107725143432617
local_in_edges_tensor generation:  0.03003382682800293
mini_batch_src_global generation:  0.04531431198120117
r_  generation:  0.4888303279876709
local_output_nid generation:  0.025607824325561523
local_in_edges_tensor generation:  0.033111572265625
mini_batch_src_global generation:  0.05572628974914551
r_  generation:  0.5155177116394043
----------------------check_connections_block total spend ----------------------------- 1.4484145641326904
generate_one_block  0.6547501087188721
generate_one_block  0.6252470016479492
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02795100212097168
gen group dst list time:  0.012655019760131836
time for parepare:  0.019007205963134766
local_output_nid generation:  0.021910429000854492
local_in_edges_tensor generation:  0.03146934509277344
mini_batch_src_global generation:  0.04704165458679199
r_  generation:  0.5090618133544922
local_output_nid generation:  0.03224062919616699
local_in_edges_tensor generation:  0.0369107723236084
mini_batch_src_global generation:  0.05657768249511719
r_  generation:  0.5217628479003906
----------------------check_connections_block total spend ----------------------------- 1.4981074333190918
generate_one_block  0.6355350017547607
generate_one_block  0.6409108638763428
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1610698699951172  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

connection checking time:  2.9465219974517822
block generation total time  2.556442975997925
average batch blocks generation time:  1.2782214879989624
block dataloader generation time/epoch 7.132408976554871
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11673307418823242  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2822108268737793  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1166219711303711  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2811279296875  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0791858434677124 |0.028910279273986816 |0.0036411285400390625 |0.0004792213439941406 |0.003764629364013672 |0.002645254135131836 |
----------------------------------------------------------pseudo_mini_loss sum 1.3428442478179932
Total (block generation + training)time/epoch 7.461696028709412
Training time/epoch 0.33674144744873047
Training time without block to device /epoch 0.27892088890075684
Training time without total dataloading part /epoch 0.018415212631225586
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 45.02it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.07it/s]100%|██████████| 4/4 [00:00<00:00, 15.20it/s]100%|██████████| 4/4 [00:00<00:00, 15.17it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.39it/s]100%|██████████| 4/4 [00:00<00:00, 16.72it/s]100%|██████████| 4/4 [00:00<00:00, 16.49it/s]
Run 00 | Epoch 00019 | Loss 1.3428 | Train 0.3506 | Val 0.4839 | Test 0.5229
Number of nodes during this epoch:  332873
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16110563278198242  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020009756088256836
range selection method range initialization spend 0.011693716049194336
time for parepare:  0.01912546157836914
local_output_nid generation:  0.01078653335571289
local_in_edges_tensor generation:  0.012302160263061523
mini_batch_src_global generation:  0.013434886932373047
r_  generation:  0.16828274726867676
local_output_nid generation:  0.012503623962402344
local_in_edges_tensor generation:  0.005823373794555664
mini_batch_src_global generation:  0.01750493049621582
r_  generation:  0.1807262897491455
----------------------check_connections_block total spend ----------------------------- 0.5092790126800537
generate_one_block  0.19590282440185547
generate_one_block  0.19959712028503418
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03291773796081543
gen group dst list time:  0.007230281829833984
time for parepare:  0.019725322723388672
local_output_nid generation:  0.018322467803955078
local_in_edges_tensor generation:  0.03196287155151367
mini_batch_src_global generation:  0.04488968849182129
r_  generation:  0.4865577220916748
local_output_nid generation:  0.0258028507232666
local_in_edges_tensor generation:  0.03281259536743164
mini_batch_src_global generation:  0.055922508239746094
r_  generation:  0.5011641979217529
----------------------check_connections_block total spend ----------------------------- 1.4306073188781738
generate_one_block  0.6247720718383789
generate_one_block  0.6304082870483398
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02497577667236328
gen group dst list time:  0.01258087158203125
time for parepare:  0.019158124923706055
local_output_nid generation:  0.021936416625976562
local_in_edges_tensor generation:  0.04334259033203125
mini_batch_src_global generation:  0.04648756980895996
r_  generation:  0.512880802154541
local_output_nid generation:  0.031110525131225586
local_in_edges_tensor generation:  0.029635190963745117
mini_batch_src_global generation:  0.05684065818786621
r_  generation:  0.5307583808898926
----------------------check_connections_block total spend ----------------------------- 1.5152995586395264
generate_one_block  0.6381113529205322
generate_one_block  0.6327464580535889
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16110563278198242  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

connection checking time:  2.9459068775177
block generation total time  2.52603816986084
average batch blocks generation time:  1.26301908493042
block dataloader generation time/epoch 7.1304803328080615
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11673784255981445  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.282175064086914  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11648225784301758  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2801661491394043  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0854724645614624 |0.015290260314941406 |0.003979802131652832 |0.0005050897598266602 |0.003015756607055664 |0.0013794898986816406 |
----------------------------------------------------------pseudo_mini_loss sum 1.3206411600112915
Total (block generation + training)time/epoch 7.459010926159945
Training time/epoch 0.32082700729370117
Training time without block to device /epoch 0.29024648666381836
Training time without total dataloading part /epoch 0.016380786895751953
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 58.74it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.82it/s]100%|██████████| 4/4 [00:00<00:00, 15.33it/s]100%|██████████| 4/4 [00:00<00:00, 15.24it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.27it/s]100%|██████████| 4/4 [00:00<00:00, 17.36it/s]100%|██████████| 4/4 [00:00<00:00, 17.32it/s]
Run 00 | Epoch 00020 | Loss 1.3206 | Train 0.3557 | Val 0.4908 | Test 0.5270
Number of nodes during this epoch:  332644
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16021251678466797  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.016259193420410156
range selection method range initialization spend 0.011558055877685547
time for parepare:  0.016817569732666016
local_output_nid generation:  0.01061391830444336
local_in_edges_tensor generation:  0.008621454238891602
mini_batch_src_global generation:  0.013513326644897461
r_  generation:  0.1673266887664795
local_output_nid generation:  0.011948585510253906
local_in_edges_tensor generation:  0.0057506561279296875
mini_batch_src_global generation:  0.017284393310546875
r_  generation:  0.18095660209655762
----------------------check_connections_block total spend ----------------------------- 0.502007246017456
generate_one_block  0.19814276695251465
generate_one_block  0.19875693321228027
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029195308685302734
gen group dst list time:  0.0071451663970947266
time for parepare:  0.01968216896057129
local_output_nid generation:  0.018073081970214844
local_in_edges_tensor generation:  0.02724456787109375
mini_batch_src_global generation:  0.0449526309967041
r_  generation:  0.48623204231262207
local_output_nid generation:  0.026304244995117188
local_in_edges_tensor generation:  0.02598261833190918
mini_batch_src_global generation:  0.05538201332092285
r_  generation:  0.49913763999938965
----------------------check_connections_block total spend ----------------------------- 1.4167311191558838
generate_one_block  0.6160268783569336
generate_one_block  0.6163234710693359
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028043031692504883
gen group dst list time:  0.012479543685913086
time for parepare:  0.018677949905395508
local_output_nid generation:  0.022454261779785156
local_in_edges_tensor generation:  0.031006336212158203
mini_batch_src_global generation:  0.04564237594604492
r_  generation:  0.5057146549224854
local_output_nid generation:  0.03190350532531738
local_in_edges_tensor generation:  0.03593707084655762
mini_batch_src_global generation:  0.05640387535095215
r_  generation:  0.5159177780151367
----------------------check_connections_block total spend ----------------------------- 1.4849183559417725
generate_one_block  0.6330969333648682
generate_one_block  0.6486272811889648
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16021251678466797  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

connection checking time:  2.9016494750976562
block generation total time  2.5140745639801025
average batch blocks generation time:  1.2570372819900513
block dataloader generation time/epoch 7.123132387797038
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11676931381225586  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2821588516235352  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11646509170532227  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2801551818847656  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07423877716064453 |0.018121957778930664 |0.003765583038330078 |0.0004897117614746094 |0.003685474395751953 |0.001291513442993164 |
----------------------------------------------------------pseudo_mini_loss sum 1.3056612014770508
Total (block generation + training)time/epoch 7.449897050857544
Training time/epoch 0.30725932121276855
Training time without block to device /epoch 0.2710154056549072
Training time without total dataloading part /epoch 0.017173051834106445
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 58.86it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.20it/s]100%|██████████| 4/4 [00:00<00:00, 15.32it/s]100%|██████████| 4/4 [00:00<00:00, 15.29it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.64it/s]100%|██████████| 4/4 [00:00<00:00, 17.61it/s]100%|██████████| 4/4 [00:00<00:00, 17.59it/s]
Run 00 | Epoch 00021 | Loss 1.3057 | Train 0.3614 | Val 0.4981 | Test 0.5316
Number of nodes during this epoch:  332769
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1602005958557129  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01785755157470703
range selection method range initialization spend 0.011445045471191406
time for parepare:  0.018628835678100586
local_output_nid generation:  0.010934829711914062
local_in_edges_tensor generation:  0.008333444595336914
mini_batch_src_global generation:  0.013730049133300781
r_  generation:  0.16588258743286133
local_output_nid generation:  0.01188039779663086
local_in_edges_tensor generation:  0.00574040412902832
mini_batch_src_global generation:  0.017058372497558594
r_  generation:  0.17881464958190918
----------------------check_connections_block total spend ----------------------------- 0.5004329681396484
generate_one_block  0.19651126861572266
generate_one_block  0.2047736644744873
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029065370559692383
gen group dst list time:  0.007303714752197266
time for parepare:  0.01952362060546875
local_output_nid generation:  0.017284154891967773
local_in_edges_tensor generation:  0.029185056686401367
mini_batch_src_global generation:  0.04454231262207031
r_  generation:  0.48826146125793457
local_output_nid generation:  0.02525639533996582
local_in_edges_tensor generation:  0.04087257385253906
mini_batch_src_global generation:  0.057573795318603516
r_  generation:  0.5137577056884766
----------------------check_connections_block total spend ----------------------------- 1.4556434154510498
generate_one_block  0.6155767440795898
generate_one_block  0.6220743656158447
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029924631118774414
gen group dst list time:  0.014237403869628906
time for parepare:  0.018608570098876953
local_output_nid generation:  0.02197575569152832
local_in_edges_tensor generation:  0.03832221031188965
mini_batch_src_global generation:  0.04800605773925781
r_  generation:  0.5062096118927002
local_output_nid generation:  0.031063556671142578
local_in_edges_tensor generation:  0.039519309997558594
mini_batch_src_global generation:  0.05654740333557129
r_  generation:  0.5142405033111572
----------------------check_connections_block total spend ----------------------------- 1.4955077171325684
generate_one_block  0.6340169906616211
generate_one_block  0.6413776874542236
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1602005958557129  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

connection checking time:  2.951151132583618
block generation total time  2.5130457878112793
average batch blocks generation time:  1.2565228939056396
block dataloader generation time/epoch 7.120492128225473
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11674642562866211  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2823138236999512  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11647891998291016  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2806892395019531  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08122992515563965 |0.017203450202941895 |0.004070162773132324 |0.0005098581314086914 |0.003575563430786133 |0.003811359405517578 |
----------------------------------------------------------pseudo_mini_loss sum 1.2881944179534912
Total (block generation + training)time/epoch 7.447471160155076
Training time/epoch 0.3294062614440918
Training time without block to device /epoch 0.294999361038208
Training time without total dataloading part /epoch 0.020122528076171875
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 57.52it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.50it/s]100%|██████████| 4/4 [00:00<00:00, 15.39it/s]100%|██████████| 4/4 [00:00<00:00, 15.39it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.30it/s]100%|██████████| 4/4 [00:00<00:00, 17.51it/s]100%|██████████| 4/4 [00:00<00:00, 17.45it/s]
Run 00 | Epoch 00022 | Loss 1.2882 | Train 0.3678 | Val 0.5027 | Test 0.5331
Number of nodes during this epoch:  332838
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16110754013061523  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.015700817108154297
range selection method range initialization spend 0.011611223220825195
time for parepare:  0.016942501068115234
local_output_nid generation:  0.010682344436645508
local_in_edges_tensor generation:  0.00885772705078125
mini_batch_src_global generation:  0.013597726821899414
r_  generation:  0.17036867141723633
local_output_nid generation:  0.011902332305908203
local_in_edges_tensor generation:  0.0062103271484375
mini_batch_src_global generation:  0.017297744750976562
r_  generation:  0.18214631080627441
----------------------check_connections_block total spend ----------------------------- 0.5074799060821533
generate_one_block  0.19934368133544922
generate_one_block  0.20051121711730957
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03102731704711914
gen group dst list time:  0.0072116851806640625
time for parepare:  0.019855499267578125
local_output_nid generation:  0.01822686195373535
local_in_edges_tensor generation:  0.027968883514404297
mini_batch_src_global generation:  0.04526686668395996
r_  generation:  0.4988226890563965
local_output_nid generation:  0.02581191062927246
local_in_edges_tensor generation:  0.027805805206298828
mini_batch_src_global generation:  0.05557751655578613
r_  generation:  0.5085914134979248
----------------------check_connections_block total spend ----------------------------- 1.4463400840759277
generate_one_block  0.6725757122039795
generate_one_block  0.6472489833831787
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.042615413665771484
gen group dst list time:  0.01483917236328125
time for parepare:  0.020678997039794922
local_output_nid generation:  0.023703336715698242
local_in_edges_tensor generation:  0.04548454284667969
mini_batch_src_global generation:  0.04649543762207031
r_  generation:  0.5126352310180664
local_output_nid generation:  0.032206058502197266
local_in_edges_tensor generation:  0.039733171463012695
mini_batch_src_global generation:  0.05709528923034668
r_  generation:  0.5208613872528076
----------------------check_connections_block total spend ----------------------------- 1.5205183029174805
generate_one_block  0.6440117359161377
generate_one_block  0.6438732147216797
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16110754013061523  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

connection checking time:  2.966858386993408
block generation total time  2.6077096462249756
average batch blocks generation time:  1.3038548231124878
block dataloader generation time/epoch 7.129294582775661
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11677885055541992  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2821617126464844  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11646461486816406  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2801313400268555  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08715951442718506 |0.018631339073181152 |0.004114985466003418 |0.0005060434341430664 |0.003925204277038574 |0.0013163089752197266 |
----------------------------------------------------------pseudo_mini_loss sum 1.2776556015014648
Total (block generation + training)time/epoch 7.457417232649667
Training time/epoch 0.3428497314453125
Training time without block to device /epoch 0.3055870532989502
Training time without total dataloading part /epoch 0.018408775329589844
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 52.99it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.88it/s]100%|██████████| 4/4 [00:00<00:00, 15.27it/s]100%|██████████| 4/4 [00:00<00:00, 15.19it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.32it/s]100%|██████████| 4/4 [00:00<00:00, 17.65it/s]100%|██████████| 4/4 [00:00<00:00, 17.58it/s]
Run 00 | Epoch 00023 | Loss 1.2777 | Train 0.3734 | Val 0.5050 | Test 0.5345
Number of nodes during this epoch:  332779
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1601719856262207  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020756244659423828
range selection method range initialization spend 0.012256860733032227
time for parepare:  0.016928434371948242
local_output_nid generation:  0.010835647583007812
local_in_edges_tensor generation:  0.008522510528564453
mini_batch_src_global generation:  0.013551950454711914
r_  generation:  0.1722874641418457
local_output_nid generation:  0.012183666229248047
local_in_edges_tensor generation:  0.006600856781005859
mini_batch_src_global generation:  0.018628358840942383
r_  generation:  0.18572783470153809
----------------------check_connections_block total spend ----------------------------- 0.5165250301361084
generate_one_block  0.20007538795471191
generate_one_block  0.2047433853149414
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04155778884887695
gen group dst list time:  0.007262706756591797
time for parepare:  0.021892547607421875
local_output_nid generation:  0.01717996597290039
local_in_edges_tensor generation:  0.03789377212524414
mini_batch_src_global generation:  0.04839134216308594
r_  generation:  0.509265661239624
local_output_nid generation:  0.028403520584106445
local_in_edges_tensor generation:  0.034975290298461914
mini_batch_src_global generation:  0.05746793746948242
r_  generation:  0.5060093402862549
----------------------check_connections_block total spend ----------------------------- 1.4798145294189453
generate_one_block  0.6250066757202148
generate_one_block  0.6293034553527832
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03323030471801758
gen group dst list time:  0.012683629989624023
time for parepare:  0.019905567169189453
local_output_nid generation:  0.021726369857788086
local_in_edges_tensor generation:  0.03862714767456055
mini_batch_src_global generation:  0.04690742492675781
r_  generation:  0.511909008026123
local_output_nid generation:  0.031702518463134766
local_in_edges_tensor generation:  0.04472923278808594
mini_batch_src_global generation:  0.05844259262084961
r_  generation:  0.5239379405975342
----------------------check_connections_block total spend ----------------------------- 1.5208961963653564
generate_one_block  0.6507318019866943
generate_one_block  0.6463327407836914
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1601719856262207  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

connection checking time:  3.0007107257843018
block generation total time  2.551374673843384
average batch blocks generation time:  1.275687336921692
block dataloader generation time/epoch 7.137776295344035
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1167607307434082  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2819509506225586  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11652946472167969  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2805967330932617  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08470606803894043 |0.016097426414489746 |0.00414586067199707 |0.0005159378051757812 |0.0031086206436157227 |0.0013964176177978516 |
----------------------------------------------------------pseudo_mini_loss sum 1.2651002407073975
Total (block generation + training)time/epoch 7.465732447306315
Training time/epoch 0.325486421585083
Training time without block to device /epoch 0.2932915687561035
Training time without total dataloading part /epoch 0.016937255859375
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 49.77it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.90it/s]100%|██████████| 4/4 [00:00<00:00, 15.46it/s]100%|██████████| 4/4 [00:00<00:00, 15.36it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.27it/s]100%|██████████| 4/4 [00:00<00:00, 17.54it/s]100%|██████████| 4/4 [00:00<00:00, 17.48it/s]
Run 00 | Epoch 00024 | Loss 1.2651 | Train 0.3791 | Val 0.5064 | Test 0.5351
Number of nodes during this epoch:  332774
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16108179092407227  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018073320388793945
range selection method range initialization spend 0.011850595474243164
time for parepare:  0.016742706298828125
local_output_nid generation:  0.010650634765625
local_in_edges_tensor generation:  0.008014440536499023
mini_batch_src_global generation:  0.013550043106079102
r_  generation:  0.16875767707824707
local_output_nid generation:  0.01180887222290039
local_in_edges_tensor generation:  0.006011009216308594
mini_batch_src_global generation:  0.017673254013061523
r_  generation:  0.1809675693511963
----------------------check_connections_block total spend ----------------------------- 0.5041866302490234
generate_one_block  0.19681000709533691
generate_one_block  0.19944262504577637
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02699446678161621
gen group dst list time:  0.007252931594848633
time for parepare:  0.019766569137573242
local_output_nid generation:  0.017288684844970703
local_in_edges_tensor generation:  0.028085947036743164
mini_batch_src_global generation:  0.0458989143371582
r_  generation:  0.48952531814575195
local_output_nid generation:  0.025751352310180664
local_in_edges_tensor generation:  0.02882671356201172
mini_batch_src_global generation:  0.0574193000793457
r_  generation:  0.49925708770751953
----------------------check_connections_block total spend ----------------------------- 1.426985263824463
generate_one_block  0.6257870197296143
generate_one_block  0.6274101734161377
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02505660057067871
gen group dst list time:  0.013094425201416016
time for parepare:  0.01975846290588379
local_output_nid generation:  0.023095130920410156
local_in_edges_tensor generation:  0.03136467933654785
mini_batch_src_global generation:  0.04602193832397461
r_  generation:  0.5158617496490479
local_output_nid generation:  0.03331279754638672
local_in_edges_tensor generation:  0.03835010528564453
mini_batch_src_global generation:  0.056146860122680664
r_  generation:  0.5308749675750732
----------------------check_connections_block total spend ----------------------------- 1.5172479152679443
generate_one_block  0.6556847095489502
generate_one_block  0.6573989391326904
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16108179092407227  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

connection checking time:  2.9442331790924072
block generation total time  2.5662808418273926
average batch blocks generation time:  1.2831404209136963
block dataloader generation time/epoch 7.138461843132973
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11674356460571289  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.281980037689209  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11648845672607422  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.280440330505371  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08588564395904541 |0.022499442100524902 |0.003900766372680664 |0.0004781484603881836 |0.003197908401489258 |0.0012629032135009766 |
----------------------------------------------------------pseudo_mini_loss sum 1.2546720504760742
Total (block generation + training)time/epoch 7.46739387512207
Training time/epoch 0.3434789180755615
Training time without block to device /epoch 0.2984800338745117
Training time without total dataloading part /epoch 0.016416549682617188
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 49.60it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.84it/s]100%|██████████| 4/4 [00:00<00:00, 15.51it/s]100%|██████████| 4/4 [00:00<00:00, 15.39it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.28it/s]100%|██████████| 4/4 [00:00<00:00, 17.48it/s]100%|██████████| 4/4 [00:00<00:00, 17.43it/s]
Run 00 | Epoch 00025 | Loss 1.2547 | Train 0.3858 | Val 0.5068 | Test 0.5344
Number of nodes during this epoch:  332771
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16111040115356445  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01585841178894043
range selection method range initialization spend 0.012176275253295898
time for parepare:  0.018900394439697266
local_output_nid generation:  0.010668516159057617
local_in_edges_tensor generation:  0.011797666549682617
mini_batch_src_global generation:  0.013657808303833008
r_  generation:  0.1700279712677002
local_output_nid generation:  0.011743783950805664
local_in_edges_tensor generation:  0.0059146881103515625
mini_batch_src_global generation:  0.017425537109375
r_  generation:  0.1831822395324707
----------------------check_connections_block total spend ----------------------------- 0.5136878490447998
generate_one_block  0.19844365119934082
generate_one_block  0.2003791332244873
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03345775604248047
gen group dst list time:  0.007311820983886719
time for parepare:  0.01985645294189453
local_output_nid generation:  0.017462491989135742
local_in_edges_tensor generation:  0.03702878952026367
mini_batch_src_global generation:  0.04665875434875488
r_  generation:  0.4918019771575928
local_output_nid generation:  0.025288105010986328
local_in_edges_tensor generation:  0.029770851135253906
mini_batch_src_global generation:  0.054556846618652344
r_  generation:  0.496082067489624
----------------------check_connections_block total spend ----------------------------- 1.4334471225738525
generate_one_block  0.637338399887085
generate_one_block  0.6366312503814697
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02614450454711914
gen group dst list time:  0.012688398361206055
time for parepare:  0.019013166427612305
local_output_nid generation:  0.02158498764038086
local_in_edges_tensor generation:  0.032067060470581055
mini_batch_src_global generation:  0.04665422439575195
r_  generation:  0.5100100040435791
local_output_nid generation:  0.03130745887756348
local_in_edges_tensor generation:  0.035646677017211914
mini_batch_src_global generation:  0.056381940841674805
r_  generation:  0.519752025604248
----------------------check_connections_block total spend ----------------------------- 1.495978593826294
generate_one_block  0.6374602317810059
generate_one_block  0.6419990062713623
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16111040115356445  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

connection checking time:  2.9294257164001465
block generation total time  2.553428888320923
average batch blocks generation time:  1.2767144441604614
block dataloader generation time/epoch 7.1378275226144225
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11681985855102539  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2822837829589844  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11632680892944336  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.280045986175537  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06528520584106445 |0.01544177532196045 |0.01642453670501709 |0.0004976987838745117 |0.0032399892807006836 |0.001394033432006836 |
----------------------------------------------------------pseudo_mini_loss sum 1.2377839088439941
Total (block generation + training)time/epoch 7.466091927360086
Training time/epoch 0.3174927234649658
Training time without block to device /epoch 0.2866091728210449
Training time without total dataloading part /epoch 0.041718482971191406
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 62.24it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.00it/s]100%|██████████| 4/4 [00:00<00:00, 15.47it/s]100%|██████████| 4/4 [00:00<00:00, 15.38it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.24it/s]100%|██████████| 4/4 [00:00<00:00, 17.66it/s]100%|██████████| 4/4 [00:00<00:00, 17.58it/s]
Run 00 | Epoch 00026 | Loss 1.2378 | Train 0.3933 | Val 0.5085 | Test 0.5345
Number of nodes during this epoch:  332824
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16101360321044922  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.015167236328125
range selection method range initialization spend 0.011695623397827148
time for parepare:  0.017128705978393555
local_output_nid generation:  0.010775327682495117
local_in_edges_tensor generation:  0.008081912994384766
mini_batch_src_global generation:  0.013567447662353516
r_  generation:  0.1688680648803711
local_output_nid generation:  0.011786699295043945
local_in_edges_tensor generation:  0.008359193801879883
mini_batch_src_global generation:  0.01719045639038086
r_  generation:  0.17975473403930664
----------------------check_connections_block total spend ----------------------------- 0.5054857730865479
generate_one_block  0.1981801986694336
generate_one_block  0.19984769821166992
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.025905132293701172
gen group dst list time:  0.007166147232055664
time for parepare:  0.02004694938659668
local_output_nid generation:  0.017493486404418945
local_in_edges_tensor generation:  0.027777433395385742
mini_batch_src_global generation:  0.04563570022583008
r_  generation:  0.4883244037628174
local_output_nid generation:  0.025660276412963867
local_in_edges_tensor generation:  0.027456045150756836
mini_batch_src_global generation:  0.05471467971801758
r_  generation:  0.4987366199493408
----------------------check_connections_block total spend ----------------------------- 1.4213500022888184
generate_one_block  0.6241049766540527
generate_one_block  0.6252329349517822
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0251467227935791
gen group dst list time:  0.013352155685424805
time for parepare:  0.01925349235534668
local_output_nid generation:  0.02213120460510254
local_in_edges_tensor generation:  0.03252768516540527
mini_batch_src_global generation:  0.046454668045043945
r_  generation:  0.5152130126953125
local_output_nid generation:  0.03303122520446777
local_in_edges_tensor generation:  0.030613422393798828
mini_batch_src_global generation:  0.059090375900268555
r_  generation:  0.5199978351593018
----------------------check_connections_block total spend ----------------------------- 1.5025749206542969
generate_one_block  0.6413257122039795
generate_one_block  0.6492104530334473
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16101360321044922  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

connection checking time:  2.9239249229431152
block generation total time  2.5398740768432617
average batch blocks generation time:  1.2699370384216309
block dataloader generation time/epoch 7.134033348825243
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11675691604614258  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2819499969482422  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11657381057739258  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2810497283935547  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07984578609466553 |0.020594358444213867 |0.0037682056427001953 |0.0005173683166503906 |0.0027774572372436523 |0.0023665428161621094 |
----------------------------------------------------------pseudo_mini_loss sum 1.2277414798736572
Total (block generation + training)time/epoch 7.462277770042419
Training time/epoch 0.32782435417175293
Training time without block to device /epoch 0.2866356372833252
Training time without total dataloading part /epoch 0.016492605209350586
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 43.06it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.05it/s]100%|██████████| 4/4 [00:00<00:00, 15.12it/s]100%|██████████| 4/4 [00:00<00:00, 14.93it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.28it/s]100%|██████████| 4/4 [00:00<00:00, 17.55it/s]100%|██████████| 4/4 [00:00<00:00, 17.49it/s]
Run 00 | Epoch 00027 | Loss 1.2277 | Train 0.4017 | Val 0.5089 | Test 0.5319
Number of nodes during this epoch:  332825
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16100549697875977  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018494367599487305
range selection method range initialization spend 0.011800050735473633
time for parepare:  0.017062902450561523
local_output_nid generation:  0.010721921920776367
local_in_edges_tensor generation:  0.012768268585205078
mini_batch_src_global generation:  0.01377558708190918
r_  generation:  0.1708073616027832
local_output_nid generation:  0.011760234832763672
local_in_edges_tensor generation:  0.006499528884887695
mini_batch_src_global generation:  0.017258167266845703
r_  generation:  0.1846330165863037
----------------------check_connections_block total spend ----------------------------- 0.5153210163116455
generate_one_block  0.19831228256225586
generate_one_block  0.19994306564331055
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029335498809814453
gen group dst list time:  0.007196664810180664
time for parepare:  0.01981830596923828
local_output_nid generation:  0.017267704010009766
local_in_edges_tensor generation:  0.0345003604888916
mini_batch_src_global generation:  0.0498347282409668
r_  generation:  0.49744296073913574
local_output_nid generation:  0.02572798728942871
local_in_edges_tensor generation:  0.02646780014038086
mini_batch_src_global generation:  0.05858445167541504
r_  generation:  0.5050985813140869
----------------------check_connections_block total spend ----------------------------- 1.4493415355682373
generate_one_block  0.6366689205169678
generate_one_block  0.6310374736785889
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02303028106689453
gen group dst list time:  0.012630701065063477
time for parepare:  0.01888298988342285
local_output_nid generation:  0.023865938186645508
local_in_edges_tensor generation:  0.0322108268737793
mini_batch_src_global generation:  0.04662370681762695
r_  generation:  0.5183770656585693
local_output_nid generation:  0.0323023796081543
local_in_edges_tensor generation:  0.03529047966003418
mini_batch_src_global generation:  0.05859851837158203
r_  generation:  0.5248184204101562
----------------------check_connections_block total spend ----------------------------- 1.5149390697479248
generate_one_block  0.6645827293395996
generate_one_block  0.6478481292724609
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16100549697875977  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

connection checking time:  2.964280605316162
block generation total time  2.580137252807617
average batch blocks generation time:  1.2900686264038086
block dataloader generation time/epoch 7.1374005643944995
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11677789688110352  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2826504707336426  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11638307571411133  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2801470756530762  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.051022887229919434 |0.02307868003845215 |0.0041239261627197266 |0.0005096197128295898 |0.04150569438934326 |0.0030395984649658203 |
----------------------------------------------------------pseudo_mini_loss sum 1.2186279296875
Total (block generation + training)time/epoch 7.466747497257433
Training time/epoch 0.34905242919921875
Training time without block to device /epoch 0.30289506912231445
Training time without total dataloading part /epoch 0.09531807899475098
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 53.41it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.02it/s]100%|██████████| 4/4 [00:00<00:00, 15.52it/s]100%|██████████| 4/4 [00:00<00:00, 15.43it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.97it/s]100%|██████████| 4/4 [00:00<00:00, 17.34it/s]100%|██████████| 4/4 [00:00<00:00, 17.26it/s]
Run 00 | Epoch 00028 | Loss 1.2186 | Train 0.4094 | Val 0.5098 | Test 0.5303
Number of nodes during this epoch:  332812
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16017818450927734  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021769046783447266
range selection method range initialization spend 0.011692285537719727
time for parepare:  0.01953125
local_output_nid generation:  0.011450529098510742
local_in_edges_tensor generation:  0.010156393051147461
mini_batch_src_global generation:  0.013637304306030273
r_  generation:  0.18480610847473145
local_output_nid generation:  0.012487173080444336
local_in_edges_tensor generation:  0.007330656051635742
mini_batch_src_global generation:  0.017940044403076172
r_  generation:  0.18444275856018066
----------------------check_connections_block total spend ----------------------------- 0.5340523719787598
generate_one_block  0.19948959350585938
generate_one_block  0.20137262344360352
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03462791442871094
gen group dst list time:  0.007296323776245117
time for parepare:  0.020067214965820312
local_output_nid generation:  0.018023014068603516
local_in_edges_tensor generation:  0.03002166748046875
mini_batch_src_global generation:  0.04818558692932129
r_  generation:  0.4943535327911377
local_output_nid generation:  0.025854110717773438
local_in_edges_tensor generation:  0.02701282501220703
mini_batch_src_global generation:  0.05560469627380371
r_  generation:  0.5043363571166992
----------------------check_connections_block total spend ----------------------------- 1.4402995109558105
generate_one_block  0.6274635791778564
generate_one_block  0.6291909217834473
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025724411010742188
gen group dst list time:  0.012583255767822266
time for parepare:  0.018805265426635742
local_output_nid generation:  0.02190399169921875
local_in_edges_tensor generation:  0.03745126724243164
mini_batch_src_global generation:  0.04918050765991211
r_  generation:  0.5107343196868896
local_output_nid generation:  0.033242225646972656
local_in_edges_tensor generation:  0.04073071479797363
mini_batch_src_global generation:  0.05629277229309082
r_  generation:  0.5230011940002441
----------------------check_connections_block total spend ----------------------------- 1.5153169631958008
generate_one_block  0.6438238620758057
generate_one_block  0.6551556587219238
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16017818450927734  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

connection checking time:  2.9556164741516113
block generation total time  2.555634021759033
average batch blocks generation time:  1.2778170108795166
block dataloader generation time/epoch 7.140768766403198
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11674833297729492  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2855291366577148  GigaBytes
Max Memory Allocated: 1.5376839637756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11650228500366211  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2804222106933594  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03973841667175293 |0.017796874046325684 |0.003922224044799805 |0.0004955530166625977 |0.04107189178466797 |0.0013377666473388672 |
----------------------------------------------------------pseudo_mini_loss sum 1.205545425415039
Total (block generation + training)time/epoch 7.469354140758514
Training time/epoch 0.3140270709991455
Training time without block to device /epoch 0.27843332290649414
Training time without total dataloading part /epoch 0.09231710433959961
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 60.33it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.31it/s]100%|██████████| 4/4 [00:00<00:00, 16.59it/s]100%|██████████| 4/4 [00:00<00:00, 16.37it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.06it/s]100%|██████████| 4/4 [00:00<00:00, 18.64it/s]
Run 00 | Epoch 00029 | Loss 1.2055 | Train 0.4138 | Val 0.5110 | Test 0.5277
Number of nodes during this epoch:  332934
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1601705551147461  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02019667625427246
range selection method range initialization spend 0.011761188507080078
time for parepare:  0.019061803817749023
local_output_nid generation:  0.010947704315185547
local_in_edges_tensor generation:  0.008629798889160156
mini_batch_src_global generation:  0.013545751571655273
r_  generation:  0.17497992515563965
local_output_nid generation:  0.012600898742675781
local_in_edges_tensor generation:  0.006352901458740234
mini_batch_src_global generation:  0.017035961151123047
r_  generation:  0.18453431129455566
----------------------check_connections_block total spend ----------------------------- 0.5245397090911865
generate_one_block  0.19764089584350586
generate_one_block  0.2019035816192627
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03684258460998535
gen group dst list time:  0.007295131683349609
time for parepare:  0.019907712936401367
local_output_nid generation:  0.017764568328857422
local_in_edges_tensor generation:  0.036986589431762695
mini_batch_src_global generation:  0.04584550857543945
r_  generation:  0.49134254455566406
local_output_nid generation:  0.025530576705932617
local_in_edges_tensor generation:  0.032320499420166016
mini_batch_src_global generation:  0.055448293685913086
r_  generation:  0.4987497329711914
----------------------check_connections_block total spend ----------------------------- 1.4431893825531006
generate_one_block  0.6284451484680176
generate_one_block  0.6249368190765381
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028608083724975586
gen group dst list time:  0.01265096664428711
time for parepare:  0.018822431564331055
local_output_nid generation:  0.021835803985595703
local_in_edges_tensor generation:  0.03419804573059082
mini_batch_src_global generation:  0.04640483856201172
r_  generation:  0.5106215476989746
local_output_nid generation:  0.03165292739868164
local_in_edges_tensor generation:  0.03814196586608887
mini_batch_src_global generation:  0.056806325912475586
r_  generation:  0.5202102661132812
----------------------check_connections_block total spend ----------------------------- 1.5025098323822021
generate_one_block  0.6427373886108398
generate_one_block  0.6462485790252686
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1601705551147461  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  2.9456992149353027
block generation total time  2.542367935180664
average batch blocks generation time:  1.271183967590332
block dataloader generation time/epoch 7.142991656348819
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11676549911499023  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.28255033493042  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11644458770751953  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.280503273010254  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08347737789154053 |0.01587545871734619 |0.003950357437133789 |0.0005114078521728516 |0.0037381649017333984 |0.0013179779052734375 |
----------------------------------------------------------pseudo_mini_loss sum 1.200542688369751
Total (block generation + training)time/epoch 7.471124399276007
Training time/epoch 0.3189427852630615
Training time without block to device /epoch 0.28719186782836914
Training time without total dataloading part /epoch 0.017717838287353516
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 56.20it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.96it/s]100%|██████████| 4/4 [00:00<00:00, 15.30it/s]100%|██████████| 4/4 [00:00<00:00, 15.24it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.90it/s]100%|██████████| 4/4 [00:00<00:00, 17.38it/s]100%|██████████| 4/4 [00:00<00:00, 17.28it/s]
Run 00 | Epoch 00030 | Loss 1.2005 | Train 0.4151 | Val 0.5110 | Test 0.5247
Number of nodes during this epoch:  332797
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16109037399291992  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.016490459442138672
range selection method range initialization spend 0.011770963668823242
time for parepare:  0.017127513885498047
local_output_nid generation:  0.010518789291381836
local_in_edges_tensor generation:  0.008182048797607422
mini_batch_src_global generation:  0.013626337051391602
r_  generation:  0.16891217231750488
local_output_nid generation:  0.011637210845947266
local_in_edges_tensor generation:  0.005791902542114258
mini_batch_src_global generation:  0.017119169235229492
r_  generation:  0.18045282363891602
----------------------check_connections_block total spend ----------------------------- 0.5025177001953125
generate_one_block  0.19719314575195312
generate_one_block  0.19875884056091309
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029050350189208984
gen group dst list time:  0.007176876068115234
time for parepare:  0.019849777221679688
local_output_nid generation:  0.01745891571044922
local_in_edges_tensor generation:  0.03000354766845703
mini_batch_src_global generation:  0.04584908485412598
r_  generation:  0.48571300506591797
local_output_nid generation:  0.026185274124145508
local_in_edges_tensor generation:  0.028275489807128906
mini_batch_src_global generation:  0.05575442314147949
r_  generation:  0.49882960319519043
----------------------check_connections_block total spend ----------------------------- 1.4223875999450684
generate_one_block  0.6279933452606201
generate_one_block  0.6272225379943848
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025348186492919922
gen group dst list time:  0.012629270553588867
time for parepare:  0.019077062606811523
local_output_nid generation:  0.02191019058227539
local_in_edges_tensor generation:  0.03338503837585449
mini_batch_src_global generation:  0.04608774185180664
r_  generation:  0.5135838985443115
local_output_nid generation:  0.03236746788024902
local_in_edges_tensor generation:  0.032575368881225586
mini_batch_src_global generation:  0.05633544921875
r_  generation:  0.5324866771697998
----------------------check_connections_block total spend ----------------------------- 1.512686014175415
generate_one_block  0.6485214233398438
generate_one_block  0.6410322189331055
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16109037399291992  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  2.9350736141204834
block generation total time  2.544769525527954
average batch blocks generation time:  1.272384762763977
block dataloader generation time/epoch 7.141249483281916
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11675214767456055  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2822113037109375  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11654424667358398  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2807927131652832  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07512426376342773 |0.01773059368133545 |0.003833293914794922 |0.0005013942718505859 |0.003610372543334961 |0.0015785694122314453 |
----------------------------------------------------------pseudo_mini_loss sum 1.187790870666504
Total (block generation + training)time/epoch 7.469075549732555
Training time/epoch 0.3213064670562744
Training time without block to device /epoch 0.2858452796936035
Training time without total dataloading part /epoch 0.017468690872192383
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 64.57it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.01it/s]100%|██████████| 4/4 [00:00<00:00, 14.86it/s]100%|██████████| 4/4 [00:00<00:00, 14.87it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.35it/s]100%|██████████| 4/4 [00:00<00:00, 16.88it/s]100%|██████████| 4/4 [00:00<00:00, 16.93it/s]
Run 00 | Epoch 00031 | Loss 1.1878 | Train 0.4145 | Val 0.5097 | Test 0.5192
Number of nodes during this epoch:  332824
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16109514236450195  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019900083541870117
range selection method range initialization spend 0.01201629638671875
time for parepare:  0.016725540161132812
local_output_nid generation:  0.010557413101196289
local_in_edges_tensor generation:  0.010171651840209961
mini_batch_src_global generation:  0.013879537582397461
r_  generation:  0.16916680335998535
local_output_nid generation:  0.011725187301635742
local_in_edges_tensor generation:  0.005845546722412109
mini_batch_src_global generation:  0.01772594451904297
r_  generation:  0.17791271209716797
----------------------check_connections_block total spend ----------------------------- 0.5032193660736084
generate_one_block  0.19989562034606934
generate_one_block  0.2014303207397461
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03100442886352539
gen group dst list time:  0.007009267807006836
time for parepare:  0.01987457275390625
local_output_nid generation:  0.01761603355407715
local_in_edges_tensor generation:  0.03188920021057129
mini_batch_src_global generation:  0.047847747802734375
r_  generation:  0.4870297908782959
local_output_nid generation:  0.025561809539794922
local_in_edges_tensor generation:  0.03397846221923828
mini_batch_src_global generation:  0.055785417556762695
r_  generation:  0.5075669288635254
----------------------check_connections_block total spend ----------------------------- 1.4428472518920898
generate_one_block  0.6286187171936035
generate_one_block  0.636786937713623
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03413224220275879
gen group dst list time:  0.012521743774414062
time for parepare:  0.019590139389038086
local_output_nid generation:  0.02338886260986328
local_in_edges_tensor generation:  0.035121917724609375
mini_batch_src_global generation:  0.04850935935974121
r_  generation:  0.5613744258880615
local_output_nid generation:  0.0311734676361084
local_in_edges_tensor generation:  0.04599618911743164
mini_batch_src_global generation:  0.06184267997741699
r_  generation:  0.5502607822418213
----------------------check_connections_block total spend ----------------------------- 1.6287751197814941
generate_one_block  0.6631560325622559
generate_one_block  0.6597185134887695
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16109514236450195  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  3.071622371673584
block generation total time  2.588280200958252
average batch blocks generation time:  1.294140100479126
block dataloader generation time/epoch 7.1453934545102324
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11681509017944336  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.282327651977539  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11637639999389648  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2802109718322754  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09269142150878906 |0.02460336685180664 |0.003826618194580078 |0.04381716251373291 |0.0036464929580688477 |0.0019669532775878906 |
----------------------------------------------------------pseudo_mini_loss sum 1.18074369430542
Total (block generation + training)time/epoch 7.476529815922612
Training time/epoch 0.40381765365600586
Training time without block to device /epoch 0.3546109199523926
Training time without total dataloading part /epoch 0.10454750061035156
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 53.27it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.10it/s]100%|██████████| 4/4 [00:00<00:00, 15.46it/s]100%|██████████| 4/4 [00:00<00:00, 15.39it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.18it/s]100%|██████████| 4/4 [00:00<00:00, 17.54it/s]100%|██████████| 4/4 [00:00<00:00, 17.47it/s]
Run 00 | Epoch 00032 | Loss 1.1807 | Train 0.4140 | Val 0.5083 | Test 0.5164
Number of nodes during this epoch:  332801
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1610255241394043  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.030425548553466797
range selection method range initialization spend 0.011774539947509766
time for parepare:  0.01683664321899414
local_output_nid generation:  0.01087498664855957
local_in_edges_tensor generation:  0.01210331916809082
mini_batch_src_global generation:  0.014328718185424805
r_  generation:  0.1694774627685547
local_output_nid generation:  0.012034416198730469
local_in_edges_tensor generation:  0.005745887756347656
mini_batch_src_global generation:  0.017267704010009766
r_  generation:  0.18489718437194824
----------------------check_connections_block total spend ----------------------------- 0.5133662223815918
generate_one_block  0.20173263549804688
generate_one_block  0.20366549491882324
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.031583309173583984
gen group dst list time:  0.0069675445556640625
time for parepare:  0.019895553588867188
local_output_nid generation:  0.020183801651000977
local_in_edges_tensor generation:  0.03621172904968262
mini_batch_src_global generation:  0.04734301567077637
r_  generation:  0.49626660346984863
local_output_nid generation:  0.027710914611816406
local_in_edges_tensor generation:  0.031426191329956055
mini_batch_src_global generation:  0.0581507682800293
r_  generation:  0.5386395454406738
----------------------check_connections_block total spend ----------------------------- 1.499903678894043
generate_one_block  0.6477828025817871
generate_one_block  0.638850212097168
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.031206130981445312
gen group dst list time:  0.01365518569946289
time for parepare:  0.019822359085083008
local_output_nid generation:  0.022309064865112305
local_in_edges_tensor generation:  0.044586181640625
mini_batch_src_global generation:  0.046057701110839844
r_  generation:  0.5072860717773438
local_output_nid generation:  0.03243517875671387
local_in_edges_tensor generation:  0.043021202087402344
mini_batch_src_global generation:  0.056826114654541016
r_  generation:  0.5213394165039062
----------------------check_connections_block total spend ----------------------------- 1.5164551734924316
generate_one_block  0.6316297054290771
generate_one_block  0.6541035175323486
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1610255241394043  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  3.0163588523864746
block generation total time  2.572366237640381
average batch blocks generation time:  1.2861831188201904
block dataloader generation time/epoch 7.147139519453049
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11676168441772461  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2823290824890137  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1164541244506836  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2802791595458984  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08896291255950928 |0.02248060703277588 |0.0038880109786987305 |0.0005005598068237305 |0.0027599334716796875 |0.002217531204223633 |
----------------------------------------------------------pseudo_mini_loss sum 1.1743978261947632
Total (block generation + training)time/epoch 7.478798637787501
Training time/epoch 0.34354138374328613
Training time without block to device /epoch 0.2985801696777344
Training time without total dataloading part /epoch 0.01651453971862793
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 53.66it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.90it/s]100%|██████████| 4/4 [00:00<00:00, 12.68it/s]100%|██████████| 4/4 [00:00<00:00, 12.55it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.28it/s]100%|██████████| 4/4 [00:00<00:00, 17.29it/s]100%|██████████| 4/4 [00:00<00:00, 17.27it/s]
Run 00 | Epoch 00033 | Loss 1.1744 | Train 0.4134 | Val 0.5060 | Test 0.5148
Number of nodes during this epoch:  332844
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1601705551147461  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019259214401245117
range selection method range initialization spend 0.012285470962524414
time for parepare:  0.01720738410949707
local_output_nid generation:  0.010597705841064453
local_in_edges_tensor generation:  0.010598182678222656
mini_batch_src_global generation:  0.014250516891479492
r_  generation:  0.16672110557556152
local_output_nid generation:  0.011764764785766602
local_in_edges_tensor generation:  0.006369113922119141
mini_batch_src_global generation:  0.017486095428466797
r_  generation:  0.18276000022888184
----------------------check_connections_block total spend ----------------------------- 0.5080163478851318
generate_one_block  0.19623994827270508
generate_one_block  0.19959759712219238
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030875205993652344
gen group dst list time:  0.007073163986206055
time for parepare:  0.021810531616210938
local_output_nid generation:  0.01813960075378418
local_in_edges_tensor generation:  0.035518646240234375
mini_batch_src_global generation:  0.04558253288269043
r_  generation:  0.48752379417419434
local_output_nid generation:  0.025884389877319336
local_in_edges_tensor generation:  0.03147530555725098
mini_batch_src_global generation:  0.055174827575683594
r_  generation:  0.5073387622833252
----------------------check_connections_block total spend ----------------------------- 1.4427287578582764
generate_one_block  0.6277658939361572
generate_one_block  0.6384649276733398
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.024901151657104492
gen group dst list time:  0.012640953063964844
time for parepare:  0.018709182739257812
local_output_nid generation:  0.022751569747924805
local_in_edges_tensor generation:  0.03313398361206055
mini_batch_src_global generation:  0.04620051383972168
r_  generation:  0.5184626579284668
local_output_nid generation:  0.03330636024475098
local_in_edges_tensor generation:  0.03694772720336914
mini_batch_src_global generation:  0.056371450424194336
r_  generation:  0.5266189575195312
----------------------check_connections_block total spend ----------------------------- 1.5177867412567139
generate_one_block  0.6448719501495361
generate_one_block  0.6724321842193604
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1601705551147461  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  2.9605154991149902
block generation total time  2.5835349559783936
average batch blocks generation time:  1.2917674779891968
block dataloader generation time/epoch 7.149324922561646
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11672735214233398  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2823166847229004  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11652231216430664  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2803406715393066  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08579707145690918 |0.02477717399597168 |0.004270195960998535 |0.0005013942718505859 |0.0032715797424316406 |0.002226591110229492 |
----------------------------------------------------------pseudo_mini_loss sum 1.1646769046783447
Total (block generation + training)time/epoch 7.481893129348755
Training time/epoch 0.354290246963501
Training time without block to device /epoch 0.3047358989715576
Training time without total dataloading part /epoch 0.018312931060791016
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 50.43it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.99it/s]100%|██████████| 4/4 [00:00<00:00, 15.33it/s]100%|██████████| 4/4 [00:00<00:00, 15.26it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.33it/s]100%|██████████| 4/4 [00:00<00:00, 17.31it/s]100%|██████████| 4/4 [00:00<00:00, 17.30it/s]
Run 00 | Epoch 00034 | Loss 1.1647 | Train 0.4122 | Val 0.5055 | Test 0.5139
Number of nodes during this epoch:  332877
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1611313819885254  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018271207809448242
range selection method range initialization spend 0.012165069580078125
time for parepare:  0.01706552505493164
local_output_nid generation:  0.010688304901123047
local_in_edges_tensor generation:  0.01189565658569336
mini_batch_src_global generation:  0.014223814010620117
r_  generation:  0.16881132125854492
local_output_nid generation:  0.01167917251586914
local_in_edges_tensor generation:  0.005836009979248047
mini_batch_src_global generation:  0.017277240753173828
r_  generation:  0.18111968040466309
----------------------check_connections_block total spend ----------------------------- 0.508002519607544
generate_one_block  0.1962425708770752
generate_one_block  0.20137977600097656
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03737688064575195
gen group dst list time:  0.007214546203613281
time for parepare:  0.02024245262145996
local_output_nid generation:  0.017863988876342773
local_in_edges_tensor generation:  0.029468774795532227
mini_batch_src_global generation:  0.0469815731048584
r_  generation:  0.48711299896240234
local_output_nid generation:  0.025792598724365234
local_in_edges_tensor generation:  0.027260541915893555
mini_batch_src_global generation:  0.055353641510009766
r_  generation:  0.5126211643218994
----------------------check_connections_block total spend ----------------------------- 1.4389514923095703
generate_one_block  0.6397981643676758
generate_one_block  0.6522018909454346
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02828192710876465
gen group dst list time:  0.018611431121826172
time for parepare:  0.021033525466918945
local_output_nid generation:  0.025281190872192383
local_in_edges_tensor generation:  0.04576992988586426
mini_batch_src_global generation:  0.05219411849975586
r_  generation:  0.5188572406768799
local_output_nid generation:  0.03229403495788574
local_in_edges_tensor generation:  0.05272555351257324
mini_batch_src_global generation:  0.05698752403259277
r_  generation:  0.5288100242614746
----------------------check_connections_block total spend ----------------------------- 1.557861566543579
generate_one_block  0.6610641479492188
generate_one_block  0.6472599506378174
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1611313819885254  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  2.9968130588531494
block generation total time  2.6003241539001465
average batch blocks generation time:  1.3001620769500732
block dataloader generation time/epoch 7.153964042663574
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11674356460571289  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2821788787841797  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11650419235229492  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2806148529052734  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08469116687774658 |0.023125052452087402 |0.004113197326660156 |0.0004949569702148438 |0.002650618553161621 |0.0021867752075195312 |
----------------------------------------------------------pseudo_mini_loss sum 1.1537729501724243
Total (block generation + training)time/epoch 7.4867376914391155
Training time/epoch 0.3377652168273926
Training time without block to device /epoch 0.2915151119232178
Training time without total dataloading part /epoch 0.016704320907592773
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 58.57it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.91it/s]100%|██████████| 4/4 [00:00<00:00, 15.36it/s]100%|██████████| 4/4 [00:00<00:00, 15.28it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.96it/s]100%|██████████| 4/4 [00:00<00:00, 17.56it/s]100%|██████████| 4/4 [00:00<00:00, 17.45it/s]
Run 00 | Epoch 00035 | Loss 1.1538 | Train 0.4114 | Val 0.5044 | Test 0.5134
Number of nodes during this epoch:  332788
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1611495018005371  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021665334701538086
range selection method range initialization spend 0.011788606643676758
time for parepare:  0.01702880859375
local_output_nid generation:  0.010600090026855469
local_in_edges_tensor generation:  0.008340597152709961
mini_batch_src_global generation:  0.013377189636230469
r_  generation:  0.16984272003173828
local_output_nid generation:  0.011682987213134766
local_in_edges_tensor generation:  0.006376981735229492
mini_batch_src_global generation:  0.017399072647094727
r_  generation:  0.18570971488952637
----------------------check_connections_block total spend ----------------------------- 0.5101914405822754
generate_one_block  0.20279812812805176
generate_one_block  0.1999194622039795
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03375697135925293
gen group dst list time:  0.007195949554443359
time for parepare:  0.020090818405151367
local_output_nid generation:  0.018023967742919922
local_in_edges_tensor generation:  0.03170943260192871
mini_batch_src_global generation:  0.044641733169555664
r_  generation:  0.4887809753417969
local_output_nid generation:  0.025981426239013672
local_in_edges_tensor generation:  0.035095930099487305
mini_batch_src_global generation:  0.05590963363647461
r_  generation:  0.5066235065460205
----------------------check_connections_block total spend ----------------------------- 1.4426946640014648
generate_one_block  0.6189994812011719
generate_one_block  0.6283223628997803
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02436375617980957
gen group dst list time:  0.012542963027954102
time for parepare:  0.019156455993652344
local_output_nid generation:  0.02269721031188965
local_in_edges_tensor generation:  0.037375450134277344
mini_batch_src_global generation:  0.04944968223571777
r_  generation:  0.5221860408782959
local_output_nid generation:  0.03163743019104004
local_in_edges_tensor generation:  0.040143489837646484
mini_batch_src_global generation:  0.05697226524353027
r_  generation:  0.5223748683929443
----------------------check_connections_block total spend ----------------------------- 1.5243089199066162
generate_one_block  0.6463503837585449
generate_one_block  0.6560642719268799
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1611495018005371  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  2.967003583908081
block generation total time  2.549736499786377
average batch blocks generation time:  1.2748682498931885
block dataloader generation time/epoch 7.1542478402455645
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11670637130737305  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.282289981842041  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11651229858398438  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.280919075012207  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08254015445709229 |0.017986297607421875 |0.0040853023529052734 |0.0005152225494384766 |0.0035277605056762695 |0.001962900161743164 |
----------------------------------------------------------pseudo_mini_loss sum 1.1477158069610596
Total (block generation + training)time/epoch 7.4868565400441485
Training time/epoch 0.32817769050598145
Training time without block to device /epoch 0.2922050952911377
Training time without total dataloading part /epoch 0.018219470977783203
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 50.23it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.78it/s]100%|██████████| 4/4 [00:00<00:00, 12.45it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.03it/s]100%|██████████| 4/4 [00:00<00:00, 17.26it/s]100%|██████████| 4/4 [00:00<00:00, 17.21it/s]
Run 00 | Epoch 00036 | Loss 1.1477 | Train 0.4104 | Val 0.5035 | Test 0.5126
Number of nodes during this epoch:  332756
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16121482849121094  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020745277404785156
range selection method range initialization spend 0.012421131134033203
time for parepare:  0.016722917556762695
local_output_nid generation:  0.01053309440612793
local_in_edges_tensor generation:  0.012205839157104492
mini_batch_src_global generation:  0.013272523880004883
r_  generation:  0.16931748390197754
local_output_nid generation:  0.012173652648925781
local_in_edges_tensor generation:  0.007725715637207031
mini_batch_src_global generation:  0.017064809799194336
r_  generation:  0.18531513214111328
----------------------check_connections_block total spend ----------------------------- 0.5144164562225342
generate_one_block  0.1968088150024414
generate_one_block  0.1983041763305664
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029698848724365234
gen group dst list time:  0.007078886032104492
time for parepare:  0.019653797149658203
local_output_nid generation:  0.018222332000732422
local_in_edges_tensor generation:  0.041773080825805664
mini_batch_src_global generation:  0.04733133316040039
r_  generation:  0.4870266914367676
local_output_nid generation:  0.02605724334716797
local_in_edges_tensor generation:  0.031216859817504883
mini_batch_src_global generation:  0.05525970458984375
r_  generation:  0.5087494850158691
----------------------check_connections_block total spend ----------------------------- 1.4487276077270508
generate_one_block  0.6339056491851807
generate_one_block  0.6297006607055664
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.026500940322875977
gen group dst list time:  0.01229715347290039
time for parepare:  0.01871323585510254
local_output_nid generation:  0.022288799285888672
local_in_edges_tensor generation:  0.03140997886657715
mini_batch_src_global generation:  0.047226667404174805
r_  generation:  0.5087311267852783
local_output_nid generation:  0.031783103942871094
local_in_edges_tensor generation:  0.03710436820983887
mini_batch_src_global generation:  0.05678248405456543
r_  generation:  0.5174005031585693
----------------------check_connections_block total spend ----------------------------- 1.4930858612060547
generate_one_block  0.6350340843200684
generate_one_block  0.6423046588897705
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16121482849121094  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  2.9418134689331055
block generation total time  2.540945053100586
average batch blocks generation time:  1.270472526550293
block dataloader generation time/epoch 7.153642850262778
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11674928665161133  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.281935691833496  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1165609359741211  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2811174392700195  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08653807640075684 |0.01612246036529541 |0.004586696624755859 |0.000553131103515625 |0.00252532958984375 |0.0018672943115234375 |
----------------------------------------------------------pseudo_mini_loss sum 1.1460705995559692
Total (block generation + training)time/epoch 7.486019824232374
Training time/epoch 0.32597947120666504
Training time without block to device /epoch 0.2937345504760742
Training time without total dataloading part /epoch 0.017197608947753906
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 63.48it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.23it/s]100%|██████████| 4/4 [00:00<00:00, 15.57it/s]100%|██████████| 4/4 [00:00<00:00, 15.50it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.14it/s]100%|██████████| 4/4 [00:00<00:00, 17.87it/s]100%|██████████| 4/4 [00:00<00:00, 17.73it/s]
Run 00 | Epoch 00037 | Loss 1.1461 | Train 0.4095 | Val 0.5022 | Test 0.5118
Number of nodes during this epoch:  332882
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16108179092407227  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01745915412902832
range selection method range initialization spend 0.011825323104858398
time for parepare:  0.01679396629333496
local_output_nid generation:  0.01064157485961914
local_in_edges_tensor generation:  0.008005142211914062
mini_batch_src_global generation:  0.013286828994750977
r_  generation:  0.16895127296447754
local_output_nid generation:  0.011831998825073242
local_in_edges_tensor generation:  0.005865812301635742
mini_batch_src_global generation:  0.017520427703857422
r_  generation:  0.1813807487487793
----------------------check_connections_block total spend ----------------------------- 0.5036993026733398
generate_one_block  0.19562125205993652
generate_one_block  0.2009274959564209
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029287338256835938
gen group dst list time:  0.006990909576416016
time for parepare:  0.01978754997253418
local_output_nid generation:  0.017897605895996094
local_in_edges_tensor generation:  0.027724027633666992
mini_batch_src_global generation:  0.048658132553100586
r_  generation:  0.49701762199401855
local_output_nid generation:  0.027429819107055664
local_in_edges_tensor generation:  0.030675172805786133
mini_batch_src_global generation:  0.056246280670166016
r_  generation:  0.5374858379364014
----------------------check_connections_block total spend ----------------------------- 1.4858059883117676
generate_one_block  0.6437876224517822
generate_one_block  0.6428368091583252
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02914261817932129
gen group dst list time:  0.013526439666748047
time for parepare:  0.018575191497802734
local_output_nid generation:  0.02289271354675293
local_in_edges_tensor generation:  0.04588794708251953
mini_batch_src_global generation:  0.04811406135559082
r_  generation:  0.5055692195892334
local_output_nid generation:  0.031496286392211914
local_in_edges_tensor generation:  0.04468965530395508
mini_batch_src_global generation:  0.056737422943115234
r_  generation:  0.5184130668640137
----------------------check_connections_block total spend ----------------------------- 1.5158789157867432
generate_one_block  0.6408786773681641
generate_one_block  0.6887819766998291
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16108179092407227  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  3.0016849040985107
block generation total time  2.6162850856781006
average batch blocks generation time:  1.3081425428390503
block dataloader generation time/epoch 7.15634535098898
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11672830581665039  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2820444107055664  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11659765243530273  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2811932563781738  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08687996864318848 |0.01752936840057373 |0.004155397415161133 |0.0005106925964355469 |0.0028460025787353516 |0.0013873577117919922 |
----------------------------------------------------------pseudo_mini_loss sum 1.137086272239685
Total (block generation + training)time/epoch 7.48862886428833
Training time/epoch 0.32952260971069336
Training time without block to device /epoch 0.2944638729095459
Training time without total dataloading part /epoch 0.016411542892456055
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 50.50it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.90it/s]100%|██████████| 4/4 [00:00<00:00, 15.28it/s]100%|██████████| 4/4 [00:00<00:00, 15.21it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.29it/s]100%|██████████| 4/4 [00:00<00:00, 17.46it/s]100%|██████████| 4/4 [00:00<00:00, 17.41it/s]
Run 00 | Epoch 00038 | Loss 1.1371 | Train 0.4081 | Val 0.4992 | Test 0.5090
Number of nodes during this epoch:  332819
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16111278533935547  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018798828125
range selection method range initialization spend 0.012176752090454102
time for parepare:  0.01690816879272461
local_output_nid generation:  0.010493993759155273
local_in_edges_tensor generation:  0.009247064590454102
mini_batch_src_global generation:  0.013247013092041016
r_  generation:  0.17007231712341309
local_output_nid generation:  0.011627674102783203
local_in_edges_tensor generation:  0.006404399871826172
mini_batch_src_global generation:  0.01694655418395996
r_  generation:  0.18082427978515625
----------------------check_connections_block total spend ----------------------------- 0.5049285888671875
generate_one_block  0.19667434692382812
generate_one_block  0.19904422760009766
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.032787322998046875
gen group dst list time:  0.007084369659423828
time for parepare:  0.020238637924194336
local_output_nid generation:  0.017388105392456055
local_in_edges_tensor generation:  0.027259111404418945
mini_batch_src_global generation:  0.04462695121765137
r_  generation:  0.49006128311157227
local_output_nid generation:  0.02562880516052246
local_in_edges_tensor generation:  0.02760767936706543
mini_batch_src_global generation:  0.05523562431335449
r_  generation:  0.5050599575042725
----------------------check_connections_block total spend ----------------------------- 1.4294192790985107
generate_one_block  0.6292445659637451
generate_one_block  0.6577513217926025
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03015422821044922
gen group dst list time:  0.013727188110351562
time for parepare:  0.01916646957397461
local_output_nid generation:  0.022329330444335938
local_in_edges_tensor generation:  0.047502756118774414
mini_batch_src_global generation:  0.04886174201965332
r_  generation:  0.5177791118621826
local_output_nid generation:  0.03206372261047363
local_in_edges_tensor generation:  0.04189276695251465
mini_batch_src_global generation:  0.056859493255615234
r_  generation:  0.5271735191345215
----------------------check_connections_block total spend ----------------------------- 1.5397772789001465
generate_one_block  0.6487526893615723
generate_one_block  0.6519420146942139
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16111278533935547  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  2.9691965579986572
block generation total time  2.587690591812134
average batch blocks generation time:  1.293845295906067
block dataloader generation time/epoch 7.157576664288839
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11676168441772461  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2816243171691895  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11653661727905273  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2808184623718262  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08516395092010498 |0.019321322441101074 |0.004120469093322754 |0.0005103349685668945 |0.0027425289154052734 |0.0017008781433105469 |
----------------------------------------------------------pseudo_mini_loss sum 1.131446123123169
Total (block generation + training)time/epoch 7.490135153134664
Training time/epoch 0.3403942584991455
Training time without block to device /epoch 0.30175161361694336
Training time without total dataloading part /epoch 0.01644754409790039
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 54.54it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.76it/s]100%|██████████| 4/4 [00:00<00:00, 15.27it/s]100%|██████████| 4/4 [00:00<00:00, 15.18it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.60it/s]100%|██████████| 4/4 [00:00<00:00, 17.61it/s]100%|██████████| 4/4 [00:00<00:00, 17.59it/s]
Run 00 | Epoch 00039 | Loss 1.1314 | Train 0.4062 | Val 0.4953 | Test 0.5044
Number of nodes during this epoch:  332714
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16107416152954102  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01761484146118164
range selection method range initialization spend 0.011902093887329102
time for parepare:  0.01695990562438965
local_output_nid generation:  0.010977029800415039
local_in_edges_tensor generation:  0.011522054672241211
mini_batch_src_global generation:  0.013104677200317383
r_  generation:  0.1669631004333496
local_output_nid generation:  0.012217521667480469
local_in_edges_tensor generation:  0.007029533386230469
mini_batch_src_global generation:  0.017267227172851562
r_  generation:  0.18237972259521484
----------------------check_connections_block total spend ----------------------------- 0.5094325542449951
generate_one_block  0.19710922241210938
generate_one_block  0.1998898983001709
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02955770492553711
gen group dst list time:  0.007207155227661133
time for parepare:  0.01976799964904785
local_output_nid generation:  0.017756938934326172
local_in_edges_tensor generation:  0.03826761245727539
mini_batch_src_global generation:  0.044724464416503906
r_  generation:  0.4887886047363281
local_output_nid generation:  0.02637028694152832
local_in_edges_tensor generation:  0.026559114456176758
mini_batch_src_global generation:  0.05759596824645996
r_  generation:  0.5007286071777344
----------------------check_connections_block total spend ----------------------------- 1.4333295822143555
generate_one_block  0.6186807155609131
generate_one_block  0.6249332427978516
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02861475944519043
gen group dst list time:  0.012410640716552734
time for parepare:  0.019620656967163086
local_output_nid generation:  0.02347564697265625
local_in_edges_tensor generation:  0.03184700012207031
mini_batch_src_global generation:  0.04527640342712402
r_  generation:  0.5112836360931396
local_output_nid generation:  0.03242015838623047
local_in_edges_tensor generation:  0.033919572830200195
mini_batch_src_global generation:  0.059996843338012695
r_  generation:  0.5212383270263672
----------------------check_connections_block total spend ----------------------------- 1.508230447769165
generate_one_block  0.6554615497589111
generate_one_block  0.6584198474884033
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16107416152954102  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  2.9415600299835205
block generation total time  2.557495355606079
average batch blocks generation time:  1.2787476778030396
block dataloader generation time/epoch 7.156778950845042
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11672353744506836  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2822613716125488  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11653518676757812  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.280728816986084  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07967007160186768 |0.023285746574401855 |0.0037707090377807617 |0.0004885196685791016 |0.003493189811706543 |0.0013108253479003906 |
----------------------------------------------------------pseudo_mini_loss sum 1.1255323886871338
Total (block generation + training)time/epoch 7.489053718505367
Training time/epoch 0.3236865997314453
Training time without block to device /epoch 0.2771151065826416
Training time without total dataloading part /epoch 0.016815662384033203
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 49.84it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.64it/s]100%|██████████| 4/4 [00:00<00:00, 15.12it/s]100%|██████████| 4/4 [00:00<00:00, 15.03it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.95it/s]100%|██████████| 4/4 [00:00<00:00, 17.32it/s]100%|██████████| 4/4 [00:00<00:00, 17.24it/s]
Run 00 | Epoch 00040 | Loss 1.1255 | Train 0.4044 | Val 0.4882 | Test 0.4986
Number of nodes during this epoch:  332843
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16113853454589844  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019597768783569336
range selection method range initialization spend 0.011708259582519531
time for parepare:  0.018139362335205078
local_output_nid generation:  0.010662317276000977
local_in_edges_tensor generation:  0.012808799743652344
mini_batch_src_global generation:  0.013261795043945312
r_  generation:  0.16953611373901367
local_output_nid generation:  0.011786699295043945
local_in_edges_tensor generation:  0.005804538726806641
mini_batch_src_global generation:  0.01710224151611328
r_  generation:  0.18388915061950684
----------------------check_connections_block total spend ----------------------------- 0.5116350650787354
generate_one_block  0.19793343544006348
generate_one_block  0.2002556324005127
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03256511688232422
gen group dst list time:  0.007191181182861328
time for parepare:  0.019728660583496094
local_output_nid generation:  0.01778554916381836
local_in_edges_tensor generation:  0.03635525703430176
mini_batch_src_global generation:  0.04498028755187988
r_  generation:  0.4938948154449463
local_output_nid generation:  0.026086807250976562
local_in_edges_tensor generation:  0.026389360427856445
mini_batch_src_global generation:  0.0556488037109375
r_  generation:  0.5083444118499756
----------------------check_connections_block total spend ----------------------------- 1.4435558319091797
generate_one_block  0.6284084320068359
generate_one_block  0.6285014152526855
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025340557098388672
gen group dst list time:  0.012367010116577148
time for parepare:  0.01895284652709961
local_output_nid generation:  0.022817134857177734
local_in_edges_tensor generation:  0.031693458557128906
mini_batch_src_global generation:  0.04856133460998535
r_  generation:  0.5132348537445068
local_output_nid generation:  0.03254342079162598
local_in_edges_tensor generation:  0.03495216369628906
mini_batch_src_global generation:  0.057127952575683594
r_  generation:  0.5259537696838379
----------------------check_connections_block total spend ----------------------------- 1.5082015991210938
generate_one_block  0.6372008323669434
generate_one_block  0.6330552101135254
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16113853454589844  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  2.9517574310302734
block generation total time  2.5271658897399902
average batch blocks generation time:  1.2635829448699951
block dataloader generation time/epoch 7.155518986284733
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11677408218383789  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2825970649719238  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11639928817749023  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2801012992858887  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08110690116882324 |0.015171527862548828 |0.003886103630065918 |0.0004988908767700195 |0.002469658851623535 |0.0037119388580322266 |
----------------------------------------------------------pseudo_mini_loss sum 1.1194310188293457
Total (block generation + training)time/epoch 7.487464994192123
Training time/epoch 0.32164430618286133
Training time without block to device /epoch 0.29130125045776367
Training time without total dataloading part /epoch 0.017421245574951172
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 51.40it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.04it/s]100%|██████████| 4/4 [00:00<00:00, 15.26it/s]100%|██████████| 4/4 [00:00<00:00, 15.21it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.30it/s]100%|██████████| 4/4 [00:00<00:00, 17.58it/s]100%|██████████| 4/4 [00:00<00:00, 17.52it/s]
Run 00 | Epoch 00041 | Loss 1.1194 | Train 0.4008 | Val 0.4807 | Test 0.4895
Number of nodes during this epoch:  332891
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16011905670166016  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018466949462890625
range selection method range initialization spend 0.012012004852294922
time for parepare:  0.018416404724121094
local_output_nid generation:  0.014151573181152344
local_in_edges_tensor generation:  0.009759187698364258
mini_batch_src_global generation:  0.013353824615478516
r_  generation:  0.17661643028259277
local_output_nid generation:  0.012904644012451172
local_in_edges_tensor generation:  0.007574796676635742
mini_batch_src_global generation:  0.0178987979888916
r_  generation:  0.18843960762023926
----------------------check_connections_block total spend ----------------------------- 0.5316832065582275
generate_one_block  0.20076584815979004
generate_one_block  0.2055988311767578
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04030871391296387
gen group dst list time:  0.007006168365478516
time for parepare:  0.020219802856445312
local_output_nid generation:  0.018091917037963867
local_in_edges_tensor generation:  0.0391080379486084
mini_batch_src_global generation:  0.04685330390930176
r_  generation:  0.4870131015777588
local_output_nid generation:  0.026072978973388672
local_in_edges_tensor generation:  0.035608768463134766
mini_batch_src_global generation:  0.05569028854370117
r_  generation:  0.5030324459075928
----------------------check_connections_block total spend ----------------------------- 1.447505235671997
generate_one_block  0.622469425201416
generate_one_block  0.6285817623138428
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029736757278442383
gen group dst list time:  0.01236581802368164
time for parepare:  0.018557310104370117
local_output_nid generation:  0.022961139678955078
local_in_edges_tensor generation:  0.03411865234375
mini_batch_src_global generation:  0.047577857971191406
r_  generation:  0.5123317241668701
local_output_nid generation:  0.032117366790771484
local_in_edges_tensor generation:  0.040180206298828125
mini_batch_src_global generation:  0.05663323402404785
r_  generation:  0.5203204154968262
----------------------check_connections_block total spend ----------------------------- 1.5074224472045898
generate_one_block  0.6386380195617676
generate_one_block  0.6444673538208008
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16011905670166016  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  2.954927682876587
block generation total time  2.534156560897827
average batch blocks generation time:  1.2670782804489136
block dataloader generation time/epoch 7.156002333669951
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11670064926147461  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.282083511352539  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1166219711303711  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2805171012878418  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08614873886108398 |0.015424966812133789 |0.004079103469848633 |0.0005136728286743164 |0.0031914710998535156 |0.001562356948852539 |
----------------------------------------------------------pseudo_mini_loss sum 1.1152293682098389
Total (block generation + training)time/epoch 7.488099286050508
Training time/epoch 0.33678293228149414
Training time without block to device /epoch 0.30593299865722656
Training time without total dataloading part /epoch 0.01713085174560547
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 57.15it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.67it/s]100%|██████████| 4/4 [00:00<00:00, 15.22it/s]100%|██████████| 4/4 [00:00<00:00, 15.12it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.09it/s]100%|██████████| 4/4 [00:00<00:00, 17.25it/s]100%|██████████| 4/4 [00:00<00:00, 17.21it/s]
Run 00 | Epoch 00042 | Loss 1.1152 | Train 0.3960 | Val 0.4717 | Test 0.4800
Number of nodes during this epoch:  332830
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16027545928955078  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018443584442138672
range selection method range initialization spend 0.011512279510498047
time for parepare:  0.016985416412353516
local_output_nid generation:  0.010644674301147461
local_in_edges_tensor generation:  0.008433103561401367
mini_batch_src_global generation:  0.013406991958618164
r_  generation:  0.17063522338867188
local_output_nid generation:  0.011713981628417969
local_in_edges_tensor generation:  0.005769014358520508
mini_batch_src_global generation:  0.01729416847229004
r_  generation:  0.18502426147460938
----------------------check_connections_block total spend ----------------------------- 0.5102486610412598
generate_one_block  0.20483756065368652
generate_one_block  0.20454740524291992
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03368425369262695
gen group dst list time:  0.007008075714111328
time for parepare:  0.02206707000732422
local_output_nid generation:  0.016904115676879883
local_in_edges_tensor generation:  0.03403282165527344
mini_batch_src_global generation:  0.047054290771484375
r_  generation:  0.5070950984954834
local_output_nid generation:  0.024991273880004883
local_in_edges_tensor generation:  0.03837418556213379
mini_batch_src_global generation:  0.05922126770019531
r_  generation:  0.5033833980560303
----------------------check_connections_block total spend ----------------------------- 1.4786863327026367
generate_one_block  0.6370375156402588
generate_one_block  0.6378834247589111
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.031656742095947266
gen group dst list time:  0.012959480285644531
time for parepare:  0.018726825714111328
local_output_nid generation:  0.022464752197265625
local_in_edges_tensor generation:  0.0408632755279541
mini_batch_src_global generation:  0.04822349548339844
r_  generation:  0.5130317211151123
local_output_nid generation:  0.03210139274597168
local_in_edges_tensor generation:  0.040307044982910156
mini_batch_src_global generation:  0.056652069091796875
r_  generation:  0.5217735767364502
----------------------check_connections_block total spend ----------------------------- 1.516798496246338
generate_one_block  0.6385548114776611
generate_one_block  0.646397590637207
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16027545928955078  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  2.9954848289489746
block generation total time  2.559873342514038
average batch blocks generation time:  1.279936671257019
block dataloader generation time/epoch 7.157571771565606
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11673974990844727  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2818093299865723  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11660289764404297  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2805542945861816  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08830845355987549 |0.01687479019165039 |0.004175543785095215 |0.0005239248275756836 |0.00276029109954834 |0.0019145011901855469 |
----------------------------------------------------------pseudo_mini_loss sum 1.1091089248657227
Total (block generation + training)time/epoch 7.489904088132522
Training time/epoch 0.33995747566223145
Training time without block to device /epoch 0.30620789527893066
Training time without total dataloading part /epoch 0.016834020614624023
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 51.37it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.91it/s]100%|██████████| 4/4 [00:00<00:00, 15.26it/s]100%|██████████| 4/4 [00:00<00:00, 15.19it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.03it/s]100%|██████████| 4/4 [00:00<00:00, 17.56it/s]100%|██████████| 4/4 [00:00<00:00, 17.46it/s]
Run 00 | Epoch 00043 | Loss 1.1091 | Train 0.3905 | Val 0.4597 | Test 0.4667
Number of nodes during this epoch:  332795
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16113758087158203  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.017836332321166992
range selection method range initialization spend 0.011939048767089844
time for parepare:  0.017320871353149414
local_output_nid generation:  0.010791301727294922
local_in_edges_tensor generation:  0.00847768783569336
mini_batch_src_global generation:  0.013576984405517578
r_  generation:  0.16789746284484863
local_output_nid generation:  0.011817693710327148
local_in_edges_tensor generation:  0.007061004638671875
mini_batch_src_global generation:  0.017133235931396484
r_  generation:  0.18172645568847656
----------------------check_connections_block total spend ----------------------------- 0.5049874782562256
generate_one_block  0.19695329666137695
generate_one_block  0.199998140335083
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03376317024230957
gen group dst list time:  0.007019758224487305
time for parepare:  0.020030975341796875
local_output_nid generation:  0.01826167106628418
local_in_edges_tensor generation:  0.029993057250976562
mini_batch_src_global generation:  0.04497241973876953
r_  generation:  0.493532657623291
local_output_nid generation:  0.025688886642456055
local_in_edges_tensor generation:  0.026404619216918945
mini_batch_src_global generation:  0.05706596374511719
r_  generation:  0.5113067626953125
----------------------check_connections_block total spend ----------------------------- 1.4418799877166748
generate_one_block  0.6692409515380859
generate_one_block  0.6392996311187744
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03621649742126465
gen group dst list time:  0.014653205871582031
time for parepare:  0.0183107852935791
local_output_nid generation:  0.02377462387084961
local_in_edges_tensor generation:  0.04256391525268555
mini_batch_src_global generation:  0.046149492263793945
r_  generation:  0.5115513801574707
local_output_nid generation:  0.03161263465881348
local_in_edges_tensor generation:  0.03981423377990723
mini_batch_src_global generation:  0.05624055862426758
r_  generation:  0.5232954025268555
----------------------check_connections_block total spend ----------------------------- 1.5171844959259033
generate_one_block  0.6397109031677246
generate_one_block  0.650005578994751
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16113758087158203  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  2.959064483642578
block generation total time  2.598257064819336
average batch blocks generation time:  1.299128532409668
block dataloader generation time/epoch 7.158608668191093
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11676931381225586  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.28261137008667  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11644744873046875  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2810359001159668  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08545196056365967 |0.023474454879760742 |0.0040128231048583984 |0.0005028247833251953 |0.0034216642379760742 |0.003858327865600586 |
----------------------------------------------------------pseudo_mini_loss sum 1.1067302227020264
Total (block generation + training)time/epoch 7.491451236179897
Training time/epoch 0.3500487804412842
Training time without block to device /epoch 0.3030998706817627
Training time without total dataloading part /epoch 0.019732952117919922
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 51.79it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.84it/s]100%|██████████| 4/4 [00:00<00:00, 15.30it/s]100%|██████████| 4/4 [00:00<00:00, 15.22it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.05it/s]100%|██████████| 4/4 [00:00<00:00, 17.12it/s]100%|██████████| 4/4 [00:00<00:00, 17.09it/s]
Run 00 | Epoch 00044 | Loss 1.1067 | Train 0.3839 | Val 0.4448 | Test 0.4506
Number of nodes during this epoch:  332992
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16100406646728516  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0240175724029541
range selection method range initialization spend 0.011869430541992188
time for parepare:  0.0211031436920166
local_output_nid generation:  0.01079106330871582
local_in_edges_tensor generation:  0.011101484298706055
mini_batch_src_global generation:  0.013691425323486328
r_  generation:  0.1685323715209961
local_output_nid generation:  0.011808633804321289
local_in_edges_tensor generation:  0.00584101676940918
mini_batch_src_global generation:  0.01742720603942871
r_  generation:  0.18140625953674316
----------------------check_connections_block total spend ----------------------------- 0.5116567611694336
generate_one_block  0.20349359512329102
generate_one_block  0.19878125190734863
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04072690010070801
gen group dst list time:  0.0069065093994140625
time for parepare:  0.019933223724365234
local_output_nid generation:  0.0170743465423584
local_in_edges_tensor generation:  0.032428741455078125
mini_batch_src_global generation:  0.04789590835571289
r_  generation:  0.489579439163208
local_output_nid generation:  0.025884151458740234
local_in_edges_tensor generation:  0.031179428100585938
mini_batch_src_global generation:  0.05553627014160156
r_  generation:  0.49870848655700684
----------------------check_connections_block total spend ----------------------------- 1.4333856105804443
generate_one_block  0.6204776763916016
generate_one_block  0.6269245147705078
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025958538055419922
gen group dst list time:  0.01243448257446289
time for parepare:  0.01902604103088379
local_output_nid generation:  0.022906064987182617
local_in_edges_tensor generation:  0.03509712219238281
mini_batch_src_global generation:  0.045281410217285156
r_  generation:  0.5099732875823975
local_output_nid generation:  0.031925201416015625
local_in_edges_tensor generation:  0.04127836227416992
mini_batch_src_global generation:  0.05650138854980469
r_  generation:  0.517770528793335
----------------------check_connections_block total spend ----------------------------- 1.5032086372375488
generate_one_block  0.6329221725463867
generate_one_block  0.6399195194244385
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16100406646728516  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  2.936594247817993
block generation total time  2.5202438831329346
average batch blocks generation time:  1.2601219415664673
block dataloader generation time/epoch 7.158392654524909
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11677312850952148  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2819414138793945  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11657571792602539  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2813596725463867  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08583128452301025 |0.015281081199645996 |0.004801630973815918 |0.0005216598510742188 |0.0027077198028564453 |0.002537250518798828 |
----------------------------------------------------------pseudo_mini_loss sum 1.0983612537384033
Total (block generation + training)time/epoch 7.49136084318161
Training time/epoch 0.3372230529785156
Training time without block to device /epoch 0.30666089057922363
Training time without total dataloading part /epoch 0.018599271774291992
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.96it/s]100%|██████████| 4/4 [00:00<00:00, 29.49it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.42it/s]100%|██████████| 4/4 [00:00<00:00, 12.41it/s]100%|██████████| 4/4 [00:00<00:00, 12.24it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.05it/s]100%|██████████| 4/4 [00:00<00:00, 17.60it/s]100%|██████████| 4/4 [00:00<00:00, 17.65it/s]
Run 00 | Epoch 00045 | Loss 1.0984 | Train 0.3770 | Val 0.4283 | Test 0.4336
Number of nodes during this epoch:  332844
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16104793548583984  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02190852165222168
range selection method range initialization spend 0.012206077575683594
time for parepare:  0.02199554443359375
local_output_nid generation:  0.011134147644042969
local_in_edges_tensor generation:  0.008475303649902344
mini_batch_src_global generation:  0.013537168502807617
r_  generation:  0.17918920516967773
local_output_nid generation:  0.01263570785522461
local_in_edges_tensor generation:  0.0066912174224853516
mini_batch_src_global generation:  0.01840043067932129
r_  generation:  0.18518900871276855
----------------------check_connections_block total spend ----------------------------- 0.5298449993133545
generate_one_block  0.19800686836242676
generate_one_block  0.20222854614257812
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.037776947021484375
gen group dst list time:  0.0069043636322021484
time for parepare:  0.02023172378540039
local_output_nid generation:  0.0176694393157959
local_in_edges_tensor generation:  0.0336909294128418
mini_batch_src_global generation:  0.04810667037963867
r_  generation:  0.49013328552246094
local_output_nid generation:  0.026438236236572266
local_in_edges_tensor generation:  0.037392377853393555
mini_batch_src_global generation:  0.055860042572021484
r_  generation:  0.5089466571807861
----------------------check_connections_block total spend ----------------------------- 1.455099105834961
generate_one_block  0.6302597522735596
generate_one_block  0.6463022232055664
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02785634994506836
gen group dst list time:  0.012452363967895508
time for parepare:  0.020230531692504883
local_output_nid generation:  0.02309274673461914
local_in_edges_tensor generation:  0.03410172462463379
mini_batch_src_global generation:  0.05630683898925781
r_  generation:  0.5163445472717285
local_output_nid generation:  0.031957149505615234
local_in_edges_tensor generation:  0.04623532295227051
mini_batch_src_global generation:  0.0569605827331543
r_  generation:  0.5242788791656494
----------------------check_connections_block total spend ----------------------------- 1.536971092224121
generate_one_block  0.647200345993042
generate_one_block  0.6679446697235107
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16104793548583984  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  2.992070198059082
block generation total time  2.5917069911956787
average batch blocks generation time:  1.2958534955978394
block dataloader generation time/epoch 7.162514995884251
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11674261093139648  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2817330360412598  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1166529655456543  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2812623977661133  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09700024127960205 |0.029637932777404785 |0.003967881202697754 |0.0004966259002685547 |0.004076480865478516 |0.002939462661743164 |
----------------------------------------------------------pseudo_mini_loss sum 1.0940170288085938
Total (block generation + training)time/epoch 7.496766083949321
Training time/epoch 0.3802976608276367
Training time without block to device /epoch 0.32102179527282715
Training time without total dataloading part /epoch 0.020021438598632812
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 47.94it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.02it/s]100%|██████████| 4/4 [00:00<00:00, 15.26it/s]100%|██████████| 4/4 [00:00<00:00, 15.21it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.93it/s]100%|██████████| 4/4 [00:00<00:00, 17.09it/s]100%|██████████| 4/4 [00:00<00:00, 17.05it/s]
Run 00 | Epoch 00046 | Loss 1.0940 | Train 0.3705 | Val 0.4132 | Test 0.4171
Number of nodes during this epoch:  332860
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1611027717590332  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021211624145507812
range selection method range initialization spend 0.01226663589477539
time for parepare:  0.017093658447265625
local_output_nid generation:  0.011189699172973633
local_in_edges_tensor generation:  0.013206958770751953
mini_batch_src_global generation:  0.013798952102661133
r_  generation:  0.16971731185913086
local_output_nid generation:  0.011935234069824219
local_in_edges_tensor generation:  0.005728483200073242
mini_batch_src_global generation:  0.017750024795532227
r_  generation:  0.1816563606262207
----------------------check_connections_block total spend ----------------------------- 0.512610673904419
generate_one_block  0.19882965087890625
generate_one_block  0.19927406311035156
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.033854007720947266
gen group dst list time:  0.0067996978759765625
time for parepare:  0.020015239715576172
local_output_nid generation:  0.01768326759338379
local_in_edges_tensor generation:  0.03548407554626465
mini_batch_src_global generation:  0.04787421226501465
r_  generation:  0.5023574829101562
local_output_nid generation:  0.028164386749267578
local_in_edges_tensor generation:  0.028997421264648438
mini_batch_src_global generation:  0.05588102340698242
r_  generation:  0.5078964233398438
----------------------check_connections_block total spend ----------------------------- 1.462235689163208
generate_one_block  0.6334266662597656
generate_one_block  0.6282072067260742
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02634739875793457
gen group dst list time:  0.012516260147094727
time for parepare:  0.018500566482543945
local_output_nid generation:  0.0230562686920166
local_in_edges_tensor generation:  0.04210305213928223
mini_batch_src_global generation:  0.046564579010009766
r_  generation:  0.5080785751342773
local_output_nid generation:  0.03186202049255371
local_in_edges_tensor generation:  0.033751726150512695
mini_batch_src_global generation:  0.0571897029876709
r_  generation:  0.5254700183868408
----------------------check_connections_block total spend ----------------------------- 1.508711338043213
generate_one_block  0.6397967338562012
generate_one_block  0.6413075923919678
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1611027717590332  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  2.970947027206421
block generation total time  2.542738199234009
average batch blocks generation time:  1.2713690996170044
block dataloader generation time/epoch 7.162881644148576
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11682558059692383  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2824110984802246  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11627769470214844  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2745656967163086  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07246589660644531 |0.015729308128356934 |0.016556978225708008 |0.000514984130859375 |0.0034554004669189453 |0.0038404464721679688 |
----------------------------------------------------------pseudo_mini_loss sum 1.0941188335418701
Total (block generation + training)time/epoch 7.49719408311342
Training time/epoch 0.3364379405975342
Training time without block to device /epoch 0.3049793243408203
Training time without total dataloading part /epoch 0.044895172119140625
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 61.68it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.59it/s]100%|██████████| 4/4 [00:00<00:00, 15.21it/s]100%|██████████| 4/4 [00:00<00:00, 15.09it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.16it/s]100%|██████████| 4/4 [00:00<00:00, 17.53it/s]100%|██████████| 4/4 [00:00<00:00, 17.46it/s]
Run 00 | Epoch 00047 | Loss 1.0941 | Train 0.3646 | Val 0.3992 | Test 0.4023
Number of nodes during this epoch:  332796
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16086053848266602  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02085423469543457
range selection method range initialization spend 0.01207280158996582
time for parepare:  0.019962072372436523
local_output_nid generation:  0.011450529098510742
local_in_edges_tensor generation:  0.009246587753295898
mini_batch_src_global generation:  0.014248371124267578
r_  generation:  0.1802835464477539
local_output_nid generation:  0.012710332870483398
local_in_edges_tensor generation:  0.0058290958404541016
mini_batch_src_global generation:  0.0177915096282959
r_  generation:  0.18247628211975098
----------------------check_connections_block total spend ----------------------------- 0.5256567001342773
generate_one_block  0.1983797550201416
generate_one_block  0.20303845405578613
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04210019111633301
gen group dst list time:  0.006725311279296875
time for parepare:  0.01997852325439453
local_output_nid generation:  0.018164396286010742
local_in_edges_tensor generation:  0.03534245491027832
mini_batch_src_global generation:  0.04799628257751465
r_  generation:  0.4958634376525879
local_output_nid generation:  0.027162790298461914
local_in_edges_tensor generation:  0.03828096389770508
mini_batch_src_global generation:  0.05466175079345703
r_  generation:  0.5067944526672363
----------------------check_connections_block total spend ----------------------------- 1.4578862190246582
generate_one_block  0.6268405914306641
generate_one_block  0.6508493423461914
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.023678302764892578
gen group dst list time:  0.012441158294677734
time for parepare:  0.018431901931762695
local_output_nid generation:  0.023182392120361328
local_in_edges_tensor generation:  0.03426384925842285
mini_batch_src_global generation:  0.04824566841125488
r_  generation:  0.5133495330810547
local_output_nid generation:  0.031987667083740234
local_in_edges_tensor generation:  0.038414955139160156
mini_batch_src_global generation:  0.05591464042663574
r_  generation:  0.5245962142944336
----------------------check_connections_block total spend ----------------------------- 1.5132777690887451
generate_one_block  0.6465485095977783
generate_one_block  0.6557979583740234
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16086053848266602  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  2.9711639881134033
block generation total time  2.5800364017486572
average batch blocks generation time:  1.2900182008743286
block dataloader generation time/epoch 7.164803058673174
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11677694320678711  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2820463180541992  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11656379699707031  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2810611724853516  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08692646026611328 |0.020590543746948242 |0.0040433406829833984 |0.00048732757568359375 |0.0029349327087402344 |0.0026819705963134766 |
----------------------------------------------------------pseudo_mini_loss sum 1.088637113571167
Total (block generation + training)time/epoch 7.499392998524201
Training time/epoch 0.3449897766113281
Training time without block to device /epoch 0.30380868911743164
Training time without total dataloading part /epoch 0.01761317253112793
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 39.71it/s]100%|██████████| 4/4 [00:00<00:00, 39.61it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.97it/s]100%|██████████| 4/4 [00:00<00:00, 15.28it/s]100%|██████████| 4/4 [00:00<00:00, 15.22it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.22it/s]100%|██████████| 4/4 [00:00<00:00, 17.38it/s]100%|██████████| 4/4 [00:00<00:00, 17.34it/s]
Run 00 | Epoch 00048 | Loss 1.0886 | Train 0.3592 | Val 0.3869 | Test 0.3888
Number of nodes during this epoch:  332891
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16101408004760742  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022699832916259766
range selection method range initialization spend 0.011994123458862305
time for parepare:  0.016797780990600586
local_output_nid generation:  0.010977029800415039
local_in_edges_tensor generation:  0.013671875
mini_batch_src_global generation:  0.01675105094909668
r_  generation:  0.16922450065612793
local_output_nid generation:  0.011586904525756836
local_in_edges_tensor generation:  0.008016347885131836
mini_batch_src_global generation:  0.017260313034057617
r_  generation:  0.1861572265625
----------------------check_connections_block total spend ----------------------------- 0.5228531360626221
generate_one_block  0.20736360549926758
generate_one_block  0.20169472694396973
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.040697574615478516
gen group dst list time:  0.0067903995513916016
time for parepare:  0.02032637596130371
local_output_nid generation:  0.0176239013671875
local_in_edges_tensor generation:  0.03888225555419922
mini_batch_src_global generation:  0.04801011085510254
r_  generation:  0.49295878410339355
local_output_nid generation:  0.026317119598388672
local_in_edges_tensor generation:  0.03010869026184082
mini_batch_src_global generation:  0.05572223663330078
r_  generation:  0.5053589344024658
----------------------check_connections_block total spend ----------------------------- 1.450542688369751
generate_one_block  0.6299235820770264
generate_one_block  0.6485292911529541
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03354978561401367
gen group dst list time:  0.017564773559570312
time for parepare:  0.01871490478515625
local_output_nid generation:  0.02372908592224121
local_in_edges_tensor generation:  0.0393071174621582
mini_batch_src_global generation:  0.04895949363708496
r_  generation:  0.5134570598602295
local_output_nid generation:  0.03214263916015625
local_in_edges_tensor generation:  0.04006195068359375
mini_batch_src_global generation:  0.05680108070373535
r_  generation:  0.5239651203155518
----------------------check_connections_block total spend ----------------------------- 1.5233700275421143
generate_one_block  0.6415858268737793
generate_one_block  0.6474413871765137
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16101408004760742  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  2.9739127159118652
block generation total time  2.5674800872802734
average batch blocks generation time:  1.2837400436401367
block dataloader generation time/epoch 7.166865533590316
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11675310134887695  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2819843292236328  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11655521392822266  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2815361022949219  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08281052112579346 |0.02190864086151123 |0.004073739051818848 |0.0005235671997070312 |0.0036925077438354492 |0.003466367721557617 |
----------------------------------------------------------pseudo_mini_loss sum 1.0853737592697144
Total (block generation + training)time/epoch 7.501469409465789
Training time/epoch 0.334993839263916
Training time without block to device /epoch 0.29117655754089355
Training time without total dataloading part /epoch 0.020045995712280273
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 51.05it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.84it/s]100%|██████████| 4/4 [00:00<00:00, 15.24it/s]100%|██████████| 4/4 [00:00<00:00, 15.17it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.14it/s]100%|██████████| 4/4 [00:00<00:00, 17.08it/s]100%|██████████| 4/4 [00:00<00:00, 17.07it/s]
Run 00 | Epoch 00049 | Loss 1.0854 | Train 0.3547 | Val 0.3777 | Test 0.3779
Number of nodes during this epoch:  332818
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1610107421875  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023606061935424805
range selection method range initialization spend 0.011559724807739258
time for parepare:  0.016774654388427734
local_output_nid generation:  0.010947465896606445
local_in_edges_tensor generation:  0.011192083358764648
mini_batch_src_global generation:  0.013763427734375
r_  generation:  0.16787052154541016
local_output_nid generation:  0.011622428894042969
local_in_edges_tensor generation:  0.0064716339111328125
mini_batch_src_global generation:  0.01759171485900879
r_  generation:  0.18008732795715332
----------------------check_connections_block total spend ----------------------------- 0.5066988468170166
generate_one_block  0.1986699104309082
generate_one_block  0.19960737228393555
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030735254287719727
gen group dst list time:  0.006835460662841797
time for parepare:  0.02016925811767578
local_output_nid generation:  0.017681121826171875
local_in_edges_tensor generation:  0.03142595291137695
mini_batch_src_global generation:  0.048090219497680664
r_  generation:  0.49990272521972656
local_output_nid generation:  0.02741694450378418
local_in_edges_tensor generation:  0.030408620834350586
mini_batch_src_global generation:  0.05787062644958496
r_  generation:  0.5067205429077148
----------------------check_connections_block total spend ----------------------------- 1.461906909942627
generate_one_block  0.6689567565917969
generate_one_block  0.6405949592590332
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03730320930480957
gen group dst list time:  0.01454472541809082
time for parepare:  0.020299673080444336
local_output_nid generation:  0.0232851505279541
local_in_edges_tensor generation:  0.046012163162231445
mini_batch_src_global generation:  0.04675626754760742
r_  generation:  0.515617847442627
local_output_nid generation:  0.032759904861450195
local_in_edges_tensor generation:  0.04163789749145508
mini_batch_src_global generation:  0.056703805923461914
r_  generation:  0.5274360179901123
----------------------check_connections_block total spend ----------------------------- 1.537163496017456
generate_one_block  0.6397879123687744
generate_one_block  0.6572451591491699
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1610107421875  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  2.999070405960083
block generation total time  2.6065847873687744
average batch blocks generation time:  1.3032923936843872
block dataloader generation time/epoch 7.169415683281131
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11680173873901367  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2823371887207031  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11639022827148438  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2805347442626953  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09050321578979492 |0.017862319946289062 |0.004118680953979492 |0.0005146265029907227 |0.0035516023635864258 |0.006179332733154297 |
----------------------------------------------------------pseudo_mini_loss sum 1.0772037506103516
Total (block generation + training)time/epoch 7.504275002130648
Training time/epoch 0.34493136405944824
Training time without block to device /epoch 0.3092067241668701
Training time without total dataloading part /epoch 0.022549152374267578
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 55.20it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.15it/s]100%|██████████| 4/4 [00:00<00:00, 15.13it/s]100%|██████████| 4/4 [00:00<00:00, 15.12it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.05it/s]100%|██████████| 4/4 [00:00<00:00, 15.81it/s]100%|██████████| 4/4 [00:00<00:00, 15.97it/s]
Run 00 | Epoch 00050 | Loss 1.0772 | Train 0.3505 | Val 0.3692 | Test 0.3693
Number of nodes during this epoch:  332869
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16105413436889648  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020666837692260742
range selection method range initialization spend 0.013527393341064453
time for parepare:  0.01805853843688965
local_output_nid generation:  0.011066675186157227
local_in_edges_tensor generation:  0.008219003677368164
mini_batch_src_global generation:  0.013638734817504883
r_  generation:  0.1770617961883545
local_output_nid generation:  0.012536287307739258
local_in_edges_tensor generation:  0.006597042083740234
mini_batch_src_global generation:  0.01763319969177246
r_  generation:  0.1836225986480713
----------------------check_connections_block total spend ----------------------------- 0.5242812633514404
generate_one_block  0.20095181465148926
generate_one_block  0.20566630363464355
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03177380561828613
gen group dst list time:  0.006773471832275391
time for parepare:  0.02012324333190918
local_output_nid generation:  0.017443418502807617
local_in_edges_tensor generation:  0.038971900939941406
mini_batch_src_global generation:  0.04817318916320801
r_  generation:  0.49279117584228516
local_output_nid generation:  0.026406526565551758
local_in_edges_tensor generation:  0.03222513198852539
mini_batch_src_global generation:  0.05497479438781738
r_  generation:  0.49894022941589355
----------------------check_connections_block total spend ----------------------------- 1.4471337795257568
generate_one_block  0.6254019737243652
generate_one_block  0.6252732276916504
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02299022674560547
gen group dst list time:  0.012561559677124023
time for parepare:  0.018874645233154297
local_output_nid generation:  0.022103548049926758
local_in_edges_tensor generation:  0.031044483184814453
mini_batch_src_global generation:  0.04861187934875488
r_  generation:  0.5133028030395508
local_output_nid generation:  0.030827045440673828
local_in_edges_tensor generation:  0.03761720657348633
mini_batch_src_global generation:  0.05635881423950195
r_  generation:  0.5242068767547607
----------------------check_connections_block total spend ----------------------------- 1.506957769393921
generate_one_block  0.6435425281524658
generate_one_block  0.6487021446228027
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16105413436889648  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  2.9540915489196777
block generation total time  2.542919874191284
average batch blocks generation time:  1.271459937095642
block dataloader generation time/epoch 7.1698462054842995
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11675786972045898  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2822341918945312  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11642026901245117  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2798104286193848  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08715617656707764 |0.017499685287475586 |0.004113674163818359 |0.0005108118057250977 |0.0025860071182250977 |0.0018863677978515625 |
----------------------------------------------------------pseudo_mini_loss sum 1.075949788093567
Total (block generation + training)time/epoch 7.504619501885914
Training time/epoch 0.3311142921447754
Training time without block to device /epoch 0.2961149215698242
Training time without total dataloading part /epoch 0.016307353973388672
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 46.90it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.05it/s]100%|██████████| 4/4 [00:00<00:00, 15.37it/s]100%|██████████| 4/4 [00:00<00:00, 15.31it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.33it/s]100%|██████████| 4/4 [00:00<00:00, 17.45it/s]100%|██████████| 4/4 [00:00<00:00, 17.41it/s]
Run 00 | Epoch 00051 | Loss 1.0759 | Train 0.3461 | Val 0.3634 | Test 0.3627
Number of nodes during this epoch:  332778
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16016817092895508  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025024890899658203
range selection method range initialization spend 0.01205301284790039
time for parepare:  0.019209861755371094
local_output_nid generation:  0.011235952377319336
local_in_edges_tensor generation:  0.011317014694213867
mini_batch_src_global generation:  0.013545989990234375
r_  generation:  0.17195653915405273
local_output_nid generation:  0.01186823844909668
local_in_edges_tensor generation:  0.005837440490722656
mini_batch_src_global generation:  0.017763853073120117
r_  generation:  0.18413257598876953
----------------------check_connections_block total spend ----------------------------- 0.5179493427276611
generate_one_block  0.20330047607421875
generate_one_block  0.20501279830932617
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03416895866394043
gen group dst list time:  0.0067501068115234375
time for parepare:  0.02134227752685547
local_output_nid generation:  0.018088579177856445
local_in_edges_tensor generation:  0.04353952407836914
mini_batch_src_global generation:  0.04650425910949707
r_  generation:  0.49564027786254883
local_output_nid generation:  0.026483774185180664
local_in_edges_tensor generation:  0.030793190002441406
mini_batch_src_global generation:  0.057938575744628906
r_  generation:  0.5109474658966064
----------------------check_connections_block total spend ----------------------------- 1.4696307182312012
generate_one_block  0.6512956619262695
generate_one_block  0.6443147659301758
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.032752275466918945
gen group dst list time:  0.016009092330932617
time for parepare:  0.01847696304321289
local_output_nid generation:  0.023912429809570312
local_in_edges_tensor generation:  0.042582035064697266
mini_batch_src_global generation:  0.04866600036621094
r_  generation:  0.5135843753814697
local_output_nid generation:  0.032320261001586914
local_in_edges_tensor generation:  0.037256717681884766
mini_batch_src_global generation:  0.056568145751953125
r_  generation:  0.5194525718688965
----------------------check_connections_block total spend ----------------------------- 1.5188307762145996
generate_one_block  0.6399352550506592
generate_one_block  0.6463098526000977
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16016817092895508  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  2.988461494445801
block generation total time  2.581855535507202
average batch blocks generation time:  1.290927767753601
block dataloader generation time/epoch 7.172369724096254
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11673212051391602  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2817273139953613  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11662530899047852  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2811713218688965  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08726334571838379 |0.021686196327209473 |0.004063248634338379 |0.0004912614822387695 |0.002799391746520996 |0.003961324691772461 |
----------------------------------------------------------pseudo_mini_loss sum 1.0703418254852295
Total (block generation + training)time/epoch 7.507477200308512
Training time/epoch 0.3489992618560791
Training time without block to device /epoch 0.30562686920166016
Training time without total dataloading part /epoch 0.01866912841796875
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 52.24it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.66it/s]100%|██████████| 4/4 [00:00<00:00, 15.02it/s]100%|██████████| 4/4 [00:00<00:00, 14.95it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.90it/s]100%|██████████| 4/4 [00:00<00:00, 17.32it/s]100%|██████████| 4/4 [00:00<00:00, 17.24it/s]
Run 00 | Epoch 00052 | Loss 1.0703 | Train 0.3429 | Val 0.3583 | Test 0.3564
Number of nodes during this epoch:  332846
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16109848022460938  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02149796485900879
range selection method range initialization spend 0.011877298355102539
time for parepare:  0.017176151275634766
local_output_nid generation:  0.011373043060302734
local_in_edges_tensor generation:  0.008654356002807617
mini_batch_src_global generation:  0.01374673843383789
r_  generation:  0.1735091209411621
local_output_nid generation:  0.012238264083862305
local_in_edges_tensor generation:  0.01078176498413086
mini_batch_src_global generation:  0.022813081741333008
r_  generation:  0.18927741050720215
----------------------check_connections_block total spend ----------------------------- 0.5334370136260986
generate_one_block  0.20580363273620605
generate_one_block  0.20222258567810059
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03825807571411133
gen group dst list time:  0.006722450256347656
time for parepare:  0.021010398864746094
local_output_nid generation:  0.017390727996826172
local_in_edges_tensor generation:  0.04191732406616211
mini_batch_src_global generation:  0.047837018966674805
r_  generation:  0.48960041999816895
local_output_nid generation:  0.02687358856201172
local_in_edges_tensor generation:  0.034011125564575195
mini_batch_src_global generation:  0.05630660057067871
r_  generation:  0.5003149509429932
----------------------check_connections_block total spend ----------------------------- 1.4543724060058594
generate_one_block  0.625016450881958
generate_one_block  0.6276905536651611
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03633260726928711
gen group dst list time:  0.01259469985961914
time for parepare:  0.019147634506225586
local_output_nid generation:  0.023253202438354492
local_in_edges_tensor generation:  0.038793087005615234
mini_batch_src_global generation:  0.04834342002868652
r_  generation:  0.5177896022796631
local_output_nid generation:  0.03251934051513672
local_in_edges_tensor generation:  0.042546749114990234
mini_batch_src_global generation:  0.0641322135925293
r_  generation:  0.5292677879333496
----------------------check_connections_block total spend ----------------------------- 1.5408761501312256
generate_one_block  0.6524415016174316
generate_one_block  0.662250280380249
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16109848022460938  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  2.995248556137085
block generation total time  2.5673987865448
average batch blocks generation time:  1.2836993932724
block dataloader generation time/epoch 7.174526642669331
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1167445182800293  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2816557884216309  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11661529541015625  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.281019687652588  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08189070224761963 |0.029649853706359863 |0.00402069091796875 |0.0004971027374267578 |0.003282904624938965 |0.0018961429595947266 |
----------------------------------------------------------pseudo_mini_loss sum 1.0685176849365234
Total (block generation + training)time/epoch 7.5098636312918225
Training time/epoch 0.3450663089752197
Training time without block to device /epoch 0.2857666015625
Training time without total dataloading part /epoch 0.017497539520263672
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 55.86it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.85it/s]100%|██████████| 4/4 [00:00<00:00, 15.39it/s]100%|██████████| 4/4 [00:00<00:00, 15.29it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.26it/s]100%|██████████| 4/4 [00:00<00:00, 17.34it/s]100%|██████████| 4/4 [00:00<00:00, 17.30it/s]
Run 00 | Epoch 00053 | Loss 1.0685 | Train 0.3400 | Val 0.3546 | Test 0.3507
Number of nodes during this epoch:  332821
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1610102653503418  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.029441356658935547
range selection method range initialization spend 0.011878013610839844
time for parepare:  0.01683211326599121
local_output_nid generation:  0.011195182800292969
local_in_edges_tensor generation:  0.01141357421875
mini_batch_src_global generation:  0.013577699661254883
r_  generation:  0.16870737075805664
local_output_nid generation:  0.01186227798461914
local_in_edges_tensor generation:  0.006415843963623047
mini_batch_src_global generation:  0.017287254333496094
r_  generation:  0.18056821823120117
----------------------check_connections_block total spend ----------------------------- 0.5081219673156738
generate_one_block  0.1968386173248291
generate_one_block  0.19999074935913086
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04138898849487305
gen group dst list time:  0.006746530532836914
time for parepare:  0.01997232437133789
local_output_nid generation:  0.017808914184570312
local_in_edges_tensor generation:  0.03004622459411621
mini_batch_src_global generation:  0.04767656326293945
r_  generation:  0.48700809478759766
local_output_nid generation:  0.026544809341430664
local_in_edges_tensor generation:  0.03044867515563965
mini_batch_src_global generation:  0.05538034439086914
r_  generation:  0.504995584487915
----------------------check_connections_block total spend ----------------------------- 1.4369418621063232
generate_one_block  0.6276273727416992
generate_one_block  0.6411654949188232
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.024721622467041016
gen group dst list time:  0.012491226196289062
time for parepare:  0.018473386764526367
local_output_nid generation:  0.022863388061523438
local_in_edges_tensor generation:  0.03450155258178711
mini_batch_src_global generation:  0.04597616195678711
r_  generation:  0.5139153003692627
local_output_nid generation:  0.03241539001464844
local_in_edges_tensor generation:  0.03231167793273926
mini_batch_src_global generation:  0.05710124969482422
r_  generation:  0.5168428421020508
----------------------check_connections_block total spend ----------------------------- 1.4996566772460938
generate_one_block  0.6372404098510742
generate_one_block  0.651921272277832
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1610102653503418  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  2.936598539352417
block generation total time  2.5579545497894287
average batch blocks generation time:  1.2789772748947144
block dataloader generation time/epoch 7.174113210042318
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11674356460571289  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2820816040039062  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11656999588012695  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2812714576721191  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08650624752044678 |0.015368819236755371 |0.0038657188415527344 |0.00049591064453125 |0.0026613473892211914 |0.0017466545104980469 |
----------------------------------------------------------pseudo_mini_loss sum 1.0681250095367432
Total (block generation + training)time/epoch 7.509238322575887
Training time/epoch 0.3257110118865967
Training time without block to device /epoch 0.29497337341308594
Training time without total dataloading part /epoch 0.0157926082611084
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 63.09it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.76it/s]100%|██████████| 4/4 [00:00<00:00, 14.79it/s]100%|██████████| 4/4 [00:00<00:00, 14.77it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.50it/s]100%|██████████| 4/4 [00:00<00:00, 16.46it/s]100%|██████████| 4/4 [00:00<00:00, 16.30it/s]
Run 00 | Epoch 00054 | Loss 1.0681 | Train 0.3371 | Val 0.3504 | Test 0.3446
Number of nodes during this epoch:  332866
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16117382049560547  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02171802520751953
range selection method range initialization spend 0.012165546417236328
time for parepare:  0.018419504165649414
local_output_nid generation:  0.011040449142456055
local_in_edges_tensor generation:  0.009359598159790039
mini_batch_src_global generation:  0.013136148452758789
r_  generation:  0.16804742813110352
local_output_nid generation:  0.013783931732177734
local_in_edges_tensor generation:  0.008131980895996094
mini_batch_src_global generation:  0.017386913299560547
r_  generation:  0.1831192970275879
----------------------check_connections_block total spend ----------------------------- 0.5136654376983643
generate_one_block  0.20476007461547852
generate_one_block  0.20067381858825684
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02966618537902832
gen group dst list time:  0.006795406341552734
time for parepare:  0.0195772647857666
local_output_nid generation:  0.01740288734436035
local_in_edges_tensor generation:  0.03357672691345215
mini_batch_src_global generation:  0.05245375633239746
r_  generation:  0.48816752433776855
local_output_nid generation:  0.02683091163635254
local_in_edges_tensor generation:  0.03143000602722168
mini_batch_src_global generation:  0.05594134330749512
r_  generation:  0.4996967315673828
----------------------check_connections_block total spend ----------------------------- 1.4438209533691406
generate_one_block  0.6254997253417969
generate_one_block  0.6382191181182861
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03230714797973633
gen group dst list time:  0.012573957443237305
time for parepare:  0.01864004135131836
local_output_nid generation:  0.02383589744567871
local_in_edges_tensor generation:  0.05344414710998535
mini_batch_src_global generation:  0.048011064529418945
r_  generation:  0.5103428363800049
local_output_nid generation:  0.03458571434020996
local_in_edges_tensor generation:  0.0422515869140625
mini_batch_src_global generation:  0.05645751953125
r_  generation:  0.523123025894165
----------------------check_connections_block total spend ----------------------------- 1.5349645614624023
generate_one_block  0.6468126773834229
generate_one_block  0.6477870941162109
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16117382049560547  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  2.978785514831543
block generation total time  2.558318614959717
average batch blocks generation time:  1.2791593074798584
block dataloader generation time/epoch 7.175674609515978
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11670255661010742  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2817206382751465  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1166529655456543  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2810444831848145  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08735799789428711 |0.023035407066345215 |0.004138946533203125 |0.0005252361297607422 |0.003748655319213867 |0.001798868179321289 |
----------------------------------------------------------pseudo_mini_loss sum 1.0609312057495117
Total (block generation + training)time/epoch 7.511175311130026
Training time/epoch 0.3522474765777588
Training time without block to device /epoch 0.30617666244506836
Training time without total dataloading part /epoch 0.018624544143676758
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 62.00it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.95it/s]100%|██████████| 4/4 [00:00<00:00, 15.46it/s]100%|██████████| 4/4 [00:00<00:00, 15.36it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.31it/s]100%|██████████| 4/4 [00:00<00:00, 17.60it/s]100%|██████████| 4/4 [00:00<00:00, 17.54it/s]
Run 00 | Epoch 00055 | Loss 1.0609 | Train 0.3347 | Val 0.3455 | Test 0.3394
Number of nodes during this epoch:  332749
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16119766235351562  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.017516136169433594
range selection method range initialization spend 0.011421918869018555
time for parepare:  0.016338109970092773
local_output_nid generation:  0.013879537582397461
local_in_edges_tensor generation:  0.011516571044921875
mini_batch_src_global generation:  0.013335704803466797
r_  generation:  0.167999267578125
local_output_nid generation:  0.011924266815185547
local_in_edges_tensor generation:  0.006929159164428711
mini_batch_src_global generation:  0.01734137535095215
r_  generation:  0.18879032135009766
----------------------check_connections_block total spend ----------------------------- 0.5183429718017578
generate_one_block  0.19591021537780762
generate_one_block  0.2015819549560547
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.040323495864868164
gen group dst list time:  0.00664067268371582
time for parepare:  0.019643068313598633
local_output_nid generation:  0.016835689544677734
local_in_edges_tensor generation:  0.04058432579040527
mini_batch_src_global generation:  0.04518389701843262
r_  generation:  0.48465991020202637
local_output_nid generation:  0.02621603012084961
local_in_edges_tensor generation:  0.03258514404296875
mini_batch_src_global generation:  0.055082082748413086
r_  generation:  0.5050861835479736
----------------------check_connections_block total spend ----------------------------- 1.4397954940795898
generate_one_block  0.6215915679931641
generate_one_block  0.6239633560180664
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028547048568725586
gen group dst list time:  0.012386083602905273
time for parepare:  0.018242835998535156
local_output_nid generation:  0.022634267807006836
local_in_edges_tensor generation:  0.03508806228637695
mini_batch_src_global generation:  0.04687213897705078
r_  generation:  0.5060017108917236
local_output_nid generation:  0.03153729438781738
local_in_edges_tensor generation:  0.03693532943725586
mini_batch_src_global generation:  0.05831766128540039
r_  generation:  0.519261360168457
----------------------check_connections_block total spend ----------------------------- 1.496584415435791
generate_one_block  0.6327295303344727
generate_one_block  0.6435120105743408
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16119766235351562  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  2.936379909515381
block generation total time  2.521796464920044
average batch blocks generation time:  1.260898232460022
block dataloader generation time/epoch 7.174603447001031
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1167597770690918  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2820625305175781  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11653518676757812  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.281057357788086  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08186733722686768 |0.01566469669342041 |0.004013776779174805 |0.0005055665969848633 |0.0023883581161499023 |0.0038449764251708984 |
----------------------------------------------------------pseudo_mini_loss sum 1.0589983463287354
Total (block generation + training)time/epoch 7.5097056703364595
Training time/epoch 0.3166375160217285
Training time without block to device /epoch 0.2853081226348877
Training time without total dataloading part /epoch 0.01766037940979004
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 53.06it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.85it/s]100%|██████████| 4/4 [00:00<00:00, 15.22it/s]100%|██████████| 4/4 [00:00<00:00, 15.15it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.43it/s]100%|██████████| 4/4 [00:00<00:00, 17.51it/s]100%|██████████| 4/4 [00:00<00:00, 17.48it/s]
Run 00 | Epoch 00056 | Loss 1.0590 | Train 0.3314 | Val 0.3398 | Test 0.3339
Number of nodes during this epoch:  332763
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16104650497436523  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018018245697021484
range selection method range initialization spend 0.011988162994384766
time for parepare:  0.017658472061157227
local_output_nid generation:  0.010880708694458008
local_in_edges_tensor generation:  0.00982975959777832
mini_batch_src_global generation:  0.014027833938598633
r_  generation:  0.16872215270996094
local_output_nid generation:  0.012087583541870117
local_in_edges_tensor generation:  0.00671076774597168
mini_batch_src_global generation:  0.017267465591430664
r_  generation:  0.18254566192626953
----------------------check_connections_block total spend ----------------------------- 0.5092124938964844
generate_one_block  0.2053525447845459
generate_one_block  0.20087409019470215
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03390240669250488
gen group dst list time:  0.0065457820892333984
time for parepare:  0.021575927734375
local_output_nid generation:  0.01810431480407715
local_in_edges_tensor generation:  0.04365372657775879
mini_batch_src_global generation:  0.04729342460632324
r_  generation:  0.4912693500518799
local_output_nid generation:  0.026842832565307617
local_in_edges_tensor generation:  0.034554243087768555
mini_batch_src_global generation:  0.05584001541137695
r_  generation:  0.505446195602417
----------------------check_connections_block total spend ----------------------------- 1.460921049118042
generate_one_block  0.6234614849090576
generate_one_block  0.6296732425689697
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029206275939941406
gen group dst list time:  0.012322187423706055
time for parepare:  0.01881575584411621
local_output_nid generation:  0.023566484451293945
local_in_edges_tensor generation:  0.03559994697570801
mini_batch_src_global generation:  0.045319557189941406
r_  generation:  0.5112566947937012
local_output_nid generation:  0.03237724304199219
local_in_edges_tensor generation:  0.04134559631347656
mini_batch_src_global generation:  0.05663704872131348
r_  generation:  0.5259091854095459
----------------------check_connections_block total spend ----------------------------- 1.5151281356811523
generate_one_block  0.6465342044830322
generate_one_block  0.6559104919433594
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16104650497436523  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  2.9760491847991943
block generation total time  2.555579423904419
average batch blocks generation time:  1.2777897119522095
block dataloader generation time/epoch 7.175442556540172
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11676836013793945  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2822599411010742  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.116455078125  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.280005931854248  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08446955680847168 |0.01742112636566162 |0.004014134407043457 |0.0005184412002563477 |0.002745985984802246 |0.0019335746765136719 |
----------------------------------------------------------pseudo_mini_loss sum 1.0535428524017334
Total (block generation + training)time/epoch 7.5105670640865965
Training time/epoch 0.3360328674316406
Training time without block to device /epoch 0.3011906147003174
Training time without total dataloading part /epoch 0.016490697860717773
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 48.61it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.01it/s]100%|██████████| 4/4 [00:00<00:00, 15.23it/s]100%|██████████| 4/4 [00:00<00:00, 15.18it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.71it/s]100%|██████████| 4/4 [00:00<00:00, 15.14it/s]100%|██████████| 4/4 [00:00<00:00, 15.06it/s]
Run 00 | Epoch 00057 | Loss 1.0535 | Train 0.3284 | Val 0.3354 | Test 0.3293
Number of nodes during this epoch:  332856
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16018104553222656  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021392822265625
range selection method range initialization spend 0.01206064224243164
time for parepare:  0.017548322677612305
local_output_nid generation:  0.010998964309692383
local_in_edges_tensor generation:  0.009357452392578125
mini_batch_src_global generation:  0.013295412063598633
r_  generation:  0.16785264015197754
local_output_nid generation:  0.011625528335571289
local_in_edges_tensor generation:  0.00653529167175293
mini_batch_src_global generation:  0.017222166061401367
r_  generation:  0.18268346786499023
----------------------check_connections_block total spend ----------------------------- 0.5079421997070312
generate_one_block  0.2055356502532959
generate_one_block  0.20812487602233887
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03105616569519043
gen group dst list time:  0.006663084030151367
time for parepare:  0.02183079719543457
local_output_nid generation:  0.01912546157836914
local_in_edges_tensor generation:  0.03542137145996094
mini_batch_src_global generation:  0.04692220687866211
r_  generation:  0.5046920776367188
local_output_nid generation:  0.027051448822021484
local_in_edges_tensor generation:  0.027339935302734375
mini_batch_src_global generation:  0.05565381050109863
r_  generation:  0.4984548091888428
----------------------check_connections_block total spend ----------------------------- 1.455632209777832
generate_one_block  0.6256258487701416
generate_one_block  0.6311709880828857
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028461217880249023
gen group dst list time:  0.012268304824829102
time for parepare:  0.01850748062133789
local_output_nid generation:  0.022716522216796875
local_in_edges_tensor generation:  0.03417229652404785
mini_batch_src_global generation:  0.04888582229614258
r_  generation:  0.5161523818969727
local_output_nid generation:  0.03311514854431152
local_in_edges_tensor generation:  0.036298513412475586
mini_batch_src_global generation:  0.05625200271606445
r_  generation:  0.5176470279693604
----------------------check_connections_block total spend ----------------------------- 1.5074055194854736
generate_one_block  0.6356194019317627
generate_one_block  0.6353514194488525
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16018104553222656  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  2.9630377292633057
block generation total time  2.5277676582336426
average batch blocks generation time:  1.2638838291168213
block dataloader generation time/epoch 7.175087325426997
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11675405502319336  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.28233003616333  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11650276184082031  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2809629440307617  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08681166172027588 |0.0153425931930542 |0.004038095474243164 |0.0005083084106445312 |0.002750396728515625 |0.0016930103302001953 |
----------------------------------------------------------pseudo_mini_loss sum 1.0529415607452393
Total (block generation + training)time/epoch 7.510197386449697
Training time/epoch 0.3342773914337158
Training time without block to device /epoch 0.3035922050476074
Training time without total dataloading part /epoch 0.016286611557006836
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 55.54it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.92it/s]100%|██████████| 4/4 [00:00<00:00, 15.28it/s]100%|██████████| 4/4 [00:00<00:00, 15.21it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.35it/s]100%|██████████| 4/4 [00:00<00:00, 17.15it/s]100%|██████████| 4/4 [00:00<00:00, 17.16it/s]
Run 00 | Epoch 00058 | Loss 1.0529 | Train 0.3266 | Val 0.3322 | Test 0.3260
Number of nodes during this epoch:  332824
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1610865592956543  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018452167510986328
range selection method range initialization spend 0.012242555618286133
time for parepare:  0.016624927520751953
local_output_nid generation:  0.010879278182983398
local_in_edges_tensor generation:  0.008601665496826172
mini_batch_src_global generation:  0.013381242752075195
r_  generation:  0.16860556602478027
local_output_nid generation:  0.012096643447875977
local_in_edges_tensor generation:  0.006421089172363281
mini_batch_src_global generation:  0.017024755477905273
r_  generation:  0.17933106422424316
----------------------check_connections_block total spend ----------------------------- 0.5029435157775879
generate_one_block  0.20237064361572266
generate_one_block  0.20189547538757324
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029524803161621094
gen group dst list time:  0.006611824035644531
time for parepare:  0.0236055850982666
local_output_nid generation:  0.01772761344909668
local_in_edges_tensor generation:  0.03853178024291992
mini_batch_src_global generation:  0.047081947326660156
r_  generation:  0.4964628219604492
local_output_nid generation:  0.027610301971435547
local_in_edges_tensor generation:  0.03920388221740723
mini_batch_src_global generation:  0.0673832893371582
r_  generation:  0.5100061893463135
----------------------check_connections_block total spend ----------------------------- 1.4898958206176758
generate_one_block  0.623511552810669
generate_one_block  0.6263539791107178
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028018951416015625
gen group dst list time:  0.013280391693115234
time for parepare:  0.019516944885253906
local_output_nid generation:  0.0228884220123291
local_in_edges_tensor generation:  0.042185068130493164
mini_batch_src_global generation:  0.045879364013671875
r_  generation:  0.5067644119262695
local_output_nid generation:  0.032610416412353516
local_in_edges_tensor generation:  0.042023658752441406
mini_batch_src_global generation:  0.05681347846984863
r_  generation:  0.5206375122070312
----------------------check_connections_block total spend ----------------------------- 1.5128321647644043
generate_one_block  0.6417021751403809
generate_one_block  0.642570972442627
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1610865592956543  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  3.00272798538208
block generation total time  2.5341386795043945
average batch blocks generation time:  1.2670693397521973
block dataloader generation time/epoch 7.17527690410614
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11677312850952148  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2820558547973633  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11648941040039062  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2807302474975586  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08400750160217285 |0.019403576850891113 |0.004463553428649902 |0.0005322694778442383 |0.0022684335708618164 |0.0017418861389160156 |
----------------------------------------------------------pseudo_mini_loss sum 1.0479710102081299
Total (block generation + training)time/epoch 7.510486226081849
Training time/epoch 0.33993053436279297
Training time without block to device /epoch 0.30112338066101074
Training time without total dataloading part /epoch 0.01627039909362793
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 58.00it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.73it/s]100%|██████████| 4/4 [00:00<00:00, 15.20it/s]100%|██████████| 4/4 [00:00<00:00, 15.12it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.76it/s]100%|██████████| 4/4 [00:00<00:00, 17.85it/s]100%|██████████| 4/4 [00:00<00:00, 17.96it/s]
Run 00 | Epoch 00059 | Loss 1.0480 | Train 0.3251 | Val 0.3287 | Test 0.3224
Number of nodes during this epoch:  332786
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16109323501586914  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.016246795654296875
range selection method range initialization spend 0.011828184127807617
time for parepare:  0.016489505767822266
local_output_nid generation:  0.011024951934814453
local_in_edges_tensor generation:  0.009068727493286133
mini_batch_src_global generation:  0.013586997985839844
r_  generation:  0.16818475723266602
local_output_nid generation:  0.011761903762817383
local_in_edges_tensor generation:  0.005845308303833008
mini_batch_src_global generation:  0.017439842224121094
r_  generation:  0.18408966064453125
----------------------check_connections_block total spend ----------------------------- 0.5070972442626953
generate_one_block  0.19832301139831543
generate_one_block  0.19874167442321777
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.027779817581176758
gen group dst list time:  0.006747722625732422
time for parepare:  0.020321130752563477
local_output_nid generation:  0.017948627471923828
local_in_edges_tensor generation:  0.0301363468170166
mini_batch_src_global generation:  0.0447084903717041
r_  generation:  0.4943349361419678
local_output_nid generation:  0.026836872100830078
local_in_edges_tensor generation:  0.028352737426757812
mini_batch_src_global generation:  0.055230140686035156
r_  generation:  0.5043759346008301
----------------------check_connections_block total spend ----------------------------- 1.4362385272979736
generate_one_block  0.6313261985778809
generate_one_block  0.6610286235809326
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.035689592361450195
gen group dst list time:  0.016564130783081055
time for parepare:  0.01867079734802246
local_output_nid generation:  0.023837804794311523
local_in_edges_tensor generation:  0.03955793380737305
mini_batch_src_global generation:  0.05369377136230469
r_  generation:  0.5143547058105469
local_output_nid generation:  0.03226304054260254
local_in_edges_tensor generation:  0.04091644287109375
mini_batch_src_global generation:  0.05648636817932129
r_  generation:  0.5213747024536133
----------------------check_connections_block total spend ----------------------------- 1.5239388942718506
generate_one_block  0.6367542743682861
generate_one_block  0.6451425552368164
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16109323501586914  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  2.960177421569824
block generation total time  2.574251651763916
average batch blocks generation time:  1.287125825881958
block dataloader generation time/epoch 7.17520359918183
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11675214767456055  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2819452285766602  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11657571792602539  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.281404972076416  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08560776710510254 |0.02158951759338379 |0.003956437110900879 |0.0005031824111938477 |0.0032421350479125977 |0.0022466182708740234 |
----------------------------------------------------------pseudo_mini_loss sum 1.0462758541107178
Total (block generation + training)time/epoch 7.5106369747835044
Training time/epoch 0.34648942947387695
Training time without block to device /epoch 0.3033103942871094
Training time without total dataloading part /epoch 0.017650127410888672
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 59.30it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.18it/s]100%|██████████| 4/4 [00:00<00:00, 15.46it/s]100%|██████████| 4/4 [00:00<00:00, 15.40it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.21it/s]100%|██████████| 4/4 [00:00<00:00, 17.43it/s]100%|██████████| 4/4 [00:00<00:00, 17.38it/s]
Run 00 | Epoch 00060 | Loss 1.0463 | Train 0.3235 | Val 0.3241 | Test 0.3178
Number of nodes during this epoch:  332835
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1609821319580078  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.016649723052978516
range selection method range initialization spend 0.012300252914428711
time for parepare:  0.016460418701171875
local_output_nid generation:  0.010966300964355469
local_in_edges_tensor generation:  0.008707046508789062
mini_batch_src_global generation:  0.01366281509399414
r_  generation:  0.1693112850189209
local_output_nid generation:  0.012169361114501953
local_in_edges_tensor generation:  0.005935192108154297
mini_batch_src_global generation:  0.017442941665649414
r_  generation:  0.18103265762329102
----------------------check_connections_block total spend ----------------------------- 0.5062839984893799
generate_one_block  0.19703912734985352
generate_one_block  0.19818973541259766
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02856278419494629
gen group dst list time:  0.006620168685913086
time for parepare:  0.01995229721069336
local_output_nid generation:  0.017730712890625
local_in_edges_tensor generation:  0.035509586334228516
mini_batch_src_global generation:  0.045357704162597656
r_  generation:  0.5007963180541992
local_output_nid generation:  0.028322935104370117
local_in_edges_tensor generation:  0.030943632125854492
mini_batch_src_global generation:  0.05618786811828613
r_  generation:  0.5078785419464111
----------------------check_connections_block total spend ----------------------------- 1.4629154205322266
generate_one_block  0.6604862213134766
generate_one_block  0.6406357288360596
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.035135746002197266
gen group dst list time:  0.014791727066040039
time for parepare:  0.018129587173461914
local_output_nid generation:  0.02299809455871582
local_in_edges_tensor generation:  0.04764723777770996
mini_batch_src_global generation:  0.048482418060302734
r_  generation:  0.5121469497680664
local_output_nid generation:  0.03220057487487793
local_in_edges_tensor generation:  0.041060686111450195
mini_batch_src_global generation:  0.05624079704284668
r_  generation:  0.5210320949554443
----------------------check_connections_block total spend ----------------------------- 1.522334098815918
generate_one_block  0.6378560066223145
generate_one_block  0.6411886215209961
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1609821319580078  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  2.9852495193481445
block generation total time  2.5801665782928467
average batch blocks generation time:  1.2900832891464233
block dataloader generation time/epoch 7.175712961416978
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11680078506469727  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2822656631469727  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11643648147583008  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2804741859436035  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0844571590423584 |0.01765608787536621 |0.0041065216064453125 |0.0005124807357788086 |0.0028210878372192383 |0.001415252685546875 |
----------------------------------------------------------pseudo_mini_loss sum 1.0442171096801758
Total (block generation + training)time/epoch 7.511156481045943
Training time/epoch 0.3358168601989746
Training time without block to device /epoch 0.3005046844482422
Training time without total dataloading part /epoch 0.016295433044433594
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 55.37it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.72it/s]100%|██████████| 4/4 [00:00<00:00, 15.39it/s]100%|██████████| 4/4 [00:00<00:00, 15.27it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.77it/s]100%|██████████| 4/4 [00:00<00:00, 17.17it/s]100%|██████████| 4/4 [00:00<00:00, 17.09it/s]
Run 00 | Epoch 00061 | Loss 1.0442 | Train 0.3214 | Val 0.3199 | Test 0.3126
Number of nodes during this epoch:  332833
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1610269546508789  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019070148468017578
range selection method range initialization spend 0.01208806037902832
time for parepare:  0.018172025680541992
local_output_nid generation:  0.010964632034301758
local_in_edges_tensor generation:  0.008667469024658203
mini_batch_src_global generation:  0.013562202453613281
r_  generation:  0.1709752082824707
local_output_nid generation:  0.011607646942138672
local_in_edges_tensor generation:  0.005945444107055664
mini_batch_src_global generation:  0.017558813095092773
r_  generation:  0.1824784278869629
----------------------check_connections_block total spend ----------------------------- 0.5101068019866943
generate_one_block  0.19962859153747559
generate_one_block  0.20481562614440918
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0331418514251709
gen group dst list time:  0.00672602653503418
time for parepare:  0.020728588104248047
local_output_nid generation:  0.018136978149414062
local_in_edges_tensor generation:  0.03304123878479004
mini_batch_src_global generation:  0.052202701568603516
r_  generation:  0.49505090713500977
local_output_nid generation:  0.02683234214782715
local_in_edges_tensor generation:  0.040915489196777344
mini_batch_src_global generation:  0.056661367416381836
r_  generation:  0.5297565460205078
----------------------check_connections_block total spend ----------------------------- 1.4992461204528809
generate_one_block  0.6327197551727295
generate_one_block  0.6338932514190674
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0315706729888916
gen group dst list time:  0.013514518737792969
time for parepare:  0.01886439323425293
local_output_nid generation:  0.023003816604614258
local_in_edges_tensor generation:  0.04373979568481445
mini_batch_src_global generation:  0.04861879348754883
r_  generation:  0.5074095726013184
local_output_nid generation:  0.03192639350891113
local_in_edges_tensor generation:  0.03686666488647461
mini_batch_src_global generation:  0.059198856353759766
r_  generation:  0.5176141262054443
----------------------check_connections_block total spend ----------------------------- 1.5129132270812988
generate_one_block  0.6365351676940918
generate_one_block  0.6493973731994629
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1610269546508789  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  3.0121593475341797
block generation total time  2.5525455474853516
average batch blocks generation time:  1.2762727737426758
block dataloader generation time/epoch 7.1765738343292815
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1167607307434082  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2819976806640625  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11653947830200195  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2812533378601074  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07895195484161377 |0.01744365692138672 |0.00449061393737793 |0.0005500316619873047 |0.002963542938232422 |0.0018017292022705078 |
----------------------------------------------------------pseudo_mini_loss sum 1.0369540452957153
Total (block generation + training)time/epoch 7.511793159088999
Training time/epoch 0.32341814041137695
Training time without block to device /epoch 0.2885308265686035
Training time without total dataloading part /epoch 0.01781010627746582
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 57.15it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.56it/s]100%|██████████| 4/4 [00:00<00:00, 17.72it/s]100%|██████████| 4/4 [00:00<00:00, 17.82it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.37it/s]100%|██████████| 4/4 [00:00<00:00, 17.55it/s]100%|██████████| 4/4 [00:00<00:00, 17.50it/s]
Run 00 | Epoch 00062 | Loss 1.0370 | Train 0.3186 | Val 0.3146 | Test 0.3070
Number of nodes during this epoch:  332824
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16103172302246094  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018071651458740234
range selection method range initialization spend 0.011795759201049805
time for parepare:  0.018659353256225586
local_output_nid generation:  0.011001110076904297
local_in_edges_tensor generation:  0.00972604751586914
mini_batch_src_global generation:  0.013588190078735352
r_  generation:  0.17175865173339844
local_output_nid generation:  0.011940240859985352
local_in_edges_tensor generation:  0.008431434631347656
mini_batch_src_global generation:  0.01880168914794922
r_  generation:  0.18625617027282715
----------------------check_connections_block total spend ----------------------------- 0.5237240791320801
generate_one_block  0.21269750595092773
generate_one_block  0.2048802375793457
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04763317108154297
gen group dst list time:  0.006587505340576172
time for parepare:  0.020581483840942383
local_output_nid generation:  0.018172740936279297
local_in_edges_tensor generation:  0.04718494415283203
mini_batch_src_global generation:  0.05150771141052246
r_  generation:  0.48754286766052246
local_output_nid generation:  0.02667546272277832
local_in_edges_tensor generation:  0.03602337837219238
mini_batch_src_global generation:  0.055281639099121094
r_  generation:  0.5013875961303711
----------------------check_connections_block total spend ----------------------------- 1.4605956077575684
generate_one_block  0.6242709159851074
generate_one_block  0.6338951587677002
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03705954551696777
gen group dst list time:  0.012429475784301758
time for parepare:  0.01845240592956543
local_output_nid generation:  0.022107839584350586
local_in_edges_tensor generation:  0.032126665115356445
mini_batch_src_global generation:  0.05111503601074219
r_  generation:  0.5118591785430908
local_output_nid generation:  0.030815601348876953
local_in_edges_tensor generation:  0.04138588905334473
mini_batch_src_global generation:  0.05642580986022949
r_  generation:  0.5279390811920166
----------------------check_connections_block total spend ----------------------------- 1.5160915851593018
generate_one_block  0.6543991565704346
generate_one_block  0.6795032024383545
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16103172302246094  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  2.97668719291687
block generation total time  2.5920684337615967
average batch blocks generation time:  1.2960342168807983
block dataloader generation time/epoch 7.178731635764793
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11676549911499023  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2822833061218262  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11647987365722656  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2803163528442383  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09372162818908691 |0.031127214431762695 |0.004004478454589844 |0.0004963874816894531 |0.0031137466430664062 |0.00171661376953125 |
----------------------------------------------------------pseudo_mini_loss sum 1.034553050994873
Total (block generation + training)time/epoch 7.514602895136233
Training time/epoch 0.3702812194824219
Training time without block to device /epoch 0.3080267906188965
Training time without total dataloading part /epoch 0.016945838928222656
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 47.25it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.71it/s]100%|██████████| 4/4 [00:00<00:00, 15.07it/s]100%|██████████| 4/4 [00:00<00:00, 15.00it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.02it/s]100%|██████████| 4/4 [00:00<00:00, 17.29it/s]100%|██████████| 4/4 [00:00<00:00, 17.23it/s]
Run 00 | Epoch 00063 | Loss 1.0346 | Train 0.3156 | Val 0.3089 | Test 0.3001
Number of nodes during this epoch:  332855
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16112661361694336  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019757986068725586
range selection method range initialization spend 0.011922836303710938
time for parepare:  0.017791032791137695
local_output_nid generation:  0.011033058166503906
local_in_edges_tensor generation:  0.00937509536743164
mini_batch_src_global generation:  0.013559341430664062
r_  generation:  0.16715598106384277
local_output_nid generation:  0.01194143295288086
local_in_edges_tensor generation:  0.0061452388763427734
mini_batch_src_global generation:  0.017465591430664062
r_  generation:  0.18142986297607422
----------------------check_connections_block total spend ----------------------------- 0.505967378616333
generate_one_block  0.1991260051727295
generate_one_block  0.20089006423950195
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.025683164596557617
gen group dst list time:  0.006567716598510742
time for parepare:  0.021037578582763672
local_output_nid generation:  0.0183255672454834
local_in_edges_tensor generation:  0.03284311294555664
mini_batch_src_global generation:  0.046749114990234375
r_  generation:  0.488292932510376
local_output_nid generation:  0.027030467987060547
local_in_edges_tensor generation:  0.025989294052124023
mini_batch_src_global generation:  0.05656123161315918
r_  generation:  0.5012102127075195
----------------------check_connections_block total spend ----------------------------- 1.4314813613891602
generate_one_block  0.6248311996459961
generate_one_block  0.6265826225280762
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.023730754852294922
gen group dst list time:  0.012430667877197266
time for parepare:  0.01828789710998535
local_output_nid generation:  0.023047685623168945
local_in_edges_tensor generation:  0.03134465217590332
mini_batch_src_global generation:  0.04741477966308594
r_  generation:  0.511066198348999
local_output_nid generation:  0.03171849250793457
local_in_edges_tensor generation:  0.03594088554382324
mini_batch_src_global generation:  0.05586099624633789
r_  generation:  0.5182702541351318
----------------------check_connections_block total spend ----------------------------- 1.4949390888214111
generate_one_block  0.6360273361206055
generate_one_block  0.6438283920288086
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16112661361694336  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  2.9264204502105713
block generation total time  2.5312695503234863
average batch blocks generation time:  1.2656347751617432
block dataloader generation time/epoch 7.177243115685203
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11674165725708008  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.281735897064209  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11659717559814453  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2812070846557617  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08517372608184814 |0.01814436912536621 |0.0038210153579711914 |0.0005059242248535156 |0.002745389938354492 |0.0012955665588378906 |
----------------------------------------------------------pseudo_mini_loss sum 1.036851406097412
Total (block generation + training)time/epoch 7.513070219213312
Training time/epoch 0.33336520195007324
Training time without block to device /epoch 0.2970764636993408
Training time without total dataloading part /epoch 0.015440225601196289
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 66.95it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.28it/s]100%|██████████| 4/4 [00:00<00:00, 15.45it/s]100%|██████████| 4/4 [00:00<00:00, 15.41it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.10it/s]100%|██████████| 4/4 [00:00<00:00, 17.35it/s]100%|██████████| 4/4 [00:00<00:00, 17.29it/s]
Run 00 | Epoch 00064 | Loss 1.0369 | Train 0.3128 | Val 0.3030 | Test 0.2933
Number of nodes during this epoch:  332837
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16100358963012695  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0206301212310791
range selection method range initialization spend 0.013738632202148438
time for parepare:  0.018029212951660156
local_output_nid generation:  0.011064767837524414
local_in_edges_tensor generation:  0.013276100158691406
mini_batch_src_global generation:  0.013541698455810547
r_  generation:  0.16802120208740234
local_output_nid generation:  0.011817693710327148
local_in_edges_tensor generation:  0.007869958877563477
mini_batch_src_global generation:  0.016981840133666992
r_  generation:  0.1806635856628418
----------------------check_connections_block total spend ----------------------------- 0.511587381362915
generate_one_block  0.19754981994628906
generate_one_block  0.19811367988586426
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03507709503173828
gen group dst list time:  0.006734609603881836
time for parepare:  0.019895315170288086
local_output_nid generation:  0.018041133880615234
local_in_edges_tensor generation:  0.03784346580505371
mini_batch_src_global generation:  0.04583263397216797
r_  generation:  0.4889719486236572
local_output_nid generation:  0.026598691940307617
local_in_edges_tensor generation:  0.03572440147399902
mini_batch_src_global generation:  0.05530095100402832
r_  generation:  0.5049166679382324
----------------------check_connections_block total spend ----------------------------- 1.4469869136810303
generate_one_block  0.6262266635894775
generate_one_block  0.6267430782318115
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02650904655456543
gen group dst list time:  0.012457609176635742
time for parepare:  0.018220186233520508
local_output_nid generation:  0.022787094116210938
local_in_edges_tensor generation:  0.03241276741027832
mini_batch_src_global generation:  0.045453548431396484
r_  generation:  0.5094616413116455
local_output_nid generation:  0.03191351890563965
local_in_edges_tensor generation:  0.03542470932006836
mini_batch_src_global generation:  0.05552816390991211
r_  generation:  0.521615743637085
----------------------check_connections_block total spend ----------------------------- 1.4959592819213867
generate_one_block  0.6333012580871582
generate_one_block  0.6458899974822998
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16100358963012695  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  2.942946195602417
block generation total time  2.532160997390747
average batch blocks generation time:  1.2660804986953735
block dataloader generation time/epoch 7.17607181412833
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1168065071105957  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2815961837768555  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11650323867797852  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2807626724243164  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08566427230834961 |0.015877246856689453 |0.00410771369934082 |0.0005140304565429688 |0.003031492233276367 |0.0017545223236083984 |
----------------------------------------------------------pseudo_mini_loss sum 1.031764268875122
Total (block generation + training)time/epoch 7.511894004685538
Training time/epoch 0.33539772033691406
Training time without block to device /epoch 0.30364322662353516
Training time without total dataloading part /epoch 0.01706099510192871
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 57.62it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.20it/s]100%|██████████| 4/4 [00:00<00:00, 15.28it/s]100%|██████████| 4/4 [00:00<00:00, 15.26it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.46it/s]100%|██████████| 4/4 [00:00<00:00, 17.74it/s]100%|██████████| 4/4 [00:00<00:00, 17.68it/s]
Run 00 | Epoch 00065 | Loss 1.0318 | Train 0.3108 | Val 0.2992 | Test 0.2890
Number of nodes during this epoch:  332794
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16104364395141602  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02150249481201172
range selection method range initialization spend 0.011784553527832031
time for parepare:  0.01668405532836914
local_output_nid generation:  0.011036157608032227
local_in_edges_tensor generation:  0.008564472198486328
mini_batch_src_global generation:  0.022233009338378906
r_  generation:  0.17852044105529785
local_output_nid generation:  0.012548446655273438
local_in_edges_tensor generation:  0.007863759994506836
mini_batch_src_global generation:  0.017204761505126953
r_  generation:  0.18431448936462402
----------------------check_connections_block total spend ----------------------------- 0.5310606956481934
generate_one_block  0.19979381561279297
generate_one_block  0.20255160331726074
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03516435623168945
gen group dst list time:  0.0066945552825927734
time for parepare:  0.019966840744018555
local_output_nid generation:  0.017909526824951172
local_in_edges_tensor generation:  0.05050015449523926
mini_batch_src_global generation:  0.049767255783081055
r_  generation:  0.49253249168395996
local_output_nid generation:  0.026938438415527344
local_in_edges_tensor generation:  0.036086082458496094
mini_batch_src_global generation:  0.05533027648925781
r_  generation:  0.5042035579681396
----------------------check_connections_block total spend ----------------------------- 1.4701581001281738
generate_one_block  0.6290972232818604
generate_one_block  0.6324412822723389
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03841447830200195
gen group dst list time:  0.013282299041748047
time for parepare:  0.018516063690185547
local_output_nid generation:  0.024079561233520508
local_in_edges_tensor generation:  0.03537416458129883
mini_batch_src_global generation:  0.0462794303894043
r_  generation:  0.5147597789764404
local_output_nid generation:  0.033260345458984375
local_in_edges_tensor generation:  0.04739952087402344
mini_batch_src_global generation:  0.06206989288330078
r_  generation:  0.5272011756896973
----------------------check_connections_block total spend ----------------------------- 1.534912347793579
generate_one_block  0.6548612117767334
generate_one_block  0.6463561058044434
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16104364395141602  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  3.005070447921753
block generation total time  2.562755823135376
average batch blocks generation time:  1.281377911567688
block dataloader generation time/epoch 7.177946534073143
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11679697036743164  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2821083068847656  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11649799346923828  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2808327674865723  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08593285083770752 |0.024768352508544922 |0.0040405988693237305 |0.0004955530166625977 |0.003920793533325195 |0.0036394596099853516 |
----------------------------------------------------------pseudo_mini_loss sum 1.0310369729995728
Total (block generation + training)time/epoch 7.513930249632451
Training time/epoch 0.34488654136657715
Training time without block to device /epoch 0.2953498363494873
Training time without total dataloading part /epoch 0.0205533504486084
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 55.22it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.16it/s]100%|██████████| 4/4 [00:00<00:00, 15.45it/s]100%|██████████| 4/4 [00:00<00:00, 15.39it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.11it/s]100%|██████████| 4/4 [00:00<00:00, 17.74it/s]100%|██████████| 4/4 [00:00<00:00, 17.62it/s]
Run 00 | Epoch 00066 | Loss 1.0310 | Train 0.3091 | Val 0.2956 | Test 0.2846
Number of nodes during this epoch:  332873
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16107654571533203  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021123886108398438
range selection method range initialization spend 0.011581659317016602
time for parepare:  0.017039775848388672
local_output_nid generation:  0.011144161224365234
local_in_edges_tensor generation:  0.009374380111694336
mini_batch_src_global generation:  0.013641119003295898
r_  generation:  0.16952013969421387
local_output_nid generation:  0.011766433715820312
local_in_edges_tensor generation:  0.006540775299072266
mini_batch_src_global generation:  0.0170900821685791
r_  generation:  0.18060016632080078
----------------------check_connections_block total spend ----------------------------- 0.506624698638916
generate_one_block  0.19802308082580566
generate_one_block  0.203125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02762460708618164
gen group dst list time:  0.006674289703369141
time for parepare:  0.021151065826416016
local_output_nid generation:  0.017340421676635742
local_in_edges_tensor generation:  0.028197050094604492
mini_batch_src_global generation:  0.045166015625
r_  generation:  0.5034959316253662
local_output_nid generation:  0.02685713768005371
local_in_edges_tensor generation:  0.047629356384277344
mini_batch_src_global generation:  0.06326413154602051
r_  generation:  0.5092504024505615
----------------------check_connections_block total spend ----------------------------- 1.4964416027069092
generate_one_block  0.66054368019104
generate_one_block  0.6372456550598145
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0317075252532959
gen group dst list time:  0.014799356460571289
time for parepare:  0.01825737953186035
local_output_nid generation:  0.023235559463500977
local_in_edges_tensor generation:  0.04627490043640137
mini_batch_src_global generation:  0.04718828201293945
r_  generation:  0.5165090560913086
local_output_nid generation:  0.03227806091308594
local_in_edges_tensor generation:  0.0481107234954834
mini_batch_src_global generation:  0.07374453544616699
r_  generation:  0.5402281284332275
----------------------check_connections_block total spend ----------------------------- 1.5789401531219482
generate_one_block  0.6480672359466553
generate_one_block  0.6667129993438721
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16107654571533203  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  3.0753817558288574
block generation total time  2.612569570541382
average batch blocks generation time:  1.306284785270691
block dataloader generation time/epoch 7.180884595575003
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11677026748657227  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2820653915405273  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11653804779052734  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2806196212768555  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09239530563354492 |0.0226743221282959 |0.0045795440673828125 |0.0005515813827514648 |0.0027985572814941406 |0.0040607452392578125 |
----------------------------------------------------------pseudo_mini_loss sum 1.0233592987060547
Total (block generation + training)time/epoch 7.517182617351927
Training time/epoch 0.3540637493133545
Training time without block to device /epoch 0.3087151050567627
Training time without total dataloading part /epoch 0.01992011070251465
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 51.98it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.82it/s]100%|██████████| 4/4 [00:00<00:00, 18.33it/s]100%|██████████| 4/4 [00:00<00:00, 18.37it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.69it/s]100%|██████████| 4/4 [00:00<00:00, 18.03it/s]100%|██████████| 4/4 [00:00<00:00, 17.96it/s]
Run 00 | Epoch 00067 | Loss 1.0234 | Train 0.3076 | Val 0.2922 | Test 0.2807
Number of nodes during this epoch:  332745
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16110706329345703  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018717050552368164
range selection method range initialization spend 0.01150369644165039
time for parepare:  0.01669931411743164
local_output_nid generation:  0.010893106460571289
local_in_edges_tensor generation:  0.010349273681640625
mini_batch_src_global generation:  0.013693571090698242
r_  generation:  0.16963911056518555
local_output_nid generation:  0.011861801147460938
local_in_edges_tensor generation:  0.006619691848754883
mini_batch_src_global generation:  0.017378568649291992
r_  generation:  0.1842818260192871
----------------------check_connections_block total spend ----------------------------- 0.5117197036743164
generate_one_block  0.20348501205444336
generate_one_block  0.2030808925628662
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.033753395080566406
gen group dst list time:  0.0065364837646484375
time for parepare:  0.022060632705688477
local_output_nid generation:  0.01775956153869629
local_in_edges_tensor generation:  0.029900550842285156
mini_batch_src_global generation:  0.04851579666137695
r_  generation:  0.49737024307250977
local_output_nid generation:  0.02934885025024414
local_in_edges_tensor generation:  0.037509918212890625
mini_batch_src_global generation:  0.05585741996765137
r_  generation:  0.5345854759216309
----------------------check_connections_block total spend ----------------------------- 1.498967170715332
generate_one_block  0.6478619575500488
generate_one_block  0.638580322265625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04550433158874512
gen group dst list time:  0.013296842575073242
time for parepare:  0.018439054489135742
local_output_nid generation:  0.022724151611328125
local_in_edges_tensor generation:  0.044830322265625
mini_batch_src_global generation:  0.04783821105957031
r_  generation:  0.5121095180511475
local_output_nid generation:  0.03194165229797363
local_in_edges_tensor generation:  0.03777742385864258
mini_batch_src_global generation:  0.05670785903930664
r_  generation:  0.520054817199707
----------------------check_connections_block total spend ----------------------------- 1.5165672302246094
generate_one_block  0.6336827278137207
generate_one_block  0.6459832191467285
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16110706329345703  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  3.0155344009399414
block generation total time  2.566108226776123
average batch blocks generation time:  1.2830541133880615
block dataloader generation time/epoch 7.18233179237883
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11675786972045898  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.282118797302246  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11651134490966797  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2808284759521484  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08927667140960693 |0.017200708389282227 |0.004143118858337402 |0.0005260705947875977 |0.003887772560119629 |0.0014195442199707031 |
----------------------------------------------------------pseudo_mini_loss sum 1.0233159065246582
Total (block generation + training)time/epoch 7.518571728366917
Training time/epoch 0.33272695541381836
Training time without block to device /epoch 0.2983255386352539
Training time without total dataloading part /epoch 0.01853346824645996
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 50.52it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.74it/s]100%|██████████| 4/4 [00:00<00:00, 14.22it/s]100%|██████████| 4/4 [00:00<00:00, 14.65it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.98it/s]100%|██████████| 4/4 [00:00<00:00, 14.86it/s]100%|██████████| 4/4 [00:00<00:00, 14.33it/s]
Run 00 | Epoch 00068 | Loss 1.0233 | Train 0.3044 | Val 0.2870 | Test 0.2750
Number of nodes during this epoch:  332797
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1611018180847168  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02297186851501465
range selection method range initialization spend 0.01188039779663086
time for parepare:  0.01702260971069336
local_output_nid generation:  0.011132240295410156
local_in_edges_tensor generation:  0.010747432708740234
mini_batch_src_global generation:  0.013261079788208008
r_  generation:  0.20442819595336914
local_output_nid generation:  0.013973236083984375
local_in_edges_tensor generation:  0.00654149055480957
mini_batch_src_global generation:  0.017856597900390625
r_  generation:  0.18825912475585938
----------------------check_connections_block total spend ----------------------------- 0.5534183979034424
generate_one_block  0.20710325241088867
generate_one_block  0.20201349258422852
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.032831430435180664
gen group dst list time:  0.006807804107666016
time for parepare:  0.019942522048950195
local_output_nid generation:  0.01926565170288086
local_in_edges_tensor generation:  0.04593944549560547
mini_batch_src_global generation:  0.045442819595336914
r_  generation:  0.49271535873413086
local_output_nid generation:  0.026944875717163086
local_in_edges_tensor generation:  0.029019594192504883
mini_batch_src_global generation:  0.05551505088806152
r_  generation:  0.5272340774536133
----------------------check_connections_block total spend ----------------------------- 1.4896597862243652
generate_one_block  0.6428706645965576
generate_one_block  0.6341552734375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.027164459228515625
gen group dst list time:  0.014019489288330078
time for parepare:  0.023042678833007812
local_output_nid generation:  0.041385650634765625
local_in_edges_tensor generation:  0.04400897026062012
mini_batch_src_global generation:  0.05997467041015625
r_  generation:  0.524003267288208
local_output_nid generation:  0.0369877815246582
local_in_edges_tensor generation:  0.0481724739074707
mini_batch_src_global generation:  0.06165909767150879
r_  generation:  0.5361342430114746
----------------------check_connections_block total spend ----------------------------- 1.623445987701416
generate_one_block  0.6595790386199951
generate_one_block  0.6452293395996094
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1611018180847168  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  3.1131057739257812
block generation total time  2.581834316253662
average batch blocks generation time:  1.290917158126831
block dataloader generation time/epoch 7.18627272049586
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11676359176635742  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2824597358703613  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11652898788452148  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2811241149902344  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0843430757522583 |0.022424936294555664 |0.004068493843078613 |0.0004913806915283203 |0.003926992416381836 |0.0018239021301269531 |
----------------------------------------------------------pseudo_mini_loss sum 1.017030954360962
Total (block generation + training)time/epoch 7.522709055741628
Training time/epoch 0.3478848934173584
Training time without block to device /epoch 0.30303502082824707
Training time without total dataloading part /epoch 0.018797636032104492
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 52.63it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.15it/s]100%|██████████| 4/4 [00:00<00:00, 15.35it/s]100%|██████████| 4/4 [00:00<00:00, 15.31it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.30it/s]100%|██████████| 4/4 [00:00<00:00, 17.67it/s]100%|██████████| 4/4 [00:00<00:00, 17.59it/s]
Run 00 | Epoch 00069 | Loss 1.0170 | Train 0.3009 | Val 0.2801 | Test 0.2682
Number of nodes during this epoch:  332865
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1611313819885254  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02048468589782715
range selection method range initialization spend 0.011524438858032227
time for parepare:  0.01757955551147461
local_output_nid generation:  0.011040925979614258
local_in_edges_tensor generation:  0.012444734573364258
mini_batch_src_global generation:  0.013956308364868164
r_  generation:  0.17438602447509766
local_output_nid generation:  0.011870622634887695
local_in_edges_tensor generation:  0.006749868392944336
mini_batch_src_global generation:  0.01726388931274414
r_  generation:  0.18334174156188965
----------------------check_connections_block total spend ----------------------------- 0.5184955596923828
generate_one_block  0.2039487361907959
generate_one_block  0.2012958526611328
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03572201728820801
gen group dst list time:  0.006561279296875
time for parepare:  0.023289918899536133
local_output_nid generation:  0.021613597869873047
local_in_edges_tensor generation:  0.04222822189331055
mini_batch_src_global generation:  0.05341625213623047
r_  generation:  0.5125648975372314
local_output_nid generation:  0.030837535858154297
local_in_edges_tensor generation:  0.03675985336303711
mini_batch_src_global generation:  0.05826568603515625
r_  generation:  0.511786699295044
----------------------check_connections_block total spend ----------------------------- 1.5395419597625732
generate_one_block  0.6173386573791504
generate_one_block  0.6225318908691406
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03487873077392578
gen group dst list time:  0.012445688247680664
time for parepare:  0.018209457397460938
local_output_nid generation:  0.02332282066345215
local_in_edges_tensor generation:  0.03701448440551758
mini_batch_src_global generation:  0.045790910720825195
r_  generation:  0.5197463035583496
local_output_nid generation:  0.03197813034057617
local_in_edges_tensor generation:  0.04174399375915527
mini_batch_src_global generation:  0.05646562576293945
r_  generation:  0.5304076671600342
----------------------check_connections_block total spend ----------------------------- 1.5346715450286865
generate_one_block  0.6805973052978516
generate_one_block  0.6515510082244873
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1611313819885254  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  3.0742135047912598
block generation total time  2.57201886177063
average batch blocks generation time:  1.286009430885315
block dataloader generation time/epoch 7.188656924200839
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11677789688110352  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2824311256408691  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11647462844848633  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2812118530273438  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.087074875831604 |0.022776126861572266 |0.004143714904785156 |0.0005196332931518555 |0.003930568695068359 |0.0012857913970947266 |
----------------------------------------------------------pseudo_mini_loss sum 1.0174041986465454
Total (block generation + training)time/epoch 7.525260897933459
Training time/epoch 0.34652233123779297
Training time without block to device /epoch 0.30097007751464844
Training time without total dataloading part /epoch 0.01847362518310547
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 53.17it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.14it/s]100%|██████████| 4/4 [00:00<00:00, 15.37it/s]100%|██████████| 4/4 [00:00<00:00, 15.32it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.53it/s]100%|██████████| 4/4 [00:00<00:00, 17.64it/s]100%|██████████| 4/4 [00:00<00:00, 17.60it/s]
Run 00 | Epoch 00070 | Loss 1.0174 | Train 0.2978 | Val 0.2741 | Test 0.2615
Number of nodes during this epoch:  332856
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16103172302246094  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02436208724975586
range selection method range initialization spend 0.012053966522216797
time for parepare:  0.016486644744873047
local_output_nid generation:  0.01100921630859375
local_in_edges_tensor generation:  0.009447813034057617
mini_batch_src_global generation:  0.013614416122436523
r_  generation:  0.1674337387084961
local_output_nid generation:  0.011885404586791992
local_in_edges_tensor generation:  0.0072171688079833984
mini_batch_src_global generation:  0.01812458038330078
r_  generation:  0.18145465850830078
----------------------check_connections_block total spend ----------------------------- 0.5090038776397705
generate_one_block  0.20301342010498047
generate_one_block  0.20525574684143066
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0330042839050293
gen group dst list time:  0.006657123565673828
time for parepare:  0.019826650619506836
local_output_nid generation:  0.018230199813842773
local_in_edges_tensor generation:  0.03810429573059082
mini_batch_src_global generation:  0.044669389724731445
r_  generation:  0.4893343448638916
local_output_nid generation:  0.02676224708557129
local_in_edges_tensor generation:  0.03066110610961914
mini_batch_src_global generation:  0.05540752410888672
r_  generation:  0.4990389347076416
----------------------check_connections_block total spend ----------------------------- 1.4367973804473877
generate_one_block  0.6178474426269531
generate_one_block  0.6184296607971191
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.027101516723632812
gen group dst list time:  0.01223611831665039
time for parepare:  0.01864147186279297
local_output_nid generation:  0.023491859436035156
local_in_edges_tensor generation:  0.03194832801818848
mini_batch_src_global generation:  0.04682159423828125
r_  generation:  0.5201947689056396
local_output_nid generation:  0.033495187759399414
local_in_edges_tensor generation:  0.035028934478759766
mini_batch_src_global generation:  0.05834555625915527
r_  generation:  0.5328238010406494
----------------------check_connections_block total spend ----------------------------- 1.5332155227661133
generate_one_block  0.6579365730285645
generate_one_block  0.6505405902862549
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16103172302246094  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  2.970012903213501
block generation total time  2.5447542667388916
average batch blocks generation time:  1.2723771333694458
block dataloader generation time/epoch 7.188548057310043
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11673593521118164  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2818593978881836  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11660575866699219  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2808308601379395  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08597981929779053 |0.022660374641418457 |0.004186153411865234 |0.00049591064453125 |0.0038717985153198242 |0.003582477569580078 |
----------------------------------------------------------pseudo_mini_loss sum 1.0175942182540894
Total (block generation + training)time/epoch 7.5252652860456895
Training time/epoch 0.34348416328430176
Training time without block to device /epoch 0.29816341400146484
Training time without total dataloading part /epoch 0.020690202713012695
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 52.47it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.01it/s]100%|██████████| 4/4 [00:00<00:00, 15.28it/s]100%|██████████| 4/4 [00:00<00:00, 15.23it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.47it/s]100%|██████████| 4/4 [00:00<00:00, 17.66it/s]100%|██████████| 4/4 [00:00<00:00, 17.61it/s]
Run 00 | Epoch 00071 | Loss 1.0176 | Train 0.2944 | Val 0.2673 | Test 0.2540
Number of nodes during this epoch:  332814
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16113996505737305  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02053999900817871
range selection method range initialization spend 0.01210474967956543
time for parepare:  0.016538143157958984
local_output_nid generation:  0.01125955581665039
local_in_edges_tensor generation:  0.010246038436889648
mini_batch_src_global generation:  0.014108419418334961
r_  generation:  0.16711711883544922
local_output_nid generation:  0.01182413101196289
local_in_edges_tensor generation:  0.005810737609863281
mini_batch_src_global generation:  0.01695537567138672
r_  generation:  0.18288922309875488
----------------------check_connections_block total spend ----------------------------- 0.5062558650970459
generate_one_block  0.20425176620483398
generate_one_block  0.20287680625915527
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03109598159790039
gen group dst list time:  0.006731510162353516
time for parepare:  0.021406173706054688
local_output_nid generation:  0.018229246139526367
local_in_edges_tensor generation:  0.029331684112548828
mini_batch_src_global generation:  0.04589200019836426
r_  generation:  0.4979414939880371
local_output_nid generation:  0.02752852439880371
local_in_edges_tensor generation:  0.03080606460571289
mini_batch_src_global generation:  0.059018611907958984
r_  generation:  0.5357129573822021
----------------------check_connections_block total spend ----------------------------- 1.4892091751098633
generate_one_block  0.6384768486022949
generate_one_block  0.6325287818908691
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02800750732421875
gen group dst list time:  0.013400554656982422
time for parepare:  0.01862049102783203
local_output_nid generation:  0.023062944412231445
local_in_edges_tensor generation:  0.04040169715881348
mini_batch_src_global generation:  0.04848814010620117
r_  generation:  0.5113198757171631
local_output_nid generation:  0.03152060508728027
local_in_edges_tensor generation:  0.039824724197387695
mini_batch_src_global generation:  0.05646800994873047
r_  generation:  0.521782636642456
----------------------check_connections_block total spend ----------------------------- 1.5133676528930664
generate_one_block  0.6439976692199707
generate_one_block  0.6541545391082764
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16113996505737305  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  3.0025768280029297
block generation total time  2.569157838821411
average batch blocks generation time:  1.2845789194107056
block dataloader generation time/epoch 7.18910082559737
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11676359176635742  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2825407981872559  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11638593673706055  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.280280590057373  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08691704273223877 |0.017560720443725586 |0.004199385643005371 |0.0005116462707519531 |0.003826618194580078 |0.0013630390167236328 |
----------------------------------------------------------pseudo_mini_loss sum 1.0119297504425049
Total (block generation + training)time/epoch 7.525884261206975
Training time/epoch 0.340745210647583
Training time without block to device /epoch 0.30562376976013184
Training time without total dataloading part /epoch 0.018438339233398438
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 54.43it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 13.91it/s]100%|██████████| 4/4 [00:00<00:00, 14.19it/s]100%|██████████| 4/4 [00:00<00:00, 14.13it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.52it/s]100%|██████████| 4/4 [00:00<00:00, 15.95it/s]100%|██████████| 4/4 [00:00<00:00, 16.15it/s]
Run 00 | Epoch 00072 | Loss 1.0119 | Train 0.2910 | Val 0.2615 | Test 0.2478
Number of nodes during this epoch:  332824
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16112136840820312  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01934814453125
range selection method range initialization spend 0.011743783950805664
time for parepare:  0.017154693603515625
local_output_nid generation:  0.01118612289428711
local_in_edges_tensor generation:  0.00945138931274414
mini_batch_src_global generation:  0.013155460357666016
r_  generation:  0.16712307929992676
local_output_nid generation:  0.011733055114746094
local_in_edges_tensor generation:  0.007699728012084961
mini_batch_src_global generation:  0.017139911651611328
r_  generation:  0.18147897720336914
----------------------check_connections_block total spend ----------------------------- 0.5053756237030029
generate_one_block  0.19764161109924316
generate_one_block  0.2005448341369629
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03157377243041992
gen group dst list time:  0.00667572021484375
time for parepare:  0.020012855529785156
local_output_nid generation:  0.018084287643432617
local_in_edges_tensor generation:  0.03945016860961914
mini_batch_src_global generation:  0.05771207809448242
r_  generation:  0.5214111804962158
local_output_nid generation:  0.027781963348388672
local_in_edges_tensor generation:  0.026035547256469727
mini_batch_src_global generation:  0.05832219123840332
r_  generation:  0.5152535438537598
----------------------check_connections_block total spend ----------------------------- 1.516002893447876
generate_one_block  0.6302995681762695
generate_one_block  0.6363406181335449
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029853343963623047
gen group dst list time:  0.012740135192871094
time for parepare:  0.020613908767700195
local_output_nid generation:  0.022867679595947266
local_in_edges_tensor generation:  0.03280806541442871
mini_batch_src_global generation:  0.04479646682739258
r_  generation:  0.5068228244781494
local_output_nid generation:  0.03235268592834473
local_in_edges_tensor generation:  0.03735208511352539
mini_batch_src_global generation:  0.056270599365234375
r_  generation:  0.5164046287536621
----------------------check_connections_block total spend ----------------------------- 1.4950358867645264
generate_one_block  0.6324794292449951
generate_one_block  0.6386525630950928
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16112136840820312  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

connection checking time:  3.0110387802124023
block generation total time  2.5377721786499023
average batch blocks generation time:  1.2688860893249512
block dataloader generation time/epoch 7.189453911036253
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11674642562866211  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.281628131866455  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1166996955871582  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2847003936767578  GigaBytes
Max Memory Allocated: 1.5396370887756348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08559668064117432 |0.020067334175109863 |0.004108786582946777 |0.0004905462265014648 |0.03827250003814697 |0.0029647350311279297 |
----------------------------------------------------------pseudo_mini_loss sum 1.0076708793640137
Total (block generation + training)time/epoch 7.526186972856522
Training time/epoch 0.3334221839904785
Training time without block to device /epoch 0.2932875156402588
Training time without total dataloading part /epoch 0.08870840072631836
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 62.24it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.99it/s]100%|██████████| 4/4 [00:00<00:00, 11.27it/s]100%|██████████| 4/4 [00:00<00:00, 11.36it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.17it/s]100%|██████████| 4/4 [00:00<00:00, 17.34it/s]100%|██████████| 4/4 [00:00<00:00, 17.29it/s]
Run 00 | Epoch 00073 | Loss 1.0077 | Train 0.2885 | Val 0.2580 | Test 0.2439
Number of nodes during this epoch:  332819
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1609787940979004  GigaBytes
Max Memory Allocated: 1.5398573875427246  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018709182739257812
range selection method range initialization spend 0.011936187744140625
time for parepare:  0.01757049560546875
local_output_nid generation:  0.010926961898803711
local_in_edges_tensor generation:  0.012224912643432617
mini_batch_src_global generation:  0.013631343841552734
r_  generation:  0.1697399616241455
local_output_nid generation:  0.011989593505859375
local_in_edges_tensor generation:  0.0071544647216796875
mini_batch_src_global generation:  0.01711583137512207
r_  generation:  0.18265914916992188
----------------------check_connections_block total spend ----------------------------- 0.5136885643005371
generate_one_block  0.19686293601989746
generate_one_block  0.19824600219726562
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.037634849548339844
gen group dst list time:  0.00668025016784668
time for parepare:  0.020817041397094727
local_output_nid generation:  0.017663240432739258
local_in_edges_tensor generation:  0.03503990173339844
mini_batch_src_global generation:  0.047577619552612305
r_  generation:  0.4911806583404541
local_output_nid generation:  0.027082443237304688
local_in_edges_tensor generation:  0.029340267181396484
mini_batch_src_global generation:  0.056490421295166016
r_  generation:  0.5008547306060791
----------------------check_connections_block total spend ----------------------------- 1.440948724746704
generate_one_block  0.6396663188934326
generate_one_block  0.6338543891906738
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02634429931640625
gen group dst list time:  0.012520313262939453
time for parepare:  0.019446849822998047
local_output_nid generation:  0.023211240768432617
local_in_edges_tensor generation:  0.03507566452026367
mini_batch_src_global generation:  0.04545283317565918
r_  generation:  0.5263023376464844
local_output_nid generation:  0.031801462173461914
local_in_edges_tensor generation:  0.04310035705566406
mini_batch_src_global generation:  0.05708456039428711
r_  generation:  0.5271737575531006
----------------------check_connections_block total spend ----------------------------- 1.5375864505767822
generate_one_block  0.664358377456665
generate_one_block  0.6627058982849121
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1609787940979004  GigaBytes
Max Memory Allocated: 1.5398573875427246  GigaBytes

connection checking time:  2.9785351753234863
block generation total time  2.6005849838256836
average batch blocks generation time:  1.3002924919128418
block dataloader generation time/epoch 7.190333956938524
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11681222915649414  GigaBytes
Max Memory Allocated: 1.5398573875427246  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.282114028930664  GigaBytes
Max Memory Allocated: 1.5398573875427246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11636590957641602  GigaBytes
Max Memory Allocated: 1.5398573875427246  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.280317783355713  GigaBytes
Max Memory Allocated: 1.5398573875427246  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08446240425109863 |0.024643421173095703 |0.0039975643157958984 |0.0004868507385253906 |0.004006147384643555 |0.0013027191162109375 |
----------------------------------------------------------pseudo_mini_loss sum 1.009372353553772
Total (block generation + training)time/epoch 7.527199088610136
Training time/epoch 0.34517860412597656
Training time without block to device /epoch 0.29589176177978516
Training time without total dataloading part /epoch 0.018283843994140625
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 49.20it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.95it/s]100%|██████████| 4/4 [00:00<00:00, 15.36it/s]100%|██████████| 4/4 [00:00<00:00, 15.28it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.39it/s]100%|██████████| 4/4 [00:00<00:00, 17.26it/s]100%|██████████| 4/4 [00:00<00:00, 17.26it/s]
Run 00 | Epoch 00074 | Loss 1.0094 | Train 0.2871 | Val 0.2560 | Test 0.2413
Number of nodes during this epoch:  332700
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16016530990600586  GigaBytes
Max Memory Allocated: 1.5398573875427246  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.017791748046875
range selection method range initialization spend 0.012228965759277344
time for parepare:  0.018228530883789062
local_output_nid generation:  0.011326074600219727
local_in_edges_tensor generation:  0.00996851921081543
mini_batch_src_global generation:  0.013559103012084961
r_  generation:  0.16938519477844238
local_output_nid generation:  0.011944055557250977
local_in_edges_tensor generation:  0.006468772888183594
mini_batch_src_global generation:  0.016943931579589844
r_  generation:  0.18086767196655273
----------------------check_connections_block total spend ----------------------------- 0.5092434883117676
generate_one_block  0.19713187217712402
generate_one_block  0.19922327995300293
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.031967878341674805
gen group dst list time:  0.006526470184326172
time for parepare:  0.020339012145996094
local_output_nid generation:  0.017589330673217773
local_in_edges_tensor generation:  0.030650615692138672
mini_batch_src_global generation:  0.04553532600402832
r_  generation:  0.487515926361084
local_output_nid generation:  0.026622295379638672
local_in_edges_tensor generation:  0.028683900833129883
mini_batch_src_global generation:  0.055047035217285156
r_  generation:  0.5068066120147705
----------------------check_connections_block total spend ----------------------------- 1.4386019706726074
generate_one_block  0.623112678527832
generate_one_block  0.6245248317718506
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.024473190307617188
gen group dst list time:  0.012498855590820312
time for parepare:  0.01986384391784668
local_output_nid generation:  0.023047208786010742
local_in_edges_tensor generation:  0.0324399471282959
mini_batch_src_global generation:  0.045381784439086914
r_  generation:  0.5090160369873047
local_output_nid generation:  0.03189682960510254
local_in_edges_tensor generation:  0.03473949432373047
mini_batch_src_global generation:  0.056441545486450195
r_  generation:  0.5188589096069336
----------------------check_connections_block total spend ----------------------------- 1.4954557418823242
generate_one_block  0.6337282657623291
generate_one_block  0.6420371532440186
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16016530990600586  GigaBytes
Max Memory Allocated: 1.5398573875427246  GigaBytes

connection checking time:  2.9340577125549316
block generation total time  2.5234029293060303
average batch blocks generation time:  1.2617014646530151
block dataloader generation time/epoch 7.188926144079729
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11676740646362305  GigaBytes
Max Memory Allocated: 1.5398573875427246  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2818474769592285  GigaBytes
Max Memory Allocated: 1.5398573875427246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11657333374023438  GigaBytes
Max Memory Allocated: 1.5398573875427246  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2809815406799316  GigaBytes
Max Memory Allocated: 1.5398573875427246  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07584190368652344 |0.02107560634613037 |0.003694772720336914 |0.0004917383193969727 |0.003661513328552246 |0.0027167797088623047 |
----------------------------------------------------------pseudo_mini_loss sum 1.0073738098144531
Total (block generation + training)time/epoch 7.525617910153938
Training time/epoch 0.32533812522888184
Training time without block to device /epoch 0.2831869125366211
Training time without total dataloading part /epoch 0.01841282844543457
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 57.40it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.02it/s]100%|██████████| 4/4 [00:00<00:00, 14.66it/s]100%|██████████| 4/4 [00:00<00:00, 14.70it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.03it/s]100%|██████████| 4/4 [00:00<00:00, 12.03it/s]100%|██████████| 4/4 [00:00<00:00, 12.57it/s]
Run 00 | Epoch 00075 | Loss 1.0074 | Train 0.2858 | Val 0.2536 | Test 0.2385
Number of nodes during this epoch:  332780
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16116094589233398  GigaBytes
Max Memory Allocated: 1.5398573875427246  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019044160842895508
range selection method range initialization spend 0.011953592300415039
time for parepare:  0.01665353775024414
local_output_nid generation:  0.01138448715209961
local_in_edges_tensor generation:  0.008669137954711914
mini_batch_src_global generation:  0.013490438461303711
r_  generation:  0.16918420791625977
local_output_nid generation:  0.01185750961303711
local_in_edges_tensor generation:  0.007745265960693359
mini_batch_src_global generation:  0.01718926429748535
r_  generation:  0.18101906776428223
----------------------check_connections_block total spend ----------------------------- 0.5065875053405762
generate_one_block  0.19712233543395996
generate_one_block  0.1999194622039795
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03234076499938965
gen group dst list time:  0.006630897521972656
time for parepare:  0.020099878311157227
local_output_nid generation:  0.017908811569213867
local_in_edges_tensor generation:  0.029433488845825195
mini_batch_src_global generation:  0.04504871368408203
r_  generation:  0.4858853816986084
local_output_nid generation:  0.0270078182220459
local_in_edges_tensor generation:  0.03165316581726074
mini_batch_src_global generation:  0.056285858154296875
r_  generation:  0.5072033405303955
----------------------check_connections_block total spend ----------------------------- 1.4370214939117432
generate_one_block  0.6237459182739258
generate_one_block  0.6333541870117188
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02618408203125
gen group dst list time:  0.01302647590637207
time for parepare:  0.018291711807250977
local_output_nid generation:  0.022808551788330078
local_in_edges_tensor generation:  0.038141727447509766
mini_batch_src_global generation:  0.04753875732421875
r_  generation:  0.5084834098815918
local_output_nid generation:  0.03179144859313965
local_in_edges_tensor generation:  0.03421473503112793
mini_batch_src_global generation:  0.05615735054016113
r_  generation:  0.5214059352874756
----------------------check_connections_block total spend ----------------------------- 1.5032086372375488
generate_one_block  0.6297402381896973
generate_one_block  0.6438870429992676
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16116094589233398  GigaBytes
Max Memory Allocated: 1.5398573875427246  GigaBytes

connection checking time:  2.940230131149292
block generation total time  2.5307273864746094
average batch blocks generation time:  1.2653636932373047
block dataloader generation time/epoch 7.187476346741861
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11671686172485352  GigaBytes
Max Memory Allocated: 1.5398573875427246  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2817034721374512  GigaBytes
Max Memory Allocated: 1.5398573875427246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11670827865600586  GigaBytes
Max Memory Allocated: 1.5398573875427246  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2849383354187012  GigaBytes
Max Memory Allocated: 1.5398573875427246  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08651041984558105 |0.015509486198425293 |0.0040509700775146484 |0.0005151033401489258 |0.00364840030670166 |0.0014188289642333984 |
----------------------------------------------------------pseudo_mini_loss sum 1.0012000799179077
Total (block generation + training)time/epoch 7.524121494435552
Training time/epoch 0.33342671394348145
Training time without block to device /epoch 0.30240774154663086
Training time without total dataloading part /epoch 0.017847776412963867
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 59.41it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.62it/s]100%|██████████| 4/4 [00:00<00:00, 15.11it/s]100%|██████████| 4/4 [00:00<00:00, 15.02it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.48it/s]100%|██████████| 4/4 [00:00<00:00, 16.91it/s]100%|██████████| 4/4 [00:00<00:00, 16.98it/s]
Run 00 | Epoch 00076 | Loss 1.0012 | Train 0.2845 | Val 0.2526 | Test 0.2366
Number of nodes during this epoch:  332825
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1620311737060547  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020713329315185547
range selection method range initialization spend 0.011968851089477539
time for parepare:  0.016837120056152344
local_output_nid generation:  0.010868310928344727
local_in_edges_tensor generation:  0.010011434555053711
mini_batch_src_global generation:  0.013592243194580078
r_  generation:  0.1689600944519043
local_output_nid generation:  0.011636495590209961
local_in_edges_tensor generation:  0.006545305252075195
mini_batch_src_global generation:  0.016997098922729492
r_  generation:  0.18197321891784668
----------------------check_connections_block total spend ----------------------------- 0.5074491500854492
generate_one_block  0.19798636436462402
generate_one_block  0.1983957290649414
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03257107734680176
gen group dst list time:  0.006618976593017578
time for parepare:  0.020145177841186523
local_output_nid generation:  0.017904996871948242
local_in_edges_tensor generation:  0.03595781326293945
mini_batch_src_global generation:  0.04709267616271973
r_  generation:  0.4870796203613281
local_output_nid generation:  0.026575565338134766
local_in_edges_tensor generation:  0.031362295150756836
mini_batch_src_global generation:  0.056023359298706055
r_  generation:  0.5019419193267822
----------------------check_connections_block total spend ----------------------------- 1.4386320114135742
generate_one_block  0.6242761611938477
generate_one_block  0.654024600982666
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.027241230010986328
gen group dst list time:  0.01253366470336914
time for parepare:  0.01903676986694336
local_output_nid generation:  0.02657175064086914
local_in_edges_tensor generation:  0.03393197059631348
mini_batch_src_global generation:  0.04770255088806152
r_  generation:  0.516127347946167
local_output_nid generation:  0.03178858757019043
local_in_edges_tensor generation:  0.03677988052368164
mini_batch_src_global generation:  0.05816507339477539
r_  generation:  0.5240507125854492
----------------------check_connections_block total spend ----------------------------- 1.5261499881744385
generate_one_block  0.6466681957244873
generate_one_block  0.6664340496063232
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1620311737060547  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

connection checking time:  2.9647819995880127
block generation total time  2.591403007507324
average batch blocks generation time:  1.295701503753662
block dataloader generation time/epoch 7.188222720342524
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11676836013793945  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2820491790771484  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11650466918945312  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2807369232177734  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08597397804260254 |0.02623295783996582 |0.004140496253967285 |0.0004922151565551758 |0.002871870994567871 |0.0016396045684814453 |
----------------------------------------------------------pseudo_mini_loss sum 0.9999587535858154
Total (block generation + training)time/epoch 7.5251445594955895
Training time/epoch 0.35532164573669434
Training time without block to device /epoch 0.3028557300567627
Training time without total dataloading part /epoch 0.01664876937866211
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 56.77it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.88it/s]100%|██████████| 4/4 [00:00<00:00, 15.36it/s]100%|██████████| 4/4 [00:00<00:00, 15.27it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.99it/s]100%|██████████| 4/4 [00:00<00:00, 17.70it/s]100%|██████████| 4/4 [00:00<00:00, 17.57it/s]
Run 00 | Epoch 00077 | Loss 1.0000 | Train 0.2835 | Val 0.2508 | Test 0.2345
Number of nodes during this epoch:  332824
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16115427017211914  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01729726791381836
range selection method range initialization spend 0.012181997299194336
time for parepare:  0.0178072452545166
local_output_nid generation:  0.010787010192871094
local_in_edges_tensor generation:  0.009286642074584961
mini_batch_src_global generation:  0.014529705047607422
r_  generation:  0.16788458824157715
local_output_nid generation:  0.01192784309387207
local_in_edges_tensor generation:  0.006227254867553711
mini_batch_src_global generation:  0.017388582229614258
r_  generation:  0.18137550354003906
----------------------check_connections_block total spend ----------------------------- 0.506779670715332
generate_one_block  0.20179224014282227
generate_one_block  0.19779467582702637
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02861785888671875
gen group dst list time:  0.006595611572265625
time for parepare:  0.019927501678466797
local_output_nid generation:  0.01798701286315918
local_in_edges_tensor generation:  0.03538703918457031
mini_batch_src_global generation:  0.04744863510131836
r_  generation:  0.486086368560791
local_output_nid generation:  0.026551008224487305
local_in_edges_tensor generation:  0.02792811393737793
mini_batch_src_global generation:  0.05468559265136719
r_  generation:  0.5070059299468994
----------------------check_connections_block total spend ----------------------------- 1.437157154083252
generate_one_block  0.6260256767272949
generate_one_block  0.6224982738494873
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.023199081420898438
gen group dst list time:  0.012440681457519531
time for parepare:  0.018166303634643555
local_output_nid generation:  0.022631406784057617
local_in_edges_tensor generation:  0.03337597846984863
mini_batch_src_global generation:  0.045485496520996094
r_  generation:  0.5069410800933838
local_output_nid generation:  0.031928062438964844
local_in_edges_tensor generation:  0.03648185729980469
mini_batch_src_global generation:  0.05645012855529785
r_  generation:  0.5185112953186035
----------------------check_connections_block total spend ----------------------------- 1.4949133396148682
generate_one_block  0.6392152309417725
generate_one_block  0.6448276042938232
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16115427017211914  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

connection checking time:  2.93207049369812
block generation total time  2.532566785812378
average batch blocks generation time:  1.266283392906189
block dataloader generation time/epoch 7.186878580977951
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11682271957397461  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.282456874847412  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11630725860595703  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2800183296203613  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08439385890960693 |0.015539407730102539 |0.0038313865661621094 |0.0005038976669311523 |0.0031090974807739258 |0.0021131038665771484 |
----------------------------------------------------------pseudo_mini_loss sum 0.9947616457939148
Total (block generation + training)time/epoch 7.52361117584118
Training time/epoch 0.323777437210083
Training time without block to device /epoch 0.29269862174987793
Training time without total dataloading part /epoch 0.017001867294311523
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 63.45it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.38it/s]100%|██████████| 4/4 [00:00<00:00, 15.46it/s]100%|██████████| 4/4 [00:00<00:00, 15.43it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.44it/s]100%|██████████| 4/4 [00:00<00:00, 17.45it/s]100%|██████████| 4/4 [00:00<00:00, 17.43it/s]
Run 00 | Epoch 00078 | Loss 0.9948 | Train 0.2824 | Val 0.2481 | Test 0.2310
Number of nodes during this epoch:  332750
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16012048721313477  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.017841100692749023
range selection method range initialization spend 0.012156486511230469
time for parepare:  0.017786264419555664
local_output_nid generation:  0.010837793350219727
local_in_edges_tensor generation:  0.012572526931762695
mini_batch_src_global generation:  0.013394832611083984
r_  generation:  0.17022943496704102
local_output_nid generation:  0.011576175689697266
local_in_edges_tensor generation:  0.006513833999633789
mini_batch_src_global generation:  0.016861438751220703
r_  generation:  0.18291926383972168
----------------------check_connections_block total spend ----------------------------- 0.5119907855987549
generate_one_block  0.1974470615386963
generate_one_block  0.20013689994812012
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03215956687927246
gen group dst list time:  0.006564140319824219
time for parepare:  0.020859956741333008
local_output_nid generation:  0.017828941345214844
local_in_edges_tensor generation:  0.03899645805358887
mini_batch_src_global generation:  0.0474853515625
r_  generation:  0.4917285442352295
local_output_nid generation:  0.026378154754638672
local_in_edges_tensor generation:  0.029887676239013672
mini_batch_src_global generation:  0.05472898483276367
r_  generation:  0.5006299018859863
----------------------check_connections_block total spend ----------------------------- 1.4421534538269043
generate_one_block  0.6260912418365479
generate_one_block  0.6410627365112305
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02556157112121582
gen group dst list time:  0.013878822326660156
time for parepare:  0.018267393112182617
local_output_nid generation:  0.023363113403320312
local_in_edges_tensor generation:  0.03474092483520508
mini_batch_src_global generation:  0.04508471488952637
r_  generation:  0.5156340599060059
local_output_nid generation:  0.031889915466308594
local_in_edges_tensor generation:  0.03246665000915527
mini_batch_src_global generation:  0.05751538276672363
r_  generation:  0.533595085144043
----------------------check_connections_block total spend ----------------------------- 1.520146131515503
generate_one_block  0.6526679992675781
generate_one_block  0.6641850471496582
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16012048721313477  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

connection checking time:  2.9622995853424072
block generation total time  2.5840070247650146
average batch blocks generation time:  1.2920035123825073
block dataloader generation time/epoch 7.187104228564671
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11675310134887695  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2823596000671387  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1164407730102539  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2805838584899902  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08429062366485596 |0.026294946670532227 |0.004771590232849121 |0.0005315542221069336 |0.0029093027114868164 |0.0019335746765136719 |
----------------------------------------------------------pseudo_mini_loss sum 0.9931412935256958
Total (block generation + training)time/epoch 7.523936132022313
Training time/epoch 0.3435490131378174
Training time without block to device /epoch 0.29095911979675293
Training time without total dataloading part /epoch 0.018358469009399414
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 50.71it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.15it/s]100%|██████████| 4/4 [00:00<00:00, 15.40it/s]100%|██████████| 4/4 [00:00<00:00, 15.35it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.34it/s]100%|██████████| 4/4 [00:00<00:00, 17.71it/s]100%|██████████| 4/4 [00:00<00:00, 17.64it/s]
Run 00 | Epoch 00079 | Loss 0.9931 | Train 0.2806 | Val 0.2447 | Test 0.2268
Number of nodes during this epoch:  332745
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16114187240600586  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022861719131469727
range selection method range initialization spend 0.011986494064331055
time for parepare:  0.016221046447753906
local_output_nid generation:  0.010908365249633789
local_in_edges_tensor generation:  0.010671854019165039
mini_batch_src_global generation:  0.01437830924987793
r_  generation:  0.168076753616333
local_output_nid generation:  0.011845827102661133
local_in_edges_tensor generation:  0.006680965423583984
mini_batch_src_global generation:  0.017082691192626953
r_  generation:  0.18347620964050293
----------------------check_connections_block total spend ----------------------------- 0.5098326206207275
generate_one_block  0.1966555118560791
generate_one_block  0.1998894214630127
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03496980667114258
gen group dst list time:  0.006541013717651367
time for parepare:  0.020203828811645508
local_output_nid generation:  0.017549514770507812
local_in_edges_tensor generation:  0.0349736213684082
mini_batch_src_global generation:  0.0462033748626709
r_  generation:  0.4932420253753662
local_output_nid generation:  0.02612018585205078
local_in_edges_tensor generation:  0.029994726181030273
mini_batch_src_global generation:  0.05460023880004883
r_  generation:  0.5090751647949219
----------------------check_connections_block total spend ----------------------------- 1.4484128952026367
generate_one_block  0.6363604068756104
generate_one_block  0.6479804515838623
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03757119178771973
gen group dst list time:  0.015222549438476562
time for parepare:  0.019771814346313477
local_output_nid generation:  0.024045228958129883
local_in_edges_tensor generation:  0.041725873947143555
mini_batch_src_global generation:  0.047739505767822266
r_  generation:  0.5167503356933594
local_output_nid generation:  0.032077789306640625
local_in_edges_tensor generation:  0.04098176956176758
mini_batch_src_global generation:  0.05572032928466797
r_  generation:  0.5175058841705322
----------------------check_connections_block total spend ----------------------------- 1.5227289199829102
generate_one_block  0.6354067325592041
generate_one_block  0.6481027603149414
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16114187240600586  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

connection checking time:  2.971141815185547
block generation total time  2.567850351333618
average batch blocks generation time:  1.283925175666809
block dataloader generation time/epoch 7.1872742444696565
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11676359176635742  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2822017669677734  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11646223068237305  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2801542282104492  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08455955982208252 |0.02087271213531494 |0.004105806350708008 |0.0005120038986206055 |0.002904653549194336 |0.0020334720611572266 |
----------------------------------------------------------pseudo_mini_loss sum 0.9934949278831482
Total (block generation + training)time/epoch 7.524152376282383
Training time/epoch 0.3399689197540283
Training time without block to device /epoch 0.29822349548339844
Training time without total dataloading part /epoch 0.017078399658203125
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 53.61it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.15it/s]100%|██████████| 4/4 [00:00<00:00, 15.47it/s]100%|██████████| 4/4 [00:00<00:00, 15.40it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.41it/s]100%|██████████| 4/4 [00:00<00:00, 17.76it/s]100%|██████████| 4/4 [00:00<00:00, 17.69it/s]
Run 00 | Epoch 00080 | Loss 0.9935 | Train 0.2779 | Val 0.2387 | Test 0.2208
Number of nodes during this epoch:  332768
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16107416152954102  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01800847053527832
range selection method range initialization spend 0.01217508316040039
time for parepare:  0.01610541343688965
local_output_nid generation:  0.0109710693359375
local_in_edges_tensor generation:  0.008573770523071289
mini_batch_src_global generation:  0.013468027114868164
r_  generation:  0.16686367988586426
local_output_nid generation:  0.011865377426147461
local_in_edges_tensor generation:  0.006035566329956055
mini_batch_src_global generation:  0.017182588577270508
r_  generation:  0.1829688549041748
----------------------check_connections_block total spend ----------------------------- 0.5047237873077393
generate_one_block  0.19634366035461426
generate_one_block  0.2009599208831787
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02588176727294922
gen group dst list time:  0.0064754486083984375
time for parepare:  0.019766569137573242
local_output_nid generation:  0.01785445213317871
local_in_edges_tensor generation:  0.02873969078063965
mini_batch_src_global generation:  0.04439568519592285
r_  generation:  0.4951763153076172
local_output_nid generation:  0.027799129486083984
local_in_edges_tensor generation:  0.02919936180114746
mini_batch_src_global generation:  0.056075096130371094
r_  generation:  0.5121903419494629
----------------------check_connections_block total spend ----------------------------- 1.448110580444336
generate_one_block  0.6692495346069336
generate_one_block  0.644517183303833
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03038763999938965
gen group dst list time:  0.014771223068237305
time for parepare:  0.01888728141784668
local_output_nid generation:  0.023965120315551758
local_in_edges_tensor generation:  0.04338502883911133
mini_batch_src_global generation:  0.048484086990356445
r_  generation:  0.5051407814025879
local_output_nid generation:  0.03142428398132324
local_in_edges_tensor generation:  0.03918957710266113
mini_batch_src_global generation:  0.05618023872375488
r_  generation:  0.5176215171813965
----------------------check_connections_block total spend ----------------------------- 1.5118739604949951
generate_one_block  0.6406800746917725
generate_one_block  0.6479172706604004
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16107416152954102  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

connection checking time:  2.959984540939331
block generation total time  2.6023640632629395
average batch blocks generation time:  1.3011820316314697
block dataloader generation time/epoch 7.187412261962891
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11674642562866211  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2818937301635742  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11657094955444336  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.281118392944336  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.10330343246459961 |0.020295381546020508 |0.004140257835388184 |0.0004906654357910156 |0.0025316476821899414 |0.0038657188415527344 |
----------------------------------------------------------pseudo_mini_loss sum 0.9914731383323669
Total (block generation + training)time/epoch 7.524805429908964
Training time/epoch 0.37381696701049805
Training time without block to device /epoch 0.33322620391845703
Training time without total dataloading part /epoch 0.018190860748291016
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 51.89it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.89it/s]100%|██████████| 4/4 [00:00<00:00, 15.40it/s]100%|██████████| 4/4 [00:00<00:00, 15.30it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.45it/s]100%|██████████| 4/4 [00:00<00:00, 17.65it/s]100%|██████████| 4/4 [00:00<00:00, 17.60it/s]
Run 00 | Epoch 00081 | Loss 0.9915 | Train 0.2748 | Val 0.2328 | Test 0.2143
Number of nodes during this epoch:  332876
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16108369827270508  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02287459373474121
range selection method range initialization spend 0.012517929077148438
time for parepare:  0.017001867294311523
local_output_nid generation:  0.011117935180664062
local_in_edges_tensor generation:  0.01005411148071289
mini_batch_src_global generation:  0.01436471939086914
r_  generation:  0.17321109771728516
local_output_nid generation:  0.012582778930664062
local_in_edges_tensor generation:  0.007303714752197266
mini_batch_src_global generation:  0.024814605712890625
r_  generation:  0.18852567672729492
----------------------check_connections_block total spend ----------------------------- 0.531287670135498
generate_one_block  0.20233488082885742
generate_one_block  0.20383954048156738
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04048466682434082
gen group dst list time:  0.0065271854400634766
time for parepare:  0.01987457275390625
local_output_nid generation:  0.017601966857910156
local_in_edges_tensor generation:  0.040572404861450195
mini_batch_src_global generation:  0.04570746421813965
r_  generation:  0.49462318420410156
local_output_nid generation:  0.027158498764038086
local_in_edges_tensor generation:  0.035170793533325195
mini_batch_src_global generation:  0.055613040924072266
r_  generation:  0.5035445690155029
----------------------check_connections_block total spend ----------------------------- 1.4588451385498047
generate_one_block  0.6298708915710449
generate_one_block  0.650336503982544
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.034316062927246094
gen group dst list time:  0.012910604476928711
time for parepare:  0.018810749053955078
local_output_nid generation:  0.023508071899414062
local_in_edges_tensor generation:  0.04806637763977051
mini_batch_src_global generation:  0.051464080810546875
r_  generation:  0.529151201248169
local_output_nid generation:  0.0359036922454834
local_in_edges_tensor generation:  0.03941655158996582
mini_batch_src_global generation:  0.056740522384643555
r_  generation:  0.517099142074585
----------------------check_connections_block total spend ----------------------------- 1.5501444339752197
generate_one_block  0.6511542797088623
generate_one_block  0.6505193710327148
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16108369827270508  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

connection checking time:  3.0089895725250244
block generation total time  2.581881046295166
average batch blocks generation time:  1.290940523147583
block dataloader generation time/epoch 7.189300625291589
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11673784255981445  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2821731567382812  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11657238006591797  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.280886173248291  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07800066471099854 |0.021766304969787598 |0.004281044006347656 |0.0005333423614501953 |0.004080057144165039 |0.002930879592895508 |
----------------------------------------------------------pseudo_mini_loss sum 0.9888156652450562
Total (block generation + training)time/epoch 7.526624924516025
Training time/epoch 0.3322110176086426
Training time without block to device /epoch 0.2886784076690674
Training time without total dataloading part /epoch 0.02071976661682129
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 46.31it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.00it/s]100%|██████████| 4/4 [00:00<00:00, 15.25it/s]100%|██████████| 4/4 [00:00<00:00, 15.20it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.10it/s]100%|██████████| 4/4 [00:00<00:00, 16.98it/s]100%|██████████| 4/4 [00:00<00:00, 16.98it/s]
Run 00 | Epoch 00082 | Loss 0.9888 | Train 0.2723 | Val 0.2264 | Test 0.2090
Number of nodes during this epoch:  332844
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16116094589233398  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019815444946289062
range selection method range initialization spend 0.012357473373413086
time for parepare:  0.017742395401000977
local_output_nid generation:  0.011072158813476562
local_in_edges_tensor generation:  0.01412200927734375
mini_batch_src_global generation:  0.013261079788208008
r_  generation:  0.1704881191253662
local_output_nid generation:  0.011826276779174805
local_in_edges_tensor generation:  0.00667262077331543
mini_batch_src_global generation:  0.01689434051513672
r_  generation:  0.18036627769470215
----------------------check_connections_block total spend ----------------------------- 0.512134313583374
generate_one_block  0.19710111618041992
generate_one_block  0.19745731353759766
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.035654306411743164
gen group dst list time:  0.006552219390869141
time for parepare:  0.019772768020629883
local_output_nid generation:  0.01786494255065918
local_in_edges_tensor generation:  0.037245988845825195
mini_batch_src_global generation:  0.04524660110473633
r_  generation:  0.490339994430542
local_output_nid generation:  0.02729058265686035
local_in_edges_tensor generation:  0.031958580017089844
mini_batch_src_global generation:  0.05512070655822754
r_  generation:  0.5009286403656006
----------------------check_connections_block total spend ----------------------------- 1.4410121440887451
generate_one_block  0.6240344047546387
generate_one_block  0.6345195770263672
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.023140668869018555
gen group dst list time:  0.012273550033569336
time for parepare:  0.018381357192993164
local_output_nid generation:  0.023380756378173828
local_in_edges_tensor generation:  0.03530120849609375
mini_batch_src_global generation:  0.04621100425720215
r_  generation:  0.5117583274841309
local_output_nid generation:  0.032052040100097656
local_in_edges_tensor generation:  0.038385629653930664
mini_batch_src_global generation:  0.05583524703979492
r_  generation:  0.5253355503082275
----------------------check_connections_block total spend ----------------------------- 1.510573148727417
generate_one_block  0.6459674835205078
generate_one_block  0.6480526924133301
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16116094589233398  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

connection checking time:  2.951585292816162
block generation total time  2.5525741577148438
average batch blocks generation time:  1.2762870788574219
block dataloader generation time/epoch 7.18928168271039
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11675691604614258  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.282038688659668  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11653709411621094  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2807083129882812  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08018183708190918 |0.02509748935699463 |0.004008889198303223 |0.00048744678497314453 |0.0032835006713867188 |0.0019593238830566406 |
----------------------------------------------------------pseudo_mini_loss sum 0.9862799048423767
Total (block generation + training)time/epoch 7.526704775320517
Training time/epoch 0.34449291229248047
Training time without block to device /epoch 0.2942979335784912
Training time without total dataloading part /epoch 0.017518997192382812
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 56.02it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.96it/s]100%|██████████| 4/4 [00:00<00:00, 15.56it/s]100%|██████████| 4/4 [00:00<00:00, 15.45it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.21it/s]100%|██████████| 4/4 [00:00<00:00, 17.36it/s]100%|██████████| 4/4 [00:00<00:00, 17.32it/s]
Run 00 | Epoch 00083 | Loss 0.9863 | Train 0.2704 | Val 0.2213 | Test 0.2034
Number of nodes during this epoch:  332833
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16112089157104492  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021758556365966797
range selection method range initialization spend 0.011837244033813477
time for parepare:  0.018246889114379883
local_output_nid generation:  0.011046171188354492
local_in_edges_tensor generation:  0.008477210998535156
mini_batch_src_global generation:  0.013215065002441406
r_  generation:  0.16619658470153809
local_output_nid generation:  0.012006521224975586
local_in_edges_tensor generation:  0.006618976593017578
mini_batch_src_global generation:  0.017369508743286133
r_  generation:  0.18663549423217773
----------------------check_connections_block total spend ----------------------------- 0.5092451572418213
generate_one_block  0.2036902904510498
generate_one_block  0.20094752311706543
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.034513235092163086
gen group dst list time:  0.0065310001373291016
time for parepare:  0.01972651481628418
local_output_nid generation:  0.01751995086669922
local_in_edges_tensor generation:  0.03723740577697754
mini_batch_src_global generation:  0.047594308853149414
r_  generation:  0.4871351718902588
local_output_nid generation:  0.026901721954345703
local_in_edges_tensor generation:  0.032189130783081055
mini_batch_src_global generation:  0.05607151985168457
r_  generation:  0.5045790672302246
----------------------check_connections_block total spend ----------------------------- 1.4447884559631348
generate_one_block  0.6170639991760254
generate_one_block  0.6277098655700684
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.026226520538330078
gen group dst list time:  0.014601469039916992
time for parepare:  0.017883777618408203
local_output_nid generation:  0.022652149200439453
local_in_edges_tensor generation:  0.03195834159851074
mini_batch_src_global generation:  0.04712653160095215
r_  generation:  0.5107104778289795
local_output_nid generation:  0.031934499740600586
local_in_edges_tensor generation:  0.03966259956359863
mini_batch_src_global generation:  0.057008981704711914
r_  generation:  0.5193743705749512
----------------------check_connections_block total spend ----------------------------- 1.5020382404327393
generate_one_block  0.6459524631500244
generate_one_block  0.653066873550415
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16112089157104492  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

connection checking time:  2.946826696395874
block generation total time  2.543793201446533
average batch blocks generation time:  1.2718966007232666
block dataloader generation time/epoch 7.188868363698323
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11670923233032227  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2820930480957031  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11661624908447266  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2809977531433105  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08810341358184814 |0.021042585372924805 |0.003856182098388672 |0.00048744678497314453 |0.002747178077697754 |0.0013778209686279297 |
----------------------------------------------------------pseudo_mini_loss sum 0.9851256012916565
Total (block generation + training)time/epoch 7.526434230804443
Training time/epoch 0.3479886054992676
Training time without block to device /epoch 0.30590343475341797
Training time without total dataloading part /epoch 0.01555943489074707
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 35.32it/s]100%|██████████| 4/4 [00:00<00:00, 35.23it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.56it/s]100%|██████████| 4/4 [00:00<00:00, 15.13it/s]100%|██████████| 4/4 [00:00<00:00, 15.02it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.15it/s]100%|██████████| 4/4 [00:00<00:00, 17.47it/s]100%|██████████| 4/4 [00:00<00:00, 17.40it/s]
Run 00 | Epoch 00084 | Loss 0.9851 | Train 0.2686 | Val 0.2159 | Test 0.1974
Number of nodes during this epoch:  332849
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16117429733276367  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019051790237426758
range selection method range initialization spend 0.01208806037902832
time for parepare:  0.017859220504760742
local_output_nid generation:  0.010872125625610352
local_in_edges_tensor generation:  0.012376070022583008
mini_batch_src_global generation:  0.014125823974609375
r_  generation:  0.16834211349487305
local_output_nid generation:  0.011966466903686523
local_in_edges_tensor generation:  0.006171226501464844
mini_batch_src_global generation:  0.016872167587280273
r_  generation:  0.18277454376220703
----------------------check_connections_block total spend ----------------------------- 0.5110423564910889
generate_one_block  0.19678997993469238
generate_one_block  0.19934821128845215
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.025936126708984375
gen group dst list time:  0.006629228591918945
time for parepare:  0.01995110511779785
local_output_nid generation:  0.018054962158203125
local_in_edges_tensor generation:  0.03777623176574707
mini_batch_src_global generation:  0.047087669372558594
r_  generation:  0.48545289039611816
local_output_nid generation:  0.026713848114013672
local_in_edges_tensor generation:  0.02938985824584961
mini_batch_src_global generation:  0.05822443962097168
r_  generation:  0.505256175994873
----------------------check_connections_block total spend ----------------------------- 1.4425036907196045
generate_one_block  0.6298196315765381
generate_one_block  0.6232278347015381
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02655339241027832
gen group dst list time:  0.012428522109985352
time for parepare:  0.01839470863342285
local_output_nid generation:  0.0232086181640625
local_in_edges_tensor generation:  0.03287529945373535
mini_batch_src_global generation:  0.046776771545410156
r_  generation:  0.5130453109741211
local_output_nid generation:  0.03196430206298828
local_in_edges_tensor generation:  0.03913998603820801
mini_batch_src_global generation:  0.05611157417297363
r_  generation:  0.5274074077606201
----------------------check_connections_block total spend ----------------------------- 1.5146777629852295
generate_one_block  0.6593868732452393
generate_one_block  0.6439149379730225
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16117429733276367  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

connection checking time:  2.957181453704834
block generation total time  2.556349277496338
average batch blocks generation time:  1.278174638748169
block dataloader generation time/epoch 7.188495839896955
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11674737930297852  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2824158668518066  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1164712905883789  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2810783386230469  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08450675010681152 |0.028805971145629883 |0.004052877426147461 |0.00048828125 |0.0033583641052246094 |0.0023851394653320312 |
----------------------------------------------------------pseudo_mini_loss sum 0.9803134202957153
Total (block generation + training)time/epoch 7.526169620062175
Training time/epoch 0.3456089496612549
Training time without block to device /epoch 0.2879970073699951
Training time without total dataloading part /epoch 0.018184185028076172
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 51.13it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.04it/s]100%|██████████| 4/4 [00:00<00:00, 15.25it/s]100%|██████████| 4/4 [00:00<00:00, 15.20it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.48it/s]100%|██████████| 4/4 [00:00<00:00, 17.47it/s]100%|██████████| 4/4 [00:00<00:00, 17.45it/s]
Run 00 | Epoch 00085 | Loss 0.9803 | Train 0.2659 | Val 0.2108 | Test 0.1916
Number of nodes during this epoch:  332804
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1611013412475586  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019467830657958984
range selection method range initialization spend 0.012236356735229492
time for parepare:  0.016173839569091797
local_output_nid generation:  0.011113166809082031
local_in_edges_tensor generation:  0.010016441345214844
mini_batch_src_global generation:  0.013252019882202148
r_  generation:  0.16881704330444336
local_output_nid generation:  0.011939287185668945
local_in_edges_tensor generation:  0.0072405338287353516
mini_batch_src_global generation:  0.017553329467773438
r_  generation:  0.18234729766845703
----------------------check_connections_block total spend ----------------------------- 0.5078444480895996
generate_one_block  0.19654417037963867
generate_one_block  0.19817256927490234
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03413820266723633
gen group dst list time:  0.006584882736206055
time for parepare:  0.019669532775878906
local_output_nid generation:  0.01795196533203125
local_in_edges_tensor generation:  0.034446001052856445
mini_batch_src_global generation:  0.04462170600891113
r_  generation:  0.48850464820861816
local_output_nid generation:  0.027562379837036133
local_in_edges_tensor generation:  0.027537822723388672
mini_batch_src_global generation:  0.057091712951660156
r_  generation:  0.49875640869140625
----------------------check_connections_block total spend ----------------------------- 1.4314837455749512
generate_one_block  0.623464822769165
generate_one_block  0.6211287975311279
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025850772857666016
gen group dst list time:  0.012267112731933594
time for parepare:  0.018332481384277344
local_output_nid generation:  0.02274489402770996
local_in_edges_tensor generation:  0.03527712821960449
mini_batch_src_global generation:  0.049147605895996094
r_  generation:  0.5111091136932373
local_output_nid generation:  0.03194284439086914
local_in_edges_tensor generation:  0.038182735443115234
mini_batch_src_global generation:  0.05647873878479004
r_  generation:  0.5164978504180908
----------------------check_connections_block total spend ----------------------------- 1.5019865036010742
generate_one_block  0.6330838203430176
generate_one_block  0.6455643177032471
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1611013412475586  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

connection checking time:  2.9334702491760254
block generation total time  2.5232417583465576
average batch blocks generation time:  1.2616208791732788
block dataloader generation time/epoch 7.187325808909033
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1167607307434082  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2818312644958496  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11658430099487305  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2806196212768555  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09092485904693604 |0.01696634292602539 |0.004189252853393555 |0.0005762577056884766 |0.003245115280151367 |0.0013256072998046875 |
----------------------------------------------------------pseudo_mini_loss sum 0.9817993640899658
Total (block generation + training)time/epoch 7.525139619777729
Training time/epoch 0.3483710289001465
Training time without block to device /epoch 0.3144383430480957
Training time without total dataloading part /epoch 0.017346858978271484
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 62.19it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.53it/s]100%|██████████| 4/4 [00:00<00:00, 14.25it/s]100%|██████████| 4/4 [00:00<00:00, 14.28it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.10it/s]100%|██████████| 4/4 [00:00<00:00, 17.00it/s]100%|██████████| 4/4 [00:00<00:00, 16.84it/s]
Run 00 | Epoch 00086 | Loss 0.9818 | Train 0.2630 | Val 0.2061 | Test 0.1862
Number of nodes during this epoch:  332800
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16115140914916992  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023398876190185547
range selection method range initialization spend 0.011648893356323242
time for parepare:  0.016686439514160156
local_output_nid generation:  0.010839700698852539
local_in_edges_tensor generation:  0.011392354965209961
mini_batch_src_global generation:  0.014306306838989258
r_  generation:  0.16808247566223145
local_output_nid generation:  0.01183462142944336
local_in_edges_tensor generation:  0.007333278656005859
mini_batch_src_global generation:  0.01705479621887207
r_  generation:  0.1792430877685547
----------------------check_connections_block total spend ----------------------------- 0.5087909698486328
generate_one_block  0.20478510856628418
generate_one_block  0.20187926292419434
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03303885459899902
gen group dst list time:  0.006498813629150391
time for parepare:  0.02244114875793457
local_output_nid generation:  0.01871514320373535
local_in_edges_tensor generation:  0.04169726371765137
mini_batch_src_global generation:  0.04819226264953613
r_  generation:  0.48921990394592285
local_output_nid generation:  0.026375770568847656
local_in_edges_tensor generation:  0.03017878532409668
mini_batch_src_global generation:  0.05689501762390137
r_  generation:  0.4973475933074951
----------------------check_connections_block total spend ----------------------------- 1.451721429824829
generate_one_block  0.6341230869293213
generate_one_block  0.6542701721191406
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0345458984375
gen group dst list time:  0.014714956283569336
time for parepare:  0.018619775772094727
local_output_nid generation:  0.02270674705505371
local_in_edges_tensor generation:  0.047966718673706055
mini_batch_src_global generation:  0.04776406288146973
r_  generation:  0.5056972503662109
local_output_nid generation:  0.031208276748657227
local_in_edges_tensor generation:  0.04435253143310547
mini_batch_src_global generation:  0.05658316612243652
r_  generation:  0.5172672271728516
----------------------check_connections_block total spend ----------------------------- 1.5166339874267578
generate_one_block  0.6346940994262695
generate_one_block  0.6609978675842285
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16115140914916992  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

connection checking time:  2.968355417251587
block generation total time  2.58408522605896
average batch blocks generation time:  1.29204261302948
block dataloader generation time/epoch 7.187845233159187
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11676549911499023  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2822141647338867  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11647653579711914  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.280278205871582  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08193695545196533 |0.02066957950592041 |0.004035592079162598 |0.0005190372467041016 |0.0024639368057250977 |0.001979827880859375 |
----------------------------------------------------------pseudo_mini_loss sum 0.9788486957550049
Total (block generation + training)time/epoch 7.525499264399211
Training time/epoch 0.32520389556884766
Training time without block to device /epoch 0.28386473655700684
Training time without total dataloading part /epoch 0.01601696014404297
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 54.45it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.75it/s]100%|██████████| 4/4 [00:00<00:00, 15.49it/s]100%|██████████| 4/4 [00:00<00:00, 15.36it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.21it/s]100%|██████████| 4/4 [00:00<00:00, 18.61it/s]
Run 00 | Epoch 00087 | Loss 0.9788 | Train 0.2605 | Val 0.2022 | Test 0.1822
Number of nodes during this epoch:  332794
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16013622283935547  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019628524780273438
range selection method range initialization spend 0.011879205703735352
time for parepare:  0.01620960235595703
local_output_nid generation:  0.010988712310791016
local_in_edges_tensor generation:  0.00852346420288086
mini_batch_src_global generation:  0.017319202423095703
r_  generation:  0.1669628620147705
local_output_nid generation:  0.012328624725341797
local_in_edges_tensor generation:  0.006792306900024414
mini_batch_src_global generation:  0.017998218536376953
r_  generation:  0.1823263168334961
----------------------check_connections_block total spend ----------------------------- 0.5101888179779053
generate_one_block  0.19789338111877441
generate_one_block  0.2042989730834961
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.037544965744018555
gen group dst list time:  0.006584882736206055
time for parepare:  0.02010798454284668
local_output_nid generation:  0.017891645431518555
local_in_edges_tensor generation:  0.0403592586517334
mini_batch_src_global generation:  0.04555511474609375
r_  generation:  0.483013391494751
local_output_nid generation:  0.027103185653686523
local_in_edges_tensor generation:  0.03518342971801758
mini_batch_src_global generation:  0.05519604682922363
r_  generation:  0.49854612350463867
----------------------check_connections_block total spend ----------------------------- 1.4360737800598145
generate_one_block  0.6182386875152588
generate_one_block  0.6270451545715332
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02834606170654297
gen group dst list time:  0.012379169464111328
time for parepare:  0.018173694610595703
local_output_nid generation:  0.02284979820251465
local_in_edges_tensor generation:  0.034552812576293945
mini_batch_src_global generation:  0.04757547378540039
r_  generation:  0.5034372806549072
local_output_nid generation:  0.0311892032623291
local_in_edges_tensor generation:  0.03994011878967285
mini_batch_src_global generation:  0.05884838104248047
r_  generation:  0.5205531120300293
----------------------check_connections_block total spend ----------------------------- 1.4980008602142334
generate_one_block  0.6354918479919434
generate_one_block  0.6350674629211426
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16013622283935547  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

connection checking time:  2.934074640274048
block generation total time  2.515843152999878
average batch blocks generation time:  1.257921576499939
block dataloader generation time/epoch 7.186846072160745
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11677408218383789  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2818875312805176  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11650657653808594  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2807025909423828  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0847846269607544 |0.015382528305053711 |0.004025697708129883 |0.0005004405975341797 |0.0037660598754882812 |0.0014789104461669922 |
----------------------------------------------------------pseudo_mini_loss sum 0.9748852252960205
Total (block generation + training)time/epoch 7.52446856378
Training time/epoch 0.33501696586608887
Training time without block to device /epoch 0.30425190925598145
Training time without total dataloading part /epoch 0.01806330680847168
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 62.24it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.02it/s]100%|██████████| 4/4 [00:00<00:00, 15.41it/s]100%|██████████| 4/4 [00:00<00:00, 15.34it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.92it/s]100%|██████████| 4/4 [00:00<00:00, 17.31it/s]100%|██████████| 4/4 [00:00<00:00, 17.23it/s]
Run 00 | Epoch 00088 | Loss 0.9749 | Train 0.2588 | Val 0.1986 | Test 0.1780
Number of nodes during this epoch:  332773
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16019535064697266  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020044565200805664
range selection method range initialization spend 0.011586427688598633
time for parepare:  0.017578125
local_output_nid generation:  0.010777950286865234
local_in_edges_tensor generation:  0.00991678237915039
mini_batch_src_global generation:  0.01428365707397461
r_  generation:  0.168684720993042
local_output_nid generation:  0.012069225311279297
local_in_edges_tensor generation:  0.006089925765991211
mini_batch_src_global generation:  0.017660140991210938
r_  generation:  0.18213105201721191
----------------------check_connections_block total spend ----------------------------- 0.5098841190338135
generate_one_block  0.196441650390625
generate_one_block  0.2000889778137207
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.034529924392700195
gen group dst list time:  0.0064373016357421875
time for parepare:  0.019658565521240234
local_output_nid generation:  0.017252445220947266
local_in_edges_tensor generation:  0.03264021873474121
mini_batch_src_global generation:  0.04577994346618652
r_  generation:  0.4844064712524414
local_output_nid generation:  0.026623010635375977
local_in_edges_tensor generation:  0.029714107513427734
mini_batch_src_global generation:  0.055214643478393555
r_  generation:  0.4924933910369873
----------------------check_connections_block total spend ----------------------------- 1.4174954891204834
generate_one_block  0.6184391975402832
generate_one_block  0.6203534603118896
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.027388572692871094
gen group dst list time:  0.012766361236572266
time for parepare:  0.018031835556030273
local_output_nid generation:  0.02233409881591797
local_in_edges_tensor generation:  0.031914472579956055
mini_batch_src_global generation:  0.04964017868041992
r_  generation:  0.5090129375457764
local_output_nid generation:  0.03169512748718262
local_in_edges_tensor generation:  0.030351877212524414
mini_batch_src_global generation:  0.06084012985229492
r_  generation:  0.5185518264770508
----------------------check_connections_block total spend ----------------------------- 1.4957201480865479
generate_one_block  0.6406197547912598
generate_one_block  0.6369471549987793
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16019535064697266  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

connection checking time:  2.9132156372070312
block generation total time  2.516359567642212
average batch blocks generation time:  1.258179783821106
block dataloader generation time/epoch 7.185403236746788
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11677694320678711  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2819786071777344  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11646795272827148  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.280588150024414  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07630789279937744 |0.01819002628326416 |0.0037689208984375 |0.0004849433898925781 |0.0025485754013061523 |0.0018939971923828125 |
----------------------------------------------------------pseudo_mini_loss sum 0.9735186100006104
Total (block generation + training)time/epoch 7.522701761126518
Training time/epoch 0.3116035461425781
Training time without block to device /epoch 0.2752234935760498
Training time without total dataloading part /epoch 0.015498876571655273
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 56.60it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.84it/s]100%|██████████| 4/4 [00:00<00:00, 15.40it/s]100%|██████████| 4/4 [00:00<00:00, 15.30it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.73it/s]100%|██████████| 4/4 [00:00<00:00, 16.70it/s]100%|██████████| 4/4 [00:00<00:00, 16.69it/s]
Run 00 | Epoch 00089 | Loss 0.9735 | Train 0.2579 | Val 0.1949 | Test 0.1749
Number of nodes during this epoch:  332692
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16109848022460938  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022599458694458008
range selection method range initialization spend 0.011811017990112305
time for parepare:  0.016724348068237305
local_output_nid generation:  0.010845661163330078
local_in_edges_tensor generation:  0.009368896484375
mini_batch_src_global generation:  0.014198780059814453
r_  generation:  0.16918063163757324
local_output_nid generation:  0.012358427047729492
local_in_edges_tensor generation:  0.006094217300415039
mini_batch_src_global generation:  0.01772475242614746
r_  generation:  0.18225526809692383
----------------------check_connections_block total spend ----------------------------- 0.5089011192321777
generate_one_block  0.1966569423675537
generate_one_block  0.19985461235046387
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030631542205810547
gen group dst list time:  0.006508588790893555
time for parepare:  0.019777297973632812
local_output_nid generation:  0.017833232879638672
local_in_edges_tensor generation:  0.03621101379394531
mini_batch_src_global generation:  0.04585146903991699
r_  generation:  0.4989044666290283
local_output_nid generation:  0.026996374130249023
local_in_edges_tensor generation:  0.029410600662231445
mini_batch_src_global generation:  0.055843353271484375
r_  generation:  0.499988317489624
----------------------check_connections_block total spend ----------------------------- 1.4447448253631592
generate_one_block  0.6289575099945068
generate_one_block  0.6337544918060303
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02756977081298828
gen group dst list time:  0.012409448623657227
time for parepare:  0.018601179122924805
local_output_nid generation:  0.02315521240234375
local_in_edges_tensor generation:  0.041915178298950195
mini_batch_src_global generation:  0.046959638595581055
r_  generation:  0.5129377841949463
local_output_nid generation:  0.03366684913635254
local_in_edges_tensor generation:  0.03792977333068848
mini_batch_src_global generation:  0.05735325813293457
r_  generation:  0.5219082832336426
----------------------check_connections_block total spend ----------------------------- 1.520341157913208
generate_one_block  0.6410119533538818
generate_one_block  0.6740140914916992
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16109848022460938  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

connection checking time:  2.965085983276367
block generation total time  2.577738046646118
average batch blocks generation time:  1.288869023323059
block dataloader generation time/epoch 7.185550233464182
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11673974990844727  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2821016311645508  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11646699905395508  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2802867889404297  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08383870124816895 |0.025180459022521973 |0.00428009033203125 |0.0005148649215698242 |0.004015088081359863 |0.0013833045959472656 |
----------------------------------------------------------pseudo_mini_loss sum 0.9706602096557617
Total (block generation + training)time/epoch 7.522928184933132
Training time/epoch 0.34359216690063477
Training time without block to device /epoch 0.2932312488555908
Training time without total dataloading part /epoch 0.01900339126586914
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 53.54it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.01it/s]100%|██████████| 4/4 [00:00<00:00, 15.44it/s]100%|██████████| 4/4 [00:00<00:00, 15.36it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.93it/s]100%|██████████| 4/4 [00:00<00:00, 17.37it/s]100%|██████████| 4/4 [00:00<00:00, 17.29it/s]
Run 00 | Epoch 00090 | Loss 0.9707 | Train 0.2560 | Val 0.1920 | Test 0.1720
Number of nodes during this epoch:  332730
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1611328125  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018861770629882812
range selection method range initialization spend 0.012123584747314453
time for parepare:  0.017553091049194336
local_output_nid generation:  0.011082649230957031
local_in_edges_tensor generation:  0.01063394546508789
mini_batch_src_global generation:  0.01366567611694336
r_  generation:  0.16864228248596191
local_output_nid generation:  0.012314081192016602
local_in_edges_tensor generation:  0.0066030025482177734
mini_batch_src_global generation:  0.017646312713623047
r_  generation:  0.18170428276062012
----------------------check_connections_block total spend ----------------------------- 0.5106935501098633
generate_one_block  0.19796156883239746
generate_one_block  0.19943857192993164
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03722500801086426
gen group dst list time:  0.006573200225830078
time for parepare:  0.019804954528808594
local_output_nid generation:  0.017710447311401367
local_in_edges_tensor generation:  0.03693747520446777
mini_batch_src_global generation:  0.05034375190734863
r_  generation:  0.4901707172393799
local_output_nid generation:  0.027152299880981445
local_in_edges_tensor generation:  0.03531646728515625
mini_batch_src_global generation:  0.05596637725830078
r_  generation:  0.5085783004760742
----------------------check_connections_block total spend ----------------------------- 1.4560492038726807
generate_one_block  0.6302201747894287
generate_one_block  0.6273918151855469
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.026619911193847656
gen group dst list time:  0.012376070022583008
time for parepare:  0.018647193908691406
local_output_nid generation:  0.024932384490966797
local_in_edges_tensor generation:  0.03236103057861328
mini_batch_src_global generation:  0.04827094078063965
r_  generation:  0.5117533206939697
local_output_nid generation:  0.03193807601928711
local_in_edges_tensor generation:  0.03349804878234863
mini_batch_src_global generation:  0.05836939811706543
r_  generation:  0.5179269313812256
----------------------check_connections_block total spend ----------------------------- 1.5037288665771484
generate_one_block  0.6411643028259277
generate_one_block  0.6381564140319824
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1611328125  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

connection checking time:  2.959778070449829
block generation total time  2.5369327068328857
average batch blocks generation time:  1.2684663534164429
block dataloader generation time/epoch 7.185083482323623
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11677885055541992  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2822494506835938  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11645269393920898  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2807164192199707  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0787043571472168 |0.014906883239746094 |0.0036852359771728516 |0.0004782676696777344 |0.0026129484176635742 |0.0013606548309326172 |
----------------------------------------------------------pseudo_mini_loss sum 0.9700086116790771
Total (block generation + training)time/epoch 7.522174928246475
Training time/epoch 0.31379103660583496
Training time without block to device /epoch 0.2839772701263428
Training time without total dataloading part /epoch 0.014913558959960938
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 63.86it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.02it/s]100%|██████████| 4/4 [00:00<00:00, 15.45it/s]100%|██████████| 4/4 [00:00<00:00, 15.37it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.08it/s]100%|██████████| 4/4 [00:00<00:00, 17.19it/s]100%|██████████| 4/4 [00:00<00:00, 17.16it/s]
Run 00 | Epoch 00091 | Loss 0.9700 | Train 0.2544 | Val 0.1899 | Test 0.1690
Number of nodes during this epoch:  332756
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16114234924316406  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01703190803527832
range selection method range initialization spend 0.011470556259155273
time for parepare:  0.016483783721923828
local_output_nid generation:  0.010859489440917969
local_in_edges_tensor generation:  0.00830078125
mini_batch_src_global generation:  0.013686895370483398
r_  generation:  0.16820812225341797
local_output_nid generation:  0.012222528457641602
local_in_edges_tensor generation:  0.006073474884033203
mini_batch_src_global generation:  0.017712116241455078
r_  generation:  0.17948579788208008
----------------------check_connections_block total spend ----------------------------- 0.5037269592285156
generate_one_block  0.19621992111206055
generate_one_block  0.19815969467163086
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028956174850463867
gen group dst list time:  0.006482839584350586
time for parepare:  0.019931793212890625
local_output_nid generation:  0.017755508422851562
local_in_edges_tensor generation:  0.03299736976623535
mini_batch_src_global generation:  0.045914411544799805
r_  generation:  0.48369717597961426
local_output_nid generation:  0.026576519012451172
local_in_edges_tensor generation:  0.03178691864013672
mini_batch_src_global generation:  0.055486202239990234
r_  generation:  0.5014567375183105
----------------------check_connections_block total spend ----------------------------- 1.4301576614379883
generate_one_block  0.6421105861663818
generate_one_block  0.640535831451416
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03828287124633789
gen group dst list time:  0.014338970184326172
time for parepare:  0.017804384231567383
local_output_nid generation:  0.023082494735717773
local_in_edges_tensor generation:  0.036881446838378906
mini_batch_src_global generation:  0.0474705696105957
r_  generation:  0.5066318511962891
local_output_nid generation:  0.03192305564880371
local_in_edges_tensor generation:  0.04094696044921875
mini_batch_src_global generation:  0.05649232864379883
r_  generation:  0.5137465000152588
----------------------check_connections_block total spend ----------------------------- 1.49879789352417
generate_one_block  0.6432559490203857
generate_one_block  0.6402995586395264
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16114234924316406  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

connection checking time:  2.928955554962158
block generation total time  2.56620192527771
average batch blocks generation time:  1.283100962638855
block dataloader generation time/epoch 7.184352027364524
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11676645278930664  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2821283340454102  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11658096313476562  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2812538146972656  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0779961347579956 |0.017409324645996094 |0.004029631614685059 |0.000507354736328125 |0.0033646821975708008 |0.0012774467468261719 |
----------------------------------------------------------pseudo_mini_loss sum 0.9680185317993164
Total (block generation + training)time/epoch 7.521254729075604
Training time/epoch 0.32128334045410156
Training time without block to device /epoch 0.2864646911621094
Training time without total dataloading part /epoch 0.01708078384399414
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 59.07it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.38it/s]100%|██████████| 4/4 [00:00<00:00, 15.70it/s]100%|██████████| 4/4 [00:00<00:00, 15.62it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.83it/s]100%|██████████| 4/4 [00:00<00:00, 17.65it/s]100%|██████████| 4/4 [00:00<00:00, 17.66it/s]
Run 00 | Epoch 00092 | Loss 0.9680 | Train 0.2526 | Val 0.1869 | Test 0.1661
Number of nodes during this epoch:  332880
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.160980224609375  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.016367197036743164
range selection method range initialization spend 0.011931419372558594
time for parepare:  0.016574859619140625
local_output_nid generation:  0.010699272155761719
local_in_edges_tensor generation:  0.008336305618286133
mini_batch_src_global generation:  0.01378631591796875
r_  generation:  0.16878581047058105
local_output_nid generation:  0.012042760848999023
local_in_edges_tensor generation:  0.007935285568237305
mini_batch_src_global generation:  0.017468690872192383
r_  generation:  0.18387818336486816
----------------------check_connections_block total spend ----------------------------- 0.5124490261077881
generate_one_block  0.19650673866271973
generate_one_block  0.19943594932556152
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028779268264770508
gen group dst list time:  0.006511688232421875
time for parepare:  0.020762920379638672
local_output_nid generation:  0.018124818801879883
local_in_edges_tensor generation:  0.03424072265625
mini_batch_src_global generation:  0.04705166816711426
r_  generation:  0.4898688793182373
local_output_nid generation:  0.027301549911499023
local_in_edges_tensor generation:  0.0317535400390625
mini_batch_src_global generation:  0.055580854415893555
r_  generation:  0.49723148345947266
----------------------check_connections_block total spend ----------------------------- 1.436560869216919
generate_one_block  0.6260755062103271
generate_one_block  0.6246504783630371
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02657008171081543
gen group dst list time:  0.01283121109008789
time for parepare:  0.018361330032348633
local_output_nid generation:  0.023588180541992188
local_in_edges_tensor generation:  0.03583812713623047
mini_batch_src_global generation:  0.046663522720336914
r_  generation:  0.5169966220855713
local_output_nid generation:  0.032361507415771484
local_in_edges_tensor generation:  0.030756711959838867
mini_batch_src_global generation:  0.057199954986572266
r_  generation:  0.5230128765106201
----------------------check_connections_block total spend ----------------------------- 1.5090596675872803
generate_one_block  0.6498048305511475
generate_one_block  0.6560027599334717
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.160980224609375  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

connection checking time:  2.945620536804199
block generation total time  2.5565335750579834
average batch blocks generation time:  1.2782667875289917
block dataloader generation time/epoch 7.183741992428189
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11678934097290039  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2821598052978516  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11646604537963867  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2803277969360352  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08124125003814697 |0.024502277374267578 |0.0037611722946166992 |0.00049591064453125 |0.0037566423416137695 |0.0015320777893066406 |
----------------------------------------------------------pseudo_mini_loss sum 0.9631345272064209
Total (block generation + training)time/epoch 7.520630010536739
Training time/epoch 0.3355834484100342
Training time without block to device /epoch 0.286578893661499
Training time without total dataloading part /epoch 0.017559528350830078
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 50.86it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.12it/s]100%|██████████| 4/4 [00:00<00:00, 13.62it/s]100%|██████████| 4/4 [00:00<00:00, 13.82it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.23it/s]100%|██████████| 4/4 [00:00<00:00, 16.86it/s]100%|██████████| 4/4 [00:00<00:00, 16.74it/s]
Run 00 | Epoch 00093 | Loss 0.9631 | Train 0.2508 | Val 0.1844 | Test 0.1631
Number of nodes during this epoch:  332828
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16015052795410156  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024173736572265625
range selection method range initialization spend 0.012202024459838867
time for parepare:  0.01675724983215332
local_output_nid generation:  0.01082611083984375
local_in_edges_tensor generation:  0.014693737030029297
mini_batch_src_global generation:  0.013555049896240234
r_  generation:  0.1660442352294922
local_output_nid generation:  0.011947393417358398
local_in_edges_tensor generation:  0.007470846176147461
mini_batch_src_global generation:  0.01750659942626953
r_  generation:  0.18099451065063477
----------------------check_connections_block total spend ----------------------------- 0.510178804397583
generate_one_block  0.19878602027893066
generate_one_block  0.20063161849975586
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03148770332336426
gen group dst list time:  0.006529808044433594
time for parepare:  0.019860029220581055
local_output_nid generation:  0.018151521682739258
local_in_edges_tensor generation:  0.04050850868225098
mini_batch_src_global generation:  0.04659128189086914
r_  generation:  0.48577094078063965
local_output_nid generation:  0.027559280395507812
local_in_edges_tensor generation:  0.030634641647338867
mini_batch_src_global generation:  0.06775569915771484
r_  generation:  0.5028328895568848
----------------------check_connections_block total spend ----------------------------- 1.454606533050537
generate_one_block  0.6197164058685303
generate_one_block  0.623431921005249
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02531886100769043
gen group dst list time:  0.012351751327514648
time for parepare:  0.018273353576660156
local_output_nid generation:  0.022789716720581055
local_in_edges_tensor generation:  0.03361344337463379
mini_batch_src_global generation:  0.047333478927612305
r_  generation:  0.5092649459838867
local_output_nid generation:  0.03165698051452637
local_in_edges_tensor generation:  0.03023672103881836
mini_batch_src_global generation:  0.05652022361755371
r_  generation:  0.5187757015228271
----------------------check_connections_block total spend ----------------------------- 1.492516279220581
generate_one_block  0.6409435272216797
generate_one_block  0.6464710235595703
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16015052795410156  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

connection checking time:  2.947122812271118
block generation total time  2.5305628776550293
average batch blocks generation time:  1.2652814388275146
block dataloader generation time/epoch 7.182832381304572
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11674070358276367  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2820682525634766  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11660337448120117  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2845282554626465  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08102607727050781 |0.01557910442352295 |0.003996133804321289 |0.0005222558975219727 |0.0035675764083862305 |0.00144195556640625 |
----------------------------------------------------------pseudo_mini_loss sum 0.9646996855735779
Total (block generation + training)time/epoch 7.519425271539127
Training time/epoch 0.31165599822998047
Training time without block to device /epoch 0.28049778938293457
Training time without total dataloading part /epoch 0.017613887786865234
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 57.27it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.81it/s]100%|██████████| 4/4 [00:00<00:00, 15.30it/s]100%|██████████| 4/4 [00:00<00:00, 15.21it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.22it/s]100%|██████████| 4/4 [00:00<00:00, 17.55it/s]100%|██████████| 4/4 [00:00<00:00, 17.48it/s]
Run 00 | Epoch 00094 | Loss 0.9647 | Train 0.2488 | Val 0.1818 | Test 0.1600
Number of nodes during this epoch:  332916
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16100835800170898  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.017317771911621094
range selection method range initialization spend 0.011800765991210938
time for parepare:  0.01628732681274414
local_output_nid generation:  0.010808706283569336
local_in_edges_tensor generation:  0.008188009262084961
mini_batch_src_global generation:  0.013672113418579102
r_  generation:  0.17064476013183594
local_output_nid generation:  0.012018680572509766
local_in_edges_tensor generation:  0.006306648254394531
mini_batch_src_global generation:  0.017494678497314453
r_  generation:  0.18304061889648438
----------------------check_connections_block total spend ----------------------------- 0.511838436126709
generate_one_block  0.20153284072875977
generate_one_block  0.20309996604919434
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.035529136657714844
gen group dst list time:  0.006502866744995117
time for parepare:  0.020792007446289062
local_output_nid generation:  0.01798725128173828
local_in_edges_tensor generation:  0.029851675033569336
mini_batch_src_global generation:  0.04893136024475098
r_  generation:  0.5137560367584229
local_output_nid generation:  0.032578468322753906
local_in_edges_tensor generation:  0.044870853424072266
mini_batch_src_global generation:  0.07168722152709961
r_  generation:  0.4994547367095947
----------------------check_connections_block total spend ----------------------------- 1.509890079498291
generate_one_block  0.6301734447479248
generate_one_block  0.6476914882659912
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030878067016601562
gen group dst list time:  0.013267040252685547
time for parepare:  0.019069671630859375
local_output_nid generation:  0.023332834243774414
local_in_edges_tensor generation:  0.0428471565246582
mini_batch_src_global generation:  0.047678232192993164
r_  generation:  0.5185184478759766
local_output_nid generation:  0.03436112403869629
local_in_edges_tensor generation:  0.04325747489929199
mini_batch_src_global generation:  0.056888580322265625
r_  generation:  0.5418477058410645
----------------------check_connections_block total spend ----------------------------- 1.5630059242248535
generate_one_block  0.6563193798065186
generate_one_block  0.6452295780181885
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16100835800170898  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

connection checking time:  3.0728960037231445
block generation total time  2.579413890838623
average batch blocks generation time:  1.2897069454193115
block dataloader generation time/epoch 7.184197761291681
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11681699752807617  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2825303077697754  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11637163162231445  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2806367874145508  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08346426486968994 |0.022137999534606934 |0.004053354263305664 |0.0004974603652954102 |0.0035060644149780273 |0.0031540393829345703 |
----------------------------------------------------------pseudo_mini_loss sum 0.9626842737197876
Total (block generation + training)time/epoch 7.520902716836264
Training time/epoch 0.34606122970581055
Training time without block to device /epoch 0.3017852306365967
Training time without total dataloading part /epoch 0.019267797470092773
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 53.48it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.30it/s]100%|██████████| 4/4 [00:00<00:00, 15.39it/s]100%|██████████| 4/4 [00:00<00:00, 15.36it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.79it/s]100%|██████████| 4/4 [00:00<00:00, 17.15it/s]100%|██████████| 4/4 [00:00<00:00, 17.07it/s]
Run 00 | Epoch 00095 | Loss 0.9627 | Train 0.2476 | Val 0.1796 | Test 0.1578
Number of nodes during this epoch:  332926
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1609945297241211  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024148225784301758
range selection method range initialization spend 0.011911630630493164
time for parepare:  0.015963315963745117
local_output_nid generation:  0.010779142379760742
local_in_edges_tensor generation:  0.012231588363647461
mini_batch_src_global generation:  0.014428853988647461
r_  generation:  0.16986680030822754
local_output_nid generation:  0.012081623077392578
local_in_edges_tensor generation:  0.006640434265136719
mini_batch_src_global generation:  0.017720460891723633
r_  generation:  0.18071961402893066
----------------------check_connections_block total spend ----------------------------- 0.5126316547393799
generate_one_block  0.1973271369934082
generate_one_block  0.20100116729736328
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.041220903396606445
gen group dst list time:  0.006491899490356445
time for parepare:  0.019879579544067383
local_output_nid generation:  0.017231225967407227
local_in_edges_tensor generation:  0.0331423282623291
mini_batch_src_global generation:  0.04652285575866699
r_  generation:  0.49123668670654297
local_output_nid generation:  0.026633739471435547
local_in_edges_tensor generation:  0.032503366470336914
mini_batch_src_global generation:  0.05576658248901367
r_  generation:  0.5055911540985107
----------------------check_connections_block total spend ----------------------------- 1.442854404449463
generate_one_block  0.6254434585571289
generate_one_block  0.6284680366516113
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025504112243652344
gen group dst list time:  0.012380838394165039
time for parepare:  0.018491029739379883
local_output_nid generation:  0.02559947967529297
local_in_edges_tensor generation:  0.03305864334106445
mini_batch_src_global generation:  0.04905104637145996
r_  generation:  0.5211703777313232
local_output_nid generation:  0.032569169998168945
local_in_edges_tensor generation:  0.032926321029663086
mini_batch_src_global generation:  0.0607752799987793
r_  generation:  0.5250062942504883
----------------------check_connections_block total spend ----------------------------- 1.5271048545837402
generate_one_block  0.6628763675689697
generate_one_block  0.6608338356018066
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1609945297241211  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

connection checking time:  2.969959259033203
block generation total time  2.5776216983795166
average batch blocks generation time:  1.2888108491897583
block dataloader generation time/epoch 7.184474988915454
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11678361892700195  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2822761535644531  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11644744873046875  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2803683280944824  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08802664279937744 |0.025405049324035645 |0.0038286447525024414 |0.00048422813415527344 |0.0034445524215698242 |0.001569986343383789 |
----------------------------------------------------------pseudo_mini_loss sum 0.9609243869781494
Total (block generation + training)time/epoch 7.521336264993953
Training time/epoch 0.35016560554504395
Training time without block to device /epoch 0.29935550689697266
Training time without total dataloading part /epoch 0.017084836959838867
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 50.90it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.75it/s]100%|██████████| 4/4 [00:00<00:00, 15.19it/s]100%|██████████| 4/4 [00:00<00:00, 15.11it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.98it/s]100%|██████████| 4/4 [00:00<00:00, 17.29it/s]100%|██████████| 4/4 [00:00<00:00, 17.23it/s]
Run 00 | Epoch 00096 | Loss 0.9609 | Train 0.2468 | Val 0.1788 | Test 0.1563
Number of nodes during this epoch:  332702
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16017818450927734  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0219268798828125
range selection method range initialization spend 0.012182474136352539
time for parepare:  0.016524076461791992
local_output_nid generation:  0.011100053787231445
local_in_edges_tensor generation:  0.009317636489868164
mini_batch_src_global generation:  0.013640642166137695
r_  generation:  0.17389369010925293
local_output_nid generation:  0.01250910758972168
local_in_edges_tensor generation:  0.006123542785644531
mini_batch_src_global generation:  0.017411231994628906
r_  generation:  0.183363676071167
----------------------check_connections_block total spend ----------------------------- 0.5154783725738525
generate_one_block  0.19861412048339844
generate_one_block  0.20130372047424316
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030536890029907227
gen group dst list time:  0.006525993347167969
time for parepare:  0.019998788833618164
local_output_nid generation:  0.01857304573059082
local_in_edges_tensor generation:  0.031778573989868164
mini_batch_src_global generation:  0.047380685806274414
r_  generation:  0.5027561187744141
local_output_nid generation:  0.028112173080444336
local_in_edges_tensor generation:  0.031706809997558594
mini_batch_src_global generation:  0.05623340606689453
r_  generation:  0.5075798034667969
----------------------check_connections_block total spend ----------------------------- 1.4617130756378174
generate_one_block  0.6550724506378174
generate_one_block  0.6318655014038086
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03070998191833496
gen group dst list time:  0.01223134994506836
time for parepare:  0.018321752548217773
local_output_nid generation:  0.023900270462036133
local_in_edges_tensor generation:  0.04171895980834961
mini_batch_src_global generation:  0.04736733436584473
r_  generation:  0.5139036178588867
local_output_nid generation:  0.03299903869628906
local_in_edges_tensor generation:  0.03740715980529785
mini_batch_src_global generation:  0.05727553367614746
r_  generation:  0.5262477397918701
----------------------check_connections_block total spend ----------------------------- 1.5226044654846191
generate_one_block  0.6372091770172119
generate_one_block  0.6542513370513916
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16017818450927734  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

connection checking time:  2.9843175411224365
block generation total time  2.5783984661102295
average batch blocks generation time:  1.2891992330551147
block dataloader generation time/epoch 7.184988143769178
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.1167597770690918  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2818965911865234  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11651277542114258  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2805042266845703  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08312094211578369 |0.015987396240234375 |0.0039014816284179688 |0.0004938840866088867 |0.003706693649291992 |0.0018649101257324219 |
----------------------------------------------------------pseudo_mini_loss sum 0.9609864354133606
Total (block generation + training)time/epoch 7.521637651053342
Training time/epoch 0.3181111812591553
Training time without block to device /epoch 0.2861363887786865
Training time without total dataloading part /epoch 0.018069028854370117
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 61.45it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.93it/s]100%|██████████| 4/4 [00:00<00:00, 15.17it/s]100%|██████████| 4/4 [00:00<00:00, 15.12it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.77it/s]100%|██████████| 4/4 [00:00<00:00, 17.45it/s]100%|██████████| 4/4 [00:00<00:00, 17.48it/s]
Run 00 | Epoch 00097 | Loss 0.9610 | Train 0.2453 | Val 0.1773 | Test 0.1553
Number of nodes during this epoch:  332703
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16112279891967773  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01540064811706543
range selection method range initialization spend 0.011736392974853516
time for parepare:  0.016411304473876953
local_output_nid generation:  0.01088571548461914
local_in_edges_tensor generation:  0.00840449333190918
mini_batch_src_global generation:  0.013687372207641602
r_  generation:  0.17004919052124023
local_output_nid generation:  0.011943578720092773
local_in_edges_tensor generation:  0.006011486053466797
mini_batch_src_global generation:  0.017423391342163086
r_  generation:  0.1828603744506836
----------------------check_connections_block total spend ----------------------------- 0.5088648796081543
generate_one_block  0.20076751708984375
generate_one_block  0.2029721736907959
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030256032943725586
gen group dst list time:  0.006485462188720703
time for parepare:  0.01987290382385254
local_output_nid generation:  0.01788806915283203
local_in_edges_tensor generation:  0.028177738189697266
mini_batch_src_global generation:  0.047005653381347656
r_  generation:  0.48996520042419434
local_output_nid generation:  0.027731657028198242
local_in_edges_tensor generation:  0.027695417404174805
mini_batch_src_global generation:  0.055320024490356445
r_  generation:  0.5012683868408203
----------------------check_connections_block total spend ----------------------------- 1.4307432174682617
generate_one_block  0.6293060779571533
generate_one_block  0.6229181289672852
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.026937246322631836
gen group dst list time:  0.013025045394897461
time for parepare:  0.01847362518310547
local_output_nid generation:  0.023853778839111328
local_in_edges_tensor generation:  0.03173947334289551
mini_batch_src_global generation:  0.046463727951049805
r_  generation:  0.5153112411499023
local_output_nid generation:  0.03344416618347168
local_in_edges_tensor generation:  0.030111312866210938
mini_batch_src_global generation:  0.056282997131347656
r_  generation:  0.5201380252838135
----------------------check_connections_block total spend ----------------------------- 1.4989464282989502
generate_one_block  0.6398043632507324
generate_one_block  0.6428532600402832
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16112279891967773  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

connection checking time:  2.929689645767212
block generation total time  2.534881830215454
average batch blocks generation time:  1.267440915107727
block dataloader generation time/epoch 7.183752354611172
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11675500869750977  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2818255424499512  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11650323867797852  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2799763679504395  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08374583721160889 |0.021606087684631348 |0.0037044286727905273 |0.00048220157623291016 |0.0037441253662109375 |0.001432657241821289 |
----------------------------------------------------------pseudo_mini_loss sum 0.9584425687789917
Total (block generation + training)time/epoch 7.520427476154285
Training time/epoch 0.33884239196777344
Training time without block to device /epoch 0.29563021659851074
Training time without total dataloading part /epoch 0.01729416847229004
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 65.36it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.07it/s]100%|██████████| 4/4 [00:00<00:00, 15.33it/s]100%|██████████| 4/4 [00:00<00:00, 15.28it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.16it/s]100%|██████████| 4/4 [00:00<00:00, 17.19it/s]100%|██████████| 4/4 [00:00<00:00, 17.16it/s]
Run 00 | Epoch 00098 | Loss 0.9584 | Train 0.2442 | Val 0.1764 | Test 0.1546
Number of nodes during this epoch:  332622
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16014623641967773  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022315263748168945
range selection method range initialization spend 0.012340307235717773
time for parepare:  0.015835046768188477
local_output_nid generation:  0.011233091354370117
local_in_edges_tensor generation:  0.008622407913208008
mini_batch_src_global generation:  0.013655424118041992
r_  generation:  0.1719064712524414
local_output_nid generation:  0.012482166290283203
local_in_edges_tensor generation:  0.00742030143737793
mini_batch_src_global generation:  0.017719745635986328
r_  generation:  0.18201971054077148
----------------------check_connections_block total spend ----------------------------- 0.5123288631439209
generate_one_block  0.19740700721740723
generate_one_block  0.20122838020324707
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03378725051879883
gen group dst list time:  0.0065746307373046875
time for parepare:  0.024387598037719727
local_output_nid generation:  0.019644498825073242
local_in_edges_tensor generation:  0.03998565673828125
mini_batch_src_global generation:  0.05768394470214844
r_  generation:  0.4898357391357422
local_output_nid generation:  0.02766728401184082
local_in_edges_tensor generation:  0.036566734313964844
mini_batch_src_global generation:  0.058039188385009766
r_  generation:  0.5007674694061279
----------------------check_connections_block total spend ----------------------------- 1.4693188667297363
generate_one_block  0.6269910335540771
generate_one_block  0.6249089241027832
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02567911148071289
gen group dst list time:  0.012426376342773438
time for parepare:  0.018387556076049805
local_output_nid generation:  0.023082971572875977
local_in_edges_tensor generation:  0.03549957275390625
mini_batch_src_global generation:  0.04659581184387207
r_  generation:  0.5139703750610352
local_output_nid generation:  0.03209829330444336
local_in_edges_tensor generation:  0.038403987884521484
mini_batch_src_global generation:  0.05751824378967285
r_  generation:  0.5208234786987305
----------------------check_connections_block total spend ----------------------------- 1.510770559310913
generate_one_block  0.6346595287322998
generate_one_block  0.647228479385376
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.16014623641967773  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

connection checking time:  2.9800894260406494
block generation total time  2.533787965774536
average batch blocks generation time:  1.266893982887268
block dataloader generation time/epoch 7.183535573217604
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11674165725708008  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2825160026550293  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 0.11641788482666016  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4705810546875 GB
    Memory Allocated: 1.2798852920532227  GigaBytes
Max Memory Allocated: 1.5412254333496094  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08839261531829834 |0.015493988990783691 |0.004140138626098633 |0.0005360841751098633 |0.0036001205444335938 |0.0013277530670166016 |
----------------------------------------------------------pseudo_mini_loss sum 0.954972505569458
Total (block generation + training)time/epoch 7.520185650719537
Training time/epoch 0.33428311347961426
Training time without block to device /epoch 0.3032951354980469
Training time without total dataloading part /epoch 0.01788043975830078
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 58.77it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.03it/s]100%|██████████| 4/4 [00:00<00:00, 15.30it/s]100%|██████████| 4/4 [00:00<00:00, 15.25it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.04it/s]100%|██████████| 4/4 [00:00<00:00, 17.18it/s]100%|██████████| 4/4 [00:00<00:00, 17.14it/s]
Run 00 | Epoch 00099 | Loss 0.9550 | Train 0.2428 | Val 0.1758 | Test 0.1537
Number of nodes during this epoch:  332878
The number of model layers:  3
Run 01:
Highest Train: 44.56
Highest Valid: 53.17
  Final Train: 44.56
   Final Test: 54.22
The number of model layers:  3
All runs:
Highest Train: 44.56 ± nan
Highest Valid: 53.17 ± nan
  Final Train: 44.56 ± nan
   Final Test: 54.22 ± nan
