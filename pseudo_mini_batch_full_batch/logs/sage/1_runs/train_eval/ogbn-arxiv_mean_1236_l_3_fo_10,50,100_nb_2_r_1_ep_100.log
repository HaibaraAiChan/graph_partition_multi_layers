Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1647070739.33129
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02698206901550293
range selection method range initialization spend 0.013578653335571289
time for parepare:  0.01993417739868164
local_output_nid generation:  0.010708093643188477
local_in_edges_tensor generation:  0.009572029113769531
mini_batch_src_global generation:  0.01507878303527832
r_  generation:  0.1887829303741455
local_output_nid generation:  0.01218414306640625
local_in_edges_tensor generation:  0.010909795761108398
mini_batch_src_global generation:  0.019841432571411133
r_  generation:  0.20185017585754395
----------------------check_connections_block total spend ----------------------------- 0.566992998123169
generate_one_block  0.2325301170349121
generate_one_block  0.2386155128479004
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04446697235107422
gen group dst list time:  0.008046150207519531
time for parepare:  0.0204312801361084
local_output_nid generation:  0.01891016960144043
local_in_edges_tensor generation:  0.042236328125
mini_batch_src_global generation:  0.05656242370605469
r_  generation:  0.5488393306732178
local_output_nid generation:  0.027947664260864258
local_in_edges_tensor generation:  0.0490422248840332
mini_batch_src_global generation:  0.06142020225524902
r_  generation:  0.5409784317016602
----------------------check_connections_block total spend ----------------------------- 1.61403489112854
generate_one_block  0.7124876976013184
generate_one_block  0.7042226791381836
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.019154071807861328
gen group dst list time:  0.01198434829711914
time for parepare:  0.01907825469970703
local_output_nid generation:  0.02152228355407715
local_in_edges_tensor generation:  0.03040170669555664
mini_batch_src_global generation:  0.0310976505279541
r_  generation:  0.376415491104126
local_output_nid generation:  0.031299591064453125
local_in_edges_tensor generation:  0.03407120704650879
mini_batch_src_global generation:  0.03923940658569336
r_  generation:  0.37612199783325195
----------------------check_connections_block total spend ----------------------------- 1.1311259269714355
generate_one_block  0.4667975902557373
generate_one_block  0.45450615882873535
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  2.7451608180999756
block generation total time  2.3380141258239746
average batch blocks generation time:  1.1690070629119873
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2010498046875 GB
    Memory Allocated: 0.10551023483276367  GigaBytes
Max Memory Allocated: 0.10551023483276367  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 1.3055977821350098  GigaBytes
Max Memory Allocated: 1.4212861061096191  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3377685546875 GB
    Memory Allocated: 0.11376237869262695  GigaBytes
Max Memory Allocated: 1.571765422821045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3377685546875 GB
    Memory Allocated: 1.3007307052612305  GigaBytes
Max Memory Allocated: 1.571765422821045  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.048195481300354004 |0.15415608882904053 |0.38847899436950684 |0.000592350959777832 |0.032618045806884766 |0.002249479293823242 |
----------------------------------------------------------pseudo_mini_loss sum 6.081014633178711
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.39it/s]100%|██████████| 4/4 [00:00<00:00, 28.30it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.60it/s]100%|██████████| 4/4 [00:00<00:00, 12.08it/s]100%|██████████| 4/4 [00:00<00:00, 12.00it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.36it/s]100%|██████████| 4/4 [00:00<00:00, 17.55it/s]100%|██████████| 4/4 [00:00<00:00, 17.50it/s]
Run 00 | Epoch 00000 | Loss 6.0810 | Train 0.2943 | Val 0.3127 | Test 0.2873
Number of nodes during this epoch:  333812
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5037841796875 GB
    Memory Allocated: 0.15884780883789062  GigaBytes
Max Memory Allocated: 1.571765422821045  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02167224884033203
range selection method range initialization spend 0.013473987579345703
time for parepare:  0.017674684524536133
local_output_nid generation:  0.010528326034545898
local_in_edges_tensor generation:  0.00960850715637207
mini_batch_src_global generation:  0.015282392501831055
r_  generation:  0.19306492805480957
local_output_nid generation:  0.011574745178222656
local_in_edges_tensor generation:  0.00921630859375
mini_batch_src_global generation:  0.01989436149597168
r_  generation:  0.20654821395874023
----------------------check_connections_block total spend ----------------------------- 0.5733709335327148
generate_one_block  0.23478960990905762
generate_one_block  0.2363910675048828
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04188680648803711
gen group dst list time:  0.007966041564941406
time for parepare:  0.020048141479492188
local_output_nid generation:  0.017041444778442383
local_in_edges_tensor generation:  0.041831016540527344
mini_batch_src_global generation:  0.05450153350830078
r_  generation:  0.5409514904022217
local_output_nid generation:  0.029404163360595703
local_in_edges_tensor generation:  0.04982328414916992
mini_batch_src_global generation:  0.06197404861450195
r_  generation:  0.5461246967315674
----------------------check_connections_block total spend ----------------------------- 1.598306655883789
generate_one_block  0.7120285034179688
generate_one_block  0.7117877006530762
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.019548654556274414
gen group dst list time:  0.012026786804199219
time for parepare:  0.019185781478881836
local_output_nid generation:  0.02129840850830078
local_in_edges_tensor generation:  0.030866622924804688
mini_batch_src_global generation:  0.030501604080200195
r_  generation:  0.3705453872680664
local_output_nid generation:  0.034462690353393555
local_in_edges_tensor generation:  0.03060626983642578
mini_batch_src_global generation:  0.039112091064453125
r_  generation:  0.38143110275268555
----------------------check_connections_block total spend ----------------------------- 1.1291697025299072
generate_one_block  0.4601156711578369
generate_one_block  0.47112441062927246
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5037841796875 GB
    Memory Allocated: 0.15884780883789062  GigaBytes
Max Memory Allocated: 1.571765422821045  GigaBytes

connection checking time:  2.7274763584136963
block generation total time  2.3550562858581543
average batch blocks generation time:  1.1775281429290771
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5037841796875 GB
    Memory Allocated: 0.11471796035766602  GigaBytes
Max Memory Allocated: 1.571765422821045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5037841796875 GB
    Memory Allocated: 1.3037080764770508  GigaBytes
Max Memory Allocated: 1.571765422821045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5037841796875 GB
    Memory Allocated: 0.11471319198608398  GigaBytes
Max Memory Allocated: 1.571765422821045  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5037841796875 GB
    Memory Allocated: 1.3079705238342285  GigaBytes
Max Memory Allocated: 1.571765422821045  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08357357978820801 |0.015012502670288086 |0.0033942461013793945 |0.00046312808990478516 |0.0034352540969848633 |0.002819538116455078 |
----------------------------------------------------------pseudo_mini_loss sum 3.221710443496704
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 68.16it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.81it/s]100%|██████████| 4/4 [00:00<00:00, 15.77it/s]100%|██████████| 4/4 [00:00<00:00, 15.77it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.58it/s]100%|██████████| 4/4 [00:00<00:00, 18.18it/s]100%|██████████| 4/4 [00:00<00:00, 18.07it/s]
Run 00 | Epoch 00001 | Loss 3.2217 | Train 0.3416 | Val 0.4089 | Test 0.4454
Number of nodes during this epoch:  333714
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1601858139038086  GigaBytes
Max Memory Allocated: 1.574770450592041  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021216630935668945
range selection method range initialization spend 0.018347501754760742
time for parepare:  0.018218040466308594
local_output_nid generation:  0.010808229446411133
local_in_edges_tensor generation:  0.009657859802246094
mini_batch_src_global generation:  0.01509547233581543
r_  generation:  0.20609593391418457
local_output_nid generation:  0.012921810150146484
local_in_edges_tensor generation:  0.006464481353759766
mini_batch_src_global generation:  0.02963852882385254
r_  generation:  0.2154991626739502
----------------------check_connections_block total spend ----------------------------- 0.6126456260681152
generate_one_block  0.2520163059234619
generate_one_block  0.23991703987121582
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0730292797088623
gen group dst list time:  0.007757663726806641
time for parepare:  0.019984960556030273
local_output_nid generation:  0.018043041229248047
local_in_edges_tensor generation:  0.05308723449707031
mini_batch_src_global generation:  0.05432415008544922
r_  generation:  0.5340261459350586
local_output_nid generation:  0.026807546615600586
local_in_edges_tensor generation:  0.05354905128479004
mini_batch_src_global generation:  0.06220579147338867
r_  generation:  0.5528032779693604
----------------------check_connections_block total spend ----------------------------- 1.6134190559387207
generate_one_block  0.7033646106719971
generate_one_block  0.7202820777893066
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.052603721618652344
gen group dst list time:  0.013912439346313477
time for parepare:  0.018784761428833008
local_output_nid generation:  0.021219968795776367
local_in_edges_tensor generation:  0.04077601432800293
mini_batch_src_global generation:  0.030655384063720703
r_  generation:  0.3767421245574951
local_output_nid generation:  0.04041314125061035
local_in_edges_tensor generation:  0.027808189392089844
mini_batch_src_global generation:  0.038839101791381836
r_  generation:  0.3882424831390381
----------------------check_connections_block total spend ----------------------------- 1.1561901569366455
generate_one_block  0.46663832664489746
generate_one_block  0.4881937503814697
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1601858139038086  GigaBytes
Max Memory Allocated: 1.574770450592041  GigaBytes

connection checking time:  2.769609212875366
block generation total time  2.378478765487671
average batch blocks generation time:  1.1892393827438354
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11469125747680664  GigaBytes
Max Memory Allocated: 1.574770450592041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.303034782409668  GigaBytes
Max Memory Allocated: 1.574770450592041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11476373672485352  GigaBytes
Max Memory Allocated: 1.574770450592041  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3091626167297363  GigaBytes
Max Memory Allocated: 1.574770450592041  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0858314037322998 |0.026184916496276855 |0.004080772399902344 |0.000506281852722168 |0.0034546852111816406 |0.0014586448669433594 |
----------------------------------------------------------pseudo_mini_loss sum 2.6172330379486084
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 60.59it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.20it/s]100%|██████████| 4/4 [00:00<00:00, 15.30it/s]100%|██████████| 4/4 [00:00<00:00, 15.27it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.26it/s]100%|██████████| 4/4 [00:00<00:00, 17.46it/s]100%|██████████| 4/4 [00:00<00:00, 17.25it/s]
Run 00 | Epoch 00002 | Loss 2.6172 | Train 0.3160 | Val 0.3345 | Test 0.3866
Number of nodes during this epoch:  333822
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16119909286499023  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023363828659057617
range selection method range initialization spend 0.012552499771118164
time for parepare:  0.017991065979003906
local_output_nid generation:  0.012245893478393555
local_in_edges_tensor generation:  0.011032342910766602
mini_batch_src_global generation:  0.01556539535522461
r_  generation:  0.19080853462219238
local_output_nid generation:  0.011682271957397461
local_in_edges_tensor generation:  0.007982015609741211
mini_batch_src_global generation:  0.020294904708862305
r_  generation:  0.2059621810913086
----------------------check_connections_block total spend ----------------------------- 0.5714097023010254
generate_one_block  0.24199581146240234
generate_one_block  0.23230528831481934
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03954911231994629
gen group dst list time:  0.007565021514892578
time for parepare:  0.019394636154174805
local_output_nid generation:  0.017673730850219727
local_in_edges_tensor generation:  0.033849239349365234
mini_batch_src_global generation:  0.05183243751525879
r_  generation:  0.5395808219909668
local_output_nid generation:  0.02666473388671875
local_in_edges_tensor generation:  0.03757905960083008
mini_batch_src_global generation:  0.06226778030395508
r_  generation:  0.555823564529419
----------------------check_connections_block total spend ----------------------------- 1.5818512439727783
generate_one_block  0.6873605251312256
generate_one_block  0.6902081966400146
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029408693313598633
gen group dst list time:  0.012710332870483398
time for parepare:  0.019016742706298828
local_output_nid generation:  0.022606849670410156
local_in_edges_tensor generation:  0.03292393684387207
mini_batch_src_global generation:  0.03170061111450195
r_  generation:  0.38796424865722656
local_output_nid generation:  0.03534126281738281
local_in_edges_tensor generation:  0.03245830535888672
mini_batch_src_global generation:  0.040679216384887695
r_  generation:  0.38213109970092773
----------------------check_connections_block total spend ----------------------------- 1.1622698307037354
generate_one_block  0.44812655448913574
generate_one_block  0.45858144760131836
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16119909286499023  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

connection checking time:  2.7441210746765137
block generation total time  2.2842767238616943
average batch blocks generation time:  1.1421383619308472
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11471033096313477  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3081026077270508  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11473608016967773  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3078398704528809  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08754408359527588 |0.030284643173217773 |0.003957152366638184 |0.0005030632019042969 |0.0038809776306152344 |0.0018138885498046875 |
----------------------------------------------------------pseudo_mini_loss sum 2.386695384979248
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 55.06it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.89it/s]100%|██████████| 4/4 [00:00<00:00, 16.01it/s]100%|██████████| 4/4 [00:00<00:00, 15.98it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.84it/s]100%|██████████| 4/4 [00:00<00:00, 18.01it/s]100%|██████████| 4/4 [00:00<00:00, 17.96it/s]
Run 00 | Epoch 00003 | Loss 2.3867 | Train 0.4262 | Val 0.4863 | Test 0.5130
Number of nodes during this epoch:  333668
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16022729873657227  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022411823272705078
range selection method range initialization spend 0.012014389038085938
time for parepare:  0.017381906509399414
local_output_nid generation:  0.010532140731811523
local_in_edges_tensor generation:  0.015113115310668945
mini_batch_src_global generation:  0.015282154083251953
r_  generation:  0.19168782234191895
local_output_nid generation:  0.011944770812988281
local_in_edges_tensor generation:  0.006300687789916992
mini_batch_src_global generation:  0.02015995979309082
r_  generation:  0.2045447826385498
----------------------check_connections_block total spend ----------------------------- 0.5711264610290527
generate_one_block  0.22861099243164062
generate_one_block  0.22881293296813965
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03319883346557617
gen group dst list time:  0.007584571838378906
time for parepare:  0.019740819931030273
local_output_nid generation:  0.01789379119873047
local_in_edges_tensor generation:  0.036051273345947266
mini_batch_src_global generation:  0.05118107795715332
r_  generation:  0.5324480533599854
local_output_nid generation:  0.029112577438354492
local_in_edges_tensor generation:  0.03034806251525879
mini_batch_src_global generation:  0.062140464782714844
r_  generation:  0.5481264591217041
----------------------check_connections_block total spend ----------------------------- 1.5593206882476807
generate_one_block  0.6803781986236572
generate_one_block  0.6862587928771973
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01846146583557129
gen group dst list time:  0.012188196182250977
time for parepare:  0.01927042007446289
local_output_nid generation:  0.022507667541503906
local_in_edges_tensor generation:  0.028804302215576172
mini_batch_src_global generation:  0.030725717544555664
r_  generation:  0.3715023994445801
local_output_nid generation:  0.03464508056640625
local_in_edges_tensor generation:  0.029601097106933594
mini_batch_src_global generation:  0.03898143768310547
r_  generation:  0.37510180473327637
----------------------check_connections_block total spend ----------------------------- 1.1211738586425781
generate_one_block  0.4491448402404785
generate_one_block  0.4474053382873535
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16022729873657227  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

connection checking time:  2.680494546890259
block generation total time  2.2631871700286865
average batch blocks generation time:  1.1315935850143433
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11471986770629883  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3035626411437988  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11471796035766602  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3041143417358398  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08490240573883057 |0.014732003211975098 |0.003843545913696289 |0.0005004405975341797 |0.0442352294921875 |0.0020301342010498047 |
----------------------------------------------------------pseudo_mini_loss sum 2.1279757022857666
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 68.86it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.40it/s]100%|██████████| 4/4 [00:00<00:00, 15.68it/s]100%|██████████| 4/4 [00:00<00:00, 15.62it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.92it/s]100%|██████████| 4/4 [00:00<00:00, 17.63it/s]100%|██████████| 4/4 [00:00<00:00, 17.65it/s]
Run 00 | Epoch 00004 | Loss 2.1280 | Train 0.4288 | Val 0.4290 | Test 0.4115
Number of nodes during this epoch:  333773
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16017961502075195  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020718097686767578
range selection method range initialization spend 0.01269841194152832
time for parepare:  0.018938064575195312
local_output_nid generation:  0.01040792465209961
local_in_edges_tensor generation:  0.012679100036621094
mini_batch_src_global generation:  0.016164779663085938
r_  generation:  0.18913030624389648
local_output_nid generation:  0.015220880508422852
local_in_edges_tensor generation:  0.011183977127075195
mini_batch_src_global generation:  0.02072882652282715
r_  generation:  0.2049112319946289
----------------------check_connections_block total spend ----------------------------- 0.5774030685424805
generate_one_block  0.22583651542663574
generate_one_block  0.23001384735107422
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03938794136047363
gen group dst list time:  0.007569074630737305
time for parepare:  0.02286076545715332
local_output_nid generation:  0.017699718475341797
local_in_edges_tensor generation:  0.04294538497924805
mini_batch_src_global generation:  0.06766867637634277
r_  generation:  0.5446281433105469
local_output_nid generation:  0.030710220336914062
local_in_edges_tensor generation:  0.04428601264953613
mini_batch_src_global generation:  0.07264518737792969
r_  generation:  0.5417482852935791
----------------------check_connections_block total spend ----------------------------- 1.622699499130249
generate_one_block  0.6817433834075928
generate_one_block  0.6923072338104248
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02367401123046875
gen group dst list time:  0.013213157653808594
time for parepare:  0.018598318099975586
local_output_nid generation:  0.021587848663330078
local_in_edges_tensor generation:  0.036836862564086914
mini_batch_src_global generation:  0.030440330505371094
r_  generation:  0.3681180477142334
local_output_nid generation:  0.03183722496032715
local_in_edges_tensor generation:  0.026958942413330078
mini_batch_src_global generation:  0.03893327713012695
r_  generation:  0.3764028549194336
----------------------check_connections_block total spend ----------------------------- 1.12083101272583
generate_one_block  0.44742679595947266
generate_one_block  0.45231056213378906
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16017961502075195  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

connection checking time:  2.743530511856079
block generation total time  2.2737879753112793
average batch blocks generation time:  1.1368939876556396
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11471128463745117  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3081722259521484  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1147313117980957  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3037590980529785  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08821582794189453 |0.015180826187133789 |0.00412297248840332 |0.0005099773406982422 |0.003673553466796875 |0.0013942718505859375 |
----------------------------------------------------------pseudo_mini_loss sum 1.9751837253570557
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 62.63it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.06it/s]100%|██████████| 4/4 [00:00<00:00, 15.33it/s]100%|██████████| 4/4 [00:00<00:00, 15.27it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.28it/s]100%|██████████| 4/4 [00:00<00:00, 17.60it/s]100%|██████████| 4/4 [00:00<00:00, 17.53it/s]
Run 00 | Epoch 00005 | Loss 1.9752 | Train 0.4268 | Val 0.4116 | Test 0.3820
Number of nodes during this epoch:  333814
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16022348403930664  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019782066345214844
range selection method range initialization spend 0.012260198593139648
time for parepare:  0.018088102340698242
local_output_nid generation:  0.01064300537109375
local_in_edges_tensor generation:  0.008769512176513672
mini_batch_src_global generation:  0.015769243240356445
r_  generation:  0.1935880184173584
local_output_nid generation:  0.011690378189086914
local_in_edges_tensor generation:  0.007461071014404297
mini_batch_src_global generation:  0.02260446548461914
r_  generation:  0.20797038078308105
----------------------check_connections_block total spend ----------------------------- 0.5779120922088623
generate_one_block  0.23595118522644043
generate_one_block  0.23468899726867676
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.032346248626708984
gen group dst list time:  0.008237600326538086
time for parepare:  0.019730329513549805
local_output_nid generation:  0.017688989639282227
local_in_edges_tensor generation:  0.029493093490600586
mini_batch_src_global generation:  0.05523848533630371
r_  generation:  0.5559465885162354
local_output_nid generation:  0.03234362602233887
local_in_edges_tensor generation:  0.04451298713684082
mini_batch_src_global generation:  0.08204460144042969
r_  generation:  0.5805587768554688
----------------------check_connections_block total spend ----------------------------- 1.6682610511779785
generate_one_block  0.7029299736022949
generate_one_block  0.698880672454834
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.022680997848510742
gen group dst list time:  0.013750553131103516
time for parepare:  0.018746614456176758
local_output_nid generation:  0.020905017852783203
local_in_edges_tensor generation:  0.036952972412109375
mini_batch_src_global generation:  0.03310847282409668
r_  generation:  0.3759915828704834
local_output_nid generation:  0.031389474868774414
local_in_edges_tensor generation:  0.032201528549194336
mini_batch_src_global generation:  0.04129290580749512
r_  generation:  0.3815281391143799
----------------------check_connections_block total spend ----------------------------- 1.1478657722473145
generate_one_block  0.4746065139770508
generate_one_block  0.46532678604125977
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16022348403930664  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

connection checking time:  2.816126823425293
block generation total time  2.3417439460754395
average batch blocks generation time:  1.1708719730377197
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11474084854125977  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.303253173828125  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11469316482543945  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3039169311523438  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08851075172424316 |0.025180935859680176 |0.00406336784362793 |0.0005023479461669922 |0.0038908720016479492 |0.003876209259033203 |
----------------------------------------------------------pseudo_mini_loss sum 1.8928158283233643
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 45.10it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.40it/s]100%|██████████| 4/4 [00:00<00:00, 14.94it/s]100%|██████████| 4/4 [00:00<00:00, 14.84it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.34it/s]100%|██████████| 4/4 [00:00<00:00, 17.41it/s]100%|██████████| 4/4 [00:00<00:00, 17.38it/s]
Run 00 | Epoch 00006 | Loss 1.8928 | Train 0.4244 | Val 0.4156 | Test 0.3861
Number of nodes during this epoch:  333788
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16015386581420898  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02033543586730957
range selection method range initialization spend 0.012045860290527344
time for parepare:  0.017782926559448242
local_output_nid generation:  0.01061391830444336
local_in_edges_tensor generation:  0.012572765350341797
mini_batch_src_global generation:  0.01620936393737793
r_  generation:  0.19158506393432617
local_output_nid generation:  0.011600971221923828
local_in_edges_tensor generation:  0.007444143295288086
mini_batch_src_global generation:  0.0208282470703125
r_  generation:  0.20668649673461914
----------------------check_connections_block total spend ----------------------------- 0.575901985168457
generate_one_block  0.23186182975769043
generate_one_block  0.2304244041442871
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.054778337478637695
gen group dst list time:  0.00777125358581543
time for parepare:  0.020751237869262695
local_output_nid generation:  0.017630815505981445
local_in_edges_tensor generation:  0.03148341178894043
mini_batch_src_global generation:  0.052519798278808594
r_  generation:  0.5337140560150146
local_output_nid generation:  0.026284217834472656
local_in_edges_tensor generation:  0.03466439247131348
mini_batch_src_global generation:  0.06604599952697754
r_  generation:  0.5529704093933105
----------------------check_connections_block total spend ----------------------------- 1.573357105255127
generate_one_block  0.7019846439361572
generate_one_block  0.6976137161254883
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02017807960510254
gen group dst list time:  0.012773752212524414
time for parepare:  0.01984858512878418
local_output_nid generation:  0.021088600158691406
local_in_edges_tensor generation:  0.030100584030151367
mini_batch_src_global generation:  0.03214550018310547
r_  generation:  0.38176870346069336
local_output_nid generation:  0.031188249588012695
local_in_edges_tensor generation:  0.029486894607543945
mini_batch_src_global generation:  0.04384970664978027
r_  generation:  0.392913818359375
----------------------check_connections_block total spend ----------------------------- 1.1633551120758057
generate_one_block  0.4613509178161621
generate_one_block  0.47354674339294434
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16015386581420898  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

connection checking time:  2.7367122173309326
block generation total time  2.334496021270752
average batch blocks generation time:  1.167248010635376
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1147160530090332  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3015670776367188  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11472749710083008  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3084149360656738  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08782029151916504 |0.025278449058532715 |0.014932632446289062 |0.0004929304122924805 |0.030681371688842773 |0.002874135971069336 |
----------------------------------------------------------pseudo_mini_loss sum 1.8089213371276855
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 49.86it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.70it/s]100%|██████████| 4/4 [00:00<00:00, 14.93it/s]100%|██████████| 4/4 [00:00<00:00, 14.89it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.79it/s]100%|██████████| 4/4 [00:00<00:00, 17.07it/s]100%|██████████| 4/4 [00:00<00:00, 17.01it/s]
Run 00 | Epoch 00007 | Loss 1.8089 | Train 0.4236 | Val 0.4340 | Test 0.4111
Number of nodes during this epoch:  333691
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1601262092590332  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021871328353881836
range selection method range initialization spend 0.01199197769165039
time for parepare:  0.01785731315612793
local_output_nid generation:  0.010443449020385742
local_in_edges_tensor generation:  0.009774446487426758
mini_batch_src_global generation:  0.016667842864990234
r_  generation:  0.18913578987121582
local_output_nid generation:  0.011557579040527344
local_in_edges_tensor generation:  0.0062999725341796875
mini_batch_src_global generation:  0.02131032943725586
r_  generation:  0.20873785018920898
----------------------check_connections_block total spend ----------------------------- 0.5716137886047363
generate_one_block  0.22725892066955566
generate_one_block  0.23330903053283691
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.037232398986816406
gen group dst list time:  0.007733583450317383
time for parepare:  0.023282289505004883
local_output_nid generation:  0.017540454864501953
local_in_edges_tensor generation:  0.03152155876159668
mini_batch_src_global generation:  0.052503347396850586
r_  generation:  0.5396349430084229
local_output_nid generation:  0.026666641235351562
local_in_edges_tensor generation:  0.037117958068847656
mini_batch_src_global generation:  0.06545686721801758
r_  generation:  0.5599253177642822
----------------------check_connections_block total spend ----------------------------- 1.5906188488006592
generate_one_block  0.6948142051696777
generate_one_block  0.6941065788269043
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.018658876419067383
gen group dst list time:  0.012670755386352539
time for parepare:  0.018933773040771484
local_output_nid generation:  0.021401166915893555
local_in_edges_tensor generation:  0.02819657325744629
mini_batch_src_global generation:  0.03383517265319824
r_  generation:  0.3805708885192871
local_output_nid generation:  0.03204488754272461
local_in_edges_tensor generation:  0.02681446075439453
mini_batch_src_global generation:  0.040618896484375
r_  generation:  0.38567018508911133
----------------------check_connections_block total spend ----------------------------- 1.1422152519226074
generate_one_block  0.4553043842315674
generate_one_block  0.4621469974517822
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1601262092590332  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

connection checking time:  2.7328341007232666
block generation total time  2.3063721656799316
average batch blocks generation time:  1.1531860828399658
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11463117599487305  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3027725219726562  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11567354202270508  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3069639205932617  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08276617527008057 |0.016535162925720215 |0.016530156135559082 |0.0004925727844238281 |0.0037817955017089844 |0.0012845993041992188 |
----------------------------------------------------------pseudo_mini_loss sum 1.7159907817840576
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 62.71it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.49it/s]100%|██████████| 4/4 [00:00<00:00, 14.94it/s]100%|██████████| 4/4 [00:00<00:00, 14.86it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.96it/s]100%|██████████| 4/4 [00:00<00:00, 17.20it/s]100%|██████████| 4/4 [00:00<00:00, 17.14it/s]
Run 00 | Epoch 00008 | Loss 1.7160 | Train 0.4261 | Val 0.4714 | Test 0.4618
Number of nodes during this epoch:  333756
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.15897655487060547  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01956462860107422
range selection method range initialization spend 0.012361764907836914
time for parepare:  0.017990589141845703
local_output_nid generation:  0.014172554016113281
local_in_edges_tensor generation:  0.010586738586425781
mini_batch_src_global generation:  0.01633453369140625
r_  generation:  0.19444727897644043
local_output_nid generation:  0.011889219284057617
local_in_edges_tensor generation:  0.006163835525512695
mini_batch_src_global generation:  0.021226167678833008
r_  generation:  0.21518492698669434
----------------------check_connections_block total spend ----------------------------- 0.5895111560821533
generate_one_block  0.23027586936950684
generate_one_block  0.2336118221282959
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04558253288269043
gen group dst list time:  0.007700681686401367
time for parepare:  0.019839763641357422
local_output_nid generation:  0.01773858070373535
local_in_edges_tensor generation:  0.039908409118652344
mini_batch_src_global generation:  0.055094003677368164
r_  generation:  0.5402741432189941
local_output_nid generation:  0.02631092071533203
local_in_edges_tensor generation:  0.0364069938659668
mini_batch_src_global generation:  0.06299805641174316
r_  generation:  0.5509812831878662
----------------------check_connections_block total spend ----------------------------- 1.5910170078277588
generate_one_block  0.6864156723022461
generate_one_block  0.6992769241333008
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0198819637298584
gen group dst list time:  0.012732505798339844
time for parepare:  0.019010066986083984
local_output_nid generation:  0.02170252799987793
local_in_edges_tensor generation:  0.02806878089904785
mini_batch_src_global generation:  0.032074689865112305
r_  generation:  0.37625932693481445
local_output_nid generation:  0.03158712387084961
local_in_edges_tensor generation:  0.02742481231689453
mini_batch_src_global generation:  0.04086875915527344
r_  generation:  0.38196849822998047
----------------------check_connections_block total spend ----------------------------- 1.135606288909912
generate_one_block  0.45910191535949707
generate_one_block  0.44989609718322754
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.15897655487060547  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

connection checking time:  2.726623296737671
block generation total time  2.2946906089782715
average batch blocks generation time:  1.1473453044891357
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11474275588989258  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3083686828613281  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11469411849975586  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3023533821105957  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08788859844207764 |0.014995336532592773 |0.004141330718994141 |0.0005025863647460938 |0.003476381301879883 |0.0013091564178466797 |
----------------------------------------------------------pseudo_mini_loss sum 1.6422147750854492
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.04it/s]100%|██████████| 4/4 [00:00<00:00, 30.16it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.59it/s]100%|██████████| 4/4 [00:00<00:00, 12.50it/s]100%|██████████| 4/4 [00:00<00:00, 12.34it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.59it/s]100%|██████████| 4/4 [00:00<00:00, 17.49it/s]100%|██████████| 4/4 [00:00<00:00, 17.48it/s]
Run 00 | Epoch 00009 | Loss 1.6422 | Train 0.4378 | Val 0.5093 | Test 0.5154
Number of nodes during this epoch:  333755
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1592860221862793  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.017417192459106445
range selection method range initialization spend 0.012143611907958984
time for parepare:  0.018802404403686523
local_output_nid generation:  0.010758161544799805
local_in_edges_tensor generation:  0.009570121765136719
mini_batch_src_global generation:  0.016257762908935547
r_  generation:  0.1898345947265625
local_output_nid generation:  0.012212991714477539
local_in_edges_tensor generation:  0.006147146224975586
mini_batch_src_global generation:  0.020572423934936523
r_  generation:  0.20649290084838867
----------------------check_connections_block total spend ----------------------------- 0.5723233222961426
generate_one_block  0.24064302444458008
generate_one_block  0.2284560203552246
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03187417984008789
gen group dst list time:  0.007617473602294922
time for parepare:  0.019646883010864258
local_output_nid generation:  0.01719832420349121
local_in_edges_tensor generation:  0.031081199645996094
mini_batch_src_global generation:  0.05212688446044922
r_  generation:  0.5318934917449951
local_output_nid generation:  0.02584218978881836
local_in_edges_tensor generation:  0.03146076202392578
mini_batch_src_global generation:  0.06345963478088379
r_  generation:  0.5391216278076172
----------------------check_connections_block total spend ----------------------------- 1.5486643314361572
generate_one_block  0.6815152168273926
generate_one_block  0.6863105297088623
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.019414901733398438
gen group dst list time:  0.012963533401489258
time for parepare:  0.018470287322998047
local_output_nid generation:  0.021572589874267578
local_in_edges_tensor generation:  0.029007434844970703
mini_batch_src_global generation:  0.03397727012634277
r_  generation:  0.37470340728759766
local_output_nid generation:  0.03208780288696289
local_in_edges_tensor generation:  0.026237010955810547
mini_batch_src_global generation:  0.040651798248291016
r_  generation:  0.376223087310791
----------------------check_connections_block total spend ----------------------------- 1.1277129650115967
generate_one_block  0.4458503723144531
generate_one_block  0.450960636138916
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1592860221862793  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

connection checking time:  2.676377296447754
block generation total time  2.264636754989624
average batch blocks generation time:  1.132318377494812
block dataloader generation time/epoch 6.705417156219482
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11477327346801758  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3095574378967285  GigaBytes
Max Memory Allocated: 1.5761399269104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11466646194458008  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3034038543701172  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.038866400718688965 |0.02089548110961914 |0.003586888313293457 |0.0004913806915283203 |0.043985843658447266 |0.001186370849609375 |
----------------------------------------------------------pseudo_mini_loss sum 1.598473310470581
Total (block generation + training)time/epoch 7.0379638671875
Training time/epoch 0.3324601650238037
Training time without block to device /epoch 0.29066920280456543
Training time without total dataloading part /epoch 0.09731459617614746
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 64.01it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 13.00it/s]100%|██████████| 4/4 [00:00<00:00, 13.76it/s]100%|██████████| 4/4 [00:00<00:00, 13.63it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.75it/s]100%|██████████| 4/4 [00:00<00:00, 15.57it/s]100%|██████████| 4/4 [00:00<00:00, 15.58it/s]
Run 00 | Epoch 00010 | Loss 1.5985 | Train 0.4437 | Val 0.5232 | Test 0.5336
Number of nodes during this epoch:  333864
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16008472442626953  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023713350296020508
range selection method range initialization spend 0.012452363967895508
time for parepare:  0.019603252410888672
local_output_nid generation:  0.010780572891235352
local_in_edges_tensor generation:  0.011503458023071289
mini_batch_src_global generation:  0.01629924774169922
r_  generation:  0.19049406051635742
local_output_nid generation:  0.011708498001098633
local_in_edges_tensor generation:  0.00617527961730957
mini_batch_src_global generation:  0.021204233169555664
r_  generation:  0.20121550559997559
----------------------check_connections_block total spend ----------------------------- 0.5672156810760498
generate_one_block  0.22844505310058594
generate_one_block  0.22607874870300293
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.040470123291015625
gen group dst list time:  0.007679939270019531
time for parepare:  0.01986837387084961
local_output_nid generation:  0.017816781997680664
local_in_edges_tensor generation:  0.029805660247802734
mini_batch_src_global generation:  0.0520632266998291
r_  generation:  0.5255520343780518
local_output_nid generation:  0.025492429733276367
local_in_edges_tensor generation:  0.03332400321960449
mini_batch_src_global generation:  0.06308388710021973
r_  generation:  0.5381762981414795
----------------------check_connections_block total spend ----------------------------- 1.5378878116607666
generate_one_block  0.6813557147979736
generate_one_block  0.6842186450958252
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02070474624633789
gen group dst list time:  0.012913942337036133
time for parepare:  0.01849365234375
local_output_nid generation:  0.020896196365356445
local_in_edges_tensor generation:  0.027093172073364258
mini_batch_src_global generation:  0.03204464912414551
r_  generation:  0.36885738372802734
local_output_nid generation:  0.031228065490722656
local_in_edges_tensor generation:  0.026360511779785156
mini_batch_src_global generation:  0.04001426696777344
r_  generation:  0.37603092193603516
----------------------check_connections_block total spend ----------------------------- 1.112485647201538
generate_one_block  0.44879889488220215
generate_one_block  0.44860053062438965
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16008472442626953  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

connection checking time:  2.6503734588623047
block generation total time  2.2629737854003906
average batch blocks generation time:  1.1314868927001953
block dataloader generation time/epoch 6.683573484420776
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11559486389160156  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3028573989868164  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1146550178527832  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3032002449035645  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08464789390563965 |0.014456629753112793 |0.003954768180847168 |0.0005022287368774414 |0.0028107166290283203 |0.002912759780883789 |
----------------------------------------------------------pseudo_mini_loss sum 1.5517423152923584
Total (block generation + training)time/epoch 7.018894076347351
Training time/epoch 0.3379356861114502
Training time without block to device /epoch 0.3090224266052246
Training time without total dataloading part /epoch 0.01744818687438965
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 67.20it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.62it/s]100%|██████████| 4/4 [00:00<00:00, 15.08it/s]100%|██████████| 4/4 [00:00<00:00, 15.00it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.60it/s]100%|██████████| 4/4 [00:00<00:00, 17.04it/s]100%|██████████| 4/4 [00:00<00:00, 16.95it/s]
Run 00 | Epoch 00011 | Loss 1.5517 | Train 0.4391 | Val 0.5150 | Test 0.5183
Number of nodes during this epoch:  333800
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1601266860961914  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01940464973449707
range selection method range initialization spend 0.012005329132080078
time for parepare:  0.017824411392211914
local_output_nid generation:  0.010451793670654297
local_in_edges_tensor generation:  0.008900642395019531
mini_batch_src_global generation:  0.01637864112854004
r_  generation:  0.19974565505981445
local_output_nid generation:  0.01211690902709961
local_in_edges_tensor generation:  0.007835865020751953
mini_batch_src_global generation:  0.021617650985717773
r_  generation:  0.20804762840270996
----------------------check_connections_block total spend ----------------------------- 0.5865206718444824
generate_one_block  0.24013376235961914
generate_one_block  0.2567107677459717
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0479583740234375
gen group dst list time:  0.007852554321289062
time for parepare:  0.02021002769470215
local_output_nid generation:  0.01854395866394043
local_in_edges_tensor generation:  0.053441762924194336
mini_batch_src_global generation:  0.05742311477661133
r_  generation:  0.5436611175537109
local_output_nid generation:  0.027455806732177734
local_in_edges_tensor generation:  0.04063820838928223
mini_batch_src_global generation:  0.06410050392150879
r_  generation:  0.5527727603912354
----------------------check_connections_block total spend ----------------------------- 1.6158716678619385
generate_one_block  0.696636438369751
generate_one_block  0.7094333171844482
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02983236312866211
gen group dst list time:  0.01266336441040039
time for parepare:  0.019105195999145508
local_output_nid generation:  0.021737337112426758
local_in_edges_tensor generation:  0.03011012077331543
mini_batch_src_global generation:  0.03228020668029785
r_  generation:  0.3744771480560303
local_output_nid generation:  0.03523683547973633
local_in_edges_tensor generation:  0.02853250503540039
mini_batch_src_global generation:  0.04059481620788574
r_  generation:  0.3873727321624756
----------------------check_connections_block total spend ----------------------------- 1.1427721977233887
generate_one_block  0.4597280025482178
generate_one_block  0.4623243808746338
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1601266860961914  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

connection checking time:  2.758643865585327
block generation total time  2.328122138977051
average batch blocks generation time:  1.1640610694885254
block dataloader generation time/epoch 6.764430125554402
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11473321914672852  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3081426620483398  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11472177505493164  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3033781051635742  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08799135684967041 |0.016160130500793457 |0.004161477088928223 |0.0005376338958740234 |0.002599358558654785 |0.001409292221069336 |
----------------------------------------------------------pseudo_mini_loss sum 1.5194296836853027
Total (block generation + training)time/epoch 7.10016671816508
Training time/epoch 0.33641672134399414
Training time without block to device /epoch 0.3040964603424072
Training time without total dataloading part /epoch 0.0160062313079834
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 50.18it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 13.14it/s]100%|██████████| 4/4 [00:00<00:00, 12.91it/s]100%|██████████| 4/4 [00:00<00:00, 12.93it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.34it/s]100%|██████████| 4/4 [00:00<00:00, 16.86it/s]100%|██████████| 4/4 [00:00<00:00, 16.76it/s]
Run 00 | Epoch 00012 | Loss 1.5194 | Train 0.4281 | Val 0.5047 | Test 0.5031
Number of nodes during this epoch:  333828
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16022300720214844  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0195920467376709
range selection method range initialization spend 0.012027502059936523
time for parepare:  0.01788020133972168
local_output_nid generation:  0.010805130004882812
local_in_edges_tensor generation:  0.012542963027954102
mini_batch_src_global generation:  0.016992568969726562
r_  generation:  0.19563555717468262
local_output_nid generation:  0.011996984481811523
local_in_edges_tensor generation:  0.007200956344604492
mini_batch_src_global generation:  0.02137136459350586
r_  generation:  0.20667695999145508
----------------------check_connections_block total spend ----------------------------- 0.5808086395263672
generate_one_block  0.23012089729309082
generate_one_block  0.23515677452087402
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03574204444885254
gen group dst list time:  0.007812738418579102
time for parepare:  0.019834518432617188
local_output_nid generation:  0.01829218864440918
local_in_edges_tensor generation:  0.037613630294799805
mini_batch_src_global generation:  0.0546572208404541
r_  generation:  0.5386202335357666
local_output_nid generation:  0.026821136474609375
local_in_edges_tensor generation:  0.03425168991088867
mini_batch_src_global generation:  0.06371927261352539
r_  generation:  0.5474033355712891
----------------------check_connections_block total spend ----------------------------- 1.5809376239776611
generate_one_block  0.6997706890106201
generate_one_block  0.7025172710418701
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.021369218826293945
gen group dst list time:  0.012809276580810547
time for parepare:  0.01873326301574707
local_output_nid generation:  0.022349119186401367
local_in_edges_tensor generation:  0.02933955192565918
mini_batch_src_global generation:  0.032331228256225586
r_  generation:  0.377377986907959
local_output_nid generation:  0.03212690353393555
local_in_edges_tensor generation:  0.029024839401245117
mini_batch_src_global generation:  0.04029107093811035
r_  generation:  0.39472365379333496
----------------------check_connections_block total spend ----------------------------- 1.1509175300598145
generate_one_block  0.46160101890563965
generate_one_block  0.4795691967010498
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16022300720214844  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

connection checking time:  2.7318551540374756
block generation total time  2.3434581756591797
average batch blocks generation time:  1.1717290878295898
block dataloader generation time/epoch 6.794835329055786
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11472368240356445  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3037023544311523  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1147150993347168  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.308349609375  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08997821807861328 |0.025432586669921875 |0.004295229911804199 |0.0004932880401611328 |0.0038987398147583008 |0.0019447803497314453 |
----------------------------------------------------------pseudo_mini_loss sum 1.4871635437011719
Total (block generation + training)time/epoch 7.136992573738098
Training time/epoch 0.3612785339355469
Training time without block to device /epoch 0.3104133605957031
Training time without total dataloading part /epoch 0.01931929588317871
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 50.27it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.82it/s]100%|██████████| 4/4 [00:00<00:00, 15.01it/s]100%|██████████| 4/4 [00:00<00:00, 14.97it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.13it/s]100%|██████████| 4/4 [00:00<00:00, 17.33it/s]100%|██████████| 4/4 [00:00<00:00, 17.28it/s]
Run 00 | Epoch 00013 | Loss 1.4872 | Train 0.4142 | Val 0.5062 | Test 0.5039
Number of nodes during this epoch:  333892
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16014671325683594  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02019357681274414
range selection method range initialization spend 0.012003660202026367
time for parepare:  0.017654895782470703
local_output_nid generation:  0.010939359664916992
local_in_edges_tensor generation:  0.011448144912719727
mini_batch_src_global generation:  0.01633000373840332
r_  generation:  0.1931467056274414
local_output_nid generation:  0.011870861053466797
local_in_edges_tensor generation:  0.006994724273681641
mini_batch_src_global generation:  0.020873069763183594
r_  generation:  0.20789361000061035
----------------------check_connections_block total spend ----------------------------- 0.5766637325286865
generate_one_block  0.23316049575805664
generate_one_block  0.2342524528503418
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03837847709655762
gen group dst list time:  0.00770878791809082
time for parepare:  0.019958019256591797
local_output_nid generation:  0.018466472625732422
local_in_edges_tensor generation:  0.03759479522705078
mini_batch_src_global generation:  0.0529484748840332
r_  generation:  0.5369935035705566
local_output_nid generation:  0.02666163444519043
local_in_edges_tensor generation:  0.0330510139465332
mini_batch_src_global generation:  0.06293082237243652
r_  generation:  0.5526156425476074
----------------------check_connections_block total spend ----------------------------- 1.5777831077575684
generate_one_block  0.7134311199188232
generate_one_block  0.7311177253723145
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025446176528930664
gen group dst list time:  0.0153961181640625
time for parepare:  0.01926708221435547
local_output_nid generation:  0.023458003997802734
local_in_edges_tensor generation:  0.034288883209228516
mini_batch_src_global generation:  0.03355121612548828
r_  generation:  0.375075101852417
local_output_nid generation:  0.032181739807128906
local_in_edges_tensor generation:  0.030664443969726562
mini_batch_src_global generation:  0.040035247802734375
r_  generation:  0.3806121349334717
----------------------check_connections_block total spend ----------------------------- 1.1463353633880615
generate_one_block  0.45731687545776367
generate_one_block  0.46431565284729004
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16014671325683594  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

connection checking time:  2.72411847114563
block generation total time  2.3661813735961914
average batch blocks generation time:  1.1830906867980957
block dataloader generation time/epoch 6.817179536819458
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11472558975219727  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3082938194274902  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11470746994018555  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.302457332611084  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08609724044799805 |0.019816994667053223 |0.0041620731353759766 |0.0005247592926025391 |0.0038785934448242188 |0.0017900466918945312 |
----------------------------------------------------------pseudo_mini_loss sum 1.4551222324371338
Total (block generation + training)time/epoch 7.157962417602539
Training time/epoch 0.33510398864746094
Training time without block to device /epoch 0.2954699993133545
Training time without total dataloading part /epoch 0.0189208984375
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 51.55it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.52it/s]100%|██████████| 4/4 [00:00<00:00, 14.96it/s]100%|██████████| 4/4 [00:00<00:00, 14.88it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.74it/s]100%|██████████| 4/4 [00:00<00:00, 17.03it/s]100%|██████████| 4/4 [00:00<00:00, 16.97it/s]
Run 00 | Epoch 00014 | Loss 1.4551 | Train 0.4015 | Val 0.5121 | Test 0.5175
Number of nodes during this epoch:  333775
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16024017333984375  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02239537239074707
range selection method range initialization spend 0.013432979583740234
time for parepare:  0.017639636993408203
local_output_nid generation:  0.010533809661865234
local_in_edges_tensor generation:  0.008687019348144531
mini_batch_src_global generation:  0.016264677047729492
r_  generation:  0.19186711311340332
local_output_nid generation:  0.011833429336547852
local_in_edges_tensor generation:  0.00695347785949707
mini_batch_src_global generation:  0.021152973175048828
r_  generation:  0.20779061317443848
----------------------check_connections_block total spend ----------------------------- 0.5727252960205078
generate_one_block  0.22962045669555664
generate_one_block  0.23526406288146973
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03360724449157715
gen group dst list time:  0.008259773254394531
time for parepare:  0.020144939422607422
local_output_nid generation:  0.018724918365478516
local_in_edges_tensor generation:  0.03415536880493164
mini_batch_src_global generation:  0.05531811714172363
r_  generation:  0.5490260124206543
local_output_nid generation:  0.028557777404785156
local_in_edges_tensor generation:  0.03445315361022949
mini_batch_src_global generation:  0.06472373008728027
r_  generation:  0.5777261257171631
----------------------check_connections_block total spend ----------------------------- 1.6343064308166504
generate_one_block  0.7047638893127441
generate_one_block  0.7053167819976807
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02147674560546875
gen group dst list time:  0.013735532760620117
time for parepare:  0.018750905990600586
local_output_nid generation:  0.02243971824645996
local_in_edges_tensor generation:  0.03557538986206055
mini_batch_src_global generation:  0.03416800498962402
r_  generation:  0.37253427505493164
local_output_nid generation:  0.03152012825012207
local_in_edges_tensor generation:  0.02833080291748047
mini_batch_src_global generation:  0.040376901626586914
r_  generation:  0.38126039505004883
----------------------check_connections_block total spend ----------------------------- 1.1410362720489502
generate_one_block  0.45084118843078613
generate_one_block  0.45832252502441406
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16024017333984375  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

connection checking time:  2.7753427028656006
block generation total time  2.319244384765625
average batch blocks generation time:  1.1596221923828125
block dataloader generation time/epoch 6.827168067296346
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11560440063476562  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3026776313781738  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11474275588989258  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3081998825073242  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08916521072387695 |0.0171889066696167 |0.004117727279663086 |0.0005170106887817383 |0.0033597946166992188 |0.0014657974243164062 |
----------------------------------------------------------pseudo_mini_loss sum 1.4266527891159058
Total (block generation + training)time/epoch 7.168843030929565
Training time/epoch 0.34598851203918457
Training time without block to device /epoch 0.31161069869995117
Training time without total dataloading part /epoch 0.017454862594604492
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 54.09it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.64it/s]100%|██████████| 4/4 [00:00<00:00, 14.89it/s]100%|██████████| 4/4 [00:00<00:00, 14.84it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.77it/s]100%|██████████| 4/4 [00:00<00:00, 17.06it/s]100%|██████████| 4/4 [00:00<00:00, 16.99it/s]
Run 00 | Epoch 00015 | Loss 1.4267 | Train 0.3850 | Val 0.5166 | Test 0.5354
Number of nodes during this epoch:  333729
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16019153594970703  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019927263259887695
range selection method range initialization spend 0.011969804763793945
time for parepare:  0.017738819122314453
local_output_nid generation:  0.010499238967895508
local_in_edges_tensor generation:  0.00900411605834961
mini_batch_src_global generation:  0.018377304077148438
r_  generation:  0.1962132453918457
local_output_nid generation:  0.012111663818359375
local_in_edges_tensor generation:  0.00714874267578125
mini_batch_src_global generation:  0.022899389266967773
r_  generation:  0.20745062828063965
----------------------check_connections_block total spend ----------------------------- 0.5821139812469482
generate_one_block  0.23571252822875977
generate_one_block  0.2429354190826416
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04076552391052246
gen group dst list time:  0.00849461555480957
time for parepare:  0.020064353942871094
local_output_nid generation:  0.01860189437866211
local_in_edges_tensor generation:  0.04146313667297363
mini_batch_src_global generation:  0.05497598648071289
r_  generation:  0.5371918678283691
local_output_nid generation:  0.026077985763549805
local_in_edges_tensor generation:  0.040793657302856445
mini_batch_src_global generation:  0.06532859802246094
r_  generation:  0.5463624000549316
----------------------check_connections_block total spend ----------------------------- 1.5892252922058105
generate_one_block  0.6888124942779541
generate_one_block  0.6914737224578857
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.022493839263916016
gen group dst list time:  0.01296687126159668
time for parepare:  0.01886129379272461
local_output_nid generation:  0.02176499366760254
local_in_edges_tensor generation:  0.030819416046142578
mini_batch_src_global generation:  0.0321803092956543
r_  generation:  0.37346911430358887
local_output_nid generation:  0.031368255615234375
local_in_edges_tensor generation:  0.02720499038696289
mini_batch_src_global generation:  0.03977632522583008
r_  generation:  0.38364338874816895
----------------------check_connections_block total spend ----------------------------- 1.1323306560516357
generate_one_block  0.45148563385009766
generate_one_block  0.4501209259033203
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16019153594970703  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

connection checking time:  2.7215559482574463
block generation total time  2.281892776489258
average batch blocks generation time:  1.140946388244629
block dataloader generation time/epoch 6.826238189424787
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11471223831176758  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3028936386108398  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11473417282104492  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3082003593444824  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07866120338439941 |0.015047192573547363 |0.0044089555740356445 |0.0005469322204589844 |0.0024766921997070312 |0.0018153190612792969 |
----------------------------------------------------------pseudo_mini_loss sum 1.38652765750885
Total (block generation + training)time/epoch 7.165198837007795
Training time/epoch 0.3225383758544922
Training time without block to device /epoch 0.29244399070739746
Training time without total dataloading part /epoch 0.016680479049682617
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 54.99it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.92it/s]100%|██████████| 4/4 [00:00<00:00, 15.02it/s]100%|██████████| 4/4 [00:00<00:00, 14.99it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.00it/s]100%|██████████| 4/4 [00:00<00:00, 17.14it/s]100%|██████████| 4/4 [00:00<00:00, 17.10it/s]
Run 00 | Epoch 00016 | Loss 1.3865 | Train 0.3712 | Val 0.5134 | Test 0.5418
Number of nodes during this epoch:  333735
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1601881980895996  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023178577423095703
range selection method range initialization spend 0.012013912200927734
time for parepare:  0.01764059066772461
local_output_nid generation:  0.010843515396118164
local_in_edges_tensor generation:  0.0093536376953125
mini_batch_src_global generation:  0.016304969787597656
r_  generation:  0.19149208068847656
local_output_nid generation:  0.011819124221801758
local_in_edges_tensor generation:  0.006291627883911133
mini_batch_src_global generation:  0.021223783493041992
r_  generation:  0.2048931121826172
----------------------check_connections_block total spend ----------------------------- 0.5695209503173828
generate_one_block  0.23457551002502441
generate_one_block  0.2335665225982666
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0310211181640625
gen group dst list time:  0.007629871368408203
time for parepare:  0.02049088478088379
local_output_nid generation:  0.020032167434692383
local_in_edges_tensor generation:  0.04201149940490723
mini_batch_src_global generation:  0.05375504493713379
r_  generation:  0.5533740520477295
local_output_nid generation:  0.029762983322143555
local_in_edges_tensor generation:  0.035642147064208984
mini_batch_src_global generation:  0.07567763328552246
r_  generation:  0.5612828731536865
----------------------check_connections_block total spend ----------------------------- 1.6558079719543457
generate_one_block  0.7247860431671143
generate_one_block  0.7020072937011719
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.024904727935791016
gen group dst list time:  0.014120101928710938
time for parepare:  0.018869400024414062
local_output_nid generation:  0.02193593978881836
local_in_edges_tensor generation:  0.034917354583740234
mini_batch_src_global generation:  0.032259225845336914
r_  generation:  0.3767545223236084
local_output_nid generation:  0.03142046928405762
local_in_edges_tensor generation:  0.02795577049255371
mini_batch_src_global generation:  0.04046201705932617
r_  generation:  0.38772058486938477
----------------------check_connections_block total spend ----------------------------- 1.146332025527954
generate_one_block  0.4532914161682129
generate_one_block  0.4605703353881836
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1601881980895996  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

connection checking time:  2.8021399974823
block generation total time  2.3406550884246826
average batch blocks generation time:  1.1703275442123413
block dataloader generation time/epoch 6.8388557732105255
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11471414566040039  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3080029487609863  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11472654342651367  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.30833101272583  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08762538433074951 |0.016866326332092285 |0.004113316535949707 |0.0005141496658325195 |0.0044765472412109375 |0.0013718605041503906 |
----------------------------------------------------------pseudo_mini_loss sum 1.3667097091674805
Total (block generation + training)time/epoch 7.177724599838257
Training time/epoch 0.3380730152130127
Training time without block to device /epoch 0.3043403625488281
Training time without total dataloading part /epoch 0.01957988739013672
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.08it/s]100%|██████████| 4/4 [00:00<00:00, 29.65it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 10.81it/s]100%|██████████| 4/4 [00:00<00:00, 10.77it/s]100%|██████████| 4/4 [00:00<00:00, 10.76it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.10it/s]100%|██████████| 4/4 [00:00<00:00, 17.13it/s]100%|██████████| 4/4 [00:00<00:00, 17.10it/s]
Run 00 | Epoch 00017 | Loss 1.3667 | Train 0.3604 | Val 0.5020 | Test 0.5360
Number of nodes during this epoch:  333869
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16017627716064453  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01926255226135254
range selection method range initialization spend 0.012136697769165039
time for parepare:  0.01866316795349121
local_output_nid generation:  0.010568857192993164
local_in_edges_tensor generation:  0.012842655181884766
mini_batch_src_global generation:  0.016388654708862305
r_  generation:  0.19127440452575684
local_output_nid generation:  0.14519214630126953
local_in_edges_tensor generation:  0.008053302764892578
mini_batch_src_global generation:  0.021104812622070312
r_  generation:  0.20524263381958008
----------------------check_connections_block total spend ----------------------------- 0.7089710235595703
generate_one_block  0.22939562797546387
generate_one_block  0.22947907447814941
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03460693359375
gen group dst list time:  0.0075414180755615234
time for parepare:  0.020183086395263672
local_output_nid generation:  0.01827239990234375
local_in_edges_tensor generation:  0.041062116622924805
mini_batch_src_global generation:  0.05527234077453613
r_  generation:  0.5361857414245605
local_output_nid generation:  0.02697277069091797
local_in_edges_tensor generation:  0.03882408142089844
mini_batch_src_global generation:  0.06343197822570801
r_  generation:  0.5474288463592529
----------------------check_connections_block total spend ----------------------------- 1.5872299671173096
generate_one_block  0.6980938911437988
generate_one_block  0.6951463222503662
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.019587278366088867
gen group dst list time:  0.012558460235595703
time for parepare:  0.01916337013244629
local_output_nid generation:  0.021695852279663086
local_in_edges_tensor generation:  0.03077530860900879
mini_batch_src_global generation:  0.03275775909423828
r_  generation:  0.37853097915649414
local_output_nid generation:  0.03173565864562988
local_in_edges_tensor generation:  0.02660369873046875
mini_batch_src_global generation:  0.0399937629699707
r_  generation:  0.3843550682067871
----------------------check_connections_block total spend ----------------------------- 1.1382031440734863
generate_one_block  0.45699238777160645
generate_one_block  0.455456018447876
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16017627716064453  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

connection checking time:  2.725433111190796
block generation total time  2.3056886196136475
average batch blocks generation time:  1.1528443098068237
block dataloader generation time/epoch 6.851019461949666
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11473894119262695  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3035879135131836  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11470365524291992  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.308537483215332  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08661723136901855 |0.014526128768920898 |0.0040967464447021484 |0.0005091428756713867 |0.04214203357696533 |0.002154111862182617 |
----------------------------------------------------------pseudo_mini_loss sum 1.3517128229141235
Total (block generation + training)time/epoch 7.1895862155490455
Training time/epoch 0.335986852645874
Training time without block to device /epoch 0.3069345951080322
Training time without total dataloading part /epoch 0.09564995765686035
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.69it/s]100%|██████████| 4/4 [00:00<00:00, 30.62it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.20it/s]100%|██████████| 4/4 [00:00<00:00, 12.35it/s]100%|██████████| 4/4 [00:00<00:00, 12.15it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.09it/s]100%|██████████| 4/4 [00:00<00:00, 17.13it/s]100%|██████████| 4/4 [00:00<00:00, 17.10it/s]
Run 00 | Epoch 00018 | Loss 1.3517 | Train 0.3530 | Val 0.4886 | Test 0.5269
Number of nodes during this epoch:  333834
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1601085662841797  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022990703582763672
range selection method range initialization spend 0.01216435432434082
time for parepare:  0.01707744598388672
local_output_nid generation:  0.010645151138305664
local_in_edges_tensor generation:  0.010159015655517578
mini_batch_src_global generation:  0.01627373695373535
r_  generation:  0.19125652313232422
local_output_nid generation:  0.011855363845825195
local_in_edges_tensor generation:  0.006375789642333984
mini_batch_src_global generation:  0.021270036697387695
r_  generation:  0.20711088180541992
----------------------check_connections_block total spend ----------------------------- 0.5718412399291992
generate_one_block  0.23312067985534668
generate_one_block  0.23973846435546875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0385894775390625
gen group dst list time:  0.007302999496459961
time for parepare:  0.020402908325195312
local_output_nid generation:  0.01918482780456543
local_in_edges_tensor generation:  0.046784162521362305
mini_batch_src_global generation:  0.05312299728393555
r_  generation:  0.5554425716400146
local_output_nid generation:  0.030690670013427734
local_in_edges_tensor generation:  0.04046201705932617
mini_batch_src_global generation:  0.06580948829650879
r_  generation:  0.5519711971282959
----------------------check_connections_block total spend ----------------------------- 1.6218879222869873
generate_one_block  0.6854987144470215
generate_one_block  0.6945292949676514
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.021540164947509766
gen group dst list time:  0.012463808059692383
time for parepare:  0.019373416900634766
local_output_nid generation:  0.022279739379882812
local_in_edges_tensor generation:  0.030364990234375
mini_batch_src_global generation:  0.03200125694274902
r_  generation:  0.3754007816314697
local_output_nid generation:  0.03235507011413574
local_in_edges_tensor generation:  0.028151988983154297
mini_batch_src_global generation:  0.04002785682678223
r_  generation:  0.38895463943481445
----------------------check_connections_block total spend ----------------------------- 1.1434297561645508
generate_one_block  0.45473217964172363
generate_one_block  0.4536581039428711
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1601085662841797  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

connection checking time:  2.765317678451538
block generation total time  2.2884182929992676
average batch blocks generation time:  1.1442091464996338
block dataloader generation time/epoch 6.851411938667297
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1146845817565918  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3023419380187988  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11475992202758789  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.309152603149414  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08788228034973145 |0.014873743057250977 |0.004075765609741211 |0.00051116943359375 |0.004407525062561035 |0.0013723373413085938 |
----------------------------------------------------------pseudo_mini_loss sum 1.3442966938018799
Total (block generation + training)time/epoch 7.189719104766846
Training time/epoch 0.3358128070831299
Training time without block to device /epoch 0.30606532096862793
Training time without total dataloading part /epoch 0.019361257553100586
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 51.81it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.68it/s]100%|██████████| 4/4 [00:00<00:00, 15.16it/s]100%|██████████| 4/4 [00:00<00:00, 15.07it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.12it/s]100%|██████████| 4/4 [00:00<00:00, 17.28it/s]100%|██████████| 4/4 [00:00<00:00, 17.24it/s]
Run 00 | Epoch 00019 | Loss 1.3443 | Train 0.3523 | Val 0.4858 | Test 0.5240
Number of nodes during this epoch:  333830
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16119384765625  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020055532455444336
range selection method range initialization spend 0.011861085891723633
time for parepare:  0.018507719039916992
local_output_nid generation:  0.011274099349975586
local_in_edges_tensor generation:  0.008667469024658203
mini_batch_src_global generation:  0.016184091567993164
r_  generation:  0.1920015811920166
local_output_nid generation:  0.011949777603149414
local_in_edges_tensor generation:  0.006370067596435547
mini_batch_src_global generation:  0.020876407623291016
r_  generation:  0.20762968063354492
----------------------check_connections_block total spend ----------------------------- 0.5733439922332764
generate_one_block  0.22775578498840332
generate_one_block  0.23218989372253418
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0328676700592041
gen group dst list time:  0.00721287727355957
time for parepare:  0.020478248596191406
local_output_nid generation:  0.019774675369262695
local_in_edges_tensor generation:  0.031295061111450195
mini_batch_src_global generation:  0.053297996520996094
r_  generation:  0.562183141708374
local_output_nid generation:  0.028582334518432617
local_in_edges_tensor generation:  0.03040313720703125
mini_batch_src_global generation:  0.06763386726379395
r_  generation:  0.5547909736633301
----------------------check_connections_block total spend ----------------------------- 1.6090710163116455
generate_one_block  0.6906514167785645
generate_one_block  0.690457820892334
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.017229080200195312
gen group dst list time:  0.01249384880065918
time for parepare:  0.018654346466064453
local_output_nid generation:  0.02257561683654785
local_in_edges_tensor generation:  0.029102802276611328
mini_batch_src_global generation:  0.03246951103210449
r_  generation:  0.3774993419647217
local_output_nid generation:  0.0329134464263916
local_in_edges_tensor generation:  0.027993440628051758
mini_batch_src_global generation:  0.04042410850524902
r_  generation:  0.38364744186401367
----------------------check_connections_block total spend ----------------------------- 1.1374683380126953
generate_one_block  0.4532155990600586
generate_one_block  0.45458269119262695
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16119384765625  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

connection checking time:  2.746539354324341
block generation total time  2.288907527923584
average batch blocks generation time:  1.144453763961792
block dataloader generation time/epoch 6.846134142442183
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11471986770629883  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3084797859191895  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11473512649536133  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3028736114501953  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08566451072692871 |0.01472008228302002 |0.003832101821899414 |0.0004945993423461914 |0.003639817237854004 |0.0026934146881103516 |
----------------------------------------------------------pseudo_mini_loss sum 1.3230235576629639
Total (block generation + training)time/epoch 7.183530048890547
Training time/epoch 0.3282036781311035
Training time without block to device /epoch 0.2987635135650635
Training time without total dataloading part /epoch 0.01862645149230957
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 66.39it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.72it/s]100%|██████████| 4/4 [00:00<00:00, 14.92it/s]100%|██████████| 4/4 [00:00<00:00, 14.87it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.27it/s]100%|██████████| 4/4 [00:00<00:00, 17.10it/s]100%|██████████| 4/4 [00:00<00:00, 16.95it/s]
Run 00 | Epoch 00020 | Loss 1.3230 | Train 0.3572 | Val 0.4914 | Test 0.5267
Number of nodes during this epoch:  333878
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16026926040649414  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024422407150268555
range selection method range initialization spend 0.012311697006225586
time for parepare:  0.019782304763793945
local_output_nid generation:  0.010825872421264648
local_in_edges_tensor generation:  0.008750438690185547
mini_batch_src_global generation:  0.017075777053833008
r_  generation:  0.19336318969726562
local_output_nid generation:  0.012842178344726562
local_in_edges_tensor generation:  0.008209228515625
mini_batch_src_global generation:  0.027840375900268555
r_  generation:  0.2123889923095703
----------------------check_connections_block total spend ----------------------------- 0.5927848815917969
generate_one_block  0.23344182968139648
generate_one_block  0.23311471939086914
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03764200210571289
gen group dst list time:  0.007128238677978516
time for parepare:  0.019927263259887695
local_output_nid generation:  0.018753767013549805
local_in_edges_tensor generation:  0.037653446197509766
mini_batch_src_global generation:  0.05589008331298828
r_  generation:  0.5437135696411133
local_output_nid generation:  0.027768373489379883
local_in_edges_tensor generation:  0.03936767578125
mini_batch_src_global generation:  0.06388378143310547
r_  generation:  0.5822615623474121
----------------------check_connections_block total spend ----------------------------- 1.6268770694732666
generate_one_block  0.700009822845459
generate_one_block  0.7048754692077637
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0205385684967041
gen group dst list time:  0.012494325637817383
time for parepare:  0.0188443660736084
local_output_nid generation:  0.023042678833007812
local_in_edges_tensor generation:  0.03029799461364746
mini_batch_src_global generation:  0.032149314880371094
r_  generation:  0.38036632537841797
local_output_nid generation:  0.032515764236450195
local_in_edges_tensor generation:  0.027723073959350586
mini_batch_src_global generation:  0.040732383728027344
r_  generation:  0.38762569427490234
----------------------check_connections_block total spend ----------------------------- 1.150371789932251
generate_one_block  0.4568347930908203
generate_one_block  0.4616096019744873
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16026926040649414  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

connection checking time:  2.7772488594055176
block generation total time  2.3233296871185303
average batch blocks generation time:  1.1616648435592651
block dataloader generation time/epoch 6.851895391941071
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1147465705871582  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3083863258361816  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11469125747680664  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3029069900512695  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08686935901641846 |0.01846134662628174 |0.0041626691818237305 |0.0005041360855102539 |0.003935575485229492 |0.001741647720336914 |
----------------------------------------------------------pseudo_mini_loss sum 1.3076411485671997
Total (block generation + training)time/epoch 7.189863443374634
Training time/epoch 0.34411168098449707
Training time without block to device /epoch 0.3071889877319336
Training time without total dataloading part /epoch 0.018946409225463867
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 60.41it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.65it/s]100%|██████████| 4/4 [00:00<00:00, 13.86it/s]100%|██████████| 4/4 [00:00<00:00, 13.96it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.49it/s]100%|██████████| 4/4 [00:00<00:00, 16.45it/s]100%|██████████| 4/4 [00:00<00:00, 16.44it/s]
Run 00 | Epoch 00021 | Loss 1.3076 | Train 0.3633 | Val 0.4969 | Test 0.5287
Number of nodes during this epoch:  333798
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.15929079055786133  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020315885543823242
range selection method range initialization spend 0.012121200561523438
time for parepare:  0.017438650131225586
local_output_nid generation:  0.010766267776489258
local_in_edges_tensor generation:  0.012180566787719727
mini_batch_src_global generation:  0.016453027725219727
r_  generation:  0.19304704666137695
local_output_nid generation:  0.011926889419555664
local_in_edges_tensor generation:  0.0063626766204833984
mini_batch_src_global generation:  0.021120548248291016
r_  generation:  0.20685958862304688
----------------------check_connections_block total spend ----------------------------- 0.5758051872253418
generate_one_block  0.23877429962158203
generate_one_block  0.24034523963928223
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.034546852111816406
gen group dst list time:  0.007242679595947266
time for parepare:  0.019853830337524414
local_output_nid generation:  0.01819467544555664
local_in_edges_tensor generation:  0.034064531326293945
mini_batch_src_global generation:  0.05283308029174805
r_  generation:  0.5350251197814941
local_output_nid generation:  0.0267336368560791
local_in_edges_tensor generation:  0.037004947662353516
mini_batch_src_global generation:  0.06541323661804199
r_  generation:  0.5451171398162842
----------------------check_connections_block total spend ----------------------------- 1.571563959121704
generate_one_block  0.6937956809997559
generate_one_block  0.7231714725494385
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.031094789505004883
gen group dst list time:  0.012530803680419922
time for parepare:  0.019188880920410156
local_output_nid generation:  0.02192544937133789
local_in_edges_tensor generation:  0.030247926712036133
mini_batch_src_global generation:  0.03228425979614258
r_  generation:  0.3837761878967285
local_output_nid generation:  0.03223562240600586
local_in_edges_tensor generation:  0.02779865264892578
mini_batch_src_global generation:  0.04187726974487305
r_  generation:  0.3910794258117676
----------------------check_connections_block total spend ----------------------------- 1.153801679611206
generate_one_block  0.4610722064971924
generate_one_block  0.4584929943084717
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.15929079055786133  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

connection checking time:  2.72536563873291
block generation total time  2.3365323543548584
average batch blocks generation time:  1.1682661771774292
block dataloader generation time/epoch 6.855296703485342
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11472177505493164  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.308736801147461  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11472177505493164  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3030762672424316  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.047580838203430176 |0.014361143112182617 |0.003995776176452637 |0.0005128383636474609 |0.04290306568145752 |0.0014162063598632812 |
----------------------------------------------------------pseudo_mini_loss sum 1.2883169651031494
Total (block generation + training)time/epoch 7.1927310686845045
Training time/epoch 0.3309295177459717
Training time without block to device /epoch 0.30220723152160645
Training time without total dataloading part /epoch 0.09623956680297852
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.95it/s]100%|██████████| 4/4 [00:00<00:00, 30.76it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.39it/s]100%|██████████| 4/4 [00:00<00:00, 12.41it/s]100%|██████████| 4/4 [00:00<00:00, 12.24it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.11it/s]100%|██████████| 4/4 [00:00<00:00, 17.29it/s]100%|██████████| 4/4 [00:00<00:00, 17.24it/s]
Run 00 | Epoch 00022 | Loss 1.2883 | Train 0.3693 | Val 0.4995 | Test 0.5291
Number of nodes during this epoch:  333812
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.15930747985839844  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020904541015625
range selection method range initialization spend 0.011898517608642578
time for parepare:  0.01848578453063965
local_output_nid generation:  0.010675430297851562
local_in_edges_tensor generation:  0.010320901870727539
mini_batch_src_global generation:  0.016346216201782227
r_  generation:  0.1958911418914795
local_output_nid generation:  0.011685371398925781
local_in_edges_tensor generation:  0.006316423416137695
mini_batch_src_global generation:  0.021392345428466797
r_  generation:  0.20856642723083496
----------------------check_connections_block total spend ----------------------------- 0.581139326095581
generate_one_block  0.23140954971313477
generate_one_block  0.23599934577941895
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04296135902404785
gen group dst list time:  0.007319450378417969
time for parepare:  0.020743846893310547
local_output_nid generation:  0.0176699161529541
local_in_edges_tensor generation:  0.04242587089538574
mini_batch_src_global generation:  0.05602717399597168
r_  generation:  0.5448393821716309
local_output_nid generation:  0.026984214782714844
local_in_edges_tensor generation:  0.042037010192871094
mini_batch_src_global generation:  0.06327247619628906
r_  generation:  0.5821452140808105
----------------------check_connections_block total spend ----------------------------- 1.6396255493164062
generate_one_block  0.6953263282775879
generate_one_block  0.6936295032501221
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.020782947540283203
gen group dst list time:  0.013466835021972656
time for parepare:  0.01858043670654297
local_output_nid generation:  0.022394657135009766
local_in_edges_tensor generation:  0.038641929626464844
mini_batch_src_global generation:  0.03407764434814453
r_  generation:  0.3752295970916748
local_output_nid generation:  0.03222012519836426
local_in_edges_tensor generation:  0.02812480926513672
mini_batch_src_global generation:  0.04020333290100098
r_  generation:  0.3820812702178955
----------------------check_connections_block total spend ----------------------------- 1.1465296745300293
generate_one_block  0.45422840118408203
generate_one_block  0.4508380889892578
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.15930747985839844  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

connection checking time:  2.7861552238464355
block generation total time  2.29402232170105
average batch blocks generation time:  1.147011160850525
block dataloader generation time/epoch 6.855783513614109
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11473321914672852  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.30833101272583  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1147150993347168  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3029499053955078  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08764398097991943 |0.016616463661193848 |0.00411069393157959 |0.0005050897598266602 |0.003787517547607422 |0.0016927719116210938 |
----------------------------------------------------------pseudo_mini_loss sum 1.2769660949707031
Total (block generation + training)time/epoch 7.1932151317596436
Training time/epoch 0.33724069595336914
Training time without block to device /epoch 0.30400776863098145
Training time without total dataloading part /epoch 0.018499374389648438
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 56.87it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.58it/s]100%|██████████| 4/4 [00:00<00:00, 14.91it/s]100%|██████████| 4/4 [00:00<00:00, 14.85it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.09it/s]100%|██████████| 4/4 [00:00<00:00, 17.49it/s]100%|██████████| 4/4 [00:00<00:00, 17.41it/s]
Run 00 | Epoch 00023 | Loss 1.2770 | Train 0.3756 | Val 0.5021 | Test 0.5297
Number of nodes during this epoch:  333823
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16023540496826172  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018738269805908203
range selection method range initialization spend 0.011987924575805664
time for parepare:  0.01681661605834961
local_output_nid generation:  0.010608196258544922
local_in_edges_tensor generation:  0.008976221084594727
mini_batch_src_global generation:  0.01625514030456543
r_  generation:  0.19032073020935059
local_output_nid generation:  0.011858940124511719
local_in_edges_tensor generation:  0.006166696548461914
mini_batch_src_global generation:  0.02100992202758789
r_  generation:  0.20613765716552734
----------------------check_connections_block total spend ----------------------------- 0.5672469139099121
generate_one_block  0.22814154624938965
generate_one_block  0.23144268989562988
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03542590141296387
gen group dst list time:  0.007180690765380859
time for parepare:  0.020030498504638672
local_output_nid generation:  0.018206357955932617
local_in_edges_tensor generation:  0.033247947692871094
mini_batch_src_global generation:  0.05262112617492676
r_  generation:  0.5367510318756104
local_output_nid generation:  0.027480602264404297
local_in_edges_tensor generation:  0.031139612197875977
mini_batch_src_global generation:  0.06400251388549805
r_  generation:  0.5509881973266602
----------------------check_connections_block total spend ----------------------------- 1.5717687606811523
generate_one_block  0.6890182495117188
generate_one_block  0.697575569152832
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01745152473449707
gen group dst list time:  0.012476682662963867
time for parepare:  0.018563270568847656
local_output_nid generation:  0.02254939079284668
local_in_edges_tensor generation:  0.030016422271728516
mini_batch_src_global generation:  0.03203272819519043
r_  generation:  0.3788876533508301
local_output_nid generation:  0.03295302391052246
local_in_edges_tensor generation:  0.027573585510253906
mini_batch_src_global generation:  0.04034566879272461
r_  generation:  0.3844432830810547
----------------------check_connections_block total spend ----------------------------- 1.1390068531036377
generate_one_block  0.45163750648498535
generate_one_block  0.45245361328125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16023540496826172  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

connection checking time:  2.71077561378479
block generation total time  2.290684938430786
average batch blocks generation time:  1.145342469215393
block dataloader generation time/epoch 6.849092260996501
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11471319198608398  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.307985782623291  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11474275588989258  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3038935661315918  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0860680341720581 |0.01406717300415039 |0.0037980079650878906 |0.0004967451095581055 |0.0036513805389404297 |0.0012509822845458984 |
----------------------------------------------------------pseudo_mini_loss sum 1.2660523653030396
Total (block generation + training)time/epoch 7.18672464688619
Training time/epoch 0.3403656482696533
Training time without block to device /epoch 0.31223130226135254
Training time without total dataloading part /epoch 0.01714324951171875
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 60.87it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.76it/s]100%|██████████| 4/4 [00:00<00:00, 15.11it/s]100%|██████████| 4/4 [00:00<00:00, 15.04it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.15it/s]100%|██████████| 4/4 [00:00<00:00, 17.29it/s]100%|██████████| 4/4 [00:00<00:00, 17.25it/s]
Run 00 | Epoch 00024 | Loss 1.2661 | Train 0.3814 | Val 0.5045 | Test 0.5318
Number of nodes during this epoch:  333726
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16023635864257812  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0200042724609375
range selection method range initialization spend 0.01186370849609375
time for parepare:  0.01714015007019043
local_output_nid generation:  0.010760068893432617
local_in_edges_tensor generation:  0.008599519729614258
mini_batch_src_global generation:  0.01629924774169922
r_  generation:  0.19186925888061523
local_output_nid generation:  0.012019634246826172
local_in_edges_tensor generation:  0.006229877471923828
mini_batch_src_global generation:  0.020662784576416016
r_  generation:  0.2077946662902832
----------------------check_connections_block total spend ----------------------------- 0.5715115070343018
generate_one_block  0.2340865135192871
generate_one_block  0.23098087310791016
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03074193000793457
gen group dst list time:  0.00718998908996582
time for parepare:  0.019834518432617188
local_output_nid generation:  0.018210172653198242
local_in_edges_tensor generation:  0.03004169464111328
mini_batch_src_global generation:  0.05361628532409668
r_  generation:  0.5387942790985107
local_output_nid generation:  0.028856277465820312
local_in_edges_tensor generation:  0.029166698455810547
mini_batch_src_global generation:  0.0635366439819336
r_  generation:  0.550006628036499
----------------------check_connections_block total spend ----------------------------- 1.5706489086151123
generate_one_block  0.6970195770263672
generate_one_block  0.6917219161987305
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02035069465637207
gen group dst list time:  0.012627840042114258
time for parepare:  0.01885199546813965
local_output_nid generation:  0.022528648376464844
local_in_edges_tensor generation:  0.03203439712524414
mini_batch_src_global generation:  0.03407907485961914
r_  generation:  0.37821078300476074
local_output_nid generation:  0.03281807899475098
local_in_edges_tensor generation:  0.02924180030822754
mini_batch_src_global generation:  0.040534019470214844
r_  generation:  0.38124895095825195
----------------------check_connections_block total spend ----------------------------- 1.147782802581787
generate_one_block  0.4641406536102295
generate_one_block  0.4548814296722412
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16023635864257812  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

connection checking time:  2.7184317111968994
block generation total time  2.3077635765075684
average batch blocks generation time:  1.1538817882537842
block dataloader generation time/epoch 6.844184130430222
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11470556259155273  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.303697109222412  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11472463607788086  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.308074951171875  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08656275272369385 |0.022414565086364746 |0.0038095712661743164 |0.0004985332489013672 |0.003835916519165039 |0.0014455318450927734 |
----------------------------------------------------------pseudo_mini_loss sum 1.2572925090789795
Total (block generation + training)time/epoch 7.182664021849632
Training time/epoch 0.35109472274780273
Training time without block to device /epoch 0.30626559257507324
Training time without total dataloading part /epoch 0.01773357391357422
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 48.23it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.86it/s]100%|██████████| 4/4 [00:00<00:00, 15.12it/s]100%|██████████| 4/4 [00:00<00:00, 15.07it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.03it/s]100%|██████████| 4/4 [00:00<00:00, 17.49it/s]100%|██████████| 4/4 [00:00<00:00, 17.40it/s]
Run 00 | Epoch 00025 | Loss 1.2573 | Train 0.3881 | Val 0.5068 | Test 0.5330
Number of nodes during this epoch:  333742
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1601872444152832  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018145322799682617
range selection method range initialization spend 0.011787176132202148
time for parepare:  0.017215728759765625
local_output_nid generation:  0.010795354843139648
local_in_edges_tensor generation:  0.014090538024902344
mini_batch_src_global generation:  0.016610383987426758
r_  generation:  0.19356036186218262
local_output_nid generation:  0.011878252029418945
local_in_edges_tensor generation:  0.006587028503417969
mini_batch_src_global generation:  0.021045207977294922
r_  generation:  0.20474743843078613
----------------------check_connections_block total spend ----------------------------- 0.5759754180908203
generate_one_block  0.22902631759643555
generate_one_block  0.2286834716796875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0369875431060791
gen group dst list time:  0.007277965545654297
time for parepare:  0.020328760147094727
local_output_nid generation:  0.01811075210571289
local_in_edges_tensor generation:  0.0353853702545166
mini_batch_src_global generation:  0.053003787994384766
r_  generation:  0.5388953685760498
local_output_nid generation:  0.0269320011138916
local_in_edges_tensor generation:  0.030671119689941406
mini_batch_src_global generation:  0.06354284286499023
r_  generation:  0.5453588962554932
----------------------check_connections_block total spend ----------------------------- 1.568861722946167
generate_one_block  0.696237325668335
generate_one_block  0.695035457611084
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01963973045349121
gen group dst list time:  0.012474775314331055
time for parepare:  0.018808841705322266
local_output_nid generation:  0.021970033645629883
local_in_edges_tensor generation:  0.028828144073486328
mini_batch_src_global generation:  0.032819271087646484
r_  generation:  0.373399019241333
local_output_nid generation:  0.03205084800720215
local_in_edges_tensor generation:  0.028845548629760742
mini_batch_src_global generation:  0.04066777229309082
r_  generation:  0.3801991939544678
----------------------check_connections_block total spend ----------------------------- 1.1321392059326172
generate_one_block  0.4573490619659424
generate_one_block  0.4624490737915039
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1601872444152832  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

connection checking time:  2.701000928878784
block generation total time  2.3110709190368652
average batch blocks generation time:  1.1555354595184326
block dataloader generation time/epoch 6.840525430791518
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11477899551391602  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3093514442443848  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11465978622436523  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.30263090133667  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0769956111907959 |0.015069723129272461 |0.016445398330688477 |0.0005043745040893555 |0.003662705421447754 |0.0013155937194824219 |
----------------------------------------------------------pseudo_mini_loss sum 1.242553472518921
Total (block generation + training)time/epoch 7.179060725604787
Training time/epoch 0.33931756019592285
Training time without block to device /epoch 0.30917811393737793
Training time without total dataloading part /epoch 0.042540550231933594
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.30it/s]100%|██████████| 4/4 [00:00<00:00, 30.39it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.08it/s]100%|██████████| 4/4 [00:00<00:00, 12.22it/s]100%|██████████| 4/4 [00:00<00:00, 12.03it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.51it/s]100%|██████████| 4/4 [00:00<00:00, 16.81it/s]100%|██████████| 4/4 [00:00<00:00, 16.75it/s]
Run 00 | Epoch 00026 | Loss 1.2426 | Train 0.3947 | Val 0.5097 | Test 0.5343
Number of nodes during this epoch:  333785
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16015243530273438  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021089553833007812
range selection method range initialization spend 0.012092113494873047
time for parepare:  0.017203092575073242
local_output_nid generation:  0.010650634765625
local_in_edges_tensor generation:  0.010538816452026367
mini_batch_src_global generation:  0.01708245277404785
r_  generation:  0.1928267478942871
local_output_nid generation:  0.011801481246948242
local_in_edges_tensor generation:  0.008690834045410156
mini_batch_src_global generation:  0.02065563201904297
r_  generation:  0.20596718788146973
----------------------check_connections_block total spend ----------------------------- 0.5748147964477539
generate_one_block  0.22860145568847656
generate_one_block  0.2318260669708252
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04068493843078613
gen group dst list time:  0.007340669631958008
time for parepare:  0.020023107528686523
local_output_nid generation:  0.017923355102539062
local_in_edges_tensor generation:  0.03811979293823242
mini_batch_src_global generation:  0.0553433895111084
r_  generation:  0.532252311706543
local_output_nid generation:  0.026508808135986328
local_in_edges_tensor generation:  0.038153648376464844
mini_batch_src_global generation:  0.06300854682922363
r_  generation:  0.5473830699920654
----------------------check_connections_block total spend ----------------------------- 1.5747778415679932
generate_one_block  0.6892960071563721
generate_one_block  0.7019290924072266
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.021038055419921875
gen group dst list time:  0.012596845626831055
time for parepare:  0.018962860107421875
local_output_nid generation:  0.022800445556640625
local_in_edges_tensor generation:  0.030242204666137695
mini_batch_src_global generation:  0.03220701217651367
r_  generation:  0.37305712699890137
local_output_nid generation:  0.031990766525268555
local_in_edges_tensor generation:  0.029213428497314453
mini_batch_src_global generation:  0.0408177375793457
r_  generation:  0.382845401763916
----------------------check_connections_block total spend ----------------------------- 1.1365337371826172
generate_one_block  0.45867013931274414
generate_one_block  0.46160054206848145
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16015243530273438  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

connection checking time:  2.7113115787506104
block generation total time  2.311495780944824
average batch blocks generation time:  1.155747890472412
block dataloader generation time/epoch 6.8402277496125965
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11470460891723633  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3036985397338867  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11474275588989258  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3044276237487793  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08688163757324219 |0.014299988746643066 |0.004075884819030762 |0.0005183219909667969 |0.003793001174926758 |0.0013628005981445312 |
----------------------------------------------------------pseudo_mini_loss sum 1.2276511192321777
Total (block generation + training)time/epoch 7.178667876455519
Training time/epoch 0.33667635917663574
Training time without block to device /epoch 0.3080763816833496
Training time without total dataloading part /epoch 0.018137216567993164
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 48.34it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.80it/s]100%|██████████| 4/4 [00:00<00:00, 15.10it/s]100%|██████████| 4/4 [00:00<00:00, 15.03it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.05it/s]100%|██████████| 4/4 [00:00<00:00, 17.54it/s]100%|██████████| 4/4 [00:00<00:00, 17.45it/s]
Run 00 | Epoch 00027 | Loss 1.2277 | Train 0.4022 | Val 0.5108 | Test 0.5324
Number of nodes during this epoch:  333811
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1602039337158203  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022330522537231445
range selection method range initialization spend 0.011867046356201172
time for parepare:  0.016840457916259766
local_output_nid generation:  0.010723590850830078
local_in_edges_tensor generation:  0.008829116821289062
mini_batch_src_global generation:  0.016984224319458008
r_  generation:  0.19612336158752441
local_output_nid generation:  0.012284517288208008
local_in_edges_tensor generation:  0.008661746978759766
mini_batch_src_global generation:  0.02268242835998535
r_  generation:  0.2143723964691162
----------------------check_connections_block total spend ----------------------------- 0.5910251140594482
generate_one_block  0.2400524616241455
generate_one_block  0.2350761890411377
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.045377492904663086
gen group dst list time:  0.007264137268066406
time for parepare:  0.021483659744262695
local_output_nid generation:  0.019043922424316406
local_in_edges_tensor generation:  0.0435032844543457
mini_batch_src_global generation:  0.0553436279296875
r_  generation:  0.5640895366668701
local_output_nid generation:  0.0303647518157959
local_in_edges_tensor generation:  0.039191246032714844
mini_batch_src_global generation:  0.0630958080291748
r_  generation:  0.5622437000274658
----------------------check_connections_block total spend ----------------------------- 1.6372451782226562
generate_one_block  0.6934258937835693
generate_one_block  0.6971950531005859
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.021914005279541016
gen group dst list time:  0.012449264526367188
time for parepare:  0.020838499069213867
local_output_nid generation:  0.022473573684692383
local_in_edges_tensor generation:  0.032646894454956055
mini_batch_src_global generation:  0.03217458724975586
r_  generation:  0.38443684577941895
local_output_nid generation:  0.03736519813537598
local_in_edges_tensor generation:  0.03479456901550293
mini_batch_src_global generation:  0.041143178939819336
r_  generation:  0.39154601097106934
----------------------check_connections_block total spend ----------------------------- 1.1740972995758057
generate_one_block  0.468172550201416
generate_one_block  0.4592416286468506
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1602039337158203  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

connection checking time:  2.811342477798462
block generation total time  2.318035125732422
average batch blocks generation time:  1.159017562866211
block dataloader generation time/epoch 6.846776861893503
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11475610733032227  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3097734451293945  GigaBytes
Max Memory Allocated: 1.5766582489013672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11469888687133789  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3025527000427246  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04942905902862549 |0.015184640884399414 |0.0041027069091796875 |0.0005195140838623047 |0.0456233024597168 |0.0013415813446044922 |
----------------------------------------------------------pseudo_mini_loss sum 1.2185888290405273
Total (block generation + training)time/epoch 7.18565317204124
Training time/epoch 0.34657812118530273
Training time without block to device /epoch 0.3162088394165039
Training time without total dataloading part /epoch 0.10183262825012207
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 58.83it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.88it/s]100%|██████████| 4/4 [00:00<00:00, 15.08it/s]100%|██████████| 4/4 [00:00<00:00, 15.03it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.13it/s]100%|██████████| 4/4 [00:00<00:00, 17.45it/s]100%|██████████| 4/4 [00:00<00:00, 17.38it/s]
Run 00 | Epoch 00028 | Loss 1.2186 | Train 0.4082 | Val 0.5103 | Test 0.5294
Number of nodes during this epoch:  333814
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1593308448791504  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021837234497070312
range selection method range initialization spend 0.012004852294921875
time for parepare:  0.016904830932617188
local_output_nid generation:  0.010775566101074219
local_in_edges_tensor generation:  0.010088920593261719
mini_batch_src_global generation:  0.016419649124145508
r_  generation:  0.19207549095153809
local_output_nid generation:  0.012150287628173828
local_in_edges_tensor generation:  0.0063343048095703125
mini_batch_src_global generation:  0.02095627784729004
r_  generation:  0.21010661125183105
----------------------check_connections_block total spend ----------------------------- 0.5758178234100342
generate_one_block  0.22896885871887207
generate_one_block  0.2303769588470459
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.032739877700805664
gen group dst list time:  0.007319450378417969
time for parepare:  0.020221233367919922
local_output_nid generation:  0.018435239791870117
local_in_edges_tensor generation:  0.034979820251464844
mini_batch_src_global generation:  0.0604097843170166
r_  generation:  0.5390150547027588
local_output_nid generation:  0.028298377990722656
local_in_edges_tensor generation:  0.029045581817626953
mini_batch_src_global generation:  0.06364727020263672
r_  generation:  0.5494401454925537
----------------------check_connections_block total spend ----------------------------- 1.580427646636963
generate_one_block  0.6933894157409668
generate_one_block  0.7070634365081787
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.018665790557861328
gen group dst list time:  0.012395858764648438
time for parepare:  0.020568132400512695
local_output_nid generation:  0.023182392120361328
local_in_edges_tensor generation:  0.04114866256713867
mini_batch_src_global generation:  0.03269195556640625
r_  generation:  0.3806579113006592
local_output_nid generation:  0.0330500602722168
local_in_edges_tensor generation:  0.029214859008789062
mini_batch_src_global generation:  0.040253639221191406
r_  generation:  0.3910543918609619
----------------------check_connections_block total spend ----------------------------- 1.1666152477264404
generate_one_block  0.4547607898712158
generate_one_block  0.46975231170654297
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1593308448791504  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.7470428943634033
block generation total time  2.3249659538269043
average batch blocks generation time:  1.1624829769134521
block dataloader generation time/epoch 6.847035491466523
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11473608016967773  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3086767196655273  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11471414566040039  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3035411834716797  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08793282508850098 |0.027260899543762207 |0.0037270784378051758 |0.00047791004180908203 |0.003899216651916504 |0.002719879150390625 |
----------------------------------------------------------pseudo_mini_loss sum 1.2093404531478882
Total (block generation + training)time/epoch 7.186884081363678
Training time/epoch 0.3582432270050049
Training time without block to device /epoch 0.30372142791748047
Training time without total dataloading part /epoch 0.01892828941345215
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 52.73it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.98it/s]100%|██████████| 4/4 [00:00<00:00, 15.23it/s]100%|██████████| 4/4 [00:00<00:00, 15.18it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.06it/s]100%|██████████| 4/4 [00:00<00:00, 17.34it/s]100%|██████████| 4/4 [00:00<00:00, 17.27it/s]
Run 00 | Epoch 00029 | Loss 1.2093 | Train 0.4109 | Val 0.5092 | Test 0.5255
Number of nodes during this epoch:  333841
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1602187156677246  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02231597900390625
range selection method range initialization spend 0.012096643447875977
time for parepare:  0.017102479934692383
local_output_nid generation:  0.01064443588256836
local_in_edges_tensor generation:  0.01193857192993164
mini_batch_src_global generation:  0.0163724422454834
r_  generation:  0.19277739524841309
local_output_nid generation:  0.011847734451293945
local_in_edges_tensor generation:  0.0068454742431640625
mini_batch_src_global generation:  0.020814895629882812
r_  generation:  0.20607280731201172
----------------------check_connections_block total spend ----------------------------- 0.5746116638183594
generate_one_block  0.22833681106567383
generate_one_block  0.22861456871032715
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03767848014831543
gen group dst list time:  0.007305145263671875
time for parepare:  0.03369569778442383
local_output_nid generation:  0.020527124404907227
local_in_edges_tensor generation:  0.045754194259643555
mini_batch_src_global generation:  0.05713534355163574
r_  generation:  0.5902259349822998
local_output_nid generation:  0.03314375877380371
local_in_edges_tensor generation:  0.03509640693664551
mini_batch_src_global generation:  0.07224059104919434
r_  generation:  0.5950179100036621
----------------------check_connections_block total spend ----------------------------- 1.746626615524292
generate_one_block  0.6942925453186035
generate_one_block  0.6865057945251465
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.019064903259277344
gen group dst list time:  0.01468205451965332
time for parepare:  0.01878809928894043
local_output_nid generation:  0.022212982177734375
local_in_edges_tensor generation:  0.031245946884155273
mini_batch_src_global generation:  0.03216958045959473
r_  generation:  0.3718559741973877
local_output_nid generation:  0.03155112266540527
local_in_edges_tensor generation:  0.028451919555664062
mini_batch_src_global generation:  0.040216922760009766
r_  generation:  0.3830733299255371
----------------------check_connections_block total spend ----------------------------- 1.1311447620391846
generate_one_block  0.4592015743255615
generate_one_block  0.45902466773986816
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1602187156677246  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.8777713775634766
block generation total time  2.2990245819091797
average batch blocks generation time:  1.1495122909545898
block dataloader generation time/epoch 6.852522112074352
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11472845077514648  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3038768768310547  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11470460891723633  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3034744262695312  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08533966541290283 |0.015780091285705566 |0.003943324089050293 |0.0004979372024536133 |0.0033316612243652344 |0.0014276504516601562 |
----------------------------------------------------------pseudo_mini_loss sum 1.2036644220352173
Total (block generation + training)time/epoch 7.192020870390392
Training time/epoch 0.3324003219604492
Training time without block to device /epoch 0.3008401393890381
Training time without total dataloading part /epoch 0.016973495483398438
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.62it/s]100%|██████████| 4/4 [00:00<00:00, 31.02it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.34it/s]100%|██████████| 4/4 [00:00<00:00, 12.31it/s]100%|██████████| 4/4 [00:00<00:00, 12.14it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.45it/s]100%|██████████| 4/4 [00:00<00:00, 17.26it/s]100%|██████████| 4/4 [00:00<00:00, 17.27it/s]
Run 00 | Epoch 00030 | Loss 1.2037 | Train 0.4118 | Val 0.5084 | Test 0.5195
Number of nodes during this epoch:  333699
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1602025032043457  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018446922302246094
range selection method range initialization spend 0.011992931365966797
time for parepare:  0.016936540603637695
local_output_nid generation:  0.010740280151367188
local_in_edges_tensor generation:  0.00890207290649414
mini_batch_src_global generation:  0.016342639923095703
r_  generation:  0.1928541660308838
local_output_nid generation:  0.01173090934753418
local_in_edges_tensor generation:  0.006970882415771484
mini_batch_src_global generation:  0.02067089080810547
r_  generation:  0.20447492599487305
----------------------check_connections_block total spend ----------------------------- 0.5698986053466797
generate_one_block  0.22975730895996094
generate_one_block  0.23111915588378906
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0321955680847168
gen group dst list time:  0.007315397262573242
time for parepare:  0.0198976993560791
local_output_nid generation:  0.01875591278076172
local_in_edges_tensor generation:  0.03242135047912598
mini_batch_src_global generation:  0.05347013473510742
r_  generation:  0.5736644268035889
local_output_nid generation:  0.03044414520263672
local_in_edges_tensor generation:  0.04255056381225586
mini_batch_src_global generation:  0.06523942947387695
r_  generation:  0.5652046203613281
----------------------check_connections_block total spend ----------------------------- 1.6430845260620117
generate_one_block  0.7109982967376709
generate_one_block  0.7053163051605225
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01863694190979004
gen group dst list time:  0.012447118759155273
time for parepare:  0.018780231475830078
local_output_nid generation:  0.0228731632232666
local_in_edges_tensor generation:  0.03884243965148926
mini_batch_src_global generation:  0.03233623504638672
r_  generation:  0.37879228591918945
local_output_nid generation:  0.03311634063720703
local_in_edges_tensor generation:  0.026656150817871094
mini_batch_src_global generation:  0.04100465774536133
r_  generation:  0.4031217098236084
----------------------check_connections_block total spend ----------------------------- 1.169992208480835
generate_one_block  0.4692065715789795
generate_one_block  0.4591050148010254
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1602025032043457  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.8130767345428467
block generation total time  2.3446261882781982
average batch blocks generation time:  1.1723130941390991
block dataloader generation time/epoch 6.854655319994146
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11473703384399414  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3038921356201172  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11469411849975586  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3038649559020996  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08900976181030273 |0.016140103340148926 |0.004019021987915039 |0.0005037784576416016 |0.002869129180908203 |0.0013494491577148438 |
----------------------------------------------------------pseudo_mini_loss sum 1.1948237419128418
Total (block generation + training)time/epoch 7.194380402565002
Training time/epoch 0.344329833984375
Training time without block to device /epoch 0.31204962730407715
Training time without total dataloading part /epoch 0.01613330841064453
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 55.70it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.85it/s]100%|██████████| 4/4 [00:00<00:00, 15.10it/s]100%|██████████| 4/4 [00:00<00:00, 15.04it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.01it/s]100%|██████████| 4/4 [00:00<00:00, 17.20it/s]100%|██████████| 4/4 [00:00<00:00, 17.15it/s]
Run 00 | Epoch 00031 | Loss 1.1948 | Train 0.4122 | Val 0.5073 | Test 0.5161
Number of nodes during this epoch:  333865
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1601552963256836  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01778101921081543
range selection method range initialization spend 0.011850118637084961
time for parepare:  0.0169830322265625
local_output_nid generation:  0.010556936264038086
local_in_edges_tensor generation:  0.00898289680480957
mini_batch_src_global generation:  0.016566038131713867
r_  generation:  0.19294285774230957
local_output_nid generation:  0.011923074722290039
local_in_edges_tensor generation:  0.006208181381225586
mini_batch_src_global generation:  0.02329874038696289
r_  generation:  0.206071138381958
----------------------check_connections_block total spend ----------------------------- 0.5719881057739258
generate_one_block  0.2318568229675293
generate_one_block  0.23046135902404785
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03598642349243164
gen group dst list time:  0.007022857666015625
time for parepare:  0.020144224166870117
local_output_nid generation:  0.01832437515258789
local_in_edges_tensor generation:  0.03569221496582031
mini_batch_src_global generation:  0.052771806716918945
r_  generation:  0.5392551422119141
local_output_nid generation:  0.02780890464782715
local_in_edges_tensor generation:  0.0312197208404541
mini_batch_src_global generation:  0.06670999526977539
r_  generation:  0.5559403896331787
----------------------check_connections_block total spend ----------------------------- 1.589090347290039
generate_one_block  0.7281415462493896
generate_one_block  0.7034096717834473
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02260446548461914
gen group dst list time:  0.014467477798461914
time for parepare:  0.018368005752563477
local_output_nid generation:  0.02386641502380371
local_in_edges_tensor generation:  0.047937631607055664
mini_batch_src_global generation:  0.03232288360595703
r_  generation:  0.37505149841308594
local_output_nid generation:  0.035010576248168945
local_in_edges_tensor generation:  0.030091047286987305
mini_batch_src_global generation:  0.0407865047454834
r_  generation:  0.38278913497924805
----------------------check_connections_block total spend ----------------------------- 1.1619188785552979
generate_one_block  0.45862555503845215
generate_one_block  0.4596245288848877
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1601552963256836  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.751009225845337
block generation total time  2.3498013019561768
average batch blocks generation time:  1.1749006509780884
block dataloader generation time/epoch 6.850802494132
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11477899551391602  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3092150688171387  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1146550178527832  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3029093742370605  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.10028302669525146 |0.017202377319335938 |0.003923892974853516 |0.04400503635406494 |0.0035246610641479492 |0.002861499786376953 |
----------------------------------------------------------pseudo_mini_loss sum 1.1833205223083496
Total (block generation + training)time/epoch 7.193476096443508
Training time/epoch 0.40739989280700684
Training time without block to device /epoch 0.37299513816833496
Training time without total dataloading part /epoch 0.10576868057250977
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.09it/s]100%|██████████| 4/4 [00:00<00:00, 30.31it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.58it/s]100%|██████████| 4/4 [00:00<00:00, 12.63it/s]100%|██████████| 4/4 [00:00<00:00, 12.45it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.42it/s]100%|██████████| 4/4 [00:00<00:00, 17.71it/s]100%|██████████| 4/4 [00:00<00:00, 17.65it/s]
Run 00 | Epoch 00032 | Loss 1.1833 | Train 0.4123 | Val 0.5080 | Test 0.5155
Number of nodes during this epoch:  333780
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16013240814208984  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019231796264648438
range selection method range initialization spend 0.011955738067626953
time for parepare:  0.01806950569152832
local_output_nid generation:  0.010910272598266602
local_in_edges_tensor generation:  0.008866071701049805
mini_batch_src_global generation:  0.017661333084106445
r_  generation:  0.1923367977142334
local_output_nid generation:  0.011898279190063477
local_in_edges_tensor generation:  0.0062274932861328125
mini_batch_src_global generation:  0.02271270751953125
r_  generation:  0.20857644081115723
----------------------check_connections_block total spend ----------------------------- 0.5761432647705078
generate_one_block  0.23226618766784668
generate_one_block  0.2297825813293457
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.035013675689697266
gen group dst list time:  0.007031679153442383
time for parepare:  0.020440101623535156
local_output_nid generation:  0.017931461334228516
local_in_edges_tensor generation:  0.032607078552246094
mini_batch_src_global generation:  0.054326534271240234
r_  generation:  0.5337300300598145
local_output_nid generation:  0.0274810791015625
local_in_edges_tensor generation:  0.03291797637939453
mini_batch_src_global generation:  0.06330442428588867
r_  generation:  0.5495734214782715
----------------------check_connections_block total spend ----------------------------- 1.5703871250152588
generate_one_block  0.7003304958343506
generate_one_block  0.717461109161377
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.023926973342895508
gen group dst list time:  0.012664079666137695
time for parepare:  0.0228269100189209
local_output_nid generation:  0.023079872131347656
local_in_edges_tensor generation:  0.03922104835510254
mini_batch_src_global generation:  0.032985687255859375
r_  generation:  0.3935849666595459
local_output_nid generation:  0.033548593521118164
local_in_edges_tensor generation:  0.03525829315185547
mini_batch_src_global generation:  0.04399919509887695
r_  generation:  0.405287504196167
----------------------check_connections_block total spend ----------------------------- 1.212306022644043
generate_one_block  0.4810142517089844
generate_one_block  0.4684727191925049
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16013240814208984  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.7826931476593018
block generation total time  2.367278575897217
average batch blocks generation time:  1.1836392879486084
block dataloader generation time/epoch 6.850076198577881
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11475419998168945  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.308300495147705  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11469697952270508  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3030824661254883  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08779585361480713 |0.02662956714630127 |0.0037451982498168945 |0.0005048513412475586 |0.0032023191452026367 |0.0012807846069335938 |
----------------------------------------------------------pseudo_mini_loss sum 1.1795799732208252
Total (block generation + training)time/epoch 7.193514982859294
Training time/epoch 0.3609466552734375
Training time without block to device /epoch 0.30768752098083496
Training time without total dataloading part /epoch 0.016185522079467773
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 52.17it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.73it/s]100%|██████████| 4/4 [00:00<00:00, 13.73it/s]100%|██████████| 4/4 [00:00<00:00, 13.37it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.90it/s]100%|██████████| 4/4 [00:00<00:00, 17.55it/s]100%|██████████| 4/4 [00:00<00:00, 17.43it/s]
Run 00 | Epoch 00033 | Loss 1.1796 | Train 0.4122 | Val 0.5077 | Test 0.5151
Number of nodes during this epoch:  333871
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16019344329833984  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01955723762512207
range selection method range initialization spend 0.011917352676391602
time for parepare:  0.018096446990966797
local_output_nid generation:  0.01096343994140625
local_in_edges_tensor generation:  0.010699033737182617
mini_batch_src_global generation:  0.016289949417114258
r_  generation:  0.19055724143981934
local_output_nid generation:  0.012284994125366211
local_in_edges_tensor generation:  0.006901979446411133
mini_batch_src_global generation:  0.020870685577392578
r_  generation:  0.20750927925109863
----------------------check_connections_block total spend ----------------------------- 0.5727415084838867
generate_one_block  0.2318286895751953
generate_one_block  0.23299241065979004
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03439664840698242
gen group dst list time:  0.006987094879150391
time for parepare:  0.020030975341796875
local_output_nid generation:  0.01859736442565918
local_in_edges_tensor generation:  0.03226351737976074
mini_batch_src_global generation:  0.05467987060546875
r_  generation:  0.5343589782714844
local_output_nid generation:  0.028560400009155273
local_in_edges_tensor generation:  0.030565261840820312
mini_batch_src_global generation:  0.06339240074157715
r_  generation:  0.5481293201446533
----------------------check_connections_block total spend ----------------------------- 1.566636323928833
generate_one_block  0.6857450008392334
generate_one_block  0.7108325958251953
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02011704444885254
gen group dst list time:  0.012327909469604492
time for parepare:  0.019613981246948242
local_output_nid generation:  0.024105072021484375
local_in_edges_tensor generation:  0.0296628475189209
mini_batch_src_global generation:  0.03264880180358887
r_  generation:  0.3907589912414551
local_output_nid generation:  0.032857418060302734
local_in_edges_tensor generation:  0.027203798294067383
mini_batch_src_global generation:  0.04062652587890625
r_  generation:  0.3864173889160156
----------------------check_connections_block total spend ----------------------------- 1.1599133014678955
generate_one_block  0.45489025115966797
generate_one_block  0.4524405002593994
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16019344329833984  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.7265496253967285
block generation total time  2.303908348083496
average batch blocks generation time:  1.151954174041748
block dataloader generation time/epoch 6.847839908599854
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11468362808227539  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3034882545471191  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11475229263305664  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.303300380706787  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.10145318508148193 |0.014204978942871094 |0.0037811994552612305 |0.0004863739013671875 |0.0031211376190185547 |0.0017392635345458984 |
----------------------------------------------------------pseudo_mini_loss sum 1.1690106391906738
Total (block generation + training)time/epoch 7.1917662525177
Training time/epoch 0.355532169342041
Training time without block to device /epoch 0.32712221145629883
Training time without total dataloading part /epoch 0.016516685485839844
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 63.58it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.94it/s]100%|██████████| 4/4 [00:00<00:00, 15.14it/s]100%|██████████| 4/4 [00:00<00:00, 15.09it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.97it/s]100%|██████████| 4/4 [00:00<00:00, 17.22it/s]100%|██████████| 4/4 [00:00<00:00, 17.17it/s]
Run 00 | Epoch 00034 | Loss 1.1690 | Train 0.4119 | Val 0.5075 | Test 0.5145
Number of nodes during this epoch:  333732
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16027593612670898  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019809246063232422
range selection method range initialization spend 0.01191568374633789
time for parepare:  0.01800823211669922
local_output_nid generation:  0.01149129867553711
local_in_edges_tensor generation:  0.009701251983642578
mini_batch_src_global generation:  0.017079591751098633
r_  generation:  0.19595980644226074
local_output_nid generation:  0.012619495391845703
local_in_edges_tensor generation:  0.008265018463134766
mini_batch_src_global generation:  0.02348923683166504
r_  generation:  0.21406245231628418
----------------------check_connections_block total spend ----------------------------- 0.5909874439239502
generate_one_block  0.23575234413146973
generate_one_block  0.23085522651672363
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05079293251037598
gen group dst list time:  0.007002830505371094
time for parepare:  0.020493030548095703
local_output_nid generation:  0.01872086524963379
local_in_edges_tensor generation:  0.047130584716796875
mini_batch_src_global generation:  0.05430769920349121
r_  generation:  0.529390811920166
local_output_nid generation:  0.02749347686767578
local_in_edges_tensor generation:  0.04034924507141113
mini_batch_src_global generation:  0.06423163414001465
r_  generation:  0.5426735877990723
----------------------check_connections_block total spend ----------------------------- 1.5836262702941895
generate_one_block  0.6970067024230957
generate_one_block  0.6931655406951904
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.024997472763061523
gen group dst list time:  0.01308894157409668
time for parepare:  0.019543886184692383
local_output_nid generation:  0.023237943649291992
local_in_edges_tensor generation:  0.031030654907226562
mini_batch_src_global generation:  0.04076743125915527
r_  generation:  0.3755500316619873
local_output_nid generation:  0.03457283973693848
local_in_edges_tensor generation:  0.03450751304626465
mini_batch_src_global generation:  0.03992891311645508
r_  generation:  0.37485766410827637
----------------------check_connections_block total spend ----------------------------- 1.1512389183044434
generate_one_block  0.4465141296386719
generate_one_block  0.4535694122314453
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16027593612670898  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.734865188598633
block generation total time  2.2902557849884033
average batch blocks generation time:  1.1451278924942017
block dataloader generation time/epoch 6.846269589204055
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1147150993347168  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.308058261871338  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11471891403198242  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3032631874084473  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08822786808013916 |0.02424633502960205 |0.003937244415283203 |0.0004912614822387695 |0.002676844596862793 |0.0014965534210205078 |
----------------------------------------------------------pseudo_mini_loss sum 1.1631195545196533
Total (block generation + training)time/epoch 7.190533922268794
Training time/epoch 0.35256147384643555
Training time without block to device /epoch 0.30406880378723145
Training time without total dataloading part /epoch 0.01570725440979004
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.83it/s]100%|██████████| 4/4 [00:00<00:00, 29.81it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.51it/s]100%|██████████| 4/4 [00:00<00:00, 12.64it/s]100%|██████████| 4/4 [00:00<00:00, 12.45it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.60it/s]100%|██████████| 4/4 [00:00<00:00, 17.79it/s]100%|██████████| 4/4 [00:00<00:00, 17.74it/s]
Run 00 | Epoch 00035 | Loss 1.1631 | Train 0.4121 | Val 0.5074 | Test 0.5156
Number of nodes during this epoch:  333692
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.15935754776000977  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020002365112304688
range selection method range initialization spend 0.012060165405273438
time for parepare:  0.01655888557434082
local_output_nid generation:  0.010522127151489258
local_in_edges_tensor generation:  0.013280630111694336
mini_batch_src_global generation:  0.01601576805114746
r_  generation:  0.18713831901550293
local_output_nid generation:  0.011733770370483398
local_in_edges_tensor generation:  0.006534576416015625
mini_batch_src_global generation:  0.021970033645629883
r_  generation:  0.20344066619873047
----------------------check_connections_block total spend ----------------------------- 0.5651612281799316
generate_one_block  0.22609591484069824
generate_one_block  0.2295856475830078
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.033586978912353516
gen group dst list time:  0.006950855255126953
time for parepare:  0.01972675323486328
local_output_nid generation:  0.017988204956054688
local_in_edges_tensor generation:  0.03544282913208008
mini_batch_src_global generation:  0.052573204040527344
r_  generation:  0.5285372734069824
local_output_nid generation:  0.026961803436279297
local_in_edges_tensor generation:  0.03331351280212402
mini_batch_src_global generation:  0.06472277641296387
r_  generation:  0.5508213043212891
----------------------check_connections_block total spend ----------------------------- 1.5653939247131348
generate_one_block  0.6897847652435303
generate_one_block  0.7074346542358398
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030426502227783203
gen group dst list time:  0.012996912002563477
time for parepare:  0.019225597381591797
local_output_nid generation:  0.023904800415039062
local_in_edges_tensor generation:  0.03503894805908203
mini_batch_src_global generation:  0.03163647651672363
r_  generation:  0.3804645538330078
local_output_nid generation:  0.032601356506347656
local_in_edges_tensor generation:  0.030544281005859375
mini_batch_src_global generation:  0.03992724418640137
r_  generation:  0.386737585067749
----------------------check_connections_block total spend ----------------------------- 1.1655473709106445
generate_one_block  0.4460725784301758
generate_one_block  0.44638633728027344
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.15935754776000977  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.7309412956237793
block generation total time  2.2896783351898193
average batch blocks generation time:  1.1448391675949097
block dataloader generation time/epoch 6.843526963834409
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11467313766479492  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3042221069335938  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1147761344909668  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3090195655822754  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08976149559020996 |0.022881150245666504 |0.0038950443267822266 |0.0004782676696777344 |0.0029015541076660156 |0.0012476444244384766 |
----------------------------------------------------------pseudo_mini_loss sum 1.153504490852356
Total (block generation + training)time/epoch 7.188134599615027
Training time/epoch 0.3533923625946045
Training time without block to device /epoch 0.3076300621032715
Training time without total dataloading part /epoch 0.01579737663269043
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.06it/s]100%|██████████| 4/4 [00:00<00:00, 30.13it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.64it/s]100%|██████████| 4/4 [00:00<00:00, 12.81it/s]100%|██████████| 4/4 [00:00<00:00, 12.61it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.56it/s]100%|██████████| 4/4 [00:00<00:00, 17.83it/s]100%|██████████| 4/4 [00:00<00:00, 17.76it/s]
Run 00 | Epoch 00036 | Loss 1.1535 | Train 0.4122 | Val 0.5065 | Test 0.5149
Number of nodes during this epoch:  333753
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16120672225952148  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021311521530151367
range selection method range initialization spend 0.012241363525390625
time for parepare:  0.016663789749145508
local_output_nid generation:  0.010856866836547852
local_in_edges_tensor generation:  0.009482860565185547
mini_batch_src_global generation:  0.016227006912231445
r_  generation:  0.18967080116271973
local_output_nid generation:  0.01188206672668457
local_in_edges_tensor generation:  0.006093025207519531
mini_batch_src_global generation:  0.02033376693725586
r_  generation:  0.2062244415283203
----------------------check_connections_block total spend ----------------------------- 0.5656094551086426
generate_one_block  0.22899150848388672
generate_one_block  0.22775030136108398
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.042235374450683594
gen group dst list time:  0.007040500640869141
time for parepare:  0.01962590217590332
local_output_nid generation:  0.017589569091796875
local_in_edges_tensor generation:  0.038233280181884766
mini_batch_src_global generation:  0.050899505615234375
r_  generation:  0.529564619064331
local_output_nid generation:  0.026591062545776367
local_in_edges_tensor generation:  0.03671669960021973
mini_batch_src_global generation:  0.06249380111694336
r_  generation:  0.5409972667694092
----------------------check_connections_block total spend ----------------------------- 1.557051181793213
generate_one_block  0.6779289245605469
generate_one_block  0.6807951927185059
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030695438385009766
gen group dst list time:  0.012289285659790039
time for parepare:  0.018236875534057617
local_output_nid generation:  0.02191758155822754
local_in_edges_tensor generation:  0.029041290283203125
mini_batch_src_global generation:  0.03128314018249512
r_  generation:  0.3721160888671875
local_output_nid generation:  0.031662702560424805
local_in_edges_tensor generation:  0.0291745662689209
mini_batch_src_global generation:  0.03996777534484863
r_  generation:  0.3743424415588379
----------------------check_connections_block total spend ----------------------------- 1.1185595989227295
generate_one_block  0.4457590579986572
generate_one_block  0.44704437255859375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16120672225952148  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.6756107807159424
block generation total time  2.2515275478363037
average batch blocks generation time:  1.1257637739181519
block dataloader generation time/epoch 6.837729471070426
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11472654342651367  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3080945014953613  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11472368240356445  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3037409782409668  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08366405963897705 |0.01380002498626709 |0.004487395286560059 |0.0004876852035522461 |0.0031676292419433594 |0.0013301372528076172 |
----------------------------------------------------------pseudo_mini_loss sum 1.1473798751831055
Total (block generation + training)time/epoch 7.18158619744437
Training time/epoch 0.3235037326812744
Training time without block to device /epoch 0.29590368270874023
Training time without total dataloading part /epoch 0.017615556716918945
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.18it/s]100%|██████████| 4/4 [00:00<00:00, 31.62it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.33it/s]100%|██████████| 4/4 [00:00<00:00, 12.47it/s]100%|██████████| 4/4 [00:00<00:00, 12.27it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.37it/s]100%|██████████| 4/4 [00:00<00:00, 17.70it/s]100%|██████████| 4/4 [00:00<00:00, 17.63it/s]
Run 00 | Epoch 00037 | Loss 1.1474 | Train 0.4119 | Val 0.5057 | Test 0.5151
Number of nodes during this epoch:  333781
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16021156311035156  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.017945289611816406
range selection method range initialization spend 0.011780261993408203
time for parepare:  0.016663551330566406
local_output_nid generation:  0.010651588439941406
local_in_edges_tensor generation:  0.010386228561401367
mini_batch_src_global generation:  0.016209840774536133
r_  generation:  0.1904921531677246
local_output_nid generation:  0.012269735336303711
local_in_edges_tensor generation:  0.009268999099731445
mini_batch_src_global generation:  0.027797222137451172
r_  generation:  0.20873641967773438
----------------------check_connections_block total spend ----------------------------- 0.583244800567627
generate_one_block  0.22590231895446777
generate_one_block  0.23100996017456055
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.034322500228881836
gen group dst list time:  0.00695347785949707
time for parepare:  0.020044565200805664
local_output_nid generation:  0.017722606658935547
local_in_edges_tensor generation:  0.0382695198059082
mini_batch_src_global generation:  0.054306983947753906
r_  generation:  0.5259482860565186
local_output_nid generation:  0.026826858520507812
local_in_edges_tensor generation:  0.038080692291259766
mini_batch_src_global generation:  0.0632178783416748
r_  generation:  0.5449752807617188
----------------------check_connections_block total spend ----------------------------- 1.5662024021148682
generate_one_block  0.6804752349853516
generate_one_block  0.6829438209533691
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0188291072845459
gen group dst list time:  0.012936592102050781
time for parepare:  0.018452167510986328
local_output_nid generation:  0.021608829498291016
local_in_edges_tensor generation:  0.036566972732543945
mini_batch_src_global generation:  0.031667232513427734
r_  generation:  0.36895084381103516
local_output_nid generation:  0.03145313262939453
local_in_edges_tensor generation:  0.027298927307128906
mini_batch_src_global generation:  0.03982234001159668
r_  generation:  0.3749206066131592
----------------------check_connections_block total spend ----------------------------- 1.1213862895965576
generate_one_block  0.44725608825683594
generate_one_block  0.4503192901611328
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16021156311035156  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.687588691711426
block generation total time  2.2609944343566895
average batch blocks generation time:  1.1304972171783447
block dataloader generation time/epoch 6.832543019590707
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1146693229675293  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.303673267364502  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11557388305664062  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3066964149475098  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08845090866088867 |0.014932632446289062 |0.003995299339294434 |0.0005047321319580078 |0.003714442253112793 |0.001453399658203125 |
----------------------------------------------------------pseudo_mini_loss sum 1.1418423652648926
Total (block generation + training)time/epoch 7.1761797296589815
Training time/epoch 0.3373255729675293
Training time without block to device /epoch 0.30746030807495117
Training time without total dataloading part /epoch 0.017882347106933594
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 53.55it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.88it/s]100%|██████████| 4/4 [00:00<00:00, 15.16it/s]100%|██████████| 4/4 [00:00<00:00, 15.11it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.65it/s]100%|██████████| 4/4 [00:00<00:00, 17.69it/s]100%|██████████| 4/4 [00:00<00:00, 17.67it/s]
Run 00 | Epoch 00038 | Loss 1.1418 | Train 0.4110 | Val 0.5045 | Test 0.5144
Number of nodes during this epoch:  333694
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.15887117385864258  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.017772912979125977
range selection method range initialization spend 0.012103796005249023
time for parepare:  0.016557931900024414
local_output_nid generation:  0.010582208633422852
local_in_edges_tensor generation:  0.008721113204956055
mini_batch_src_global generation:  0.018424272537231445
r_  generation:  0.19323229789733887
local_output_nid generation:  0.011723518371582031
local_in_edges_tensor generation:  0.006155252456665039
mini_batch_src_global generation:  0.02058243751525879
r_  generation:  0.20234298706054688
----------------------check_connections_block total spend ----------------------------- 0.56703782081604
generate_one_block  0.22486519813537598
generate_one_block  0.22675490379333496
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03571748733520508
gen group dst list time:  0.006993532180786133
time for parepare:  0.01967453956604004
local_output_nid generation:  0.017744064331054688
local_in_edges_tensor generation:  0.032166481018066406
mini_batch_src_global generation:  0.053676605224609375
r_  generation:  0.5278432369232178
local_output_nid generation:  0.028028249740600586
local_in_edges_tensor generation:  0.028562068939208984
mini_batch_src_global generation:  0.06302976608276367
r_  generation:  0.5395348072052002
----------------------check_connections_block total spend ----------------------------- 1.5454914569854736
generate_one_block  0.6763904094696045
generate_one_block  0.6875293254852295
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01786494255065918
gen group dst list time:  0.012291908264160156
time for parepare:  0.018255949020385742
local_output_nid generation:  0.021741390228271484
local_in_edges_tensor generation:  0.02826666831970215
mini_batch_src_global generation:  0.03174471855163574
r_  generation:  0.367840051651001
local_output_nid generation:  0.03129768371582031
local_in_edges_tensor generation:  0.0273287296295166
mini_batch_src_global generation:  0.03966975212097168
r_  generation:  0.3790280818939209
----------------------check_connections_block total spend ----------------------------- 1.115609884262085
generate_one_block  0.4438474178314209
generate_one_block  0.44217729568481445
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.15887117385864258  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.6611013412475586
block generation total time  2.2499444484710693
average batch blocks generation time:  1.1249722242355347
block dataloader generation time/epoch 6.825640781720479
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11472082138061523  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3035526275634766  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11472177505493164  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3079848289489746  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08302855491638184 |0.014194250106811523 |0.0037250518798828125 |0.0004917383193969727 |0.0036617517471313477 |0.0017330646514892578 |
----------------------------------------------------------pseudo_mini_loss sum 1.131481647491455
Total (block generation + training)time/epoch 7.168424773216247
Training time/epoch 0.317974328994751
Training time without block to device /epoch 0.28958582878112793
Training time without total dataloading part /epoch 0.017490148544311523
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 64.25it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.73it/s]100%|██████████| 4/4 [00:00<00:00, 15.17it/s]100%|██████████| 4/4 [00:00<00:00, 15.09it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.92it/s]100%|██████████| 4/4 [00:00<00:00, 17.44it/s]100%|██████████| 4/4 [00:00<00:00, 17.34it/s]
Run 00 | Epoch 00039 | Loss 1.1315 | Train 0.4102 | Val 0.5040 | Test 0.5134
Number of nodes during this epoch:  333666
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16019725799560547  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022878408432006836
range selection method range initialization spend 0.013256549835205078
time for parepare:  0.01798248291015625
local_output_nid generation:  0.010731697082519531
local_in_edges_tensor generation:  0.014667034149169922
mini_batch_src_global generation:  0.016399145126342773
r_  generation:  0.19170093536376953
local_output_nid generation:  0.011750459671020508
local_in_edges_tensor generation:  0.008043766021728516
mini_batch_src_global generation:  0.022060394287109375
r_  generation:  0.20650124549865723
----------------------check_connections_block total spend ----------------------------- 0.5818042755126953
generate_one_block  0.22771048545837402
generate_one_block  0.23178863525390625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03683733940124512
gen group dst list time:  0.0070455074310302734
time for parepare:  0.020368576049804688
local_output_nid generation:  0.01796889305114746
local_in_edges_tensor generation:  0.037798404693603516
mini_batch_src_global generation:  0.05360531806945801
r_  generation:  0.5310418605804443
local_output_nid generation:  0.026920080184936523
local_in_edges_tensor generation:  0.03940725326538086
mini_batch_src_global generation:  0.06412458419799805
r_  generation:  0.5535874366760254
----------------------check_connections_block total spend ----------------------------- 1.5797414779663086
generate_one_block  0.721092939376831
generate_one_block  0.7082545757293701
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025119543075561523
gen group dst list time:  0.012329816818237305
time for parepare:  0.018636465072631836
local_output_nid generation:  0.022386550903320312
local_in_edges_tensor generation:  0.028942346572875977
mini_batch_src_global generation:  0.03209257125854492
r_  generation:  0.3850128650665283
local_output_nid generation:  0.03221416473388672
local_in_edges_tensor generation:  0.0281374454498291
mini_batch_src_global generation:  0.040540456771850586
r_  generation:  0.3829934597015381
----------------------check_connections_block total spend ----------------------------- 1.1468024253845215
generate_one_block  0.4599900245666504
generate_one_block  0.4575378894805908
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16019725799560547  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.72654390335083
block generation total time  2.3468754291534424
average batch blocks generation time:  1.1734377145767212
block dataloader generation time/epoch 6.826167183537637
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1146855354309082  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3082633018493652  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11475896835327148  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3039822578430176  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08714485168457031 |0.014685511589050293 |0.004161715507507324 |0.0005123615264892578 |0.004456520080566406 |0.0014185905456542969 |
----------------------------------------------------------pseudo_mini_loss sum 1.128204107284546
Total (block generation + training)time/epoch 7.168931676495459
Training time/epoch 0.3420281410217285
Training time without block to device /epoch 0.31265711784362793
Training time without total dataloading part /epoch 0.019679784774780273
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 48.22it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.57it/s]100%|██████████| 4/4 [00:00<00:00, 14.95it/s]100%|██████████| 4/4 [00:00<00:00, 14.88it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.37it/s]100%|██████████| 4/4 [00:00<00:00, 16.84it/s]100%|██████████| 4/4 [00:00<00:00, 16.90it/s]
Run 00 | Epoch 00040 | Loss 1.1282 | Train 0.4102 | Val 0.5028 | Test 0.5116
Number of nodes during this epoch:  333828
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16025972366333008  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021132707595825195
range selection method range initialization spend 0.01216745376586914
time for parepare:  0.017223596572875977
local_output_nid generation:  0.010802268981933594
local_in_edges_tensor generation:  0.011569023132324219
mini_batch_src_global generation:  0.01716136932373047
r_  generation:  0.190948486328125
local_output_nid generation:  0.011866331100463867
local_in_edges_tensor generation:  0.007951021194458008
mini_batch_src_global generation:  0.021228551864624023
r_  generation:  0.2048954963684082
----------------------check_connections_block total spend ----------------------------- 0.5729148387908936
generate_one_block  0.22980427742004395
generate_one_block  0.2318260669708252
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04320645332336426
gen group dst list time:  0.0071184635162353516
time for parepare:  0.01990985870361328
local_output_nid generation:  0.018572092056274414
local_in_edges_tensor generation:  0.04171252250671387
mini_batch_src_global generation:  0.05509233474731445
r_  generation:  0.5369510650634766
local_output_nid generation:  0.02767205238342285
local_in_edges_tensor generation:  0.04101729393005371
mini_batch_src_global generation:  0.0632631778717041
r_  generation:  0.5433328151702881
----------------------check_connections_block total spend ----------------------------- 1.5845308303833008
generate_one_block  0.6893446445465088
generate_one_block  0.7043118476867676
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02267909049987793
gen group dst list time:  0.012374401092529297
time for parepare:  0.01852107048034668
local_output_nid generation:  0.02279043197631836
local_in_edges_tensor generation:  0.02967667579650879
mini_batch_src_global generation:  0.03188800811767578
r_  generation:  0.3751816749572754
local_output_nid generation:  0.032463788986206055
local_in_edges_tensor generation:  0.027863264083862305
mini_batch_src_global generation:  0.039867401123046875
r_  generation:  0.38065648078918457
----------------------check_connections_block total spend ----------------------------- 1.1335563659667969
generate_one_block  0.45177698135375977
generate_one_block  0.4590740203857422
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16025972366333008  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.7180871963500977
block generation total time  2.3045074939727783
average batch blocks generation time:  1.1522537469863892
block dataloader generation time/epoch 6.82578182965517
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11474180221557617  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3085761070251465  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11468267440795898  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3025174140930176  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08631324768066406 |0.014620304107666016 |0.00400996208190918 |0.0005145072937011719 |0.004194140434265137 |0.0013573169708251953 |
----------------------------------------------------------pseudo_mini_loss sum 1.1247671842575073
Total (block generation + training)time/epoch 7.168321914970875
Training time/epoch 0.33542418479919434
Training time without block to device /epoch 0.3061835765838623
Training time without total dataloading part /epoch 0.018794536590576172
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 58.25it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.20it/s]100%|██████████| 4/4 [00:00<00:00, 15.28it/s]100%|██████████| 4/4 [00:00<00:00, 15.25it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.04it/s]100%|██████████| 4/4 [00:00<00:00, 17.56it/s]100%|██████████| 4/4 [00:00<00:00, 17.46it/s]
Run 00 | Epoch 00041 | Loss 1.1248 | Train 0.4099 | Val 0.5016 | Test 0.5086
Number of nodes during this epoch:  333806
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1602039337158203  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0186312198638916
range selection method range initialization spend 0.01179957389831543
time for parepare:  0.016977310180664062
local_output_nid generation:  0.010660648345947266
local_in_edges_tensor generation:  0.009231805801391602
mini_batch_src_global generation:  0.016052961349487305
r_  generation:  0.1909332275390625
local_output_nid generation:  0.011602640151977539
local_in_edges_tensor generation:  0.0069119930267333984
mini_batch_src_global generation:  0.021352529525756836
r_  generation:  0.208404541015625
----------------------check_connections_block total spend ----------------------------- 0.5715265274047852
generate_one_block  0.22695016860961914
generate_one_block  0.2344651222229004
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030138254165649414
gen group dst list time:  0.006927967071533203
time for parepare:  0.019973039627075195
local_output_nid generation:  0.017541885375976562
local_in_edges_tensor generation:  0.031185150146484375
mini_batch_src_global generation:  0.052059173583984375
r_  generation:  0.5328724384307861
local_output_nid generation:  0.026377439498901367
local_in_edges_tensor generation:  0.029445886611938477
mini_batch_src_global generation:  0.06336617469787598
r_  generation:  0.5554263591766357
----------------------check_connections_block total spend ----------------------------- 1.5643272399902344
generate_one_block  0.6931295394897461
generate_one_block  0.7078931331634521
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02066659927368164
gen group dst list time:  0.012379646301269531
time for parepare:  0.01882195472717285
local_output_nid generation:  0.023105621337890625
local_in_edges_tensor generation:  0.03513073921203613
mini_batch_src_global generation:  0.036437273025512695
r_  generation:  0.38335657119750977
local_output_nid generation:  0.03682112693786621
local_in_edges_tensor generation:  0.03237724304199219
mini_batch_src_global generation:  0.040514469146728516
r_  generation:  0.3842959403991699
----------------------check_connections_block total spend ----------------------------- 1.1648814678192139
generate_one_block  0.45591139793395996
generate_one_block  0.4518725872039795
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1602039337158203  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.7292087078094482
block generation total time  2.3088066577911377
average batch blocks generation time:  1.1544033288955688
block dataloader generation time/epoch 6.824540983546864
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11466836929321289  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3037109375  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11478090286254883  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3076658248901367  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09450554847717285 |0.022476911544799805 |0.003878355026245117 |0.0004951953887939453 |0.003878951072692871 |0.0018169879913330078 |
----------------------------------------------------------pseudo_mini_loss sum 1.1158220767974854
Total (block generation + training)time/epoch 7.167645844546231
Training time/epoch 0.36103367805480957
Training time without block to device /epoch 0.31607985496520996
Training time without total dataloading part /epoch 0.018321990966796875
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 55.54it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.21it/s]100%|██████████| 4/4 [00:00<00:00, 15.30it/s]100%|██████████| 4/4 [00:00<00:00, 15.27it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.43it/s]100%|██████████| 4/4 [00:00<00:00, 17.50it/s]100%|██████████| 4/4 [00:00<00:00, 17.47it/s]
Run 00 | Epoch 00042 | Loss 1.1158 | Train 0.4082 | Val 0.4970 | Test 0.5039
Number of nodes during this epoch:  333792
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16037511825561523  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022425413131713867
range selection method range initialization spend 0.011939764022827148
time for parepare:  0.016860485076904297
local_output_nid generation:  0.011044502258300781
local_in_edges_tensor generation:  0.010187387466430664
mini_batch_src_global generation:  0.015942096710205078
r_  generation:  0.19018054008483887
local_output_nid generation:  0.011868000030517578
local_in_edges_tensor generation:  0.007258415222167969
mini_batch_src_global generation:  0.020572423934936523
r_  generation:  0.20608162879943848
----------------------check_connections_block total spend ----------------------------- 0.5700902938842773
generate_one_block  0.2302076816558838
generate_one_block  0.23118972778320312
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03592395782470703
gen group dst list time:  0.006790876388549805
time for parepare:  0.020134925842285156
local_output_nid generation:  0.01854109764099121
local_in_edges_tensor generation:  0.031375885009765625
mini_batch_src_global generation:  0.051690101623535156
r_  generation:  0.5317561626434326
local_output_nid generation:  0.029587745666503906
local_in_edges_tensor generation:  0.03728342056274414
mini_batch_src_global generation:  0.06519913673400879
r_  generation:  0.5617520809173584
----------------------check_connections_block total spend ----------------------------- 1.586113691329956
generate_one_block  0.6963992118835449
generate_one_block  0.7033872604370117
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01796126365661621
gen group dst list time:  0.012289047241210938
time for parepare:  0.018526077270507812
local_output_nid generation:  0.022565841674804688
local_in_edges_tensor generation:  0.028662681579589844
mini_batch_src_global generation:  0.031310081481933594
r_  generation:  0.37380385398864746
local_output_nid generation:  0.03192901611328125
local_in_edges_tensor generation:  0.027424335479736328
mini_batch_src_global generation:  0.040015220642089844
r_  generation:  0.38275146484375
----------------------check_connections_block total spend ----------------------------- 1.1287214756011963
generate_one_block  0.45252370834350586
generate_one_block  0.4532291889190674
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16037511825561523  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.7148351669311523
block generation total time  2.30553936958313
average batch blocks generation time:  1.152769684791565
block dataloader generation time/epoch 6.822886866681716
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11470651626586914  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.303365707397461  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11472654342651367  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3035292625427246  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08643472194671631 |0.014446496963500977 |0.0039098262786865234 |0.0005052089691162109 |0.003714919090270996 |0.002777576446533203 |
----------------------------------------------------------pseudo_mini_loss sum 1.117222785949707
Total (block generation + training)time/epoch 7.165872917455785
Training time/epoch 0.3389735221862793
Training time without block to device /epoch 0.31008052825927734
Training time without total dataloading part /epoch 0.019037485122680664
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 51.96it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.77it/s]100%|██████████| 4/4 [00:00<00:00, 16.25it/s]100%|██████████| 4/4 [00:00<00:00, 16.45it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.61it/s]100%|██████████| 4/4 [00:00<00:00, 17.68it/s]100%|██████████| 4/4 [00:00<00:00, 17.65it/s]
Run 00 | Epoch 00043 | Loss 1.1172 | Train 0.4058 | Val 0.4904 | Test 0.4968
Number of nodes during this epoch:  333795
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1602306365966797  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024773836135864258
range selection method range initialization spend 0.012084722518920898
time for parepare:  0.017276287078857422
local_output_nid generation:  0.01280522346496582
local_in_edges_tensor generation:  0.010504484176635742
mini_batch_src_global generation:  0.01721048355102539
r_  generation:  0.19728732109069824
local_output_nid generation:  0.01240086555480957
local_in_edges_tensor generation:  0.008927106857299805
mini_batch_src_global generation:  0.020622968673706055
r_  generation:  0.2176055908203125
----------------------check_connections_block total spend ----------------------------- 0.601759672164917
generate_one_block  0.23411107063293457
generate_one_block  0.2305920124053955
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03804612159729004
gen group dst list time:  0.0069122314453125
time for parepare:  0.020296573638916016
local_output_nid generation:  0.018442153930664062
local_in_edges_tensor generation:  0.04721379280090332
mini_batch_src_global generation:  0.054712772369384766
r_  generation:  0.536280632019043
local_output_nid generation:  0.02796459197998047
local_in_edges_tensor generation:  0.03932642936706543
mini_batch_src_global generation:  0.0646357536315918
r_  generation:  0.5480060577392578
----------------------check_connections_block total spend ----------------------------- 1.5953609943389893
generate_one_block  0.6864991188049316
generate_one_block  0.6938707828521729
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.024457693099975586
gen group dst list time:  0.01237034797668457
time for parepare:  0.018648862838745117
local_output_nid generation:  0.022534608840942383
local_in_edges_tensor generation:  0.03149580955505371
mini_batch_src_global generation:  0.03141474723815918
r_  generation:  0.37163233757019043
local_output_nid generation:  0.032607316970825195
local_in_edges_tensor generation:  0.028561115264892578
mini_batch_src_global generation:  0.04048514366149902
r_  generation:  0.381101131439209
----------------------check_connections_block total spend ----------------------------- 1.1316545009613037
generate_one_block  0.4570636749267578
generate_one_block  0.45398592948913574
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1602306365966797  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.727015495300293
block generation total time  2.291419506072998
average batch blocks generation time:  1.145709753036499
block dataloader generation time/epoch 6.8224906035832
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11475610733032227  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.30961275100708  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11469316482543945  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3029608726501465  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08680522441864014 |0.0149458646774292 |0.0041120052337646484 |0.0005154609680175781 |0.0038177967071533203 |0.001416921615600586 |
----------------------------------------------------------pseudo_mini_loss sum 1.1138277053833008
Total (block generation + training)time/epoch 7.165252787726266
Training time/epoch 0.33499741554260254
Training time without block to device /epoch 0.30510568618774414
Training time without total dataloading part /epoch 0.01830744743347168
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 59.36it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.78it/s]100%|██████████| 4/4 [00:00<00:00, 15.18it/s]100%|██████████| 4/4 [00:00<00:00, 15.11it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.58it/s]100%|██████████| 4/4 [00:00<00:00, 17.50it/s]100%|██████████| 4/4 [00:00<00:00, 17.49it/s]
Run 00 | Epoch 00044 | Loss 1.1138 | Train 0.4022 | Val 0.4807 | Test 0.4864
Number of nodes during this epoch:  333823
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16019487380981445  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01883721351623535
range selection method range initialization spend 0.011744260787963867
time for parepare:  0.01753401756286621
local_output_nid generation:  0.0113067626953125
local_in_edges_tensor generation:  0.00895237922668457
mini_batch_src_global generation:  0.016397953033447266
r_  generation:  0.19109773635864258
local_output_nid generation:  0.011704683303833008
local_in_edges_tensor generation:  0.006192207336425781
mini_batch_src_global generation:  0.02096080780029297
r_  generation:  0.20499825477600098
----------------------check_connections_block total spend ----------------------------- 0.5685200691223145
generate_one_block  0.23256564140319824
generate_one_block  0.23131370544433594
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.039723873138427734
gen group dst list time:  0.00925135612487793
time for parepare:  0.0289762020111084
local_output_nid generation:  0.02020573616027832
local_in_edges_tensor generation:  0.05071759223937988
mini_batch_src_global generation:  0.059453725814819336
r_  generation:  0.5427775382995605
local_output_nid generation:  0.0343625545501709
local_in_edges_tensor generation:  0.04299163818359375
mini_batch_src_global generation:  0.06702566146850586
r_  generation:  0.5790839195251465
----------------------check_connections_block total spend ----------------------------- 1.6804776191711426
generate_one_block  0.7051348686218262
generate_one_block  0.7008025646209717
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028699398040771484
gen group dst list time:  0.01352381706237793
time for parepare:  0.01870441436767578
local_output_nid generation:  0.021882057189941406
local_in_edges_tensor generation:  0.0407710075378418
mini_batch_src_global generation:  0.033513784408569336
r_  generation:  0.38271355628967285
local_output_nid generation:  0.031842947006225586
local_in_edges_tensor generation:  0.02745342254638672
mini_batch_src_global generation:  0.0399785041809082
r_  generation:  0.3891451358795166
----------------------check_connections_block total spend ----------------------------- 1.160496711730957
generate_one_block  0.456650972366333
generate_one_block  0.46106410026550293
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16019487380981445  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.8409743309020996
block generation total time  2.323652505874634
average batch blocks generation time:  1.161826252937317
block dataloader generation time/epoch 6.825392113791572
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11470174789428711  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.30279541015625  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1147456169128418  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3086490631103516  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08781242370605469 |0.018870234489440918 |0.004075169563293457 |0.0005145072937011719 |0.003867506980895996 |0.0020885467529296875 |
----------------------------------------------------------pseudo_mini_loss sum 1.10285484790802
Total (block generation + training)time/epoch 7.168088283803728
Training time/epoch 0.340228796005249
Training time without block to device /epoch 0.3024883270263672
Training time without total dataloading part /epoch 0.019002914428710938
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 46.97it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.17it/s]100%|██████████| 4/4 [00:00<00:00, 15.21it/s]100%|██████████| 4/4 [00:00<00:00, 15.18it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.39it/s]100%|██████████| 4/4 [00:00<00:00, 17.53it/s]100%|██████████| 4/4 [00:00<00:00, 17.48it/s]
Run 00 | Epoch 00045 | Loss 1.1029 | Train 0.3975 | Val 0.4695 | Test 0.4745
Number of nodes during this epoch:  333790
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16013526916503906  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01959228515625
range selection method range initialization spend 0.012200593948364258
time for parepare:  0.016891002655029297
local_output_nid generation:  0.011380195617675781
local_in_edges_tensor generation:  0.009500980377197266
mini_batch_src_global generation:  0.016315460205078125
r_  generation:  0.1931147575378418
local_output_nid generation:  0.011934757232666016
local_in_edges_tensor generation:  0.00676417350769043
mini_batch_src_global generation:  0.022449254989624023
r_  generation:  0.21392059326171875
----------------------check_connections_block total spend ----------------------------- 0.5842306613922119
generate_one_block  0.24082088470458984
generate_one_block  0.25130605697631836
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.042005062103271484
gen group dst list time:  0.007223606109619141
time for parepare:  0.02294635772705078
local_output_nid generation:  0.022459983825683594
local_in_edges_tensor generation:  0.04439949989318848
mini_batch_src_global generation:  0.06845831871032715
r_  generation:  0.5366332530975342
local_output_nid generation:  0.028953075408935547
local_in_edges_tensor generation:  0.03809356689453125
mini_batch_src_global generation:  0.0651392936706543
r_  generation:  0.543511152267456
----------------------check_connections_block total spend ----------------------------- 1.606438398361206
generate_one_block  0.6838538646697998
generate_one_block  0.701209306716919
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.020739316940307617
gen group dst list time:  0.012324810028076172
time for parepare:  0.019045591354370117
local_output_nid generation:  0.023403406143188477
local_in_edges_tensor generation:  0.03081035614013672
mini_batch_src_global generation:  0.03125309944152832
r_  generation:  0.3740270137786865
local_output_nid generation:  0.033202409744262695
local_in_edges_tensor generation:  0.029549121856689453
mini_batch_src_global generation:  0.04134941101074219
r_  generation:  0.3913707733154297
----------------------check_connections_block total spend ----------------------------- 1.1510086059570312
generate_one_block  0.47060465812683105
generate_one_block  0.46103334426879883
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16013526916503906  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.7574470043182373
block generation total time  2.3167011737823486
average batch blocks generation time:  1.1583505868911743
block dataloader generation time/epoch 6.827246556410918
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11469221115112305  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.303110122680664  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11476564407348633  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3097867965698242  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09094476699829102 |0.01491689682006836 |0.004164934158325195 |0.0005209445953369141 |0.04025542736053467 |0.002913236618041992 |
----------------------------------------------------------pseudo_mini_loss sum 1.09987473487854
Total (block generation + training)time/epoch 7.169895474975173
Training time/epoch 0.3407924175262451
Training time without block to device /epoch 0.3109586238861084
Training time without total dataloading part /epoch 0.09279584884643555
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 57.89it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.43it/s]100%|██████████| 4/4 [00:00<00:00, 15.73it/s]100%|██████████| 4/4 [00:00<00:00, 15.66it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.62it/s]100%|██████████| 4/4 [00:00<00:00, 18.01it/s]100%|██████████| 4/4 [00:00<00:00, 17.93it/s]
Run 00 | Epoch 00046 | Loss 1.0999 | Train 0.3918 | Val 0.4582 | Test 0.4608
Number of nodes during this epoch:  333868
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16112565994262695  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019773244857788086
range selection method range initialization spend 0.012032032012939453
time for parepare:  0.01695537567138672
local_output_nid generation:  0.012752056121826172
local_in_edges_tensor generation:  0.01578354835510254
mini_batch_src_global generation:  0.018638134002685547
r_  generation:  0.20458149909973145
local_output_nid generation:  0.013737201690673828
local_in_edges_tensor generation:  0.010802984237670898
mini_batch_src_global generation:  0.031801462173461914
r_  generation:  0.22381091117858887
----------------------check_connections_block total spend ----------------------------- 0.6353883743286133
generate_one_block  0.2389063835144043
generate_one_block  0.23778963088989258
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03896737098693848
gen group dst list time:  0.007752656936645508
time for parepare:  0.02054429054260254
local_output_nid generation:  0.020952463150024414
local_in_edges_tensor generation:  0.0326685905456543
mini_batch_src_global generation:  0.05156064033508301
r_  generation:  0.5599002838134766
local_output_nid generation:  0.030952930450439453
local_in_edges_tensor generation:  0.045166969299316406
mini_batch_src_global generation:  0.08020663261413574
r_  generation:  0.547508955001831
----------------------check_connections_block total spend ----------------------------- 1.6525402069091797
generate_one_block  0.6975481510162354
generate_one_block  0.6945509910583496
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.022687673568725586
gen group dst list time:  0.012340545654296875
time for parepare:  0.018895387649536133
local_output_nid generation:  0.022513151168823242
local_in_edges_tensor generation:  0.036360979080200195
mini_batch_src_global generation:  0.031389713287353516
r_  generation:  0.3728160858154297
local_output_nid generation:  0.03152942657470703
local_in_edges_tensor generation:  0.02772808074951172
mini_batch_src_global generation:  0.040335893630981445
r_  generation:  0.38327693939208984
----------------------check_connections_block total spend ----------------------------- 1.1383535861968994
generate_one_block  0.47042250633239746
generate_one_block  0.46262073516845703
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16112565994262695  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.790893793106079
block generation total time  2.3251423835754395
average batch blocks generation time:  1.1625711917877197
block dataloader generation time/epoch 6.830657889968471
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11480188369750977  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3094301223754883  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11463403701782227  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.2989773750305176  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07248234748840332 |0.01832115650177002 |0.01653265953063965 |0.0005159378051757812 |0.0036973953247070312 |0.002080678939819336 |
----------------------------------------------------------pseudo_mini_loss sum 1.0967631340026855
Total (block generation + training)time/epoch 7.173185938283017
Training time/epoch 0.3379058837890625
Training time without block to device /epoch 0.30126357078552246
Training time without total dataloading part /epoch 0.04357266426086426
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 50.27it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.91it/s]100%|██████████| 4/4 [00:00<00:00, 17.79it/s]100%|██████████| 4/4 [00:00<00:00, 17.46it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.68it/s]100%|██████████| 4/4 [00:00<00:00, 20.02it/s]
Run 00 | Epoch 00047 | Loss 1.0968 | Train 0.3869 | Val 0.4472 | Test 0.4484
Number of nodes during this epoch:  333798
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1583566665649414  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02985525131225586
range selection method range initialization spend 0.012595176696777344
time for parepare:  0.017203330993652344
local_output_nid generation:  0.010965824127197266
local_in_edges_tensor generation:  0.015221595764160156
mini_batch_src_global generation:  0.017081737518310547
r_  generation:  0.19415044784545898
local_output_nid generation:  0.011785507202148438
local_in_edges_tensor generation:  0.006994724273681641
mini_batch_src_global generation:  0.020396947860717773
r_  generation:  0.24472379684448242
----------------------check_connections_block total spend ----------------------------- 0.6229846477508545
generate_one_block  0.2541487216949463
generate_one_block  0.23219084739685059
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.035929203033447266
gen group dst list time:  0.0068361759185791016
time for parepare:  0.020003080368041992
local_output_nid generation:  0.018033504486083984
local_in_edges_tensor generation:  0.03442525863647461
mini_batch_src_global generation:  0.05407977104187012
r_  generation:  0.531733512878418
local_output_nid generation:  0.027404069900512695
local_in_edges_tensor generation:  0.03302288055419922
mini_batch_src_global generation:  0.06563019752502441
r_  generation:  0.548346996307373
----------------------check_connections_block total spend ----------------------------- 1.5702629089355469
generate_one_block  0.6867725849151611
generate_one_block  0.685915470123291
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.017698287963867188
gen group dst list time:  0.012337446212768555
time for parepare:  0.01859736442565918
local_output_nid generation:  0.023264646530151367
local_in_edges_tensor generation:  0.02870345115661621
mini_batch_src_global generation:  0.031238079071044922
r_  generation:  0.3713114261627197
local_output_nid generation:  0.031781673431396484
local_in_edges_tensor generation:  0.02713799476623535
mini_batch_src_global generation:  0.03993511199951172
r_  generation:  0.38083815574645996
----------------------check_connections_block total spend ----------------------------- 1.1245734691619873
generate_one_block  0.45322728157043457
generate_one_block  0.4646027088165283
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1583566665649414  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.694836378097534
block generation total time  2.290518045425415
average batch blocks generation time:  1.1452590227127075
block dataloader generation time/epoch 6.831121065677741
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11473512649536133  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3016514778137207  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11469411849975586  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3081793785095215  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08582425117492676 |0.013816475868225098 |0.004066944122314453 |0.000510096549987793 |0.0037218332290649414 |0.00287628173828125 |
----------------------------------------------------------pseudo_mini_loss sum 1.092355728149414
Total (block generation + training)time/epoch 7.173462299200205
Training time/epoch 0.33509063720703125
Training time without block to device /epoch 0.30745768547058105
Training time without total dataloading part /epoch 0.019474029541015625
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 50.98it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.53it/s]100%|██████████| 4/4 [00:00<00:00, 15.60it/s]100%|██████████| 4/4 [00:00<00:00, 15.57it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.27it/s]100%|██████████| 4/4 [00:00<00:00, 17.89it/s]100%|██████████| 4/4 [00:00<00:00, 17.93it/s]
Run 00 | Epoch 00048 | Loss 1.0924 | Train 0.3827 | Val 0.4382 | Test 0.4373
Number of nodes during this epoch:  333800
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16013002395629883  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03226757049560547
range selection method range initialization spend 0.015967130661010742
time for parepare:  0.022691965103149414
local_output_nid generation:  0.012337923049926758
local_in_edges_tensor generation:  0.013402938842773438
mini_batch_src_global generation:  0.01876235008239746
r_  generation:  0.199876070022583
local_output_nid generation:  0.01694464683532715
local_in_edges_tensor generation:  0.008412361145019531
mini_batch_src_global generation:  0.025922775268554688
r_  generation:  0.21978449821472168
----------------------check_connections_block total spend ----------------------------- 0.6288328170776367
generate_one_block  0.23037171363830566
generate_one_block  0.23284387588500977
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03621077537536621
gen group dst list time:  0.006825447082519531
time for parepare:  0.021917104721069336
local_output_nid generation:  0.022258281707763672
local_in_edges_tensor generation:  0.04864501953125
mini_batch_src_global generation:  0.0627899169921875
r_  generation:  0.5357053279876709
local_output_nid generation:  0.03405880928039551
local_in_edges_tensor generation:  0.042934417724609375
mini_batch_src_global generation:  0.06322860717773438
r_  generation:  0.5498886108398438
----------------------check_connections_block total spend ----------------------------- 1.6208951473236084
generate_one_block  0.7067184448242188
generate_one_block  0.7048656940460205
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.022396326065063477
gen group dst list time:  0.013489484786987305
time for parepare:  0.018860340118408203
local_output_nid generation:  0.026819467544555664
local_in_edges_tensor generation:  0.036544084548950195
mini_batch_src_global generation:  0.03128957748413086
r_  generation:  0.38861632347106934
local_output_nid generation:  0.037941694259643555
local_in_edges_tensor generation:  0.03252053260803223
mini_batch_src_global generation:  0.040377140045166016
r_  generation:  0.38437747955322266
----------------------check_connections_block total spend ----------------------------- 1.185126781463623
generate_one_block  0.45258569717407227
generate_one_block  0.4583418369293213
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16013002395629883  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.8060219287872314
block generation total time  2.322511672973633
average batch blocks generation time:  1.1612558364868164
block dataloader generation time/epoch 6.835256540775299
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11473226547241211  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.303555965423584  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11472368240356445  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.308363914489746  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.10213816165924072 |0.024841904640197754 |0.0038448572158813477 |0.0004980564117431641 |0.003599405288696289 |0.0027894973754882812 |
----------------------------------------------------------pseudo_mini_loss sum 1.085594892501831
Total (block generation + training)time/epoch 7.178582918643952
Training time/epoch 0.3815765380859375
Training time without block to device /epoch 0.331892728805542
Training time without total dataloading part /epoch 0.018674135208129883
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 58.58it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.78it/s]100%|██████████| 4/4 [00:00<00:00, 15.32it/s]100%|██████████| 4/4 [00:00<00:00, 15.22it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.39it/s]100%|██████████| 4/4 [00:00<00:00, 17.53it/s]100%|██████████| 4/4 [00:00<00:00, 17.49it/s]
Run 00 | Epoch 00049 | Loss 1.0856 | Train 0.3782 | Val 0.4287 | Test 0.4271
Number of nodes during this epoch:  333711
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16014719009399414  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01876664161682129
range selection method range initialization spend 0.013829708099365234
time for parepare:  0.017935991287231445
local_output_nid generation:  0.010883331298828125
local_in_edges_tensor generation:  0.011064291000366211
mini_batch_src_global generation:  0.016781330108642578
r_  generation:  0.19342374801635742
local_output_nid generation:  0.011885643005371094
local_in_edges_tensor generation:  0.006398677825927734
mini_batch_src_global generation:  0.020764589309692383
r_  generation:  0.20540452003479004
----------------------check_connections_block total spend ----------------------------- 0.5748083591461182
generate_one_block  0.23525571823120117
generate_one_block  0.23619508743286133
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03995490074157715
gen group dst list time:  0.006886720657348633
time for parepare:  0.021526336669921875
local_output_nid generation:  0.019683361053466797
local_in_edges_tensor generation:  0.0393216609954834
mini_batch_src_global generation:  0.05562925338745117
r_  generation:  0.5560214519500732
local_output_nid generation:  0.032903194427490234
local_in_edges_tensor generation:  0.0467534065246582
mini_batch_src_global generation:  0.06286334991455078
r_  generation:  0.5601205825805664
----------------------check_connections_block total spend ----------------------------- 1.6350138187408447
generate_one_block  0.6971845626831055
generate_one_block  0.7185971736907959
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03079366683959961
gen group dst list time:  0.014950037002563477
time for parepare:  0.0200655460357666
local_output_nid generation:  0.02680206298828125
local_in_edges_tensor generation:  0.04421854019165039
mini_batch_src_global generation:  0.03222465515136719
r_  generation:  0.3732151985168457
local_output_nid generation:  0.034410953521728516
local_in_edges_tensor generation:  0.032677650451660156
mini_batch_src_global generation:  0.03984951972961426
r_  generation:  0.3771698474884033
----------------------check_connections_block total spend ----------------------------- 1.1577911376953125
generate_one_block  0.4529409408569336
generate_one_block  0.4477050304412842
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16014719009399414  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.7928049564361572
block generation total time  2.316427707672119
average batch blocks generation time:  1.1582138538360596
block dataloader generation time/epoch 6.8369119516233114
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1147608757019043  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3091468811035156  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11468267440795898  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3035564422607422  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08867526054382324 |0.020119309425354004 |0.0040978193283081055 |0.0005172491073608398 |0.0040853023529052734 |0.0013508796691894531 |
----------------------------------------------------------pseudo_mini_loss sum 1.0878853797912598
Total (block generation + training)time/epoch 7.180334934374181
Training time/epoch 0.34712696075439453
Training time without block to device /epoch 0.3068883419036865
Training time without total dataloading part /epoch 0.01875162124633789
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 57.91it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.18it/s]100%|██████████| 4/4 [00:00<00:00, 15.35it/s]100%|██████████| 4/4 [00:00<00:00, 15.31it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.22it/s]100%|██████████| 4/4 [00:00<00:00, 17.47it/s]100%|██████████| 4/4 [00:00<00:00, 17.41it/s]
Run 00 | Epoch 00050 | Loss 1.0879 | Train 0.3752 | Val 0.4234 | Test 0.4210
Number of nodes during this epoch:  333816
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16015195846557617  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020607948303222656
range selection method range initialization spend 0.011999130249023438
time for parepare:  0.01640462875366211
local_output_nid generation:  0.011013031005859375
local_in_edges_tensor generation:  0.009227991104125977
mini_batch_src_global generation:  0.016224145889282227
r_  generation:  0.19038987159729004
local_output_nid generation:  0.012351274490356445
local_in_edges_tensor generation:  0.006444692611694336
mini_batch_src_global generation:  0.020394325256347656
r_  generation:  0.20358943939208984
----------------------check_connections_block total spend ----------------------------- 0.5654582977294922
generate_one_block  0.2299480438232422
generate_one_block  0.2282111644744873
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03613758087158203
gen group dst list time:  0.006593942642211914
time for parepare:  0.019833087921142578
local_output_nid generation:  0.017874956130981445
local_in_edges_tensor generation:  0.03482246398925781
mini_batch_src_global generation:  0.053688764572143555
r_  generation:  0.5333647727966309
local_output_nid generation:  0.027370214462280273
local_in_edges_tensor generation:  0.03005671501159668
mini_batch_src_global generation:  0.06212735176086426
r_  generation:  0.5389556884765625
----------------------check_connections_block total spend ----------------------------- 1.557420015335083
generate_one_block  0.6859433650970459
generate_one_block  0.6873214244842529
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.022582054138183594
gen group dst list time:  0.014068126678466797
time for parepare:  0.018779516220092773
local_output_nid generation:  0.022107601165771484
local_in_edges_tensor generation:  0.029308319091796875
mini_batch_src_global generation:  0.031278371810913086
r_  generation:  0.37052059173583984
local_output_nid generation:  0.031059980392456055
local_in_edges_tensor generation:  0.028117895126342773
mini_batch_src_global generation:  0.0394902229309082
r_  generation:  0.3789865970611572
----------------------check_connections_block total spend ----------------------------- 1.1268196105957031
generate_one_block  0.46021556854248047
generate_one_block  0.4627420902252197
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16015195846557617  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.684239625930786
block generation total time  2.296222448348999
average batch blocks generation time:  1.1481112241744995
block dataloader generation time/epoch 6.834470992996579
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11476469039916992  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.309471607208252  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11468648910522461  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3021659851074219  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08956277370452881 |0.023291945457458496 |0.003710150718688965 |0.00048732757568359375 |0.003255605697631836 |0.0016889572143554688 |
----------------------------------------------------------pseudo_mini_loss sum 1.079818606376648
Total (block generation + training)time/epoch 7.178409468559992
Training time/epoch 0.3649911880493164
Training time without block to device /epoch 0.3184072971343994
Training time without total dataloading part /epoch 0.016595125198364258
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 53.23it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.03it/s]100%|██████████| 4/4 [00:00<00:00, 15.32it/s]100%|██████████| 4/4 [00:00<00:00, 15.26it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.18it/s]100%|██████████| 4/4 [00:00<00:00, 17.41it/s]100%|██████████| 4/4 [00:00<00:00, 17.35it/s]
Run 00 | Epoch 00051 | Loss 1.0798 | Train 0.3713 | Val 0.4184 | Test 0.4147
Number of nodes during this epoch:  333719
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.15938854217529297  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01756453514099121
range selection method range initialization spend 0.012062788009643555
time for parepare:  0.017785310745239258
local_output_nid generation:  0.010928630828857422
local_in_edges_tensor generation:  0.009861946105957031
mini_batch_src_global generation:  0.016885757446289062
r_  generation:  0.18976545333862305
local_output_nid generation:  0.012068033218383789
local_in_edges_tensor generation:  0.006464719772338867
mini_batch_src_global generation:  0.02071094512939453
r_  generation:  0.20479893684387207
----------------------check_connections_block total spend ----------------------------- 0.5688726902008057
generate_one_block  0.2263789176940918
generate_one_block  0.23016977310180664
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03722786903381348
gen group dst list time:  0.006688594818115234
time for parepare:  0.019922971725463867
local_output_nid generation:  0.019006967544555664
local_in_edges_tensor generation:  0.03399252891540527
mini_batch_src_global generation:  0.05130720138549805
r_  generation:  0.5313951969146729
local_output_nid generation:  0.028995037078857422
local_in_edges_tensor generation:  0.03579592704772949
mini_batch_src_global generation:  0.06296849250793457
r_  generation:  0.5498058795928955
----------------------check_connections_block total spend ----------------------------- 1.5672321319580078
generate_one_block  0.6814157962799072
generate_one_block  0.6919729709625244
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01910853385925293
gen group dst list time:  0.012377262115478516
time for parepare:  0.018362045288085938
local_output_nid generation:  0.023711681365966797
local_in_edges_tensor generation:  0.028860092163085938
mini_batch_src_global generation:  0.03130197525024414
r_  generation:  0.3719780445098877
local_output_nid generation:  0.03248858451843262
local_in_edges_tensor generation:  0.026894092559814453
mini_batch_src_global generation:  0.040429115295410156
r_  generation:  0.3799006938934326
----------------------check_connections_block total spend ----------------------------- 1.126544713973999
generate_one_block  0.4485800266265869
generate_one_block  0.45396876335144043
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.15938854217529297  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.693776845932007
block generation total time  2.275937557220459
average batch blocks generation time:  1.1379687786102295
block dataloader generation time/epoch 6.8310987783032795
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11555194854736328  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3027400970458984  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1147465705871582  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3080778121948242  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0850902795791626 |0.014969587326049805 |0.003954052925109863 |0.0005016326904296875 |0.00287020206451416 |0.0029015541076660156 |
----------------------------------------------------------pseudo_mini_loss sum 1.073227882385254
Total (block generation + training)time/epoch 7.174665733825329
Training time/epoch 0.32781505584716797
Training time without block to device /epoch 0.29787588119506836
Training time without total dataloading part /epoch 0.017553329467773438
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 65.59it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.79it/s]100%|██████████| 4/4 [00:00<00:00, 15.11it/s]100%|██████████| 4/4 [00:00<00:00, 15.05it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.25it/s]100%|██████████| 4/4 [00:00<00:00, 17.45it/s]100%|██████████| 4/4 [00:00<00:00, 17.40it/s]
Run 00 | Epoch 00052 | Loss 1.0732 | Train 0.3673 | Val 0.4134 | Test 0.4093
Number of nodes during this epoch:  333772
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16022157669067383  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01879119873046875
range selection method range initialization spend 0.011914491653442383
time for parepare:  0.016909360885620117
local_output_nid generation:  0.011130332946777344
local_in_edges_tensor generation:  0.009041786193847656
mini_batch_src_global generation:  0.016229629516601562
r_  generation:  0.19459199905395508
local_output_nid generation:  0.012020349502563477
local_in_edges_tensor generation:  0.006520509719848633
mini_batch_src_global generation:  0.02233719825744629
r_  generation:  0.21131229400634766
----------------------check_connections_block total spend ----------------------------- 0.5796959400177002
generate_one_block  0.23082780838012695
generate_one_block  0.2389678955078125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.039267778396606445
gen group dst list time:  0.006961822509765625
time for parepare:  0.0199129581451416
local_output_nid generation:  0.019100666046142578
local_in_edges_tensor generation:  0.029315948486328125
mini_batch_src_global generation:  0.05329775810241699
r_  generation:  0.5591685771942139
local_output_nid generation:  0.0327913761138916
local_in_edges_tensor generation:  0.0422215461730957
mini_batch_src_global generation:  0.06479263305664062
r_  generation:  0.5457792282104492
----------------------check_connections_block total spend ----------------------------- 1.6057960987091064
generate_one_block  0.6925582885742188
generate_one_block  0.7005438804626465
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025081634521484375
gen group dst list time:  0.01250147819519043
time for parepare:  0.020346403121948242
local_output_nid generation:  0.02321767807006836
local_in_edges_tensor generation:  0.04712677001953125
mini_batch_src_global generation:  0.0333559513092041
r_  generation:  0.38462281227111816
local_output_nid generation:  0.03387165069580078
local_in_edges_tensor generation:  0.030470848083496094
mini_batch_src_global generation:  0.03986024856567383
r_  generation:  0.3841538429260254
----------------------check_connections_block total spend ----------------------------- 1.1724772453308105
generate_one_block  0.47614097595214844
generate_one_block  0.4665358066558838
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16022157669067383  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.778273344039917
block generation total time  2.3357789516448975
average batch blocks generation time:  1.1678894758224487
block dataloader generation time/epoch 6.832326206293973
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11468744277954102  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3025517463684082  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11475229263305664  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3086013793945312  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0888051986694336 |0.02299487590789795 |0.004109978675842285 |0.0004973411560058594 |0.003566265106201172 |0.0012943744659423828 |
----------------------------------------------------------pseudo_mini_loss sum 1.072296380996704
Total (block generation + training)time/epoch 7.176333394917575
Training time/epoch 0.362778902053833
Training time without block to device /epoch 0.3167891502380371
Training time without total dataloading part /epoch 0.017641544342041016
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 49.98it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.04it/s]100%|██████████| 4/4 [00:00<00:00, 15.58it/s]100%|██████████| 4/4 [00:00<00:00, 15.48it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.37it/s]100%|██████████| 4/4 [00:00<00:00, 17.44it/s]100%|██████████| 4/4 [00:00<00:00, 17.41it/s]
Run 00 | Epoch 00053 | Loss 1.0723 | Train 0.3636 | Val 0.4093 | Test 0.4040
Number of nodes during this epoch:  333884
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16018390655517578  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020186662673950195
range selection method range initialization spend 0.011921882629394531
time for parepare:  0.016453027725219727
local_output_nid generation:  0.010899543762207031
local_in_edges_tensor generation:  0.011959075927734375
mini_batch_src_global generation:  0.016745805740356445
r_  generation:  0.1931626796722412
local_output_nid generation:  0.012194395065307617
local_in_edges_tensor generation:  0.007505893707275391
mini_batch_src_global generation:  0.020367860794067383
r_  generation:  0.20467114448547363
----------------------check_connections_block total spend ----------------------------- 0.5738725662231445
generate_one_block  0.22913432121276855
generate_one_block  0.2289748191833496
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0299832820892334
gen group dst list time:  0.006759166717529297
time for parepare:  0.02017974853515625
local_output_nid generation:  0.018630266189575195
local_in_edges_tensor generation:  0.03485870361328125
mini_batch_src_global generation:  0.05366706848144531
r_  generation:  0.5411531925201416
local_output_nid generation:  0.02848362922668457
local_in_edges_tensor generation:  0.03605198860168457
mini_batch_src_global generation:  0.06236004829406738
r_  generation:  0.5449333190917969
----------------------check_connections_block total spend ----------------------------- 1.5752651691436768
generate_one_block  0.6915066242218018
generate_one_block  0.6915998458862305
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.020063400268554688
gen group dst list time:  0.012441635131835938
time for parepare:  0.018997669219970703
local_output_nid generation:  0.023111581802368164
local_in_edges_tensor generation:  0.028382301330566406
mini_batch_src_global generation:  0.03168439865112305
r_  generation:  0.37497925758361816
local_output_nid generation:  0.03217959403991699
local_in_edges_tensor generation:  0.027889490127563477
mini_batch_src_global generation:  0.039797306060791016
r_  generation:  0.3835484981536865
----------------------check_connections_block total spend ----------------------------- 1.134138584136963
generate_one_block  0.455120325088501
generate_one_block  0.45250988006591797
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16018390655517578  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.7094037532806396
block generation total time  2.290736675262451
average batch blocks generation time:  1.1453683376312256
block dataloader generation time/epoch 6.830441978242662
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11473512649536133  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3080086708068848  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1147160530090332  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3079748153686523  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08543932437896729 |0.014263391494750977 |0.003918051719665527 |0.0004979372024536133 |0.003176450729370117 |0.0013391971588134766 |
----------------------------------------------------------pseudo_mini_loss sum 1.068354845046997
Total (block generation + training)time/epoch 7.174286641014946
Training time/epoch 0.3365976810455322
Training time without block to device /epoch 0.3080708980560303
Training time without total dataloading part /epoch 0.016524076461791992
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 62.86it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.81it/s]100%|██████████| 4/4 [00:00<00:00, 15.37it/s]100%|██████████| 4/4 [00:00<00:00, 15.27it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.11it/s]100%|██████████| 4/4 [00:00<00:00, 17.32it/s]100%|██████████| 4/4 [00:00<00:00, 17.26it/s]
Run 00 | Epoch 00054 | Loss 1.0684 | Train 0.3610 | Val 0.4050 | Test 0.3983
Number of nodes during this epoch:  333738
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16017389297485352  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023233890533447266
range selection method range initialization spend 0.011932611465454102
time for parepare:  0.01674342155456543
local_output_nid generation:  0.010976791381835938
local_in_edges_tensor generation:  0.008904457092285156
mini_batch_src_global generation:  0.016077756881713867
r_  generation:  0.1950235366821289
local_output_nid generation:  0.0122222900390625
local_in_edges_tensor generation:  0.014208078384399414
mini_batch_src_global generation:  0.021332740783691406
r_  generation:  0.2206740379333496
----------------------check_connections_block total spend ----------------------------- 0.6011152267456055
generate_one_block  0.23302507400512695
generate_one_block  0.2348465919494629
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0408177375793457
gen group dst list time:  0.006565093994140625
time for parepare:  0.020432472229003906
local_output_nid generation:  0.018813133239746094
local_in_edges_tensor generation:  0.042687416076660156
mini_batch_src_global generation:  0.052278757095336914
r_  generation:  0.5390770435333252
local_output_nid generation:  0.02845168113708496
local_in_edges_tensor generation:  0.0386195182800293
mini_batch_src_global generation:  0.06514763832092285
r_  generation:  0.5497896671295166
----------------------check_connections_block total spend ----------------------------- 1.5906882286071777
generate_one_block  0.6841740608215332
generate_one_block  0.6968863010406494
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02729487419128418
gen group dst list time:  0.012740850448608398
time for parepare:  0.018803119659423828
local_output_nid generation:  0.023807287216186523
local_in_edges_tensor generation:  0.0300290584564209
mini_batch_src_global generation:  0.03203392028808594
r_  generation:  0.37801313400268555
local_output_nid generation:  0.03285384178161621
local_in_edges_tensor generation:  0.0324702262878418
mini_batch_src_global generation:  0.03975343704223633
r_  generation:  0.387037992477417
----------------------check_connections_block total spend ----------------------------- 1.1485824584960938
generate_one_block  0.46181321144104004
generate_one_block  0.4619936943054199
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16017389297485352  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.7392706871032715
block generation total time  2.3048672676086426
average batch blocks generation time:  1.1524336338043213
block dataloader generation time/epoch 6.830681614253832
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11464834213256836  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3021836280822754  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11563682556152344  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3065357208251953  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08330821990966797 |0.017441987991333008 |0.0039501190185546875 |0.0005047321319580078 |0.0035049915313720703 |0.001329183578491211 |
----------------------------------------------------------pseudo_mini_loss sum 1.0664856433868408
Total (block generation + training)time/epoch 7.174248301464578
Training time/epoch 0.33091044425964355
Training time without block to device /epoch 0.29602646827697754
Training time without total dataloading part /epoch 0.017248868942260742
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 38.39it/s]100%|██████████| 4/4 [00:00<00:00, 38.29it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.27it/s]100%|██████████| 4/4 [00:00<00:00, 15.28it/s]100%|██████████| 4/4 [00:00<00:00, 15.26it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.17it/s]100%|██████████| 4/4 [00:00<00:00, 17.82it/s]100%|██████████| 4/4 [00:00<00:00, 17.85it/s]
Run 00 | Epoch 00055 | Loss 1.0665 | Train 0.3589 | Val 0.4011 | Test 0.3949
Number of nodes during this epoch:  333708
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.15897274017333984  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021935701370239258
range selection method range initialization spend 0.012499094009399414
time for parepare:  0.01898050308227539
local_output_nid generation:  0.011172294616699219
local_in_edges_tensor generation:  0.010352134704589844
mini_batch_src_global generation:  0.01641249656677246
r_  generation:  0.24056601524353027
local_output_nid generation:  0.012034893035888672
local_in_edges_tensor generation:  0.006689310073852539
mini_batch_src_global generation:  0.02204108238220215
r_  generation:  0.209730863571167
----------------------check_connections_block total spend ----------------------------- 0.6292808055877686
generate_one_block  0.22917389869689941
generate_one_block  0.2298731803894043
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03258037567138672
gen group dst list time:  0.00664973258972168
time for parepare:  0.020374536514282227
local_output_nid generation:  0.018403291702270508
local_in_edges_tensor generation:  0.032073974609375
mini_batch_src_global generation:  0.05299234390258789
r_  generation:  0.537029504776001
local_output_nid generation:  0.028757333755493164
local_in_edges_tensor generation:  0.03624129295349121
mini_batch_src_global generation:  0.06303286552429199
r_  generation:  0.5493383407592773
----------------------check_connections_block total spend ----------------------------- 1.5742974281311035
generate_one_block  0.6914143562316895
generate_one_block  0.6887435913085938
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.016921520233154297
gen group dst list time:  0.012411355972290039
time for parepare:  0.01868438720703125
local_output_nid generation:  0.024280071258544922
local_in_edges_tensor generation:  0.03465414047241211
mini_batch_src_global generation:  0.03206038475036621
r_  generation:  0.37156200408935547
local_output_nid generation:  0.03316044807434082
local_in_edges_tensor generation:  0.03237485885620117
mini_batch_src_global generation:  0.04019618034362793
r_  generation:  0.3794846534729004
----------------------check_connections_block total spend ----------------------------- 1.1408166885375977
generate_one_block  0.4516911506652832
generate_one_block  0.4576547145843506
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.15897274017333984  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.715114116668701
block generation total time  2.289503812789917
average batch blocks generation time:  1.1447519063949585
block dataloader generation time/epoch 6.833915253903004
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11472845077514648  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3043384552001953  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1147150993347168  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3039031028747559  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08421874046325684 |0.013763070106506348 |0.0041046142578125 |0.0005146265029907227 |0.0037267208099365234 |0.0014040470123291016 |
----------------------------------------------------------pseudo_mini_loss sum 1.0616214275360107
Total (block generation + training)time/epoch 7.177137050222843
Training time/epoch 0.32720088958740234
Training time without block to device /epoch 0.29967474937438965
Training time without total dataloading part /epoch 0.018095970153808594
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 59.44it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.52it/s]100%|██████████| 4/4 [00:00<00:00, 17.50it/s]100%|██████████| 4/4 [00:00<00:00, 17.15it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.32it/s]100%|██████████| 4/4 [00:00<00:00, 21.64it/s]
Run 00 | Epoch 00056 | Loss 1.0616 | Train 0.3565 | Val 0.3980 | Test 0.3910
Number of nodes during this epoch:  333697
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16019105911254883  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01965045928955078
range selection method range initialization spend 0.012156248092651367
time for parepare:  0.016558408737182617
local_output_nid generation:  0.011188507080078125
local_in_edges_tensor generation:  0.009682655334472656
mini_batch_src_global generation:  0.017189979553222656
r_  generation:  0.19156980514526367
local_output_nid generation:  0.012125968933105469
local_in_edges_tensor generation:  0.007244110107421875
mini_batch_src_global generation:  0.02079606056213379
r_  generation:  0.20893144607543945
----------------------check_connections_block total spend ----------------------------- 0.5786492824554443
generate_one_block  0.24683833122253418
generate_one_block  0.23457646369934082
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04030489921569824
gen group dst list time:  0.006601810455322266
time for parepare:  0.020615577697753906
local_output_nid generation:  0.018989086151123047
local_in_edges_tensor generation:  0.046149492263793945
mini_batch_src_global generation:  0.06583118438720703
r_  generation:  0.5587868690490723
local_output_nid generation:  0.02852034568786621
local_in_edges_tensor generation:  0.040062904357910156
mini_batch_src_global generation:  0.0668191909790039
r_  generation:  0.5600087642669678
----------------------check_connections_block total spend ----------------------------- 1.670517921447754
generate_one_block  0.6857433319091797
generate_one_block  0.6874301433563232
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02034926414489746
gen group dst list time:  0.012406587600708008
time for parepare:  0.018338441848754883
local_output_nid generation:  0.025569677352905273
local_in_edges_tensor generation:  0.03533339500427246
mini_batch_src_global generation:  0.03145623207092285
r_  generation:  0.3809356689453125
local_output_nid generation:  0.032509803771972656
local_in_edges_tensor generation:  0.02728581428527832
mini_batch_src_global generation:  0.04144597053527832
r_  generation:  0.3898775577545166
----------------------check_connections_block total spend ----------------------------- 1.157433271408081
generate_one_block  0.477872371673584
generate_one_block  0.4656219482421875
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16019105911254883  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.827951192855835
block generation total time  2.3166677951812744
average batch blocks generation time:  1.1583338975906372
block dataloader generation time/epoch 6.836459254225095
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11474466323852539  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3084278106689453  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1146855354309082  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3014893531799316  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08786427974700928 |0.02416825294494629 |0.004073619842529297 |0.0005077123641967773 |0.003368377685546875 |0.0012907981872558594 |
----------------------------------------------------------pseudo_mini_loss sum 1.0584001541137695
Total (block generation + training)time/epoch 7.179969226320584
Training time/epoch 0.35689330101013184
Training time without block to device /epoch 0.30855679512023926
Training time without total dataloading part /epoch 0.017190217971801758
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 49.79it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.91it/s]100%|██████████| 4/4 [00:00<00:00, 15.46it/s]100%|██████████| 4/4 [00:00<00:00, 15.36it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.28it/s]100%|██████████| 4/4 [00:00<00:00, 17.78it/s]100%|██████████| 4/4 [00:00<00:00, 17.68it/s]
Run 00 | Epoch 00057 | Loss 1.0584 | Train 0.3544 | Val 0.3941 | Test 0.3873
Number of nodes during this epoch:  333820
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.15853071212768555  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022406816482543945
range selection method range initialization spend 0.011862993240356445
time for parepare:  0.018421649932861328
local_output_nid generation:  0.011055707931518555
local_in_edges_tensor generation:  0.013259649276733398
mini_batch_src_global generation:  0.016439199447631836
r_  generation:  0.1927032470703125
local_output_nid generation:  0.0121002197265625
local_in_edges_tensor generation:  0.007761240005493164
mini_batch_src_global generation:  0.020678043365478516
r_  generation:  0.24344205856323242
----------------------check_connections_block total spend ----------------------------- 0.6208817958831787
generate_one_block  0.24383306503295898
generate_one_block  0.23571538925170898
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0318913459777832
gen group dst list time:  0.006726980209350586
time for parepare:  0.02003788948059082
local_output_nid generation:  0.018076658248901367
local_in_edges_tensor generation:  0.04368329048156738
mini_batch_src_global generation:  0.0546877384185791
r_  generation:  0.5382850170135498
local_output_nid generation:  0.029547452926635742
local_in_edges_tensor generation:  0.03139758110046387
mini_batch_src_global generation:  0.06622004508972168
r_  generation:  0.555063009262085
----------------------check_connections_block total spend ----------------------------- 1.5942914485931396
generate_one_block  0.7400412559509277
generate_one_block  0.6946017742156982
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.021193742752075195
gen group dst list time:  0.014845609664916992
time for parepare:  0.018164396286010742
local_output_nid generation:  0.02295541763305664
local_in_edges_tensor generation:  0.03894948959350586
mini_batch_src_global generation:  0.03218579292297363
r_  generation:  0.3724327087402344
local_output_nid generation:  0.03206753730773926
local_in_edges_tensor generation:  0.03130531311035156
mini_batch_src_global generation:  0.04052090644836426
r_  generation:  0.3804206848144531
----------------------check_connections_block total spend ----------------------------- 1.143256425857544
generate_one_block  0.4666285514831543
generate_one_block  0.4658322334289551
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.15853071212768555  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.7375478744506836
block generation total time  2.3671038150787354
average batch blocks generation time:  1.1835519075393677
block dataloader generation time/epoch 6.838535333166317
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11470746994018555  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3032593727111816  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11472940444946289  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3082962036132812  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08247649669647217 |0.017139673233032227 |0.004103302955627441 |0.000522613525390625 |0.0037838220596313477 |0.0014026165008544922 |
----------------------------------------------------------pseudo_mini_loss sum 1.054725170135498
Total (block generation + training)time/epoch 7.18167317156889
Training time/epoch 0.325120210647583
Training time without block to device /epoch 0.29084086418151855
Training time without total dataloading part /epoch 0.01822209358215332
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 55.14it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 13.89it/s]100%|██████████| 4/4 [00:00<00:00, 14.68it/s]100%|██████████| 4/4 [00:00<00:00, 14.54it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.99it/s]100%|██████████| 4/4 [00:00<00:00, 17.02it/s]100%|██████████| 4/4 [00:00<00:00, 17.00it/s]
Run 00 | Epoch 00058 | Loss 1.0547 | Train 0.3511 | Val 0.3894 | Test 0.3817
Number of nodes during this epoch:  333786
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1601696014404297  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02079463005065918
range selection method range initialization spend 0.012043476104736328
time for parepare:  0.018227338790893555
local_output_nid generation:  0.011013507843017578
local_in_edges_tensor generation:  0.009978771209716797
mini_batch_src_global generation:  0.019119739532470703
r_  generation:  0.19257593154907227
local_output_nid generation:  0.012208223342895508
local_in_edges_tensor generation:  0.008018255233764648
mini_batch_src_global generation:  0.02050304412841797
r_  generation:  0.20588421821594238
----------------------check_connections_block total spend ----------------------------- 0.5772359371185303
generate_one_block  0.2297496795654297
generate_one_block  0.22946429252624512
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03792524337768555
gen group dst list time:  0.006577253341674805
time for parepare:  0.020161867141723633
local_output_nid generation:  0.018167495727539062
local_in_edges_tensor generation:  0.031155824661254883
mini_batch_src_global generation:  0.05149364471435547
r_  generation:  0.5312666893005371
local_output_nid generation:  0.02797675132751465
local_in_edges_tensor generation:  0.03548073768615723
mini_batch_src_global generation:  0.06319928169250488
r_  generation:  0.5456855297088623
----------------------check_connections_block total spend ----------------------------- 1.5594761371612549
generate_one_block  0.683966875076294
generate_one_block  0.6980941295623779
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.020032167434692383
gen group dst list time:  0.012320518493652344
time for parepare:  0.018418312072753906
local_output_nid generation:  0.02271127700805664
local_in_edges_tensor generation:  0.0312345027923584
mini_batch_src_global generation:  0.033425331115722656
r_  generation:  0.3744044303894043
local_output_nid generation:  0.03236055374145508
local_in_edges_tensor generation:  0.027976036071777344
mini_batch_src_global generation:  0.04050803184509277
r_  generation:  0.38444066047668457
----------------------check_connections_block total spend ----------------------------- 1.1385858058929443
generate_one_block  0.45139217376708984
generate_one_block  0.4618101119995117
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1601696014404297  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.698061943054199
block generation total time  2.2952632904052734
average batch blocks generation time:  1.1476316452026367
block dataloader generation time/epoch 6.83727578163147
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11474847793579102  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3041276931762695  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1146998405456543  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3079824447631836  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08446979522705078 |0.015200614929199219 |0.004062771797180176 |0.0005388259887695312 |0.00377810001373291 |0.002885580062866211 |
----------------------------------------------------------pseudo_mini_loss sum 1.0516369342803955
Total (block generation + training)time/epoch 7.180054082870483
Training time/epoch 0.3250148296356201
Training time without block to device /epoch 0.2946135997772217
Training time without total dataloading part /epoch 0.019644975662231445
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 54.46it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.81it/s]100%|██████████| 4/4 [00:00<00:00, 14.94it/s]100%|██████████| 4/4 [00:00<00:00, 14.91it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.30it/s]100%|██████████| 4/4 [00:00<00:00, 17.19it/s]100%|██████████| 4/4 [00:00<00:00, 17.19it/s]
Run 00 | Epoch 00059 | Loss 1.0516 | Train 0.3484 | Val 0.3843 | Test 0.3760
Number of nodes during this epoch:  333780
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16016340255737305  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0192413330078125
range selection method range initialization spend 0.011907577514648438
time for parepare:  0.016780614852905273
local_output_nid generation:  0.010960102081298828
local_in_edges_tensor generation:  0.00910639762878418
mini_batch_src_global generation:  0.016399860382080078
r_  generation:  0.1909325122833252
local_output_nid generation:  0.012088298797607422
local_in_edges_tensor generation:  0.006514549255371094
mini_batch_src_global generation:  0.0204465389251709
r_  generation:  0.208573579788208
----------------------check_connections_block total spend ----------------------------- 0.5759885311126709
generate_one_block  0.24280333518981934
generate_one_block  0.24188542366027832
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05506134033203125
gen group dst list time:  0.006625652313232422
time for parepare:  0.021382570266723633
local_output_nid generation:  0.019137144088745117
local_in_edges_tensor generation:  0.05026721954345703
mini_batch_src_global generation:  0.054535627365112305
r_  generation:  0.5332345962524414
local_output_nid generation:  0.028792381286621094
local_in_edges_tensor generation:  0.03977799415588379
mini_batch_src_global generation:  0.06293678283691406
r_  generation:  0.5449485778808594
----------------------check_connections_block total spend ----------------------------- 1.5903043746948242
generate_one_block  0.6877748966217041
generate_one_block  0.694382905960083
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02165079116821289
gen group dst list time:  0.012334823608398438
time for parepare:  0.0187833309173584
local_output_nid generation:  0.02324390411376953
local_in_edges_tensor generation:  0.03147697448730469
mini_batch_src_global generation:  0.03186988830566406
r_  generation:  0.3717665672302246
local_output_nid generation:  0.03262901306152344
local_in_edges_tensor generation:  0.02786993980407715
mini_batch_src_global generation:  0.04004025459289551
r_  generation:  0.3984389305114746
----------------------check_connections_block total spend ----------------------------- 1.1501491069793701
generate_one_block  0.47050929069519043
generate_one_block  0.46431827545166016
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16016340255737305  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.7404534816741943
block generation total time  2.3169853687286377
average batch blocks generation time:  1.1584926843643188
block dataloader generation time/epoch 6.837703162548589
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11474275588989258  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3041787147521973  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1146998405456543  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3083724975585938  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08837628364562988 |0.016309380531311035 |0.004055142402648926 |0.0005083084106445312 |0.003779888153076172 |0.0013523101806640625 |
----------------------------------------------------------pseudo_mini_loss sum 1.0478771924972534
Total (block generation + training)time/epoch 7.180495762357525
Training time/epoch 0.343355655670166
Training time without block to device /epoch 0.31073689460754395
Training time without total dataloading part /epoch 0.01803898811340332
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 57.05it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.90it/s]100%|██████████| 4/4 [00:00<00:00, 15.24it/s]100%|██████████| 4/4 [00:00<00:00, 15.17it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.78it/s]100%|██████████| 4/4 [00:00<00:00, 17.17it/s]100%|██████████| 4/4 [00:00<00:00, 17.09it/s]
Run 00 | Epoch 00060 | Loss 1.0479 | Train 0.3458 | Val 0.3790 | Test 0.3706
Number of nodes during this epoch:  333777
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16013193130493164  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02020859718322754
range selection method range initialization spend 0.011821269989013672
time for parepare:  0.016912460327148438
local_output_nid generation:  0.01102304458618164
local_in_edges_tensor generation:  0.009021997451782227
mini_batch_src_global generation:  0.018364429473876953
r_  generation:  0.19312787055969238
local_output_nid generation:  0.012015342712402344
local_in_edges_tensor generation:  0.006491661071777344
mini_batch_src_global generation:  0.020727872848510742
r_  generation:  0.20548796653747559
----------------------check_connections_block total spend ----------------------------- 0.5731348991394043
generate_one_block  0.22871971130371094
generate_one_block  0.23063206672668457
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.035753488540649414
gen group dst list time:  0.006565093994140625
time for parepare:  0.020235538482666016
local_output_nid generation:  0.018480539321899414
local_in_edges_tensor generation:  0.030323266983032227
mini_batch_src_global generation:  0.05331707000732422
r_  generation:  0.5444488525390625
local_output_nid generation:  0.031192541122436523
local_in_edges_tensor generation:  0.03805065155029297
mini_batch_src_global generation:  0.06279993057250977
r_  generation:  0.5525045394897461
----------------------check_connections_block total spend ----------------------------- 1.5915908813476562
generate_one_block  0.7335405349731445
generate_one_block  0.7057263851165771
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028393983840942383
gen group dst list time:  0.014709234237670898
time for parepare:  0.018347978591918945
local_output_nid generation:  0.023530244827270508
local_in_edges_tensor generation:  0.03943920135498047
mini_batch_src_global generation:  0.03220796585083008
r_  generation:  0.3742375373840332
local_output_nid generation:  0.03294944763183594
local_in_edges_tensor generation:  0.029259204864501953
mini_batch_src_global generation:  0.04025745391845703
r_  generation:  0.3799755573272705
----------------------check_connections_block total spend ----------------------------- 1.1446623802185059
generate_one_block  0.4539303779602051
generate_one_block  0.45906996726989746
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16013193130493164  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.736253261566162
block generation total time  2.352267265319824
average batch blocks generation time:  1.176133632659912
block dataloader generation time/epoch 6.8382331270437975
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1147456169128418  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3081302642822266  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11469030380249023  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.303609848022461  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08763313293457031 |0.017480015754699707 |0.003992915153503418 |0.0005159378051757812 |0.0028934478759765625 |0.0022783279418945312 |
----------------------------------------------------------pseudo_mini_loss sum 1.044831395149231
Total (block generation + training)time/epoch 7.180861422648797
Training time/epoch 0.3341062068939209
Training time without block to device /epoch 0.2991461753845215
Training time without total dataloading part /epoch 0.017082929611206055
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 52.88it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.75it/s]100%|██████████| 4/4 [00:00<00:00, 15.06it/s]100%|██████████| 4/4 [00:00<00:00, 15.00it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.09it/s]100%|██████████| 4/4 [00:00<00:00, 17.32it/s]100%|██████████| 4/4 [00:00<00:00, 17.26it/s]
Run 00 | Epoch 00061 | Loss 1.0448 | Train 0.3440 | Val 0.3753 | Test 0.3666
Number of nodes during this epoch:  333759
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16016864776611328  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023512601852416992
range selection method range initialization spend 0.012015819549560547
time for parepare:  0.016956329345703125
local_output_nid generation:  0.011071443557739258
local_in_edges_tensor generation:  0.009165048599243164
mini_batch_src_global generation:  0.01619887351989746
r_  generation:  0.19233345985412598
local_output_nid generation:  0.012095451354980469
local_in_edges_tensor generation:  0.007939815521240234
mini_batch_src_global generation:  0.022017240524291992
r_  generation:  0.20711946487426758
----------------------check_connections_block total spend ----------------------------- 0.575007438659668
generate_one_block  0.2428450584411621
generate_one_block  0.2382340431213379
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03914833068847656
gen group dst list time:  0.006710052490234375
time for parepare:  0.02041029930114746
local_output_nid generation:  0.019430160522460938
local_in_edges_tensor generation:  0.048951148986816406
mini_batch_src_global generation:  0.052427053451538086
r_  generation:  0.5564196109771729
local_output_nid generation:  0.030779123306274414
local_in_edges_tensor generation:  0.04029035568237305
mini_batch_src_global generation:  0.06264162063598633
r_  generation:  0.5542120933532715
----------------------check_connections_block total spend ----------------------------- 1.632451057434082
generate_one_block  0.6855337619781494
generate_one_block  0.6935873031616211
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.020655393600463867
gen group dst list time:  0.01241612434387207
time for parepare:  0.0184328556060791
local_output_nid generation:  0.02342534065246582
local_in_edges_tensor generation:  0.0393826961517334
mini_batch_src_global generation:  0.032919883728027344
r_  generation:  0.37400317192077637
local_output_nid generation:  0.03277921676635742
local_in_edges_tensor generation:  0.028690576553344727
mini_batch_src_global generation:  0.040569305419921875
r_  generation:  0.3811919689178467
----------------------check_connections_block total spend ----------------------------- 1.1430773735046387
generate_one_block  0.4497361183166504
generate_one_block  0.45318150520324707
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16016864776611328  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.7755284309387207
block generation total time  2.282038688659668
average batch blocks generation time:  1.141019344329834
block dataloader generation time/epoch 6.838465150797142
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11470746994018555  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3039631843566895  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11474847793579102  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3085474967956543  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08887290954589844 |0.017589807510375977 |0.003943443298339844 |0.0005130767822265625 |0.002985715866088867 |0.0015444755554199219 |
----------------------------------------------------------pseudo_mini_loss sum 1.0458149909973145
Total (block generation + training)time/epoch 7.181002486426875
Training time/epoch 0.33766674995422363
Training time without block to device /epoch 0.3024871349334717
Training time without total dataloading part /epoch 0.01642894744873047
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 57.46it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.23it/s]100%|██████████| 4/4 [00:00<00:00, 15.50it/s]100%|██████████| 4/4 [00:00<00:00, 15.44it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.48it/s]100%|██████████| 4/4 [00:00<00:00, 17.95it/s]100%|██████████| 4/4 [00:00<00:00, 17.86it/s]
Run 00 | Epoch 00062 | Loss 1.0458 | Train 0.3428 | Val 0.3721 | Test 0.3626
Number of nodes during this epoch:  333815
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16015005111694336  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019215822219848633
range selection method range initialization spend 0.012258052825927734
time for parepare:  0.016927003860473633
local_output_nid generation:  0.011141538619995117
local_in_edges_tensor generation:  0.008878231048583984
mini_batch_src_global generation:  0.016129255294799805
r_  generation:  0.1910707950592041
local_output_nid generation:  0.012033462524414062
local_in_edges_tensor generation:  0.006412982940673828
mini_batch_src_global generation:  0.024026870727539062
r_  generation:  0.20796632766723633
----------------------check_connections_block total spend ----------------------------- 0.5749638080596924
generate_one_block  0.24228525161743164
generate_one_block  0.2430722713470459
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0450594425201416
gen group dst list time:  0.0066375732421875
time for parepare:  0.020918607711791992
local_output_nid generation:  0.019207000732421875
local_in_edges_tensor generation:  0.04245352745056152
mini_batch_src_global generation:  0.06717133522033691
r_  generation:  0.586186408996582
local_output_nid generation:  0.03099536895751953
local_in_edges_tensor generation:  0.039811134338378906
mini_batch_src_global generation:  0.0694429874420166
r_  generation:  0.56449294090271
----------------------check_connections_block total spend ----------------------------- 1.6951451301574707
generate_one_block  0.6847596168518066
generate_one_block  0.7056372165679932
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02545332908630371
gen group dst list time:  0.017361164093017578
time for parepare:  0.018814563751220703
local_output_nid generation:  0.023664474487304688
local_in_edges_tensor generation:  0.032233238220214844
mini_batch_src_global generation:  0.032564640045166016
r_  generation:  0.40114355087280273
local_output_nid generation:  0.03276634216308594
local_in_edges_tensor generation:  0.03720521926879883
mini_batch_src_global generation:  0.040766239166259766
r_  generation:  0.40310215950012207
----------------------check_connections_block total spend ----------------------------- 1.2035908699035645
generate_one_block  0.46543192863464355
generate_one_block  0.462904691696167
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16015005111694336  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.898736000061035
block generation total time  2.3187334537506104
average batch blocks generation time:  1.1593667268753052
block dataloader generation time/epoch 6.842015438609653
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11470365524291992  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3041563034057617  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11473703384399414  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3076748847961426  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08528423309326172 |0.02413308620452881 |0.004139542579650879 |0.0004998445510864258 |0.003906726837158203 |0.001611471176147461 |
----------------------------------------------------------pseudo_mini_loss sum 1.037717342376709
Total (block generation + training)time/epoch 7.184805812659087
Training time/epoch 0.35604405403137207
Training time without block to device /epoch 0.30777788162231445
Training time without total dataloading part /epoch 0.018703699111938477
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 51.00it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.94it/s]100%|██████████| 4/4 [00:00<00:00, 15.29it/s]100%|██████████| 4/4 [00:00<00:00, 15.22it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.18it/s]100%|██████████| 4/4 [00:00<00:00, 17.29it/s]100%|██████████| 4/4 [00:00<00:00, 17.25it/s]
Run 00 | Epoch 00063 | Loss 1.0377 | Train 0.3415 | Val 0.3695 | Test 0.3594
Number of nodes during this epoch:  333796
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.15935420989990234  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020157575607299805
range selection method range initialization spend 0.012182235717773438
time for parepare:  0.01675248146057129
local_output_nid generation:  0.010956525802612305
local_in_edges_tensor generation:  0.01411128044128418
mini_batch_src_global generation:  0.016908645629882812
r_  generation:  0.1914355754852295
local_output_nid generation:  0.014653682708740234
local_in_edges_tensor generation:  0.0072422027587890625
mini_batch_src_global generation:  0.020827054977416992
r_  generation:  0.20748186111450195
----------------------check_connections_block total spend ----------------------------- 0.5804071426391602
generate_one_block  0.2306685447692871
generate_one_block  0.23633861541748047
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.038930416107177734
gen group dst list time:  0.006663322448730469
time for parepare:  0.020354032516479492
local_output_nid generation:  0.02061176300048828
local_in_edges_tensor generation:  0.04823493957519531
mini_batch_src_global generation:  0.05247235298156738
r_  generation:  0.5459868907928467
local_output_nid generation:  0.029152631759643555
local_in_edges_tensor generation:  0.052419424057006836
mini_batch_src_global generation:  0.08510684967041016
r_  generation:  0.5657892227172852
----------------------check_connections_block total spend ----------------------------- 1.6644923686981201
generate_one_block  0.6905853748321533
generate_one_block  0.694448709487915
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.020787954330444336
gen group dst list time:  0.013379335403442383
time for parepare:  0.018472671508789062
local_output_nid generation:  0.02353978157043457
local_in_edges_tensor generation:  0.03485703468322754
mini_batch_src_global generation:  0.03175616264343262
r_  generation:  0.3745570182800293
local_output_nid generation:  0.0326993465423584
local_in_edges_tensor generation:  0.031331777572631836
mini_batch_src_global generation:  0.04541802406311035
r_  generation:  0.3834517002105713
----------------------check_connections_block total spend ----------------------------- 1.1488368511199951
generate_one_block  0.4548501968383789
generate_one_block  0.46123719215393066
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.15935420989990234  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.8133292198181152
block generation total time  2.301121473312378
average batch blocks generation time:  1.150560736656189
block dataloader generation time/epoch 6.8429591395638205
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11471319198608398  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3078203201293945  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1147160530090332  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.304018497467041  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0859827995300293 |0.016884684562683105 |0.004131913185119629 |0.000522613525390625 |0.0038756132125854492 |0.0015454292297363281 |
----------------------------------------------------------pseudo_mini_loss sum 1.0390706062316895
Total (block generation + training)time/epoch 7.18561204996976
Training time/epoch 0.3350718021392822
Training time without block to device /epoch 0.301302433013916
Training time without total dataloading part /epoch 0.018605709075927734
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.99it/s]100%|██████████| 4/4 [00:00<00:00, 29.57it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.44it/s]100%|██████████| 4/4 [00:00<00:00, 12.57it/s]100%|██████████| 4/4 [00:00<00:00, 12.37it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.02it/s]100%|██████████| 4/4 [00:00<00:00, 17.33it/s]100%|██████████| 4/4 [00:00<00:00, 17.26it/s]
Run 00 | Epoch 00064 | Loss 1.0391 | Train 0.3401 | Val 0.3672 | Test 0.3563
Number of nodes during this epoch:  333741
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16018152236938477  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018518686294555664
range selection method range initialization spend 0.01186823844909668
time for parepare:  0.017127275466918945
local_output_nid generation:  0.010929107666015625
local_in_edges_tensor generation:  0.012366294860839844
mini_batch_src_global generation:  0.01642918586730957
r_  generation:  0.1906728744506836
local_output_nid generation:  0.012018918991088867
local_in_edges_tensor generation:  0.006746053695678711
mini_batch_src_global generation:  0.021320343017578125
r_  generation:  0.205916166305542
----------------------check_connections_block total spend ----------------------------- 0.573174238204956
generate_one_block  0.22896122932434082
generate_one_block  0.23073124885559082
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03263974189758301
gen group dst list time:  0.006569862365722656
time for parepare:  0.019802093505859375
local_output_nid generation:  0.018451213836669922
local_in_edges_tensor generation:  0.03191828727722168
mini_batch_src_global generation:  0.05363869667053223
r_  generation:  0.5312061309814453
local_output_nid generation:  0.028353214263916016
local_in_edges_tensor generation:  0.03361058235168457
mini_batch_src_global generation:  0.06412959098815918
r_  generation:  0.5422196388244629
----------------------check_connections_block total spend ----------------------------- 1.5578885078430176
generate_one_block  0.6862504482269287
generate_one_block  0.6927027702331543
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.020780563354492188
gen group dst list time:  0.01240849494934082
time for parepare:  0.018393278121948242
local_output_nid generation:  0.023150920867919922
local_in_edges_tensor generation:  0.028980255126953125
mini_batch_src_global generation:  0.034325361251831055
r_  generation:  0.37607717514038086
local_output_nid generation:  0.03221011161804199
local_in_edges_tensor generation:  0.027434825897216797
mini_batch_src_global generation:  0.04006361961364746
r_  generation:  0.3815906047821045
----------------------check_connections_block total spend ----------------------------- 1.1355280876159668
generate_one_block  0.4549434185028076
generate_one_block  0.45439624786376953
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16018152236938477  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.6934165954589844
block generation total time  2.28829288482666
average batch blocks generation time:  1.14414644241333
block dataloader generation time/epoch 6.841061179127012
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11475229263305664  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3076419830322266  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11469507217407227  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3034939765930176  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08445537090301514 |0.014696717262268066 |0.005460500717163086 |0.0007838010787963867 |0.0025063753128051758 |0.0026006698608398438 |
----------------------------------------------------------pseudo_mini_loss sum 1.0356359481811523
Total (block generation + training)time/epoch 7.183460044009345
Training time/epoch 0.32832765579223633
Training time without block to device /epoch 0.2989342212677002
Training time without total dataloading part /epoch 0.02010202407836914
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 64.53it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.30it/s]100%|██████████| 4/4 [00:00<00:00, 15.52it/s]100%|██████████| 4/4 [00:00<00:00, 15.47it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.49it/s]100%|██████████| 4/4 [00:00<00:00, 17.66it/s]100%|██████████| 4/4 [00:00<00:00, 17.61it/s]
Run 00 | Epoch 00065 | Loss 1.0356 | Train 0.3385 | Val 0.3649 | Test 0.3533
Number of nodes during this epoch:  333737
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16017532348632812  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018110990524291992
range selection method range initialization spend 0.011732816696166992
time for parepare:  0.016439199447631836
local_output_nid generation:  0.01081538200378418
local_in_edges_tensor generation:  0.009113073348999023
mini_batch_src_global generation:  0.016338109970092773
r_  generation:  0.19281220436096191
local_output_nid generation:  0.014618635177612305
local_in_edges_tensor generation:  0.008826494216918945
mini_batch_src_global generation:  0.02102518081665039
r_  generation:  0.20901751518249512
----------------------check_connections_block total spend ----------------------------- 0.5810573101043701
generate_one_block  0.24161267280578613
generate_one_block  0.23316121101379395
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.048963069915771484
gen group dst list time:  0.006662607192993164
time for parepare:  0.02063274383544922
local_output_nid generation:  0.01783299446105957
local_in_edges_tensor generation:  0.0354459285736084
mini_batch_src_global generation:  0.05211997032165527
r_  generation:  0.5310850143432617
local_output_nid generation:  0.027983427047729492
local_in_edges_tensor generation:  0.03939628601074219
mini_batch_src_global generation:  0.06227684020996094
r_  generation:  0.5464515686035156
----------------------check_connections_block total spend ----------------------------- 1.5676500797271729
generate_one_block  0.6883935928344727
generate_one_block  0.7108922004699707
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01913285255432129
gen group dst list time:  0.014389753341674805
time for parepare:  0.018184423446655273
local_output_nid generation:  0.023206472396850586
local_in_edges_tensor generation:  0.03489422798156738
mini_batch_src_global generation:  0.032709360122680664
r_  generation:  0.37268853187561035
local_output_nid generation:  0.03211355209350586
local_in_edges_tensor generation:  0.02912449836730957
mini_batch_src_global generation:  0.03970503807067871
r_  generation:  0.37816596031188965
----------------------check_connections_block total spend ----------------------------- 1.1336095333099365
generate_one_block  0.45445942878723145
generate_one_block  0.46791839599609375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16017532348632812  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.7012596130371094
block generation total time  2.3216636180877686
average batch blocks generation time:  1.1608318090438843
block dataloader generation time/epoch 6.840016737318876
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11474847793579102  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3079814910888672  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11469697952270508  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3039650917053223  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08774173259735107 |0.016819357872009277 |0.004248142242431641 |0.0005270242691040039 |0.0029298067092895508 |0.003876209259033203 |
----------------------------------------------------------pseudo_mini_loss sum 1.0310158729553223
Total (block generation + training)time/epoch 7.182390568549173
Training time/epoch 0.3408193588256836
Training time without block to device /epoch 0.30718064308166504
Training time without total dataloading part /epoch 0.019286155700683594
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 52.80it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.53it/s]100%|██████████| 4/4 [00:00<00:00, 15.05it/s]100%|██████████| 4/4 [00:00<00:00, 14.96it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.38it/s]100%|██████████| 4/4 [00:00<00:00, 17.59it/s]100%|██████████| 4/4 [00:00<00:00, 17.54it/s]
Run 00 | Epoch 00066 | Loss 1.0310 | Train 0.3366 | Val 0.3616 | Test 0.3489
Number of nodes during this epoch:  333804
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16015386581420898  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02335047721862793
range selection method range initialization spend 0.012103796005249023
time for parepare:  0.017970800399780273
local_output_nid generation:  0.011099576950073242
local_in_edges_tensor generation:  0.01181936264038086
mini_batch_src_global generation:  0.017162561416625977
r_  generation:  0.19971489906311035
local_output_nid generation:  0.013128042221069336
local_in_edges_tensor generation:  0.008119583129882812
mini_batch_src_global generation:  0.021381855010986328
r_  generation:  0.2055525779724121
----------------------check_connections_block total spend ----------------------------- 0.5928115844726562
generate_one_block  0.22941255569458008
generate_one_block  0.2294766902923584
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.042600154876708984
gen group dst list time:  0.006548404693603516
time for parepare:  0.021611690521240234
local_output_nid generation:  0.01840829849243164
local_in_edges_tensor generation:  0.040769100189208984
mini_batch_src_global generation:  0.05643963813781738
r_  generation:  0.5325732231140137
local_output_nid generation:  0.028380632400512695
local_in_edges_tensor generation:  0.04010629653930664
mini_batch_src_global generation:  0.06299877166748047
r_  generation:  0.5468897819519043
----------------------check_connections_block total spend ----------------------------- 1.5851142406463623
generate_one_block  0.6859362125396729
generate_one_block  0.6971139907836914
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.020006179809570312
gen group dst list time:  0.012438058853149414
time for parepare:  0.01920032501220703
local_output_nid generation:  0.022904396057128906
local_in_edges_tensor generation:  0.02895832061767578
mini_batch_src_global generation:  0.03251981735229492
r_  generation:  0.373307466506958
local_output_nid generation:  0.0324549674987793
local_in_edges_tensor generation:  0.026942729949951172
mini_batch_src_global generation:  0.040360450744628906
r_  generation:  0.3780210018157959
----------------------check_connections_block total spend ----------------------------- 1.1296324729919434
generate_one_block  0.4569716453552246
generate_one_block  0.45042920112609863
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16015386581420898  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.7147467136383057
block generation total time  2.2904510498046875
average batch blocks generation time:  1.1452255249023438
block dataloader generation time/epoch 6.839559172761851
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11473321914672852  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3031926155090332  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11470460891723633  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.308262825012207  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08437061309814453 |0.015109777450561523 |0.00408935546875 |0.0005142688751220703 |0.0028191804885864258 |0.0013766288757324219 |
----------------------------------------------------------pseudo_mini_loss sum 1.0285708904266357
Total (block generation + training)time/epoch 7.181794059687648
Training time/epoch 0.33415937423706055
Training time without block to device /epoch 0.3039398193359375
Training time without total dataloading part /epoch 0.016222238540649414
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 58.64it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.05it/s]100%|██████████| 4/4 [00:00<00:00, 15.36it/s]100%|██████████| 4/4 [00:00<00:00, 15.29it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.31it/s]100%|██████████| 4/4 [00:00<00:00, 17.56it/s]100%|██████████| 4/4 [00:00<00:00, 17.50it/s]
Run 00 | Epoch 00067 | Loss 1.0286 | Train 0.3353 | Val 0.3587 | Test 0.3453
Number of nodes during this epoch:  333764
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1601400375366211  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018312931060791016
range selection method range initialization spend 0.011913776397705078
time for parepare:  0.016911983489990234
local_output_nid generation:  0.011078834533691406
local_in_edges_tensor generation:  0.009708642959594727
mini_batch_src_global generation:  0.017039775848388672
r_  generation:  0.1921522617340088
local_output_nid generation:  0.012145519256591797
local_in_edges_tensor generation:  0.006490945816040039
mini_batch_src_global generation:  0.020615577697753906
r_  generation:  0.20708322525024414
----------------------check_connections_block total spend ----------------------------- 0.5735418796539307
generate_one_block  0.23505568504333496
generate_one_block  0.23504304885864258
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030246257781982422
gen group dst list time:  0.006596088409423828
time for parepare:  0.021901369094848633
local_output_nid generation:  0.01875615119934082
local_in_edges_tensor generation:  0.03683829307556152
mini_batch_src_global generation:  0.05619668960571289
r_  generation:  0.5479941368103027
local_output_nid generation:  0.029972314834594727
local_in_edges_tensor generation:  0.04210400581359863
mini_batch_src_global generation:  0.06489086151123047
r_  generation:  0.5644023418426514
----------------------check_connections_block total spend ----------------------------- 1.6400084495544434
generate_one_block  0.6993498802185059
generate_one_block  0.6959574222564697
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.026651620864868164
gen group dst list time:  0.013634681701660156
time for parepare:  0.018464088439941406
local_output_nid generation:  0.022863388061523438
local_in_edges_tensor generation:  0.032867431640625
mini_batch_src_global generation:  0.03241395950317383
r_  generation:  0.3732261657714844
local_output_nid generation:  0.032060861587524414
local_in_edges_tensor generation:  0.029630184173583984
mini_batch_src_global generation:  0.04068255424499512
r_  generation:  0.3825991153717041
----------------------check_connections_block total spend ----------------------------- 1.1372439861297607
generate_one_block  0.45327258110046387
generate_one_block  0.45173120498657227
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1601400375366211  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.777252435684204
block generation total time  2.3003110885620117
average batch blocks generation time:  1.1501555442810059
block dataloader generation time/epoch 6.839510174120887
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11472368240356445  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.303750991821289  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11472272872924805  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3080201148986816  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08770418167114258 |0.0159912109375 |0.003986239433288574 |0.0005069971084594727 |0.0027326345443725586 |0.0016422271728515625 |
----------------------------------------------------------pseudo_mini_loss sum 1.0259530544281006
Total (block generation + training)time/epoch 7.181506536774716
Training time/epoch 0.3280189037322998
Training time without block to device /epoch 0.2960364818572998
Training time without total dataloading part /epoch 0.016093969345092773
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 53.87it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.03it/s]100%|██████████| 4/4 [00:00<00:00, 15.19it/s]100%|██████████| 4/4 [00:00<00:00, 15.15it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.52it/s]100%|██████████| 4/4 [00:00<00:00, 17.49it/s]100%|██████████| 4/4 [00:00<00:00, 17.48it/s]
Run 00 | Epoch 00068 | Loss 1.0260 | Train 0.3333 | Val 0.3541 | Test 0.3394
Number of nodes during this epoch:  333780
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16016626358032227  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02141714096069336
range selection method range initialization spend 0.011887311935424805
time for parepare:  0.016588211059570312
local_output_nid generation:  0.010820388793945312
local_in_edges_tensor generation:  0.009631156921386719
mini_batch_src_global generation:  0.016315221786499023
r_  generation:  0.19231009483337402
local_output_nid generation:  0.012057304382324219
local_in_edges_tensor generation:  0.0066776275634765625
mini_batch_src_global generation:  0.02173018455505371
r_  generation:  0.20509576797485352
----------------------check_connections_block total spend ----------------------------- 0.5715930461883545
generate_one_block  0.2364645004272461
generate_one_block  0.23363304138183594
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03597450256347656
gen group dst list time:  0.006585597991943359
time for parepare:  0.021698713302612305
local_output_nid generation:  0.01871633529663086
local_in_edges_tensor generation:  0.03007674217224121
mini_batch_src_global generation:  0.05319690704345703
r_  generation:  0.5439126491546631
local_output_nid generation:  0.02828669548034668
local_in_edges_tensor generation:  0.03818035125732422
mini_batch_src_global generation:  0.06620001792907715
r_  generation:  0.5826699733734131
----------------------check_connections_block total spend ----------------------------- 1.633458137512207
generate_one_block  0.7075583934783936
generate_one_block  0.6992716789245605
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02539968490600586
gen group dst list time:  0.01356053352355957
time for parepare:  0.019222259521484375
local_output_nid generation:  0.024073123931884766
local_in_edges_tensor generation:  0.04296517372131348
mini_batch_src_global generation:  0.033976078033447266
r_  generation:  0.37648892402648926
local_output_nid generation:  0.0344693660736084
local_in_edges_tensor generation:  0.029697179794311523
mini_batch_src_global generation:  0.040621280670166016
r_  generation:  0.3938477039337158
----------------------check_connections_block total spend ----------------------------- 1.1704769134521484
generate_one_block  0.473285436630249
generate_one_block  0.4709296226501465
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16016626358032227  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.8039350509643555
block generation total time  2.3510451316833496
average batch blocks generation time:  1.1755225658416748
block dataloader generation time/epoch 6.841065355141958
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11472940444946289  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3038921356201172  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11471033096313477  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.307805061340332  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.1000601053237915 |0.020717382431030273 |0.00408172607421875 |0.0005041360855102539 |0.0026443004608154297 |0.002727985382080078 |
----------------------------------------------------------pseudo_mini_loss sum 1.0243690013885498
Total (block generation + training)time/epoch 7.183566613992055
Training time/epoch 0.3721299171447754
Training time without block to device /epoch 0.33069515228271484
Training time without total dataloading part /epoch 0.017188310623168945
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 55.55it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.11it/s]100%|██████████| 4/4 [00:00<00:00, 15.28it/s]100%|██████████| 4/4 [00:00<00:00, 15.24it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.21it/s]100%|██████████| 4/4 [00:00<00:00, 17.52it/s]100%|██████████| 4/4 [00:00<00:00, 17.46it/s]
Run 00 | Epoch 00069 | Loss 1.0244 | Train 0.3310 | Val 0.3499 | Test 0.3334
Number of nodes during this epoch:  333757
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1601881980895996  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02003169059753418
range selection method range initialization spend 0.011941671371459961
time for parepare:  0.018146276473999023
local_output_nid generation:  0.011026859283447266
local_in_edges_tensor generation:  0.012397527694702148
mini_batch_src_global generation:  0.0170745849609375
r_  generation:  0.19280290603637695
local_output_nid generation:  0.012187957763671875
local_in_edges_tensor generation:  0.008640289306640625
mini_batch_src_global generation:  0.020777225494384766
r_  generation:  0.20532751083374023
----------------------check_connections_block total spend ----------------------------- 0.5786054134368896
generate_one_block  0.22733139991760254
generate_one_block  0.22950124740600586
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03797793388366699
gen group dst list time:  0.006670951843261719
time for parepare:  0.019842147827148438
local_output_nid generation:  0.017918825149536133
local_in_edges_tensor generation:  0.03528547286987305
mini_batch_src_global generation:  0.05496859550476074
r_  generation:  0.5364232063293457
local_output_nid generation:  0.029104948043823242
local_in_edges_tensor generation:  0.0306549072265625
mini_batch_src_global generation:  0.06335139274597168
r_  generation:  0.5441937446594238
----------------------check_connections_block total spend ----------------------------- 1.5682756900787354
generate_one_block  0.6874761581420898
generate_one_block  0.6892228126525879
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02303481101989746
gen group dst list time:  0.012413978576660156
time for parepare:  0.018591880798339844
local_output_nid generation:  0.023079633712768555
local_in_edges_tensor generation:  0.029859066009521484
mini_batch_src_global generation:  0.03229165077209473
r_  generation:  0.3762626647949219
local_output_nid generation:  0.03239250183105469
local_in_edges_tensor generation:  0.028490543365478516
mini_batch_src_global generation:  0.041051626205444336
r_  generation:  0.3818840980529785
----------------------check_connections_block total spend ----------------------------- 1.1393709182739258
generate_one_block  0.45906710624694824
generate_one_block  0.46527624130249023
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1601881980895996  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.707646608352661
block generation total time  2.301042318344116
average batch blocks generation time:  1.150521159172058
block dataloader generation time/epoch 6.84018964454776
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11473512649536133  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3081655502319336  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11472558975219727  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3085298538208008  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08684921264648438 |0.014643669128417969 |0.0039806365966796875 |0.0005314350128173828 |0.0029984712600708008 |0.0013723373413085938 |
----------------------------------------------------------pseudo_mini_loss sum 1.0234745740890503
Total (block generation + training)time/epoch 7.182430927870704
Training time/epoch 0.32654333114624023
Training time without block to device /epoch 0.2972559928894043
Training time without total dataloading part /epoch 0.016393423080444336
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 55.67it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.19it/s]100%|██████████| 4/4 [00:00<00:00, 15.31it/s]100%|██████████| 4/4 [00:00<00:00, 15.28it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.54it/s]100%|██████████| 4/4 [00:00<00:00, 17.29it/s]100%|██████████| 4/4 [00:00<00:00, 17.15it/s]
Run 00 | Epoch 00070 | Loss 1.0235 | Train 0.3280 | Val 0.3430 | Test 0.3266
Number of nodes during this epoch:  333885
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16014528274536133  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023991823196411133
range selection method range initialization spend 0.012426614761352539
time for parepare:  0.016759395599365234
local_output_nid generation:  0.01096343994140625
local_in_edges_tensor generation:  0.01414179801940918
mini_batch_src_global generation:  0.016196489334106445
r_  generation:  0.19609284400939941
local_output_nid generation:  0.01282954216003418
local_in_edges_tensor generation:  0.00795292854309082
mini_batch_src_global generation:  0.020865917205810547
r_  generation:  0.20761823654174805
----------------------check_connections_block total spend ----------------------------- 0.5908477306365967
generate_one_block  0.22806572914123535
generate_one_block  0.23276090621948242
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04147672653198242
gen group dst list time:  0.006565093994140625
time for parepare:  0.02007317543029785
local_output_nid generation:  0.018685102462768555
local_in_edges_tensor generation:  0.03681635856628418
mini_batch_src_global generation:  0.05419278144836426
r_  generation:  0.5308628082275391
local_output_nid generation:  0.028929471969604492
local_in_edges_tensor generation:  0.041001081466674805
mini_batch_src_global generation:  0.06282877922058105
r_  generation:  0.5532312393188477
----------------------check_connections_block total spend ----------------------------- 1.582770586013794
generate_one_block  0.6841044425964355
generate_one_block  0.6991124153137207
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02057504653930664
gen group dst list time:  0.01241612434387207
time for parepare:  0.018502235412597656
local_output_nid generation:  0.023160457611083984
local_in_edges_tensor generation:  0.0319671630859375
mini_batch_src_global generation:  0.032213687896728516
r_  generation:  0.37474584579467773
local_output_nid generation:  0.032697200775146484
local_in_edges_tensor generation:  0.028420209884643555
mini_batch_src_global generation:  0.040081024169921875
r_  generation:  0.3810749053955078
----------------------check_connections_block total spend ----------------------------- 1.1387038230895996
generate_one_block  0.45772600173950195
generate_one_block  0.45231175422668457
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16014528274536133  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.7214744091033936
block generation total time  2.2932546138763428
average batch blocks generation time:  1.1466273069381714
block dataloader generation time/epoch 6.839823507493542
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11467123031616211  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3025875091552734  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11476564407348633  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3090157508850098  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0875481367111206 |0.01553499698638916 |0.00404810905456543 |0.0005183219909667969 |0.0028824806213378906 |0.003905773162841797 |
----------------------------------------------------------pseudo_mini_loss sum 1.016266107559204
Total (block generation + training)time/epoch 7.18194862334959
Training time/epoch 0.3348865509033203
Training time without block to device /epoch 0.303816556930542
Training time without total dataloading part /epoch 0.01880359649658203
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 55.05it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.60it/s]100%|██████████| 4/4 [00:00<00:00, 15.06it/s]100%|██████████| 4/4 [00:00<00:00, 14.98it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.07it/s]100%|██████████| 4/4 [00:00<00:00, 17.16it/s]100%|██████████| 4/4 [00:00<00:00, 17.12it/s]
Run 00 | Epoch 00071 | Loss 1.0163 | Train 0.3247 | Val 0.3380 | Test 0.3199
Number of nodes during this epoch:  333677
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16120433807373047  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020367860794067383
range selection method range initialization spend 0.011913537979125977
time for parepare:  0.016537904739379883
local_output_nid generation:  0.011084556579589844
local_in_edges_tensor generation:  0.009675025939941406
mini_batch_src_global generation:  0.0170745849609375
r_  generation:  0.19033193588256836
local_output_nid generation:  0.012044668197631836
local_in_edges_tensor generation:  0.007143497467041016
mini_batch_src_global generation:  0.02120208740234375
r_  generation:  0.20509600639343262
----------------------check_connections_block total spend ----------------------------- 0.5704002380371094
generate_one_block  0.22903752326965332
generate_one_block  0.22949671745300293
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.031004905700683594
gen group dst list time:  0.006722688674926758
time for parepare:  0.020185232162475586
local_output_nid generation:  0.018992900848388672
local_in_edges_tensor generation:  0.029988765716552734
mini_batch_src_global generation:  0.05173230171203613
r_  generation:  0.5329575538635254
local_output_nid generation:  0.028871536254882812
local_in_edges_tensor generation:  0.030729293823242188
mini_batch_src_global generation:  0.06297707557678223
r_  generation:  0.5507526397705078
----------------------check_connections_block total spend ----------------------------- 1.561978816986084
generate_one_block  0.7328946590423584
generate_one_block  0.6989128589630127
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.020514488220214844
gen group dst list time:  0.01453089714050293
time for parepare:  0.018121004104614258
local_output_nid generation:  0.024670124053955078
local_in_edges_tensor generation:  0.03545498847961426
mini_batch_src_global generation:  0.03316044807434082
r_  generation:  0.3719775676727295
local_output_nid generation:  0.03286862373352051
local_in_edges_tensor generation:  0.0319218635559082
mini_batch_src_global generation:  0.04045295715332031
r_  generation:  0.38114309310913086
----------------------check_connections_block total spend ----------------------------- 1.1444742679595947
generate_one_block  0.45276641845703125
generate_one_block  0.45939111709594727
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16120433807373047  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.7064530849456787
block generation total time  2.3439650535583496
average batch blocks generation time:  1.1719825267791748
block dataloader generation time/epoch 6.83940821602231
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1147313117980957  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3086819648742676  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11471700668334961  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3035812377929688  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08623695373535156 |0.016340970993041992 |0.0040978193283081055 |0.0005083084106445312 |0.002656102180480957 |0.0014684200286865234 |
----------------------------------------------------------pseudo_mini_loss sum 1.0178215503692627
Total (block generation + training)time/epoch 7.181462257627457
Training time/epoch 0.33748388290405273
Training time without block to device /epoch 0.30480194091796875
Training time without total dataloading part /epoch 0.01599287986755371
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 54.55it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.06it/s]100%|██████████| 4/4 [00:00<00:00, 15.52it/s]100%|██████████| 4/4 [00:00<00:00, 15.44it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.25it/s]100%|██████████| 4/4 [00:00<00:00, 17.60it/s]100%|██████████| 4/4 [00:00<00:00, 17.53it/s]
Run 00 | Epoch 00072 | Loss 1.0178 | Train 0.3221 | Val 0.3330 | Test 0.3152
Number of nodes during this epoch:  333810
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16020631790161133  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.017934560775756836
range selection method range initialization spend 0.011980056762695312
time for parepare:  0.016440391540527344
local_output_nid generation:  0.013742685317993164
local_in_edges_tensor generation:  0.009929656982421875
mini_batch_src_global generation:  0.01624774932861328
r_  generation:  0.19771313667297363
local_output_nid generation:  0.012131690979003906
local_in_edges_tensor generation:  0.008246421813964844
mini_batch_src_global generation:  0.021692991256713867
r_  generation:  0.21274089813232422
----------------------check_connections_block total spend ----------------------------- 0.5936479568481445
generate_one_block  0.24217653274536133
generate_one_block  0.2361125946044922
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.041048526763916016
gen group dst list time:  0.00655817985534668
time for parepare:  0.020446062088012695
local_output_nid generation:  0.018674612045288086
local_in_edges_tensor generation:  0.0419774055480957
mini_batch_src_global generation:  0.05517125129699707
r_  generation:  0.5401017665863037
local_output_nid generation:  0.02851700782775879
local_in_edges_tensor generation:  0.0447845458984375
mini_batch_src_global generation:  0.06231856346130371
r_  generation:  0.5557329654693604
----------------------check_connections_block total spend ----------------------------- 1.6050059795379639
generate_one_block  0.6870341300964355
generate_one_block  0.705657958984375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.032503604888916016
gen group dst list time:  0.012550830841064453
time for parepare:  0.018353700637817383
local_output_nid generation:  0.02344369888305664
local_in_edges_tensor generation:  0.032778263092041016
mini_batch_src_global generation:  0.03237271308898926
r_  generation:  0.3748781681060791
local_output_nid generation:  0.032509803771972656
local_in_edges_tensor generation:  0.029570579528808594
mini_batch_src_global generation:  0.03983640670776367
r_  generation:  0.3800361156463623
----------------------check_connections_block total spend ----------------------------- 1.1388132572174072
generate_one_block  0.45398712158203125
generate_one_block  0.45694398880004883
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16020631790161133  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.743819236755371
block generation total time  2.3036231994628906
average batch blocks generation time:  1.1518115997314453
block dataloader generation time/epoch 6.839712858200073
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11470746994018555  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3014674186706543  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11474370956420898  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3087220191955566  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08917927742004395 |0.015721917152404785 |0.003999948501586914 |0.0005127191543579102 |0.002741098403930664 |0.0019211769104003906 |
----------------------------------------------------------pseudo_mini_loss sum 1.0148872137069702
Total (block generation + training)time/epoch 7.181768413633108
Training time/epoch 0.3419969081878662
Training time without block to device /epoch 0.31055307388305664
Training time without total dataloading part /epoch 0.016428709030151367
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.26it/s]100%|██████████| 4/4 [00:00<00:00, 29.47it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.38it/s]100%|██████████| 4/4 [00:00<00:00, 12.57it/s]100%|██████████| 4/4 [00:00<00:00, 12.37it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.94it/s]100%|██████████| 4/4 [00:00<00:00, 17.45it/s]100%|██████████| 4/4 [00:00<00:00, 17.35it/s]
Run 00 | Epoch 00073 | Loss 1.0149 | Train 0.3194 | Val 0.3282 | Test 0.3092
Number of nodes during this epoch:  333734
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16011381149291992  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018221378326416016
range selection method range initialization spend 0.011860847473144531
time for parepare:  0.016572237014770508
local_output_nid generation:  0.011025667190551758
local_in_edges_tensor generation:  0.009134054183959961
mini_batch_src_global generation:  0.016461610794067383
r_  generation:  0.19333529472351074
local_output_nid generation:  0.011939048767089844
local_in_edges_tensor generation:  0.006481647491455078
mini_batch_src_global generation:  0.02046513557434082
r_  generation:  0.20615601539611816
----------------------check_connections_block total spend ----------------------------- 0.5730860233306885
generate_one_block  0.23776841163635254
generate_one_block  0.2380378246307373
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03216695785522461
gen group dst list time:  0.007136821746826172
time for parepare:  0.02003312110900879
local_output_nid generation:  0.018619775772094727
local_in_edges_tensor generation:  0.03365778923034668
mini_batch_src_global generation:  0.05331587791442871
r_  generation:  0.5615599155426025
local_output_nid generation:  0.032181739807128906
local_in_edges_tensor generation:  0.04400062561035156
mini_batch_src_global generation:  0.06876873970031738
r_  generation:  0.544670820236206
----------------------check_connections_block total spend ----------------------------- 1.6189484596252441
generate_one_block  0.6942601203918457
generate_one_block  0.6905970573425293
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.024688243865966797
gen group dst list time:  0.012407302856445312
time for parepare:  0.018263578414916992
local_output_nid generation:  0.02292346954345703
local_in_edges_tensor generation:  0.04537391662597656
mini_batch_src_global generation:  0.03552842140197754
r_  generation:  0.371661901473999
local_output_nid generation:  0.03272652626037598
local_in_edges_tensor generation:  0.02966022491455078
mini_batch_src_global generation:  0.04208803176879883
r_  generation:  0.38213515281677246
----------------------check_connections_block total spend ----------------------------- 1.1574301719665527
generate_one_block  0.4663691520690918
generate_one_block  0.4662153720855713
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16011381149291992  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.776378631591797
block generation total time  2.317441701889038
average batch blocks generation time:  1.158720850944519
block dataloader generation time/epoch 6.840222222988422
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11477327346801758  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3090310096740723  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11468648910522461  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3033747673034668  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08996880054473877 |0.017533183097839355 |0.004138350486755371 |0.0005148649215698242 |0.0025995969772338867 |0.002115964889526367 |
----------------------------------------------------------pseudo_mini_loss sum 1.0089260339736938
Total (block generation + training)time/epoch 7.182279641811665
Training time/epoch 0.3420252799987793
Training time without block to device /epoch 0.3069589138031006
Training time without total dataloading part /epoch 0.01662158966064453
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 46.39it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.10it/s]100%|██████████| 4/4 [00:00<00:00, 14.97it/s]100%|██████████| 4/4 [00:00<00:00, 14.82it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.48it/s]100%|██████████| 4/4 [00:00<00:00, 17.44it/s]100%|██████████| 4/4 [00:00<00:00, 17.43it/s]
Run 00 | Epoch 00074 | Loss 1.0089 | Train 0.3168 | Val 0.3221 | Test 0.3032
Number of nodes during this epoch:  333653
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1592402458190918  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01935267448425293
range selection method range initialization spend 0.012042760848999023
time for parepare:  0.018273353576660156
local_output_nid generation:  0.011076688766479492
local_in_edges_tensor generation:  0.008905172348022461
mini_batch_src_global generation:  0.016335725784301758
r_  generation:  0.19494223594665527
local_output_nid generation:  0.012639760971069336
local_in_edges_tensor generation:  0.007234334945678711
mini_batch_src_global generation:  0.02058267593383789
r_  generation:  0.2050948143005371
----------------------check_connections_block total spend ----------------------------- 0.576387882232666
generate_one_block  0.22919893264770508
generate_one_block  0.23170065879821777
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.035947322845458984
gen group dst list time:  0.0065441131591796875
time for parepare:  0.020234346389770508
local_output_nid generation:  0.018462181091308594
local_in_edges_tensor generation:  0.03479743003845215
mini_batch_src_global generation:  0.05259275436401367
r_  generation:  0.5530376434326172
local_output_nid generation:  0.031954050064086914
local_in_edges_tensor generation:  0.02899646759033203
mini_batch_src_global generation:  0.06321072578430176
r_  generation:  0.5548231601715088
----------------------check_connections_block total spend ----------------------------- 1.595452070236206
generate_one_block  0.6875729560852051
generate_one_block  0.6939370632171631
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.019835710525512695
gen group dst list time:  0.012259483337402344
time for parepare:  0.018761634826660156
local_output_nid generation:  0.0236053466796875
local_in_edges_tensor generation:  0.03150653839111328
mini_batch_src_global generation:  0.03210783004760742
r_  generation:  0.3774406909942627
local_output_nid generation:  0.03252100944519043
local_in_edges_tensor generation:  0.027759790420532227
mini_batch_src_global generation:  0.039766788482666016
r_  generation:  0.37984490394592285
----------------------check_connections_block total spend ----------------------------- 1.1378955841064453
generate_one_block  0.4589991569519043
generate_one_block  0.4521036148071289
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1592402458190918  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.7333476543426514
block generation total time  2.2926127910614014
average batch blocks generation time:  1.1463063955307007
block dataloader generation time/epoch 6.83957961472598
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11471891403198242  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3037381172180176  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11472558975219727  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3080263137817383  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08528494834899902 |0.015039443969726562 |0.0057795047760009766 |0.0007746219635009766 |0.0029387474060058594 |0.0028526782989501953 |
----------------------------------------------------------pseudo_mini_loss sum 1.0098378658294678
Total (block generation + training)time/epoch 7.1814305782318115
Training time/epoch 0.32828330993652344
Training time without block to device /epoch 0.2982044219970703
Training time without total dataloading part /epoch 0.02183842658996582
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 59.77it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.81it/s]100%|██████████| 4/4 [00:00<00:00, 15.43it/s]100%|██████████| 4/4 [00:00<00:00, 15.32it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.96it/s]100%|██████████| 4/4 [00:00<00:00, 17.29it/s]100%|██████████| 4/4 [00:00<00:00, 17.22it/s]
Run 00 | Epoch 00075 | Loss 1.0098 | Train 0.3138 | Val 0.3143 | Test 0.2962
Number of nodes during this epoch:  333775
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16018295288085938  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01948261260986328
range selection method range initialization spend 0.012000560760498047
time for parepare:  0.016287565231323242
local_output_nid generation:  0.011155843734741211
local_in_edges_tensor generation:  0.00924539566040039
mini_batch_src_global generation:  0.016269445419311523
r_  generation:  0.19116425514221191
local_output_nid generation:  0.012170791625976562
local_in_edges_tensor generation:  0.006663084030151367
mini_batch_src_global generation:  0.020797014236450195
r_  generation:  0.20590901374816895
----------------------check_connections_block total spend ----------------------------- 0.5699636936187744
generate_one_block  0.23225069046020508
generate_one_block  0.23494410514831543
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.037550926208496094
gen group dst list time:  0.006536722183227539
time for parepare:  0.019873857498168945
local_output_nid generation:  0.020224332809448242
local_in_edges_tensor generation:  0.03179454803466797
mini_batch_src_global generation:  0.05392122268676758
r_  generation:  0.5415897369384766
local_output_nid generation:  0.03250455856323242
local_in_edges_tensor generation:  0.037679433822631836
mini_batch_src_global generation:  0.06441879272460938
r_  generation:  0.5983684062957764
----------------------check_connections_block total spend ----------------------------- 1.643059492111206
generate_one_block  0.7035770416259766
generate_one_block  0.7065834999084473
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02643299102783203
gen group dst list time:  0.013434171676635742
time for parepare:  0.018676042556762695
local_output_nid generation:  0.023730993270874023
local_in_edges_tensor generation:  0.03618335723876953
mini_batch_src_global generation:  0.034017324447631836
r_  generation:  0.379345178604126
local_output_nid generation:  0.032752037048339844
local_in_edges_tensor generation:  0.029161930084228516
mini_batch_src_global generation:  0.04065823554992676
r_  generation:  0.38167691230773926
----------------------check_connections_block total spend ----------------------------- 1.152970790863037
generate_one_block  0.45545363426208496
generate_one_block  0.45691657066345215
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16018295288085938  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.796030282974243
block generation total time  2.322530746459961
average batch blocks generation time:  1.1612653732299805
block dataloader generation time/epoch 6.840289187075487
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11470842361450195  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3033018112182617  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11474847793579102  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3086705207824707  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08677935600280762 |0.019702792167663574 |0.004068970680236816 |0.0005080699920654297 |0.0032095909118652344 |0.0017757415771484375 |
----------------------------------------------------------pseudo_mini_loss sum 1.0072612762451172
Total (block generation + training)time/epoch 7.18228254389407
Training time/epoch 0.3512382507324219
Training time without block to device /epoch 0.3118326663970947
Training time without total dataloading part /epoch 0.0173490047454834
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.99it/s]100%|██████████| 4/4 [00:00<00:00, 27.80it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.35it/s]100%|██████████| 4/4 [00:00<00:00, 12.49it/s]100%|██████████| 4/4 [00:00<00:00, 12.29it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.97it/s]100%|██████████| 4/4 [00:00<00:00, 17.13it/s]100%|██████████| 4/4 [00:00<00:00, 17.09it/s]
Run 00 | Epoch 00076 | Loss 1.0073 | Train 0.3109 | Val 0.3079 | Test 0.2890
Number of nodes during this epoch:  333805
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16013813018798828  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023618221282958984
range selection method range initialization spend 0.011976480484008789
time for parepare:  0.017683029174804688
local_output_nid generation:  0.014261722564697266
local_in_edges_tensor generation:  0.015119314193725586
mini_batch_src_global generation:  0.0166933536529541
r_  generation:  0.2027280330657959
local_output_nid generation:  0.013213634490966797
local_in_edges_tensor generation:  0.008855104446411133
mini_batch_src_global generation:  0.02194976806640625
r_  generation:  0.2075366973876953
----------------------check_connections_block total spend ----------------------------- 0.6037130355834961
generate_one_block  0.23112010955810547
generate_one_block  0.22996902465820312
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03691887855529785
gen group dst list time:  0.006698131561279297
time for parepare:  0.020409345626831055
local_output_nid generation:  0.01845097541809082
local_in_edges_tensor generation:  0.03899192810058594
mini_batch_src_global generation:  0.05346083641052246
r_  generation:  0.5416262149810791
local_output_nid generation:  0.03022146224975586
local_in_edges_tensor generation:  0.04127860069274902
mini_batch_src_global generation:  0.06344175338745117
r_  generation:  0.5490283966064453
----------------------check_connections_block total spend ----------------------------- 1.5931696891784668
generate_one_block  0.6869347095489502
generate_one_block  0.7029552459716797
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.020493268966674805
gen group dst list time:  0.01230478286743164
time for parepare:  0.021144866943359375
local_output_nid generation:  0.02278876304626465
local_in_edges_tensor generation:  0.029173851013183594
mini_batch_src_global generation:  0.03225970268249512
r_  generation:  0.37640905380249023
local_output_nid generation:  0.03249621391296387
local_in_edges_tensor generation:  0.02998495101928711
mini_batch_src_global generation:  0.04116201400756836
r_  generation:  0.3815023899078369
----------------------check_connections_block total spend ----------------------------- 1.139843225479126
generate_one_block  0.4614877700805664
generate_one_block  0.4606513977050781
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16013813018798828  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.7330129146575928
block generation total time  2.3120291233062744
average batch blocks generation time:  1.1560145616531372
block dataloader generation time/epoch 6.840814239838544
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1147465705871582  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.308154582977295  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11469125747680664  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.303492546081543  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08737146854400635 |0.01984095573425293 |0.004055023193359375 |0.0005136728286743164 |0.003237128257751465 |0.002864837646484375 |
----------------------------------------------------------pseudo_mini_loss sum 1.000941514968872
Total (block generation + training)time/epoch 7.1827186416177184
Training time/epoch 0.33579134941101074
Training time without block to device /epoch 0.2961094379425049
Training time without total dataloading part /epoch 0.018476486206054688
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.09it/s]100%|██████████| 4/4 [00:00<00:00, 30.74it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.41it/s]100%|██████████| 4/4 [00:00<00:00, 12.58it/s]100%|██████████| 4/4 [00:00<00:00, 12.38it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.90it/s]100%|██████████| 4/4 [00:00<00:00, 17.18it/s]100%|██████████| 4/4 [00:00<00:00, 17.12it/s]
Run 00 | Epoch 00077 | Loss 1.0009 | Train 0.3076 | Val 0.3005 | Test 0.2812
Number of nodes during this epoch:  333840
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16018009185791016  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02025437355041504
range selection method range initialization spend 0.011860132217407227
time for parepare:  0.016423463821411133
local_output_nid generation:  0.010984420776367188
local_in_edges_tensor generation:  0.009265661239624023
mini_batch_src_global generation:  0.01639723777770996
r_  generation:  0.1926736831665039
local_output_nid generation:  0.012727022171020508
local_in_edges_tensor generation:  0.006459474563598633
mini_batch_src_global generation:  0.021027803421020508
r_  generation:  0.20747971534729004
----------------------check_connections_block total spend ----------------------------- 0.5734992027282715
generate_one_block  0.23066210746765137
generate_one_block  0.22934222221374512
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.034423112869262695
gen group dst list time:  0.006605863571166992
time for parepare:  0.019873857498168945
local_output_nid generation:  0.019121885299682617
local_in_edges_tensor generation:  0.03799891471862793
mini_batch_src_global generation:  0.05602216720581055
r_  generation:  0.5648660659790039
local_output_nid generation:  0.03276419639587402
local_in_edges_tensor generation:  0.042801618576049805
mini_batch_src_global generation:  0.06787490844726562
r_  generation:  0.5528085231781006
----------------------check_connections_block total spend ----------------------------- 1.6406099796295166
generate_one_block  0.6915972232818604
generate_one_block  0.6939923763275146
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025262832641601562
gen group dst list time:  0.012357473373413086
time for parepare:  0.018419981002807617
local_output_nid generation:  0.023543834686279297
local_in_edges_tensor generation:  0.033867835998535156
mini_batch_src_global generation:  0.03396010398864746
r_  generation:  0.3720529079437256
local_output_nid generation:  0.03301429748535156
local_in_edges_tensor generation:  0.03172779083251953
mini_batch_src_global generation:  0.0401616096496582
r_  generation:  0.38439249992370605
----------------------check_connections_block total spend ----------------------------- 1.1455225944519043
generate_one_block  0.46248388290405273
generate_one_block  0.4564852714538574
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16018009185791016  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.786132574081421
block generation total time  2.304558753967285
average batch blocks generation time:  1.1522793769836426
block dataloader generation time/epoch 6.840970903203107
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11477136611938477  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.309553623199463  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11468362808227539  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3033113479614258  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08985006809234619 |0.016572237014770508 |0.0040819644927978516 |0.0005332231521606445 |0.003732442855834961 |0.00336456298828125 |
----------------------------------------------------------pseudo_mini_loss sum 1.001753807067871
Total (block generation + training)time/epoch 7.182899723882261
Training time/epoch 0.3434300422668457
Training time without block to device /epoch 0.3102855682373047
Training time without total dataloading part /epoch 0.020059823989868164
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.41it/s]100%|██████████| 4/4 [00:00<00:00, 29.63it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.23it/s]100%|██████████| 4/4 [00:00<00:00, 12.35it/s]100%|██████████| 4/4 [00:00<00:00, 12.16it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.72it/s]100%|██████████| 4/4 [00:00<00:00, 17.31it/s]100%|██████████| 4/4 [00:00<00:00, 17.20it/s]
Run 00 | Epoch 00078 | Loss 1.0018 | Train 0.3046 | Val 0.2925 | Test 0.2731
Number of nodes during this epoch:  333735
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.15923833847045898  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021638870239257812
range selection method range initialization spend 0.012212038040161133
time for parepare:  0.017553091049194336
local_output_nid generation:  0.010947227478027344
local_in_edges_tensor generation:  0.012603521347045898
mini_batch_src_global generation:  0.01626443862915039
r_  generation:  0.19238996505737305
local_output_nid generation:  0.012130498886108398
local_in_edges_tensor generation:  0.00789189338684082
mini_batch_src_global generation:  0.020722389221191406
r_  generation:  0.20690131187438965
----------------------check_connections_block total spend ----------------------------- 0.578906774520874
generate_one_block  0.2285158634185791
generate_one_block  0.23161673545837402
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.040622711181640625
gen group dst list time:  0.0067403316497802734
time for parepare:  0.019869089126586914
local_output_nid generation:  0.01839470863342285
local_in_edges_tensor generation:  0.039725542068481445
mini_batch_src_global generation:  0.05230879783630371
r_  generation:  0.5345127582550049
local_output_nid generation:  0.028946876525878906
local_in_edges_tensor generation:  0.03664898872375488
mini_batch_src_global generation:  0.06285762786865234
r_  generation:  0.5483758449554443
----------------------check_connections_block total spend ----------------------------- 1.5786993503570557
generate_one_block  0.6952996253967285
generate_one_block  0.7096474170684814
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.018073081970214844
gen group dst list time:  0.012357473373413086
time for parepare:  0.020313024520874023
local_output_nid generation:  0.023491859436035156
local_in_edges_tensor generation:  0.030066728591918945
mini_batch_src_global generation:  0.03243875503540039
r_  generation:  0.37876319885253906
local_output_nid generation:  0.032151222229003906
local_in_edges_tensor generation:  0.029681921005249023
mini_batch_src_global generation:  0.043357133865356445
r_  generation:  0.38691234588623047
----------------------check_connections_block total spend ----------------------------- 1.1543419361114502
generate_one_block  0.4714071750640869
generate_one_block  0.48345208168029785
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.15923833847045898  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.733041286468506
block generation total time  2.3598062992095947
average batch blocks generation time:  1.1799031496047974
block dataloader generation time/epoch 6.841866414887565
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11471796035766602  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3081326484680176  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11472463607788086  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3034582138061523  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08716905117034912 |0.02636134624481201 |0.004145979881286621 |0.0004979372024536133 |0.0039020776748657227 |0.0016055107116699219 |
----------------------------------------------------------pseudo_mini_loss sum 0.9991271495819092
Total (block generation + training)time/epoch 7.184107984815325
Training time/epoch 0.36366748809814453
Training time without block to device /epoch 0.3109447956085205
Training time without total dataloading part /epoch 0.018697500228881836
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 50.53it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.77it/s]100%|██████████| 4/4 [00:00<00:00, 15.41it/s]100%|██████████| 4/4 [00:00<00:00, 15.29it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.24it/s]100%|██████████| 4/4 [00:00<00:00, 17.33it/s]100%|██████████| 4/4 [00:00<00:00, 17.30it/s]
Run 00 | Epoch 00079 | Loss 0.9991 | Train 0.3014 | Val 0.2853 | Test 0.2656
Number of nodes during this epoch:  333715
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16022491455078125  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02052021026611328
range selection method range initialization spend 0.012223958969116211
time for parepare:  0.01773834228515625
local_output_nid generation:  0.011470556259155273
local_in_edges_tensor generation:  0.011937379837036133
mini_batch_src_global generation:  0.016350984573364258
r_  generation:  0.1915433406829834
local_output_nid generation:  0.012066841125488281
local_in_edges_tensor generation:  0.007516622543334961
mini_batch_src_global generation:  0.021839141845703125
r_  generation:  0.20407652854919434
----------------------check_connections_block total spend ----------------------------- 0.575162410736084
generate_one_block  0.22719740867614746
generate_one_block  0.23163080215454102
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.034337759017944336
gen group dst list time:  0.006551265716552734
time for parepare:  0.01994943618774414
local_output_nid generation:  0.018415451049804688
local_in_edges_tensor generation:  0.03557896614074707
mini_batch_src_global generation:  0.05384373664855957
r_  generation:  0.5318615436553955
local_output_nid generation:  0.02877974510192871
local_in_edges_tensor generation:  0.032416582107543945
mini_batch_src_global generation:  0.06192517280578613
r_  generation:  0.5465691089630127
----------------------check_connections_block total spend ----------------------------- 1.563469648361206
generate_one_block  0.6830768585205078
generate_one_block  0.6783220767974854
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.019827604293823242
gen group dst list time:  0.012397527694702148
time for parepare:  0.018395662307739258
local_output_nid generation:  0.022974252700805664
local_in_edges_tensor generation:  0.028564929962158203
mini_batch_src_global generation:  0.03203749656677246
r_  generation:  0.3701210021972656
local_output_nid generation:  0.03250479698181152
local_in_edges_tensor generation:  0.027768611907958984
mini_batch_src_global generation:  0.04014229774475098
r_  generation:  0.37643003463745117
----------------------check_connections_block total spend ----------------------------- 1.121438980102539
generate_one_block  0.4522888660430908
generate_one_block  0.4549534320831299
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16022491455078125  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.684908628463745
block generation total time  2.268641233444214
average batch blocks generation time:  1.134320616722107
block dataloader generation time/epoch 6.840203510203832
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11473321914672852  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3043570518493652  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11469602584838867  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3032464981079102  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08348989486694336 |0.014419317245483398 |0.0038428306579589844 |0.00049591064453125 |0.003326416015625 |0.0017104148864746094 |
----------------------------------------------------------pseudo_mini_loss sum 0.9973138570785522
Total (block generation + training)time/epoch 7.182170176170241
Training time/epoch 0.32262682914733887
Training time without block to device /epoch 0.29378819465637207
Training time without total dataloading part /epoch 0.017040729522705078
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 64.31it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.20it/s]100%|██████████| 4/4 [00:00<00:00, 15.21it/s]100%|██████████| 4/4 [00:00<00:00, 15.20it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.28it/s]100%|██████████| 4/4 [00:00<00:00, 17.04it/s]100%|██████████| 4/4 [00:00<00:00, 17.06it/s]
Run 00 | Epoch 00080 | Loss 0.9973 | Train 0.2984 | Val 0.2796 | Test 0.2595
Number of nodes during this epoch:  333928
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.160186767578125  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01949763298034668
range selection method range initialization spend 0.01184535026550293
time for parepare:  0.01666855812072754
local_output_nid generation:  0.011058807373046875
local_in_edges_tensor generation:  0.009048700332641602
mini_batch_src_global generation:  0.01618504524230957
r_  generation:  0.18809747695922852
local_output_nid generation:  0.01229715347290039
local_in_edges_tensor generation:  0.006561279296875
mini_batch_src_global generation:  0.021071672439575195
r_  generation:  0.2061302661895752
----------------------check_connections_block total spend ----------------------------- 0.5671296119689941
generate_one_block  0.22532272338867188
generate_one_block  0.22952032089233398
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03195023536682129
gen group dst list time:  0.00664067268371582
time for parepare:  0.01976156234741211
local_output_nid generation:  0.017729759216308594
local_in_edges_tensor generation:  0.03130960464477539
mini_batch_src_global generation:  0.05121612548828125
r_  generation:  0.5317559242248535
local_output_nid generation:  0.028198957443237305
local_in_edges_tensor generation:  0.02950263023376465
mini_batch_src_global generation:  0.06301045417785645
r_  generation:  0.5700571537017822
----------------------check_connections_block total spend ----------------------------- 1.5793581008911133
generate_one_block  0.6958951950073242
generate_one_block  0.6999397277832031
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02510976791381836
gen group dst list time:  0.01721048355102539
time for parepare:  0.02017498016357422
local_output_nid generation:  0.023549795150756836
local_in_edges_tensor generation:  0.03440666198730469
mini_batch_src_global generation:  0.03410959243774414
r_  generation:  0.3816509246826172
local_output_nid generation:  0.035651445388793945
local_in_edges_tensor generation:  0.032253265380859375
mini_batch_src_global generation:  0.04027962684631348
r_  generation:  0.3889482021331787
----------------------check_connections_block total spend ----------------------------- 1.1640453338623047
generate_one_block  0.4559745788574219
generate_one_block  0.45795583724975586
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.160186767578125  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.743403434753418
block generation total time  2.309765338897705
average batch blocks generation time:  1.1548826694488525
block dataloader generation time/epoch 6.839431458049351
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11471128463745117  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3036646842956543  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1147456169128418  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3081417083740234  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0883786678314209 |0.02283334732055664 |0.003960967063903809 |0.0004947185516357422 |0.0030516386032104492 |0.0028891563415527344 |
----------------------------------------------------------pseudo_mini_loss sum 0.9952821731567383
Total (block generation + training)time/epoch 7.181456453270382
Training time/epoch 0.3460214138031006
Training time without block to device /epoch 0.3003547191619873
Training time without total dataloading part /epoch 0.017903804779052734
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 53.89it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.95it/s]100%|██████████| 4/4 [00:00<00:00, 15.29it/s]100%|██████████| 4/4 [00:00<00:00, 15.22it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.85it/s]100%|██████████| 4/4 [00:00<00:00, 17.04it/s]100%|██████████| 4/4 [00:00<00:00, 16.99it/s]
Run 00 | Epoch 00081 | Loss 0.9953 | Train 0.2956 | Val 0.2723 | Test 0.2533
Number of nodes during this epoch:  333729
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16019105911254883  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.05644822120666504
range selection method range initialization spend 0.012027502059936523
time for parepare:  0.017232418060302734
local_output_nid generation:  0.011774778366088867
local_in_edges_tensor generation:  0.010489463806152344
mini_batch_src_global generation:  0.016515016555786133
r_  generation:  0.19330573081970215
local_output_nid generation:  0.012226343154907227
local_in_edges_tensor generation:  0.006520509719848633
mini_batch_src_global generation:  0.02088642120361328
r_  generation:  0.2064952850341797
----------------------check_connections_block total spend ----------------------------- 0.576667070388794
generate_one_block  0.2287425994873047
generate_one_block  0.2314894199371338
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03893423080444336
gen group dst list time:  0.006632089614868164
time for parepare:  0.020203351974487305
local_output_nid generation:  0.019080638885498047
local_in_edges_tensor generation:  0.03266286849975586
mini_batch_src_global generation:  0.054270267486572266
r_  generation:  0.5656347274780273
local_output_nid generation:  0.029029369354248047
local_in_edges_tensor generation:  0.034449100494384766
mini_batch_src_global generation:  0.06300759315490723
r_  generation:  0.5570192337036133
----------------------check_connections_block total spend ----------------------------- 1.618239402770996
generate_one_block  0.7397501468658447
generate_one_block  0.7000319957733154
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03085803985595703
gen group dst list time:  0.014696359634399414
time for parepare:  0.018141508102416992
local_output_nid generation:  0.023720979690551758
local_in_edges_tensor generation:  0.03980708122253418
mini_batch_src_global generation:  0.03160357475280762
r_  generation:  0.37483739852905273
local_output_nid generation:  0.03304886817932129
local_in_edges_tensor generation:  0.031171083450317383
mini_batch_src_global generation:  0.040276527404785156
r_  generation:  0.3823890686035156
----------------------check_connections_block total spend ----------------------------- 1.1500601768493652
generate_one_block  0.45186924934387207
generate_one_block  0.45038294792175293
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16019105911254883  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.7682995796203613
block generation total time  2.342034339904785
average batch blocks generation time:  1.1710171699523926
block dataloader generation time/epoch 6.840933672369343
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11470365524291992  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3038506507873535  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11473226547241211  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3077607154846191  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08670485019683838 |0.01692354679107666 |0.00413203239440918 |0.0005123615264892578 |0.003668665885925293 |0.0014986991882324219 |
----------------------------------------------------------pseudo_mini_loss sum 0.9930723309516907
Total (block generation + training)time/epoch 7.18284176800349
Training time/epoch 0.3333275318145752
Training time without block to device /epoch 0.2994804382324219
Training time without total dataloading part /epoch 0.018124818801879883
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 49.48it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.25it/s]100%|██████████| 4/4 [00:00<00:00, 15.60it/s]100%|██████████| 4/4 [00:00<00:00, 15.53it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.69it/s]100%|██████████| 4/4 [00:00<00:00, 18.07it/s]100%|██████████| 4/4 [00:00<00:00, 17.99it/s]
Run 00 | Epoch 00082 | Loss 0.9931 | Train 0.2931 | Val 0.2677 | Test 0.2485
Number of nodes during this epoch:  333750
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1602306365966797  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019821882247924805
range selection method range initialization spend 0.012067794799804688
time for parepare:  0.016831398010253906
local_output_nid generation:  0.01119685173034668
local_in_edges_tensor generation:  0.009919881820678711
mini_batch_src_global generation:  0.016695737838745117
r_  generation:  0.1922318935394287
local_output_nid generation:  0.011916875839233398
local_in_edges_tensor generation:  0.006422996520996094
mini_batch_src_global generation:  0.020622968673706055
r_  generation:  0.20503759384155273
----------------------check_connections_block total spend ----------------------------- 0.5709476470947266
generate_one_block  0.23151350021362305
generate_one_block  0.23014211654663086
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03272294998168945
gen group dst list time:  0.006593942642211914
time for parepare:  0.0199124813079834
local_output_nid generation:  0.018353700637817383
local_in_edges_tensor generation:  0.03451228141784668
mini_batch_src_global generation:  0.05521988868713379
r_  generation:  0.5347638130187988
local_output_nid generation:  0.030206918716430664
local_in_edges_tensor generation:  0.02886486053466797
mini_batch_src_global generation:  0.06278753280639648
r_  generation:  0.5462749004364014
----------------------check_connections_block total spend ----------------------------- 1.565889835357666
generate_one_block  0.6947078704833984
generate_one_block  0.6976277828216553
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025653839111328125
gen group dst list time:  0.012915611267089844
time for parepare:  0.018711566925048828
local_output_nid generation:  0.02330160140991211
local_in_edges_tensor generation:  0.03154444694519043
mini_batch_src_global generation:  0.032393693923950195
r_  generation:  0.3806793689727783
local_output_nid generation:  0.03336167335510254
local_in_edges_tensor generation:  0.0356905460357666
mini_batch_src_global generation:  0.05186271667480469
r_  generation:  0.3912360668182373
----------------------check_connections_block total spend ----------------------------- 1.1777710914611816
generate_one_block  0.4582216739654541
generate_one_block  0.45778346061706543
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1602306365966797  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.7436609268188477
block generation total time  2.3083407878875732
average batch blocks generation time:  1.1541703939437866
block dataloader generation time/epoch 6.840568674577249
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11472463607788086  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3039159774780273  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11471891403198242  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3079805374145508  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09360861778259277 |0.02375006675720215 |0.003983020782470703 |0.000496983528137207 |0.0034946203231811523 |0.0018646717071533203 |
----------------------------------------------------------pseudo_mini_loss sum 0.9920525550842285
Total (block generation + training)time/epoch 7.1827895705764355
Training time/epoch 0.3648984432220459
Training time without block to device /epoch 0.3173983097076416
Training time without total dataloading part /epoch 0.017813920974731445
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.85it/s]100%|██████████| 4/4 [00:00<00:00, 29.53it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.37it/s]100%|██████████| 4/4 [00:00<00:00, 12.61it/s]100%|██████████| 4/4 [00:00<00:00, 12.39it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.68it/s]100%|██████████| 4/4 [00:00<00:00, 18.07it/s]
Run 00 | Epoch 00083 | Loss 0.9921 | Train 0.2913 | Val 0.2635 | Test 0.2446
Number of nodes during this epoch:  333726
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16017913818359375  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0180966854095459
range selection method range initialization spend 0.011977672576904297
time for parepare:  0.016987323760986328
local_output_nid generation:  0.010851144790649414
local_in_edges_tensor generation:  0.015021800994873047
mini_batch_src_global generation:  0.019475221633911133
r_  generation:  0.20032405853271484
local_output_nid generation:  0.01532125473022461
local_in_edges_tensor generation:  0.014921903610229492
mini_batch_src_global generation:  0.02541351318359375
r_  generation:  0.2223505973815918
----------------------check_connections_block total spend ----------------------------- 0.6261024475097656
generate_one_block  0.22735095024108887
generate_one_block  0.23290061950683594
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03323793411254883
gen group dst list time:  0.006459474563598633
time for parepare:  0.02012157440185547
local_output_nid generation:  0.019428014755249023
local_in_edges_tensor generation:  0.033141374588012695
mini_batch_src_global generation:  0.054079294204711914
r_  generation:  0.5424692630767822
local_output_nid generation:  0.028516530990600586
local_in_edges_tensor generation:  0.03725934028625488
mini_batch_src_global generation:  0.06490516662597656
r_  generation:  0.5666244029998779
----------------------check_connections_block total spend ----------------------------- 1.6030278205871582
generate_one_block  0.7323858737945557
generate_one_block  0.7002294063568115
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.021534442901611328
gen group dst list time:  0.014682292938232422
time for parepare:  0.0187380313873291
local_output_nid generation:  0.02474212646484375
local_in_edges_tensor generation:  0.042772769927978516
mini_batch_src_global generation:  0.03183269500732422
r_  generation:  0.37809062004089355
local_output_nid generation:  0.032935142517089844
local_in_edges_tensor generation:  0.029148578643798828
mini_batch_src_global generation:  0.0403292179107666
r_  generation:  0.38355541229248047
----------------------check_connections_block total spend ----------------------------- 1.1576411724090576
generate_one_block  0.44932103157043457
generate_one_block  0.4547119140625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16017913818359375  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.760668992996216
block generation total time  2.3366482257843018
average batch blocks generation time:  1.1683241128921509
block dataloader generation time/epoch 6.841415926615397
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11467313766479492  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.302657127380371  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11476850509643555  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3093557357788086  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.084464430809021 |0.016675472259521484 |0.004164338111877441 |0.000518798828125 |0.0036725997924804688 |0.0019130706787109375 |
----------------------------------------------------------pseudo_mini_loss sum 0.9879123568534851
Total (block generation + training)time/epoch 7.183548040390015
Training time/epoch 0.3354201316833496
Training time without block to device /epoch 0.30206918716430664
Training time without total dataloading part /epoch 0.018624544143676758
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 52.02it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.69it/s]100%|██████████| 4/4 [00:00<00:00, 17.34it/s]100%|██████████| 4/4 [00:00<00:00, 17.04it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.56it/s]100%|██████████| 4/4 [00:00<00:00, 19.07it/s]100%|██████████| 4/4 [00:00<00:00, 18.95it/s]
Run 00 | Epoch 00084 | Loss 0.9879 | Train 0.2889 | Val 0.2591 | Test 0.2402
Number of nodes during this epoch:  333799
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1611795425415039  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019791126251220703
range selection method range initialization spend 0.011970758438110352
time for parepare:  0.016964197158813477
local_output_nid generation:  0.010843753814697266
local_in_edges_tensor generation:  0.0169680118560791
mini_batch_src_global generation:  0.019346952438354492
r_  generation:  0.2152724266052246
local_output_nid generation:  0.014878988265991211
local_in_edges_tensor generation:  0.00713658332824707
mini_batch_src_global generation:  0.030347108840942383
r_  generation:  0.22185301780700684
----------------------check_connections_block total spend ----------------------------- 0.644282341003418
generate_one_block  0.23123979568481445
generate_one_block  0.23122930526733398
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03614544868469238
gen group dst list time:  0.006467103958129883
time for parepare:  0.02043318748474121
local_output_nid generation:  0.018975257873535156
local_in_edges_tensor generation:  0.03222203254699707
mini_batch_src_global generation:  0.05050015449523926
r_  generation:  0.5420382022857666
local_output_nid generation:  0.02908015251159668
local_in_edges_tensor generation:  0.036209821701049805
mini_batch_src_global generation:  0.0637209415435791
r_  generation:  0.5501453876495361
----------------------check_connections_block total spend ----------------------------- 1.5805838108062744
generate_one_block  0.6996948719024658
generate_one_block  0.7324302196502686
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.026628732681274414
gen group dst list time:  0.014321088790893555
time for parepare:  0.0197598934173584
local_output_nid generation:  0.024130821228027344
local_in_edges_tensor generation:  0.05066967010498047
mini_batch_src_global generation:  0.03290367126464844
r_  generation:  0.38187551498413086
local_output_nid generation:  0.03250002861022949
local_in_edges_tensor generation:  0.03382539749145508
mini_batch_src_global generation:  0.039608001708984375
r_  generation:  0.383007287979126
----------------------check_connections_block total spend ----------------------------- 1.170999526977539
generate_one_block  0.47199583053588867
generate_one_block  0.4547104835510254
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1611795425415039  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.7515833377838135
block generation total time  2.3588314056396484
average batch blocks generation time:  1.1794157028198242
block dataloader generation time/epoch 6.843219236323708
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11473798751831055  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3084144592285156  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11471128463745117  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.308016300201416  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09402751922607422 |0.018467068672180176 |0.004155158996582031 |0.0005202293395996094 |0.0037163496017456055 |0.0013604164123535156 |
----------------------------------------------------------pseudo_mini_loss sum 0.985761284828186
Total (block generation + training)time/epoch 7.1855580053831405
Training time/epoch 0.3576836585998535
Training time without block to device /epoch 0.32074952125549316
Training time without total dataloading part /epoch 0.018143892288208008
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.43it/s]100%|██████████| 4/4 [00:00<00:00, 28.81it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 12.02it/s]100%|██████████| 4/4 [00:00<00:00, 13.36it/s]100%|██████████| 4/4 [00:00<00:00, 13.13it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.93it/s]100%|██████████| 4/4 [00:00<00:00, 19.09it/s]100%|██████████| 4/4 [00:00<00:00, 19.03it/s]
Run 00 | Epoch 00085 | Loss 0.9858 | Train 0.2871 | Val 0.2547 | Test 0.2362
Number of nodes during this epoch:  333868
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16016674041748047  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022340774536132812
range selection method range initialization spend 0.01227712631225586
time for parepare:  0.017246484756469727
local_output_nid generation:  0.010986089706420898
local_in_edges_tensor generation:  0.01004648208618164
mini_batch_src_global generation:  0.016753435134887695
r_  generation:  0.2259960174560547
local_output_nid generation:  0.01227569580078125
local_in_edges_tensor generation:  0.00709986686706543
mini_batch_src_global generation:  0.020932674407958984
r_  generation:  0.21155619621276855
----------------------check_connections_block total spend ----------------------------- 0.6121025085449219
generate_one_block  0.22802329063415527
generate_one_block  0.23176264762878418
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.032362937927246094
gen group dst list time:  0.006537437438964844
time for parepare:  0.019893884658813477
local_output_nid generation:  0.018860816955566406
local_in_edges_tensor generation:  0.031684160232543945
mini_batch_src_global generation:  0.057512521743774414
r_  generation:  0.5355026721954346
local_output_nid generation:  0.028970718383789062
local_in_edges_tensor generation:  0.03566169738769531
mini_batch_src_global generation:  0.06243252754211426
r_  generation:  0.553617000579834
----------------------check_connections_block total spend ----------------------------- 1.5776724815368652
generate_one_block  0.6893815994262695
generate_one_block  0.6907613277435303
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.017378807067871094
gen group dst list time:  0.012356996536254883
time for parepare:  0.018463134765625
local_output_nid generation:  0.023720502853393555
local_in_edges_tensor generation:  0.02815866470336914
mini_batch_src_global generation:  0.03120708465576172
r_  generation:  0.37558770179748535
local_output_nid generation:  0.032778263092041016
local_in_edges_tensor generation:  0.030153751373291016
mini_batch_src_global generation:  0.03945136070251465
r_  generation:  0.39096736907958984
----------------------check_connections_block total spend ----------------------------- 1.1443872451782227
generate_one_block  0.4573829174041748
generate_one_block  0.4650533199310303
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16016674041748047  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.722059726715088
block generation total time  2.302579164505005
average batch blocks generation time:  1.1512895822525024
block dataloader generation time/epoch 6.842979539524425
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11472272872924805  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.304081916809082  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1147160530090332  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.308342456817627  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08566606044769287 |0.014103174209594727 |0.0038927793502807617 |0.0005130767822265625 |0.0036023855209350586 |0.003771543502807617 |
----------------------------------------------------------pseudo_mini_loss sum 0.9835243225097656
Total (block generation + training)time/epoch 7.185098202197583
Training time/epoch 0.3252873420715332
Training time without block to device /epoch 0.29708099365234375
Training time without total dataloading part /epoch 0.019788026809692383
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 49.86it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.95it/s]100%|██████████| 4/4 [00:00<00:00, 15.54it/s]100%|██████████| 4/4 [00:00<00:00, 15.42it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.49it/s]100%|██████████| 4/4 [00:00<00:00, 20.69it/s]
Run 00 | Epoch 00086 | Loss 0.9835 | Train 0.2853 | Val 0.2492 | Test 0.2311
Number of nodes during this epoch:  333837
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1601576805114746  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019936561584472656
range selection method range initialization spend 0.01236104965209961
time for parepare:  0.01700282096862793
local_output_nid generation:  0.010811328887939453
local_in_edges_tensor generation:  0.01005244255065918
mini_batch_src_global generation:  0.016802310943603516
r_  generation:  0.2227027416229248
local_output_nid generation:  0.012149333953857422
local_in_edges_tensor generation:  0.007068634033203125
mini_batch_src_global generation:  0.02337193489074707
r_  generation:  0.21056675910949707
----------------------check_connections_block total spend ----------------------------- 0.6100115776062012
generate_one_block  0.22718524932861328
generate_one_block  0.2330479621887207
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.035805463790893555
gen group dst list time:  0.008131742477416992
time for parepare:  0.02017831802368164
local_output_nid generation:  0.018831968307495117
local_in_edges_tensor generation:  0.03737592697143555
mini_batch_src_global generation:  0.05017566680908203
r_  generation:  0.5370564460754395
local_output_nid generation:  0.028966426849365234
local_in_edges_tensor generation:  0.02827620506286621
mini_batch_src_global generation:  0.06212639808654785
r_  generation:  0.5440919399261475
----------------------check_connections_block total spend ----------------------------- 1.5602593421936035
generate_one_block  0.6842424869537354
generate_one_block  0.6865592002868652
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.018263816833496094
gen group dst list time:  0.012104034423828125
time for parepare:  0.01853466033935547
local_output_nid generation:  0.023853063583374023
local_in_edges_tensor generation:  0.028574705123901367
mini_batch_src_global generation:  0.031032800674438477
r_  generation:  0.37270402908325195
local_output_nid generation:  0.033621788024902344
local_in_edges_tensor generation:  0.027449607849121094
mini_batch_src_global generation:  0.04009890556335449
r_  generation:  0.3899083137512207
----------------------check_connections_block total spend ----------------------------- 1.1374082565307617
generate_one_block  0.4589653015136719
generate_one_block  0.45978808403015137
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1601576805114746  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.6976675987243652
block generation total time  2.289555072784424
average batch blocks generation time:  1.144777536392212
block dataloader generation time/epoch 6.843414111015124
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11473798751831055  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.308326244354248  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11471986770629883  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.308082103729248  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08463895320892334 |0.016546010971069336 |0.003974795341491699 |0.0005080699920654297 |0.003569960594177246 |0.0013360977172851562 |
----------------------------------------------------------pseudo_mini_loss sum 0.98240727186203
Total (block generation + training)time/epoch 7.185482407227541
Training time/epoch 0.33808350563049316
Training time without block to device /epoch 0.3049914836883545
Training time without total dataloading part /epoch 0.017441749572753906
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.33it/s]100%|██████████| 4/4 [00:00<00:00, 27.16it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 10.82it/s]100%|██████████| 4/4 [00:00<00:00, 11.99it/s]100%|██████████| 4/4 [00:00<00:00, 11.79it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.52it/s]100%|██████████| 4/4 [00:00<00:00, 19.43it/s]
Run 00 | Epoch 00087 | Loss 0.9824 | Train 0.2832 | Val 0.2441 | Test 0.2261
Number of nodes during this epoch:  333833
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1601886749267578  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026184558868408203
range selection method range initialization spend 0.012833595275878906
time for parepare:  0.020284652709960938
local_output_nid generation:  0.012237071990966797
local_in_edges_tensor generation:  0.010775566101074219
mini_batch_src_global generation:  0.01707005500793457
r_  generation:  0.20490574836730957
local_output_nid generation:  0.012369871139526367
local_in_edges_tensor generation:  0.007821798324584961
mini_batch_src_global generation:  0.024445533752441406
r_  generation:  0.21402668952941895
----------------------check_connections_block total spend ----------------------------- 0.609757661819458
generate_one_block  0.23380279541015625
generate_one_block  0.23131179809570312
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03176140785217285
gen group dst list time:  0.007982492446899414
time for parepare:  0.020401716232299805
local_output_nid generation:  0.019221067428588867
local_in_edges_tensor generation:  0.03730583190917969
mini_batch_src_global generation:  0.053529977798461914
r_  generation:  0.5258479118347168
local_output_nid generation:  0.02918410301208496
local_in_edges_tensor generation:  0.03468132019042969
mini_batch_src_global generation:  0.061707258224487305
r_  generation:  0.5381453037261963
----------------------check_connections_block total spend ----------------------------- 1.5534474849700928
generate_one_block  0.6765146255493164
generate_one_block  0.6930158138275146
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.019303321838378906
gen group dst list time:  0.012073278427124023
time for parepare:  0.018305540084838867
local_output_nid generation:  0.02326178550720215
local_in_edges_tensor generation:  0.029635190963745117
mini_batch_src_global generation:  0.030920743942260742
r_  generation:  0.3695871829986572
local_output_nid generation:  0.032192230224609375
local_in_edges_tensor generation:  0.02656865119934082
mini_batch_src_global generation:  0.038945674896240234
r_  generation:  0.38074779510498047
----------------------check_connections_block total spend ----------------------------- 1.1211135387420654
generate_one_block  0.45028138160705566
generate_one_block  0.450883150100708
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1601886749267578  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.674561023712158
block generation total time  2.2706949710845947
average batch blocks generation time:  1.1353474855422974
block dataloader generation time/epoch 6.842282645310028
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11472654342651367  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3039798736572266  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11471986770629883  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.308201789855957  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08280658721923828 |0.016210317611694336 |0.004066348075866699 |0.0005010366439819336 |0.0036597251892089844 |0.0013210773468017578 |
----------------------------------------------------------pseudo_mini_loss sum 0.9790692329406738
Total (block generation + training)time/epoch 7.184145592436006
Training time/epoch 0.32569122314453125
Training time without block to device /epoch 0.2932705879211426
Training time without total dataloading part /epoch 0.017775297164916992
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.21it/s]100%|██████████| 4/4 [00:00<00:00, 31.21it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 12.05it/s]100%|██████████| 4/4 [00:00<00:00, 13.08it/s]100%|██████████| 4/4 [00:00<00:00, 12.91it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.86it/s]100%|██████████| 4/4 [00:00<00:00, 18.99it/s]100%|██████████| 4/4 [00:00<00:00, 18.78it/s]
Run 00 | Epoch 00088 | Loss 0.9791 | Train 0.2814 | Val 0.2391 | Test 0.2207
Number of nodes during this epoch:  333878
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16016197204589844  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023482084274291992
range selection method range initialization spend 0.012395381927490234
time for parepare:  0.01811075210571289
local_output_nid generation:  0.010969877243041992
local_in_edges_tensor generation:  0.012166738510131836
mini_batch_src_global generation:  0.017258405685424805
r_  generation:  0.19099068641662598
local_output_nid generation:  0.012824773788452148
local_in_edges_tensor generation:  0.00733494758605957
mini_batch_src_global generation:  0.020702362060546875
r_  generation:  0.2440323829650879
----------------------check_connections_block total spend ----------------------------- 0.6185848712921143
generate_one_block  0.2364795207977295
generate_one_block  0.23035430908203125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.036032915115356445
gen group dst list time:  0.006494998931884766
time for parepare:  0.020615816116333008
local_output_nid generation:  0.018765926361083984
local_in_edges_tensor generation:  0.040677785873413086
mini_batch_src_global generation:  0.054155588150024414
r_  generation:  0.5365653038024902
local_output_nid generation:  0.033118247985839844
local_in_edges_tensor generation:  0.03598499298095703
mini_batch_src_global generation:  0.0619351863861084
r_  generation:  0.5468313694000244
----------------------check_connections_block total spend ----------------------------- 1.5825276374816895
generate_one_block  0.6929726600646973
generate_one_block  0.7094676494598389
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01977086067199707
gen group dst list time:  0.012736320495605469
time for parepare:  0.018459081649780273
local_output_nid generation:  0.025761127471923828
local_in_edges_tensor generation:  0.029048442840576172
mini_batch_src_global generation:  0.03121018409729004
r_  generation:  0.397458553314209
local_output_nid generation:  0.03789234161376953
local_in_edges_tensor generation:  0.03539872169494629
mini_batch_src_global generation:  0.04259848594665527
r_  generation:  0.3857150077819824
----------------------check_connections_block total spend ----------------------------- 1.1797230243682861
generate_one_block  0.45640110969543457
generate_one_block  0.45439887046813965
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16016197204589844  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.7622506618499756
block generation total time  2.3132402896881104
average batch blocks generation time:  1.1566201448440552
block dataloader generation time/epoch 6.843539381027222
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11475038528442383  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.307997226715088  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11468935012817383  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3037385940551758  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08396100997924805 |0.022161006927490234 |0.004187941551208496 |0.0005115270614624023 |0.0038747787475585938 |0.001493215560913086 |
----------------------------------------------------------pseudo_mini_loss sum 0.9789081811904907
Total (block generation + training)time/epoch 7.1853256970644
Training time/epoch 0.33556199073791504
Training time without block to device /epoch 0.29123997688293457
Training time without total dataloading part /epoch 0.01864171028137207
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 51.44it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.37it/s]100%|██████████| 4/4 [00:00<00:00, 16.24it/s]100%|██████████| 4/4 [00:00<00:00, 16.08it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.85it/s]100%|██████████| 4/4 [00:00<00:00, 18.44it/s]100%|██████████| 4/4 [00:00<00:00, 18.33it/s]
Run 00 | Epoch 00089 | Loss 0.9789 | Train 0.2794 | Val 0.2348 | Test 0.2170
Number of nodes during this epoch:  333776
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1601552963256836  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022806167602539062
range selection method range initialization spend 0.013136625289916992
time for parepare:  0.0168302059173584
local_output_nid generation:  0.01112818717956543
local_in_edges_tensor generation:  0.015607357025146484
mini_batch_src_global generation:  0.01871490478515625
r_  generation:  0.22115111351013184
local_output_nid generation:  0.012867450714111328
local_in_edges_tensor generation:  0.007313966751098633
mini_batch_src_global generation:  0.023321866989135742
r_  generation:  0.22175812721252441
----------------------check_connections_block total spend ----------------------------- 0.6346204280853271
generate_one_block  0.23043441772460938
generate_one_block  0.2335662841796875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03289985656738281
gen group dst list time:  0.006460666656494141
time for parepare:  0.01984429359436035
local_output_nid generation:  0.018999338150024414
local_in_edges_tensor generation:  0.032240867614746094
mini_batch_src_global generation:  0.050818443298339844
r_  generation:  0.5433061122894287
local_output_nid generation:  0.029292583465576172
local_in_edges_tensor generation:  0.030928611755371094
mini_batch_src_global generation:  0.06198549270629883
r_  generation:  0.5571634769439697
----------------------check_connections_block total spend ----------------------------- 1.5783863067626953
generate_one_block  0.7001118659973145
generate_one_block  0.7423567771911621
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.020404577255249023
gen group dst list time:  0.012379884719848633
time for parepare:  0.019489526748657227
local_output_nid generation:  0.031184673309326172
local_in_edges_tensor generation:  0.03744626045227051
mini_batch_src_global generation:  0.03366684913635254
r_  generation:  0.39833855628967285
local_output_nid generation:  0.03654670715332031
local_in_edges_tensor generation:  0.03392314910888672
mini_batch_src_global generation:  0.040071964263916016
r_  generation:  0.38649630546569824
----------------------check_connections_block total spend ----------------------------- 1.200685739517212
generate_one_block  0.4796454906463623
generate_one_block  0.4595918655395508
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1601552963256836  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.7790720462799072
block generation total time  2.3817059993743896
average batch blocks generation time:  1.1908529996871948
block dataloader generation time/epoch 6.845906381253843
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11468172073364258  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3080377578735352  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11475610733032227  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3038983345031738  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08669853210449219 |0.022350549697875977 |0.004284977912902832 |0.0005077123641967773 |0.003966569900512695 |0.0029993057250976562 |
----------------------------------------------------------pseudo_mini_loss sum 0.9741845726966858
Total (block generation + training)time/epoch 7.187747001647949
Training time/epoch 0.3460259437561035
Training time without block to device /epoch 0.30132484436035156
Training time without total dataloading part /epoch 0.020517826080322266
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 55.61it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.21it/s]100%|██████████| 4/4 [00:00<00:00, 15.48it/s]100%|██████████| 4/4 [00:00<00:00, 15.42it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.76it/s]100%|██████████| 4/4 [00:00<00:00, 17.22it/s]100%|██████████| 4/4 [00:00<00:00, 17.28it/s]
Run 00 | Epoch 00090 | Loss 0.9742 | Train 0.2777 | Val 0.2321 | Test 0.2141
Number of nodes during this epoch:  333779
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16025924682617188  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020585060119628906
range selection method range initialization spend 0.013478994369506836
time for parepare:  0.015987396240234375
local_output_nid generation:  0.010866880416870117
local_in_edges_tensor generation:  0.010379314422607422
mini_batch_src_global generation:  0.016337156295776367
r_  generation:  0.1932995319366455
local_output_nid generation:  0.01213979721069336
local_in_edges_tensor generation:  0.007151126861572266
mini_batch_src_global generation:  0.020296812057495117
r_  generation:  0.20566582679748535
----------------------check_connections_block total spend ----------------------------- 0.5720927715301514
generate_one_block  0.23357176780700684
generate_one_block  0.23269343376159668
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03750920295715332
gen group dst list time:  0.00666499137878418
time for parepare:  0.020325422286987305
local_output_nid generation:  0.019243717193603516
local_in_edges_tensor generation:  0.036911725997924805
mini_batch_src_global generation:  0.05602741241455078
r_  generation:  0.568157434463501
local_output_nid generation:  0.03339672088623047
local_in_edges_tensor generation:  0.04464459419250488
mini_batch_src_global generation:  0.0650169849395752
r_  generation:  0.5543544292449951
----------------------check_connections_block total spend ----------------------------- 1.6370153427124023
generate_one_block  0.7115573883056641
generate_one_block  0.6950645446777344
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.023242473602294922
gen group dst list time:  0.012152433395385742
time for parepare:  0.01903510093688965
local_output_nid generation:  0.02353668212890625
local_in_edges_tensor generation:  0.04058551788330078
mini_batch_src_global generation:  0.03329205513000488
r_  generation:  0.3751556873321533
local_output_nid generation:  0.03417086601257324
local_in_edges_tensor generation:  0.032546043395996094
mini_batch_src_global generation:  0.04027152061462402
r_  generation:  0.3959674835205078
----------------------check_connections_block total spend ----------------------------- 1.1683998107910156
generate_one_block  0.45882368087768555
generate_one_block  0.4544353485107422
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16025924682617188  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.805415153503418
block generation total time  2.319880962371826
average batch blocks generation time:  1.159940481185913
block dataloader generation time/epoch 6.84678747305056
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11473894119262695  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.304029941558838  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11470937728881836  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3078827857971191  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08464038372039795 |0.01648259162902832 |0.0044019222259521484 |0.0005483627319335938 |0.003577589988708496 |0.001901388168334961 |
----------------------------------------------------------pseudo_mini_loss sum 0.9740433692932129
Total (block generation + training)time/epoch 7.188504117291148
Training time/epoch 0.3315126895904541
Training time without block to device /epoch 0.29854750633239746
Training time without total dataloading part /epoch 0.018957138061523438
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.78it/s]100%|██████████| 4/4 [00:00<00:00, 29.33it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.48it/s]100%|██████████| 4/4 [00:00<00:00, 12.60it/s]100%|██████████| 4/4 [00:00<00:00, 12.41it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.94it/s]100%|██████████| 4/4 [00:00<00:00, 17.96it/s]100%|██████████| 4/4 [00:00<00:00, 17.94it/s]
Run 00 | Epoch 00091 | Loss 0.9740 | Train 0.2765 | Val 0.2298 | Test 0.2110
Number of nodes during this epoch:  333742
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16016578674316406  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02359747886657715
range selection method range initialization spend 0.011772632598876953
time for parepare:  0.01590251922607422
local_output_nid generation:  0.010766744613647461
local_in_edges_tensor generation:  0.009479045867919922
mini_batch_src_global generation:  0.016295433044433594
r_  generation:  0.1903071403503418
local_output_nid generation:  0.011883735656738281
local_in_edges_tensor generation:  0.0068013668060302734
mini_batch_src_global generation:  0.02051067352294922
r_  generation:  0.2035994529724121
----------------------check_connections_block total spend ----------------------------- 0.5647139549255371
generate_one_block  0.2263774871826172
generate_one_block  0.2305910587310791
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04089927673339844
gen group dst list time:  0.00639796257019043
time for parepare:  0.01981949806213379
local_output_nid generation:  0.017995595932006836
local_in_edges_tensor generation:  0.03154301643371582
mini_batch_src_global generation:  0.053255319595336914
r_  generation:  0.531970739364624
local_output_nid generation:  0.02785634994506836
local_in_edges_tensor generation:  0.034234046936035156
mini_batch_src_global generation:  0.06171917915344238
r_  generation:  0.5430393218994141
----------------------check_connections_block total spend ----------------------------- 1.5593655109405518
generate_one_block  0.7295670509338379
generate_one_block  0.6932272911071777
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030157804489135742
gen group dst list time:  0.01450347900390625
time for parepare:  0.017853975296020508
local_output_nid generation:  0.023145437240600586
local_in_edges_tensor generation:  0.03952527046203613
mini_batch_src_global generation:  0.03244924545288086
r_  generation:  0.37621188163757324
local_output_nid generation:  0.0320124626159668
local_in_edges_tensor generation:  0.02820444107055664
mini_batch_src_global generation:  0.039392948150634766
r_  generation:  0.379596471786499
----------------------check_connections_block total spend ----------------------------- 1.1417253017425537
generate_one_block  0.4456498622894287
generate_one_block  0.44493889808654785
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16016578674316406  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.7010908126831055
block generation total time  2.313383102416992
average batch blocks generation time:  1.156691551208496
block dataloader generation time/epoch 6.846029948039227
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11473512649536133  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.303210735321045  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11471891403198242  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3082938194274902  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08719134330749512 |0.01862645149230957 |0.004056692123413086 |0.0005202293395996094 |0.003005385398864746 |0.002975940704345703 |
----------------------------------------------------------pseudo_mini_loss sum 0.9713985919952393
Total (block generation + training)time/epoch 7.187812336956162
Training time/epoch 0.347027063369751
Training time without block to device /epoch 0.30977416038513184
Training time without total dataloading part /epoch 0.018140554428100586
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 52.38it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.26it/s]100%|██████████| 4/4 [00:00<00:00, 15.38it/s]100%|██████████| 4/4 [00:00<00:00, 15.34it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.42it/s]100%|██████████| 4/4 [00:00<00:00, 17.78it/s]100%|██████████| 4/4 [00:00<00:00, 17.71it/s]
Run 00 | Epoch 00092 | Loss 0.9714 | Train 0.2746 | Val 0.2264 | Test 0.2077
Number of nodes during this epoch:  333859
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16014814376831055  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021153688430786133
range selection method range initialization spend 0.012180566787719727
time for parepare:  0.016106128692626953
local_output_nid generation:  0.011170625686645508
local_in_edges_tensor generation:  0.009368181228637695
mini_batch_src_global generation:  0.01635909080505371
r_  generation:  0.19153046607971191
local_output_nid generation:  0.012342453002929688
local_in_edges_tensor generation:  0.0065822601318359375
mini_batch_src_global generation:  0.020593881607055664
r_  generation:  0.208251953125
----------------------check_connections_block total spend ----------------------------- 0.5720722675323486
generate_one_block  0.2284853458404541
generate_one_block  0.22992753982543945
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03920340538024902
gen group dst list time:  0.0064852237701416016
time for parepare:  0.020868539810180664
local_output_nid generation:  0.018788576126098633
local_in_edges_tensor generation:  0.03559064865112305
mini_batch_src_global generation:  0.05177164077758789
r_  generation:  0.5378522872924805
local_output_nid generation:  0.028614044189453125
local_in_edges_tensor generation:  0.030645370483398438
mini_batch_src_global generation:  0.0637509822845459
r_  generation:  0.5602033138275146
----------------------check_connections_block total spend ----------------------------- 1.5884084701538086
generate_one_block  0.7367570400238037
generate_one_block  0.7051486968994141
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.024898290634155273
gen group dst list time:  0.014344930648803711
time for parepare:  0.01817798614501953
local_output_nid generation:  0.024410486221313477
local_in_edges_tensor generation:  0.04141044616699219
mini_batch_src_global generation:  0.03228473663330078
r_  generation:  0.37787675857543945
local_output_nid generation:  0.03336191177368164
local_in_edges_tensor generation:  0.03070545196533203
mini_batch_src_global generation:  0.04004931449890137
r_  generation:  0.38234853744506836
----------------------check_connections_block total spend ----------------------------- 1.1585402488708496
generate_one_block  0.45387887954711914
generate_one_block  0.4582095146179199
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16014814376831055  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.746948719024658
block generation total time  2.353994131088257
average batch blocks generation time:  1.1769970655441284
block dataloader generation time/epoch 6.846390885966165
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11474275588989258  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3077964782714844  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11470174789428711  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3034963607788086  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08749270439147949 |0.01647210121154785 |0.004223227500915527 |0.0005074739456176758 |0.003816366195678711 |0.002014636993408203 |
----------------------------------------------------------pseudo_mini_loss sum 0.9690251350402832
Total (block generation + training)time/epoch 7.188139435790834
Training time/epoch 0.3387923240661621
Training time without block to device /epoch 0.3058481216430664
Training time without total dataloading part /epoch 0.01910877227783203
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 56.04it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.07it/s]100%|██████████| 4/4 [00:00<00:00, 15.22it/s]100%|██████████| 4/4 [00:00<00:00, 15.18it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.09it/s]100%|██████████| 4/4 [00:00<00:00, 17.31it/s]100%|██████████| 4/4 [00:00<00:00, 17.26it/s]
Run 00 | Epoch 00093 | Loss 0.9690 | Train 0.2730 | Val 0.2230 | Test 0.2039
Number of nodes during this epoch:  333729
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.15929412841796875  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02507638931274414
range selection method range initialization spend 0.011888265609741211
time for parepare:  0.016155242919921875
local_output_nid generation:  0.010973215103149414
local_in_edges_tensor generation:  0.009111166000366211
mini_batch_src_global generation:  0.01649618148803711
r_  generation:  0.19394397735595703
local_output_nid generation:  0.012092351913452148
local_in_edges_tensor generation:  0.007120609283447266
mini_batch_src_global generation:  0.021243810653686523
r_  generation:  0.2109389305114746
----------------------check_connections_block total spend ----------------------------- 0.5818016529083252
generate_one_block  0.23241662979125977
generate_one_block  0.24028563499450684
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04613471031188965
gen group dst list time:  0.006735086441040039
time for parepare:  0.02003335952758789
local_output_nid generation:  0.01862788200378418
local_in_edges_tensor generation:  0.037078142166137695
mini_batch_src_global generation:  0.057676076889038086
r_  generation:  0.5630395412445068
local_output_nid generation:  0.03304719924926758
local_in_edges_tensor generation:  0.04459428787231445
mini_batch_src_global generation:  0.06347894668579102
r_  generation:  0.5490701198577881
----------------------check_connections_block total spend ----------------------------- 1.6268415451049805
generate_one_block  0.691215991973877
generate_one_block  0.6941313743591309
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.023009061813354492
gen group dst list time:  0.012243270874023438
time for parepare:  0.01819467544555664
local_output_nid generation:  0.02404952049255371
local_in_edges_tensor generation:  0.03843235969543457
mini_batch_src_global generation:  0.03341078758239746
r_  generation:  0.3729207515716553
local_output_nid generation:  0.03310036659240723
local_in_edges_tensor generation:  0.033608436584472656
mini_batch_src_global generation:  0.0393826961517334
r_  generation:  0.38785624504089355
----------------------check_connections_block total spend ----------------------------- 1.155846357345581
generate_one_block  0.461029052734375
generate_one_block  0.4534173011779785
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.15929412841796875  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.7826879024505615
block generation total time  2.2997937202453613
average batch blocks generation time:  1.1498968601226807
block dataloader generation time/epoch 6.846802156111774
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11469507217407227  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3035016059875488  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11473608016967773  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3087258338928223  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09072184562683105 |0.016834020614624023 |0.004099607467651367 |0.000510096549987793 |0.0032864809036254883 |0.0021719932556152344 |
----------------------------------------------------------pseudo_mini_loss sum 0.9696347713470459
Total (block generation + training)time/epoch 7.188674419066485
Training time/epoch 0.3521099090576172
Training time without block to device /epoch 0.31844186782836914
Training time without total dataloading part /epoch 0.01796436309814453
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 49.43it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.65it/s]100%|██████████| 4/4 [00:00<00:00, 15.28it/s]100%|██████████| 4/4 [00:00<00:00, 15.17it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.99it/s]100%|██████████| 4/4 [00:00<00:00, 17.20it/s]100%|██████████| 4/4 [00:00<00:00, 17.15it/s]
Run 00 | Epoch 00094 | Loss 0.9696 | Train 0.2715 | Val 0.2204 | Test 0.2013
Number of nodes during this epoch:  333814
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16015100479125977  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02060675621032715
range selection method range initialization spend 0.012111902236938477
time for parepare:  0.01587843894958496
local_output_nid generation:  0.010903120040893555
local_in_edges_tensor generation:  0.01204228401184082
mini_batch_src_global generation:  0.016453027725219727
r_  generation:  0.19348907470703125
local_output_nid generation:  0.012017011642456055
local_in_edges_tensor generation:  0.0070879459381103516
mini_batch_src_global generation:  0.021270036697387695
r_  generation:  0.20939230918884277
----------------------check_connections_block total spend ----------------------------- 0.5789592266082764
generate_one_block  0.230027437210083
generate_one_block  0.22926020622253418
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.033277273178100586
gen group dst list time:  0.006396055221557617
time for parepare:  0.02015399932861328
local_output_nid generation:  0.019063949584960938
local_in_edges_tensor generation:  0.030005455017089844
mini_batch_src_global generation:  0.05188918113708496
r_  generation:  0.5402524471282959
local_output_nid generation:  0.028269052505493164
local_in_edges_tensor generation:  0.031064271926879883
mini_batch_src_global generation:  0.06277036666870117
r_  generation:  0.5549919605255127
----------------------check_connections_block total spend ----------------------------- 1.5749211311340332
generate_one_block  0.7283525466918945
generate_one_block  0.6986863613128662
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.027090787887573242
gen group dst list time:  0.014360904693603516
time for parepare:  0.01813483238220215
local_output_nid generation:  0.023632526397705078
local_in_edges_tensor generation:  0.040378570556640625
mini_batch_src_global generation:  0.032723426818847656
r_  generation:  0.37409543991088867
local_output_nid generation:  0.032834529876708984
local_in_edges_tensor generation:  0.031235694885253906
mini_batch_src_global generation:  0.039934396743774414
r_  generation:  0.38205957412719727
----------------------check_connections_block total spend ----------------------------- 1.1511294841766357
generate_one_block  0.45194029808044434
generate_one_block  0.4523491859436035
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16015100479125977  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.726050615310669
block generation total time  2.3313283920288086
average batch blocks generation time:  1.1656641960144043
block dataloader generation time/epoch 6.846616897472115
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11478471755981445  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.309091567993164  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11466836929321289  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3042588233947754  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08270037174224854 |0.0174257755279541 |0.004365205764770508 |0.0005393028259277344 |0.003595113754272461 |0.00144195556640625 |
----------------------------------------------------------pseudo_mini_loss sum 0.9646471738815308
Total (block generation + training)time/epoch 7.188335224639538
Training time/epoch 0.3284780979156494
Training time without block to device /epoch 0.2936265468597412
Training time without total dataloading part /epoch 0.018441200256347656
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 51.71it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.21it/s]100%|██████████| 4/4 [00:00<00:00, 15.28it/s]100%|██████████| 4/4 [00:00<00:00, 15.26it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.95it/s]100%|██████████| 4/4 [00:00<00:00, 17.43it/s]100%|██████████| 4/4 [00:00<00:00, 17.33it/s]
Run 00 | Epoch 00095 | Loss 0.9646 | Train 0.2692 | Val 0.2163 | Test 0.1969
Number of nodes during this epoch:  333862
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1600937843322754  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019006967544555664
range selection method range initialization spend 0.012143850326538086
time for parepare:  0.01615118980407715
local_output_nid generation:  0.010906219482421875
local_in_edges_tensor generation:  0.009100914001464844
mini_batch_src_global generation:  0.016347646713256836
r_  generation:  0.1913139820098877
local_output_nid generation:  0.012106895446777344
local_in_edges_tensor generation:  0.008945941925048828
mini_batch_src_global generation:  0.02086472511291504
r_  generation:  0.2039046287536621
----------------------check_connections_block total spend ----------------------------- 0.5697979927062988
generate_one_block  0.23020482063293457
generate_one_block  0.2307114601135254
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.034188270568847656
gen group dst list time:  0.006549835205078125
time for parepare:  0.02018904685974121
local_output_nid generation:  0.021303653717041016
local_in_edges_tensor generation:  0.03109598159790039
mini_batch_src_global generation:  0.05205178260803223
r_  generation:  0.5412347316741943
local_output_nid generation:  0.02934122085571289
local_in_edges_tensor generation:  0.030239105224609375
mini_batch_src_global generation:  0.06416010856628418
r_  generation:  0.5593576431274414
----------------------check_connections_block total spend ----------------------------- 1.592658519744873
generate_one_block  0.7342872619628906
generate_one_block  0.6977028846740723
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.027842998504638672
gen group dst list time:  0.014465093612670898
time for parepare:  0.018173694610595703
local_output_nid generation:  0.025432586669921875
local_in_edges_tensor generation:  0.03862619400024414
mini_batch_src_global generation:  0.03226590156555176
r_  generation:  0.3809030055999756
local_output_nid generation:  0.03257274627685547
local_in_edges_tensor generation:  0.02703857421875
mini_batch_src_global generation:  0.04009437561035156
r_  generation:  0.38678717613220215
----------------------check_connections_block total spend ----------------------------- 1.1579580307006836
generate_one_block  0.4515538215637207
generate_one_block  0.45563793182373047
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1600937843322754  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.7506165504455566
block generation total time  2.339181900024414
average batch blocks generation time:  1.169590950012207
block dataloader generation time/epoch 6.846849430566547
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11475992202758789  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3085637092590332  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11469697952270508  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3076744079589844  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08784615993499756 |0.018319129943847656 |0.004081130027770996 |0.0005211830139160156 |0.003091573715209961 |0.0014300346374511719 |
----------------------------------------------------------pseudo_mini_loss sum 0.9661061763763428
Total (block generation + training)time/epoch 7.18865859919581
Training time/epoch 0.3494584560394287
Training time without block to device /epoch 0.3128201961517334
Training time without total dataloading part /epoch 0.016817808151245117
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 53.34it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.82it/s]100%|██████████| 4/4 [00:00<00:00, 15.43it/s]100%|██████████| 4/4 [00:00<00:00, 15.32it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.38it/s]100%|██████████| 4/4 [00:00<00:00, 17.52it/s]100%|██████████| 4/4 [00:00<00:00, 17.48it/s]
Run 00 | Epoch 00096 | Loss 0.9661 | Train 0.2666 | Val 0.2120 | Test 0.1933
Number of nodes during this epoch:  333801
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1592540740966797  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021150588989257812
range selection method range initialization spend 0.012008428573608398
time for parepare:  0.016054868698120117
local_output_nid generation:  0.010914802551269531
local_in_edges_tensor generation:  0.009092092514038086
mini_batch_src_global generation:  0.016433238983154297
r_  generation:  0.19442057609558105
local_output_nid generation:  0.012082099914550781
local_in_edges_tensor generation:  0.006511211395263672
mini_batch_src_global generation:  0.020859956741333008
r_  generation:  0.20667219161987305
----------------------check_connections_block total spend ----------------------------- 0.5733060836791992
generate_one_block  0.23008298873901367
generate_one_block  0.23128843307495117
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03345632553100586
gen group dst list time:  0.006390094757080078
time for parepare:  0.020019054412841797
local_output_nid generation:  0.018505096435546875
local_in_edges_tensor generation:  0.03224468231201172
mini_batch_src_global generation:  0.0517573356628418
r_  generation:  0.5464563369750977
local_output_nid generation:  0.029315710067749023
local_in_edges_tensor generation:  0.03525567054748535
mini_batch_src_global generation:  0.06267881393432617
r_  generation:  0.5624778270721436
----------------------check_connections_block total spend ----------------------------- 1.6018002033233643
generate_one_block  0.7141776084899902
generate_one_block  0.701467752456665
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025299787521362305
gen group dst list time:  0.014106512069702148
time for parepare:  0.01866745948791504
local_output_nid generation:  0.023910999298095703
local_in_edges_tensor generation:  0.04331612586975098
mini_batch_src_global generation:  0.034448862075805664
r_  generation:  0.37438130378723145
local_output_nid generation:  0.03221273422241211
local_in_edges_tensor generation:  0.028562307357788086
mini_batch_src_global generation:  0.039862632751464844
r_  generation:  0.37944531440734863
----------------------check_connections_block total spend ----------------------------- 1.149343729019165
generate_one_block  0.4514503479003906
generate_one_block  0.4517195224761963
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1592540740966797  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.7511439323425293
block generation total time  2.318815231323242
average batch blocks generation time:  1.159407615661621
block dataloader generation time/epoch 6.846829490228132
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.1147465705871582  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3077936172485352  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11471033096313477  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3035073280334473  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08958935737609863 |0.017565369606018066 |0.004071593284606934 |0.0005174875259399414 |0.0033648014068603516 |0.0013616085052490234 |
----------------------------------------------------------pseudo_mini_loss sum 0.9632437229156494
Total (block generation + training)time/epoch 7.18867369944399
Training time/epoch 0.34471869468688965
Training time without block to device /epoch 0.3095879554748535
Training time without total dataloading part /epoch 0.017269372940063477
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.12it/s]100%|██████████| 4/4 [00:00<00:00, 29.77it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.50it/s]100%|██████████| 4/4 [00:00<00:00, 12.61it/s]100%|██████████| 4/4 [00:00<00:00, 12.42it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.33it/s]100%|██████████| 4/4 [00:00<00:00, 17.26it/s]100%|██████████| 4/4 [00:00<00:00, 17.25it/s]
Run 00 | Epoch 00097 | Loss 0.9632 | Train 0.2642 | Val 0.2083 | Test 0.1898
Number of nodes during this epoch:  333688
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16019773483276367  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020039081573486328
range selection method range initialization spend 0.01206350326538086
time for parepare:  0.016063213348388672
local_output_nid generation:  0.011022567749023438
local_in_edges_tensor generation:  0.009900569915771484
mini_batch_src_global generation:  0.016427278518676758
r_  generation:  0.19091200828552246
local_output_nid generation:  0.012089252471923828
local_in_edges_tensor generation:  0.0063436031341552734
mini_batch_src_global generation:  0.02161264419555664
r_  generation:  0.20494484901428223
----------------------check_connections_block total spend ----------------------------- 0.569324254989624
generate_one_block  0.2291867733001709
generate_one_block  0.23028278350830078
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03346610069274902
gen group dst list time:  0.006395816802978516
time for parepare:  0.03498244285583496
local_output_nid generation:  0.034290313720703125
local_in_edges_tensor generation:  0.03623652458190918
mini_batch_src_global generation:  0.05490612983703613
r_  generation:  0.5403802394866943
local_output_nid generation:  0.03415203094482422
local_in_edges_tensor generation:  0.0366666316986084
mini_batch_src_global generation:  0.06202840805053711
r_  generation:  0.5542607307434082
----------------------check_connections_block total spend ----------------------------- 1.6290910243988037
generate_one_block  0.73697829246521
generate_one_block  0.6995422840118408
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.021562814712524414
gen group dst list time:  0.014431238174438477
time for parepare:  0.017917633056640625
local_output_nid generation:  0.0238955020904541
local_in_edges_tensor generation:  0.04443550109863281
mini_batch_src_global generation:  0.033803701400756836
r_  generation:  0.3751718997955322
local_output_nid generation:  0.03199028968811035
local_in_edges_tensor generation:  0.030873537063598633
mini_batch_src_global generation:  0.040704965591430664
r_  generation:  0.3809788227081299
----------------------check_connections_block total spend ----------------------------- 1.157017469406128
generate_one_block  0.4509258270263672
generate_one_block  0.45148420333862305
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16019773483276367  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.7861084938049316
block generation total time  2.338930606842041
average batch blocks generation time:  1.1694653034210205
block dataloader generation time/epoch 6.847328944152661
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11473512649536133  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.307896614074707  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11470174789428711  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.302504539489746  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08544731140136719 |0.017752647399902344 |0.004204273223876953 |0.0005191564559936523 |0.0038999319076538086 |0.0013763904571533203 |
----------------------------------------------------------pseudo_mini_loss sum 0.9622091054916382
Total (block generation + training)time/epoch 7.189079930273334
Training time/epoch 0.3334052562713623
Training time without block to device /epoch 0.2978999614715576
Training time without total dataloading part /epoch 0.01862311363220215
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.39it/s]100%|██████████| 4/4 [00:00<00:00, 29.95it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.62it/s]100%|██████████| 4/4 [00:00<00:00, 12.62it/s]100%|██████████| 4/4 [00:00<00:00, 12.45it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.46it/s]100%|██████████| 4/4 [00:00<00:00, 17.71it/s]100%|██████████| 4/4 [00:00<00:00, 17.65it/s]
Run 00 | Epoch 00098 | Loss 0.9622 | Train 0.2630 | Val 0.2059 | Test 0.1870
Number of nodes during this epoch:  333717
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16022443771362305  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019457340240478516
range selection method range initialization spend 0.011939287185668945
time for parepare:  0.016355037689208984
local_output_nid generation:  0.010823726654052734
local_in_edges_tensor generation:  0.009075403213500977
mini_batch_src_global generation:  0.01626420021057129
r_  generation:  0.19205307960510254
local_output_nid generation:  0.01218104362487793
local_in_edges_tensor generation:  0.0072116851806640625
mini_batch_src_global generation:  0.020802021026611328
r_  generation:  0.20864152908325195
----------------------check_connections_block total spend ----------------------------- 0.57578444480896
generate_one_block  0.23334407806396484
generate_one_block  0.23830246925354004
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03727364540100098
gen group dst list time:  0.006558418273925781
time for parepare:  0.01990056037902832
local_output_nid generation:  0.019269943237304688
local_in_edges_tensor generation:  0.034546613693237305
mini_batch_src_global generation:  0.052069902420043945
r_  generation:  0.5474004745483398
local_output_nid generation:  0.029412031173706055
local_in_edges_tensor generation:  0.0430750846862793
mini_batch_src_global generation:  0.07034659385681152
r_  generation:  0.5606679916381836
----------------------check_connections_block total spend ----------------------------- 1.616513967514038
generate_one_block  0.6969165802001953
generate_one_block  0.7009048461914062
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02312445640563965
gen group dst list time:  0.013184309005737305
time for parepare:  0.018206357955932617
local_output_nid generation:  0.023674964904785156
local_in_edges_tensor generation:  0.04143190383911133
mini_batch_src_global generation:  0.0352017879486084
r_  generation:  0.3732583522796631
local_output_nid generation:  0.03238821029663086
local_in_edges_tensor generation:  0.031548500061035156
mini_batch_src_global generation:  0.04025578498840332
r_  generation:  0.3795623779296875
----------------------check_connections_block total spend ----------------------------- 1.1498920917510986
generate_one_block  0.45464086532592773
generate_one_block  0.4509732723236084
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.16022443771362305  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

connection checking time:  2.7664060592651367
block generation total time  2.3034355640411377
average batch blocks generation time:  1.1517177820205688
block dataloader generation time/epoch 6.8473860952589245
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11471700668334961  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3084826469421387  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 0.11471128463745117  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5057373046875 GB
    Memory Allocated: 1.3022618293762207  GigaBytes
Max Memory Allocated: 1.5769124031066895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08794128894805908 |0.016799569129943848 |0.00413823127746582 |0.0005124807357788086 |0.003882169723510742 |0.0012764930725097656 |
----------------------------------------------------------pseudo_mini_loss sum 0.9559592604637146
Total (block generation + training)time/epoch 7.189063183466593
Training time/epoch 0.3349480628967285
Training time without block to device /epoch 0.3013489246368408
Training time without total dataloading part /epoch 0.018342256546020508
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 56.63it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.27it/s]100%|██████████| 4/4 [00:00<00:00, 15.28it/s]100%|██████████| 4/4 [00:00<00:00, 15.26it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.30it/s]100%|██████████| 4/4 [00:00<00:00, 17.45it/s]100%|██████████| 4/4 [00:00<00:00, 17.41it/s]
Run 00 | Epoch 00099 | Loss 0.9560 | Train 0.2630 | Val 0.2047 | Test 0.1851
Number of nodes during this epoch:  333774
The number of model layers:  3
Run 01:
Highest Train: 44.37
Highest Valid: 52.32
  Final Train: 44.37
   Final Test: 53.36
The number of model layers:  3
All runs:
Highest Train: 44.37 ± nan
Highest Valid: 52.32 ± nan
  Final Train: 44.37 ± nan
   Final Test: 53.36 ± nan
