Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1647069342.409957
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019000530242919922
range selection method range initialization spend 0.01306915283203125
time for parepare:  0.017771244049072266
local_output_nid generation:  0.010991096496582031
local_in_edges_tensor generation:  0.007952451705932617
mini_batch_src_global generation:  0.009212732315063477
r_  generation:  0.1320486068725586
local_output_nid generation:  0.011887788772583008
local_in_edges_tensor generation:  0.0054318904876708984
mini_batch_src_global generation:  0.012392282485961914
r_  generation:  0.14391708374023438
----------------------check_connections_block total spend ----------------------------- 0.4059572219848633
generate_one_block  0.1561286449432373
generate_one_block  0.16090893745422363
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03685164451599121
gen group dst list time:  0.0067903995513916016
time for parepare:  0.01963067054748535
local_output_nid generation:  0.015246868133544922
local_in_edges_tensor generation:  0.03460431098937988
mini_batch_src_global generation:  0.03656935691833496
r_  generation:  0.410106897354126
local_output_nid generation:  0.02258443832397461
local_in_edges_tensor generation:  0.03817009925842285
mini_batch_src_global generation:  0.04489541053771973
r_  generation:  0.4303727149963379
----------------------check_connections_block total spend ----------------------------- 1.235788345336914
generate_one_block  0.5380144119262695
generate_one_block  0.5373940467834473
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02422642707824707
gen group dst list time:  0.01130819320678711
time for parepare:  0.018808603286743164
local_output_nid generation:  0.02187824249267578
local_in_edges_tensor generation:  0.030726909637451172
mini_batch_src_global generation:  0.03005528450012207
r_  generation:  0.37151622772216797
local_output_nid generation:  0.030372142791748047
local_in_edges_tensor generation:  0.0371248722076416
mini_batch_src_global generation:  0.03713107109069824
r_  generation:  0.39884352684020996
----------------------check_connections_block total spend ----------------------------- 1.1416680812835693
generate_one_block  0.4821033477783203
generate_one_block  0.46547794342041016
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  2.3774564266204834
block generation total time  2.0229897499084473
average batch blocks generation time:  1.0114948749542236
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1815185546875 GB
    Memory Allocated: 0.09928178787231445  GigaBytes
Max Memory Allocated: 0.09928178787231445  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7537841796875 GB
    Memory Allocated: 1.2044529914855957  GigaBytes
Max Memory Allocated: 1.3049135208129883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 0.10652732849121094  GigaBytes
Max Memory Allocated: 1.4357175827026367  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 1.205671787261963  GigaBytes
Max Memory Allocated: 1.4357175827026367  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04906952381134033 |0.15420055389404297 |0.4030272960662842 |0.0006002187728881836 |0.026494860649108887 |0.0019659996032714844 |
----------------------------------------------------------pseudo_mini_loss sum 6.044898986816406
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.95it/s]100%|██████████| 4/4 [00:00<00:00, 25.24it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.19it/s]100%|██████████| 4/4 [00:00<00:00, 11.62it/s]100%|██████████| 4/4 [00:00<00:00, 11.55it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.63it/s]100%|██████████| 4/4 [00:00<00:00, 17.33it/s]100%|██████████| 4/4 [00:00<00:00, 17.21it/s]
Run 00 | Epoch 00000 | Loss 6.0449 | Train 0.2953 | Val 0.3144 | Test 0.2902
Number of nodes during this epoch:  329392
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.3631591796875 GB
    Memory Allocated: 0.14336776733398438  GigaBytes
Max Memory Allocated: 1.4367194175720215  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.047356605529785156
range selection method range initialization spend 0.013631820678710938
time for parepare:  0.020815372467041016
local_output_nid generation:  0.010530471801757812
local_in_edges_tensor generation:  0.025196075439453125
mini_batch_src_global generation:  0.009731769561767578
r_  generation:  0.13649630546569824
local_output_nid generation:  0.012533903121948242
local_in_edges_tensor generation:  0.010341644287109375
mini_batch_src_global generation:  0.012455224990844727
r_  generation:  0.14991497993469238
----------------------check_connections_block total spend ----------------------------- 0.4437825679779053
generate_one_block  0.1532607078552246
generate_one_block  0.15483427047729492
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06427121162414551
gen group dst list time:  0.006758451461791992
time for parepare:  0.019135475158691406
local_output_nid generation:  0.015003204345703125
local_in_edges_tensor generation:  0.04560256004333496
mini_batch_src_global generation:  0.03634309768676758
r_  generation:  0.4062364101409912
local_output_nid generation:  0.02266240119934082
local_in_edges_tensor generation:  0.03796219825744629
mini_batch_src_global generation:  0.045244455337524414
r_  generation:  0.4304485321044922
----------------------check_connections_block total spend ----------------------------- 1.2427690029144287
generate_one_block  0.5335476398468018
generate_one_block  0.5478663444519043
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05715823173522949
gen group dst list time:  0.011922836303710938
time for parepare:  0.01897287368774414
local_output_nid generation:  0.0218355655670166
local_in_edges_tensor generation:  0.03246736526489258
mini_batch_src_global generation:  0.030716419219970703
r_  generation:  0.3771507740020752
local_output_nid generation:  0.031100034713745117
local_in_edges_tensor generation:  0.0335540771484375
mini_batch_src_global generation:  0.038004159927368164
r_  generation:  0.37970495223999023
----------------------check_connections_block total spend ----------------------------- 1.1285817623138428
generate_one_block  0.4593522548675537
generate_one_block  0.46202874183654785
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.3631591796875 GB
    Memory Allocated: 0.14336776733398438  GigaBytes
Max Memory Allocated: 1.4367194175720215  GigaBytes

connection checking time:  2.3713507652282715
block generation total time  2.0027949810028076
average batch blocks generation time:  1.0013974905014038
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3631591796875 GB
    Memory Allocated: 0.10930204391479492  GigaBytes
Max Memory Allocated: 1.4367194175720215  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3631591796875 GB
    Memory Allocated: 1.2082090377807617  GigaBytes
Max Memory Allocated: 1.4367194175720215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3631591796875 GB
    Memory Allocated: 0.10855293273925781  GigaBytes
Max Memory Allocated: 1.43873929977417  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3631591796875 GB
    Memory Allocated: 1.207521915435791  GigaBytes
Max Memory Allocated: 1.43873929977417  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08332252502441406 |0.01278996467590332 |0.004107952117919922 |0.0005418062210083008 |0.003354787826538086 |0.0014171600341796875 |
----------------------------------------------------------pseudo_mini_loss sum 3.2197742462158203
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.06it/s]100%|██████████| 4/4 [00:00<00:00, 27.58it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.19it/s]100%|██████████| 4/4 [00:00<00:00, 11.76it/s]100%|██████████| 4/4 [00:00<00:00, 11.66it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.58it/s]100%|██████████| 4/4 [00:00<00:00, 17.90it/s]100%|██████████| 4/4 [00:00<00:00, 17.83it/s]
Run 00 | Epoch 00001 | Loss 3.2198 | Train 0.3185 | Val 0.3533 | Test 0.4004
Number of nodes during this epoch:  329239
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.3631591796875 GB
    Memory Allocated: 0.1434636116027832  GigaBytes
Max Memory Allocated: 1.43873929977417  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024119853973388672
range selection method range initialization spend 0.013690471649169922
time for parepare:  0.017870426177978516
local_output_nid generation:  0.011242389678955078
local_in_edges_tensor generation:  0.009590387344360352
mini_batch_src_global generation:  0.009981393814086914
r_  generation:  0.13736605644226074
local_output_nid generation:  0.011663436889648438
local_in_edges_tensor generation:  0.007183551788330078
mini_batch_src_global generation:  0.01491093635559082
r_  generation:  0.14606785774230957
----------------------check_connections_block total spend ----------------------------- 0.42265963554382324
generate_one_block  0.15756988525390625
generate_one_block  0.16359877586364746
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03642463684082031
gen group dst list time:  0.007032155990600586
time for parepare:  0.02213120460510254
local_output_nid generation:  0.016235828399658203
local_in_edges_tensor generation:  0.03154277801513672
mini_batch_src_global generation:  0.03842353820800781
r_  generation:  0.4322929382324219
local_output_nid generation:  0.028728485107421875
local_in_edges_tensor generation:  0.03537154197692871
mini_batch_src_global generation:  0.04903006553649902
r_  generation:  0.4381704330444336
----------------------check_connections_block total spend ----------------------------- 1.2944049835205078
generate_one_block  0.535334587097168
generate_one_block  0.5385715961456299
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028161287307739258
gen group dst list time:  0.012171745300292969
time for parepare:  0.019548892974853516
local_output_nid generation:  0.02172398567199707
local_in_edges_tensor generation:  0.039488792419433594
mini_batch_src_global generation:  0.030635595321655273
r_  generation:  0.3790900707244873
local_output_nid generation:  0.03273463249206543
local_in_edges_tensor generation:  0.030417680740356445
mini_batch_src_global generation:  0.04057812690734863
r_  generation:  0.39121270179748535
----------------------check_connections_block total spend ----------------------------- 1.1523818969726562
generate_one_block  0.48726630210876465
generate_one_block  0.4653360843658447
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.3631591796875 GB
    Memory Allocated: 0.1434636116027832  GigaBytes
Max Memory Allocated: 1.43873929977417  GigaBytes

connection checking time:  2.446786880493164
block generation total time  2.0265085697174072
average batch blocks generation time:  1.0132542848587036
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3631591796875 GB
    Memory Allocated: 0.10857915878295898  GigaBytes
Max Memory Allocated: 1.43873929977417  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3631591796875 GB
    Memory Allocated: 1.2072882652282715  GigaBytes
Max Memory Allocated: 1.43873929977417  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3631591796875 GB
    Memory Allocated: 0.10888671875  GigaBytes
Max Memory Allocated: 1.43873929977417  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3631591796875 GB
    Memory Allocated: 1.2075328826904297  GigaBytes
Max Memory Allocated: 1.43873929977417  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08351826667785645 |0.01389455795288086 |0.004197835922241211 |0.0005338191986083984 |0.0038979053497314453 |0.0015375614166259766 |
----------------------------------------------------------pseudo_mini_loss sum 2.6278388500213623
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 66.22it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.39it/s]100%|██████████| 4/4 [00:00<00:00, 16.49it/s]100%|██████████| 4/4 [00:00<00:00, 16.60it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.42it/s]100%|██████████| 4/4 [00:00<00:00, 17.86it/s]100%|██████████| 4/4 [00:00<00:00, 17.77it/s]
Run 00 | Epoch 00002 | Loss 2.6278 | Train 0.3144 | Val 0.3228 | Test 0.3751
Number of nodes during this epoch:  329158
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.3631591796875 GB
    Memory Allocated: 0.1444716453552246  GigaBytes
Max Memory Allocated: 1.4388413429260254  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018859148025512695
range selection method range initialization spend 0.01273345947265625
time for parepare:  0.021941661834716797
local_output_nid generation:  0.012347936630249023
local_in_edges_tensor generation:  0.01213526725769043
mini_batch_src_global generation:  0.009611129760742188
r_  generation:  0.13518476486206055
local_output_nid generation:  0.012726545333862305
local_in_edges_tensor generation:  0.00879669189453125
mini_batch_src_global generation:  0.012708663940429688
r_  generation:  0.14502859115600586
----------------------check_connections_block total spend ----------------------------- 0.4265296459197998
generate_one_block  0.15115904808044434
generate_one_block  0.15512609481811523
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.032113075256347656
gen group dst list time:  0.006543397903442383
time for parepare:  0.02057170867919922
local_output_nid generation:  0.016268014907836914
local_in_edges_tensor generation:  0.03643798828125
mini_batch_src_global generation:  0.03684425354003906
r_  generation:  0.4172210693359375
local_output_nid generation:  0.023856401443481445
local_in_edges_tensor generation:  0.029178142547607422
mini_batch_src_global generation:  0.047998905181884766
r_  generation:  0.4301919937133789
----------------------check_connections_block total spend ----------------------------- 1.2439210414886475
generate_one_block  0.5328507423400879
generate_one_block  0.5351443290710449
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.019515037536621094
gen group dst list time:  0.011341333389282227
time for parepare:  0.019556522369384766
local_output_nid generation:  0.022586345672607422
local_in_edges_tensor generation:  0.03056812286376953
mini_batch_src_global generation:  0.032189130783081055
r_  generation:  0.3790147304534912
local_output_nid generation:  0.03442978858947754
local_in_edges_tensor generation:  0.033472299575805664
mini_batch_src_global generation:  0.037705183029174805
r_  generation:  0.3852963447570801
----------------------check_connections_block total spend ----------------------------- 1.1407718658447266
generate_one_block  0.4803733825683594
generate_one_block  0.46189165115356445
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.3631591796875 GB
    Memory Allocated: 0.1444716453552246  GigaBytes
Max Memory Allocated: 1.4388413429260254  GigaBytes

connection checking time:  2.384692907333374
block generation total time  2.0102601051330566
average batch blocks generation time:  1.0051300525665283
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3631591796875 GB
    Memory Allocated: 0.10879659652709961  GigaBytes
Max Memory Allocated: 1.4388413429260254  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3651123046875 GB
    Memory Allocated: 1.2079887390136719  GigaBytes
Max Memory Allocated: 1.4388413429260254  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3651123046875 GB
    Memory Allocated: 0.10889339447021484  GigaBytes
Max Memory Allocated: 1.4388413429260254  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3651123046875 GB
    Memory Allocated: 1.2076878547668457  GigaBytes
Max Memory Allocated: 1.4388413429260254  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.045256972312927246 |0.0186007022857666 |0.004287600517272949 |0.0005172491073608398 |0.03823566436767578 |0.001399993896484375 |
----------------------------------------------------------pseudo_mini_loss sum 2.4039783477783203
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 44.48it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.96it/s]100%|██████████| 4/4 [00:00<00:00, 15.89it/s]100%|██████████| 4/4 [00:00<00:00, 15.88it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.66it/s]100%|██████████| 4/4 [00:00<00:00, 17.80it/s]100%|██████████| 4/4 [00:00<00:00, 17.76it/s]
Run 00 | Epoch 00003 | Loss 2.4040 | Train 0.4434 | Val 0.5079 | Test 0.5266
Number of nodes during this epoch:  329380
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.3651123046875 GB
    Memory Allocated: 0.14408349990844727  GigaBytes
Max Memory Allocated: 1.4390454292297363  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023148059844970703
range selection method range initialization spend 0.012246847152709961
time for parepare:  0.016875743865966797
local_output_nid generation:  0.010631322860717773
local_in_edges_tensor generation:  0.018511056900024414
mini_batch_src_global generation:  0.00955057144165039
r_  generation:  0.1344280242919922
local_output_nid generation:  0.011771917343139648
local_in_edges_tensor generation:  0.00544428825378418
mini_batch_src_global generation:  0.01291656494140625
r_  generation:  0.14348173141479492
----------------------check_connections_block total spend ----------------------------- 0.41845130920410156
generate_one_block  0.1537926197052002
generate_one_block  0.15371417999267578
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.035195350646972656
gen group dst list time:  0.006575107574462891
time for parepare:  0.01952075958251953
local_output_nid generation:  0.01649165153503418
local_in_edges_tensor generation:  0.04246878623962402
mini_batch_src_global generation:  0.03665280342102051
r_  generation:  0.4156162738800049
local_output_nid generation:  0.024285554885864258
local_in_edges_tensor generation:  0.026224851608276367
mini_batch_src_global generation:  0.046402931213378906
r_  generation:  0.4320404529571533
----------------------check_connections_block total spend ----------------------------- 1.2448492050170898
generate_one_block  0.5472116470336914
generate_one_block  0.5354487895965576
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0203859806060791
gen group dst list time:  0.013412237167358398
time for parepare:  0.01950669288635254
local_output_nid generation:  0.02246403694152832
local_in_edges_tensor generation:  0.03925490379333496
mini_batch_src_global generation:  0.029811382293701172
r_  generation:  0.3696119785308838
local_output_nid generation:  0.030640125274658203
local_in_edges_tensor generation:  0.03748345375061035
mini_batch_src_global generation:  0.03770136833190918
r_  generation:  0.37874937057495117
----------------------check_connections_block total spend ----------------------------- 1.127939224243164
generate_one_block  0.465545654296875
generate_one_block  0.4565548896789551
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.3651123046875 GB
    Memory Allocated: 0.14408349990844727  GigaBytes
Max Memory Allocated: 1.4390454292297363  GigaBytes

connection checking time:  2.372788429260254
block generation total time  2.004760980606079
average batch blocks generation time:  1.0023804903030396
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3651123046875 GB
    Memory Allocated: 0.10859155654907227  GigaBytes
Max Memory Allocated: 1.4390454292297363  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3651123046875 GB
    Memory Allocated: 1.2076449394226074  GigaBytes
Max Memory Allocated: 1.4390454292297363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3651123046875 GB
    Memory Allocated: 0.10895872116088867  GigaBytes
Max Memory Allocated: 1.4390454292297363  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3651123046875 GB
    Memory Allocated: 1.208195686340332  GigaBytes
Max Memory Allocated: 1.4390454292297363  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08043992519378662 |0.013852715492248535 |0.004187464714050293 |0.0005142688751220703 |0.03378486633300781 |0.002981901168823242 |
----------------------------------------------------------pseudo_mini_loss sum 2.119993209838867
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 52.59it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.81it/s]100%|██████████| 4/4 [00:00<00:00, 13.74it/s]100%|██████████| 4/4 [00:00<00:00, 13.88it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.54it/s]100%|██████████| 4/4 [00:00<00:00, 16.31it/s]100%|██████████| 4/4 [00:00<00:00, 16.00it/s]
Run 00 | Epoch 00004 | Loss 2.1200 | Train 0.4427 | Val 0.4475 | Test 0.4312
Number of nodes during this epoch:  329423
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.3651123046875 GB
    Memory Allocated: 0.14362573623657227  GigaBytes
Max Memory Allocated: 1.4390454292297363  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01242685317993164
range selection method range initialization spend 0.012836456298828125
time for parepare:  0.017593860626220703
local_output_nid generation:  0.011960506439208984
local_in_edges_tensor generation:  0.011337757110595703
mini_batch_src_global generation:  0.00994253158569336
r_  generation:  0.13869595527648926
local_output_nid generation:  0.012010335922241211
local_in_edges_tensor generation:  0.006319284439086914
mini_batch_src_global generation:  0.012783527374267578
r_  generation:  0.14531159400939941
----------------------check_connections_block total spend ----------------------------- 0.4213523864746094
generate_one_block  0.1521134376525879
generate_one_block  0.1541440486907959
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.034017324447631836
gen group dst list time:  0.0066492557525634766
time for parepare:  0.01959991455078125
local_output_nid generation:  0.015920400619506836
local_in_edges_tensor generation:  0.04001641273498535
mini_batch_src_global generation:  0.03784370422363281
r_  generation:  0.41423630714416504
local_output_nid generation:  0.022801637649536133
local_in_edges_tensor generation:  0.023760080337524414
mini_batch_src_global generation:  0.04789161682128906
r_  generation:  0.4304640293121338
----------------------check_connections_block total spend ----------------------------- 1.2352824211120605
generate_one_block  0.5368695259094238
generate_one_block  0.5207865238189697
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01976633071899414
gen group dst list time:  0.01164865493774414
time for parepare:  0.019289493560791016
local_output_nid generation:  0.021802902221679688
local_in_edges_tensor generation:  0.03206968307495117
mini_batch_src_global generation:  0.03027939796447754
r_  generation:  0.3727378845214844
local_output_nid generation:  0.03050971031188965
local_in_edges_tensor generation:  0.028863191604614258
mini_batch_src_global generation:  0.03781461715698242
r_  generation:  0.37999725341796875
----------------------check_connections_block total spend ----------------------------- 1.115530014038086
generate_one_block  0.4500908851623535
generate_one_block  0.4554417133331299
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.3651123046875 GB
    Memory Allocated: 0.14362573623657227  GigaBytes
Max Memory Allocated: 1.4390454292297363  GigaBytes

connection checking time:  2.3508124351501465
block generation total time  1.963188648223877
average batch blocks generation time:  0.9815943241119385
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3651123046875 GB
    Memory Allocated: 0.10874080657958984  GigaBytes
Max Memory Allocated: 1.4390454292297363  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3651123046875 GB
    Memory Allocated: 1.207707405090332  GigaBytes
Max Memory Allocated: 1.4390454292297363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3651123046875 GB
    Memory Allocated: 0.10887575149536133  GigaBytes
Max Memory Allocated: 1.4390454292297363  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3651123046875 GB
    Memory Allocated: 1.207550048828125  GigaBytes
Max Memory Allocated: 1.4390454292297363  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08152413368225098 |0.014159679412841797 |0.004062652587890625 |0.0005155801773071289 |0.0037734508514404297 |0.0013997554779052734 |
----------------------------------------------------------pseudo_mini_loss sum 1.9790345430374146
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 49.96it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.14it/s]100%|██████████| 4/4 [00:00<00:00, 15.43it/s]100%|██████████| 4/4 [00:00<00:00, 15.37it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.50it/s]100%|██████████| 4/4 [00:00<00:00, 17.67it/s]100%|██████████| 4/4 [00:00<00:00, 17.62it/s]
Run 00 | Epoch 00005 | Loss 1.9790 | Train 0.4379 | Val 0.4291 | Test 0.4000
Number of nodes during this epoch:  329347
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.3651123046875 GB
    Memory Allocated: 0.14429283142089844  GigaBytes
Max Memory Allocated: 1.4390454292297363  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018752336502075195
range selection method range initialization spend 0.01221609115600586
time for parepare:  0.020210742950439453
local_output_nid generation:  0.01060628890991211
local_in_edges_tensor generation:  0.007942914962768555
mini_batch_src_global generation:  0.013747453689575195
r_  generation:  0.13727712631225586
local_output_nid generation:  0.012983322143554688
local_in_edges_tensor generation:  0.005491733551025391
mini_batch_src_global generation:  0.018108606338500977
r_  generation:  0.1439378261566162
----------------------check_connections_block total spend ----------------------------- 0.4266476631164551
generate_one_block  0.15247368812561035
generate_one_block  0.1520826816558838
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.033410072326660156
gen group dst list time:  0.006628990173339844
time for parepare:  0.019887924194335938
local_output_nid generation:  0.015573978424072266
local_in_edges_tensor generation:  0.03493833541870117
mini_batch_src_global generation:  0.037987470626831055
r_  generation:  0.40997743606567383
local_output_nid generation:  0.021915197372436523
local_in_edges_tensor generation:  0.02906012535095215
mini_batch_src_global generation:  0.04947018623352051
r_  generation:  0.42714834213256836
----------------------check_connections_block total spend ----------------------------- 1.2281081676483154
generate_one_block  0.5286366939544678
generate_one_block  0.5236248970031738
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.021210670471191406
gen group dst list time:  0.011500358581542969
time for parepare:  0.0194857120513916
local_output_nid generation:  0.02257370948791504
local_in_edges_tensor generation:  0.028673887252807617
mini_batch_src_global generation:  0.02988266944885254
r_  generation:  0.37142276763916016
local_output_nid generation:  0.030452728271484375
local_in_edges_tensor generation:  0.027334928512573242
mini_batch_src_global generation:  0.037467241287231445
r_  generation:  0.3788912296295166
----------------------check_connections_block total spend ----------------------------- 1.110238790512085
generate_one_block  0.4473147392272949
generate_one_block  0.45439577102661133
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.3651123046875 GB
    Memory Allocated: 0.14429283142089844  GigaBytes
Max Memory Allocated: 1.4390454292297363  GigaBytes

connection checking time:  2.3383469581604004
block generation total time  1.9539721012115479
average batch blocks generation time:  0.9769860506057739
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3651123046875 GB
    Memory Allocated: 0.10876798629760742  GigaBytes
Max Memory Allocated: 1.4390454292297363  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3651123046875 GB
    Memory Allocated: 1.2088837623596191  GigaBytes
Max Memory Allocated: 1.4390454292297363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3651123046875 GB
    Memory Allocated: 0.1089315414428711  GigaBytes
Max Memory Allocated: 1.4395904541015625  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3651123046875 GB
    Memory Allocated: 1.2081990242004395  GigaBytes
Max Memory Allocated: 1.4395904541015625  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08086156845092773 |0.01202535629272461 |0.004149317741394043 |0.0005507469177246094 |0.034270644187927246 |0.0028018951416015625 |
----------------------------------------------------------pseudo_mini_loss sum 1.8882180452346802
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 57.02it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.31it/s]100%|██████████| 4/4 [00:00<00:00, 15.47it/s]100%|██████████| 4/4 [00:00<00:00, 15.43it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.44it/s]100%|██████████| 4/4 [00:00<00:00, 17.72it/s]100%|██████████| 4/4 [00:00<00:00, 17.66it/s]
Run 00 | Epoch 00006 | Loss 1.8882 | Train 0.4325 | Val 0.4319 | Test 0.4031
Number of nodes during this epoch:  329444
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.3651123046875 GB
    Memory Allocated: 0.14358806610107422  GigaBytes
Max Memory Allocated: 1.4395904541015625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01333308219909668
range selection method range initialization spend 0.012108802795410156
time for parepare:  0.018181562423706055
local_output_nid generation:  0.010499715805053711
local_in_edges_tensor generation:  0.007680654525756836
mini_batch_src_global generation:  0.009652853012084961
r_  generation:  0.13466835021972656
local_output_nid generation:  0.011886835098266602
local_in_edges_tensor generation:  0.005334138870239258
mini_batch_src_global generation:  0.012661933898925781
r_  generation:  0.14378070831298828
----------------------check_connections_block total spend ----------------------------- 0.4086117744445801
generate_one_block  0.1512744426727295
generate_one_block  0.15365982055664062
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.025669574737548828
gen group dst list time:  0.007093906402587891
time for parepare:  0.023778438568115234
local_output_nid generation:  0.01664280891418457
local_in_edges_tensor generation:  0.027750492095947266
mini_batch_src_global generation:  0.03656148910522461
r_  generation:  0.41226959228515625
local_output_nid generation:  0.0224153995513916
local_in_edges_tensor generation:  0.023267507553100586
mini_batch_src_global generation:  0.048883676528930664
r_  generation:  0.4251527786254883
----------------------check_connections_block total spend ----------------------------- 1.2197186946868896
generate_one_block  0.5185966491699219
generate_one_block  0.5170149803161621
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.019415616989135742
gen group dst list time:  0.011743545532226562
time for parepare:  0.0190122127532959
local_output_nid generation:  0.02211308479309082
local_in_edges_tensor generation:  0.035129547119140625
mini_batch_src_global generation:  0.03056025505065918
r_  generation:  0.3710966110229492
local_output_nid generation:  0.0305173397064209
local_in_edges_tensor generation:  0.03461170196533203
mini_batch_src_global generation:  0.03760576248168945
r_  generation:  0.38674235343933105
----------------------check_connections_block total spend ----------------------------- 1.1306512355804443
generate_one_block  0.44543027877807617
generate_one_block  0.4599480628967285
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.3651123046875 GB
    Memory Allocated: 0.14358806610107422  GigaBytes
Max Memory Allocated: 1.4395904541015625  GigaBytes

connection checking time:  2.350369930267334
block generation total time  1.9409899711608887
average batch blocks generation time:  0.9704949855804443
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3651123046875 GB
    Memory Allocated: 0.10879039764404297  GigaBytes
Max Memory Allocated: 1.4395904541015625  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3651123046875 GB
    Memory Allocated: 1.2076301574707031  GigaBytes
Max Memory Allocated: 1.4395904541015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3651123046875 GB
    Memory Allocated: 0.10894584655761719  GigaBytes
Max Memory Allocated: 1.4395904541015625  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3651123046875 GB
    Memory Allocated: 1.2087230682373047  GigaBytes
Max Memory Allocated: 1.4395904541015625  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0788801908493042 |0.022935986518859863 |0.014243006706237793 |0.0004912614822387695 |0.0037746429443359375 |0.0028243064880371094 |
----------------------------------------------------------pseudo_mini_loss sum 1.8066470623016357
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 57.17it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.94it/s]100%|██████████| 4/4 [00:00<00:00, 15.45it/s]100%|██████████| 4/4 [00:00<00:00, 15.35it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.70it/s]100%|██████████| 4/4 [00:00<00:00, 17.88it/s]100%|██████████| 4/4 [00:00<00:00, 17.83it/s]
Run 00 | Epoch 00007 | Loss 1.8066 | Train 0.4340 | Val 0.4541 | Test 0.4310
Number of nodes during this epoch:  329407
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.3651123046875 GB
    Memory Allocated: 0.14403963088989258  GigaBytes
Max Memory Allocated: 1.4399876594543457  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01344609260559082
range selection method range initialization spend 0.012044906616210938
time for parepare:  0.0172882080078125
local_output_nid generation:  0.0106048583984375
local_in_edges_tensor generation:  0.011080741882324219
mini_batch_src_global generation:  0.010167837142944336
r_  generation:  0.13429617881774902
local_output_nid generation:  0.011569738388061523
local_in_edges_tensor generation:  0.005362272262573242
mini_batch_src_global generation:  0.012810468673706055
r_  generation:  0.14632534980773926
----------------------check_connections_block total spend ----------------------------- 0.41486454010009766
generate_one_block  0.149810791015625
generate_one_block  0.15419435501098633
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030314207077026367
gen group dst list time:  0.006659030914306641
time for parepare:  0.019772052764892578
local_output_nid generation:  0.01632523536682129
local_in_edges_tensor generation:  0.02757740020751953
mini_batch_src_global generation:  0.036370277404785156
r_  generation:  0.41818881034851074
local_output_nid generation:  0.022875308990478516
local_in_edges_tensor generation:  0.023845434188842773
mini_batch_src_global generation:  0.04795479774475098
r_  generation:  0.4328911304473877
----------------------check_connections_block total spend ----------------------------- 1.2269017696380615
generate_one_block  0.5248875617980957
generate_one_block  0.5263910293579102
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01917409896850586
gen group dst list time:  0.01260066032409668
time for parepare:  0.019248247146606445
local_output_nid generation:  0.023453712463378906
local_in_edges_tensor generation:  0.030602455139160156
mini_batch_src_global generation:  0.03058624267578125
r_  generation:  0.3795607089996338
local_output_nid generation:  0.031293392181396484
local_in_edges_tensor generation:  0.026674985885620117
mini_batch_src_global generation:  0.037775516510009766
r_  generation:  0.3875560760498047
----------------------check_connections_block total spend ----------------------------- 1.1361563205718994
generate_one_block  0.4669520854949951
generate_one_block  0.4506974220275879
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.3651123046875 GB
    Memory Allocated: 0.14403963088989258  GigaBytes
Max Memory Allocated: 1.4399876594543457  GigaBytes

connection checking time:  2.363058090209961
block generation total time  1.9689280986785889
average batch blocks generation time:  0.9844640493392944
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3651123046875 GB
    Memory Allocated: 0.10842180252075195  GigaBytes
Max Memory Allocated: 1.4399876594543457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3651123046875 GB
    Memory Allocated: 1.2066092491149902  GigaBytes
Max Memory Allocated: 1.4399876594543457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3651123046875 GB
    Memory Allocated: 0.1089324951171875  GigaBytes
Max Memory Allocated: 1.4399876594543457  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6053466796875 GB
    Memory Allocated: 1.2105636596679688  GigaBytes
Max Memory Allocated: 1.4399876594543457  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08265495300292969 |0.018206477165222168 |0.01745140552520752 |0.0004957914352416992 |0.0041838884353637695 |0.0017631053924560547 |
----------------------------------------------------------pseudo_mini_loss sum 1.7209504842758179
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 53.36it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.97it/s]100%|██████████| 4/4 [00:00<00:00, 15.12it/s]100%|██████████| 4/4 [00:00<00:00, 15.08it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.52it/s]100%|██████████| 4/4 [00:00<00:00, 18.01it/s]100%|██████████| 4/4 [00:00<00:00, 17.92it/s]
Run 00 | Epoch 00008 | Loss 1.7210 | Train 0.4427 | Val 0.4922 | Test 0.4809
Number of nodes during this epoch:  329219
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1449432373046875  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.012484550476074219
range selection method range initialization spend 0.011858224868774414
time for parepare:  0.017190933227539062
local_output_nid generation:  0.010509729385375977
local_in_edges_tensor generation:  0.009522438049316406
mini_batch_src_global generation:  0.009817123413085938
r_  generation:  0.13327813148498535
local_output_nid generation:  0.012310266494750977
local_in_edges_tensor generation:  0.005250215530395508
mini_batch_src_global generation:  0.012624979019165039
r_  generation:  0.1440441608428955
----------------------check_connections_block total spend ----------------------------- 0.4100151062011719
generate_one_block  0.15079760551452637
generate_one_block  0.15448665618896484
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.026300430297851562
gen group dst list time:  0.006571292877197266
time for parepare:  0.019881010055541992
local_output_nid generation:  0.017072677612304688
local_in_edges_tensor generation:  0.02945876121520996
mini_batch_src_global generation:  0.03850674629211426
r_  generation:  0.40903282165527344
local_output_nid generation:  0.02426934242248535
local_in_edges_tensor generation:  0.025960445404052734
mini_batch_src_global generation:  0.045828819274902344
r_  generation:  0.4255239963531494
----------------------check_connections_block total spend ----------------------------- 1.2165768146514893
generate_one_block  0.5196020603179932
generate_one_block  0.5190253257751465
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.018777132034301758
gen group dst list time:  0.012524127960205078
time for parepare:  0.01923227310180664
local_output_nid generation:  0.02188587188720703
local_in_edges_tensor generation:  0.028409481048583984
mini_batch_src_global generation:  0.030208826065063477
r_  generation:  0.372333288192749
local_output_nid generation:  0.03585696220397949
local_in_edges_tensor generation:  0.02713775634765625
mini_batch_src_global generation:  0.03779149055480957
r_  generation:  0.38388967514038086
----------------------check_connections_block total spend ----------------------------- 1.123504877090454
generate_one_block  0.44985508918762207
generate_one_block  0.4545154571533203
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1449432373046875  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.3400816917419434
block generation total time  1.942997932434082
average batch blocks generation time:  0.971498966217041
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10920143127441406  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.207263469696045  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1088724136352539  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2078461647033691  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0859231948852539 |0.021079540252685547 |0.0037734508514404297 |0.0004967451095581055 |0.0030155181884765625 |0.0017507076263427734 |
----------------------------------------------------------pseudo_mini_loss sum 1.6478793621063232
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 49.48it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.86it/s]100%|██████████| 4/4 [00:00<00:00, 15.49it/s]100%|██████████| 4/4 [00:00<00:00, 15.38it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.67it/s]100%|██████████| 4/4 [00:00<00:00, 17.87it/s]100%|██████████| 4/4 [00:00<00:00, 17.82it/s]
Run 00 | Epoch 00009 | Loss 1.6479 | Train 0.4560 | Val 0.5257 | Test 0.5245
Number of nodes during this epoch:  329254
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14481258392333984  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01227259635925293
range selection method range initialization spend 0.012214422225952148
time for parepare:  0.01756763458251953
local_output_nid generation:  0.011037588119506836
local_in_edges_tensor generation:  0.01522517204284668
mini_batch_src_global generation:  0.009834527969360352
r_  generation:  0.13683319091796875
local_output_nid generation:  0.011799812316894531
local_in_edges_tensor generation:  0.005388498306274414
mini_batch_src_global generation:  0.012521743774414062
r_  generation:  0.14401888847351074
----------------------check_connections_block total spend ----------------------------- 0.41947174072265625
generate_one_block  0.15371036529541016
generate_one_block  0.15316081047058105
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028244972229003906
gen group dst list time:  0.0065882205963134766
time for parepare:  0.019780397415161133
local_output_nid generation:  0.015635967254638672
local_in_edges_tensor generation:  0.0363917350769043
mini_batch_src_global generation:  0.03859710693359375
r_  generation:  0.4165232181549072
local_output_nid generation:  0.02323746681213379
local_in_edges_tensor generation:  0.02262282371520996
mini_batch_src_global generation:  0.045584678649902344
r_  generation:  0.4204280376434326
----------------------check_connections_block total spend ----------------------------- 1.2196474075317383
generate_one_block  0.5156633853912354
generate_one_block  0.5163016319274902
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.018447399139404297
gen group dst list time:  0.011753320693969727
time for parepare:  0.019356250762939453
local_output_nid generation:  0.021898508071899414
local_in_edges_tensor generation:  0.03130912780761719
mini_batch_src_global generation:  0.029706239700317383
r_  generation:  0.3729429244995117
local_output_nid generation:  0.03193187713623047
local_in_edges_tensor generation:  0.02735614776611328
mini_batch_src_global generation:  0.03707718849182129
r_  generation:  0.3862111568450928
----------------------check_connections_block total spend ----------------------------- 1.1209137439727783
generate_one_block  0.4520261287689209
generate_one_block  0.44701409339904785
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14481258392333984  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.3405611515045166
block generation total time  1.9310052394866943
average batch blocks generation time:  0.9655026197433472
block dataloader generation time/epoch 5.667971611022949
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10903692245483398  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.209787368774414  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10917854309082031  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2068657875061035  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04465150833129883 |0.011922478675842285 |0.004089832305908203 |0.0005362033843994141 |0.038167595863342285 |0.001397848129272461 |
----------------------------------------------------------pseudo_mini_loss sum 1.6043301820755005
Total (block generation + training)time/epoch 5.9659388065338135
Training time/epoch 0.29781556129455566
Training time without block to device /epoch 0.2739706039428711
Training time without total dataloading part /epoch 0.08698511123657227
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 60.80it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.25it/s]100%|██████████| 4/4 [00:00<00:00, 15.60it/s]100%|██████████| 4/4 [00:00<00:00, 15.53it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.72it/s]100%|██████████| 4/4 [00:00<00:00, 18.14it/s]100%|██████████| 4/4 [00:00<00:00, 18.06it/s]
Run 00 | Epoch 00010 | Loss 1.6043 | Train 0.4648 | Val 0.5345 | Test 0.5330
Number of nodes during this epoch:  329399
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14406776428222656  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01349329948425293
range selection method range initialization spend 0.011744260787963867
time for parepare:  0.017446041107177734
local_output_nid generation:  0.0111846923828125
local_in_edges_tensor generation:  0.007733345031738281
mini_batch_src_global generation:  0.009868860244750977
r_  generation:  0.1576521396636963
local_output_nid generation:  0.013985395431518555
local_in_edges_tensor generation:  0.005688190460205078
mini_batch_src_global generation:  0.014548540115356445
r_  generation:  0.15570425987243652
----------------------check_connections_block total spend ----------------------------- 0.45362043380737305
generate_one_block  0.16658687591552734
generate_one_block  0.1670536994934082
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.027165889739990234
gen group dst list time:  0.007401943206787109
time for parepare:  0.021479368209838867
local_output_nid generation:  0.018505334854125977
local_in_edges_tensor generation:  0.02893996238708496
mini_batch_src_global generation:  0.04021739959716797
r_  generation:  0.42574524879455566
local_output_nid generation:  0.02813553810119629
local_in_edges_tensor generation:  0.028081417083740234
mini_batch_src_global generation:  0.04826712608337402
r_  generation:  0.4337460994720459
----------------------check_connections_block total spend ----------------------------- 1.2668616771697998
generate_one_block  0.5497746467590332
generate_one_block  0.5479331016540527
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01873636245727539
gen group dst list time:  0.012312889099121094
time for parepare:  0.0213320255279541
local_output_nid generation:  0.024178504943847656
local_in_edges_tensor generation:  0.03240489959716797
mini_batch_src_global generation:  0.03201484680175781
r_  generation:  0.39176321029663086
local_output_nid generation:  0.0379946231842041
local_in_edges_tensor generation:  0.03867459297180176
mini_batch_src_global generation:  0.04217267036437988
r_  generation:  0.40271735191345215
----------------------check_connections_block total spend ----------------------------- 1.203181505203247
generate_one_block  0.46363282203674316
generate_one_block  0.4761350154876709
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14406776428222656  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.470043182373047
block generation total time  2.0374755859375
average batch blocks generation time:  1.01873779296875
block dataloader generation time/epoch 5.814602971076965
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10932016372680664  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.208254337310791  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10858726501464844  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2073984146118164  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0838017463684082 |0.01950705051422119 |0.004019737243652344 |0.0005217790603637695 |0.0036197900772094727 |0.0014367103576660156 |
----------------------------------------------------------pseudo_mini_loss sum 1.554487705230713
Total (block generation + training)time/epoch 6.1257511377334595
Training time/epoch 0.3241841793060303
Training time without block to device /epoch 0.2851700782775879
Training time without total dataloading part /epoch 0.017759323120117188
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 60.32it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.92it/s]100%|██████████| 4/4 [00:00<00:00, 16.50it/s]100%|██████████| 4/4 [00:00<00:00, 16.40it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.98it/s]100%|██████████| 4/4 [00:00<00:00, 19.94it/s]
Run 00 | Epoch 00011 | Loss 1.5545 | Train 0.4634 | Val 0.5291 | Test 0.5230
Number of nodes during this epoch:  329403
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14371156692504883  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.014117240905761719
range selection method range initialization spend 0.011725902557373047
time for parepare:  0.018324613571166992
local_output_nid generation:  0.010645389556884766
local_in_edges_tensor generation:  0.00839996337890625
mini_batch_src_global generation:  0.010033130645751953
r_  generation:  0.13194561004638672
local_output_nid generation:  0.012455463409423828
local_in_edges_tensor generation:  0.006338357925415039
mini_batch_src_global generation:  0.012841939926147461
r_  generation:  0.1449415683746338
----------------------check_connections_block total spend ----------------------------- 0.4115009307861328
generate_one_block  0.15165162086486816
generate_one_block  0.1548302173614502
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.026021242141723633
gen group dst list time:  0.006677389144897461
time for parepare:  0.019910812377929688
local_output_nid generation:  0.01599597930908203
local_in_edges_tensor generation:  0.033005475997924805
mini_batch_src_global generation:  0.03690958023071289
r_  generation:  0.4208106994628906
local_output_nid generation:  0.02297186851501465
local_in_edges_tensor generation:  0.030654191970825195
mini_batch_src_global generation:  0.04543924331665039
r_  generation:  0.43284010887145996
----------------------check_connections_block total spend ----------------------------- 1.2407987117767334
generate_one_block  0.5323810577392578
generate_one_block  0.5360000133514404
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.020296573638916016
gen group dst list time:  0.013177871704101562
time for parepare:  0.023254871368408203
local_output_nid generation:  0.025899887084960938
local_in_edges_tensor generation:  0.04221987724304199
mini_batch_src_global generation:  0.030103445053100586
r_  generation:  0.3734862804412842
local_output_nid generation:  0.03209996223449707
local_in_edges_tensor generation:  0.031617164611816406
mini_batch_src_global generation:  0.04099464416503906
r_  generation:  0.38472437858581543
----------------------check_connections_block total spend ----------------------------- 1.1487176418304443
generate_one_block  0.45415329933166504
generate_one_block  0.44736766815185547
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14371156692504883  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.3895163536071777
block generation total time  1.9699020385742188
average batch blocks generation time:  0.9849510192871094
block dataloader generation time/epoch 5.809741894404094
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10896062850952148  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2073369026184082  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10857725143432617  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2075128555297852  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0766139030456543 |0.016192197799682617 |0.005330920219421387 |0.0006358623504638672 |0.0035789012908935547 |0.0027167797088623047 |
----------------------------------------------------------pseudo_mini_loss sum 1.5194926261901855
Total (block generation + training)time/epoch 6.117138783137004
Training time/epoch 0.2997448444366455
Training time without block to device /epoch 0.2673604488372803
Training time without total dataloading part /epoch 0.021808147430419922
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 53.97it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.83it/s]100%|██████████| 4/4 [00:00<00:00, 15.27it/s]100%|██████████| 4/4 [00:00<00:00, 15.19it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.01it/s]100%|██████████| 4/4 [00:00<00:00, 18.47it/s]100%|██████████| 4/4 [00:00<00:00, 18.38it/s]
Run 00 | Epoch 00012 | Loss 1.5195 | Train 0.4532 | Val 0.5206 | Test 0.5128
Number of nodes during this epoch:  329306
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14366626739501953  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.014009475708007812
range selection method range initialization spend 0.01168513298034668
time for parepare:  0.01738572120666504
local_output_nid generation:  0.010803461074829102
local_in_edges_tensor generation:  0.010970830917358398
mini_batch_src_global generation:  0.009836435317993164
r_  generation:  0.1325089931488037
local_output_nid generation:  0.011946678161621094
local_in_edges_tensor generation:  0.00531458854675293
mini_batch_src_global generation:  0.012583732604980469
r_  generation:  0.14138412475585938
----------------------check_connections_block total spend ----------------------------- 0.40763115882873535
generate_one_block  0.14971590042114258
generate_one_block  0.15381503105163574
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02690434455871582
gen group dst list time:  0.00657343864440918
time for parepare:  0.0208742618560791
local_output_nid generation:  0.016683578491210938
local_in_edges_tensor generation:  0.026622772216796875
mini_batch_src_global generation:  0.03717470169067383
r_  generation:  0.4416329860687256
local_output_nid generation:  0.025627613067626953
local_in_edges_tensor generation:  0.034810543060302734
mini_batch_src_global generation:  0.04892230033874512
r_  generation:  0.42975282669067383
----------------------check_connections_block total spend ----------------------------- 1.2669899463653564
generate_one_block  0.5279667377471924
generate_one_block  0.5237150192260742
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.020314931869506836
gen group dst list time:  0.011688232421875
time for parepare:  0.018911361694335938
local_output_nid generation:  0.021625757217407227
local_in_edges_tensor generation:  0.032698631286621094
mini_batch_src_global generation:  0.029759883880615234
r_  generation:  0.37236881256103516
local_output_nid generation:  0.0308682918548584
local_in_edges_tensor generation:  0.025976181030273438
mini_batch_src_global generation:  0.03735637664794922
r_  generation:  0.37738680839538574
----------------------check_connections_block total spend ----------------------------- 1.1088976860046387
generate_one_block  0.44534826278686523
generate_one_block  0.45625901222229004
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14366626739501953  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.375887632369995
block generation total time  1.9532890319824219
average batch blocks generation time:  0.9766445159912109
block dataloader generation time/epoch 5.786699116230011
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10895872116088867  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2074942588806152  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10857391357421875  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2081260681152344  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08966565132141113 |0.021162748336791992 |0.004004955291748047 |0.0005308389663696289 |0.0028896331787109375 |0.0017752647399902344 |
----------------------------------------------------------pseudo_mini_loss sum 1.4882453680038452
Total (block generation + training)time/epoch 6.101547539234161
Training time/epoch 0.33705949783325195
Training time without block to device /epoch 0.29473400115966797
Training time without total dataloading part /epoch 0.01662611961364746
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 50.37it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.57it/s]100%|██████████| 4/4 [00:00<00:00, 15.74it/s]100%|██████████| 4/4 [00:00<00:00, 15.70it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.01it/s]100%|██████████| 4/4 [00:00<00:00, 18.15it/s]100%|██████████| 4/4 [00:00<00:00, 18.11it/s]
Run 00 | Epoch 00013 | Loss 1.4882 | Train 0.4436 | Val 0.5197 | Test 0.5139
Number of nodes during this epoch:  329348
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14404869079589844  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.014770984649658203
range selection method range initialization spend 0.012181282043457031
time for parepare:  0.016610145568847656
local_output_nid generation:  0.01064610481262207
local_in_edges_tensor generation:  0.013130426406860352
mini_batch_src_global generation:  0.00987553596496582
r_  generation:  0.1343543529510498
local_output_nid generation:  0.011887788772583008
local_in_edges_tensor generation:  0.006116628646850586
mini_batch_src_global generation:  0.01271820068359375
r_  generation:  0.1413407325744629
----------------------check_connections_block total spend ----------------------------- 0.4116816520690918
generate_one_block  0.1581268310546875
generate_one_block  0.15278148651123047
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02836298942565918
gen group dst list time:  0.006401538848876953
time for parepare:  0.019843101501464844
local_output_nid generation:  0.016168832778930664
local_in_edges_tensor generation:  0.02948737144470215
mini_batch_src_global generation:  0.03640103340148926
r_  generation:  0.4059884548187256
local_output_nid generation:  0.02344536781311035
local_in_edges_tensor generation:  0.024727582931518555
mini_batch_src_global generation:  0.04535198211669922
r_  generation:  0.4183506965637207
----------------------check_connections_block total spend ----------------------------- 1.199601650238037
generate_one_block  0.5113227367401123
generate_one_block  0.512265682220459
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0215909481048584
gen group dst list time:  0.01163029670715332
time for parepare:  0.018996477127075195
local_output_nid generation:  0.02173018455505371
local_in_edges_tensor generation:  0.029408931732177734
mini_batch_src_global generation:  0.02954888343811035
r_  generation:  0.3701927661895752
local_output_nid generation:  0.029973745346069336
local_in_edges_tensor generation:  0.025998830795288086
mini_batch_src_global generation:  0.037204742431640625
r_  generation:  0.3761754035949707
----------------------check_connections_block total spend ----------------------------- 1.1008942127227783
generate_one_block  0.444683313369751
generate_one_block  0.4448530673980713
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14404869079589844  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.3004958629608154
block generation total time  1.9131247997283936
average batch blocks generation time:  0.9565623998641968
block dataloader generation time/epoch 5.755147266387939
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10897397994995117  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2077956199645996  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10850906372070312  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2067432403564453  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07982540130615234 |0.012740135192871094 |0.0039937496185302734 |0.0005077123641967773 |0.003801584243774414 |0.0012979507446289062 |
----------------------------------------------------------pseudo_mini_loss sum 1.4538604021072388
Total (block generation + training)time/epoch 6.0667296886444095
Training time/epoch 0.298398494720459
Training time without block to device /epoch 0.2729182243347168
Training time without total dataloading part /epoch 0.017904043197631836
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 55.94it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.06it/s]100%|██████████| 4/4 [00:00<00:00, 15.62it/s]100%|██████████| 4/4 [00:00<00:00, 15.52it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.93it/s]100%|██████████| 4/4 [00:00<00:00, 17.67it/s]100%|██████████| 4/4 [00:00<00:00, 17.54it/s]
Run 00 | Epoch 00014 | Loss 1.4539 | Train 0.4321 | Val 0.5230 | Test 0.5243
Number of nodes during this epoch:  329283
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14434099197387695  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.013821125030517578
range selection method range initialization spend 0.011708259582519531
time for parepare:  0.01664113998413086
local_output_nid generation:  0.010859012603759766
local_in_edges_tensor generation:  0.011531829833984375
mini_batch_src_global generation:  0.009697437286376953
r_  generation:  0.13448548316955566
local_output_nid generation:  0.011916160583496094
local_in_edges_tensor generation:  0.005634307861328125
mini_batch_src_global generation:  0.012403488159179688
r_  generation:  0.14467620849609375
----------------------check_connections_block total spend ----------------------------- 0.4124429225921631
generate_one_block  0.1494147777557373
generate_one_block  0.1514573097229004
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.026477336883544922
gen group dst list time:  0.006432533264160156
time for parepare:  0.01948714256286621
local_output_nid generation:  0.015726566314697266
local_in_edges_tensor generation:  0.02650284767150879
mini_batch_src_global generation:  0.03761577606201172
r_  generation:  0.40360093116760254
local_output_nid generation:  0.021802425384521484
local_in_edges_tensor generation:  0.027324438095092773
mini_batch_src_global generation:  0.04612445831298828
r_  generation:  0.41752123832702637
----------------------check_connections_block total spend ----------------------------- 1.1955108642578125
generate_one_block  0.5156409740447998
generate_one_block  0.5225586891174316
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.018352270126342773
gen group dst list time:  0.01168060302734375
time for parepare:  0.019047021865844727
local_output_nid generation:  0.021360397338867188
local_in_edges_tensor generation:  0.0283663272857666
mini_batch_src_global generation:  0.02950906753540039
r_  generation:  0.3681001663208008
local_output_nid generation:  0.030194520950317383
local_in_edges_tensor generation:  0.03181624412536621
mini_batch_src_global generation:  0.037192583084106445
r_  generation:  0.3757157325744629
----------------------check_connections_block total spend ----------------------------- 1.1020636558532715
generate_one_block  0.4425842761993408
generate_one_block  0.44715118408203125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14434099197387695  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.297574520111084
block generation total time  1.9279351234436035
average batch blocks generation time:  0.9639675617218018
block dataloader generation time/epoch 5.73024042447408
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10894060134887695  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2070822715759277  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10857963562011719  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2081842422485352  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07815718650817871 |0.011252522468566895 |0.004024147987365723 |0.0005244016647338867 |0.003371715545654297 |0.0013628005981445312 |
----------------------------------------------------------pseudo_mini_loss sum 1.4157772064208984
Total (block generation + training)time/epoch 6.0394428968429565
Training time/epoch 0.2971620559692383
Training time without block to device /epoch 0.2746570110321045
Training time without total dataloading part /epoch 0.017203330993652344
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 59.37it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.88it/s]100%|██████████| 4/4 [00:00<00:00, 15.29it/s]100%|██████████| 4/4 [00:00<00:00, 15.22it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.90it/s]100%|██████████| 4/4 [00:00<00:00, 17.37it/s]100%|██████████| 4/4 [00:00<00:00, 17.28it/s]
Run 00 | Epoch 00015 | Loss 1.4158 | Train 0.4115 | Val 0.5211 | Test 0.5337
Number of nodes during this epoch:  329199
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14402151107788086  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.013534307479858398
range selection method range initialization spend 0.011841297149658203
time for parepare:  0.016623497009277344
local_output_nid generation:  0.01050114631652832
local_in_edges_tensor generation:  0.00808858871459961
mini_batch_src_global generation:  0.009735584259033203
r_  generation:  0.13163995742797852
local_output_nid generation:  0.012133359909057617
local_in_edges_tensor generation:  0.0052340030670166016
mini_batch_src_global generation:  0.012470006942749023
r_  generation:  0.14290714263916016
----------------------check_connections_block total spend ----------------------------- 0.4039328098297119
generate_one_block  0.1485602855682373
generate_one_block  0.15094423294067383
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02856159210205078
gen group dst list time:  0.0065212249755859375
time for parepare:  0.019603967666625977
local_output_nid generation:  0.016317367553710938
local_in_edges_tensor generation:  0.02546215057373047
mini_batch_src_global generation:  0.03647184371948242
r_  generation:  0.41199469566345215
local_output_nid generation:  0.022377967834472656
local_in_edges_tensor generation:  0.02286839485168457
mini_batch_src_global generation:  0.04527473449707031
r_  generation:  0.4185311794281006
----------------------check_connections_block total spend ----------------------------- 1.1980977058410645
generate_one_block  0.5139613151550293
generate_one_block  0.5134475231170654
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.019074201583862305
gen group dst list time:  0.011680126190185547
time for parepare:  0.019099950790405273
local_output_nid generation:  0.022524595260620117
local_in_edges_tensor generation:  0.02826404571533203
mini_batch_src_global generation:  0.030097484588623047
r_  generation:  0.3686072826385498
local_output_nid generation:  0.030681133270263672
local_in_edges_tensor generation:  0.03038763999938965
mini_batch_src_global generation:  0.037328481674194336
r_  generation:  0.4142637252807617
----------------------check_connections_block total spend ----------------------------- 1.1481590270996094
generate_one_block  0.45058178901672363
generate_one_block  0.44608139991760254
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14402151107788086  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.346256732940674
block generation total time  1.924072027206421
average batch blocks generation time:  0.9620360136032104
block dataloader generation time/epoch 5.718186753136771
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10900259017944336  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2075204849243164  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10858821868896484  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.208052635192871  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07614946365356445 |0.012187600135803223 |0.0038328170776367188 |0.0005125999450683594 |0.003584623336791992 |0.0012934207916259766 |
----------------------------------------------------------pseudo_mini_loss sum 1.3928557634353638
Total (block generation + training)time/epoch 6.024620601109096
Training time/epoch 0.28974294662475586
Training time without block to device /epoch 0.2653677463531494
Training time without total dataloading part /epoch 0.017153501510620117
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 66.52it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.60it/s]100%|██████████| 4/4 [00:00<00:00, 15.63it/s]100%|██████████| 4/4 [00:00<00:00, 15.61it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.69it/s]100%|██████████| 4/4 [00:00<00:00, 17.99it/s]100%|██████████| 4/4 [00:00<00:00, 17.92it/s]
Run 00 | Epoch 00016 | Loss 1.3929 | Train 0.3950 | Val 0.5185 | Test 0.5428
Number of nodes during this epoch:  329323
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1437697410583496  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.015560388565063477
range selection method range initialization spend 0.011750459671020508
time for parepare:  0.016476869583129883
local_output_nid generation:  0.011023521423339844
local_in_edges_tensor generation:  0.008276939392089844
mini_batch_src_global generation:  0.00982975959777832
r_  generation:  0.1314256191253662
local_output_nid generation:  0.011812925338745117
local_in_edges_tensor generation:  0.005282163619995117
mini_batch_src_global generation:  0.012552022933959961
r_  generation:  0.1430368423461914
----------------------check_connections_block total spend ----------------------------- 0.40442323684692383
generate_one_block  0.15159106254577637
generate_one_block  0.1602933406829834
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.07761836051940918
gen group dst list time:  0.00735163688659668
time for parepare:  0.0223996639251709
local_output_nid generation:  0.01848459243774414
local_in_edges_tensor generation:  0.03910946846008301
mini_batch_src_global generation:  0.03830862045288086
r_  generation:  0.4371349811553955
local_output_nid generation:  0.022699594497680664
local_in_edges_tensor generation:  0.03086996078491211
mini_batch_src_global generation:  0.047484397888183594
r_  generation:  0.48083925247192383
----------------------check_connections_block total spend ----------------------------- 1.3256475925445557
generate_one_block  0.5326507091522217
generate_one_block  0.5401313304901123
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.020311594009399414
gen group dst list time:  0.011608600616455078
time for parepare:  0.01950526237487793
local_output_nid generation:  0.021435260772705078
local_in_edges_tensor generation:  0.03152608871459961
mini_batch_src_global generation:  0.029700279235839844
r_  generation:  0.36496448516845703
local_output_nid generation:  0.029696941375732422
local_in_edges_tensor generation:  0.027591943740844727
mini_batch_src_global generation:  0.038680315017700195
r_  generation:  0.3756086826324463
----------------------check_connections_block total spend ----------------------------- 1.0996043682098389
generate_one_block  0.4383516311645508
generate_one_block  0.44159913063049316
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1437697410583496  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.4252519607543945
block generation total time  1.952732801437378
average batch blocks generation time:  0.976366400718689
block dataloader generation time/epoch 5.727053016424179
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1089777946472168  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2073488235473633  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10861396789550781  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2081284523010254  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07410192489624023 |0.011905312538146973 |0.003906369209289551 |0.0005128383636474609 |0.004355669021606445 |0.002888917922973633 |
----------------------------------------------------------pseudo_mini_loss sum 1.3666574954986572
Total (block generation + training)time/epoch 6.0319085121154785
Training time/epoch 0.2936580181121826
Training time without block to device /epoch 0.26984739303588867
Training time without total dataloading part /epoch 0.020438671112060547
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 57.85it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.44it/s]100%|██████████| 4/4 [00:00<00:00, 15.93it/s]100%|██████████| 4/4 [00:00<00:00, 15.84it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.82it/s]100%|██████████| 4/4 [00:00<00:00, 18.34it/s]100%|██████████| 4/4 [00:00<00:00, 18.24it/s]
Run 00 | Epoch 00017 | Loss 1.3667 | Train 0.3830 | Val 0.5149 | Test 0.5447
Number of nodes during this epoch:  329371
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14410161972045898  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.016290903091430664
range selection method range initialization spend 0.011912345886230469
time for parepare:  0.01615309715270996
local_output_nid generation:  0.010677576065063477
local_in_edges_tensor generation:  0.009494543075561523
mini_batch_src_global generation:  0.00997614860534668
r_  generation:  0.1666700839996338
local_output_nid generation:  0.012559175491333008
local_in_edges_tensor generation:  0.006161928176879883
mini_batch_src_global generation:  0.015073776245117188
r_  generation:  0.14806389808654785
----------------------check_connections_block total spend ----------------------------- 0.45227742195129395
generate_one_block  0.16088604927062988
generate_one_block  0.1599559783935547
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.034975528717041016
gen group dst list time:  0.0064504146575927734
time for parepare:  0.020081520080566406
local_output_nid generation:  0.017047643661499023
local_in_edges_tensor generation:  0.040387868881225586
mini_batch_src_global generation:  0.03835749626159668
r_  generation:  0.41659998893737793
local_output_nid generation:  0.023253679275512695
local_in_edges_tensor generation:  0.030043601989746094
mini_batch_src_global generation:  0.04572415351867676
r_  generation:  0.455045223236084
----------------------check_connections_block total spend ----------------------------- 1.2702007293701172
generate_one_block  0.5264840126037598
generate_one_block  0.5323877334594727
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.021216630935668945
gen group dst list time:  0.012229442596435547
time for parepare:  0.019258499145507812
local_output_nid generation:  0.022731781005859375
local_in_edges_tensor generation:  0.03260612487792969
mini_batch_src_global generation:  0.030085325241088867
r_  generation:  0.37789273262023926
local_output_nid generation:  0.031891822814941406
local_in_edges_tensor generation:  0.031941890716552734
mini_batch_src_global generation:  0.0390472412109375
r_  generation:  0.42099690437316895
----------------------check_connections_block total spend ----------------------------- 1.176544427871704
generate_one_block  0.46712779998779297
generate_one_block  0.45856809616088867
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14410161972045898  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.4467451572418213
block generation total time  1.984567642211914
average batch blocks generation time:  0.992283821105957
block dataloader generation time/epoch 5.745303418901232
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10901117324829102  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2072639465332031  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10863256454467773  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2083473205566406  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07959330081939697 |0.02018558979034424 |0.004091143608093262 |0.000522613525390625 |0.0027637481689453125 |0.003081083297729492 |
----------------------------------------------------------pseudo_mini_loss sum 1.3588454723358154
Total (block generation + training)time/epoch 6.050751606623332
Training time/epoch 0.31002020835876465
Training time without block to device /epoch 0.26964902877807617
Training time without total dataloading part /epoch 0.01783609390258789
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.40it/s]100%|██████████| 4/4 [00:00<00:00, 30.26it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.57it/s]100%|██████████| 4/4 [00:00<00:00, 12.79it/s]100%|██████████| 4/4 [00:00<00:00, 12.58it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.29it/s]100%|██████████| 4/4 [00:00<00:00, 18.20it/s]100%|██████████| 4/4 [00:00<00:00, 18.04it/s]
Run 00 | Epoch 00018 | Loss 1.3588 | Train 0.3737 | Val 0.5098 | Test 0.5413
Number of nodes during this epoch:  329318
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14370346069335938  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.012692689895629883
range selection method range initialization spend 0.01163935661315918
time for parepare:  0.01652240753173828
local_output_nid generation:  0.011354446411132812
local_in_edges_tensor generation:  0.01076197624206543
mini_batch_src_global generation:  0.009717941284179688
r_  generation:  0.15545439720153809
local_output_nid generation:  0.013596296310424805
local_in_edges_tensor generation:  0.0076143741607666016
mini_batch_src_global generation:  0.020089387893676758
r_  generation:  0.16014719009399414
----------------------check_connections_block total spend ----------------------------- 0.4619710445404053
generate_one_block  0.15752434730529785
generate_one_block  0.1613616943359375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029125452041625977
gen group dst list time:  0.00638890266418457
time for parepare:  0.020986557006835938
local_output_nid generation:  0.01850128173828125
local_in_edges_tensor generation:  0.037633419036865234
mini_batch_src_global generation:  0.03928256034851074
r_  generation:  0.4683716297149658
local_output_nid generation:  0.0257718563079834
local_in_edges_tensor generation:  0.035053253173828125
mini_batch_src_global generation:  0.051204681396484375
r_  generation:  0.47126150131225586
----------------------check_connections_block total spend ----------------------------- 1.36710786819458
generate_one_block  0.553041934967041
generate_one_block  0.5395307540893555
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02168750762939453
gen group dst list time:  0.012483358383178711
time for parepare:  0.018744945526123047
local_output_nid generation:  0.021961212158203125
local_in_edges_tensor generation:  0.044049739837646484
mini_batch_src_global generation:  0.03186368942260742
r_  generation:  0.37216949462890625
local_output_nid generation:  0.03157925605773926
local_in_edges_tensor generation:  0.02941441535949707
mini_batch_src_global generation:  0.03745865821838379
r_  generation:  0.38524508476257324
----------------------check_connections_block total spend ----------------------------- 1.1354849338531494
generate_one_block  0.4518289566040039
generate_one_block  0.4585552215576172
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14370346069335938  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.5025928020477295
block generation total time  2.0029568672180176
average batch blocks generation time:  1.0014784336090088
block dataloader generation time/epoch 5.770173835754394
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10897588729858398  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2070302963256836  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10858726501464844  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.208240032196045  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08991527557373047 |0.01990818977355957 |0.0041615962982177734 |0.0005241632461547852 |0.004502296447753906 |0.0031659603118896484 |
----------------------------------------------------------pseudo_mini_loss sum 1.3421580791473389
Total (block generation + training)time/epoch 6.079459524154663
Training time/epoch 0.3436770439147949
Training time without block to device /epoch 0.3038606643676758
Training time without total dataloading part /epoch 0.021542072296142578
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 56.52it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.18it/s]100%|██████████| 4/4 [00:00<00:00, 16.58it/s]100%|██████████| 4/4 [00:00<00:00, 16.50it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.33it/s]100%|██████████| 4/4 [00:00<00:00, 19.66it/s]
Run 00 | Epoch 00019 | Loss 1.3422 | Train 0.3700 | Val 0.5062 | Test 0.5381
Number of nodes during this epoch:  329248
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1439228057861328  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.014059782028198242
range selection method range initialization spend 0.011899948120117188
time for parepare:  0.016698598861694336
local_output_nid generation:  0.010896682739257812
local_in_edges_tensor generation:  0.013852357864379883
mini_batch_src_global generation:  0.013705730438232422
r_  generation:  0.1581568717956543
local_output_nid generation:  0.012577056884765625
local_in_edges_tensor generation:  0.0056726932525634766
mini_batch_src_global generation:  0.014476537704467773
r_  generation:  0.1607990264892578
----------------------check_connections_block total spend ----------------------------- 0.46566152572631836
generate_one_block  0.1563730239868164
generate_one_block  0.1554262638092041
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029258012771606445
gen group dst list time:  0.006487131118774414
time for parepare:  0.021091461181640625
local_output_nid generation:  0.016668081283569336
local_in_edges_tensor generation:  0.032423973083496094
mini_batch_src_global generation:  0.0377042293548584
r_  generation:  0.4133005142211914
local_output_nid generation:  0.02313375473022461
local_in_edges_tensor generation:  0.022504806518554688
mini_batch_src_global generation:  0.04603004455566406
r_  generation:  0.49327754974365234
----------------------check_connections_block total spend ----------------------------- 1.2873561382293701
generate_one_block  0.5188264846801758
generate_one_block  0.5261397361755371
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01779031753540039
gen group dst list time:  0.011567354202270508
time for parepare:  0.019401073455810547
local_output_nid generation:  0.025121688842773438
local_in_edges_tensor generation:  0.02832341194152832
mini_batch_src_global generation:  0.02970743179321289
r_  generation:  0.3789079189300537
local_output_nid generation:  0.03316164016723633
local_in_edges_tensor generation:  0.026373863220214844
mini_batch_src_global generation:  0.037908077239990234
r_  generation:  0.4037618637084961
----------------------check_connections_block total spend ----------------------------- 1.1542963981628418
generate_one_block  0.4562246799468994
generate_one_block  0.4588899612426758
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1439228057861328  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.441652536392212
block generation total time  1.960080862045288
average batch blocks generation time:  0.980040431022644
block dataloader generation time/epoch 5.787825129248879
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10899877548217773  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.207481861114502  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1085357666015625  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.20721435546875  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08236265182495117 |0.01801323890686035 |0.0041429996490478516 |0.000504612922668457 |0.004338622093200684 |0.0018734931945800781 |
----------------------------------------------------------pseudo_mini_loss sum 1.3264915943145752
Total (block generation + training)time/epoch 6.097487644715742
Training time/epoch 0.3132791519165039
Training time without block to device /epoch 0.2772526741027832
Training time without total dataloading part /epoch 0.019845962524414062
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 56.07it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.96it/s]100%|██████████| 4/4 [00:00<00:00, 18.10it/s]100%|██████████| 4/4 [00:00<00:00, 17.72it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.10it/s]100%|██████████| 4/4 [00:00<00:00, 22.77it/s]
Run 00 | Epoch 00020 | Loss 1.3265 | Train 0.3714 | Val 0.5061 | Test 0.5377
Number of nodes during this epoch:  329265
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1439962387084961  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.013994216918945312
range selection method range initialization spend 0.011688947677612305
time for parepare:  0.016384124755859375
local_output_nid generation:  0.010637760162353516
local_in_edges_tensor generation:  0.0164639949798584
mini_batch_src_global generation:  0.013428211212158203
r_  generation:  0.13992881774902344
local_output_nid generation:  0.011791467666625977
local_in_edges_tensor generation:  0.006171226501464844
mini_batch_src_global generation:  0.013239860534667969
r_  generation:  0.14810633659362793
----------------------check_connections_block total spend ----------------------------- 0.4441111087799072
generate_one_block  0.14987945556640625
generate_one_block  0.15345358848571777
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.024624109268188477
gen group dst list time:  0.006259441375732422
time for parepare:  0.019666433334350586
local_output_nid generation:  0.016544342041015625
local_in_edges_tensor generation:  0.0402529239654541
mini_batch_src_global generation:  0.039817094802856445
r_  generation:  0.433840274810791
local_output_nid generation:  0.03293442726135254
local_in_edges_tensor generation:  0.03708195686340332
mini_batch_src_global generation:  0.05291938781738281
r_  generation:  0.4544830322265625
----------------------check_connections_block total spend ----------------------------- 1.3308324813842773
generate_one_block  0.5484609603881836
generate_one_block  0.5301926136016846
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02104949951171875
gen group dst list time:  0.014942407608032227
time for parepare:  0.018652677536010742
local_output_nid generation:  0.023288488388061523
local_in_edges_tensor generation:  0.04018592834472656
mini_batch_src_global generation:  0.03150224685668945
r_  generation:  0.3723733425140381
local_output_nid generation:  0.031234025955200195
local_in_edges_tensor generation:  0.02588677406311035
mini_batch_src_global generation:  0.037270307540893555
r_  generation:  0.37935328483581543
----------------------check_connections_block total spend ----------------------------- 1.1227993965148926
generate_one_block  0.4452228546142578
generate_one_block  0.4439666271209717
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1439962387084961  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.45363187789917
block generation total time  1.9678430557250977
average batch blocks generation time:  0.9839215278625488
block dataloader generation time/epoch 5.796277503172557
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10894536972045898  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2076196670532227  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1085205078125  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.207740306854248  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07595181465148926 |0.012987613677978516 |0.004065036773681641 |0.0005193948745727539 |0.0043027400970458984 |0.0013942718505859375 |
----------------------------------------------------------pseudo_mini_loss sum 1.300718903541565
Total (block generation + training)time/epoch 6.104576071103414
Training time/epoch 0.29314446449279785
Training time without block to device /epoch 0.2671692371368408
Training time without total dataloading part /epoch 0.019168615341186523
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 54.78it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.16it/s]100%|██████████| 4/4 [00:00<00:00, 17.85it/s]100%|██████████| 4/4 [00:00<00:00, 17.55it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.72it/s]100%|██████████| 4/4 [00:00<00:00, 19.23it/s]100%|██████████| 4/4 [00:00<00:00, 19.12it/s]
Run 00 | Epoch 00021 | Loss 1.3007 | Train 0.3752 | Val 0.5075 | Test 0.5373
Number of nodes during this epoch:  329328
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14447546005249023  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.012692928314208984
range selection method range initialization spend 0.011715173721313477
time for parepare:  0.016079187393188477
local_output_nid generation:  0.010754823684692383
local_in_edges_tensor generation:  0.007631063461303711
mini_batch_src_global generation:  0.009933233261108398
r_  generation:  0.1461787223815918
local_output_nid generation:  0.011879682540893555
local_in_edges_tensor generation:  0.005609750747680664
mini_batch_src_global generation:  0.012741565704345703
r_  generation:  0.14644360542297363
----------------------check_connections_block total spend ----------------------------- 0.42218637466430664
generate_one_block  0.15089726448059082
generate_one_block  0.16018438339233398
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.027324676513671875
gen group dst list time:  0.006338834762573242
time for parepare:  0.02163410186767578
local_output_nid generation:  0.016998767852783203
local_in_edges_tensor generation:  0.027051210403442383
mini_batch_src_global generation:  0.03660464286804199
r_  generation:  0.43299317359924316
local_output_nid generation:  0.025814294815063477
local_in_edges_tensor generation:  0.03157687187194824
mini_batch_src_global generation:  0.05193161964416504
r_  generation:  0.42269086837768555
----------------------check_connections_block total spend ----------------------------- 1.2525901794433594
generate_one_block  0.5212869644165039
generate_one_block  0.5168852806091309
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.020477771759033203
gen group dst list time:  0.0115814208984375
time for parepare:  0.020824432373046875
local_output_nid generation:  0.022690773010253906
local_in_edges_tensor generation:  0.032733917236328125
mini_batch_src_global generation:  0.0297696590423584
r_  generation:  0.3694736957550049
local_output_nid generation:  0.03084588050842285
local_in_edges_tensor generation:  0.030521392822265625
mini_batch_src_global generation:  0.037610530853271484
r_  generation:  0.37770724296569824
----------------------check_connections_block total spend ----------------------------- 1.1136276721954346
generate_one_block  0.4444706439971924
generate_one_block  0.4715745449066162
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14447546005249023  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.366217851638794
block generation total time  1.9542174339294434
average batch blocks generation time:  0.9771087169647217
block dataloader generation time/epoch 5.791516762513381
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10896635055541992  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2075481414794922  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10858583450317383  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2080821990966797  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07738101482391357 |0.013355374336242676 |0.0041321516036987305 |0.0005241632461547852 |0.003658771514892578 |0.0013980865478515625 |
----------------------------------------------------------pseudo_mini_loss sum 1.2916045188903809
Total (block generation + training)time/epoch 6.098710830395039
Training time/epoch 0.293795108795166
Training time without block to device /epoch 0.26708436012268066
Training time without total dataloading part /epoch 0.01802825927734375
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 57.53it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.50it/s]100%|██████████| 4/4 [00:00<00:00, 17.63it/s]100%|██████████| 4/4 [00:00<00:00, 17.25it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.83it/s]100%|██████████| 4/4 [00:00<00:00, 19.74it/s]
Run 00 | Epoch 00022 | Loss 1.2916 | Train 0.3803 | Val 0.5089 | Test 0.5380
Number of nodes during this epoch:  329337
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14426851272583008  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02034592628479004
range selection method range initialization spend 0.013122081756591797
time for parepare:  0.025391817092895508
local_output_nid generation:  0.014455080032348633
local_in_edges_tensor generation:  0.015224218368530273
mini_batch_src_global generation:  0.009947538375854492
r_  generation:  0.13436365127563477
local_output_nid generation:  0.012276887893676758
local_in_edges_tensor generation:  0.005209207534790039
mini_batch_src_global generation:  0.012784004211425781
r_  generation:  0.14460277557373047
----------------------check_connections_block total spend ----------------------------- 0.4301269054412842
generate_one_block  0.1545703411102295
generate_one_block  0.15948915481567383
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02817225456237793
gen group dst list time:  0.006263017654418945
time for parepare:  0.019440650939941406
local_output_nid generation:  0.016457557678222656
local_in_edges_tensor generation:  0.03177666664123535
mini_batch_src_global generation:  0.03825688362121582
r_  generation:  0.4186413288116455
local_output_nid generation:  0.02243518829345703
local_in_edges_tensor generation:  0.027814149856567383
mini_batch_src_global generation:  0.04742622375488281
r_  generation:  0.43245792388916016
----------------------check_connections_block total spend ----------------------------- 1.240100383758545
generate_one_block  0.5484137535095215
generate_one_block  0.5249478816986084
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.020644426345825195
gen group dst list time:  0.013296365737915039
time for parepare:  0.02023625373840332
local_output_nid generation:  0.022093534469604492
local_in_edges_tensor generation:  0.037885189056396484
mini_batch_src_global generation:  0.03022146224975586
r_  generation:  0.37001776695251465
local_output_nid generation:  0.03040313720703125
local_in_edges_tensor generation:  0.030617237091064453
mini_batch_src_global generation:  0.037433624267578125
r_  generation:  0.3787803649902344
----------------------check_connections_block total spend ----------------------------- 1.1203508377075195
generate_one_block  0.44330358505249023
generate_one_block  0.44718098640441895
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14426851272583008  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.3604512214660645
block generation total time  1.963846206665039
average batch blocks generation time:  0.9819231033325195
block dataloader generation time/epoch 5.796228681291852
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10901308059692383  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2080111503601074  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1085667610168457  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2073745727539062  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08989763259887695 |0.01294088363647461 |0.004200577735900879 |0.0005224943161010742 |0.0031850337982177734 |0.001444101333618164 |
----------------------------------------------------------pseudo_mini_loss sum 1.2824597358703613
Total (block generation + training)time/epoch 6.104333945683071
Training time/epoch 0.3198072910308838
Training time without block to device /epoch 0.29392552375793457
Training time without total dataloading part /epoch 0.017260313034057617
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 49.90it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.21it/s]100%|██████████| 4/4 [00:00<00:00, 15.54it/s]100%|██████████| 4/4 [00:00<00:00, 15.48it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.76it/s]100%|██████████| 4/4 [00:00<00:00, 18.13it/s]100%|██████████| 4/4 [00:00<00:00, 18.05it/s]
Run 00 | Epoch 00023 | Loss 1.2825 | Train 0.3864 | Val 0.5103 | Test 0.5395
Number of nodes during this epoch:  329251
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14383602142333984  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.014528512954711914
range selection method range initialization spend 0.011919975280761719
time for parepare:  0.015891313552856445
local_output_nid generation:  0.010780096054077148
local_in_edges_tensor generation:  0.0075948238372802734
mini_batch_src_global generation:  0.010130167007446289
r_  generation:  0.13230252265930176
local_output_nid generation:  0.013390302658081055
local_in_edges_tensor generation:  0.005199432373046875
mini_batch_src_global generation:  0.012588739395141602
r_  generation:  0.14134955406188965
----------------------check_connections_block total spend ----------------------------- 0.40381693840026855
generate_one_block  0.15025115013122559
generate_one_block  0.1528029441833496
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.026398897171020508
gen group dst list time:  0.006138324737548828
time for parepare:  0.019501686096191406
local_output_nid generation:  0.015710830688476562
local_in_edges_tensor generation:  0.027103424072265625
mini_batch_src_global generation:  0.038132667541503906
r_  generation:  0.40897345542907715
local_output_nid generation:  0.02397942543029785
local_in_edges_tensor generation:  0.02642965316772461
mini_batch_src_global generation:  0.04690957069396973
r_  generation:  0.42131805419921875
----------------------check_connections_block total spend ----------------------------- 1.2107205390930176
generate_one_block  0.5370852947235107
generate_one_block  0.5189838409423828
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02323007583618164
gen group dst list time:  0.013332843780517578
time for parepare:  0.018491268157958984
local_output_nid generation:  0.022020816802978516
local_in_edges_tensor generation:  0.03622603416442871
mini_batch_src_global generation:  0.030200719833374023
r_  generation:  0.3663959503173828
local_output_nid generation:  0.029653310775756836
local_in_edges_tensor generation:  0.027607202529907227
mini_batch_src_global generation:  0.03698253631591797
r_  generation:  0.3752892017364502
----------------------check_connections_block total spend ----------------------------- 1.1057591438293457
generate_one_block  0.4386308193206787
generate_one_block  0.44185495376586914
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14383602142333984  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.3164796829223633
block generation total time  1.9365549087524414
average batch blocks generation time:  0.9682774543762207
block dataloader generation time/epoch 5.785533046722412
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10897493362426758  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.207228183746338  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10853433609008789  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2077269554138184  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08397579193115234 |0.014039158821105957 |0.0037925243377685547 |0.00048601627349853516 |0.0031031370162963867 |0.0013794898986816406 |
----------------------------------------------------------pseudo_mini_loss sum 1.2672538757324219
Total (block generation + training)time/epoch 6.093656794230143
Training time/epoch 0.30825066566467285
Training time without block to device /epoch 0.28017234802246094
Training time without total dataloading part /epoch 0.016142845153808594
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 57.72it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.01it/s]100%|██████████| 4/4 [00:00<00:00, 15.31it/s]100%|██████████| 4/4 [00:00<00:00, 15.24it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.90it/s]100%|██████████| 4/4 [00:00<00:00, 17.44it/s]100%|██████████| 4/4 [00:00<00:00, 17.34it/s]
Run 00 | Epoch 00024 | Loss 1.2673 | Train 0.3927 | Val 0.5132 | Test 0.5418
Number of nodes during this epoch:  329246
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14336109161376953  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.016892194747924805
range selection method range initialization spend 0.011573553085327148
time for parepare:  0.016386032104492188
local_output_nid generation:  0.010701894760131836
local_in_edges_tensor generation:  0.008513450622558594
mini_batch_src_global generation:  0.009873628616333008
r_  generation:  0.1344621181488037
local_output_nid generation:  0.011736631393432617
local_in_edges_tensor generation:  0.005266904830932617
mini_batch_src_global generation:  0.012644290924072266
r_  generation:  0.14640593528747559
----------------------check_connections_block total spend ----------------------------- 0.4152827262878418
generate_one_block  0.15861272811889648
generate_one_block  0.15953731536865234
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029448270797729492
gen group dst list time:  0.006288766860961914
time for parepare:  0.019942522048950195
local_output_nid generation:  0.016495943069458008
local_in_edges_tensor generation:  0.031929969787597656
mini_batch_src_global generation:  0.054060935974121094
r_  generation:  0.42502689361572266
local_output_nid generation:  0.025363922119140625
local_in_edges_tensor generation:  0.03126883506774902
mini_batch_src_global generation:  0.04607367515563965
r_  generation:  0.4248316287994385
----------------------check_connections_block total spend ----------------------------- 1.2696175575256348
generate_one_block  0.5223567485809326
generate_one_block  0.524390697479248
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.020323991775512695
gen group dst list time:  0.011699914932250977
time for parepare:  0.021361351013183594
local_output_nid generation:  0.02281045913696289
local_in_edges_tensor generation:  0.04162192344665527
mini_batch_src_global generation:  0.03242015838623047
r_  generation:  0.37147951126098633
local_output_nid generation:  0.0316004753112793
local_in_edges_tensor generation:  0.026556968688964844
mini_batch_src_global generation:  0.03710055351257324
r_  generation:  0.3775520324707031
----------------------check_connections_block total spend ----------------------------- 1.1235134601593018
generate_one_block  0.4567444324493408
generate_one_block  0.4667673110961914
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14336109161376953  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.3931310176849365
block generation total time  1.970259189605713
average batch blocks generation time:  0.9851295948028564
block dataloader generation time/epoch 5.78586719930172
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10897684097290039  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2076787948608398  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10855484008789062  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2080192565917969  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07995402812957764 |0.014304876327514648 |0.0041016340255737305 |0.0005311965942382812 |0.0037654638290405273 |0.0013854503631591797 |
----------------------------------------------------------pseudo_mini_loss sum 1.2469725608825684
Total (block generation + training)time/epoch 6.093475490808487
Training time/epoch 0.29971861839294434
Training time without block to device /epoch 0.27110886573791504
Training time without total dataloading part /epoch 0.018182039260864258
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 52.57it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 13.75it/s]100%|██████████| 4/4 [00:00<00:00, 14.52it/s]100%|██████████| 4/4 [00:00<00:00, 14.39it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.98it/s]100%|██████████| 4/4 [00:00<00:00, 17.08it/s]100%|██████████| 4/4 [00:00<00:00, 16.89it/s]
Run 00 | Epoch 00025 | Loss 1.2470 | Train 0.4009 | Val 0.5168 | Test 0.5443
Number of nodes during this epoch:  329311
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14420509338378906  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.014506816864013672
range selection method range initialization spend 0.011846780776977539
time for parepare:  0.018785953521728516
local_output_nid generation:  0.010907411575317383
local_in_edges_tensor generation:  0.012073516845703125
mini_batch_src_global generation:  0.010411739349365234
r_  generation:  0.13376092910766602
local_output_nid generation:  0.011925697326660156
local_in_edges_tensor generation:  0.005307197570800781
mini_batch_src_global generation:  0.015609502792358398
r_  generation:  0.14693999290466309
----------------------check_connections_block total spend ----------------------------- 0.4213440418243408
generate_one_block  0.15897870063781738
generate_one_block  0.15542840957641602
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02740931510925293
gen group dst list time:  0.006197452545166016
time for parepare:  0.021344423294067383
local_output_nid generation:  0.0184934139251709
local_in_edges_tensor generation:  0.03018951416015625
mini_batch_src_global generation:  0.03698444366455078
r_  generation:  0.416003942489624
local_output_nid generation:  0.023290395736694336
local_in_edges_tensor generation:  0.023588180541992188
mini_batch_src_global generation:  0.045400381088256836
r_  generation:  0.4226081371307373
----------------------check_connections_block total spend ----------------------------- 1.2188138961791992
generate_one_block  0.5246584415435791
generate_one_block  0.5173468589782715
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01713418960571289
gen group dst list time:  0.011724472045898438
time for parepare:  0.01898479461669922
local_output_nid generation:  0.021985769271850586
local_in_edges_tensor generation:  0.029554367065429688
mini_batch_src_global generation:  0.030650615692138672
r_  generation:  0.372037410736084
local_output_nid generation:  0.03036332130432129
local_in_edges_tensor generation:  0.02755594253540039
mini_batch_src_global generation:  0.03755640983581543
r_  generation:  0.37910914421081543
----------------------check_connections_block total spend ----------------------------- 1.1094415187835693
generate_one_block  0.4528045654296875
generate_one_block  0.4560556411743164
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14420509338378906  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.3282554149627686
block generation total time  1.9508655071258545
average batch blocks generation time:  0.9754327535629272
block dataloader generation time/epoch 5.7815101146698
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10904932022094727  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2097563743591309  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10910844802856445  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2070975303649902  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07095754146575928 |0.011999130249023438 |0.016205668449401855 |0.0005145072937011719 |0.003737926483154297 |0.002824068069458008 |
----------------------------------------------------------pseudo_mini_loss sum 1.2432944774627686
Total (block generation + training)time/epoch 6.089443178737865
Training time/epoch 0.3130342960357666
Training time without block to device /epoch 0.2890360355377197
Training time without total dataloading part /epoch 0.043740272521972656
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.14it/s]100%|██████████| 4/4 [00:00<00:00, 29.38it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.34it/s]100%|██████████| 4/4 [00:00<00:00, 12.21it/s]100%|██████████| 4/4 [00:00<00:00, 12.06it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.66it/s]100%|██████████| 4/4 [00:00<00:00, 16.19it/s]100%|██████████| 4/4 [00:00<00:00, 15.91it/s]
Run 00 | Epoch 00026 | Loss 1.2433 | Train 0.4088 | Val 0.5196 | Test 0.5455
Number of nodes during this epoch:  329283
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14361286163330078  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.014491796493530273
range selection method range initialization spend 0.011850118637084961
time for parepare:  0.016356468200683594
local_output_nid generation:  0.01070713996887207
local_in_edges_tensor generation:  0.010666370391845703
mini_batch_src_global generation:  0.010429859161376953
r_  generation:  0.13225698471069336
local_output_nid generation:  0.011748313903808594
local_in_edges_tensor generation:  0.006360769271850586
mini_batch_src_global generation:  0.012861251831054688
r_  generation:  0.14465737342834473
----------------------check_connections_block total spend ----------------------------- 0.41212034225463867
generate_one_block  0.15129327774047852
generate_one_block  0.15398645401000977
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02826213836669922
gen group dst list time:  0.006337881088256836
time for parepare:  0.020307540893554688
local_output_nid generation:  0.01676154136657715
local_in_edges_tensor generation:  0.03139686584472656
mini_batch_src_global generation:  0.03819417953491211
r_  generation:  0.41096925735473633
local_output_nid generation:  0.02339625358581543
local_in_edges_tensor generation:  0.02345895767211914
mini_batch_src_global generation:  0.04598093032836914
r_  generation:  0.421278715133667
----------------------check_connections_block total spend ----------------------------- 1.2133691310882568
generate_one_block  0.5198111534118652
generate_one_block  0.5333402156829834
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.019293785095214844
gen group dst list time:  0.011708974838256836
time for parepare:  0.019109487533569336
local_output_nid generation:  0.023087501525878906
local_in_edges_tensor generation:  0.029503822326660156
mini_batch_src_global generation:  0.03093433380126953
r_  generation:  0.37306952476501465
local_output_nid generation:  0.030970096588134766
local_in_edges_tensor generation:  0.027245044708251953
mini_batch_src_global generation:  0.03975510597229004
r_  generation:  0.38216352462768555
----------------------check_connections_block total spend ----------------------------- 1.1212012767791748
generate_one_block  0.4470827579498291
generate_one_block  0.46204471588134766
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14361286163330078  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.3345704078674316
block generation total time  1.9622788429260254
average batch blocks generation time:  0.9811394214630127
block dataloader generation time/epoch 5.777430839008755
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10927438735961914  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2080669403076172  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10860443115234375  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.207925796508789  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08053672313690186 |0.01191413402557373 |0.003973722457885742 |0.0005106925964355469 |0.003486037254333496 |0.0013303756713867188 |
----------------------------------------------------------pseudo_mini_loss sum 1.2273228168487549
Total (block generation + training)time/epoch 6.084986196623908
Training time/epoch 0.30103397369384766
Training time without block to device /epoch 0.2772057056427002
Training time without total dataloading part /epoch 0.01727128028869629
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.95it/s]100%|██████████| 4/4 [00:00<00:00, 28.82it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.51it/s]100%|██████████| 4/4 [00:00<00:00, 12.73it/s]100%|██████████| 4/4 [00:00<00:00, 12.52it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.19it/s]100%|██████████| 4/4 [00:00<00:00, 17.61it/s]100%|██████████| 4/4 [00:00<00:00, 17.52it/s]
Run 00 | Epoch 00027 | Loss 1.2273 | Train 0.4178 | Val 0.5235 | Test 0.5453
Number of nodes during this epoch:  329376
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14313268661499023  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.015240669250488281
range selection method range initialization spend 0.011925220489501953
time for parepare:  0.01650094985961914
local_output_nid generation:  0.011453390121459961
local_in_edges_tensor generation:  0.011013984680175781
mini_batch_src_global generation:  0.010245323181152344
r_  generation:  0.13283181190490723
local_output_nid generation:  0.012342691421508789
local_in_edges_tensor generation:  0.006224155426025391
mini_batch_src_global generation:  0.012675285339355469
r_  generation:  0.14090538024902344
----------------------check_connections_block total spend ----------------------------- 0.40969133377075195
generate_one_block  0.1504678726196289
generate_one_block  0.15281367301940918
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.026031494140625
gen group dst list time:  0.006241321563720703
time for parepare:  0.020892620086669922
local_output_nid generation:  0.016462326049804688
local_in_edges_tensor generation:  0.030284643173217773
mini_batch_src_global generation:  0.03917956352233887
r_  generation:  0.40476226806640625
local_output_nid generation:  0.023113012313842773
local_in_edges_tensor generation:  0.02488541603088379
mini_batch_src_global generation:  0.0452272891998291
r_  generation:  0.4178478717803955
----------------------check_connections_block total spend ----------------------------- 1.2035696506500244
generate_one_block  0.5145833492279053
generate_one_block  0.5224828720092773
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.019576311111450195
gen group dst list time:  0.011596441268920898
time for parepare:  0.019212007522583008
local_output_nid generation:  0.022734403610229492
local_in_edges_tensor generation:  0.029175996780395508
mini_batch_src_global generation:  0.031060218811035156
r_  generation:  0.3676917552947998
local_output_nid generation:  0.030758380889892578
local_in_edges_tensor generation:  0.02886056900024414
mini_batch_src_global generation:  0.037369489669799805
r_  generation:  0.3764150142669678
----------------------check_connections_block total spend ----------------------------- 1.1068642139434814
generate_one_block  0.4554755687713623
generate_one_block  0.4508354663848877
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14313268661499023  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.310433864593506
block generation total time  1.9433772563934326
average batch blocks generation time:  0.9716886281967163
block dataloader generation time/epoch 5.770735765758314
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10899591445922852  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2080721855163574  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10856866836547852  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2074790000915527  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04660212993621826 |0.011661529541015625 |0.00475919246673584 |0.0005124807357788086 |0.0375291109085083 |0.0013928413391113281 |
----------------------------------------------------------pseudo_mini_loss sum 1.2185169458389282
Total (block generation + training)time/epoch 6.078360143460725
Training time/epoch 0.30872035026550293
Training time without block to device /epoch 0.2853972911834717
Training time without total dataloading part /epoch 0.08699440956115723
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.37it/s]100%|██████████| 4/4 [00:00<00:00, 31.41it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.71it/s]100%|██████████| 4/4 [00:00<00:00, 12.93it/s]100%|██████████| 4/4 [00:00<00:00, 12.72it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.75it/s]100%|██████████| 4/4 [00:00<00:00, 18.25it/s]100%|██████████| 4/4 [00:00<00:00, 18.15it/s]
Run 00 | Epoch 00028 | Loss 1.2185 | Train 0.4254 | Val 0.5241 | Test 0.5433
Number of nodes during this epoch:  329444
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14380645751953125  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.015789270401000977
range selection method range initialization spend 0.011699199676513672
time for parepare:  0.016242265701293945
local_output_nid generation:  0.010707378387451172
local_in_edges_tensor generation:  0.008670806884765625
mini_batch_src_global generation:  0.010083436965942383
r_  generation:  0.13500714302062988
local_output_nid generation:  0.012426614761352539
local_in_edges_tensor generation:  0.005543708801269531
mini_batch_src_global generation:  0.012953042984008789
r_  generation:  0.14507555961608887
----------------------check_connections_block total spend ----------------------------- 0.41297197341918945
generate_one_block  0.14986181259155273
generate_one_block  0.15359950065612793
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02695775032043457
gen group dst list time:  0.006064414978027344
time for parepare:  0.019480466842651367
local_output_nid generation:  0.01658916473388672
local_in_edges_tensor generation:  0.0264284610748291
mini_batch_src_global generation:  0.039581298828125
r_  generation:  0.41129541397094727
local_output_nid generation:  0.023461103439331055
local_in_edges_tensor generation:  0.025788545608520508
mini_batch_src_global generation:  0.04511857032775879
r_  generation:  0.4229319095611572
----------------------check_connections_block total spend ----------------------------- 1.210052728652954
generate_one_block  0.5166521072387695
generate_one_block  0.5317909717559814
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02231884002685547
gen group dst list time:  0.012158632278442383
time for parepare:  0.020151853561401367
local_output_nid generation:  0.02187180519104004
local_in_edges_tensor generation:  0.03665041923522949
mini_batch_src_global generation:  0.03206324577331543
r_  generation:  0.380260705947876
local_output_nid generation:  0.034282684326171875
local_in_edges_tensor generation:  0.029043912887573242
mini_batch_src_global generation:  0.04250502586364746
r_  generation:  0.3740668296813965
----------------------check_connections_block total spend ----------------------------- 1.1338534355163574
generate_one_block  0.4421515464782715
generate_one_block  0.44992589950561523
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14380645751953125  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.3439061641693115
block generation total time  1.9405205249786377
average batch blocks generation time:  0.9702602624893188
block dataloader generation time/epoch 5.766694366931915
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10895586013793945  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.207672119140625  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10855865478515625  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2079734802246094  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08723294734954834 |0.01836395263671875 |0.003938198089599609 |0.0004938840866088867 |0.0032765865325927734 |0.0012860298156738281 |
----------------------------------------------------------pseudo_mini_loss sum 1.2064166069030762
Total (block generation + training)time/epoch 6.075610184669495
Training time/epoch 0.33330678939819336
Training time without block to device /epoch 0.29657888412475586
Training time without total dataloading part /epoch 0.016703367233276367
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 53.13it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.81it/s]100%|██████████| 4/4 [00:00<00:00, 15.89it/s]100%|██████████| 4/4 [00:00<00:00, 15.86it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.62it/s]100%|██████████| 4/4 [00:00<00:00, 18.12it/s]100%|██████████| 4/4 [00:00<00:00, 18.03it/s]
Run 00 | Epoch 00029 | Loss 1.2064 | Train 0.4294 | Val 0.5227 | Test 0.5389
Number of nodes during this epoch:  329356
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14446783065795898  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.012117862701416016
range selection method range initialization spend 0.011530399322509766
time for parepare:  0.016056060791015625
local_output_nid generation:  0.010884284973144531
local_in_edges_tensor generation:  0.010845422744750977
mini_batch_src_global generation:  0.010452985763549805
r_  generation:  0.1312723159790039
local_output_nid generation:  0.011567354202270508
local_in_edges_tensor generation:  0.005254983901977539
mini_batch_src_global generation:  0.012798547744750977
r_  generation:  0.14058375358581543
----------------------check_connections_block total spend ----------------------------- 0.4050567150115967
generate_one_block  0.1499180793762207
generate_one_block  0.1521759033203125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0323481559753418
gen group dst list time:  0.006020307540893555
time for parepare:  0.019904136657714844
local_output_nid generation:  0.015666961669921875
local_in_edges_tensor generation:  0.027817726135253906
mini_batch_src_global generation:  0.03757619857788086
r_  generation:  0.404970645904541
local_output_nid generation:  0.022538423538208008
local_in_edges_tensor generation:  0.02575993537902832
mini_batch_src_global generation:  0.04590868949890137
r_  generation:  0.4841306209564209
----------------------check_connections_block total spend ----------------------------- 1.2702522277832031
generate_one_block  0.5306053161621094
generate_one_block  0.5530664920806885
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02687835693359375
gen group dst list time:  0.016379594802856445
time for parepare:  0.020601511001586914
local_output_nid generation:  0.0238645076751709
local_in_edges_tensor generation:  0.0450437068939209
mini_batch_src_global generation:  0.034192800521850586
r_  generation:  0.37842726707458496
local_output_nid generation:  0.030488014221191406
local_in_edges_tensor generation:  0.030658960342407227
mini_batch_src_global generation:  0.040299177169799805
r_  generation:  0.3965275287628174
----------------------check_connections_block total spend ----------------------------- 1.1655528545379639
generate_one_block  0.4700291156768799
generate_one_block  0.4736006259918213
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14446783065795898  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.435805082321167
block generation total time  2.027301549911499
average batch blocks generation time:  1.0136507749557495
block dataloader generation time/epoch 5.77159435408456
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10900354385375977  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2076139450073242  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10854244232177734  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.207557201385498  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07875120639801025 |0.01744973659515381 |0.004473090171813965 |0.0005221366882324219 |0.0034619569778442383 |0.0015566349029541016 |
----------------------------------------------------------pseudo_mini_loss sum 1.2034211158752441
Total (block generation + training)time/epoch 6.080520709355672
Training time/epoch 0.3089902400970459
Training time without block to device /epoch 0.2740907669067383
Training time without total dataloading part /epoch 0.01847100257873535
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 50.58it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.98it/s]100%|██████████| 4/4 [00:00<00:00, 15.44it/s]100%|██████████| 4/4 [00:00<00:00, 15.35it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.38it/s]100%|██████████| 4/4 [00:00<00:00, 17.55it/s]100%|██████████| 4/4 [00:00<00:00, 17.50it/s]
Run 00 | Epoch 00030 | Loss 1.2034 | Train 0.4288 | Val 0.5205 | Test 0.5321
Number of nodes during this epoch:  329256
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1436471939086914  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.015186786651611328
range selection method range initialization spend 0.011687040328979492
time for parepare:  0.016437053680419922
local_output_nid generation:  0.010692358016967773
local_in_edges_tensor generation:  0.00910043716430664
mini_batch_src_global generation:  0.009945154190063477
r_  generation:  0.13891005516052246
local_output_nid generation:  0.012507438659667969
local_in_edges_tensor generation:  0.005257368087768555
mini_batch_src_global generation:  0.01275014877319336
r_  generation:  0.14248394966125488
----------------------check_connections_block total spend ----------------------------- 0.4139864444732666
generate_one_block  0.15622925758361816
generate_one_block  0.15331053733825684
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028736114501953125
gen group dst list time:  0.006192207336425781
time for parepare:  0.019904613494873047
local_output_nid generation:  0.016381502151489258
local_in_edges_tensor generation:  0.02869105339050293
mini_batch_src_global generation:  0.03788137435913086
r_  generation:  0.4163949489593506
local_output_nid generation:  0.0242769718170166
local_in_edges_tensor generation:  0.023564815521240234
mini_batch_src_global generation:  0.04584217071533203
r_  generation:  0.425692081451416
----------------------check_connections_block total spend ----------------------------- 1.2219812870025635
generate_one_block  0.5224006175994873
generate_one_block  0.5214757919311523
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01784658432006836
gen group dst list time:  0.011747360229492188
time for parepare:  0.019458770751953125
local_output_nid generation:  0.023623228073120117
local_in_edges_tensor generation:  0.029016971588134766
mini_batch_src_global generation:  0.031272172927856445
r_  generation:  0.3710141181945801
local_output_nid generation:  0.03291821479797363
local_in_edges_tensor generation:  0.03570079803466797
mini_batch_src_global generation:  0.037858009338378906
r_  generation:  0.38370180130004883
----------------------check_connections_block total spend ----------------------------- 1.1336097717285156
generate_one_block  0.45232343673706055
generate_one_block  0.4533193111419678
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1436471939086914  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.355591058731079
block generation total time  1.949519157409668
average batch blocks generation time:  0.974759578704834
block dataloader generation time/epoch 5.769528540697965
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10897111892700195  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2073206901550293  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10856485366821289  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2077326774597168  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07643842697143555 |0.012621521949768066 |0.0038832426071166992 |0.0005036592483520508 |0.003718256950378418 |0.0013391971588134766 |
----------------------------------------------------------pseudo_mini_loss sum 1.1898013353347778
Total (block generation + training)time/epoch 6.078146869486028
Training time/epoch 0.3020670413970947
Training time without block to device /epoch 0.2768239974975586
Training time without total dataloading part /epoch 0.017549514770507812
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.91it/s]100%|██████████| 4/4 [00:00<00:00, 30.36it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.38it/s]100%|██████████| 4/4 [00:00<00:00, 12.22it/s]100%|██████████| 4/4 [00:00<00:00, 12.08it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.90it/s]100%|██████████| 4/4 [00:00<00:00, 16.89it/s]100%|██████████| 4/4 [00:00<00:00, 16.88it/s]
Run 00 | Epoch 00031 | Loss 1.1898 | Train 0.4252 | Val 0.5169 | Test 0.5265
Number of nodes during this epoch:  329275
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14336442947387695  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.013652324676513672
range selection method range initialization spend 0.012408018112182617
time for parepare:  0.016142845153808594
local_output_nid generation:  0.011387825012207031
local_in_edges_tensor generation:  0.011887550354003906
mini_batch_src_global generation:  0.009880542755126953
r_  generation:  0.13383078575134277
local_output_nid generation:  0.01162862777709961
local_in_edges_tensor generation:  0.0052852630615234375
mini_batch_src_global generation:  0.013084173202514648
r_  generation:  0.14814472198486328
----------------------check_connections_block total spend ----------------------------- 0.41691017150878906
generate_one_block  0.1511821746826172
generate_one_block  0.15341711044311523
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03578448295593262
gen group dst list time:  0.006022930145263672
time for parepare:  0.019736766815185547
local_output_nid generation:  0.016376495361328125
local_in_edges_tensor generation:  0.03151702880859375
mini_batch_src_global generation:  0.048539161682128906
r_  generation:  0.44388651847839355
local_output_nid generation:  0.023625612258911133
local_in_edges_tensor generation:  0.0257418155670166
mini_batch_src_global generation:  0.046906232833862305
r_  generation:  0.42388153076171875
----------------------check_connections_block total spend ----------------------------- 1.2663474082946777
generate_one_block  0.5201003551483154
generate_one_block  0.5264072418212891
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.020386457443237305
gen group dst list time:  0.011463403701782227
time for parepare:  0.018800735473632812
local_output_nid generation:  0.02267909049987793
local_in_edges_tensor generation:  0.0297396183013916
mini_batch_src_global generation:  0.031217098236083984
r_  generation:  0.37486767768859863
local_output_nid generation:  0.030574560165405273
local_in_edges_tensor generation:  0.028235673904418945
mini_batch_src_global generation:  0.03776693344116211
r_  generation:  0.3804326057434082
----------------------check_connections_block total spend ----------------------------- 1.1175744533538818
generate_one_block  0.45212483406066895
generate_one_block  0.4513051509857178
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14336442947387695  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.3839218616485596
block generation total time  1.9499375820159912
average batch blocks generation time:  0.9749687910079956
block dataloader generation time/epoch 5.764755663664444
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10903215408325195  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.209489345550537  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10930585861206055  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2070937156677246  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07472681999206543 |0.011306524276733398 |0.003946423530578613 |0.04335308074951172 |0.003786325454711914 |0.0028007030487060547 |
----------------------------------------------------------pseudo_mini_loss sum 1.183537244796753
Total (block generation + training)time/epoch 6.0746153333912725
Training time/epoch 0.33702635765075684
Training time without block to device /epoch 0.31441330909729004
Training time without total dataloading part /epoch 0.10497236251831055
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 69.56it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.14it/s]100%|██████████| 4/4 [00:00<00:00, 19.28it/s]100%|██████████| 4/4 [00:00<00:00, 19.22it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.59it/s]100%|██████████| 4/4 [00:00<00:00, 17.74it/s]100%|██████████| 4/4 [00:00<00:00, 17.70it/s]
Run 00 | Epoch 00032 | Loss 1.1835 | Train 0.4225 | Val 0.5141 | Test 0.5232
Number of nodes during this epoch:  329418
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14356184005737305  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.014169931411743164
range selection method range initialization spend 0.012154579162597656
time for parepare:  0.01639842987060547
local_output_nid generation:  0.011085033416748047
local_in_edges_tensor generation:  0.007750272750854492
mini_batch_src_global generation:  0.010169506072998047
r_  generation:  0.13947081565856934
local_output_nid generation:  0.01222848892211914
local_in_edges_tensor generation:  0.007653713226318359
mini_batch_src_global generation:  0.013646364212036133
r_  generation:  0.14632368087768555
----------------------check_connections_block total spend ----------------------------- 0.42598700523376465
generate_one_block  0.1575002670288086
generate_one_block  0.1629953384399414
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03929853439331055
gen group dst list time:  0.005980014801025391
time for parepare:  0.021385669708251953
local_output_nid generation:  0.017307519912719727
local_in_edges_tensor generation:  0.033674001693725586
mini_batch_src_global generation:  0.03972315788269043
r_  generation:  0.4107935428619385
local_output_nid generation:  0.023887157440185547
local_in_edges_tensor generation:  0.03011322021484375
mini_batch_src_global generation:  0.04628896713256836
r_  generation:  0.42824363708496094
----------------------check_connections_block total spend ----------------------------- 1.2339987754821777
generate_one_block  0.5206716060638428
generate_one_block  0.5223596096038818
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.019188404083251953
gen group dst list time:  0.011568307876586914
time for parepare:  0.020403146743774414
local_output_nid generation:  0.022655963897705078
local_in_edges_tensor generation:  0.029142379760742188
mini_batch_src_global generation:  0.03151202201843262
r_  generation:  0.37119626998901367
local_output_nid generation:  0.03159666061401367
local_in_edges_tensor generation:  0.031063556671142578
mini_batch_src_global generation:  0.04034280776977539
r_  generation:  0.38488316535949707
----------------------check_connections_block total spend ----------------------------- 1.1271696090698242
generate_one_block  0.45701122283935547
generate_one_block  0.45587754249572754
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14356184005737305  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.361168384552002
block generation total time  1.9559199810028076
average batch blocks generation time:  0.9779599905014038
block dataloader generation time/epoch 5.759706815083821
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1092829704284668  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2085018157958984  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10856056213378906  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2076282501220703  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07826066017150879 |0.011580705642700195 |0.004129171371459961 |0.0005584955215454102 |0.0038862228393554688 |0.00341796875 |
----------------------------------------------------------pseudo_mini_loss sum 1.1743710041046143
Total (block generation + training)time/epoch 6.06877597173055
Training time/epoch 0.2907280921936035
Training time without block to device /epoch 0.2675666809082031
Training time without total dataloading part /epoch 0.02056574821472168
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 54.46it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.86it/s]100%|██████████| 4/4 [00:00<00:00, 15.26it/s]100%|██████████| 4/4 [00:00<00:00, 15.18it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.21it/s]100%|██████████| 4/4 [00:00<00:00, 17.51it/s]100%|██████████| 4/4 [00:00<00:00, 17.44it/s]
Run 00 | Epoch 00033 | Loss 1.1744 | Train 0.4215 | Val 0.5128 | Test 0.5209
Number of nodes during this epoch:  329339
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14356613159179688  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.017320871353149414
range selection method range initialization spend 0.011884450912475586
time for parepare:  0.016200780868530273
local_output_nid generation:  0.010813236236572266
local_in_edges_tensor generation:  0.010527610778808594
mini_batch_src_global generation:  0.010006904602050781
r_  generation:  0.13315749168395996
local_output_nid generation:  0.011764764785766602
local_in_edges_tensor generation:  0.005865812301635742
mini_batch_src_global generation:  0.013074874877929688
r_  generation:  0.14334487915039062
----------------------check_connections_block total spend ----------------------------- 0.4106893539428711
generate_one_block  0.15013480186462402
generate_one_block  0.15259599685668945
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03338789939880371
gen group dst list time:  0.005992412567138672
time for parepare:  0.019564390182495117
local_output_nid generation:  0.016004562377929688
local_in_edges_tensor generation:  0.028516054153442383
mini_batch_src_global generation:  0.03761601448059082
r_  generation:  0.4074592590332031
local_output_nid generation:  0.022736787796020508
local_in_edges_tensor generation:  0.027251005172729492
mini_batch_src_global generation:  0.046262264251708984
r_  generation:  0.426804780960083
----------------------check_connections_block total spend ----------------------------- 1.2132606506347656
generate_one_block  0.5151152610778809
generate_one_block  0.5189425945281982
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.020458221435546875
gen group dst list time:  0.011600017547607422
time for parepare:  0.01865673065185547
local_output_nid generation:  0.02149486541748047
local_in_edges_tensor generation:  0.029732227325439453
mini_batch_src_global generation:  0.03184819221496582
r_  generation:  0.3921995162963867
local_output_nid generation:  0.030058622360229492
local_in_edges_tensor generation:  0.032337188720703125
mini_batch_src_global generation:  0.03783917427062988
r_  generation:  0.3802759647369385
----------------------check_connections_block total spend ----------------------------- 1.1377394199371338
generate_one_block  0.4511756896972656
generate_one_block  0.4515974521636963
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14356613159179688  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.3510000705718994
block generation total time  1.936830997467041
average batch blocks generation time:  0.9684154987335205
block dataloader generation time/epoch 5.757716341018677
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1089634895324707  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2077302932739258  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10854721069335938  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.207409381866455  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07538056373596191 |0.011720061302185059 |0.003937244415283203 |0.0005124807357788086 |0.0038529634475708008 |0.0038881301879882812 |
----------------------------------------------------------pseudo_mini_loss sum 1.16437828540802
Total (block generation + training)time/epoch 6.066277990341186
Training time/epoch 0.2962310314178467
Training time without block to device /epoch 0.27279090881347656
Training time without total dataloading part /epoch 0.020493507385253906
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 62.56it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.10it/s]100%|██████████| 4/4 [00:00<00:00, 15.28it/s]100%|██████████| 4/4 [00:00<00:00, 15.23it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.65it/s]100%|██████████| 4/4 [00:00<00:00, 14.94it/s]100%|██████████| 4/4 [00:00<00:00, 15.16it/s]
Run 00 | Epoch 00034 | Loss 1.1644 | Train 0.4214 | Val 0.5131 | Test 0.5215
Number of nodes during this epoch:  329387
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14375591278076172  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.016520977020263672
range selection method range initialization spend 0.011843204498291016
time for parepare:  0.017069101333618164
local_output_nid generation:  0.011370658874511719
local_in_edges_tensor generation:  0.008985042572021484
mini_batch_src_global generation:  0.00982356071472168
r_  generation:  0.13489770889282227
local_output_nid generation:  0.012270450592041016
local_in_edges_tensor generation:  0.006860017776489258
mini_batch_src_global generation:  0.013080358505249023
r_  generation:  0.14529061317443848
----------------------check_connections_block total spend ----------------------------- 0.41611146926879883
generate_one_block  0.1539616584777832
generate_one_block  0.15396952629089355
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02994060516357422
gen group dst list time:  0.005980968475341797
time for parepare:  0.02024078369140625
local_output_nid generation:  0.016918659210205078
local_in_edges_tensor generation:  0.027286052703857422
mini_batch_src_global generation:  0.03827214241027832
r_  generation:  0.4134867191314697
local_output_nid generation:  0.02380061149597168
local_in_edges_tensor generation:  0.02713155746459961
mini_batch_src_global generation:  0.045923709869384766
r_  generation:  0.427356481552124
----------------------check_connections_block total spend ----------------------------- 1.2219479084014893
generate_one_block  0.518958568572998
generate_one_block  0.5238690376281738
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.020438671112060547
gen group dst list time:  0.01187753677368164
time for parepare:  0.018754005432128906
local_output_nid generation:  0.023652315139770508
local_in_edges_tensor generation:  0.029162168502807617
mini_batch_src_global generation:  0.031049489974975586
r_  generation:  0.3735222816467285
local_output_nid generation:  0.03163719177246094
local_in_edges_tensor generation:  0.030287742614746094
mini_batch_src_global generation:  0.03811025619506836
r_  generation:  0.382051944732666
----------------------check_connections_block total spend ----------------------------- 1.1242759227752686
generate_one_block  0.45056629180908203
generate_one_block  0.46269726753234863
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14375591278076172  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.346223831176758
block generation total time  1.9560911655426025
average batch blocks generation time:  0.9780455827713013
block dataloader generation time/epoch 5.756476833270146
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1089930534362793  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.207566738128662  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10852336883544922  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2076258659362793  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08108758926391602 |0.01296687126159668 |0.004170656204223633 |0.0005172491073608398 |0.0032227039337158203 |0.0014216899871826172 |
----------------------------------------------------------pseudo_mini_loss sum 1.159804344177246
Total (block generation + training)time/epoch 6.064910540213952
Training time/epoch 0.3050973415374756
Training time without block to device /epoch 0.2791635990142822
Training time without total dataloading part /epoch 0.017242908477783203
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.38it/s]100%|██████████| 4/4 [00:00<00:00, 30.94it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.55it/s]100%|██████████| 4/4 [00:00<00:00, 12.25it/s]100%|██████████| 4/4 [00:00<00:00, 12.13it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.11it/s]100%|██████████| 4/4 [00:00<00:00, 16.44it/s]100%|██████████| 4/4 [00:00<00:00, 16.52it/s]
Run 00 | Epoch 00035 | Loss 1.1598 | Train 0.4216 | Val 0.5134 | Test 0.5220
Number of nodes during this epoch:  329108
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1445636749267578  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.015486001968383789
range selection method range initialization spend 0.011703014373779297
time for parepare:  0.016793251037597656
local_output_nid generation:  0.010833024978637695
local_in_edges_tensor generation:  0.008773326873779297
mini_batch_src_global generation:  0.010448694229125977
r_  generation:  0.13329648971557617
local_output_nid generation:  0.01216268539428711
local_in_edges_tensor generation:  0.006258249282836914
mini_batch_src_global generation:  0.013169288635253906
r_  generation:  0.14479994773864746
----------------------check_connections_block total spend ----------------------------- 0.41301846504211426
generate_one_block  0.15151095390319824
generate_one_block  0.15434575080871582
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03229975700378418
gen group dst list time:  0.006012916564941406
time for parepare:  0.019934892654418945
local_output_nid generation:  0.016356468200683594
local_in_edges_tensor generation:  0.029662609100341797
mini_batch_src_global generation:  0.03949093818664551
r_  generation:  0.409102201461792
local_output_nid generation:  0.023540019989013672
local_in_edges_tensor generation:  0.02466273307800293
mini_batch_src_global generation:  0.046839237213134766
r_  generation:  0.4246864318847656
----------------------check_connections_block total spend ----------------------------- 1.2163302898406982
generate_one_block  0.5191376209259033
generate_one_block  0.5272042751312256
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0200955867767334
gen group dst list time:  0.011727571487426758
time for parepare:  0.018810272216796875
local_output_nid generation:  0.02264857292175293
local_in_edges_tensor generation:  0.03079819679260254
mini_batch_src_global generation:  0.03216290473937988
r_  generation:  0.3746349811553955
local_output_nid generation:  0.03127646446228027
local_in_edges_tensor generation:  0.027957439422607422
mini_batch_src_global generation:  0.03969216346740723
r_  generation:  0.38360071182250977
----------------------check_connections_block total spend ----------------------------- 1.1254997253417969
generate_one_block  0.45836520195007324
generate_one_block  0.45679736137390137
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1445636749267578  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.341830015182495
block generation total time  1.9615044593811035
average batch blocks generation time:  0.9807522296905518
block dataloader generation time/epoch 5.754638777838813
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1089320182800293  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.207352638244629  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10857295989990234  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.208247184753418  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08207345008850098 |0.012295007705688477 |0.0040798187255859375 |0.0005437135696411133 |0.003217935562133789 |0.002918720245361328 |
----------------------------------------------------------pseudo_mini_loss sum 1.1541476249694824
Total (block generation + training)time/epoch 6.063212341732449
Training time/epoch 0.31206703186035156
Training time without block to device /epoch 0.2874770164489746
Training time without total dataloading part /epoch 0.018601655960083008
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 56.45it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.11it/s]100%|██████████| 4/4 [00:00<00:00, 15.52it/s]100%|██████████| 4/4 [00:00<00:00, 15.44it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.49it/s]100%|██████████| 4/4 [00:00<00:00, 17.85it/s]100%|██████████| 4/4 [00:00<00:00, 17.78it/s]
Run 00 | Epoch 00036 | Loss 1.1541 | Train 0.4197 | Val 0.5141 | Test 0.5225
Number of nodes during this epoch:  329252
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1443181037902832  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.017673254013061523
range selection method range initialization spend 0.011905193328857422
time for parepare:  0.019281864166259766
local_output_nid generation:  0.011267662048339844
local_in_edges_tensor generation:  0.009426593780517578
mini_batch_src_global generation:  0.009848356246948242
r_  generation:  0.14069175720214844
local_output_nid generation:  0.016662120819091797
local_in_edges_tensor generation:  0.007308244705200195
mini_batch_src_global generation:  0.016128063201904297
r_  generation:  0.14963769912719727
----------------------check_connections_block total spend ----------------------------- 0.439772367477417
generate_one_block  0.1557307243347168
generate_one_block  0.15642762184143066
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03602719306945801
gen group dst list time:  0.00597071647644043
time for parepare:  0.022019386291503906
local_output_nid generation:  0.016831636428833008
local_in_edges_tensor generation:  0.04133915901184082
mini_batch_src_global generation:  0.03988313674926758
r_  generation:  0.41260194778442383
local_output_nid generation:  0.023029327392578125
local_in_edges_tensor generation:  0.031478166580200195
mini_batch_src_global generation:  0.04650998115539551
r_  generation:  0.42556118965148926
----------------------check_connections_block total spend ----------------------------- 1.2424836158752441
generate_one_block  0.5225415229797363
generate_one_block  0.5310614109039307
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02085113525390625
gen group dst list time:  0.011694908142089844
time for parepare:  0.019269943237304688
local_output_nid generation:  0.02247762680053711
local_in_edges_tensor generation:  0.03805136680603027
mini_batch_src_global generation:  0.032061100006103516
r_  generation:  0.3756721019744873
local_output_nid generation:  0.030217647552490234
local_in_edges_tensor generation:  0.026394367218017578
mini_batch_src_global generation:  0.03822803497314453
r_  generation:  0.38389110565185547
----------------------check_connections_block total spend ----------------------------- 1.1330361366271973
generate_one_block  0.4642479419708252
generate_one_block  0.4609353542327881
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1443181037902832  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.3755197525024414
block generation total time  1.9787862300872803
average batch blocks generation time:  0.9893931150436401
block dataloader generation time/epoch 5.75612565449306
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10901498794555664  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2079238891601562  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1085515022277832  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.208045482635498  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07897031307220459 |0.012086868286132812 |0.004201054573059082 |0.00052642822265625 |0.003156304359436035 |0.0029320716857910156 |
----------------------------------------------------------pseudo_mini_loss sum 1.1479923725128174
Total (block generation + training)time/epoch 6.064420921461923
Training time/epoch 0.3006322383880615
Training time without block to device /epoch 0.2764585018157959
Training time without total dataloading part /epoch 0.01869964599609375
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.69it/s]100%|██████████| 4/4 [00:00<00:00, 30.59it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.35it/s]100%|██████████| 4/4 [00:00<00:00, 12.69it/s]100%|██████████| 4/4 [00:00<00:00, 12.46it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.98it/s]100%|██████████| 4/4 [00:00<00:00, 17.57it/s]100%|██████████| 4/4 [00:00<00:00, 17.46it/s]
Run 00 | Epoch 00037 | Loss 1.1480 | Train 0.4174 | Val 0.5134 | Test 0.5224
Number of nodes during this epoch:  329269
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14421796798706055  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.016071557998657227
range selection method range initialization spend 0.011696815490722656
time for parepare:  0.016597747802734375
local_output_nid generation:  0.010894298553466797
local_in_edges_tensor generation:  0.0075910091400146484
mini_batch_src_global generation:  0.009874820709228516
r_  generation:  0.1310255527496338
local_output_nid generation:  0.012410402297973633
local_in_edges_tensor generation:  0.0060002803802490234
mini_batch_src_global generation:  0.013117313385009766
r_  generation:  0.14406585693359375
----------------------check_connections_block total spend ----------------------------- 0.408031702041626
generate_one_block  0.14966559410095215
generate_one_block  0.15331149101257324
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03122115135192871
gen group dst list time:  0.0058367252349853516
time for parepare:  0.020388126373291016
local_output_nid generation:  0.016278743743896484
local_in_edges_tensor generation:  0.02478766441345215
mini_batch_src_global generation:  0.03959321975708008
r_  generation:  0.409970760345459
local_output_nid generation:  0.024550914764404297
local_in_edges_tensor generation:  0.02375960350036621
mini_batch_src_global generation:  0.045949697494506836
r_  generation:  0.4256248474121094
----------------------check_connections_block total spend ----------------------------- 1.2122623920440674
generate_one_block  0.5531351566314697
generate_one_block  0.5337066650390625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.022428035736083984
gen group dst list time:  0.013393163681030273
time for parepare:  0.019576549530029297
local_output_nid generation:  0.023231983184814453
local_in_edges_tensor generation:  0.03617119789123535
mini_batch_src_global generation:  0.039138078689575195
r_  generation:  0.37286829948425293
local_output_nid generation:  0.03083944320678711
local_in_edges_tensor generation:  0.026376008987426758
mini_batch_src_global generation:  0.03738856315612793
r_  generation:  0.38511228561401367
----------------------check_connections_block total spend ----------------------------- 1.1356515884399414
generate_one_block  0.45435667037963867
generate_one_block  0.4518296718597412
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14421796798706055  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.347913980484009
block generation total time  1.993028163909912
average batch blocks generation time:  0.996514081954956
block dataloader generation time/epoch 5.756018556397537
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1089930534362793  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2074403762817383  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10854673385620117  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2077102661132812  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07786333560943604 |0.014181375503540039 |0.004910826683044434 |0.0005663633346557617 |0.002785801887512207 |0.001665353775024414 |
----------------------------------------------------------pseudo_mini_loss sum 1.1423556804656982
Total (block generation + training)time/epoch 6.064242601394653
Training time/epoch 0.30608153343200684
Training time without block to device /epoch 0.27771878242492676
Training time without total dataloading part /epoch 0.01819133758544922
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.13it/s]100%|██████████| 4/4 [00:00<00:00, 30.25it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.56it/s]100%|██████████| 4/4 [00:00<00:00, 12.74it/s]100%|██████████| 4/4 [00:00<00:00, 12.54it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.83it/s]100%|██████████| 4/4 [00:00<00:00, 17.95it/s]
Run 00 | Epoch 00038 | Loss 1.1424 | Train 0.4156 | Val 0.5113 | Test 0.5212
Number of nodes during this epoch:  329205
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1434612274169922  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.012874364852905273
range selection method range initialization spend 0.012011528015136719
time for parepare:  0.016442298889160156
local_output_nid generation:  0.010841131210327148
local_in_edges_tensor generation:  0.007798194885253906
mini_batch_src_global generation:  0.010140180587768555
r_  generation:  0.13490796089172363
local_output_nid generation:  0.011813163757324219
local_in_edges_tensor generation:  0.0053577423095703125
mini_batch_src_global generation:  0.012957096099853516
r_  generation:  0.14603328704833984
----------------------check_connections_block total spend ----------------------------- 0.4134080410003662
generate_one_block  0.15291500091552734
generate_one_block  0.1529836654663086
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02800893783569336
gen group dst list time:  0.0059163570404052734
time for parepare:  0.020930767059326172
local_output_nid generation:  0.016560792922973633
local_in_edges_tensor generation:  0.02881479263305664
mini_batch_src_global generation:  0.03878426551818848
r_  generation:  0.4158453941345215
local_output_nid generation:  0.023699522018432617
local_in_edges_tensor generation:  0.025028228759765625
mini_batch_src_global generation:  0.04871249198913574
r_  generation:  0.44103169441223145
----------------------check_connections_block total spend ----------------------------- 1.2462117671966553
generate_one_block  0.547278642654419
generate_one_block  0.5335626602172852
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.024196147918701172
gen group dst list time:  0.013852596282958984
time for parepare:  0.018871784210205078
local_output_nid generation:  0.02344202995300293
local_in_edges_tensor generation:  0.042130470275878906
mini_batch_src_global generation:  0.04093146324157715
r_  generation:  0.38635754585266113
local_output_nid generation:  0.032120466232299805
local_in_edges_tensor generation:  0.02943730354309082
mini_batch_src_global generation:  0.039450883865356445
r_  generation:  0.41921162605285645
----------------------check_connections_block total spend ----------------------------- 1.2284038066864014
generate_one_block  0.5132246017456055
generate_one_block  0.4894142150878906
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1434612274169922  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.4746155738830566
block generation total time  2.0834801197052
average batch blocks generation time:  1.0417400598526
block dataloader generation time/epoch 5.764414230982463
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10898447036743164  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2071123123168945  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10860586166381836  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2079896926879883  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07984805107116699 |0.025841712951660156 |0.003978252410888672 |0.000502467155456543 |0.003956437110900879 |0.0034253597259521484 |
----------------------------------------------------------pseudo_mini_loss sum 1.131844162940979
Total (block generation + training)time/epoch 6.073524109522501
Training time/epoch 0.33463215827941895
Training time without block to device /epoch 0.28294873237609863
Training time without total dataloading part /epoch 0.020299673080444336
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 47.76it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.67it/s]100%|██████████| 4/4 [00:00<00:00, 15.77it/s]100%|██████████| 4/4 [00:00<00:00, 15.74it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.96it/s]100%|██████████| 4/4 [00:00<00:00, 18.14it/s]100%|██████████| 4/4 [00:00<00:00, 18.09it/s]
Run 00 | Epoch 00039 | Loss 1.1318 | Train 0.4145 | Val 0.5094 | Test 0.5192
Number of nodes during this epoch:  329292
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1439371109008789  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.015439748764038086
range selection method range initialization spend 0.012049674987792969
time for parepare:  0.017911911010742188
local_output_nid generation:  0.011545181274414062
local_in_edges_tensor generation:  0.02947521209716797
mini_batch_src_global generation:  0.010083198547363281
r_  generation:  0.14136528968811035
local_output_nid generation:  0.012598514556884766
local_in_edges_tensor generation:  0.006799221038818359
mini_batch_src_global generation:  0.012990951538085938
r_  generation:  0.14659690856933594
----------------------check_connections_block total spend ----------------------------- 0.4525279998779297
generate_one_block  0.15082502365112305
generate_one_block  0.15460634231567383
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03306984901428223
gen group dst list time:  0.005918025970458984
time for parepare:  0.020307302474975586
local_output_nid generation:  0.016336917877197266
local_in_edges_tensor generation:  0.03714561462402344
mini_batch_src_global generation:  0.038668155670166016
r_  generation:  0.41852831840515137
local_output_nid generation:  0.022691965103149414
local_in_edges_tensor generation:  0.029730796813964844
mini_batch_src_global generation:  0.04607081413269043
r_  generation:  0.42801952362060547
----------------------check_connections_block total spend ----------------------------- 1.2390105724334717
generate_one_block  0.5250349044799805
generate_one_block  0.5234425067901611
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.019254207611083984
gen group dst list time:  0.011661767959594727
time for parepare:  0.019315481185913086
local_output_nid generation:  0.02202582359313965
local_in_edges_tensor generation:  0.029787063598632812
mini_batch_src_global generation:  0.03066253662109375
r_  generation:  0.3772404193878174
local_output_nid generation:  0.03176259994506836
local_in_edges_tensor generation:  0.032692670822143555
mini_batch_src_global generation:  0.0441129207611084
r_  generation:  0.38169050216674805
----------------------check_connections_block total spend ----------------------------- 1.1337616443634033
generate_one_block  0.49146032333374023
generate_one_block  0.47181153297424316
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1439371109008789  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.372772216796875
block generation total time  2.011749267578125
average batch blocks generation time:  1.0058746337890625
block dataloader generation time/epoch 5.767095588868664
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10896921157836914  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2071890830993652  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1085662841796875  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2077035903930664  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08037197589874268 |0.01718449592590332 |0.004332065582275391 |0.0005376338958740234 |0.002601027488708496 |0.0014333724975585938 |
----------------------------------------------------------pseudo_mini_loss sum 1.1299500465393066
Total (block generation + training)time/epoch 6.076364686412196
Training time/epoch 0.31389617919921875
Training time without block to device /epoch 0.2795271873474121
Training time without total dataloading part /epoch 0.016374826431274414
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.36it/s]100%|██████████| 4/4 [00:00<00:00, 29.94it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 12.09it/s]100%|██████████| 4/4 [00:00<00:00, 13.07it/s]100%|██████████| 4/4 [00:00<00:00, 12.90it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.17it/s]100%|██████████| 4/4 [00:00<00:00, 18.71it/s]100%|██████████| 4/4 [00:00<00:00, 18.61it/s]
Run 00 | Epoch 00040 | Loss 1.1300 | Train 0.4136 | Val 0.5074 | Test 0.5169
Number of nodes during this epoch:  329254
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1444988250732422  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.012130975723266602
range selection method range initialization spend 0.011781692504882812
time for parepare:  0.01688241958618164
local_output_nid generation:  0.010894775390625
local_in_edges_tensor generation:  0.010586261749267578
mini_batch_src_global generation:  0.01567363739013672
r_  generation:  0.1393718719482422
local_output_nid generation:  0.013383865356445312
local_in_edges_tensor generation:  0.0056915283203125
mini_batch_src_global generation:  0.012868642807006836
r_  generation:  0.15120816230773926
----------------------check_connections_block total spend ----------------------------- 0.439100980758667
generate_one_block  0.17346787452697754
generate_one_block  0.1687452793121338
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029565095901489258
gen group dst list time:  0.007160186767578125
time for parepare:  0.02085137367248535
local_output_nid generation:  0.020717382431030273
local_in_edges_tensor generation:  0.029042959213256836
mini_batch_src_global generation:  0.0392608642578125
r_  generation:  0.4700942039489746
local_output_nid generation:  0.028847217559814453
local_in_edges_tensor generation:  0.028342723846435547
mini_batch_src_global generation:  0.05469369888305664
r_  generation:  0.4926719665527344
----------------------check_connections_block total spend ----------------------------- 1.3964447975158691
generate_one_block  0.5625619888305664
generate_one_block  0.5405752658843994
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.019527196884155273
gen group dst list time:  0.012994766235351562
time for parepare:  0.019280195236206055
local_output_nid generation:  0.02293109893798828
local_in_edges_tensor generation:  0.0363156795501709
mini_batch_src_global generation:  0.032254934310913086
r_  generation:  0.37490415573120117
local_output_nid generation:  0.03137087821960449
local_in_edges_tensor generation:  0.031223058700561523
mini_batch_src_global generation:  0.03753972053527832
r_  generation:  0.3988840579986572
----------------------check_connections_block total spend ----------------------------- 1.1536242961883545
generate_one_block  0.4553844928741455
generate_one_block  0.45353174209594727
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1444988250732422  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.5500690937042236
block generation total time  2.0120534896850586
average batch blocks generation time:  1.0060267448425293
block dataloader generation time/epoch 5.775233246386051
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10899019241333008  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2075486183166504  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10854721069335938  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2075505256652832  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09302914142608643 |0.01895880699157715 |0.004010915756225586 |0.0005322694778442383 |0.0032558441162109375 |0.0035762786865234375 |
----------------------------------------------------------pseudo_mini_loss sum 1.1238946914672852
Total (block generation + training)time/epoch 6.085263125598431
Training time/epoch 0.3334517478942871
Training time without block to device /epoch 0.2955341339111328
Training time without total dataloading part /epoch 0.01917433738708496
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 50.26it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.01it/s]100%|██████████| 4/4 [00:00<00:00, 15.39it/s]100%|██████████| 4/4 [00:00<00:00, 15.32it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.29it/s]100%|██████████| 4/4 [00:00<00:00, 17.74it/s]100%|██████████| 4/4 [00:00<00:00, 17.65it/s]
Run 00 | Epoch 00041 | Loss 1.1239 | Train 0.4121 | Val 0.5039 | Test 0.5120
Number of nodes during this epoch:  329326
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1436142921447754  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01475071907043457
range selection method range initialization spend 0.012073278427124023
time for parepare:  0.016154766082763672
local_output_nid generation:  0.011344432830810547
local_in_edges_tensor generation:  0.009378433227539062
mini_batch_src_global generation:  0.009810686111450195
r_  generation:  0.13848447799682617
local_output_nid generation:  0.012230634689331055
local_in_edges_tensor generation:  0.0060884952545166016
mini_batch_src_global generation:  0.014214038848876953
r_  generation:  0.14920973777770996
----------------------check_connections_block total spend ----------------------------- 0.424130916595459
generate_one_block  0.15733957290649414
generate_one_block  0.16221308708190918
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0331568717956543
gen group dst list time:  0.00582432746887207
time for parepare:  0.02073383331298828
local_output_nid generation:  0.017168045043945312
local_in_edges_tensor generation:  0.03815746307373047
mini_batch_src_global generation:  0.03850841522216797
r_  generation:  0.41597533226013184
local_output_nid generation:  0.024328947067260742
local_in_edges_tensor generation:  0.03534960746765137
mini_batch_src_global generation:  0.0476682186126709
r_  generation:  0.43053531646728516
----------------------check_connections_block total spend ----------------------------- 1.2527976036071777
generate_one_block  0.5479474067687988
generate_one_block  0.5356528759002686
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0219268798828125
gen group dst list time:  0.012337446212768555
time for parepare:  0.021268844604492188
local_output_nid generation:  0.02381753921508789
local_in_edges_tensor generation:  0.033345699310302734
mini_batch_src_global generation:  0.03039407730102539
r_  generation:  0.3898296356201172
local_output_nid generation:  0.034526824951171875
local_in_edges_tensor generation:  0.030545949935913086
mini_batch_src_global generation:  0.0378265380859375
r_  generation:  0.38073110580444336
----------------------check_connections_block total spend ----------------------------- 1.1507246494293213
generate_one_block  0.45035767555236816
generate_one_block  0.4457557201385498
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1436142921447754  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.403522253036499
block generation total time  1.9797136783599854
average batch blocks generation time:  0.9898568391799927
block dataloader generation time/epoch 5.776429920485525
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10893583297729492  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2074599266052246  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10859966278076172  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2081527709960938  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09269416332244873 |0.01716291904449463 |0.0041588544845581055 |0.0005221366882324219 |0.0038460493087768555 |0.0013737678527832031 |
----------------------------------------------------------pseudo_mini_loss sum 1.119401216506958
Total (block generation + training)time/epoch 6.087418837980791
Training time/epoch 0.3415257930755615
Training time without block to device /epoch 0.30719995498657227
Training time without total dataloading part /epoch 0.01842784881591797
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.32it/s]100%|██████████| 4/4 [00:00<00:00, 29.83it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.60it/s]100%|██████████| 4/4 [00:00<00:00, 12.81it/s]100%|██████████| 4/4 [00:00<00:00, 12.61it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.84it/s]100%|██████████| 4/4 [00:00<00:00, 17.75it/s]100%|██████████| 4/4 [00:00<00:00, 17.75it/s]
Run 00 | Epoch 00042 | Loss 1.1194 | Train 0.4088 | Val 0.4985 | Test 0.5056
Number of nodes during this epoch:  329407
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1442432403564453  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.017446279525756836
range selection method range initialization spend 0.011733055114746094
time for parepare:  0.01815342903137207
local_output_nid generation:  0.011285781860351562
local_in_edges_tensor generation:  0.008905887603759766
mini_batch_src_global generation:  0.009984970092773438
r_  generation:  0.13493633270263672
local_output_nid generation:  0.011754989624023438
local_in_edges_tensor generation:  0.005282878875732422
mini_batch_src_global generation:  0.015051841735839844
r_  generation:  0.14589452743530273
----------------------check_connections_block total spend ----------------------------- 0.4173917770385742
generate_one_block  0.1572253704071045
generate_one_block  0.15510821342468262
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.024905920028686523
gen group dst list time:  0.006755828857421875
time for parepare:  0.020566225051879883
local_output_nid generation:  0.016881942749023438
local_in_edges_tensor generation:  0.029486656188964844
mini_batch_src_global generation:  0.04107499122619629
r_  generation:  0.42716217041015625
local_output_nid generation:  0.030287981033325195
local_in_edges_tensor generation:  0.03455615043640137
mini_batch_src_global generation:  0.06007194519042969
r_  generation:  0.434948205947876
----------------------check_connections_block total spend ----------------------------- 1.2837185859680176
generate_one_block  0.5464653968811035
generate_one_block  0.5390095710754395
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.024474620819091797
gen group dst list time:  0.012950658798217773
time for parepare:  0.019712209701538086
local_output_nid generation:  0.02357625961303711
local_in_edges_tensor generation:  0.042365312576293945
mini_batch_src_global generation:  0.032874345779418945
r_  generation:  0.3752892017364502
local_output_nid generation:  0.03795576095581055
local_in_edges_tensor generation:  0.03650307655334473
mini_batch_src_global generation:  0.04626893997192383
r_  generation:  0.38538074493408203
----------------------check_connections_block total spend ----------------------------- 1.168433666229248
generate_one_block  0.45614171028137207
generate_one_block  0.4730393886566162
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1442432403564453  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.4521522521972656
block generation total time  2.0146560668945312
average batch blocks generation time:  1.0073280334472656
block dataloader generation time/epoch 5.779224241481108
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10900163650512695  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.207226276397705  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1086111068725586  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2079315185546875  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07774043083190918 |0.017521262168884277 |0.0040465593338012695 |0.000518798828125 |0.0033125877380371094 |0.001531839370727539 |
----------------------------------------------------------pseudo_mini_loss sum 1.1102206707000732
Total (block generation + training)time/epoch 6.090303000281839
Training time/epoch 0.31389403343200684
Training time without block to device /epoch 0.2788515090942383
Training time without total dataloading part /epoch 0.017287731170654297
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 57.27it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.92it/s]100%|██████████| 4/4 [00:00<00:00, 15.54it/s]100%|██████████| 4/4 [00:00<00:00, 15.43it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.28it/s]100%|██████████| 4/4 [00:00<00:00, 17.90it/s]100%|██████████| 4/4 [00:00<00:00, 17.78it/s]
Run 00 | Epoch 00043 | Loss 1.1102 | Train 0.4047 | Val 0.4912 | Test 0.4980
Number of nodes during this epoch:  329397
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14393043518066406  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.014253377914428711
range selection method range initialization spend 0.011580228805541992
time for parepare:  0.0166778564453125
local_output_nid generation:  0.011136531829833984
local_in_edges_tensor generation:  0.008614063262939453
mini_batch_src_global generation:  0.010422945022583008
r_  generation:  0.13196635246276855
local_output_nid generation:  0.01187276840209961
local_in_edges_tensor generation:  0.005313873291015625
mini_batch_src_global generation:  0.013238668441772461
r_  generation:  0.14237260818481445
----------------------check_connections_block total spend ----------------------------- 0.4086439609527588
generate_one_block  0.1503126621246338
generate_one_block  0.1536405086517334
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.026021718978881836
gen group dst list time:  0.005816936492919922
time for parepare:  0.02004528045654297
local_output_nid generation:  0.016315937042236328
local_in_edges_tensor generation:  0.024688720703125
mini_batch_src_global generation:  0.03759956359863281
r_  generation:  0.4098937511444092
local_output_nid generation:  0.023772001266479492
local_in_edges_tensor generation:  0.02390599250793457
mini_batch_src_global generation:  0.04530453681945801
r_  generation:  0.42319655418395996
----------------------check_connections_block total spend ----------------------------- 1.206768274307251
generate_one_block  0.5564711093902588
generate_one_block  0.5337495803833008
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.024688243865966797
gen group dst list time:  0.013567447662353516
time for parepare:  0.018591642379760742
local_output_nid generation:  0.023653507232666016
local_in_edges_tensor generation:  0.03638124465942383
mini_batch_src_global generation:  0.03301835060119629
r_  generation:  0.3730332851409912
local_output_nid generation:  0.03140997886657715
local_in_edges_tensor generation:  0.029552459716796875
mini_batch_src_global generation:  0.037848472595214844
r_  generation:  0.38643622398376465
----------------------check_connections_block total spend ----------------------------- 1.1340572834014893
generate_one_block  0.4634406566619873
generate_one_block  0.45763206481933594
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14393043518066406  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.3408255577087402
block generation total time  2.011293411254883
average batch blocks generation time:  1.0056467056274414
block dataloader generation time/epoch 5.777985218593052
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1089940071105957  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2079267501831055  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10844230651855469  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.208939552307129  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08217918872833252 |0.013467550277709961 |0.004086971282958984 |0.0005147457122802734 |0.0029755830764770508 |0.0013666152954101562 |
----------------------------------------------------------pseudo_mini_loss sum 1.111363172531128
Total (block generation + training)time/epoch 6.088841608592442
Training time/epoch 0.3031485080718994
Training time without block to device /epoch 0.2762134075164795
Training time without total dataloading part /epoch 0.016521215438842773
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.28it/s]100%|██████████| 4/4 [00:00<00:00, 29.56it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.64it/s]100%|██████████| 4/4 [00:00<00:00, 12.69it/s]100%|██████████| 4/4 [00:00<00:00, 12.51it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.69it/s]100%|██████████| 4/4 [00:00<00:00, 17.24it/s]100%|██████████| 4/4 [00:00<00:00, 17.13it/s]
Run 00 | Epoch 00044 | Loss 1.1114 | Train 0.4002 | Val 0.4826 | Test 0.4895
Number of nodes during this epoch:  329426
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1445603370666504  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01659560203552246
range selection method range initialization spend 0.011805057525634766
time for parepare:  0.016450166702270508
local_output_nid generation:  0.01123189926147461
local_in_edges_tensor generation:  0.05723381042480469
mini_batch_src_global generation:  0.010587215423583984
r_  generation:  0.13445281982421875
local_output_nid generation:  0.011796236038208008
local_in_edges_tensor generation:  0.006190061569213867
mini_batch_src_global generation:  0.013019561767578125
r_  generation:  0.1439990997314453
----------------------check_connections_block total spend ----------------------------- 0.461162805557251
generate_one_block  0.15107011795043945
generate_one_block  0.15471458435058594
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028929948806762695
gen group dst list time:  0.0058100223541259766
time for parepare:  0.020017623901367188
local_output_nid generation:  0.016588687896728516
local_in_edges_tensor generation:  0.028531551361083984
mini_batch_src_global generation:  0.039690256118774414
r_  generation:  0.41443538665771484
local_output_nid generation:  0.02381420135498047
local_in_edges_tensor generation:  0.025686979293823242
mini_batch_src_global generation:  0.046530961990356445
r_  generation:  0.4303412437438965
----------------------check_connections_block total spend ----------------------------- 1.2333240509033203
generate_one_block  0.5291140079498291
generate_one_block  0.5262172222137451
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01991438865661621
gen group dst list time:  0.011688947677612305
time for parepare:  0.01897287368774414
local_output_nid generation:  0.024023056030273438
local_in_edges_tensor generation:  0.029675722122192383
mini_batch_src_global generation:  0.031828880310058594
r_  generation:  0.3774709701538086
local_output_nid generation:  0.03209495544433594
local_in_edges_tensor generation:  0.029148578643798828
mini_batch_src_global generation:  0.038033485412597656
r_  generation:  0.3827860355377197
----------------------check_connections_block total spend ----------------------------- 1.1311588287353516
generate_one_block  0.4590799808502197
generate_one_block  0.46930646896362305
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1445603370666504  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.364482879638672
block generation total time  1.983717679977417
average batch blocks generation time:  0.9918588399887085
block dataloader generation time/epoch 5.779021183649699
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10931396484375  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.20808744430542  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10858535766601562  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2081856727600098  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08050036430358887 |0.01848018169403076 |0.004038810729980469 |0.0005154609680175781 |0.0032510757446289062 |0.0019795894622802734 |
----------------------------------------------------------pseudo_mini_loss sum 1.1048461198806763
Total (block generation + training)time/epoch 6.089999702241686
Training time/epoch 0.3151116371154785
Training time without block to device /epoch 0.278151273727417
Training time without total dataloading part /epoch 0.01759028434753418
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 51.40it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.22it/s]100%|██████████| 4/4 [00:00<00:00, 15.49it/s]100%|██████████| 4/4 [00:00<00:00, 15.44it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.36it/s]100%|██████████| 4/4 [00:00<00:00, 17.64it/s]100%|██████████| 4/4 [00:00<00:00, 17.58it/s]
Run 00 | Epoch 00045 | Loss 1.1048 | Train 0.3962 | Val 0.4737 | Test 0.4815
Number of nodes during this epoch:  329334
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14364385604858398  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01215982437133789
range selection method range initialization spend 0.011880874633789062
time for parepare:  0.016206979751586914
local_output_nid generation:  0.011333227157592773
local_in_edges_tensor generation:  0.011426687240600586
mini_batch_src_global generation:  0.009998083114624023
r_  generation:  0.13468289375305176
local_output_nid generation:  0.01185917854309082
local_in_edges_tensor generation:  0.005880117416381836
mini_batch_src_global generation:  0.01308894157409668
r_  generation:  0.14520788192749023
----------------------check_connections_block total spend ----------------------------- 0.41614866256713867
generate_one_block  0.15035748481750488
generate_one_block  0.15288329124450684
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.027801990509033203
gen group dst list time:  0.005734920501708984
time for parepare:  0.020079612731933594
local_output_nid generation:  0.016248703002929688
local_in_edges_tensor generation:  0.031089067459106445
mini_batch_src_global generation:  0.03882145881652832
r_  generation:  0.41860008239746094
local_output_nid generation:  0.02437591552734375
local_in_edges_tensor generation:  0.023415088653564453
mini_batch_src_global generation:  0.04663562774658203
r_  generation:  0.4290034770965576
----------------------check_connections_block total spend ----------------------------- 1.2318799495697021
generate_one_block  0.5274257659912109
generate_one_block  0.5203022956848145
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01984095573425293
gen group dst list time:  0.01153874397277832
time for parepare:  0.019555330276489258
local_output_nid generation:  0.023190736770629883
local_in_edges_tensor generation:  0.029282808303833008
mini_batch_src_global generation:  0.03276491165161133
r_  generation:  0.3734853267669678
local_output_nid generation:  0.03319215774536133
local_in_edges_tensor generation:  0.026178359985351562
mini_batch_src_global generation:  0.03845047950744629
r_  generation:  0.3812711238861084
----------------------check_connections_block total spend ----------------------------- 1.1227660179138184
generate_one_block  0.4470529556274414
generate_one_block  0.4494490623474121
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14364385604858398  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.3546459674835205
block generation total time  1.944230079650879
average batch blocks generation time:  0.9721150398254395
block dataloader generation time/epoch 5.7766365747194035
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10898065567016602  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2070508003234863  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1086435317993164  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2083821296691895  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07957649230957031 |0.01193702220916748 |0.003957509994506836 |0.0005196332931518555 |0.003213047981262207 |0.0014541149139404297 |
----------------------------------------------------------pseudo_mini_loss sum 1.1015677452087402
Total (block generation + training)time/epoch 6.087073119910988
Training time/epoch 0.2908313274383545
Training time without block to device /epoch 0.26695728302001953
Training time without total dataloading part /epoch 0.016834497451782227
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 59.65it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.53it/s]100%|██████████| 4/4 [00:00<00:00, 15.10it/s]100%|██████████| 4/4 [00:00<00:00, 15.00it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.39it/s]100%|██████████| 4/4 [00:00<00:00, 15.62it/s]100%|██████████| 4/4 [00:00<00:00, 15.41it/s]
Run 00 | Epoch 00046 | Loss 1.1016 | Train 0.3931 | Val 0.4665 | Test 0.4734
Number of nodes during this epoch:  329379
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14359807968139648  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02013373374938965
range selection method range initialization spend 0.011921405792236328
time for parepare:  0.016571998596191406
local_output_nid generation:  0.011031389236450195
local_in_edges_tensor generation:  0.00892019271850586
mini_batch_src_global generation:  0.010017871856689453
r_  generation:  0.13767766952514648
local_output_nid generation:  0.01189732551574707
local_in_edges_tensor generation:  0.00563812255859375
mini_batch_src_global generation:  0.013068675994873047
r_  generation:  0.1441800594329834
----------------------check_connections_block total spend ----------------------------- 0.4155004024505615
generate_one_block  0.16235709190368652
generate_one_block  0.15381693840026855
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03150177001953125
gen group dst list time:  0.007170200347900391
time for parepare:  0.019816160202026367
local_output_nid generation:  0.01668858528137207
local_in_edges_tensor generation:  0.029139041900634766
mini_batch_src_global generation:  0.03807830810546875
r_  generation:  0.4137728214263916
local_output_nid generation:  0.025510549545288086
local_in_edges_tensor generation:  0.024549245834350586
mini_batch_src_global generation:  0.04640841484069824
r_  generation:  0.4252779483795166
----------------------check_connections_block total spend ----------------------------- 1.2225415706634521
generate_one_block  0.5279006958007812
generate_one_block  0.5268278121948242
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.021207332611083984
gen group dst list time:  0.012284994125366211
time for parepare:  0.018842458724975586
local_output_nid generation:  0.023511886596679688
local_in_edges_tensor generation:  0.03379964828491211
mini_batch_src_global generation:  0.05534172058105469
r_  generation:  0.4107472896575928
local_output_nid generation:  0.038611412048339844
local_in_edges_tensor generation:  0.0363616943359375
mini_batch_src_global generation:  0.042623043060302734
r_  generation:  0.3953831195831299
----------------------check_connections_block total spend ----------------------------- 1.2598488330841064
generate_one_block  0.4773523807525635
generate_one_block  0.45774316787719727
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14359807968139648  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.4823904037475586
block generation total time  1.9898240566253662
average batch blocks generation time:  0.9949120283126831
block dataloader generation time/epoch 5.779798683367278
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10901880264282227  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.209317684173584  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10915803909301758  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.203066349029541  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0806281566619873 |0.019265294075012207 |0.004168868064880371 |0.0005182027816772461 |0.002575397491455078 |0.0019712448120117188 |
----------------------------------------------------------pseudo_mini_loss sum 1.093562126159668
Total (block generation + training)time/epoch 6.090568887559991
Training time/epoch 0.3229668140411377
Training time without block to device /epoch 0.2844362258911133
Training time without total dataloading part /epoch 0.01649618148803711
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 50.10it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.47it/s]100%|██████████| 4/4 [00:00<00:00, 15.77it/s]100%|██████████| 4/4 [00:00<00:00, 15.71it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.48it/s]100%|██████████| 4/4 [00:00<00:00, 17.78it/s]100%|██████████| 4/4 [00:00<00:00, 17.72it/s]
Run 00 | Epoch 00047 | Loss 1.0936 | Train 0.3902 | Val 0.4597 | Test 0.4656
Number of nodes during this epoch:  329198
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1447281837463379  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01401209831237793
range selection method range initialization spend 0.011883020401000977
time for parepare:  0.01686882972717285
local_output_nid generation:  0.011017560958862305
local_in_edges_tensor generation:  0.011545658111572266
mini_batch_src_global generation:  0.010004997253417969
r_  generation:  0.13741421699523926
local_output_nid generation:  0.011776208877563477
local_in_edges_tensor generation:  0.007703542709350586
mini_batch_src_global generation:  0.012866497039794922
r_  generation:  0.14612483978271484
----------------------check_connections_block total spend ----------------------------- 0.4226505756378174
generate_one_block  0.16088461875915527
generate_one_block  0.15325355529785156
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03913426399230957
gen group dst list time:  0.005830049514770508
time for parepare:  0.019893646240234375
local_output_nid generation:  0.016807079315185547
local_in_edges_tensor generation:  0.03306245803833008
mini_batch_src_global generation:  0.03790283203125
r_  generation:  0.4153256416320801
local_output_nid generation:  0.0247042179107666
local_in_edges_tensor generation:  0.023508787155151367
mini_batch_src_global generation:  0.04659152030944824
r_  generation:  0.4296233654022217
----------------------check_connections_block total spend ----------------------------- 1.230557918548584
generate_one_block  0.52557373046875
generate_one_block  0.5312249660491943
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0175018310546875
gen group dst list time:  0.011677265167236328
time for parepare:  0.01913619041442871
local_output_nid generation:  0.023553133010864258
local_in_edges_tensor generation:  0.032984256744384766
mini_batch_src_global generation:  0.032886505126953125
r_  generation:  0.40014004707336426
local_output_nid generation:  0.035349130630493164
local_in_edges_tensor generation:  0.03484797477722168
mini_batch_src_global generation:  0.040496110916137695
r_  generation:  0.382718563079834
----------------------check_connections_block total spend ----------------------------- 1.1742496490478516
generate_one_block  0.4554717540740967
generate_one_block  0.46190619468688965
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1447281837463379  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.4048075675964355
block generation total time  1.9741766452789307
average batch blocks generation time:  0.9870883226394653
block dataloader generation time/epoch 5.780381257717426
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10930919647216797  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2082223892211914  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10855293273925781  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.207808017730713  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07987833023071289 |0.018657565116882324 |0.004139542579650879 |0.000531315803527832 |0.002651214599609375 |0.003920555114746094 |
----------------------------------------------------------pseudo_mini_loss sum 1.0916931629180908
Total (block generation + training)time/epoch 6.0912565512534895
Training time/epoch 0.31471896171569824
Training time without block to device /epoch 0.2774038314819336
Training time without total dataloading part /epoch 0.018564701080322266
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 53.95it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.26it/s]100%|██████████| 4/4 [00:00<00:00, 15.60it/s]100%|██████████| 4/4 [00:00<00:00, 15.53it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.93it/s]100%|██████████| 4/4 [00:00<00:00, 17.73it/s]100%|██████████| 4/4 [00:00<00:00, 17.74it/s]
Run 00 | Epoch 00048 | Loss 1.0917 | Train 0.3877 | Val 0.4539 | Test 0.4588
Number of nodes during this epoch:  329243
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14400434494018555  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.014581680297851562
range selection method range initialization spend 0.011662483215332031
time for parepare:  0.015903472900390625
local_output_nid generation:  0.011833667755126953
local_in_edges_tensor generation:  0.013391971588134766
mini_batch_src_global generation:  0.009896039962768555
r_  generation:  0.1339890956878662
local_output_nid generation:  0.0126953125
local_in_edges_tensor generation:  0.005747079849243164
mini_batch_src_global generation:  0.013213157653808594
r_  generation:  0.1433582305908203
----------------------check_connections_block total spend ----------------------------- 0.41661620140075684
generate_one_block  0.1508641242980957
generate_one_block  0.15529942512512207
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.026870250701904297
gen group dst list time:  0.005820751190185547
time for parepare:  0.0196688175201416
local_output_nid generation:  0.016488075256347656
local_in_edges_tensor generation:  0.033437490463256836
mini_batch_src_global generation:  0.03845524787902832
r_  generation:  0.41487884521484375
local_output_nid generation:  0.02429056167602539
local_in_edges_tensor generation:  0.02528095245361328
mini_batch_src_global generation:  0.04690051078796387
r_  generation:  0.4332897663116455
----------------------check_connections_block total spend ----------------------------- 1.2369096279144287
generate_one_block  0.5343761444091797
generate_one_block  0.5549144744873047
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.024221420288085938
gen group dst list time:  0.014223337173461914
time for parepare:  0.019197940826416016
local_output_nid generation:  0.024322032928466797
local_in_edges_tensor generation:  0.0331876277923584
mini_batch_src_global generation:  0.03140687942504883
r_  generation:  0.37473416328430176
local_output_nid generation:  0.03115701675415039
local_in_edges_tensor generation:  0.03337860107421875
mini_batch_src_global generation:  0.03751707077026367
r_  generation:  0.37929868698120117
----------------------check_connections_block total spend ----------------------------- 1.129464864730835
generate_one_block  0.45432209968566895
generate_one_block  0.44962143898010254
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14400434494018555  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.3663744926452637
block generation total time  1.9932341575622559
average batch blocks generation time:  0.9966170787811279
block dataloader generation time/epoch 5.78005103468895
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10896062850952148  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2071833610534668  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10855436325073242  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2081446647644043  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08079636096954346 |0.015301346778869629 |0.003992676734924316 |0.0005081892013549805 |0.002841949462890625 |0.0013611316680908203 |
----------------------------------------------------------pseudo_mini_loss sum 1.0896880626678467
Total (block generation + training)time/epoch 6.09101704955101
Training time/epoch 0.31435155868530273
Training time without block to device /epoch 0.2837488651275635
Training time without total dataloading part /epoch 0.016046762466430664
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 61.75it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.97it/s]100%|██████████| 4/4 [00:00<00:00, 15.52it/s]100%|██████████| 4/4 [00:00<00:00, 15.42it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.49it/s]100%|██████████| 4/4 [00:00<00:00, 17.98it/s]100%|██████████| 4/4 [00:00<00:00, 17.78it/s]
Run 00 | Epoch 00049 | Loss 1.0897 | Train 0.3845 | Val 0.4494 | Test 0.4531
Number of nodes during this epoch:  329193
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14376401901245117  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.015344619750976562
range selection method range initialization spend 0.012099981307983398
time for parepare:  0.015771865844726562
local_output_nid generation:  0.010958671569824219
local_in_edges_tensor generation:  0.007819175720214844
mini_batch_src_global generation:  0.011470556259155273
r_  generation:  0.13477611541748047
local_output_nid generation:  0.01257467269897461
local_in_edges_tensor generation:  0.0055468082427978516
mini_batch_src_global generation:  0.012657880783081055
r_  generation:  0.15049338340759277
----------------------check_connections_block total spend ----------------------------- 0.4202301502227783
generate_one_block  0.16435861587524414
generate_one_block  0.15911531448364258
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03229928016662598
gen group dst list time:  0.006052494049072266
time for parepare:  0.024129867553710938
local_output_nid generation:  0.01737833023071289
local_in_edges_tensor generation:  0.0355534553527832
mini_batch_src_global generation:  0.04378461837768555
r_  generation:  0.4359860420227051
local_output_nid generation:  0.027739286422729492
local_in_edges_tensor generation:  0.03152036666870117
mini_batch_src_global generation:  0.04560685157775879
r_  generation:  0.441087007522583
----------------------check_connections_block total spend ----------------------------- 1.290113925933838
generate_one_block  0.5374212265014648
generate_one_block  0.5405223369598389
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0299224853515625
gen group dst list time:  0.012644767761230469
time for parepare:  0.02111077308654785
local_output_nid generation:  0.025187969207763672
local_in_edges_tensor generation:  0.04019808769226074
mini_batch_src_global generation:  0.03331327438354492
r_  generation:  0.3877081871032715
local_output_nid generation:  0.033516883850097656
local_in_edges_tensor generation:  0.03312563896179199
mini_batch_src_global generation:  0.03723025321960449
r_  generation:  0.38834357261657715
----------------------check_connections_block total spend ----------------------------- 1.177551031112671
generate_one_block  0.4709360599517822
generate_one_block  0.46824049949645996
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14376401901245117  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.467664957046509
block generation total time  2.017120122909546
average batch blocks generation time:  1.008560061454773
block dataloader generation time/epoch 5.783610500940463
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10901212692260742  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2078661918640137  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10840463638305664  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2077932357788086  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09013652801513672 |0.022702693939208984 |0.004095315933227539 |0.000512242317199707 |0.0034803152084350586 |0.0015225410461425781 |
----------------------------------------------------------pseudo_mini_loss sum 1.0811066627502441
Total (block generation + training)time/epoch 6.095260910871552
Training time/epoch 0.33887338638305664
Training time without block to device /epoch 0.29346799850463867
Training time without total dataloading part /epoch 0.017698287963867188
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 60.91it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.38it/s]100%|██████████| 4/4 [00:00<00:00, 15.75it/s]100%|██████████| 4/4 [00:00<00:00, 15.68it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.52it/s]100%|██████████| 4/4 [00:00<00:00, 17.79it/s]100%|██████████| 4/4 [00:00<00:00, 17.73it/s]
Run 00 | Epoch 00050 | Loss 1.0811 | Train 0.3811 | Val 0.4465 | Test 0.4483
Number of nodes during this epoch:  329310
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1437969207763672  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.013467788696289062
range selection method range initialization spend 0.011703968048095703
time for parepare:  0.015595436096191406
local_output_nid generation:  0.010961294174194336
local_in_edges_tensor generation:  0.010604143142700195
mini_batch_src_global generation:  0.009775400161743164
r_  generation:  0.131988525390625
local_output_nid generation:  0.011941671371459961
local_in_edges_tensor generation:  0.006348133087158203
mini_batch_src_global generation:  0.013062000274658203
r_  generation:  0.14232110977172852
----------------------check_connections_block total spend ----------------------------- 0.40920519828796387
generate_one_block  0.1481027603149414
generate_one_block  0.15153288841247559
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0271456241607666
gen group dst list time:  0.005881786346435547
time for parepare:  0.019742250442504883
local_output_nid generation:  0.01653146743774414
local_in_edges_tensor generation:  0.029478073120117188
mini_batch_src_global generation:  0.037464141845703125
r_  generation:  0.406085729598999
local_output_nid generation:  0.02399468421936035
local_in_edges_tensor generation:  0.022821903228759766
mini_batch_src_global generation:  0.04748415946960449
r_  generation:  0.4251527786254883
----------------------check_connections_block total spend ----------------------------- 1.2096178531646729
generate_one_block  0.5286910533905029
generate_one_block  0.5350048542022705
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02772045135498047
gen group dst list time:  0.014494657516479492
time for parepare:  0.02145695686340332
local_output_nid generation:  0.023842573165893555
local_in_edges_tensor generation:  0.043172597885131836
mini_batch_src_global generation:  0.03146243095397949
r_  generation:  0.366163969039917
local_output_nid generation:  0.032366037368774414
local_in_edges_tensor generation:  0.0292661190032959
mini_batch_src_global generation:  0.03755688667297363
r_  generation:  0.3857555389404297
----------------------check_connections_block total spend ----------------------------- 1.1361560821533203
generate_one_block  0.4596552848815918
generate_one_block  0.4529097080230713
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1437969207763672  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.345773935317993
block generation total time  1.9762609004974365
average batch blocks generation time:  0.9881304502487183
block dataloader generation time/epoch 5.781632196335566
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10929298400878906  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2082505226135254  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1085348129272461  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2073216438293457  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0763930082321167 |0.01864039897918701 |0.004086136817932129 |0.0005077123641967773 |0.004599928855895996 |0.0014121532440185547 |
----------------------------------------------------------pseudo_mini_loss sum 1.0812017917633057
Total (block generation + training)time/epoch 6.0933749448685415
Training time/epoch 0.3153815269470215
Training time without block to device /epoch 0.27810072898864746
Training time without total dataloading part /epoch 0.01979970932006836
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 51.32it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.22it/s]100%|██████████| 4/4 [00:00<00:00, 15.68it/s]100%|██████████| 4/4 [00:00<00:00, 15.59it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.27it/s]100%|██████████| 4/4 [00:00<00:00, 17.79it/s]100%|██████████| 4/4 [00:00<00:00, 17.69it/s]
Run 00 | Epoch 00051 | Loss 1.0812 | Train 0.3786 | Val 0.4437 | Test 0.4444
Number of nodes during this epoch:  329234
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1438755989074707  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01416468620300293
range selection method range initialization spend 0.011707544326782227
time for parepare:  0.015682220458984375
local_output_nid generation:  0.010911226272583008
local_in_edges_tensor generation:  0.007875204086303711
mini_batch_src_global generation:  0.009832382202148438
r_  generation:  0.13330411911010742
local_output_nid generation:  0.012789487838745117
local_in_edges_tensor generation:  0.006472110748291016
mini_batch_src_global generation:  0.013153553009033203
r_  generation:  0.14183568954467773
----------------------check_connections_block total spend ----------------------------- 0.40820908546447754
generate_one_block  0.14804339408874512
generate_one_block  0.1529560089111328
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.027797460556030273
gen group dst list time:  0.005789756774902344
time for parepare:  0.019388198852539062
local_output_nid generation:  0.016444921493530273
local_in_edges_tensor generation:  0.026372432708740234
mini_batch_src_global generation:  0.038002729415893555
r_  generation:  0.41965270042419434
local_output_nid generation:  0.026653528213500977
local_in_edges_tensor generation:  0.022716760635375977
mini_batch_src_global generation:  0.04963183403015137
r_  generation:  0.4241361618041992
----------------------check_connections_block total spend ----------------------------- 1.2268097400665283
generate_one_block  0.5422720909118652
generate_one_block  0.5309348106384277
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.019278764724731445
gen group dst list time:  0.011492252349853516
time for parepare:  0.01885390281677246
local_output_nid generation:  0.022783279418945312
local_in_edges_tensor generation:  0.03258013725280762
mini_batch_src_global generation:  0.030994415283203125
r_  generation:  0.365598201751709
local_output_nid generation:  0.0300600528717041
local_in_edges_tensor generation:  0.02963399887084961
mini_batch_src_global generation:  0.0398869514465332
r_  generation:  0.37648797035217285
----------------------check_connections_block total spend ----------------------------- 1.1117753982543945
generate_one_block  0.4428536891937256
generate_one_block  0.45029759407043457
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1438755989074707  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.338585138320923
block generation total time  1.9663581848144531
average batch blocks generation time:  0.9831790924072266
block dataloader generation time/epoch 5.779213844343674
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10894536972045898  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2072691917419434  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10858392715454102  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2081866264343262  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07791578769683838 |0.01268625259399414 |0.0043534040451049805 |0.0005714893341064453 |0.0033038854598999023 |0.0016813278198242188 |
----------------------------------------------------------pseudo_mini_loss sum 1.076413631439209
Total (block generation + training)time/epoch 6.090569900911908
Training time/epoch 0.2949671745300293
Training time without block to device /epoch 0.269594669342041
Training time without total dataloading part /epoch 0.018138885498046875
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.09it/s]100%|██████████| 4/4 [00:00<00:00, 29.58it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.35it/s]100%|██████████| 4/4 [00:00<00:00, 12.53it/s]100%|██████████| 4/4 [00:00<00:00, 12.33it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.89it/s]100%|██████████| 4/4 [00:00<00:00, 17.13it/s]100%|██████████| 4/4 [00:00<00:00, 17.08it/s]
Run 00 | Epoch 00052 | Loss 1.0764 | Train 0.3767 | Val 0.4418 | Test 0.4418
Number of nodes during this epoch:  329300
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14396905899047852  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01778388023376465
range selection method range initialization spend 0.011965274810791016
time for parepare:  0.01663804054260254
local_output_nid generation:  0.011047124862670898
local_in_edges_tensor generation:  0.009948968887329102
mini_batch_src_global generation:  0.010368108749389648
r_  generation:  0.1368253231048584
local_output_nid generation:  0.012388229370117188
local_in_edges_tensor generation:  0.005600452423095703
mini_batch_src_global generation:  0.012823343276977539
r_  generation:  0.14445877075195312
----------------------check_connections_block total spend ----------------------------- 0.41713619232177734
generate_one_block  0.15299415588378906
generate_one_block  0.16011691093444824
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03676033020019531
gen group dst list time:  0.005934476852416992
time for parepare:  0.019947528839111328
local_output_nid generation:  0.017064332962036133
local_in_edges_tensor generation:  0.03424215316772461
mini_batch_src_global generation:  0.04024624824523926
r_  generation:  0.42415690422058105
local_output_nid generation:  0.024696826934814453
local_in_edges_tensor generation:  0.027689695358276367
mini_batch_src_global generation:  0.04594111442565918
r_  generation:  0.4333028793334961
----------------------check_connections_block total spend ----------------------------- 1.2520735263824463
generate_one_block  0.5214493274688721
generate_one_block  0.5314712524414062
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0192568302154541
gen group dst list time:  0.01211857795715332
time for parepare:  0.018944263458251953
local_output_nid generation:  0.024025678634643555
local_in_edges_tensor generation:  0.03848099708557129
mini_batch_src_global generation:  0.03252911567687988
r_  generation:  0.3796217441558838
local_output_nid generation:  0.03224444389343262
local_in_edges_tensor generation:  0.02860736846923828
mini_batch_src_global generation:  0.0389251708984375
r_  generation:  0.4034156799316406
----------------------check_connections_block total spend ----------------------------- 1.1703591346740723
generate_one_block  0.46231889724731445
generate_one_block  0.45610785484313965
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14396905899047852  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.4224326610565186
block generation total time  1.9713473320007324
average batch blocks generation time:  0.9856736660003662
block dataloader generation time/epoch 5.780458927154541
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10900449752807617  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2077522277832031  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10858964920043945  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2079639434814453  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08010196685791016 |0.017412304878234863 |0.0041817426681518555 |0.0005180835723876953 |0.0031453371047973633 |0.0035266876220703125 |
----------------------------------------------------------pseudo_mini_loss sum 1.0752334594726562
Total (block generation + training)time/epoch 6.091656397689473
Training time/epoch 0.3042268753051758
Training time without block to device /epoch 0.26940226554870605
Training time without total dataloading part /epoch 0.01921701431274414
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 42.53it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.14it/s]100%|██████████| 4/4 [00:00<00:00, 15.43it/s]100%|██████████| 4/4 [00:00<00:00, 15.37it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.37it/s]100%|██████████| 4/4 [00:00<00:00, 17.60it/s]100%|██████████| 4/4 [00:00<00:00, 17.55it/s]
Run 00 | Epoch 00053 | Loss 1.0752 | Train 0.3762 | Val 0.4399 | Test 0.4399
Number of nodes during this epoch:  329297
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14397764205932617  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01423788070678711
range selection method range initialization spend 0.011614561080932617
time for parepare:  0.01606011390686035
local_output_nid generation:  0.01103067398071289
local_in_edges_tensor generation:  0.013697624206542969
mini_batch_src_global generation:  0.009937047958374023
r_  generation:  0.13408517837524414
local_output_nid generation:  0.012066364288330078
local_in_edges_tensor generation:  0.0055882930755615234
mini_batch_src_global generation:  0.012947559356689453
r_  generation:  0.14733433723449707
----------------------check_connections_block total spend ----------------------------- 0.4197385311126709
generate_one_block  0.15210366249084473
generate_one_block  0.16229033470153809
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03225255012512207
gen group dst list time:  0.0061833858489990234
time for parepare:  0.021524429321289062
local_output_nid generation:  0.018805980682373047
local_in_edges_tensor generation:  0.02811908721923828
mini_batch_src_global generation:  0.038375139236450195
r_  generation:  0.4352250099182129
local_output_nid generation:  0.026932716369628906
local_in_edges_tensor generation:  0.03698563575744629
mini_batch_src_global generation:  0.048250675201416016
r_  generation:  0.4283285140991211
----------------------check_connections_block total spend ----------------------------- 1.2713170051574707
generate_one_block  0.5288577079772949
generate_one_block  0.5498754978179932
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.020531892776489258
gen group dst list time:  0.012053251266479492
time for parepare:  0.019375085830688477
local_output_nid generation:  0.02355194091796875
local_in_edges_tensor generation:  0.04408073425292969
mini_batch_src_global generation:  0.0363011360168457
r_  generation:  0.37767982482910156
local_output_nid generation:  0.03166508674621582
local_in_edges_tensor generation:  0.028989315032958984
mini_batch_src_global generation:  0.03957033157348633
r_  generation:  0.3913562297821045
----------------------check_connections_block total spend ----------------------------- 1.165499210357666
generate_one_block  0.48252367973327637
generate_one_block  0.4642179012298584
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14397764205932617  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.4368162155151367
block generation total time  2.025474786758423
average batch blocks generation time:  1.0127373933792114
block dataloader generation time/epoch 5.782572015126546
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1089482307434082  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2071943283081055  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10859966278076172  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2084698677062988  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0811316967010498 |0.01853954792022705 |0.004180431365966797 |0.000514984130859375 |0.0028302669525146484 |0.001519918441772461 |
----------------------------------------------------------pseudo_mini_loss sum 1.0678000450134277
Total (block generation + training)time/epoch 6.093894476360745
Training time/epoch 0.31665658950805664
Training time without block to device /epoch 0.27957749366760254
Training time without total dataloading part /epoch 0.0165712833404541
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 47.59it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.75it/s]100%|██████████| 4/4 [00:00<00:00, 15.37it/s]100%|██████████| 4/4 [00:00<00:00, 15.26it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.11it/s]100%|██████████| 4/4 [00:00<00:00, 17.61it/s]100%|██████████| 4/4 [00:00<00:00, 17.51it/s]
Run 00 | Epoch 00054 | Loss 1.0678 | Train 0.3752 | Val 0.4380 | Test 0.4369
Number of nodes during this epoch:  329361
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1439042091369629  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01411128044128418
range selection method range initialization spend 0.012058019638061523
time for parepare:  0.015991687774658203
local_output_nid generation:  0.010905981063842773
local_in_edges_tensor generation:  0.008729696273803711
mini_batch_src_global generation:  0.009940862655639648
r_  generation:  0.13256025314331055
local_output_nid generation:  0.012034893035888672
local_in_edges_tensor generation:  0.0055141448974609375
mini_batch_src_global generation:  0.014942407608032227
r_  generation:  0.14469552040100098
----------------------check_connections_block total spend ----------------------------- 0.41256260871887207
generate_one_block  0.15849757194519043
generate_one_block  0.15575885772705078
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.025531291961669922
gen group dst list time:  0.005865335464477539
time for parepare:  0.019639015197753906
local_output_nid generation:  0.016765594482421875
local_in_edges_tensor generation:  0.030603647232055664
mini_batch_src_global generation:  0.03884482383728027
r_  generation:  0.41227054595947266
local_output_nid generation:  0.024817705154418945
local_in_edges_tensor generation:  0.026736736297607422
mini_batch_src_global generation:  0.04980921745300293
r_  generation:  0.42656946182250977
----------------------check_connections_block total spend ----------------------------- 1.2278330326080322
generate_one_block  0.5221047401428223
generate_one_block  0.5223557949066162
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.019603967666625977
gen group dst list time:  0.011485576629638672
time for parepare:  0.020270109176635742
local_output_nid generation:  0.023140430450439453
local_in_edges_tensor generation:  0.029215335845947266
mini_batch_src_global generation:  0.03157472610473633
r_  generation:  0.37372326850891113
local_output_nid generation:  0.03065323829650879
local_in_edges_tensor generation:  0.02718329429626465
mini_batch_src_global generation:  0.03768110275268555
r_  generation:  0.3819460868835449
----------------------check_connections_block total spend ----------------------------- 1.1204757690429688
generate_one_block  0.44945311546325684
generate_one_block  0.45665407180786133
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1439042091369629  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.348308801651001
block generation total time  1.9505677223205566
average batch blocks generation time:  0.9752838611602783
block dataloader generation time/epoch 5.780680723812269
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10847139358520508  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.206803798675537  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10889244079589844  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2074475288391113  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07948446273803711 |0.012862682342529297 |0.003939270973205566 |0.0005096197128295898 |0.0036325454711914062 |0.0028295516967773438 |
----------------------------------------------------------pseudo_mini_loss sum 1.0628676414489746
Total (block generation + training)time/epoch 6.091811330422111
Training time/epoch 0.30240511894226074
Training time without block to device /epoch 0.27667975425720215
Training time without total dataloading part /epoch 0.01899242401123047
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.66it/s]100%|██████████| 4/4 [00:00<00:00, 27.42it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.49it/s]100%|██████████| 4/4 [00:00<00:00, 11.19it/s]100%|██████████| 4/4 [00:00<00:00, 11.23it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.47it/s]100%|██████████| 4/4 [00:00<00:00, 16.41it/s]100%|██████████| 4/4 [00:00<00:00, 16.23it/s]
Run 00 | Epoch 00055 | Loss 1.0629 | Train 0.3729 | Val 0.4347 | Test 0.4334
Number of nodes during this epoch:  329089
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14406394958496094  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.014599084854125977
range selection method range initialization spend 0.01178431510925293
time for parepare:  0.01693129539489746
local_output_nid generation:  0.011481285095214844
local_in_edges_tensor generation:  0.009615898132324219
mini_batch_src_global generation:  0.010062456130981445
r_  generation:  0.13473939895629883
local_output_nid generation:  0.012075662612915039
local_in_edges_tensor generation:  0.006165742874145508
mini_batch_src_global generation:  0.012957334518432617
r_  generation:  0.14294147491455078
----------------------check_connections_block total spend ----------------------------- 0.4136207103729248
generate_one_block  0.15170502662658691
generate_one_block  0.15443730354309082
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02765798568725586
gen group dst list time:  0.005960941314697266
time for parepare:  0.019678831100463867
local_output_nid generation:  0.01685500144958496
local_in_edges_tensor generation:  0.031058073043823242
mini_batch_src_global generation:  0.03832697868347168
r_  generation:  0.41239047050476074
local_output_nid generation:  0.024432897567749023
local_in_edges_tensor generation:  0.025534868240356445
mini_batch_src_global generation:  0.04574131965637207
r_  generation:  0.4250795841217041
----------------------check_connections_block total spend ----------------------------- 1.2209701538085938
generate_one_block  0.5224771499633789
generate_one_block  0.5376400947570801
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.017675161361694336
gen group dst list time:  0.011398077011108398
time for parepare:  0.018931865692138672
local_output_nid generation:  0.02562880516052246
local_in_edges_tensor generation:  0.03362298011779785
mini_batch_src_global generation:  0.03148937225341797
r_  generation:  0.375133752822876
local_output_nid generation:  0.031618595123291016
local_in_edges_tensor generation:  0.027089834213256836
mini_batch_src_global generation:  0.03905940055847168
r_  generation:  0.38053131103515625
----------------------check_connections_block total spend ----------------------------- 1.1294629573822021
generate_one_block  0.4505023956298828
generate_one_block  0.45696043968200684
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14406394958496094  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.350433111190796
block generation total time  1.9675800800323486
average batch blocks generation time:  0.9837900400161743
block dataloader generation time/epoch 5.779110543271329
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10898923873901367  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2075462341308594  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10860061645507812  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2082595825195312  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08849525451660156 |0.013048052787780762 |0.003740549087524414 |0.0004919767379760742 |0.002581477165222168 |0.0017499923706054688 |
----------------------------------------------------------pseudo_mini_loss sum 1.059390664100647
Total (block generation + training)time/epoch 6.090379456256298
Training time/epoch 0.31752657890319824
Training time without block to device /epoch 0.2914304733276367
Training time without total dataloading part /epoch 0.015377998352050781
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.41it/s]100%|██████████| 4/4 [00:00<00:00, 21.49it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.09it/s]100%|██████████| 4/4 [00:00<00:00, 12.43it/s]100%|██████████| 4/4 [00:00<00:00, 12.20it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.01it/s]100%|██████████| 4/4 [00:00<00:00, 17.53it/s]100%|██████████| 4/4 [00:00<00:00, 17.43it/s]
Run 00 | Epoch 00056 | Loss 1.0594 | Train 0.3695 | Val 0.4302 | Test 0.4279
Number of nodes during this epoch:  329385
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14364290237426758  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0175628662109375
range selection method range initialization spend 0.011851072311401367
time for parepare:  0.016873836517333984
local_output_nid generation:  0.011843204498291016
local_in_edges_tensor generation:  0.008893966674804688
mini_batch_src_global generation:  0.012433052062988281
r_  generation:  0.1325984001159668
local_output_nid generation:  0.01230478286743164
local_in_edges_tensor generation:  0.005636692047119141
mini_batch_src_global generation:  0.013101577758789062
r_  generation:  0.14380121231079102
----------------------check_connections_block total spend ----------------------------- 0.4155566692352295
generate_one_block  0.15598821640014648
generate_one_block  0.15530848503112793
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029179096221923828
gen group dst list time:  0.005832195281982422
time for parepare:  0.020017385482788086
local_output_nid generation:  0.017455101013183594
local_in_edges_tensor generation:  0.026444196701049805
mini_batch_src_global generation:  0.03785991668701172
r_  generation:  0.41762518882751465
local_output_nid generation:  0.02472400665283203
local_in_edges_tensor generation:  0.030066728591918945
mini_batch_src_global generation:  0.046181440353393555
r_  generation:  0.4305849075317383
----------------------check_connections_block total spend ----------------------------- 1.2372705936431885
generate_one_block  0.5239899158477783
generate_one_block  0.5506796836853027
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.024212121963500977
gen group dst list time:  0.013909101486206055
time for parepare:  0.023209095001220703
local_output_nid generation:  0.024222850799560547
local_in_edges_tensor generation:  0.04665088653564453
mini_batch_src_global generation:  0.03380179405212402
r_  generation:  0.37743043899536133
local_output_nid generation:  0.031238555908203125
local_in_edges_tensor generation:  0.03216242790222168
mini_batch_src_global generation:  0.040422916412353516
r_  generation:  0.3812274932861328
----------------------check_connections_block total spend ----------------------------- 1.1553897857666016
generate_one_block  0.46764469146728516
generate_one_block  0.4569518566131592
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14364290237426758  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.39266037940979
block generation total time  1.9992661476135254
average batch blocks generation time:  0.9996330738067627
block dataloader generation time/epoch 5.779778242111206
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1089930534362793  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.20796537399292  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10858964920043945  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2075371742248535  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09225213527679443 |0.014988064765930176 |0.00393068790435791 |0.0005012750625610352 |0.0033611059188842773 |0.00154876708984375 |
----------------------------------------------------------pseudo_mini_loss sum 1.0612884759902954
Total (block generation + training)time/epoch 6.091508607069652
Training time/epoch 0.3332509994506836
Training time without block to device /epoch 0.30327486991882324
Training time without total dataloading part /epoch 0.017134904861450195
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 55.30it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.53it/s]100%|██████████| 4/4 [00:00<00:00, 16.08it/s]100%|██████████| 4/4 [00:00<00:00, 15.98it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.98it/s]100%|██████████| 4/4 [00:00<00:00, 18.93it/s]100%|██████████| 4/4 [00:00<00:00, 18.76it/s]
Run 00 | Epoch 00057 | Loss 1.0613 | Train 0.3657 | Val 0.4245 | Test 0.4204
Number of nodes during this epoch:  329458
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1437993049621582  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018663883209228516
range selection method range initialization spend 0.013826131820678711
time for parepare:  0.01734781265258789
local_output_nid generation:  0.0110015869140625
local_in_edges_tensor generation:  0.00880575180053711
mini_batch_src_global generation:  0.010668754577636719
r_  generation:  0.15936660766601562
local_output_nid generation:  0.011770248413085938
local_in_edges_tensor generation:  0.006494760513305664
mini_batch_src_global generation:  0.015520095825195312
r_  generation:  0.1826164722442627
----------------------check_connections_block total spend ----------------------------- 0.4838528633117676
generate_one_block  0.15967750549316406
generate_one_block  0.15691637992858887
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028004884719848633
gen group dst list time:  0.005860090255737305
time for parepare:  0.021811723709106445
local_output_nid generation:  0.017660856246948242
local_in_edges_tensor generation:  0.0324249267578125
mini_batch_src_global generation:  0.038721323013305664
r_  generation:  0.4181816577911377
local_output_nid generation:  0.02470088005065918
local_in_edges_tensor generation:  0.027330875396728516
mini_batch_src_global generation:  0.048358917236328125
r_  generation:  0.4400334358215332
----------------------check_connections_block total spend ----------------------------- 1.2594032287597656
generate_one_block  0.5416598320007324
generate_one_block  0.5307803153991699
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.021513938903808594
gen group dst list time:  0.013672113418579102
time for parepare:  0.019072294235229492
local_output_nid generation:  0.025104284286499023
local_in_edges_tensor generation:  0.05787301063537598
mini_batch_src_global generation:  0.03318643569946289
r_  generation:  0.3798482418060303
local_output_nid generation:  0.03205728530883789
local_in_edges_tensor generation:  0.028697490692138672
mini_batch_src_global generation:  0.03797459602355957
r_  generation:  0.38630056381225586
----------------------check_connections_block total spend ----------------------------- 1.1684315204620361
generate_one_block  0.4716520309448242
generate_one_block  0.45776987075805664
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1437993049621582  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.4278347492218018
block generation total time  2.001862049102783
average batch blocks generation time:  1.0009310245513916
block dataloader generation time/epoch 5.786659021766818
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10897207260131836  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.207601547241211  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10859537124633789  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2081198692321777  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07602357864379883 |0.017161846160888672 |0.004146695137023926 |0.0005208253860473633 |0.003905653953552246 |0.0015869140625 |
----------------------------------------------------------pseudo_mini_loss sum 1.058572769165039
Total (block generation + training)time/epoch 6.0982063984384345
Training time/epoch 0.30258965492248535
Training time without block to device /epoch 0.268265962600708
Training time without total dataloading part /epoch 0.01873326301574707
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.23it/s]100%|██████████| 4/4 [00:00<00:00, 29.42it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 12.10it/s]100%|██████████| 4/4 [00:00<00:00, 13.61it/s]100%|██████████| 4/4 [00:00<00:00, 13.35it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.26it/s]100%|██████████| 4/4 [00:00<00:00, 20.55it/s]
Run 00 | Epoch 00058 | Loss 1.0586 | Train 0.3621 | Val 0.4174 | Test 0.4121
Number of nodes during this epoch:  329358
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14395904541015625  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.015517950057983398
range selection method range initialization spend 0.011748790740966797
time for parepare:  0.015998363494873047
local_output_nid generation:  0.01095438003540039
local_in_edges_tensor generation:  0.01073455810546875
mini_batch_src_global generation:  0.010214090347290039
r_  generation:  0.13723278045654297
local_output_nid generation:  0.012190580368041992
local_in_edges_tensor generation:  0.00598454475402832
mini_batch_src_global generation:  0.012938976287841797
r_  generation:  0.14494633674621582
----------------------check_connections_block total spend ----------------------------- 0.4199643135070801
generate_one_block  0.1574859619140625
generate_one_block  0.1565868854522705
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.032228946685791016
gen group dst list time:  0.00623321533203125
time for parepare:  0.021531343460083008
local_output_nid generation:  0.01777791976928711
local_in_edges_tensor generation:  0.03295493125915527
mini_batch_src_global generation:  0.04073333740234375
r_  generation:  0.4366588592529297
local_output_nid generation:  0.028421878814697266
local_in_edges_tensor generation:  0.03547358512878418
mini_batch_src_global generation:  0.05317378044128418
r_  generation:  0.427473783493042
----------------------check_connections_block total spend ----------------------------- 1.284165382385254
generate_one_block  0.5289125442504883
generate_one_block  0.5215339660644531
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01959085464477539
gen group dst list time:  0.011424064636230469
time for parepare:  0.019556283950805664
local_output_nid generation:  0.023943185806274414
local_in_edges_tensor generation:  0.03477358818054199
mini_batch_src_global generation:  0.03194832801818848
r_  generation:  0.373976469039917
local_output_nid generation:  0.03145790100097656
local_in_edges_tensor generation:  0.026702404022216797
mini_batch_src_global generation:  0.03825044631958008
r_  generation:  0.383899450302124
----------------------check_connections_block total spend ----------------------------- 1.1319129467010498
generate_one_block  0.451763391494751
generate_one_block  0.4716908931732178
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14395904541015625  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.4160783290863037
block generation total time  1.9739007949829102
average batch blocks generation time:  0.9869503974914551
block dataloader generation time/epoch 5.788629002571106
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10898733139038086  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.207352638244629  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10850954055786133  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.207754135131836  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07956051826477051 |0.013602137565612793 |0.004150748252868652 |0.0005167722702026367 |0.0036334991455078125 |0.001768350601196289 |
----------------------------------------------------------pseudo_mini_loss sum 1.05361807346344
Total (block generation + training)time/epoch 6.100102515220642
Training time/epoch 0.3077049255371094
Training time without block to device /epoch 0.2805006504058838
Training time without total dataloading part /epoch 0.018370389938354492
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.51it/s]100%|██████████| 4/4 [00:00<00:00, 28.80it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.59it/s]100%|██████████| 4/4 [00:00<00:00, 11.03it/s]100%|██████████| 4/4 [00:00<00:00, 11.10it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 12.64it/s]100%|██████████| 4/4 [00:00<00:00, 15.00it/s]100%|██████████| 4/4 [00:00<00:00, 14.57it/s]
Run 00 | Epoch 00059 | Loss 1.0536 | Train 0.3588 | Val 0.4093 | Test 0.4029
Number of nodes during this epoch:  329219
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14409732818603516  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.013302803039550781
range selection method range initialization spend 0.011959552764892578
time for parepare:  0.01797032356262207
local_output_nid generation:  0.011053800582885742
local_in_edges_tensor generation:  0.009148120880126953
mini_batch_src_global generation:  0.010108709335327148
r_  generation:  0.13506245613098145
local_output_nid generation:  0.0122833251953125
local_in_edges_tensor generation:  0.007019758224487305
mini_batch_src_global generation:  0.013160467147827148
r_  generation:  0.1434650421142578
----------------------check_connections_block total spend ----------------------------- 0.41597604751586914
generate_one_block  0.1511385440826416
generate_one_block  0.15380644798278809
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.027367591857910156
gen group dst list time:  0.005834817886352539
time for parepare:  0.019910573959350586
local_output_nid generation:  0.017090559005737305
local_in_edges_tensor generation:  0.02993941307067871
mini_batch_src_global generation:  0.03948545455932617
r_  generation:  0.41318440437316895
local_output_nid generation:  0.024878263473510742
local_in_edges_tensor generation:  0.027872800827026367
mini_batch_src_global generation:  0.046590566635131836
r_  generation:  0.4247913360595703
----------------------check_connections_block total spend ----------------------------- 1.229135274887085
generate_one_block  0.523564338684082
generate_one_block  0.5369737148284912
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.017134904861450195
gen group dst list time:  0.011361837387084961
time for parepare:  0.018858909606933594
local_output_nid generation:  0.02387261390686035
local_in_edges_tensor generation:  0.029773950576782227
mini_batch_src_global generation:  0.03139948844909668
r_  generation:  0.3763608932495117
local_output_nid generation:  0.031218290328979492
local_in_edges_tensor generation:  0.027756690979003906
mini_batch_src_global generation:  0.03863835334777832
r_  generation:  0.382277250289917
----------------------check_connections_block total spend ----------------------------- 1.1273021697998047
generate_one_block  0.45473670959472656
generate_one_block  0.45443058013916016
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14409732818603516  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.3564374446868896
block generation total time  1.96970534324646
average batch blocks generation time:  0.98485267162323
block dataloader generation time/epoch 5.787936061036353
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10896635055541992  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2073450088500977  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10856151580810547  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2081499099731445  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08052206039428711 |0.013520479202270508 |0.003934383392333984 |0.0005167722702026367 |0.0032672882080078125 |0.0013537406921386719 |
----------------------------------------------------------pseudo_mini_loss sum 1.0517289638519287
Total (block generation + training)time/epoch 6.099260489145915
Training time/epoch 0.3037705421447754
Training time without block to device /epoch 0.2767295837402344
Training time without total dataloading part /epoch 0.01679062843322754
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 56.89it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 13.62it/s]100%|██████████| 4/4 [00:00<00:00, 14.00it/s]100%|██████████| 4/4 [00:00<00:00, 13.93it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.89it/s]100%|██████████| 4/4 [00:00<00:00, 16.92it/s]100%|██████████| 4/4 [00:00<00:00, 16.90it/s]
Run 00 | Epoch 00060 | Loss 1.0517 | Train 0.3544 | Val 0.4004 | Test 0.3934
Number of nodes during this epoch:  329228
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14380121231079102  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.016106843948364258
range selection method range initialization spend 0.01180887222290039
time for parepare:  0.016757726669311523
local_output_nid generation:  0.01103353500366211
local_in_edges_tensor generation:  0.01318049430847168
mini_batch_src_global generation:  0.010439157485961914
r_  generation:  0.13475823402404785
local_output_nid generation:  0.012702465057373047
local_in_edges_tensor generation:  0.00612640380859375
mini_batch_src_global generation:  0.015171051025390625
r_  generation:  0.14378046989440918
----------------------check_connections_block total spend ----------------------------- 0.4199042320251465
generate_one_block  0.15669965744018555
generate_one_block  0.15354180335998535
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.027312278747558594
gen group dst list time:  0.0058176517486572266
time for parepare:  0.021563291549682617
local_output_nid generation:  0.016549348831176758
local_in_edges_tensor generation:  0.02920675277709961
mini_batch_src_global generation:  0.03925800323486328
r_  generation:  0.4122185707092285
local_output_nid generation:  0.024282455444335938
local_in_edges_tensor generation:  0.027506113052368164
mini_batch_src_global generation:  0.04538893699645996
r_  generation:  0.4265024662017822
----------------------check_connections_block total spend ----------------------------- 1.2239878177642822
generate_one_block  0.5157790184020996
generate_one_block  0.5171971321105957
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.016468048095703125
gen group dst list time:  0.011314153671264648
time for parepare:  0.019478559494018555
local_output_nid generation:  0.023586273193359375
local_in_edges_tensor generation:  0.030144929885864258
mini_batch_src_global generation:  0.03058910369873047
r_  generation:  0.37247538566589355
local_output_nid generation:  0.03215312957763672
local_in_edges_tensor generation:  0.02905750274658203
mini_batch_src_global generation:  0.03741812705993652
r_  generation:  0.3832554817199707
----------------------check_connections_block total spend ----------------------------- 1.1228618621826172
generate_one_block  0.4462850093841553
generate_one_block  0.4523203372955322
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14380121231079102  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.3468496799468994
block generation total time  1.9315814971923828
average batch blocks generation time:  0.9657907485961914
block dataloader generation time/epoch 5.786913573741913
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1089940071105957  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2074708938598633  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10854721069335938  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2075471878051758  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0847090482711792 |0.011883854866027832 |0.003985285758972168 |0.0005247592926025391 |0.0032033920288085938 |0.001497030258178711 |
----------------------------------------------------------pseudo_mini_loss sum 1.0444400310516357
Total (block generation + training)time/epoch 6.098096063503852
Training time/epoch 0.30384182929992676
Training time without block to device /epoch 0.2800741195678711
Training time without total dataloading part /epoch 0.016923904418945312
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.66it/s]100%|██████████| 4/4 [00:00<00:00, 30.42it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.58it/s]100%|██████████| 4/4 [00:00<00:00, 12.59it/s]100%|██████████| 4/4 [00:00<00:00, 12.42it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.85it/s]100%|██████████| 4/4 [00:00<00:00, 17.35it/s]100%|██████████| 4/4 [00:00<00:00, 17.25it/s]
Run 00 | Epoch 00061 | Loss 1.0444 | Train 0.3503 | Val 0.3928 | Test 0.3845
Number of nodes during this epoch:  329224
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14344072341918945  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.016426563262939453
range selection method range initialization spend 0.011870861053466797
time for parepare:  0.016869068145751953
local_output_nid generation:  0.01111745834350586
local_in_edges_tensor generation:  0.01081991195678711
mini_batch_src_global generation:  0.010165214538574219
r_  generation:  0.13398265838623047
local_output_nid generation:  0.012187004089355469
local_in_edges_tensor generation:  0.00647425651550293
mini_batch_src_global generation:  0.012715816497802734
r_  generation:  0.14403271675109863
----------------------check_connections_block total spend ----------------------------- 0.41514039039611816
generate_one_block  0.15502357482910156
generate_one_block  0.15743088722229004
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03328704833984375
gen group dst list time:  0.005802631378173828
time for parepare:  0.023718595504760742
local_output_nid generation:  0.017129898071289062
local_in_edges_tensor generation:  0.029300451278686523
mini_batch_src_global generation:  0.03743124008178711
r_  generation:  0.4155874252319336
local_output_nid generation:  0.02451777458190918
local_in_edges_tensor generation:  0.0288240909576416
mini_batch_src_global generation:  0.04539918899536133
r_  generation:  0.4301016330718994
----------------------check_connections_block total spend ----------------------------- 1.233879566192627
generate_one_block  0.5232820510864258
generate_one_block  0.5266292095184326
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.023193359375
gen group dst list time:  0.01214909553527832
time for parepare:  0.020780563354492188
local_output_nid generation:  0.024852275848388672
local_in_edges_tensor generation:  0.03307175636291504
mini_batch_src_global generation:  0.03185725212097168
r_  generation:  0.3747410774230957
local_output_nid generation:  0.03399920463562012
local_in_edges_tensor generation:  0.03478884696960449
mini_batch_src_global generation:  0.03930473327636719
r_  generation:  0.4051089286804199
----------------------check_connections_block total spend ----------------------------- 1.167989730834961
generate_one_block  0.45458245277404785
generate_one_block  0.4583606719970703
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14344072341918945  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.401869297027588
block generation total time  1.9628543853759766
average batch blocks generation time:  0.9814271926879883
block dataloader generation time/epoch 5.787040215618205
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10896062850952148  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2074131965637207  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10853338241577148  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.20782470703125  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08455765247344971 |0.018569469451904297 |0.00394129753112793 |0.0005069971084594727 |0.0028058290481567383 |0.0012767314910888672 |
----------------------------------------------------------pseudo_mini_loss sum 1.043654441833496
Total (block generation + training)time/epoch 6.098545753730918
Training time/epoch 0.328153133392334
Training time without block to device /epoch 0.2910141944885254
Training time without total dataloading part /epoch 0.01578497886657715
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 57.54it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.92it/s]100%|██████████| 4/4 [00:00<00:00, 15.35it/s]100%|██████████| 4/4 [00:00<00:00, 15.27it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.57it/s]100%|██████████| 4/4 [00:00<00:00, 17.69it/s]100%|██████████| 4/4 [00:00<00:00, 17.65it/s]
Run 00 | Epoch 00062 | Loss 1.0437 | Train 0.3474 | Val 0.3871 | Test 0.3793
Number of nodes during this epoch:  329265
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14392375946044922  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.014111042022705078
range selection method range initialization spend 0.011803865432739258
time for parepare:  0.015753746032714844
local_output_nid generation:  0.010988235473632812
local_in_edges_tensor generation:  0.009502887725830078
mini_batch_src_global generation:  0.009917020797729492
r_  generation:  0.13277006149291992
local_output_nid generation:  0.012292623519897461
local_in_edges_tensor generation:  0.006008148193359375
mini_batch_src_global generation:  0.012811899185180664
r_  generation:  0.14373111724853516
----------------------check_connections_block total spend ----------------------------- 0.4103984832763672
generate_one_block  0.150848388671875
generate_one_block  0.15350055694580078
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028857946395874023
gen group dst list time:  0.00579380989074707
time for parepare:  0.020109176635742188
local_output_nid generation:  0.017359256744384766
local_in_edges_tensor generation:  0.029658794403076172
mini_batch_src_global generation:  0.03711986541748047
r_  generation:  0.4138028621673584
local_output_nid generation:  0.02440047264099121
local_in_edges_tensor generation:  0.023841381072998047
mini_batch_src_global generation:  0.04609084129333496
r_  generation:  0.42699623107910156
----------------------check_connections_block total spend ----------------------------- 1.2223613262176514
generate_one_block  0.5194146633148193
generate_one_block  0.5237424373626709
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.018848180770874023
gen group dst list time:  0.011226177215576172
time for parepare:  0.018937349319458008
local_output_nid generation:  0.024343013763427734
local_in_edges_tensor generation:  0.030503511428833008
mini_batch_src_global generation:  0.03209519386291504
r_  generation:  0.3739898204803467
local_output_nid generation:  0.03110218048095703
local_in_edges_tensor generation:  0.026096582412719727
mini_batch_src_global generation:  0.037911176681518555
r_  generation:  0.3786158561706543
----------------------check_connections_block total spend ----------------------------- 1.1165008544921875
generate_one_block  0.4495277404785156
generate_one_block  0.45339274406433105
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14392375946044922  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.338862180709839
block generation total time  1.946077585220337
average batch blocks generation time:  0.9730387926101685
block dataloader generation time/epoch 5.785000673046818
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10895776748657227  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.207404613494873  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10856199264526367  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2075400352478027  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07267236709594727 |0.014084458351135254 |0.004349470138549805 |0.0005605220794677734 |0.002614140510559082 |0.0016531944274902344 |
----------------------------------------------------------pseudo_mini_loss sum 1.04103684425354
Total (block generation + training)time/epoch 6.095988304526718
Training time/epoch 0.28345513343811035
Training time without block to device /epoch 0.25528621673583984
Training time without total dataloading part /epoch 0.016701459884643555
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.21it/s]100%|██████████| 4/4 [00:00<00:00, 31.40it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.49it/s]100%|██████████| 4/4 [00:00<00:00, 11.01it/s]100%|██████████| 4/4 [00:00<00:00, 11.07it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.04it/s]100%|██████████| 4/4 [00:00<00:00, 17.34it/s]100%|██████████| 4/4 [00:00<00:00, 17.27it/s]
Run 00 | Epoch 00063 | Loss 1.0410 | Train 0.3454 | Val 0.3839 | Test 0.3755
Number of nodes during this epoch:  329294
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14382553100585938  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018129825592041016
range selection method range initialization spend 0.011646509170532227
time for parepare:  0.016889095306396484
local_output_nid generation:  0.010757207870483398
local_in_edges_tensor generation:  0.012059926986694336
mini_batch_src_global generation:  0.00975656509399414
r_  generation:  0.13515996932983398
local_output_nid generation:  0.012251853942871094
local_in_edges_tensor generation:  0.006417751312255859
mini_batch_src_global generation:  0.013018608093261719
r_  generation:  0.14371895790100098
----------------------check_connections_block total spend ----------------------------- 0.41815185546875
generate_one_block  0.15538287162780762
generate_one_block  0.15358757972717285
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.034067392349243164
gen group dst list time:  0.005746126174926758
time for parepare:  0.019793987274169922
local_output_nid generation:  0.016815900802612305
local_in_edges_tensor generation:  0.03243255615234375
mini_batch_src_global generation:  0.03743577003479004
r_  generation:  0.40969347953796387
local_output_nid generation:  0.024271249771118164
local_in_edges_tensor generation:  0.023054838180541992
mini_batch_src_global generation:  0.04593610763549805
r_  generation:  0.4234621524810791
----------------------check_connections_block total spend ----------------------------- 1.2179367542266846
generate_one_block  0.5260963439941406
generate_one_block  0.5328166484832764
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.019945144653320312
gen group dst list time:  0.011481523513793945
time for parepare:  0.019212961196899414
local_output_nid generation:  0.02363896369934082
local_in_edges_tensor generation:  0.03405308723449707
mini_batch_src_global generation:  0.042697906494140625
r_  generation:  0.3799910545349121
local_output_nid generation:  0.03281807899475098
local_in_edges_tensor generation:  0.030762434005737305
mini_batch_src_global generation:  0.03813314437866211
r_  generation:  0.3706178665161133
----------------------check_connections_block total spend ----------------------------- 1.1453771591186523
generate_one_block  0.4509739875793457
generate_one_block  0.46206188201904297
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14382553100585938  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.363313913345337
block generation total time  1.9719488620758057
average batch blocks generation time:  0.9859744310379028
block dataloader generation time/epoch 5.785046469081532
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10896635055541992  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.20709228515625  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1086273193359375  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2083592414855957  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08094799518585205 |0.014929533004760742 |0.004071593284606934 |0.0005216598510742188 |0.002888798713684082 |0.0014178752899169922 |
----------------------------------------------------------pseudo_mini_loss sum 1.036484956741333
Total (block generation + training)time/epoch 6.095996184782549
Training time/epoch 0.3087494373321533
Training time without block to device /epoch 0.27889037132263184
Training time without total dataloading part /epoch 0.01638197898864746
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 49.94it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.04it/s]100%|██████████| 4/4 [00:00<00:00, 15.35it/s]100%|██████████| 4/4 [00:00<00:00, 15.29it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.79it/s]100%|██████████| 4/4 [00:00<00:00, 17.71it/s]100%|██████████| 4/4 [00:00<00:00, 17.71it/s]
Run 00 | Epoch 00064 | Loss 1.0365 | Train 0.3444 | Val 0.3825 | Test 0.3742
Number of nodes during this epoch:  329467
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14357280731201172  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.016669750213623047
range selection method range initialization spend 0.011797904968261719
time for parepare:  0.015491247177124023
local_output_nid generation:  0.011476516723632812
local_in_edges_tensor generation:  0.01105642318725586
mini_batch_src_global generation:  0.011760234832763672
r_  generation:  0.13393735885620117
local_output_nid generation:  0.01298069953918457
local_in_edges_tensor generation:  0.005590915679931641
mini_batch_src_global generation:  0.012778759002685547
r_  generation:  0.14382171630859375
----------------------check_connections_block total spend ----------------------------- 0.4164390563964844
generate_one_block  0.15055108070373535
generate_one_block  0.15173625946044922
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029735803604125977
gen group dst list time:  0.005680561065673828
time for parepare:  0.020178794860839844
local_output_nid generation:  0.016563892364501953
local_in_edges_tensor generation:  0.038832902908325195
mini_batch_src_global generation:  0.038359642028808594
r_  generation:  0.4130403995513916
local_output_nid generation:  0.024553298950195312
local_in_edges_tensor generation:  0.03505992889404297
mini_batch_src_global generation:  0.047437191009521484
r_  generation:  0.4326822757720947
----------------------check_connections_block total spend ----------------------------- 1.2622003555297852
generate_one_block  0.5193698406219482
generate_one_block  0.5182266235351562
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02109217643737793
gen group dst list time:  0.011895179748535156
time for parepare:  0.01901531219482422
local_output_nid generation:  0.023152589797973633
local_in_edges_tensor generation:  0.03869175910949707
mini_batch_src_global generation:  0.03310894966125488
r_  generation:  0.36845970153808594
local_output_nid generation:  0.03052210807800293
local_in_edges_tensor generation:  0.028719186782836914
mini_batch_src_global generation:  0.03813433647155762
r_  generation:  0.377638578414917
----------------------check_connections_block total spend ----------------------------- 1.1207923889160156
generate_one_block  0.44829678535461426
generate_one_block  0.4480299949645996
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14357280731201172  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.382992744445801
block generation total time  1.9339232444763184
average batch blocks generation time:  0.9669616222381592
block dataloader generation time/epoch 5.78391894698143
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10902166366577148  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2079148292541504  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1085672378540039  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2075977325439453  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0750349760055542 |0.012828588485717773 |0.003925323486328125 |0.000512242317199707 |0.003066539764404297 |0.0013997554779052734 |
----------------------------------------------------------pseudo_mini_loss sum 1.0363550186157227
Total (block generation + training)time/epoch 6.094617967094694
Training time/epoch 0.2967488765716553
Training time without block to device /epoch 0.2710916996002197
Training time without total dataloading part /epoch 0.01640796661376953
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 58.77it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.39it/s]100%|██████████| 4/4 [00:00<00:00, 15.76it/s]100%|██████████| 4/4 [00:00<00:00, 15.68it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.46it/s]100%|██████████| 4/4 [00:00<00:00, 17.87it/s]100%|██████████| 4/4 [00:00<00:00, 17.78it/s]
Run 00 | Epoch 00065 | Loss 1.0364 | Train 0.3438 | Val 0.3819 | Test 0.3729
Number of nodes during this epoch:  329269
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1433568000793457  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020673036575317383
range selection method range initialization spend 0.016701936721801758
time for parepare:  0.015786170959472656
local_output_nid generation:  0.011654853820800781
local_in_edges_tensor generation:  0.009089946746826172
mini_batch_src_global generation:  0.009927511215209961
r_  generation:  0.1331632137298584
local_output_nid generation:  0.012792825698852539
local_in_edges_tensor generation:  0.005673646926879883
mini_batch_src_global generation:  0.013050317764282227
r_  generation:  0.14423346519470215
----------------------check_connections_block total spend ----------------------------- 0.4122498035430908
generate_one_block  0.15266084671020508
generate_one_block  0.1558389663696289
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029916763305664062
gen group dst list time:  0.005774736404418945
time for parepare:  0.020336627960205078
local_output_nid generation:  0.018752574920654297
local_in_edges_tensor generation:  0.02905893325805664
mini_batch_src_global generation:  0.03805398941040039
r_  generation:  0.4234588146209717
local_output_nid generation:  0.024707794189453125
local_in_edges_tensor generation:  0.02622056007385254
mini_batch_src_global generation:  0.04954171180725098
r_  generation:  0.45664453506469727
----------------------check_connections_block total spend ----------------------------- 1.2800853252410889
generate_one_block  0.5456867218017578
generate_one_block  0.5535342693328857
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02358102798461914
gen group dst list time:  0.012858390808105469
time for parepare:  0.01932382583618164
local_output_nid generation:  0.023878812789916992
local_in_edges_tensor generation:  0.03987765312194824
mini_batch_src_global generation:  0.03341937065124512
r_  generation:  0.37917351722717285
local_output_nid generation:  0.03185153007507324
local_in_edges_tensor generation:  0.027841806411743164
mini_batch_src_global generation:  0.0390622615814209
r_  generation:  0.3889312744140625
----------------------check_connections_block total spend ----------------------------- 1.1553840637207031
generate_one_block  0.4727013111114502
generate_one_block  0.45424747467041016
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1433568000793457  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.435469388961792
block generation total time  2.026169776916504
average batch blocks generation time:  1.013084888458252
block dataloader generation time/epoch 5.786392433601513
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10896444320678711  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2071995735168457  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10860157012939453  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2079343795776367  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08015275001525879 |0.026691794395446777 |0.004075765609741211 |0.0005755424499511719 |0.004008054733276367 |0.0014760494232177734 |
----------------------------------------------------------pseudo_mini_loss sum 1.0322089195251465
Total (block generation + training)time/epoch 6.09733920348318
Training time/epoch 0.3246617317199707
Training time without block to device /epoch 0.27127814292907715
Training time without total dataloading part /epoch 0.018794775009155273
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.67it/s]100%|██████████| 4/4 [00:00<00:00, 26.94it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.44it/s]100%|██████████| 4/4 [00:00<00:00, 12.62it/s]100%|██████████| 4/4 [00:00<00:00, 12.42it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.53it/s]100%|██████████| 4/4 [00:00<00:00, 17.39it/s]100%|██████████| 4/4 [00:00<00:00, 17.39it/s]
Run 00 | Epoch 00066 | Loss 1.0322 | Train 0.3431 | Val 0.3790 | Test 0.3698
Number of nodes during this epoch:  329315
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14397287368774414  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.013531684875488281
range selection method range initialization spend 0.011667966842651367
time for parepare:  0.01570725440979004
local_output_nid generation:  0.011128664016723633
local_in_edges_tensor generation:  0.01334238052368164
mini_batch_src_global generation:  0.00998687744140625
r_  generation:  0.1698925495147705
local_output_nid generation:  0.012379646301269531
local_in_edges_tensor generation:  0.00556182861328125
mini_batch_src_global generation:  0.015724897384643555
r_  generation:  0.14826655387878418
----------------------check_connections_block total spend ----------------------------- 0.458402156829834
generate_one_block  0.15636181831359863
generate_one_block  0.16315031051635742
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.026700735092163086
gen group dst list time:  0.00579380989074707
time for parepare:  0.02039957046508789
local_output_nid generation:  0.017496824264526367
local_in_edges_tensor generation:  0.03217315673828125
mini_batch_src_global generation:  0.0387873649597168
r_  generation:  0.4212348461151123
local_output_nid generation:  0.024597883224487305
local_in_edges_tensor generation:  0.0275118350982666
mini_batch_src_global generation:  0.047332763671875
r_  generation:  0.43739867210388184
----------------------check_connections_block total spend ----------------------------- 1.2506625652313232
generate_one_block  0.5545666217803955
generate_one_block  0.5282549858093262
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.021971940994262695
gen group dst list time:  0.013648033142089844
time for parepare:  0.018954992294311523
local_output_nid generation:  0.024869441986083984
local_in_edges_tensor generation:  0.04121065139770508
mini_batch_src_global generation:  0.032186031341552734
r_  generation:  0.3810420036315918
local_output_nid generation:  0.03305220603942871
local_in_edges_tensor generation:  0.030078649520874023
mini_batch_src_global generation:  0.03792572021484375
r_  generation:  0.3836839199066162
----------------------check_connections_block total spend ----------------------------- 1.162618637084961
generate_one_block  0.4743790626525879
generate_one_block  0.45655369758605957
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14397287368774414  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.413281202316284
block generation total time  2.013754367828369
average batch blocks generation time:  1.0068771839141846
block dataloader generation time/epoch 5.788295885612225
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10898828506469727  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2073922157287598  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10854959487915039  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2076144218444824  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07893633842468262 |0.021483659744262695 |0.004087328910827637 |0.0005278587341308594 |0.0038378238677978516 |0.002953052520751953 |
----------------------------------------------------------pseudo_mini_loss sum 1.0292878150939941
Total (block generation + training)time/epoch 6.099460605917306
Training time/epoch 0.3234124183654785
Training time without block to device /epoch 0.2804450988769531
Training time without total dataloading part /epoch 0.01985907554626465
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.65it/s]100%|██████████| 4/4 [00:00<00:00, 29.24it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.70it/s]100%|██████████| 4/4 [00:00<00:00, 12.92it/s]100%|██████████| 4/4 [00:00<00:00, 12.71it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.81it/s]100%|██████████| 4/4 [00:00<00:00, 18.19it/s]100%|██████████| 4/4 [00:00<00:00, 18.11it/s]
Run 00 | Epoch 00067 | Loss 1.0293 | Train 0.3428 | Val 0.3770 | Test 0.3669
Number of nodes during this epoch:  329215
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1435861587524414  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.014913558959960938
range selection method range initialization spend 0.012086868286132812
time for parepare:  0.016094207763671875
local_output_nid generation:  0.011949300765991211
local_in_edges_tensor generation:  0.009996891021728516
mini_batch_src_global generation:  0.009997844696044922
r_  generation:  0.13857054710388184
local_output_nid generation:  0.012257099151611328
local_in_edges_tensor generation:  0.0074634552001953125
mini_batch_src_global generation:  0.01282501220703125
r_  generation:  0.14879274368286133
----------------------check_connections_block total spend ----------------------------- 0.42582130432128906
generate_one_block  0.16057062149047852
generate_one_block  0.1584625244140625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03972434997558594
gen group dst list time:  0.005772113800048828
time for parepare:  0.02222442626953125
local_output_nid generation:  0.01842665672302246
local_in_edges_tensor generation:  0.03946423530578613
mini_batch_src_global generation:  0.03907918930053711
r_  generation:  0.42272400856018066
local_output_nid generation:  0.025251388549804688
local_in_edges_tensor generation:  0.03063058853149414
mini_batch_src_global generation:  0.04609036445617676
r_  generation:  0.4240152835845947
----------------------check_connections_block total spend ----------------------------- 1.2513079643249512
generate_one_block  0.5258674621582031
generate_one_block  0.5293753147125244
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02026963233947754
gen group dst list time:  0.011286020278930664
time for parepare:  0.018854856491088867
local_output_nid generation:  0.023941516876220703
local_in_edges_tensor generation:  0.04109311103820801
mini_batch_src_global generation:  0.03123641014099121
r_  generation:  0.36983442306518555
local_output_nid generation:  0.031298160552978516
local_in_edges_tensor generation:  0.027280092239379883
mini_batch_src_global generation:  0.03806948661804199
r_  generation:  0.38294410705566406
----------------------check_connections_block total spend ----------------------------- 1.1283040046691895
generate_one_block  0.4457204341888428
generate_one_block  0.4483678340911865
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1435861587524414  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.3796119689941406
block generation total time  1.9493310451507568
average batch blocks generation time:  0.9746655225753784
block dataloader generation time/epoch 5.788090940249169
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10896921157836914  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2075557708740234  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10859918594360352  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2082242965698242  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0823289155960083 |0.011713385581970215 |0.004077553749084473 |0.000508427619934082 |0.002723217010498047 |0.0028793811798095703 |
----------------------------------------------------------pseudo_mini_loss sum 1.0284409523010254
Total (block generation + training)time/epoch 6.09909835104215
Training time/epoch 0.3017287254333496
Training time without block to device /epoch 0.2783019542694092
Training time without total dataloading part /epoch 0.017497777938842773
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.32it/s]100%|██████████| 4/4 [00:00<00:00, 30.23it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.58it/s]100%|██████████| 4/4 [00:00<00:00, 12.63it/s]100%|██████████| 4/4 [00:00<00:00, 12.45it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.23it/s]100%|██████████| 4/4 [00:00<00:00, 17.83it/s]100%|██████████| 4/4 [00:00<00:00, 17.55it/s]
Run 00 | Epoch 00068 | Loss 1.0284 | Train 0.3410 | Val 0.3731 | Test 0.3625
Number of nodes during this epoch:  329485
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14389896392822266  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.012790203094482422
range selection method range initialization spend 0.011782646179199219
time for parepare:  0.015321969985961914
local_output_nid generation:  0.011109590530395508
local_in_edges_tensor generation:  0.010819196701049805
mini_batch_src_global generation:  0.017350435256958008
r_  generation:  0.1435384750366211
local_output_nid generation:  0.012508153915405273
local_in_edges_tensor generation:  0.008021354675292969
mini_batch_src_global generation:  0.013506889343261719
r_  generation:  0.153214693069458
----------------------check_connections_block total spend ----------------------------- 0.45244431495666504
generate_one_block  0.15735960006713867
generate_one_block  0.15836167335510254
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03430366516113281
gen group dst list time:  0.005796909332275391
time for parepare:  0.021837234497070312
local_output_nid generation:  0.01781296730041504
local_in_edges_tensor generation:  0.03707528114318848
mini_batch_src_global generation:  0.0392000675201416
r_  generation:  0.41756319999694824
local_output_nid generation:  0.027637243270874023
local_in_edges_tensor generation:  0.035018205642700195
mini_batch_src_global generation:  0.04651689529418945
r_  generation:  0.42613983154296875
----------------------check_connections_block total spend ----------------------------- 1.2583937644958496
generate_one_block  0.5312187671661377
generate_one_block  0.5374107360839844
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02080845832824707
gen group dst list time:  0.011766195297241211
time for parepare:  0.0203704833984375
local_output_nid generation:  0.024876832962036133
local_in_edges_tensor generation:  0.033286094665527344
mini_batch_src_global generation:  0.03236818313598633
r_  generation:  0.3744938373565674
local_output_nid generation:  0.03313302993774414
local_in_edges_tensor generation:  0.027150630950927734
mini_batch_src_global generation:  0.03942370414733887
r_  generation:  0.4016423225402832
----------------------check_connections_block total spend ----------------------------- 1.1570873260498047
generate_one_block  0.45453739166259766
generate_one_block  0.4537665843963623
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14389896392822266  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.4154810905456543
block generation total time  1.976933479309082
average batch blocks generation time:  0.988466739654541
block dataloader generation time/epoch 5.788729655742645
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10899019241333008  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2075729370117188  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10857295989990234  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2082066535949707  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07883548736572266 |0.016315221786499023 |0.004171848297119141 |0.0005224943161010742 |0.0035859346389770508 |0.003129243850708008 |
----------------------------------------------------------pseudo_mini_loss sum 1.0251855850219727
Total (block generation + training)time/epoch 6.099648479620615
Training time/epoch 0.3055400848388672
Training time without block to device /epoch 0.27290964126586914
Training time without total dataloading part /epoch 0.01968979835510254
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.43it/s]100%|██████████| 4/4 [00:00<00:00, 29.43it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.78it/s]100%|██████████| 4/4 [00:00<00:00, 12.95it/s]100%|██████████| 4/4 [00:00<00:00, 12.75it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.95it/s]100%|██████████| 4/4 [00:00<00:00, 21.53it/s]
Run 00 | Epoch 00069 | Loss 1.0252 | Train 0.3384 | Val 0.3685 | Test 0.3569
Number of nodes during this epoch:  329352
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14415550231933594  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01486515998840332
range selection method range initialization spend 0.015457868576049805
time for parepare:  0.0170743465423584
local_output_nid generation:  0.011028051376342773
local_in_edges_tensor generation:  0.014107465744018555
mini_batch_src_global generation:  0.012496709823608398
r_  generation:  0.13587498664855957
local_output_nid generation:  0.012199163436889648
local_in_edges_tensor generation:  0.009516000747680664
mini_batch_src_global generation:  0.012700319290161133
r_  generation:  0.14688968658447266
----------------------check_connections_block total spend ----------------------------- 0.4298107624053955
generate_one_block  0.15686869621276855
generate_one_block  0.16101312637329102
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03978919982910156
gen group dst list time:  0.007796049118041992
time for parepare:  0.021680355072021484
local_output_nid generation:  0.017548322677612305
local_in_edges_tensor generation:  0.038550615310668945
mini_batch_src_global generation:  0.039325714111328125
r_  generation:  0.414370059967041
local_output_nid generation:  0.024486780166625977
local_in_edges_tensor generation:  0.03120279312133789
mini_batch_src_global generation:  0.04647231101989746
r_  generation:  0.4261939525604248
----------------------check_connections_block total spend ----------------------------- 1.2453713417053223
generate_one_block  0.5271170139312744
generate_one_block  0.5325906276702881
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02039313316345215
gen group dst list time:  0.011243343353271484
time for parepare:  0.019142627716064453
local_output_nid generation:  0.024580955505371094
local_in_edges_tensor generation:  0.03111863136291504
mini_batch_src_global generation:  0.03052663803100586
r_  generation:  0.3823885917663574
local_output_nid generation:  0.03455090522766113
local_in_edges_tensor generation:  0.03299260139465332
mini_batch_src_global generation:  0.03799581527709961
r_  generation:  0.38475918769836426
----------------------check_connections_block total spend ----------------------------- 1.1478383541107178
generate_one_block  0.46078014373779297
generate_one_block  0.4651052951812744
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14415550231933594  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.39320969581604
block generation total time  1.9855930805206299
average batch blocks generation time:  0.9927965402603149
block dataloader generation time/epoch 5.789937203047706
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10897493362426758  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.207685947418213  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10858392715454102  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2079787254333496  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07858467102050781 |0.01890420913696289 |0.00401151180267334 |0.0005028247833251953 |0.003855109214782715 |0.0013747215270996094 |
----------------------------------------------------------pseudo_mini_loss sum 1.022756814956665
Total (block generation + training)time/epoch 6.100960958199423
Training time/epoch 0.3171672821044922
Training time without block to device /epoch 0.2793588638305664
Training time without total dataloading part /epoch 0.01811361312866211
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 48.75it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.41it/s]100%|██████████| 4/4 [00:00<00:00, 15.81it/s]100%|██████████| 4/4 [00:00<00:00, 15.74it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.86it/s]100%|██████████| 4/4 [00:00<00:00, 18.33it/s]100%|██████████| 4/4 [00:00<00:00, 18.23it/s]
Run 00 | Epoch 00070 | Loss 1.0228 | Train 0.3351 | Val 0.3631 | Test 0.3495
Number of nodes during this epoch:  329437
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14380645751953125  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.013461112976074219
range selection method range initialization spend 0.012146711349487305
time for parepare:  0.015141487121582031
local_output_nid generation:  0.010930061340332031
local_in_edges_tensor generation:  0.009127616882324219
mini_batch_src_global generation:  0.010334968566894531
r_  generation:  0.1336803436279297
local_output_nid generation:  0.012373685836791992
local_in_edges_tensor generation:  0.005550384521484375
mini_batch_src_global generation:  0.012908935546875
r_  generation:  0.14534926414489746
----------------------check_connections_block total spend ----------------------------- 0.4115900993347168
generate_one_block  0.15215301513671875
generate_one_block  0.1532602310180664
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028689146041870117
gen group dst list time:  0.005812883377075195
time for parepare:  0.019621849060058594
local_output_nid generation:  0.01661086082458496
local_in_edges_tensor generation:  0.03387641906738281
mini_batch_src_global generation:  0.038199663162231445
r_  generation:  0.4028167724609375
local_output_nid generation:  0.023721933364868164
local_in_edges_tensor generation:  0.022989988327026367
mini_batch_src_global generation:  0.04569673538208008
r_  generation:  0.42020082473754883
----------------------check_connections_block total spend ----------------------------- 1.2061195373535156
generate_one_block  0.5102534294128418
generate_one_block  0.5168664455413818
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01861858367919922
gen group dst list time:  0.011312007904052734
time for parepare:  0.019107580184936523
local_output_nid generation:  0.02326178550720215
local_in_edges_tensor generation:  0.029975414276123047
mini_batch_src_global generation:  0.030689716339111328
r_  generation:  0.3663218021392822
local_output_nid generation:  0.02993488311767578
local_in_edges_tensor generation:  0.026621103286743164
mini_batch_src_global generation:  0.03744173049926758
r_  generation:  0.3740830421447754
----------------------check_connections_block total spend ----------------------------- 1.1003100872039795
generate_one_block  0.4411351680755615
generate_one_block  0.44160890579223633
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14380645751953125  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.306429624557495
block generation total time  1.9098639488220215
average batch blocks generation time:  0.9549319744110107
block dataloader generation time/epoch 5.786815724065227
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10892915725708008  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2071070671081543  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10855627059936523  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2080020904541016  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07910263538360596 |0.011205911636352539 |0.0036290884017944336 |0.0004961490631103516 |0.0028228759765625 |0.0019137859344482422 |
----------------------------------------------------------pseudo_mini_loss sum 1.0191011428833008
Total (block generation + training)time/epoch 6.097641344993345
Training time/epoch 0.2986433506011963
Training time without block to device /epoch 0.2762315273284912
Training time without total dataloading part /epoch 0.015810012817382812
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 62.37it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.77it/s]100%|██████████| 4/4 [00:00<00:00, 15.13it/s]100%|██████████| 4/4 [00:00<00:00, 15.06it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.33it/s]100%|██████████| 4/4 [00:00<00:00, 17.30it/s]100%|██████████| 4/4 [00:00<00:00, 17.28it/s]
Run 00 | Epoch 00071 | Loss 1.0191 | Train 0.3323 | Val 0.3570 | Test 0.3424
Number of nodes during this epoch:  329288
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14422035217285156  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01738715171813965
range selection method range initialization spend 0.013820648193359375
time for parepare:  0.015557527542114258
local_output_nid generation:  0.01242971420288086
local_in_edges_tensor generation:  0.011691570281982422
mini_batch_src_global generation:  0.014397382736206055
r_  generation:  0.13958954811096191
local_output_nid generation:  0.012985706329345703
local_in_edges_tensor generation:  0.006046295166015625
mini_batch_src_global generation:  0.017184734344482422
r_  generation:  0.14299368858337402
----------------------check_connections_block total spend ----------------------------- 0.4312164783477783
generate_one_block  0.15247368812561035
generate_one_block  0.15609145164489746
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029742002487182617
gen group dst list time:  0.005764007568359375
time for parepare:  0.019562721252441406
local_output_nid generation:  0.016493558883666992
local_in_edges_tensor generation:  0.03658151626586914
mini_batch_src_global generation:  0.03921008110046387
r_  generation:  0.40213871002197266
local_output_nid generation:  0.024066448211669922
local_in_edges_tensor generation:  0.0300748348236084
mini_batch_src_global generation:  0.047304630279541016
r_  generation:  0.4164392948150635
----------------------check_connections_block total spend ----------------------------- 1.213069200515747
generate_one_block  0.5102026462554932
generate_one_block  0.5148708820343018
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02307915687561035
gen group dst list time:  0.011511802673339844
time for parepare:  0.018599748611450195
local_output_nid generation:  0.02418065071105957
local_in_edges_tensor generation:  0.02976679801940918
mini_batch_src_global generation:  0.03089594841003418
r_  generation:  0.3683013916015625
local_output_nid generation:  0.030535221099853516
local_in_edges_tensor generation:  0.028093576431274414
mini_batch_src_global generation:  0.03927445411682129
r_  generation:  0.38136816024780273
----------------------check_connections_block total spend ----------------------------- 1.1160082817077637
generate_one_block  0.46689772605895996
generate_one_block  0.45696282386779785
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14422035217285156  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.3290774822235107
block generation total time  1.9489340782165527
average batch blocks generation time:  0.9744670391082764
block dataloader generation time/epoch 5.786184008159335
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10898923873901367  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.207531452178955  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10852956771850586  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2078790664672852  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0801316499710083 |0.011341691017150879 |0.004138350486755371 |0.000529170036315918 |0.0030791759490966797 |0.0029540061950683594 |
----------------------------------------------------------pseudo_mini_loss sum 1.016765832901001
Total (block generation + training)time/epoch 6.096686582716685
Training time/epoch 0.2903251647949219
Training time without block to device /epoch 0.2676417827606201
Training time without total dataloading part /epoch 0.018447399139404297
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.14it/s]100%|██████████| 4/4 [00:00<00:00, 30.53it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.74it/s]100%|██████████| 4/4 [00:00<00:00, 12.80it/s]100%|██████████| 4/4 [00:00<00:00, 12.62it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.28it/s]100%|██████████| 4/4 [00:00<00:00, 17.41it/s]100%|██████████| 4/4 [00:00<00:00, 17.37it/s]
Run 00 | Epoch 00072 | Loss 1.0168 | Train 0.3290 | Val 0.3515 | Test 0.3352
Number of nodes during this epoch:  329353
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1439967155456543  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.015475749969482422
range selection method range initialization spend 0.011917352676391602
time for parepare:  0.01689910888671875
local_output_nid generation:  0.010903358459472656
local_in_edges_tensor generation:  0.012848854064941406
mini_batch_src_global generation:  0.009945154190063477
r_  generation:  0.13589072227478027
local_output_nid generation:  0.012086629867553711
local_in_edges_tensor generation:  0.005527019500732422
mini_batch_src_global generation:  0.012896299362182617
r_  generation:  0.14657926559448242
----------------------check_connections_block total spend ----------------------------- 0.4205138683319092
generate_one_block  0.15924358367919922
generate_one_block  0.15462350845336914
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028419971466064453
gen group dst list time:  0.005710601806640625
time for parepare:  0.01988697052001953
local_output_nid generation:  0.01703953742980957
local_in_edges_tensor generation:  0.03746795654296875
mini_batch_src_global generation:  0.03965044021606445
r_  generation:  0.41296887397766113
local_output_nid generation:  0.024787425994873047
local_in_edges_tensor generation:  0.026526927947998047
mini_batch_src_global generation:  0.04803919792175293
r_  generation:  0.4272496700286865
----------------------check_connections_block total spend ----------------------------- 1.237551212310791
generate_one_block  0.5222296714782715
generate_one_block  0.5222833156585693
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.021811962127685547
gen group dst list time:  0.011591911315917969
time for parepare:  0.019288301467895508
local_output_nid generation:  0.025010108947753906
local_in_edges_tensor generation:  0.032617807388305664
mini_batch_src_global generation:  0.030932903289794922
r_  generation:  0.37746453285217285
local_output_nid generation:  0.03701019287109375
local_in_edges_tensor generation:  0.033539533615112305
mini_batch_src_global generation:  0.046656131744384766
r_  generation:  0.38252806663513184
----------------------check_connections_block total spend ----------------------------- 1.1556706428527832
generate_one_block  0.45572614669799805
generate_one_block  0.46207237243652344
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1439967155456543  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.393221855163574
block generation total time  1.9623115062713623
average batch blocks generation time:  0.9811557531356812
block dataloader generation time/epoch 5.7864160649478436
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10897493362426758  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2068266868591309  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10860681533813477  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2097859382629395  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08030128479003906 |0.01780068874359131 |0.004169583320617676 |0.0005178451538085938 |0.0026731491088867188 |0.0029327869415283203 |
----------------------------------------------------------pseudo_mini_loss sum 1.0129408836364746
Total (block generation + training)time/epoch 6.097049914300442
Training time/epoch 0.3187413215637207
Training time without block to device /epoch 0.2831399440765381
Training time without total dataloading part /epoch 0.017653942108154297
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.90it/s]100%|██████████| 4/4 [00:00<00:00, 29.44it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.51it/s]100%|██████████| 4/4 [00:00<00:00, 12.72it/s]100%|██████████| 4/4 [00:00<00:00, 12.51it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.98it/s]100%|██████████| 4/4 [00:00<00:00, 17.44it/s]100%|██████████| 4/4 [00:00<00:00, 17.35it/s]
Run 00 | Epoch 00073 | Loss 1.0129 | Train 0.3257 | Val 0.3445 | Test 0.3277
Number of nodes during this epoch:  329307
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14444446563720703  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.014102697372436523
range selection method range initialization spend 0.011948108673095703
time for parepare:  0.015751361846923828
local_output_nid generation:  0.011507987976074219
local_in_edges_tensor generation:  0.011923074722290039
mini_batch_src_global generation:  0.010030508041381836
r_  generation:  0.13548016548156738
local_output_nid generation:  0.011973381042480469
local_in_edges_tensor generation:  0.0057697296142578125
mini_batch_src_global generation:  0.013016223907470703
r_  generation:  0.1438121795654297
----------------------check_connections_block total spend ----------------------------- 0.4176294803619385
generate_one_block  0.15250086784362793
generate_one_block  0.15288138389587402
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030073165893554688
gen group dst list time:  0.005667448043823242
time for parepare:  0.020192623138427734
local_output_nid generation:  0.017510414123535156
local_in_edges_tensor generation:  0.029473304748535156
mini_batch_src_global generation:  0.0386652946472168
r_  generation:  0.4130280017852783
local_output_nid generation:  0.025080204010009766
local_in_edges_tensor generation:  0.02801370620727539
mini_batch_src_global generation:  0.045763254165649414
r_  generation:  0.4220240116119385
----------------------check_connections_block total spend ----------------------------- 1.2229044437408447
generate_one_block  0.523388147354126
generate_one_block  0.5305745601654053
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.020740747451782227
gen group dst list time:  0.011644124984741211
time for parepare:  0.021517038345336914
local_output_nid generation:  0.024748563766479492
local_in_edges_tensor generation:  0.030762195587158203
mini_batch_src_global generation:  0.031002521514892578
r_  generation:  0.40079307556152344
local_output_nid generation:  0.035602569580078125
local_in_edges_tensor generation:  0.034299373626708984
mini_batch_src_global generation:  0.043186187744140625
r_  generation:  0.38155293464660645
----------------------check_connections_block total spend ----------------------------- 1.1726865768432617
generate_one_block  0.4538857936859131
generate_one_block  0.4519846439361572
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14444446563720703  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.3955910205841064
block generation total time  1.9598331451416016
average batch blocks generation time:  0.9799165725708008
block dataloader generation time/epoch 5.78599333029527
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10944652557373047  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.207871913909912  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10887527465820312  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2074875831604004  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0795292854309082 |0.016768336296081543 |0.004032492637634277 |0.0005162954330444336 |0.002462625503540039 |0.0013701915740966797 |
----------------------------------------------------------pseudo_mini_loss sum 1.0113017559051514
Total (block generation + training)time/epoch 6.096581073907705
Training time/epoch 0.30748987197875977
Training time without block to device /epoch 0.2739531993865967
Training time without total dataloading part /epoch 0.01539301872253418
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 51.69it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.86it/s]100%|██████████| 4/4 [00:00<00:00, 15.41it/s]100%|██████████| 4/4 [00:00<00:00, 15.31it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.54it/s]100%|██████████| 4/4 [00:00<00:00, 17.63it/s]100%|██████████| 4/4 [00:00<00:00, 17.60it/s]
Run 00 | Epoch 00074 | Loss 1.0113 | Train 0.3225 | Val 0.3371 | Test 0.3199
Number of nodes during this epoch:  329248
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1439061164855957  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.015570402145385742
range selection method range initialization spend 0.012121915817260742
time for parepare:  0.015586614608764648
local_output_nid generation:  0.011214494705200195
local_in_edges_tensor generation:  0.011202812194824219
mini_batch_src_global generation:  0.009958982467651367
r_  generation:  0.13694119453430176
local_output_nid generation:  0.012069225311279297
local_in_edges_tensor generation:  0.005790233612060547
mini_batch_src_global generation:  0.013176441192626953
r_  generation:  0.14667487144470215
----------------------check_connections_block total spend ----------------------------- 0.42092108726501465
generate_one_block  0.16137480735778809
generate_one_block  0.1597447395324707
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.036531925201416016
gen group dst list time:  0.0056629180908203125
time for parepare:  0.02037668228149414
local_output_nid generation:  0.02034783363342285
local_in_edges_tensor generation:  0.033419132232666016
mini_batch_src_global generation:  0.0373384952545166
r_  generation:  0.4350738525390625
local_output_nid generation:  0.031039714813232422
local_in_edges_tensor generation:  0.03328514099121094
mini_batch_src_global generation:  0.04868650436401367
r_  generation:  0.42902684211730957
----------------------check_connections_block total spend ----------------------------- 1.2794485092163086
generate_one_block  0.5249946117401123
generate_one_block  0.5242919921875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.019368648529052734
gen group dst list time:  0.011002302169799805
time for parepare:  0.019151926040649414
local_output_nid generation:  0.024308443069458008
local_in_edges_tensor generation:  0.03965306282043457
mini_batch_src_global generation:  0.032913923263549805
r_  generation:  0.38324856758117676
local_output_nid generation:  0.03142976760864258
local_in_edges_tensor generation:  0.0285646915435791
mini_batch_src_global generation:  0.03786420822143555
r_  generation:  0.40462303161621094
----------------------check_connections_block total spend ----------------------------- 1.1719579696655273
generate_one_block  0.4687929153442383
generate_one_block  0.45813941955566406
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1439061164855957  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.451406478881836
block generation total time  1.9762189388275146
average batch blocks generation time:  0.9881094694137573
block dataloader generation time/epoch 5.788578828175862
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1089634895324707  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.207252025604248  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10857486724853516  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2080836296081543  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08302175998687744 |0.013608455657958984 |0.0044324398040771484 |0.0005511045455932617 |0.0023031234741210938 |0.0017399787902832031 |
----------------------------------------------------------pseudo_mini_loss sum 1.011296033859253
Total (block generation + training)time/epoch 6.099215706189473
Training time/epoch 0.3136742115020752
Training time without block to device /epoch 0.2864573001861572
Training time without total dataloading part /epoch 0.01631331443786621
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.07it/s]100%|██████████| 4/4 [00:00<00:00, 23.21it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.66it/s]100%|██████████| 4/4 [00:00<00:00, 12.72it/s]100%|██████████| 4/4 [00:00<00:00, 12.53it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.28it/s]100%|██████████| 4/4 [00:00<00:00, 17.99it/s]100%|██████████| 4/4 [00:00<00:00, 17.86it/s]
Run 00 | Epoch 00075 | Loss 1.0113 | Train 0.3193 | Val 0.3299 | Test 0.3123
Number of nodes during this epoch:  329206
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14451122283935547  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.016552209854125977
range selection method range initialization spend 0.012004375457763672
time for parepare:  0.016824722290039062
local_output_nid generation:  0.01108551025390625
local_in_edges_tensor generation:  0.008665084838867188
mini_batch_src_global generation:  0.009958982467651367
r_  generation:  0.13565301895141602
local_output_nid generation:  0.012931108474731445
local_in_edges_tensor generation:  0.005643129348754883
mini_batch_src_global generation:  0.012717723846435547
r_  generation:  0.14652776718139648
----------------------check_connections_block total spend ----------------------------- 0.416534423828125
generate_one_block  0.15530109405517578
generate_one_block  0.15425348281860352
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02700042724609375
gen group dst list time:  0.00587153434753418
time for parepare:  0.020188331604003906
local_output_nid generation:  0.016936540603637695
local_in_edges_tensor generation:  0.029196500778198242
mini_batch_src_global generation:  0.03843522071838379
r_  generation:  0.4130685329437256
local_output_nid generation:  0.02434372901916504
local_in_edges_tensor generation:  0.027066946029663086
mini_batch_src_global generation:  0.04666280746459961
r_  generation:  0.4330883026123047
----------------------check_connections_block total spend ----------------------------- 1.2349965572357178
generate_one_block  0.5209836959838867
generate_one_block  0.5528666973114014
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.021993637084960938
gen group dst list time:  0.013502836227416992
time for parepare:  0.019087553024291992
local_output_nid generation:  0.024427175521850586
local_in_edges_tensor generation:  0.03911113739013672
mini_batch_src_global generation:  0.03822207450866699
r_  generation:  0.3728029727935791
local_output_nid generation:  0.03074812889099121
local_in_edges_tensor generation:  0.03217005729675293
mini_batch_src_global generation:  0.037706613540649414
r_  generation:  0.3832066059112549
----------------------check_connections_block total spend ----------------------------- 1.1433968544006348
generate_one_block  0.45298242568969727
generate_one_block  0.4684014320373535
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14451122283935547  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.3783934116363525
block generation total time  1.9952342510223389
average batch blocks generation time:  0.9976171255111694
block dataloader generation time/epoch 5.788968182321804
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10896062850952148  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2068758010864258  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10859107971191406  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.210134506225586  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07874274253845215 |0.015207529067993164 |0.004156827926635742 |0.0005176067352294922 |0.002838611602783203 |0.0029141902923583984 |
----------------------------------------------------------pseudo_mini_loss sum 1.0079474449157715
Total (block generation + training)time/epoch 6.099652222732999
Training time/epoch 0.3136436939239502
Training time without block to device /epoch 0.28322863578796387
Training time without total dataloading part /epoch 0.017940282821655273
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 50.22it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.25it/s]100%|██████████| 4/4 [00:00<00:00, 15.61it/s]100%|██████████| 4/4 [00:00<00:00, 15.54it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.51it/s]100%|██████████| 4/4 [00:00<00:00, 17.95it/s]100%|██████████| 4/4 [00:00<00:00, 17.86it/s]
Run 00 | Epoch 00076 | Loss 1.0079 | Train 0.3160 | Val 0.3227 | Test 0.3053
Number of nodes during this epoch:  329197
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14439964294433594  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.015380859375
range selection method range initialization spend 0.011965751647949219
time for parepare:  0.0158083438873291
local_output_nid generation:  0.011084556579589844
local_in_edges_tensor generation:  0.010351896286010742
mini_batch_src_global generation:  0.009824275970458984
r_  generation:  0.13323473930358887
local_output_nid generation:  0.01304769515991211
local_in_edges_tensor generation:  0.005522251129150391
mini_batch_src_global generation:  0.012698888778686523
r_  generation:  0.14570045471191406
----------------------check_connections_block total spend ----------------------------- 0.41474103927612305
generate_one_block  0.15584897994995117
generate_one_block  0.16654729843139648
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03019094467163086
gen group dst list time:  0.005747318267822266
time for parepare:  0.019942283630371094
local_output_nid generation:  0.016672611236572266
local_in_edges_tensor generation:  0.03937840461730957
mini_batch_src_global generation:  0.040009260177612305
r_  generation:  0.4144904613494873
local_output_nid generation:  0.0247342586517334
local_in_edges_tensor generation:  0.030716657638549805
mini_batch_src_global generation:  0.04612302780151367
r_  generation:  0.42476487159729004
----------------------check_connections_block total spend ----------------------------- 1.2389426231384277
generate_one_block  0.5212178230285645
generate_one_block  0.5205764770507812
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02151656150817871
gen group dst list time:  0.01125645637512207
time for parepare:  0.018696308135986328
local_output_nid generation:  0.02428126335144043
local_in_edges_tensor generation:  0.035504817962646484
mini_batch_src_global generation:  0.03060746192932129
r_  generation:  0.37426018714904785
local_output_nid generation:  0.03112649917602539
local_in_edges_tensor generation:  0.029258251190185547
mini_batch_src_global generation:  0.037659645080566406
r_  generation:  0.3833434581756592
----------------------check_connections_block total spend ----------------------------- 1.127366065979004
generate_one_block  0.45485520362854004
generate_one_block  0.4509611129760742
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14439964294433594  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.3663086891174316
block generation total time  1.94761061668396
average batch blocks generation time:  0.97380530834198
block dataloader generation time/epoch 5.788310310419868
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10931110382080078  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2073640823364258  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10888385772705078  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2076678276062012  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07899093627929688 |0.01292264461517334 |0.0044994354248046875 |0.0005433559417724609 |0.002950906753540039 |0.0016024112701416016 |
----------------------------------------------------------pseudo_mini_loss sum 1.0045361518859863
Total (block generation + training)time/epoch 6.098756001276128
Training time/epoch 0.29431819915771484
Training time without block to device /epoch 0.26847290992736816
Training time without total dataloading part /epoch 0.017589807510375977
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.48it/s]100%|██████████| 4/4 [00:00<00:00, 28.34it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.20it/s]100%|██████████| 4/4 [00:00<00:00, 12.37it/s]100%|██████████| 4/4 [00:00<00:00, 12.17it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.12it/s]100%|██████████| 4/4 [00:00<00:00, 16.72it/s]100%|██████████| 4/4 [00:00<00:00, 16.76it/s]
Run 00 | Epoch 00077 | Loss 1.0045 | Train 0.3118 | Val 0.3154 | Test 0.2975
Number of nodes during this epoch:  329306
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14367103576660156  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01908564567565918
range selection method range initialization spend 0.01461172103881836
time for parepare:  0.016404151916503906
local_output_nid generation:  0.011614561080932617
local_in_edges_tensor generation:  0.011500120162963867
mini_batch_src_global generation:  0.009946346282958984
r_  generation:  0.13653230667114258
local_output_nid generation:  0.011928796768188477
local_in_edges_tensor generation:  0.006012678146362305
mini_batch_src_global generation:  0.012790918350219727
r_  generation:  0.14485979080200195
----------------------check_connections_block total spend ----------------------------- 0.4179117679595947
generate_one_block  0.15637660026550293
generate_one_block  0.1542215347290039
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.027457714080810547
gen group dst list time:  0.005822896957397461
time for parepare:  0.01981830596923828
local_output_nid generation:  0.017288684844970703
local_in_edges_tensor generation:  0.02791595458984375
mini_batch_src_global generation:  0.03899025917053223
r_  generation:  0.446333646774292
local_output_nid generation:  0.024396657943725586
local_in_edges_tensor generation:  0.029453754425048828
mini_batch_src_global generation:  0.04646134376525879
r_  generation:  0.4270293712615967
----------------------check_connections_block total spend ----------------------------- 1.2655510902404785
generate_one_block  0.5238018035888672
generate_one_block  0.5188910961151123
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01783132553100586
gen group dst list time:  0.011279106140136719
time for parepare:  0.01880049705505371
local_output_nid generation:  0.024447202682495117
local_in_edges_tensor generation:  0.03277921676635742
mini_batch_src_global generation:  0.030192136764526367
r_  generation:  0.3762061595916748
local_output_nid generation:  0.031494140625
local_in_edges_tensor generation:  0.029422998428344727
mini_batch_src_global generation:  0.03768324851989746
r_  generation:  0.3815188407897949
----------------------check_connections_block total spend ----------------------------- 1.127800464630127
generate_one_block  0.47634124755859375
generate_one_block  0.4618961811065674
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14367103576660156  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.3933515548706055
block generation total time  1.9809303283691406
average batch blocks generation time:  0.9904651641845703
block dataloader generation time/epoch 5.789029947225599
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10899686813354492  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2081646919250488  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10843133926391602  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2073826789855957  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0814669132232666 |0.017084836959838867 |0.00414884090423584 |0.0005373954772949219 |0.003968715667724609 |0.0018715858459472656 |
----------------------------------------------------------pseudo_mini_loss sum 1.00221848487854
Total (block generation + training)time/epoch 6.099517874095751
Training time/epoch 0.31321072578430176
Training time without block to device /epoch 0.279041051864624
Training time without total dataloading part /epoch 0.019181489944458008
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.97it/s]100%|██████████| 4/4 [00:00<00:00, 30.13it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.62it/s]100%|██████████| 4/4 [00:00<00:00, 12.65it/s]100%|██████████| 4/4 [00:00<00:00, 12.47it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.38it/s]100%|██████████| 4/4 [00:00<00:00, 17.77it/s]100%|██████████| 4/4 [00:00<00:00, 17.69it/s]
Run 00 | Epoch 00078 | Loss 1.0022 | Train 0.3071 | Val 0.3062 | Test 0.2886
Number of nodes during this epoch:  329371
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14363861083984375  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.015499591827392578
range selection method range initialization spend 0.011988162994384766
time for parepare:  0.015960693359375
local_output_nid generation:  0.011976957321166992
local_in_edges_tensor generation:  0.012359619140625
mini_batch_src_global generation:  0.01039743423461914
r_  generation:  0.1350109577178955
local_output_nid generation:  0.012575626373291016
local_in_edges_tensor generation:  0.006113529205322266
mini_batch_src_global generation:  0.012643575668334961
r_  generation:  0.1445455551147461
----------------------check_connections_block total spend ----------------------------- 0.4184134006500244
generate_one_block  0.15073895454406738
generate_one_block  0.15369439125061035
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029225826263427734
gen group dst list time:  0.005725383758544922
time for parepare:  0.019842863082885742
local_output_nid generation:  0.01727581024169922
local_in_edges_tensor generation:  0.0329737663269043
mini_batch_src_global generation:  0.03694891929626465
r_  generation:  0.4160161018371582
local_output_nid generation:  0.02432107925415039
local_in_edges_tensor generation:  0.02329397201538086
mini_batch_src_global generation:  0.04609060287475586
r_  generation:  0.42879581451416016
----------------------check_connections_block total spend ----------------------------- 1.2289211750030518
generate_one_block  0.5343818664550781
generate_one_block  0.5566370487213135
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.021743297576904297
gen group dst list time:  0.013907909393310547
time for parepare:  0.021075010299682617
local_output_nid generation:  0.026198387145996094
local_in_edges_tensor generation:  0.04183554649353027
mini_batch_src_global generation:  0.03258490562438965
r_  generation:  0.3741440773010254
local_output_nid generation:  0.032039642333984375
local_in_edges_tensor generation:  0.03310728073120117
mini_batch_src_global generation:  0.03794503211975098
r_  generation:  0.3811938762664795
----------------------check_connections_block total spend ----------------------------- 1.1456594467163086
generate_one_block  0.444028377532959
generate_one_block  0.4471619129180908
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14363861083984375  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.3745806217193604
block generation total time  1.9822092056274414
average batch blocks generation time:  0.9911046028137207
block dataloader generation time/epoch 5.788737065451485
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10930347442626953  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2082934379577637  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10856008529663086  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.207883358001709  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08030581474304199 |0.01594233512878418 |0.0040673017501831055 |0.0005286931991577148 |0.0029810667037963867 |0.0014290809631347656 |
----------------------------------------------------------pseudo_mini_loss sum 0.9972890615463257
Total (block generation + training)time/epoch 6.099213310650417
Training time/epoch 0.30951905250549316
Training time without block to device /epoch 0.2776343822479248
Training time without total dataloading part /epoch 0.01658320426940918
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 52.47it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.27it/s]100%|██████████| 4/4 [00:00<00:00, 15.49it/s]100%|██████████| 4/4 [00:00<00:00, 15.44it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.02it/s]100%|██████████| 4/4 [00:00<00:00, 17.33it/s]100%|██████████| 4/4 [00:00<00:00, 17.15it/s]
Run 00 | Epoch 00079 | Loss 0.9973 | Train 0.3030 | Val 0.2976 | Test 0.2790
Number of nodes during this epoch:  329336
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14390134811401367  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01456904411315918
range selection method range initialization spend 0.011568546295166016
time for parepare:  0.016328811645507812
local_output_nid generation:  0.011922597885131836
local_in_edges_tensor generation:  0.0077190399169921875
mini_batch_src_global generation:  0.010455846786499023
r_  generation:  0.13524770736694336
local_output_nid generation:  0.012150764465332031
local_in_edges_tensor generation:  0.005567073822021484
mini_batch_src_global generation:  0.012674331665039062
r_  generation:  0.14707422256469727
----------------------check_connections_block total spend ----------------------------- 0.4166862964630127
generate_one_block  0.15984106063842773
generate_one_block  0.15880513191223145
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02984023094177246
gen group dst list time:  0.0058133602142333984
time for parepare:  0.020921707153320312
local_output_nid generation:  0.019655942916870117
local_in_edges_tensor generation:  0.03151440620422363
mini_batch_src_global generation:  0.03633618354797363
r_  generation:  0.43284177780151367
local_output_nid generation:  0.028115272521972656
local_in_edges_tensor generation:  0.03457283973693848
mini_batch_src_global generation:  0.04614615440368652
r_  generation:  0.4244990348815918
----------------------check_connections_block total spend ----------------------------- 1.2618019580841064
generate_one_block  0.523484468460083
generate_one_block  0.5247292518615723
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01997208595275879
gen group dst list time:  0.011215925216674805
time for parepare:  0.0197603702545166
local_output_nid generation:  0.02404189109802246
local_in_edges_tensor generation:  0.03811192512512207
mini_batch_src_global generation:  0.030318260192871094
r_  generation:  0.3720982074737549
local_output_nid generation:  0.03057861328125
local_in_edges_tensor generation:  0.029633522033691406
mini_batch_src_global generation:  0.03911304473876953
r_  generation:  0.38047027587890625
----------------------check_connections_block total spend ----------------------------- 1.1294128894805908
generate_one_block  0.4640359878540039
generate_one_block  0.45462822914123535
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14390134811401367  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.3912148475646973
block generation total time  1.9668779373168945
average batch blocks generation time:  0.9834389686584473
block dataloader generation time/epoch 5.788533828627895
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10897207260131836  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2074546813964844  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10853004455566406  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2076845169067383  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07893931865692139 |0.01296985149383545 |0.004146099090576172 |0.0005224943161010742 |0.0031690597534179688 |0.0013685226440429688 |
----------------------------------------------------------pseudo_mini_loss sum 0.99723219871521
Total (block generation + training)time/epoch 6.09879092767205
Training time/epoch 0.2947671413421631
Training time without block to device /epoch 0.2688274383544922
Training time without total dataloading part /epoch 0.0170438289642334
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 53.92it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 13.85it/s]100%|██████████| 4/4 [00:00<00:00, 13.54it/s]100%|██████████| 4/4 [00:00<00:00, 13.58it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.77it/s]100%|██████████| 4/4 [00:00<00:00, 15.51it/s]100%|██████████| 4/4 [00:00<00:00, 15.67it/s]
Run 00 | Epoch 00080 | Loss 0.9972 | Train 0.2992 | Val 0.2893 | Test 0.2707
Number of nodes during this epoch:  329256
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14338445663452148  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.017848491668701172
range selection method range initialization spend 0.011814355850219727
time for parepare:  0.016756057739257812
local_output_nid generation:  0.010854959487915039
local_in_edges_tensor generation:  0.009233713150024414
mini_batch_src_global generation:  0.010425806045532227
r_  generation:  0.13410568237304688
local_output_nid generation:  0.011693239212036133
local_in_edges_tensor generation:  0.006531715393066406
mini_batch_src_global generation:  0.012829065322875977
r_  generation:  0.14539027214050293
----------------------check_connections_block total spend ----------------------------- 0.41409730911254883
generate_one_block  0.15103721618652344
generate_one_block  0.15475773811340332
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029307842254638672
gen group dst list time:  0.005776405334472656
time for parepare:  0.020383834838867188
local_output_nid generation:  0.017436504364013672
local_in_edges_tensor generation:  0.02990412712097168
mini_batch_src_global generation:  0.036763668060302734
r_  generation:  0.4118316173553467
local_output_nid generation:  0.024026155471801758
local_in_edges_tensor generation:  0.022787094116210938
mini_batch_src_global generation:  0.04547905921936035
r_  generation:  0.42233800888061523
----------------------check_connections_block total spend ----------------------------- 1.2135789394378662
generate_one_block  0.5201489925384521
generate_one_block  0.5208272933959961
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02001190185546875
gen group dst list time:  0.011181831359863281
time for parepare:  0.019183874130249023
local_output_nid generation:  0.02446126937866211
local_in_edges_tensor generation:  0.029506921768188477
mini_batch_src_global generation:  0.030045509338378906
r_  generation:  0.37407493591308594
local_output_nid generation:  0.031154632568359375
local_in_edges_tensor generation:  0.027737140655517578
mini_batch_src_global generation:  0.03765726089477539
r_  generation:  0.3799326419830322
----------------------check_connections_block total spend ----------------------------- 1.117521047592163
generate_one_block  0.44934511184692383
generate_one_block  0.4499855041503906
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14338445663452148  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.3310999870300293
block generation total time  1.9403069019317627
average batch blocks generation time:  0.9701534509658813
block dataloader generation time/epoch 5.786967191431257
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10897588729858398  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2074246406555176  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10855913162231445  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2076683044433594  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08334338665008545 |0.011847257614135742 |0.004086732864379883 |0.0005258321762084961 |0.0029653310775756836 |0.001882314682006836 |
----------------------------------------------------------pseudo_mini_loss sum 0.9960939884185791
Total (block generation + training)time/epoch 6.097228752242194
Training time/epoch 0.31043362617492676
Training time without block to device /epoch 0.2867391109466553
Training time without total dataloading part /epoch 0.01703810691833496
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 56.79it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.24it/s]100%|██████████| 4/4 [00:00<00:00, 15.43it/s]100%|██████████| 4/4 [00:00<00:00, 15.39it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.31it/s]100%|██████████| 4/4 [00:00<00:00, 17.47it/s]100%|██████████| 4/4 [00:00<00:00, 17.43it/s]
Run 00 | Epoch 00081 | Loss 0.9961 | Train 0.2963 | Val 0.2829 | Test 0.2644
Number of nodes during this epoch:  329246
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14348459243774414  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.015007972717285156
range selection method range initialization spend 0.012593746185302734
time for parepare:  0.016758441925048828
local_output_nid generation:  0.01095128059387207
local_in_edges_tensor generation:  0.011363983154296875
mini_batch_src_global generation:  0.010433673858642578
r_  generation:  0.1347341537475586
local_output_nid generation:  0.011977434158325195
local_in_edges_tensor generation:  0.006145000457763672
mini_batch_src_global generation:  0.012739896774291992
r_  generation:  0.1462564468383789
----------------------check_connections_block total spend ----------------------------- 0.41753125190734863
generate_one_block  0.15044736862182617
generate_one_block  0.15467119216918945
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028004884719848633
gen group dst list time:  0.0058023929595947266
time for parepare:  0.020015478134155273
local_output_nid generation:  0.01689624786376953
local_in_edges_tensor generation:  0.030057907104492188
mini_batch_src_global generation:  0.03618907928466797
r_  generation:  0.4115159511566162
local_output_nid generation:  0.023827075958251953
local_in_edges_tensor generation:  0.024895429611206055
mini_batch_src_global generation:  0.04510021209716797
r_  generation:  0.4277224540710449
----------------------check_connections_block total spend ----------------------------- 1.2163169384002686
generate_one_block  0.5157809257507324
generate_one_block  0.5308845043182373
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.022469758987426758
gen group dst list time:  0.011240482330322266
time for parepare:  0.018787145614624023
local_output_nid generation:  0.023978710174560547
local_in_edges_tensor generation:  0.03027033805847168
mini_batch_src_global generation:  0.03022146224975586
r_  generation:  0.37232041358947754
local_output_nid generation:  0.032827138900756836
local_in_edges_tensor generation:  0.027033090591430664
mini_batch_src_global generation:  0.03762984275817871
r_  generation:  0.37999486923217773
----------------------check_connections_block total spend ----------------------------- 1.117377758026123
generate_one_block  0.4525575637817383
generate_one_block  0.45471882820129395
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14348459243774414  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.3336946964263916
block generation total time  1.953941822052002
average batch blocks generation time:  0.976970911026001
block dataloader generation time/epoch 5.785804225973887
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10895395278930664  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2072863578796387  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10855484008789062  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2078890800476074  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09485578536987305 |0.014196515083312988 |0.004511594772338867 |0.0005263090133666992 |0.003323197364807129 |0.0019843578338623047 |
----------------------------------------------------------pseudo_mini_loss sum 0.9936777949333191
Total (block generation + training)time/epoch 6.096312095041144
Training time/epoch 0.3280906677246094
Training time without block to device /epoch 0.2996976375579834
Training time without total dataloading part /epoch 0.018706560134887695
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 57.69it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.00it/s]100%|██████████| 4/4 [00:00<00:00, 14.81it/s]100%|██████████| 4/4 [00:00<00:00, 14.83it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.96it/s]100%|██████████| 4/4 [00:00<00:00, 16.40it/s]100%|██████████| 4/4 [00:00<00:00, 16.15it/s]
Run 00 | Epoch 00082 | Loss 0.9937 | Train 0.2939 | Val 0.2769 | Test 0.2583
Number of nodes during this epoch:  329281
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1444392204284668  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.015228748321533203
range selection method range initialization spend 0.012304306030273438
time for parepare:  0.01708841323852539
local_output_nid generation:  0.011228561401367188
local_in_edges_tensor generation:  0.00875091552734375
mini_batch_src_global generation:  0.009956121444702148
r_  generation:  0.13545465469360352
local_output_nid generation:  0.01267099380493164
local_in_edges_tensor generation:  0.005998134613037109
mini_batch_src_global generation:  0.014428138732910156
r_  generation:  0.14275360107421875
----------------------check_connections_block total spend ----------------------------- 0.4151597023010254
generate_one_block  0.1599586009979248
generate_one_block  0.15493202209472656
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030180692672729492
gen group dst list time:  0.005666255950927734
time for parepare:  0.019683837890625
local_output_nid generation:  0.016814470291137695
local_in_edges_tensor generation:  0.02710270881652832
mini_batch_src_global generation:  0.03778862953186035
r_  generation:  0.41326045989990234
local_output_nid generation:  0.02434539794921875
local_in_edges_tensor generation:  0.026388168334960938
mini_batch_src_global generation:  0.04641532897949219
r_  generation:  0.42813730239868164
----------------------check_connections_block total spend ----------------------------- 1.222498893737793
generate_one_block  0.5247211456298828
generate_one_block  0.5271012783050537
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01933598518371582
gen group dst list time:  0.01172327995300293
time for parepare:  0.020592689514160156
local_output_nid generation:  0.025298595428466797
local_in_edges_tensor generation:  0.036086082458496094
mini_batch_src_global generation:  0.03140830993652344
r_  generation:  0.3873755931854248
local_output_nid generation:  0.03588366508483887
local_in_edges_tensor generation:  0.0358731746673584
mini_batch_src_global generation:  0.03741717338562012
r_  generation:  0.3770132064819336
----------------------check_connections_block total spend ----------------------------- 1.1568233966827393
generate_one_block  0.44716429710388184
generate_one_block  0.45188307762145996
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1444392204284668  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.3793222904205322
block generation total time  1.9508697986602783
average batch blocks generation time:  0.9754348993301392
block dataloader generation time/epoch 5.785289622641899
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10901403427124023  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2081389427185059  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10856914520263672  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2078661918640137  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08010077476501465 |0.01660001277923584 |0.004103183746337891 |0.000525355339050293 |0.0037937164306640625 |0.001608133316040039 |
----------------------------------------------------------pseudo_mini_loss sum 0.9917660355567932
Total (block generation + training)time/epoch 6.095778117308745
Training time/epoch 0.30892300605773926
Training time without block to device /epoch 0.2757229804992676
Training time without total dataloading part /epoch 0.01845264434814453
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 52.57it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.11it/s]100%|██████████| 4/4 [00:00<00:00, 15.54it/s]100%|██████████| 4/4 [00:00<00:00, 15.46it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.56it/s]100%|██████████| 4/4 [00:00<00:00, 17.76it/s]100%|██████████| 4/4 [00:00<00:00, 17.71it/s]
Run 00 | Epoch 00083 | Loss 0.9918 | Train 0.2903 | Val 0.2692 | Test 0.2504
Number of nodes during this epoch:  329218
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14425420761108398  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01236867904663086
range selection method range initialization spend 0.011977195739746094
time for parepare:  0.015272140502929688
local_output_nid generation:  0.010806798934936523
local_in_edges_tensor generation:  0.013125896453857422
mini_batch_src_global generation:  0.009876728057861328
r_  generation:  0.1318683624267578
local_output_nid generation:  0.011954069137573242
local_in_edges_tensor generation:  0.005998134613037109
mini_batch_src_global generation:  0.013193368911743164
r_  generation:  0.14307713508605957
----------------------check_connections_block total spend ----------------------------- 0.41143250465393066
generate_one_block  0.15640711784362793
generate_one_block  0.1648540496826172
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030395984649658203
gen group dst list time:  0.005712270736694336
time for parepare:  0.01981973648071289
local_output_nid generation:  0.016535520553588867
local_in_edges_tensor generation:  0.030139446258544922
mini_batch_src_global generation:  0.03749442100524902
r_  generation:  0.40817689895629883
local_output_nid generation:  0.023921966552734375
local_in_edges_tensor generation:  0.02648329734802246
mini_batch_src_global generation:  0.0458831787109375
r_  generation:  0.42344093322753906
----------------------check_connections_block total spend ----------------------------- 1.2145898342132568
generate_one_block  0.5172152519226074
generate_one_block  0.5211982727050781
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.017119884490966797
gen group dst list time:  0.011134862899780273
time for parepare:  0.019017934799194336
local_output_nid generation:  0.02408766746520996
local_in_edges_tensor generation:  0.030153512954711914
mini_batch_src_global generation:  0.03121042251586914
r_  generation:  0.3727126121520996
local_output_nid generation:  0.030832767486572266
local_in_edges_tensor generation:  0.02785515785217285
mini_batch_src_global generation:  0.03741002082824707
r_  generation:  0.3762850761413574
----------------------check_connections_block total spend ----------------------------- 1.114753246307373
generate_one_block  0.4465477466583252
generate_one_block  0.45273780822753906
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14425420761108398  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.32934308052063
block generation total time  1.9376990795135498
average batch blocks generation time:  0.9688495397567749
block dataloader generation time/epoch 5.783812351226807
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10895204544067383  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2071452140808105  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10858011245727539  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2082314491271973  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07855677604675293 |0.012652277946472168 |0.003913402557373047 |0.000510096549987793 |0.0037511587142944336 |0.0013453960418701172 |
----------------------------------------------------------pseudo_mini_loss sum 0.9874935150146484
Total (block generation + training)time/epoch 6.09414244333903
Training time/epoch 0.29851508140563965
Training time without block to device /epoch 0.2732105255126953
Training time without total dataloading part /epoch 0.017694711685180664
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 65.40it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.12it/s]100%|██████████| 4/4 [00:00<00:00, 15.36it/s]100%|██████████| 4/4 [00:00<00:00, 15.31it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.41it/s]100%|██████████| 4/4 [00:00<00:00, 17.73it/s]100%|██████████| 4/4 [00:00<00:00, 17.66it/s]
Run 00 | Epoch 00084 | Loss 0.9875 | Train 0.2868 | Val 0.2617 | Test 0.2431
Number of nodes during this epoch:  329386
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14388418197631836  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.014148950576782227
range selection method range initialization spend 0.01514291763305664
time for parepare:  0.016076326370239258
local_output_nid generation:  0.011944293975830078
local_in_edges_tensor generation:  0.008332490921020508
mini_batch_src_global generation:  0.009882688522338867
r_  generation:  0.13336634635925293
local_output_nid generation:  0.013220071792602539
local_in_edges_tensor generation:  0.006493091583251953
mini_batch_src_global generation:  0.01270747184753418
r_  generation:  0.15057587623596191
----------------------check_connections_block total spend ----------------------------- 0.4229159355163574
generate_one_block  0.15204095840454102
generate_one_block  0.152756929397583
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03245878219604492
gen group dst list time:  0.005721092224121094
time for parepare:  0.021485567092895508
local_output_nid generation:  0.01820659637451172
local_in_edges_tensor generation:  0.037256479263305664
mini_batch_src_global generation:  0.039194345474243164
r_  generation:  0.4112825393676758
local_output_nid generation:  0.02414107322692871
local_in_edges_tensor generation:  0.026018381118774414
mini_batch_src_global generation:  0.04643607139587402
r_  generation:  0.42377185821533203
----------------------check_connections_block total spend ----------------------------- 1.2321231365203857
generate_one_block  0.5166013240814209
generate_one_block  0.521888256072998
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.021142005920410156
gen group dst list time:  0.011183500289916992
time for parepare:  0.019060850143432617
local_output_nid generation:  0.023462772369384766
local_in_edges_tensor generation:  0.029255390167236328
mini_batch_src_global generation:  0.031100749969482422
r_  generation:  0.3724381923675537
local_output_nid generation:  0.031132221221923828
local_in_edges_tensor generation:  0.026322364807128906
mini_batch_src_global generation:  0.03784894943237305
r_  generation:  0.3756999969482422
----------------------check_connections_block total spend ----------------------------- 1.1095831394195557
generate_one_block  0.4463958740234375
generate_one_block  0.4527103900909424
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14388418197631836  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.3417062759399414
block generation total time  1.9375958442687988
average batch blocks generation time:  0.9687979221343994
block dataloader generation time/epoch 5.782335987216548
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10900259017944336  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2075152397155762  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10857248306274414  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2080802917480469  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08022069931030273 |0.011963129043579102 |0.004054546356201172 |0.0005234479904174805 |0.003699064254760742 |0.0013942718505859375 |
----------------------------------------------------------pseudo_mini_loss sum 0.9880018830299377
Total (block generation + training)time/epoch 6.092606657429745
Training time/epoch 0.3056669235229492
Training time without block to device /epoch 0.281740665435791
Training time without total dataloading part /epoch 0.017948389053344727
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.55it/s]100%|██████████| 4/4 [00:00<00:00, 28.29it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.57it/s]100%|██████████| 4/4 [00:00<00:00, 12.68it/s]100%|██████████| 4/4 [00:00<00:00, 12.49it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.18it/s]100%|██████████| 4/4 [00:00<00:00, 17.40it/s]100%|██████████| 4/4 [00:00<00:00, 17.35it/s]
Run 00 | Epoch 00085 | Loss 0.9880 | Train 0.2841 | Val 0.2546 | Test 0.2367
Number of nodes during this epoch:  329370
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14412307739257812  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.011951208114624023
range selection method range initialization spend 0.011705636978149414
time for parepare:  0.015082359313964844
local_output_nid generation:  0.01099395751953125
local_in_edges_tensor generation:  0.007550716400146484
mini_batch_src_global generation:  0.009876251220703125
r_  generation:  0.13251662254333496
local_output_nid generation:  0.01228189468383789
local_in_edges_tensor generation:  0.005586147308349609
mini_batch_src_global generation:  0.012750625610351562
r_  generation:  0.14309430122375488
----------------------check_connections_block total spend ----------------------------- 0.407961368560791
generate_one_block  0.15009307861328125
generate_one_block  0.15316534042358398
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0363616943359375
gen group dst list time:  0.005740642547607422
time for parepare:  0.01983046531677246
local_output_nid generation:  0.016630172729492188
local_in_edges_tensor generation:  0.02668905258178711
mini_batch_src_global generation:  0.037383079528808594
r_  generation:  0.4087333679199219
local_output_nid generation:  0.023960113525390625
local_in_edges_tensor generation:  0.02429509162902832
mini_batch_src_global generation:  0.04668927192687988
r_  generation:  0.42352294921875
----------------------check_connections_block total spend ----------------------------- 1.2113287448883057
generate_one_block  0.5169477462768555
generate_one_block  0.5181548595428467
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.019171714782714844
gen group dst list time:  0.01121973991394043
time for parepare:  0.0185697078704834
local_output_nid generation:  0.023391246795654297
local_in_edges_tensor generation:  0.029858827590942383
mini_batch_src_global generation:  0.03130483627319336
r_  generation:  0.37047386169433594
local_output_nid generation:  0.030516624450683594
local_in_edges_tensor generation:  0.026675939559936523
mini_batch_src_global generation:  0.038422584533691406
r_  generation:  0.3812830448150635
----------------------check_connections_block total spend ----------------------------- 1.1140317916870117
generate_one_block  0.4447786808013916
generate_one_block  0.44913196563720703
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14412307739257812  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.3253605365753174
block generation total time  1.9290132522583008
average batch blocks generation time:  0.9645066261291504
block dataloader generation time/epoch 5.780301258161471
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10898637771606445  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2073168754577637  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10858917236328125  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2082090377807617  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07859480381011963 |0.011510133743286133 |0.003834843635559082 |0.0005099773406982422 |0.00322115421295166 |0.0013115406036376953 |
----------------------------------------------------------pseudo_mini_loss sum 0.9834915399551392
Total (block generation + training)time/epoch 6.090342611461491
Training time/epoch 0.2925281524658203
Training time without block to device /epoch 0.26950788497924805
Training time without total dataloading part /epoch 0.016443490982055664
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 65.44it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.29it/s]100%|██████████| 4/4 [00:00<00:00, 15.29it/s]100%|██████████| 4/4 [00:00<00:00, 15.28it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.53it/s]100%|██████████| 4/4 [00:00<00:00, 17.69it/s]100%|██████████| 4/4 [00:00<00:00, 17.65it/s]
Run 00 | Epoch 00086 | Loss 0.9835 | Train 0.2815 | Val 0.2476 | Test 0.2298
Number of nodes during this epoch:  329310
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14399003982543945  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01276397705078125
range selection method range initialization spend 0.011901378631591797
time for parepare:  0.015828609466552734
local_output_nid generation:  0.011714458465576172
local_in_edges_tensor generation:  0.007521390914916992
mini_batch_src_global generation:  0.009984016418457031
r_  generation:  0.1338362693786621
local_output_nid generation:  0.012040853500366211
local_in_edges_tensor generation:  0.005563020706176758
mini_batch_src_global generation:  0.01289987564086914
r_  generation:  0.1429452896118164
----------------------check_connections_block total spend ----------------------------- 0.40917205810546875
generate_one_block  0.15116047859191895
generate_one_block  0.15386509895324707
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02562880516052246
gen group dst list time:  0.005662679672241211
time for parepare:  0.02278423309326172
local_output_nid generation:  0.017748355865478516
local_in_edges_tensor generation:  0.024461746215820312
mini_batch_src_global generation:  0.03762030601501465
r_  generation:  0.4100191593170166
local_output_nid generation:  0.024049997329711914
local_in_edges_tensor generation:  0.022287368774414062
mini_batch_src_global generation:  0.04598093032836914
r_  generation:  0.42836809158325195
----------------------check_connections_block total spend ----------------------------- 1.2174010276794434
generate_one_block  0.5454723834991455
generate_one_block  0.5151064395904541
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.020872116088867188
gen group dst list time:  0.011301279067993164
time for parepare:  0.01909661293029785
local_output_nid generation:  0.023752927780151367
local_in_edges_tensor generation:  0.030627727508544922
mini_batch_src_global generation:  0.033585548400878906
r_  generation:  0.3694474697113037
local_output_nid generation:  0.03132152557373047
local_in_edges_tensor generation:  0.032422542572021484
mini_batch_src_global generation:  0.03798985481262207
r_  generation:  0.3825221061706543
----------------------check_connections_block total spend ----------------------------- 1.1253557205200195
generate_one_block  0.45154356956481934
generate_one_block  0.46070241928100586
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14399003982543945  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.342756748199463
block generation total time  1.9728248119354248
average batch blocks generation time:  0.9864124059677124
block dataloader generation time/epoch 5.778809840862568
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10901880264282227  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2079181671142578  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10843372344970703  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2069120407104492  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08155989646911621 |0.017403364181518555 |0.003817915916442871 |0.0005115270614624023 |0.00365447998046875 |0.0012514591217041016 |
----------------------------------------------------------pseudo_mini_loss sum 0.9839120507240295
Total (block generation + training)time/epoch 6.088885371501629
Training time/epoch 0.31261491775512695
Training time without block to device /epoch 0.27780818939208984
Training time without total dataloading part /epoch 0.01721930503845215
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 51.43it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.12it/s]100%|██████████| 4/4 [00:00<00:00, 15.47it/s]100%|██████████| 4/4 [00:00<00:00, 15.40it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.28it/s]100%|██████████| 4/4 [00:00<00:00, 17.72it/s]100%|██████████| 4/4 [00:00<00:00, 17.63it/s]
Run 00 | Epoch 00087 | Loss 0.9839 | Train 0.2799 | Val 0.2429 | Test 0.2251
Number of nodes during this epoch:  329409
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14395809173583984  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.012789011001586914
range selection method range initialization spend 0.011814355850219727
time for parepare:  0.015607833862304688
local_output_nid generation:  0.01102590560913086
local_in_edges_tensor generation:  0.009040117263793945
mini_batch_src_global generation:  0.010004281997680664
r_  generation:  0.13339924812316895
local_output_nid generation:  0.011925458908081055
local_in_edges_tensor generation:  0.00596928596496582
mini_batch_src_global generation:  0.013178348541259766
r_  generation:  0.14365553855895996
----------------------check_connections_block total spend ----------------------------- 0.4106123447418213
generate_one_block  0.15055012702941895
generate_one_block  0.15355348587036133
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029374122619628906
gen group dst list time:  0.005677223205566406
time for parepare:  0.019902706146240234
local_output_nid generation:  0.016981840133666992
local_in_edges_tensor generation:  0.027850627899169922
mini_batch_src_global generation:  0.04176163673400879
r_  generation:  0.415557861328125
local_output_nid generation:  0.02425408363342285
local_in_edges_tensor generation:  0.027979135513305664
mini_batch_src_global generation:  0.04631209373474121
r_  generation:  0.42415356636047363
----------------------check_connections_block total spend ----------------------------- 1.2271947860717773
generate_one_block  0.5179948806762695
generate_one_block  0.5192210674285889
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01905226707458496
gen group dst list time:  0.011188030242919922
time for parepare:  0.019094467163085938
local_output_nid generation:  0.023615598678588867
local_in_edges_tensor generation:  0.029273271560668945
mini_batch_src_global generation:  0.03167271614074707
r_  generation:  0.37119483947753906
local_output_nid generation:  0.030611753463745117
local_in_edges_tensor generation:  0.02620244026184082
mini_batch_src_global generation:  0.037850141525268555
r_  generation:  0.3787047863006592
----------------------check_connections_block total spend ----------------------------- 1.1113741397857666
generate_one_block  0.4508662223815918
generate_one_block  0.4511287212371826
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14395809173583984  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.338568925857544
block generation total time  1.9392108917236328
average batch blocks generation time:  0.9696054458618164
block dataloader generation time/epoch 5.777349387543111
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1093149185180664  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.208402156829834  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10860967636108398  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2080168724060059  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07573437690734863 |0.011764049530029297 |0.004199981689453125 |0.0005590915679931641 |0.0034259557723999023 |0.0014269351959228516 |
----------------------------------------------------------pseudo_mini_loss sum 0.9785137176513672
Total (block generation + training)time/epoch 6.08724314351625
Training time/epoch 0.2955741882324219
Training time without block to device /epoch 0.2720460891723633
Training time without total dataloading part /epoch 0.017796993255615234
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 64.17it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.82it/s]100%|██████████| 4/4 [00:00<00:00, 15.40it/s]100%|██████████| 4/4 [00:00<00:00, 15.30it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.46it/s]100%|██████████| 4/4 [00:00<00:00, 17.55it/s]100%|██████████| 4/4 [00:00<00:00, 17.52it/s]
Run 00 | Epoch 00088 | Loss 0.9785 | Train 0.2781 | Val 0.2394 | Test 0.2211
Number of nodes during this epoch:  329306
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1441044807434082  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.013166427612304688
range selection method range initialization spend 0.011770248413085938
time for parepare:  0.015412569046020508
local_output_nid generation:  0.01326131820678711
local_in_edges_tensor generation:  0.007784366607666016
mini_batch_src_global generation:  0.009930610656738281
r_  generation:  0.1352534294128418
local_output_nid generation:  0.01199793815612793
local_in_edges_tensor generation:  0.005475759506225586
mini_batch_src_global generation:  0.012875556945800781
r_  generation:  0.14673328399658203
----------------------check_connections_block total spend ----------------------------- 0.41572117805480957
generate_one_block  0.15409135818481445
generate_one_block  0.15892720222473145
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03059244155883789
gen group dst list time:  0.005869865417480469
time for parepare:  0.0201113224029541
local_output_nid generation:  0.01740431785583496
local_in_edges_tensor generation:  0.027825355529785156
mini_batch_src_global generation:  0.038059234619140625
r_  generation:  0.43509554862976074
local_output_nid generation:  0.028081417083740234
local_in_edges_tensor generation:  0.0356745719909668
mini_batch_src_global generation:  0.05206036567687988
r_  generation:  0.4301149845123291
----------------------check_connections_block total spend ----------------------------- 1.2743523120880127
generate_one_block  0.5287683010101318
generate_one_block  0.5217533111572266
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.022364139556884766
gen group dst list time:  0.0112762451171875
time for parepare:  0.01902461051940918
local_output_nid generation:  0.023805856704711914
local_in_edges_tensor generation:  0.04025459289550781
mini_batch_src_global generation:  0.03333139419555664
r_  generation:  0.37293076515197754
local_output_nid generation:  0.030702829360961914
local_in_edges_tensor generation:  0.029805898666381836
mini_batch_src_global generation:  0.03823447227478027
r_  generation:  0.37753939628601074
----------------------check_connections_block total spend ----------------------------- 1.1334092617034912
generate_one_block  0.4575672149658203
generate_one_block  0.4813199043273926
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1441044807434082  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.407761573791504
block generation total time  1.9894087314605713
average batch blocks generation time:  0.9947043657302856
block dataloader generation time/epoch 5.777425608038902
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10899782180786133  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2074813842773438  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10856008529663086  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2078595161437988  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08056020736694336 |0.014405369758605957 |0.0042182207107543945 |0.000522613525390625 |0.003818035125732422 |0.0014312267303466797 |
----------------------------------------------------------pseudo_mini_loss sum 0.9797321557998657
Total (block generation + training)time/epoch 6.087216266989708
Training time/epoch 0.3014791011810303
Training time without block to device /epoch 0.27266836166381836
Training time without total dataloading part /epoch 0.018548965454101562
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.14it/s]100%|██████████| 4/4 [00:00<00:00, 30.52it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.49it/s]100%|██████████| 4/4 [00:00<00:00, 12.29it/s]100%|██████████| 4/4 [00:00<00:00, 12.15it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.75it/s]100%|██████████| 4/4 [00:00<00:00, 15.97it/s]100%|██████████| 4/4 [00:00<00:00, 16.20it/s]
Run 00 | Epoch 00089 | Loss 0.9797 | Train 0.2768 | Val 0.2371 | Test 0.2188
Number of nodes during this epoch:  329312
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14408063888549805  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.013177871704101562
range selection method range initialization spend 0.011825323104858398
time for parepare:  0.0164034366607666
local_output_nid generation:  0.012393474578857422
local_in_edges_tensor generation:  0.009117603302001953
mini_batch_src_global generation:  0.009945392608642578
r_  generation:  0.13289523124694824
local_output_nid generation:  0.01195216178894043
local_in_edges_tensor generation:  0.005572080612182617
mini_batch_src_global generation:  0.01306462287902832
r_  generation:  0.1456446647644043
----------------------check_connections_block total spend ----------------------------- 0.4145824909210205
generate_one_block  0.15084099769592285
generate_one_block  0.15387344360351562
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02725696563720703
gen group dst list time:  0.0057811737060546875
time for parepare:  0.021651029586791992
local_output_nid generation:  0.01635575294494629
local_in_edges_tensor generation:  0.0266573429107666
mini_batch_src_global generation:  0.03980207443237305
r_  generation:  0.40865206718444824
local_output_nid generation:  0.024996519088745117
local_in_edges_tensor generation:  0.023392200469970703
mini_batch_src_global generation:  0.04668378829956055
r_  generation:  0.4297797679901123
----------------------check_connections_block total spend ----------------------------- 1.2230033874511719
generate_one_block  0.5186893939971924
generate_one_block  0.5253114700317383
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01809096336364746
gen group dst list time:  0.011282682418823242
time for parepare:  0.0191652774810791
local_output_nid generation:  0.023566007614135742
local_in_edges_tensor generation:  0.02996659278869629
mini_batch_src_global generation:  0.03144097328186035
r_  generation:  0.3720557689666748
local_output_nid generation:  0.030772686004638672
local_in_edges_tensor generation:  0.029393672943115234
mini_batch_src_global generation:  0.039636850357055664
r_  generation:  0.38150978088378906
----------------------check_connections_block total spend ----------------------------- 1.1227550506591797
generate_one_block  0.45580029487609863
generate_one_block  0.45328450202941895
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14408063888549805  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.3457584381103516
block generation total time  1.9530856609344482
average batch blocks generation time:  0.9765428304672241
block dataloader generation time/epoch 5.776630322138469
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1089625358581543  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.207531452178955  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10857486724853516  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2076120376586914  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08065330982208252 |0.011654019355773926 |0.004099369049072266 |0.0005375146865844727 |0.0036286115646362305 |0.002920866012573242 |
----------------------------------------------------------pseudo_mini_loss sum 0.9738050699234009
Total (block generation + training)time/epoch 6.086367889686867
Training time/epoch 0.3053410053253174
Training time without block to device /epoch 0.28203296661376953
Training time without total dataloading part /epoch 0.01945185661315918
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 50.87it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.96it/s]100%|██████████| 4/4 [00:00<00:00, 15.32it/s]100%|██████████| 4/4 [00:00<00:00, 15.25it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.29it/s]100%|██████████| 4/4 [00:00<00:00, 17.74it/s]100%|██████████| 4/4 [00:00<00:00, 17.65it/s]
Run 00 | Epoch 00090 | Loss 0.9738 | Train 0.2755 | Val 0.2349 | Test 0.2169
Number of nodes during this epoch:  329358
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14365911483764648  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.011646032333374023
range selection method range initialization spend 0.011829614639282227
time for parepare:  0.015522956848144531
local_output_nid generation:  0.01110696792602539
local_in_edges_tensor generation:  0.0077953338623046875
mini_batch_src_global generation:  0.009929180145263672
r_  generation:  0.1326920986175537
local_output_nid generation:  0.01258397102355957
local_in_edges_tensor generation:  0.005503654479980469
mini_batch_src_global generation:  0.012739181518554688
r_  generation:  0.14398479461669922
----------------------check_connections_block total spend ----------------------------- 0.4087071418762207
generate_one_block  0.15156984329223633
generate_one_block  0.15457653999328613
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.024807453155517578
gen group dst list time:  0.005719184875488281
time for parepare:  0.01982283592224121
local_output_nid generation:  0.017369508743286133
local_in_edges_tensor generation:  0.024478435516357422
mini_batch_src_global generation:  0.038683176040649414
r_  generation:  0.4135732650756836
local_output_nid generation:  0.024762868881225586
local_in_edges_tensor generation:  0.02466297149658203
mini_batch_src_global generation:  0.046474456787109375
r_  generation:  0.42382287979125977
----------------------check_connections_block total spend ----------------------------- 1.2169163227081299
generate_one_block  0.5300090312957764
generate_one_block  0.5578389167785645
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02284860610961914
gen group dst list time:  0.013636589050292969
time for parepare:  0.019446372985839844
local_output_nid generation:  0.025304794311523438
local_in_edges_tensor generation:  0.04533529281616211
mini_batch_src_global generation:  0.03241848945617676
r_  generation:  0.37224912643432617
local_output_nid generation:  0.03164815902709961
local_in_edges_tensor generation:  0.030716419219970703
mini_batch_src_global generation:  0.0380549430847168
r_  generation:  0.38060593605041504
----------------------check_connections_block total spend ----------------------------- 1.1424434185028076
generate_one_block  0.44928479194641113
generate_one_block  0.45200347900390625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14365911483764648  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.3593597412109375
block generation total time  1.9891362190246582
average batch blocks generation time:  0.9945681095123291
block dataloader generation time/epoch 5.776024234004137
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10898447036743164  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2077393531799316  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10853719711303711  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2078604698181152  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08134138584136963 |0.015606284141540527 |0.003995537757873535 |0.0005104541778564453 |0.0034421682357788086 |0.0013720989227294922 |
----------------------------------------------------------pseudo_mini_loss sum 0.973054051399231
Total (block generation + training)time/epoch 6.085749477874942
Training time/epoch 0.30858588218688965
Training time without block to device /epoch 0.2773733139038086
Training time without total dataloading part /epoch 0.01726841926574707
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.33it/s]100%|██████████| 4/4 [00:00<00:00, 30.43it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.60it/s]100%|██████████| 4/4 [00:00<00:00, 12.65it/s]100%|██████████| 4/4 [00:00<00:00, 12.47it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.21it/s]100%|██████████| 4/4 [00:00<00:00, 17.47it/s]100%|██████████| 4/4 [00:00<00:00, 17.41it/s]
Run 00 | Epoch 00091 | Loss 0.9731 | Train 0.2740 | Val 0.2327 | Test 0.2135
Number of nodes during this epoch:  329370
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1443328857421875  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.014999628067016602
range selection method range initialization spend 0.011992692947387695
time for parepare:  0.0157625675201416
local_output_nid generation:  0.010988950729370117
local_in_edges_tensor generation:  0.007850885391235352
mini_batch_src_global generation:  0.011466026306152344
r_  generation:  0.1336045265197754
local_output_nid generation:  0.011941671371459961
local_in_edges_tensor generation:  0.0055577754974365234
mini_batch_src_global generation:  0.012819051742553711
r_  generation:  0.14624786376953125
----------------------check_connections_block total spend ----------------------------- 0.41529297828674316
generate_one_block  0.1559896469116211
generate_one_block  0.15720582008361816
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02829718589782715
gen group dst list time:  0.005782604217529297
time for parepare:  0.02023911476135254
local_output_nid generation:  0.01717519760131836
local_in_edges_tensor generation:  0.025499343872070312
mini_batch_src_global generation:  0.037967681884765625
r_  generation:  0.4159111976623535
local_output_nid generation:  0.02444148063659668
local_in_edges_tensor generation:  0.025229454040527344
mini_batch_src_global generation:  0.04656338691711426
r_  generation:  0.42850804328918457
----------------------check_connections_block total spend ----------------------------- 1.2311069965362549
generate_one_block  0.5402939319610596
generate_one_block  0.5336453914642334
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.023030757904052734
gen group dst list time:  0.013391733169555664
time for parepare:  0.018872499465942383
local_output_nid generation:  0.024191617965698242
local_in_edges_tensor generation:  0.03738069534301758
mini_batch_src_global generation:  0.03181290626525879
r_  generation:  0.3737618923187256
local_output_nid generation:  0.03077411651611328
local_in_edges_tensor generation:  0.03522801399230957
mini_batch_src_global generation:  0.03811240196228027
r_  generation:  0.3823235034942627
----------------------check_connections_block total spend ----------------------------- 1.1378858089447021
generate_one_block  0.4489891529083252
generate_one_block  0.4514658451080322
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1443328857421875  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.368992805480957
block generation total time  1.9743943214416504
average batch blocks generation time:  0.9871971607208252
block dataloader generation time/epoch 5.775981067174889
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10898828506469727  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.207282543182373  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10856008529663086  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.208125114440918  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07967686653137207 |0.012880682945251465 |0.004117250442504883 |0.0005156993865966797 |0.003680706024169922 |0.0014071464538574219 |
----------------------------------------------------------pseudo_mini_loss sum 0.973285436630249
Total (block generation + training)time/epoch 6.085669836366033
Training time/epoch 0.30656003952026367
Training time without block to device /epoch 0.28079867362976074
Training time without total dataloading part /epoch 0.01803445816040039
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 58.79it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.01it/s]100%|██████████| 4/4 [00:00<00:00, 15.37it/s]100%|██████████| 4/4 [00:00<00:00, 15.30it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.63it/s]100%|██████████| 4/4 [00:00<00:00, 17.50it/s]100%|██████████| 4/4 [00:00<00:00, 17.50it/s]
Run 00 | Epoch 00092 | Loss 0.9733 | Train 0.2712 | Val 0.2278 | Test 0.2078
Number of nodes during this epoch:  329297
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14380931854248047  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.013987064361572266
range selection method range initialization spend 0.011784791946411133
time for parepare:  0.015916109085083008
local_output_nid generation:  0.01089930534362793
local_in_edges_tensor generation:  0.007586479187011719
mini_batch_src_global generation:  0.010458707809448242
r_  generation:  0.13382625579833984
local_output_nid generation:  0.011989355087280273
local_in_edges_tensor generation:  0.005510807037353516
mini_batch_src_global generation:  0.01277017593383789
r_  generation:  0.14374899864196777
----------------------check_connections_block total spend ----------------------------- 0.40996694564819336
generate_one_block  0.15518665313720703
generate_one_block  0.15421772003173828
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028000354766845703
gen group dst list time:  0.0057373046875
time for parepare:  0.01981949806213379
local_output_nid generation:  0.01689291000366211
local_in_edges_tensor generation:  0.027662038803100586
mini_batch_src_global generation:  0.039987802505493164
r_  generation:  0.4138357639312744
local_output_nid generation:  0.024250030517578125
local_in_edges_tensor generation:  0.023525714874267578
mini_batch_src_global generation:  0.04621529579162598
r_  generation:  0.42325711250305176
----------------------check_connections_block total spend ----------------------------- 1.2185328006744385
generate_one_block  0.5218715667724609
generate_one_block  0.5248570442199707
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.018352270126342773
gen group dst list time:  0.011159896850585938
time for parepare:  0.018967151641845703
local_output_nid generation:  0.023839235305786133
local_in_edges_tensor generation:  0.030373096466064453
mini_batch_src_global generation:  0.03154587745666504
r_  generation:  0.373166561126709
local_output_nid generation:  0.031215906143188477
local_in_edges_tensor generation:  0.029221534729003906
mini_batch_src_global generation:  0.03810739517211914
r_  generation:  0.37993693351745605
----------------------check_connections_block total spend ----------------------------- 1.1214745044708252
generate_one_block  0.44960999488830566
generate_one_block  0.4573676586151123
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14380931854248047  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.3400073051452637
block generation total time  1.9537062644958496
average batch blocks generation time:  0.9768531322479248
block dataloader generation time/epoch 5.774923685051146
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10899686813354492  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2073955535888672  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10858154296875  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.207387924194336  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07645058631896973 |0.011420130729675293 |0.003851771354675293 |0.0005307197570800781 |0.0033720731735229492 |0.0021619796752929688 |
----------------------------------------------------------pseudo_mini_loss sum 0.9710953235626221
Total (block generation + training)time/epoch 6.084390390486944
Training time/epoch 0.29094815254211426
Training time without block to device /epoch 0.26810789108276367
Training time without total dataloading part /epoch 0.01767110824584961
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 63.25it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.02it/s]100%|██████████| 4/4 [00:00<00:00, 14.93it/s]100%|██████████| 4/4 [00:00<00:00, 14.93it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.91it/s]100%|██████████| 4/4 [00:00<00:00, 17.19it/s]100%|██████████| 4/4 [00:00<00:00, 17.13it/s]
Run 00 | Epoch 00093 | Loss 0.9711 | Train 0.2685 | Val 0.2218 | Test 0.2017
Number of nodes during this epoch:  329297
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14389324188232422  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023653030395507812
range selection method range initialization spend 0.011982917785644531
time for parepare:  0.01640605926513672
local_output_nid generation:  0.010915994644165039
local_in_edges_tensor generation:  0.009505748748779297
mini_batch_src_global generation:  0.01046609878540039
r_  generation:  0.1328871250152588
local_output_nid generation:  0.012600898742675781
local_in_edges_tensor generation:  0.006456851959228516
mini_batch_src_global generation:  0.012774467468261719
r_  generation:  0.14289021492004395
----------------------check_connections_block total spend ----------------------------- 0.41192030906677246
generate_one_block  0.15025115013122559
generate_one_block  0.15381360054016113
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.026994943618774414
gen group dst list time:  0.005718231201171875
time for parepare:  0.019846439361572266
local_output_nid generation:  0.016515493392944336
local_in_edges_tensor generation:  0.029766082763671875
mini_batch_src_global generation:  0.04013705253601074
r_  generation:  0.4106900691986084
local_output_nid generation:  0.0243377685546875
local_in_edges_tensor generation:  0.031461238861083984
mini_batch_src_global generation:  0.04653453826904297
r_  generation:  0.42291760444641113
----------------------check_connections_block total spend ----------------------------- 1.2269513607025146
generate_one_block  0.5157628059387207
generate_one_block  0.5258021354675293
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.019685745239257812
gen group dst list time:  0.011145591735839844
time for parepare:  0.020971059799194336
local_output_nid generation:  0.023913860321044922
local_in_edges_tensor generation:  0.030020952224731445
mini_batch_src_global generation:  0.03187441825866699
r_  generation:  0.3731262683868408
local_output_nid generation:  0.030842065811157227
local_in_edges_tensor generation:  0.028809070587158203
mini_batch_src_global generation:  0.03917360305786133
r_  generation:  0.3823537826538086
----------------------check_connections_block total spend ----------------------------- 1.1244211196899414
generate_one_block  0.4527132511138916
generate_one_block  0.4513680934906006
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14389324188232422  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.351372480392456
block generation total time  1.9456462860107422
average batch blocks generation time:  0.9728231430053711
block dataloader generation time/epoch 5.774023847018971
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10895013809204102  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2073984146118164  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10860204696655273  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2082786560058594  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08033931255340576 |0.015265941619873047 |0.004060626029968262 |0.0005234479904174805 |0.032860636711120605 |0.0029418468475341797 |
----------------------------------------------------------pseudo_mini_loss sum 0.9692145586013794
Total (block generation + training)time/epoch 6.0834496470058665
Training time/epoch 0.30583930015563965
Training time without block to device /epoch 0.27530741691589355
Training time without total dataloading part /epoch 0.07783126831054688
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 56.13it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.95it/s]100%|██████████| 4/4 [00:00<00:00, 15.26it/s]100%|██████████| 4/4 [00:00<00:00, 15.20it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.62it/s]100%|██████████| 4/4 [00:00<00:00, 17.49it/s]100%|██████████| 4/4 [00:00<00:00, 17.49it/s]
Run 00 | Epoch 00094 | Loss 0.9692 | Train 0.2656 | Val 0.2152 | Test 0.1964
Number of nodes during this epoch:  329343
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1433706283569336  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.015294551849365234
range selection method range initialization spend 0.01216745376586914
time for parepare:  0.017049551010131836
local_output_nid generation:  0.01097726821899414
local_in_edges_tensor generation:  0.011798620223999023
mini_batch_src_global generation:  0.015246391296386719
r_  generation:  0.13569021224975586
local_output_nid generation:  0.012154102325439453
local_in_edges_tensor generation:  0.005601644515991211
mini_batch_src_global generation:  0.012907028198242188
r_  generation:  0.14573121070861816
----------------------check_connections_block total spend ----------------------------- 0.42432498931884766
generate_one_block  0.15508699417114258
generate_one_block  0.15413808822631836
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03334355354309082
gen group dst list time:  0.005742549896240234
time for parepare:  0.023699522018432617
local_output_nid generation:  0.016847848892211914
local_in_edges_tensor generation:  0.03460860252380371
mini_batch_src_global generation:  0.03821444511413574
r_  generation:  0.414203405380249
local_output_nid generation:  0.024066686630249023
local_in_edges_tensor generation:  0.027588844299316406
mini_batch_src_global generation:  0.04625296592712402
r_  generation:  0.4226105213165283
----------------------check_connections_block total spend ----------------------------- 1.2316265106201172
generate_one_block  0.5299925804138184
generate_one_block  0.5206949710845947
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.017961502075195312
gen group dst list time:  0.011254072189331055
time for parepare:  0.019037961959838867
local_output_nid generation:  0.023766517639160156
local_in_edges_tensor generation:  0.029287099838256836
mini_batch_src_global generation:  0.03146982192993164
r_  generation:  0.37268996238708496
local_output_nid generation:  0.030874013900756836
local_in_edges_tensor generation:  0.026732683181762695
mini_batch_src_global generation:  0.03789234161376953
r_  generation:  0.38075780868530273
----------------------check_connections_block total spend ----------------------------- 1.1184422969818115
generate_one_block  0.4504075050354004
generate_one_block  0.45063304901123047
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1433706283569336  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.3500688076019287
block generation total time  1.951728105545044
average batch blocks generation time:  0.975864052772522
block dataloader generation time/epoch 5.773518972618636
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10902070999145508  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2079792022705078  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10843181610107422  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2076969146728516  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08126723766326904 |0.012637495994567871 |0.004121661186218262 |0.0005183219909667969 |0.003914594650268555 |0.0013985633850097656 |
----------------------------------------------------------pseudo_mini_loss sum 0.9669069051742554
Total (block generation + training)time/epoch 6.082898633424626
Training time/epoch 0.30530786514282227
Training time without block to device /epoch 0.2800328731536865
Training time without total dataloading part /epoch 0.018507719039916992
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 55.62it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.39it/s]100%|██████████| 4/4 [00:00<00:00, 15.66it/s]100%|██████████| 4/4 [00:00<00:00, 15.60it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.51it/s]100%|██████████| 4/4 [00:00<00:00, 17.51it/s]100%|██████████| 4/4 [00:00<00:00, 17.49it/s]
Run 00 | Epoch 00095 | Loss 0.9669 | Train 0.2631 | Val 0.2094 | Test 0.1908
Number of nodes during this epoch:  329396
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14373254776000977  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.015392541885375977
range selection method range initialization spend 0.011838197708129883
time for parepare:  0.016466856002807617
local_output_nid generation:  0.011773109436035156
local_in_edges_tensor generation:  0.0075109004974365234
mini_batch_src_global generation:  0.010151147842407227
r_  generation:  0.137984037399292
local_output_nid generation:  0.01256418228149414
local_in_edges_tensor generation:  0.006050586700439453
mini_batch_src_global generation:  0.013141393661499023
r_  generation:  0.1474616527557373
----------------------check_connections_block total spend ----------------------------- 0.4203305244445801
generate_one_block  0.15183639526367188
generate_one_block  0.15925097465515137
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.031601667404174805
gen group dst list time:  0.005646228790283203
time for parepare:  0.020381450653076172
local_output_nid generation:  0.01707601547241211
local_in_edges_tensor generation:  0.036275386810302734
mini_batch_src_global generation:  0.03828287124633789
r_  generation:  0.4096207618713379
local_output_nid generation:  0.024231910705566406
local_in_edges_tensor generation:  0.03239107131958008
mini_batch_src_global generation:  0.05790877342224121
r_  generation:  0.42804598808288574
----------------------check_connections_block total spend ----------------------------- 1.2482550144195557
generate_one_block  0.5187811851501465
generate_one_block  0.5231401920318604
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.021615982055664062
gen group dst list time:  0.011210441589355469
time for parepare:  0.01930999755859375
local_output_nid generation:  0.023722410202026367
local_in_edges_tensor generation:  0.03068232536315918
mini_batch_src_global generation:  0.03140401840209961
r_  generation:  0.37335801124572754
local_output_nid generation:  0.031218290328979492
local_in_edges_tensor generation:  0.030472755432128906
mini_batch_src_global generation:  0.0386660099029541
r_  generation:  0.3821868896484375
----------------------check_connections_block total spend ----------------------------- 1.1262986660003662
generate_one_block  0.4483628273010254
generate_one_block  0.4511229991912842
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14373254776000977  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.374553680419922
block generation total time  1.9414072036743164
average batch blocks generation time:  0.9707036018371582
block dataloader generation time/epoch 5.773041700494701
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10930395126342773  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2083415985107422  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10856008529663086  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2079839706420898  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07700157165527344 |0.01186835765838623 |0.004260063171386719 |0.0005651712417602539 |0.0034407377243041992 |0.0014545917510986328 |
----------------------------------------------------------pseudo_mini_loss sum 0.9643692970275879
Total (block generation + training)time/epoch 6.082316982335057
Training time/epoch 0.3001532554626465
Training time without block to device /epoch 0.276416540145874
Training time without total dataloading part /epoch 0.017986536026000977
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.22it/s]100%|██████████| 4/4 [00:00<00:00, 29.45it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.49it/s]100%|██████████| 4/4 [00:00<00:00, 12.59it/s]100%|██████████| 4/4 [00:00<00:00, 12.40it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.26it/s]100%|██████████| 4/4 [00:00<00:00, 17.46it/s]100%|██████████| 4/4 [00:00<00:00, 17.41it/s]
Run 00 | Epoch 00096 | Loss 0.9644 | Train 0.2600 | Val 0.2038 | Test 0.1863
Number of nodes during this epoch:  329249
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1441969871520996  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.013995170593261719
range selection method range initialization spend 0.011751413345336914
time for parepare:  0.016147613525390625
local_output_nid generation:  0.010992050170898438
local_in_edges_tensor generation:  0.007558584213256836
mini_batch_src_global generation:  0.010045528411865234
r_  generation:  0.13732481002807617
local_output_nid generation:  0.011950492858886719
local_in_edges_tensor generation:  0.006026029586791992
mini_batch_src_global generation:  0.012986183166503906
r_  generation:  0.15192961692810059
----------------------check_connections_block total spend ----------------------------- 0.4244997501373291
generate_one_block  0.15675640106201172
generate_one_block  0.16385269165039062
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03984427452087402
gen group dst list time:  0.0058362483978271484
time for parepare:  0.021134614944458008
local_output_nid generation:  0.023197412490844727
local_in_edges_tensor generation:  0.034435272216796875
mini_batch_src_global generation:  0.03981161117553711
r_  generation:  0.41919803619384766
local_output_nid generation:  0.026035308837890625
local_in_edges_tensor generation:  0.03593325614929199
mini_batch_src_global generation:  0.05790853500366211
r_  generation:  0.45026421546936035
----------------------check_connections_block total spend ----------------------------- 1.2990827560424805
generate_one_block  0.5423309803009033
generate_one_block  0.5563805103302002
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02272629737854004
gen group dst list time:  0.01372385025024414
time for parepare:  0.019150257110595703
local_output_nid generation:  0.024242162704467773
local_in_edges_tensor generation:  0.04102325439453125
mini_batch_src_global generation:  0.03753232955932617
r_  generation:  0.3772776126861572
local_output_nid generation:  0.030873775482177734
local_in_edges_tensor generation:  0.033007144927978516
mini_batch_src_global generation:  0.038057565689086914
r_  generation:  0.39330101013183594
----------------------check_connections_block total spend ----------------------------- 1.1626701354980469
generate_one_block  0.455507755279541
generate_one_block  0.45583152770996094
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1441969871520996  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.4617528915405273
block generation total time  2.0100507736206055
average batch blocks generation time:  1.0050253868103027
block dataloader generation time/epoch 5.774672405286268
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10899591445922852  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2072243690490723  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1086115837097168  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2080140113830566  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08696389198303223 |0.01792597770690918 |0.004210710525512695 |0.0005283355712890625 |0.0037031173706054688 |0.0013430118560791016 |
----------------------------------------------------------pseudo_mini_loss sum 0.9624304175376892
Total (block generation + training)time/epoch 6.084210347045552
Training time/epoch 0.33222460746765137
Training time without block to device /epoch 0.296372652053833
Training time without total dataloading part /epoch 0.018227338790893555
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.62it/s]100%|██████████| 4/4 [00:00<00:00, 26.59it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 13.07it/s]100%|██████████| 4/4 [00:00<00:00, 14.71it/s]100%|██████████| 4/4 [00:00<00:00, 14.41it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.68it/s]100%|██████████| 4/4 [00:00<00:00, 20.12it/s]
Run 00 | Epoch 00097 | Loss 0.9624 | Train 0.2571 | Val 0.1979 | Test 0.1810
Number of nodes during this epoch:  329350
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1440258026123047  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01256871223449707
range selection method range initialization spend 0.013584375381469727
time for parepare:  0.015874862670898438
local_output_nid generation:  0.011282682418823242
local_in_edges_tensor generation:  0.010526180267333984
mini_batch_src_global generation:  0.015048503875732422
r_  generation:  0.1388552188873291
local_output_nid generation:  0.01383829116821289
local_in_edges_tensor generation:  0.00616455078125
mini_batch_src_global generation:  0.012796163558959961
r_  generation:  0.17409014701843262
----------------------check_connections_block total spend ----------------------------- 0.4606292247772217
generate_one_block  0.1525576114654541
generate_one_block  0.1533520221710205
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02748274803161621
gen group dst list time:  0.005697965621948242
time for parepare:  0.019985437393188477
local_output_nid generation:  0.017678022384643555
local_in_edges_tensor generation:  0.02786850929260254
mini_batch_src_global generation:  0.03857922554016113
r_  generation:  0.4116387367248535
local_output_nid generation:  0.025107622146606445
local_in_edges_tensor generation:  0.028318405151367188
mini_batch_src_global generation:  0.048154354095458984
r_  generation:  0.4238424301147461
----------------------check_connections_block total spend ----------------------------- 1.2244677543640137
generate_one_block  0.525846004486084
generate_one_block  0.5307643413543701
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.017172574996948242
gen group dst list time:  0.011313915252685547
time for parepare:  0.018707275390625
local_output_nid generation:  0.023955821990966797
local_in_edges_tensor generation:  0.030295848846435547
mini_batch_src_global generation:  0.03169608116149902
r_  generation:  0.38089776039123535
local_output_nid generation:  0.033667802810668945
local_in_edges_tensor generation:  0.03236532211303711
mini_batch_src_global generation:  0.038858890533447266
r_  generation:  0.46229052543640137
----------------------check_connections_block total spend ----------------------------- 1.2352335453033447
generate_one_block  0.47417497634887695
generate_one_block  0.45444202423095703
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.1440258026123047  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.4597012996673584
block generation total time  1.985227346420288
average batch blocks generation time:  0.992613673210144
block dataloader generation time/epoch 5.776715734031763
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10899686813354492  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.208082675933838  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10851669311523438  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.207326889038086  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09044420719146729 |0.019057512283325195 |0.004300236701965332 |0.0005487203598022461 |0.003478407859802246 |0.001344919204711914 |
----------------------------------------------------------pseudo_mini_loss sum 0.9636518955230713
Total (block generation + training)time/epoch 6.086572858724701
Training time/epoch 0.33779120445251465
Training time without block to device /epoch 0.29967617988586426
Training time without total dataloading part /epoch 0.017999649047851562
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.94it/s]100%|██████████| 4/4 [00:00<00:00, 30.36it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 11.70it/s]100%|██████████| 4/4 [00:00<00:00, 12.93it/s]100%|██████████| 4/4 [00:00<00:00, 12.72it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.53it/s]100%|██████████| 4/4 [00:00<00:00, 17.97it/s]100%|██████████| 4/4 [00:00<00:00, 17.88it/s]
Run 00 | Epoch 00098 | Loss 0.9637 | Train 0.2554 | Val 0.1948 | Test 0.1774
Number of nodes during this epoch:  329195
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14385032653808594  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.013863086700439453
range selection method range initialization spend 0.011962175369262695
time for parepare:  0.015245914459228516
local_output_nid generation:  0.010927438735961914
local_in_edges_tensor generation:  0.008573770523071289
mini_batch_src_global generation:  0.010509490966796875
r_  generation:  0.13478899002075195
local_output_nid generation:  0.01263427734375
local_in_edges_tensor generation:  0.005769014358520508
mini_batch_src_global generation:  0.013162851333618164
r_  generation:  0.15494942665100098
----------------------check_connections_block total spend ----------------------------- 0.4245905876159668
generate_one_block  0.1559007167816162
generate_one_block  0.1529221534729004
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030212879180908203
gen group dst list time:  0.005974292755126953
time for parepare:  0.01965188980102539
local_output_nid generation:  0.017106056213378906
local_in_edges_tensor generation:  0.027918100357055664
mini_batch_src_global generation:  0.041983842849731445
r_  generation:  0.40711116790771484
local_output_nid generation:  0.024323225021362305
local_in_edges_tensor generation:  0.03132939338684082
mini_batch_src_global generation:  0.04672861099243164
r_  generation:  0.4455583095550537
----------------------check_connections_block total spend ----------------------------- 1.250922679901123
generate_one_block  0.5282671451568604
generate_one_block  0.5202460289001465
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02313995361328125
gen group dst list time:  0.012554168701171875
time for parepare:  0.019113540649414062
local_output_nid generation:  0.023540735244750977
local_in_edges_tensor generation:  0.04533123970031738
mini_batch_src_global generation:  0.032160043716430664
r_  generation:  0.3692002296447754
local_output_nid generation:  0.03136277198791504
local_in_edges_tensor generation:  0.03550243377685547
mini_batch_src_global generation:  0.038396596908569336
r_  generation:  0.37488794326782227
----------------------check_connections_block total spend ----------------------------- 1.1347193717956543
generate_one_block  0.4548625946044922
generate_one_block  0.45010900497436523
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.14385032653808594  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

connection checking time:  2.3856420516967773
block generation total time  1.9534847736358643
average batch blocks generation time:  0.9767423868179321
block dataloader generation time/epoch 5.776371696260241
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10894536972045898  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2075128555297852  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 0.10847997665405273  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7244873046875 GB
    Memory Allocated: 1.2073302268981934  GigaBytes
Max Memory Allocated: 1.4423236846923828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08758246898651123 |0.014827609062194824 |0.0040465593338012695 |0.0005449056625366211 |0.002676248550415039 |0.001470327377319336 |
----------------------------------------------------------pseudo_mini_loss sum 0.9598573446273804
Total (block generation + training)time/epoch 6.086316566997104
Training time/epoch 0.31760668754577637
Training time without block to device /epoch 0.2879514694213867
Training time without total dataloading part /epoch 0.016005754470825195
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 52.60it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.84it/s]100%|██████████| 4/4 [00:00<00:00, 15.14it/s]100%|██████████| 4/4 [00:00<00:00, 15.08it/s]
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.65it/s]100%|██████████| 4/4 [00:00<00:00, 17.70it/s]100%|██████████| 4/4 [00:00<00:00, 17.68it/s]
Run 00 | Epoch 00099 | Loss 0.9599 | Train 0.2541 | Val 0.1926 | Test 0.1754
Number of nodes during this epoch:  329236
The number of model layers:  3
Run 01:
Highest Train: 46.48
Highest Valid: 53.45
  Final Train: 46.48
   Final Test: 53.30
The number of model layers:  3
All runs:
Highest Train: 46.48 ± nan
Highest Valid: 53.45 ± nan
  Final Train: 46.48 ± nan
   Final Test: 53.30 ± nan
