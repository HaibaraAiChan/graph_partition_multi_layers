Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648442395.6198106
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02714085578918457
random selection method range initialization spend 0.006200313568115234
time for parepare:  0.018379688262939453
local_output_nid generation:  0.004324913024902344
local_in_edges_tensor generation:  0.006875038146972656
mini_batch_src_global generation:  0.00359344482421875
r_  generation:  0.04086422920227051
local_output_nid generation:  0.0056531429290771484
local_in_edges_tensor generation:  0.0032389163970947266
mini_batch_src_global generation:  0.0043218135833740234
r_  generation:  0.04093575477600098
local_output_nid generation:  0.006060361862182617
local_in_edges_tensor generation:  0.003251314163208008
mini_batch_src_global generation:  0.0032074451446533203
r_  generation:  0.0428318977355957
local_output_nid generation:  0.0060575008392333984
local_in_edges_tensor generation:  0.0034050941467285156
mini_batch_src_global generation:  0.0032486915588378906
r_  generation:  0.045656442642211914
local_output_nid generation:  0.006092071533203125
local_in_edges_tensor generation:  0.0033118724822998047
mini_batch_src_global generation:  0.003493785858154297
r_  generation:  0.044283390045166016
local_output_nid generation:  0.0060882568359375
local_in_edges_tensor generation:  0.003262042999267578
mini_batch_src_global generation:  0.003845691680908203
r_  generation:  0.045685768127441406
local_output_nid generation:  0.006066560745239258
local_in_edges_tensor generation:  0.0031745433807373047
mini_batch_src_global generation:  0.0036432743072509766
r_  generation:  0.04547572135925293
local_output_nid generation:  0.006105184555053711
local_in_edges_tensor generation:  0.0032134056091308594
mini_batch_src_global generation:  0.0038154125213623047
r_  generation:  0.046202898025512695
----------------------check_connections_block total spend ----------------------------- 0.5581164360046387
generate_one_block  0.06090855598449707
generate_one_block  0.05892539024353027
generate_one_block  0.06081080436706543
generate_one_block  0.06200528144836426
generate_one_block  0.06409192085266113
generate_one_block  0.06099748611450195
generate_one_block  0.06032919883728027
generate_one_block  0.061725616455078125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04342937469482422
gen group dst list time:  0.01612257957458496
time for parepare:  0.019701242446899414
local_output_nid generation:  0.014816522598266602
local_in_edges_tensor generation:  0.034087419509887695
mini_batch_src_global generation:  0.03406929969787598
r_  generation:  0.3524656295776367
local_output_nid generation:  0.022987842559814453
local_in_edges_tensor generation:  0.035307884216308594
mini_batch_src_global generation:  0.043088674545288086
r_  generation:  0.36356210708618164
local_output_nid generation:  0.023503541946411133
local_in_edges_tensor generation:  0.030295848846435547
mini_batch_src_global generation:  0.04294705390930176
r_  generation:  0.3825061321258545
local_output_nid generation:  0.023679494857788086
local_in_edges_tensor generation:  0.027325153350830078
mini_batch_src_global generation:  0.045601606369018555
r_  generation:  0.38441038131713867
local_output_nid generation:  0.022959232330322266
local_in_edges_tensor generation:  0.02438950538635254
mini_batch_src_global generation:  0.045319318771362305
r_  generation:  0.3798229694366455
local_output_nid generation:  0.023736000061035156
local_in_edges_tensor generation:  0.024348974227905273
mini_batch_src_global generation:  0.04630017280578613
r_  generation:  0.38564515113830566
local_output_nid generation:  0.023442983627319336
local_in_edges_tensor generation:  0.027475357055664062
mini_batch_src_global generation:  0.046660423278808594
r_  generation:  0.3890359401702881
local_output_nid generation:  0.023786544799804688
local_in_edges_tensor generation:  0.026678800582885742
mini_batch_src_global generation:  0.04923653602600098
r_  generation:  0.3798506259918213
----------------------check_connections_block total spend ----------------------------- 4.434935808181763
generate_one_block  0.4938681125640869
generate_one_block  0.48397254943847656
generate_one_block  0.5025999546051025
generate_one_block  0.5155029296875
generate_one_block  0.48874473571777344
generate_one_block  0.5212829113006592
generate_one_block  0.4978363513946533
generate_one_block  0.5070407390594482
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03692507743835449
gen group dst list time:  0.0369257926940918
time for parepare:  0.019575119018554688
local_output_nid generation:  0.029172897338867188
local_in_edges_tensor generation:  0.044747114181518555
mini_batch_src_global generation:  0.048091888427734375
r_  generation:  0.4789900779724121
local_output_nid generation:  0.035996437072753906
local_in_edges_tensor generation:  0.053966522216796875
mini_batch_src_global generation:  0.05453133583068848
r_  generation:  0.4844841957092285
local_output_nid generation:  0.03660726547241211
local_in_edges_tensor generation:  0.04246926307678223
mini_batch_src_global generation:  0.05799460411071777
r_  generation:  0.48348474502563477
local_output_nid generation:  0.03636622428894043
local_in_edges_tensor generation:  0.04519462585449219
mini_batch_src_global generation:  0.05263566970825195
r_  generation:  0.4961991310119629
local_output_nid generation:  0.03659200668334961
local_in_edges_tensor generation:  0.036594390869140625
mini_batch_src_global generation:  0.05664181709289551
r_  generation:  0.4905064105987549
local_output_nid generation:  0.03626394271850586
local_in_edges_tensor generation:  0.04062771797180176
mini_batch_src_global generation:  0.05326509475708008
r_  generation:  0.502518892288208
local_output_nid generation:  0.03633308410644531
local_in_edges_tensor generation:  0.049584150314331055
mini_batch_src_global generation:  0.05319619178771973
r_  generation:  0.5017011165618896
local_output_nid generation:  0.03641557693481445
local_in_edges_tensor generation:  0.036644697189331055
mini_batch_src_global generation:  0.05460214614868164
r_  generation:  0.5035402774810791
----------------------check_connections_block total spend ----------------------------- 5.906057596206665
generate_one_block  0.6156227588653564
generate_one_block  0.6228370666503906
generate_one_block  0.6238980293273926
generate_one_block  0.6280338764190674
generate_one_block  0.6069960594177246
generate_one_block  0.6229252815246582
generate_one_block  0.6575987339019775
generate_one_block  0.6340212821960449
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

connection checking time:  10.340993404388428
block generation total time  9.022781372070312
average batch blocks generation time:  1.127847671508789
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.09973430633544922  GigaBytes
Max Memory Allocated: 0.09973430633544922  GigaBytes

torch.Size([162364, 128])
torch.Size([146227, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9608154296875 GB
    Memory Allocated: 0.5739316940307617  GigaBytes
Max Memory Allocated: 0.6044001579284668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2322998046875 GB
    Memory Allocated: 0.10227298736572266  GigaBytes
Max Memory Allocated: 0.6437211036682129  GigaBytes

torch.Size([161972, 128])
torch.Size([145323, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2322998046875 GB
    Memory Allocated: 0.5692768096923828  GigaBytes
Max Memory Allocated: 0.6437211036682129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2322998046875 GB
    Memory Allocated: 0.10274934768676758  GigaBytes
Max Memory Allocated: 0.6437211036682129  GigaBytes

torch.Size([162310, 128])
torch.Size([146125, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5763406753540039  GigaBytes
Max Memory Allocated: 0.6437211036682129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.10241127014160156  GigaBytes
Max Memory Allocated: 0.6456832885742188  GigaBytes

torch.Size([162142, 128])
torch.Size([146118, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.5765795707702637  GigaBytes
Max Memory Allocated: 0.6456832885742188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.10259246826171875  GigaBytes
Max Memory Allocated: 0.6469898223876953  GigaBytes

torch.Size([162116, 128])
torch.Size([145668, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.5745763778686523  GigaBytes
Max Memory Allocated: 0.6469898223876953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.10277271270751953  GigaBytes
Max Memory Allocated: 0.6469898223876953  GigaBytes

torch.Size([162139, 128])
torch.Size([146037, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.5755791664123535  GigaBytes
Max Memory Allocated: 0.6469898223876953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.10227108001708984  GigaBytes
Max Memory Allocated: 0.6469898223876953  GigaBytes

torch.Size([162317, 128])
torch.Size([146209, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.5752625465393066  GigaBytes
Max Memory Allocated: 0.6469898223876953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.10272359848022461  GigaBytes
Max Memory Allocated: 0.6469898223876953  GigaBytes

torch.Size([162304, 128])
torch.Size([146309, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.57635498046875  GigaBytes
Max Memory Allocated: 0.6469898223876953  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04815596342086792 |0.05455118417739868 |0.08780309557914734 |0.00010189414024353027 |0.008536994457244873 |0.003692150115966797 |
----------------------------------------------------------pseudo_mini_loss sum 5.602389335632324
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3055171
Number of first layer input nodes during this epoch:  1297664
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.13664913177490234  GigaBytes
Max Memory Allocated: 0.6469898223876953  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028435468673706055
random selection method range initialization spend 0.005518674850463867
time for parepare:  0.017282724380493164
local_output_nid generation:  0.004425048828125
local_in_edges_tensor generation:  0.009663820266723633
mini_batch_src_global generation:  0.003776073455810547
r_  generation:  0.04087686538696289
local_output_nid generation:  0.005875587463378906
local_in_edges_tensor generation:  0.0032286643981933594
mini_batch_src_global generation:  0.00477910041809082
r_  generation:  0.04340839385986328
local_output_nid generation:  0.006016731262207031
local_in_edges_tensor generation:  0.003374814987182617
mini_batch_src_global generation:  0.003309965133666992
r_  generation:  0.04305005073547363
local_output_nid generation:  0.006045341491699219
local_in_edges_tensor generation:  0.003268003463745117
mini_batch_src_global generation:  0.0034246444702148438
r_  generation:  0.04604220390319824
local_output_nid generation:  0.0061304569244384766
local_in_edges_tensor generation:  0.0033740997314453125
mini_batch_src_global generation:  0.0037238597869873047
r_  generation:  0.04582691192626953
local_output_nid generation:  0.00601959228515625
local_in_edges_tensor generation:  0.003205537796020508
mini_batch_src_global generation:  0.0038068294525146484
r_  generation:  0.04652714729309082
local_output_nid generation:  0.0060040950775146484
local_in_edges_tensor generation:  0.0032732486724853516
mini_batch_src_global generation:  0.0040318965911865234
r_  generation:  0.04778099060058594
local_output_nid generation:  0.006087541580200195
local_in_edges_tensor generation:  0.003301858901977539
mini_batch_src_global generation:  0.004002571105957031
r_  generation:  0.0474390983581543
----------------------check_connections_block total spend ----------------------------- 0.5741047859191895
generate_one_block  0.06043672561645508
generate_one_block  0.061858177185058594
generate_one_block  0.06028580665588379
generate_one_block  0.0633549690246582
generate_one_block  0.06185173988342285
generate_one_block  0.06125950813293457
generate_one_block  0.06688499450683594
generate_one_block  0.06292319297790527
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.039797306060791016
gen group dst list time:  0.016142845153808594
time for parepare:  0.019132375717163086
local_output_nid generation:  0.014250993728637695
local_in_edges_tensor generation:  0.04033184051513672
mini_batch_src_global generation:  0.038709402084350586
r_  generation:  0.35845017433166504
local_output_nid generation:  0.02071547508239746
local_in_edges_tensor generation:  0.03365302085876465
mini_batch_src_global generation:  0.05633115768432617
r_  generation:  0.37157559394836426
local_output_nid generation:  0.01959991455078125
local_in_edges_tensor generation:  0.027926921844482422
mini_batch_src_global generation:  0.04398226737976074
r_  generation:  0.37352728843688965
local_output_nid generation:  0.021660566329956055
local_in_edges_tensor generation:  0.024247169494628906
mini_batch_src_global generation:  0.045413970947265625
r_  generation:  0.3808326721191406
local_output_nid generation:  0.01947498321533203
local_in_edges_tensor generation:  0.024074554443359375
mini_batch_src_global generation:  0.04780840873718262
r_  generation:  0.3809688091278076
local_output_nid generation:  0.019594907760620117
local_in_edges_tensor generation:  0.020102262496948242
mini_batch_src_global generation:  0.04656791687011719
r_  generation:  0.37775182723999023
local_output_nid generation:  0.019822359085083008
local_in_edges_tensor generation:  0.02631235122680664
mini_batch_src_global generation:  0.04664969444274902
r_  generation:  0.3862636089324951
local_output_nid generation:  0.01979851722717285
local_in_edges_tensor generation:  0.031172752380371094
mini_batch_src_global generation:  0.04786276817321777
r_  generation:  0.3876688480377197
----------------------check_connections_block total spend ----------------------------- 4.433954238891602
generate_one_block  0.514472246170044
generate_one_block  0.5041084289550781
generate_one_block  0.5411834716796875
generate_one_block  0.5278041362762451
generate_one_block  0.4960606098175049
generate_one_block  0.48656749725341797
generate_one_block  0.4994833469390869
generate_one_block  0.5231342315673828
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.06976032257080078
gen group dst list time:  0.03798198699951172
time for parepare:  0.019264698028564453
local_output_nid generation:  0.028604745864868164
local_in_edges_tensor generation:  0.05825686454772949
mini_batch_src_global generation:  0.04548835754394531
r_  generation:  0.48125147819519043
local_output_nid generation:  0.03575563430786133
local_in_edges_tensor generation:  0.0531771183013916
mini_batch_src_global generation:  0.06731557846069336
r_  generation:  0.4902815818786621
local_output_nid generation:  0.03585553169250488
local_in_edges_tensor generation:  0.049138545989990234
mini_batch_src_global generation:  0.0545957088470459
r_  generation:  0.49679040908813477
local_output_nid generation:  0.03676748275756836
local_in_edges_tensor generation:  0.05342912673950195
mini_batch_src_global generation:  0.058277130126953125
r_  generation:  0.5110459327697754
local_output_nid generation:  0.03891491889953613
local_in_edges_tensor generation:  0.04703164100646973
mini_batch_src_global generation:  0.05685877799987793
r_  generation:  0.49491286277770996
local_output_nid generation:  0.0366969108581543
local_in_edges_tensor generation:  0.03977155685424805
mini_batch_src_global generation:  0.05385398864746094
r_  generation:  0.5031609535217285
local_output_nid generation:  0.0369565486907959
local_in_edges_tensor generation:  0.0401155948638916
mini_batch_src_global generation:  0.054312705993652344
r_  generation:  0.5049409866333008
local_output_nid generation:  0.03643631935119629
local_in_edges_tensor generation:  0.03676486015319824
mini_batch_src_global generation:  0.055227041244506836
r_  generation:  0.5129108428955078
----------------------check_connections_block total spend ----------------------------- 6.027815580368042
generate_one_block  0.6433289051055908
generate_one_block  0.6368649005889893
generate_one_block  0.6402614116668701
generate_one_block  0.6179928779602051
generate_one_block  0.6346883773803711
generate_one_block  0.6301460266113281
generate_one_block  0.6338775157928467
generate_one_block  0.6116766929626465
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.13664913177490234  GigaBytes
Max Memory Allocated: 0.6469898223876953  GigaBytes

connection checking time:  10.461769819259644
block generation total time  9.141650676727295
average batch blocks generation time:  1.1427063345909119
block dataloader generation time/epoch 21.761757850646973
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.10312080383300781  GigaBytes
Max Memory Allocated: 0.6469898223876953  GigaBytes

torch.Size([162239, 128])
torch.Size([145863, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.5751709938049316  GigaBytes
Max Memory Allocated: 0.6469898223876953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.10316324234008789  GigaBytes
Max Memory Allocated: 0.6469898223876953  GigaBytes

torch.Size([162004, 128])
torch.Size([145921, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.5755491256713867  GigaBytes
Max Memory Allocated: 0.6469898223876953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.10300254821777344  GigaBytes
Max Memory Allocated: 0.6469898223876953  GigaBytes

torch.Size([162287, 128])
torch.Size([146109, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.5755996704101562  GigaBytes
Max Memory Allocated: 0.6469898223876953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.10330390930175781  GigaBytes
Max Memory Allocated: 0.6469898223876953  GigaBytes

torch.Size([162100, 128])
torch.Size([145626, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.57666015625  GigaBytes
Max Memory Allocated: 0.6469898223876953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.10278034210205078  GigaBytes
Max Memory Allocated: 0.6469898223876953  GigaBytes

torch.Size([162059, 128])
torch.Size([145526, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.575838565826416  GigaBytes
Max Memory Allocated: 0.6469898223876953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.10312271118164062  GigaBytes
Max Memory Allocated: 0.6469898223876953  GigaBytes

torch.Size([162300, 128])
torch.Size([145984, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.5749082565307617  GigaBytes
Max Memory Allocated: 0.6469898223876953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.1033029556274414  GigaBytes
Max Memory Allocated: 0.6469898223876953  GigaBytes

torch.Size([162119, 128])
torch.Size([146119, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.5761690139770508  GigaBytes
Max Memory Allocated: 0.6469898223876953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.10294771194458008  GigaBytes
Max Memory Allocated: 0.6469898223876953  GigaBytes

torch.Size([162221, 128])
torch.Size([145914, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.5757322311401367  GigaBytes
Max Memory Allocated: 0.6469898223876953  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0492856502532959 |0.018185168504714966 |0.0036129653453826904 |0.0001010894775390625 |0.0037272870540618896 |0.0014100074768066406 |
----------------------------------------------------------pseudo_mini_loss sum 3.5752432346343994
Total (block generation + training)time/epoch 22.39846920967102
Training time/epoch 0.6364719867706299
Training time without block to device /epoch 0.49099063873291016
Training time without total dataloading part /epoch 0.06094074249267578
load block tensor time/epoch 0.3942852020263672
block to device time/epoch 0.14548134803771973
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3053352
Number of first layer input nodes during this epoch:  1297329
