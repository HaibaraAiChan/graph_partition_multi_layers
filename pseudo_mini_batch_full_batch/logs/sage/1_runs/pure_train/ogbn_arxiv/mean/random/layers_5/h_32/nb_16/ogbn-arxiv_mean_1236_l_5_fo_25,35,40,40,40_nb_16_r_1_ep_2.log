Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648490849.5541637
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 7.2479248046875e-05  GigaBytes
Max Memory Allocated: 7.2479248046875e-05  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.02483820915222168
random selection method range initialization spend 0.00603032112121582
time for parepare:  0.018342971801757812
local_output_nid generation:  0.0021462440490722656
local_in_edges_tensor generation:  0.004644155502319336
mini_batch_src_global generation:  0.0018150806427001953
r_  generation:  0.018048763275146484
local_output_nid generation:  0.0025336742401123047
local_in_edges_tensor generation:  0.0016541481018066406
mini_batch_src_global generation:  0.002119779586791992
r_  generation:  0.017694950103759766
local_output_nid generation:  0.0027625560760498047
local_in_edges_tensor generation:  0.0015635490417480469
mini_batch_src_global generation:  0.0014090538024902344
r_  generation:  0.018051624298095703
local_output_nid generation:  0.002874135971069336
local_in_edges_tensor generation:  0.0015752315521240234
mini_batch_src_global generation:  0.001341104507446289
r_  generation:  0.01765727996826172
local_output_nid generation:  0.0028145313262939453
local_in_edges_tensor generation:  0.0015072822570800781
mini_batch_src_global generation:  0.0013659000396728516
r_  generation:  0.017910003662109375
local_output_nid generation:  0.002779722213745117
local_in_edges_tensor generation:  0.0014693737030029297
mini_batch_src_global generation:  0.0014235973358154297
r_  generation:  0.018429279327392578
local_output_nid generation:  0.0028548240661621094
local_in_edges_tensor generation:  0.0014882087707519531
mini_batch_src_global generation:  0.0014238357543945312
r_  generation:  0.01808929443359375
local_output_nid generation:  0.0029065608978271484
local_in_edges_tensor generation:  0.0014612674713134766
mini_batch_src_global generation:  0.001470327377319336
r_  generation:  0.018664121627807617
local_output_nid generation:  0.002868175506591797
local_in_edges_tensor generation:  0.0014846324920654297
mini_batch_src_global generation:  0.0014188289642333984
r_  generation:  0.018080949783325195
local_output_nid generation:  0.0028374195098876953
local_in_edges_tensor generation:  0.0014882087707519531
mini_batch_src_global generation:  0.0014774799346923828
r_  generation:  0.018327951431274414
local_output_nid generation:  0.0028362274169921875
local_in_edges_tensor generation:  0.0014815330505371094
mini_batch_src_global generation:  0.00145721435546875
r_  generation:  0.018648862838745117
local_output_nid generation:  0.0028884410858154297
local_in_edges_tensor generation:  0.001522064208984375
mini_batch_src_global generation:  0.013791799545288086
r_  generation:  0.01870417594909668
local_output_nid generation:  0.00286865234375
local_in_edges_tensor generation:  0.0014805793762207031
mini_batch_src_global generation:  0.0015518665313720703
r_  generation:  0.019057273864746094
local_output_nid generation:  0.002801179885864258
local_in_edges_tensor generation:  0.0014734268188476562
mini_batch_src_global generation:  0.0015263557434082031
r_  generation:  0.019402027130126953
local_output_nid generation:  0.002858400344848633
local_in_edges_tensor generation:  0.0014965534210205078
mini_batch_src_global generation:  0.0015227794647216797
r_  generation:  0.018526792526245117
local_output_nid generation:  0.0029497146606445312
local_in_edges_tensor generation:  0.0015358924865722656
mini_batch_src_global generation:  0.0015447139739990234
r_  generation:  0.019043445587158203
----------------------check_connections_block total spend ----------------------------- 0.49858880043029785
generate_one_block  0.02732372283935547
generate_one_block  0.028526782989501953
generate_one_block  0.028665781021118164
generate_one_block  0.030363798141479492
generate_one_block  0.028807640075683594
generate_one_block  0.02802896499633789
generate_one_block  0.027754545211791992
generate_one_block  0.028067588806152344
generate_one_block  0.027405738830566406
generate_one_block  0.02765941619873047
generate_one_block  0.027807235717773438
generate_one_block  0.028398513793945312
generate_one_block  0.028254032135009766
generate_one_block  0.028889179229736328
generate_one_block  0.02747344970703125
generate_one_block  0.028043746948242188
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.03950786590576172
gen group dst list time:  0.018898963928222656
time for parepare:  0.018697261810302734
local_output_nid generation:  0.00806427001953125
local_in_edges_tensor generation:  0.017487049102783203
mini_batch_src_global generation:  0.019735336303710938
r_  generation:  0.20126104354858398
local_output_nid generation:  0.011803627014160156
local_in_edges_tensor generation:  0.01966118812561035
mini_batch_src_global generation:  0.025078773498535156
r_  generation:  0.20315051078796387
local_output_nid generation:  0.011833429336547852
local_in_edges_tensor generation:  0.017832517623901367
mini_batch_src_global generation:  0.02755284309387207
r_  generation:  0.21326518058776855
local_output_nid generation:  0.011594057083129883
local_in_edges_tensor generation:  0.012405633926391602
mini_batch_src_global generation:  0.02717113494873047
r_  generation:  0.20784687995910645
local_output_nid generation:  0.011740446090698242
local_in_edges_tensor generation:  0.014209985733032227
mini_batch_src_global generation:  0.03575921058654785
r_  generation:  0.2147355079650879
local_output_nid generation:  0.011568069458007812
local_in_edges_tensor generation:  0.016000032424926758
mini_batch_src_global generation:  0.028160572052001953
r_  generation:  0.2112877368927002
local_output_nid generation:  0.011425018310546875
local_in_edges_tensor generation:  0.012192726135253906
mini_batch_src_global generation:  0.03615260124206543
r_  generation:  0.21004295349121094
local_output_nid generation:  0.011549234390258789
local_in_edges_tensor generation:  0.013886451721191406
mini_batch_src_global generation:  0.03197431564331055
r_  generation:  0.21363568305969238
local_output_nid generation:  0.01153111457824707
local_in_edges_tensor generation:  0.014175653457641602
mini_batch_src_global generation:  0.02987527847290039
r_  generation:  0.2136833667755127
local_output_nid generation:  0.011701583862304688
local_in_edges_tensor generation:  0.01401209831237793
mini_batch_src_global generation:  0.031098127365112305
r_  generation:  0.21419692039489746
local_output_nid generation:  0.011731863021850586
local_in_edges_tensor generation:  0.01388859748840332
mini_batch_src_global generation:  0.0292508602142334
r_  generation:  0.21491694450378418
local_output_nid generation:  0.011708736419677734
local_in_edges_tensor generation:  0.017754077911376953
mini_batch_src_global generation:  0.030888795852661133
r_  generation:  0.21778464317321777
local_output_nid generation:  0.012689590454101562
local_in_edges_tensor generation:  0.016499996185302734
mini_batch_src_global generation:  0.05241823196411133
r_  generation:  0.23532700538635254
local_output_nid generation:  0.014280319213867188
local_in_edges_tensor generation:  0.02828812599182129
mini_batch_src_global generation:  0.029251575469970703
r_  generation:  0.21914052963256836
local_output_nid generation:  0.012129545211791992
local_in_edges_tensor generation:  0.015097379684448242
mini_batch_src_global generation:  0.026601076126098633
r_  generation:  0.2163221836090088
local_output_nid generation:  0.012352943420410156
local_in_edges_tensor generation:  0.013979673385620117
mini_batch_src_global generation:  0.027080535888671875
r_  generation:  0.2181074619293213
----------------------check_connections_block total spend ----------------------------- 5.1469151973724365
generate_one_block  0.28289294242858887
generate_one_block  0.29103994369506836
generate_one_block  0.28850507736206055
generate_one_block  0.2735166549682617
generate_one_block  0.3085505962371826
generate_one_block  0.2783656120300293
generate_one_block  0.27736902236938477
generate_one_block  0.27764463424682617
generate_one_block  0.2777578830718994
generate_one_block  0.27946972846984863
generate_one_block  0.28450798988342285
generate_one_block  0.28601527214050293
generate_one_block  0.28502988815307617
generate_one_block  0.28740692138671875
generate_one_block  0.28841185569763184
generate_one_block  0.28040504455566406
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.061398983001708984
gen group dst list time:  0.06225728988647461
time for parepare:  0.0191037654876709
local_output_nid generation:  0.025150537490844727
local_in_edges_tensor generation:  0.0580592155456543
mini_batch_src_global generation:  0.047628164291381836
r_  generation:  0.49094223976135254
local_output_nid generation:  0.03186798095703125
local_in_edges_tensor generation:  0.05100727081298828
mini_batch_src_global generation:  0.08417344093322754
r_  generation:  0.49445223808288574
local_output_nid generation:  0.03532767295837402
local_in_edges_tensor generation:  0.05019545555114746
mini_batch_src_global generation:  0.06835222244262695
r_  generation:  0.4975309371948242
local_output_nid generation:  0.03168606758117676
local_in_edges_tensor generation:  0.03683829307556152
mini_batch_src_global generation:  0.05936002731323242
r_  generation:  0.49901509284973145
local_output_nid generation:  0.03171086311340332
local_in_edges_tensor generation:  0.03343486785888672
mini_batch_src_global generation:  0.059052228927612305
r_  generation:  0.5015780925750732
local_output_nid generation:  0.03182411193847656
local_in_edges_tensor generation:  0.038367271423339844
mini_batch_src_global generation:  0.05968332290649414
r_  generation:  0.5006277561187744
local_output_nid generation:  0.0317530632019043
local_in_edges_tensor generation:  0.04185748100280762
mini_batch_src_global generation:  0.05888986587524414
r_  generation:  0.501079797744751
local_output_nid generation:  0.03169751167297363
local_in_edges_tensor generation:  0.04173421859741211
mini_batch_src_global generation:  0.05965876579284668
r_  generation:  0.49843311309814453
local_output_nid generation:  0.03191876411437988
local_in_edges_tensor generation:  0.036444664001464844
mini_batch_src_global generation:  0.06759357452392578
r_  generation:  0.5064702033996582
local_output_nid generation:  0.03177285194396973
local_in_edges_tensor generation:  0.046961307525634766
mini_batch_src_global generation:  0.0596005916595459
r_  generation:  0.49706363677978516
local_output_nid generation:  0.032155513763427734
local_in_edges_tensor generation:  0.046495676040649414
mini_batch_src_global generation:  0.05909299850463867
r_  generation:  0.5057952404022217
local_output_nid generation:  0.03214836120605469
local_in_edges_tensor generation:  0.040834903717041016
mini_batch_src_global generation:  0.06243777275085449
r_  generation:  0.4974935054779053
local_output_nid generation:  0.03215837478637695
local_in_edges_tensor generation:  0.03197503089904785
mini_batch_src_global generation:  0.05825018882751465
r_  generation:  0.510359525680542
local_output_nid generation:  0.03236699104309082
local_in_edges_tensor generation:  0.033953189849853516
mini_batch_src_global generation:  0.0636143684387207
r_  generation:  0.5021095275878906
local_output_nid generation:  0.03208446502685547
local_in_edges_tensor generation:  0.03290820121765137
mini_batch_src_global generation:  0.058559417724609375
r_  generation:  0.5070199966430664
local_output_nid generation:  0.03205084800720215
local_in_edges_tensor generation:  0.03774118423461914
mini_batch_src_global generation:  0.0599825382232666
r_  generation:  0.5038852691650391
----------------------check_connections_block total spend ----------------------------- 11.907296895980835
generate_one_block  0.6661207675933838
generate_one_block  0.6587886810302734
generate_one_block  0.6610770225524902
generate_one_block  0.6472115516662598
generate_one_block  0.6485702991485596
generate_one_block  0.6320853233337402
generate_one_block  0.7019739151000977
generate_one_block  0.659761905670166
generate_one_block  0.6316912174224854
generate_one_block  0.6356158256530762
generate_one_block  0.6582651138305664
generate_one_block  0.654987096786499
generate_one_block  0.6426448822021484
generate_one_block  0.6541216373443604
generate_one_block  0.6906371116638184
generate_one_block  0.6707744598388672
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.048598527908325195
gen group dst list time:  0.09505558013916016
time for parepare:  0.01907205581665039
local_output_nid generation:  0.034616947174072266
local_in_edges_tensor generation:  0.05938887596130371
mini_batch_src_global generation:  0.049191951751708984
r_  generation:  0.5307872295379639
local_output_nid generation:  0.041466474533081055
local_in_edges_tensor generation:  0.059177398681640625
mini_batch_src_global generation:  0.0612795352935791
r_  generation:  0.5350799560546875
local_output_nid generation:  0.03905224800109863
local_in_edges_tensor generation:  0.0730435848236084
mini_batch_src_global generation:  0.06662917137145996
r_  generation:  0.5494558811187744
local_output_nid generation:  0.04231548309326172
local_in_edges_tensor generation:  0.05282950401306152
mini_batch_src_global generation:  0.0570979118347168
r_  generation:  0.5448424816131592
local_output_nid generation:  0.04374980926513672
local_in_edges_tensor generation:  0.044068098068237305
mini_batch_src_global generation:  0.0577237606048584
r_  generation:  0.546018123626709
local_output_nid generation:  0.0418093204498291
local_in_edges_tensor generation:  0.03933215141296387
mini_batch_src_global generation:  0.057509422302246094
r_  generation:  0.5521378517150879
local_output_nid generation:  0.04179215431213379
local_in_edges_tensor generation:  0.04925394058227539
mini_batch_src_global generation:  0.05905961990356445
r_  generation:  0.5460019111633301
local_output_nid generation:  0.0421445369720459
local_in_edges_tensor generation:  0.05479931831359863
mini_batch_src_global generation:  0.06517314910888672
r_  generation:  0.5704517364501953
local_output_nid generation:  0.04105567932128906
local_in_edges_tensor generation:  0.05080461502075195
mini_batch_src_global generation:  0.0655052661895752
r_  generation:  0.556957483291626
local_output_nid generation:  0.0391695499420166
local_in_edges_tensor generation:  0.04061555862426758
mini_batch_src_global generation:  0.06343340873718262
r_  generation:  0.5609710216522217
local_output_nid generation:  0.039014577865600586
local_in_edges_tensor generation:  0.0446019172668457
mini_batch_src_global generation:  0.05935049057006836
r_  generation:  0.5577824115753174
local_output_nid generation:  0.03894686698913574
local_in_edges_tensor generation:  0.0454256534576416
mini_batch_src_global generation:  0.059198617935180664
r_  generation:  0.551215410232544
local_output_nid generation:  0.03903937339782715
local_in_edges_tensor generation:  0.03506207466125488
mini_batch_src_global generation:  0.06009531021118164
r_  generation:  0.5530288219451904
local_output_nid generation:  0.03924226760864258
local_in_edges_tensor generation:  0.03484082221984863
mini_batch_src_global generation:  0.06328272819519043
r_  generation:  0.5525343418121338
local_output_nid generation:  0.03986549377441406
local_in_edges_tensor generation:  0.038498878479003906
mini_batch_src_global generation:  0.06069183349609375
r_  generation:  0.5536847114562988
local_output_nid generation:  0.03897595405578613
local_in_edges_tensor generation:  0.03498506546020508
mini_batch_src_global generation:  0.06413865089416504
r_  generation:  0.550839900970459
----------------------check_connections_block total spend ----------------------------- 13.27197527885437
generate_one_block  0.6808316707611084
generate_one_block  0.6779320240020752
generate_one_block  0.7807514667510986
generate_one_block  0.685626745223999
generate_one_block  0.6728718280792236
generate_one_block  0.6759293079376221
generate_one_block  0.6774632930755615
generate_one_block  0.6904711723327637
generate_one_block  0.6868984699249268
generate_one_block  0.6800117492675781
generate_one_block  0.696096658706665
generate_one_block  0.6877396106719971
generate_one_block  0.6646716594696045
generate_one_block  0.6927616596221924
generate_one_block  0.6765327453613281
generate_one_block  0.6929011344909668
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04640078544616699
gen group dst list time:  0.09874439239501953
time for parepare:  0.020561933517456055
local_output_nid generation:  0.03601956367492676
local_in_edges_tensor generation:  0.05947518348693848
mini_batch_src_global generation:  0.04503059387207031
r_  generation:  0.49418091773986816
local_output_nid generation:  0.0419461727142334
local_in_edges_tensor generation:  0.0359494686126709
mini_batch_src_global generation:  0.056749582290649414
r_  generation:  0.5118203163146973
local_output_nid generation:  0.04026913642883301
local_in_edges_tensor generation:  0.03682136535644531
mini_batch_src_global generation:  0.05732893943786621
r_  generation:  0.5007100105285645
local_output_nid generation:  0.04015469551086426
local_in_edges_tensor generation:  0.03653597831726074
mini_batch_src_global generation:  0.056090354919433594
r_  generation:  0.5070388317108154
local_output_nid generation:  0.03983664512634277
local_in_edges_tensor generation:  0.03678727149963379
mini_batch_src_global generation:  0.056229352951049805
r_  generation:  0.5043551921844482
local_output_nid generation:  0.03990888595581055
local_in_edges_tensor generation:  0.03874516487121582
mini_batch_src_global generation:  0.056372880935668945
r_  generation:  0.5099940299987793
local_output_nid generation:  0.040245771408081055
local_in_edges_tensor generation:  0.041887760162353516
mini_batch_src_global generation:  0.055905818939208984
r_  generation:  0.5058698654174805
local_output_nid generation:  0.04020214080810547
local_in_edges_tensor generation:  0.03676152229309082
mini_batch_src_global generation:  0.056473493576049805
r_  generation:  0.5082316398620605
local_output_nid generation:  0.04052376747131348
local_in_edges_tensor generation:  0.03858613967895508
mini_batch_src_global generation:  0.05621337890625
r_  generation:  0.5135288238525391
local_output_nid generation:  0.04029583930969238
local_in_edges_tensor generation:  0.04043078422546387
mini_batch_src_global generation:  0.05638694763183594
r_  generation:  0.5094761848449707
local_output_nid generation:  0.04025602340698242
local_in_edges_tensor generation:  0.04115152359008789
mini_batch_src_global generation:  0.058524131774902344
r_  generation:  0.5227925777435303
local_output_nid generation:  0.040407657623291016
local_in_edges_tensor generation:  0.04835009574890137
mini_batch_src_global generation:  0.05693793296813965
r_  generation:  0.511878490447998
local_output_nid generation:  0.0401606559753418
local_in_edges_tensor generation:  0.04094862937927246
mini_batch_src_global generation:  0.05571627616882324
r_  generation:  0.5135853290557861
local_output_nid generation:  0.04041123390197754
local_in_edges_tensor generation:  0.04546928405761719
mini_batch_src_global generation:  0.056268930435180664
r_  generation:  0.5159876346588135
local_output_nid generation:  0.040213584899902344
local_in_edges_tensor generation:  0.040895938873291016
mini_batch_src_global generation:  0.05642056465148926
r_  generation:  0.5194220542907715
local_output_nid generation:  0.040363311767578125
local_in_edges_tensor generation:  0.04105257987976074
mini_batch_src_global generation:  0.05568981170654297
r_  generation:  0.5152361392974854
----------------------check_connections_block total spend ----------------------------- 12.315625429153442
generate_one_block  0.6618132591247559
generate_one_block  0.6424849033355713
generate_one_block  0.6499254703521729
generate_one_block  0.6381149291992188
generate_one_block  0.7108967304229736
generate_one_block  0.6302130222320557
generate_one_block  0.6413607597351074
generate_one_block  0.6311862468719482
generate_one_block  0.640782356262207
generate_one_block  0.6391096115112305
generate_one_block  0.6387951374053955
generate_one_block  0.6370813846588135
generate_one_block  0.6259937286376953
generate_one_block  0.6342108249664307
generate_one_block  0.6216959953308105
generate_one_block  0.6434836387634277
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 7.2479248046875e-05  GigaBytes
Max Memory Allocated: 7.2479248046875e-05  GigaBytes

connection checking time:  42.641812801361084
block generation total time  36.367855072021484
average batch blocks generation time:  2.2729909420013428
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2205810546875 GB
    Memory Allocated: 0.12176656723022461  GigaBytes
Max Memory Allocated: 0.12176656723022461  GigaBytes

torch.Size([166300, 128])
torch.Size([163922, 32])
torch.Size([155556, 32])
torch.Size([123697, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7108154296875 GB
    Memory Allocated: 0.40026426315307617  GigaBytes
Max Memory Allocated: 0.40240049362182617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12328052520751953  GigaBytes
Max Memory Allocated: 0.4135165214538574  GigaBytes

torch.Size([166255, 128])
torch.Size([163936, 32])
torch.Size([155824, 32])
torch.Size([124045, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.40134096145629883  GigaBytes
Max Memory Allocated: 0.4135165214538574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12331390380859375  GigaBytes
Max Memory Allocated: 0.4135165214538574  GigaBytes

torch.Size([166263, 128])
torch.Size([164047, 32])
torch.Size([156143, 32])
torch.Size([124363, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.4016752243041992  GigaBytes
Max Memory Allocated: 0.4135165214538574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12320852279663086  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

torch.Size([166346, 128])
torch.Size([164088, 32])
torch.Size([155877, 32])
torch.Size([123364, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.39999818801879883  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12331151962280273  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

torch.Size([166096, 128])
torch.Size([163694, 32])
torch.Size([155531, 32])
torch.Size([123761, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.3971104621887207  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12321758270263672  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

torch.Size([166267, 128])
torch.Size([163942, 32])
torch.Size([155681, 32])
torch.Size([123243, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.3999018669128418  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12315797805786133  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

torch.Size([166168, 128])
torch.Size([163732, 32])
torch.Size([155479, 32])
torch.Size([122848, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.3954620361328125  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12326574325561523  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

torch.Size([166218, 128])
torch.Size([163900, 32])
torch.Size([155815, 32])
torch.Size([123869, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.4009385108947754  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12321186065673828  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

torch.Size([166120, 128])
torch.Size([163764, 32])
torch.Size([155590, 32])
torch.Size([123336, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.3958406448364258  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12320899963378906  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

torch.Size([166202, 128])
torch.Size([163879, 32])
torch.Size([155828, 32])
torch.Size([123344, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.39986705780029297  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12326240539550781  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

torch.Size([166287, 128])
torch.Size([164100, 32])
torch.Size([156123, 32])
torch.Size([124200, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.40133047103881836  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12328910827636719  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

torch.Size([166253, 128])
torch.Size([163957, 32])
torch.Size([155841, 32])
torch.Size([124127, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.40129709243774414  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12328243255615234  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

torch.Size([166157, 128])
torch.Size([163760, 32])
torch.Size([155582, 32])
torch.Size([123703, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.39687442779541016  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12331819534301758  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

torch.Size([166198, 128])
torch.Size([163985, 32])
torch.Size([155941, 32])
torch.Size([124125, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.4015789031982422  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12322664260864258  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

torch.Size([166132, 128])
torch.Size([163745, 32])
torch.Size([155450, 32])
torch.Size([123526, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.3960866928100586  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.1233062744140625  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

torch.Size([166162, 128])
torch.Size([163895, 32])
torch.Size([155978, 32])
torch.Size([124466, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.40169715881347656  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05279439687728882 |0.05845664441585541 |0.049475401639938354 |0.00010246038436889648 |0.012648522853851318 |0.006161689758300781 |
----------------------------------------------------------pseudo_mini_loss sum 5.0345001220703125
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10415254
Number of first layer input nodes during this epoch:  2659424
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.21094846725463867  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.01806950569152832
random selection method range initialization spend 0.005191326141357422
time for parepare:  0.018628835678100586
local_output_nid generation:  0.002657175064086914
local_in_edges_tensor generation:  0.00561070442199707
mini_batch_src_global generation:  0.0016546249389648438
r_  generation:  0.01839160919189453
local_output_nid generation:  0.003304004669189453
local_in_edges_tensor generation:  0.0016205310821533203
mini_batch_src_global generation:  0.0018906593322753906
r_  generation:  0.018933534622192383
local_output_nid generation:  0.0032529830932617188
local_in_edges_tensor generation:  0.0015225410461425781
mini_batch_src_global generation:  0.001491546630859375
r_  generation:  0.01842522621154785
local_output_nid generation:  0.0032606124877929688
local_in_edges_tensor generation:  0.0014214515686035156
mini_batch_src_global generation:  0.0014634132385253906
r_  generation:  0.01900959014892578
local_output_nid generation:  0.003506183624267578
local_in_edges_tensor generation:  0.0014901161193847656
mini_batch_src_global generation:  0.001535177230834961
r_  generation:  0.01899099349975586
local_output_nid generation:  0.0033721923828125
local_in_edges_tensor generation:  0.0014760494232177734
mini_batch_src_global generation:  0.0015897750854492188
r_  generation:  0.01945805549621582
local_output_nid generation:  0.003426790237426758
local_in_edges_tensor generation:  0.001483917236328125
mini_batch_src_global generation:  0.0016505718231201172
r_  generation:  0.01976776123046875
local_output_nid generation:  0.0035114288330078125
local_in_edges_tensor generation:  0.0014891624450683594
mini_batch_src_global generation:  0.0016777515411376953
r_  generation:  0.019762754440307617
local_output_nid generation:  0.0034935474395751953
local_in_edges_tensor generation:  0.0015115737915039062
mini_batch_src_global generation:  0.001622915267944336
r_  generation:  0.019769668579101562
local_output_nid generation:  0.0034775733947753906
local_in_edges_tensor generation:  0.0014634132385253906
mini_batch_src_global generation:  0.0015788078308105469
r_  generation:  0.019467592239379883
local_output_nid generation:  0.0035469532012939453
local_in_edges_tensor generation:  0.0014679431915283203
mini_batch_src_global generation:  0.0015647411346435547
r_  generation:  0.01946282386779785
local_output_nid generation:  0.0035059452056884766
local_in_edges_tensor generation:  0.0014178752899169922
mini_batch_src_global generation:  0.001619100570678711
r_  generation:  0.019773006439208984
local_output_nid generation:  0.003556966781616211
local_in_edges_tensor generation:  0.0013971328735351562
mini_batch_src_global generation:  0.0015978813171386719
r_  generation:  0.01946282386779785
local_output_nid generation:  0.0035009384155273438
local_in_edges_tensor generation:  0.0013959407806396484
mini_batch_src_global generation:  0.0015609264373779297
r_  generation:  0.019439697265625
local_output_nid generation:  0.0035119056701660156
local_in_edges_tensor generation:  0.0014181137084960938
mini_batch_src_global generation:  0.0016176700592041016
r_  generation:  0.019742250442504883
local_output_nid generation:  0.0034952163696289062
local_in_edges_tensor generation:  0.0013897418975830078
mini_batch_src_global generation:  0.0016160011291503906
r_  generation:  0.01964879035949707
----------------------check_connections_block total spend ----------------------------- 0.5152828693389893
generate_one_block  0.027304649353027344
generate_one_block  0.028307199478149414
generate_one_block  0.027268409729003906
generate_one_block  0.027659893035888672
generate_one_block  0.02753424644470215
generate_one_block  0.030748844146728516
generate_one_block  0.028604507446289062
generate_one_block  0.028203487396240234
generate_one_block  0.028188228607177734
generate_one_block  0.027399301528930664
generate_one_block  0.0278775691986084
generate_one_block  0.028205156326293945
generate_one_block  0.027431249618530273
generate_one_block  0.027704477310180664
generate_one_block  0.028090953826904297
generate_one_block  0.028264522552490234
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.03615689277648926
gen group dst list time:  0.016242027282714844
time for parepare:  0.019402027130126953
local_output_nid generation:  0.011401176452636719
local_in_edges_tensor generation:  0.020427942276000977
mini_batch_src_global generation:  0.020732641220092773
r_  generation:  0.20580053329467773
local_output_nid generation:  0.012360572814941406
local_in_edges_tensor generation:  0.023044109344482422
mini_batch_src_global generation:  0.02471923828125
r_  generation:  0.21204757690429688
local_output_nid generation:  0.013564109802246094
local_in_edges_tensor generation:  0.02773427963256836
mini_batch_src_global generation:  0.03061842918395996
r_  generation:  0.22325873374938965
local_output_nid generation:  0.015837907791137695
local_in_edges_tensor generation:  0.017759084701538086
mini_batch_src_global generation:  0.025218725204467773
r_  generation:  0.21387410163879395
local_output_nid generation:  0.012918472290039062
local_in_edges_tensor generation:  0.016783952713012695
mini_batch_src_global generation:  0.026185274124145508
r_  generation:  0.21704769134521484
local_output_nid generation:  0.012553215026855469
local_in_edges_tensor generation:  0.01566028594970703
mini_batch_src_global generation:  0.026988983154296875
r_  generation:  0.22332215309143066
local_output_nid generation:  0.0131378173828125
local_in_edges_tensor generation:  0.015385866165161133
mini_batch_src_global generation:  0.027745962142944336
r_  generation:  0.22101974487304688
local_output_nid generation:  0.013376474380493164
local_in_edges_tensor generation:  0.017536401748657227
mini_batch_src_global generation:  0.027669191360473633
r_  generation:  0.2221364974975586
local_output_nid generation:  0.013320446014404297
local_in_edges_tensor generation:  0.024567365646362305
mini_batch_src_global generation:  0.028001070022583008
r_  generation:  0.2253437042236328
local_output_nid generation:  0.013079166412353516
local_in_edges_tensor generation:  0.013629913330078125
mini_batch_src_global generation:  0.027306079864501953
r_  generation:  0.21799325942993164
local_output_nid generation:  0.014925003051757812
local_in_edges_tensor generation:  0.015648365020751953
mini_batch_src_global generation:  0.027643203735351562
r_  generation:  0.22155523300170898
local_output_nid generation:  0.013386011123657227
local_in_edges_tensor generation:  0.021734952926635742
mini_batch_src_global generation:  0.028593778610229492
r_  generation:  0.23079729080200195
local_output_nid generation:  0.013327598571777344
local_in_edges_tensor generation:  0.013779878616333008
mini_batch_src_global generation:  0.03045344352722168
r_  generation:  0.22062230110168457
local_output_nid generation:  0.014313697814941406
local_in_edges_tensor generation:  0.016277790069580078
mini_batch_src_global generation:  0.027532339096069336
r_  generation:  0.21895670890808105
local_output_nid generation:  0.012853860855102539
local_in_edges_tensor generation:  0.014384746551513672
mini_batch_src_global generation:  0.0282132625579834
r_  generation:  0.22054362297058105
local_output_nid generation:  0.012487411499023438
local_in_edges_tensor generation:  0.012420892715454102
mini_batch_src_global generation:  0.02785468101501465
r_  generation:  0.22299957275390625
----------------------check_connections_block total spend ----------------------------- 5.277901887893677
generate_one_block  0.28298139572143555
generate_one_block  0.27791810035705566
generate_one_block  0.27634358406066895
generate_one_block  0.2821033000946045
generate_one_block  0.2779724597930908
generate_one_block  0.2884237766265869
generate_one_block  0.3156747817993164
generate_one_block  0.2903318405151367
generate_one_block  0.28185248374938965
generate_one_block  0.2786087989807129
generate_one_block  0.29277920722961426
generate_one_block  0.291550874710083
generate_one_block  0.27823710441589355
generate_one_block  0.29139208793640137
generate_one_block  0.28745508193969727
generate_one_block  0.2747364044189453
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.06422138214111328
gen group dst list time:  0.06735038757324219
time for parepare:  0.01784515380859375
local_output_nid generation:  0.026546716690063477
local_in_edges_tensor generation:  0.056710243225097656
mini_batch_src_global generation:  0.04941678047180176
r_  generation:  0.48830509185791016
local_output_nid generation:  0.03175544738769531
local_in_edges_tensor generation:  0.05045485496520996
mini_batch_src_global generation:  0.06026172637939453
r_  generation:  0.501467227935791
local_output_nid generation:  0.031100034713745117
local_in_edges_tensor generation:  0.03717803955078125
mini_batch_src_global generation:  0.057572126388549805
r_  generation:  0.5017268657684326
local_output_nid generation:  0.031324148178100586
local_in_edges_tensor generation:  0.04171442985534668
mini_batch_src_global generation:  0.05919504165649414
r_  generation:  0.5025579929351807
local_output_nid generation:  0.031098127365112305
local_in_edges_tensor generation:  0.08572554588317871
mini_batch_src_global generation:  0.05832934379577637
r_  generation:  0.5045633316040039
local_output_nid generation:  0.03122401237487793
local_in_edges_tensor generation:  0.03216981887817383
mini_batch_src_global generation:  0.05956697463989258
r_  generation:  0.5106563568115234
local_output_nid generation:  0.03138399124145508
local_in_edges_tensor generation:  0.041956424713134766
mini_batch_src_global generation:  0.05868840217590332
r_  generation:  0.5079052448272705
local_output_nid generation:  0.03206825256347656
local_in_edges_tensor generation:  0.033577919006347656
mini_batch_src_global generation:  0.060411691665649414
r_  generation:  0.5157756805419922
local_output_nid generation:  0.03330802917480469
local_in_edges_tensor generation:  0.03714323043823242
mini_batch_src_global generation:  0.05942559242248535
r_  generation:  0.5132696628570557
local_output_nid generation:  0.03156018257141113
local_in_edges_tensor generation:  0.04265117645263672
mini_batch_src_global generation:  0.05983901023864746
r_  generation:  0.5081746578216553
local_output_nid generation:  0.03190279006958008
local_in_edges_tensor generation:  0.03753352165222168
mini_batch_src_global generation:  0.06141042709350586
r_  generation:  0.5240278244018555
local_output_nid generation:  0.03210139274597168
local_in_edges_tensor generation:  0.04729962348937988
mini_batch_src_global generation:  0.07191205024719238
r_  generation:  0.5065219402313232
local_output_nid generation:  0.034264564514160156
local_in_edges_tensor generation:  0.04085087776184082
mini_batch_src_global generation:  0.059192657470703125
r_  generation:  0.5098311901092529
local_output_nid generation:  0.03317141532897949
local_in_edges_tensor generation:  0.04344677925109863
mini_batch_src_global generation:  0.06012892723083496
r_  generation:  0.5048937797546387
local_output_nid generation:  0.032906532287597656
local_in_edges_tensor generation:  0.03293466567993164
mini_batch_src_global generation:  0.058416128158569336
r_  generation:  0.50832200050354
local_output_nid generation:  0.0329592227935791
local_in_edges_tensor generation:  0.03715944290161133
mini_batch_src_global generation:  0.059615373611450195
r_  generation:  0.49986720085144043
----------------------check_connections_block total spend ----------------------------- 12.0010507106781
generate_one_block  0.6453237533569336
generate_one_block  0.6739449501037598
generate_one_block  0.6450560092926025
generate_one_block  0.6530649662017822
generate_one_block  0.6535837650299072
generate_one_block  0.6502366065979004
generate_one_block  0.6585209369659424
generate_one_block  0.6617212295532227
generate_one_block  0.6856958866119385
generate_one_block  0.6400337219238281
generate_one_block  0.6472699642181396
generate_one_block  0.6536357402801514
generate_one_block  0.6400635242462158
generate_one_block  0.6619210243225098
generate_one_block  0.6447548866271973
generate_one_block  0.6388339996337891
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05265307426452637
gen group dst list time:  0.09717321395874023
time for parepare:  0.021193742752075195
local_output_nid generation:  0.03440690040588379
local_in_edges_tensor generation:  0.06460738182067871
mini_batch_src_global generation:  0.04951333999633789
r_  generation:  0.5272817611694336
local_output_nid generation:  0.04166412353515625
local_in_edges_tensor generation:  0.05806612968444824
mini_batch_src_global generation:  0.061341047286987305
r_  generation:  0.5321834087371826
local_output_nid generation:  0.04143548011779785
local_in_edges_tensor generation:  0.0451960563659668
mini_batch_src_global generation:  0.05860137939453125
r_  generation:  0.5384371280670166
local_output_nid generation:  0.04172253608703613
local_in_edges_tensor generation:  0.04241466522216797
mini_batch_src_global generation:  0.057015180587768555
r_  generation:  0.5426337718963623
local_output_nid generation:  0.04224443435668945
local_in_edges_tensor generation:  0.04838085174560547
mini_batch_src_global generation:  0.06985783576965332
r_  generation:  0.5449557304382324
local_output_nid generation:  0.039227962493896484
local_in_edges_tensor generation:  0.04578256607055664
mini_batch_src_global generation:  0.056795597076416016
r_  generation:  0.5492327213287354
local_output_nid generation:  0.04217791557312012
local_in_edges_tensor generation:  0.043176889419555664
mini_batch_src_global generation:  0.06464266777038574
r_  generation:  0.5484542846679688
local_output_nid generation:  0.03979039192199707
local_in_edges_tensor generation:  0.04295849800109863
mini_batch_src_global generation:  0.06243324279785156
r_  generation:  0.5508384704589844
local_output_nid generation:  0.04047703742980957
local_in_edges_tensor generation:  0.04841423034667969
mini_batch_src_global generation:  0.058303117752075195
r_  generation:  0.5556502342224121
local_output_nid generation:  0.040331125259399414
local_in_edges_tensor generation:  0.03902173042297363
mini_batch_src_global generation:  0.05936765670776367
r_  generation:  0.556751012802124
local_output_nid generation:  0.04017829895019531
local_in_edges_tensor generation:  0.039038658142089844
mini_batch_src_global generation:  0.05957317352294922
r_  generation:  0.5589885711669922
local_output_nid generation:  0.04048752784729004
local_in_edges_tensor generation:  0.05309104919433594
mini_batch_src_global generation:  0.05964374542236328
r_  generation:  0.5557706356048584
local_output_nid generation:  0.04254317283630371
local_in_edges_tensor generation:  0.038907766342163086
mini_batch_src_global generation:  0.05934429168701172
r_  generation:  0.5580041408538818
local_output_nid generation:  0.03994631767272949
local_in_edges_tensor generation:  0.04807329177856445
mini_batch_src_global generation:  0.059502601623535156
r_  generation:  0.5555894374847412
local_output_nid generation:  0.03994393348693848
local_in_edges_tensor generation:  0.03953099250793457
mini_batch_src_global generation:  0.06019473075866699
r_  generation:  0.5590360164642334
local_output_nid generation:  0.040143728256225586
local_in_edges_tensor generation:  0.03865170478820801
mini_batch_src_global generation:  0.06015419960021973
r_  generation:  0.560370922088623
----------------------check_connections_block total spend ----------------------------- 13.209929466247559
generate_one_block  0.6926944255828857
generate_one_block  0.6958057880401611
generate_one_block  0.6769990921020508
generate_one_block  0.6812939643859863
generate_one_block  0.6764392852783203
generate_one_block  0.6739721298217773
generate_one_block  0.7484073638916016
generate_one_block  0.6811685562133789
generate_one_block  0.689162015914917
generate_one_block  0.6699519157409668
generate_one_block  0.6924149990081787
generate_one_block  0.6809878349304199
generate_one_block  0.6754207611083984
generate_one_block  0.6854751110076904
generate_one_block  0.6718981266021729
generate_one_block  0.6821613311767578
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04409193992614746
gen group dst list time:  0.09903383255004883
time for parepare:  0.01956963539123535
local_output_nid generation:  0.037514448165893555
local_in_edges_tensor generation:  0.05555009841918945
mini_batch_src_global generation:  0.04430222511291504
r_  generation:  0.5108194351196289
local_output_nid generation:  0.04259443283081055
local_in_edges_tensor generation:  0.053508758544921875
mini_batch_src_global generation:  0.0573422908782959
r_  generation:  0.5082781314849854
local_output_nid generation:  0.04021263122558594
local_in_edges_tensor generation:  0.04404044151306152
mini_batch_src_global generation:  0.05673956871032715
r_  generation:  0.5176923274993896
local_output_nid generation:  0.04021716117858887
local_in_edges_tensor generation:  0.04147839546203613
mini_batch_src_global generation:  0.05677366256713867
r_  generation:  0.5120282173156738
local_output_nid generation:  0.04044485092163086
local_in_edges_tensor generation:  0.05126047134399414
mini_batch_src_global generation:  0.059567928314208984
r_  generation:  0.5143256187438965
local_output_nid generation:  0.04044389724731445
local_in_edges_tensor generation:  0.03820061683654785
mini_batch_src_global generation:  0.05653023719787598
r_  generation:  0.5252501964569092
local_output_nid generation:  0.04387784004211426
local_in_edges_tensor generation:  0.04140424728393555
mini_batch_src_global generation:  0.05901312828063965
r_  generation:  0.5157124996185303
local_output_nid generation:  0.04148435592651367
local_in_edges_tensor generation:  0.04646801948547363
mini_batch_src_global generation:  0.05600285530090332
r_  generation:  0.5131137371063232
local_output_nid generation:  0.041535139083862305
local_in_edges_tensor generation:  0.046285390853881836
mini_batch_src_global generation:  0.056578874588012695
r_  generation:  0.5194892883300781
local_output_nid generation:  0.04161858558654785
local_in_edges_tensor generation:  0.04110074043273926
mini_batch_src_global generation:  0.055876731872558594
r_  generation:  0.5194101333618164
local_output_nid generation:  0.041277170181274414
local_in_edges_tensor generation:  0.04659771919250488
mini_batch_src_global generation:  0.05595541000366211
r_  generation:  0.5290398597717285
local_output_nid generation:  0.04148983955383301
local_in_edges_tensor generation:  0.04286599159240723
mini_batch_src_global generation:  0.05663108825683594
r_  generation:  0.5269832611083984
local_output_nid generation:  0.04164767265319824
local_in_edges_tensor generation:  0.04146552085876465
mini_batch_src_global generation:  0.056296586990356445
r_  generation:  0.5255696773529053
local_output_nid generation:  0.04154062271118164
local_in_edges_tensor generation:  0.04169726371765137
mini_batch_src_global generation:  0.05709433555603027
r_  generation:  0.5311968326568604
local_output_nid generation:  0.04155397415161133
local_in_edges_tensor generation:  0.04544544219970703
mini_batch_src_global generation:  0.05655837059020996
r_  generation:  0.5255146026611328
local_output_nid generation:  0.0412297248840332
local_in_edges_tensor generation:  0.04162168502807617
mini_batch_src_global generation:  0.0567021369934082
r_  generation:  0.5287690162658691
----------------------check_connections_block total spend ----------------------------- 12.569327116012573
generate_one_block  0.6424846649169922
generate_one_block  0.6427531242370605
generate_one_block  0.6453418731689453
generate_one_block  0.6389999389648438
generate_one_block  0.6423110961914062
generate_one_block  0.6385843753814697
generate_one_block  0.6424283981323242
generate_one_block  0.6507608890533447
generate_one_block  0.651759147644043
generate_one_block  0.7170305252075195
generate_one_block  0.6431949138641357
generate_one_block  0.6461117267608643
generate_one_block  0.6428928375244141
generate_one_block  0.6433172225952148
generate_one_block  0.6360619068145752
generate_one_block  0.6447668075561523
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.21094846725463867  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

connection checking time:  43.05820918083191
block generation total time  36.36507439613342
average batch blocks generation time:  2.272817149758339
block dataloader generation time/epoch 82.44110465049744
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12338781356811523  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

torch.Size([166318, 128])
torch.Size([163973, 32])
torch.Size([155988, 32])
torch.Size([124158, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.40149784088134766  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12337875366210938  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

torch.Size([166361, 128])
torch.Size([164048, 32])
torch.Size([155845, 32])
torch.Size([123465, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.4001445770263672  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12332630157470703  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

torch.Size([166370, 128])
torch.Size([164030, 32])
torch.Size([155844, 32])
torch.Size([123510, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.400113582611084  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12335062026977539  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

torch.Size([166210, 128])
torch.Size([163819, 32])
torch.Size([155709, 32])
torch.Size([123808, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.40024662017822266  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12336540222167969  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

torch.Size([166377, 128])
torch.Size([164012, 32])
torch.Size([155880, 32])
torch.Size([123628, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.4003596305847168  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12339925765991211  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

torch.Size([166182, 128])
torch.Size([163837, 32])
torch.Size([155681, 32])
torch.Size([123718, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.4010457992553711  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12345457077026367  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

torch.Size([166161, 128])
torch.Size([163862, 32])
torch.Size([155705, 32])
torch.Size([123773, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.40137195587158203  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12349605560302734  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

torch.Size([166157, 128])
torch.Size([163719, 32])
torch.Size([155561, 32])
torch.Size([124254, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.3976860046386719  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12343788146972656  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

torch.Size([166303, 128])
torch.Size([163976, 32])
torch.Size([155876, 32])
torch.Size([124026, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.40143585205078125  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.1233525276184082  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

torch.Size([166267, 128])
torch.Size([163910, 32])
torch.Size([155694, 32])
torch.Size([123442, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.399965763092041  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.1233677864074707  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

torch.Size([166354, 128])
torch.Size([164085, 32])
torch.Size([156025, 32])
torch.Size([123791, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.4004049301147461  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12345504760742188  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

torch.Size([166270, 128])
torch.Size([163970, 32])
torch.Size([155870, 32])
torch.Size([123962, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.4014768600463867  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.1233673095703125  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

torch.Size([166295, 128])
torch.Size([163977, 32])
torch.Size([155883, 32])
torch.Size([123512, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.40022706985473633  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.1234431266784668  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

torch.Size([166336, 128])
torch.Size([164037, 32])
torch.Size([155981, 32])
torch.Size([124393, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.40151309967041016  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12343358993530273  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

torch.Size([166179, 128])
torch.Size([163815, 32])
torch.Size([155407, 32])
torch.Size([123641, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.3970775604248047  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12333393096923828  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

torch.Size([166220, 128])
torch.Size([163899, 32])
torch.Size([155594, 32])
torch.Size([123452, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.39635276794433594  GigaBytes
Max Memory Allocated: 0.41383934020996094  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05321680009365082 |0.03670103847980499 |0.005480870604515076 |8.977949619293213e-05 |0.009204640984535217 |0.0025131702423095703 |
----------------------------------------------------------pseudo_mini_loss sum 4.31555700302124
Total (block generation + training)time/epoch 84.17098093032837
Training time/epoch 1.729668140411377
Training time without block to device /epoch 1.142451524734497
Training time without total dataloading part /epoch 0.23891782760620117
load block tensor time/epoch 0.8514688014984131
block to device time/epoch 0.5872166156768799
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.9073486328125e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10417917
Number of first layer input nodes during this epoch:  2660360
