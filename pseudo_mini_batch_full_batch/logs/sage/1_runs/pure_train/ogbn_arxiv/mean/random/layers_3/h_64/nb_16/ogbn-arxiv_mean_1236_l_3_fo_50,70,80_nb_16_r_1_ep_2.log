Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648440957.101966
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028243541717529297
random selection method range initialization spend 0.006123542785644531
time for parepare:  0.018584012985229492
local_output_nid generation:  0.0021381378173828125
local_in_edges_tensor generation:  0.004889011383056641
mini_batch_src_global generation:  0.0019948482513427734
r_  generation:  0.020282268524169922
local_output_nid generation:  0.0026216506958007812
local_in_edges_tensor generation:  0.0017635822296142578
mini_batch_src_global generation:  0.0024290084838867188
r_  generation:  0.020341873168945312
local_output_nid generation:  0.002835512161254883
local_in_edges_tensor generation:  0.0016796588897705078
mini_batch_src_global generation:  0.0015549659729003906
r_  generation:  0.020358800888061523
local_output_nid generation:  0.0029425621032714844
local_in_edges_tensor generation:  0.0016787052154541016
mini_batch_src_global generation:  0.0016031265258789062
r_  generation:  0.020477771759033203
local_output_nid generation:  0.0029654502868652344
local_in_edges_tensor generation:  0.0016257762908935547
mini_batch_src_global generation:  0.0014905929565429688
r_  generation:  0.019970178604125977
local_output_nid generation:  0.002904653549194336
local_in_edges_tensor generation:  0.0015594959259033203
mini_batch_src_global generation:  0.001565694808959961
r_  generation:  0.02023625373840332
local_output_nid generation:  0.002881765365600586
local_in_edges_tensor generation:  0.001554727554321289
mini_batch_src_global generation:  0.0016100406646728516
r_  generation:  0.020529985427856445
local_output_nid generation:  0.0028984546661376953
local_in_edges_tensor generation:  0.001577615737915039
mini_batch_src_global generation:  0.0016748905181884766
r_  generation:  0.021340608596801758
local_output_nid generation:  0.0029573440551757812
local_in_edges_tensor generation:  0.0015735626220703125
mini_batch_src_global generation:  0.0017342567443847656
r_  generation:  0.02201080322265625
local_output_nid generation:  0.0029001235961914062
local_in_edges_tensor generation:  0.0015642642974853516
mini_batch_src_global generation:  0.0017077922821044922
r_  generation:  0.0215151309967041
local_output_nid generation:  0.0029206275939941406
local_in_edges_tensor generation:  0.0016291141510009766
mini_batch_src_global generation:  0.0017557144165039062
r_  generation:  0.022416114807128906
local_output_nid generation:  0.0029909610748291016
local_in_edges_tensor generation:  0.0015709400177001953
mini_batch_src_global generation:  0.0017719268798828125
r_  generation:  0.02161860466003418
local_output_nid generation:  0.0029151439666748047
local_in_edges_tensor generation:  0.0015680789947509766
mini_batch_src_global generation:  0.0017309188842773438
r_  generation:  0.021585941314697266
local_output_nid generation:  0.002912759780883789
local_in_edges_tensor generation:  0.0016434192657470703
mini_batch_src_global generation:  0.0016617774963378906
r_  generation:  0.021387100219726562
local_output_nid generation:  0.0029685497283935547
local_in_edges_tensor generation:  0.0015971660614013672
mini_batch_src_global generation:  0.0017216205596923828
r_  generation:  0.021385669708251953
local_output_nid generation:  0.002977132797241211
local_in_edges_tensor generation:  0.001634359359741211
mini_batch_src_global generation:  0.0017819404602050781
r_  generation:  0.02167654037475586
----------------------check_connections_block total spend ----------------------------- 0.5435943603515625
generate_one_block  0.03129768371582031
generate_one_block  0.031885623931884766
generate_one_block  0.0343475341796875
generate_one_block  0.03124403953552246
generate_one_block  0.030218124389648438
generate_one_block  0.030241966247558594
generate_one_block  0.030839204788208008
generate_one_block  0.031964778900146484
generate_one_block  0.03190016746520996
generate_one_block  0.030582427978515625
generate_one_block  0.03166675567626953
generate_one_block  0.030710220336914062
generate_one_block  0.03123331069946289
generate_one_block  0.030508756637573242
generate_one_block  0.030495643615722656
generate_one_block  0.031020641326904297
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04616856575012207
gen group dst list time:  0.020500659942626953
time for parepare:  0.019482851028442383
local_output_nid generation:  0.00933384895324707
local_in_edges_tensor generation:  0.022902250289916992
mini_batch_src_global generation:  0.027162790298461914
r_  generation:  0.25046849250793457
local_output_nid generation:  0.013390779495239258
local_in_edges_tensor generation:  0.02440953254699707
mini_batch_src_global generation:  0.03184843063354492
r_  generation:  0.2534608840942383
local_output_nid generation:  0.012974023818969727
local_in_edges_tensor generation:  0.019586801528930664
mini_batch_src_global generation:  0.030977249145507812
r_  generation:  0.26044702529907227
local_output_nid generation:  0.013006210327148438
local_in_edges_tensor generation:  0.019640684127807617
mini_batch_src_global generation:  0.032611846923828125
r_  generation:  0.27027177810668945
local_output_nid generation:  0.012828588485717773
local_in_edges_tensor generation:  0.017050743103027344
mini_batch_src_global generation:  0.032297372817993164
r_  generation:  0.25804877281188965
local_output_nid generation:  0.01276707649230957
local_in_edges_tensor generation:  0.01665782928466797
mini_batch_src_global generation:  0.03519153594970703
r_  generation:  0.26766347885131836
local_output_nid generation:  0.012861967086791992
local_in_edges_tensor generation:  0.01737213134765625
mini_batch_src_global generation:  0.03542828559875488
r_  generation:  0.2702641487121582
local_output_nid generation:  0.01310110092163086
local_in_edges_tensor generation:  0.020056962966918945
mini_batch_src_global generation:  0.03385162353515625
r_  generation:  0.2715926170349121
local_output_nid generation:  0.013230562210083008
local_in_edges_tensor generation:  0.019968748092651367
mini_batch_src_global generation:  0.03407621383666992
r_  generation:  0.27774763107299805
local_output_nid generation:  0.012958049774169922
local_in_edges_tensor generation:  0.01561594009399414
mini_batch_src_global generation:  0.03723764419555664
r_  generation:  0.27064943313598633
local_output_nid generation:  0.013239860534667969
local_in_edges_tensor generation:  0.019795894622802734
mini_batch_src_global generation:  0.0342097282409668
r_  generation:  0.27890586853027344
local_output_nid generation:  0.012933969497680664
local_in_edges_tensor generation:  0.017916440963745117
mini_batch_src_global generation:  0.03440976142883301
r_  generation:  0.27309441566467285
local_output_nid generation:  0.013099193572998047
local_in_edges_tensor generation:  0.015249967575073242
mini_batch_src_global generation:  0.034067630767822266
r_  generation:  0.2723352909088135
local_output_nid generation:  0.012932777404785156
local_in_edges_tensor generation:  0.015385866165161133
mini_batch_src_global generation:  0.03358745574951172
r_  generation:  0.26755475997924805
local_output_nid generation:  0.013033866882324219
local_in_edges_tensor generation:  0.015260934829711914
mini_batch_src_global generation:  0.03599357604980469
r_  generation:  0.2732822895050049
local_output_nid generation:  0.01299285888671875
local_in_edges_tensor generation:  0.017282485961914062
mini_batch_src_global generation:  0.034381866455078125
r_  generation:  0.2718682289123535
----------------------check_connections_block total spend ----------------------------- 6.265075206756592
generate_one_block  0.3644065856933594
generate_one_block  0.360149621963501
generate_one_block  0.3627755641937256
generate_one_block  0.3655555248260498
generate_one_block  0.36025476455688477
generate_one_block  0.3462209701538086
generate_one_block  0.35459470748901367
generate_one_block  0.365509033203125
generate_one_block  0.367565393447876
generate_one_block  0.34848976135253906
generate_one_block  0.3697974681854248
generate_one_block  0.34929895401000977
generate_one_block  0.3567025661468506
generate_one_block  0.35400986671447754
generate_one_block  0.3682670593261719
generate_one_block  0.35753464698791504
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.042237043380737305
gen group dst list time:  0.0631718635559082
time for parepare:  0.019665956497192383
local_output_nid generation:  0.027126789093017578
local_in_edges_tensor generation:  0.04441475868225098
mini_batch_src_global generation:  0.0515902042388916
r_  generation:  0.5220277309417725
local_output_nid generation:  0.03360486030578613
local_in_edges_tensor generation:  0.05525469779968262
mini_batch_src_global generation:  0.06251788139343262
r_  generation:  0.5304996967315674
local_output_nid generation:  0.03251171112060547
local_in_edges_tensor generation:  0.0509798526763916
mini_batch_src_global generation:  0.05874490737915039
r_  generation:  0.5328173637390137
local_output_nid generation:  0.03245401382446289
local_in_edges_tensor generation:  0.04192066192626953
mini_batch_src_global generation:  0.060005903244018555
r_  generation:  0.5327613353729248
local_output_nid generation:  0.03232264518737793
local_in_edges_tensor generation:  0.035982608795166016
mini_batch_src_global generation:  0.06097078323364258
r_  generation:  0.5417172908782959
local_output_nid generation:  0.03201484680175781
local_in_edges_tensor generation:  0.04078960418701172
mini_batch_src_global generation:  0.0617215633392334
r_  generation:  0.5387508869171143
local_output_nid generation:  0.03223824501037598
local_in_edges_tensor generation:  0.050536394119262695
mini_batch_src_global generation:  0.06084465980529785
r_  generation:  0.540985107421875
local_output_nid generation:  0.03237271308898926
local_in_edges_tensor generation:  0.04633307456970215
mini_batch_src_global generation:  0.06537985801696777
r_  generation:  0.5407564640045166
local_output_nid generation:  0.03240966796875
local_in_edges_tensor generation:  0.04075193405151367
mini_batch_src_global generation:  0.06492280960083008
r_  generation:  0.5404171943664551
local_output_nid generation:  0.032189369201660156
local_in_edges_tensor generation:  0.040247440338134766
mini_batch_src_global generation:  0.06232261657714844
r_  generation:  0.5395801067352295
local_output_nid generation:  0.03245377540588379
local_in_edges_tensor generation:  0.040024757385253906
mini_batch_src_global generation:  0.062494516372680664
r_  generation:  0.5427241325378418
local_output_nid generation:  0.032279253005981445
local_in_edges_tensor generation:  0.04537224769592285
mini_batch_src_global generation:  0.06220126152038574
r_  generation:  0.5450072288513184
local_output_nid generation:  0.032525062561035156
local_in_edges_tensor generation:  0.035675048828125
mini_batch_src_global generation:  0.06253242492675781
r_  generation:  0.5444118976593018
local_output_nid generation:  0.03247642517089844
local_in_edges_tensor generation:  0.03577089309692383
mini_batch_src_global generation:  0.06243562698364258
r_  generation:  0.542959451675415
local_output_nid generation:  0.03262066841125488
local_in_edges_tensor generation:  0.03960275650024414
mini_batch_src_global generation:  0.06243419647216797
r_  generation:  0.5463013648986816
local_output_nid generation:  0.032326459884643555
local_in_edges_tensor generation:  0.05104398727416992
mini_batch_src_global generation:  0.06456160545349121
r_  generation:  0.5485608577728271
----------------------check_connections_block total spend ----------------------------- 12.777343273162842
generate_one_block  0.7063064575195312
generate_one_block  0.7008965015411377
generate_one_block  0.710108757019043
generate_one_block  0.710991382598877
generate_one_block  0.6781678199768066
generate_one_block  0.6829042434692383
generate_one_block  0.7564404010772705
generate_one_block  0.700291633605957
generate_one_block  0.7001197338104248
generate_one_block  0.6912393569946289
generate_one_block  0.7015397548675537
generate_one_block  0.6833498477935791
generate_one_block  0.6790883541107178
generate_one_block  0.6823439598083496
generate_one_block  0.7042551040649414
generate_one_block  0.6777646541595459
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

connection checking time:  19.042418479919434
block generation total time  16.916940450668335
average batch blocks generation time:  1.057308778166771
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09519577026367188  GigaBytes
Max Memory Allocated: 0.09519577026367188  GigaBytes

torch.Size([157383, 128])
torch.Size([129274, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.2671666145324707  GigaBytes
Max Memory Allocated: 0.2759380340576172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.0959177017211914  GigaBytes
Max Memory Allocated: 0.2896385192871094  GigaBytes

torch.Size([157666, 128])
torch.Size([130502, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.2669057846069336  GigaBytes
Max Memory Allocated: 0.2896385192871094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09576272964477539  GigaBytes
Max Memory Allocated: 0.2896385192871094  GigaBytes

torch.Size([157269, 128])
torch.Size([129595, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.2665414810180664  GigaBytes
Max Memory Allocated: 0.2896385192871094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09601879119873047  GigaBytes
Max Memory Allocated: 0.2896385192871094  GigaBytes

torch.Size([157624, 128])
torch.Size([130405, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.26685094833374023  GigaBytes
Max Memory Allocated: 0.2896385192871094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.0956573486328125  GigaBytes
Max Memory Allocated: 0.2896385192871094  GigaBytes

torch.Size([157494, 128])
torch.Size([129667, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.2655177116394043  GigaBytes
Max Memory Allocated: 0.2896385192871094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09566497802734375  GigaBytes
Max Memory Allocated: 0.2896385192871094  GigaBytes

torch.Size([157470, 128])
torch.Size([129387, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.2653336524963379  GigaBytes
Max Memory Allocated: 0.2896385192871094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09581708908081055  GigaBytes
Max Memory Allocated: 0.2896385192871094  GigaBytes

torch.Size([157617, 128])
torch.Size([129948, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.2661104202270508  GigaBytes
Max Memory Allocated: 0.2896385192871094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09589719772338867  GigaBytes
Max Memory Allocated: 0.2896385192871094  GigaBytes

torch.Size([157491, 128])
torch.Size([129997, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.26681947708129883  GigaBytes
Max Memory Allocated: 0.2896385192871094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09600019454956055  GigaBytes
Max Memory Allocated: 0.2896385192871094  GigaBytes

torch.Size([157611, 128])
torch.Size([130443, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.26699209213256836  GigaBytes
Max Memory Allocated: 0.2896385192871094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.0968475341796875  GigaBytes
Max Memory Allocated: 0.2896385192871094  GigaBytes

torch.Size([157774, 128])
torch.Size([130063, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.26708078384399414  GigaBytes
Max Memory Allocated: 0.2896385192871094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09709453582763672  GigaBytes
Max Memory Allocated: 0.2896385192871094  GigaBytes

torch.Size([157820, 128])
torch.Size([130902, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.26888465881347656  GigaBytes
Max Memory Allocated: 0.2896385192871094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09586381912231445  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

torch.Size([157641, 128])
torch.Size([130235, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.2664222717285156  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09580039978027344  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

torch.Size([157444, 128])
torch.Size([129856, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.26636600494384766  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.0957026481628418  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

torch.Size([157483, 128])
torch.Size([129944, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.26544713973999023  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09685039520263672  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

torch.Size([157737, 128])
torch.Size([129813, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.2669968605041504  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09572696685791016  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

torch.Size([157494, 128])
torch.Size([129510, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.26584529876708984  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.037526220083236694 |0.034010350704193115 |0.05034162104129791 |9.378790855407715e-05 |0.008460015058517456 |0.0035517215728759766 |
----------------------------------------------------------pseudo_mini_loss sum 5.340138912200928
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5331570
Number of first layer input nodes during this epoch:  2521018
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.13778114318847656  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02629542350769043
random selection method range initialization spend 0.005136251449584961
time for parepare:  0.016846895217895508
local_output_nid generation:  0.0023305416107177734
local_in_edges_tensor generation:  0.0074923038482666016
mini_batch_src_global generation:  0.0019965171813964844
r_  generation:  0.01959228515625
local_output_nid generation:  0.002749204635620117
local_in_edges_tensor generation:  0.0016880035400390625
mini_batch_src_global generation:  0.0022575855255126953
r_  generation:  0.019390583038330078
local_output_nid generation:  0.002883434295654297
local_in_edges_tensor generation:  0.0015676021575927734
mini_batch_src_global generation:  0.0014798641204833984
r_  generation:  0.020267009735107422
local_output_nid generation:  0.0029401779174804688
local_in_edges_tensor generation:  0.00165557861328125
mini_batch_src_global generation:  0.0016193389892578125
r_  generation:  0.020032405853271484
local_output_nid generation:  0.0029554367065429688
local_in_edges_tensor generation:  0.0015730857849121094
mini_batch_src_global generation:  0.0015282630920410156
r_  generation:  0.020226716995239258
local_output_nid generation:  0.0029327869415283203
local_in_edges_tensor generation:  0.0015501976013183594
mini_batch_src_global generation:  0.0016689300537109375
r_  generation:  0.02212834358215332
local_output_nid generation:  0.002939939498901367
local_in_edges_tensor generation:  0.0015804767608642578
mini_batch_src_global generation:  0.0017762184143066406
r_  generation:  0.021602869033813477
local_output_nid generation:  0.002974271774291992
local_in_edges_tensor generation:  0.0015380382537841797
mini_batch_src_global generation:  0.0017180442810058594
r_  generation:  0.020977258682250977
local_output_nid generation:  0.002985715866088867
local_in_edges_tensor generation:  0.0015308856964111328
mini_batch_src_global generation:  0.0017483234405517578
r_  generation:  0.021979331970214844
local_output_nid generation:  0.002955913543701172
local_in_edges_tensor generation:  0.0014948844909667969
mini_batch_src_global generation:  0.0018520355224609375
r_  generation:  0.022084951400756836
local_output_nid generation:  0.002932310104370117
local_in_edges_tensor generation:  0.0015265941619873047
mini_batch_src_global generation:  0.0017735958099365234
r_  generation:  0.021871328353881836
local_output_nid generation:  0.0030395984649658203
local_in_edges_tensor generation:  0.0015425682067871094
mini_batch_src_global generation:  0.0018033981323242188
r_  generation:  0.021741390228271484
local_output_nid generation:  0.002977609634399414
local_in_edges_tensor generation:  0.0015387535095214844
mini_batch_src_global generation:  0.0017549991607666016
r_  generation:  0.021875381469726562
local_output_nid generation:  0.002982616424560547
local_in_edges_tensor generation:  0.00159454345703125
mini_batch_src_global generation:  0.0017383098602294922
r_  generation:  0.02161240577697754
local_output_nid generation:  0.003003358840942383
local_in_edges_tensor generation:  0.0015225410461425781
mini_batch_src_global generation:  0.0018579959869384766
r_  generation:  0.022214412689208984
local_output_nid generation:  0.0029523372650146484
local_in_edges_tensor generation:  0.0015251636505126953
mini_batch_src_global generation:  0.0018930435180664062
r_  generation:  0.02289271354675293
----------------------check_connections_block total spend ----------------------------- 0.5498185157775879
generate_one_block  0.030787944793701172
generate_one_block  0.03050971031188965
generate_one_block  0.03128480911254883
generate_one_block  0.031062841415405273
generate_one_block  0.031333208084106445
generate_one_block  0.03558206558227539
generate_one_block  0.0325322151184082
generate_one_block  0.03097820281982422
generate_one_block  0.03287148475646973
generate_one_block  0.03188657760620117
generate_one_block  0.03183913230895996
generate_one_block  0.03240489959716797
generate_one_block  0.031996965408325195
generate_one_block  0.030757904052734375
generate_one_block  0.03271770477294922
generate_one_block  0.033213138580322266
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04180908203125
gen group dst list time:  0.02223992347717285
time for parepare:  0.018999576568603516
local_output_nid generation:  0.009132862091064453
local_in_edges_tensor generation:  0.028429269790649414
mini_batch_src_global generation:  0.024927854537963867
r_  generation:  0.24856972694396973
local_output_nid generation:  0.013132572174072266
local_in_edges_tensor generation:  0.023183345794677734
mini_batch_src_global generation:  0.03271150588989258
r_  generation:  0.24456405639648438
local_output_nid generation:  0.013214111328125
local_in_edges_tensor generation:  0.021327495574951172
mini_batch_src_global generation:  0.03141188621520996
r_  generation:  0.25781869888305664
local_output_nid generation:  0.013643503189086914
local_in_edges_tensor generation:  0.016657352447509766
mini_batch_src_global generation:  0.038254737854003906
r_  generation:  0.27429819107055664
local_output_nid generation:  0.014565467834472656
local_in_edges_tensor generation:  0.032346248626708984
mini_batch_src_global generation:  0.03562569618225098
r_  generation:  0.26727867126464844
local_output_nid generation:  0.015217781066894531
local_in_edges_tensor generation:  0.018637418746948242
mini_batch_src_global generation:  0.034989118576049805
r_  generation:  0.2755134105682373
local_output_nid generation:  0.013438940048217773
local_in_edges_tensor generation:  0.01869058609008789
mini_batch_src_global generation:  0.03434395790100098
r_  generation:  0.2689208984375
local_output_nid generation:  0.013363122940063477
local_in_edges_tensor generation:  0.01601552963256836
mini_batch_src_global generation:  0.03423738479614258
r_  generation:  0.2659783363342285
local_output_nid generation:  0.013544797897338867
local_in_edges_tensor generation:  0.016409635543823242
mini_batch_src_global generation:  0.03501486778259277
r_  generation:  0.2746925354003906
local_output_nid generation:  0.013518095016479492
local_in_edges_tensor generation:  0.01869821548461914
mini_batch_src_global generation:  0.034464120864868164
r_  generation:  0.27010107040405273
local_output_nid generation:  0.013420343399047852
local_in_edges_tensor generation:  0.016587257385253906
mini_batch_src_global generation:  0.03535151481628418
r_  generation:  0.27565979957580566
local_output_nid generation:  0.01345968246459961
local_in_edges_tensor generation:  0.018837690353393555
mini_batch_src_global generation:  0.03501486778259277
r_  generation:  0.26948046684265137
local_output_nid generation:  0.013412714004516602
local_in_edges_tensor generation:  0.013996362686157227
mini_batch_src_global generation:  0.052472591400146484
r_  generation:  0.27065062522888184
local_output_nid generation:  0.013272762298583984
local_in_edges_tensor generation:  0.015837907791137695
mini_batch_src_global generation:  0.03793215751647949
r_  generation:  0.267714262008667
local_output_nid generation:  0.013575315475463867
local_in_edges_tensor generation:  0.018759965896606445
mini_batch_src_global generation:  0.03639936447143555
r_  generation:  0.2766683101654053
local_output_nid generation:  0.013696670532226562
local_in_edges_tensor generation:  0.019543886184692383
mini_batch_src_global generation:  0.03518104553222656
r_  generation:  0.28092050552368164
----------------------check_connections_block total spend ----------------------------- 6.333065748214722
generate_one_block  0.37798261642456055
generate_one_block  0.3813507556915283
generate_one_block  0.3643009662628174
generate_one_block  0.3714742660522461
generate_one_block  0.3607792854309082
generate_one_block  0.3817441463470459
generate_one_block  0.3989219665527344
generate_one_block  0.3666517734527588
generate_one_block  0.3745131492614746
generate_one_block  0.3647489547729492
generate_one_block  0.36429691314697266
generate_one_block  0.370389461517334
generate_one_block  0.3509669303894043
generate_one_block  0.34715771675109863
generate_one_block  0.3647594451904297
generate_one_block  0.36566710472106934
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05205416679382324
gen group dst list time:  0.07024240493774414
time for parepare:  0.02266860008239746
local_output_nid generation:  0.029048442840576172
local_in_edges_tensor generation:  0.056465864181518555
mini_batch_src_global generation:  0.05433344841003418
r_  generation:  0.5225727558135986
local_output_nid generation:  0.03480672836303711
local_in_edges_tensor generation:  0.054523468017578125
mini_batch_src_global generation:  0.06692814826965332
r_  generation:  0.54134202003479
local_output_nid generation:  0.036171913146972656
local_in_edges_tensor generation:  0.0461273193359375
mini_batch_src_global generation:  0.0660550594329834
r_  generation:  0.5255007743835449
local_output_nid generation:  0.0341188907623291
local_in_edges_tensor generation:  0.047313690185546875
mini_batch_src_global generation:  0.06056022644042969
r_  generation:  0.5305624008178711
local_output_nid generation:  0.0343782901763916
local_in_edges_tensor generation:  0.10110163688659668
mini_batch_src_global generation:  0.060819387435913086
r_  generation:  0.5338680744171143
local_output_nid generation:  0.0332181453704834
local_in_edges_tensor generation:  0.03876161575317383
mini_batch_src_global generation:  0.0653986930847168
r_  generation:  0.5456080436706543
local_output_nid generation:  0.033486127853393555
local_in_edges_tensor generation:  0.03494429588317871
mini_batch_src_global generation:  0.06196141242980957
r_  generation:  0.546109676361084
local_output_nid generation:  0.03319382667541504
local_in_edges_tensor generation:  0.034647464752197266
mini_batch_src_global generation:  0.06237387657165527
r_  generation:  0.5387482643127441
local_output_nid generation:  0.03356003761291504
local_in_edges_tensor generation:  0.039459943771362305
mini_batch_src_global generation:  0.06594443321228027
r_  generation:  0.5493676662445068
local_output_nid generation:  0.03336215019226074
local_in_edges_tensor generation:  0.03977346420288086
mini_batch_src_global generation:  0.06286001205444336
r_  generation:  0.5381526947021484
local_output_nid generation:  0.03327822685241699
local_in_edges_tensor generation:  0.034624338150024414
mini_batch_src_global generation:  0.06267333030700684
r_  generation:  0.5397794246673584
local_output_nid generation:  0.0333409309387207
local_in_edges_tensor generation:  0.056099653244018555
mini_batch_src_global generation:  0.06308627128601074
r_  generation:  0.5439112186431885
local_output_nid generation:  0.03463125228881836
local_in_edges_tensor generation:  0.04537010192871094
mini_batch_src_global generation:  0.06236720085144043
r_  generation:  0.5451979637145996
local_output_nid generation:  0.03333282470703125
local_in_edges_tensor generation:  0.035202980041503906
mini_batch_src_global generation:  0.07988548278808594
r_  generation:  0.5578103065490723
local_output_nid generation:  0.03356599807739258
local_in_edges_tensor generation:  0.052831411361694336
mini_batch_src_global generation:  0.06641268730163574
r_  generation:  0.5550487041473389
local_output_nid generation:  0.03580355644226074
local_in_edges_tensor generation:  0.05415630340576172
mini_batch_src_global generation:  0.06193351745605469
r_  generation:  0.5407581329345703
----------------------check_connections_block total spend ----------------------------- 12.907057523727417
generate_one_block  0.6982803344726562
generate_one_block  0.6811678409576416
generate_one_block  0.6807892322540283
generate_one_block  0.6908268928527832
generate_one_block  0.690995454788208
generate_one_block  0.7001087665557861
generate_one_block  0.7018208503723145
generate_one_block  0.6978094577789307
generate_one_block  0.729999303817749
generate_one_block  0.6876993179321289
generate_one_block  0.6951532363891602
generate_one_block  0.7076685428619385
generate_one_block  0.6983141899108887
generate_one_block  0.6756269931793213
generate_one_block  0.6780331134796143
generate_one_block  0.689368724822998
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.13778114318847656  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

connection checking time:  19.24012327194214
block generation total time  17.00936770439148
average batch blocks generation time:  1.0630854815244675
block dataloader generation time/epoch 38.62449622154236
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09622812271118164  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

torch.Size([157670, 128])
torch.Size([129995, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.2670431137084961  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09577035903930664  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

torch.Size([157645, 128])
torch.Size([129756, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.26520395278930664  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09573173522949219  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

torch.Size([157072, 128])
torch.Size([128857, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.26546716690063477  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.09582376480102539  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

torch.Size([157499, 128])
torch.Size([129369, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.26516008377075195  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.09693145751953125  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

torch.Size([157806, 128])
torch.Size([130016, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.26671266555786133  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.09623384475708008  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

torch.Size([157409, 128])
torch.Size([130086, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.2678999900817871  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.09619998931884766  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

torch.Size([157690, 128])
torch.Size([130153, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.2671318054199219  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.09605216979980469  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

torch.Size([157598, 128])
torch.Size([129900, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.26609086990356445  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.09632301330566406  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

torch.Size([157680, 128])
torch.Size([130511, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.2677187919616699  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.09614276885986328  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

torch.Size([157558, 128])
torch.Size([129808, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.26698827743530273  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.09604597091674805  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

torch.Size([157299, 128])
torch.Size([129697, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.26672887802124023  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.09617328643798828  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

torch.Size([157638, 128])
torch.Size([130237, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.2669978141784668  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.09609794616699219  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

torch.Size([157638, 128])
torch.Size([130114, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.26654052734375  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.09563827514648438  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

torch.Size([157078, 128])
torch.Size([129005, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.2652864456176758  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.09618806838989258  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

torch.Size([157593, 128])
torch.Size([129565, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.26683521270751953  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.09621047973632812  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

torch.Size([157556, 128])
torch.Size([130095, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.2676100730895996  GigaBytes
Max Memory Allocated: 0.290952205657959  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03403303027153015 |0.014750882983207703 |0.0034980177879333496 |8.997321128845215e-05 |0.004119277000427246 |0.0014657974243164062 |
----------------------------------------------------------pseudo_mini_loss sum 4.107621669769287
Total (block generation + training)time/epoch 39.56104254722595
Training time/epoch 0.936345100402832
Training time without block to device /epoch 0.7003309726715088
Training time without total dataloading part /epoch 0.12478208541870117
load block tensor time/epoch 0.5445284843444824
block to device time/epoch 0.23601412773132324
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5327748
Number of first layer input nodes during this epoch:  2520429
