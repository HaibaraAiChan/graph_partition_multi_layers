Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648442448.5555482
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026919841766357422
random selection method range initialization spend 0.006625652313232422
time for parepare:  0.01920342445373535
local_output_nid generation:  0.0021820068359375
local_in_edges_tensor generation:  0.004611492156982422
mini_batch_src_global generation:  0.0020139217376708984
r_  generation:  0.020724773406982422
local_output_nid generation:  0.0029230117797851562
local_in_edges_tensor generation:  0.001722097396850586
mini_batch_src_global generation:  0.0025107860565185547
r_  generation:  0.021132946014404297
local_output_nid generation:  0.002912282943725586
local_in_edges_tensor generation:  0.0016679763793945312
mini_batch_src_global generation:  0.0015680789947509766
r_  generation:  0.020031452178955078
local_output_nid generation:  0.0029668807983398438
local_in_edges_tensor generation:  0.0015749931335449219
mini_batch_src_global generation:  0.0016336441040039062
r_  generation:  0.02032017707824707
local_output_nid generation:  0.0029625892639160156
local_in_edges_tensor generation:  0.001573324203491211
mini_batch_src_global generation:  0.0015926361083984375
r_  generation:  0.021342039108276367
local_output_nid generation:  0.0029969215393066406
local_in_edges_tensor generation:  0.001592874526977539
mini_batch_src_global generation:  0.0017309188842773438
r_  generation:  0.021890878677368164
local_output_nid generation:  0.0029773712158203125
local_in_edges_tensor generation:  0.0015981197357177734
mini_batch_src_global generation:  0.0017561912536621094
r_  generation:  0.022517919540405273
local_output_nid generation:  0.003010272979736328
local_in_edges_tensor generation:  0.001621246337890625
mini_batch_src_global generation:  0.001790761947631836
r_  generation:  0.022343873977661133
local_output_nid generation:  0.0029566287994384766
local_in_edges_tensor generation:  0.0016002655029296875
mini_batch_src_global generation:  0.0017170906066894531
r_  generation:  0.021759986877441406
local_output_nid generation:  0.0029964447021484375
local_in_edges_tensor generation:  0.0016121864318847656
mini_batch_src_global generation:  0.0017440319061279297
r_  generation:  0.02237391471862793
local_output_nid generation:  0.003029346466064453
local_in_edges_tensor generation:  0.0016372203826904297
mini_batch_src_global generation:  0.0017783641815185547
r_  generation:  0.021975040435791016
local_output_nid generation:  0.002994060516357422
local_in_edges_tensor generation:  0.0015921592712402344
mini_batch_src_global generation:  0.001806020736694336
r_  generation:  0.02216482162475586
local_output_nid generation:  0.0029840469360351562
local_in_edges_tensor generation:  0.0016279220581054688
mini_batch_src_global generation:  0.0018334388732910156
r_  generation:  0.022736787796020508
local_output_nid generation:  0.0030188560485839844
local_in_edges_tensor generation:  0.0015788078308105469
mini_batch_src_global generation:  0.0018138885498046875
r_  generation:  0.021666288375854492
local_output_nid generation:  0.0029840469360351562
local_in_edges_tensor generation:  0.0015628337860107422
mini_batch_src_global generation:  0.0018169879913330078
r_  generation:  0.022320032119750977
local_output_nid generation:  0.0029609203338623047
local_in_edges_tensor generation:  0.0016624927520751953
mini_batch_src_global generation:  0.0018222332000732422
r_  generation:  0.022533655166625977
----------------------check_connections_block total spend ----------------------------- 0.5596990585327148
generate_one_block  0.03052234649658203
generate_one_block  0.03155398368835449
generate_one_block  0.033377647399902344
generate_one_block  0.03102254867553711
generate_one_block  0.031375885009765625
generate_one_block  0.03176426887512207
generate_one_block  0.031916141510009766
generate_one_block  0.03261423110961914
generate_one_block  0.03126192092895508
generate_one_block  0.03142905235290527
generate_one_block  0.03157401084899902
generate_one_block  0.03167414665222168
generate_one_block  0.03211379051208496
generate_one_block  0.030615806579589844
generate_one_block  0.031394243240356445
generate_one_block  0.03180503845214844
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.044519662857055664
gen group dst list time:  0.021259784698486328
time for parepare:  0.01957082748413086
local_output_nid generation:  0.00900721549987793
local_in_edges_tensor generation:  0.02235269546508789
mini_batch_src_global generation:  0.0271146297454834
r_  generation:  0.24560904502868652
local_output_nid generation:  0.013232707977294922
local_in_edges_tensor generation:  0.02384662628173828
mini_batch_src_global generation:  0.03190350532531738
r_  generation:  0.2626354694366455
local_output_nid generation:  0.012575626373291016
local_in_edges_tensor generation:  0.018436908721923828
mini_batch_src_global generation:  0.030666112899780273
r_  generation:  0.260631799697876
local_output_nid generation:  0.012711286544799805
local_in_edges_tensor generation:  0.021581649780273438
mini_batch_src_global generation:  0.03159284591674805
r_  generation:  0.26892995834350586
local_output_nid generation:  0.01288461685180664
local_in_edges_tensor generation:  0.019445180892944336
mini_batch_src_global generation:  0.03362083435058594
r_  generation:  0.2920663356781006
local_output_nid generation:  0.016147375106811523
local_in_edges_tensor generation:  0.03435945510864258
mini_batch_src_global generation:  0.03995227813720703
r_  generation:  0.2716975212097168
local_output_nid generation:  0.013287544250488281
local_in_edges_tensor generation:  0.019979476928710938
mini_batch_src_global generation:  0.034401655197143555
r_  generation:  0.27124953269958496
local_output_nid generation:  0.01352691650390625
local_in_edges_tensor generation:  0.022020339965820312
mini_batch_src_global generation:  0.03516125679016113
r_  generation:  0.2724573612213135
local_output_nid generation:  0.013613700866699219
local_in_edges_tensor generation:  0.014083385467529297
mini_batch_src_global generation:  0.034403324127197266
r_  generation:  0.2683706283569336
local_output_nid generation:  0.013288736343383789
local_in_edges_tensor generation:  0.013594388961791992
mini_batch_src_global generation:  0.03486204147338867
r_  generation:  0.2741711139678955
local_output_nid generation:  0.013298511505126953
local_in_edges_tensor generation:  0.01665043830871582
mini_batch_src_global generation:  0.036774635314941406
r_  generation:  0.2780117988586426
local_output_nid generation:  0.013455867767333984
local_in_edges_tensor generation:  0.019115924835205078
mini_batch_src_global generation:  0.035582780838012695
r_  generation:  0.2750866413116455
local_output_nid generation:  0.013469696044921875
local_in_edges_tensor generation:  0.01686382293701172
mini_batch_src_global generation:  0.03512430191040039
r_  generation:  0.2750256061553955
local_output_nid generation:  0.013190507888793945
local_in_edges_tensor generation:  0.01366567611694336
mini_batch_src_global generation:  0.03423953056335449
r_  generation:  0.2682783603668213
local_output_nid generation:  0.013401269912719727
local_in_edges_tensor generation:  0.01604485511779785
mini_batch_src_global generation:  0.03445768356323242
r_  generation:  0.2746455669403076
local_output_nid generation:  0.013539791107177734
local_in_edges_tensor generation:  0.01915574073791504
mini_batch_src_global generation:  0.03512287139892578
r_  generation:  0.27671051025390625
----------------------check_connections_block total spend ----------------------------- 6.363503694534302
generate_one_block  0.3578171730041504
generate_one_block  0.3518242835998535
generate_one_block  0.34371376037597656
generate_one_block  0.3484232425689697
generate_one_block  0.3793809413909912
generate_one_block  0.3535778522491455
generate_one_block  0.35855913162231445
generate_one_block  0.3610050678253174
generate_one_block  0.3485376834869385
generate_one_block  0.3547821044921875
generate_one_block  0.36067843437194824
generate_one_block  0.3783431053161621
generate_one_block  0.37180638313293457
generate_one_block  0.362058162689209
generate_one_block  0.3687450885772705
generate_one_block  0.36956143379211426
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05844593048095703
gen group dst list time:  0.07294678688049316
time for parepare:  0.02199578285217285
local_output_nid generation:  0.029742717742919922
local_in_edges_tensor generation:  0.053792476654052734
mini_batch_src_global generation:  0.042672157287597656
r_  generation:  0.4657764434814453
local_output_nid generation:  0.033154964447021484
local_in_edges_tensor generation:  0.048354148864746094
mini_batch_src_global generation:  0.05652451515197754
r_  generation:  0.46441006660461426
local_output_nid generation:  0.03249335289001465
local_in_edges_tensor generation:  0.04630088806152344
mini_batch_src_global generation:  0.05088925361633301
r_  generation:  0.47136759757995605
local_output_nid generation:  0.03431439399719238
local_in_edges_tensor generation:  0.04567718505859375
mini_batch_src_global generation:  0.05751180648803711
r_  generation:  0.47583961486816406
local_output_nid generation:  0.03562641143798828
local_in_edges_tensor generation:  0.04021859169006348
mini_batch_src_global generation:  0.058045387268066406
r_  generation:  0.46917247772216797
local_output_nid generation:  0.03354382514953613
local_in_edges_tensor generation:  0.0364682674407959
mini_batch_src_global generation:  0.05229973793029785
r_  generation:  0.470691442489624
local_output_nid generation:  0.033354997634887695
local_in_edges_tensor generation:  0.035781145095825195
mini_batch_src_global generation:  0.052657365798950195
r_  generation:  0.48162150382995605
local_output_nid generation:  0.033586978912353516
local_in_edges_tensor generation:  0.03555774688720703
mini_batch_src_global generation:  0.05615687370300293
r_  generation:  0.4809904098510742
local_output_nid generation:  0.03354597091674805
local_in_edges_tensor generation:  0.035947561264038086
mini_batch_src_global generation:  0.05256986618041992
r_  generation:  0.47608518600463867
local_output_nid generation:  0.0334780216217041
local_in_edges_tensor generation:  0.03944516181945801
mini_batch_src_global generation:  0.05416727066040039
r_  generation:  0.4772512912750244
local_output_nid generation:  0.03435015678405762
local_in_edges_tensor generation:  0.03369927406311035
mini_batch_src_global generation:  0.05302834510803223
r_  generation:  0.4766573905944824
local_output_nid generation:  0.03350996971130371
local_in_edges_tensor generation:  0.04726862907409668
mini_batch_src_global generation:  0.058911800384521484
r_  generation:  0.472930908203125
local_output_nid generation:  0.03354239463806152
local_in_edges_tensor generation:  0.039305925369262695
mini_batch_src_global generation:  0.0731804370880127
r_  generation:  0.4756159782409668
local_output_nid generation:  0.034830570220947266
local_in_edges_tensor generation:  0.03518176078796387
mini_batch_src_global generation:  0.05693483352661133
r_  generation:  0.47165346145629883
local_output_nid generation:  0.033568620681762695
local_in_edges_tensor generation:  0.0379488468170166
mini_batch_src_global generation:  0.05329751968383789
r_  generation:  0.4775509834289551
local_output_nid generation:  0.03386878967285156
local_in_edges_tensor generation:  0.0382692813873291
mini_batch_src_global generation:  0.05590701103210449
r_  generation:  0.4782145023345947
----------------------check_connections_block total spend ----------------------------- 11.360882997512817
generate_one_block  0.6006627082824707
generate_one_block  0.5977563858032227
generate_one_block  0.5843899250030518
generate_one_block  0.5919592380523682
generate_one_block  0.6170859336853027
generate_one_block  0.6022109985351562
generate_one_block  0.6481773853302002
generate_one_block  0.6059737205505371
generate_one_block  0.582693338394165
generate_one_block  0.5835697650909424
generate_one_block  0.5996065139770508
generate_one_block  0.6168520450592041
generate_one_block  0.5862994194030762
generate_one_block  0.6015183925628662
generate_one_block  0.6000111103057861
generate_one_block  0.5995175838470459
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

connection checking time:  17.72438669204712
block generation total time  15.38709831237793
average batch blocks generation time:  0.9616936445236206
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09280633926391602  GigaBytes
Max Memory Allocated: 0.09280633926391602  GigaBytes

torch.Size([157022, 128])
torch.Size([130154, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.47221899032592773  GigaBytes
Max Memory Allocated: 0.4918661117553711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.09477376937866211  GigaBytes
Max Memory Allocated: 0.5156712532043457  GigaBytes

torch.Size([156999, 128])
torch.Size([130070, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.4717698097229004  GigaBytes
Max Memory Allocated: 0.5156712532043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.0943455696105957  GigaBytes
Max Memory Allocated: 0.5156712532043457  GigaBytes

torch.Size([156455, 128])
torch.Size([129080, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.46885061264038086  GigaBytes
Max Memory Allocated: 0.5156712532043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.0944986343383789  GigaBytes
Max Memory Allocated: 0.5156712532043457  GigaBytes

torch.Size([156572, 128])
torch.Size([129368, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.4700474739074707  GigaBytes
Max Memory Allocated: 0.5156712532043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.09482145309448242  GigaBytes
Max Memory Allocated: 0.5156712532043457  GigaBytes

torch.Size([156867, 128])
torch.Size([129969, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.47315120697021484  GigaBytes
Max Memory Allocated: 0.5156712532043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.09481048583984375  GigaBytes
Max Memory Allocated: 0.5167860984802246  GigaBytes

torch.Size([156934, 128])
torch.Size([130076, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.4727663993835449  GigaBytes
Max Memory Allocated: 0.5167860984802246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.09478998184204102  GigaBytes
Max Memory Allocated: 0.5167860984802246  GigaBytes

torch.Size([156779, 128])
torch.Size([129717, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.47263097763061523  GigaBytes
Max Memory Allocated: 0.5167860984802246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.09490156173706055  GigaBytes
Max Memory Allocated: 0.5167860984802246  GigaBytes

torch.Size([156799, 128])
torch.Size([130079, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.47400522232055664  GigaBytes
Max Memory Allocated: 0.5167860984802246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.09470653533935547  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

torch.Size([156816, 128])
torch.Size([129573, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.4715690612792969  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.09468698501586914  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

torch.Size([156611, 128])
torch.Size([129490, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.4725480079650879  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.0948019027709961  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

torch.Size([156716, 128])
torch.Size([129759, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.4723520278930664  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.09493350982666016  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

torch.Size([156986, 128])
torch.Size([130397, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.4737515449523926  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.09480667114257812  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

torch.Size([156738, 128])
torch.Size([129692, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.4727778434753418  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.0947256088256836  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

torch.Size([157040, 128])
torch.Size([130345, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.4712376594543457  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.09484624862670898  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

torch.Size([156977, 128])
torch.Size([130048, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.4727745056152344  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.09494400024414062  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

torch.Size([156940, 128])
torch.Size([130367, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.47388553619384766  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03630863130092621 |0.03387954831123352 |0.04855293035507202 |9.830296039581299e-05 |0.005942314863204956 |0.0019593238830566406 |
----------------------------------------------------------pseudo_mini_loss sum 5.636065483093262
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5317250
Number of first layer input nodes during this epoch:  2509251
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.12158918380737305  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020306825637817383
random selection method range initialization spend 0.005206584930419922
time for parepare:  0.01693582534790039
local_output_nid generation:  0.0023949146270751953
local_in_edges_tensor generation:  0.006130695343017578
mini_batch_src_global generation:  0.0019865036010742188
r_  generation:  0.0200653076171875
local_output_nid generation:  0.0029418468475341797
local_in_edges_tensor generation:  0.0017123222351074219
mini_batch_src_global generation:  0.0023183822631835938
r_  generation:  0.020493745803833008
local_output_nid generation:  0.0029795169830322266
local_in_edges_tensor generation:  0.0015892982482910156
mini_batch_src_global generation:  0.001539468765258789
r_  generation:  0.020526647567749023
local_output_nid generation:  0.002965211868286133
local_in_edges_tensor generation:  0.0015988349914550781
mini_batch_src_global generation:  0.001554250717163086
r_  generation:  0.02057480812072754
local_output_nid generation:  0.0029244422912597656
local_in_edges_tensor generation:  0.0015931129455566406
mini_batch_src_global generation:  0.001539468765258789
r_  generation:  0.020755290985107422
local_output_nid generation:  0.002966165542602539
local_in_edges_tensor generation:  0.0015761852264404297
mini_batch_src_global generation:  0.0015621185302734375
r_  generation:  0.0205533504486084
local_output_nid generation:  0.002924680709838867
local_in_edges_tensor generation:  0.0015153884887695312
mini_batch_src_global generation:  0.0016486644744873047
r_  generation:  0.021836042404174805
local_output_nid generation:  0.0029430389404296875
local_in_edges_tensor generation:  0.001500844955444336
mini_batch_src_global generation:  0.001668691635131836
r_  generation:  0.022223472595214844
local_output_nid generation:  0.003007650375366211
local_in_edges_tensor generation:  0.001611948013305664
mini_batch_src_global generation:  0.0016741752624511719
r_  generation:  0.02126479148864746
local_output_nid generation:  0.0029473304748535156
local_in_edges_tensor generation:  0.0015704631805419922
mini_batch_src_global generation:  0.0016777515411376953
r_  generation:  0.021999835968017578
local_output_nid generation:  0.0029418468475341797
local_in_edges_tensor generation:  0.0015361309051513672
mini_batch_src_global generation:  0.0016753673553466797
r_  generation:  0.021532535552978516
local_output_nid generation:  0.0029478073120117188
local_in_edges_tensor generation:  0.0015072822570800781
mini_batch_src_global generation:  0.0016937255859375
r_  generation:  0.021242618560791016
local_output_nid generation:  0.0029425621032714844
local_in_edges_tensor generation:  0.0015730857849121094
mini_batch_src_global generation:  0.0017023086547851562
r_  generation:  0.02217698097229004
local_output_nid generation:  0.0029544830322265625
local_in_edges_tensor generation:  0.0015578269958496094
mini_batch_src_global generation:  0.0017354488372802734
r_  generation:  0.022397756576538086
local_output_nid generation:  0.0029485225677490234
local_in_edges_tensor generation:  0.0015647411346435547
mini_batch_src_global generation:  0.0017139911651611328
r_  generation:  0.021453142166137695
local_output_nid generation:  0.002920866012573242
local_in_edges_tensor generation:  0.0016016960144042969
mini_batch_src_global generation:  0.001783132553100586
r_  generation:  0.022644996643066406
----------------------check_connections_block total spend ----------------------------- 0.5512096881866455
generate_one_block  0.03010272979736328
generate_one_block  0.031194448471069336
generate_one_block  0.03251981735229492
generate_one_block  0.03173398971557617
generate_one_block  0.030725479125976562
generate_one_block  0.03333616256713867
generate_one_block  0.03343653678894043
generate_one_block  0.03214216232299805
generate_one_block  0.030770063400268555
generate_one_block  0.032193899154663086
generate_one_block  0.030976295471191406
generate_one_block  0.03123164176940918
generate_one_block  0.03204631805419922
generate_one_block  0.03220176696777344
generate_one_block  0.030818939208984375
generate_one_block  0.03357553482055664
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05491304397583008
gen group dst list time:  0.020661592483520508
time for parepare:  0.018925189971923828
local_output_nid generation:  0.008790254592895508
local_in_edges_tensor generation:  0.0384671688079834
mini_batch_src_global generation:  0.025226593017578125
r_  generation:  0.25189852714538574
local_output_nid generation:  0.013273954391479492
local_in_edges_tensor generation:  0.023585796356201172
mini_batch_src_global generation:  0.03183341026306152
r_  generation:  0.248154878616333
local_output_nid generation:  0.013212203979492188
local_in_edges_tensor generation:  0.022075414657592773
mini_batch_src_global generation:  0.03142595291137695
r_  generation:  0.2635014057159424
local_output_nid generation:  0.013670921325683594
local_in_edges_tensor generation:  0.01924610137939453
mini_batch_src_global generation:  0.0324397087097168
r_  generation:  0.26560521125793457
local_output_nid generation:  0.013528585433959961
local_in_edges_tensor generation:  0.017301321029663086
mini_batch_src_global generation:  0.03344559669494629
r_  generation:  0.26937437057495117
local_output_nid generation:  0.013083219528198242
local_in_edges_tensor generation:  0.01875782012939453
mini_batch_src_global generation:  0.03306102752685547
r_  generation:  0.2645988464355469
local_output_nid generation:  0.013106107711791992
local_in_edges_tensor generation:  0.017459869384765625
mini_batch_src_global generation:  0.033696651458740234
r_  generation:  0.2736508846282959
local_output_nid generation:  0.014668941497802734
local_in_edges_tensor generation:  0.01689743995666504
mini_batch_src_global generation:  0.03385472297668457
r_  generation:  0.27048754692077637
local_output_nid generation:  0.01291656494140625
local_in_edges_tensor generation:  0.019777297973632812
mini_batch_src_global generation:  0.033493757247924805
r_  generation:  0.267575740814209
local_output_nid generation:  0.0130767822265625
local_in_edges_tensor generation:  0.020100116729736328
mini_batch_src_global generation:  0.04034280776977539
r_  generation:  0.2769773006439209
local_output_nid generation:  0.012816190719604492
local_in_edges_tensor generation:  0.01475381851196289
mini_batch_src_global generation:  0.03711986541748047
r_  generation:  0.268359899520874
local_output_nid generation:  0.012831926345825195
local_in_edges_tensor generation:  0.019902706146240234
mini_batch_src_global generation:  0.03645634651184082
r_  generation:  0.2863128185272217
local_output_nid generation:  0.01624464988708496
local_in_edges_tensor generation:  0.025892257690429688
mini_batch_src_global generation:  0.037030696868896484
r_  generation:  0.27278709411621094
local_output_nid generation:  0.013423919677734375
local_in_edges_tensor generation:  0.01786065101623535
mini_batch_src_global generation:  0.035904884338378906
r_  generation:  0.27177929878234863
local_output_nid generation:  0.013300418853759766
local_in_edges_tensor generation:  0.01508951187133789
mini_batch_src_global generation:  0.03400444984436035
r_  generation:  0.26511526107788086
local_output_nid generation:  0.013606786727905273
local_in_edges_tensor generation:  0.017180919647216797
mini_batch_src_global generation:  0.034647464752197266
r_  generation:  0.27431225776672363
----------------------check_connections_block total spend ----------------------------- 6.313816547393799
generate_one_block  0.36063623428344727
generate_one_block  0.3385488986968994
generate_one_block  0.3561995029449463
generate_one_block  0.35360145568847656
generate_one_block  0.36536550521850586
generate_one_block  0.3469696044921875
generate_one_block  0.394519567489624
generate_one_block  0.3450932502746582
generate_one_block  0.33766651153564453
generate_one_block  0.3672003746032715
generate_one_block  0.3418407440185547
generate_one_block  0.3537425994873047
generate_one_block  0.36337876319885254
generate_one_block  0.361147403717041
generate_one_block  0.34519410133361816
generate_one_block  0.36232805252075195
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.1515789031982422
gen group dst list time:  0.07473182678222656
time for parepare:  0.019928455352783203
local_output_nid generation:  0.027416229248046875
local_in_edges_tensor generation:  0.05445432662963867
mini_batch_src_global generation:  0.048645734786987305
r_  generation:  0.44641757011413574
local_output_nid generation:  0.03247570991516113
local_in_edges_tensor generation:  0.04782247543334961
mini_batch_src_global generation:  0.05487942695617676
r_  generation:  0.45779919624328613
local_output_nid generation:  0.03252863883972168
local_in_edges_tensor generation:  0.03968310356140137
mini_batch_src_global generation:  0.05323457717895508
r_  generation:  0.4779055118560791
local_output_nid generation:  0.03241586685180664
local_in_edges_tensor generation:  0.03489041328430176
mini_batch_src_global generation:  0.05464506149291992
r_  generation:  0.46248340606689453
local_output_nid generation:  0.03259587287902832
local_in_edges_tensor generation:  0.07780814170837402
mini_batch_src_global generation:  0.06505322456359863
r_  generation:  0.471449613571167
local_output_nid generation:  0.0325620174407959
local_in_edges_tensor generation:  0.0350346565246582
mini_batch_src_global generation:  0.05545449256896973
r_  generation:  0.468264102935791
local_output_nid generation:  0.032584428787231445
local_in_edges_tensor generation:  0.031017303466796875
mini_batch_src_global generation:  0.055159807205200195
r_  generation:  0.47055530548095703
local_output_nid generation:  0.03244900703430176
local_in_edges_tensor generation:  0.036736249923706055
mini_batch_src_global generation:  0.05562114715576172
r_  generation:  0.4677112102508545
local_output_nid generation:  0.0325620174407959
local_in_edges_tensor generation:  0.03108048439025879
mini_batch_src_global generation:  0.05562424659729004
r_  generation:  0.47318196296691895
local_output_nid generation:  0.03233456611633301
local_in_edges_tensor generation:  0.034981489181518555
mini_batch_src_global generation:  0.059214115142822266
r_  generation:  0.47617530822753906
local_output_nid generation:  0.03250765800476074
local_in_edges_tensor generation:  0.03119659423828125
mini_batch_src_global generation:  0.05586957931518555
r_  generation:  0.47788119316101074
local_output_nid generation:  0.032430410385131836
local_in_edges_tensor generation:  0.040582895278930664
mini_batch_src_global generation:  0.05986428260803223
r_  generation:  0.4763028621673584
local_output_nid generation:  0.03400683403015137
local_in_edges_tensor generation:  0.039429664611816406
mini_batch_src_global generation:  0.05590415000915527
r_  generation:  0.481032133102417
local_output_nid generation:  0.03349041938781738
local_in_edges_tensor generation:  0.04357171058654785
mini_batch_src_global generation:  0.060416221618652344
r_  generation:  0.48967409133911133
local_output_nid generation:  0.03513479232788086
local_in_edges_tensor generation:  0.03783059120178223
mini_batch_src_global generation:  0.06354451179504395
r_  generation:  0.47575974464416504
local_output_nid generation:  0.03528618812561035
local_in_edges_tensor generation:  0.03803372383117676
mini_batch_src_global generation:  0.06221747398376465
r_  generation:  0.4738752841949463
----------------------check_connections_block total spend ----------------------------- 11.326517105102539
generate_one_block  0.5900897979736328
generate_one_block  0.6016199588775635
generate_one_block  0.6075887680053711
generate_one_block  0.584420919418335
generate_one_block  0.5967962741851807
generate_one_block  0.5921916961669922
generate_one_block  0.6012182235717773
generate_one_block  0.5897974967956543
generate_one_block  0.6315839290618896
generate_one_block  0.5951719284057617
generate_one_block  0.5958151817321777
generate_one_block  0.5997753143310547
generate_one_block  0.5916569232940674
generate_one_block  0.6020796298980713
generate_one_block  0.5772988796234131
generate_one_block  0.5834746360778809
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.12158918380737305  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

connection checking time:  17.640333652496338
block generation total time  15.234012126922607
average batch blocks generation time:  0.952125757932663
block dataloader generation time/epoch 35.302385330200195
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.09542655944824219  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

torch.Size([156819, 128])
torch.Size([129803, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.4737277030944824  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.09509086608886719  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

torch.Size([156694, 128])
torch.Size([129576, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.47153520584106445  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.09544610977172852  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

torch.Size([156871, 128])
torch.Size([130320, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.473297119140625  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.09519290924072266  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

torch.Size([156478, 128])
torch.Size([129638, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.47275447845458984  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.0954599380493164  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

torch.Size([157046, 128])
torch.Size([130217, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.4732670783996582  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.09521150588989258  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

torch.Size([156887, 128])
torch.Size([129628, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.47127628326416016  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.09541034698486328  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

torch.Size([156644, 128])
torch.Size([129741, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.4740939140319824  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.09541177749633789  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

torch.Size([156967, 128])
torch.Size([129850, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.47371578216552734  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.09510564804077148  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

torch.Size([156685, 128])
torch.Size([129632, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.4715094566345215  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.09530019760131836  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

torch.Size([156481, 128])
torch.Size([129971, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.47401905059814453  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.09526681900024414  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

torch.Size([156933, 128])
torch.Size([129901, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.47195959091186523  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.09533166885375977  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

torch.Size([156997, 128])
torch.Size([129840, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.4722566604614258  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.09532546997070312  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

torch.Size([156678, 128])
torch.Size([129975, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.4733242988586426  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.0955648422241211  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

torch.Size([157150, 128])
torch.Size([130529, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.47379255294799805  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.09528446197509766  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

torch.Size([156956, 128])
torch.Size([129692, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.4713921546936035  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.09549522399902344  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

torch.Size([156896, 128])
torch.Size([130408, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.47472620010375977  GigaBytes
Max Memory Allocated: 0.5179810523986816  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.034131258726119995 |0.012285619974136353 |0.003811851143836975 |9.480118751525879e-05 |0.0046498775482177734 |0.0018172264099121094 |
----------------------------------------------------------pseudo_mini_loss sum 3.5828983783721924
Total (block generation + training)time/epoch 36.22060990333557
Training time/epoch 0.9180238246917725
Training time without block to device /epoch 0.7214539051055908
Training time without total dataloading part /epoch 0.13872170448303223
load block tensor time/epoch 0.5461001396179199
block to device time/epoch 0.19656991958618164
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5318056
Number of first layer input nodes during this epoch:  2509182
