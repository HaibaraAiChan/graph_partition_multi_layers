Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648439563.3656907
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024156808853149414
random selection method range initialization spend 0.00732874870300293
time for parepare:  0.019771575927734375
local_output_nid generation:  0.0011131763458251953
local_in_edges_tensor generation:  0.003206968307495117
mini_batch_src_global generation:  0.001975536346435547
r_  generation:  0.010492801666259766
local_output_nid generation:  0.0014102458953857422
local_in_edges_tensor generation:  0.0008606910705566406
mini_batch_src_global generation:  0.0013730525970458984
r_  generation:  0.0076901912689208984
local_output_nid generation:  0.0014941692352294922
local_in_edges_tensor generation:  0.0007884502410888672
mini_batch_src_global generation:  0.0009562969207763672
r_  generation:  0.007650613784790039
local_output_nid generation:  0.0014820098876953125
local_in_edges_tensor generation:  0.0007381439208984375
mini_batch_src_global generation:  0.0008919239044189453
r_  generation:  0.007677316665649414
local_output_nid generation:  0.0014324188232421875
local_in_edges_tensor generation:  0.0007212162017822266
mini_batch_src_global generation:  0.0008282661437988281
r_  generation:  0.0075931549072265625
local_output_nid generation:  0.0014150142669677734
local_in_edges_tensor generation:  0.0007076263427734375
mini_batch_src_global generation:  0.0009047985076904297
r_  generation:  0.00783991813659668
local_output_nid generation:  0.0014162063598632812
local_in_edges_tensor generation:  0.0007188320159912109
mini_batch_src_global generation:  0.0008428096771240234
r_  generation:  0.00791025161743164
local_output_nid generation:  0.0013930797576904297
local_in_edges_tensor generation:  0.0006844997406005859
mini_batch_src_global generation:  0.0008413791656494141
r_  generation:  0.007974863052368164
local_output_nid generation:  0.0013842582702636719
local_in_edges_tensor generation:  0.0006806850433349609
mini_batch_src_global generation:  0.0008189678192138672
r_  generation:  0.007713794708251953
local_output_nid generation:  0.0014443397521972656
local_in_edges_tensor generation:  0.0006945133209228516
mini_batch_src_global generation:  0.0008230209350585938
r_  generation:  0.0078887939453125
local_output_nid generation:  0.0013799667358398438
local_in_edges_tensor generation:  0.0006990432739257812
mini_batch_src_global generation:  0.0008335113525390625
r_  generation:  0.00800323486328125
local_output_nid generation:  0.0013706684112548828
local_in_edges_tensor generation:  0.0006792545318603516
mini_batch_src_global generation:  0.0008230209350585938
r_  generation:  0.007945537567138672
local_output_nid generation:  0.001375436782836914
local_in_edges_tensor generation:  0.0007021427154541016
mini_batch_src_global generation:  0.0008625984191894531
r_  generation:  0.008013010025024414
local_output_nid generation:  0.0013780593872070312
local_in_edges_tensor generation:  0.0006766319274902344
mini_batch_src_global generation:  0.0008256435394287109
r_  generation:  0.008095741271972656
local_output_nid generation:  0.001397848129272461
local_in_edges_tensor generation:  0.0006985664367675781
mini_batch_src_global generation:  0.0008668899536132812
r_  generation:  0.00835108757019043
local_output_nid generation:  0.001398324966430664
local_in_edges_tensor generation:  0.0007109642028808594
mini_batch_src_global generation:  0.0008766651153564453
r_  generation:  0.008230924606323242
local_output_nid generation:  0.0013937950134277344
local_in_edges_tensor generation:  0.0006842613220214844
mini_batch_src_global generation:  0.000881195068359375
r_  generation:  0.00840616226196289
local_output_nid generation:  0.001384735107421875
local_in_edges_tensor generation:  0.0006930828094482422
mini_batch_src_global generation:  0.0008852481842041016
r_  generation:  0.008380889892578125
local_output_nid generation:  0.0013988018035888672
local_in_edges_tensor generation:  0.0006995201110839844
mini_batch_src_global generation:  0.0008428096771240234
r_  generation:  0.008140087127685547
local_output_nid generation:  0.0013799667358398438
local_in_edges_tensor generation:  0.0006697177886962891
mini_batch_src_global generation:  0.0008780956268310547
r_  generation:  0.008120298385620117
local_output_nid generation:  0.0013921260833740234
local_in_edges_tensor generation:  0.0006840229034423828
mini_batch_src_global generation:  0.0008847713470458984
r_  generation:  0.008341073989868164
local_output_nid generation:  0.0014469623565673828
local_in_edges_tensor generation:  0.0006730556488037109
mini_batch_src_global generation:  0.0008852481842041016
r_  generation:  0.008476495742797852
local_output_nid generation:  0.0013823509216308594
local_in_edges_tensor generation:  0.0006666183471679688
mini_batch_src_global generation:  0.0008604526519775391
r_  generation:  0.008213281631469727
local_output_nid generation:  0.0014033317565917969
local_in_edges_tensor generation:  0.0007064342498779297
mini_batch_src_global generation:  0.0009760856628417969
r_  generation:  0.00820159912109375
local_output_nid generation:  0.0014214515686035156
local_in_edges_tensor generation:  0.0006802082061767578
mini_batch_src_global generation:  0.0008711814880371094
r_  generation:  0.008479595184326172
local_output_nid generation:  0.0013766288757324219
local_in_edges_tensor generation:  0.0006806850433349609
mini_batch_src_global generation:  0.0008342266082763672
r_  generation:  0.008063077926635742
local_output_nid generation:  0.0013887882232666016
local_in_edges_tensor generation:  0.0006756782531738281
mini_batch_src_global generation:  0.0008244514465332031
r_  generation:  0.007846355438232422
local_output_nid generation:  0.0014138221740722656
local_in_edges_tensor generation:  0.0006778240203857422
mini_batch_src_global generation:  0.0008363723754882812
r_  generation:  0.008073806762695312
local_output_nid generation:  0.0013687610626220703
local_in_edges_tensor generation:  0.000698089599609375
mini_batch_src_global generation:  0.0008499622344970703
r_  generation:  0.008292198181152344
local_output_nid generation:  0.0013909339904785156
local_in_edges_tensor generation:  0.005124807357788086
mini_batch_src_global generation:  0.0010590553283691406
r_  generation:  0.008096694946289062
local_output_nid generation:  0.0012629032135009766
local_in_edges_tensor generation:  0.0007374286651611328
mini_batch_src_global generation:  0.0009760856628417969
r_  generation:  0.008188724517822266
local_output_nid generation:  0.0012755393981933594
local_in_edges_tensor generation:  0.0006859302520751953
mini_batch_src_global generation:  0.0009701251983642578
r_  generation:  0.008082866668701172
----------------------check_connections_block total spend ----------------------------- 0.4633007049560547
generate_one_block  0.013861656188964844
generate_one_block  0.01325535774230957
generate_one_block  0.013058185577392578
generate_one_block  0.013016939163208008
generate_one_block  0.01272273063659668
generate_one_block  0.01311349868774414
generate_one_block  0.012846708297729492
generate_one_block  0.013046741485595703
generate_one_block  0.012658834457397461
generate_one_block  0.013108015060424805
generate_one_block  0.012885093688964844
generate_one_block  0.012613058090209961
generate_one_block  0.012769460678100586
generate_one_block  0.01270747184753418
generate_one_block  0.013196468353271484
generate_one_block  0.01310873031616211
generate_one_block  0.01338958740234375
generate_one_block  0.013086080551147461
generate_one_block  0.012776374816894531
generate_one_block  0.012862920761108398
generate_one_block  0.01334238052368164
generate_one_block  0.013274431228637695
generate_one_block  0.012857198715209961
generate_one_block  0.012981891632080078
generate_one_block  0.013340473175048828
generate_one_block  0.01272892951965332
generate_one_block  0.012584686279296875
generate_one_block  0.012798309326171875
generate_one_block  0.01299285888671875
generate_one_block  0.012602567672729492
generate_one_block  0.013121604919433594
generate_one_block  0.012887239456176758
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.037508487701416016
gen group dst list time:  0.021372556686401367
time for parepare:  0.018761157989501953
local_output_nid generation:  0.00468897819519043
local_in_edges_tensor generation:  0.011291027069091797
mini_batch_src_global generation:  0.011840343475341797
r_  generation:  0.11874818801879883
local_output_nid generation:  0.007517576217651367
local_in_edges_tensor generation:  0.01151895523071289
mini_batch_src_global generation:  0.01501154899597168
r_  generation:  0.12242746353149414
local_output_nid generation:  0.007489204406738281
local_in_edges_tensor generation:  0.008255958557128906
mini_batch_src_global generation:  0.01525568962097168
r_  generation:  0.12658405303955078
local_output_nid generation:  0.007289886474609375
local_in_edges_tensor generation:  0.007375001907348633
mini_batch_src_global generation:  0.014389991760253906
r_  generation:  0.12725615501403809
local_output_nid generation:  0.0070095062255859375
local_in_edges_tensor generation:  0.008030891418457031
mini_batch_src_global generation:  0.014665842056274414
r_  generation:  0.1287999153137207
local_output_nid generation:  0.007337093353271484
local_in_edges_tensor generation:  0.009480476379394531
mini_batch_src_global generation:  0.015585899353027344
r_  generation:  0.13648557662963867
local_output_nid generation:  0.007247447967529297
local_in_edges_tensor generation:  0.008335590362548828
mini_batch_src_global generation:  0.016008377075195312
r_  generation:  0.13761234283447266
local_output_nid generation:  0.007287263870239258
local_in_edges_tensor generation:  0.009551763534545898
mini_batch_src_global generation:  0.016118288040161133
r_  generation:  0.13770627975463867
local_output_nid generation:  0.010232210159301758
local_in_edges_tensor generation:  0.007336616516113281
mini_batch_src_global generation:  0.015949726104736328
r_  generation:  0.13278985023498535
local_output_nid generation:  0.007127523422241211
local_in_edges_tensor generation:  0.008677482604980469
mini_batch_src_global generation:  0.01995539665222168
r_  generation:  0.1355593204498291
local_output_nid generation:  0.007989645004272461
local_in_edges_tensor generation:  0.008834600448608398
mini_batch_src_global generation:  0.017377138137817383
r_  generation:  0.14506101608276367
local_output_nid generation:  0.009373188018798828
local_in_edges_tensor generation:  0.016117572784423828
mini_batch_src_global generation:  0.021611928939819336
r_  generation:  0.13160014152526855
local_output_nid generation:  0.007394552230834961
local_in_edges_tensor generation:  0.007546186447143555
mini_batch_src_global generation:  0.016193866729736328
r_  generation:  0.13324356079101562
local_output_nid generation:  0.00743556022644043
local_in_edges_tensor generation:  0.007273674011230469
mini_batch_src_global generation:  0.015881776809692383
r_  generation:  0.13005447387695312
local_output_nid generation:  0.007577419281005859
local_in_edges_tensor generation:  0.009328603744506836
mini_batch_src_global generation:  0.016646146774291992
r_  generation:  0.13786649703979492
local_output_nid generation:  0.007467508316040039
local_in_edges_tensor generation:  0.009372711181640625
mini_batch_src_global generation:  0.01634383201599121
r_  generation:  0.1349022388458252
local_output_nid generation:  0.00760960578918457
local_in_edges_tensor generation:  0.008511543273925781
mini_batch_src_global generation:  0.017588138580322266
r_  generation:  0.13796329498291016
local_output_nid generation:  0.0075376033782958984
local_in_edges_tensor generation:  0.00839543342590332
mini_batch_src_global generation:  0.016567230224609375
r_  generation:  0.1365823745727539
local_output_nid generation:  0.007317066192626953
local_in_edges_tensor generation:  0.00720667839050293
mini_batch_src_global generation:  0.01605701446533203
r_  generation:  0.13576531410217285
local_output_nid generation:  0.007601737976074219
local_in_edges_tensor generation:  0.0072591304779052734
mini_batch_src_global generation:  0.017122268676757812
r_  generation:  0.13354015350341797
local_output_nid generation:  0.0076334476470947266
local_in_edges_tensor generation:  0.00970458984375
mini_batch_src_global generation:  0.016496658325195312
r_  generation:  0.1379833221435547
local_output_nid generation:  0.00765538215637207
local_in_edges_tensor generation:  0.007499217987060547
mini_batch_src_global generation:  0.017802715301513672
r_  generation:  0.14002752304077148
local_output_nid generation:  0.007481575012207031
local_in_edges_tensor generation:  0.008335351943969727
mini_batch_src_global generation:  0.016157150268554688
r_  generation:  0.1465294361114502
local_output_nid generation:  0.0074884891510009766
local_in_edges_tensor generation:  0.010546684265136719
mini_batch_src_global generation:  0.017397403717041016
r_  generation:  0.14048218727111816
local_output_nid generation:  0.008385181427001953
local_in_edges_tensor generation:  0.007757663726806641
mini_batch_src_global generation:  0.017085790634155273
r_  generation:  0.14168834686279297
local_output_nid generation:  0.007375478744506836
local_in_edges_tensor generation:  0.013140678405761719
mini_batch_src_global generation:  0.01642632484436035
r_  generation:  0.14316272735595703
local_output_nid generation:  0.009317159652709961
local_in_edges_tensor generation:  0.00821232795715332
mini_batch_src_global generation:  0.01596856117248535
r_  generation:  0.13513541221618652
local_output_nid generation:  0.007357597351074219
local_in_edges_tensor generation:  0.009538412094116211
mini_batch_src_global generation:  0.01694321632385254
r_  generation:  0.1340494155883789
local_output_nid generation:  0.007531642913818359
local_in_edges_tensor generation:  0.008365392684936523
mini_batch_src_global generation:  0.016314029693603516
r_  generation:  0.1867520809173584
local_output_nid generation:  0.0074481964111328125
local_in_edges_tensor generation:  0.008306026458740234
mini_batch_src_global generation:  0.018921613693237305
r_  generation:  0.13653278350830078
local_output_nid generation:  0.0075418949127197266
local_in_edges_tensor generation:  0.00944972038269043
mini_batch_src_global generation:  0.01928234100341797
r_  generation:  0.1497049331665039
local_output_nid generation:  0.013827323913574219
local_in_edges_tensor generation:  0.0077402591705322266
mini_batch_src_global generation:  0.0169217586517334
r_  generation:  0.1377706527709961
----------------------check_connections_block total spend ----------------------------- 6.486272811889648
generate_one_block  0.18119239807128906
generate_one_block  0.17138886451721191
generate_one_block  0.19916963577270508
generate_one_block  0.18073439598083496
generate_one_block  0.16017770767211914
generate_one_block  0.1761341094970703
generate_one_block  0.17097091674804688
generate_one_block  0.17768478393554688
generate_one_block  0.1649477481842041
generate_one_block  0.16085600852966309
generate_one_block  0.16399359703063965
generate_one_block  0.16394448280334473
generate_one_block  0.16637921333312988
generate_one_block  0.16007733345031738
generate_one_block  0.173234224319458
generate_one_block  0.19694113731384277
generate_one_block  0.16916155815124512
generate_one_block  0.16872000694274902
generate_one_block  0.1621084213256836
generate_one_block  0.16224932670593262
generate_one_block  0.17274260520935059
generate_one_block  0.17389345169067383
generate_one_block  0.1614370346069336
generate_one_block  0.1632683277130127
generate_one_block  0.17163610458374023
generate_one_block  0.15980839729309082
generate_one_block  0.15753793716430664
generate_one_block  0.16250014305114746
generate_one_block  0.16978812217712402
generate_one_block  0.16440868377685547
generate_one_block  0.16911959648132324
generate_one_block  0.16633272171020508
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04879903793334961
gen group dst list time:  0.09469199180603027
time for parepare:  0.01903843879699707
local_output_nid generation:  0.02127552032470703
local_in_edges_tensor generation:  0.05828356742858887
mini_batch_src_global generation:  0.03836870193481445
r_  generation:  0.390472412109375
local_output_nid generation:  0.027639389038085938
local_in_edges_tensor generation:  0.041147708892822266
mini_batch_src_global generation:  0.04975533485412598
r_  generation:  0.39717888832092285
local_output_nid generation:  0.02801990509033203
local_in_edges_tensor generation:  0.037847042083740234
mini_batch_src_global generation:  0.06184101104736328
r_  generation:  0.445568323135376
local_output_nid generation:  0.029458045959472656
local_in_edges_tensor generation:  0.040738582611083984
mini_batch_src_global generation:  0.06497669219970703
r_  generation:  0.40514540672302246
local_output_nid generation:  0.027636289596557617
local_in_edges_tensor generation:  0.04175758361816406
mini_batch_src_global generation:  0.0471646785736084
r_  generation:  0.40569519996643066
local_output_nid generation:  0.027362823486328125
local_in_edges_tensor generation:  0.04589033126831055
mini_batch_src_global generation:  0.04806780815124512
r_  generation:  0.4313204288482666
local_output_nid generation:  0.030379056930541992
local_in_edges_tensor generation:  0.03957700729370117
mini_batch_src_global generation:  0.04912543296813965
r_  generation:  0.4050867557525635
local_output_nid generation:  0.027369260787963867
local_in_edges_tensor generation:  0.0371856689453125
mini_batch_src_global generation:  0.05363011360168457
r_  generation:  0.41363048553466797
local_output_nid generation:  0.026992082595825195
local_in_edges_tensor generation:  0.03357505798339844
mini_batch_src_global generation:  0.04824018478393555
r_  generation:  0.4048326015472412
local_output_nid generation:  0.026943206787109375
local_in_edges_tensor generation:  0.029808998107910156
mini_batch_src_global generation:  0.047638893127441406
r_  generation:  0.4024808406829834
local_output_nid generation:  0.027989625930786133
local_in_edges_tensor generation:  0.02836918830871582
mini_batch_src_global generation:  0.05856013298034668
r_  generation:  0.4167792797088623
local_output_nid generation:  0.02905726432800293
local_in_edges_tensor generation:  0.0351870059967041
mini_batch_src_global generation:  0.050020694732666016
r_  generation:  0.40304064750671387
local_output_nid generation:  0.026943206787109375
local_in_edges_tensor generation:  0.03333425521850586
mini_batch_src_global generation:  0.049073219299316406
r_  generation:  0.40633058547973633
local_output_nid generation:  0.026929855346679688
local_in_edges_tensor generation:  0.02503228187561035
mini_batch_src_global generation:  0.04636335372924805
r_  generation:  0.39713573455810547
local_output_nid generation:  0.027111053466796875
local_in_edges_tensor generation:  0.028609037399291992
mini_batch_src_global generation:  0.06217312812805176
r_  generation:  0.40788793563842773
local_output_nid generation:  0.027008771896362305
local_in_edges_tensor generation:  0.03239727020263672
mini_batch_src_global generation:  0.0503849983215332
r_  generation:  0.4060020446777344
local_output_nid generation:  0.0276486873626709
local_in_edges_tensor generation:  0.03464555740356445
mini_batch_src_global generation:  0.049875736236572266
r_  generation:  0.42597126960754395
local_output_nid generation:  0.028935670852661133
local_in_edges_tensor generation:  0.03556036949157715
mini_batch_src_global generation:  0.0499722957611084
r_  generation:  0.4054398536682129
local_output_nid generation:  0.026755094528198242
local_in_edges_tensor generation:  0.031395912170410156
mini_batch_src_global generation:  0.04694342613220215
r_  generation:  0.40091776847839355
local_output_nid generation:  0.026668787002563477
local_in_edges_tensor generation:  0.02562117576599121
mini_batch_src_global generation:  0.04688096046447754
r_  generation:  0.40311241149902344
local_output_nid generation:  0.027356624603271484
local_in_edges_tensor generation:  0.032263755798339844
mini_batch_src_global generation:  0.046761274337768555
r_  generation:  0.40619659423828125
local_output_nid generation:  0.02745795249938965
local_in_edges_tensor generation:  0.032984256744384766
mini_batch_src_global generation:  0.04768252372741699
r_  generation:  0.4067983627319336
local_output_nid generation:  0.027100086212158203
local_in_edges_tensor generation:  0.024913549423217773
mini_batch_src_global generation:  0.04672431945800781
r_  generation:  0.40581846237182617
local_output_nid generation:  0.027538299560546875
local_in_edges_tensor generation:  0.02477884292602539
mini_batch_src_global generation:  0.05062413215637207
r_  generation:  0.4158179759979248
local_output_nid generation:  0.026971817016601562
local_in_edges_tensor generation:  0.03571653366088867
mini_batch_src_global generation:  0.047562599182128906
r_  generation:  0.4079406261444092
local_output_nid generation:  0.026637554168701172
local_in_edges_tensor generation:  0.02556586265563965
mini_batch_src_global generation:  0.047846078872680664
r_  generation:  0.3991363048553467
local_output_nid generation:  0.02687525749206543
local_in_edges_tensor generation:  0.025120973587036133
mini_batch_src_global generation:  0.04643821716308594
r_  generation:  0.408160924911499
local_output_nid generation:  0.02713632583618164
local_in_edges_tensor generation:  0.025527238845825195
mini_batch_src_global generation:  0.050919532775878906
r_  generation:  0.4004063606262207
local_output_nid generation:  0.027241230010986328
local_in_edges_tensor generation:  0.028771400451660156
mini_batch_src_global generation:  0.046564579010009766
r_  generation:  0.4063115119934082
local_output_nid generation:  0.026973724365234375
local_in_edges_tensor generation:  0.0405118465423584
mini_batch_src_global generation:  0.04700112342834473
r_  generation:  0.4018728733062744
local_output_nid generation:  0.02707982063293457
local_in_edges_tensor generation:  0.029039621353149414
mini_batch_src_global generation:  0.04987835884094238
r_  generation:  0.4062347412109375
local_output_nid generation:  0.02671360969543457
local_in_edges_tensor generation:  0.02512836456298828
mini_batch_src_global generation:  0.04773116111755371
r_  generation:  0.4021310806274414
----------------------check_connections_block total spend ----------------------------- 19.437261819839478
generate_one_block  0.6084051132202148
generate_one_block  0.5205614566802979
generate_one_block  0.5099334716796875
generate_one_block  0.5220112800598145
generate_one_block  0.510444164276123
generate_one_block  0.5279028415679932
generate_one_block  0.526104211807251
generate_one_block  0.526386022567749
generate_one_block  0.5334877967834473
generate_one_block  0.505695104598999
generate_one_block  0.5125048160552979
generate_one_block  0.5231490135192871
generate_one_block  0.5240645408630371
generate_one_block  0.502650260925293
generate_one_block  0.5330734252929688
generate_one_block  0.5115551948547363
generate_one_block  0.553076982498169
generate_one_block  0.5337460041046143
generate_one_block  0.5124566555023193
generate_one_block  0.5109434127807617
generate_one_block  0.5543999671936035
generate_one_block  0.563662052154541
generate_one_block  0.5331943035125732
generate_one_block  0.5318660736083984
generate_one_block  0.5311059951782227
generate_one_block  0.5285134315490723
generate_one_block  0.5262835025787354
generate_one_block  0.512204647064209
generate_one_block  0.5249466896057129
generate_one_block  0.5339574813842773
generate_one_block  0.5249195098876953
generate_one_block  0.5087881088256836
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

connection checking time:  25.923534631729126
block generation total time  22.304532527923584
average batch blocks generation time:  0.697016641497612
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1717529296875 GB
    Memory Allocated: 0.08181190490722656  GigaBytes
Max Memory Allocated: 0.08181190490722656  GigaBytes

torch.Size([145271, 128])
torch.Size([98893, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5252685546875 GB
    Memory Allocated: 0.19865131378173828  GigaBytes
Max Memory Allocated: 0.2032623291015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08237266540527344  GigaBytes
Max Memory Allocated: 0.22488117218017578  GigaBytes

torch.Size([145398, 128])
torch.Size([99212, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19824504852294922  GigaBytes
Max Memory Allocated: 0.22488117218017578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08327674865722656  GigaBytes
Max Memory Allocated: 0.22510671615600586  GigaBytes

torch.Size([145915, 128])
torch.Size([99403, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19860029220581055  GigaBytes
Max Memory Allocated: 0.22510671615600586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08336925506591797  GigaBytes
Max Memory Allocated: 0.2252507209777832  GigaBytes

torch.Size([145887, 128])
torch.Size([100212, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19987916946411133  GigaBytes
Max Memory Allocated: 0.2252507209777832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.0818624496459961  GigaBytes
Max Memory Allocated: 0.2266063690185547  GigaBytes

torch.Size([144816, 128])
torch.Size([97781, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19626998901367188  GigaBytes
Max Memory Allocated: 0.2266063690185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08234977722167969  GigaBytes
Max Memory Allocated: 0.2266063690185547  GigaBytes

torch.Size([145278, 128])
torch.Size([99388, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19891071319580078  GigaBytes
Max Memory Allocated: 0.2266063690185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08231306076049805  GigaBytes
Max Memory Allocated: 0.2266063690185547  GigaBytes

torch.Size([145157, 128])
torch.Size([99615, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.1984696388244629  GigaBytes
Max Memory Allocated: 0.2266063690185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08345222473144531  GigaBytes
Max Memory Allocated: 0.2266063690185547  GigaBytes

torch.Size([145603, 128])
torch.Size([100013, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.1999039649963379  GigaBytes
Max Memory Allocated: 0.2266063690185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08323097229003906  GigaBytes
Max Memory Allocated: 0.2266063690185547  GigaBytes

torch.Size([145800, 128])
torch.Size([99058, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19917058944702148  GigaBytes
Max Memory Allocated: 0.2266063690185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08207321166992188  GigaBytes
Max Memory Allocated: 0.2266063690185547  GigaBytes

torch.Size([145182, 128])
torch.Size([98112, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19660615921020508  GigaBytes
Max Memory Allocated: 0.2266063690185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08220338821411133  GigaBytes
Max Memory Allocated: 0.2266063690185547  GigaBytes

torch.Size([145207, 128])
torch.Size([98436, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19692707061767578  GigaBytes
Max Memory Allocated: 0.2266063690185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.0832223892211914  GigaBytes
Max Memory Allocated: 0.2266063690185547  GigaBytes

torch.Size([145468, 128])
torch.Size([98658, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19799518585205078  GigaBytes
Max Memory Allocated: 0.2266063690185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08332633972167969  GigaBytes
Max Memory Allocated: 0.2266063690185547  GigaBytes

torch.Size([145927, 128])
torch.Size([99490, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19942474365234375  GigaBytes
Max Memory Allocated: 0.2266063690185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08204507827758789  GigaBytes
Max Memory Allocated: 0.2266063690185547  GigaBytes

torch.Size([145119, 128])
torch.Size([98190, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19677209854125977  GigaBytes
Max Memory Allocated: 0.2266063690185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08344745635986328  GigaBytes
Max Memory Allocated: 0.2266063690185547  GigaBytes

torch.Size([145932, 128])
torch.Size([99924, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.20019149780273438  GigaBytes
Max Memory Allocated: 0.2266063690185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08235979080200195  GigaBytes
Max Memory Allocated: 0.2274951934814453  GigaBytes

torch.Size([145395, 128])
torch.Size([99431, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19851112365722656  GigaBytes
Max Memory Allocated: 0.2274951934814453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08345222473144531  GigaBytes
Max Memory Allocated: 0.2274951934814453  GigaBytes

torch.Size([145418, 128])
torch.Size([99894, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.20015192031860352  GigaBytes
Max Memory Allocated: 0.2274951934814453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08338737487792969  GigaBytes
Max Memory Allocated: 0.2275090217590332  GigaBytes

torch.Size([145742, 128])
torch.Size([99772, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.1999340057373047  GigaBytes
Max Memory Allocated: 0.2275090217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08203983306884766  GigaBytes
Max Memory Allocated: 0.2275090217590332  GigaBytes

torch.Size([144960, 128])
torch.Size([98271, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19649076461791992  GigaBytes
Max Memory Allocated: 0.2275090217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08330631256103516  GigaBytes
Max Memory Allocated: 0.2275090217590332  GigaBytes

torch.Size([145915, 128])
torch.Size([99557, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19952392578125  GigaBytes
Max Memory Allocated: 0.2275090217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.0834207534790039  GigaBytes
Max Memory Allocated: 0.2275090217590332  GigaBytes

torch.Size([145940, 128])
torch.Size([100100, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.20029592514038086  GigaBytes
Max Memory Allocated: 0.2275090217590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.083526611328125  GigaBytes
Max Memory Allocated: 0.2275218963623047  GigaBytes

torch.Size([145911, 128])
torch.Size([100592, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.20211553573608398  GigaBytes
Max Memory Allocated: 0.2275218963623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08326339721679688  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

torch.Size([145497, 128])
torch.Size([99333, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19939613342285156  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08335018157958984  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

torch.Size([145918, 128])
torch.Size([99655, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19959259033203125  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08346080780029297  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

torch.Size([145920, 128])
torch.Size([99987, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.20030879974365234  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08208703994750977  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

torch.Size([145197, 128])
torch.Size([98351, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19664478302001953  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08203840255737305  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

torch.Size([145153, 128])
torch.Size([98517, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.1963973045349121  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08323955535888672  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

torch.Size([145693, 128])
torch.Size([99159, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19824457168579102  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.0833120346069336  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

torch.Size([145748, 128])
torch.Size([99358, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19967269897460938  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08326244354248047  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

torch.Size([145620, 128])
torch.Size([98550, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19875526428222656  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08330249786376953  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

torch.Size([145565, 128])
torch.Size([99385, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19946575164794922  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.0832509994506836  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

torch.Size([145417, 128])
torch.Size([98535, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.1978907585144043  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030256524682044983 |0.022920623421669006 |0.02687281370162964 |9.371340274810791e-05 |0.0053978413343429565 |0.0019598007202148438 |
----------------------------------------------------------pseudo_mini_loss sum 5.32883358001709
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  8584266
Number of first layer input nodes during this epoch:  4656969
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.11114645004272461  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01998758316040039
random selection method range initialization spend 0.0064504146575927734
time for parepare:  0.018924951553344727
local_output_nid generation:  0.0012426376342773438
local_in_edges_tensor generation:  0.003679513931274414
mini_batch_src_global generation:  0.0017023086547851562
r_  generation:  0.008620977401733398
local_output_nid generation:  0.0014371871948242188
local_in_edges_tensor generation:  0.0009243488311767578
mini_batch_src_global generation:  0.00153350830078125
r_  generation:  0.008401632308959961
local_output_nid generation:  0.0015225410461425781
local_in_edges_tensor generation:  0.0008692741394042969
mini_batch_src_global generation:  0.0011091232299804688
r_  generation:  0.0076673030853271484
local_output_nid generation:  0.001486063003540039
local_in_edges_tensor generation:  0.0007910728454589844
mini_batch_src_global generation:  0.0010044574737548828
r_  generation:  0.0076830387115478516
local_output_nid generation:  0.0014340877532958984
local_in_edges_tensor generation:  0.0007638931274414062
mini_batch_src_global generation:  0.0009202957153320312
r_  generation:  0.009974479675292969
local_output_nid generation:  0.0014195442199707031
local_in_edges_tensor generation:  0.0007822513580322266
mini_batch_src_global generation:  0.0010249614715576172
r_  generation:  0.008212804794311523
local_output_nid generation:  0.0013985633850097656
local_in_edges_tensor generation:  0.0007588863372802734
mini_batch_src_global generation:  0.0008950233459472656
r_  generation:  0.007985115051269531
local_output_nid generation:  0.0014307498931884766
local_in_edges_tensor generation:  0.0007977485656738281
mini_batch_src_global generation:  0.0008602142333984375
r_  generation:  0.008104562759399414
local_output_nid generation:  0.0013947486877441406
local_in_edges_tensor generation:  0.0007281303405761719
mini_batch_src_global generation:  0.0008647441864013672
r_  generation:  0.007866382598876953
local_output_nid generation:  0.0013554096221923828
local_in_edges_tensor generation:  0.0007507801055908203
mini_batch_src_global generation:  0.0011246204376220703
r_  generation:  0.008137226104736328
local_output_nid generation:  0.0014345645904541016
local_in_edges_tensor generation:  0.0007753372192382812
mini_batch_src_global generation:  0.0008759498596191406
r_  generation:  0.008449792861938477
local_output_nid generation:  0.0013842582702636719
local_in_edges_tensor generation:  0.0007636547088623047
mini_batch_src_global generation:  0.0008981227874755859
r_  generation:  0.008692741394042969
local_output_nid generation:  0.0013852119445800781
local_in_edges_tensor generation:  0.0007429122924804688
mini_batch_src_global generation:  0.0008950233459472656
r_  generation:  0.010943412780761719
local_output_nid generation:  0.0014111995697021484
local_in_edges_tensor generation:  0.0007784366607666016
mini_batch_src_global generation:  0.0009222030639648438
r_  generation:  0.008638858795166016
local_output_nid generation:  0.0014140605926513672
local_in_edges_tensor generation:  0.0007784366607666016
mini_batch_src_global generation:  0.0008871555328369141
r_  generation:  0.00819087028503418
local_output_nid generation:  0.0014753341674804688
local_in_edges_tensor generation:  0.0007996559143066406
mini_batch_src_global generation:  0.0008778572082519531
r_  generation:  0.008034944534301758
local_output_nid generation:  0.0014081001281738281
local_in_edges_tensor generation:  0.0007648468017578125
mini_batch_src_global generation:  0.0009131431579589844
r_  generation:  0.008603811264038086
local_output_nid generation:  0.0014574527740478516
local_in_edges_tensor generation:  0.0007917881011962891
mini_batch_src_global generation:  0.0009126663208007812
r_  generation:  0.008283376693725586
local_output_nid generation:  0.001413583755493164
local_in_edges_tensor generation:  0.0007734298706054688
mini_batch_src_global generation:  0.0009202957153320312
r_  generation:  0.00853276252746582
local_output_nid generation:  0.0013954639434814453
local_in_edges_tensor generation:  0.0007443428039550781
mini_batch_src_global generation:  0.0008604526519775391
r_  generation:  0.008233070373535156
local_output_nid generation:  0.0014190673828125
local_in_edges_tensor generation:  0.0007543563842773438
mini_batch_src_global generation:  0.003893613815307617
r_  generation:  0.00810098648071289
local_output_nid generation:  0.0014078617095947266
local_in_edges_tensor generation:  0.0007750988006591797
mini_batch_src_global generation:  0.0009052753448486328
r_  generation:  0.008542299270629883
local_output_nid generation:  0.0014541149139404297
local_in_edges_tensor generation:  0.0007648468017578125
mini_batch_src_global generation:  0.0008981227874755859
r_  generation:  0.008432149887084961
local_output_nid generation:  0.0014061927795410156
local_in_edges_tensor generation:  0.000762939453125
mini_batch_src_global generation:  0.0009038448333740234
r_  generation:  0.008431673049926758
local_output_nid generation:  0.0014128684997558594
local_in_edges_tensor generation:  0.0007526874542236328
mini_batch_src_global generation:  0.0009138584136962891
r_  generation:  0.00831294059753418
local_output_nid generation:  0.0014004707336425781
local_in_edges_tensor generation:  0.0007507801055908203
mini_batch_src_global generation:  0.0008401870727539062
r_  generation:  0.0078089237213134766
local_output_nid generation:  0.0013883113861083984
local_in_edges_tensor generation:  0.0007576942443847656
mini_batch_src_global generation:  0.00086212158203125
r_  generation:  0.008184671401977539
local_output_nid generation:  0.0013861656188964844
local_in_edges_tensor generation:  0.000751495361328125
mini_batch_src_global generation:  0.0008788108825683594
r_  generation:  0.010675191879272461
local_output_nid generation:  0.0013916492462158203
local_in_edges_tensor generation:  0.0007750988006591797
mini_batch_src_global generation:  0.0008909702301025391
r_  generation:  0.008307695388793945
local_output_nid generation:  0.00140380859375
local_in_edges_tensor generation:  0.0007736682891845703
mini_batch_src_global generation:  0.0009007453918457031
r_  generation:  0.008175134658813477
local_output_nid generation:  0.0014224052429199219
local_in_edges_tensor generation:  0.0007717609405517578
mini_batch_src_global generation:  0.0008912086486816406
r_  generation:  0.009441852569580078
local_output_nid generation:  0.0014274120330810547
local_in_edges_tensor generation:  0.0007803440093994141
mini_batch_src_global generation:  0.0009059906005859375
r_  generation:  0.008322000503540039
----------------------check_connections_block total spend ----------------------------- 0.4782218933105469
generate_one_block  0.01755356788635254
generate_one_block  0.01600050926208496
generate_one_block  0.014656305313110352
generate_one_block  0.01268625259399414
generate_one_block  0.012974977493286133
generate_one_block  0.01317739486694336
generate_one_block  0.012761116027832031
generate_one_block  0.012814998626708984
generate_one_block  0.012647867202758789
generate_one_block  0.012883901596069336
generate_one_block  0.015022993087768555
generate_one_block  0.013945579528808594
generate_one_block  0.01291203498840332
generate_one_block  0.013437271118164062
generate_one_block  0.013019323348999023
generate_one_block  0.012891530990600586
generate_one_block  0.013493061065673828
generate_one_block  0.013024091720581055
generate_one_block  0.015982627868652344
generate_one_block  0.013046026229858398
generate_one_block  0.012824296951293945
generate_one_block  0.013531208038330078
generate_one_block  0.013383865356445312
generate_one_block  0.013136863708496094
generate_one_block  0.013219833374023438
generate_one_block  0.012682437896728516
generate_one_block  0.016431331634521484
generate_one_block  0.012871980667114258
generate_one_block  0.013072013854980469
generate_one_block  0.013273477554321289
generate_one_block  0.013631820678710938
generate_one_block  0.012992143630981445
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03835916519165039
gen group dst list time:  0.01934075355529785
time for parepare:  0.018884897232055664
local_output_nid generation:  0.004834413528442383
local_in_edges_tensor generation:  0.013039588928222656
mini_batch_src_global generation:  0.011873722076416016
r_  generation:  0.12400341033935547
local_output_nid generation:  0.008432865142822266
local_in_edges_tensor generation:  0.01645970344543457
mini_batch_src_global generation:  0.016655683517456055
r_  generation:  0.1334238052368164
local_output_nid generation:  0.009790897369384766
local_in_edges_tensor generation:  0.03357744216918945
mini_batch_src_global generation:  0.012976646423339844
r_  generation:  0.1214449405670166
local_output_nid generation:  0.007645606994628906
local_in_edges_tensor generation:  0.008362293243408203
mini_batch_src_global generation:  0.01354670524597168
r_  generation:  0.12763619422912598
local_output_nid generation:  0.00775909423828125
local_in_edges_tensor generation:  0.00843358039855957
mini_batch_src_global generation:  0.015716075897216797
r_  generation:  0.13305997848510742
local_output_nid generation:  0.0076580047607421875
local_in_edges_tensor generation:  0.009737253189086914
mini_batch_src_global generation:  0.015582799911499023
r_  generation:  0.13334083557128906
local_output_nid generation:  0.00730133056640625
local_in_edges_tensor generation:  0.0073773860931396484
mini_batch_src_global generation:  0.015331029891967773
r_  generation:  0.14011907577514648
local_output_nid generation:  0.00718379020690918
local_in_edges_tensor generation:  0.00730586051940918
mini_batch_src_global generation:  0.01657700538635254
r_  generation:  0.13234591484069824
local_output_nid generation:  0.007230520248413086
local_in_edges_tensor generation:  0.00934910774230957
mini_batch_src_global generation:  0.015497684478759766
r_  generation:  0.13252639770507812
local_output_nid generation:  0.007339000701904297
local_in_edges_tensor generation:  0.008447408676147461
mini_batch_src_global generation:  0.015541791915893555
r_  generation:  0.16560888290405273
local_output_nid generation:  0.012335538864135742
local_in_edges_tensor generation:  0.012566089630126953
mini_batch_src_global generation:  0.019940614700317383
r_  generation:  0.1538691520690918
local_output_nid generation:  0.013270854949951172
local_in_edges_tensor generation:  0.014360904693603516
mini_batch_src_global generation:  0.02395796775817871
r_  generation:  0.14665436744689941
local_output_nid generation:  0.010844945907592773
local_in_edges_tensor generation:  0.010384321212768555
mini_batch_src_global generation:  0.016455888748168945
r_  generation:  0.13600611686706543
local_output_nid generation:  0.014957904815673828
local_in_edges_tensor generation:  0.016765832901000977
mini_batch_src_global generation:  0.02280259132385254
r_  generation:  0.1405341625213623
local_output_nid generation:  0.008309364318847656
local_in_edges_tensor generation:  0.009620189666748047
mini_batch_src_global generation:  0.01644754409790039
r_  generation:  0.17474889755249023
local_output_nid generation:  0.008063077926635742
local_in_edges_tensor generation:  0.008415937423706055
mini_batch_src_global generation:  0.01602935791015625
r_  generation:  0.14042353630065918
local_output_nid generation:  0.008315563201904297
local_in_edges_tensor generation:  0.00906682014465332
mini_batch_src_global generation:  0.017017841339111328
r_  generation:  0.14311575889587402
local_output_nid generation:  0.00799417495727539
local_in_edges_tensor generation:  0.010560750961303711
mini_batch_src_global generation:  0.01680302619934082
r_  generation:  0.1358480453491211
local_output_nid generation:  0.008120298385620117
local_in_edges_tensor generation:  0.00787353515625
mini_batch_src_global generation:  0.016859054565429688
r_  generation:  0.14229869842529297
local_output_nid generation:  0.008734464645385742
local_in_edges_tensor generation:  0.012624740600585938
mini_batch_src_global generation:  0.031228303909301758
r_  generation:  0.13549542427062988
local_output_nid generation:  0.009009599685668945
local_in_edges_tensor generation:  0.009417295455932617
mini_batch_src_global generation:  0.01712799072265625
r_  generation:  0.13436079025268555
local_output_nid generation:  0.00803685188293457
local_in_edges_tensor generation:  0.009769201278686523
mini_batch_src_global generation:  0.017667531967163086
r_  generation:  0.1402726173400879
local_output_nid generation:  0.007689237594604492
local_in_edges_tensor generation:  0.007613658905029297
mini_batch_src_global generation:  0.018359661102294922
r_  generation:  0.13892865180969238
local_output_nid generation:  0.007572650909423828
local_in_edges_tensor generation:  0.009720802307128906
mini_batch_src_global generation:  0.016634225845336914
r_  generation:  0.137312650680542
local_output_nid generation:  0.00767207145690918
local_in_edges_tensor generation:  0.0075266361236572266
mini_batch_src_global generation:  0.016382694244384766
r_  generation:  0.13502168655395508
local_output_nid generation:  0.007214546203613281
local_in_edges_tensor generation:  0.007139444351196289
mini_batch_src_global generation:  0.015903711318969727
r_  generation:  0.13317513465881348
local_output_nid generation:  0.007542848587036133
local_in_edges_tensor generation:  0.0073926448822021484
mini_batch_src_global generation:  0.017238378524780273
r_  generation:  0.13648247718811035
local_output_nid generation:  0.007315635681152344
local_in_edges_tensor generation:  0.008186101913452148
mini_batch_src_global generation:  0.01601123809814453
r_  generation:  0.13077926635742188
local_output_nid generation:  0.007586956024169922
local_in_edges_tensor generation:  0.00852513313293457
mini_batch_src_global generation:  0.01731276512145996
r_  generation:  0.13528823852539062
local_output_nid generation:  0.007454872131347656
local_in_edges_tensor generation:  0.008486032485961914
mini_batch_src_global generation:  0.01947951316833496
r_  generation:  0.13820409774780273
local_output_nid generation:  0.008483409881591797
local_in_edges_tensor generation:  0.0164945125579834
mini_batch_src_global generation:  0.017287015914916992
r_  generation:  0.1694316864013672
local_output_nid generation:  0.0074999332427978516
local_in_edges_tensor generation:  0.009178638458251953
mini_batch_src_global generation:  0.01770162582397461
r_  generation:  0.1712656021118164
----------------------check_connections_block total spend ----------------------------- 6.757760286331177
generate_one_block  0.18532752990722656
generate_one_block  0.16518807411193848
generate_one_block  0.16388916969299316
generate_one_block  0.16794133186340332
generate_one_block  0.18343329429626465
generate_one_block  0.16947722434997559
generate_one_block  0.1620640754699707
generate_one_block  0.1623544692993164
generate_one_block  0.1591191291809082
generate_one_block  0.16074657440185547
generate_one_block  0.17193078994750977
generate_one_block  0.175523042678833
generate_one_block  0.16683006286621094
generate_one_block  0.17232871055603027
generate_one_block  0.16153311729431152
generate_one_block  0.1627652645111084
generate_one_block  0.17964506149291992
generate_one_block  0.16606879234313965
generate_one_block  0.17289423942565918
generate_one_block  0.19196224212646484
generate_one_block  0.1698153018951416
generate_one_block  0.17174601554870605
generate_one_block  0.18172192573547363
generate_one_block  0.16876864433288574
generate_one_block  0.16843700408935547
generate_one_block  0.1585407257080078
generate_one_block  0.1654961109161377
generate_one_block  0.16040349006652832
generate_one_block  0.1803591251373291
generate_one_block  0.17049622535705566
generate_one_block  0.17484784126281738
generate_one_block  0.16915178298950195
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04013252258300781
gen group dst list time:  0.09990239143371582
time for parepare:  0.01748967170715332
local_output_nid generation:  0.02261805534362793
local_in_edges_tensor generation:  0.049344539642333984
mini_batch_src_global generation:  0.036049604415893555
r_  generation:  0.3994932174682617
local_output_nid generation:  0.03447604179382324
local_in_edges_tensor generation:  0.040833234786987305
mini_batch_src_global generation:  0.04746222496032715
r_  generation:  0.397144079208374
local_output_nid generation:  0.02790999412536621
local_in_edges_tensor generation:  0.03125357627868652
mini_batch_src_global generation:  0.04581117630004883
r_  generation:  0.39091014862060547
local_output_nid generation:  0.027074337005615234
local_in_edges_tensor generation:  0.030501365661621094
mini_batch_src_global generation:  0.04625082015991211
r_  generation:  0.3882911205291748
local_output_nid generation:  0.026929616928100586
local_in_edges_tensor generation:  0.03507733345031738
mini_batch_src_global generation:  0.04651832580566406
r_  generation:  0.3996436595916748
local_output_nid generation:  0.02695155143737793
local_in_edges_tensor generation:  0.024498939514160156
mini_batch_src_global generation:  0.04715466499328613
r_  generation:  0.4079623222351074
local_output_nid generation:  0.026813268661499023
local_in_edges_tensor generation:  0.02732682228088379
mini_batch_src_global generation:  0.046556949615478516
r_  generation:  0.395366907119751
local_output_nid generation:  0.0270688533782959
local_in_edges_tensor generation:  0.027938127517700195
mini_batch_src_global generation:  0.04989933967590332
r_  generation:  0.39473891258239746
local_output_nid generation:  0.026866674423217773
local_in_edges_tensor generation:  0.02805018424987793
mini_batch_src_global generation:  0.04662036895751953
r_  generation:  0.39879608154296875
local_output_nid generation:  0.027048349380493164
local_in_edges_tensor generation:  0.03161144256591797
mini_batch_src_global generation:  0.04703402519226074
r_  generation:  0.39679574966430664
local_output_nid generation:  0.02744317054748535
local_in_edges_tensor generation:  0.028642892837524414
mini_batch_src_global generation:  0.04709959030151367
r_  generation:  0.4077887535095215
local_output_nid generation:  0.027149200439453125
local_in_edges_tensor generation:  0.03198647499084473
mini_batch_src_global generation:  0.047975778579711914
r_  generation:  0.4031050205230713
local_output_nid generation:  0.026996135711669922
local_in_edges_tensor generation:  0.024911165237426758
mini_batch_src_global generation:  0.04730963706970215
r_  generation:  0.41056370735168457
local_output_nid generation:  0.027243852615356445
local_in_edges_tensor generation:  0.02794027328491211
mini_batch_src_global generation:  0.04767251014709473
r_  generation:  0.40255165100097656
local_output_nid generation:  0.03156399726867676
local_in_edges_tensor generation:  0.030918121337890625
mini_batch_src_global generation:  0.04782557487487793
r_  generation:  0.4008817672729492
local_output_nid generation:  0.027010679244995117
local_in_edges_tensor generation:  0.027791261672973633
mini_batch_src_global generation:  0.050420522689819336
r_  generation:  0.40313172340393066
local_output_nid generation:  0.027594327926635742
local_in_edges_tensor generation:  0.03215956687927246
mini_batch_src_global generation:  0.04697418212890625
r_  generation:  0.41111159324645996
local_output_nid generation:  0.028231143951416016
local_in_edges_tensor generation:  0.03429698944091797
mini_batch_src_global generation:  0.047385454177856445
r_  generation:  0.40048789978027344
local_output_nid generation:  0.027466297149658203
local_in_edges_tensor generation:  0.03296828269958496
mini_batch_src_global generation:  0.06365776062011719
r_  generation:  0.40862059593200684
local_output_nid generation:  0.027610063552856445
local_in_edges_tensor generation:  0.03218984603881836
mini_batch_src_global generation:  0.04734921455383301
r_  generation:  0.40163326263427734
local_output_nid generation:  0.02865457534790039
local_in_edges_tensor generation:  0.028098106384277344
mini_batch_src_global generation:  0.048224687576293945
r_  generation:  0.40474581718444824
local_output_nid generation:  0.027734994888305664
local_in_edges_tensor generation:  0.02806878089904785
mini_batch_src_global generation:  0.04775667190551758
r_  generation:  0.4202311038970947
local_output_nid generation:  0.02751326560974121
local_in_edges_tensor generation:  0.03200101852416992
mini_batch_src_global generation:  0.046758413314819336
r_  generation:  0.4097447395324707
local_output_nid generation:  0.027353525161743164
local_in_edges_tensor generation:  0.024908781051635742
mini_batch_src_global generation:  0.04719948768615723
r_  generation:  0.4042937755584717
local_output_nid generation:  0.027411460876464844
local_in_edges_tensor generation:  0.02821040153503418
mini_batch_src_global generation:  0.04736638069152832
r_  generation:  0.40714430809020996
local_output_nid generation:  0.026993989944458008
local_in_edges_tensor generation:  0.024129629135131836
mini_batch_src_global generation:  0.04742765426635742
r_  generation:  0.39955973625183105
local_output_nid generation:  0.027059555053710938
local_in_edges_tensor generation:  0.027678966522216797
mini_batch_src_global generation:  0.06373000144958496
r_  generation:  0.400834321975708
local_output_nid generation:  0.02669382095336914
local_in_edges_tensor generation:  0.02735304832458496
mini_batch_src_global generation:  0.04673576354980469
r_  generation:  0.39482545852661133
local_output_nid generation:  0.027432680130004883
local_in_edges_tensor generation:  0.03174233436584473
mini_batch_src_global generation:  0.04689502716064453
r_  generation:  0.4088163375854492
local_output_nid generation:  0.026784420013427734
local_in_edges_tensor generation:  0.03374218940734863
mini_batch_src_global generation:  0.049634456634521484
r_  generation:  0.41304588317871094
local_output_nid generation:  0.028589248657226562
local_in_edges_tensor generation:  0.031244516372680664
mini_batch_src_global generation:  0.055960893630981445
r_  generation:  0.41294217109680176
local_output_nid generation:  0.02731490135192871
local_in_edges_tensor generation:  0.02842235565185547
mini_batch_src_global generation:  0.06356334686279297
r_  generation:  0.4073925018310547
----------------------check_connections_block total spend ----------------------------- 19.141789436340332
generate_one_block  0.5292856693267822
generate_one_block  0.5218956470489502
generate_one_block  0.5089988708496094
generate_one_block  0.511669397354126
generate_one_block  0.6175615787506104
generate_one_block  0.5278098583221436
generate_one_block  0.5270054340362549
generate_one_block  0.5165066719055176
generate_one_block  0.5127153396606445
generate_one_block  0.518014669418335
generate_one_block  0.5357482433319092
generate_one_block  0.5286657810211182
generate_one_block  0.5079391002655029
generate_one_block  0.5170583724975586
generate_one_block  0.5145995616912842
generate_one_block  0.5169389247894287
generate_one_block  0.5362141132354736
generate_one_block  0.5115463733673096
generate_one_block  0.5255908966064453
generate_one_block  0.5077648162841797
generate_one_block  0.519690752029419
generate_one_block  0.5245940685272217
generate_one_block  0.5318222045898438
generate_one_block  0.5145657062530518
generate_one_block  0.5421631336212158
generate_one_block  0.5097787380218506
generate_one_block  0.5154473781585693
generate_one_block  0.5023312568664551
generate_one_block  0.524083137512207
generate_one_block  0.5241050720214844
generate_one_block  0.540433406829834
generate_one_block  0.5093183517456055
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.11114645004272461  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

connection checking time:  25.89954972267151
block generation total time  22.192668914794922
average batch blocks generation time:  0.6935209035873413
block dataloader generation time/epoch 50.41335320472717
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08364439010620117  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

torch.Size([145507, 128])
torch.Size([99511, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.20017051696777344  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08357810974121094  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

torch.Size([145472, 128])
torch.Size([99402, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19962167739868164  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08327960968017578  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

torch.Size([145445, 128])
torch.Size([98287, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.1976332664489746  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08221626281738281  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

torch.Size([145296, 128])
torch.Size([98167, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19683122634887695  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08228111267089844  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

torch.Size([144942, 128])
torch.Size([98549, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19689273834228516  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08224201202392578  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

torch.Size([144670, 128])
torch.Size([99004, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.1984095573425293  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.0820918083190918  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

torch.Size([144781, 128])
torch.Size([97866, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19666051864624023  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08243513107299805  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

torch.Size([145357, 128])
torch.Size([98851, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19704818725585938  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08336639404296875  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

torch.Size([145570, 128])
torch.Size([98832, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19806623458862305  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08341789245605469  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

torch.Size([145543, 128])
torch.Size([99229, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19840717315673828  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08370590209960938  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

torch.Size([145978, 128])
torch.Size([100530, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.2011723518371582  GigaBytes
Max Memory Allocated: 0.22846508026123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.0837564468383789  GigaBytes
Max Memory Allocated: 0.2288074493408203  GigaBytes

torch.Size([145500, 128])
torch.Size([99943, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.20070743560791016  GigaBytes
Max Memory Allocated: 0.2288074493408203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08236265182495117  GigaBytes
Max Memory Allocated: 0.2288074493408203  GigaBytes

torch.Size([145131, 128])
torch.Size([98500, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19707679748535156  GigaBytes
Max Memory Allocated: 0.2288074493408203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08363819122314453  GigaBytes
Max Memory Allocated: 0.2288074493408203  GigaBytes

torch.Size([146184, 128])
torch.Size([100151, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.20052576065063477  GigaBytes
Max Memory Allocated: 0.2288074493408203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08237123489379883  GigaBytes
Max Memory Allocated: 0.2288074493408203  GigaBytes

torch.Size([145277, 128])
torch.Size([98582, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.1969304084777832  GigaBytes
Max Memory Allocated: 0.2288074493408203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08245706558227539  GigaBytes
Max Memory Allocated: 0.2288074493408203  GigaBytes

torch.Size([145343, 128])
torch.Size([98859, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.1979665756225586  GigaBytes
Max Memory Allocated: 0.2288074493408203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08375358581542969  GigaBytes
Max Memory Allocated: 0.2288074493408203  GigaBytes

torch.Size([146005, 128])
torch.Size([100721, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.20244550704956055  GigaBytes
Max Memory Allocated: 0.2288074493408203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08354759216308594  GigaBytes
Max Memory Allocated: 0.22882080078125  GigaBytes

torch.Size([145450, 128])
torch.Size([99272, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.1996464729309082  GigaBytes
Max Memory Allocated: 0.22882080078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.0837259292602539  GigaBytes
Max Memory Allocated: 0.22882080078125  GigaBytes

torch.Size([146113, 128])
torch.Size([99914, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.2005939483642578  GigaBytes
Max Memory Allocated: 0.22882080078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08226537704467773  GigaBytes
Max Memory Allocated: 0.22882080078125  GigaBytes

torch.Size([144997, 128])
torch.Size([98327, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.1970529556274414  GigaBytes
Max Memory Allocated: 0.22882080078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08231496810913086  GigaBytes
Max Memory Allocated: 0.22882080078125  GigaBytes

torch.Size([144925, 128])
torch.Size([98787, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.1977710723876953  GigaBytes
Max Memory Allocated: 0.22882080078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08371639251708984  GigaBytes
Max Memory Allocated: 0.22882080078125  GigaBytes

torch.Size([145613, 128])
torch.Size([99776, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.20061254501342773  GigaBytes
Max Memory Allocated: 0.22882080078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08367729187011719  GigaBytes
Max Memory Allocated: 0.22882080078125  GigaBytes

torch.Size([145655, 128])
torch.Size([99807, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.2004547119140625  GigaBytes
Max Memory Allocated: 0.22882080078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08262109756469727  GigaBytes
Max Memory Allocated: 0.22882080078125  GigaBytes

torch.Size([145391, 128])
torch.Size([99670, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19927358627319336  GigaBytes
Max Memory Allocated: 0.22882080078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08361148834228516  GigaBytes
Max Memory Allocated: 0.22882080078125  GigaBytes

torch.Size([146038, 128])
torch.Size([100066, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.20028400421142578  GigaBytes
Max Memory Allocated: 0.22882080078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08226585388183594  GigaBytes
Max Memory Allocated: 0.22882080078125  GigaBytes

torch.Size([145090, 128])
torch.Size([98199, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19633245468139648  GigaBytes
Max Memory Allocated: 0.22882080078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08240938186645508  GigaBytes
Max Memory Allocated: 0.22882080078125  GigaBytes

torch.Size([145219, 128])
torch.Size([98688, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19735002517700195  GigaBytes
Max Memory Allocated: 0.22882080078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08188343048095703  GigaBytes
Max Memory Allocated: 0.22882080078125  GigaBytes

torch.Size([144510, 128])
torch.Size([97197, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19636106491088867  GigaBytes
Max Memory Allocated: 0.22882080078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08359622955322266  GigaBytes
Max Memory Allocated: 0.22882080078125  GigaBytes

torch.Size([145902, 128])
torch.Size([99679, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.1996612548828125  GigaBytes
Max Memory Allocated: 0.22882080078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08212137222290039  GigaBytes
Max Memory Allocated: 0.22882080078125  GigaBytes

torch.Size([144264, 128])
torch.Size([97802, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.19816160202026367  GigaBytes
Max Memory Allocated: 0.22882080078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.0837850570678711  GigaBytes
Max Memory Allocated: 0.22882080078125  GigaBytes

torch.Size([145738, 128])
torch.Size([100168, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.20085382461547852  GigaBytes
Max Memory Allocated: 0.22882080078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.08350753784179688  GigaBytes
Max Memory Allocated: 0.22882080078125  GigaBytes

torch.Size([145493, 128])
torch.Size([99405, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.1995692253112793  GigaBytes
Max Memory Allocated: 0.22882080078125  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.028758935630321503 |0.00901072472333908 |0.0037689507007598877 |9.120255708694458e-05 |0.004650108516216278 |0.0013058185577392578 |
----------------------------------------------------------pseudo_mini_loss sum 4.091458797454834
Total (block generation + training)time/epoch 51.94168138504028
Training time/epoch 1.5280373096466064
Training time without block to device /epoch 1.2396941184997559
Training time without total dataloading part /epoch 0.2736341953277588
load block tensor time/epoch 0.9202859401702881
block to device time/epoch 0.2883431911468506
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  8575852
Number of first layer input nodes during this epoch:  4652399
