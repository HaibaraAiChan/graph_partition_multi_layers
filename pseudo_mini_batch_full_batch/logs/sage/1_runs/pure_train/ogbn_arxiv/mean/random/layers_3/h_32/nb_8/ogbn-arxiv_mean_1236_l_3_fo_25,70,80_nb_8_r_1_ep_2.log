Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648438367.5522654
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02701401710510254
random selection method range initialization spend 0.006258487701416016
time for parepare:  0.01831364631652832
local_output_nid generation:  0.004171848297119141
local_in_edges_tensor generation:  0.006733894348144531
mini_batch_src_global generation:  0.0037572383880615234
r_  generation:  0.04167509078979492
local_output_nid generation:  0.005762815475463867
local_in_edges_tensor generation:  0.0033409595489501953
mini_batch_src_global generation:  0.004752635955810547
r_  generation:  0.04400920867919922
local_output_nid generation:  0.006072044372558594
local_in_edges_tensor generation:  0.0033004283905029297
mini_batch_src_global generation:  0.003243684768676758
r_  generation:  0.04460597038269043
local_output_nid generation:  0.00616908073425293
local_in_edges_tensor generation:  0.0033745765686035156
mini_batch_src_global generation:  0.0033555030822753906
r_  generation:  0.04551100730895996
local_output_nid generation:  0.006194114685058594
local_in_edges_tensor generation:  0.0032224655151367188
mini_batch_src_global generation:  0.0037071704864501953
r_  generation:  0.04649972915649414
local_output_nid generation:  0.006155729293823242
local_in_edges_tensor generation:  0.003292560577392578
mini_batch_src_global generation:  0.0037500858306884766
r_  generation:  0.046013593673706055
local_output_nid generation:  0.006107330322265625
local_in_edges_tensor generation:  0.0031690597534179688
mini_batch_src_global generation:  0.004025697708129883
r_  generation:  0.04611325263977051
local_output_nid generation:  0.006155252456665039
local_in_edges_tensor generation:  0.003293275833129883
mini_batch_src_global generation:  0.0038280487060546875
r_  generation:  0.04555773735046387
----------------------check_connections_block total spend ----------------------------- 0.5689246654510498
generate_one_block  0.06179642677307129
generate_one_block  0.06268191337585449
generate_one_block  0.062293291091918945
generate_one_block  0.06097698211669922
generate_one_block  0.06534266471862793
generate_one_block  0.06166958808898926
generate_one_block  0.0606691837310791
generate_one_block  0.05930209159851074
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.044606685638427734
gen group dst list time:  0.0160977840423584
time for parepare:  0.020049095153808594
local_output_nid generation:  0.014586448669433594
local_in_edges_tensor generation:  0.036296844482421875
mini_batch_src_global generation:  0.03538942337036133
r_  generation:  0.35132527351379395
local_output_nid generation:  0.02371692657470703
local_in_edges_tensor generation:  0.03668332099914551
mini_batch_src_global generation:  0.044321537017822266
r_  generation:  0.3730888366699219
local_output_nid generation:  0.02386927604675293
local_in_edges_tensor generation:  0.026340484619140625
mini_batch_src_global generation:  0.044149160385131836
r_  generation:  0.38244128227233887
local_output_nid generation:  0.023254871368408203
local_in_edges_tensor generation:  0.029055118560791016
mini_batch_src_global generation:  0.04516863822937012
r_  generation:  0.37520790100097656
local_output_nid generation:  0.02378702163696289
local_in_edges_tensor generation:  0.029516220092773438
mini_batch_src_global generation:  0.04569673538208008
r_  generation:  0.3786649703979492
local_output_nid generation:  0.02419900894165039
local_in_edges_tensor generation:  0.02517223358154297
mini_batch_src_global generation:  0.045993804931640625
r_  generation:  0.3796117305755615
local_output_nid generation:  0.02385568618774414
local_in_edges_tensor generation:  0.025424718856811523
mini_batch_src_global generation:  0.04574275016784668
r_  generation:  0.38085055351257324
local_output_nid generation:  0.023862361907958984
local_in_edges_tensor generation:  0.025126934051513672
mini_batch_src_global generation:  0.046473026275634766
r_  generation:  0.37247586250305176
----------------------check_connections_block total spend ----------------------------- 4.412688255310059
generate_one_block  0.4923858642578125
generate_one_block  0.5076990127563477
generate_one_block  0.502610445022583
generate_one_block  0.49448084831237793
generate_one_block  0.505072832107544
generate_one_block  0.5177862644195557
generate_one_block  0.5008509159088135
generate_one_block  0.4940218925476074
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03260540962219238
gen group dst list time:  0.0374295711517334
time for parepare:  0.01970052719116211
local_output_nid generation:  0.028693437576293945
local_in_edges_tensor generation:  0.044653892517089844
mini_batch_src_global generation:  0.04505419731140137
r_  generation:  0.4826478958129883
local_output_nid generation:  0.03549647331237793
local_in_edges_tensor generation:  0.04897451400756836
mini_batch_src_global generation:  0.05437469482421875
r_  generation:  0.4914216995239258
local_output_nid generation:  0.03505349159240723
local_in_edges_tensor generation:  0.04223155975341797
mini_batch_src_global generation:  0.05419564247131348
r_  generation:  0.48617076873779297
local_output_nid generation:  0.035254716873168945
local_in_edges_tensor generation:  0.03817939758300781
mini_batch_src_global generation:  0.05297255516052246
r_  generation:  0.5012755393981934
local_output_nid generation:  0.035299062728881836
local_in_edges_tensor generation:  0.0414886474609375
mini_batch_src_global generation:  0.0566096305847168
r_  generation:  0.4978952407836914
local_output_nid generation:  0.03502297401428223
local_in_edges_tensor generation:  0.034322500228881836
mini_batch_src_global generation:  0.053141117095947266
r_  generation:  0.5017461776733398
local_output_nid generation:  0.0354306697845459
local_in_edges_tensor generation:  0.0375368595123291
mini_batch_src_global generation:  0.05404162406921387
r_  generation:  0.5019817352294922
local_output_nid generation:  0.03541851043701172
local_in_edges_tensor generation:  0.03599739074707031
mini_batch_src_global generation:  0.054155826568603516
r_  generation:  0.5057461261749268
----------------------check_connections_block total spend ----------------------------- 5.892978668212891
generate_one_block  0.6125128269195557
generate_one_block  0.6279819011688232
generate_one_block  0.6190919876098633
generate_one_block  0.6221127510070801
generate_one_block  0.6237871646881104
generate_one_block  0.6178195476531982
generate_one_block  0.6419157981872559
generate_one_block  0.6107137203216553
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

connection checking time:  10.30566692352295
block generation total time  8.990843772888184
average batch blocks generation time:  1.123855471611023
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.09952831268310547  GigaBytes
Max Memory Allocated: 0.09952831268310547  GigaBytes

torch.Size([161964, 128])
torch.Size([145333, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5252685546875 GB
    Memory Allocated: 0.2214818000793457  GigaBytes
Max Memory Allocated: 0.2241506576538086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.10190916061401367  GigaBytes
Max Memory Allocated: 0.23671340942382812  GigaBytes

torch.Size([162430, 128])
torch.Size([146515, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.2256159782409668  GigaBytes
Max Memory Allocated: 0.23671340942382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.10215234756469727  GigaBytes
Max Memory Allocated: 0.24091482162475586  GigaBytes

torch.Size([162021, 128])
torch.Size([145843, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.2235550880432129  GigaBytes
Max Memory Allocated: 0.24091482162475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.10195636749267578  GigaBytes
Max Memory Allocated: 0.24091482162475586  GigaBytes

torch.Size([162241, 128])
torch.Size([146143, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.2235269546508789  GigaBytes
Max Memory Allocated: 0.24091482162475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.1021432876586914  GigaBytes
Max Memory Allocated: 0.24091482162475586  GigaBytes

torch.Size([162164, 128])
torch.Size([145880, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.22359657287597656  GigaBytes
Max Memory Allocated: 0.24091482162475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.10196113586425781  GigaBytes
Max Memory Allocated: 0.24091482162475586  GigaBytes

torch.Size([162214, 128])
torch.Size([145899, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.22358989715576172  GigaBytes
Max Memory Allocated: 0.24091482162475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.10190963745117188  GigaBytes
Max Memory Allocated: 0.24091482162475586  GigaBytes

torch.Size([162120, 128])
torch.Size([146051, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.223419189453125  GigaBytes
Max Memory Allocated: 0.24091482162475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.10187244415283203  GigaBytes
Max Memory Allocated: 0.24091482162475586  GigaBytes

torch.Size([162146, 128])
torch.Size([146040, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.2221670150756836  GigaBytes
Max Memory Allocated: 0.24091482162475586  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03673344850540161 |0.054046839475631714 |0.09357181191444397 |0.00010320544242858887 |0.009210795164108276 |0.0021626949310302734 |
----------------------------------------------------------pseudo_mini_loss sum 5.010550022125244
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3053916
Number of first layer input nodes during this epoch:  1297300
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.14703655242919922  GigaBytes
Max Memory Allocated: 0.24091482162475586  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027853727340698242
random selection method range initialization spend 0.005301713943481445
time for parepare:  0.017652511596679688
local_output_nid generation:  0.0045201778411865234
local_in_edges_tensor generation:  0.009485960006713867
mini_batch_src_global generation:  0.0036644935607910156
r_  generation:  0.0410611629486084
local_output_nid generation:  0.005955696105957031
local_in_edges_tensor generation:  0.003185272216796875
mini_batch_src_global generation:  0.004860877990722656
r_  generation:  0.04424643516540527
local_output_nid generation:  0.006049394607543945
local_in_edges_tensor generation:  0.0032372474670410156
mini_batch_src_global generation:  0.0032355785369873047
r_  generation:  0.04559636116027832
local_output_nid generation:  0.006070852279663086
local_in_edges_tensor generation:  0.003309965133666992
mini_batch_src_global generation:  0.0035169124603271484
r_  generation:  0.0459742546081543
local_output_nid generation:  0.006099700927734375
local_in_edges_tensor generation:  0.0031991004943847656
mini_batch_src_global generation:  0.0038428306579589844
r_  generation:  0.046803951263427734
local_output_nid generation:  0.00614476203918457
local_in_edges_tensor generation:  0.0032896995544433594
mini_batch_src_global generation:  0.004194974899291992
r_  generation:  0.048157691955566406
local_output_nid generation:  0.006084442138671875
local_in_edges_tensor generation:  0.003262758255004883
mini_batch_src_global generation:  0.0039827823638916016
r_  generation:  0.04794764518737793
local_output_nid generation:  0.0061168670654296875
local_in_edges_tensor generation:  0.0032346248626708984
mini_batch_src_global generation:  0.004093647003173828
r_  generation:  0.048349618911743164
----------------------check_connections_block total spend ----------------------------- 0.5825581550598145
generate_one_block  0.05917859077453613
generate_one_block  0.06239056587219238
generate_one_block  0.06305098533630371
generate_one_block  0.06258630752563477
generate_one_block  0.06345725059509277
generate_one_block  0.0637350082397461
generate_one_block  0.06638526916503906
generate_one_block  0.06322145462036133
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03959083557128906
gen group dst list time:  0.01648998260498047
time for parepare:  0.019149065017700195
local_output_nid generation:  0.014689445495605469
local_in_edges_tensor generation:  0.03705906867980957
mini_batch_src_global generation:  0.038234710693359375
r_  generation:  0.35256004333496094
local_output_nid generation:  0.0205533504486084
local_in_edges_tensor generation:  0.03388071060180664
mini_batch_src_global generation:  0.04801440238952637
r_  generation:  0.37717556953430176
local_output_nid generation:  0.019576072692871094
local_in_edges_tensor generation:  0.028441905975341797
mini_batch_src_global generation:  0.04455375671386719
r_  generation:  0.3791160583496094
local_output_nid generation:  0.01944446563720703
local_in_edges_tensor generation:  0.025471925735473633
mini_batch_src_global generation:  0.0482478141784668
r_  generation:  0.3829326629638672
local_output_nid generation:  0.01968526840209961
local_in_edges_tensor generation:  0.02772831916809082
mini_batch_src_global generation:  0.046064138412475586
r_  generation:  0.38784027099609375
local_output_nid generation:  0.019829750061035156
local_in_edges_tensor generation:  0.024265766143798828
mini_batch_src_global generation:  0.05031847953796387
r_  generation:  0.3899416923522949
local_output_nid generation:  0.022151947021484375
local_in_edges_tensor generation:  0.021272659301757812
mini_batch_src_global generation:  0.04693269729614258
r_  generation:  0.3895425796508789
local_output_nid generation:  0.01969742774963379
local_in_edges_tensor generation:  0.021210193634033203
mini_batch_src_global generation:  0.0506134033203125
r_  generation:  0.4168281555175781
----------------------check_connections_block total spend ----------------------------- 4.492318153381348
generate_one_block  0.5177574157714844
generate_one_block  0.5387444496154785
generate_one_block  0.5074214935302734
generate_one_block  0.4975917339324951
generate_one_block  0.49861621856689453
generate_one_block  0.5071630477905273
generate_one_block  0.5040369033813477
generate_one_block  0.5481734275817871
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03479599952697754
gen group dst list time:  0.038658857345581055
time for parepare:  0.02173328399658203
local_output_nid generation:  0.030132770538330078
local_in_edges_tensor generation:  0.0670480728149414
mini_batch_src_global generation:  0.04929947853088379
r_  generation:  0.5015947818756104
local_output_nid generation:  0.035608768463134766
local_in_edges_tensor generation:  0.05299019813537598
mini_batch_src_global generation:  0.05435299873352051
r_  generation:  0.49464988708496094
local_output_nid generation:  0.0357210636138916
local_in_edges_tensor generation:  0.04008984565734863
mini_batch_src_global generation:  0.055486440658569336
r_  generation:  0.4933605194091797
local_output_nid generation:  0.03567194938659668
local_in_edges_tensor generation:  0.0511324405670166
mini_batch_src_global generation:  0.05277061462402344
r_  generation:  0.5030276775360107
local_output_nid generation:  0.03587198257446289
local_in_edges_tensor generation:  0.0357973575592041
mini_batch_src_global generation:  0.05510139465332031
r_  generation:  0.495755672454834
local_output_nid generation:  0.03591036796569824
local_in_edges_tensor generation:  0.03713274002075195
mini_batch_src_global generation:  0.05669975280761719
r_  generation:  0.5077450275421143
local_output_nid generation:  0.035809993743896484
local_in_edges_tensor generation:  0.04481005668640137
mini_batch_src_global generation:  0.057355642318725586
r_  generation:  0.5108699798583984
local_output_nid generation:  0.03649783134460449
local_in_edges_tensor generation:  0.04755878448486328
mini_batch_src_global generation:  0.05452704429626465
r_  generation:  0.5126011371612549
----------------------check_connections_block total spend ----------------------------- 6.022225379943848
generate_one_block  0.6624574661254883
generate_one_block  0.6270725727081299
generate_one_block  0.6217334270477295
generate_one_block  0.6386315822601318
generate_one_block  0.6208248138427734
generate_one_block  0.6302788257598877
generate_one_block  0.6338069438934326
generate_one_block  0.6263196468353271
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.14703655242919922  GigaBytes
Max Memory Allocated: 0.24091482162475586  GigaBytes

connection checking time:  10.514543533325195
block generation total time  9.180629968643188
average batch blocks generation time:  1.1475787460803986
block dataloader generation time/epoch 21.852896213531494
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.10211563110351562  GigaBytes
Max Memory Allocated: 0.24091482162475586  GigaBytes

torch.Size([162183, 128])
torch.Size([145921, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.22312211990356445  GigaBytes
Max Memory Allocated: 0.24091482162475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.10234880447387695  GigaBytes
Max Memory Allocated: 0.24091482162475586  GigaBytes

torch.Size([162117, 128])
torch.Size([145778, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.22354412078857422  GigaBytes
Max Memory Allocated: 0.24091482162475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.1020212173461914  GigaBytes
Max Memory Allocated: 0.24091482162475586  GigaBytes

torch.Size([162113, 128])
torch.Size([145680, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.22345256805419922  GigaBytes
Max Memory Allocated: 0.24091482162475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.10219383239746094  GigaBytes
Max Memory Allocated: 0.24091482162475586  GigaBytes

torch.Size([162074, 128])
torch.Size([145879, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.2234325408935547  GigaBytes
Max Memory Allocated: 0.24091482162475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.10221290588378906  GigaBytes
Max Memory Allocated: 0.24091482162475586  GigaBytes

torch.Size([162117, 128])
torch.Size([145779, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.22356605529785156  GigaBytes
Max Memory Allocated: 0.24091482162475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.1021718978881836  GigaBytes
Max Memory Allocated: 0.24091482162475586  GigaBytes

torch.Size([162249, 128])
torch.Size([145792, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.22389459609985352  GigaBytes
Max Memory Allocated: 0.24091482162475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.10193443298339844  GigaBytes
Max Memory Allocated: 0.24091482162475586  GigaBytes

torch.Size([162353, 128])
torch.Size([146278, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.22369003295898438  GigaBytes
Max Memory Allocated: 0.24091482162475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.10208892822265625  GigaBytes
Max Memory Allocated: 0.24091482162475586  GigaBytes

torch.Size([162264, 128])
torch.Size([146288, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.22375154495239258  GigaBytes
Max Memory Allocated: 0.24091482162475586  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.037660032510757446 |0.016721218824386597 |0.003413468599319458 |8.887052536010742e-05 |0.0030585825443267822 |0.0015184879302978516 |
----------------------------------------------------------pseudo_mini_loss sum 4.3318281173706055
Total (block generation + training)time/epoch 22.365673542022705
Training time/epoch 0.5125036239624023
Training time without block to device /epoch 0.37873387336730957
Training time without total dataloading part /epoch 0.05400586128234863
load block tensor time/epoch 0.30128026008605957
block to device time/epoch 0.13376975059509277
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3053772
Number of first layer input nodes during this epoch:  1297470
