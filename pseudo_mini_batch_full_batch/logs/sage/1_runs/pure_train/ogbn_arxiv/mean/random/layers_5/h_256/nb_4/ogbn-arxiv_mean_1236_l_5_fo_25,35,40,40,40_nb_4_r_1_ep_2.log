Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648494477.0008585
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0018024444580078125  GigaBytes
Max Memory Allocated: 0.0018024444580078125  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.025134563446044922
random selection method range initialization spend 0.006366252899169922
time for parepare:  0.018297910690307617
local_output_nid generation:  0.008203268051147461
local_in_edges_tensor generation:  0.00915074348449707
mini_batch_src_global generation:  0.0064237117767333984
r_  generation:  0.08327794075012207
local_output_nid generation:  0.011701822280883789
local_in_edges_tensor generation:  0.006075859069824219
mini_batch_src_global generation:  0.008571863174438477
r_  generation:  0.08785390853881836
local_output_nid generation:  0.011736154556274414
local_in_edges_tensor generation:  0.006028413772583008
mini_batch_src_global generation:  0.006544351577758789
r_  generation:  0.08751678466796875
local_output_nid generation:  0.011690616607666016
local_in_edges_tensor generation:  0.006333351135253906
mini_batch_src_global generation:  0.007339954376220703
r_  generation:  0.09207510948181152
----------------------check_connections_block total spend ----------------------------- 0.5493431091308594
generate_one_block  0.10307765007019043
generate_one_block  0.10358262062072754
generate_one_block  0.10166597366333008
generate_one_block  0.10304760932922363
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.040724754333496094
gen group dst list time:  0.011163949966430664
time for parepare:  0.02013707160949707
local_output_nid generation:  0.020160913467407227
local_in_edges_tensor generation:  0.0435185432434082
mini_batch_src_global generation:  0.03876495361328125
r_  generation:  0.409409761428833
local_output_nid generation:  0.03369426727294922
local_in_edges_tensor generation:  0.04118466377258301
mini_batch_src_global generation:  0.05139803886413574
r_  generation:  0.4282379150390625
local_output_nid generation:  0.03387928009033203
local_in_edges_tensor generation:  0.03380179405212402
mini_batch_src_global generation:  0.04732012748718262
r_  generation:  0.43657732009887695
local_output_nid generation:  0.030521869659423828
local_in_edges_tensor generation:  0.04821276664733887
mini_batch_src_global generation:  0.06748604774475098
r_  generation:  0.42908310890197754
----------------------check_connections_block total spend ----------------------------- 2.6034634113311768
generate_one_block  0.5818524360656738
generate_one_block  0.5524675846099854
generate_one_block  0.5293564796447754
generate_one_block  0.5429902076721191
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.06448960304260254
gen group dst list time:  0.020853519439697266
time for parepare:  0.01888132095336914
local_output_nid generation:  0.02910590171813965
local_in_edges_tensor generation:  0.06296181678771973
mini_batch_src_global generation:  0.05118560791015625
r_  generation:  0.5402572154998779
local_output_nid generation:  0.03647732734680176
local_in_edges_tensor generation:  0.06067848205566406
mini_batch_src_global generation:  0.06248927116394043
r_  generation:  0.5659046173095703
local_output_nid generation:  0.03849196434020996
local_in_edges_tensor generation:  0.07252025604248047
mini_batch_src_global generation:  0.05989837646484375
r_  generation:  0.580435037612915
local_output_nid generation:  0.040131330490112305
local_in_edges_tensor generation:  0.05232048034667969
mini_batch_src_global generation:  0.06016063690185547
r_  generation:  0.569467306137085
----------------------check_connections_block total spend ----------------------------- 3.40887451171875
generate_one_block  0.7201881408691406
generate_one_block  0.7359063625335693
generate_one_block  0.7167174816131592
generate_one_block  0.70556640625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.07163262367248535
gen group dst list time:  0.028955698013305664
time for parepare:  0.018935203552246094
local_output_nid generation:  0.03368949890136719
local_in_edges_tensor generation:  0.05439019203186035
mini_batch_src_global generation:  0.049367666244506836
r_  generation:  0.5410256385803223
local_output_nid generation:  0.03935551643371582
local_in_edges_tensor generation:  0.05513739585876465
mini_batch_src_global generation:  0.06248641014099121
r_  generation:  0.5597708225250244
local_output_nid generation:  0.03896784782409668
local_in_edges_tensor generation:  0.047313690185546875
mini_batch_src_global generation:  0.06239748001098633
r_  generation:  0.551262617111206
local_output_nid generation:  0.03924083709716797
local_in_edges_tensor generation:  0.04453754425048828
mini_batch_src_global generation:  0.06211519241333008
r_  generation:  0.5594592094421387
----------------------check_connections_block total spend ----------------------------- 3.326920509338379
generate_one_block  0.7322523593902588
generate_one_block  0.7025530338287354
generate_one_block  0.7111992835998535
generate_one_block  0.701960563659668
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.037665367126464844
gen group dst list time:  0.02858114242553711
time for parepare:  0.01901531219482422
local_output_nid generation:  0.03333854675292969
local_in_edges_tensor generation:  0.06110668182373047
mini_batch_src_global generation:  0.04570269584655762
r_  generation:  0.5091924667358398
local_output_nid generation:  0.040746450424194336
local_in_edges_tensor generation:  0.051778554916381836
mini_batch_src_global generation:  0.05721235275268555
r_  generation:  0.5198850631713867
local_output_nid generation:  0.039674997329711914
local_in_edges_tensor generation:  0.04932713508605957
mini_batch_src_global generation:  0.058164358139038086
r_  generation:  0.5219588279724121
local_output_nid generation:  0.03971457481384277
local_in_edges_tensor generation:  0.036112308502197266
mini_batch_src_global generation:  0.05783843994140625
r_  generation:  0.5211074352264404
----------------------check_connections_block total spend ----------------------------- 3.1463446617126465
generate_one_block  0.6376416683197021
generate_one_block  0.649526834487915
generate_one_block  0.6617233753204346
generate_one_block  0.6320230960845947
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0018024444580078125  GigaBytes
Max Memory Allocated: 0.0018024444580078125  GigaBytes

connection checking time:  12.485603094100952
block generation total time  10.513925313949585
average batch blocks generation time:  2.6284813284873962
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2225341796875 GB
    Memory Allocated: 0.13112545013427734  GigaBytes
Max Memory Allocated: 0.13112545013427734  GigaBytes

torch.Size([167397, 128])
torch.Size([166867, 256])
torch.Size([164863, 256])
torch.Size([154998, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0838623046875 GB
    Memory Allocated: 2.5035452842712402  GigaBytes
Max Memory Allocated: 2.591549873352051  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1444091796875 GB
    Memory Allocated: 0.13679265975952148  GigaBytes
Max Memory Allocated: 2.6967244148254395  GigaBytes

torch.Size([167491, 128])
torch.Size([166962, 256])
torch.Size([164976, 256])
torch.Size([155190, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1444091796875 GB
    Memory Allocated: 2.511928081512451  GigaBytes
Max Memory Allocated: 2.6967244148254395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1463623046875 GB
    Memory Allocated: 0.13664674758911133  GigaBytes
Max Memory Allocated: 2.705000400543213  GigaBytes

torch.Size([167484, 128])
torch.Size([166943, 256])
torch.Size([164969, 256])
torch.Size([155336, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1463623046875 GB
    Memory Allocated: 2.506984233856201  GigaBytes
Max Memory Allocated: 2.705000400543213  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1463623046875 GB
    Memory Allocated: 0.13689374923706055  GigaBytes
Max Memory Allocated: 2.705000400543213  GigaBytes

torch.Size([167418, 128])
torch.Size([166877, 256])
torch.Size([164944, 256])
torch.Size([155121, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1463623046875 GB
    Memory Allocated: 2.5053024291992188  GigaBytes
Max Memory Allocated: 2.705000400543213  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.10019791126251221 |0.12607020139694214 |0.19682687520980835 |0.00012379884719848633 |0.08992964029312134 |0.006806612014770508 |
----------------------------------------------------------pseudo_mini_loss sum 5.905773162841797
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3023585
Number of first layer input nodes during this epoch:  669790
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 5.1483154296875 GB
    Memory Allocated: 0.23107528686523438  GigaBytes
Max Memory Allocated: 2.705000400543213  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.030831098556518555
random selection method range initialization spend 0.005584716796875
time for parepare:  0.019182920455932617
local_output_nid generation:  0.008694171905517578
local_in_edges_tensor generation:  0.013418197631835938
mini_batch_src_global generation:  0.006620645523071289
r_  generation:  0.07954931259155273
local_output_nid generation:  0.01186513900756836
local_in_edges_tensor generation:  0.006132602691650391
mini_batch_src_global generation:  0.012512683868408203
r_  generation:  0.08919525146484375
local_output_nid generation:  0.011950492858886719
local_in_edges_tensor generation:  0.00629115104675293
mini_batch_src_global generation:  0.0066165924072265625
r_  generation:  0.08883905410766602
local_output_nid generation:  0.011998176574707031
local_in_edges_tensor generation:  0.0062677860260009766
mini_batch_src_global generation:  0.008359670639038086
r_  generation:  0.09499454498291016
----------------------check_connections_block total spend ----------------------------- 0.566563606262207
generate_one_block  0.10876584053039551
generate_one_block  0.10284256935119629
generate_one_block  0.10370540618896484
generate_one_block  0.10496115684509277
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.035205841064453125
gen group dst list time:  0.011133193969726562
time for parepare:  0.019378662109375
local_output_nid generation:  0.019445180892944336
local_in_edges_tensor generation:  0.03968930244445801
mini_batch_src_global generation:  0.042977333068847656
r_  generation:  0.4023308753967285
local_output_nid generation:  0.02559804916381836
local_in_edges_tensor generation:  0.039649248123168945
mini_batch_src_global generation:  0.05216789245605469
r_  generation:  0.4207332134246826
local_output_nid generation:  0.025303125381469727
local_in_edges_tensor generation:  0.03297829627990723
mini_batch_src_global generation:  0.047789573669433594
r_  generation:  0.4261205196380615
local_output_nid generation:  0.025452613830566406
local_in_edges_tensor generation:  0.02878880500793457
mini_batch_src_global generation:  0.0518496036529541
r_  generation:  0.43042731285095215
----------------------check_connections_block total spend ----------------------------- 2.5010900497436523
generate_one_block  0.561326265335083
generate_one_block  0.5546162128448486
generate_one_block  0.5896213054656982
generate_one_block  0.5515408515930176
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0438380241394043
gen group dst list time:  0.021207094192504883
time for parepare:  0.019039392471313477
local_output_nid generation:  0.029278278350830078
local_in_edges_tensor generation:  0.07080745697021484
mini_batch_src_global generation:  0.05617046356201172
r_  generation:  0.5445270538330078
local_output_nid generation:  0.0371551513671875
local_in_edges_tensor generation:  0.05893063545227051
mini_batch_src_global generation:  0.06082797050476074
r_  generation:  0.5531392097473145
local_output_nid generation:  0.038140296936035156
local_in_edges_tensor generation:  0.055164337158203125
mini_batch_src_global generation:  0.05719590187072754
r_  generation:  0.5697197914123535
local_output_nid generation:  0.03712034225463867
local_in_edges_tensor generation:  0.06128191947937012
mini_batch_src_global generation:  0.08011937141418457
r_  generation:  0.5629231929779053
----------------------check_connections_block total spend ----------------------------- 3.386249303817749
generate_one_block  0.7082560062408447
generate_one_block  0.7228758335113525
generate_one_block  0.7038648128509521
generate_one_block  0.7031393051147461
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0386807918548584
gen group dst list time:  0.026996374130249023
time for parepare:  0.019237995147705078
local_output_nid generation:  0.03410053253173828
local_in_edges_tensor generation:  0.05690264701843262
mini_batch_src_global generation:  0.05254554748535156
r_  generation:  0.5409438610076904
local_output_nid generation:  0.039287567138671875
local_in_edges_tensor generation:  0.0404057502746582
mini_batch_src_global generation:  0.0616605281829834
r_  generation:  0.5478696823120117
local_output_nid generation:  0.03934979438781738
local_in_edges_tensor generation:  0.0411834716796875
mini_batch_src_global generation:  0.06355738639831543
r_  generation:  0.544022798538208
local_output_nid generation:  0.0390779972076416
local_in_edges_tensor generation:  0.04139375686645508
mini_batch_src_global generation:  0.06126570701599121
r_  generation:  0.5536813735961914
----------------------check_connections_block total spend ----------------------------- 3.293487787246704
generate_one_block  0.6819806098937988
generate_one_block  0.7083723545074463
generate_one_block  0.6874995231628418
generate_one_block  0.7180783748626709
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.035221099853515625
gen group dst list time:  0.026200056076049805
time for parepare:  0.019489765167236328
local_output_nid generation:  0.03526568412780762
local_in_edges_tensor generation:  0.04481196403503418
mini_batch_src_global generation:  0.045500993728637695
r_  generation:  0.5129032135009766
local_output_nid generation:  0.04048013687133789
local_in_edges_tensor generation:  0.050777435302734375
mini_batch_src_global generation:  0.05697488784790039
r_  generation:  0.5232532024383545
local_output_nid generation:  0.04047799110412598
local_in_edges_tensor generation:  0.04972410202026367
mini_batch_src_global generation:  0.05993223190307617
r_  generation:  0.5299937725067139
local_output_nid generation:  0.040557861328125
local_in_edges_tensor generation:  0.0463109016418457
mini_batch_src_global generation:  0.0588834285736084
r_  generation:  0.5285899639129639
----------------------check_connections_block total spend ----------------------------- 3.1723811626434326
generate_one_block  0.656886100769043
generate_one_block  0.6526534557342529
generate_one_block  0.6502583026885986
generate_one_block  0.6405835151672363
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 5.1483154296875 GB
    Memory Allocated: 0.23107528686523438  GigaBytes
Max Memory Allocated: 2.705000400543213  GigaBytes

connection checking time:  12.353208303451538
block generation total time  10.491552829742432
average batch blocks generation time:  2.622888207435608
block dataloader generation time/epoch 25.181280851364136
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1483154296875 GB
    Memory Allocated: 0.14023685455322266  GigaBytes
Max Memory Allocated: 2.705000400543213  GigaBytes

torch.Size([167432, 128])
torch.Size([166845, 256])
torch.Size([164805, 256])
torch.Size([154935, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1483154296875 GB
    Memory Allocated: 2.500487804412842  GigaBytes
Max Memory Allocated: 2.705000400543213  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1502685546875 GB
    Memory Allocated: 0.14055919647216797  GigaBytes
Max Memory Allocated: 2.705000400543213  GigaBytes

torch.Size([167470, 128])
torch.Size([166884, 256])
torch.Size([164920, 256])
torch.Size([155220, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1502685546875 GB
    Memory Allocated: 2.5131688117980957  GigaBytes
Max Memory Allocated: 2.705000400543213  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1502685546875 GB
    Memory Allocated: 0.14031219482421875  GigaBytes
Max Memory Allocated: 2.706404209136963  GigaBytes

torch.Size([167435, 128])
torch.Size([166856, 256])
torch.Size([164812, 256])
torch.Size([155006, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1502685546875 GB
    Memory Allocated: 2.503612518310547  GigaBytes
Max Memory Allocated: 2.706404209136963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1502685546875 GB
    Memory Allocated: 0.14042377471923828  GigaBytes
Max Memory Allocated: 2.706404209136963  GigaBytes

torch.Size([167358, 128])
torch.Size([166783, 256])
torch.Size([164713, 256])
torch.Size([154898, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1502685546875 GB
    Memory Allocated: 2.5071215629577637  GigaBytes
Max Memory Allocated: 2.706404209136963  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.1915019154548645 |0.04279202222824097 |0.005778014659881592 |9.79304313659668e-05 |0.005223631858825684 |0.0031321048736572266 |
----------------------------------------------------------pseudo_mini_loss sum 3.5134308338165283
Total (block generation + training)time/epoch 26.387400150299072
Training time/epoch 1.2059030532836914
Training time without block to device /epoch 1.0347349643707275
Training time without total dataloading part /epoch 0.047530412673950195
load block tensor time/epoch 0.766007661819458
block to device time/epoch 0.17116808891296387
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3021722
Number of first layer input nodes during this epoch:  669695
