Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648507808.3156583
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 8.249282836914062e-05  GigaBytes
Max Memory Allocated: 8.249282836914062e-05  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.023510217666625977
random selection method range initialization spend 0.006112337112426758
time for parepare:  0.018764972686767578
local_output_nid generation:  0.004321575164794922
local_in_edges_tensor generation:  0.005097866058349609
mini_batch_src_global generation:  0.003268003463745117
r_  generation:  0.03762459754943848
local_output_nid generation:  0.005925893783569336
local_in_edges_tensor generation:  0.003044605255126953
mini_batch_src_global generation:  0.004098415374755859
r_  generation:  0.03887224197387695
local_output_nid generation:  0.006021261215209961
local_in_edges_tensor generation:  0.0031685829162597656
mini_batch_src_global generation:  0.0027921199798583984
r_  generation:  0.039641618728637695
local_output_nid generation:  0.006070375442504883
local_in_edges_tensor generation:  0.0031561851501464844
mini_batch_src_global generation:  0.0029048919677734375
r_  generation:  0.04075288772583008
local_output_nid generation:  0.006042957305908203
local_in_edges_tensor generation:  0.003116130828857422
mini_batch_src_global generation:  0.0031011104583740234
r_  generation:  0.0416560173034668
local_output_nid generation:  0.006096601486206055
local_in_edges_tensor generation:  0.0031630992889404297
mini_batch_src_global generation:  0.003323793411254883
r_  generation:  0.04173994064331055
local_output_nid generation:  0.006084442138671875
local_in_edges_tensor generation:  0.0032494068145751953
mini_batch_src_global generation:  0.0033223628997802734
r_  generation:  0.04215121269226074
local_output_nid generation:  0.00609898567199707
local_in_edges_tensor generation:  0.0032362937927246094
mini_batch_src_global generation:  0.003423929214477539
r_  generation:  0.04288983345031738
----------------------check_connections_block total spend ----------------------------- 0.522531270980835
generate_one_block  0.05447268486022949
generate_one_block  0.054651498794555664
generate_one_block  0.055318593978881836
generate_one_block  0.055010080337524414
generate_one_block  0.058450937271118164
generate_one_block  0.05555891990661621
generate_one_block  0.054986000061035156
generate_one_block  0.05543160438537598
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.03966116905212402
gen group dst list time:  0.015478372573852539
time for parepare:  0.019002676010131836
local_output_nid generation:  0.013413429260253906
local_in_edges_tensor generation:  0.03114485740661621
mini_batch_src_global generation:  0.030928373336791992
r_  generation:  0.293316125869751
local_output_nid generation:  0.019384145736694336
local_in_edges_tensor generation:  0.030249834060668945
mini_batch_src_global generation:  0.0363774299621582
r_  generation:  0.31742310523986816
local_output_nid generation:  0.01940321922302246
local_in_edges_tensor generation:  0.036041259765625
mini_batch_src_global generation:  0.06425285339355469
r_  generation:  0.3121218681335449
local_output_nid generation:  0.01980113983154297
local_in_edges_tensor generation:  0.025437355041503906
mini_batch_src_global generation:  0.03997302055358887
r_  generation:  0.31347012519836426
local_output_nid generation:  0.018890857696533203
local_in_edges_tensor generation:  0.018259286880493164
mini_batch_src_global generation:  0.03852367401123047
r_  generation:  0.3175632953643799
local_output_nid generation:  0.018677473068237305
local_in_edges_tensor generation:  0.018153905868530273
mini_batch_src_global generation:  0.0392606258392334
r_  generation:  0.31766176223754883
local_output_nid generation:  0.01866912841796875
local_in_edges_tensor generation:  0.024287939071655273
mini_batch_src_global generation:  0.03859353065490723
r_  generation:  0.3183624744415283
local_output_nid generation:  0.01875758171081543
local_in_edges_tensor generation:  0.023303508758544922
mini_batch_src_global generation:  0.03890204429626465
r_  generation:  0.32532238960266113
----------------------check_connections_block total spend ----------------------------- 3.770350217819214
generate_one_block  0.416248083114624
generate_one_block  0.4148590564727783
generate_one_block  0.427462100982666
generate_one_block  0.41771554946899414
generate_one_block  0.4032409191131592
generate_one_block  0.4332852363586426
generate_one_block  0.40912365913391113
generate_one_block  0.414597749710083
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.050139665603637695
gen group dst list time:  0.03691887855529785
time for parepare:  0.01927018165588379
local_output_nid generation:  0.028565645217895508
local_in_edges_tensor generation:  0.06055855751037598
mini_batch_src_global generation:  0.05488109588623047
r_  generation:  0.5234503746032715
local_output_nid generation:  0.03420376777648926
local_in_edges_tensor generation:  0.0515289306640625
mini_batch_src_global generation:  0.06092715263366699
r_  generation:  0.5425333976745605
local_output_nid generation:  0.0342252254486084
local_in_edges_tensor generation:  0.038274526596069336
mini_batch_src_global generation:  0.057765960693359375
r_  generation:  0.5450990200042725
local_output_nid generation:  0.0358891487121582
local_in_edges_tensor generation:  0.050812721252441406
mini_batch_src_global generation:  0.06372499465942383
r_  generation:  0.5532183647155762
local_output_nid generation:  0.03536200523376465
local_in_edges_tensor generation:  0.04641580581665039
mini_batch_src_global generation:  0.0679466724395752
r_  generation:  0.5674548149108887
local_output_nid generation:  0.03772139549255371
local_in_edges_tensor generation:  0.04108572006225586
mini_batch_src_global generation:  0.06352806091308594
r_  generation:  0.5385699272155762
local_output_nid generation:  0.03555583953857422
local_in_edges_tensor generation:  0.033049583435058594
mini_batch_src_global generation:  0.060672760009765625
r_  generation:  0.551177978515625
local_output_nid generation:  0.03563833236694336
local_in_edges_tensor generation:  0.04746603965759277
mini_batch_src_global generation:  0.06240725517272949
r_  generation:  0.5407083034515381
----------------------check_connections_block total spend ----------------------------- 6.471109390258789
generate_one_block  0.6903600692749023
generate_one_block  0.6913096904754639
generate_one_block  0.6825876235961914
generate_one_block  0.7118861675262451
generate_one_block  0.6827845573425293
generate_one_block  0.7070915699005127
generate_one_block  0.7271451950073242
generate_one_block  0.7313005924224854
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.051964521408081055
gen group dst list time:  0.04960465431213379
time for parepare:  0.019881486892700195
local_output_nid generation:  0.03559517860412598
local_in_edges_tensor generation:  0.05818891525268555
mini_batch_src_global generation:  0.05478525161743164
r_  generation:  0.5569150447845459
local_output_nid generation:  0.03906059265136719
local_in_edges_tensor generation:  0.057462215423583984
mini_batch_src_global generation:  0.06462931632995605
r_  generation:  0.5695419311523438
local_output_nid generation:  0.04183173179626465
local_in_edges_tensor generation:  0.048568010330200195
mini_batch_src_global generation:  0.06743001937866211
r_  generation:  0.551199197769165
local_output_nid generation:  0.03988170623779297
local_in_edges_tensor generation:  0.05091214179992676
mini_batch_src_global generation:  0.05902361869812012
r_  generation:  0.5615494251251221
local_output_nid generation:  0.03980565071105957
local_in_edges_tensor generation:  0.03963065147399902
mini_batch_src_global generation:  0.06042885780334473
r_  generation:  0.5630500316619873
local_output_nid generation:  0.04017925262451172
local_in_edges_tensor generation:  0.042450904846191406
mini_batch_src_global generation:  0.0603940486907959
r_  generation:  0.5655412673950195
local_output_nid generation:  0.03989529609680176
local_in_edges_tensor generation:  0.04282808303833008
mini_batch_src_global generation:  0.0605623722076416
r_  generation:  0.5699455738067627
local_output_nid generation:  0.03998446464538574
local_in_edges_tensor generation:  0.04241180419921875
mini_batch_src_global generation:  0.06537199020385742
r_  generation:  0.5708277225494385
----------------------check_connections_block total spend ----------------------------- 6.748426198959351
generate_one_block  0.7228212356567383
generate_one_block  0.7108957767486572
generate_one_block  0.7068724632263184
generate_one_block  0.7210030555725098
generate_one_block  0.6885213851928711
generate_one_block  0.7075624465942383
generate_one_block  0.7365682125091553
generate_one_block  0.7139933109283447
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04088258743286133
gen group dst list time:  0.04980921745300293
time for parepare:  0.020400524139404297
local_output_nid generation:  0.03785109519958496
local_in_edges_tensor generation:  0.05518364906311035
mini_batch_src_global generation:  0.04938530921936035
r_  generation:  0.5401463508605957
local_output_nid generation:  0.04106330871582031
local_in_edges_tensor generation:  0.04404139518737793
mini_batch_src_global generation:  0.06971240043640137
r_  generation:  0.5621974468231201
local_output_nid generation:  0.043599843978881836
local_in_edges_tensor generation:  0.053977251052856445
mini_batch_src_global generation:  0.06403398513793945
r_  generation:  0.545039176940918
local_output_nid generation:  0.041570186614990234
local_in_edges_tensor generation:  0.046608924865722656
mini_batch_src_global generation:  0.0629119873046875
r_  generation:  0.5501813888549805
local_output_nid generation:  0.04217195510864258
local_in_edges_tensor generation:  0.039826393127441406
mini_batch_src_global generation:  0.06326961517333984
r_  generation:  0.5470530986785889
local_output_nid generation:  0.041361331939697266
local_in_edges_tensor generation:  0.046274423599243164
mini_batch_src_global generation:  0.06345605850219727
r_  generation:  0.5499486923217773
local_output_nid generation:  0.04102730751037598
local_in_edges_tensor generation:  0.03730297088623047
mini_batch_src_global generation:  0.06583595275878906
r_  generation:  0.550872802734375
local_output_nid generation:  0.04149055480957031
local_in_edges_tensor generation:  0.04313349723815918
mini_batch_src_global generation:  0.06217694282531738
r_  generation:  0.5564146041870117
----------------------check_connections_block total spend ----------------------------- 6.63870906829834
generate_one_block  0.693394660949707
generate_one_block  0.6975831985473633
generate_one_block  0.6867222785949707
generate_one_block  0.6967017650604248
generate_one_block  0.6969971656799316
generate_one_block  0.6969461441040039
generate_one_block  0.6791462898254395
generate_one_block  0.7390098571777344
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04600787162780762
gen group dst list time:  0.0490567684173584
time for parepare:  0.019456863403320312
local_output_nid generation:  0.03576993942260742
local_in_edges_tensor generation:  0.05135822296142578
mini_batch_src_global generation:  0.04584479331970215
r_  generation:  0.5083057880401611
local_output_nid generation:  0.04155421257019043
local_in_edges_tensor generation:  0.04239916801452637
mini_batch_src_global generation:  0.0585784912109375
r_  generation:  0.5118682384490967
local_output_nid generation:  0.0403599739074707
local_in_edges_tensor generation:  0.04082465171813965
mini_batch_src_global generation:  0.05855727195739746
r_  generation:  0.518181562423706
local_output_nid generation:  0.04050564765930176
local_in_edges_tensor generation:  0.05504631996154785
mini_batch_src_global generation:  0.06325459480285645
r_  generation:  0.5307731628417969
local_output_nid generation:  0.04408073425292969
local_in_edges_tensor generation:  0.05123138427734375
mini_batch_src_global generation:  0.06521058082580566
r_  generation:  0.5146522521972656
local_output_nid generation:  0.04166007041931152
local_in_edges_tensor generation:  0.046875953674316406
mini_batch_src_global generation:  0.058380126953125
r_  generation:  0.5222370624542236
local_output_nid generation:  0.041481971740722656
local_in_edges_tensor generation:  0.03948783874511719
mini_batch_src_global generation:  0.07509279251098633
r_  generation:  0.5142216682434082
local_output_nid generation:  0.041373252868652344
local_in_edges_tensor generation:  0.036652565002441406
mini_batch_src_global generation:  0.057952165603637695
r_  generation:  0.5212209224700928
----------------------check_connections_block total spend ----------------------------- 6.303385019302368
generate_one_block  0.6657683849334717
generate_one_block  0.6460051536560059
generate_one_block  0.6399805545806885
generate_one_block  0.6496319770812988
generate_one_block  0.6588058471679688
generate_one_block  0.6355037689208984
generate_one_block  0.63352370262146
generate_one_block  0.6315939426422119
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 8.249282836914062e-05  GigaBytes
Max Memory Allocated: 8.249282836914062e-05  GigaBytes

connection checking time:  29.93197989463806
block generation total time  25.416550397872925
average batch blocks generation time:  3.1770687997341156
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2401123046875 GB
    Memory Allocated: 0.13854074478149414  GigaBytes
Max Memory Allocated: 0.13854074478149414  GigaBytes

torch.Size([167626, 128])
torch.Size([167225, 32])
torch.Size([165955, 32])
torch.Size([161520, 32])
torch.Size([142283, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8826904296875 GB
    Memory Allocated: 0.548945426940918  GigaBytes
Max Memory Allocated: 0.5512404441833496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.14174652099609375  GigaBytes
Max Memory Allocated: 0.5629425048828125  GigaBytes

torch.Size([167527, 128])
torch.Size([167055, 32])
torch.Size([165754, 32])
torch.Size([161191, 32])
torch.Size([141827, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.5490727424621582  GigaBytes
Max Memory Allocated: 0.5629425048828125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.1417675018310547  GigaBytes
Max Memory Allocated: 0.5629425048828125  GigaBytes

torch.Size([167538, 128])
torch.Size([167076, 32])
torch.Size([165761, 32])
torch.Size([161132, 32])
torch.Size([141804, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.5490837097167969  GigaBytes
Max Memory Allocated: 0.5629425048828125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.1418437957763672  GigaBytes
Max Memory Allocated: 0.5629425048828125  GigaBytes

torch.Size([167558, 128])
torch.Size([167085, 32])
torch.Size([165781, 32])
torch.Size([161350, 32])
torch.Size([142135, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.5494351387023926  GigaBytes
Max Memory Allocated: 0.5629425048828125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.1417555809020996  GigaBytes
Max Memory Allocated: 0.5633587837219238  GigaBytes

torch.Size([167593, 128])
torch.Size([167133, 32])
torch.Size([165792, 32])
torch.Size([161131, 32])
torch.Size([142019, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.5494065284729004  GigaBytes
Max Memory Allocated: 0.5633587837219238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.14184999465942383  GigaBytes
Max Memory Allocated: 0.5633726119995117  GigaBytes

torch.Size([167559, 128])
torch.Size([167109, 32])
torch.Size([165840, 32])
torch.Size([161441, 32])
torch.Size([142237, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.5493736267089844  GigaBytes
Max Memory Allocated: 0.5633726119995117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.1418004035949707  GigaBytes
Max Memory Allocated: 0.5633726119995117  GigaBytes

torch.Size([167561, 128])
torch.Size([167087, 32])
torch.Size([165752, 32])
torch.Size([161115, 32])
torch.Size([141607, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5490279197692871  GigaBytes
Max Memory Allocated: 0.5633726119995117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.14190435409545898  GigaBytes
Max Memory Allocated: 0.5633726119995117  GigaBytes

torch.Size([167539, 128])
torch.Size([167057, 32])
torch.Size([165771, 32])
torch.Size([161459, 32])
torch.Size([142492, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5497622489929199  GigaBytes
Max Memory Allocated: 0.5633726119995117  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06706258654594421 |0.0916675329208374 |0.09578311443328857 |0.00010356307029724121 |0.01627013087272644 |0.007718324661254883 |
----------------------------------------------------------pseudo_mini_loss sum 5.3901448249816895
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6973628
Number of first layer input nodes during this epoch:  1340501
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.26635026931762695  GigaBytes
Max Memory Allocated: 0.5637922286987305  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.022544384002685547
random selection method range initialization spend 0.005523681640625
time for parepare:  0.017290115356445312
local_output_nid generation:  0.004568815231323242
local_in_edges_tensor generation:  0.006129741668701172
mini_batch_src_global generation:  0.0033648014068603516
r_  generation:  0.03722691535949707
local_output_nid generation:  0.005789518356323242
local_in_edges_tensor generation:  0.003023386001586914
mini_batch_src_global generation:  0.0040929317474365234
r_  generation:  0.03835034370422363
local_output_nid generation:  0.006001472473144531
local_in_edges_tensor generation:  0.003064393997192383
mini_batch_src_global generation:  0.0029060840606689453
r_  generation:  0.042088985443115234
local_output_nid generation:  0.006661176681518555
local_in_edges_tensor generation:  0.006340503692626953
mini_batch_src_global generation:  0.003965616226196289
r_  generation:  0.04073476791381836
local_output_nid generation:  0.006053924560546875
local_in_edges_tensor generation:  0.0031206607818603516
mini_batch_src_global generation:  0.0032155513763427734
r_  generation:  0.04820895195007324
local_output_nid generation:  0.00733184814453125
local_in_edges_tensor generation:  0.003068685531616211
mini_batch_src_global generation:  0.0034284591674804688
r_  generation:  0.04414200782775879
local_output_nid generation:  0.006180524826049805
local_in_edges_tensor generation:  0.003251791000366211
mini_batch_src_global generation:  0.0034482479095458984
r_  generation:  0.042128562927246094
local_output_nid generation:  0.0061037540435791016
local_in_edges_tensor generation:  0.003057241439819336
mini_batch_src_global generation:  0.003381490707397461
r_  generation:  0.04258918762207031
----------------------check_connections_block total spend ----------------------------- 0.5463032722473145
generate_one_block  0.05388617515563965
generate_one_block  0.05428171157836914
generate_one_block  0.05466866493225098
generate_one_block  0.05470561981201172
generate_one_block  0.056535959243774414
generate_one_block  0.053838253021240234
generate_one_block  0.05405259132385254
generate_one_block  0.05764627456665039
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.07041430473327637
gen group dst list time:  0.01638650894165039
time for parepare:  0.02110910415649414
local_output_nid generation:  0.01386880874633789
local_in_edges_tensor generation:  0.04165005683898926
mini_batch_src_global generation:  0.031044960021972656
r_  generation:  0.2981569766998291
local_output_nid generation:  0.018846750259399414
local_in_edges_tensor generation:  0.029199838638305664
mini_batch_src_global generation:  0.038805484771728516
r_  generation:  0.3110387325286865
local_output_nid generation:  0.018837451934814453
local_in_edges_tensor generation:  0.024295330047607422
mini_batch_src_global generation:  0.03839898109436035
r_  generation:  0.3167586326599121
local_output_nid generation:  0.019336462020874023
local_in_edges_tensor generation:  0.024614810943603516
mini_batch_src_global generation:  0.041496992111206055
r_  generation:  0.3179752826690674
local_output_nid generation:  0.02137279510498047
local_in_edges_tensor generation:  0.021893024444580078
mini_batch_src_global generation:  0.04090285301208496
r_  generation:  0.329608678817749
local_output_nid generation:  0.017901897430419922
local_in_edges_tensor generation:  0.01851820945739746
mini_batch_src_global generation:  0.03852272033691406
r_  generation:  0.31684207916259766
local_output_nid generation:  0.017960309982299805
local_in_edges_tensor generation:  0.020476102828979492
mini_batch_src_global generation:  0.03812909126281738
r_  generation:  0.3209080696105957
local_output_nid generation:  0.01786661148071289
local_in_edges_tensor generation:  0.021280288696289062
mini_batch_src_global generation:  0.038799285888671875
r_  generation:  0.3126347064971924
----------------------check_connections_block total spend ----------------------------- 3.740873336791992
generate_one_block  0.41319966316223145
generate_one_block  0.40973544120788574
generate_one_block  0.4158971309661865
generate_one_block  0.421825647354126
generate_one_block  0.4145164489746094
generate_one_block  0.3991382122039795
generate_one_block  0.40950679779052734
generate_one_block  0.43724703788757324
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04529237747192383
gen group dst list time:  0.03689980506896973
time for parepare:  0.018049240112304688
local_output_nid generation:  0.028835773468017578
local_in_edges_tensor generation:  0.06290912628173828
mini_batch_src_global generation:  0.06355524063110352
r_  generation:  0.5483217239379883
local_output_nid generation:  0.03507709503173828
local_in_edges_tensor generation:  0.05496072769165039
mini_batch_src_global generation:  0.0638425350189209
r_  generation:  0.5747270584106445
local_output_nid generation:  0.03928065299987793
local_in_edges_tensor generation:  0.05517983436584473
mini_batch_src_global generation:  0.07131838798522949
r_  generation:  0.5657734870910645
local_output_nid generation:  0.0363621711730957
local_in_edges_tensor generation:  0.047162771224975586
mini_batch_src_global generation:  0.06249189376831055
r_  generation:  0.5414354801177979
local_output_nid generation:  0.036377906799316406
local_in_edges_tensor generation:  0.04582667350769043
mini_batch_src_global generation:  0.06471800804138184
r_  generation:  0.5997917652130127
local_output_nid generation:  0.03640389442443848
local_in_edges_tensor generation:  0.03653454780578613
mini_batch_src_global generation:  0.06359720230102539
r_  generation:  0.5534188747406006
local_output_nid generation:  0.03650927543640137
local_in_edges_tensor generation:  0.03720903396606445
mini_batch_src_global generation:  0.06755352020263672
r_  generation:  0.6391801834106445
local_output_nid generation:  0.039806365966796875
local_in_edges_tensor generation:  0.05668044090270996
mini_batch_src_global generation:  0.0671243667602539
r_  generation:  0.540919303894043
----------------------check_connections_block total spend ----------------------------- 6.813763380050659
generate_one_block  0.6860623359680176
generate_one_block  0.6941969394683838
generate_one_block  0.6915278434753418
generate_one_block  0.6986558437347412
generate_one_block  0.6958441734313965
generate_one_block  0.6777198314666748
generate_one_block  0.6793332099914551
generate_one_block  0.6812996864318848
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.048821449279785156
gen group dst list time:  0.05179643630981445
time for parepare:  0.018878698348999023
local_output_nid generation:  0.03514409065246582
local_in_edges_tensor generation:  0.06638312339782715
mini_batch_src_global generation:  0.05445289611816406
r_  generation:  0.5673596858978271
local_output_nid generation:  0.04471302032470703
local_in_edges_tensor generation:  0.09736132621765137
mini_batch_src_global generation:  0.06320834159851074
r_  generation:  0.553398847579956
local_output_nid generation:  0.04033517837524414
local_in_edges_tensor generation:  0.04602646827697754
mini_batch_src_global generation:  0.06395745277404785
r_  generation:  0.5518803596496582
local_output_nid generation:  0.03923797607421875
local_in_edges_tensor generation:  0.042154550552368164
mini_batch_src_global generation:  0.06084299087524414
r_  generation:  0.5608425140380859
local_output_nid generation:  0.03945302963256836
local_in_edges_tensor generation:  0.05305981636047363
mini_batch_src_global generation:  0.060936689376831055
r_  generation:  0.5646674633026123
local_output_nid generation:  0.039131879806518555
local_in_edges_tensor generation:  0.047594547271728516
mini_batch_src_global generation:  0.06060671806335449
r_  generation:  0.5792953968048096
local_output_nid generation:  0.03908491134643555
local_in_edges_tensor generation:  0.03845953941345215
mini_batch_src_global generation:  0.06092405319213867
r_  generation:  0.5705540180206299
local_output_nid generation:  0.03894686698913574
local_in_edges_tensor generation:  0.03816676139831543
mini_batch_src_global generation:  0.06175398826599121
r_  generation:  0.5708508491516113
----------------------check_connections_block total spend ----------------------------- 6.795443296432495
generate_one_block  0.705254316329956
generate_one_block  0.7112166881561279
generate_one_block  0.6928908824920654
generate_one_block  0.70025634765625
generate_one_block  0.7047779560089111
generate_one_block  0.708101749420166
generate_one_block  0.6900310516357422
generate_one_block  0.7018570899963379
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03772449493408203
gen group dst list time:  0.051764726638793945
time for parepare:  0.018747806549072266
local_output_nid generation:  0.03715944290161133
local_in_edges_tensor generation:  0.05317068099975586
mini_batch_src_global generation:  0.05515789985656738
r_  generation:  0.5449416637420654
local_output_nid generation:  0.040517330169677734
local_in_edges_tensor generation:  0.05981302261352539
mini_batch_src_global generation:  0.06539344787597656
r_  generation:  0.5530335903167725
local_output_nid generation:  0.0407109260559082
local_in_edges_tensor generation:  0.051564931869506836
mini_batch_src_global generation:  0.07461142539978027
r_  generation:  0.5544896125793457
local_output_nid generation:  0.04263472557067871
local_in_edges_tensor generation:  0.04284381866455078
mini_batch_src_global generation:  0.06261610984802246
r_  generation:  0.5542194843292236
local_output_nid generation:  0.04177451133728027
local_in_edges_tensor generation:  0.04789280891418457
mini_batch_src_global generation:  0.06152844429016113
r_  generation:  0.546781063079834
local_output_nid generation:  0.04183530807495117
local_in_edges_tensor generation:  0.09137964248657227
mini_batch_src_global generation:  0.06157875061035156
r_  generation:  0.5556859970092773
local_output_nid generation:  0.04070854187011719
local_in_edges_tensor generation:  0.037966251373291016
mini_batch_src_global generation:  0.06293892860412598
r_  generation:  0.5669305324554443
local_output_nid generation:  0.04102158546447754
local_in_edges_tensor generation:  0.03805279731750488
mini_batch_src_global generation:  0.06154036521911621
r_  generation:  0.5602607727050781
----------------------check_connections_block total spend ----------------------------- 6.748612403869629
generate_one_block  0.6845173835754395
generate_one_block  0.6980588436126709
generate_one_block  0.6872808933258057
generate_one_block  0.6950571537017822
generate_one_block  0.6987166404724121
generate_one_block  0.6986889839172363
generate_one_block  0.6886923313140869
generate_one_block  0.6802594661712646
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.045966386795043945
gen group dst list time:  0.047298431396484375
time for parepare:  0.019699573516845703
local_output_nid generation:  0.036927223205566406
local_in_edges_tensor generation:  0.05556297302246094
mini_batch_src_global generation:  0.04558277130126953
r_  generation:  0.5102524757385254
local_output_nid generation:  0.04396247863769531
local_in_edges_tensor generation:  0.04557609558105469
mini_batch_src_global generation:  0.057990074157714844
r_  generation:  0.5115697383880615
local_output_nid generation:  0.04307365417480469
local_in_edges_tensor generation:  0.046111106872558594
mini_batch_src_global generation:  0.0582280158996582
r_  generation:  0.5197110176086426
local_output_nid generation:  0.04159998893737793
local_in_edges_tensor generation:  0.03900551795959473
mini_batch_src_global generation:  0.06166696548461914
r_  generation:  0.5253052711486816
local_output_nid generation:  0.04143166542053223
local_in_edges_tensor generation:  0.043897151947021484
mini_batch_src_global generation:  0.06220054626464844
r_  generation:  0.5209219455718994
local_output_nid generation:  0.0408475399017334
local_in_edges_tensor generation:  0.05008840560913086
mini_batch_src_global generation:  0.05819582939147949
r_  generation:  0.5140256881713867
local_output_nid generation:  0.0410914421081543
local_in_edges_tensor generation:  0.03713822364807129
mini_batch_src_global generation:  0.06273198127746582
r_  generation:  0.5147857666015625
local_output_nid generation:  0.04115462303161621
local_in_edges_tensor generation:  0.0372769832611084
mini_batch_src_global generation:  0.058853864669799805
r_  generation:  0.5168132781982422
----------------------check_connections_block total spend ----------------------------- 6.26833176612854
generate_one_block  0.684084415435791
generate_one_block  0.6476798057556152
generate_one_block  0.6530191898345947
generate_one_block  0.6350319385528564
generate_one_block  0.6604471206665039
generate_one_block  0.6449947357177734
generate_one_block  0.6431834697723389
generate_one_block  0.6483154296875
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.26635026931762695  GigaBytes
Max Memory Allocated: 0.5637922286987305  GigaBytes

connection checking time:  30.367024183273315
block generation total time  25.188120126724243
average batch blocks generation time:  3.1485150158405304
block dataloader generation time/epoch 58.46403408050537
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.14197921752929688  GigaBytes
Max Memory Allocated: 0.5637922286987305  GigaBytes

torch.Size([167522, 128])
torch.Size([167105, 32])
torch.Size([165846, 32])
torch.Size([161483, 32])
torch.Size([142222, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5496697425842285  GigaBytes
Max Memory Allocated: 0.5637922286987305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.14194345474243164  GigaBytes
Max Memory Allocated: 0.5637922286987305  GigaBytes

torch.Size([167517, 128])
torch.Size([167111, 32])
torch.Size([165825, 32])
torch.Size([161435, 32])
torch.Size([142185, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5495419502258301  GigaBytes
Max Memory Allocated: 0.5637922286987305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.1419849395751953  GigaBytes
Max Memory Allocated: 0.5637922286987305  GigaBytes

torch.Size([167521, 128])
torch.Size([167108, 32])
torch.Size([165820, 32])
torch.Size([161354, 32])
torch.Size([141965, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.549537181854248  GigaBytes
Max Memory Allocated: 0.5637922286987305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.14203643798828125  GigaBytes
Max Memory Allocated: 0.5637922286987305  GigaBytes

torch.Size([167457, 128])
torch.Size([167018, 32])
torch.Size([165742, 32])
torch.Size([161273, 32])
torch.Size([141923, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5495562553405762  GigaBytes
Max Memory Allocated: 0.5637922286987305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.1421494483947754  GigaBytes
Max Memory Allocated: 0.5637922286987305  GigaBytes

torch.Size([167544, 128])
torch.Size([167136, 32])
torch.Size([165893, 32])
torch.Size([161588, 32])
torch.Size([142586, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5504508018493652  GigaBytes
Max Memory Allocated: 0.5637922286987305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.14185762405395508  GigaBytes
Max Memory Allocated: 0.5647134780883789  GigaBytes

torch.Size([167502, 128])
torch.Size([167076, 32])
torch.Size([165824, 32])
torch.Size([161451, 32])
torch.Size([142010, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5490999221801758  GigaBytes
Max Memory Allocated: 0.5647134780883789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.14189672470092773  GigaBytes
Max Memory Allocated: 0.5647134780883789  GigaBytes

torch.Size([167507, 128])
torch.Size([167112, 32])
torch.Size([165838, 32])
torch.Size([161251, 32])
torch.Size([141643, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5490798950195312  GigaBytes
Max Memory Allocated: 0.5647134780883789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.14177560806274414  GigaBytes
Max Memory Allocated: 0.5647134780883789  GigaBytes

torch.Size([167487, 128])
torch.Size([167032, 32])
torch.Size([165716, 32])
torch.Size([161090, 32])
torch.Size([141590, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5477137565612793  GigaBytes
Max Memory Allocated: 0.5647134780883789  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06972324848175049 |0.051838219165802 |0.006659001111984253 |9.655952453613281e-05 |0.0077024102210998535 |0.002920866012573242 |
----------------------------------------------------------pseudo_mini_loss sum 4.799186706542969
Total (block generation + training)time/epoch 59.616459369659424
Training time/epoch 1.1521379947662354
Training time without block to device /epoch 0.7374322414398193
Training time without total dataloading part /epoch 0.11858463287353516
load block tensor time/epoch 0.5577859878540039
block to device time/epoch 0.414705753326416
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6973025
Number of first layer input nodes during this epoch:  1340057
