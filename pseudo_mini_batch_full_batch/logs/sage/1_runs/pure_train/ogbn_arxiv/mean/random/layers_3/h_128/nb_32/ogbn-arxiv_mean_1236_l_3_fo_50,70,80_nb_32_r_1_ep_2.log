Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648443057.6817675
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02691483497619629
random selection method range initialization spend 0.0064334869384765625
time for parepare:  0.01879596710205078
local_output_nid generation:  0.0011148452758789062
local_in_edges_tensor generation:  0.004342317581176758
mini_batch_src_global generation:  0.001600027084350586
r_  generation:  0.010300636291503906
local_output_nid generation:  0.0012793540954589844
local_in_edges_tensor generation:  0.0010144710540771484
mini_batch_src_global generation:  0.0016326904296875
r_  generation:  0.009270906448364258
local_output_nid generation:  0.0013599395751953125
local_in_edges_tensor generation:  0.0008962154388427734
mini_batch_src_global generation:  0.0011966228485107422
r_  generation:  0.009901285171508789
local_output_nid generation:  0.0014185905456542969
local_in_edges_tensor generation:  0.0008685588836669922
mini_batch_src_global generation:  0.0010440349578857422
r_  generation:  0.00914454460144043
local_output_nid generation:  0.0014147758483886719
local_in_edges_tensor generation:  0.0008451938629150391
mini_batch_src_global generation:  0.0009589195251464844
r_  generation:  0.009109258651733398
local_output_nid generation:  0.0014367103576660156
local_in_edges_tensor generation:  0.0008373260498046875
mini_batch_src_global generation:  0.0009999275207519531
r_  generation:  0.009337902069091797
local_output_nid generation:  0.0014314651489257812
local_in_edges_tensor generation:  0.0008130073547363281
mini_batch_src_global generation:  0.000982046127319336
r_  generation:  0.009401798248291016
local_output_nid generation:  0.001421213150024414
local_in_edges_tensor generation:  0.0007948875427246094
mini_batch_src_global generation:  0.0009903907775878906
r_  generation:  0.009352445602416992
local_output_nid generation:  0.0014319419860839844
local_in_edges_tensor generation:  0.0007958412170410156
mini_batch_src_global generation:  0.0011217594146728516
r_  generation:  0.009905576705932617
local_output_nid generation:  0.001434326171875
local_in_edges_tensor generation:  0.0008280277252197266
mini_batch_src_global generation:  0.0010623931884765625
r_  generation:  0.009815216064453125
local_output_nid generation:  0.0014514923095703125
local_in_edges_tensor generation:  0.0007901191711425781
mini_batch_src_global generation:  0.0010540485382080078
r_  generation:  0.010174989700317383
local_output_nid generation:  0.0015027523040771484
local_in_edges_tensor generation:  0.0007791519165039062
mini_batch_src_global generation:  0.0010695457458496094
r_  generation:  0.009992361068725586
local_output_nid generation:  0.0014429092407226562
local_in_edges_tensor generation:  0.0007917881011962891
mini_batch_src_global generation:  0.0010502338409423828
r_  generation:  0.009850502014160156
local_output_nid generation:  0.0014514923095703125
local_in_edges_tensor generation:  0.0007946491241455078
mini_batch_src_global generation:  0.0011026859283447266
r_  generation:  0.010303258895874023
local_output_nid generation:  0.0014388561248779297
local_in_edges_tensor generation:  0.0008089542388916016
mini_batch_src_global generation:  0.0011014938354492188
r_  generation:  0.010227441787719727
local_output_nid generation:  0.0014586448669433594
local_in_edges_tensor generation:  0.0007894039154052734
mini_batch_src_global generation:  0.0011191368103027344
r_  generation:  0.010906696319580078
local_output_nid generation:  0.0015020370483398438
local_in_edges_tensor generation:  0.0007927417755126953
mini_batch_src_global generation:  0.001125335693359375
r_  generation:  0.010050535202026367
local_output_nid generation:  0.0014791488647460938
local_in_edges_tensor generation:  0.0007772445678710938
mini_batch_src_global generation:  0.0011053085327148438
r_  generation:  0.009853601455688477
local_output_nid generation:  0.0014927387237548828
local_in_edges_tensor generation:  0.0007796287536621094
mini_batch_src_global generation:  0.0010662078857421875
r_  generation:  0.00991511344909668
local_output_nid generation:  0.0014846324920654297
local_in_edges_tensor generation:  0.0007944107055664062
mini_batch_src_global generation:  0.0011730194091796875
r_  generation:  0.010132074356079102
local_output_nid generation:  0.00146484375
local_in_edges_tensor generation:  0.0007717609405517578
mini_batch_src_global generation:  0.0010607242584228516
r_  generation:  0.009969472885131836
local_output_nid generation:  0.0014884471893310547
local_in_edges_tensor generation:  0.000759124755859375
mini_batch_src_global generation:  0.0010519027709960938
r_  generation:  0.010183334350585938
local_output_nid generation:  0.0014653205871582031
local_in_edges_tensor generation:  0.0007529258728027344
mini_batch_src_global generation:  0.0011746883392333984
r_  generation:  0.010365724563598633
local_output_nid generation:  0.0014495849609375
local_in_edges_tensor generation:  0.00075531005859375
mini_batch_src_global generation:  0.0010347366333007812
r_  generation:  0.009722232818603516
local_output_nid generation:  0.00144195556640625
local_in_edges_tensor generation:  0.0007703304290771484
mini_batch_src_global generation:  0.0010340213775634766
r_  generation:  0.010234594345092773
local_output_nid generation:  0.0014495849609375
local_in_edges_tensor generation:  0.0007884502410888672
mini_batch_src_global generation:  0.0010750293731689453
r_  generation:  0.010133981704711914
local_output_nid generation:  0.0014710426330566406
local_in_edges_tensor generation:  0.0007803440093994141
mini_batch_src_global generation:  0.0011937618255615234
r_  generation:  0.009800195693969727
local_output_nid generation:  0.0014674663543701172
local_in_edges_tensor generation:  0.0007779598236083984
mini_batch_src_global generation:  0.0010859966278076172
r_  generation:  0.00993967056274414
local_output_nid generation:  0.001478433609008789
local_in_edges_tensor generation:  0.0007605552673339844
mini_batch_src_global generation:  0.0010445117950439453
r_  generation:  0.009972095489501953
local_output_nid generation:  0.0014491081237792969
local_in_edges_tensor generation:  0.00563812255859375
mini_batch_src_global generation:  0.0012745857238769531
r_  generation:  0.010530710220336914
local_output_nid generation:  0.0013992786407470703
local_in_edges_tensor generation:  0.0008153915405273438
mini_batch_src_global generation:  0.0011970996856689453
r_  generation:  0.010321378707885742
local_output_nid generation:  0.001413106918334961
local_in_edges_tensor generation:  0.0007741451263427734
mini_batch_src_global generation:  0.001117706298828125
r_  generation:  0.010152101516723633
----------------------check_connections_block total spend ----------------------------- 0.5450541973114014
generate_one_block  0.015649795532226562
generate_one_block  0.014822721481323242
generate_one_block  0.015330791473388672
generate_one_block  0.014447689056396484
generate_one_block  0.014284133911132812
generate_one_block  0.01441812515258789
generate_one_block  0.014459609985351562
generate_one_block  0.014322519302368164
generate_one_block  0.015253543853759766
generate_one_block  0.015093564987182617
generate_one_block  0.015367507934570312
generate_one_block  0.014914512634277344
generate_one_block  0.014805078506469727
generate_one_block  0.01556086540222168
generate_one_block  0.014997005462646484
generate_one_block  0.01581430435180664
generate_one_block  0.015152692794799805
generate_one_block  0.014720439910888672
generate_one_block  0.014884710311889648
generate_one_block  0.015248775482177734
generate_one_block  0.015096426010131836
generate_one_block  0.014950037002563477
generate_one_block  0.015352964401245117
generate_one_block  0.014711618423461914
generate_one_block  0.01494455337524414
generate_one_block  0.01506495475769043
generate_one_block  0.01458740234375
generate_one_block  0.014679431915283203
generate_one_block  0.014571189880371094
generate_one_block  0.01530146598815918
generate_one_block  0.01546621322631836
generate_one_block  0.014707088470458984
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04465913772583008
gen group dst list time:  0.02370762825012207
time for parepare:  0.020035982131958008
local_output_nid generation:  0.00527644157409668
local_in_edges_tensor generation:  0.015339136123657227
mini_batch_src_global generation:  0.016345739364624023
r_  generation:  0.15702128410339355
local_output_nid generation:  0.010281562805175781
local_in_edges_tensor generation:  0.015833377838134766
mini_batch_src_global generation:  0.02117300033569336
r_  generation:  0.1670539379119873
local_output_nid generation:  0.010278463363647461
local_in_edges_tensor generation:  0.013421058654785156
mini_batch_src_global generation:  0.02031397819519043
r_  generation:  0.1765906810760498
local_output_nid generation:  0.013462305068969727
local_in_edges_tensor generation:  0.01164555549621582
mini_batch_src_global generation:  0.020415544509887695
r_  generation:  0.17355895042419434
local_output_nid generation:  0.009927988052368164
local_in_edges_tensor generation:  0.012401580810546875
mini_batch_src_global generation:  0.02073526382446289
r_  generation:  0.17210721969604492
local_output_nid generation:  0.010112762451171875
local_in_edges_tensor generation:  0.012705802917480469
mini_batch_src_global generation:  0.025549650192260742
r_  generation:  0.1793346405029297
local_output_nid generation:  0.010199546813964844
local_in_edges_tensor generation:  0.011157035827636719
mini_batch_src_global generation:  0.021507978439331055
r_  generation:  0.17742061614990234
local_output_nid generation:  0.010276079177856445
local_in_edges_tensor generation:  0.011883974075317383
mini_batch_src_global generation:  0.025035858154296875
r_  generation:  0.18683505058288574
local_output_nid generation:  0.012921571731567383
local_in_edges_tensor generation:  0.027675628662109375
mini_batch_src_global generation:  0.023516416549682617
r_  generation:  0.17993688583374023
local_output_nid generation:  0.008355855941772461
local_in_edges_tensor generation:  0.00993490219116211
mini_batch_src_global generation:  0.02282571792602539
r_  generation:  0.17589402198791504
local_output_nid generation:  0.008359193801879883
local_in_edges_tensor generation:  0.010639429092407227
mini_batch_src_global generation:  0.02250814437866211
r_  generation:  0.1788642406463623
local_output_nid generation:  0.008331298828125
local_in_edges_tensor generation:  0.012135505676269531
mini_batch_src_global generation:  0.02383708953857422
r_  generation:  0.17735934257507324
local_output_nid generation:  0.008231401443481445
local_in_edges_tensor generation:  0.009169578552246094
mini_batch_src_global generation:  0.02292013168334961
r_  generation:  0.17366337776184082
local_output_nid generation:  0.00845789909362793
local_in_edges_tensor generation:  0.010265827178955078
mini_batch_src_global generation:  0.024961471557617188
r_  generation:  0.1844007968902588
local_output_nid generation:  0.008400678634643555
local_in_edges_tensor generation:  0.011808156967163086
mini_batch_src_global generation:  0.023510217666625977
r_  generation:  0.17902088165283203
local_output_nid generation:  0.008639097213745117
local_in_edges_tensor generation:  0.01242828369140625
mini_batch_src_global generation:  0.02512335777282715
r_  generation:  0.18727588653564453
local_output_nid generation:  0.008322715759277344
local_in_edges_tensor generation:  0.009510278701782227
mini_batch_src_global generation:  0.023372650146484375
r_  generation:  0.18135690689086914
local_output_nid generation:  0.008374452590942383
local_in_edges_tensor generation:  0.009105443954467773
mini_batch_src_global generation:  0.0233762264251709
r_  generation:  0.19059014320373535
local_output_nid generation:  0.00828409194946289
local_in_edges_tensor generation:  0.008994340896606445
mini_batch_src_global generation:  0.022662639617919922
r_  generation:  0.18225598335266113
local_output_nid generation:  0.009519815444946289
local_in_edges_tensor generation:  0.016970396041870117
mini_batch_src_global generation:  0.023712635040283203
r_  generation:  0.18468260765075684
local_output_nid generation:  0.00843501091003418
local_in_edges_tensor generation:  0.012078285217285156
mini_batch_src_global generation:  0.0239410400390625
r_  generation:  0.1833021640777588
local_output_nid generation:  0.008267641067504883
local_in_edges_tensor generation:  0.012063264846801758
mini_batch_src_global generation:  0.023511886596679688
r_  generation:  0.1816871166229248
local_output_nid generation:  0.008619070053100586
local_in_edges_tensor generation:  0.013824701309204102
mini_batch_src_global generation:  0.024588823318481445
r_  generation:  0.18659043312072754
local_output_nid generation:  0.008224010467529297
local_in_edges_tensor generation:  0.01000070571899414
mini_batch_src_global generation:  0.023324251174926758
r_  generation:  0.17741703987121582
local_output_nid generation:  0.008446931838989258
local_in_edges_tensor generation:  0.008986473083496094
mini_batch_src_global generation:  0.02391982078552246
r_  generation:  0.18181157112121582
local_output_nid generation:  0.008322477340698242
local_in_edges_tensor generation:  0.009125709533691406
mini_batch_src_global generation:  0.023604631423950195
r_  generation:  0.18429327011108398
local_output_nid generation:  0.008383750915527344
local_in_edges_tensor generation:  0.009142637252807617
mini_batch_src_global generation:  0.023151397705078125
r_  generation:  0.17785334587097168
local_output_nid generation:  0.008189201354980469
local_in_edges_tensor generation:  0.010471105575561523
mini_batch_src_global generation:  0.022385120391845703
r_  generation:  0.1779470443725586
local_output_nid generation:  0.008231639862060547
local_in_edges_tensor generation:  0.010336160659790039
mini_batch_src_global generation:  0.02387690544128418
r_  generation:  0.17638921737670898
local_output_nid generation:  0.008582830429077148
local_in_edges_tensor generation:  0.012230634689331055
mini_batch_src_global generation:  0.023946523666381836
r_  generation:  0.18596148490905762
local_output_nid generation:  0.008406877517700195
local_in_edges_tensor generation:  0.010722160339355469
mini_batch_src_global generation:  0.024132490158081055
r_  generation:  0.18761110305786133
local_output_nid generation:  0.008376836776733398
local_in_edges_tensor generation:  0.009270668029785156
mini_batch_src_global generation:  0.02337193489074707
r_  generation:  0.17864346504211426
----------------------check_connections_block total spend ----------------------------- 8.491304636001587
generate_one_block  0.24204778671264648
generate_one_block  0.22938990592956543
generate_one_block  0.268749475479126
generate_one_block  0.2446744441986084
generate_one_block  0.2189321517944336
generate_one_block  0.2263331413269043
generate_one_block  0.23159074783325195
generate_one_block  0.2246105670928955
generate_one_block  0.23696279525756836
generate_one_block  0.23983025550842285
generate_one_block  0.22859549522399902
generate_one_block  0.2293989658355713
generate_one_block  0.22439217567443848
generate_one_block  0.2378396987915039
generate_one_block  0.22954726219177246
generate_one_block  0.27158498764038086
generate_one_block  0.22722864151000977
generate_one_block  0.22690725326538086
generate_one_block  0.22177910804748535
generate_one_block  0.23936748504638672
generate_one_block  0.23426413536071777
generate_one_block  0.2295820713043213
generate_one_block  0.23776555061340332
generate_one_block  0.22944927215576172
generate_one_block  0.22926950454711914
generate_one_block  0.266387939453125
generate_one_block  0.23017358779907227
generate_one_block  0.22166109085083008
generate_one_block  0.22343850135803223
generate_one_block  0.24840164184570312
generate_one_block  0.2755866050720215
generate_one_block  0.23546099662780762
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.07571196556091309
gen group dst list time:  0.11622858047485352
time for parepare:  0.0205538272857666
local_output_nid generation:  0.023558855056762695
local_in_edges_tensor generation:  0.05505061149597168
mini_batch_src_global generation:  0.05209970474243164
r_  generation:  0.4729480743408203
local_output_nid generation:  0.029665708541870117
local_in_edges_tensor generation:  0.053128719329833984
mini_batch_src_global generation:  0.05979204177856445
r_  generation:  0.5067665576934814
local_output_nid generation:  0.030380725860595703
local_in_edges_tensor generation:  0.04447531700134277
mini_batch_src_global generation:  0.05803251266479492
r_  generation:  0.5018191337585449
local_output_nid generation:  0.02929997444152832
local_in_edges_tensor generation:  0.05679178237915039
mini_batch_src_global generation:  0.07662463188171387
r_  generation:  0.48945093154907227
local_output_nid generation:  0.030886411666870117
local_in_edges_tensor generation:  0.04300498962402344
mini_batch_src_global generation:  0.05826449394226074
r_  generation:  0.49109625816345215
local_output_nid generation:  0.028940200805664062
local_in_edges_tensor generation:  0.04895448684692383
mini_batch_src_global generation:  0.058594703674316406
r_  generation:  0.4955432415008545
local_output_nid generation:  0.02868485450744629
local_in_edges_tensor generation:  0.03490471839904785
mini_batch_src_global generation:  0.058724403381347656
r_  generation:  0.5153110027313232
local_output_nid generation:  0.028896093368530273
local_in_edges_tensor generation:  0.04818081855773926
mini_batch_src_global generation:  0.06281018257141113
r_  generation:  0.4958076477050781
local_output_nid generation:  0.02980661392211914
local_in_edges_tensor generation:  0.06868481636047363
mini_batch_src_global generation:  0.06446146965026855
r_  generation:  0.5025539398193359
local_output_nid generation:  0.02973628044128418
local_in_edges_tensor generation:  0.04943084716796875
mini_batch_src_global generation:  0.0735921859741211
r_  generation:  0.5025069713592529
local_output_nid generation:  0.03142523765563965
local_in_edges_tensor generation:  0.03493833541870117
mini_batch_src_global generation:  0.06249713897705078
r_  generation:  0.5036709308624268
local_output_nid generation:  0.028806686401367188
local_in_edges_tensor generation:  0.03998160362243652
mini_batch_src_global generation:  0.06012272834777832
r_  generation:  0.5074174404144287
local_output_nid generation:  0.028746604919433594
local_in_edges_tensor generation:  0.0408167839050293
mini_batch_src_global generation:  0.059264421463012695
r_  generation:  0.5050573348999023
local_output_nid generation:  0.028851747512817383
local_in_edges_tensor generation:  0.048899173736572266
mini_batch_src_global generation:  0.06012463569641113
r_  generation:  0.4967026710510254
local_output_nid generation:  0.029239416122436523
local_in_edges_tensor generation:  0.050156593322753906
mini_batch_src_global generation:  0.05968427658081055
r_  generation:  0.5030028820037842
local_output_nid generation:  0.029560565948486328
local_in_edges_tensor generation:  0.03665041923522949
mini_batch_src_global generation:  0.060871124267578125
r_  generation:  0.4962129592895508
local_output_nid generation:  0.028746843338012695
local_in_edges_tensor generation:  0.031568050384521484
mini_batch_src_global generation:  0.060353994369506836
r_  generation:  0.5045132637023926
local_output_nid generation:  0.029632091522216797
local_in_edges_tensor generation:  0.0383913516998291
mini_batch_src_global generation:  0.08038926124572754
r_  generation:  0.4965400695800781
local_output_nid generation:  0.030458927154541016
local_in_edges_tensor generation:  0.03744769096374512
mini_batch_src_global generation:  0.06229233741760254
r_  generation:  0.49901437759399414
local_output_nid generation:  0.028920650482177734
local_in_edges_tensor generation:  0.03040480613708496
mini_batch_src_global generation:  0.06152224540710449
r_  generation:  0.495424747467041
local_output_nid generation:  0.029066085815429688
local_in_edges_tensor generation:  0.03984832763671875
mini_batch_src_global generation:  0.0742795467376709
r_  generation:  0.5005550384521484
local_output_nid generation:  0.02894735336303711
local_in_edges_tensor generation:  0.030603408813476562
mini_batch_src_global generation:  0.06166386604309082
r_  generation:  0.497023344039917
local_output_nid generation:  0.029592275619506836
local_in_edges_tensor generation:  0.04636025428771973
mini_batch_src_global generation:  0.06422185897827148
r_  generation:  0.5027017593383789
local_output_nid generation:  0.028919219970703125
local_in_edges_tensor generation:  0.04102301597595215
mini_batch_src_global generation:  0.06073927879333496
r_  generation:  0.5104753971099854
local_output_nid generation:  0.029979467391967773
local_in_edges_tensor generation:  0.03506588935852051
mini_batch_src_global generation:  0.07801628112792969
r_  generation:  0.5048515796661377
local_output_nid generation:  0.02918267250061035
local_in_edges_tensor generation:  0.034888505935668945
mini_batch_src_global generation:  0.06384420394897461
r_  generation:  0.514737606048584
local_output_nid generation:  0.029249191284179688
local_in_edges_tensor generation:  0.04270219802856445
mini_batch_src_global generation:  0.06605720520019531
r_  generation:  0.49775052070617676
local_output_nid generation:  0.029004812240600586
local_in_edges_tensor generation:  0.037322998046875
mini_batch_src_global generation:  0.06168484687805176
r_  generation:  0.4999806880950928
local_output_nid generation:  0.031058073043823242
local_in_edges_tensor generation:  0.033193111419677734
mini_batch_src_global generation:  0.061067819595336914
r_  generation:  0.49808311462402344
local_output_nid generation:  0.02914714813232422
local_in_edges_tensor generation:  0.03986382484436035
mini_batch_src_global generation:  0.0638730525970459
r_  generation:  0.4991447925567627
local_output_nid generation:  0.02945089340209961
local_in_edges_tensor generation:  0.039809226989746094
mini_batch_src_global generation:  0.06132698059082031
r_  generation:  0.511338472366333
local_output_nid generation:  0.02903008460998535
local_in_edges_tensor generation:  0.030886173248291016
mini_batch_src_global generation:  0.060953378677368164
r_  generation:  0.49811339378356934
----------------------check_connections_block total spend ----------------------------- 23.82438325881958
generate_one_block  0.7649450302124023
generate_one_block  0.6534154415130615
generate_one_block  0.6349170207977295
generate_one_block  0.6429164409637451
generate_one_block  0.6339635848999023
generate_one_block  0.661156415939331
generate_one_block  0.6328799724578857
generate_one_block  0.6430099010467529
generate_one_block  0.655587911605835
generate_one_block  0.6529467105865479
generate_one_block  0.6497128009796143
generate_one_block  0.644066333770752
generate_one_block  0.6316487789154053
generate_one_block  0.6480922698974609
generate_one_block  0.6605525016784668
generate_one_block  0.6532666683197021
generate_one_block  0.6327390670776367
generate_one_block  0.6447136402130127
generate_one_block  0.6443521976470947
generate_one_block  0.6447155475616455
generate_one_block  0.667445182800293
generate_one_block  0.6303043365478516
generate_one_block  0.6686840057373047
generate_one_block  0.640582799911499
generate_one_block  0.6359496116638184
generate_one_block  0.6616504192352295
generate_one_block  0.653388500213623
generate_one_block  0.6361761093139648
generate_one_block  0.6287014484405518
generate_one_block  0.661801815032959
generate_one_block  0.6591646671295166
generate_one_block  0.632277250289917
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

connection checking time:  32.31568789482117
block generation total time  28.36692762374878
average batch blocks generation time:  0.8864664882421494
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1737060546875 GB
    Memory Allocated: 0.08868741989135742  GigaBytes
Max Memory Allocated: 0.08868741989135742  GigaBytes

torch.Size([150413, 128])
torch.Size([109685, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7186279296875 GB
    Memory Allocated: 0.3838338851928711  GigaBytes
Max Memory Allocated: 0.39519834518432617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.08943653106689453  GigaBytes
Max Memory Allocated: 0.44065332412719727  GigaBytes

torch.Size([150300, 128])
torch.Size([109957, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.385312557220459  GigaBytes
Max Memory Allocated: 0.44065332412719727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.08958053588867188  GigaBytes
Max Memory Allocated: 0.44130992889404297  GigaBytes

torch.Size([149964, 128])
torch.Size([109713, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.3864011764526367  GigaBytes
Max Memory Allocated: 0.44130992889404297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.08930492401123047  GigaBytes
Max Memory Allocated: 0.4413337707519531  GigaBytes

torch.Size([150303, 128])
torch.Size([109905, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.3825368881225586  GigaBytes
Max Memory Allocated: 0.4413337707519531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.0882415771484375  GigaBytes
Max Memory Allocated: 0.4413337707519531  GigaBytes

torch.Size([149498, 128])
torch.Size([108430, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.37650489807128906  GigaBytes
Max Memory Allocated: 0.4413337707519531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.08942604064941406  GigaBytes
Max Memory Allocated: 0.4413337707519531  GigaBytes

torch.Size([150505, 128])
torch.Size([110293, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.38396310806274414  GigaBytes
Max Memory Allocated: 0.4413337707519531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.08930015563964844  GigaBytes
Max Memory Allocated: 0.4413337707519531  GigaBytes

torch.Size([150113, 128])
torch.Size([108976, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.38370656967163086  GigaBytes
Max Memory Allocated: 0.4413337707519531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.08939075469970703  GigaBytes
Max Memory Allocated: 0.4413337707519531  GigaBytes

torch.Size([150132, 128])
torch.Size([109209, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.38388776779174805  GigaBytes
Max Memory Allocated: 0.4413337707519531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.08961868286132812  GigaBytes
Max Memory Allocated: 0.4413337707519531  GigaBytes

torch.Size([150243, 128])
torch.Size([109839, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.38593053817749023  GigaBytes
Max Memory Allocated: 0.4413337707519531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.08946037292480469  GigaBytes
Max Memory Allocated: 0.44190454483032227  GigaBytes

torch.Size([150522, 128])
torch.Size([110186, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.38561344146728516  GigaBytes
Max Memory Allocated: 0.44190454483032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.08952617645263672  GigaBytes
Max Memory Allocated: 0.44190454483032227  GigaBytes

torch.Size([150425, 128])
torch.Size([110257, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.3857264518737793  GigaBytes
Max Memory Allocated: 0.44190454483032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.08951663970947266  GigaBytes
Max Memory Allocated: 0.4422183036804199  GigaBytes

torch.Size([150351, 128])
torch.Size([109980, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.3856806755065918  GigaBytes
Max Memory Allocated: 0.4422183036804199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.08936023712158203  GigaBytes
Max Memory Allocated: 0.4422183036804199  GigaBytes

torch.Size([150100, 128])
torch.Size([108913, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.38382816314697266  GigaBytes
Max Memory Allocated: 0.4422183036804199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.08965873718261719  GigaBytes
Max Memory Allocated: 0.4422183036804199  GigaBytes

torch.Size([150009, 128])
torch.Size([109796, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.38632774353027344  GigaBytes
Max Memory Allocated: 0.4422183036804199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.08953666687011719  GigaBytes
Max Memory Allocated: 0.4422183036804199  GigaBytes

torch.Size([150197, 128])
torch.Size([110240, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.38553571701049805  GigaBytes
Max Memory Allocated: 0.4422183036804199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.08976364135742188  GigaBytes
Max Memory Allocated: 0.44248008728027344  GigaBytes

torch.Size([150241, 128])
torch.Size([109949, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.3873023986816406  GigaBytes
Max Memory Allocated: 0.44248008728027344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.08946704864501953  GigaBytes
Max Memory Allocated: 0.44248008728027344  GigaBytes

torch.Size([150331, 128])
torch.Size([109689, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.3849306106567383  GigaBytes
Max Memory Allocated: 0.44248008728027344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.08946895599365234  GigaBytes
Max Memory Allocated: 0.44248008728027344  GigaBytes

torch.Size([150384, 128])
torch.Size([109664, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.3853750228881836  GigaBytes
Max Memory Allocated: 0.44248008728027344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.08937644958496094  GigaBytes
Max Memory Allocated: 0.44248008728027344  GigaBytes

torch.Size([150062, 128])
torch.Size([109549, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.3848867416381836  GigaBytes
Max Memory Allocated: 0.44248008728027344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.08963298797607422  GigaBytes
Max Memory Allocated: 0.44248008728027344  GigaBytes

torch.Size([149694, 128])
torch.Size([109261, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.3861813545227051  GigaBytes
Max Memory Allocated: 0.44248008728027344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.08958244323730469  GigaBytes
Max Memory Allocated: 0.44248008728027344  GigaBytes

torch.Size([149873, 128])
torch.Size([109512, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.38579797744750977  GigaBytes
Max Memory Allocated: 0.44248008728027344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.0895071029663086  GigaBytes
Max Memory Allocated: 0.44248008728027344  GigaBytes

torch.Size([150190, 128])
torch.Size([109227, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.38489770889282227  GigaBytes
Max Memory Allocated: 0.44248008728027344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.08975887298583984  GigaBytes
Max Memory Allocated: 0.44248008728027344  GigaBytes

torch.Size([150449, 128])
torch.Size([110858, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1385498046875 GB
    Memory Allocated: 0.3880472183227539  GigaBytes
Max Memory Allocated: 0.44248008728027344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.08939647674560547  GigaBytes
Max Memory Allocated: 0.4425544738769531  GigaBytes

torch.Size([150066, 128])
torch.Size([109420, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.38390064239501953  GigaBytes
Max Memory Allocated: 0.4425544738769531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.08956146240234375  GigaBytes
Max Memory Allocated: 0.4425544738769531  GigaBytes

torch.Size([149638, 128])
torch.Size([109389, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.3857541084289551  GigaBytes
Max Memory Allocated: 0.4425544738769531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.0896148681640625  GigaBytes
Max Memory Allocated: 0.4425544738769531  GigaBytes

torch.Size([150435, 128])
torch.Size([110366, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.38573265075683594  GigaBytes
Max Memory Allocated: 0.4425544738769531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.08942413330078125  GigaBytes
Max Memory Allocated: 0.4425544738769531  GigaBytes

torch.Size([150692, 128])
torch.Size([110176, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.3840904235839844  GigaBytes
Max Memory Allocated: 0.4425544738769531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.08929634094238281  GigaBytes
Max Memory Allocated: 0.4425544738769531  GigaBytes

torch.Size([150235, 128])
torch.Size([109253, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.3836989402770996  GigaBytes
Max Memory Allocated: 0.4425544738769531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.08933067321777344  GigaBytes
Max Memory Allocated: 0.4425544738769531  GigaBytes

torch.Size([150568, 128])
torch.Size([109583, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.3837728500366211  GigaBytes
Max Memory Allocated: 0.4425544738769531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.08971977233886719  GigaBytes
Max Memory Allocated: 0.4425544738769531  GigaBytes

torch.Size([150652, 128])
torch.Size([110892, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.3873114585876465  GigaBytes
Max Memory Allocated: 0.4425544738769531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.08975982666015625  GigaBytes
Max Memory Allocated: 0.4425544738769531  GigaBytes

torch.Size([150370, 128])
torch.Size([110576, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.3865351676940918  GigaBytes
Max Memory Allocated: 0.4425544738769531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.08939075469970703  GigaBytes
Max Memory Allocated: 0.4425544738769531  GigaBytes

torch.Size([150314, 128])
torch.Size([109849, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.3852267265319824  GigaBytes
Max Memory Allocated: 0.4425544738769531  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03352498263120651 |0.026957683265209198 |0.026600897312164307 |9.479373693466187e-05 |0.004911117255687714 |0.00174713134765625 |
----------------------------------------------------------pseudo_mini_loss sum 5.664363384246826
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9159047
Number of first layer input nodes during this epoch:  4807269
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.11201763153076172  GigaBytes
Max Memory Allocated: 0.4425544738769531  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022023677825927734
random selection method range initialization spend 0.0051577091217041016
time for parepare:  0.018262147903442383
local_output_nid generation:  0.0015642642974853516
local_in_edges_tensor generation:  0.008908510208129883
mini_batch_src_global generation:  0.002176046371459961
r_  generation:  0.010574817657470703
local_output_nid generation:  0.0016891956329345703
local_in_edges_tensor generation:  0.0011491775512695312
mini_batch_src_global generation:  0.0016241073608398438
r_  generation:  0.009808063507080078
local_output_nid generation:  0.0017688274383544922
local_in_edges_tensor generation:  0.0009474754333496094
mini_batch_src_global generation:  0.001262664794921875
r_  generation:  0.009262561798095703
local_output_nid generation:  0.0017821788787841797
local_in_edges_tensor generation:  0.0009827613830566406
mini_batch_src_global generation:  0.001216888427734375
r_  generation:  0.009550094604492188
local_output_nid generation:  0.0017993450164794922
local_in_edges_tensor generation:  0.000926971435546875
mini_batch_src_global generation:  0.001150369644165039
r_  generation:  0.009407281875610352
local_output_nid generation:  0.0018033981323242188
local_in_edges_tensor generation:  0.0009558200836181641
mini_batch_src_global generation:  0.0012128353118896484
r_  generation:  0.009862899780273438
local_output_nid generation:  0.0018162727355957031
local_in_edges_tensor generation:  0.0008995532989501953
mini_batch_src_global generation:  0.0011582374572753906
r_  generation:  0.009559869766235352
local_output_nid generation:  0.001821279525756836
local_in_edges_tensor generation:  0.0009136199951171875
mini_batch_src_global generation:  0.0011408329010009766
r_  generation:  0.009784936904907227
local_output_nid generation:  0.0018012523651123047
local_in_edges_tensor generation:  0.0008912086486816406
mini_batch_src_global generation:  0.0011298656463623047
r_  generation:  0.009609699249267578
local_output_nid generation:  0.0018050670623779297
local_in_edges_tensor generation:  0.0008904933929443359
mini_batch_src_global generation:  0.0011508464813232422
r_  generation:  0.009728431701660156
local_output_nid generation:  0.0018362998962402344
local_in_edges_tensor generation:  0.0008559226989746094
mini_batch_src_global generation:  0.0010960102081298828
r_  generation:  0.009107351303100586
local_output_nid generation:  0.001880645751953125
local_in_edges_tensor generation:  0.0008902549743652344
mini_batch_src_global generation:  0.0011241436004638672
r_  generation:  0.009890317916870117
local_output_nid generation:  0.0018284320831298828
local_in_edges_tensor generation:  0.000873565673828125
mini_batch_src_global generation:  0.0011200904846191406
r_  generation:  0.009855031967163086
local_output_nid generation:  0.0018494129180908203
local_in_edges_tensor generation:  0.00090789794921875
mini_batch_src_global generation:  0.0011851787567138672
r_  generation:  0.010225057601928711
local_output_nid generation:  0.004586219787597656
local_in_edges_tensor generation:  0.0010211467742919922
mini_batch_src_global generation:  0.001168966293334961
r_  generation:  0.010215044021606445
local_output_nid generation:  0.0018486976623535156
local_in_edges_tensor generation:  0.0008966922760009766
mini_batch_src_global generation:  0.0011255741119384766
r_  generation:  0.009972810745239258
local_output_nid generation:  0.0018391609191894531
local_in_edges_tensor generation:  0.0008640289306640625
mini_batch_src_global generation:  0.0011324882507324219
r_  generation:  0.009752273559570312
local_output_nid generation:  0.0018024444580078125
local_in_edges_tensor generation:  0.0008823871612548828
mini_batch_src_global generation:  0.0010938644409179688
r_  generation:  0.010041475296020508
local_output_nid generation:  0.0018520355224609375
local_in_edges_tensor generation:  0.0009675025939941406
mini_batch_src_global generation:  0.001445770263671875
r_  generation:  0.010518074035644531
local_output_nid generation:  0.0018665790557861328
local_in_edges_tensor generation:  0.0009474754333496094
mini_batch_src_global generation:  0.0012021064758300781
r_  generation:  0.009962797164916992
local_output_nid generation:  0.0018649101257324219
local_in_edges_tensor generation:  0.0009367465972900391
mini_batch_src_global generation:  0.0011599063873291016
r_  generation:  0.010265350341796875
local_output_nid generation:  0.0019698143005371094
local_in_edges_tensor generation:  0.0009438991546630859
mini_batch_src_global generation:  0.0011987686157226562
r_  generation:  0.009840011596679688
local_output_nid generation:  0.0018699169158935547
local_in_edges_tensor generation:  0.0009133815765380859
mini_batch_src_global generation:  0.0011348724365234375
r_  generation:  0.009696245193481445
local_output_nid generation:  0.0018525123596191406
local_in_edges_tensor generation:  0.0008749961853027344
mini_batch_src_global generation:  0.0012104511260986328
r_  generation:  0.01004934310913086
local_output_nid generation:  0.0018601417541503906
local_in_edges_tensor generation:  0.0009009838104248047
mini_batch_src_global generation:  0.0011818408966064453
r_  generation:  0.010202646255493164
local_output_nid generation:  0.0018393993377685547
local_in_edges_tensor generation:  0.0009009838104248047
mini_batch_src_global generation:  0.0012128353118896484
r_  generation:  0.01010894775390625
local_output_nid generation:  0.0018401145935058594
local_in_edges_tensor generation:  0.0008924007415771484
mini_batch_src_global generation:  0.0011332035064697266
r_  generation:  0.009585142135620117
local_output_nid generation:  0.0018458366394042969
local_in_edges_tensor generation:  0.0009479522705078125
mini_batch_src_global generation:  0.0012552738189697266
r_  generation:  0.010974407196044922
local_output_nid generation:  0.0018649101257324219
local_in_edges_tensor generation:  0.0009057521820068359
mini_batch_src_global generation:  0.0011355876922607422
r_  generation:  0.009516716003417969
local_output_nid generation:  0.0018672943115234375
local_in_edges_tensor generation:  0.0009112358093261719
mini_batch_src_global generation:  0.0011639595031738281
r_  generation:  0.009955644607543945
local_output_nid generation:  0.0018393993377685547
local_in_edges_tensor generation:  0.0009226799011230469
mini_batch_src_global generation:  0.001155853271484375
r_  generation:  0.010530233383178711
local_output_nid generation:  0.0018694400787353516
local_in_edges_tensor generation:  0.0009257793426513672
mini_batch_src_global generation:  0.0011944770812988281
r_  generation:  0.010294914245605469
----------------------check_connections_block total spend ----------------------------- 0.5739061832427979
generate_one_block  0.03541231155395508
generate_one_block  0.01829051971435547
generate_one_block  0.01484990119934082
generate_one_block  0.015225410461425781
generate_one_block  0.014577865600585938
generate_one_block  0.018124103546142578
generate_one_block  0.01473546028137207
generate_one_block  0.01507711410522461
generate_one_block  0.014754772186279297
generate_one_block  0.014938831329345703
generate_one_block  0.013994932174682617
generate_one_block  0.018008708953857422
generate_one_block  0.015108346939086914
generate_one_block  0.01593780517578125
generate_one_block  0.01565694808959961
generate_one_block  0.014942407608032227
generate_one_block  0.01468205451965332
generate_one_block  0.01475381851196289
generate_one_block  0.01820206642150879
generate_one_block  0.015431880950927734
generate_one_block  0.014987945556640625
generate_one_block  0.014594554901123047
generate_one_block  0.01441049575805664
generate_one_block  0.015083074569702148
generate_one_block  0.015657424926757812
generate_one_block  0.01795482635498047
generate_one_block  0.014542341232299805
generate_one_block  0.016022205352783203
generate_one_block  0.014122486114501953
generate_one_block  0.015363216400146484
generate_one_block  0.0151214599609375
generate_one_block  0.01594829559326172
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04694843292236328
gen group dst list time:  0.021395206451416016
time for parepare:  0.019068241119384766
local_output_nid generation:  0.005475282669067383
local_in_edges_tensor generation:  0.01790785789489746
mini_batch_src_global generation:  0.017403602600097656
r_  generation:  0.1700422763824463
local_output_nid generation:  0.008512020111083984
local_in_edges_tensor generation:  0.01537013053894043
mini_batch_src_global generation:  0.021255016326904297
r_  generation:  0.1704578399658203
local_output_nid generation:  0.008487224578857422
local_in_edges_tensor generation:  0.03276681900024414
mini_batch_src_global generation:  0.021816015243530273
r_  generation:  0.15980744361877441
local_output_nid generation:  0.011588335037231445
local_in_edges_tensor generation:  0.012372732162475586
mini_batch_src_global generation:  0.02059030532836914
r_  generation:  0.1779019832611084
local_output_nid generation:  0.008403301239013672
local_in_edges_tensor generation:  0.012363672256469727
mini_batch_src_global generation:  0.02178192138671875
r_  generation:  0.17643022537231445
local_output_nid generation:  0.008297443389892578
local_in_edges_tensor generation:  0.011389970779418945
mini_batch_src_global generation:  0.025440216064453125
r_  generation:  0.18610119819641113
local_output_nid generation:  0.008931159973144531
local_in_edges_tensor generation:  0.011243581771850586
mini_batch_src_global generation:  0.023080825805664062
r_  generation:  0.18941688537597656
local_output_nid generation:  0.010537385940551758
local_in_edges_tensor generation:  0.021239042282104492
mini_batch_src_global generation:  0.024266719818115234
r_  generation:  0.17943286895751953
local_output_nid generation:  0.00847768783569336
local_in_edges_tensor generation:  0.01202535629272461
mini_batch_src_global generation:  0.022485733032226562
r_  generation:  0.17345499992370605
local_output_nid generation:  0.008874893188476562
local_in_edges_tensor generation:  0.011121749877929688
mini_batch_src_global generation:  0.02295708656311035
r_  generation:  0.17992520332336426
local_output_nid generation:  0.008466958999633789
local_in_edges_tensor generation:  0.009055376052856445
mini_batch_src_global generation:  0.021586894989013672
r_  generation:  0.16658520698547363
local_output_nid generation:  0.008899211883544922
local_in_edges_tensor generation:  0.012841939926147461
mini_batch_src_global generation:  0.022969484329223633
r_  generation:  0.18185639381408691
local_output_nid generation:  0.008789300918579102
local_in_edges_tensor generation:  0.012711048126220703
mini_batch_src_global generation:  0.023505210876464844
r_  generation:  0.1810746192932129
local_output_nid generation:  0.009205341339111328
local_in_edges_tensor generation:  0.013188600540161133
mini_batch_src_global generation:  0.025295019149780273
r_  generation:  0.18817996978759766
local_output_nid generation:  0.009008407592773438
local_in_edges_tensor generation:  0.009899139404296875
mini_batch_src_global generation:  0.023863792419433594
r_  generation:  0.18218159675598145
local_output_nid generation:  0.008815526962280273
local_in_edges_tensor generation:  0.00965738296508789
mini_batch_src_global generation:  0.02308368682861328
r_  generation:  0.17967581748962402
local_output_nid generation:  0.00874638557434082
local_in_edges_tensor generation:  0.01083230972290039
mini_batch_src_global generation:  0.0280606746673584
r_  generation:  0.1785295009613037
local_output_nid generation:  0.008713960647583008
local_in_edges_tensor generation:  0.011029958724975586
mini_batch_src_global generation:  0.024017333984375
r_  generation:  0.18718981742858887
local_output_nid generation:  0.008914470672607422
local_in_edges_tensor generation:  0.01134037971496582
mini_batch_src_global generation:  0.02496957778930664
r_  generation:  0.18704700469970703
local_output_nid generation:  0.008625268936157227
local_in_edges_tensor generation:  0.01129460334777832
mini_batch_src_global generation:  0.023398637771606445
r_  generation:  0.17815589904785156
local_output_nid generation:  0.008505582809448242
local_in_edges_tensor generation:  0.022603750228881836
mini_batch_src_global generation:  0.023749351501464844
r_  generation:  0.18567967414855957
local_output_nid generation:  0.009010791778564453
local_in_edges_tensor generation:  0.02701401710510254
mini_batch_src_global generation:  0.023056507110595703
r_  generation:  0.1863875389099121
local_output_nid generation:  0.010401725769042969
local_in_edges_tensor generation:  0.01203012466430664
mini_batch_src_global generation:  0.025209903717041016
r_  generation:  0.17443442344665527
local_output_nid generation:  0.008527040481567383
local_in_edges_tensor generation:  0.013058185577392578
mini_batch_src_global generation:  0.022963523864746094
r_  generation:  0.18117070198059082
local_output_nid generation:  0.008581399917602539
local_in_edges_tensor generation:  0.009059667587280273
mini_batch_src_global generation:  0.023328781127929688
r_  generation:  0.18567371368408203
local_output_nid generation:  0.008481025695800781
local_in_edges_tensor generation:  0.010239362716674805
mini_batch_src_global generation:  0.023403406143188477
r_  generation:  0.18078994750976562
local_output_nid generation:  0.00824284553527832
local_in_edges_tensor generation:  0.010110616683959961
mini_batch_src_global generation:  0.0399632453918457
r_  generation:  0.18066191673278809
local_output_nid generation:  0.008764982223510742
local_in_edges_tensor generation:  0.012340784072875977
mini_batch_src_global generation:  0.024196147918701172
r_  generation:  0.18758249282836914
local_output_nid generation:  0.007932186126708984
local_in_edges_tensor generation:  0.0114288330078125
mini_batch_src_global generation:  0.022740840911865234
r_  generation:  0.17348694801330566
local_output_nid generation:  0.008643150329589844
local_in_edges_tensor generation:  0.008842706680297852
mini_batch_src_global generation:  0.024523258209228516
r_  generation:  0.19796514511108398
local_output_nid generation:  0.009251117706298828
local_in_edges_tensor generation:  0.010484933853149414
mini_batch_src_global generation:  0.02378988265991211
r_  generation:  0.1757640838623047
local_output_nid generation:  0.008737564086914062
local_in_edges_tensor generation:  0.010467052459716797
mini_batch_src_global generation:  0.025252580642700195
r_  generation:  0.191514253616333
----------------------check_connections_block total spend ----------------------------- 8.557757377624512
generate_one_block  0.25133562088012695
generate_one_block  0.2214517593383789
generate_one_block  0.20968389511108398
generate_one_block  0.23343324661254883
generate_one_block  0.24189972877502441
generate_one_block  0.2369835376739502
generate_one_block  0.22232723236083984
generate_one_block  0.23338603973388672
generate_one_block  0.22243833541870117
generate_one_block  0.23006868362426758
generate_one_block  0.20580625534057617
generate_one_block  0.23220610618591309
generate_one_block  0.2320399284362793
generate_one_block  0.23781991004943848
generate_one_block  0.22742152214050293
generate_one_block  0.22595953941345215
generate_one_block  0.22022414207458496
generate_one_block  0.2212057113647461
generate_one_block  0.2363743782043457
generate_one_block  0.25847339630126953
generate_one_block  0.22577595710754395
generate_one_block  0.21587586402893066
generate_one_block  0.21562743186950684
generate_one_block  0.2267930507659912
generate_one_block  0.233795166015625
generate_one_block  0.22559428215026855
generate_one_block  0.21866774559020996
generate_one_block  0.243574857711792
generate_one_block  0.21756744384765625
generate_one_block  0.2298283576965332
generate_one_block  0.22102046012878418
generate_one_block  0.24267864227294922
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.06065702438354492
gen group dst list time:  0.10591697692871094
time for parepare:  0.017913341522216797
local_output_nid generation:  0.02370309829711914
local_in_edges_tensor generation:  0.06400585174560547
mini_batch_src_global generation:  0.059891462326049805
r_  generation:  0.5240459442138672
local_output_nid generation:  0.03029012680053711
local_in_edges_tensor generation:  0.04600644111633301
mini_batch_src_global generation:  0.06373381614685059
r_  generation:  0.5183203220367432
local_output_nid generation:  0.0296633243560791
local_in_edges_tensor generation:  0.04270815849304199
mini_batch_src_global generation:  0.06066322326660156
r_  generation:  0.5233440399169922
local_output_nid generation:  0.036048173904418945
local_in_edges_tensor generation:  0.04576897621154785
mini_batch_src_global generation:  0.10196661949157715
r_  generation:  0.4870598316192627
local_output_nid generation:  0.02980494499206543
local_in_edges_tensor generation:  0.05198502540588379
mini_batch_src_global generation:  0.062009572982788086
r_  generation:  0.5029151439666748
local_output_nid generation:  0.029805660247802734
local_in_edges_tensor generation:  0.0343480110168457
mini_batch_src_global generation:  0.06417179107666016
r_  generation:  0.5002591609954834
local_output_nid generation:  0.029256820678710938
local_in_edges_tensor generation:  0.028677940368652344
mini_batch_src_global generation:  0.05949878692626953
r_  generation:  0.4975616931915283
local_output_nid generation:  0.029340744018554688
local_in_edges_tensor generation:  0.030894041061401367
mini_batch_src_global generation:  0.06264662742614746
r_  generation:  0.5041768550872803
local_output_nid generation:  0.029526472091674805
local_in_edges_tensor generation:  0.042062997817993164
mini_batch_src_global generation:  0.05947303771972656
r_  generation:  0.5067510604858398
local_output_nid generation:  0.02942037582397461
local_in_edges_tensor generation:  0.04240083694458008
mini_batch_src_global generation:  0.06223416328430176
r_  generation:  0.5200071334838867
local_output_nid generation:  0.03252077102661133
local_in_edges_tensor generation:  0.03788638114929199
mini_batch_src_global generation:  0.06165194511413574
r_  generation:  0.4956355094909668
local_output_nid generation:  0.029253482818603516
local_in_edges_tensor generation:  0.035117149353027344
mini_batch_src_global generation:  0.05993056297302246
r_  generation:  0.4941592216491699
local_output_nid generation:  0.029448509216308594
local_in_edges_tensor generation:  0.0418393611907959
mini_batch_src_global generation:  0.06331992149353027
r_  generation:  0.49859094619750977
local_output_nid generation:  0.029701948165893555
local_in_edges_tensor generation:  0.0374608039855957
mini_batch_src_global generation:  0.060962677001953125
r_  generation:  0.49607419967651367
local_output_nid generation:  0.029150962829589844
local_in_edges_tensor generation:  0.028155803680419922
mini_batch_src_global generation:  0.059561729431152344
r_  generation:  0.5044705867767334
local_output_nid generation:  0.029307126998901367
local_in_edges_tensor generation:  0.02831578254699707
mini_batch_src_global generation:  0.06000924110412598
r_  generation:  0.49838948249816895
local_output_nid generation:  0.0293121337890625
local_in_edges_tensor generation:  0.037660837173461914
mini_batch_src_global generation:  0.05949664115905762
r_  generation:  0.4993579387664795
local_output_nid generation:  0.02955341339111328
local_in_edges_tensor generation:  0.03448987007141113
mini_batch_src_global generation:  0.06033515930175781
r_  generation:  0.4957139492034912
local_output_nid generation:  0.03023362159729004
local_in_edges_tensor generation:  0.03702259063720703
mini_batch_src_global generation:  0.07026481628417969
r_  generation:  0.5272080898284912
local_output_nid generation:  0.031502485275268555
local_in_edges_tensor generation:  0.04444575309753418
mini_batch_src_global generation:  0.06503152847290039
r_  generation:  0.496807336807251
local_output_nid generation:  0.029620647430419922
local_in_edges_tensor generation:  0.03356146812438965
mini_batch_src_global generation:  0.06324338912963867
r_  generation:  0.500136137008667
local_output_nid generation:  0.029367923736572266
local_in_edges_tensor generation:  0.03049159049987793
mini_batch_src_global generation:  0.06023979187011719
r_  generation:  0.4967350959777832
local_output_nid generation:  0.02930450439453125
local_in_edges_tensor generation:  0.02878546714782715
mini_batch_src_global generation:  0.059252023696899414
r_  generation:  0.5016357898712158
local_output_nid generation:  0.029635190963745117
local_in_edges_tensor generation:  0.03289222717285156
mini_batch_src_global generation:  0.06345987319946289
r_  generation:  0.4932873249053955
local_output_nid generation:  0.02942633628845215
local_in_edges_tensor generation:  0.037129878997802734
mini_batch_src_global generation:  0.05931591987609863
r_  generation:  0.52097487449646
local_output_nid generation:  0.029262065887451172
local_in_edges_tensor generation:  0.037154436111450195
mini_batch_src_global generation:  0.060407161712646484
r_  generation:  0.5000684261322021
local_output_nid generation:  0.029177188873291016
local_in_edges_tensor generation:  0.02846813201904297
mini_batch_src_global generation:  0.05913043022155762
r_  generation:  0.5044388771057129
local_output_nid generation:  0.029572248458862305
local_in_edges_tensor generation:  0.04735255241394043
mini_batch_src_global generation:  0.06066775321960449
r_  generation:  0.500678539276123
local_output_nid generation:  0.02905893325805664
local_in_edges_tensor generation:  0.02847003936767578
mini_batch_src_global generation:  0.059212446212768555
r_  generation:  0.49933528900146484
local_output_nid generation:  0.03260922431945801
local_in_edges_tensor generation:  0.032216548919677734
mini_batch_src_global generation:  0.060327768325805664
r_  generation:  0.49546051025390625
local_output_nid generation:  0.029308080673217773
local_in_edges_tensor generation:  0.03339529037475586
mini_batch_src_global generation:  0.061637163162231445
r_  generation:  0.5023543834686279
local_output_nid generation:  0.029717206954956055
local_in_edges_tensor generation:  0.037819623947143555
mini_batch_src_global generation:  0.0606074333190918
r_  generation:  0.502410888671875
----------------------check_connections_block total spend ----------------------------- 23.80069351196289
generate_one_block  0.6577410697937012
generate_one_block  0.6424610614776611
generate_one_block  0.6374220848083496
generate_one_block  0.6408216953277588
generate_one_block  0.7643783092498779
generate_one_block  0.6580681800842285
generate_one_block  0.6469721794128418
generate_one_block  0.6384773254394531
generate_one_block  0.6536765098571777
generate_one_block  0.643160343170166
generate_one_block  0.6293394565582275
generate_one_block  0.6510322093963623
generate_one_block  0.6519014835357666
generate_one_block  0.6575095653533936
generate_one_block  0.6320183277130127
generate_one_block  0.6349079608917236
generate_one_block  0.6448566913604736
generate_one_block  0.6432957649230957
generate_one_block  0.6585514545440674
generate_one_block  0.6498548984527588
generate_one_block  0.6373424530029297
generate_one_block  0.6330432891845703
generate_one_block  0.6413345336914062
generate_one_block  0.652094841003418
generate_one_block  0.6743922233581543
generate_one_block  0.6569356918334961
generate_one_block  0.6365752220153809
generate_one_block  0.6599624156951904
generate_one_block  0.6317949295043945
generate_one_block  0.6495101451873779
generate_one_block  0.636897087097168
generate_one_block  0.6656718254089355
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.11201763153076172  GigaBytes
Max Memory Allocated: 0.4425544738769531  GigaBytes

connection checking time:  32.3584508895874
block generation total time  28.129339456558228
average batch blocks generation time:  0.8790418580174446
block dataloader generation time/epoch 63.19321417808533
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.09025430679321289  GigaBytes
Max Memory Allocated: 0.4425544738769531  GigaBytes

torch.Size([150222, 128])
torch.Size([109779, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.386965274810791  GigaBytes
Max Memory Allocated: 0.4425544738769531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.08997917175292969  GigaBytes
Max Memory Allocated: 0.4425544738769531  GigaBytes

torch.Size([150394, 128])
torch.Size([109540, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.38450002670288086  GigaBytes
Max Memory Allocated: 0.4425544738769531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.08966922760009766  GigaBytes
Max Memory Allocated: 0.4425544738769531  GigaBytes

torch.Size([150541, 128])
torch.Size([109213, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.3841710090637207  GigaBytes
Max Memory Allocated: 0.4425544738769531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.09009170532226562  GigaBytes
Max Memory Allocated: 0.4425544738769531  GigaBytes

torch.Size([149905, 128])
torch.Size([109213, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.38580894470214844  GigaBytes
Max Memory Allocated: 0.4425544738769531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.09004974365234375  GigaBytes
Max Memory Allocated: 0.44266366958618164  GigaBytes

torch.Size([150000, 128])
torch.Size([109742, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.384641170501709  GigaBytes
Max Memory Allocated: 0.44266366958618164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.0903472900390625  GigaBytes
Max Memory Allocated: 0.44266366958618164  GigaBytes

torch.Size([150456, 128])
torch.Size([111145, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.38869524002075195  GigaBytes
Max Memory Allocated: 0.44266366958618164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.09005355834960938  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

torch.Size([150117, 128])
torch.Size([109601, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.38465023040771484  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.09014606475830078  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

torch.Size([149869, 128])
torch.Size([109951, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.38675785064697266  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.09000873565673828  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

torch.Size([150467, 128])
torch.Size([110121, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.3859729766845703  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.09011173248291016  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

torch.Size([150056, 128])
torch.Size([109550, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.38572168350219727  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.08964824676513672  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

torch.Size([150476, 128])
torch.Size([109134, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.3827786445617676  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.09014701843261719  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

torch.Size([150137, 128])
torch.Size([109303, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.385983943939209  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.09014892578125  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

torch.Size([150008, 128])
torch.Size([109698, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.38570213317871094  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.09033584594726562  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

torch.Size([150248, 128])
torch.Size([110321, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.38820409774780273  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.09012985229492188  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

torch.Size([150244, 128])
torch.Size([109353, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.3869171142578125  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.0899953842163086  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

torch.Size([150134, 128])
torch.Size([109459, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.3854794502258301  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.08992290496826172  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

torch.Size([150342, 128])
torch.Size([109887, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.38438892364501953  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.08997535705566406  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

torch.Size([150109, 128])
torch.Size([109645, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.3844919204711914  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.0902090072631836  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

torch.Size([149730, 128])
torch.Size([109670, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.3865342140197754  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.09007930755615234  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

torch.Size([150199, 128])
torch.Size([110001, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.3863697052001953  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.09008312225341797  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

torch.Size([150667, 128])
torch.Size([110082, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.38620758056640625  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.08986186981201172  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

torch.Size([150047, 128])
torch.Size([109342, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.3842620849609375  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.0898122787475586  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

torch.Size([150315, 128])
torch.Size([109404, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.3831934928894043  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.090087890625  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

torch.Size([150263, 128])
torch.Size([109597, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.38604021072387695  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.09014034271240234  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

torch.Size([150102, 128])
torch.Size([109981, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.38640880584716797  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.09010887145996094  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

torch.Size([150060, 128])
torch.Size([109843, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.3861379623413086  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.08992767333984375  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

torch.Size([150126, 128])
torch.Size([109350, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.38336706161499023  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.0903329849243164  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

torch.Size([150776, 128])
torch.Size([110802, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.38850831985473633  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.08972644805908203  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

torch.Size([149962, 128])
torch.Size([108361, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.3783230781555176  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.09016895294189453  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

torch.Size([150598, 128])
torch.Size([110001, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.3867950439453125  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.09000396728515625  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

torch.Size([150349, 128])
torch.Size([110034, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.3858780860900879  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.09035587310791016  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

torch.Size([150195, 128])
torch.Size([110624, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.3881363868713379  GigaBytes
Max Memory Allocated: 0.4439868927001953  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03157871216535568 |0.015463940799236298 |0.0035029128193855286 |8.784979581832886e-05 |0.003346554934978485 |0.0013175010681152344 |
----------------------------------------------------------pseudo_mini_loss sum 3.587434768676758
Total (block generation + training)time/epoch 64.97174096107483
Training time/epoch 1.7782366275787354
Training time without block to device /epoch 1.2833905220031738
Training time without total dataloading part /epoch 0.2233116626739502
load block tensor time/epoch 1.0105187892913818
block to device time/epoch 0.4948461055755615
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9157861
Number of first layer input nodes during this epoch:  4807114
