Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648480489.4142916
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0013098716735839844  GigaBytes
Max Memory Allocated: 0.0013098716735839844  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.024079322814941406
random selection method range initialization spend 0.006081819534301758
time for parepare:  0.01859736442565918
local_output_nid generation:  0.008273601531982422
local_in_edges_tensor generation:  0.008767843246459961
mini_batch_src_global generation:  0.006490945816040039
r_  generation:  0.0819997787475586
local_output_nid generation:  0.01180720329284668
local_in_edges_tensor generation:  0.00581049919128418
mini_batch_src_global generation:  0.008650064468383789
r_  generation:  0.08838796615600586
local_output_nid generation:  0.011727333068847656
local_in_edges_tensor generation:  0.006055355072021484
mini_batch_src_global generation:  0.006716728210449219
r_  generation:  0.08961653709411621
local_output_nid generation:  0.011901140213012695
local_in_edges_tensor generation:  0.005861997604370117
mini_batch_src_global generation:  0.007042884826660156
r_  generation:  0.09238910675048828
----------------------check_connections_block total spend ----------------------------- 0.5512094497680664
generate_one_block  0.10212540626525879
generate_one_block  0.10389471054077148
generate_one_block  0.10410428047180176
generate_one_block  0.10251665115356445
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04095649719238281
gen group dst list time:  0.011332273483276367
time for parepare:  0.019687414169311523
local_output_nid generation:  0.01920628547668457
local_in_edges_tensor generation:  0.04323530197143555
mini_batch_src_global generation:  0.03817605972290039
r_  generation:  0.401669979095459
local_output_nid generation:  0.0284576416015625
local_in_edges_tensor generation:  0.04036831855773926
mini_batch_src_global generation:  0.05091595649719238
r_  generation:  0.4206359386444092
local_output_nid generation:  0.02910900115966797
local_in_edges_tensor generation:  0.034331321716308594
mini_batch_src_global generation:  0.04749131202697754
r_  generation:  0.420015811920166
local_output_nid generation:  0.028773784637451172
local_in_edges_tensor generation:  0.029311656951904297
mini_batch_src_global generation:  0.04907369613647461
r_  generation:  0.42378735542297363
----------------------check_connections_block total spend ----------------------------- 2.4966304302215576
generate_one_block  0.563633918762207
generate_one_block  0.5497221946716309
generate_one_block  0.5509195327758789
generate_one_block  0.5450994968414307
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03457832336425781
gen group dst list time:  0.020918607711791992
time for parepare:  0.019286155700683594
local_output_nid generation:  0.029752731323242188
local_in_edges_tensor generation:  0.047373294830322266
mini_batch_src_global generation:  0.05335211753845215
r_  generation:  0.5344514846801758
local_output_nid generation:  0.04096031188964844
local_in_edges_tensor generation:  0.05529356002807617
mini_batch_src_global generation:  0.060765981674194336
r_  generation:  0.544064998626709
local_output_nid generation:  0.04099583625793457
local_in_edges_tensor generation:  0.04170942306518555
mini_batch_src_global generation:  0.06014513969421387
r_  generation:  0.5449230670928955
local_output_nid generation:  0.041192054748535156
local_in_edges_tensor generation:  0.04190659523010254
mini_batch_src_global generation:  0.05685877799987793
r_  generation:  0.5524928569793701
----------------------check_connections_block total spend ----------------------------- 3.237908124923706
generate_one_block  0.68141770362854
generate_one_block  0.6943259239196777
generate_one_block  0.7187888622283936
generate_one_block  0.7089338302612305
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.049291372299194336
gen group dst list time:  0.025450944900512695
time for parepare:  0.0192718505859375
local_output_nid generation:  0.03325772285461426
local_in_edges_tensor generation:  0.05929684638977051
mini_batch_src_global generation:  0.04679989814758301
r_  generation:  0.5131435394287109
local_output_nid generation:  0.04177069664001465
local_in_edges_tensor generation:  0.047867774963378906
mini_batch_src_global generation:  0.05766630172729492
r_  generation:  0.5186398029327393
local_output_nid generation:  0.040096282958984375
local_in_edges_tensor generation:  0.0471956729888916
mini_batch_src_global generation:  0.057525634765625
r_  generation:  0.5222203731536865
local_output_nid generation:  0.03968954086303711
local_in_edges_tensor generation:  0.038019657135009766
mini_batch_src_global generation:  0.057689666748046875
r_  generation:  0.5213277339935303
----------------------check_connections_block total spend ----------------------------- 3.1346535682678223
generate_one_block  0.6357579231262207
generate_one_block  0.6560182571411133
generate_one_block  0.6443548202514648
generate_one_block  0.6350679397583008
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0013098716735839844  GigaBytes
Max Memory Allocated: 0.0013098716735839844  GigaBytes

connection checking time:  8.869192123413086
block generation total time  7.584040403366089
average batch blocks generation time:  1.8960101008415222
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.11721086502075195  GigaBytes
Max Memory Allocated: 0.11721086502075195  GigaBytes

torch.Size([166747, 128])
torch.Size([164768, 256])
torch.Size([155105, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3572998046875 GB
    Memory Allocated: 1.7972412109375  GigaBytes
Max Memory Allocated: 1.8848142623901367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0955810546875 GB
    Memory Allocated: 0.12250995635986328  GigaBytes
Max Memory Allocated: 1.989567756652832  GigaBytes

torch.Size([166693, 128])
torch.Size([164730, 256])
torch.Size([154879, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0955810546875 GB
    Memory Allocated: 1.7993950843811035  GigaBytes
Max Memory Allocated: 1.989567756652832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0975341796875 GB
    Memory Allocated: 0.12296867370605469  GigaBytes
Max Memory Allocated: 1.9923911094665527  GigaBytes

torch.Size([166768, 128])
torch.Size([164825, 256])
torch.Size([155152, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0975341796875 GB
    Memory Allocated: 1.7957763671875  GigaBytes
Max Memory Allocated: 1.9923911094665527  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0975341796875 GB
    Memory Allocated: 0.122467041015625  GigaBytes
Max Memory Allocated: 1.9923911094665527  GigaBytes

torch.Size([166724, 128])
torch.Size([164774, 256])
torch.Size([155062, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0975341796875 GB
    Memory Allocated: 1.794752597808838  GigaBytes
Max Memory Allocated: 1.9923911094665527  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08871728181838989 |0.10868662595748901 |0.20008420944213867 |0.00012123584747314453 |0.05473226308822632 |0.005571126937866211 |
----------------------------------------------------------pseudo_mini_loss sum 6.264206886291504
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2351804
Number of first layer input nodes during this epoch:  666932
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 4.0994873046875 GB
    Memory Allocated: 0.18794775009155273  GigaBytes
Max Memory Allocated: 1.9923911094665527  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.018852949142456055
random selection method range initialization spend 0.005057096481323242
time for parepare:  0.018749713897705078
local_output_nid generation:  0.008840560913085938
local_in_edges_tensor generation:  0.00978231430053711
mini_batch_src_global generation:  0.006870746612548828
r_  generation:  0.0823674201965332
local_output_nid generation:  0.011684179306030273
local_in_edges_tensor generation:  0.006636142730712891
mini_batch_src_global generation:  0.008790731430053711
r_  generation:  0.09514474868774414
local_output_nid generation:  0.011896610260009766
local_in_edges_tensor generation:  0.0068929195404052734
mini_batch_src_global generation:  0.006663799285888672
r_  generation:  0.09067678451538086
local_output_nid generation:  0.011880159378051758
local_in_edges_tensor generation:  0.006960868835449219
mini_batch_src_global generation:  0.007639646530151367
r_  generation:  0.09320259094238281
----------------------check_connections_block total spend ----------------------------- 0.5682799816131592
generate_one_block  0.10703110694885254
generate_one_block  0.10358881950378418
generate_one_block  0.10410118103027344
generate_one_block  0.10304975509643555
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03907513618469238
gen group dst list time:  0.011336088180541992
time for parepare:  0.019265413284301758
local_output_nid generation:  0.019664525985717773
local_in_edges_tensor generation:  0.04222512245178223
mini_batch_src_global generation:  0.04243922233581543
r_  generation:  0.4125988483428955
local_output_nid generation:  0.026732444763183594
local_in_edges_tensor generation:  0.040877580642700195
mini_batch_src_global generation:  0.048650503158569336
r_  generation:  0.42897820472717285
local_output_nid generation:  0.02537059783935547
local_in_edges_tensor generation:  0.03963160514831543
mini_batch_src_global generation:  0.0486602783203125
r_  generation:  0.4600543975830078
local_output_nid generation:  0.029108524322509766
local_in_edges_tensor generation:  0.041043758392333984
mini_batch_src_global generation:  0.05876016616821289
r_  generation:  0.42974305152893066
----------------------check_connections_block total spend ----------------------------- 2.596914052963257
generate_one_block  0.5734374523162842
generate_one_block  0.5449142456054688
generate_one_block  0.5908255577087402
generate_one_block  0.5501420497894287
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.037969350814819336
gen group dst list time:  0.02387690544128418
time for parepare:  0.019451379776000977
local_output_nid generation:  0.02925562858581543
local_in_edges_tensor generation:  0.07924056053161621
mini_batch_src_global generation:  0.06500434875488281
r_  generation:  0.5432302951812744
local_output_nid generation:  0.03754019737243652
local_in_edges_tensor generation:  0.05617523193359375
mini_batch_src_global generation:  0.06322908401489258
r_  generation:  0.5644221305847168
local_output_nid generation:  0.037435054779052734
local_in_edges_tensor generation:  0.05115675926208496
mini_batch_src_global generation:  0.05933642387390137
r_  generation:  0.5605754852294922
local_output_nid generation:  0.03730583190917969
local_in_edges_tensor generation:  0.04184126853942871
mini_batch_src_global generation:  0.05907607078552246
r_  generation:  0.5654873847961426
----------------------check_connections_block total spend ----------------------------- 3.35078501701355
generate_one_block  0.7003664970397949
generate_one_block  0.724367618560791
generate_one_block  0.6986696720123291
generate_one_block  0.7004694938659668
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03330540657043457
gen group dst list time:  0.030472755432128906
time for parepare:  0.018770933151245117
local_output_nid generation:  0.034833431243896484
local_in_edges_tensor generation:  0.058977603912353516
mini_batch_src_global generation:  0.047437191009521484
r_  generation:  0.5193722248077393
local_output_nid generation:  0.039395809173583984
local_in_edges_tensor generation:  0.04657292366027832
mini_batch_src_global generation:  0.05777597427368164
r_  generation:  0.5154476165771484
local_output_nid generation:  0.03931450843811035
local_in_edges_tensor generation:  0.054489850997924805
mini_batch_src_global generation:  0.0572209358215332
r_  generation:  0.520397424697876
local_output_nid generation:  0.039424896240234375
local_in_edges_tensor generation:  0.041352033615112305
mini_batch_src_global generation:  0.06074643135070801
r_  generation:  0.5250823497772217
----------------------check_connections_block total spend ----------------------------- 3.1550090312957764
generate_one_block  0.6378364562988281
generate_one_block  0.6539208889007568
generate_one_block  0.6485893726348877
generate_one_block  0.6643836498260498
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.0994873046875 GB
    Memory Allocated: 0.18794775009155273  GigaBytes
Max Memory Allocated: 1.9923911094665527  GigaBytes

connection checking time:  9.102708101272583
block generation total time  7.687922954559326
average batch blocks generation time:  1.9219807386398315
block dataloader generation time/epoch 18.952958345413208
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0994873046875 GB
    Memory Allocated: 0.12506723403930664  GigaBytes
Max Memory Allocated: 1.9923911094665527  GigaBytes

torch.Size([166663, 128])
torch.Size([164678, 256])
torch.Size([154903, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0994873046875 GB
    Memory Allocated: 1.7960624694824219  GigaBytes
Max Memory Allocated: 1.9923911094665527  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1014404296875 GB
    Memory Allocated: 0.12497901916503906  GigaBytes
Max Memory Allocated: 1.9923911094665527  GigaBytes

torch.Size([166731, 128])
torch.Size([164795, 256])
torch.Size([155204, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1014404296875 GB
    Memory Allocated: 1.8022632598876953  GigaBytes
Max Memory Allocated: 1.9923911094665527  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1033935546875 GB
    Memory Allocated: 0.12548303604125977  GigaBytes
Max Memory Allocated: 1.9953513145446777  GigaBytes

torch.Size([166704, 128])
torch.Size([164764, 256])
torch.Size([155197, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1033935546875 GB
    Memory Allocated: 1.802574634552002  GigaBytes
Max Memory Allocated: 1.9953513145446777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1033935546875 GB
    Memory Allocated: 0.12546300888061523  GigaBytes
Max Memory Allocated: 1.9955878257751465  GigaBytes

torch.Size([166710, 128])
torch.Size([164737, 256])
torch.Size([155136, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1033935546875 GB
    Memory Allocated: 1.7978153228759766  GigaBytes
Max Memory Allocated: 1.9955878257751465  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.144062340259552 |0.033214032649993896 |0.010653674602508545 |9.66191291809082e-05 |0.005403101444244385 |0.004040956497192383 |
----------------------------------------------------------pseudo_mini_loss sum 3.27252459526062
Total (block generation + training)time/epoch 19.88581347465515
Training time/epoch 0.9325335025787354
Training time without block to device /epoch 0.7996773719787598
Training time without total dataloading part /epoch 0.06865453720092773
load block tensor time/epoch 0.576249361038208
block to device time/epoch 0.13285613059997559
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2351786
Number of first layer input nodes during this epoch:  666808
