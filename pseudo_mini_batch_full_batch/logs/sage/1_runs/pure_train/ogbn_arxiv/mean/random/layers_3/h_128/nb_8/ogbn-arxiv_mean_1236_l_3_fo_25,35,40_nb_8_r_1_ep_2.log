Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648441457.0389159
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02468585968017578
random selection method range initialization spend 0.006531238555908203
time for parepare:  0.018537521362304688
local_output_nid generation:  0.004187107086181641
local_in_edges_tensor generation:  0.00648808479309082
mini_batch_src_global generation:  0.003313779830932617
r_  generation:  0.03687715530395508
local_output_nid generation:  0.0056304931640625
local_in_edges_tensor generation:  0.003120899200439453
mini_batch_src_global generation:  0.004177570343017578
r_  generation:  0.03761863708496094
local_output_nid generation:  0.005949974060058594
local_in_edges_tensor generation:  0.0031986236572265625
mini_batch_src_global generation:  0.002861499786376953
r_  generation:  0.03908801078796387
local_output_nid generation:  0.006063699722290039
local_in_edges_tensor generation:  0.0031006336212158203
mini_batch_src_global generation:  0.002997875213623047
r_  generation:  0.041253089904785156
local_output_nid generation:  0.006053924560546875
local_in_edges_tensor generation:  0.003177642822265625
mini_batch_src_global generation:  0.00304412841796875
r_  generation:  0.0394282341003418
local_output_nid generation:  0.005975961685180664
local_in_edges_tensor generation:  0.0031366348266601562
mini_batch_src_global generation:  0.00325775146484375
r_  generation:  0.04089236259460449
local_output_nid generation:  0.006007194519042969
local_in_edges_tensor generation:  0.003193378448486328
mini_batch_src_global generation:  0.0032100677490234375
r_  generation:  0.0404512882232666
local_output_nid generation:  0.005975484848022461
local_in_edges_tensor generation:  0.0032286643981933594
mini_batch_src_global generation:  0.0033979415893554688
r_  generation:  0.04063773155212402
----------------------check_connections_block total spend ----------------------------- 0.5119376182556152
generate_one_block  0.05417346954345703
generate_one_block  0.05382084846496582
generate_one_block  0.05558347702026367
generate_one_block  0.055737972259521484
generate_one_block  0.05813145637512207
generate_one_block  0.054868459701538086
generate_one_block  0.05439138412475586
generate_one_block  0.054601192474365234
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04120802879333496
gen group dst list time:  0.015059471130371094
time for parepare:  0.019331932067871094
local_output_nid generation:  0.013421773910522461
local_in_edges_tensor generation:  0.03187847137451172
mini_batch_src_global generation:  0.02684640884399414
r_  generation:  0.28557777404785156
local_output_nid generation:  0.021068334579467773
local_in_edges_tensor generation:  0.029804229736328125
mini_batch_src_global generation:  0.03457760810852051
r_  generation:  0.29673242568969727
local_output_nid generation:  0.02138972282409668
local_in_edges_tensor generation:  0.027515649795532227
mini_batch_src_global generation:  0.03473472595214844
r_  generation:  0.30395078659057617
local_output_nid generation:  0.021532535552978516
local_in_edges_tensor generation:  0.020484447479248047
mini_batch_src_global generation:  0.03683805465698242
r_  generation:  0.31696295738220215
local_output_nid generation:  0.021215438842773438
local_in_edges_tensor generation:  0.0222928524017334
mini_batch_src_global generation:  0.03729057312011719
r_  generation:  0.3058195114135742
local_output_nid generation:  0.021628618240356445
local_in_edges_tensor generation:  0.022823333740234375
mini_batch_src_global generation:  0.03797101974487305
r_  generation:  0.3180556297302246
local_output_nid generation:  0.02164912223815918
local_in_edges_tensor generation:  0.024991273880004883
mini_batch_src_global generation:  0.03714442253112793
r_  generation:  0.3092000484466553
local_output_nid generation:  0.021779775619506836
local_in_edges_tensor generation:  0.02210235595703125
mini_batch_src_global generation:  0.03827309608459473
r_  generation:  0.3165717124938965
----------------------check_connections_block total spend ----------------------------- 3.6421663761138916
generate_one_block  0.3961038589477539
generate_one_block  0.38638782501220703
generate_one_block  0.3958556652069092
generate_one_block  0.40514588356018066
generate_one_block  0.38861536979675293
generate_one_block  0.412447452545166
generate_one_block  0.39238500595092773
generate_one_block  0.4009084701538086
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0325007438659668
gen group dst list time:  0.035437583923339844
time for parepare:  0.01887369155883789
local_output_nid generation:  0.028339385986328125
local_in_edges_tensor generation:  0.04480338096618652
mini_batch_src_global generation:  0.046755075454711914
r_  generation:  0.46762871742248535
local_output_nid generation:  0.03417491912841797
local_in_edges_tensor generation:  0.054491519927978516
mini_batch_src_global generation:  0.05429792404174805
r_  generation:  0.4757370948791504
local_output_nid generation:  0.034455299377441406
local_in_edges_tensor generation:  0.047246694564819336
mini_batch_src_global generation:  0.05081510543823242
r_  generation:  0.4872782230377197
local_output_nid generation:  0.03438591957092285
local_in_edges_tensor generation:  0.04305434226989746
mini_batch_src_global generation:  0.05733489990234375
r_  generation:  0.48558950424194336
local_output_nid generation:  0.03433680534362793
local_in_edges_tensor generation:  0.03466606140136719
mini_batch_src_global generation:  0.052916765213012695
r_  generation:  0.4941067695617676
local_output_nid generation:  0.0345921516418457
local_in_edges_tensor generation:  0.03473496437072754
mini_batch_src_global generation:  0.05550193786621094
r_  generation:  0.4860811233520508
local_output_nid generation:  0.03455042839050293
local_in_edges_tensor generation:  0.04737687110900879
mini_batch_src_global generation:  0.052916526794433594
r_  generation:  0.5011212825775146
local_output_nid generation:  0.03462481498718262
local_in_edges_tensor generation:  0.034583330154418945
mini_batch_src_global generation:  0.055353403091430664
r_  generation:  0.4883260726928711
----------------------check_connections_block total spend ----------------------------- 5.785218954086304
generate_one_block  0.6043200492858887
generate_one_block  0.6057102680206299
generate_one_block  0.617302656173706
generate_one_block  0.618267297744751
generate_one_block  0.6015348434448242
generate_one_block  0.616987943649292
generate_one_block  0.6397826671600342
generate_one_block  0.6169977188110352
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

connection checking time:  9.427385330200195
block generation total time  8.098752975463867
average batch blocks generation time:  1.0123441219329834
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.09589815139770508  GigaBytes
Max Memory Allocated: 0.09589815139770508  GigaBytes

torch.Size([160715, 128])
torch.Size([141399, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.5495767593383789  GigaBytes
Max Memory Allocated: 0.5785255432128906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2596435546875 GB
    Memory Allocated: 0.09819889068603516  GigaBytes
Max Memory Allocated: 0.6153192520141602  GigaBytes

torch.Size([160303, 128])
torch.Size([140606, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5404329299926758  GigaBytes
Max Memory Allocated: 0.6153192520141602  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09882211685180664  GigaBytes
Max Memory Allocated: 0.6153192520141602  GigaBytes

torch.Size([160562, 128])
torch.Size([141319, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5508337020874023  GigaBytes
Max Memory Allocated: 0.6153192520141602  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0985560417175293  GigaBytes
Max Memory Allocated: 0.6158781051635742  GigaBytes

torch.Size([160450, 128])
torch.Size([141492, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5530118942260742  GigaBytes
Max Memory Allocated: 0.6158781051635742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09836196899414062  GigaBytes
Max Memory Allocated: 0.6177978515625  GigaBytes

torch.Size([160433, 128])
torch.Size([140853, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5428128242492676  GigaBytes
Max Memory Allocated: 0.6177978515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09921455383300781  GigaBytes
Max Memory Allocated: 0.6177978515625  GigaBytes

torch.Size([160487, 128])
torch.Size([141439, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.551905632019043  GigaBytes
Max Memory Allocated: 0.6177978515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09945869445800781  GigaBytes
Max Memory Allocated: 0.6177978515625  GigaBytes

torch.Size([160696, 128])
torch.Size([141657, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5512709617614746  GigaBytes
Max Memory Allocated: 0.6177978515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0986180305480957  GigaBytes
Max Memory Allocated: 0.6177978515625  GigaBytes

torch.Size([160690, 128])
torch.Size([141707, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5516996383666992  GigaBytes
Max Memory Allocated: 0.6177978515625  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.045990705490112305 |0.046673208475112915 |0.08988547325134277 |9.632110595703125e-05 |0.012453019618988037 |0.003714323043823242 |
----------------------------------------------------------pseudo_mini_loss sum 5.561844348907471
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2958016
Number of first layer input nodes during this epoch:  1284336
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1287522315979004  GigaBytes
Max Memory Allocated: 0.6177978515625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023088932037353516
random selection method range initialization spend 0.005507469177246094
time for parepare:  0.0166778564453125
local_output_nid generation:  0.004353761672973633
local_in_edges_tensor generation:  0.01065826416015625
mini_batch_src_global generation:  0.0032396316528320312
r_  generation:  0.03625941276550293
local_output_nid generation:  0.0057032108306884766
local_in_edges_tensor generation:  0.003160715103149414
mini_batch_src_global generation:  0.0041790008544921875
r_  generation:  0.03806495666503906
local_output_nid generation:  0.005940437316894531
local_in_edges_tensor generation:  0.003141641616821289
mini_batch_src_global generation:  0.0027463436126708984
r_  generation:  0.0378413200378418
local_output_nid generation:  0.006012916564941406
local_in_edges_tensor generation:  0.0031096935272216797
mini_batch_src_global generation:  0.0029497146606445312
r_  generation:  0.040193796157836914
local_output_nid generation:  0.005998849868774414
local_in_edges_tensor generation:  0.003110647201538086
mini_batch_src_global generation:  0.003136873245239258
r_  generation:  0.04042530059814453
local_output_nid generation:  0.005974531173706055
local_in_edges_tensor generation:  0.003084421157836914
mini_batch_src_global generation:  0.0032825469970703125
r_  generation:  0.04149198532104492
local_output_nid generation:  0.00603175163269043
local_in_edges_tensor generation:  0.0031249523162841797
mini_batch_src_global generation:  0.0033168792724609375
r_  generation:  0.04182076454162598
local_output_nid generation:  0.00600886344909668
local_in_edges_tensor generation:  0.0031290054321289062
mini_batch_src_global generation:  0.0033462047576904297
r_  generation:  0.041663169860839844
----------------------check_connections_block total spend ----------------------------- 0.515089750289917
generate_one_block  0.053229331970214844
generate_one_block  0.05431556701660156
generate_one_block  0.05411243438720703
generate_one_block  0.05484294891357422
generate_one_block  0.05525827407836914
generate_one_block  0.055233001708984375
generate_one_block  0.05948925018310547
generate_one_block  0.05580735206604004
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03809762001037598
gen group dst list time:  0.014684200286865234
time for parepare:  0.018906354904174805
local_output_nid generation:  0.01372528076171875
local_in_edges_tensor generation:  0.03358793258666992
mini_batch_src_global generation:  0.027013540267944336
r_  generation:  0.2879047393798828
local_output_nid generation:  0.01896953582763672
local_in_edges_tensor generation:  0.02907419204711914
mini_batch_src_global generation:  0.03535866737365723
r_  generation:  0.30196452140808105
local_output_nid generation:  0.018047332763671875
local_in_edges_tensor generation:  0.0212252140045166
mini_batch_src_global generation:  0.03480982780456543
r_  generation:  0.30556654930114746
local_output_nid generation:  0.018100500106811523
local_in_edges_tensor generation:  0.0242764949798584
mini_batch_src_global generation:  0.03601861000061035
r_  generation:  0.3076968193054199
local_output_nid generation:  0.01812124252319336
local_in_edges_tensor generation:  0.02447795867919922
mini_batch_src_global generation:  0.037843942642211914
r_  generation:  0.3056464195251465
local_output_nid generation:  0.019614696502685547
local_in_edges_tensor generation:  0.020952224731445312
mini_batch_src_global generation:  0.036453962326049805
r_  generation:  0.3092834949493408
local_output_nid generation:  0.018101930618286133
local_in_edges_tensor generation:  0.02131819725036621
mini_batch_src_global generation:  0.039569854736328125
r_  generation:  0.3153228759765625
local_output_nid generation:  0.01819467544555664
local_in_edges_tensor generation:  0.023684024810791016
mini_batch_src_global generation:  0.03755831718444824
r_  generation:  0.31011104583740234
----------------------check_connections_block total spend ----------------------------- 3.6200599670410156
generate_one_block  0.4030168056488037
generate_one_block  0.403322696685791
generate_one_block  0.40503835678100586
generate_one_block  0.4035334587097168
generate_one_block  0.4180731773376465
generate_one_block  0.40154552459716797
generate_one_block  0.3997993469238281
generate_one_block  0.4283576011657715
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.06638979911804199
gen group dst list time:  0.03610110282897949
time for parepare:  0.018587350845336914
local_output_nid generation:  0.028204679489135742
local_in_edges_tensor generation:  0.058431148529052734
mini_batch_src_global generation:  0.0498197078704834
r_  generation:  0.48936891555786133
local_output_nid generation:  0.03880119323730469
local_in_edges_tensor generation:  0.057913780212402344
mini_batch_src_global generation:  0.05533456802368164
r_  generation:  0.48398852348327637
local_output_nid generation:  0.035808563232421875
local_in_edges_tensor generation:  0.046172380447387695
mini_batch_src_global generation:  0.05013895034790039
r_  generation:  0.4899275302886963
local_output_nid generation:  0.03635120391845703
local_in_edges_tensor generation:  0.03698158264160156
mini_batch_src_global generation:  0.05369853973388672
r_  generation:  0.4845104217529297
local_output_nid generation:  0.03571367263793945
local_in_edges_tensor generation:  0.03806757926940918
mini_batch_src_global generation:  0.05416083335876465
r_  generation:  0.5081653594970703
local_output_nid generation:  0.03611302375793457
local_in_edges_tensor generation:  0.038583993911743164
mini_batch_src_global generation:  0.05447697639465332
r_  generation:  0.4949164390563965
local_output_nid generation:  0.036205291748046875
local_in_edges_tensor generation:  0.06219315528869629
mini_batch_src_global generation:  0.05770111083984375
r_  generation:  0.5037636756896973
local_output_nid generation:  0.037010908126831055
local_in_edges_tensor generation:  0.031922340393066406
mini_batch_src_global generation:  0.05488109588623047
r_  generation:  0.5035462379455566
----------------------check_connections_block total spend ----------------------------- 5.92603063583374
generate_one_block  0.6220719814300537
generate_one_block  0.6226696968078613
generate_one_block  0.6114380359649658
generate_one_block  0.6083602905273438
generate_one_block  0.6044394969940186
generate_one_block  0.6220536231994629
generate_one_block  0.6160991191864014
generate_one_block  0.6073312759399414
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1287522315979004  GigaBytes
Max Memory Allocated: 0.6177978515625  GigaBytes

connection checking time:  9.546090602874756
block generation total time  8.17715048789978
average batch blocks generation time:  1.0221438109874725
block dataloader generation time/epoch 19.700620651245117
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09995031356811523  GigaBytes
Max Memory Allocated: 0.6177978515625  GigaBytes

torch.Size([160528, 128])
torch.Size([141167, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.547816276550293  GigaBytes
Max Memory Allocated: 0.6177978515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09900999069213867  GigaBytes
Max Memory Allocated: 0.6177978515625  GigaBytes

torch.Size([160320, 128])
torch.Size([141240, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5466828346252441  GigaBytes
Max Memory Allocated: 0.6177978515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.09896278381347656  GigaBytes
Max Memory Allocated: 0.6177978515625  GigaBytes

torch.Size([160609, 128])
torch.Size([141373, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.5485515594482422  GigaBytes
Max Memory Allocated: 0.6177978515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.09906435012817383  GigaBytes
Max Memory Allocated: 0.6177978515625  GigaBytes

torch.Size([160482, 128])
torch.Size([140929, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.5460171699523926  GigaBytes
Max Memory Allocated: 0.6177978515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.09888887405395508  GigaBytes
Max Memory Allocated: 0.6177978515625  GigaBytes

torch.Size([160358, 128])
torch.Size([140791, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.5423259735107422  GigaBytes
Max Memory Allocated: 0.6177978515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.09896707534790039  GigaBytes
Max Memory Allocated: 0.6177978515625  GigaBytes

torch.Size([160644, 128])
torch.Size([141205, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.5474634170532227  GigaBytes
Max Memory Allocated: 0.6177978515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.09903144836425781  GigaBytes
Max Memory Allocated: 0.6177978515625  GigaBytes

torch.Size([160429, 128])
torch.Size([141278, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.5466642379760742  GigaBytes
Max Memory Allocated: 0.6177978515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.09927082061767578  GigaBytes
Max Memory Allocated: 0.6177978515625  GigaBytes

torch.Size([160605, 128])
torch.Size([141201, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.5469813346862793  GigaBytes
Max Memory Allocated: 0.6177978515625  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.049268245697021484 |0.01453438401222229 |0.0035492777824401855 |9.03010368347168e-05 |0.003898829221725464 |0.0019016265869140625 |
----------------------------------------------------------pseudo_mini_loss sum 3.566226005554199
Total (block generation + training)time/epoch 20.30570936203003
Training time/epoch 0.6048519611358643
Training time without block to device /epoch 0.48857688903808594
Training time without total dataloading part /epoch 0.06220889091491699
load block tensor time/epoch 0.3941459655761719
block to device time/epoch 0.11627507209777832
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2955712
Number of first layer input nodes during this epoch:  1283975
