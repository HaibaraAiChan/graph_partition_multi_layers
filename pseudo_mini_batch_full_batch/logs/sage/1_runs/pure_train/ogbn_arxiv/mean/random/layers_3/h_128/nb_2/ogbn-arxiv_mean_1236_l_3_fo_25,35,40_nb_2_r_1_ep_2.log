Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648441399.3474798
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024871826171875
random selection method range initialization spend 0.006182193756103516
time for parepare:  0.018657445907592773
local_output_nid generation:  0.016109943389892578
local_in_edges_tensor generation:  0.014673948287963867
mini_batch_src_global generation:  0.014022350311279297
r_  generation:  0.17012476921081543
local_output_nid generation:  0.021683216094970703
local_in_edges_tensor generation:  0.016263723373413086
mini_batch_src_global generation:  0.017299413681030273
r_  generation:  0.17981433868408203
----------------------check_connections_block total spend ----------------------------- 0.5471787452697754
generate_one_block  0.19935894012451172
generate_one_block  0.20119476318359375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04030203819274902
gen group dst list time:  0.0075032711029052734
time for parepare:  0.019188642501831055
local_output_nid generation:  0.02452254295349121
local_in_edges_tensor generation:  0.05235886573791504
mini_batch_src_global generation:  0.04912519454956055
r_  generation:  0.4890778064727783
local_output_nid generation:  0.030992984771728516
local_in_edges_tensor generation:  0.04966020584106445
mini_batch_src_global generation:  0.055024147033691406
r_  generation:  0.49701380729675293
----------------------check_connections_block total spend ----------------------------- 1.4935503005981445
generate_one_block  0.6263561248779297
generate_one_block  0.6479597091674805
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02791142463684082
gen group dst list time:  0.011809587478637695
time for parepare:  0.019486188888549805
local_output_nid generation:  0.03088545799255371
local_in_edges_tensor generation:  0.04806041717529297
mini_batch_src_global generation:  0.04566645622253418
r_  generation:  0.5115108489990234
local_output_nid generation:  0.040982961654663086
local_in_edges_tensor generation:  0.05948448181152344
mini_batch_src_global generation:  0.05719566345214844
r_  generation:  0.5183086395263672
----------------------check_connections_block total spend ----------------------------- 1.568129301071167
generate_one_block  0.6658158302307129
generate_one_block  0.6543018817901611
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

connection checking time:  3.0616796016693115
block generation total time  2.594433546066284
average batch blocks generation time:  1.297216773033142
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2010498046875 GB
    Memory Allocated: 0.10752630233764648  GigaBytes
Max Memory Allocated: 0.10752630233764648  GigaBytes

torch.Size([166374, 128])
torch.Size([162594, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7563638687133789  GigaBytes
Max Memory Allocated: 0.8032088279724121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6248779296875 GB
    Memory Allocated: 0.11408567428588867  GigaBytes
Max Memory Allocated: 0.8820195198059082  GigaBytes

torch.Size([166401, 128])
torch.Size([162635, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6268310546875 GB
    Memory Allocated: 0.7562503814697266  GigaBytes
Max Memory Allocated: 0.8820195198059082  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03142392635345459 |0.15530836582183838 |0.36295652389526367 |0.00013399124145507812 |0.037348151206970215 |0.0038650035858154297 |
----------------------------------------------------------pseudo_mini_loss sum 5.458909511566162
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  927193
Number of first layer input nodes during this epoch:  332775
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6268310546875 GB
    Memory Allocated: 0.15919828414916992  GigaBytes
Max Memory Allocated: 0.8820195198059082  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.018001317977905273
random selection method range initialization spend 0.0057201385498046875
time for parepare:  0.018637657165527344
local_output_nid generation:  0.016269683837890625
local_in_edges_tensor generation:  0.01425933837890625
mini_batch_src_global generation:  0.012113571166992188
r_  generation:  0.17275285720825195
local_output_nid generation:  0.0216827392578125
local_in_edges_tensor generation:  0.019479036331176758
mini_batch_src_global generation:  0.0166776180267334
r_  generation:  0.18694090843200684
----------------------check_connections_block total spend ----------------------------- 0.5576739311218262
generate_one_block  0.21073198318481445
generate_one_block  0.20831513404846191
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03908038139343262
gen group dst list time:  0.0076296329498291016
time for parepare:  0.023262739181518555
local_output_nid generation:  0.025305747985839844
local_in_edges_tensor generation:  0.05150103569030762
mini_batch_src_global generation:  0.04792213439941406
r_  generation:  0.5191729068756104
local_output_nid generation:  0.03615570068359375
local_in_edges_tensor generation:  0.05997800827026367
mini_batch_src_global generation:  0.07661032676696777
r_  generation:  0.5013701915740967
----------------------check_connections_block total spend ----------------------------- 1.5910718441009521
generate_one_block  0.6398122310638428
generate_one_block  0.6409714221954346
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.07418298721313477
gen group dst list time:  0.011643409729003906
time for parepare:  0.018941640853881836
local_output_nid generation:  0.030941009521484375
local_in_edges_tensor generation:  0.08182859420776367
mini_batch_src_global generation:  0.04637312889099121
r_  generation:  0.5196678638458252
local_output_nid generation:  0.03730630874633789
local_in_edges_tensor generation:  0.058600425720214844
mini_batch_src_global generation:  0.05651521682739258
r_  generation:  0.5313353538513184
----------------------check_connections_block total spend ----------------------------- 1.6199908256530762
generate_one_block  0.6644515991210938
generate_one_block  0.6715946197509766
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6268310546875 GB
    Memory Allocated: 0.15919828414916992  GigaBytes
Max Memory Allocated: 0.8820195198059082  GigaBytes

connection checking time:  3.2110626697540283
block generation total time  2.6168298721313477
average batch blocks generation time:  1.3084149360656738
block dataloader generation time/epoch 7.654530763626099
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6268310546875 GB
    Memory Allocated: 0.11473989486694336  GigaBytes
Max Memory Allocated: 0.8820195198059082  GigaBytes

torch.Size([166457, 128])
torch.Size([162711, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6268310546875 GB
    Memory Allocated: 0.7568960189819336  GigaBytes
Max Memory Allocated: 0.8820195198059082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6268310546875 GB
    Memory Allocated: 0.11482858657836914  GigaBytes
Max Memory Allocated: 0.8821210861206055  GigaBytes

torch.Size([166440, 128])
torch.Size([162668, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6268310546875 GB
    Memory Allocated: 0.7565536499023438  GigaBytes
Max Memory Allocated: 0.8821210861206055  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04364335536956787 |0.02484428882598877 |0.004795074462890625 |0.00010693073272705078 |0.020597219467163086 |0.001287221908569336 |
----------------------------------------------------------pseudo_mini_loss sum 3.5426130294799805
Total (block generation + training)time/epoch 7.893259763717651
Training time/epoch 0.2384662628173828
Training time without block to device /epoch 0.18877768516540527
Training time without total dataloading part /epoch 0.05228567123413086
load block tensor time/epoch 0.08728671073913574
block to device time/epoch 0.04968857765197754
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  927404
Number of first layer input nodes during this epoch:  332897
