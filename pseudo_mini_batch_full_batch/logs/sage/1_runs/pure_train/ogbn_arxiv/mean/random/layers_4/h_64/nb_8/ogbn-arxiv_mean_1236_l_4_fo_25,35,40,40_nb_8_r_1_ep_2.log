Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648478837.005507
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00014829635620117188  GigaBytes
Max Memory Allocated: 0.00014829635620117188  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.024285078048706055
random selection method range initialization spend 0.005870342254638672
time for parepare:  0.018317222595214844
local_output_nid generation:  0.0042934417724609375
local_in_edges_tensor generation:  0.0063207149505615234
mini_batch_src_global generation:  0.0032455921173095703
r_  generation:  0.036540985107421875
local_output_nid generation:  0.0056612491607666016
local_in_edges_tensor generation:  0.0032508373260498047
mini_batch_src_global generation:  0.004103660583496094
r_  generation:  0.037511348724365234
local_output_nid generation:  0.006097555160522461
local_in_edges_tensor generation:  0.0032472610473632812
mini_batch_src_global generation:  0.0026085376739501953
r_  generation:  0.03831648826599121
local_output_nid generation:  0.006042003631591797
local_in_edges_tensor generation:  0.00325775146484375
mini_batch_src_global generation:  0.0028259754180908203
r_  generation:  0.03985857963562012
local_output_nid generation:  0.006086111068725586
local_in_edges_tensor generation:  0.00322723388671875
mini_batch_src_global generation:  0.0030455589294433594
r_  generation:  0.040564537048339844
local_output_nid generation:  0.0061185359954833984
local_in_edges_tensor generation:  0.0032253265380859375
mini_batch_src_global generation:  0.0031502246856689453
r_  generation:  0.040952205657958984
local_output_nid generation:  0.0060994625091552734
local_in_edges_tensor generation:  0.003194570541381836
mini_batch_src_global generation:  0.0033414363861083984
r_  generation:  0.04017758369445801
local_output_nid generation:  0.006094217300415039
local_in_edges_tensor generation:  0.0031652450561523438
mini_batch_src_global generation:  0.0033111572265625
r_  generation:  0.04096221923828125
----------------------check_connections_block total spend ----------------------------- 0.5092825889587402
generate_one_block  0.05498337745666504
generate_one_block  0.055114030838012695
generate_one_block  0.05471014976501465
generate_one_block  0.05506300926208496
generate_one_block  0.05870318412780762
generate_one_block  0.05527782440185547
generate_one_block  0.05503487586975098
generate_one_block  0.054708242416381836
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.041559457778930664
gen group dst list time:  0.015096902847290039
time for parepare:  0.01924419403076172
local_output_nid generation:  0.013208866119384766
local_in_edges_tensor generation:  0.033095598220825195
mini_batch_src_global generation:  0.03117513656616211
r_  generation:  0.2989048957824707
local_output_nid generation:  0.018552541732788086
local_in_edges_tensor generation:  0.030103683471679688
mini_batch_src_global generation:  0.03637337684631348
r_  generation:  0.3032195568084717
local_output_nid generation:  0.01795220375061035
local_in_edges_tensor generation:  0.024591922760009766
mini_batch_src_global generation:  0.036118268966674805
r_  generation:  0.3078274726867676
local_output_nid generation:  0.017935752868652344
local_in_edges_tensor generation:  0.02430891990661621
mini_batch_src_global generation:  0.03692913055419922
r_  generation:  0.3125004768371582
local_output_nid generation:  0.018116235733032227
local_in_edges_tensor generation:  0.02426600456237793
mini_batch_src_global generation:  0.03782391548156738
r_  generation:  0.317918062210083
local_output_nid generation:  0.018023967742919922
local_in_edges_tensor generation:  0.024362802505493164
mini_batch_src_global generation:  0.03824782371520996
r_  generation:  0.3173842430114746
local_output_nid generation:  0.01796269416809082
local_in_edges_tensor generation:  0.019341707229614258
mini_batch_src_global generation:  0.03835177421569824
r_  generation:  0.3147153854370117
local_output_nid generation:  0.01805901527404785
local_in_edges_tensor generation:  0.021747589111328125
mini_batch_src_global generation:  0.03820466995239258
r_  generation:  0.3174583911895752
----------------------check_connections_block total spend ----------------------------- 3.683931589126587
generate_one_block  0.40624260902404785
generate_one_block  0.39928317070007324
generate_one_block  0.4102795124053955
generate_one_block  0.4032888412475586
generate_one_block  0.41756367683410645
generate_one_block  0.4126887321472168
generate_one_block  0.4048733711242676
generate_one_block  0.41526007652282715
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03574514389038086
gen group dst list time:  0.03536677360534668
time for parepare:  0.01885819435119629
local_output_nid generation:  0.0283658504486084
local_in_edges_tensor generation:  0.04570198059082031
mini_batch_src_global generation:  0.051395416259765625
r_  generation:  0.5018997192382812
local_output_nid generation:  0.03462815284729004
local_in_edges_tensor generation:  0.05015730857849121
mini_batch_src_global generation:  0.05791139602661133
r_  generation:  0.5142192840576172
local_output_nid generation:  0.037534475326538086
local_in_edges_tensor generation:  0.038526058197021484
mini_batch_src_global generation:  0.05550885200500488
r_  generation:  0.5238327980041504
local_output_nid generation:  0.03465700149536133
local_in_edges_tensor generation:  0.042400360107421875
mini_batch_src_global generation:  0.059311866760253906
r_  generation:  0.5168757438659668
local_output_nid generation:  0.034922122955322266
local_in_edges_tensor generation:  0.03778553009033203
mini_batch_src_global generation:  0.06063961982727051
r_  generation:  0.5381789207458496
local_output_nid generation:  0.034615278244018555
local_in_edges_tensor generation:  0.033661842346191406
mini_batch_src_global generation:  0.05933213233947754
r_  generation:  0.5195727348327637
local_output_nid generation:  0.0347902774810791
local_in_edges_tensor generation:  0.033124446868896484
mini_batch_src_global generation:  0.06186413764953613
r_  generation:  0.5378661155700684
local_output_nid generation:  0.03490900993347168
local_in_edges_tensor generation:  0.04613685607910156
mini_batch_src_global generation:  0.06042933464050293
r_  generation:  0.5241549015045166
----------------------check_connections_block total spend ----------------------------- 6.174929857254028
generate_one_block  0.6587018966674805
generate_one_block  0.6625144481658936
generate_one_block  0.6680147647857666
generate_one_block  0.6753244400024414
generate_one_block  0.6752345561981201
generate_one_block  0.6523070335388184
generate_one_block  0.6844711303710938
generate_one_block  0.6762878894805908
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03087925910949707
gen group dst list time:  0.04531359672546387
time for parepare:  0.018914222717285156
local_output_nid generation:  0.03454279899597168
local_in_edges_tensor generation:  0.044252872467041016
mini_batch_src_global generation:  0.04491424560546875
r_  generation:  0.4925258159637451
local_output_nid generation:  0.03959035873413086
local_in_edges_tensor generation:  0.03496122360229492
mini_batch_src_global generation:  0.05738544464111328
r_  generation:  0.5036137104034424
local_output_nid generation:  0.039005279541015625
local_in_edges_tensor generation:  0.03924250602722168
mini_batch_src_global generation:  0.06047320365905762
r_  generation:  0.5070197582244873
local_output_nid generation:  0.03883790969848633
local_in_edges_tensor generation:  0.04345417022705078
mini_batch_src_global generation:  0.057611942291259766
r_  generation:  0.5077927112579346
local_output_nid generation:  0.03882908821105957
local_in_edges_tensor generation:  0.04301643371582031
mini_batch_src_global generation:  0.05445504188537598
r_  generation:  0.5126922130584717
local_output_nid generation:  0.03878474235534668
local_in_edges_tensor generation:  0.036005258560180664
mini_batch_src_global generation:  0.06358504295349121
r_  generation:  0.5136091709136963
local_output_nid generation:  0.04018092155456543
local_in_edges_tensor generation:  0.03858590126037598
mini_batch_src_global generation:  0.05455327033996582
r_  generation:  0.5202217102050781
local_output_nid generation:  0.03916001319885254
local_in_edges_tensor generation:  0.051436662673950195
mini_batch_src_global generation:  0.0782318115234375
r_  generation:  0.5252845287322998
----------------------check_connections_block total spend ----------------------------- 6.179269075393677
generate_one_block  0.6327829360961914
generate_one_block  0.6425220966339111
generate_one_block  0.6448850631713867
generate_one_block  0.648404598236084
generate_one_block  0.6387977600097656
generate_one_block  0.6262991428375244
generate_one_block  0.6893184185028076
generate_one_block  0.6370797157287598
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00014829635620117188  GigaBytes
Max Memory Allocated: 0.00014829635620117188  GigaBytes

connection checking time:  16.038130521774292
block generation total time  13.782425880432129
average batch blocks generation time:  1.7228032350540161
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2010498046875 GB
    Memory Allocated: 0.11117029190063477  GigaBytes
Max Memory Allocated: 0.11117029190063477  GigaBytes

torch.Size([165490, 128])
torch.Size([161180, 64])
torch.Size([142157, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8436279296875 GB
    Memory Allocated: 0.4902935028076172  GigaBytes
Max Memory Allocated: 0.5029778480529785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0701904296875 GB
    Memory Allocated: 0.11293363571166992  GigaBytes
Max Memory Allocated: 0.5211911201477051  GigaBytes

torch.Size([165459, 128])
torch.Size([161169, 64])
torch.Size([141771, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0701904296875 GB
    Memory Allocated: 0.48894262313842773  GigaBytes
Max Memory Allocated: 0.5211911201477051  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0701904296875 GB
    Memory Allocated: 0.11303091049194336  GigaBytes
Max Memory Allocated: 0.5211911201477051  GigaBytes

torch.Size([165438, 128])
torch.Size([161151, 64])
torch.Size([141768, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0701904296875 GB
    Memory Allocated: 0.4891648292541504  GigaBytes
Max Memory Allocated: 0.5211911201477051  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0701904296875 GB
    Memory Allocated: 0.11299514770507812  GigaBytes
Max Memory Allocated: 0.5211911201477051  GigaBytes

torch.Size([165516, 128])
torch.Size([161131, 64])
torch.Size([141910, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0701904296875 GB
    Memory Allocated: 0.4900202751159668  GigaBytes
Max Memory Allocated: 0.5211911201477051  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0701904296875 GB
    Memory Allocated: 0.11344718933105469  GigaBytes
Max Memory Allocated: 0.521636962890625  GigaBytes

torch.Size([165543, 128])
torch.Size([161390, 64])
torch.Size([142489, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0701904296875 GB
    Memory Allocated: 0.4905428886413574  GigaBytes
Max Memory Allocated: 0.521636962890625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.11324167251586914  GigaBytes
Max Memory Allocated: 0.522005558013916  GigaBytes

torch.Size([165410, 128])
torch.Size([161021, 64])
torch.Size([141472, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.4894380569458008  GigaBytes
Max Memory Allocated: 0.522005558013916  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.11290121078491211  GigaBytes
Max Memory Allocated: 0.522005558013916  GigaBytes

torch.Size([165450, 128])
torch.Size([161174, 64])
torch.Size([141992, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.4891343116760254  GigaBytes
Max Memory Allocated: 0.522005558013916  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.11330795288085938  GigaBytes
Max Memory Allocated: 0.522005558013916  GigaBytes

torch.Size([165359, 128])
torch.Size([161041, 64])
torch.Size([142160, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.4907350540161133  GigaBytes
Max Memory Allocated: 0.522005558013916  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.048116534948349 |0.06943070888519287 |0.0933217704296112 |0.00010713934898376465 |0.018783092498779297 |0.0048983097076416016 |
----------------------------------------------------------pseudo_mini_loss sum 5.594203948974609
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  4291222
Number of first layer input nodes during this epoch:  1323665
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.18190431594848633  GigaBytes
Max Memory Allocated: 0.5225934982299805  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.02966165542602539
random selection method range initialization spend 0.005544424057006836
time for parepare:  0.019282817840576172
local_output_nid generation:  0.004543304443359375
local_in_edges_tensor generation:  0.011253595352172852
mini_batch_src_global generation:  0.00334930419921875
r_  generation:  0.03676462173461914
local_output_nid generation:  0.006992816925048828
local_in_edges_tensor generation:  0.0033690929412841797
mini_batch_src_global generation:  0.0042226314544677734
r_  generation:  0.038716793060302734
local_output_nid generation:  0.0071794986724853516
local_in_edges_tensor generation:  0.003319978713989258
mini_batch_src_global generation:  0.0028896331787109375
r_  generation:  0.039977312088012695
local_output_nid generation:  0.0073626041412353516
local_in_edges_tensor generation:  0.0031843185424804688
mini_batch_src_global generation:  0.0029840469360351562
r_  generation:  0.040718793869018555
local_output_nid generation:  0.00741124153137207
local_in_edges_tensor generation:  0.0032775402069091797
mini_batch_src_global generation:  0.0030999183654785156
r_  generation:  0.04374504089355469
local_output_nid generation:  0.007420539855957031
local_in_edges_tensor generation:  0.0034499168395996094
mini_batch_src_global generation:  0.003398418426513672
r_  generation:  0.041655778884887695
local_output_nid generation:  0.0074803829193115234
local_in_edges_tensor generation:  0.0031435489654541016
mini_batch_src_global generation:  0.0034897327423095703
r_  generation:  0.04226374626159668
local_output_nid generation:  0.007448673248291016
local_in_edges_tensor generation:  0.003231525421142578
mini_batch_src_global generation:  0.0034606456756591797
r_  generation:  0.042401790618896484
----------------------check_connections_block total spend ----------------------------- 0.5461831092834473
generate_one_block  0.07106161117553711
generate_one_block  0.05487966537475586
generate_one_block  0.05461931228637695
generate_one_block  0.0549015998840332
generate_one_block  0.05443072319030762
generate_one_block  0.05438661575317383
generate_one_block  0.05861663818359375
generate_one_block  0.05583620071411133
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04104781150817871
gen group dst list time:  0.014731168746948242
time for parepare:  0.01924443244934082
local_output_nid generation:  0.013622283935546875
local_in_edges_tensor generation:  0.03740382194519043
mini_batch_src_global generation:  0.030782461166381836
r_  generation:  0.30191802978515625
local_output_nid generation:  0.023450136184692383
local_in_edges_tensor generation:  0.029904842376708984
mini_batch_src_global generation:  0.0366978645324707
r_  generation:  0.31709909439086914
local_output_nid generation:  0.02051568031311035
local_in_edges_tensor generation:  0.024125337600708008
mini_batch_src_global generation:  0.03626585006713867
r_  generation:  0.3243064880371094
local_output_nid generation:  0.02003765106201172
local_in_edges_tensor generation:  0.024469614028930664
mini_batch_src_global generation:  0.037230491638183594
r_  generation:  0.3200867176055908
local_output_nid generation:  0.020066499710083008
local_in_edges_tensor generation:  0.021657466888427734
mini_batch_src_global generation:  0.041155338287353516
r_  generation:  0.3349285125732422
local_output_nid generation:  0.02324080467224121
local_in_edges_tensor generation:  0.029680967330932617
mini_batch_src_global generation:  0.04468584060668945
r_  generation:  0.31848716735839844
local_output_nid generation:  0.020420551300048828
local_in_edges_tensor generation:  0.02816605567932129
mini_batch_src_global generation:  0.03834176063537598
r_  generation:  0.3196535110473633
local_output_nid generation:  0.020424365997314453
local_in_edges_tensor generation:  0.01876235008239746
mini_batch_src_global generation:  0.03884124755859375
r_  generation:  0.3328530788421631
----------------------check_connections_block total spend ----------------------------- 3.820537805557251
generate_one_block  0.41282176971435547
generate_one_block  0.4101543426513672
generate_one_block  0.4146149158477783
generate_one_block  0.4116497039794922
generate_one_block  0.4101850986480713
generate_one_block  0.4158759117126465
generate_one_block  0.41759729385375977
generate_one_block  0.4410367012023926
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.046009063720703125
gen group dst list time:  0.03750777244567871
time for parepare:  0.01989889144897461
local_output_nid generation:  0.02846503257751465
local_in_edges_tensor generation:  0.06297945976257324
mini_batch_src_global generation:  0.0526425838470459
r_  generation:  0.51188063621521
local_output_nid generation:  0.03748059272766113
local_in_edges_tensor generation:  0.05327653884887695
mini_batch_src_global generation:  0.059628963470458984
r_  generation:  0.5190796852111816
local_output_nid generation:  0.03696608543395996
local_in_edges_tensor generation:  0.03946685791015625
mini_batch_src_global generation:  0.05648303031921387
r_  generation:  0.5389447212219238
local_output_nid generation:  0.03721737861633301
local_in_edges_tensor generation:  0.03871917724609375
mini_batch_src_global generation:  0.05988907814025879
r_  generation:  0.5255992412567139
local_output_nid generation:  0.03777813911437988
local_in_edges_tensor generation:  0.048387765884399414
mini_batch_src_global generation:  0.058710336685180664
r_  generation:  0.5367896556854248
local_output_nid generation:  0.037596940994262695
local_in_edges_tensor generation:  0.035004615783691406
mini_batch_src_global generation:  0.06037735939025879
r_  generation:  0.5259292125701904
local_output_nid generation:  0.03771519660949707
local_in_edges_tensor generation:  0.03458690643310547
mini_batch_src_global generation:  0.058466434478759766
r_  generation:  0.5419704914093018
local_output_nid generation:  0.03776741027832031
local_in_edges_tensor generation:  0.0440363883972168
mini_batch_src_global generation:  0.060332298278808594
r_  generation:  0.5291411876678467
----------------------check_connections_block total spend ----------------------------- 6.27716851234436
generate_one_block  0.6665749549865723
generate_one_block  0.6751105785369873
generate_one_block  0.6879019737243652
generate_one_block  0.6852850914001465
generate_one_block  0.6780149936676025
generate_one_block  0.6598315238952637
generate_one_block  0.6673009395599365
generate_one_block  0.6756453514099121
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03634166717529297
gen group dst list time:  0.054826974868774414
time for parepare:  0.018942832946777344
local_output_nid generation:  0.033657073974609375
local_in_edges_tensor generation:  0.05571746826171875
mini_batch_src_global generation:  0.0454864501953125
r_  generation:  0.5401372909545898
local_output_nid generation:  0.04077506065368652
local_in_edges_tensor generation:  0.047618865966796875
mini_batch_src_global generation:  0.05714821815490723
r_  generation:  0.5105388164520264
local_output_nid generation:  0.04100680351257324
local_in_edges_tensor generation:  0.03951406478881836
mini_batch_src_global generation:  0.05711650848388672
r_  generation:  0.5061600208282471
local_output_nid generation:  0.03938126564025879
local_in_edges_tensor generation:  0.04315185546875
mini_batch_src_global generation:  0.05420184135437012
r_  generation:  0.5148983001708984
local_output_nid generation:  0.038754940032958984
local_in_edges_tensor generation:  0.03959393501281738
mini_batch_src_global generation:  0.06954455375671387
r_  generation:  0.5137796401977539
local_output_nid generation:  0.03930044174194336
local_in_edges_tensor generation:  0.04495382308959961
mini_batch_src_global generation:  0.054567813873291016
r_  generation:  0.5298473834991455
local_output_nid generation:  0.039257049560546875
local_in_edges_tensor generation:  0.03483915328979492
mini_batch_src_global generation:  0.05567455291748047
r_  generation:  0.5218534469604492
local_output_nid generation:  0.03880453109741211
local_in_edges_tensor generation:  0.04044055938720703
mini_batch_src_global generation:  0.05521798133850098
r_  generation:  0.5285604000091553
----------------------check_connections_block total spend ----------------------------- 6.227331161499023
generate_one_block  0.6354236602783203
generate_one_block  0.6380360126495361
generate_one_block  0.6499779224395752
generate_one_block  0.6285197734832764
generate_one_block  0.6386544704437256
generate_one_block  0.6481037139892578
generate_one_block  0.6305503845214844
generate_one_block  0.645235538482666
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.18190431594848633  GigaBytes
Max Memory Allocated: 0.5225934982299805  GigaBytes

connection checking time:  16.325037479400635
block generation total time  13.844102621078491
average batch blocks generation time:  1.7305128276348114
block dataloader generation time/epoch 32.503015995025635
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.11374711990356445  GigaBytes
Max Memory Allocated: 0.5225934982299805  GigaBytes

torch.Size([165576, 128])
torch.Size([161184, 64])
torch.Size([142251, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.49060583114624023  GigaBytes
Max Memory Allocated: 0.5225934982299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.11357450485229492  GigaBytes
Max Memory Allocated: 0.5225934982299805  GigaBytes

torch.Size([165516, 128])
torch.Size([161216, 64])
torch.Size([142031, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.49022579193115234  GigaBytes
Max Memory Allocated: 0.5225934982299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.11331844329833984  GigaBytes
Max Memory Allocated: 0.5225934982299805  GigaBytes

torch.Size([165536, 128])
torch.Size([161158, 64])
torch.Size([141840, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.48976755142211914  GigaBytes
Max Memory Allocated: 0.5225934982299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.11325263977050781  GigaBytes
Max Memory Allocated: 0.5225934982299805  GigaBytes

torch.Size([165398, 128])
torch.Size([161043, 64])
torch.Size([141951, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.4908175468444824  GigaBytes
Max Memory Allocated: 0.5225934982299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.11355829238891602  GigaBytes
Max Memory Allocated: 0.5226755142211914  GigaBytes

torch.Size([165454, 128])
torch.Size([161122, 64])
torch.Size([142065, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.49024009704589844  GigaBytes
Max Memory Allocated: 0.5226755142211914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.11319589614868164  GigaBytes
Max Memory Allocated: 0.5226755142211914  GigaBytes

torch.Size([165545, 128])
torch.Size([161233, 64])
torch.Size([141704, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.4890007972717285  GigaBytes
Max Memory Allocated: 0.5226755142211914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.11316251754760742  GigaBytes
Max Memory Allocated: 0.5226755142211914  GigaBytes

torch.Size([165343, 128])
torch.Size([160927, 64])
torch.Size([141523, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.4888014793395996  GigaBytes
Max Memory Allocated: 0.5226755142211914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.1136484146118164  GigaBytes
Max Memory Allocated: 0.5226755142211914  GigaBytes

torch.Size([165485, 128])
torch.Size([161300, 64])
torch.Size([142580, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.4908156394958496  GigaBytes
Max Memory Allocated: 0.5226755142211914  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.050339967012405396 |0.023470133543014526 |0.004482626914978027 |9.268522262573242e-05 |0.01049429178237915 |0.0038101673126220703 |
----------------------------------------------------------pseudo_mini_loss sum 4.4337592124938965
Total (block generation + training)time/epoch 33.25770592689514
Training time/epoch 0.7543959617614746
Training time without block to device /epoch 0.5666348934173584
Training time without total dataloading part /epoch 0.12436699867248535
load block tensor time/epoch 0.40271973609924316
block to device time/epoch 0.1877610683441162
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  4291927
Number of first layer input nodes during this epoch:  1323853
