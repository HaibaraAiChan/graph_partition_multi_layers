Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648437937.9635959
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027611970901489258
random selection method range initialization spend 0.00611567497253418
time for parepare:  0.01888895034790039
local_output_nid generation:  0.0021924972534179688
local_in_edges_tensor generation:  0.004893064498901367
mini_batch_src_global generation:  0.0020754337310791016
r_  generation:  0.020779132843017578
local_output_nid generation:  0.002804279327392578
local_in_edges_tensor generation:  0.0016922950744628906
mini_batch_src_global generation:  0.0025396347045898438
r_  generation:  0.02065443992614746
local_output_nid generation:  0.002895832061767578
local_in_edges_tensor generation:  0.001672506332397461
mini_batch_src_global generation:  0.00164794921875
r_  generation:  0.021053075790405273
local_output_nid generation:  0.0029349327087402344
local_in_edges_tensor generation:  0.001659393310546875
mini_batch_src_global generation:  0.0016837120056152344
r_  generation:  0.020738840103149414
local_output_nid generation:  0.0029036998748779297
local_in_edges_tensor generation:  0.0015642642974853516
mini_batch_src_global generation:  0.0016520023345947266
r_  generation:  0.021065711975097656
local_output_nid generation:  0.002964019775390625
local_in_edges_tensor generation:  0.0015680789947509766
mini_batch_src_global generation:  0.0016832351684570312
r_  generation:  0.02184915542602539
local_output_nid generation:  0.0029528141021728516
local_in_edges_tensor generation:  0.0016298294067382812
mini_batch_src_global generation:  0.0017821788787841797
r_  generation:  0.021804332733154297
local_output_nid generation:  0.002886533737182617
local_in_edges_tensor generation:  0.0014598369598388672
mini_batch_src_global generation:  0.001842498779296875
r_  generation:  0.021317481994628906
local_output_nid generation:  0.002908468246459961
local_in_edges_tensor generation:  0.0015530586242675781
mini_batch_src_global generation:  0.0017092227935791016
r_  generation:  0.021413087844848633
local_output_nid generation:  0.002948760986328125
local_in_edges_tensor generation:  0.0015244483947753906
mini_batch_src_global generation:  0.0017743110656738281
r_  generation:  0.02225041389465332
local_output_nid generation:  0.002927541732788086
local_in_edges_tensor generation:  0.0015921592712402344
mini_batch_src_global generation:  0.001781463623046875
r_  generation:  0.021674633026123047
local_output_nid generation:  0.002929210662841797
local_in_edges_tensor generation:  0.001523733139038086
mini_batch_src_global generation:  0.0018715858459472656
r_  generation:  0.021938323974609375
local_output_nid generation:  0.002997159957885742
local_in_edges_tensor generation:  0.0016074180603027344
mini_batch_src_global generation:  0.001760244369506836
r_  generation:  0.021526098251342773
local_output_nid generation:  0.002929210662841797
local_in_edges_tensor generation:  0.0015189647674560547
mini_batch_src_global generation:  0.0018584728240966797
r_  generation:  0.022413015365600586
local_output_nid generation:  0.002904176712036133
local_in_edges_tensor generation:  0.0015606880187988281
mini_batch_src_global generation:  0.0018014907836914062
r_  generation:  0.021142005920410156
local_output_nid generation:  0.002958059310913086
local_in_edges_tensor generation:  0.0014798641204833984
mini_batch_src_global generation:  0.0017838478088378906
r_  generation:  0.021683454513549805
----------------------check_connections_block total spend ----------------------------- 0.5539984703063965
generate_one_block  0.030910253524780273
generate_one_block  0.03274393081665039
generate_one_block  0.035332441329956055
generate_one_block  0.03254985809326172
generate_one_block  0.03209543228149414
generate_one_block  0.03235054016113281
generate_one_block  0.03186631202697754
generate_one_block  0.031310319900512695
generate_one_block  0.032047271728515625
generate_one_block  0.03197598457336426
generate_one_block  0.03130698204040527
generate_one_block  0.031923532485961914
generate_one_block  0.031049013137817383
generate_one_block  0.031711578369140625
generate_one_block  0.03078484535217285
generate_one_block  0.030637741088867188
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03773069381713867
gen group dst list time:  0.020809412002563477
time for parepare:  0.01971888542175293
local_output_nid generation:  0.009243965148925781
local_in_edges_tensor generation:  0.020993947982788086
mini_batch_src_global generation:  0.023181915283203125
r_  generation:  0.21220946311950684
local_output_nid generation:  0.01574230194091797
local_in_edges_tensor generation:  0.022629976272583008
mini_batch_src_global generation:  0.030020952224731445
r_  generation:  0.23169875144958496
local_output_nid generation:  0.015802860260009766
local_in_edges_tensor generation:  0.02088022232055664
mini_batch_src_global generation:  0.027959346771240234
r_  generation:  0.24549579620361328
local_output_nid generation:  0.015552043914794922
local_in_edges_tensor generation:  0.01871657371520996
mini_batch_src_global generation:  0.029013872146606445
r_  generation:  0.24204182624816895
local_output_nid generation:  0.01577448844909668
local_in_edges_tensor generation:  0.01679062843322754
mini_batch_src_global generation:  0.03248119354248047
r_  generation:  0.24410653114318848
local_output_nid generation:  0.015599727630615234
local_in_edges_tensor generation:  0.03494405746459961
mini_batch_src_global generation:  0.03643035888671875
r_  generation:  0.24510693550109863
local_output_nid generation:  0.01619410514831543
local_in_edges_tensor generation:  0.01560211181640625
mini_batch_src_global generation:  0.029909372329711914
r_  generation:  0.23999786376953125
local_output_nid generation:  0.0132904052734375
local_in_edges_tensor generation:  0.014786243438720703
mini_batch_src_global generation:  0.03029632568359375
r_  generation:  0.23188567161560059
local_output_nid generation:  0.013608455657958984
local_in_edges_tensor generation:  0.017033815383911133
mini_batch_src_global generation:  0.030278444290161133
r_  generation:  0.23698878288269043
local_output_nid generation:  0.013635396957397461
local_in_edges_tensor generation:  0.01700305938720703
mini_batch_src_global generation:  0.03025078773498535
r_  generation:  0.2416388988494873
local_output_nid generation:  0.01332402229309082
local_in_edges_tensor generation:  0.013390779495239258
mini_batch_src_global generation:  0.029613256454467773
r_  generation:  0.23525023460388184
local_output_nid generation:  0.013627052307128906
local_in_edges_tensor generation:  0.014928817749023438
mini_batch_src_global generation:  0.03238630294799805
r_  generation:  0.239426851272583
local_output_nid generation:  0.013268232345581055
local_in_edges_tensor generation:  0.015208959579467773
mini_batch_src_global generation:  0.030059099197387695
r_  generation:  0.24676251411437988
local_output_nid generation:  0.013386011123657227
local_in_edges_tensor generation:  0.012934207916259766
mini_batch_src_global generation:  0.030426502227783203
r_  generation:  0.2433927059173584
local_output_nid generation:  0.014184951782226562
local_in_edges_tensor generation:  0.02235698699951172
mini_batch_src_global generation:  0.03080916404724121
r_  generation:  0.23494195938110352
local_output_nid generation:  0.01330256462097168
local_in_edges_tensor generation:  0.014928579330444336
mini_batch_src_global generation:  0.03038644790649414
r_  generation:  0.22997236251831055
----------------------check_connections_block total spend ----------------------------- 5.6720356941223145
generate_one_block  0.3071310520172119
generate_one_block  0.3168196678161621
generate_one_block  0.3175833225250244
generate_one_block  0.30829548835754395
generate_one_block  0.3272671699523926
generate_one_block  0.3080713748931885
generate_one_block  0.3130335807800293
generate_one_block  0.299267053604126
generate_one_block  0.3094973564147949
generate_one_block  0.3216099739074707
generate_one_block  0.30782127380371094
generate_one_block  0.3385796546936035
generate_one_block  0.3029661178588867
generate_one_block  0.3162415027618408
generate_one_block  0.30576443672180176
generate_one_block  0.29924964904785156
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.07396602630615234
gen group dst list time:  0.07195186614990234
time for parepare:  0.019274473190307617
local_output_nid generation:  0.02559494972229004
local_in_edges_tensor generation:  0.05730462074279785
mini_batch_src_global generation:  0.04523181915283203
r_  generation:  0.4499831199645996
local_output_nid generation:  0.03527426719665527
local_in_edges_tensor generation:  0.047348737716674805
mini_batch_src_global generation:  0.052529335021972656
r_  generation:  0.4461965560913086
local_output_nid generation:  0.03142356872558594
local_in_edges_tensor generation:  0.03992795944213867
mini_batch_src_global generation:  0.05160379409790039
r_  generation:  0.455181360244751
local_output_nid generation:  0.03184962272644043
local_in_edges_tensor generation:  0.035416603088378906
mini_batch_src_global generation:  0.0534207820892334
r_  generation:  0.454272985458374
local_output_nid generation:  0.03159356117248535
local_in_edges_tensor generation:  0.03511977195739746
mini_batch_src_global generation:  0.055542945861816406
r_  generation:  0.45813798904418945
local_output_nid generation:  0.031471967697143555
local_in_edges_tensor generation:  0.030929088592529297
mini_batch_src_global generation:  0.06438255310058594
r_  generation:  0.45005249977111816
local_output_nid generation:  0.031842708587646484
local_in_edges_tensor generation:  0.03149890899658203
mini_batch_src_global generation:  0.05339550971984863
r_  generation:  0.4670853614807129
local_output_nid generation:  0.03226470947265625
local_in_edges_tensor generation:  0.043593406677246094
mini_batch_src_global generation:  0.053588151931762695
r_  generation:  0.45551013946533203
local_output_nid generation:  0.031748056411743164
local_in_edges_tensor generation:  0.040822744369506836
mini_batch_src_global generation:  0.0570521354675293
r_  generation:  0.4647808074951172
local_output_nid generation:  0.03316855430603027
local_in_edges_tensor generation:  0.0431368350982666
mini_batch_src_global generation:  0.05659747123718262
r_  generation:  0.4609839916229248
local_output_nid generation:  0.03234529495239258
local_in_edges_tensor generation:  0.03972959518432617
mini_batch_src_global generation:  0.061081886291503906
r_  generation:  0.4573028087615967
local_output_nid generation:  0.034133195877075195
local_in_edges_tensor generation:  0.03755378723144531
mini_batch_src_global generation:  0.06471419334411621
r_  generation:  0.45925140380859375
local_output_nid generation:  0.03212308883666992
local_in_edges_tensor generation:  0.03099536895751953
mini_batch_src_global generation:  0.053862810134887695
r_  generation:  0.46117115020751953
local_output_nid generation:  0.03272747993469238
local_in_edges_tensor generation:  0.03610539436340332
mini_batch_src_global generation:  0.054328203201293945
r_  generation:  0.45578479766845703
local_output_nid generation:  0.03190445899963379
local_in_edges_tensor generation:  0.03085017204284668
mini_batch_src_global generation:  0.05656170845031738
r_  generation:  0.45701050758361816
local_output_nid generation:  0.031859636306762695
local_in_edges_tensor generation:  0.03937196731567383
mini_batch_src_global generation:  0.06432890892028809
r_  generation:  0.4576411247253418
----------------------check_connections_block total spend ----------------------------- 10.95120358467102
generate_one_block  0.5797758102416992
generate_one_block  0.5881941318511963
generate_one_block  0.6040151119232178
generate_one_block  0.5885968208312988
generate_one_block  0.5812909603118896
generate_one_block  0.587451696395874
generate_one_block  0.6456918716430664
generate_one_block  0.5782005786895752
generate_one_block  0.580780029296875
generate_one_block  0.5880544185638428
generate_one_block  0.5816476345062256
generate_one_block  0.5842320919036865
generate_one_block  0.5831553936004639
generate_one_block  0.5718576908111572
generate_one_block  0.5753378868103027
generate_one_block  0.5933947563171387
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

connection checking time:  16.623239278793335
block generation total time  14.41087555885315
average batch blocks generation time:  0.9006797224283218
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.09052801132202148  GigaBytes
Max Memory Allocated: 0.09052801132202148  GigaBytes

torch.Size([154729, 128])
torch.Size([123936, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.18297719955444336  GigaBytes
Max Memory Allocated: 0.1854686737060547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09171104431152344  GigaBytes
Max Memory Allocated: 0.19605064392089844  GigaBytes

torch.Size([154913, 128])
torch.Size([124503, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18489789962768555  GigaBytes
Max Memory Allocated: 0.19605064392089844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09183406829833984  GigaBytes
Max Memory Allocated: 0.19605064392089844  GigaBytes

torch.Size([155513, 128])
torch.Size([125982, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18736696243286133  GigaBytes
Max Memory Allocated: 0.19605064392089844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09171009063720703  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

torch.Size([155620, 128])
torch.Size([125628, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18595600128173828  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09166812896728516  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

torch.Size([155483, 128])
torch.Size([125892, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18585777282714844  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09158134460449219  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

torch.Size([154672, 128])
torch.Size([124109, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.1844773292541504  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09171295166015625  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

torch.Size([155352, 128])
torch.Size([125464, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.1858525276184082  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.0915060043334961  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

torch.Size([154882, 128])
torch.Size([124592, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.1842050552368164  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09160900115966797  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

torch.Size([155341, 128])
torch.Size([125205, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.1855907440185547  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09175968170166016  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

torch.Size([155066, 128])
torch.Size([125157, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18702173233032227  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09150981903076172  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

torch.Size([155094, 128])
torch.Size([124677, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18531370162963867  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09169292449951172  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

torch.Size([155073, 128])
torch.Size([125054, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18594598770141602  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.0915060043334961  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

torch.Size([155131, 128])
torch.Size([125068, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.1853194236755371  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.091522216796875  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

torch.Size([154788, 128])
torch.Size([124479, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18445110321044922  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09143733978271484  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

torch.Size([154980, 128])
torch.Size([124372, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18278837203979492  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09142303466796875  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

torch.Size([155076, 128])
torch.Size([125166, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18403387069702148  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.034957364201545715 |0.034037619829177856 |0.05068562924861908 |9.88990068435669e-05 |0.007474139332771301 |0.0022826194763183594 |
----------------------------------------------------------pseudo_mini_loss sum 5.048877716064453
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5211149
Number of first layer input nodes during this epoch:  2481713
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.1260671615600586  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.05922651290893555
random selection method range initialization spend 0.004854679107666016
time for parepare:  0.01716756820678711
local_output_nid generation:  0.002462148666381836
local_in_edges_tensor generation:  0.007548332214355469
mini_batch_src_global generation:  0.0019562244415283203
r_  generation:  0.019485950469970703
local_output_nid generation:  0.003165721893310547
local_in_edges_tensor generation:  0.0017685890197753906
mini_batch_src_global generation:  0.0024297237396240234
r_  generation:  0.02198195457458496
local_output_nid generation:  0.003068208694458008
local_in_edges_tensor generation:  0.0017871856689453125
mini_batch_src_global generation:  0.0015943050384521484
r_  generation:  0.020429134368896484
local_output_nid generation:  0.003011465072631836
local_in_edges_tensor generation:  0.0016281604766845703
mini_batch_src_global generation:  0.0016427040100097656
r_  generation:  0.021495342254638672
local_output_nid generation:  0.002953052520751953
local_in_edges_tensor generation:  0.0017299652099609375
mini_batch_src_global generation:  0.0016131401062011719
r_  generation:  0.0212099552154541
local_output_nid generation:  0.00302886962890625
local_in_edges_tensor generation:  0.0015943050384521484
mini_batch_src_global generation:  0.0016949176788330078
r_  generation:  0.021695613861083984
local_output_nid generation:  0.0029675960540771484
local_in_edges_tensor generation:  0.0015764236450195312
mini_batch_src_global generation:  0.0016789436340332031
r_  generation:  0.021873950958251953
local_output_nid generation:  0.0029954910278320312
local_in_edges_tensor generation:  0.0015988349914550781
mini_batch_src_global generation:  0.0017209053039550781
r_  generation:  0.021623849868774414
local_output_nid generation:  0.0029599666595458984
local_in_edges_tensor generation:  0.0016181468963623047
mini_batch_src_global generation:  0.0017359256744384766
r_  generation:  0.021649599075317383
local_output_nid generation:  0.0029554367065429688
local_in_edges_tensor generation:  0.001590728759765625
mini_batch_src_global generation:  0.0017726421356201172
r_  generation:  0.022591114044189453
local_output_nid generation:  0.0029501914978027344
local_in_edges_tensor generation:  0.001641988754272461
mini_batch_src_global generation:  0.0017788410186767578
r_  generation:  0.022638320922851562
local_output_nid generation:  0.0029757022857666016
local_in_edges_tensor generation:  0.0016088485717773438
mini_batch_src_global generation:  0.0017848014831542969
r_  generation:  0.024953126907348633
local_output_nid generation:  0.003058910369873047
local_in_edges_tensor generation:  0.0016770362854003906
mini_batch_src_global generation:  0.0017633438110351562
r_  generation:  0.03193855285644531
local_output_nid generation:  0.004826545715332031
local_in_edges_tensor generation:  0.0025773048400878906
mini_batch_src_global generation:  0.006897926330566406
r_  generation:  0.03033590316772461
local_output_nid generation:  0.0040853023529052734
local_in_edges_tensor generation:  0.005269765853881836
mini_batch_src_global generation:  0.0031838417053222656
r_  generation:  0.024915695190429688
local_output_nid generation:  0.0032656192779541016
local_in_edges_tensor generation:  0.001999378204345703
mini_batch_src_global generation:  0.002223491668701172
r_  generation:  0.022816181182861328
----------------------check_connections_block total spend ----------------------------- 0.6147923469543457
generate_one_block  0.03454232215881348
generate_one_block  0.03122115135192871
generate_one_block  0.03142237663269043
generate_one_block  0.03385734558105469
generate_one_block  0.03148698806762695
generate_one_block  0.036081552505493164
generate_one_block  0.0338289737701416
generate_one_block  0.03145551681518555
generate_one_block  0.03154754638671875
generate_one_block  0.032453060150146484
generate_one_block  0.032561540603637695
generate_one_block  0.0320737361907959
generate_one_block  0.031163692474365234
generate_one_block  0.04066920280456543
generate_one_block  0.03586769104003906
generate_one_block  0.031577110290527344
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.047864675521850586
gen group dst list time:  0.024941444396972656
time for parepare:  0.030707836151123047
local_output_nid generation:  0.012096166610717773
local_in_edges_tensor generation:  0.036490678787231445
mini_batch_src_global generation:  0.020717382431030273
r_  generation:  0.20825433731079102
local_output_nid generation:  0.015807390213012695
local_in_edges_tensor generation:  0.020885229110717773
mini_batch_src_global generation:  0.02730536460876465
r_  generation:  0.21831846237182617
local_output_nid generation:  0.016020536422729492
local_in_edges_tensor generation:  0.019517183303833008
mini_batch_src_global generation:  0.028624296188354492
r_  generation:  0.23556184768676758
local_output_nid generation:  0.01648879051208496
local_in_edges_tensor generation:  0.01899862289428711
mini_batch_src_global generation:  0.028143882751464844
r_  generation:  0.23047852516174316
local_output_nid generation:  0.016169071197509766
local_in_edges_tensor generation:  0.01557469367980957
mini_batch_src_global generation:  0.028806447982788086
r_  generation:  0.23269343376159668
local_output_nid generation:  0.016427040100097656
local_in_edges_tensor generation:  0.013446569442749023
mini_batch_src_global generation:  0.02952408790588379
r_  generation:  0.24069929122924805
local_output_nid generation:  0.015720605850219727
local_in_edges_tensor generation:  0.01801133155822754
mini_batch_src_global generation:  0.029808521270751953
r_  generation:  0.24402594566345215
local_output_nid generation:  0.019814014434814453
local_in_edges_tensor generation:  0.021140098571777344
mini_batch_src_global generation:  0.029964208602905273
r_  generation:  0.24337983131408691
local_output_nid generation:  0.01831841468811035
local_in_edges_tensor generation:  0.018782377243041992
mini_batch_src_global generation:  0.03157544136047363
r_  generation:  0.2351233959197998
local_output_nid generation:  0.016387224197387695
local_in_edges_tensor generation:  0.016445636749267578
mini_batch_src_global generation:  0.029867887496948242
r_  generation:  0.24859213829040527
local_output_nid generation:  0.01632547378540039
local_in_edges_tensor generation:  0.019995689392089844
mini_batch_src_global generation:  0.03943228721618652
r_  generation:  0.24765539169311523
local_output_nid generation:  0.016297340393066406
local_in_edges_tensor generation:  0.017249107360839844
mini_batch_src_global generation:  0.030269145965576172
r_  generation:  0.23912429809570312
local_output_nid generation:  0.01681041717529297
local_in_edges_tensor generation:  0.024573326110839844
mini_batch_src_global generation:  0.030418872833251953
r_  generation:  0.2513718605041504
local_output_nid generation:  0.01883673667907715
local_in_edges_tensor generation:  0.017009496688842773
mini_batch_src_global generation:  0.03166317939758301
r_  generation:  0.23743438720703125
local_output_nid generation:  0.01364755630493164
local_in_edges_tensor generation:  0.018298864364624023
mini_batch_src_global generation:  0.03172874450683594
r_  generation:  0.23713994026184082
local_output_nid generation:  0.013440370559692383
local_in_edges_tensor generation:  0.013151168823242188
mini_batch_src_global generation:  0.029868364334106445
r_  generation:  0.24618291854858398
----------------------check_connections_block total spend ----------------------------- 5.728851079940796
generate_one_block  0.3046708106994629
generate_one_block  0.29938459396362305
generate_one_block  0.3108336925506592
generate_one_block  0.30682969093322754
generate_one_block  0.3048365116119385
generate_one_block  0.30881166458129883
generate_one_block  0.350588321685791
generate_one_block  0.30542612075805664
generate_one_block  0.31505727767944336
generate_one_block  0.309528112411499
generate_one_block  0.3166632652282715
generate_one_block  0.3111252784729004
generate_one_block  0.29781317710876465
generate_one_block  0.30573368072509766
generate_one_block  0.33577966690063477
generate_one_block  0.2975311279296875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.049828290939331055
gen group dst list time:  0.07082939147949219
time for parepare:  0.018055438995361328
local_output_nid generation:  0.026406049728393555
local_in_edges_tensor generation:  0.058199405670166016
mini_batch_src_global generation:  0.04582381248474121
r_  generation:  0.4429664611816406
local_output_nid generation:  0.03224062919616699
local_in_edges_tensor generation:  0.046483516693115234
mini_batch_src_global generation:  0.052706241607666016
r_  generation:  0.4523298740386963
local_output_nid generation:  0.03196835517883301
local_in_edges_tensor generation:  0.03957390785217285
mini_batch_src_global generation:  0.0509333610534668
r_  generation:  0.46021533012390137
local_output_nid generation:  0.03209090232849121
local_in_edges_tensor generation:  0.03471660614013672
mini_batch_src_global generation:  0.05235171318054199
r_  generation:  0.4541149139404297
local_output_nid generation:  0.031958818435668945
local_in_edges_tensor generation:  0.08003520965576172
mini_batch_src_global generation:  0.055425405502319336
r_  generation:  0.4606471061706543
local_output_nid generation:  0.032263755798339844
local_in_edges_tensor generation:  0.039191484451293945
mini_batch_src_global generation:  0.0535435676574707
r_  generation:  0.4574239253997803
local_output_nid generation:  0.03211498260498047
local_in_edges_tensor generation:  0.0308229923248291
mini_batch_src_global generation:  0.05320143699645996
r_  generation:  0.4662938117980957
local_output_nid generation:  0.032717227935791016
local_in_edges_tensor generation:  0.030932903289794922
mini_batch_src_global generation:  0.0531773567199707
r_  generation:  0.4616968631744385
local_output_nid generation:  0.0321049690246582
local_in_edges_tensor generation:  0.037482500076293945
mini_batch_src_global generation:  0.056267738342285156
r_  generation:  0.4668748378753662
local_output_nid generation:  0.03224587440490723
local_in_edges_tensor generation:  0.04234480857849121
mini_batch_src_global generation:  0.05333518981933594
r_  generation:  0.4712107181549072
local_output_nid generation:  0.032955169677734375
local_in_edges_tensor generation:  0.03970742225646973
mini_batch_src_global generation:  0.058715105056762695
r_  generation:  0.46091294288635254
local_output_nid generation:  0.032044410705566406
local_in_edges_tensor generation:  0.03778672218322754
mini_batch_src_global generation:  0.05947136878967285
r_  generation:  0.4565093517303467
local_output_nid generation:  0.03376889228820801
local_in_edges_tensor generation:  0.03294062614440918
mini_batch_src_global generation:  0.05364561080932617
r_  generation:  0.4656558036804199
local_output_nid generation:  0.032981157302856445
local_in_edges_tensor generation:  0.04295158386230469
mini_batch_src_global generation:  0.05372786521911621
r_  generation:  0.4578516483306885
local_output_nid generation:  0.03324413299560547
local_in_edges_tensor generation:  0.03935813903808594
mini_batch_src_global generation:  0.05257010459899902
r_  generation:  0.4767885208129883
local_output_nid generation:  0.033060312271118164
local_in_edges_tensor generation:  0.03223538398742676
mini_batch_src_global generation:  0.05314373970031738
r_  generation:  0.4570343494415283
----------------------check_connections_block total spend ----------------------------- 11.039256572723389
generate_one_block  0.5831449031829834
generate_one_block  0.5868442058563232
generate_one_block  0.5991888046264648
generate_one_block  0.5790958404541016
generate_one_block  0.596198558807373
generate_one_block  0.6125242710113525
generate_one_block  0.5839314460754395
generate_one_block  0.5821511745452881
generate_one_block  0.6248841285705566
generate_one_block  0.59732985496521
generate_one_block  0.5958364009857178
generate_one_block  0.5879530906677246
generate_one_block  0.5850415229797363
generate_one_block  0.5941812992095947
generate_one_block  0.5986993312835693
generate_one_block  0.574948787689209
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.1260671615600586  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

connection checking time:  16.768107652664185
block generation total time  14.462566614151001
average batch blocks generation time:  0.9039104133844376
block dataloader generation time/epoch 33.61456346511841
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09154272079467773  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

torch.Size([154923, 128])
torch.Size([124284, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18305158615112305  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09157752990722656  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

torch.Size([155280, 128])
torch.Size([125060, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.1852579116821289  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09179019927978516  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

torch.Size([155120, 128])
torch.Size([124959, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18585777282714844  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09172630310058594  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

torch.Size([154724, 128])
torch.Size([124518, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18582582473754883  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09163475036621094  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

torch.Size([154962, 128])
torch.Size([124830, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18547582626342773  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09177398681640625  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

torch.Size([155107, 128])
torch.Size([125349, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18593263626098633  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.0917959213256836  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

torch.Size([154943, 128])
torch.Size([124848, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.1859416961669922  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09160327911376953  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

torch.Size([154633, 128])
torch.Size([124394, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18329763412475586  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09168815612792969  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

torch.Size([154798, 128])
torch.Size([124645, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.1856060028076172  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09171295166015625  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

torch.Size([155159, 128])
torch.Size([124941, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18587827682495117  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09184741973876953  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

torch.Size([154895, 128])
torch.Size([124591, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18704986572265625  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.0917205810546875  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

torch.Size([155059, 128])
torch.Size([124782, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18579339981079102  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09162616729736328  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

torch.Size([155159, 128])
torch.Size([125124, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18546772003173828  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09171485900878906  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

torch.Size([155125, 128])
torch.Size([125212, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18579769134521484  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09174156188964844  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

torch.Size([155274, 128])
torch.Size([125242, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18592357635498047  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09161758422851562  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

torch.Size([155092, 128])
torch.Size([124696, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18542718887329102  GigaBytes
Max Memory Allocated: 0.1981334686279297  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03214041888713837 |0.012673810124397278 |0.0036405622959136963 |9.149312973022461e-05 |0.00429108738899231 |0.002140045166015625 |
----------------------------------------------------------pseudo_mini_loss sum 4.333652019500732
Total (block generation + training)time/epoch 34.48852062225342
Training time/epoch 0.873748779296875
Training time without block to device /epoch 0.6709678173065186
Training time without total dataloading part /epoch 0.1305103302001953
load block tensor time/epoch 0.5142467021942139
block to device time/epoch 0.20278096199035645
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5207681
Number of first layer input nodes during this epoch:  2480253
