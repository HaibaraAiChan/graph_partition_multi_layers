Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648437478.200107
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0243682861328125
random selection method range initialization spend 0.0057713985443115234
time for parepare:  0.018728971481323242
local_output_nid generation:  0.002142667770385742
local_in_edges_tensor generation:  0.004485130310058594
mini_batch_src_global generation:  0.0018007755279541016
r_  generation:  0.01823115348815918
local_output_nid generation:  0.0027773380279541016
local_in_edges_tensor generation:  0.0016798973083496094
mini_batch_src_global generation:  0.0021431446075439453
r_  generation:  0.018750429153442383
local_output_nid generation:  0.002889871597290039
local_in_edges_tensor generation:  0.0015823841094970703
mini_batch_src_global generation:  0.0014195442199707031
r_  generation:  0.018581628799438477
local_output_nid generation:  0.0029070377349853516
local_in_edges_tensor generation:  0.0015387535095214844
mini_batch_src_global generation:  0.0013890266418457031
r_  generation:  0.01858353614807129
local_output_nid generation:  0.0028781890869140625
local_in_edges_tensor generation:  0.0014684200286865234
mini_batch_src_global generation:  0.0014727115631103516
r_  generation:  0.01888751983642578
local_output_nid generation:  0.0029277801513671875
local_in_edges_tensor generation:  0.0015263557434082031
mini_batch_src_global generation:  0.0014891624450683594
r_  generation:  0.018984317779541016
local_output_nid generation:  0.002889871597290039
local_in_edges_tensor generation:  0.0014803409576416016
mini_batch_src_global generation:  0.0014424324035644531
r_  generation:  0.019078731536865234
local_output_nid generation:  0.002881765365600586
local_in_edges_tensor generation:  0.0015201568603515625
mini_batch_src_global generation:  0.0014612674713134766
r_  generation:  0.01920461654663086
local_output_nid generation:  0.002907276153564453
local_in_edges_tensor generation:  0.0014684200286865234
mini_batch_src_global generation:  0.0014553070068359375
r_  generation:  0.018993854522705078
local_output_nid generation:  0.0028810501098632812
local_in_edges_tensor generation:  0.0014960765838623047
mini_batch_src_global generation:  0.0014812946319580078
r_  generation:  0.0192873477935791
local_output_nid generation:  0.002887248992919922
local_in_edges_tensor generation:  0.0015110969543457031
mini_batch_src_global generation:  0.0015311241149902344
r_  generation:  0.019135475158691406
local_output_nid generation:  0.002841472625732422
local_in_edges_tensor generation:  0.001489877700805664
mini_batch_src_global generation:  0.0015099048614501953
r_  generation:  0.01913142204284668
local_output_nid generation:  0.0028481483459472656
local_in_edges_tensor generation:  0.0014274120330810547
mini_batch_src_global generation:  0.001482248306274414
r_  generation:  0.018952608108520508
local_output_nid generation:  0.002906322479248047
local_in_edges_tensor generation:  0.0014655590057373047
mini_batch_src_global generation:  0.0015075206756591797
r_  generation:  0.019422292709350586
local_output_nid generation:  0.002908945083618164
local_in_edges_tensor generation:  0.0014836788177490234
mini_batch_src_global generation:  0.001566171646118164
r_  generation:  0.018662452697753906
local_output_nid generation:  0.002923727035522461
local_in_edges_tensor generation:  0.0014989376068115234
mini_batch_src_global generation:  0.0015168190002441406
r_  generation:  0.01885366439819336
----------------------check_connections_block total spend ----------------------------- 0.49654054641723633
generate_one_block  0.027057409286499023
generate_one_block  0.02885127067565918
generate_one_block  0.031333208084106445
generate_one_block  0.028415918350219727
generate_one_block  0.02826976776123047
generate_one_block  0.02843785285949707
generate_one_block  0.0279538631439209
generate_one_block  0.027915477752685547
generate_one_block  0.028148889541625977
generate_one_block  0.028179407119750977
generate_one_block  0.027559280395507812
generate_one_block  0.027805566787719727
generate_one_block  0.027468204498291016
generate_one_block  0.02815723419189453
generate_one_block  0.027124881744384766
generate_one_block  0.02747178077697754
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.034873008728027344
gen group dst list time:  0.018771648406982422
time for parepare:  0.018746376037597656
local_output_nid generation:  0.008006572723388672
local_in_edges_tensor generation:  0.015115499496459961
mini_batch_src_global generation:  0.018404245376586914
r_  generation:  0.1874065399169922
local_output_nid generation:  0.012161970138549805
local_in_edges_tensor generation:  0.019510746002197266
mini_batch_src_global generation:  0.023928403854370117
r_  generation:  0.2025740146636963
local_output_nid generation:  0.011961221694946289
local_in_edges_tensor generation:  0.014326095581054688
mini_batch_src_global generation:  0.02317667007446289
r_  generation:  0.2075200080871582
local_output_nid generation:  0.011771917343139648
local_in_edges_tensor generation:  0.013696908950805664
mini_batch_src_global generation:  0.02422642707824707
r_  generation:  0.20918035507202148
local_output_nid generation:  0.01194906234741211
local_in_edges_tensor generation:  0.012407779693603516
mini_batch_src_global generation:  0.02525782585144043
r_  generation:  0.20974326133728027
local_output_nid generation:  0.01188349723815918
local_in_edges_tensor generation:  0.015233755111694336
mini_batch_src_global generation:  0.03176259994506836
r_  generation:  0.21135234832763672
local_output_nid generation:  0.011793375015258789
local_in_edges_tensor generation:  0.013966083526611328
mini_batch_src_global generation:  0.025414228439331055
r_  generation:  0.20622968673706055
local_output_nid generation:  0.01173710823059082
local_in_edges_tensor generation:  0.015624761581420898
mini_batch_src_global generation:  0.025852441787719727
r_  generation:  0.2069694995880127
local_output_nid generation:  0.011783123016357422
local_in_edges_tensor generation:  0.015708208084106445
mini_batch_src_global generation:  0.02705073356628418
r_  generation:  0.2091214656829834
local_output_nid generation:  0.011976003646850586
local_in_edges_tensor generation:  0.012362003326416016
mini_batch_src_global generation:  0.025916099548339844
r_  generation:  0.21168875694274902
local_output_nid generation:  0.011803388595581055
local_in_edges_tensor generation:  0.013964414596557617
mini_batch_src_global generation:  0.026327133178710938
r_  generation:  0.2098538875579834
local_output_nid generation:  0.011860847473144531
local_in_edges_tensor generation:  0.013911724090576172
mini_batch_src_global generation:  0.02802896499633789
r_  generation:  0.2141425609588623
local_output_nid generation:  0.011758565902709961
local_in_edges_tensor generation:  0.011894702911376953
mini_batch_src_global generation:  0.025847673416137695
r_  generation:  0.21309399604797363
local_output_nid generation:  0.011789321899414062
local_in_edges_tensor generation:  0.012153148651123047
mini_batch_src_global generation:  0.026186227798461914
r_  generation:  0.209395170211792
local_output_nid generation:  0.011694192886352539
local_in_edges_tensor generation:  0.015395641326904297
mini_batch_src_global generation:  0.025211334228515625
r_  generation:  0.2084827423095703
local_output_nid generation:  0.011672258377075195
local_in_edges_tensor generation:  0.01392054557800293
mini_batch_src_global generation:  0.027341127395629883
r_  generation:  0.2067255973815918
----------------------check_connections_block total spend ----------------------------- 4.892850637435913
generate_one_block  0.26468849182128906
generate_one_block  0.27301788330078125
generate_one_block  0.27461767196655273
generate_one_block  0.27519655227661133
generate_one_block  0.2823352813720703
generate_one_block  0.26854658126831055
generate_one_block  0.270374059677124
generate_one_block  0.26639342308044434
generate_one_block  0.2670633792877197
generate_one_block  0.2723550796508789
generate_one_block  0.2696692943572998
generate_one_block  0.2698531150817871
generate_one_block  0.2648885250091553
generate_one_block  0.2666964530944824
generate_one_block  0.2686467170715332
generate_one_block  0.2648799419403076
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03297781944274902
gen group dst list time:  0.058799028396606445
time for parepare:  0.018820762634277344
local_output_nid generation:  0.025133371353149414
local_in_edges_tensor generation:  0.03737139701843262
mini_batch_src_global generation:  0.04012870788574219
r_  generation:  0.4318881034851074
local_output_nid generation:  0.031421661376953125
local_in_edges_tensor generation:  0.046875953674316406
mini_batch_src_global generation:  0.05319786071777344
r_  generation:  0.43987512588500977
local_output_nid generation:  0.03083014488220215
local_in_edges_tensor generation:  0.0468752384185791
mini_batch_src_global generation:  0.0491178035736084
r_  generation:  0.450101375579834
local_output_nid generation:  0.030921459197998047
local_in_edges_tensor generation:  0.03574967384338379
mini_batch_src_global generation:  0.051733970642089844
r_  generation:  0.45015859603881836
local_output_nid generation:  0.03103160858154297
local_in_edges_tensor generation:  0.0394287109375
mini_batch_src_global generation:  0.05075693130493164
r_  generation:  0.4519944190979004
local_output_nid generation:  0.030351877212524414
local_in_edges_tensor generation:  0.031112194061279297
mini_batch_src_global generation:  0.05157756805419922
r_  generation:  0.4451925754547119
local_output_nid generation:  0.03081989288330078
local_in_edges_tensor generation:  0.03154563903808594
mini_batch_src_global generation:  0.05127239227294922
r_  generation:  0.4578690528869629
local_output_nid generation:  0.03040933609008789
local_in_edges_tensor generation:  0.03473830223083496
mini_batch_src_global generation:  0.05210447311401367
r_  generation:  0.4462738037109375
local_output_nid generation:  0.030754804611206055
local_in_edges_tensor generation:  0.03429913520812988
mini_batch_src_global generation:  0.050887107849121094
r_  generation:  0.4531674385070801
local_output_nid generation:  0.030709028244018555
local_in_edges_tensor generation:  0.0427098274230957
mini_batch_src_global generation:  0.05196833610534668
r_  generation:  0.4552178382873535
local_output_nid generation:  0.03158307075500488
local_in_edges_tensor generation:  0.0314178466796875
mini_batch_src_global generation:  0.056212425231933594
r_  generation:  0.4519209861755371
local_output_nid generation:  0.03070807456970215
local_in_edges_tensor generation:  0.03167223930358887
mini_batch_src_global generation:  0.05262923240661621
r_  generation:  0.4541893005371094
local_output_nid generation:  0.030594825744628906
local_in_edges_tensor generation:  0.03600192070007324
mini_batch_src_global generation:  0.05193448066711426
r_  generation:  0.45963597297668457
local_output_nid generation:  0.030809402465820312
local_in_edges_tensor generation:  0.04631233215332031
mini_batch_src_global generation:  0.052032470703125
r_  generation:  0.44998717308044434
local_output_nid generation:  0.03094649314880371
local_in_edges_tensor generation:  0.03602743148803711
mini_batch_src_global generation:  0.05454683303833008
r_  generation:  0.4565145969390869
local_output_nid generation:  0.030929088592529297
local_in_edges_tensor generation:  0.033232927322387695
mini_batch_src_global generation:  0.05267786979675293
r_  generation:  0.49193692207336426
----------------------check_connections_block total spend ----------------------------- 10.70988154411316
generate_one_block  0.5814740657806396
generate_one_block  0.5819218158721924
generate_one_block  0.6378521919250488
generate_one_block  0.6048433780670166
generate_one_block  0.5806212425231934
generate_one_block  0.5864191055297852
generate_one_block  0.6600816249847412
generate_one_block  0.6125783920288086
generate_one_block  0.6050698757171631
generate_one_block  0.6153228282928467
generate_one_block  0.5834448337554932
generate_one_block  0.5954909324645996
generate_one_block  0.6090481281280518
generate_one_block  0.5756127834320068
generate_one_block  0.5869743824005127
generate_one_block  0.582101583480835
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

connection checking time:  15.602732181549072
block generation total time  13.918079614639282
average batch blocks generation time:  0.8698799759149551
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.08970308303833008  GigaBytes
Max Memory Allocated: 0.08970308303833008  GigaBytes

torch.Size([154118, 128])
torch.Size([121441, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.17831087112426758  GigaBytes
Max Memory Allocated: 0.18035554885864258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.09088325500488281  GigaBytes
Max Memory Allocated: 0.18980073928833008  GigaBytes

torch.Size([154381, 128])
torch.Size([122318, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17927169799804688  GigaBytes
Max Memory Allocated: 0.18980073928833008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09090709686279297  GigaBytes
Max Memory Allocated: 0.19081544876098633  GigaBytes

torch.Size([154911, 128])
torch.Size([123370, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.1819438934326172  GigaBytes
Max Memory Allocated: 0.19081544876098633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09088134765625  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

torch.Size([155121, 128])
torch.Size([123354, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.18193769454956055  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09081363677978516  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

torch.Size([154772, 128])
torch.Size([123292, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.18192815780639648  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09073448181152344  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

torch.Size([154144, 128])
torch.Size([121682, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17881345748901367  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09074020385742188  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

torch.Size([154841, 128])
torch.Size([122738, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17920589447021484  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09071636199951172  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

torch.Size([154342, 128])
torch.Size([122230, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.1789846420288086  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09073162078857422  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

torch.Size([154756, 128])
torch.Size([122471, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17909812927246094  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09086799621582031  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

torch.Size([154521, 128])
torch.Size([122759, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17984819412231445  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09067726135253906  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

torch.Size([154552, 128])
torch.Size([122174, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17892980575561523  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09075736999511719  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

torch.Size([154501, 128])
torch.Size([122326, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17906618118286133  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.090667724609375  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

torch.Size([154620, 128])
torch.Size([122570, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17907333374023438  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09064865112304688  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

torch.Size([154252, 128])
torch.Size([121953, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17882490158081055  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.0906229019165039  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

torch.Size([154421, 128])
torch.Size([122203, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17667436599731445  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09061908721923828  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

torch.Size([154464, 128])
torch.Size([122491, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17798709869384766  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03410203754901886 |0.03463529050350189 |0.05073997378349304 |9.621679782867432e-05 |0.007613882422447205 |0.003610849380493164 |
----------------------------------------------------------pseudo_mini_loss sum 5.016565799713135
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5092988
Number of first layer input nodes during this epoch:  2472717
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.1249089241027832  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02026653289794922
random selection method range initialization spend 0.004930257797241211
time for parepare:  0.017596960067749023
local_output_nid generation:  0.002445220947265625
local_in_edges_tensor generation:  0.004900455474853516
mini_batch_src_global generation:  0.0017604827880859375
r_  generation:  0.019130706787109375
local_output_nid generation:  0.0028464794158935547
local_in_edges_tensor generation:  0.001844167709350586
mini_batch_src_global generation:  0.0020737648010253906
r_  generation:  0.018365144729614258
local_output_nid generation:  0.002895355224609375
local_in_edges_tensor generation:  0.001714468002319336
mini_batch_src_global generation:  0.0013506412506103516
r_  generation:  0.01816868782043457
local_output_nid generation:  0.0028738975524902344
local_in_edges_tensor generation:  0.0016787052154541016
mini_batch_src_global generation:  0.0013682842254638672
r_  generation:  0.018859148025512695
local_output_nid generation:  0.0029451847076416016
local_in_edges_tensor generation:  0.0016937255859375
mini_batch_src_global generation:  0.0013802051544189453
r_  generation:  0.01870894432067871
local_output_nid generation:  0.002938508987426758
local_in_edges_tensor generation:  0.0016856193542480469
mini_batch_src_global generation:  0.0014271736145019531
r_  generation:  0.01894998550415039
local_output_nid generation:  0.0030107498168945312
local_in_edges_tensor generation:  0.0016427040100097656
mini_batch_src_global generation:  0.0014450550079345703
r_  generation:  0.019004106521606445
local_output_nid generation:  0.0029077529907226562
local_in_edges_tensor generation:  0.001598358154296875
mini_batch_src_global generation:  0.0014598369598388672
r_  generation:  0.019130945205688477
local_output_nid generation:  0.0029420852661132812
local_in_edges_tensor generation:  0.0015971660614013672
mini_batch_src_global generation:  0.0014605522155761719
r_  generation:  0.018765687942504883
local_output_nid generation:  0.0029137134552001953
local_in_edges_tensor generation:  0.0016307830810546875
mini_batch_src_global generation:  0.0014858245849609375
r_  generation:  0.019641637802124023
local_output_nid generation:  0.002954721450805664
local_in_edges_tensor generation:  0.0016422271728515625
mini_batch_src_global generation:  0.0014796257019042969
r_  generation:  0.01957249641418457
local_output_nid generation:  0.0029010772705078125
local_in_edges_tensor generation:  0.0015714168548583984
mini_batch_src_global generation:  0.0014965534210205078
r_  generation:  0.01969170570373535
local_output_nid generation:  0.0029582977294921875
local_in_edges_tensor generation:  0.0016849040985107422
mini_batch_src_global generation:  0.0014727115631103516
r_  generation:  0.019298553466796875
local_output_nid generation:  0.0028977394104003906
local_in_edges_tensor generation:  0.001596212387084961
mini_batch_src_global generation:  0.0015370845794677734
r_  generation:  0.019692659378051758
local_output_nid generation:  0.0029103755950927734
local_in_edges_tensor generation:  0.0015964508056640625
mini_batch_src_global generation:  0.0015234947204589844
r_  generation:  0.019750595092773438
local_output_nid generation:  0.002910614013671875
local_in_edges_tensor generation:  0.0016529560089111328
mini_batch_src_global generation:  0.001523733139038086
r_  generation:  0.01969003677368164
----------------------check_connections_block total spend ----------------------------- 0.5068807601928711
generate_one_block  0.0343475341796875
generate_one_block  0.02798151969909668
generate_one_block  0.02759575843811035
generate_one_block  0.028467655181884766
generate_one_block  0.027879953384399414
generate_one_block  0.0303800106048584
generate_one_block  0.027857542037963867
generate_one_block  0.0275423526763916
generate_one_block  0.02746868133544922
generate_one_block  0.028499364852905273
generate_one_block  0.02825021743774414
generate_one_block  0.027979135513305664
generate_one_block  0.02744770050048828
generate_one_block  0.027648448944091797
generate_one_block  0.028128385543823242
generate_one_block  0.028476715087890625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.035272836685180664
gen group dst list time:  0.017240047454833984
time for parepare:  0.01903247833251953
local_output_nid generation:  0.008058786392211914
local_in_edges_tensor generation:  0.016729116439819336
mini_batch_src_global generation:  0.018493175506591797
r_  generation:  0.19275593757629395
local_output_nid generation:  0.012602806091308594
local_in_edges_tensor generation:  0.018736600875854492
mini_batch_src_global generation:  0.023771286010742188
r_  generation:  0.1976640224456787
local_output_nid generation:  0.01329183578491211
local_in_edges_tensor generation:  0.017312288284301758
mini_batch_src_global generation:  0.026261091232299805
r_  generation:  0.21055841445922852
local_output_nid generation:  0.013725996017456055
local_in_edges_tensor generation:  0.016000032424926758
mini_batch_src_global generation:  0.026051759719848633
r_  generation:  0.20965981483459473
local_output_nid generation:  0.013357400894165039
local_in_edges_tensor generation:  0.011537790298461914
mini_batch_src_global generation:  0.026019811630249023
r_  generation:  0.2128736972808838
local_output_nid generation:  0.013201475143432617
local_in_edges_tensor generation:  0.013642311096191406
mini_batch_src_global generation:  0.02574443817138672
r_  generation:  0.21426010131835938
local_output_nid generation:  0.013194799423217773
local_in_edges_tensor generation:  0.015635967254638672
mini_batch_src_global generation:  0.02974557876586914
r_  generation:  0.2329113483428955
local_output_nid generation:  0.016091346740722656
local_in_edges_tensor generation:  0.020194530487060547
mini_batch_src_global generation:  0.02772998809814453
r_  generation:  0.2104933261871338
local_output_nid generation:  0.013178825378417969
local_in_edges_tensor generation:  0.014111757278442383
mini_batch_src_global generation:  0.02656388282775879
r_  generation:  0.2162458896636963
local_output_nid generation:  0.013458013534545898
local_in_edges_tensor generation:  0.01625847816467285
mini_batch_src_global generation:  0.02643418312072754
r_  generation:  0.21935319900512695
local_output_nid generation:  0.013522624969482422
local_in_edges_tensor generation:  0.014104604721069336
mini_batch_src_global generation:  0.02686142921447754
r_  generation:  0.2186264991760254
local_output_nid generation:  0.013273000717163086
local_in_edges_tensor generation:  0.013799905776977539
mini_batch_src_global generation:  0.0591733455657959
r_  generation:  0.2154078483581543
local_output_nid generation:  0.013185262680053711
local_in_edges_tensor generation:  0.011744976043701172
mini_batch_src_global generation:  0.02651071548461914
r_  generation:  0.21357965469360352
local_output_nid generation:  0.013309717178344727
local_in_edges_tensor generation:  0.01337289810180664
mini_batch_src_global generation:  0.02677440643310547
r_  generation:  0.21958160400390625
local_output_nid generation:  0.013980865478515625
local_in_edges_tensor generation:  0.021288633346557617
mini_batch_src_global generation:  0.026773929595947266
r_  generation:  0.23053550720214844
local_output_nid generation:  0.014430522918701172
local_in_edges_tensor generation:  0.015460968017578125
mini_batch_src_global generation:  0.027481555938720703
r_  generation:  0.21338891983032227
----------------------check_connections_block total spend ----------------------------- 5.106768369674683
generate_one_block  0.27108216285705566
generate_one_block  0.2660665512084961
generate_one_block  0.27233099937438965
generate_one_block  0.2762794494628906
generate_one_block  0.27143383026123047
generate_one_block  0.2756524085998535
generate_one_block  0.30101561546325684
generate_one_block  0.26773929595947266
generate_one_block  0.27540135383605957
generate_one_block  0.27277565002441406
generate_one_block  0.27618885040283203
generate_one_block  0.2732231616973877
generate_one_block  0.2690012454986572
generate_one_block  0.270918607711792
generate_one_block  0.27680420875549316
generate_one_block  0.2685110569000244
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.046854257583618164
gen group dst list time:  0.06167292594909668
time for parepare:  0.01831340789794922
local_output_nid generation:  0.025507688522338867
local_in_edges_tensor generation:  0.05504250526428223
mini_batch_src_global generation:  0.04113292694091797
r_  generation:  0.4373178482055664
local_output_nid generation:  0.03133416175842285
local_in_edges_tensor generation:  0.05054116249084473
mini_batch_src_global generation:  0.054245710372924805
r_  generation:  0.45052075386047363
local_output_nid generation:  0.032202959060668945
local_in_edges_tensor generation:  0.04660201072692871
mini_batch_src_global generation:  0.050066232681274414
r_  generation:  0.46396708488464355
local_output_nid generation:  0.031847238540649414
local_in_edges_tensor generation:  0.04221534729003906
mini_batch_src_global generation:  0.055999040603637695
r_  generation:  0.46266651153564453
local_output_nid generation:  0.0344088077545166
local_in_edges_tensor generation:  0.09560704231262207
mini_batch_src_global generation:  0.05555915832519531
r_  generation:  0.4541144371032715
local_output_nid generation:  0.03266334533691406
local_in_edges_tensor generation:  0.03983473777770996
mini_batch_src_global generation:  0.05521678924560547
r_  generation:  0.4518706798553467
local_output_nid generation:  0.031050920486450195
local_in_edges_tensor generation:  0.03159689903259277
mini_batch_src_global generation:  0.052101850509643555
r_  generation:  0.4565317630767822
local_output_nid generation:  0.031234025955200195
local_in_edges_tensor generation:  0.03158736228942871
mini_batch_src_global generation:  0.07036042213439941
r_  generation:  0.4622921943664551
local_output_nid generation:  0.031265974044799805
local_in_edges_tensor generation:  0.03147315979003906
mini_batch_src_global generation:  0.05233192443847656
r_  generation:  0.4587705135345459
local_output_nid generation:  0.031177282333374023
local_in_edges_tensor generation:  0.03150129318237305
mini_batch_src_global generation:  0.05306220054626465
r_  generation:  0.45572590827941895
local_output_nid generation:  0.031116247177124023
local_in_edges_tensor generation:  0.04780173301696777
mini_batch_src_global generation:  0.05189967155456543
r_  generation:  0.4621005058288574
local_output_nid generation:  0.031121492385864258
local_in_edges_tensor generation:  0.03189849853515625
mini_batch_src_global generation:  0.05276966094970703
r_  generation:  0.4553205966949463
local_output_nid generation:  0.03129458427429199
local_in_edges_tensor generation:  0.031221389770507812
mini_batch_src_global generation:  0.0524446964263916
r_  generation:  0.46001768112182617
local_output_nid generation:  0.031408071517944336
local_in_edges_tensor generation:  0.03162717819213867
mini_batch_src_global generation:  0.05264568328857422
r_  generation:  0.4675588607788086
local_output_nid generation:  0.031499624252319336
local_in_edges_tensor generation:  0.04751443862915039
mini_batch_src_global generation:  0.05161595344543457
r_  generation:  0.4634225368499756
local_output_nid generation:  0.03158116340637207
local_in_edges_tensor generation:  0.03213334083557129
mini_batch_src_global generation:  0.052614688873291016
r_  generation:  0.4563474655151367
----------------------check_connections_block total spend ----------------------------- 10.938006162643433
generate_one_block  0.5775885581970215
generate_one_block  0.57452392578125
generate_one_block  0.588698148727417
generate_one_block  0.5675098896026611
generate_one_block  0.5914821624755859
generate_one_block  0.5856685638427734
generate_one_block  0.5824174880981445
generate_one_block  0.5671377182006836
generate_one_block  0.6052470207214355
generate_one_block  0.5792264938354492
generate_one_block  0.579596757888794
generate_one_block  0.5823383331298828
generate_one_block  0.5750014781951904
generate_one_block  0.5786275863647461
generate_one_block  0.6038227081298828
generate_one_block  0.5683314800262451
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.1249089241027832  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

connection checking time:  16.044774532318115
block generation total time  13.691642761230469
average batch blocks generation time:  0.8557276725769043
block dataloader generation time/epoch 31.867039442062378
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09071683883666992  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

torch.Size([154321, 128])
torch.Size([121823, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.1767559051513672  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09074974060058594  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

torch.Size([154590, 128])
torch.Size([122444, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17909908294677734  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.0908956527709961  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

torch.Size([154471, 128])
torch.Size([122565, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17932987213134766  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09089279174804688  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

torch.Size([154034, 128])
torch.Size([122102, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17912912368774414  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09082984924316406  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

torch.Size([154464, 128])
torch.Size([122492, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.1791973114013672  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09090423583984375  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

torch.Size([154503, 128])
torch.Size([122921, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.18193912506103516  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.090911865234375  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

torch.Size([154404, 128])
torch.Size([122585, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17932415008544922  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09078693389892578  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

torch.Size([154115, 128])
torch.Size([122133, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.177978515625  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09080219268798828  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

torch.Size([154229, 128])
torch.Size([122105, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17902469635009766  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09086894989013672  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

torch.Size([154489, 128])
torch.Size([122329, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17919397354125977  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09095287322998047  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

torch.Size([154389, 128])
torch.Size([122220, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17931079864501953  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09082603454589844  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

torch.Size([154426, 128])
torch.Size([122155, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17907047271728516  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09077644348144531  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

torch.Size([154499, 128])
torch.Size([122503, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17915773391723633  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09082794189453125  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

torch.Size([154481, 128])
torch.Size([122581, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17924165725708008  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09090232849121094  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

torch.Size([154619, 128])
torch.Size([122774, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17992782592773438  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09079170227050781  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

torch.Size([154640, 128])
torch.Size([122386, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17913436889648438  GigaBytes
Max Memory Allocated: 0.19336271286010742  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.027878254652023315 |0.01425178349018097 |0.003474220633506775 |9.295344352722168e-05 |0.004131481051445007 |0.0029876232147216797 |
----------------------------------------------------------pseudo_mini_loss sum 4.321111679077148
Total (block generation + training)time/epoch 32.69280791282654
Training time/epoch 0.8254644870758057
Training time without block to device /epoch 0.5974359512329102
Training time without total dataloading part /epoch 0.12616610527038574
load block tensor time/epoch 0.44605207443237305
block to device time/epoch 0.2280285358428955
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5089965
Number of first layer input nodes during this epoch:  2470674
