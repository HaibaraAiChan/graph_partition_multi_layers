Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648441044.709156
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02734684944152832
random selection method range initialization spend 0.0064814090728759766
time for parepare:  0.018839359283447266
local_output_nid generation:  0.0011038780212402344
local_in_edges_tensor generation:  0.004194498062133789
mini_batch_src_global generation:  0.0016484260559082031
r_  generation:  0.010434150695800781
local_output_nid generation:  0.0012707710266113281
local_in_edges_tensor generation:  0.0009520053863525391
mini_batch_src_global generation:  0.0015554428100585938
r_  generation:  0.009435892105102539
local_output_nid generation:  0.0013773441314697266
local_in_edges_tensor generation:  0.0008854866027832031
mini_batch_src_global generation:  0.0010607242584228516
r_  generation:  0.009289979934692383
local_output_nid generation:  0.0013887882232666016
local_in_edges_tensor generation:  0.0008575916290283203
mini_batch_src_global generation:  0.0010013580322265625
r_  generation:  0.009319305419921875
local_output_nid generation:  0.0014147758483886719
local_in_edges_tensor generation:  0.0008196830749511719
mini_batch_src_global generation:  0.0009393692016601562
r_  generation:  0.009059667587280273
local_output_nid generation:  0.0014004707336425781
local_in_edges_tensor generation:  0.0008063316345214844
mini_batch_src_global generation:  0.0010023117065429688
r_  generation:  0.009876489639282227
local_output_nid generation:  0.0014514923095703125
local_in_edges_tensor generation:  0.0007894039154052734
mini_batch_src_global generation:  0.0009868144989013672
r_  generation:  0.00949549674987793
local_output_nid generation:  0.0014233589172363281
local_in_edges_tensor generation:  0.0008139610290527344
mini_batch_src_global generation:  0.0010001659393310547
r_  generation:  0.00980377197265625
local_output_nid generation:  0.0014503002166748047
local_in_edges_tensor generation:  0.0007908344268798828
mini_batch_src_global generation:  0.0009355545043945312
r_  generation:  0.009296655654907227
local_output_nid generation:  0.0014274120330810547
local_in_edges_tensor generation:  0.0007882118225097656
mini_batch_src_global generation:  0.0009610652923583984
r_  generation:  0.009535551071166992
local_output_nid generation:  0.0014231204986572266
local_in_edges_tensor generation:  0.0007717609405517578
mini_batch_src_global generation:  0.0010058879852294922
r_  generation:  0.009865999221801758
local_output_nid generation:  0.0014240741729736328
local_in_edges_tensor generation:  0.0007734298706054688
mini_batch_src_global generation:  0.0010139942169189453
r_  generation:  0.00957179069519043
local_output_nid generation:  0.0014214515686035156
local_in_edges_tensor generation:  0.0007526874542236328
mini_batch_src_global generation:  0.0009796619415283203
r_  generation:  0.009761810302734375
local_output_nid generation:  0.0014383792877197266
local_in_edges_tensor generation:  0.0007927417755126953
mini_batch_src_global generation:  0.0009796619415283203
r_  generation:  0.009566068649291992
local_output_nid generation:  0.0014238357543945312
local_in_edges_tensor generation:  0.0007505416870117188
mini_batch_src_global generation:  0.0010311603546142578
r_  generation:  0.010162830352783203
local_output_nid generation:  0.001474618911743164
local_in_edges_tensor generation:  0.0007622241973876953
mini_batch_src_global generation:  0.0010190010070800781
r_  generation:  0.009968280792236328
local_output_nid generation:  0.0014307498931884766
local_in_edges_tensor generation:  0.0007724761962890625
mini_batch_src_global generation:  0.0010471343994140625
r_  generation:  0.00999760627746582
local_output_nid generation:  0.0014302730560302734
local_in_edges_tensor generation:  0.0007646083831787109
mini_batch_src_global generation:  0.0010333061218261719
r_  generation:  0.010241031646728516
local_output_nid generation:  0.0014259815216064453
local_in_edges_tensor generation:  0.0007696151733398438
mini_batch_src_global generation:  0.001064300537109375
r_  generation:  0.009668827056884766
local_output_nid generation:  0.001468658447265625
local_in_edges_tensor generation:  0.0007534027099609375
mini_batch_src_global generation:  0.001024007797241211
r_  generation:  0.009890556335449219
local_output_nid generation:  0.0014662742614746094
local_in_edges_tensor generation:  0.000797271728515625
mini_batch_src_global generation:  0.00104522705078125
r_  generation:  0.010251760482788086
local_output_nid generation:  0.0014591217041015625
local_in_edges_tensor generation:  0.0007569789886474609
mini_batch_src_global generation:  0.0010645389556884766
r_  generation:  0.010308980941772461
local_output_nid generation:  0.0014505386352539062
local_in_edges_tensor generation:  0.0007722377777099609
mini_batch_src_global generation:  0.0010390281677246094
r_  generation:  0.009858369827270508
local_output_nid generation:  0.0014908313751220703
local_in_edges_tensor generation:  0.0007550716400146484
mini_batch_src_global generation:  0.0010776519775390625
r_  generation:  0.009981632232666016
local_output_nid generation:  0.00146484375
local_in_edges_tensor generation:  0.0007505416870117188
mini_batch_src_global generation:  0.0010755062103271484
r_  generation:  0.01026153564453125
local_output_nid generation:  0.0014843940734863281
local_in_edges_tensor generation:  0.0007615089416503906
mini_batch_src_global generation:  0.0010132789611816406
r_  generation:  0.009776115417480469
local_output_nid generation:  0.001477956771850586
local_in_edges_tensor generation:  0.000736236572265625
mini_batch_src_global generation:  0.0009808540344238281
r_  generation:  0.009598970413208008
local_output_nid generation:  0.0014891624450683594
local_in_edges_tensor generation:  0.0007593631744384766
mini_batch_src_global generation:  0.000985860824584961
r_  generation:  0.009730339050292969
local_output_nid generation:  0.0014650821685791016
local_in_edges_tensor generation:  0.0007333755493164062
mini_batch_src_global generation:  0.001016378402709961
r_  generation:  0.00988626480102539
local_output_nid generation:  0.0014681816101074219
local_in_edges_tensor generation:  0.005469560623168945
mini_batch_src_global generation:  0.0012111663818359375
r_  generation:  0.009616851806640625
local_output_nid generation:  0.0013136863708496094
local_in_edges_tensor generation:  0.0007767677307128906
mini_batch_src_global generation:  0.001119375228881836
r_  generation:  0.010016441345214844
local_output_nid generation:  0.0013835430145263672
local_in_edges_tensor generation:  0.00074005126953125
mini_batch_src_global generation:  0.001065969467163086
r_  generation:  0.00985407829284668
----------------------check_connections_block total spend ----------------------------- 0.5360548496246338
generate_one_block  0.015869140625
generate_one_block  0.015156984329223633
generate_one_block  0.015057563781738281
generate_one_block  0.014927148818969727
generate_one_block  0.01437997817993164
generate_one_block  0.01536417007446289
generate_one_block  0.014692068099975586
generate_one_block  0.015054941177368164
generate_one_block  0.014475584030151367
generate_one_block  0.015011072158813477
generate_one_block  0.0147247314453125
generate_one_block  0.014299869537353516
generate_one_block  0.014693737030029297
generate_one_block  0.01436924934387207
generate_one_block  0.015315532684326172
generate_one_block  0.014815330505371094
generate_one_block  0.015189886093139648
generate_one_block  0.01491093635559082
generate_one_block  0.014589071273803711
generate_one_block  0.014752626419067383
generate_one_block  0.015442132949829102
generate_one_block  0.015627145767211914
generate_one_block  0.014721155166625977
generate_one_block  0.015007734298706055
generate_one_block  0.015538215637207031
generate_one_block  0.014552831649780273
generate_one_block  0.01423954963684082
generate_one_block  0.01470637321472168
generate_one_block  0.01481485366821289
generate_one_block  0.014404773712158203
generate_one_block  0.015026092529296875
generate_one_block  0.014852762222290039
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04477381706237793
gen group dst list time:  0.023455381393432617
time for parepare:  0.020061016082763672
local_output_nid generation:  0.005376577377319336
local_in_edges_tensor generation:  0.014406681060791016
mini_batch_src_global generation:  0.016933441162109375
r_  generation:  0.1607823371887207
local_output_nid generation:  0.010481595993041992
local_in_edges_tensor generation:  0.016409635543823242
mini_batch_src_global generation:  0.022884130477905273
r_  generation:  0.1670377254486084
local_output_nid generation:  0.010518789291381836
local_in_edges_tensor generation:  0.011609554290771484
mini_batch_src_global generation:  0.019864320755004883
r_  generation:  0.16840839385986328
local_output_nid generation:  0.010382652282714844
local_in_edges_tensor generation:  0.015385866165161133
mini_batch_src_global generation:  0.021003246307373047
r_  generation:  0.17057085037231445
local_output_nid generation:  0.010170459747314453
local_in_edges_tensor generation:  0.009887933731079102
mini_batch_src_global generation:  0.02040243148803711
r_  generation:  0.1700880527496338
local_output_nid generation:  0.010550737380981445
local_in_edges_tensor generation:  0.013229846954345703
mini_batch_src_global generation:  0.02230238914489746
r_  generation:  0.17890238761901855
local_output_nid generation:  0.010181665420532227
local_in_edges_tensor generation:  0.011974096298217773
mini_batch_src_global generation:  0.022475719451904297
r_  generation:  0.1743016242980957
local_output_nid generation:  0.01042032241821289
local_in_edges_tensor generation:  0.011839628219604492
mini_batch_src_global generation:  0.024625062942504883
r_  generation:  0.1831521987915039
local_output_nid generation:  0.010037899017333984
local_in_edges_tensor generation:  0.010262727737426758
mini_batch_src_global generation:  0.02197265625
r_  generation:  0.16941332817077637
local_output_nid generation:  0.010170459747314453
local_in_edges_tensor generation:  0.011795282363891602
mini_batch_src_global generation:  0.022167682647705078
r_  generation:  0.1747574806213379
local_output_nid generation:  0.010132074356079102
local_in_edges_tensor generation:  0.011449337005615234
mini_batch_src_global generation:  0.023901939392089844
r_  generation:  0.17888498306274414
local_output_nid generation:  0.010123968124389648
local_in_edges_tensor generation:  0.009995460510253906
mini_batch_src_global generation:  0.02221202850341797
r_  generation:  0.17343378067016602
local_output_nid generation:  0.010333776473999023
local_in_edges_tensor generation:  0.011811017990112305
mini_batch_src_global generation:  0.02271747589111328
r_  generation:  0.177642822265625
local_output_nid generation:  0.010050296783447266
local_in_edges_tensor generation:  0.010173797607421875
mini_batch_src_global generation:  0.022414684295654297
r_  generation:  0.17839670181274414
local_output_nid generation:  0.010494709014892578
local_in_edges_tensor generation:  0.012962102890014648
mini_batch_src_global generation:  0.023617029190063477
r_  generation:  0.18278050422668457
local_output_nid generation:  0.010167121887207031
local_in_edges_tensor generation:  0.011375904083251953
mini_batch_src_global generation:  0.023773908615112305
r_  generation:  0.17865729331970215
local_output_nid generation:  0.01044154167175293
local_in_edges_tensor generation:  0.013416051864624023
mini_batch_src_global generation:  0.025194168090820312
r_  generation:  0.18513107299804688
local_output_nid generation:  0.010260581970214844
local_in_edges_tensor generation:  0.010188579559326172
mini_batch_src_global generation:  0.023904085159301758
r_  generation:  0.17855358123779297
local_output_nid generation:  0.010011911392211914
local_in_edges_tensor generation:  0.009941816329956055
mini_batch_src_global generation:  0.023160934448242188
r_  generation:  0.17882251739501953
local_output_nid generation:  0.010339021682739258
local_in_edges_tensor generation:  0.010307788848876953
mini_batch_src_global generation:  0.02286672592163086
r_  generation:  0.18283915519714355
local_output_nid generation:  0.010554075241088867
local_in_edges_tensor generation:  0.011333465576171875
mini_batch_src_global generation:  0.02502155303955078
r_  generation:  0.18417072296142578
local_output_nid generation:  0.010471820831298828
local_in_edges_tensor generation:  0.014740228652954102
mini_batch_src_global generation:  0.024239301681518555
r_  generation:  0.1844630241394043
local_output_nid generation:  0.010197877883911133
local_in_edges_tensor generation:  0.010236263275146484
mini_batch_src_global generation:  0.023555517196655273
r_  generation:  0.1814267635345459
local_output_nid generation:  0.010375022888183594
local_in_edges_tensor generation:  0.01003575325012207
mini_batch_src_global generation:  0.023610591888427734
r_  generation:  0.1820230484008789
local_output_nid generation:  0.010425329208374023
local_in_edges_tensor generation:  0.01330709457397461
mini_batch_src_global generation:  0.023871183395385742
r_  generation:  0.18491148948669434
local_output_nid generation:  0.010030984878540039
local_in_edges_tensor generation:  0.010008811950683594
mini_batch_src_global generation:  0.023355484008789062
r_  generation:  0.17960691452026367
local_output_nid generation:  0.009947538375854492
local_in_edges_tensor generation:  0.009707212448120117
mini_batch_src_global generation:  0.02238154411315918
r_  generation:  0.17485523223876953
local_output_nid generation:  0.010068178176879883
local_in_edges_tensor generation:  0.010083436965942383
mini_batch_src_global generation:  0.02319478988647461
r_  generation:  0.17994451522827148
local_output_nid generation:  0.01032710075378418
local_in_edges_tensor generation:  0.012460947036743164
mini_batch_src_global generation:  0.022930622100830078
r_  generation:  0.18394732475280762
local_output_nid generation:  0.010151147842407227
local_in_edges_tensor generation:  0.009932518005371094
mini_batch_src_global generation:  0.0234987735748291
r_  generation:  0.17737960815429688
local_output_nid generation:  0.010375261306762695
local_in_edges_tensor generation:  0.009949684143066406
mini_batch_src_global generation:  0.022849321365356445
r_  generation:  0.1790485382080078
local_output_nid generation:  0.010259866714477539
local_in_edges_tensor generation:  0.014412403106689453
mini_batch_src_global generation:  0.023737668991088867
r_  generation:  0.18275976181030273
----------------------check_connections_block total spend ----------------------------- 8.420518398284912
generate_one_block  0.23332858085632324
generate_one_block  0.23258280754089355
generate_one_block  0.24808621406555176
generate_one_block  0.23332834243774414
generate_one_block  0.2191636562347412
generate_one_block  0.23978185653686523
generate_one_block  0.2352609634399414
generate_one_block  0.23749876022338867
generate_one_block  0.21939659118652344
generate_one_block  0.2239089012145996
generate_one_block  0.23307180404663086
generate_one_block  0.226332426071167
generate_one_block  0.22970056533813477
generate_one_block  0.22047972679138184
generate_one_block  0.23933839797973633
generate_one_block  0.2610135078430176
generate_one_block  0.23538804054260254
generate_one_block  0.22850608825683594
generate_one_block  0.22214603424072266
generate_one_block  0.23604679107666016
generate_one_block  0.23889517784118652
generate_one_block  0.24674129486083984
generate_one_block  0.2296910285949707
generate_one_block  0.2377331256866455
generate_one_block  0.24504590034484863
generate_one_block  0.22609186172485352
generate_one_block  0.227858304977417
generate_one_block  0.26094961166381836
generate_one_block  0.23141717910766602
generate_one_block  0.25783467292785645
generate_one_block  0.23945951461791992
generate_one_block  0.2405686378479004
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.10073280334472656
gen group dst list time:  0.1237783432006836
time for parepare:  0.021667003631591797
local_output_nid generation:  0.024333715438842773
local_in_edges_tensor generation:  0.061902761459350586
mini_batch_src_global generation:  0.05124497413635254
r_  generation:  0.4807448387145996
local_output_nid generation:  0.04256010055541992
local_in_edges_tensor generation:  0.049643516540527344
mini_batch_src_global generation:  0.059500694274902344
r_  generation:  0.49170875549316406
local_output_nid generation:  0.03130364418029785
local_in_edges_tensor generation:  0.05299258232116699
mini_batch_src_global generation:  0.06106877326965332
r_  generation:  0.5209658145904541
local_output_nid generation:  0.03132987022399902
local_in_edges_tensor generation:  0.04461026191711426
mini_batch_src_global generation:  0.06471848487854004
r_  generation:  0.4926133155822754
local_output_nid generation:  0.028647899627685547
local_in_edges_tensor generation:  0.047408342361450195
mini_batch_src_global generation:  0.05936551094055176
r_  generation:  0.4972069263458252
local_output_nid generation:  0.02867722511291504
local_in_edges_tensor generation:  0.03327608108520508
mini_batch_src_global generation:  0.06584572792053223
r_  generation:  0.4943385124206543
local_output_nid generation:  0.02954864501953125
local_in_edges_tensor generation:  0.055768728256225586
mini_batch_src_global generation:  0.06011509895324707
r_  generation:  0.5083558559417725
local_output_nid generation:  0.029278039932250977
local_in_edges_tensor generation:  0.04796266555786133
mini_batch_src_global generation:  0.0634608268737793
r_  generation:  0.509070634841919
local_output_nid generation:  0.030995607376098633
local_in_edges_tensor generation:  0.035282135009765625
mini_batch_src_global generation:  0.06194496154785156
r_  generation:  0.49770283699035645
local_output_nid generation:  0.028479814529418945
local_in_edges_tensor generation:  0.030182361602783203
mini_batch_src_global generation:  0.06047344207763672
r_  generation:  0.49237489700317383
local_output_nid generation:  0.02853870391845703
local_in_edges_tensor generation:  0.02725815773010254
mini_batch_src_global generation:  0.0695183277130127
r_  generation:  0.4984452724456787
local_output_nid generation:  0.02858757972717285
local_in_edges_tensor generation:  0.0280911922454834
mini_batch_src_global generation:  0.05988121032714844
r_  generation:  0.49528002738952637
local_output_nid generation:  0.029343128204345703
local_in_edges_tensor generation:  0.041602373123168945
mini_batch_src_global generation:  0.06007122993469238
r_  generation:  0.49933648109436035
local_output_nid generation:  0.029918193817138672
local_in_edges_tensor generation:  0.03084421157836914
mini_batch_src_global generation:  0.06019115447998047
r_  generation:  0.49512600898742676
local_output_nid generation:  0.029300451278686523
local_in_edges_tensor generation:  0.03286314010620117
mini_batch_src_global generation:  0.05996584892272949
r_  generation:  0.5067920684814453
local_output_nid generation:  0.02912449836730957
local_in_edges_tensor generation:  0.04436945915222168
mini_batch_src_global generation:  0.06009244918823242
r_  generation:  0.5012383460998535
local_output_nid generation:  0.029438495635986328
local_in_edges_tensor generation:  0.040008544921875
mini_batch_src_global generation:  0.0630955696105957
r_  generation:  0.5214688777923584
local_output_nid generation:  0.028860807418823242
local_in_edges_tensor generation:  0.04247117042541504
mini_batch_src_global generation:  0.06399035453796387
r_  generation:  0.4971442222595215
local_output_nid generation:  0.031119108200073242
local_in_edges_tensor generation:  0.03256821632385254
mini_batch_src_global generation:  0.06141829490661621
r_  generation:  0.4928107261657715
local_output_nid generation:  0.02867913246154785
local_in_edges_tensor generation:  0.028652191162109375
mini_batch_src_global generation:  0.06028032302856445
r_  generation:  0.49375033378601074
local_output_nid generation:  0.029253005981445312
local_in_edges_tensor generation:  0.03753066062927246
mini_batch_src_global generation:  0.05936002731323242
r_  generation:  0.5049707889556885
local_output_nid generation:  0.02997136116027832
local_in_edges_tensor generation:  0.03400087356567383
mini_batch_src_global generation:  0.06419062614440918
r_  generation:  0.4973323345184326
local_output_nid generation:  0.02979254722595215
local_in_edges_tensor generation:  0.028513193130493164
mini_batch_src_global generation:  0.06013774871826172
r_  generation:  0.497607946395874
local_output_nid generation:  0.029799699783325195
local_in_edges_tensor generation:  0.04197573661804199
mini_batch_src_global generation:  0.06008172035217285
r_  generation:  0.49498724937438965
local_output_nid generation:  0.029952526092529297
local_in_edges_tensor generation:  0.04172086715698242
mini_batch_src_global generation:  0.05945563316345215
r_  generation:  0.502230167388916
local_output_nid generation:  0.028793811798095703
local_in_edges_tensor generation:  0.02852344512939453
mini_batch_src_global generation:  0.05980801582336426
r_  generation:  0.49772071838378906
local_output_nid generation:  0.02881908416748047
local_in_edges_tensor generation:  0.028278589248657227
mini_batch_src_global generation:  0.05919027328491211
r_  generation:  0.49621009826660156
local_output_nid generation:  0.028867006301879883
local_in_edges_tensor generation:  0.03319573402404785
mini_batch_src_global generation:  0.0635976791381836
r_  generation:  0.5015592575073242
local_output_nid generation:  0.029941797256469727
local_in_edges_tensor generation:  0.0356597900390625
mini_batch_src_global generation:  0.06389427185058594
r_  generation:  0.4998137950897217
local_output_nid generation:  0.028800487518310547
local_in_edges_tensor generation:  0.028671741485595703
mini_batch_src_global generation:  0.060643911361694336
r_  generation:  0.4975893497467041
local_output_nid generation:  0.028644561767578125
local_in_edges_tensor generation:  0.03212308883666992
mini_batch_src_global generation:  0.05979776382446289
r_  generation:  0.4980132579803467
local_output_nid generation:  0.028998851776123047
local_in_edges_tensor generation:  0.027897357940673828
mini_batch_src_global generation:  0.061094045639038086
r_  generation:  0.49493408203125
----------------------check_connections_block total spend ----------------------------- 23.59067177772522
generate_one_block  0.737586498260498
generate_one_block  0.656031608581543
generate_one_block  0.6441197395324707
generate_one_block  0.6500873565673828
generate_one_block  0.6437160968780518
generate_one_block  0.6280264854431152
generate_one_block  0.6445086002349854
generate_one_block  0.6683361530303955
generate_one_block  0.6367495059967041
generate_one_block  0.6305010318756104
generate_one_block  0.6296606063842773
generate_one_block  0.6275882720947266
generate_one_block  0.656280517578125
generate_one_block  0.6234314441680908
generate_one_block  0.6418161392211914
generate_one_block  0.6403169631958008
generate_one_block  0.6447441577911377
generate_one_block  0.6464569568634033
generate_one_block  0.6295452117919922
generate_one_block  0.6319594383239746
generate_one_block  0.6786291599273682
generate_one_block  0.6552536487579346
generate_one_block  0.627687931060791
generate_one_block  0.6257050037384033
generate_one_block  0.6543724536895752
generate_one_block  0.6223180294036865
generate_one_block  0.6245079040527344
generate_one_block  0.625312328338623
generate_one_block  0.6437041759490967
generate_one_block  0.6343884468078613
generate_one_block  0.6378629207611084
generate_one_block  0.632805585861206
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

connection checking time:  32.01119017601013
block generation total time  28.11065673828125
average batch blocks generation time:  0.8784580230712891
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1737060546875 GB
    Memory Allocated: 0.0887150764465332  GigaBytes
Max Memory Allocated: 0.0887150764465332  GigaBytes

torch.Size([150008, 128])
torch.Size([109421, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5487060546875 GB
    Memory Allocated: 0.2196650505065918  GigaBytes
Max Memory Allocated: 0.22588348388671875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08930683135986328  GigaBytes
Max Memory Allocated: 0.24880170822143555  GigaBytes

torch.Size([150160, 128])
torch.Size([110027, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.22002553939819336  GigaBytes
Max Memory Allocated: 0.24880170822143555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08914566040039062  GigaBytes
Max Memory Allocated: 0.24987363815307617  GigaBytes

torch.Size([150716, 128])
torch.Size([110313, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.21984243392944336  GigaBytes
Max Memory Allocated: 0.24987363815307617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.0892496109008789  GigaBytes
Max Memory Allocated: 0.2500319480895996  GigaBytes

torch.Size([150576, 128])
torch.Size([111005, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.22330999374389648  GigaBytes
Max Memory Allocated: 0.2500319480895996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08896636962890625  GigaBytes
Max Memory Allocated: 0.2544841766357422  GigaBytes

torch.Size([149735, 128])
torch.Size([108734, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.2169198989868164  GigaBytes
Max Memory Allocated: 0.2544841766357422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08937263488769531  GigaBytes
Max Memory Allocated: 0.2544841766357422  GigaBytes

torch.Size([149965, 128])
torch.Size([110111, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.22075748443603516  GigaBytes
Max Memory Allocated: 0.2544841766357422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08924198150634766  GigaBytes
Max Memory Allocated: 0.2544841766357422  GigaBytes

torch.Size([149882, 128])
torch.Size([110030, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.2194690704345703  GigaBytes
Max Memory Allocated: 0.2544841766357422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.0893402099609375  GigaBytes
Max Memory Allocated: 0.2544841766357422  GigaBytes

torch.Size([150487, 128])
torch.Size([110763, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.22346067428588867  GigaBytes
Max Memory Allocated: 0.2544841766357422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08901691436767578  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

torch.Size([150466, 128])
torch.Size([109698, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.2187056541442871  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08905315399169922  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

torch.Size([149905, 128])
torch.Size([108950, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.21843290328979492  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08910942077636719  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

torch.Size([149803, 128])
torch.Size([108918, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.21840620040893555  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08900928497314453  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

torch.Size([150066, 128])
torch.Size([108963, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.21823692321777344  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08922100067138672  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

torch.Size([150595, 128])
torch.Size([110255, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.21977663040161133  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08895301818847656  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

torch.Size([149936, 128])
torch.Size([108830, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.21811294555664062  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08934688568115234  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

torch.Size([150545, 128])
torch.Size([110560, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.22075176239013672  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08916282653808594  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

torch.Size([150081, 128])
torch.Size([110031, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.2195272445678711  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08934688568115234  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

torch.Size([150087, 128])
torch.Size([110432, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.2205338478088379  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08923625946044922  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

torch.Size([150510, 128])
torch.Size([110567, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.2200469970703125  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08905696868896484  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

torch.Size([149874, 128])
torch.Size([109150, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.21830415725708008  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08918571472167969  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

torch.Size([150589, 128])
torch.Size([110396, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.21998929977416992  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.0893259048461914  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

torch.Size([150785, 128])
torch.Size([111045, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.2236790657043457  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08935165405273438  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

torch.Size([150488, 128])
torch.Size([110807, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.22374582290649414  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.089111328125  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

torch.Size([150168, 128])
torch.Size([110162, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.2195110321044922  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08922958374023438  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

torch.Size([150484, 128])
torch.Size([110203, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.2199726104736328  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08935546875  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

torch.Size([150451, 128])
torch.Size([110571, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.22078466415405273  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08896255493164062  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

torch.Size([149956, 128])
torch.Size([108962, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.2170853614807129  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08900165557861328  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

torch.Size([149908, 128])
torch.Size([109286, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.21719789505004883  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08912181854248047  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

torch.Size([150505, 128])
torch.Size([109953, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.2193317413330078  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.0891427993774414  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

torch.Size([150409, 128])
torch.Size([109957, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.2196345329284668  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08910942077636719  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

torch.Size([150270, 128])
torch.Size([109179, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.21840286254882812  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08911609649658203  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

torch.Size([150342, 128])
torch.Size([109861, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.21930551528930664  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08913707733154297  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

torch.Size([150246, 128])
torch.Size([109315, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.2188262939453125  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03148485720157623 |0.02155279368162155 |0.026336051523685455 |9.046494960784912e-05 |0.0054623037576675415 |0.0036017894744873047 |
----------------------------------------------------------pseudo_mini_loss sum 5.367461681365967
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9165429
Number of first layer input nodes during this epoch:  4807998
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.12382364273071289  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021035432815551758
random selection method range initialization spend 0.004977226257324219
time for parepare:  0.017725229263305664
local_output_nid generation:  0.0013566017150878906
local_in_edges_tensor generation:  0.008394718170166016
mini_batch_src_global generation:  0.0015947818756103516
r_  generation:  0.010489225387573242
local_output_nid generation:  0.0017139911651611328
local_in_edges_tensor generation:  0.000990152359008789
mini_batch_src_global generation:  0.0014755725860595703
r_  generation:  0.00983881950378418
local_output_nid generation:  0.0016083717346191406
local_in_edges_tensor generation:  0.0008492469787597656
mini_batch_src_global generation:  0.0010371208190917969
r_  generation:  0.009016275405883789
local_output_nid generation:  0.0015552043914794922
local_in_edges_tensor generation:  0.0008435249328613281
mini_batch_src_global generation:  0.001051187515258789
r_  generation:  0.008999824523925781
local_output_nid generation:  0.0015273094177246094
local_in_edges_tensor generation:  0.0007917881011962891
mini_batch_src_global generation:  0.0009744167327880859
r_  generation:  0.009335517883300781
local_output_nid generation:  0.0015096664428710938
local_in_edges_tensor generation:  0.0007834434509277344
mini_batch_src_global generation:  0.0010259151458740234
r_  generation:  0.009835481643676758
local_output_nid generation:  0.0014934539794921875
local_in_edges_tensor generation:  0.0007889270782470703
mini_batch_src_global generation:  0.00102996826171875
r_  generation:  0.009729146957397461
local_output_nid generation:  0.001493215560913086
local_in_edges_tensor generation:  0.0007872581481933594
mini_batch_src_global generation:  0.001003265380859375
r_  generation:  0.009544610977172852
local_output_nid generation:  0.0014872550964355469
local_in_edges_tensor generation:  0.0007834434509277344
mini_batch_src_global generation:  0.0010111331939697266
r_  generation:  0.00953817367553711
local_output_nid generation:  0.0014848709106445312
local_in_edges_tensor generation:  0.0007600784301757812
mini_batch_src_global generation:  0.0010216236114501953
r_  generation:  0.009739160537719727
local_output_nid generation:  0.0015010833740234375
local_in_edges_tensor generation:  0.0007779598236083984
mini_batch_src_global generation:  0.0010535717010498047
r_  generation:  0.01016378402709961
local_output_nid generation:  0.004384040832519531
local_in_edges_tensor generation:  0.0008673667907714844
mini_batch_src_global generation:  0.001134634017944336
r_  generation:  0.010535717010498047
local_output_nid generation:  0.0015103816986083984
local_in_edges_tensor generation:  0.0007870197296142578
mini_batch_src_global generation:  0.001062154769897461
r_  generation:  0.009947061538696289
local_output_nid generation:  0.001508474349975586
local_in_edges_tensor generation:  0.0007607936859130859
mini_batch_src_global generation:  0.001112222671508789
r_  generation:  0.01021265983581543
local_output_nid generation:  0.0014886856079101562
local_in_edges_tensor generation:  0.0007674694061279297
mini_batch_src_global generation:  0.001020193099975586
r_  generation:  0.009863138198852539
local_output_nid generation:  0.00148773193359375
local_in_edges_tensor generation:  0.0007615089416503906
mini_batch_src_global generation:  0.00103759765625
r_  generation:  0.009752273559570312
local_output_nid generation:  0.0014793872833251953
local_in_edges_tensor generation:  0.0008046627044677734
mini_batch_src_global generation:  0.0010933876037597656
r_  generation:  0.010343074798583984
local_output_nid generation:  0.0014667510986328125
local_in_edges_tensor generation:  0.0007677078247070312
mini_batch_src_global generation:  0.0010361671447753906
r_  generation:  0.01285552978515625
local_output_nid generation:  0.0015015602111816406
local_in_edges_tensor generation:  0.0007867813110351562
mini_batch_src_global generation:  0.0011391639709472656
r_  generation:  0.010467767715454102
local_output_nid generation:  0.0014989376068115234
local_in_edges_tensor generation:  0.0007681846618652344
mini_batch_src_global generation:  0.0010704994201660156
r_  generation:  0.009918451309204102
local_output_nid generation:  0.0014786720275878906
local_in_edges_tensor generation:  0.0007638931274414062
mini_batch_src_global generation:  0.0010275840759277344
r_  generation:  0.009717702865600586
local_output_nid generation:  0.0014727115631103516
local_in_edges_tensor generation:  0.0007672309875488281
mini_batch_src_global generation:  0.0010883808135986328
r_  generation:  0.010514974594116211
local_output_nid generation:  0.0014734268188476562
local_in_edges_tensor generation:  0.0007603168487548828
mini_batch_src_global generation:  0.0010929107666015625
r_  generation:  0.010228633880615234
local_output_nid generation:  0.0015044212341308594
local_in_edges_tensor generation:  0.0007822513580322266
mini_batch_src_global generation:  0.0010733604431152344
r_  generation:  0.00990915298461914
local_output_nid generation:  0.0044062137603759766
local_in_edges_tensor generation:  0.0008203983306884766
mini_batch_src_global generation:  0.0010862350463867188
r_  generation:  0.010142087936401367
local_output_nid generation:  0.0014939308166503906
local_in_edges_tensor generation:  0.0007815361022949219
mini_batch_src_global generation:  0.0010571479797363281
r_  generation:  0.009659528732299805
local_output_nid generation:  0.0014874935150146484
local_in_edges_tensor generation:  0.0007648468017578125
mini_batch_src_global generation:  0.0010416507720947266
r_  generation:  0.009775638580322266
local_output_nid generation:  0.0014812946319580078
local_in_edges_tensor generation:  0.0007433891296386719
mini_batch_src_global generation:  0.0010342597961425781
r_  generation:  0.010328531265258789
local_output_nid generation:  0.0014748573303222656
local_in_edges_tensor generation:  0.0007624626159667969
mini_batch_src_global generation:  0.0010783672332763672
r_  generation:  0.010197877883911133
local_output_nid generation:  0.0014684200286865234
local_in_edges_tensor generation:  0.0007581710815429688
mini_batch_src_global generation:  0.0010683536529541016
r_  generation:  0.010111570358276367
local_output_nid generation:  0.0014679431915283203
local_in_edges_tensor generation:  0.0007493495941162109
mini_batch_src_global generation:  0.0011148452758789062
r_  generation:  0.013791799545288086
local_output_nid generation:  0.001474142074584961
local_in_edges_tensor generation:  0.0007522106170654297
mini_batch_src_global generation:  0.0010938644409179688
r_  generation:  0.010426521301269531
----------------------check_connections_block total spend ----------------------------- 0.5535049438476562
generate_one_block  0.015648841857910156
generate_one_block  0.017696142196655273
generate_one_block  0.014040708541870117
generate_one_block  0.01416921615600586
generate_one_block  0.014292240142822266
generate_one_block  0.01737213134765625
generate_one_block  0.014366388320922852
generate_one_block  0.014230966567993164
generate_one_block  0.014187097549438477
generate_one_block  0.014370441436767578
generate_one_block  0.015277624130249023
generate_one_block  0.018292903900146484
generate_one_block  0.014819622039794922
generate_one_block  0.015303850173950195
generate_one_block  0.014464855194091797
generate_one_block  0.014517784118652344
generate_one_block  0.01565837860107422
generate_one_block  0.014849424362182617
generate_one_block  0.018115520477294922
generate_one_block  0.01477503776550293
generate_one_block  0.014503240585327148
generate_one_block  0.015650033950805664
generate_one_block  0.01513528823852539
generate_one_block  0.014690399169921875
generate_one_block  0.015032529830932617
generate_one_block  0.017962932586669922
generate_one_block  0.014962911605834961
generate_one_block  0.01492166519165039
generate_one_block  0.015141010284423828
generate_one_block  0.015175819396972656
generate_one_block  0.015952348709106445
generate_one_block  0.014708757400512695
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05751538276672363
gen group dst list time:  0.026093721389770508
time for parepare:  0.020276546478271484
local_output_nid generation:  0.006856203079223633
local_in_edges_tensor generation:  0.0294339656829834
mini_batch_src_global generation:  0.018245697021484375
r_  generation:  0.16442537307739258
local_output_nid generation:  0.00818324089050293
local_in_edges_tensor generation:  0.015386581420898438
mini_batch_src_global generation:  0.021453857421875
r_  generation:  0.16668343544006348
local_output_nid generation:  0.008105993270874023
local_in_edges_tensor generation:  0.03517770767211914
mini_batch_src_global generation:  0.018701791763305664
r_  generation:  0.1628110408782959
local_output_nid generation:  0.008287429809570312
local_in_edges_tensor generation:  0.011626958847045898
mini_batch_src_global generation:  0.01957988739013672
r_  generation:  0.1646440029144287
local_output_nid generation:  0.008245468139648438
local_in_edges_tensor generation:  0.011902570724487305
mini_batch_src_global generation:  0.021380186080932617
r_  generation:  0.17198610305786133
local_output_nid generation:  0.008139610290527344
local_in_edges_tensor generation:  0.010828256607055664
mini_batch_src_global generation:  0.0224459171295166
r_  generation:  0.17647480964660645
local_output_nid generation:  0.007961750030517578
local_in_edges_tensor generation:  0.01039266586303711
mini_batch_src_global generation:  0.021860837936401367
r_  generation:  0.17169857025146484
local_output_nid generation:  0.007762908935546875
local_in_edges_tensor generation:  0.010309219360351562
mini_batch_src_global generation:  0.02223825454711914
r_  generation:  0.173079252243042
local_output_nid generation:  0.008300542831420898
local_in_edges_tensor generation:  0.011806964874267578
mini_batch_src_global generation:  0.02211761474609375
r_  generation:  0.1730341911315918
local_output_nid generation:  0.008455753326416016
local_in_edges_tensor generation:  0.010595560073852539
mini_batch_src_global generation:  0.02251887321472168
r_  generation:  0.17432165145874023
local_output_nid generation:  0.00876617431640625
local_in_edges_tensor generation:  0.012597084045410156
mini_batch_src_global generation:  0.02480602264404297
r_  generation:  0.18399500846862793
local_output_nid generation:  0.010787487030029297
local_in_edges_tensor generation:  0.011094093322753906
mini_batch_src_global generation:  0.023985624313354492
r_  generation:  0.18641901016235352
local_output_nid generation:  0.008512020111083984
local_in_edges_tensor generation:  0.009228944778442383
mini_batch_src_global generation:  0.023267269134521484
r_  generation:  0.18381285667419434
local_output_nid generation:  0.008710622787475586
local_in_edges_tensor generation:  0.012053251266479492
mini_batch_src_global generation:  0.02475428581237793
r_  generation:  0.18129873275756836
local_output_nid generation:  0.00824284553527832
local_in_edges_tensor generation:  0.008859872817993164
mini_batch_src_global generation:  0.024193763732910156
r_  generation:  0.17539119720458984
local_output_nid generation:  0.008626937866210938
local_in_edges_tensor generation:  0.014276266098022461
mini_batch_src_global generation:  0.0249936580657959
r_  generation:  0.18246769905090332
local_output_nid generation:  0.009727001190185547
local_in_edges_tensor generation:  0.016312122344970703
mini_batch_src_global generation:  0.024692535400390625
r_  generation:  0.20024418830871582
local_output_nid generation:  0.010759592056274414
local_in_edges_tensor generation:  0.013386011123657227
mini_batch_src_global generation:  0.028591632843017578
r_  generation:  0.17937374114990234
local_output_nid generation:  0.008846759796142578
local_in_edges_tensor generation:  0.013580083847045898
mini_batch_src_global generation:  0.023801803588867188
r_  generation:  0.18802237510681152
local_output_nid generation:  0.00861811637878418
local_in_edges_tensor generation:  0.010755777359008789
mini_batch_src_global generation:  0.02339935302734375
r_  generation:  0.17731618881225586
local_output_nid generation:  0.008163213729858398
local_in_edges_tensor generation:  0.010768651962280273
mini_batch_src_global generation:  0.041365623474121094
r_  generation:  0.17829585075378418
local_output_nid generation:  0.008528709411621094
local_in_edges_tensor generation:  0.01272439956665039
mini_batch_src_global generation:  0.024050235748291016
r_  generation:  0.18896842002868652
local_output_nid generation:  0.008501768112182617
local_in_edges_tensor generation:  0.010985851287841797
mini_batch_src_global generation:  0.023865222930908203
r_  generation:  0.18378567695617676
local_output_nid generation:  0.00828862190246582
local_in_edges_tensor generation:  0.012204885482788086
mini_batch_src_global generation:  0.023884296417236328
r_  generation:  0.17931103706359863
local_output_nid generation:  0.00835275650024414
local_in_edges_tensor generation:  0.009236812591552734
mini_batch_src_global generation:  0.034754276275634766
r_  generation:  0.1826634407043457
local_output_nid generation:  0.008083105087280273
local_in_edges_tensor generation:  0.016030311584472656
mini_batch_src_global generation:  0.023650646209716797
r_  generation:  0.17723393440246582
local_output_nid generation:  0.008170604705810547
local_in_edges_tensor generation:  0.010293006896972656
mini_batch_src_global generation:  0.026039838790893555
r_  generation:  0.18028974533081055
local_output_nid generation:  0.008951663970947266
local_in_edges_tensor generation:  0.01743030548095703
mini_batch_src_global generation:  0.030771255493164062
r_  generation:  0.17729926109313965
local_output_nid generation:  0.009568452835083008
local_in_edges_tensor generation:  0.01364898681640625
mini_batch_src_global generation:  0.02336573600769043
r_  generation:  0.1804027557373047
local_output_nid generation:  0.008312463760375977
local_in_edges_tensor generation:  0.010529756546020508
mini_batch_src_global generation:  0.02372264862060547
r_  generation:  0.18472886085510254
local_output_nid generation:  0.008595705032348633
local_in_edges_tensor generation:  0.011852502822875977
mini_batch_src_global generation:  0.0258481502532959
r_  generation:  0.1875617504119873
local_output_nid generation:  0.008239984512329102
local_in_edges_tensor generation:  0.00879526138305664
mini_batch_src_global generation:  0.023529767990112305
r_  generation:  0.17911982536315918
----------------------check_connections_block total spend ----------------------------- 8.513436555862427
generate_one_block  0.23569011688232422
generate_one_block  0.2230536937713623
generate_one_block  0.2108628749847412
generate_one_block  0.21262335777282715
generate_one_block  0.23801517486572266
generate_one_block  0.23418927192687988
generate_one_block  0.23867440223693848
generate_one_block  0.22173714637756348
generate_one_block  0.22950315475463867
generate_one_block  0.23760032653808594
generate_one_block  0.24074339866638184
generate_one_block  0.24114108085632324
generate_one_block  0.23960518836975098
generate_one_block  0.23234844207763672
generate_one_block  0.22043490409851074
generate_one_block  0.23506474494934082
generate_one_block  0.24329900741577148
generate_one_block  0.2290492057800293
generate_one_block  0.24333620071411133
generate_one_block  0.25983524322509766
generate_one_block  0.22040414810180664
generate_one_block  0.24149584770202637
generate_one_block  0.23715806007385254
generate_one_block  0.2245955467224121
generate_one_block  0.23701262474060059
generate_one_block  0.2189476490020752
generate_one_block  0.22576355934143066
generate_one_block  0.2162463665008545
generate_one_block  0.235215425491333
generate_one_block  0.2476952075958252
generate_one_block  0.24118828773498535
generate_one_block  0.22345185279846191
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.08035397529602051
gen group dst list time:  0.10691523551940918
time for parepare:  0.018169164657592773
local_output_nid generation:  0.024347305297851562
local_in_edges_tensor generation:  0.05838608741760254
mini_batch_src_global generation:  0.05454730987548828
r_  generation:  0.49651050567626953
local_output_nid generation:  0.03158974647521973
local_in_edges_tensor generation:  0.054533958435058594
mini_batch_src_global generation:  0.061753273010253906
r_  generation:  0.48033690452575684
local_output_nid generation:  0.03119206428527832
local_in_edges_tensor generation:  0.04185175895690918
mini_batch_src_global generation:  0.05732274055480957
r_  generation:  0.4902768135070801
local_output_nid generation:  0.029323816299438477
local_in_edges_tensor generation:  0.03448057174682617
mini_batch_src_global generation:  0.05839705467224121
r_  generation:  0.483978271484375
local_output_nid generation:  0.031118154525756836
local_in_edges_tensor generation:  0.039301395416259766
mini_batch_src_global generation:  0.06174445152282715
r_  generation:  0.4915440082550049
local_output_nid generation:  0.02940821647644043
local_in_edges_tensor generation:  0.03480839729309082
mini_batch_src_global generation:  0.0741887092590332
r_  generation:  0.4869866371154785
local_output_nid generation:  0.02933788299560547
local_in_edges_tensor generation:  0.0306246280670166
mini_batch_src_global generation:  0.059784650802612305
r_  generation:  0.49497532844543457
local_output_nid generation:  0.02940535545349121
local_in_edges_tensor generation:  0.03287792205810547
mini_batch_src_global generation:  0.06035733222961426
r_  generation:  0.4889514446258545
local_output_nid generation:  0.029615402221679688
local_in_edges_tensor generation:  0.03946638107299805
mini_batch_src_global generation:  0.059114694595336914
r_  generation:  0.5015432834625244
local_output_nid generation:  0.02950286865234375
local_in_edges_tensor generation:  0.03962969779968262
mini_batch_src_global generation:  0.06003212928771973
r_  generation:  0.498929500579834
local_output_nid generation:  0.029784202575683594
local_in_edges_tensor generation:  0.03591609001159668
mini_batch_src_global generation:  0.06035327911376953
r_  generation:  0.5042300224304199
local_output_nid generation:  0.029531478881835938
local_in_edges_tensor generation:  0.0474088191986084
mini_batch_src_global generation:  0.060973167419433594
r_  generation:  0.49308156967163086
local_output_nid generation:  0.029621601104736328
local_in_edges_tensor generation:  0.028692007064819336
mini_batch_src_global generation:  0.06119132041931152
r_  generation:  0.506131649017334
local_output_nid generation:  0.030626296997070312
local_in_edges_tensor generation:  0.03292441368103027
mini_batch_src_global generation:  0.06685400009155273
r_  generation:  0.49883198738098145
local_output_nid generation:  0.029546737670898438
local_in_edges_tensor generation:  0.035918235778808594
mini_batch_src_global generation:  0.06752872467041016
r_  generation:  0.5006086826324463
local_output_nid generation:  0.029646635055541992
local_in_edges_tensor generation:  0.0418243408203125
mini_batch_src_global generation:  0.07565593719482422
r_  generation:  0.49385499954223633
local_output_nid generation:  0.030878305435180664
local_in_edges_tensor generation:  0.03300285339355469
mini_batch_src_global generation:  0.06462430953979492
r_  generation:  0.5025925636291504
local_output_nid generation:  0.030184030532836914
local_in_edges_tensor generation:  0.02878260612487793
mini_batch_src_global generation:  0.06064105033874512
r_  generation:  0.4936859607696533
local_output_nid generation:  0.029952049255371094
local_in_edges_tensor generation:  0.03242850303649902
mini_batch_src_global generation:  0.06308317184448242
r_  generation:  0.5012257099151611
local_output_nid generation:  0.02923297882080078
local_in_edges_tensor generation:  0.029995441436767578
mini_batch_src_global generation:  0.06260347366333008
r_  generation:  0.4933304786682129
local_output_nid generation:  0.02931046485900879
local_in_edges_tensor generation:  0.028186559677124023
mini_batch_src_global generation:  0.061887502670288086
r_  generation:  0.4996304512023926
local_output_nid generation:  0.029878616333007812
local_in_edges_tensor generation:  0.03768420219421387
mini_batch_src_global generation:  0.060372114181518555
r_  generation:  0.49602675437927246
local_output_nid generation:  0.029819250106811523
local_in_edges_tensor generation:  0.037143707275390625
mini_batch_src_global generation:  0.05998826026916504
r_  generation:  0.5050380229949951
local_output_nid generation:  0.029774188995361328
local_in_edges_tensor generation:  0.03404974937438965
mini_batch_src_global generation:  0.06085538864135742
r_  generation:  0.49153923988342285
local_output_nid generation:  0.0299680233001709
local_in_edges_tensor generation:  0.03463435173034668
mini_batch_src_global generation:  0.059284210205078125
r_  generation:  0.5051636695861816
local_output_nid generation:  0.03028416633605957
local_in_edges_tensor generation:  0.02871084213256836
mini_batch_src_global generation:  0.060909271240234375
r_  generation:  0.49228715896606445
local_output_nid generation:  0.029191970825195312
local_in_edges_tensor generation:  0.03187870979309082
mini_batch_src_global generation:  0.05927395820617676
r_  generation:  0.49742937088012695
local_output_nid generation:  0.029150724411010742
local_in_edges_tensor generation:  0.0325322151184082
mini_batch_src_global generation:  0.06164145469665527
r_  generation:  0.4870591163635254
local_output_nid generation:  0.02982807159423828
local_in_edges_tensor generation:  0.04116678237915039
mini_batch_src_global generation:  0.06276273727416992
r_  generation:  0.517878532409668
local_output_nid generation:  0.02926015853881836
local_in_edges_tensor generation:  0.028192996978759766
mini_batch_src_global generation:  0.06014370918273926
r_  generation:  0.5020389556884766
local_output_nid generation:  0.029700040817260742
local_in_edges_tensor generation:  0.0395960807800293
mini_batch_src_global generation:  0.06017494201660156
r_  generation:  0.5020387172698975
local_output_nid generation:  0.029801607131958008
local_in_edges_tensor generation:  0.0352931022644043
mini_batch_src_global generation:  0.06104898452758789
r_  generation:  0.5057985782623291
----------------------check_connections_block total spend ----------------------------- 23.507644414901733
generate_one_block  0.6707732677459717
generate_one_block  0.6521415710449219
generate_one_block  0.6275289058685303
generate_one_block  0.6287319660186768
generate_one_block  0.7476308345794678
generate_one_block  0.6417481899261475
generate_one_block  0.6361064910888672
generate_one_block  0.637446403503418
generate_one_block  0.6440732479095459
generate_one_block  0.6621465682983398
generate_one_block  0.6567461490631104
generate_one_block  0.6454188823699951
generate_one_block  0.6319279670715332
generate_one_block  0.6471395492553711
generate_one_block  0.6315395832061768
generate_one_block  0.6469802856445312
generate_one_block  0.6589217185974121
generate_one_block  0.6321969032287598
generate_one_block  0.6506454944610596
generate_one_block  0.6288797855377197
generate_one_block  0.6407938003540039
generate_one_block  0.663219690322876
generate_one_block  0.6523373126983643
generate_one_block  0.6310896873474121
generate_one_block  0.6636803150177002
generate_one_block  0.6336557865142822
generate_one_block  0.6334035396575928
generate_one_block  0.62904953956604
generate_one_block  0.6604030132293701
generate_one_block  0.637427806854248
generate_one_block  0.6521027088165283
generate_one_block  0.6438958644866943
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.12382364273071289  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

connection checking time:  32.02108097076416
block generation total time  28.15576434135437
average batch blocks generation time:  0.8798676356673241
block dataloader generation time/epoch 62.8077666759491
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.0895543098449707  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

torch.Size([150453, 128])
torch.Size([110181, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.22052240371704102  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.0894021987915039  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

torch.Size([150393, 128])
torch.Size([110095, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.21974515914916992  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08905315399169922  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

torch.Size([150335, 128])
torch.Size([109143, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.2166733741760254  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08905601501464844  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

torch.Size([150342, 128])
torch.Size([109111, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.21738243103027344  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08924007415771484  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

torch.Size([149715, 128])
torch.Size([108939, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.21723699569702148  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08940410614013672  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

torch.Size([149597, 128])
torch.Size([109542, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.21945953369140625  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08920860290527344  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

torch.Size([150012, 128])
torch.Size([108930, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.2184615135192871  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.0892496109008789  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

torch.Size([150212, 128])
torch.Size([109669, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.2187032699584961  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08922863006591797  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

torch.Size([150547, 128])
torch.Size([109752, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.2190399169921875  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08924293518066406  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

torch.Size([150412, 128])
torch.Size([109954, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.2192544937133789  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08960819244384766  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

torch.Size([150665, 128])
torch.Size([111076, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.22400712966918945  GigaBytes
Max Memory Allocated: 0.2545628547668457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08956146240234375  GigaBytes
Max Memory Allocated: 0.2548069953918457  GigaBytes

torch.Size([150258, 128])
torch.Size([109931, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.22059202194213867  GigaBytes
Max Memory Allocated: 0.2548069953918457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.0893697738647461  GigaBytes
Max Memory Allocated: 0.2548069953918457  GigaBytes

torch.Size([150043, 128])
torch.Size([109089, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.2189650535583496  GigaBytes
Max Memory Allocated: 0.2548069953918457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08950519561767578  GigaBytes
Max Memory Allocated: 0.2548069953918457  GigaBytes

torch.Size([150892, 128])
torch.Size([110746, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.2238020896911621  GigaBytes
Max Memory Allocated: 0.2548069953918457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08925342559814453  GigaBytes
Max Memory Allocated: 0.2548069953918457  GigaBytes

torch.Size([150302, 128])
torch.Size([109342, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.21863222122192383  GigaBytes
Max Memory Allocated: 0.2548069953918457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08939933776855469  GigaBytes
Max Memory Allocated: 0.2548069953918457  GigaBytes

torch.Size([150277, 128])
torch.Size([109739, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.21940326690673828  GigaBytes
Max Memory Allocated: 0.2548069953918457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.0896759033203125  GigaBytes
Max Memory Allocated: 0.2548069953918457  GigaBytes

torch.Size([150729, 128])
torch.Size([111439, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.2242875099182129  GigaBytes
Max Memory Allocated: 0.2548069953918457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08938884735107422  GigaBytes
Max Memory Allocated: 0.25492238998413086  GigaBytes

torch.Size([150486, 128])
torch.Size([110051, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.21978998184204102  GigaBytes
Max Memory Allocated: 0.25492238998413086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08957099914550781  GigaBytes
Max Memory Allocated: 0.25492238998413086  GigaBytes

torch.Size([150774, 128])
torch.Size([110173, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.22070598602294922  GigaBytes
Max Memory Allocated: 0.25492238998413086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08927440643310547  GigaBytes
Max Memory Allocated: 0.25492238998413086  GigaBytes

torch.Size([149894, 128])
torch.Size([109070, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.21880531311035156  GigaBytes
Max Memory Allocated: 0.25492238998413086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08933067321777344  GigaBytes
Max Memory Allocated: 0.25492238998413086  GigaBytes

torch.Size([149795, 128])
torch.Size([109394, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.2187652587890625  GigaBytes
Max Memory Allocated: 0.25492238998413086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08967304229736328  GigaBytes
Max Memory Allocated: 0.25492238998413086  GigaBytes

torch.Size([150535, 128])
torch.Size([110822, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.22423267364501953  GigaBytes
Max Memory Allocated: 0.25492238998413086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08953094482421875  GigaBytes
Max Memory Allocated: 0.25492238998413086  GigaBytes

torch.Size([150586, 128])
torch.Size([110372, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.22074651718139648  GigaBytes
Max Memory Allocated: 0.25492238998413086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.0893545150756836  GigaBytes
Max Memory Allocated: 0.25492238998413086  GigaBytes

torch.Size([150230, 128])
torch.Size([110026, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.2197246551513672  GigaBytes
Max Memory Allocated: 0.25492238998413086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08944320678710938  GigaBytes
Max Memory Allocated: 0.25492238998413086  GigaBytes

torch.Size([150741, 128])
torch.Size([110612, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.22352981567382812  GigaBytes
Max Memory Allocated: 0.25492238998413086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08927154541015625  GigaBytes
Max Memory Allocated: 0.25492238998413086  GigaBytes

torch.Size([150143, 128])
torch.Size([109197, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.21743202209472656  GigaBytes
Max Memory Allocated: 0.25492238998413086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.0892791748046875  GigaBytes
Max Memory Allocated: 0.25492238998413086  GigaBytes

torch.Size([150130, 128])
torch.Size([109230, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.21882104873657227  GigaBytes
Max Memory Allocated: 0.25492238998413086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08909034729003906  GigaBytes
Max Memory Allocated: 0.25492238998413086  GigaBytes

torch.Size([149572, 128])
torch.Size([108243, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.21633577346801758  GigaBytes
Max Memory Allocated: 0.25492238998413086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.0894622802734375  GigaBytes
Max Memory Allocated: 0.25492238998413086  GigaBytes

torch.Size([150744, 128])
torch.Size([110430, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.2203507423400879  GigaBytes
Max Memory Allocated: 0.25492238998413086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08837080001831055  GigaBytes
Max Memory Allocated: 0.25492238998413086  GigaBytes

torch.Size([149241, 128])
torch.Size([108421, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.21779108047485352  GigaBytes
Max Memory Allocated: 0.25492238998413086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08970260620117188  GigaBytes
Max Memory Allocated: 0.25492238998413086  GigaBytes

torch.Size([150648, 128])
torch.Size([110854, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.22449827194213867  GigaBytes
Max Memory Allocated: 0.25492238998413086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.08935546875  GigaBytes
Max Memory Allocated: 0.25492238998413086  GigaBytes

torch.Size([150431, 128])
torch.Size([110056, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.21971654891967773  GigaBytes
Max Memory Allocated: 0.25492238998413086  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03171732276678085 |0.014537177979946136 |0.003749251365661621 |9.086728096008301e-05 |0.004532270133495331 |0.0019025802612304688 |
----------------------------------------------------------pseudo_mini_loss sum 4.118179798126221
Total (block generation + training)time/epoch 64.60451483726501
Training time/epoch 1.796482801437378
Training time without block to device /epoch 1.3312931060791016
Training time without total dataloading part /epoch 0.2698190212249756
load block tensor time/epoch 1.0149543285369873
block to device time/epoch 0.46518969535827637
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9162558
Number of first layer input nodes during this epoch:  4809134
