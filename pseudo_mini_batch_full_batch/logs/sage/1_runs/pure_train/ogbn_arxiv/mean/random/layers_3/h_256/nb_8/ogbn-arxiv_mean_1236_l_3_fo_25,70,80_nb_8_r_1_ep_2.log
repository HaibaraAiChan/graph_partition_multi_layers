Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648444416.4131982
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02774953842163086
random selection method range initialization spend 0.0063211917877197266
time for parepare:  0.0186614990234375
local_output_nid generation:  0.0042743682861328125
local_in_edges_tensor generation:  0.006642818450927734
mini_batch_src_global generation:  0.003694772720336914
r_  generation:  0.04156637191772461
local_output_nid generation:  0.005759239196777344
local_in_edges_tensor generation:  0.003267049789428711
mini_batch_src_global generation:  0.004738569259643555
r_  generation:  0.04455709457397461
local_output_nid generation:  0.006077766418457031
local_in_edges_tensor generation:  0.0032775402069091797
mini_batch_src_global generation:  0.003258943557739258
r_  generation:  0.04370546340942383
local_output_nid generation:  0.00615382194519043
local_in_edges_tensor generation:  0.0032842159271240234
mini_batch_src_global generation:  0.003400087356567383
r_  generation:  0.04462838172912598
local_output_nid generation:  0.0061490535736083984
local_in_edges_tensor generation:  0.003350973129272461
mini_batch_src_global generation:  0.003561258316040039
r_  generation:  0.046868085861206055
local_output_nid generation:  0.0061533451080322266
local_in_edges_tensor generation:  0.0032701492309570312
mini_batch_src_global generation:  0.0037162303924560547
r_  generation:  0.04651165008544922
local_output_nid generation:  0.006112098693847656
local_in_edges_tensor generation:  0.003229379653930664
mini_batch_src_global generation:  0.0038068294525146484
r_  generation:  0.047269344329833984
local_output_nid generation:  0.0061435699462890625
local_in_edges_tensor generation:  0.0032317638397216797
mini_batch_src_global generation:  0.004064083099365234
r_  generation:  0.04746675491333008
----------------------check_connections_block total spend ----------------------------- 0.5723428726196289
generate_one_block  0.06236624717712402
generate_one_block  0.06323432922363281
generate_one_block  0.06142234802246094
generate_one_block  0.06088399887084961
generate_one_block  0.06540417671203613
generate_one_block  0.06251001358032227
generate_one_block  0.061759233474731445
generate_one_block  0.06204724311828613
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04372596740722656
gen group dst list time:  0.016435861587524414
time for parepare:  0.020445823669433594
local_output_nid generation:  0.015161275863647461
local_in_edges_tensor generation:  0.0368657112121582
mini_batch_src_global generation:  0.03560137748718262
r_  generation:  0.36026787757873535
local_output_nid generation:  0.024765491485595703
local_in_edges_tensor generation:  0.03742647171020508
mini_batch_src_global generation:  0.048044681549072266
r_  generation:  0.37345147132873535
local_output_nid generation:  0.024635791778564453
local_in_edges_tensor generation:  0.02600860595703125
mini_batch_src_global generation:  0.04415154457092285
r_  generation:  0.3783292770385742
local_output_nid generation:  0.02443242073059082
local_in_edges_tensor generation:  0.029120206832885742
mini_batch_src_global generation:  0.04427003860473633
r_  generation:  0.37178707122802734
local_output_nid generation:  0.02435922622680664
local_in_edges_tensor generation:  0.025794029235839844
mini_batch_src_global generation:  0.04871368408203125
r_  generation:  0.3812906742095947
local_output_nid generation:  0.024837255477905273
local_in_edges_tensor generation:  0.025806427001953125
mini_batch_src_global generation:  0.049204111099243164
r_  generation:  0.3817005157470703
local_output_nid generation:  0.024533510208129883
local_in_edges_tensor generation:  0.02580428123474121
mini_batch_src_global generation:  0.047066688537597656
r_  generation:  0.3891129493713379
local_output_nid generation:  0.0243377685546875
local_in_edges_tensor generation:  0.029108524322509766
mini_batch_src_global generation:  0.0473783016204834
r_  generation:  0.38249802589416504
----------------------check_connections_block total spend ----------------------------- 4.46145224571228
generate_one_block  0.5033636093139648
generate_one_block  0.5159945487976074
generate_one_block  0.49601078033447266
generate_one_block  0.48366641998291016
generate_one_block  0.500540018081665
generate_one_block  0.5208959579467773
generate_one_block  0.5089082717895508
generate_one_block  0.5001688003540039
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03239083290100098
gen group dst list time:  0.03769946098327637
time for parepare:  0.019296646118164062
local_output_nid generation:  0.02900409698486328
local_in_edges_tensor generation:  0.04465341567993164
mini_batch_src_global generation:  0.04533505439758301
r_  generation:  0.4803440570831299
local_output_nid generation:  0.03558659553527832
local_in_edges_tensor generation:  0.05217885971069336
mini_batch_src_global generation:  0.05552172660827637
r_  generation:  0.48734092712402344
local_output_nid generation:  0.03520393371582031
local_in_edges_tensor generation:  0.044095516204833984
mini_batch_src_global generation:  0.0548098087310791
r_  generation:  0.4887995719909668
local_output_nid generation:  0.03559541702270508
local_in_edges_tensor generation:  0.03910064697265625
mini_batch_src_global generation:  0.05662202835083008
r_  generation:  0.4992835521697998
local_output_nid generation:  0.03870677947998047
local_in_edges_tensor generation:  0.03497433662414551
mini_batch_src_global generation:  0.05391192436218262
r_  generation:  0.49943971633911133
local_output_nid generation:  0.03564786911010742
local_in_edges_tensor generation:  0.043457984924316406
mini_batch_src_global generation:  0.05736589431762695
r_  generation:  0.5049223899841309
local_output_nid generation:  0.035657644271850586
local_in_edges_tensor generation:  0.03551459312438965
mini_batch_src_global generation:  0.05476570129394531
r_  generation:  0.5082314014434814
local_output_nid generation:  0.03551149368286133
local_in_edges_tensor generation:  0.03525352478027344
mini_batch_src_global generation:  0.05487465858459473
r_  generation:  0.5041728019714355
----------------------check_connections_block total spend ----------------------------- 5.921512126922607
generate_one_block  0.6168148517608643
generate_one_block  0.6351344585418701
generate_one_block  0.6246442794799805
generate_one_block  0.6284050941467285
generate_one_block  0.6233072280883789
generate_one_block  0.6336770057678223
generate_one_block  0.6446714401245117
generate_one_block  0.6301329135894775
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  10.382964372634888
block generation total time  9.066335678100586
average batch blocks generation time:  1.1332919597625732
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.10040664672851562  GigaBytes
Max Memory Allocated: 0.10040664672851562  GigaBytes

torch.Size([162247, 128])
torch.Size([145835, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4783935546875 GB
    Memory Allocated: 0.9485869407653809  GigaBytes
Max Memory Allocated: 1.014742374420166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8494873046875 GB
    Memory Allocated: 0.10273027420043945  GigaBytes
Max Memory Allocated: 1.0892348289489746  GigaBytes

torch.Size([162459, 128])
torch.Size([146357, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8514404296875 GB
    Memory Allocated: 0.9533052444458008  GigaBytes
Max Memory Allocated: 1.0892348289489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.10323953628540039  GigaBytes
Max Memory Allocated: 1.0950050354003906  GigaBytes

torch.Size([162196, 128])
torch.Size([145782, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.9484419822692871  GigaBytes
Max Memory Allocated: 1.0950050354003906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.10378646850585938  GigaBytes
Max Memory Allocated: 1.0950050354003906  GigaBytes

torch.Size([162364, 128])
torch.Size([146134, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.9451546669006348  GigaBytes
Max Memory Allocated: 1.0950050354003906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.10251712799072266  GigaBytes
Max Memory Allocated: 1.0950050354003906  GigaBytes

torch.Size([162223, 128])
torch.Size([145709, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.9471354484558105  GigaBytes
Max Memory Allocated: 1.0950050354003906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.1036062240600586  GigaBytes
Max Memory Allocated: 1.0950050354003906  GigaBytes

torch.Size([162512, 128])
torch.Size([146630, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.9547443389892578  GigaBytes
Max Memory Allocated: 1.0950050354003906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.10276031494140625  GigaBytes
Max Memory Allocated: 1.0953407287597656  GigaBytes

torch.Size([162316, 128])
torch.Size([145787, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.9486594200134277  GigaBytes
Max Memory Allocated: 1.0953407287597656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.10335636138916016  GigaBytes
Max Memory Allocated: 1.0953407287597656  GigaBytes

torch.Size([162135, 128])
torch.Size([145664, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.9472708702087402  GigaBytes
Max Memory Allocated: 1.0953407287597656  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.062351882457733154 |0.04686465859413147 |0.09791520237922668 |0.00010064244270324707 |0.01495903730392456 |0.00164794921875 |
----------------------------------------------------------pseudo_mini_loss sum 6.242984771728516
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3055295
Number of first layer input nodes during this epoch:  1298452
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.1381058692932129  GigaBytes
Max Memory Allocated: 1.0953407287597656  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02622246742248535
random selection method range initialization spend 0.005577802658081055
time for parepare:  0.018673419952392578
local_output_nid generation:  0.004398345947265625
local_in_edges_tensor generation:  0.006605863571166992
mini_batch_src_global generation:  0.003843069076538086
r_  generation:  0.04772377014160156
local_output_nid generation:  0.0073680877685546875
local_in_edges_tensor generation:  0.007647275924682617
mini_batch_src_global generation:  0.009113311767578125
r_  generation:  0.04781794548034668
local_output_nid generation:  0.006654024124145508
local_in_edges_tensor generation:  0.0034999847412109375
mini_batch_src_global generation:  0.0034112930297851562
r_  generation:  0.04811406135559082
local_output_nid generation:  0.006833076477050781
local_in_edges_tensor generation:  0.0033180713653564453
mini_batch_src_global generation:  0.003576517105102539
r_  generation:  0.04588007926940918
local_output_nid generation:  0.006251811981201172
local_in_edges_tensor generation:  0.003368377685546875
mini_batch_src_global generation:  0.0037322044372558594
r_  generation:  0.0522918701171875
local_output_nid generation:  0.006377458572387695
local_in_edges_tensor generation:  0.004560708999633789
mini_batch_src_global generation:  0.004078865051269531
r_  generation:  0.05015301704406738
local_output_nid generation:  0.0063021183013916016
local_in_edges_tensor generation:  0.0035080909729003906
mini_batch_src_global generation:  0.00408935546875
r_  generation:  0.04854083061218262
local_output_nid generation:  0.006299495697021484
local_in_edges_tensor generation:  0.0032625198364257812
mini_batch_src_global generation:  0.004069805145263672
r_  generation:  0.048432350158691406
----------------------check_connections_block total spend ----------------------------- 0.6374404430389404
generate_one_block  0.06180691719055176
generate_one_block  0.06173849105834961
generate_one_block  0.06208229064941406
generate_one_block  0.06170368194580078
generate_one_block  0.0629880428314209
generate_one_block  0.06211233139038086
generate_one_block  0.06706523895263672
generate_one_block  0.0619654655456543
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.07685708999633789
gen group dst list time:  0.01654672622680664
time for parepare:  0.01933431625366211
local_output_nid generation:  0.014937162399291992
local_in_edges_tensor generation:  0.05829668045043945
mini_batch_src_global generation:  0.03682756423950195
r_  generation:  0.3639407157897949
local_output_nid generation:  0.02070021629333496
local_in_edges_tensor generation:  0.03614544868469238
mini_batch_src_global generation:  0.045601606369018555
r_  generation:  0.37548041343688965
local_output_nid generation:  0.019665002822875977
local_in_edges_tensor generation:  0.025754690170288086
mini_batch_src_global generation:  0.04452395439147949
r_  generation:  0.38220715522766113
local_output_nid generation:  0.019541025161743164
local_in_edges_tensor generation:  0.029429912567138672
mini_batch_src_global generation:  0.04607748985290527
r_  generation:  0.3781449794769287
local_output_nid generation:  0.02095341682434082
local_in_edges_tensor generation:  0.025217294692993164
mini_batch_src_global generation:  0.04643368721008301
r_  generation:  0.3813507556915283
local_output_nid generation:  0.01964426040649414
local_in_edges_tensor generation:  0.02984309196472168
mini_batch_src_global generation:  0.04819536209106445
r_  generation:  0.38463687896728516
local_output_nid generation:  0.01986837387084961
local_in_edges_tensor generation:  0.030188560485839844
mini_batch_src_global generation:  0.04741263389587402
r_  generation:  0.3903234004974365
local_output_nid generation:  0.0213162899017334
local_in_edges_tensor generation:  0.022709369659423828
mini_batch_src_global generation:  0.047052860260009766
r_  generation:  0.37985968589782715
----------------------check_connections_block total spend ----------------------------- 4.469513893127441
generate_one_block  0.5406789779663086
generate_one_block  0.5233163833618164
generate_one_block  0.5248100757598877
generate_one_block  0.5079925060272217
generate_one_block  0.4949808120727539
generate_one_block  0.4983036518096924
generate_one_block  0.5102040767669678
generate_one_block  0.519059419631958
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.06853628158569336
gen group dst list time:  0.038599491119384766
time for parepare:  0.018951416015625
local_output_nid generation:  0.03325629234313965
local_in_edges_tensor generation:  0.06344318389892578
mini_batch_src_global generation:  0.04479026794433594
r_  generation:  0.49707746505737305
local_output_nid generation:  0.03604292869567871
local_in_edges_tensor generation:  0.05280876159667969
mini_batch_src_global generation:  0.0570220947265625
r_  generation:  0.48725247383117676
local_output_nid generation:  0.036705732345581055
local_in_edges_tensor generation:  0.04870152473449707
mini_batch_src_global generation:  0.05428886413574219
r_  generation:  0.49161529541015625
local_output_nid generation:  0.035395145416259766
local_in_edges_tensor generation:  0.037822723388671875
mini_batch_src_global generation:  0.0515744686126709
r_  generation:  0.5018177032470703
local_output_nid generation:  0.03536653518676758
local_in_edges_tensor generation:  0.03423905372619629
mini_batch_src_global generation:  0.05305838584899902
r_  generation:  0.5067534446716309
local_output_nid generation:  0.03666210174560547
local_in_edges_tensor generation:  0.03923320770263672
mini_batch_src_global generation:  0.055869340896606445
r_  generation:  0.5079107284545898
local_output_nid generation:  0.03947257995605469
local_in_edges_tensor generation:  0.04311728477478027
mini_batch_src_global generation:  0.05339550971984863
r_  generation:  0.5068137645721436
local_output_nid generation:  0.03619050979614258
local_in_edges_tensor generation:  0.03967118263244629
mini_batch_src_global generation:  0.05382370948791504
r_  generation:  0.5115606784820557
----------------------check_connections_block total spend ----------------------------- 5.988470077514648
generate_one_block  0.6409282684326172
generate_one_block  0.6275997161865234
generate_one_block  0.625551700592041
generate_one_block  0.6275947093963623
generate_one_block  0.6169979572296143
generate_one_block  0.6335330009460449
generate_one_block  0.6585233211517334
generate_one_block  0.6332042217254639
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.1381058692932129  GigaBytes
Max Memory Allocated: 1.0953407287597656  GigaBytes

connection checking time:  10.45798397064209
block generation total time  9.183278799057007
average batch blocks generation time:  1.1479098498821259
block dataloader generation time/epoch 21.893926858901978
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.10426759719848633  GigaBytes
Max Memory Allocated: 1.0953407287597656  GigaBytes

torch.Size([162225, 128])
torch.Size([146227, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9549212455749512  GigaBytes
Max Memory Allocated: 1.0953407287597656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10458707809448242  GigaBytes
Max Memory Allocated: 1.0968527793884277  GigaBytes

torch.Size([162235, 128])
torch.Size([145795, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9526090621948242  GigaBytes
Max Memory Allocated: 1.0968527793884277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1051025390625  GigaBytes
Max Memory Allocated: 1.0968527793884277  GigaBytes

torch.Size([162476, 128])
torch.Size([146559, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9547247886657715  GigaBytes
Max Memory Allocated: 1.0968527793884277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10508584976196289  GigaBytes
Max Memory Allocated: 1.0968527793884277  GigaBytes

torch.Size([162291, 128])
torch.Size([145905, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9490303993225098  GigaBytes
Max Memory Allocated: 1.0968527793884277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1043548583984375  GigaBytes
Max Memory Allocated: 1.0968527793884277  GigaBytes

torch.Size([161988, 128])
torch.Size([145920, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9493002891540527  GigaBytes
Max Memory Allocated: 1.0968527793884277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10521411895751953  GigaBytes
Max Memory Allocated: 1.0968527793884277  GigaBytes

torch.Size([162324, 128])
torch.Size([145996, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9509854316711426  GigaBytes
Max Memory Allocated: 1.0968527793884277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10446882247924805  GigaBytes
Max Memory Allocated: 1.0968527793884277  GigaBytes

torch.Size([162044, 128])
torch.Size([145993, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9528870582580566  GigaBytes
Max Memory Allocated: 1.0968527793884277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1057124137878418  GigaBytes
Max Memory Allocated: 1.0968527793884277  GigaBytes

torch.Size([162428, 128])
torch.Size([146120, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9502468109130859  GigaBytes
Max Memory Allocated: 1.0968527793884277  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0753275454044342 |0.01791742444038391 |0.006445884704589844 |9.337067604064941e-05 |0.004271060228347778 |0.0013494491577148438 |
----------------------------------------------------------pseudo_mini_loss sum 3.23695707321167
Total (block generation + training)time/epoch 22.79749369621277
Training time/epoch 0.9032864570617676
Training time without block to device /epoch 0.7599470615386963
Training time without total dataloading part /epoch 0.08783197402954102
load block tensor time/epoch 0.6026203632354736
block to device time/epoch 0.1433393955230713
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3056561
Number of first layer input nodes during this epoch:  1298011
