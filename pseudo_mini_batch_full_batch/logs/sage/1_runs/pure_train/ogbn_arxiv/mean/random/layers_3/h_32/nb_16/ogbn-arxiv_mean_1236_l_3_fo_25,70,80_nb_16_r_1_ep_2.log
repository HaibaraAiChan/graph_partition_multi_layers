Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648438420.447416
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02797389030456543
random selection method range initialization spend 0.0063283443450927734
time for parepare:  0.018768310546875
local_output_nid generation:  0.002165079116821289
local_in_edges_tensor generation:  0.005151271820068359
mini_batch_src_global generation:  0.0019474029541015625
r_  generation:  0.019446372985839844
local_output_nid generation:  0.0025534629821777344
local_in_edges_tensor generation:  0.0018091201782226562
mini_batch_src_global generation:  0.002460002899169922
r_  generation:  0.019884109497070312
local_output_nid generation:  0.0028219223022460938
local_in_edges_tensor generation:  0.001669168472290039
mini_batch_src_global generation:  0.001552581787109375
r_  generation:  0.02111959457397461
local_output_nid generation:  0.002884387969970703
local_in_edges_tensor generation:  0.0016331672668457031
mini_batch_src_global generation:  0.0015516281127929688
r_  generation:  0.01983928680419922
local_output_nid generation:  0.002865314483642578
local_in_edges_tensor generation:  0.001621246337890625
mini_batch_src_global generation:  0.0014922618865966797
r_  generation:  0.020090341567993164
local_output_nid generation:  0.002830982208251953
local_in_edges_tensor generation:  0.0016179084777832031
mini_batch_src_global generation:  0.0016200542449951172
r_  generation:  0.0207517147064209
local_output_nid generation:  0.0028269290924072266
local_in_edges_tensor generation:  0.0016024112701416016
mini_batch_src_global generation:  0.001636505126953125
r_  generation:  0.020681381225585938
local_output_nid generation:  0.002941131591796875
local_in_edges_tensor generation:  0.0016155242919921875
mini_batch_src_global generation:  0.0016832351684570312
r_  generation:  0.020631074905395508
local_output_nid generation:  0.002905607223510742
local_in_edges_tensor generation:  0.00157928466796875
mini_batch_src_global generation:  0.0016508102416992188
r_  generation:  0.020824909210205078
local_output_nid generation:  0.0029153823852539062
local_in_edges_tensor generation:  0.001565694808959961
mini_batch_src_global generation:  0.0017347335815429688
r_  generation:  0.02161860466003418
local_output_nid generation:  0.002933502197265625
local_in_edges_tensor generation:  0.0015892982482910156
mini_batch_src_global generation:  0.0016858577728271484
r_  generation:  0.0208432674407959
local_output_nid generation:  0.0028874874114990234
local_in_edges_tensor generation:  0.0015413761138916016
mini_batch_src_global generation:  0.00174713134765625
r_  generation:  0.02109670639038086
local_output_nid generation:  0.0028533935546875
local_in_edges_tensor generation:  0.001554250717163086
mini_batch_src_global generation:  0.0016825199127197266
r_  generation:  0.020589828491210938
local_output_nid generation:  0.002926349639892578
local_in_edges_tensor generation:  0.0015726089477539062
mini_batch_src_global generation:  0.0017464160919189453
r_  generation:  0.021520614624023438
local_output_nid generation:  0.002869844436645508
local_in_edges_tensor generation:  0.0015835762023925781
mini_batch_src_global generation:  0.0017194747924804688
r_  generation:  0.02055954933166504
local_output_nid generation:  0.0029442310333251953
local_in_edges_tensor generation:  0.001600027084350586
mini_batch_src_global generation:  0.0016617774963378906
r_  generation:  0.020682573318481445
----------------------check_connections_block total spend ----------------------------- 0.5350203514099121
generate_one_block  0.030681133270263672
generate_one_block  0.0315546989440918
generate_one_block  0.034651756286621094
generate_one_block  0.0317072868347168
generate_one_block  0.03129267692565918
generate_one_block  0.03131675720214844
generate_one_block  0.0309908390045166
generate_one_block  0.030441999435424805
generate_one_block  0.031243085861206055
generate_one_block  0.031467437744140625
generate_one_block  0.03086090087890625
generate_one_block  0.030956506729125977
generate_one_block  0.030435800552368164
generate_one_block  0.03130197525024414
generate_one_block  0.029834985733032227
generate_one_block  0.03054499626159668
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04497361183166504
gen group dst list time:  0.020700693130493164
time for parepare:  0.020420074462890625
local_output_nid generation:  0.009372234344482422
local_in_edges_tensor generation:  0.02288818359375
mini_batch_src_global generation:  0.02645277976989746
r_  generation:  0.24156618118286133
local_output_nid generation:  0.01623821258544922
local_in_edges_tensor generation:  0.025476932525634766
mini_batch_src_global generation:  0.03197193145751953
r_  generation:  0.259890079498291
local_output_nid generation:  0.016526460647583008
local_in_edges_tensor generation:  0.02080082893371582
mini_batch_src_global generation:  0.03156852722167969
r_  generation:  0.2699580192565918
local_output_nid generation:  0.016135692596435547
local_in_edges_tensor generation:  0.020269155502319336
mini_batch_src_global generation:  0.0322270393371582
r_  generation:  0.2645137310028076
local_output_nid generation:  0.016090869903564453
local_in_edges_tensor generation:  0.02156853675842285
mini_batch_src_global generation:  0.033390045166015625
r_  generation:  0.2657492160797119
local_output_nid generation:  0.01620006561279297
local_in_edges_tensor generation:  0.01779794692993164
mini_batch_src_global generation:  0.0333559513092041
r_  generation:  0.269153356552124
local_output_nid generation:  0.016220569610595703
local_in_edges_tensor generation:  0.020334482192993164
mini_batch_src_global generation:  0.03423643112182617
r_  generation:  0.2696239948272705
local_output_nid generation:  0.01605677604675293
local_in_edges_tensor generation:  0.015080451965332031
mini_batch_src_global generation:  0.034020185470581055
r_  generation:  0.26628732681274414
local_output_nid generation:  0.0161893367767334
local_in_edges_tensor generation:  0.01833963394165039
mini_batch_src_global generation:  0.03427529335021973
r_  generation:  0.2680022716522217
local_output_nid generation:  0.01626133918762207
local_in_edges_tensor generation:  0.02338433265686035
mini_batch_src_global generation:  0.038191795349121094
r_  generation:  0.2765505313873291
local_output_nid generation:  0.01613640785217285
local_in_edges_tensor generation:  0.015478134155273438
mini_batch_src_global generation:  0.03417706489562988
r_  generation:  0.2670588493347168
local_output_nid generation:  0.016312122344970703
local_in_edges_tensor generation:  0.018242359161376953
mini_batch_src_global generation:  0.03659963607788086
r_  generation:  0.275348424911499
local_output_nid generation:  0.016190528869628906
local_in_edges_tensor generation:  0.01997828483581543
mini_batch_src_global generation:  0.03422427177429199
r_  generation:  0.26637697219848633
local_output_nid generation:  0.01604294776916504
local_in_edges_tensor generation:  0.01569962501525879
mini_batch_src_global generation:  0.034310102462768555
r_  generation:  0.2669401168823242
local_output_nid generation:  0.015700340270996094
local_in_edges_tensor generation:  0.01743769645690918
mini_batch_src_global generation:  0.033875465393066406
r_  generation:  0.26593637466430664
local_output_nid generation:  0.0159759521484375
local_in_edges_tensor generation:  0.01781630516052246
mini_batch_src_global generation:  0.0357823371887207
r_  generation:  0.2651333808898926
----------------------check_connections_block total spend ----------------------------- 6.296837091445923
generate_one_block  0.35022401809692383
generate_one_block  0.3624579906463623
generate_one_block  0.3694489002227783
generate_one_block  0.3576474189758301
generate_one_block  0.37168097496032715
generate_one_block  0.35468459129333496
generate_one_block  0.36255359649658203
generate_one_block  0.3491475582122803
generate_one_block  0.35553693771362305
generate_one_block  0.36417293548583984
generate_one_block  0.3465280532836914
generate_one_block  0.36173057556152344
generate_one_block  0.3507974147796631
generate_one_block  0.35115480422973633
generate_one_block  0.3570692539215088
generate_one_block  0.34898853302001953
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.035956382751464844
gen group dst list time:  0.06280732154846191
time for parepare:  0.019656896591186523
local_output_nid generation:  0.027033329010009766
local_in_edges_tensor generation:  0.04111599922180176
mini_batch_src_global generation:  0.042490482330322266
r_  generation:  0.4481468200683594
local_output_nid generation:  0.036705732345581055
local_in_edges_tensor generation:  0.0487980842590332
mini_batch_src_global generation:  0.05307912826538086
r_  generation:  0.4590461254119873
local_output_nid generation:  0.04123950004577637
local_in_edges_tensor generation:  0.041320085525512695
mini_batch_src_global generation:  0.05051827430725098
r_  generation:  0.47103357315063477
local_output_nid generation:  0.036983489990234375
local_in_edges_tensor generation:  0.03618907928466797
mini_batch_src_global generation:  0.05179476737976074
r_  generation:  0.47218775749206543
local_output_nid generation:  0.0364990234375
local_in_edges_tensor generation:  0.03591728210449219
mini_batch_src_global generation:  0.05622720718383789
r_  generation:  0.47889041900634766
local_output_nid generation:  0.033455610275268555
local_in_edges_tensor generation:  0.04026317596435547
mini_batch_src_global generation:  0.05529284477233887
r_  generation:  0.47445249557495117
local_output_nid generation:  0.033072710037231445
local_in_edges_tensor generation:  0.030571460723876953
mini_batch_src_global generation:  0.05316877365112305
r_  generation:  0.47634100914001465
local_output_nid generation:  0.03263115882873535
local_in_edges_tensor generation:  0.03891277313232422
mini_batch_src_global generation:  0.05378985404968262
r_  generation:  0.4957289695739746
local_output_nid generation:  0.03319144248962402
local_in_edges_tensor generation:  0.034980058670043945
mini_batch_src_global generation:  0.05643439292907715
r_  generation:  0.4783475399017334
local_output_nid generation:  0.03333735466003418
local_in_edges_tensor generation:  0.034525156021118164
mini_batch_src_global generation:  0.05391383171081543
r_  generation:  0.47419238090515137
local_output_nid generation:  0.03306078910827637
local_in_edges_tensor generation:  0.030106544494628906
mini_batch_src_global generation:  0.05470418930053711
r_  generation:  0.48001980781555176
local_output_nid generation:  0.03380155563354492
local_in_edges_tensor generation:  0.03668403625488281
mini_batch_src_global generation:  0.06064748764038086
r_  generation:  0.47432923316955566
local_output_nid generation:  0.03406667709350586
local_in_edges_tensor generation:  0.03892707824707031
mini_batch_src_global generation:  0.053411245346069336
r_  generation:  0.4793059825897217
local_output_nid generation:  0.03385210037231445
local_in_edges_tensor generation:  0.034003257751464844
mini_batch_src_global generation:  0.053781986236572266
r_  generation:  0.4830358028411865
local_output_nid generation:  0.03382515907287598
local_in_edges_tensor generation:  0.040590524673461914
mini_batch_src_global generation:  0.05396533012390137
r_  generation:  0.47685718536376953
local_output_nid generation:  0.03430461883544922
local_in_edges_tensor generation:  0.042845726013183594
mini_batch_src_global generation:  0.0572962760925293
r_  generation:  0.47446489334106445
----------------------check_connections_block total spend ----------------------------- 11.312016010284424
generate_one_block  0.599947452545166
generate_one_block  0.6097304821014404
generate_one_block  0.6031284332275391
generate_one_block  0.6121959686279297
generate_one_block  0.6010444164276123
generate_one_block  0.5997700691223145
generate_one_block  0.6561164855957031
generate_one_block  0.6053435802459717
generate_one_block  0.602231502532959
generate_one_block  0.6108255386352539
generate_one_block  0.5979001522064209
generate_one_block  0.5946228504180908
generate_one_block  0.5937726497650146
generate_one_block  0.5966403484344482
generate_one_block  0.598285436630249
generate_one_block  0.5932447910308838
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

connection checking time:  17.608853101730347
block generation total time  15.388623714447021
average batch blocks generation time:  0.9617889821529388
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09220170974731445  GigaBytes
Max Memory Allocated: 0.09220170974731445  GigaBytes

torch.Size([156494, 128])
torch.Size([129138, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4862060546875 GB
    Memory Allocated: 0.1873784065246582  GigaBytes
Max Memory Allocated: 0.18986034393310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09436225891113281  GigaBytes
Max Memory Allocated: 0.20146417617797852  GigaBytes

torch.Size([156724, 128])
torch.Size([129527, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18917274475097656  GigaBytes
Max Memory Allocated: 0.20146417617797852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09469413757324219  GigaBytes
Max Memory Allocated: 0.20273208618164062  GigaBytes

torch.Size([157226, 128])
torch.Size([130912, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.19017744064331055  GigaBytes
Max Memory Allocated: 0.20273208618164062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.0946340560913086  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

torch.Size([157382, 128])
torch.Size([130522, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18961668014526367  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09446001052856445  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

torch.Size([157139, 128])
torch.Size([130753, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18935680389404297  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09412288665771484  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

torch.Size([156444, 128])
torch.Size([129035, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18881559371948242  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09454584121704102  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

torch.Size([157179, 128])
torch.Size([130433, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18939685821533203  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.0941305160522461  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

torch.Size([156642, 128])
torch.Size([129577, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18833112716674805  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09440040588378906  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

torch.Size([157044, 128])
torch.Size([130221, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18909549713134766  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09447097778320312  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

torch.Size([156890, 128])
torch.Size([130099, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18953895568847656  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09424543380737305  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

torch.Size([156917, 128])
torch.Size([129768, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.1884140968322754  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09438562393188477  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

torch.Size([156819, 128])
torch.Size([129896, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18929719924926758  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09428024291992188  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

torch.Size([156970, 128])
torch.Size([130176, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18879985809326172  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09410667419433594  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

torch.Size([156592, 128])
torch.Size([129575, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18854999542236328  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09406185150146484  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

torch.Size([156718, 128])
torch.Size([129563, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18806934356689453  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.0941624641418457  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

torch.Size([156889, 128])
torch.Size([130312, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18834209442138672  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03514404594898224 |0.031510934233665466 |0.049871623516082764 |9.624660015106201e-05 |0.007895082235336304 |0.0036039352416992188 |
----------------------------------------------------------pseudo_mini_loss sum 5.053693771362305
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5319738
Number of first layer input nodes during this epoch:  2510069
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.1313924789428711  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027481794357299805
random selection method range initialization spend 0.0061647891998291016
time for parepare:  0.018908023834228516
local_output_nid generation:  0.0023584365844726562
local_in_edges_tensor generation:  0.009190559387207031
mini_batch_src_global generation:  0.002280712127685547
r_  generation:  0.021001815795898438
local_output_nid generation:  0.0030028820037841797
local_in_edges_tensor generation:  0.0017478466033935547
mini_batch_src_global generation:  0.0023963451385498047
r_  generation:  0.020832061767578125
local_output_nid generation:  0.0031213760375976562
local_in_edges_tensor generation:  0.0017285346984863281
mini_batch_src_global generation:  0.0016396045684814453
r_  generation:  0.02091193199157715
local_output_nid generation:  0.003018617630004883
local_in_edges_tensor generation:  0.0016591548919677734
mini_batch_src_global generation:  0.0016722679138183594
r_  generation:  0.021339893341064453
local_output_nid generation:  0.0029904842376708984
local_in_edges_tensor generation:  0.0015511512756347656
mini_batch_src_global generation:  0.0015912055969238281
r_  generation:  0.02248835563659668
local_output_nid generation:  0.0029892921447753906
local_in_edges_tensor generation:  0.0015630722045898438
mini_batch_src_global generation:  0.001646280288696289
r_  generation:  0.02219247817993164
local_output_nid generation:  0.0030176639556884766
local_in_edges_tensor generation:  0.0015635490417480469
mini_batch_src_global generation:  0.0016841888427734375
r_  generation:  0.021892547607421875
local_output_nid generation:  0.0029501914978027344
local_in_edges_tensor generation:  0.0015382766723632812
mini_batch_src_global generation:  0.0017240047454833984
r_  generation:  0.02215576171875
local_output_nid generation:  0.0030586719512939453
local_in_edges_tensor generation:  0.0016241073608398438
mini_batch_src_global generation:  0.0017676353454589844
r_  generation:  0.022191286087036133
local_output_nid generation:  0.0029866695404052734
local_in_edges_tensor generation:  0.0015535354614257812
mini_batch_src_global generation:  0.0017995834350585938
r_  generation:  0.022320270538330078
local_output_nid generation:  0.0029900074005126953
local_in_edges_tensor generation:  0.0015330314636230469
mini_batch_src_global generation:  0.0018312931060791016
r_  generation:  0.022819995880126953
local_output_nid generation:  0.0030078887939453125
local_in_edges_tensor generation:  0.0016372203826904297
mini_batch_src_global generation:  0.001737356185913086
r_  generation:  0.022871017456054688
local_output_nid generation:  0.002991199493408203
local_in_edges_tensor generation:  0.001581430435180664
mini_batch_src_global generation:  0.0017733573913574219
r_  generation:  0.02232837677001953
local_output_nid generation:  0.003002643585205078
local_in_edges_tensor generation:  0.0015456676483154297
mini_batch_src_global generation:  0.001722574234008789
r_  generation:  0.024985074996948242
local_output_nid generation:  0.0030405521392822266
local_in_edges_tensor generation:  0.0015249252319335938
mini_batch_src_global generation:  0.0018000602722167969
r_  generation:  0.02255105972290039
local_output_nid generation:  0.003061532974243164
local_in_edges_tensor generation:  0.0015077590942382812
mini_batch_src_global generation:  0.001798868179321289
r_  generation:  0.022181272506713867
----------------------check_connections_block total spend ----------------------------- 0.5737733840942383
generate_one_block  0.03240513801574707
generate_one_block  0.030794858932495117
generate_one_block  0.03163290023803711
generate_one_block  0.03226804733276367
generate_one_block  0.03134918212890625
generate_one_block  0.034624338150024414
generate_one_block  0.03498554229736328
generate_one_block  0.031562089920043945
generate_one_block  0.031368255615234375
generate_one_block  0.03238987922668457
generate_one_block  0.03533744812011719
generate_one_block  0.03183889389038086
generate_one_block  0.03122234344482422
generate_one_block  0.03327131271362305
generate_one_block  0.034011125564575195
generate_one_block  0.03437066078186035
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.07474589347839355
gen group dst list time:  0.022168636322021484
time for parepare:  0.0245211124420166
local_output_nid generation:  0.009914398193359375
local_in_edges_tensor generation:  0.030695199966430664
mini_batch_src_global generation:  0.02425861358642578
r_  generation:  0.24825787544250488
local_output_nid generation:  0.013574361801147461
local_in_edges_tensor generation:  0.024242639541625977
mini_batch_src_global generation:  0.03228759765625
r_  generation:  0.265869140625
local_output_nid generation:  0.014055490493774414
local_in_edges_tensor generation:  0.021843433380126953
mini_batch_src_global generation:  0.03169083595275879
r_  generation:  0.2710599899291992
local_output_nid generation:  0.01432657241821289
local_in_edges_tensor generation:  0.01958775520324707
mini_batch_src_global generation:  0.032578229904174805
r_  generation:  0.2841072082519531
local_output_nid generation:  0.013547182083129883
local_in_edges_tensor generation:  0.01681971549987793
mini_batch_src_global generation:  0.03338503837585449
r_  generation:  0.2696518898010254
local_output_nid generation:  0.017902612686157227
local_in_edges_tensor generation:  0.02916741371154785
mini_batch_src_global generation:  0.039423465728759766
r_  generation:  0.28443264961242676
local_output_nid generation:  0.01555323600769043
local_in_edges_tensor generation:  0.020972013473510742
mini_batch_src_global generation:  0.0362696647644043
r_  generation:  0.2756807804107666
local_output_nid generation:  0.013257265090942383
local_in_edges_tensor generation:  0.01812267303466797
mini_batch_src_global generation:  0.033529043197631836
r_  generation:  0.27076292037963867
local_output_nid generation:  0.013578414916992188
local_in_edges_tensor generation:  0.014399051666259766
mini_batch_src_global generation:  0.0340118408203125
r_  generation:  0.28099751472473145
local_output_nid generation:  0.01362299919128418
local_in_edges_tensor generation:  0.017116785049438477
mini_batch_src_global generation:  0.034117698669433594
r_  generation:  0.2746281623840332
local_output_nid generation:  0.013634443283081055
local_in_edges_tensor generation:  0.021694660186767578
mini_batch_src_global generation:  0.03509664535522461
r_  generation:  0.28090953826904297
local_output_nid generation:  0.013586997985839844
local_in_edges_tensor generation:  0.014570951461791992
mini_batch_src_global generation:  0.03483271598815918
r_  generation:  0.2809295654296875
local_output_nid generation:  0.013377904891967773
local_in_edges_tensor generation:  0.01445770263671875
mini_batch_src_global generation:  0.034258127212524414
r_  generation:  0.2743873596191406
local_output_nid generation:  0.014324188232421875
local_in_edges_tensor generation:  0.016875267028808594
mini_batch_src_global generation:  0.03700089454650879
r_  generation:  0.2742011547088623
local_output_nid generation:  0.013678550720214844
local_in_edges_tensor generation:  0.019548892974853516
mini_batch_src_global generation:  0.03727579116821289
r_  generation:  0.29538536071777344
local_output_nid generation:  0.01542210578918457
local_in_edges_tensor generation:  0.030520915985107422
mini_batch_src_global generation:  0.03932499885559082
r_  generation:  0.27346205711364746
----------------------check_connections_block total spend ----------------------------- 6.4680495262146
generate_one_block  0.3622276782989502
generate_one_block  0.3495316505432129
generate_one_block  0.36044907569885254
generate_one_block  0.3640305995941162
generate_one_block  0.35019779205322266
generate_one_block  0.35524868965148926
generate_one_block  0.3948216438293457
generate_one_block  0.3469212055206299
generate_one_block  0.35695981979370117
generate_one_block  0.35484814643859863
generate_one_block  0.3664727210998535
generate_one_block  0.35437583923339844
generate_one_block  0.3828723430633545
generate_one_block  0.38338589668273926
generate_one_block  0.35759711265563965
generate_one_block  0.3519093990325928
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.07624101638793945
gen group dst list time:  0.07171297073364258
time for parepare:  0.01843714714050293
local_output_nid generation:  0.027969837188720703
local_in_edges_tensor generation:  0.05416584014892578
mini_batch_src_global generation:  0.05322718620300293
r_  generation:  0.4632415771484375
local_output_nid generation:  0.03573203086853027
local_in_edges_tensor generation:  0.04934883117675781
mini_batch_src_global generation:  0.0578005313873291
r_  generation:  0.48232245445251465
local_output_nid generation:  0.03387093544006348
local_in_edges_tensor generation:  0.056490421295166016
mini_batch_src_global generation:  0.05467796325683594
r_  generation:  0.5115466117858887
local_output_nid generation:  0.03717851638793945
local_in_edges_tensor generation:  0.0417482852935791
mini_batch_src_global generation:  0.05567049980163574
r_  generation:  0.4711647033691406
local_output_nid generation:  0.03403806686401367
local_in_edges_tensor generation:  0.09700155258178711
mini_batch_src_global generation:  0.05597114562988281
r_  generation:  0.48992156982421875
local_output_nid generation:  0.0332179069519043
local_in_edges_tensor generation:  0.04405832290649414
mini_batch_src_global generation:  0.05739927291870117
r_  generation:  0.47907519340515137
local_output_nid generation:  0.03286314010620117
local_in_edges_tensor generation:  0.032431840896606445
mini_batch_src_global generation:  0.06372332572937012
r_  generation:  0.5034332275390625
local_output_nid generation:  0.03416037559509277
local_in_edges_tensor generation:  0.03191232681274414
mini_batch_src_global generation:  0.05571556091308594
r_  generation:  0.4878084659576416
local_output_nid generation:  0.033921003341674805
local_in_edges_tensor generation:  0.06159234046936035
mini_batch_src_global generation:  0.08600115776062012
r_  generation:  0.48046088218688965
local_output_nid generation:  0.035494327545166016
local_in_edges_tensor generation:  0.03916120529174805
mini_batch_src_global generation:  0.05442953109741211
r_  generation:  0.4879150390625
local_output_nid generation:  0.03410005569458008
local_in_edges_tensor generation:  0.03209042549133301
mini_batch_src_global generation:  0.053168296813964844
r_  generation:  0.4893336296081543
local_output_nid generation:  0.03422999382019043
local_in_edges_tensor generation:  0.038019418716430664
mini_batch_src_global generation:  0.056754112243652344
r_  generation:  0.4854767322540283
local_output_nid generation:  0.03549695014953613
local_in_edges_tensor generation:  0.043677330017089844
mini_batch_src_global generation:  0.053699493408203125
r_  generation:  0.48204708099365234
local_output_nid generation:  0.03451061248779297
local_in_edges_tensor generation:  0.038750648498535156
mini_batch_src_global generation:  0.05712318420410156
r_  generation:  0.478198766708374
local_output_nid generation:  0.03410220146179199
local_in_edges_tensor generation:  0.03057575225830078
mini_batch_src_global generation:  0.05327200889587402
r_  generation:  0.4830801486968994
local_output_nid generation:  0.03451085090637207
local_in_edges_tensor generation:  0.03297567367553711
mini_batch_src_global generation:  0.05461716651916504
r_  generation:  0.5026230812072754
----------------------check_connections_block total spend ----------------------------- 11.775213479995728
generate_one_block  0.6102590560913086
generate_one_block  0.6149754524230957
generate_one_block  0.6021881103515625
generate_one_block  0.5880541801452637
generate_one_block  0.6004908084869385
generate_one_block  0.6001856327056885
generate_one_block  0.5951600074768066
generate_one_block  0.6077821254730225
generate_one_block  0.6277143955230713
generate_one_block  0.5958237648010254
generate_one_block  0.5938212871551514
generate_one_block  0.6032159328460693
generate_one_block  0.5954406261444092
generate_one_block  0.6067883968353271
generate_one_block  0.6036801338195801
generate_one_block  0.5933966636657715
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.1313924789428711  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

connection checking time:  18.243263006210327
block generation total time  15.430826187133789
average batch blocks generation time:  0.9644266366958618
block dataloader generation time/epoch 36.11203074455261
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09424543380737305  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

torch.Size([156786, 128])
torch.Size([129446, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18825340270996094  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09438610076904297  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

torch.Size([157132, 128])
torch.Size([130264, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18893098831176758  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09456062316894531  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

torch.Size([156956, 128])
torch.Size([129968, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18931913375854492  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09439659118652344  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

torch.Size([156666, 128])
torch.Size([129686, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.1892108917236328  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09434986114501953  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

torch.Size([156910, 128])
torch.Size([129882, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18855810165405273  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09452629089355469  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

torch.Size([157024, 128])
torch.Size([130459, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.1893787384033203  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09448957443237305  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

torch.Size([156785, 128])
torch.Size([129846, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.1892848014831543  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09418725967407227  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

torch.Size([156573, 128])
torch.Size([129611, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18840646743774414  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09433221817016602  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

torch.Size([156701, 128])
torch.Size([129604, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18886041641235352  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09446859359741211  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

torch.Size([157017, 128])
torch.Size([129904, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18941211700439453  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09457683563232422  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

torch.Size([156884, 128])
torch.Size([129519, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18961334228515625  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09453916549682617  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

torch.Size([157019, 128])
torch.Size([129797, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18939495086669922  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09440898895263672  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

torch.Size([157034, 128])
torch.Size([130164, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.1889328956604004  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.0944976806640625  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

torch.Size([157032, 128])
torch.Size([130170, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.18934965133666992  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.09452629089355469  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

torch.Size([157064, 128])
torch.Size([130307, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.1894826889038086  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.0944671630859375  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

torch.Size([157106, 128])
torch.Size([129915, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.1889495849609375  GigaBytes
Max Memory Allocated: 0.20346498489379883  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02954787015914917 |0.014842942357063293 |0.003625229001045227 |9.429454803466797e-05 |0.0039542317390441895 |0.0015256404876708984 |
----------------------------------------------------------pseudo_mini_loss sum 4.332293510437012
Total (block generation + training)time/epoch 36.97553777694702
Training time/epoch 0.8632516860961914
Training time without block to device /epoch 0.6257646083831787
Training time without total dataloading part /epoch 0.12430572509765625
load block tensor time/epoch 0.4727659225463867
block to device time/epoch 0.2374870777130127
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5319000
Number of first layer input nodes during this epoch:  2510689
