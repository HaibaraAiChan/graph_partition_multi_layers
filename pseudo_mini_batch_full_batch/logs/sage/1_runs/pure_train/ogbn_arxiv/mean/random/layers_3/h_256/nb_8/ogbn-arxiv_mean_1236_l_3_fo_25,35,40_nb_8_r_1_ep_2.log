Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648443470.8820524
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023340225219726562
random selection method range initialization spend 0.005818367004394531
time for parepare:  0.019264698028564453
local_output_nid generation:  0.004272937774658203
local_in_edges_tensor generation:  0.005095005035400391
mini_batch_src_global generation:  0.0032694339752197266
r_  generation:  0.03819012641906738
local_output_nid generation:  0.0059452056884765625
local_in_edges_tensor generation:  0.003082275390625
mini_batch_src_global generation:  0.004225492477416992
r_  generation:  0.040305137634277344
local_output_nid generation:  0.006087303161621094
local_in_edges_tensor generation:  0.0032372474670410156
mini_batch_src_global generation:  0.0028281211853027344
r_  generation:  0.0394136905670166
local_output_nid generation:  0.006089448928833008
local_in_edges_tensor generation:  0.003173351287841797
mini_batch_src_global generation:  0.0036034584045410156
r_  generation:  0.04010725021362305
local_output_nid generation:  0.006072998046875
local_in_edges_tensor generation:  0.003201007843017578
mini_batch_src_global generation:  0.0030736923217773438
r_  generation:  0.04080915451049805
local_output_nid generation:  0.006025075912475586
local_in_edges_tensor generation:  0.0032427310943603516
mini_batch_src_global generation:  0.003293275833129883
r_  generation:  0.041799068450927734
local_output_nid generation:  0.006124258041381836
local_in_edges_tensor generation:  0.003237485885620117
mini_batch_src_global generation:  0.0033304691314697266
r_  generation:  0.041586875915527344
local_output_nid generation:  0.0060389041900634766
local_in_edges_tensor generation:  0.003152132034301758
mini_batch_src_global generation:  0.0033202171325683594
r_  generation:  0.041269540786743164
----------------------check_connections_block total spend ----------------------------- 0.521040678024292
generate_one_block  0.05459022521972656
generate_one_block  0.05635547637939453
generate_one_block  0.05483436584472656
generate_one_block  0.05473613739013672
generate_one_block  0.058358192443847656
generate_one_block  0.0552983283996582
generate_one_block  0.05496716499328613
generate_one_block  0.054325103759765625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03890681266784668
gen group dst list time:  0.015413999557495117
time for parepare:  0.01906442642211914
local_output_nid generation:  0.013658285140991211
local_in_edges_tensor generation:  0.028795480728149414
mini_batch_src_global generation:  0.02960205078125
r_  generation:  0.29274654388427734
local_output_nid generation:  0.020259857177734375
local_in_edges_tensor generation:  0.028475522994995117
mini_batch_src_global generation:  0.0356447696685791
r_  generation:  0.302401065826416
local_output_nid generation:  0.019988536834716797
local_in_edges_tensor generation:  0.020507097244262695
mini_batch_src_global generation:  0.04559445381164551
r_  generation:  0.3063349723815918
local_output_nid generation:  0.019779443740844727
local_in_edges_tensor generation:  0.017593860626220703
mini_batch_src_global generation:  0.03542590141296387
r_  generation:  0.2992827892303467
local_output_nid generation:  0.02008366584777832
local_in_edges_tensor generation:  0.022496700286865234
mini_batch_src_global generation:  0.03865623474121094
r_  generation:  0.31207799911499023
local_output_nid generation:  0.0199429988861084
local_in_edges_tensor generation:  0.020211219787597656
mini_batch_src_global generation:  0.03742265701293945
r_  generation:  0.3147714138031006
local_output_nid generation:  0.01979660987854004
local_in_edges_tensor generation:  0.017795085906982422
mini_batch_src_global generation:  0.03784584999084473
r_  generation:  0.3124270439147949
local_output_nid generation:  0.01991868019104004
local_in_edges_tensor generation:  0.022578954696655273
mini_batch_src_global generation:  0.03703737258911133
r_  generation:  0.30490946769714355
----------------------check_connections_block total spend ----------------------------- 3.6115684509277344
generate_one_block  0.3979811668395996
generate_one_block  0.4039468765258789
generate_one_block  0.39287281036376953
generate_one_block  0.3866260051727295
generate_one_block  0.396777868270874
generate_one_block  0.4054841995239258
generate_one_block  0.3978757858276367
generate_one_block  0.39183664321899414
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.032088518142700195
gen group dst list time:  0.0358126163482666
time for parepare:  0.018767833709716797
local_output_nid generation:  0.02811288833618164
local_in_edges_tensor generation:  0.04341411590576172
mini_batch_src_global generation:  0.04354500770568848
r_  generation:  0.4733157157897949
local_output_nid generation:  0.03456258773803711
local_in_edges_tensor generation:  0.05161619186401367
mini_batch_src_global generation:  0.05402851104736328
r_  generation:  0.48267483711242676
local_output_nid generation:  0.03493237495422363
local_in_edges_tensor generation:  0.04831886291503906
mini_batch_src_global generation:  0.050813913345336914
r_  generation:  0.49186134338378906
local_output_nid generation:  0.034818172454833984
local_in_edges_tensor generation:  0.03883671760559082
mini_batch_src_global generation:  0.05417442321777344
r_  generation:  0.48795485496520996
local_output_nid generation:  0.03445935249328613
local_in_edges_tensor generation:  0.03914952278137207
mini_batch_src_global generation:  0.05385446548461914
r_  generation:  0.4995574951171875
local_output_nid generation:  0.0356748104095459
local_in_edges_tensor generation:  0.05472970008850098
mini_batch_src_global generation:  0.05541539192199707
r_  generation:  0.49379420280456543
local_output_nid generation:  0.034529924392700195
local_in_edges_tensor generation:  0.030900239944458008
mini_batch_src_global generation:  0.05503439903259277
r_  generation:  0.5028975009918213
local_output_nid generation:  0.03470945358276367
local_in_edges_tensor generation:  0.04261612892150879
mini_batch_src_global generation:  0.05492663383483887
r_  generation:  0.48538684844970703
----------------------check_connections_block total spend ----------------------------- 5.83537745475769
generate_one_block  0.608712911605835
generate_one_block  0.6190826892852783
generate_one_block  0.6141629219055176
generate_one_block  0.6122908592224121
generate_one_block  0.6148746013641357
generate_one_block  0.6137700080871582
generate_one_block  0.6377599239349365
generate_one_block  0.6124746799468994
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  9.446945905685425
block generation total time  8.106529951095581
average batch blocks generation time:  1.0133162438869476
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.09645795822143555  GigaBytes
Max Memory Allocated: 0.09645795822143555  GigaBytes

torch.Size([160549, 128])
torch.Size([141125, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 0.9007797241210938  GigaBytes
Max Memory Allocated: 0.9613490104675293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8319091796875 GB
    Memory Allocated: 0.09975624084472656  GigaBytes
Max Memory Allocated: 1.0298476219177246  GigaBytes

torch.Size([160835, 128])
torch.Size([141726, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3787841796875 GB
    Memory Allocated: 0.910402774810791  GigaBytes
Max Memory Allocated: 1.0298476219177246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.09949827194213867  GigaBytes
Max Memory Allocated: 1.0416359901428223  GigaBytes

torch.Size([160539, 128])
torch.Size([141123, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.9002223014831543  GigaBytes
Max Memory Allocated: 1.0416359901428223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.0995321273803711  GigaBytes
Max Memory Allocated: 1.0416359901428223  GigaBytes

torch.Size([160782, 128])
torch.Size([141540, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.9006929397583008  GigaBytes
Max Memory Allocated: 1.0416359901428223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.09958124160766602  GigaBytes
Max Memory Allocated: 1.0416359901428223  GigaBytes

torch.Size([160567, 128])
torch.Size([141044, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.9009175300598145  GigaBytes
Max Memory Allocated: 1.0416359901428223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.09964179992675781  GigaBytes
Max Memory Allocated: 1.0416359901428223  GigaBytes

torch.Size([160829, 128])
torch.Size([141944, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.906303882598877  GigaBytes
Max Memory Allocated: 1.0416359901428223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.09953165054321289  GigaBytes
Max Memory Allocated: 1.0416359901428223  GigaBytes

torch.Size([160552, 128])
torch.Size([140976, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.9021191596984863  GigaBytes
Max Memory Allocated: 1.0416359901428223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.09954261779785156  GigaBytes
Max Memory Allocated: 1.0416359901428223  GigaBytes

torch.Size([160427, 128])
torch.Size([140847, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.9001579284667969  GigaBytes
Max Memory Allocated: 1.0416359901428223  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0672459602355957 |0.052083373069763184 |0.09849157929420471 |0.00010013580322265625 |0.018875211477279663 |0.0017457008361816406 |
----------------------------------------------------------pseudo_mini_loss sum 6.201321125030518
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2958099
Number of first layer input nodes during this epoch:  1285080
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.1302204132080078  GigaBytes
Max Memory Allocated: 1.0416359901428223  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03478264808654785
random selection method range initialization spend 0.004934549331665039
time for parepare:  0.01736927032470703
local_output_nid generation:  0.0045659542083740234
local_in_edges_tensor generation:  0.007882118225097656
mini_batch_src_global generation:  0.0033445358276367188
r_  generation:  0.03675389289855957
local_output_nid generation:  0.0058629512786865234
local_in_edges_tensor generation:  0.003087282180786133
mini_batch_src_global generation:  0.004223823547363281
r_  generation:  0.03870868682861328
local_output_nid generation:  0.005934715270996094
local_in_edges_tensor generation:  0.003155231475830078
mini_batch_src_global generation:  0.002842426300048828
r_  generation:  0.03966045379638672
local_output_nid generation:  0.0061168670654296875
local_in_edges_tensor generation:  0.0030891895294189453
mini_batch_src_global generation:  0.002915620803833008
r_  generation:  0.039878129959106445
local_output_nid generation:  0.005990266799926758
local_in_edges_tensor generation:  0.003150463104248047
mini_batch_src_global generation:  0.0030782222747802734
r_  generation:  0.04123353958129883
local_output_nid generation:  0.006070375442504883
local_in_edges_tensor generation:  0.003091573715209961
mini_batch_src_global generation:  0.0032968521118164062
r_  generation:  0.0412135124206543
local_output_nid generation:  0.005969047546386719
local_in_edges_tensor generation:  0.0030755996704101562
mini_batch_src_global generation:  0.0033521652221679688
r_  generation:  0.04153895378112793
local_output_nid generation:  0.005988597869873047
local_in_edges_tensor generation:  0.003023386001586914
mini_batch_src_global generation:  0.0032892227172851562
r_  generation:  0.04048800468444824
----------------------check_connections_block total spend ----------------------------- 0.516028642654419
generate_one_block  0.05711984634399414
generate_one_block  0.0544126033782959
generate_one_block  0.054891109466552734
generate_one_block  0.05478811264038086
generate_one_block  0.05547595024108887
generate_one_block  0.0552067756652832
generate_one_block  0.05871272087097168
generate_one_block  0.05466628074645996
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03813028335571289
gen group dst list time:  0.016547441482543945
time for parepare:  0.01925206184387207
local_output_nid generation:  0.01340484619140625
local_in_edges_tensor generation:  0.025984525680541992
mini_batch_src_global generation:  0.0277252197265625
r_  generation:  0.2946321964263916
local_output_nid generation:  0.02196359634399414
local_in_edges_tensor generation:  0.028079748153686523
mini_batch_src_global generation:  0.03591442108154297
r_  generation:  0.3005940914154053
local_output_nid generation:  0.020986318588256836
local_in_edges_tensor generation:  0.021023035049438477
mini_batch_src_global generation:  0.036446332931518555
r_  generation:  0.301591157913208
local_output_nid generation:  0.021321773529052734
local_in_edges_tensor generation:  0.020215749740600586
mini_batch_src_global generation:  0.03604698181152344
r_  generation:  0.3002958297729492
local_output_nid generation:  0.021010398864746094
local_in_edges_tensor generation:  0.022994518280029297
mini_batch_src_global generation:  0.03938603401184082
r_  generation:  0.30608606338500977
local_output_nid generation:  0.02112293243408203
local_in_edges_tensor generation:  0.02308964729309082
mini_batch_src_global generation:  0.037049293518066406
r_  generation:  0.3088083267211914
local_output_nid generation:  0.018891096115112305
local_in_edges_tensor generation:  0.03099656105041504
mini_batch_src_global generation:  0.054114341735839844
r_  generation:  0.3136589527130127
local_output_nid generation:  0.019464969635009766
local_in_edges_tensor generation:  0.02330756187438965
mini_batch_src_global generation:  0.03768587112426758
r_  generation:  0.30239343643188477
----------------------check_connections_block total spend ----------------------------- 3.6415557861328125
generate_one_block  0.39369821548461914
generate_one_block  0.39846158027648926
generate_one_block  0.39391565322875977
generate_one_block  0.38933777809143066
generate_one_block  0.39045095443725586
generate_one_block  0.3905141353607178
generate_one_block  0.41909241676330566
generate_one_block  0.40883564949035645
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.062191009521484375
gen group dst list time:  0.03666281700134277
time for parepare:  0.019060134887695312
local_output_nid generation:  0.028308391571044922
local_in_edges_tensor generation:  0.065032958984375
mini_batch_src_global generation:  0.04469776153564453
r_  generation:  0.46665167808532715
local_output_nid generation:  0.03404116630554199
local_in_edges_tensor generation:  0.04752469062805176
mini_batch_src_global generation:  0.053644418716430664
r_  generation:  0.4728217124938965
local_output_nid generation:  0.0348057746887207
local_in_edges_tensor generation:  0.04392743110656738
mini_batch_src_global generation:  0.05039548873901367
r_  generation:  0.48516273498535156
local_output_nid generation:  0.03417849540710449
local_in_edges_tensor generation:  0.035637855529785156
mini_batch_src_global generation:  0.05426383018493652
r_  generation:  0.48406553268432617
local_output_nid generation:  0.03463435173034668
local_in_edges_tensor generation:  0.031162023544311523
mini_batch_src_global generation:  0.05263018608093262
r_  generation:  0.4934399127960205
local_output_nid generation:  0.034345149993896484
local_in_edges_tensor generation:  0.03197360038757324
mini_batch_src_global generation:  0.05469083786010742
r_  generation:  0.48476743698120117
local_output_nid generation:  0.034358978271484375
local_in_edges_tensor generation:  0.043846845626831055
mini_batch_src_global generation:  0.05336952209472656
r_  generation:  0.49947667121887207
local_output_nid generation:  0.034542083740234375
local_in_edges_tensor generation:  0.03184771537780762
mini_batch_src_global generation:  0.0546872615814209
r_  generation:  0.49005842208862305
----------------------check_connections_block total spend ----------------------------- 5.769352912902832
generate_one_block  0.5994558334350586
generate_one_block  0.6038033962249756
generate_one_block  0.6192774772644043
generate_one_block  0.6068809032440186
generate_one_block  0.5959208011627197
generate_one_block  0.6110994815826416
generate_one_block  0.6208338737487793
generate_one_block  0.6001300811767578
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.1302204132080078  GigaBytes
Max Memory Allocated: 1.0416359901428223  GigaBytes

connection checking time:  9.410908699035645
block generation total time  8.04170823097229
average batch blocks generation time:  1.0052135288715363
block dataloader generation time/epoch 19.408390283584595
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.10161733627319336  GigaBytes
Max Memory Allocated: 1.0416359901428223  GigaBytes

torch.Size([160483, 128])
torch.Size([141282, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.9058032035827637  GigaBytes
Max Memory Allocated: 1.0416359901428223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10122442245483398  GigaBytes
Max Memory Allocated: 1.0416359901428223  GigaBytes

torch.Size([160554, 128])
torch.Size([141013, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9051847457885742  GigaBytes
Max Memory Allocated: 1.0416359901428223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10075139999389648  GigaBytes
Max Memory Allocated: 1.0416359901428223  GigaBytes

torch.Size([160733, 128])
torch.Size([141829, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9075789451599121  GigaBytes
Max Memory Allocated: 1.0416359901428223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10147237777709961  GigaBytes
Max Memory Allocated: 1.0416359901428223  GigaBytes

torch.Size([160560, 128])
torch.Size([141168, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9025444984436035  GigaBytes
Max Memory Allocated: 1.0416359901428223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10132503509521484  GigaBytes
Max Memory Allocated: 1.0416359901428223  GigaBytes

torch.Size([160304, 128])
torch.Size([141161, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9026570320129395  GigaBytes
Max Memory Allocated: 1.0416359901428223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10126018524169922  GigaBytes
Max Memory Allocated: 1.0416359901428223  GigaBytes

torch.Size([160560, 128])
torch.Size([141231, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9038019180297852  GigaBytes
Max Memory Allocated: 1.0416359901428223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10115194320678711  GigaBytes
Max Memory Allocated: 1.0416359901428223  GigaBytes

torch.Size([160350, 128])
torch.Size([141300, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9050312042236328  GigaBytes
Max Memory Allocated: 1.0416359901428223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10119390487670898  GigaBytes
Max Memory Allocated: 1.0416359901428223  GigaBytes

torch.Size([160656, 128])
torch.Size([141216, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9022831916809082  GigaBytes
Max Memory Allocated: 1.0416359901428223  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07421067357063293 |0.012695401906967163 |0.0038528144359588623 |0.00010147690773010254 |0.0033852458000183105 |0.0019474029541015625 |
----------------------------------------------------------pseudo_mini_loss sum 3.2356457710266113
Total (block generation + training)time/epoch 20.233729362487793
Training time/epoch 0.8251259326934814
Training time without block to device /epoch 0.7235627174377441
Training time without total dataloading part /epoch 0.060663700103759766
load block tensor time/epoch 0.5936853885650635
block to device time/epoch 0.1015632152557373
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2958158
Number of first layer input nodes during this epoch:  1284200
