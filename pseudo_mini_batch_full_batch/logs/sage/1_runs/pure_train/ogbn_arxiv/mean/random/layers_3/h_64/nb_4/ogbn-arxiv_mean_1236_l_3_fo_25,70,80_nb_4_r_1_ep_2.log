Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648440346.7209554
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02788066864013672
random selection method range initialization spend 0.006209850311279297
time for parepare:  0.018590450286865234
local_output_nid generation:  0.008315563201904297
local_in_edges_tensor generation:  0.009436845779418945
mini_batch_src_global generation:  0.007359981536865234
r_  generation:  0.09043073654174805
local_output_nid generation:  0.011747121810913086
local_in_edges_tensor generation:  0.005980968475341797
mini_batch_src_global generation:  0.009496450424194336
r_  generation:  0.09519839286804199
local_output_nid generation:  0.011803388595581055
local_in_edges_tensor generation:  0.005988359451293945
mini_batch_src_global generation:  0.007816076278686523
r_  generation:  0.10208010673522949
local_output_nid generation:  0.011810541152954102
local_in_edges_tensor generation:  0.0061032772064208984
mini_batch_src_global generation:  0.008545160293579102
r_  generation:  0.10122108459472656
----------------------check_connections_block total spend ----------------------------- 0.6000430583953857
generate_one_block  0.11562371253967285
generate_one_block  0.11498570442199707
generate_one_block  0.1185140609741211
generate_one_block  0.11520218849182129
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04589128494262695
gen group dst list time:  0.011946916580200195
time for parepare:  0.020271778106689453
local_output_nid generation:  0.021196603775024414
local_in_edges_tensor generation:  0.047069549560546875
mini_batch_src_global generation:  0.045464277267456055
r_  generation:  0.4788856506347656
local_output_nid generation:  0.03089427947998047
local_in_edges_tensor generation:  0.04356861114501953
mini_batch_src_global generation:  0.06796956062316895
r_  generation:  0.4772186279296875
local_output_nid generation:  0.03078174591064453
local_in_edges_tensor generation:  0.03801727294921875
mini_batch_src_global generation:  0.05526852607727051
r_  generation:  0.4892613887786865
local_output_nid generation:  0.03069758415222168
local_in_edges_tensor generation:  0.028173446655273438
mini_batch_src_global generation:  0.05755901336669922
r_  generation:  0.4880549907684326
----------------------check_connections_block total spend ----------------------------- 2.8746256828308105
generate_one_block  0.666964054107666
generate_one_block  0.6402413845062256
generate_one_block  0.6394562721252441
generate_one_block  0.6302947998046875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.033010244369506836
gen group dst list time:  0.021454811096191406
time for parepare:  0.01943063735961914
local_output_nid generation:  0.030364513397216797
local_in_edges_tensor generation:  0.04232215881347656
mini_batch_src_global generation:  0.045174360275268555
r_  generation:  0.5028731822967529
local_output_nid generation:  0.04140329360961914
local_in_edges_tensor generation:  0.05391359329223633
mini_batch_src_global generation:  0.056801557540893555
r_  generation:  0.5009217262268066
local_output_nid generation:  0.04244542121887207
local_in_edges_tensor generation:  0.043360233306884766
mini_batch_src_global generation:  0.05998826026916504
r_  generation:  0.5056173801422119
local_output_nid generation:  0.04180717468261719
local_in_edges_tensor generation:  0.037477731704711914
mini_batch_src_global generation:  0.05603480339050293
r_  generation:  0.5032382011413574
----------------------check_connections_block total spend ----------------------------- 3.048905372619629
generate_one_block  0.659454345703125
generate_one_block  0.6555531024932861
generate_one_block  0.6537203788757324
generate_one_block  0.6384382247924805
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

connection checking time:  5.9235310554504395
block generation total time  5.184122562408447
average batch blocks generation time:  1.2960306406021118
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.1042933464050293  GigaBytes
Max Memory Allocated: 0.1042933464050293  GigaBytes

torch.Size([165503, 128])
torch.Size([157418, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7342529296875 GB
    Memory Allocated: 0.3697338104248047  GigaBytes
Max Memory Allocated: 0.3892650604248047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.10807132720947266  GigaBytes
Max Memory Allocated: 0.41997289657592773  GigaBytes

torch.Size([165589, 128])
torch.Size([157377, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.36997222900390625  GigaBytes
Max Memory Allocated: 0.41997289657592773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.10895681381225586  GigaBytes
Max Memory Allocated: 0.41997289657592773  GigaBytes

torch.Size([165547, 128])
torch.Size([157466, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.369814395904541  GigaBytes
Max Memory Allocated: 0.41997289657592773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.10790729522705078  GigaBytes
Max Memory Allocated: 0.41997814178466797  GigaBytes

torch.Size([165439, 128])
torch.Size([157391, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.36899566650390625  GigaBytes
Max Memory Allocated: 0.41997814178466797  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04141336679458618 |0.09037637710571289 |0.1868886947631836 |0.00011068582534790039 |0.019739091396331787 |0.003709077835083008 |
----------------------------------------------------------pseudo_mini_loss sum 5.278158664703369
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1721491
Number of first layer input nodes during this epoch:  662078
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.16161870956420898  GigaBytes
Max Memory Allocated: 0.41997814178466797  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027347087860107422
random selection method range initialization spend 0.005224704742431641
time for parepare:  0.019435644149780273
local_output_nid generation:  0.008336782455444336
local_in_edges_tensor generation:  0.008919954299926758
mini_batch_src_global generation:  0.007458209991455078
r_  generation:  0.09090256690979004
local_output_nid generation:  0.011657476425170898
local_in_edges_tensor generation:  0.006217479705810547
mini_batch_src_global generation:  0.013489007949829102
r_  generation:  0.09909462928771973
local_output_nid generation:  0.011843681335449219
local_in_edges_tensor generation:  0.00645899772644043
mini_batch_src_global generation:  0.008083343505859375
r_  generation:  0.10587382316589355
local_output_nid generation:  0.012575626373291016
local_in_edges_tensor generation:  0.01625204086303711
mini_batch_src_global generation:  0.01302337646484375
r_  generation:  0.10675168037414551
----------------------check_connections_block total spend ----------------------------- 0.6455264091491699
generate_one_block  0.11479306221008301
generate_one_block  0.1178140640258789
generate_one_block  0.11843156814575195
generate_one_block  0.11815118789672852
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.07091426849365234
gen group dst list time:  0.012465238571166992
time for parepare:  0.021010875701904297
local_output_nid generation:  0.020015716552734375
local_in_edges_tensor generation:  0.06194567680358887
mini_batch_src_global generation:  0.04852795600891113
r_  generation:  0.4668300151824951
local_output_nid generation:  0.026469945907592773
local_in_edges_tensor generation:  0.045500993728637695
mini_batch_src_global generation:  0.05657315254211426
r_  generation:  0.48015499114990234
local_output_nid generation:  0.027022361755371094
local_in_edges_tensor generation:  0.037796974182128906
mini_batch_src_global generation:  0.056284189224243164
r_  generation:  0.4884004592895508
local_output_nid generation:  0.026511192321777344
local_in_edges_tensor generation:  0.03342723846435547
mini_batch_src_global generation:  0.05790352821350098
r_  generation:  0.4869053363800049
----------------------check_connections_block total spend ----------------------------- 2.859251022338867
generate_one_block  0.6217930316925049
generate_one_block  0.6373391151428223
generate_one_block  0.6623454093933105
generate_one_block  0.6333723068237305
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03778243064880371
gen group dst list time:  0.022342681884765625
time for parepare:  0.01878523826599121
local_output_nid generation:  0.029283761978149414
local_in_edges_tensor generation:  0.04119086265563965
mini_batch_src_global generation:  0.04477214813232422
r_  generation:  0.4947946071624756
local_output_nid generation:  0.036997079849243164
local_in_edges_tensor generation:  0.05374717712402344
mini_batch_src_global generation:  0.05701017379760742
r_  generation:  0.5001482963562012
local_output_nid generation:  0.03712296485900879
local_in_edges_tensor generation:  0.04023098945617676
mini_batch_src_global generation:  0.056301116943359375
r_  generation:  0.5054159164428711
local_output_nid generation:  0.037425994873046875
local_in_edges_tensor generation:  0.04521465301513672
mini_batch_src_global generation:  0.056262969970703125
r_  generation:  0.5107288360595703
----------------------check_connections_block total spend ----------------------------- 3.025395393371582
generate_one_block  0.6503040790557861
generate_one_block  0.6466042995452881
generate_one_block  0.639493465423584
generate_one_block  0.6538233757019043
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.16161870956420898  GigaBytes
Max Memory Allocated: 0.41997814178466797  GigaBytes

connection checking time:  5.884646415710449
block generation total time  5.145075082778931
average batch blocks generation time:  1.2862687706947327
block dataloader generation time/epoch 13.062634229660034
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.10853338241577148  GigaBytes
Max Memory Allocated: 0.41997814178466797  GigaBytes

torch.Size([165502, 128])
torch.Size([157374, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.36891794204711914  GigaBytes
Max Memory Allocated: 0.41997814178466797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.10819339752197266  GigaBytes
Max Memory Allocated: 0.41997814178466797  GigaBytes

torch.Size([165519, 128])
torch.Size([157508, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.3700075149536133  GigaBytes
Max Memory Allocated: 0.41997814178466797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.10853099822998047  GigaBytes
Max Memory Allocated: 0.41999149322509766  GigaBytes

torch.Size([165447, 128])
torch.Size([157306, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.36972999572753906  GigaBytes
Max Memory Allocated: 0.41999149322509766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.10816001892089844  GigaBytes
Max Memory Allocated: 0.41999149322509766  GigaBytes

torch.Size([165455, 128])
torch.Size([157463, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.37013816833496094  GigaBytes
Max Memory Allocated: 0.41999149322509766  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.046839118003845215 |0.014510869979858398 |0.004333853721618652 |9.804964065551758e-05 |0.00425034761428833 |0.0017731189727783203 |
----------------------------------------------------------pseudo_mini_loss sum 4.067214012145996
Total (block generation + training)time/epoch 13.374513626098633
Training time/epoch 0.31160593032836914
Training time without block to device /epoch 0.25356245040893555
Training time without total dataloading part /epoch 0.03650212287902832
load block tensor time/epoch 0.18735647201538086
block to device time/epoch 0.058043479919433594
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1721250
Number of first layer input nodes during this epoch:  661923
