Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648491948.3707402
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0001811981201171875  GigaBytes
Max Memory Allocated: 0.0001811981201171875  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.024645328521728516
random selection method range initialization spend 0.0066149234771728516
time for parepare:  0.018545866012573242
local_output_nid generation:  0.008342742919921875
local_in_edges_tensor generation:  0.008770227432250977
mini_batch_src_global generation:  0.006640911102294922
r_  generation:  0.08278346061706543
local_output_nid generation:  0.011652946472167969
local_in_edges_tensor generation:  0.005934715270996094
mini_batch_src_global generation:  0.008946657180786133
r_  generation:  0.08807253837585449
local_output_nid generation:  0.011983394622802734
local_in_edges_tensor generation:  0.006104469299316406
mini_batch_src_global generation:  0.0065762996673583984
r_  generation:  0.08905601501464844
local_output_nid generation:  0.011792898178100586
local_in_edges_tensor generation:  0.006014585494995117
mini_batch_src_global generation:  0.007578611373901367
r_  generation:  0.09181642532348633
----------------------check_connections_block total spend ----------------------------- 0.5530610084533691
generate_one_block  0.10122156143188477
generate_one_block  0.10227060317993164
generate_one_block  0.10211825370788574
generate_one_block  0.1031651496887207
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.03998064994812012
gen group dst list time:  0.011508941650390625
time for parepare:  0.01956629753112793
local_output_nid generation:  0.01963520050048828
local_in_edges_tensor generation:  0.04235529899597168
mini_batch_src_global generation:  0.04197263717651367
r_  generation:  0.3986797332763672
local_output_nid generation:  0.027646541595458984
local_in_edges_tensor generation:  0.041031837463378906
mini_batch_src_global generation:  0.051606178283691406
r_  generation:  0.4180471897125244
local_output_nid generation:  0.027840375900268555
local_in_edges_tensor generation:  0.034014225006103516
mini_batch_src_global generation:  0.04876446723937988
r_  generation:  0.42452478408813477
local_output_nid generation:  0.027768373489379883
local_in_edges_tensor generation:  0.0335698127746582
mini_batch_src_global generation:  0.04956173896789551
r_  generation:  0.42606639862060547
----------------------check_connections_block total spend ----------------------------- 2.5043768882751465
generate_one_block  0.5738260746002197
generate_one_block  0.555147647857666
generate_one_block  0.5493214130401611
generate_one_block  0.554307222366333
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.030809402465820312
gen group dst list time:  0.02089834213256836
time for parepare:  0.019904136657714844
local_output_nid generation:  0.030727863311767578
local_in_edges_tensor generation:  0.056967735290527344
mini_batch_src_global generation:  0.05072379112243652
r_  generation:  0.5405597686767578
local_output_nid generation:  0.0373225212097168
local_in_edges_tensor generation:  0.056476593017578125
mini_batch_src_global generation:  0.0627744197845459
r_  generation:  0.5470008850097656
local_output_nid generation:  0.03733205795288086
local_in_edges_tensor generation:  0.051502227783203125
mini_batch_src_global generation:  0.060973405838012695
r_  generation:  0.5553436279296875
local_output_nid generation:  0.03706550598144531
local_in_edges_tensor generation:  0.0367283821105957
mini_batch_src_global generation:  0.05979657173156738
r_  generation:  0.5522646903991699
----------------------check_connections_block total spend ----------------------------- 3.279696226119995
generate_one_block  0.695643424987793
generate_one_block  0.7005360126495361
generate_one_block  0.7064638137817383
generate_one_block  0.6979765892028809
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029218196868896484
gen group dst list time:  0.02379322052001953
time for parepare:  0.019375324249267578
local_output_nid generation:  0.03368496894836426
local_in_edges_tensor generation:  0.04462242126464844
mini_batch_src_global generation:  0.050698041915893555
r_  generation:  0.5392122268676758
local_output_nid generation:  0.0397946834564209
local_in_edges_tensor generation:  0.036246538162231445
mini_batch_src_global generation:  0.06310653686523438
r_  generation:  0.5486133098602295
local_output_nid generation:  0.03966712951660156
local_in_edges_tensor generation:  0.04633736610412598
mini_batch_src_global generation:  0.06299424171447754
r_  generation:  0.5454239845275879
local_output_nid generation:  0.03953981399536133
local_in_edges_tensor generation:  0.04392647743225098
mini_batch_src_global generation:  0.06177258491516113
r_  generation:  0.5512957572937012
----------------------check_connections_block total spend ----------------------------- 3.2625887393951416
generate_one_block  0.6837291717529297
generate_one_block  0.7095937728881836
generate_one_block  0.7021794319152832
generate_one_block  0.6861345767974854
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02635478973388672
gen group dst list time:  0.02407526969909668
time for parepare:  0.019580602645874023
local_output_nid generation:  0.03437185287475586
local_in_edges_tensor generation:  0.043132781982421875
mini_batch_src_global generation:  0.04674720764160156
r_  generation:  0.5108888149261475
local_output_nid generation:  0.04000115394592285
local_in_edges_tensor generation:  0.048647165298461914
mini_batch_src_global generation:  0.05869603157043457
r_  generation:  0.5135583877563477
local_output_nid generation:  0.03988528251647949
local_in_edges_tensor generation:  0.03895425796508789
mini_batch_src_global generation:  0.05856132507324219
r_  generation:  0.5128588676452637
local_output_nid generation:  0.03993034362792969
local_in_edges_tensor generation:  0.04277300834655762
mini_batch_src_global generation:  0.06193280220031738
r_  generation:  0.5167272090911865
----------------------check_connections_block total spend ----------------------------- 3.105271816253662
generate_one_block  0.6375927925109863
generate_one_block  0.6496355533599854
generate_one_block  0.6466689109802246
generate_one_block  0.6467516422271729
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0001811981201171875  GigaBytes
Max Memory Allocated: 0.0001811981201171875  GigaBytes

connection checking time:  12.151933670043945
block generation total time  10.395508050918579
average batch blocks generation time:  2.5988770127296448
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2205810546875 GB
    Memory Allocated: 0.12936162948608398  GigaBytes
Max Memory Allocated: 0.12936162948608398  GigaBytes

torch.Size([167421, 128])
torch.Size([166836, 64])
torch.Size([164703, 64])
torch.Size([154652, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1405029296875 GB
    Memory Allocated: 0.7465362548828125  GigaBytes
Max Memory Allocated: 0.7654094696044922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4627685546875 GB
    Memory Allocated: 0.13482046127319336  GigaBytes
Max Memory Allocated: 0.7925577163696289  GigaBytes

torch.Size([167463, 128])
torch.Size([166933, 64])
torch.Size([164937, 64])
torch.Size([155087, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4627685546875 GB
    Memory Allocated: 0.7494535446166992  GigaBytes
Max Memory Allocated: 0.7925577163696289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4647216796875 GB
    Memory Allocated: 0.1340780258178711  GigaBytes
Max Memory Allocated: 0.7962722778320312  GigaBytes

torch.Size([167433, 128])
torch.Size([166883, 64])
torch.Size([164856, 64])
torch.Size([155117, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4647216796875 GB
    Memory Allocated: 0.7491841316223145  GigaBytes
Max Memory Allocated: 0.7962722778320312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4647216796875 GB
    Memory Allocated: 0.13430213928222656  GigaBytes
Max Memory Allocated: 0.7962722778320312  GigaBytes

torch.Size([167437, 128])
torch.Size([166863, 64])
torch.Size([164792, 64])
torch.Size([154881, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4647216796875 GB
    Memory Allocated: 0.7486615180969238  GigaBytes
Max Memory Allocated: 0.7962722778320312  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04878741502761841 |0.10194540023803711 |0.1777920126914978 |0.0001131296157836914 |0.04039955139160156 |0.002759695053100586 |
----------------------------------------------------------pseudo_mini_loss sum 5.423884391784668
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3021797
Number of first layer input nodes during this epoch:  669754
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.4647216796875 GB
    Memory Allocated: 0.23889493942260742  GigaBytes
Max Memory Allocated: 0.7962722778320312  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.025064468383789062
random selection method range initialization spend 0.0053250789642333984
time for parepare:  0.01843118667602539
local_output_nid generation:  0.008344650268554688
local_in_edges_tensor generation:  0.008899211883544922
mini_batch_src_global generation:  0.006345272064208984
r_  generation:  0.08050131797790527
local_output_nid generation:  0.013863563537597656
local_in_edges_tensor generation:  0.005755186080932617
mini_batch_src_global generation:  0.008727312088012695
r_  generation:  0.08762669563293457
local_output_nid generation:  0.0142822265625
local_in_edges_tensor generation:  0.005747795104980469
mini_batch_src_global generation:  0.014796972274780273
r_  generation:  0.09092545509338379
local_output_nid generation:  0.014423131942749023
local_in_edges_tensor generation:  0.006207942962646484
mini_batch_src_global generation:  0.012440681457519531
r_  generation:  0.09076738357543945
----------------------check_connections_block total spend ----------------------------- 0.5740575790405273
generate_one_block  0.10453414916992188
generate_one_block  0.10674691200256348
generate_one_block  0.11915326118469238
generate_one_block  0.1054074764251709
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.05633664131164551
gen group dst list time:  0.011086702346801758
time for parepare:  0.022816181182861328
local_output_nid generation:  0.020170927047729492
local_in_edges_tensor generation:  0.06062912940979004
mini_batch_src_global generation:  0.042244672775268555
r_  generation:  0.4082808494567871
local_output_nid generation:  0.025274276733398438
local_in_edges_tensor generation:  0.04222512245178223
mini_batch_src_global generation:  0.04767966270446777
r_  generation:  0.41278862953186035
local_output_nid generation:  0.025018692016601562
local_in_edges_tensor generation:  0.03900289535522461
mini_batch_src_global generation:  0.04785943031311035
r_  generation:  0.4211702346801758
local_output_nid generation:  0.024576902389526367
local_in_edges_tensor generation:  0.0280454158782959
mini_batch_src_global generation:  0.04938244819641113
r_  generation:  0.4219985008239746
----------------------check_connections_block total spend ----------------------------- 2.5106589794158936
generate_one_block  0.5466187000274658
generate_one_block  0.5407202243804932
generate_one_block  0.5709002017974854
generate_one_block  0.5358381271362305
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.05319547653198242
gen group dst list time:  0.0207517147064209
time for parepare:  0.01907205581665039
local_output_nid generation:  0.029215574264526367
local_in_edges_tensor generation:  0.0604252815246582
mini_batch_src_global generation:  0.05464816093444824
r_  generation:  0.5524866580963135
local_output_nid generation:  0.037941932678222656
local_in_edges_tensor generation:  0.06485366821289062
mini_batch_src_global generation:  0.07444190979003906
r_  generation:  0.5583271980285645
local_output_nid generation:  0.0422360897064209
local_in_edges_tensor generation:  0.05582094192504883
mini_batch_src_global generation:  0.06351685523986816
r_  generation:  0.5658035278320312
local_output_nid generation:  0.03975319862365723
local_in_edges_tensor generation:  0.03990340232849121
mini_batch_src_global generation:  0.06017303466796875
r_  generation:  0.574958086013794
----------------------check_connections_block total spend ----------------------------- 3.4012627601623535
generate_one_block  0.7174515724182129
generate_one_block  0.7102024555206299
generate_one_block  0.7123456001281738
generate_one_block  0.6999824047088623
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.07195329666137695
gen group dst list time:  0.026111125946044922
time for parepare:  0.01899433135986328
local_output_nid generation:  0.03400373458862305
local_in_edges_tensor generation:  0.06209588050842285
mini_batch_src_global generation:  0.05060529708862305
r_  generation:  0.5606403350830078
local_output_nid generation:  0.042176246643066406
local_in_edges_tensor generation:  0.057909488677978516
mini_batch_src_global generation:  0.06349301338195801
r_  generation:  0.5448405742645264
local_output_nid generation:  0.039489030838012695
local_in_edges_tensor generation:  0.04695630073547363
mini_batch_src_global generation:  0.06347513198852539
r_  generation:  0.5488810539245605
local_output_nid generation:  0.03935408592224121
local_in_edges_tensor generation:  0.05452466011047363
mini_batch_src_global generation:  0.06377482414245605
r_  generation:  0.5446479320526123
----------------------check_connections_block total spend ----------------------------- 3.3483121395111084
generate_one_block  0.6917343139648438
generate_one_block  0.6804373264312744
generate_one_block  0.6975035667419434
generate_one_block  0.7055211067199707
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03955841064453125
gen group dst list time:  0.024491310119628906
time for parepare:  0.019775867462158203
local_output_nid generation:  0.03362321853637695
local_in_edges_tensor generation:  0.05785703659057617
mini_batch_src_global generation:  0.04726982116699219
r_  generation:  0.5081949234008789
local_output_nid generation:  0.03924894332885742
local_in_edges_tensor generation:  0.05470418930053711
mini_batch_src_global generation:  0.058725833892822266
r_  generation:  0.511676549911499
local_output_nid generation:  0.039502859115600586
local_in_edges_tensor generation:  0.047280311584472656
mini_batch_src_global generation:  0.059371232986450195
r_  generation:  0.5158777236938477
local_output_nid generation:  0.04067230224609375
local_in_edges_tensor generation:  0.048650264739990234
mini_batch_src_global generation:  0.0626828670501709
r_  generation:  0.5155131816864014
----------------------check_connections_block total spend ----------------------------- 3.1478183269500732
generate_one_block  0.6545186042785645
generate_one_block  0.6514401435852051
generate_one_block  0.6443302631378174
generate_one_block  0.6487908363342285
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.4647216796875 GB
    Memory Allocated: 0.23889493942260742  GigaBytes
Max Memory Allocated: 0.7962722778320312  GigaBytes

connection checking time:  12.408052206039429
block generation total time  10.408335447311401
average batch blocks generation time:  2.6020838618278503
block dataloader generation time/epoch 25.216421842575073
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4647216796875 GB
    Memory Allocated: 0.13439607620239258  GigaBytes
Max Memory Allocated: 0.7962722778320312  GigaBytes

torch.Size([167443, 128])
torch.Size([166897, 64])
torch.Size([164860, 64])
torch.Size([155127, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4647216796875 GB
    Memory Allocated: 0.749053955078125  GigaBytes
Max Memory Allocated: 0.7962722778320312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4647216796875 GB
    Memory Allocated: 0.13457059860229492  GigaBytes
Max Memory Allocated: 0.7962722778320312  GigaBytes

torch.Size([167414, 128])
torch.Size([166883, 64])
torch.Size([164851, 64])
torch.Size([155225, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4647216796875 GB
    Memory Allocated: 0.7488398551940918  GigaBytes
Max Memory Allocated: 0.7962722778320312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4647216796875 GB
    Memory Allocated: 0.13448715209960938  GigaBytes
Max Memory Allocated: 0.7962722778320312  GigaBytes

torch.Size([167404, 128])
torch.Size([166874, 64])
torch.Size([164986, 64])
torch.Size([155414, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4647216796875 GB
    Memory Allocated: 0.749910831451416  GigaBytes
Max Memory Allocated: 0.7962722778320312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4647216796875 GB
    Memory Allocated: 0.13632583618164062  GigaBytes
Max Memory Allocated: 0.7969989776611328  GigaBytes

torch.Size([167458, 128])
torch.Size([166905, 64])
torch.Size([164832, 64])
torch.Size([154934, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4647216796875 GB
    Memory Allocated: 0.7503194808959961  GigaBytes
Max Memory Allocated: 0.7969989776611328  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07644504308700562 |0.04661393165588379 |0.0057662129402160645 |9.530782699584961e-05 |0.006502866744995117 |0.002425670623779297 |
----------------------------------------------------------pseudo_mini_loss sum 4.409544944763184
Total (block generation + training)time/epoch 25.819841861724854
Training time/epoch 0.6031482219696045
Training time without block to device /epoch 0.41669249534606934
Training time without total dataloading part /epoch 0.05188322067260742
load block tensor time/epoch 0.30578017234802246
block to device time/epoch 0.18645572662353516
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3023440
Number of first layer input nodes during this epoch:  669719
