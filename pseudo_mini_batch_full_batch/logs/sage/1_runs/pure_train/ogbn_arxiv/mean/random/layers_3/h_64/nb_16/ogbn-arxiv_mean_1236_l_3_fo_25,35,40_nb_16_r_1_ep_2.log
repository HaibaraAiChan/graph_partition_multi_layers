Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648439489.667246
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024550676345825195
random selection method range initialization spend 0.006340503692626953
time for parepare:  0.018403291702270508
local_output_nid generation:  0.0021283626556396484
local_in_edges_tensor generation:  0.004694461822509766
mini_batch_src_global generation:  0.0017805099487304688
r_  generation:  0.017737150192260742
local_output_nid generation:  0.0025565624237060547
local_in_edges_tensor generation:  0.0016682147979736328
mini_batch_src_global generation:  0.002283811569213867
r_  generation:  0.01738882064819336
local_output_nid generation:  0.002740144729614258
local_in_edges_tensor generation:  0.0016317367553710938
mini_batch_src_global generation:  0.0013382434844970703
r_  generation:  0.017270326614379883
local_output_nid generation:  0.0028150081634521484
local_in_edges_tensor generation:  0.0015149116516113281
mini_batch_src_global generation:  0.0013544559478759766
r_  generation:  0.017472267150878906
local_output_nid generation:  0.002769947052001953
local_in_edges_tensor generation:  0.001535177230834961
mini_batch_src_global generation:  0.0013494491577148438
r_  generation:  0.017560958862304688
local_output_nid generation:  0.002827882766723633
local_in_edges_tensor generation:  0.0014827251434326172
mini_batch_src_global generation:  0.0013196468353271484
r_  generation:  0.018238544464111328
local_output_nid generation:  0.0027756690979003906
local_in_edges_tensor generation:  0.0014638900756835938
mini_batch_src_global generation:  0.0014286041259765625
r_  generation:  0.017885446548461914
local_output_nid generation:  0.0027887821197509766
local_in_edges_tensor generation:  0.0014545917510986328
mini_batch_src_global generation:  0.0014495849609375
r_  generation:  0.018774986267089844
local_output_nid generation:  0.0028820037841796875
local_in_edges_tensor generation:  0.0014786720275878906
mini_batch_src_global generation:  0.001512289047241211
r_  generation:  0.018821239471435547
local_output_nid generation:  0.0028269290924072266
local_in_edges_tensor generation:  0.0014722347259521484
mini_batch_src_global generation:  0.007693767547607422
r_  generation:  0.018294334411621094
local_output_nid generation:  0.002765655517578125
local_in_edges_tensor generation:  0.0014781951904296875
mini_batch_src_global generation:  0.0015308856964111328
r_  generation:  0.018947839736938477
local_output_nid generation:  0.0029211044311523438
local_in_edges_tensor generation:  0.0014891624450683594
mini_batch_src_global generation:  0.0015130043029785156
r_  generation:  0.018970966339111328
local_output_nid generation:  0.002904176712036133
local_in_edges_tensor generation:  0.0014948844909667969
mini_batch_src_global generation:  0.005910634994506836
r_  generation:  0.018947124481201172
local_output_nid generation:  0.002768993377685547
local_in_edges_tensor generation:  0.0014405250549316406
mini_batch_src_global generation:  0.0014576911926269531
r_  generation:  0.018696069717407227
local_output_nid generation:  0.002852916717529297
local_in_edges_tensor generation:  0.0014643669128417969
mini_batch_src_global generation:  0.0014700889587402344
r_  generation:  0.01873183250427246
local_output_nid generation:  0.0027947425842285156
local_in_edges_tensor generation:  0.0014925003051757812
mini_batch_src_global generation:  0.0015437602996826172
r_  generation:  0.018691539764404297
----------------------check_connections_block total spend ----------------------------- 0.49370503425598145
generate_one_block  0.027276039123535156
generate_one_block  0.02777242660522461
generate_one_block  0.0310819149017334
generate_one_block  0.029293298721313477
generate_one_block  0.02861642837524414
generate_one_block  0.02794170379638672
generate_one_block  0.02761363983154297
generate_one_block  0.02822566032409668
generate_one_block  0.028266429901123047
generate_one_block  0.027466297149658203
generate_one_block  0.028170347213745117
generate_one_block  0.027538776397705078
generate_one_block  0.027571916580200195
generate_one_block  0.026847124099731445
generate_one_block  0.027378320693969727
generate_one_block  0.027384281158447266
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04104113578796387
gen group dst list time:  0.018579959869384766
time for parepare:  0.018642902374267578
local_output_nid generation:  0.008086919784545898
local_in_edges_tensor generation:  0.017789363861083984
mini_batch_src_global generation:  0.01860332489013672
r_  generation:  0.19318032264709473
local_output_nid generation:  0.01214742660522461
local_in_edges_tensor generation:  0.01983356475830078
mini_batch_src_global generation:  0.023624897003173828
r_  generation:  0.19716978073120117
local_output_nid generation:  0.011741399765014648
local_in_edges_tensor generation:  0.016095876693725586
mini_batch_src_global generation:  0.0229339599609375
r_  generation:  0.20103955268859863
local_output_nid generation:  0.01172327995300293
local_in_edges_tensor generation:  0.01568603515625
mini_batch_src_global generation:  0.02424764633178711
r_  generation:  0.20516061782836914
local_output_nid generation:  0.011601686477661133
local_in_edges_tensor generation:  0.012599468231201172
mini_batch_src_global generation:  0.02474832534790039
r_  generation:  0.20237398147583008
local_output_nid generation:  0.011643171310424805
local_in_edges_tensor generation:  0.015343666076660156
mini_batch_src_global generation:  0.02508997917175293
r_  generation:  0.20347929000854492
local_output_nid generation:  0.0118408203125
local_in_edges_tensor generation:  0.014084100723266602
mini_batch_src_global generation:  0.025557279586791992
r_  generation:  0.2076249122619629
local_output_nid generation:  0.01199030876159668
local_in_edges_tensor generation:  0.016356945037841797
mini_batch_src_global generation:  0.025893449783325195
r_  generation:  0.21150660514831543
local_output_nid generation:  0.01192617416381836
local_in_edges_tensor generation:  0.014044761657714844
mini_batch_src_global generation:  0.026609420776367188
r_  generation:  0.21492648124694824
local_output_nid generation:  0.01177215576171875
local_in_edges_tensor generation:  0.014075279235839844
mini_batch_src_global generation:  0.026223421096801758
r_  generation:  0.20708012580871582
local_output_nid generation:  0.011887550354003906
local_in_edges_tensor generation:  0.014593362808227539
mini_batch_src_global generation:  0.02799057960510254
r_  generation:  0.21490812301635742
local_output_nid generation:  0.011826515197753906
local_in_edges_tensor generation:  0.01216578483581543
mini_batch_src_global generation:  0.026026010513305664
r_  generation:  0.20946598052978516
local_output_nid generation:  0.011859893798828125
local_in_edges_tensor generation:  0.01442575454711914
mini_batch_src_global generation:  0.026044368743896484
r_  generation:  0.21082758903503418
local_output_nid generation:  0.0117340087890625
local_in_edges_tensor generation:  0.016031503677368164
mini_batch_src_global generation:  0.02584099769592285
r_  generation:  0.2051255702972412
local_output_nid generation:  0.01174783706665039
local_in_edges_tensor generation:  0.014336585998535156
mini_batch_src_global generation:  0.025920867919921875
r_  generation:  0.21097159385681152
local_output_nid generation:  0.011743783950805664
local_in_edges_tensor generation:  0.01715230941772461
mini_batch_src_global generation:  0.026350021362304688
r_  generation:  0.20738005638122559
----------------------check_connections_block total spend ----------------------------- 4.881364822387695
generate_one_block  0.2723422050476074
generate_one_block  0.26888585090637207
generate_one_block  0.26671743392944336
generate_one_block  0.27509045600891113
generate_one_block  0.27489161491394043
generate_one_block  0.2656254768371582
generate_one_block  0.2723233699798584
generate_one_block  0.2733001708984375
generate_one_block  0.27207303047180176
generate_one_block  0.26699113845825195
generate_one_block  0.2747383117675781
generate_one_block  0.2672159671783447
generate_one_block  0.2706599235534668
generate_one_block  0.26722049713134766
generate_one_block  0.27577662467956543
generate_one_block  0.26706504821777344
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.037131309509277344
gen group dst list time:  0.05861711502075195
time for parepare:  0.01871657371520996
local_output_nid generation:  0.025006532669067383
local_in_edges_tensor generation:  0.039859771728515625
mini_batch_src_global generation:  0.0416417121887207
r_  generation:  0.43649840354919434
local_output_nid generation:  0.03126406669616699
local_in_edges_tensor generation:  0.04787158966064453
mini_batch_src_global generation:  0.050554513931274414
r_  generation:  0.4446136951446533
local_output_nid generation:  0.03048419952392578
local_in_edges_tensor generation:  0.0477602481842041
mini_batch_src_global generation:  0.0503542423248291
r_  generation:  0.44828104972839355
local_output_nid generation:  0.0305938720703125
local_in_edges_tensor generation:  0.04434943199157715
mini_batch_src_global generation:  0.05135631561279297
r_  generation:  0.4522678852081299
local_output_nid generation:  0.030138254165649414
local_in_edges_tensor generation:  0.03304648399353027
mini_batch_src_global generation:  0.05097341537475586
r_  generation:  0.4557228088378906
local_output_nid generation:  0.030187368392944336
local_in_edges_tensor generation:  0.03239703178405762
mini_batch_src_global generation:  0.05188798904418945
r_  generation:  0.449815034866333
local_output_nid generation:  0.03063654899597168
local_in_edges_tensor generation:  0.03190016746520996
mini_batch_src_global generation:  0.05087447166442871
r_  generation:  0.46152591705322266
local_output_nid generation:  0.030284404754638672
local_in_edges_tensor generation:  0.03675484657287598
mini_batch_src_global generation:  0.0529627799987793
r_  generation:  0.45975422859191895
local_output_nid generation:  0.030481338500976562
local_in_edges_tensor generation:  0.04020380973815918
mini_batch_src_global generation:  0.05173683166503906
r_  generation:  0.46080589294433594
local_output_nid generation:  0.030491113662719727
local_in_edges_tensor generation:  0.0335233211517334
mini_batch_src_global generation:  0.05248069763183594
r_  generation:  0.4619109630584717
local_output_nid generation:  0.03028130531311035
local_in_edges_tensor generation:  0.03594040870666504
mini_batch_src_global generation:  0.0520930290222168
r_  generation:  0.4685249328613281
local_output_nid generation:  0.03206634521484375
local_in_edges_tensor generation:  0.03673291206359863
mini_batch_src_global generation:  0.054811716079711914
r_  generation:  0.4582540988922119
local_output_nid generation:  0.030440568923950195
local_in_edges_tensor generation:  0.03643465042114258
mini_batch_src_global generation:  0.05180859565734863
r_  generation:  0.4613943099975586
local_output_nid generation:  0.030290842056274414
local_in_edges_tensor generation:  0.03214454650878906
mini_batch_src_global generation:  0.052556753158569336
r_  generation:  0.45830655097961426
local_output_nid generation:  0.030889034271240234
local_in_edges_tensor generation:  0.04527997970581055
mini_batch_src_global generation:  0.05446434020996094
r_  generation:  0.463778018951416
local_output_nid generation:  0.03092479705810547
local_in_edges_tensor generation:  0.04013395309448242
mini_batch_src_global generation:  0.05310630798339844
r_  generation:  0.4580347537994385
----------------------check_connections_block total spend ----------------------------- 10.802104473114014
generate_one_block  0.5786542892456055
generate_one_block  0.58380126953125
generate_one_block  0.582911491394043
generate_one_block  0.5842747688293457
generate_one_block  0.5775487422943115
generate_one_block  0.5812277793884277
generate_one_block  0.6212191581726074
generate_one_block  0.5943253040313721
generate_one_block  0.5845308303833008
generate_one_block  0.5712909698486328
generate_one_block  0.5961956977844238
generate_one_block  0.5795462131500244
generate_one_block  0.5815248489379883
generate_one_block  0.5657732486724854
generate_one_block  0.5883316993713379
generate_one_block  0.5663962364196777
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

connection checking time:  15.683469295501709
block generation total time  13.668469667434692
average batch blocks generation time:  0.8542793542146683
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.08994245529174805  GigaBytes
Max Memory Allocated: 0.08994245529174805  GigaBytes

torch.Size([154276, 128])
torch.Size([121803, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5780029296875 GB
    Memory Allocated: 0.2461075782775879  GigaBytes
Max Memory Allocated: 0.2538423538208008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.09089374542236328  GigaBytes
Max Memory Allocated: 0.2675051689147949  GigaBytes

torch.Size([154649, 128])
torch.Size([122979, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7733154296875 GB
    Memory Allocated: 0.24658441543579102  GigaBytes
Max Memory Allocated: 0.2675051689147949  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09084796905517578  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

torch.Size([154147, 128])
torch.Size([121943, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.2454547882080078  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09101009368896484  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

torch.Size([154607, 128])
torch.Size([123116, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24669551849365234  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09074211120605469  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

torch.Size([154431, 128])
torch.Size([121967, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24489498138427734  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09076881408691406  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

torch.Size([154463, 128])
torch.Size([121876, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24495172500610352  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09083843231201172  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

torch.Size([154583, 128])
torch.Size([122564, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24555397033691406  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.090972900390625  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

torch.Size([154526, 128])
torch.Size([122801, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24625730514526367  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09098529815673828  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

torch.Size([154623, 128])
torch.Size([123030, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24689054489135742  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09084033966064453  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

torch.Size([154704, 128])
torch.Size([122392, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.2453293800354004  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09104728698730469  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

torch.Size([154752, 128])
torch.Size([123436, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24764537811279297  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09086322784423828  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

torch.Size([154647, 128])
torch.Size([122791, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.2456512451171875  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09089374542236328  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

torch.Size([154422, 128])
torch.Size([122351, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24578428268432617  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09072399139404297  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

torch.Size([154393, 128])
torch.Size([122118, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24475955963134766  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09086799621582031  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

torch.Size([154670, 128])
torch.Size([122381, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24549245834350586  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.0907888412475586  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

torch.Size([154441, 128])
torch.Size([122007, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24515104293823242  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03410744667053223 |0.03344513475894928 |0.05012714862823486 |9.694695472717285e-05 |0.007637470960617065 |0.0016179084777832031 |
----------------------------------------------------------pseudo_mini_loss sum 5.306926727294922
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5093867
Number of first layer input nodes during this epoch:  2472334
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.12372970581054688  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024378538131713867
random selection method range initialization spend 0.005337715148925781
time for parepare:  0.01705169677734375
local_output_nid generation:  0.0023696422576904297
local_in_edges_tensor generation:  0.0071523189544677734
mini_batch_src_global generation:  0.0017805099487304688
r_  generation:  0.017859458923339844
local_output_nid generation:  0.0029397010803222656
local_in_edges_tensor generation:  0.0016541481018066406
mini_batch_src_global generation:  0.002089977264404297
r_  generation:  0.017809152603149414
local_output_nid generation:  0.0029053688049316406
local_in_edges_tensor generation:  0.0015790462493896484
mini_batch_src_global generation:  0.0013928413391113281
r_  generation:  0.018433094024658203
local_output_nid generation:  0.002897024154663086
local_in_edges_tensor generation:  0.0015864372253417969
mini_batch_src_global generation:  0.0014081001281738281
r_  generation:  0.018393278121948242
local_output_nid generation:  0.0028839111328125
local_in_edges_tensor generation:  0.0015301704406738281
mini_batch_src_global generation:  0.0013937950134277344
r_  generation:  0.018867015838623047
local_output_nid generation:  0.0028994083404541016
local_in_edges_tensor generation:  0.0014820098876953125
mini_batch_src_global generation:  0.0015053749084472656
r_  generation:  0.019799232482910156
local_output_nid generation:  0.002867460250854492
local_in_edges_tensor generation:  0.0015246868133544922
mini_batch_src_global generation:  0.0015666484832763672
r_  generation:  0.019396305084228516
local_output_nid generation:  0.002882719039916992
local_in_edges_tensor generation:  0.0015406608581542969
mini_batch_src_global generation:  0.0014891624450683594
r_  generation:  0.018772602081298828
local_output_nid generation:  0.0030045509338378906
local_in_edges_tensor generation:  0.001596212387084961
mini_batch_src_global generation:  0.0015330314636230469
r_  generation:  0.019937992095947266
local_output_nid generation:  0.0029754638671875
local_in_edges_tensor generation:  0.0015058517456054688
mini_batch_src_global generation:  0.0015974044799804688
r_  generation:  0.019636154174804688
local_output_nid generation:  0.0030264854431152344
local_in_edges_tensor generation:  0.0015511512756347656
mini_batch_src_global generation:  0.001611471176147461
r_  generation:  0.01963949203491211
local_output_nid generation:  0.002962350845336914
local_in_edges_tensor generation:  0.0016241073608398438
mini_batch_src_global generation:  0.001600027084350586
r_  generation:  0.020317792892456055
local_output_nid generation:  0.0029327869415283203
local_in_edges_tensor generation:  0.0015497207641601562
mini_batch_src_global generation:  0.0015358924865722656
r_  generation:  0.01935100555419922
local_output_nid generation:  0.0029540061950683594
local_in_edges_tensor generation:  0.0015225410461425781
mini_batch_src_global generation:  0.0015556812286376953
r_  generation:  0.01923513412475586
local_output_nid generation:  0.0029315948486328125
local_in_edges_tensor generation:  0.0015115737915039062
mini_batch_src_global generation:  0.0015802383422851562
r_  generation:  0.01959824562072754
local_output_nid generation:  0.0029366016387939453
local_in_edges_tensor generation:  0.0015294551849365234
mini_batch_src_global generation:  0.0016171932220458984
r_  generation:  0.020182132720947266
----------------------check_connections_block total spend ----------------------------- 0.5059158802032471
generate_one_block  0.03179621696472168
generate_one_block  0.027386903762817383
generate_one_block  0.027883529663085938
generate_one_block  0.02728104591369629
generate_one_block  0.02733135223388672
generate_one_block  0.03129696846008301
generate_one_block  0.028427600860595703
generate_one_block  0.02724289894104004
generate_one_block  0.028338909149169922
generate_one_block  0.028217554092407227
generate_one_block  0.028181791305541992
generate_one_block  0.02850818634033203
generate_one_block  0.02738046646118164
generate_one_block  0.027625322341918945
generate_one_block  0.028406143188476562
generate_one_block  0.029286861419677734
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.034980058670043945
gen group dst list time:  0.01732015609741211
time for parepare:  0.019185304641723633
local_output_nid generation:  0.008240461349487305
local_in_edges_tensor generation:  0.021158933639526367
mini_batch_src_global generation:  0.019675254821777344
r_  generation:  0.19536209106445312
local_output_nid generation:  0.011806964874267578
local_in_edges_tensor generation:  0.019179582595825195
mini_batch_src_global generation:  0.023653745651245117
r_  generation:  0.19279742240905762
local_output_nid generation:  0.012375831604003906
local_in_edges_tensor generation:  0.013976812362670898
mini_batch_src_global generation:  0.024607181549072266
r_  generation:  0.20324110984802246
local_output_nid generation:  0.012543201446533203
local_in_edges_tensor generation:  0.016158342361450195
mini_batch_src_global generation:  0.024130821228027344
r_  generation:  0.20148277282714844
local_output_nid generation:  0.012116193771362305
local_in_edges_tensor generation:  0.013668537139892578
mini_batch_src_global generation:  0.026541948318481445
r_  generation:  0.20774269104003906
local_output_nid generation:  0.015343189239501953
local_in_edges_tensor generation:  0.014072179794311523
mini_batch_src_global generation:  0.027819156646728516
r_  generation:  0.21779775619506836
local_output_nid generation:  0.012188911437988281
local_in_edges_tensor generation:  0.012535572052001953
mini_batch_src_global generation:  0.026600122451782227
r_  generation:  0.21560406684875488
local_output_nid generation:  0.011968612670898438
local_in_edges_tensor generation:  0.013452768325805664
mini_batch_src_global generation:  0.025961875915527344
r_  generation:  0.2098844051361084
local_output_nid generation:  0.012154579162597656
local_in_edges_tensor generation:  0.015974044799804688
mini_batch_src_global generation:  0.028147220611572266
r_  generation:  0.2182481288909912
local_output_nid generation:  0.012381315231323242
local_in_edges_tensor generation:  0.013765096664428711
mini_batch_src_global generation:  0.026961088180541992
r_  generation:  0.21634554862976074
local_output_nid generation:  0.012131929397583008
local_in_edges_tensor generation:  0.014346837997436523
mini_batch_src_global generation:  0.026729106903076172
r_  generation:  0.21619319915771484
local_output_nid generation:  0.012335538864135742
local_in_edges_tensor generation:  0.014108657836914062
mini_batch_src_global generation:  0.02850961685180664
r_  generation:  0.22043585777282715
local_output_nid generation:  0.012061834335327148
local_in_edges_tensor generation:  0.011834144592285156
mini_batch_src_global generation:  0.02664971351623535
r_  generation:  0.2155013084411621
local_output_nid generation:  0.012120246887207031
local_in_edges_tensor generation:  0.013803720474243164
mini_batch_src_global generation:  0.026139020919799805
r_  generation:  0.21123600006103516
local_output_nid generation:  0.012120962142944336
local_in_edges_tensor generation:  0.01586294174194336
mini_batch_src_global generation:  0.02667522430419922
r_  generation:  0.21776127815246582
local_output_nid generation:  0.012148618698120117
local_in_edges_tensor generation:  0.015644073486328125
mini_batch_src_global generation:  0.02814340591430664
r_  generation:  0.21680641174316406
----------------------check_connections_block total spend ----------------------------- 4.992365837097168
generate_one_block  0.2887537479400635
generate_one_block  0.268552303314209
generate_one_block  0.27102112770080566
generate_one_block  0.2637953758239746
generate_one_block  0.2636110782623291
generate_one_block  0.30112195014953613
generate_one_block  0.31238865852355957
generate_one_block  0.26585984230041504
generate_one_block  0.2734825611114502
generate_one_block  0.2800333499908447
generate_one_block  0.2737874984741211
generate_one_block  0.27612876892089844
generate_one_block  0.27390050888061523
generate_one_block  0.27081894874572754
generate_one_block  0.26952362060546875
generate_one_block  0.276275634765625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05495643615722656
gen group dst list time:  0.06727862358093262
time for parepare:  0.018321514129638672
local_output_nid generation:  0.02620720863342285
local_in_edges_tensor generation:  0.055626869201660156
mini_batch_src_global generation:  0.04217839241027832
r_  generation:  0.43518829345703125
local_output_nid generation:  0.031903982162475586
local_in_edges_tensor generation:  0.0456540584564209
mini_batch_src_global generation:  0.05092883110046387
r_  generation:  0.4550130367279053
local_output_nid generation:  0.031071901321411133
local_in_edges_tensor generation:  0.03760528564453125
mini_batch_src_global generation:  0.049844980239868164
r_  generation:  0.4488053321838379
local_output_nid generation:  0.031082630157470703
local_in_edges_tensor generation:  0.03721261024475098
mini_batch_src_global generation:  0.05088663101196289
r_  generation:  0.4524080753326416
local_output_nid generation:  0.0313112735748291
local_in_edges_tensor generation:  0.0766301155090332
mini_batch_src_global generation:  0.053304433822631836
r_  generation:  0.455305814743042
local_output_nid generation:  0.03116130828857422
local_in_edges_tensor generation:  0.0344538688659668
mini_batch_src_global generation:  0.05165410041809082
r_  generation:  0.4605400562286377
local_output_nid generation:  0.03145432472229004
local_in_edges_tensor generation:  0.033907175064086914
mini_batch_src_global generation:  0.0508885383605957
r_  generation:  0.4641995429992676
local_output_nid generation:  0.0313420295715332
local_in_edges_tensor generation:  0.03438305854797363
mini_batch_src_global generation:  0.05200529098510742
r_  generation:  0.4725642204284668
local_output_nid generation:  0.03142571449279785
local_in_edges_tensor generation:  0.04266023635864258
mini_batch_src_global generation:  0.052536964416503906
r_  generation:  0.46558165550231934
local_output_nid generation:  0.033066511154174805
local_in_edges_tensor generation:  0.03373432159423828
mini_batch_src_global generation:  0.0534055233001709
r_  generation:  0.460726261138916
local_output_nid generation:  0.03126382827758789
local_in_edges_tensor generation:  0.03411698341369629
mini_batch_src_global generation:  0.05759286880493164
r_  generation:  0.46271443367004395
local_output_nid generation:  0.031951904296875
local_in_edges_tensor generation:  0.047385454177856445
mini_batch_src_global generation:  0.05307412147521973
r_  generation:  0.471712589263916
local_output_nid generation:  0.032212257385253906
local_in_edges_tensor generation:  0.04131174087524414
mini_batch_src_global generation:  0.0519106388092041
r_  generation:  0.46865010261535645
local_output_nid generation:  0.03343820571899414
local_in_edges_tensor generation:  0.036847591400146484
mini_batch_src_global generation:  0.05228090286254883
r_  generation:  0.4634358882904053
local_output_nid generation:  0.03227639198303223
local_in_edges_tensor generation:  0.03282618522644043
mini_batch_src_global generation:  0.05231070518493652
r_  generation:  0.4677009582519531
local_output_nid generation:  0.0322415828704834
local_in_edges_tensor generation:  0.042288780212402344
mini_batch_src_global generation:  0.05303311347961426
r_  generation:  0.4581422805786133
----------------------check_connections_block total spend ----------------------------- 10.973768949508667
generate_one_block  0.5796525478363037
generate_one_block  0.5788357257843018
generate_one_block  0.5785369873046875
generate_one_block  0.5700185298919678
generate_one_block  0.5806519985198975
generate_one_block  0.6037163734436035
generate_one_block  0.57771897315979
generate_one_block  0.5765633583068848
generate_one_block  0.6186091899871826
generate_one_block  0.5816860198974609
generate_one_block  0.5784080028533936
generate_one_block  0.5888159275054932
generate_one_block  0.5836446285247803
generate_one_block  0.5666942596435547
generate_one_block  0.5654902458190918
generate_one_block  0.5790705680847168
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.12372970581054688  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

connection checking time:  15.966134786605835
block generation total time  13.737168312072754
average batch blocks generation time:  0.8585730195045471
block dataloader generation time/epoch 31.860268354415894
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09117746353149414  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

torch.Size([154411, 128])
torch.Size([122464, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.2462630271911621  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09082984924316406  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

torch.Size([154461, 128])
torch.Size([122123, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24475717544555664  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.0910482406616211  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

torch.Size([153898, 128])
torch.Size([121503, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24532365798950195  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09091663360595703  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

torch.Size([154380, 128])
torch.Size([121774, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24480104446411133  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09095096588134766  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

torch.Size([154542, 128])
torch.Size([122533, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.2451014518737793  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09126853942871094  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

torch.Size([154357, 128])
torch.Size([122793, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24684476852416992  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09111309051513672  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

torch.Size([154499, 128])
torch.Size([122547, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24615859985351562  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09100341796875  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

torch.Size([154568, 128])
torch.Size([122461, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24506759643554688  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09125041961669922  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

torch.Size([154695, 128])
torch.Size([123208, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24738407135009766  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09117984771728516  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

torch.Size([154536, 128])
torch.Size([122436, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24632692337036133  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09116458892822266  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

torch.Size([154221, 128])
torch.Size([122103, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24594354629516602  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09122753143310547  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

torch.Size([154628, 128])
torch.Size([123039, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24726104736328125  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09107780456542969  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

torch.Size([154515, 128])
torch.Size([122665, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.24560213088989258  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09093570709228516  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

torch.Size([154043, 128])
torch.Size([121500, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.2449793815612793  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09112262725830078  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

torch.Size([154316, 128])
torch.Size([121859, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.2456984519958496  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.09119701385498047  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

torch.Size([154504, 128])
torch.Size([122889, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.2470860481262207  GigaBytes
Max Memory Allocated: 0.26858043670654297  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030831798911094666 |0.012005463242530823 |0.003398582339286804 |8.83936882019043e-05 |0.004604056477546692 |0.0015571117401123047 |
----------------------------------------------------------pseudo_mini_loss sum 4.094028472900391
Total (block generation + training)time/epoch 32.70563888549805
Training time/epoch 0.8451716899871826
Training time without block to device /epoch 0.6530842781066895
Training time without total dataloading part /epoch 0.1310136318206787
load block tensor time/epoch 0.49330878257751465
block to device time/epoch 0.19208741188049316
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5089352
Number of first layer input nodes during this epoch:  2470574
