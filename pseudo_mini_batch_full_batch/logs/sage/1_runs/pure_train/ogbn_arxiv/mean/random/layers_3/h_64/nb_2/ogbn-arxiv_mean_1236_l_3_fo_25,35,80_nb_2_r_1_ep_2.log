Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648439841.9682505
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027050495147705078
random selection method range initialization spend 0.006636857986450195
time for parepare:  0.018807172775268555
local_output_nid generation:  0.0159912109375
local_in_edges_tensor generation:  0.014647722244262695
mini_batch_src_global generation:  0.014970779418945312
r_  generation:  0.18463993072509766
local_output_nid generation:  0.021774768829345703
local_in_edges_tensor generation:  0.016811370849609375
mini_batch_src_global generation:  0.020034074783325195
r_  generation:  0.1980118751525879
----------------------check_connections_block total spend ----------------------------- 0.591914176940918
generate_one_block  0.22336316108703613
generate_one_block  0.2246553897857666
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03979039192199707
gen group dst list time:  0.00804758071899414
time for parepare:  0.01932382583618164
local_output_nid generation:  0.025461435317993164
local_in_edges_tensor generation:  0.05290627479553223
mini_batch_src_global generation:  0.04676675796508789
r_  generation:  0.5003182888031006
local_output_nid generation:  0.03220391273498535
local_in_edges_tensor generation:  0.05135059356689453
mini_batch_src_global generation:  0.057288169860839844
r_  generation:  0.5101375579833984
----------------------check_connections_block total spend ----------------------------- 1.5300157070159912
generate_one_block  0.650172233581543
generate_one_block  0.6530265808105469
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.027547836303710938
gen group dst list time:  0.012403249740600586
time for parepare:  0.01883101463317871
local_output_nid generation:  0.030388593673706055
local_in_edges_tensor generation:  0.04291939735412598
mini_batch_src_global generation:  0.045717716217041016
r_  generation:  0.5076894760131836
local_output_nid generation:  0.037697792053222656
local_in_edges_tensor generation:  0.056749582290649414
mini_batch_src_global generation:  0.05729079246520996
r_  generation:  0.5176119804382324
----------------------check_connections_block total spend ----------------------------- 1.5548806190490723
generate_one_block  0.6736137866973877
generate_one_block  0.6551690101623535
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

connection checking time:  3.0848963260650635
block generation total time  2.631981611251831
average batch blocks generation time:  1.3159908056259155
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2010498046875 GB
    Memory Allocated: 0.1078038215637207  GigaBytes
Max Memory Allocated: 0.1078038215637207  GigaBytes

torch.Size([166711, 128])
torch.Size([163439, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7733154296875 GB
    Memory Allocated: 0.4204702377319336  GigaBytes
Max Memory Allocated: 0.44811487197875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.11454582214355469  GigaBytes
Max Memory Allocated: 0.4831886291503906  GigaBytes

torch.Size([166662, 128])
torch.Size([163370, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.41921091079711914  GigaBytes
Max Memory Allocated: 0.4831886291503906  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.033535122871398926 |0.1546109914779663 |0.3722487688064575 |0.00013875961303710938 |0.021323442459106445 |0.0037920475006103516 |
----------------------------------------------------------pseudo_mini_loss sum 5.225893974304199
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  938505
Number of first layer input nodes during this epoch:  333373
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.17328786849975586  GigaBytes
Max Memory Allocated: 0.4831886291503906  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02282238006591797
random selection method range initialization spend 0.00647425651550293
time for parepare:  0.019681692123413086
local_output_nid generation:  0.01658010482788086
local_in_edges_tensor generation:  0.01879572868347168
mini_batch_src_global generation:  0.014925956726074219
r_  generation:  0.19195556640625
local_output_nid generation:  0.024946928024291992
local_in_edges_tensor generation:  0.016986846923828125
mini_batch_src_global generation:  0.02108454704284668
r_  generation:  0.2142491340637207
----------------------check_connections_block total spend ----------------------------- 0.6341111660003662
generate_one_block  0.24065756797790527
generate_one_block  0.2303907871246338
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.061632633209228516
gen group dst list time:  0.008061408996582031
time for parepare:  0.019489049911499023
local_output_nid generation:  0.026044368743896484
local_in_edges_tensor generation:  0.06566882133483887
mini_batch_src_global generation:  0.04665660858154297
r_  generation:  0.5008885860443115
local_output_nid generation:  0.032617807388305664
local_in_edges_tensor generation:  0.05262303352355957
mini_batch_src_global generation:  0.058196067810058594
r_  generation:  0.5122635364532471
----------------------check_connections_block total spend ----------------------------- 1.5517547130584717
generate_one_block  0.6494283676147461
generate_one_block  0.6781816482543945
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04134106636047363
gen group dst list time:  0.01267385482788086
time for parepare:  0.018932342529296875
local_output_nid generation:  0.030736446380615234
local_in_edges_tensor generation:  0.047673702239990234
mini_batch_src_global generation:  0.046721458435058594
r_  generation:  0.5134634971618652
local_output_nid generation:  0.03770613670349121
local_in_edges_tensor generation:  0.04860210418701172
mini_batch_src_global generation:  0.05779743194580078
r_  generation:  0.5267691612243652
----------------------check_connections_block total spend ----------------------------- 1.577803373336792
generate_one_block  0.6656241416931152
generate_one_block  0.6622402667999268
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.17328786849975586  GigaBytes
Max Memory Allocated: 0.4831886291503906  GigaBytes

connection checking time:  3.1295580863952637
block generation total time  2.6554744243621826
average batch blocks generation time:  1.3277372121810913
block dataloader generation time/epoch 7.750677824020386
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.11542606353759766  GigaBytes
Max Memory Allocated: 0.4831886291503906  GigaBytes

torch.Size([166637, 128])
torch.Size([163305, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.4201231002807617  GigaBytes
Max Memory Allocated: 0.4831886291503906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.11547040939331055  GigaBytes
Max Memory Allocated: 0.48395586013793945  GigaBytes

torch.Size([166712, 128])
torch.Size([163369, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.4207472801208496  GigaBytes
Max Memory Allocated: 0.48395586013793945  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.045839905738830566 |0.02442610263824463 |0.004096031188964844 |0.00010716915130615234 |0.0045680999755859375 |0.003131866455078125 |
----------------------------------------------------------pseudo_mini_loss sum 4.04421329498291
Total (block generation + training)time/epoch 7.947733402252197
Training time/epoch 0.19676971435546875
Training time without block to device /epoch 0.1479175090789795
Training time without total dataloading part /epoch 0.020674467086791992
load block tensor time/epoch 0.09167981147766113
block to device time/epoch 0.04885220527648926
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  938659
Number of first layer input nodes during this epoch:  333349
