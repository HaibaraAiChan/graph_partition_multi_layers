Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648507735.7886088
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 8.249282836914062e-05  GigaBytes
Max Memory Allocated: 8.249282836914062e-05  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.024161577224731445
random selection method range initialization spend 0.006208896636962891
time for parepare:  0.019102811813354492
local_output_nid generation:  0.00829005241394043
local_in_edges_tensor generation:  0.0076253414154052734
mini_batch_src_global generation:  0.006551504135131836
r_  generation:  0.08209562301635742
local_output_nid generation:  0.011712312698364258
local_in_edges_tensor generation:  0.0058629512786865234
mini_batch_src_global generation:  0.008688926696777344
r_  generation:  0.08850550651550293
local_output_nid generation:  0.011788606643676758
local_in_edges_tensor generation:  0.0059125423431396484
mini_batch_src_global generation:  0.006649494171142578
r_  generation:  0.08948516845703125
local_output_nid generation:  0.01186060905456543
local_in_edges_tensor generation:  0.0059397220611572266
mini_batch_src_global generation:  0.0073969364166259766
r_  generation:  0.09251618385314941
----------------------check_connections_block total spend ----------------------------- 0.5521419048309326
generate_one_block  0.1009376049041748
generate_one_block  0.10219430923461914
generate_one_block  0.10236716270446777
generate_one_block  0.10290193557739258
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.03922438621520996
gen group dst list time:  0.011807680130004883
time for parepare:  0.01890277862548828
local_output_nid generation:  0.0191500186920166
local_in_edges_tensor generation:  0.04032254219055176
mini_batch_src_global generation:  0.03880572319030762
r_  generation:  0.4040985107421875
local_output_nid generation:  0.02502298355102539
local_in_edges_tensor generation:  0.03922605514526367
mini_batch_src_global generation:  0.048798561096191406
r_  generation:  0.41309118270874023
local_output_nid generation:  0.025139331817626953
local_in_edges_tensor generation:  0.02891397476196289
mini_batch_src_global generation:  0.05620694160461426
r_  generation:  0.42511796951293945
local_output_nid generation:  0.025089025497436523
local_in_edges_tensor generation:  0.03232717514038086
mini_batch_src_global generation:  0.05228924751281738
r_  generation:  0.42249369621276855
----------------------check_connections_block total spend ----------------------------- 2.4831480979919434
generate_one_block  0.5674946308135986
generate_one_block  0.538182258605957
generate_one_block  0.5378701686859131
generate_one_block  0.5392317771911621
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.03443145751953125
gen group dst list time:  0.02129197120666504
time for parepare:  0.018833160400390625
local_output_nid generation:  0.029803752899169922
local_in_edges_tensor generation:  0.054946184158325195
mini_batch_src_global generation:  0.050444602966308594
r_  generation:  0.5432636737823486
local_output_nid generation:  0.03644895553588867
local_in_edges_tensor generation:  0.05417585372924805
mini_batch_src_global generation:  0.06272649765014648
r_  generation:  0.547248125076294
local_output_nid generation:  0.0361933708190918
local_in_edges_tensor generation:  0.04059886932373047
mini_batch_src_global generation:  0.05797624588012695
r_  generation:  0.5599918365478516
local_output_nid generation:  0.03653144836425781
local_in_edges_tensor generation:  0.03999757766723633
mini_batch_src_global generation:  0.05955004692077637
r_  generation:  0.5595037937164307
----------------------check_connections_block total spend ----------------------------- 3.273545980453491
generate_one_block  0.6875152587890625
generate_one_block  0.7028441429138184
generate_one_block  0.6913189888000488
generate_one_block  0.6940670013427734
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03822684288024902
gen group dst list time:  0.024130821228027344
time for parepare:  0.018619775772094727
local_output_nid generation:  0.0323028564453125
local_in_edges_tensor generation:  0.04763460159301758
mini_batch_src_global generation:  0.05536484718322754
r_  generation:  0.5515997409820557
local_output_nid generation:  0.03928947448730469
local_in_edges_tensor generation:  0.055641889572143555
mini_batch_src_global generation:  0.06399965286254883
r_  generation:  0.5701334476470947
local_output_nid generation:  0.038915157318115234
local_in_edges_tensor generation:  0.0422976016998291
mini_batch_src_global generation:  0.06584644317626953
r_  generation:  0.5724349021911621
local_output_nid generation:  0.04188370704650879
local_in_edges_tensor generation:  0.04124951362609863
mini_batch_src_global generation:  0.06364083290100098
r_  generation:  0.5726447105407715
----------------------check_connections_block total spend ----------------------------- 3.38512921333313
generate_one_block  0.7022645473480225
generate_one_block  0.7332298755645752
generate_one_block  0.7051129341125488
generate_one_block  0.7067685127258301
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.027207374572753906
gen group dst list time:  0.024698495864868164
time for parepare:  0.01890110969543457
local_output_nid generation:  0.032737016677856445
local_in_edges_tensor generation:  0.043274879455566406
mini_batch_src_global generation:  0.04987192153930664
r_  generation:  0.5469143390655518
local_output_nid generation:  0.0404047966003418
local_in_edges_tensor generation:  0.035819292068481445
mini_batch_src_global generation:  0.06331753730773926
r_  generation:  0.5515635013580322
local_output_nid generation:  0.03933238983154297
local_in_edges_tensor generation:  0.03666806221008301
mini_batch_src_global generation:  0.06399941444396973
r_  generation:  0.5548927783966064
local_output_nid generation:  0.039396047592163086
local_in_edges_tensor generation:  0.036797285079956055
mini_batch_src_global generation:  0.06480693817138672
r_  generation:  0.5581390857696533
----------------------check_connections_block total spend ----------------------------- 3.2946956157684326
generate_one_block  0.6838052272796631
generate_one_block  0.7055168151855469
generate_one_block  0.7007327079772949
generate_one_block  0.6899375915527344
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04759955406188965
gen group dst list time:  0.026045799255371094
time for parepare:  0.019195556640625
local_output_nid generation:  0.0383756160736084
local_in_edges_tensor generation:  0.05222368240356445
mini_batch_src_global generation:  0.046105384826660156
r_  generation:  0.5105185508728027
local_output_nid generation:  0.039290428161621094
local_in_edges_tensor generation:  0.04953813552856445
mini_batch_src_global generation:  0.05837297439575195
r_  generation:  0.5108036994934082
local_output_nid generation:  0.039170026779174805
local_in_edges_tensor generation:  0.045423269271850586
mini_batch_src_global generation:  0.05921626091003418
r_  generation:  0.5274467468261719
local_output_nid generation:  0.03915071487426758
local_in_edges_tensor generation:  0.040323734283447266
mini_batch_src_global generation:  0.06505107879638672
r_  generation:  0.5164322853088379
----------------------check_connections_block total spend ----------------------------- 3.1451938152313232
generate_one_block  0.6366307735443115
generate_one_block  0.6874501705169678
generate_one_block  0.6452953815460205
generate_one_block  0.6403274536132812
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 8.249282836914062e-05  GigaBytes
Max Memory Allocated: 8.249282836914062e-05  GigaBytes

connection checking time:  15.58171272277832
block generation total time  13.19559621810913
average batch blocks generation time:  3.2988990545272827
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2401123046875 GB
    Memory Allocated: 0.14229154586791992  GigaBytes
Max Memory Allocated: 0.14229154586791992  GigaBytes

torch.Size([167774, 128])
torch.Size([167542, 32])
torch.Size([166945, 32])
torch.Size([164935, 32])
torch.Size([155171, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9334716796875 GB
    Memory Allocated: 0.5829777717590332  GigaBytes
Max Memory Allocated: 0.5870938301086426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.1488795280456543  GigaBytes
Max Memory Allocated: 0.6029653549194336  GigaBytes

torch.Size([167739, 128])
torch.Size([167497, 32])
torch.Size([166922, 32])
torch.Size([164813, 32])
torch.Size([155069, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.5878758430480957  GigaBytes
Max Memory Allocated: 0.6029653549194336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.1481928825378418  GigaBytes
Max Memory Allocated: 0.6076436042785645  GigaBytes

torch.Size([167721, 128])
torch.Size([167480, 32])
torch.Size([166860, 32])
torch.Size([164785, 32])
torch.Size([155027, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.5859556198120117  GigaBytes
Max Memory Allocated: 0.6076436042785645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.14820480346679688  GigaBytes
Max Memory Allocated: 0.6076436042785645  GigaBytes

torch.Size([167696, 128])
torch.Size([167438, 32])
torch.Size([166829, 32])
torch.Size([164727, 32])
torch.Size([154945, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.5858478546142578  GigaBytes
Max Memory Allocated: 0.6076436042785645  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06912267208099365 |0.1326010823249817 |0.1884094476699829 |0.00012123584747314453 |0.02566850185394287 |0.007373809814453125 |
----------------------------------------------------------pseudo_mini_loss sum 5.281926155090332
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3693781
Number of first layer input nodes during this epoch:  670930
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.2803478240966797  GigaBytes
Max Memory Allocated: 0.6076436042785645  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.017399072647094727
random selection method range initialization spend 0.004992485046386719
time for parepare:  0.01748204231262207
local_output_nid generation:  0.008587121963500977
local_in_edges_tensor generation:  0.012680768966674805
mini_batch_src_global generation:  0.0064618587493896484
r_  generation:  0.0792384147644043
local_output_nid generation:  0.01161336898803711
local_in_edges_tensor generation:  0.009798526763916016
mini_batch_src_global generation:  0.008823633193969727
r_  generation:  0.08685541152954102
local_output_nid generation:  0.011698007583618164
local_in_edges_tensor generation:  0.0058634281158447266
mini_batch_src_global generation:  0.006824016571044922
r_  generation:  0.09160780906677246
local_output_nid generation:  0.011834144592285156
local_in_edges_tensor generation:  0.005730628967285156
mini_batch_src_global generation:  0.007360219955444336
r_  generation:  0.08986210823059082
----------------------check_connections_block total spend ----------------------------- 0.5550253391265869
generate_one_block  0.10910344123840332
generate_one_block  0.10139060020446777
generate_one_block  0.10405349731445312
generate_one_block  0.10188937187194824
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.040145158767700195
gen group dst list time:  0.011086463928222656
time for parepare:  0.01879429817199707
local_output_nid generation:  0.019199132919311523
local_in_edges_tensor generation:  0.0435638427734375
mini_batch_src_global generation:  0.038565635681152344
r_  generation:  0.4066932201385498
local_output_nid generation:  0.02530694007873535
local_in_edges_tensor generation:  0.038511037826538086
mini_batch_src_global generation:  0.04869818687438965
r_  generation:  0.4150512218475342
local_output_nid generation:  0.024451255798339844
local_in_edges_tensor generation:  0.02807021141052246
mini_batch_src_global generation:  0.04883074760437012
r_  generation:  0.4273700714111328
local_output_nid generation:  0.024265050888061523
local_in_edges_tensor generation:  0.02452707290649414
mini_batch_src_global generation:  0.04948592185974121
r_  generation:  0.420825719833374
----------------------check_connections_block total spend ----------------------------- 2.479011058807373
generate_one_block  0.5610263347625732
generate_one_block  0.5574741363525391
generate_one_block  0.5716094970703125
generate_one_block  0.5487167835235596
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04682588577270508
gen group dst list time:  0.021113157272338867
time for parepare:  0.01891493797302246
local_output_nid generation:  0.028479576110839844
local_in_edges_tensor generation:  0.07776713371276855
mini_batch_src_global generation:  0.05438423156738281
r_  generation:  0.5396485328674316
local_output_nid generation:  0.03792095184326172
local_in_edges_tensor generation:  0.054482460021972656
mini_batch_src_global generation:  0.06239819526672363
r_  generation:  0.5420975685119629
local_output_nid generation:  0.035871028900146484
local_in_edges_tensor generation:  0.04306221008300781
mini_batch_src_global generation:  0.06232810020446777
r_  generation:  0.5591340065002441
local_output_nid generation:  0.03727984428405762
local_in_edges_tensor generation:  0.04843783378601074
mini_batch_src_global generation:  0.06026029586791992
r_  generation:  0.5604863166809082
----------------------check_connections_block total spend ----------------------------- 3.3072237968444824
generate_one_block  0.7055747509002686
generate_one_block  0.696324348449707
generate_one_block  0.7032797336578369
generate_one_block  0.6956179141998291
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04770994186401367
gen group dst list time:  0.02785325050354004
time for parepare:  0.0185699462890625
local_output_nid generation:  0.03293585777282715
local_in_edges_tensor generation:  0.05978584289550781
mini_batch_src_global generation:  0.051676273345947266
r_  generation:  0.5485062599182129
local_output_nid generation:  0.038793325424194336
local_in_edges_tensor generation:  0.05551004409790039
mini_batch_src_global generation:  0.0641176700592041
r_  generation:  0.5543243885040283
local_output_nid generation:  0.0384063720703125
local_in_edges_tensor generation:  0.040923118591308594
mini_batch_src_global generation:  0.06868863105773926
r_  generation:  0.5602719783782959
local_output_nid generation:  0.03803062438964844
local_in_edges_tensor generation:  0.04261922836303711
mini_batch_src_global generation:  0.06380343437194824
r_  generation:  0.5662703514099121
----------------------check_connections_block total spend ----------------------------- 3.356632947921753
generate_one_block  0.7168140411376953
generate_one_block  0.7133691310882568
generate_one_block  0.7016074657440186
generate_one_block  0.7428326606750488
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05048871040344238
gen group dst list time:  0.029655933380126953
time for parepare:  0.020004749298095703
local_output_nid generation:  0.03340458869934082
local_in_edges_tensor generation:  0.0646066665649414
mini_batch_src_global generation:  0.05162620544433594
r_  generation:  0.5440006256103516
local_output_nid generation:  0.04117941856384277
local_in_edges_tensor generation:  0.042813777923583984
mini_batch_src_global generation:  0.06362128257751465
r_  generation:  0.5441229343414307
local_output_nid generation:  0.03991341590881348
local_in_edges_tensor generation:  0.0429081916809082
mini_batch_src_global generation:  0.06684708595275879
r_  generation:  0.5523481369018555
local_output_nid generation:  0.03972220420837402
local_in_edges_tensor generation:  0.038147687911987305
mini_batch_src_global generation:  0.06251931190490723
r_  generation:  0.548698902130127
----------------------check_connections_block total spend ----------------------------- 3.3043949604034424
generate_one_block  0.6838369369506836
generate_one_block  0.6948907375335693
generate_one_block  0.6902899742126465
generate_one_block  0.6897990703582764
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.037763118743896484
gen group dst list time:  0.024843931198120117
time for parepare:  0.019150733947753906
local_output_nid generation:  0.03359365463256836
local_in_edges_tensor generation:  0.04478144645690918
mini_batch_src_global generation:  0.0461277961730957
r_  generation:  0.5100083351135254
local_output_nid generation:  0.0404055118560791
local_in_edges_tensor generation:  0.04968380928039551
mini_batch_src_global generation:  0.06010842323303223
r_  generation:  0.5087080001831055
local_output_nid generation:  0.0387723445892334
local_in_edges_tensor generation:  0.04607796669006348
mini_batch_src_global generation:  0.058783531188964844
r_  generation:  0.5091044902801514
local_output_nid generation:  0.039163827896118164
local_in_edges_tensor generation:  0.04571413993835449
mini_batch_src_global generation:  0.058357954025268555
r_  generation:  0.5206315517425537
----------------------check_connections_block total spend ----------------------------- 3.1180741786956787
generate_one_block  0.6380772590637207
generate_one_block  0.6461284160614014
generate_one_block  0.6403419971466064
generate_one_block  0.6696522235870361
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.2803478240966797  GigaBytes
Max Memory Allocated: 0.6076436042785645  GigaBytes

connection checking time:  15.56533694267273
block generation total time  13.267263412475586
average batch blocks generation time:  3.3168158531188965
block dataloader generation time/epoch 31.342049598693848
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.14836454391479492  GigaBytes
Max Memory Allocated: 0.6076436042785645  GigaBytes

torch.Size([167765, 128])
torch.Size([167537, 32])
torch.Size([166948, 32])
torch.Size([164952, 32])
torch.Size([155374, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.5866255760192871  GigaBytes
Max Memory Allocated: 0.6076436042785645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.14830398559570312  GigaBytes
Max Memory Allocated: 0.6076436042785645  GigaBytes

torch.Size([167718, 128])
torch.Size([167479, 32])
torch.Size([166836, 32])
torch.Size([164677, 32])
torch.Size([154744, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.5858850479125977  GigaBytes
Max Memory Allocated: 0.6076436042785645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.14840126037597656  GigaBytes
Max Memory Allocated: 0.6076436042785645  GigaBytes

torch.Size([167771, 128])
torch.Size([167536, 32])
torch.Size([166900, 32])
torch.Size([164817, 32])
torch.Size([155084, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.5863451957702637  GigaBytes
Max Memory Allocated: 0.6076436042785645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1502685546875 GB
    Memory Allocated: 0.1482377052307129  GigaBytes
Max Memory Allocated: 0.6076436042785645  GigaBytes

torch.Size([167761, 128])
torch.Size([167535, 32])
torch.Size([166913, 32])
torch.Size([164742, 32])
torch.Size([154751, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1502685546875 GB
    Memory Allocated: 0.5840888023376465  GigaBytes
Max Memory Allocated: 0.6076436042785645  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07571381330490112 |0.05010581016540527 |0.006706058979034424 |9.870529174804688e-05 |0.008222341537475586 |0.0053403377532958984 |
----------------------------------------------------------pseudo_mini_loss sum 4.7555975914001465
Total (block generation + training)time/epoch 31.969545602798462
Training time/epoch 0.627213716506958
Training time without block to device /epoch 0.4267904758453369
Training time without total dataloading part /epoch 0.06544876098632812
load block tensor time/epoch 0.3028552532196045
block to device time/epoch 0.2004232406616211
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3693096
Number of first layer input nodes during this epoch:  671015
