Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648443411.9581318
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02440476417541504
random selection method range initialization spend 0.006154775619506836
time for parepare:  0.018736839294433594
local_output_nid generation:  0.015982866287231445
local_in_edges_tensor generation:  0.013435602188110352
mini_batch_src_global generation:  0.014364480972290039
r_  generation:  0.17147207260131836
local_output_nid generation:  0.021808385848999023
local_in_edges_tensor generation:  0.01567554473876953
mini_batch_src_global generation:  0.017135143280029297
r_  generation:  0.18449783325195312
----------------------check_connections_block total spend ----------------------------- 0.5525579452514648
generate_one_block  0.20149517059326172
generate_one_block  0.202498197555542
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.038840293884277344
gen group dst list time:  0.007679939270019531
time for parepare:  0.02006816864013672
local_output_nid generation:  0.025075435638427734
local_in_edges_tensor generation:  0.04562115669250488
mini_batch_src_global generation:  0.04912161827087402
r_  generation:  0.49082207679748535
local_output_nid generation:  0.03446650505065918
local_in_edges_tensor generation:  0.050644636154174805
mini_batch_src_global generation:  0.055991411209106445
r_  generation:  0.5169410705566406
----------------------check_connections_block total spend ----------------------------- 1.5297980308532715
generate_one_block  0.6625738143920898
generate_one_block  0.6525900363922119
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04771280288696289
gen group dst list time:  0.014356374740600586
time for parepare:  0.019379138946533203
local_output_nid generation:  0.03025364875793457
local_in_edges_tensor generation:  0.07171988487243652
mini_batch_src_global generation:  0.047472238540649414
r_  generation:  0.5151574611663818
local_output_nid generation:  0.03981280326843262
local_in_edges_tensor generation:  0.05474662780761719
mini_batch_src_global generation:  0.05705571174621582
r_  generation:  0.5271542072296143
----------------------check_connections_block total spend ----------------------------- 1.6037163734436035
generate_one_block  0.6840567588806152
generate_one_block  0.6813061237335205
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  3.133514404296875
block generation total time  2.6805267333984375
average batch blocks generation time:  1.3402633666992188
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2010498046875 GB
    Memory Allocated: 0.10806035995483398  GigaBytes
Max Memory Allocated: 0.10806035995483398  GigaBytes

torch.Size([166437, 128])
torch.Size([162769, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8416748046875 GB
    Memory Allocated: 1.2810344696044922  GigaBytes
Max Memory Allocated: 1.3924188613891602  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3045654296875 GB
    Memory Allocated: 0.11451292037963867  GigaBytes
Max Memory Allocated: 1.5351710319519043  GigaBytes

torch.Size([166426, 128])
torch.Size([162613, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3045654296875 GB
    Memory Allocated: 1.2787413597106934  GigaBytes
Max Memory Allocated: 1.5351710319519043  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06942009925842285 |0.19670915603637695 |0.38902199268341064 |0.0001628398895263672 |0.030263066291809082 |0.002028942108154297 |
----------------------------------------------------------pseudo_mini_loss sum 6.079049587249756
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  927508
Number of first layer input nodes during this epoch:  332863
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.16027212142944336  GigaBytes
Max Memory Allocated: 1.5351710319519043  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019971132278442383
random selection method range initialization spend 0.006119489669799805
time for parepare:  0.019319772720336914
local_output_nid generation:  0.01625657081604004
local_in_edges_tensor generation:  0.01310110092163086
mini_batch_src_global generation:  0.015356302261352539
r_  generation:  0.16987156867980957
local_output_nid generation:  0.02139449119567871
local_in_edges_tensor generation:  0.01507425308227539
mini_batch_src_global generation:  0.017080307006835938
r_  generation:  0.18199563026428223
----------------------check_connections_block total spend ----------------------------- 0.5492653846740723
generate_one_block  0.2116236686706543
generate_one_block  0.2054145336151123
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03309512138366699
gen group dst list time:  0.007676839828491211
time for parepare:  0.02263045310974121
local_output_nid generation:  0.025428295135498047
local_in_edges_tensor generation:  0.05021262168884277
mini_batch_src_global generation:  0.05095338821411133
r_  generation:  0.5174448490142822
local_output_nid generation:  0.035248756408691406
local_in_edges_tensor generation:  0.05527853965759277
mini_batch_src_global generation:  0.05800461769104004
r_  generation:  0.5233480930328369
----------------------check_connections_block total spend ----------------------------- 1.5884945392608643
generate_one_block  0.6909592151641846
generate_one_block  0.646500825881958
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03871321678161621
gen group dst list time:  0.013978719711303711
time for parepare:  0.02086925506591797
local_output_nid generation:  0.03011918067932129
local_in_edges_tensor generation:  0.06228303909301758
mini_batch_src_global generation:  0.04564261436462402
r_  generation:  0.5257737636566162
local_output_nid generation:  0.03747820854187012
local_in_edges_tensor generation:  0.05479168891906738
mini_batch_src_global generation:  0.05689549446105957
r_  generation:  0.5237259864807129
----------------------check_connections_block total spend ----------------------------- 1.5999646186828613
generate_one_block  0.646209716796875
generate_one_block  0.6539628505706787
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.16027212142944336  GigaBytes
Max Memory Allocated: 1.5351710319519043  GigaBytes

connection checking time:  3.1884591579437256
block generation total time  2.6376326084136963
average batch blocks generation time:  1.3188163042068481
block dataloader generation time/epoch 7.616116285324097
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.11686229705810547  GigaBytes
Max Memory Allocated: 1.5351710319519043  GigaBytes

torch.Size([166369, 128])
torch.Size([162620, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 1.2827858924865723  GigaBytes
Max Memory Allocated: 1.5351710319519043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 0.11646413803100586  GigaBytes
Max Memory Allocated: 1.5367932319641113  GigaBytes

torch.Size([166341, 128])
torch.Size([162545, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 1.2803125381469727  GigaBytes
Max Memory Allocated: 1.5367932319641113  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09320712089538574 |0.029135465621948242 |0.0041991472244262695 |0.00011920928955078125 |0.003360152244567871 |0.0029516220092773438 |
----------------------------------------------------------pseudo_mini_loss sum 3.217108726501465
Total (block generation + training)time/epoch 7.9823548793792725
Training time/epoch 0.3659663200378418
Training time without block to device /epoch 0.3076953887939453
Training time without total dataloading part /epoch 0.018308639526367188
load block tensor time/epoch 0.18641424179077148
block to device time/epoch 0.058270931243896484
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  927014
Number of first layer input nodes during this epoch:  332710
