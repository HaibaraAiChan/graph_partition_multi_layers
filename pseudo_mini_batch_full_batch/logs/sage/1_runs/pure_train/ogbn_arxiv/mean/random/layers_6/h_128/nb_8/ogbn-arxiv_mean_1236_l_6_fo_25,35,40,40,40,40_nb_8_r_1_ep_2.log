Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648511162.3463526
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006604194641113281  GigaBytes
Max Memory Allocated: 0.0006604194641113281  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.02454996109008789
random selection method range initialization spend 0.006208896636962891
time for parepare:  0.018697261810302734
local_output_nid generation:  0.004199028015136719
local_in_edges_tensor generation:  0.006490468978881836
mini_batch_src_global generation:  0.0033152103424072266
r_  generation:  0.03756237030029297
local_output_nid generation:  0.005815744400024414
local_in_edges_tensor generation:  0.0030858516693115234
mini_batch_src_global generation:  0.004264116287231445
r_  generation:  0.03931474685668945
local_output_nid generation:  0.006159782409667969
local_in_edges_tensor generation:  0.003051280975341797
mini_batch_src_global generation:  0.0028107166290283203
r_  generation:  0.03919196128845215
local_output_nid generation:  0.005975961685180664
local_in_edges_tensor generation:  0.0030188560485839844
mini_batch_src_global generation:  0.0029299259185791016
r_  generation:  0.039633989334106445
local_output_nid generation:  0.0059986114501953125
local_in_edges_tensor generation:  0.003222942352294922
mini_batch_src_global generation:  0.002989530563354492
r_  generation:  0.04004859924316406
local_output_nid generation:  0.0061168670654296875
local_in_edges_tensor generation:  0.0031270980834960938
mini_batch_src_global generation:  0.0033180713653564453
r_  generation:  0.04184150695800781
local_output_nid generation:  0.006112575531005859
local_in_edges_tensor generation:  0.003098011016845703
mini_batch_src_global generation:  0.0035028457641601562
r_  generation:  0.041214704513549805
local_output_nid generation:  0.006021261215209961
local_in_edges_tensor generation:  0.0031785964965820312
mini_batch_src_global generation:  0.003429412841796875
r_  generation:  0.04141736030578613
----------------------check_connections_block total spend ----------------------------- 0.5177035331726074
generate_one_block  0.054294586181640625
generate_one_block  0.05605888366699219
generate_one_block  0.055442094802856445
generate_one_block  0.054911136627197266
generate_one_block  0.058179616928100586
generate_one_block  0.056009769439697266
generate_one_block  0.05678248405456543
generate_one_block  0.05477428436279297
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.04079079627990723
gen group dst list time:  0.015409708023071289
time for parepare:  0.019472837448120117
local_output_nid generation:  0.013562202453613281
local_in_edges_tensor generation:  0.03298044204711914
mini_batch_src_global generation:  0.028764009475708008
r_  generation:  0.2917323112487793
local_output_nid generation:  0.020686864852905273
local_in_edges_tensor generation:  0.03071904182434082
mini_batch_src_global generation:  0.03709840774536133
r_  generation:  0.30805110931396484
local_output_nid generation:  0.02063727378845215
local_in_edges_tensor generation:  0.024919748306274414
mini_batch_src_global generation:  0.03626251220703125
r_  generation:  0.30757904052734375
local_output_nid generation:  0.02086496353149414
local_in_edges_tensor generation:  0.026836156845092773
mini_batch_src_global generation:  0.037699222564697266
r_  generation:  0.3093900680541992
local_output_nid generation:  0.020439624786376953
local_in_edges_tensor generation:  0.022125244140625
mini_batch_src_global generation:  0.037804603576660156
r_  generation:  0.3128063678741455
local_output_nid generation:  0.02097940444946289
local_in_edges_tensor generation:  0.027948617935180664
mini_batch_src_global generation:  0.039167165756225586
r_  generation:  0.3170146942138672
local_output_nid generation:  0.020696640014648438
local_in_edges_tensor generation:  0.022778034210205078
mini_batch_src_global generation:  0.04139566421508789
r_  generation:  0.320462703704834
local_output_nid generation:  0.020630836486816406
local_in_edges_tensor generation:  0.019896507263183594
mini_batch_src_global generation:  0.03872871398925781
r_  generation:  0.31661176681518555
----------------------check_connections_block total spend ----------------------------- 3.7022883892059326
generate_one_block  0.4061777591705322
generate_one_block  0.41735029220581055
generate_one_block  0.4038715362548828
generate_one_block  0.40377378463745117
generate_one_block  0.40047550201416016
generate_one_block  0.42458605766296387
generate_one_block  0.41652345657348633
generate_one_block  0.3979964256286621
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04045844078063965
gen group dst list time:  0.03588294982910156
time for parepare:  0.0187225341796875
local_output_nid generation:  0.028174400329589844
local_in_edges_tensor generation:  0.044980525970458984
mini_batch_src_global generation:  0.05325436592102051
r_  generation:  0.5180244445800781
local_output_nid generation:  0.03422284126281738
local_in_edges_tensor generation:  0.05505084991455078
mini_batch_src_global generation:  0.060724496841430664
r_  generation:  0.5245382785797119
local_output_nid generation:  0.03454327583312988
local_in_edges_tensor generation:  0.040413856506347656
mini_batch_src_global generation:  0.05827689170837402
r_  generation:  0.5341043472290039
local_output_nid generation:  0.0344691276550293
local_in_edges_tensor generation:  0.04053926467895508
mini_batch_src_global generation:  0.06155848503112793
r_  generation:  0.5325860977172852
local_output_nid generation:  0.034433841705322266
local_in_edges_tensor generation:  0.050005197525024414
mini_batch_src_global generation:  0.05845165252685547
r_  generation:  0.5377371311187744
local_output_nid generation:  0.03457021713256836
local_in_edges_tensor generation:  0.04027438163757324
mini_batch_src_global generation:  0.06432342529296875
r_  generation:  0.5360898971557617
local_output_nid generation:  0.034651756286621094
local_in_edges_tensor generation:  0.045238494873046875
mini_batch_src_global generation:  0.05946493148803711
r_  generation:  0.5421543121337891
local_output_nid generation:  0.034401893615722656
local_in_edges_tensor generation:  0.036923885345458984
mini_batch_src_global generation:  0.06222414970397949
r_  generation:  0.5469768047332764
----------------------check_connections_block total spend ----------------------------- 6.307012557983398
generate_one_block  0.6834406852722168
generate_one_block  0.6855511665344238
generate_one_block  0.66715407371521
generate_one_block  0.6776473522186279
generate_one_block  0.6885888576507568
generate_one_block  0.6820135116577148
generate_one_block  0.7023611068725586
generate_one_block  0.6664750576019287
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.029552698135375977
gen group dst list time:  0.04454493522644043
time for parepare:  0.019545793533325195
local_output_nid generation:  0.03443431854248047
local_in_edges_tensor generation:  0.04646587371826172
mini_batch_src_global generation:  0.054636478424072266
r_  generation:  0.54695725440979
local_output_nid generation:  0.04244828224182129
local_in_edges_tensor generation:  0.057335853576660156
mini_batch_src_global generation:  0.06481146812438965
r_  generation:  0.5499417781829834
local_output_nid generation:  0.04280996322631836
local_in_edges_tensor generation:  0.04292798042297363
mini_batch_src_global generation:  0.06550359725952148
r_  generation:  0.5535328388214111
local_output_nid generation:  0.04355216026306152
local_in_edges_tensor generation:  0.04757523536682129
mini_batch_src_global generation:  0.06093645095825195
r_  generation:  0.5603618621826172
local_output_nid generation:  0.04235720634460449
local_in_edges_tensor generation:  0.047812700271606445
mini_batch_src_global generation:  0.060755014419555664
r_  generation:  0.5593535900115967
local_output_nid generation:  0.04277348518371582
local_in_edges_tensor generation:  0.03728771209716797
mini_batch_src_global generation:  0.061547279357910156
r_  generation:  0.5703561305999756
local_output_nid generation:  0.03982114791870117
local_in_edges_tensor generation:  0.04257798194885254
mini_batch_src_global generation:  0.06241106986999512
r_  generation:  0.5725364685058594
local_output_nid generation:  0.038979530334472656
local_in_edges_tensor generation:  0.0491335391998291
mini_batch_src_global generation:  0.06241583824157715
r_  generation:  0.592747688293457
----------------------check_connections_block total spend ----------------------------- 6.74575138092041
generate_one_block  0.7279386520385742
generate_one_block  0.7119953632354736
generate_one_block  0.7042241096496582
generate_one_block  0.7286984920501709
generate_one_block  0.7158839702606201
generate_one_block  0.6935770511627197
generate_one_block  0.7612433433532715
generate_one_block  0.7000632286071777
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05060935020446777
gen group dst list time:  0.0470881462097168
time for parepare:  0.019190073013305664
local_output_nid generation:  0.03515219688415527
local_in_edges_tensor generation:  0.0708150863647461
mini_batch_src_global generation:  0.05019235610961914
r_  generation:  0.5433051586151123
local_output_nid generation:  0.041129350662231445
local_in_edges_tensor generation:  0.04095816612243652
mini_batch_src_global generation:  0.06368422508239746
r_  generation:  0.5381135940551758
local_output_nid generation:  0.03981637954711914
local_in_edges_tensor generation:  0.04104185104370117
mini_batch_src_global generation:  0.06696534156799316
r_  generation:  0.5451843738555908
local_output_nid generation:  0.040162086486816406
local_in_edges_tensor generation:  0.041535377502441406
mini_batch_src_global generation:  0.06276845932006836
r_  generation:  0.546804666519165
local_output_nid generation:  0.04049491882324219
local_in_edges_tensor generation:  0.05084872245788574
mini_batch_src_global generation:  0.0624692440032959
r_  generation:  0.5466465950012207
local_output_nid generation:  0.04009437561035156
local_in_edges_tensor generation:  0.0368039608001709
mini_batch_src_global generation:  0.0623319149017334
r_  generation:  0.543691873550415
local_output_nid generation:  0.04038596153259277
local_in_edges_tensor generation:  0.036690473556518555
mini_batch_src_global generation:  0.06257033348083496
r_  generation:  0.547229528427124
local_output_nid generation:  0.03972125053405762
local_in_edges_tensor generation:  0.03657793998718262
mini_batch_src_global generation:  0.06147313117980957
r_  generation:  0.5537388324737549
----------------------check_connections_block total spend ----------------------------- 6.571830987930298
generate_one_block  0.6873960494995117
generate_one_block  0.6915831565856934
generate_one_block  0.6955995559692383
generate_one_block  0.7013957500457764
generate_one_block  0.697638750076294
generate_one_block  0.6901280879974365
generate_one_block  0.6902201175689697
generate_one_block  0.735436201095581
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02905559539794922
gen group dst list time:  0.0480494499206543
time for parepare:  0.019209623336791992
local_output_nid generation:  0.035099029541015625
local_in_edges_tensor generation:  0.04484987258911133
mini_batch_src_global generation:  0.04511880874633789
r_  generation:  0.5009574890136719
local_output_nid generation:  0.04137158393859863
local_in_edges_tensor generation:  0.04105257987976074
mini_batch_src_global generation:  0.05860495567321777
r_  generation:  0.5050289630889893
local_output_nid generation:  0.039899349212646484
local_in_edges_tensor generation:  0.0436098575592041
mini_batch_src_global generation:  0.05829453468322754
r_  generation:  0.5051352977752686
local_output_nid generation:  0.039980411529541016
local_in_edges_tensor generation:  0.04445219039916992
mini_batch_src_global generation:  0.05807781219482422
r_  generation:  0.5076816082000732
local_output_nid generation:  0.039897918701171875
local_in_edges_tensor generation:  0.04770088195800781
mini_batch_src_global generation:  0.05872845649719238
r_  generation:  0.5039584636688232
local_output_nid generation:  0.040018320083618164
local_in_edges_tensor generation:  0.03552055358886719
mini_batch_src_global generation:  0.05919313430786133
r_  generation:  0.5102577209472656
local_output_nid generation:  0.040003061294555664
local_in_edges_tensor generation:  0.04376864433288574
mini_batch_src_global generation:  0.05917978286743164
r_  generation:  0.5129384994506836
local_output_nid generation:  0.04027724266052246
local_in_edges_tensor generation:  0.03517484664916992
mini_batch_src_global generation:  0.06225943565368652
r_  generation:  0.5253074169158936
----------------------check_connections_block total spend ----------------------------- 6.170031547546387
generate_one_block  0.6444122791290283
generate_one_block  0.6478579044342041
generate_one_block  0.6442873477935791
generate_one_block  0.649094820022583
generate_one_block  0.6399767398834229
generate_one_block  0.6330561637878418
generate_one_block  0.6687779426574707
generate_one_block  0.6312911510467529
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006604194641113281  GigaBytes
Max Memory Allocated: 0.0006604194641113281  GigaBytes

connection checking time:  29.496914863586426
block generation total time  25.215762853622437
average batch blocks generation time:  3.1519703567028046
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2401123046875 GB
    Memory Allocated: 0.13910818099975586  GigaBytes
Max Memory Allocated: 0.13910818099975586  GigaBytes

torch.Size([167567, 128])
torch.Size([167125, 128])
torch.Size([165864, 128])
torch.Size([161411, 128])
torch.Size([141854, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.6390471458435059  GigaBytes
Max Memory Allocated: 1.66798734664917  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5838623046875 GB
    Memory Allocated: 0.14273405075073242  GigaBytes
Max Memory Allocated: 1.7047920227050781  GigaBytes

torch.Size([167475, 128])
torch.Size([167011, 128])
torch.Size([165729, 128])
torch.Size([161358, 128])
torch.Size([142227, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5838623046875 GB
    Memory Allocated: 1.6422834396362305  GigaBytes
Max Memory Allocated: 1.7047920227050781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 0.14293575286865234  GigaBytes
Max Memory Allocated: 1.7074165344238281  GigaBytes

torch.Size([167540, 128])
torch.Size([167102, 128])
torch.Size([165765, 128])
torch.Size([161344, 128])
torch.Size([141843, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 1.6420397758483887  GigaBytes
Max Memory Allocated: 1.7074165344238281  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 0.1431865692138672  GigaBytes
Max Memory Allocated: 1.7074165344238281  GigaBytes

torch.Size([167547, 128])
torch.Size([167105, 128])
torch.Size([165823, 128])
torch.Size([161445, 128])
torch.Size([142132, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 1.6438112258911133  GigaBytes
Max Memory Allocated: 1.7074165344238281  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 0.14285898208618164  GigaBytes
Max Memory Allocated: 1.7077198028564453  GigaBytes

torch.Size([167531, 128])
torch.Size([167103, 128])
torch.Size([165882, 128])
torch.Size([161528, 128])
torch.Size([142028, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 1.6395764350891113  GigaBytes
Max Memory Allocated: 1.7077198028564453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 0.14333534240722656  GigaBytes
Max Memory Allocated: 1.7077198028564453  GigaBytes

torch.Size([167506, 128])
torch.Size([167077, 128])
torch.Size([165797, 128])
torch.Size([161377, 128])
torch.Size([142084, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 1.6442832946777344  GigaBytes
Max Memory Allocated: 1.7077198028564453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 0.14312314987182617  GigaBytes
Max Memory Allocated: 1.7084918022155762  GigaBytes

torch.Size([167577, 128])
torch.Size([167146, 128])
torch.Size([165793, 128])
torch.Size([161384, 128])
torch.Size([142380, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 1.643913745880127  GigaBytes
Max Memory Allocated: 1.7084918022155762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 0.14315080642700195  GigaBytes
Max Memory Allocated: 1.7091093063354492  GigaBytes

torch.Size([167501, 128])
torch.Size([167058, 128])
torch.Size([165766, 128])
torch.Size([161268, 128])
torch.Size([141539, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 1.639540195465088  GigaBytes
Max Memory Allocated: 1.7091093063354492  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09098696708679199 |0.09607228636741638 |0.09345784783363342 |0.00010964274406433105 |0.030003905296325684 |0.00767207145690918 |
----------------------------------------------------------pseudo_mini_loss sum 6.052942752838135
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6973417
Number of first layer input nodes during this epoch:  1340244
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 0.25713634490966797  GigaBytes
Max Memory Allocated: 1.7091093063354492  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.020555734634399414
random selection method range initialization spend 0.005586862564086914
time for parepare:  0.0165708065032959
local_output_nid generation:  0.004776477813720703
local_in_edges_tensor generation:  0.007030963897705078
mini_batch_src_global generation:  0.0035207271575927734
r_  generation:  0.04010367393493652
local_output_nid generation:  0.005812406539916992
local_in_edges_tensor generation:  0.0032265186309814453
mini_batch_src_global generation:  0.004269123077392578
r_  generation:  0.03896665573120117
local_output_nid generation:  0.006018400192260742
local_in_edges_tensor generation:  0.0034127235412597656
mini_batch_src_global generation:  0.0028905868530273438
r_  generation:  0.0395665168762207
local_output_nid generation:  0.006104946136474609
local_in_edges_tensor generation:  0.0032906532287597656
mini_batch_src_global generation:  0.003034353256225586
r_  generation:  0.04169511795043945
local_output_nid generation:  0.00609898567199707
local_in_edges_tensor generation:  0.0034189224243164062
mini_batch_src_global generation:  0.0031676292419433594
r_  generation:  0.04159855842590332
local_output_nid generation:  0.0060770511627197266
local_in_edges_tensor generation:  0.003303050994873047
mini_batch_src_global generation:  0.003305673599243164
r_  generation:  0.04215836524963379
local_output_nid generation:  0.006089687347412109
local_in_edges_tensor generation:  0.003435850143432617
mini_batch_src_global generation:  0.003452301025390625
r_  generation:  0.04232025146484375
local_output_nid generation:  0.006137847900390625
local_in_edges_tensor generation:  0.0033407211303710938
mini_batch_src_global generation:  0.0033774375915527344
r_  generation:  0.0417783260345459
----------------------check_connections_block total spend ----------------------------- 0.5366344451904297
generate_one_block  0.05566525459289551
generate_one_block  0.05465054512023926
generate_one_block  0.056713104248046875
generate_one_block  0.05503678321838379
generate_one_block  0.060803890228271484
generate_one_block  0.055295467376708984
generate_one_block  0.06043100357055664
generate_one_block  0.06075549125671387
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.05471968650817871
gen group dst list time:  0.015438079833984375
time for parepare:  0.0218808650970459
local_output_nid generation:  0.013551950454711914
local_in_edges_tensor generation:  0.04176044464111328
mini_batch_src_global generation:  0.03129386901855469
r_  generation:  0.3010249137878418
local_output_nid generation:  0.0189666748046875
local_in_edges_tensor generation:  0.03049755096435547
mini_batch_src_global generation:  0.03692054748535156
r_  generation:  0.31618642807006836
local_output_nid generation:  0.018635034561157227
local_in_edges_tensor generation:  0.02544403076171875
mini_batch_src_global generation:  0.03653526306152344
r_  generation:  0.3162531852722168
local_output_nid generation:  0.019265174865722656
local_in_edges_tensor generation:  0.021457672119140625
mini_batch_src_global generation:  0.05008435249328613
r_  generation:  0.3205835819244385
local_output_nid generation:  0.01914048194885254
local_in_edges_tensor generation:  0.025271892547607422
mini_batch_src_global generation:  0.03851437568664551
r_  generation:  0.3240971565246582
local_output_nid generation:  0.017911672592163086
local_in_edges_tensor generation:  0.022107601165771484
mini_batch_src_global generation:  0.038773536682128906
r_  generation:  0.3264343738555908
local_output_nid generation:  0.017953157424926758
local_in_edges_tensor generation:  0.02180767059326172
mini_batch_src_global generation:  0.03869223594665527
r_  generation:  0.3370516300201416
local_output_nid generation:  0.019514083862304688
local_in_edges_tensor generation:  0.03535890579223633
mini_batch_src_global generation:  0.05077004432678223
r_  generation:  0.3229053020477295
----------------------check_connections_block total spend ----------------------------- 3.828101396560669
generate_one_block  0.4226644039154053
generate_one_block  0.4162905216217041
generate_one_block  0.42064428329467773
generate_one_block  0.41942477226257324
generate_one_block  0.4106738567352295
generate_one_block  0.40374255180358887
generate_one_block  0.4159214496612549
generate_one_block  0.4367222785949707
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04632854461669922
gen group dst list time:  0.03880143165588379
time for parepare:  0.019273757934570312
local_output_nid generation:  0.030246973037719727
local_in_edges_tensor generation:  0.06012272834777832
mini_batch_src_global generation:  0.049221038818359375
r_  generation:  0.5412790775299072
local_output_nid generation:  0.037778377532958984
local_in_edges_tensor generation:  0.06091928482055664
mini_batch_src_global generation:  0.06540322303771973
r_  generation:  0.5365777015686035
local_output_nid generation:  0.036748409271240234
local_in_edges_tensor generation:  0.04831576347351074
mini_batch_src_global generation:  0.05833768844604492
r_  generation:  0.5465781688690186
local_output_nid generation:  0.036478519439697266
local_in_edges_tensor generation:  0.04019021987915039
mini_batch_src_global generation:  0.06476259231567383
r_  generation:  0.5410270690917969
local_output_nid generation:  0.03605294227600098
local_in_edges_tensor generation:  0.04054594039916992
mini_batch_src_global generation:  0.05939888954162598
r_  generation:  0.5593488216400146
local_output_nid generation:  0.036373138427734375
local_in_edges_tensor generation:  0.03554725646972656
mini_batch_src_global generation:  0.06231117248535156
r_  generation:  0.538301944732666
local_output_nid generation:  0.03631472587585449
local_in_edges_tensor generation:  0.039571523666381836
mini_batch_src_global generation:  0.05972933769226074
r_  generation:  0.5543756484985352
local_output_nid generation:  0.036623477935791016
local_in_edges_tensor generation:  0.03589963912963867
mini_batch_src_global generation:  0.06249809265136719
r_  generation:  0.5397152900695801
----------------------check_connections_block total spend ----------------------------- 6.444783687591553
generate_one_block  0.6788225173950195
generate_one_block  0.6947124004364014
generate_one_block  0.6792404651641846
generate_one_block  0.679908037185669
generate_one_block  0.6950259208679199
generate_one_block  0.6808533668518066
generate_one_block  0.6907038688659668
generate_one_block  0.6811549663543701
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.052666664123535156
gen group dst list time:  0.05465269088745117
time for parepare:  0.01939868927001953
local_output_nid generation:  0.03548550605773926
local_in_edges_tensor generation:  0.057028770446777344
mini_batch_src_global generation:  0.05500435829162598
r_  generation:  0.5489499568939209
local_output_nid generation:  0.04092979431152344
local_in_edges_tensor generation:  0.09146738052368164
mini_batch_src_global generation:  0.06409358978271484
r_  generation:  0.5604679584503174
local_output_nid generation:  0.04041767120361328
local_in_edges_tensor generation:  0.04828786849975586
mini_batch_src_global generation:  0.06375789642333984
r_  generation:  0.5609140396118164
local_output_nid generation:  0.03878378868103027
local_in_edges_tensor generation:  0.04263806343078613
mini_batch_src_global generation:  0.0605006217956543
r_  generation:  0.5667660236358643
local_output_nid generation:  0.038741111755371094
local_in_edges_tensor generation:  0.03886103630065918
mini_batch_src_global generation:  0.06117391586303711
r_  generation:  0.5682666301727295
local_output_nid generation:  0.03880763053894043
local_in_edges_tensor generation:  0.03873634338378906
mini_batch_src_global generation:  0.060739755630493164
r_  generation:  0.5672228336334229
local_output_nid generation:  0.03859400749206543
local_in_edges_tensor generation:  0.05249953269958496
mini_batch_src_global generation:  0.0608670711517334
r_  generation:  0.5823817253112793
local_output_nid generation:  0.038491249084472656
local_in_edges_tensor generation:  0.03842878341674805
mini_batch_src_global generation:  0.06168055534362793
r_  generation:  0.5711584091186523
----------------------check_connections_block total spend ----------------------------- 6.790637254714966
generate_one_block  0.7063918113708496
generate_one_block  0.7098226547241211
generate_one_block  0.7181105613708496
generate_one_block  0.6931240558624268
generate_one_block  0.6970827579498291
generate_one_block  0.7045047283172607
generate_one_block  0.7109448909759521
generate_one_block  0.6987061500549316
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0387723445892334
gen group dst list time:  0.0476527214050293
time for parepare:  0.019243717193603516
local_output_nid generation:  0.03570699691772461
local_in_edges_tensor generation:  0.04663491249084473
mini_batch_src_global generation:  0.05017495155334473
r_  generation:  0.5415573120117188
local_output_nid generation:  0.04313516616821289
local_in_edges_tensor generation:  0.05608534812927246
mini_batch_src_global generation:  0.06612467765808105
r_  generation:  0.5598363876342773
local_output_nid generation:  0.04351925849914551
local_in_edges_tensor generation:  0.043184518814086914
mini_batch_src_global generation:  0.07201290130615234
r_  generation:  0.5538842678070068
local_output_nid generation:  0.044092655181884766
local_in_edges_tensor generation:  0.048009395599365234
mini_batch_src_global generation:  0.06330990791320801
r_  generation:  0.5473501682281494
local_output_nid generation:  0.04069185256958008
local_in_edges_tensor generation:  0.03625941276550293
mini_batch_src_global generation:  0.06442523002624512
r_  generation:  0.5453376770019531
local_output_nid generation:  0.043100833892822266
local_in_edges_tensor generation:  0.08416032791137695
mini_batch_src_global generation:  0.06328248977661133
r_  generation:  0.5513033866882324
local_output_nid generation:  0.04079008102416992
local_in_edges_tensor generation:  0.041617393493652344
mini_batch_src_global generation:  0.062438249588012695
r_  generation:  0.5544352531433105
local_output_nid generation:  0.040253400802612305
local_in_edges_tensor generation:  0.04926013946533203
mini_batch_src_global generation:  0.0626990795135498
r_  generation:  0.5589339733123779
----------------------check_connections_block total spend ----------------------------- 6.708828449249268
generate_one_block  0.7133603096008301
generate_one_block  0.699183464050293
generate_one_block  0.7028939723968506
generate_one_block  0.7127025127410889
generate_one_block  0.6939184665679932
generate_one_block  0.6946084499359131
generate_one_block  0.6969907283782959
generate_one_block  0.699521541595459
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03758573532104492
gen group dst list time:  0.054271697998046875
time for parepare:  0.020395517349243164
local_output_nid generation:  0.03764533996582031
local_in_edges_tensor generation:  0.04802823066711426
mini_batch_src_global generation:  0.046324729919433594
r_  generation:  0.5061895847320557
local_output_nid generation:  0.04355502128601074
local_in_edges_tensor generation:  0.041855573654174805
mini_batch_src_global generation:  0.058293819427490234
r_  generation:  0.5167388916015625
local_output_nid generation:  0.0432734489440918
local_in_edges_tensor generation:  0.037457942962646484
mini_batch_src_global generation:  0.058913230895996094
r_  generation:  0.5153255462646484
local_output_nid generation:  0.0406489372253418
local_in_edges_tensor generation:  0.04985356330871582
mini_batch_src_global generation:  0.059007883071899414
r_  generation:  0.5132265090942383
local_output_nid generation:  0.04106926918029785
local_in_edges_tensor generation:  0.041260719299316406
mini_batch_src_global generation:  0.05941057205200195
r_  generation:  0.5210015773773193
local_output_nid generation:  0.0409700870513916
local_in_edges_tensor generation:  0.03694581985473633
mini_batch_src_global generation:  0.059639692306518555
r_  generation:  0.5156023502349854
local_output_nid generation:  0.04096794128417969
local_in_edges_tensor generation:  0.036956787109375
mini_batch_src_global generation:  0.05911064147949219
r_  generation:  0.5294291973114014
local_output_nid generation:  0.04084944725036621
local_in_edges_tensor generation:  0.054114580154418945
mini_batch_src_global generation:  0.05851173400878906
r_  generation:  0.5167934894561768
----------------------check_connections_block total spend ----------------------------- 6.259503126144409
generate_one_block  0.6688125133514404
generate_one_block  0.6392366886138916
generate_one_block  0.6561141014099121
generate_one_block  0.6466951370239258
generate_one_block  0.6472492218017578
generate_one_block  0.6346096992492676
generate_one_block  0.649571418762207
generate_one_block  0.6463844776153564
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 0.25713634490966797  GigaBytes
Max Memory Allocated: 1.7091093063354492  GigaBytes

connection checking time:  30.031853914260864
block generation total time  25.267045974731445
average batch blocks generation time:  3.1583807468414307
block dataloader generation time/epoch 58.261168003082275
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 0.14423799514770508  GigaBytes
Max Memory Allocated: 1.7091093063354492  GigaBytes

torch.Size([167523, 128])
torch.Size([167136, 128])
torch.Size([165916, 128])
torch.Size([161491, 128])
torch.Size([142183, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 1.6477503776550293  GigaBytes
Max Memory Allocated: 1.7091093063354492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 0.14460134506225586  GigaBytes
Max Memory Allocated: 1.7125506401062012  GigaBytes

torch.Size([167510, 128])
torch.Size([167049, 128])
torch.Size([165746, 128])
torch.Size([161301, 128])
torch.Size([142226, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 1.6450910568237305  GigaBytes
Max Memory Allocated: 1.7125506401062012  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 0.14422607421875  GigaBytes
Max Memory Allocated: 1.7125506401062012  GigaBytes

torch.Size([167555, 128])
torch.Size([167133, 128])
torch.Size([165927, 128])
torch.Size([161480, 128])
torch.Size([142060, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 1.6477737426757812  GigaBytes
Max Memory Allocated: 1.7125506401062012  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 0.14461517333984375  GigaBytes
Max Memory Allocated: 1.712606430053711  GigaBytes

torch.Size([167504, 128])
torch.Size([167120, 128])
torch.Size([165844, 128])
torch.Size([161244, 128])
torch.Size([141903, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 1.6451592445373535  GigaBytes
Max Memory Allocated: 1.712606430053711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 0.14429950714111328  GigaBytes
Max Memory Allocated: 1.712606430053711  GigaBytes

torch.Size([167525, 128])
torch.Size([167107, 128])
torch.Size([165813, 128])
torch.Size([161411, 128])
torch.Size([142340, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 1.644822120666504  GigaBytes
Max Memory Allocated: 1.712606430053711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 0.14446735382080078  GigaBytes
Max Memory Allocated: 1.712606430053711  GigaBytes

torch.Size([167503, 128])
torch.Size([167046, 128])
torch.Size([165766, 128])
torch.Size([161358, 128])
torch.Size([142122, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 1.6415562629699707  GigaBytes
Max Memory Allocated: 1.712606430053711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 0.14425992965698242  GigaBytes
Max Memory Allocated: 1.712606430053711  GigaBytes

torch.Size([167520, 128])
torch.Size([167103, 128])
torch.Size([165880, 128])
torch.Size([161516, 128])
torch.Size([142340, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 1.6441617012023926  GigaBytes
Max Memory Allocated: 1.712606430053711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 0.1445140838623047  GigaBytes
Max Memory Allocated: 1.712606430053711  GigaBytes

torch.Size([167509, 128])
torch.Size([167087, 128])
torch.Size([165821, 128])
torch.Size([161230, 128])
torch.Size([141767, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 1.644686222076416  GigaBytes
Max Memory Allocated: 1.712606430053711  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.11248379945755005 |0.04893377423286438 |0.006687641143798828 |9.909272193908691e-05 |0.007195234298706055 |0.0027484893798828125 |
----------------------------------------------------------pseudo_mini_loss sum 4.148488998413086
Total (block generation + training)time/epoch 59.771998167037964
Training time/epoch 1.510610818862915
Training time without block to device /epoch 1.119140625
Training time without total dataloading part /epoch 0.11460423469543457
load block tensor time/epoch 0.8998703956604004
block to device time/epoch 0.39147019386291504
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6974370
Number of first layer input nodes during this epoch:  1340149
