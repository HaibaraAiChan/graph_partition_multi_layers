Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648444939.5476353
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02691793441772461
random selection method range initialization spend 0.006441593170166016
time for parepare:  0.018260478973388672
local_output_nid generation:  0.004174709320068359
local_in_edges_tensor generation:  0.006690025329589844
mini_batch_src_global generation:  0.003702402114868164
r_  generation:  0.041773080825805664
local_output_nid generation:  0.0056726932525634766
local_in_edges_tensor generation:  0.003167390823364258
mini_batch_src_global generation:  0.004822492599487305
r_  generation:  0.04353523254394531
local_output_nid generation:  0.005980014801025391
local_in_edges_tensor generation:  0.0034351348876953125
mini_batch_src_global generation:  0.003159761428833008
r_  generation:  0.0428464412689209
local_output_nid generation:  0.0060422420501708984
local_in_edges_tensor generation:  0.0032296180725097656
mini_batch_src_global generation:  0.003269672393798828
r_  generation:  0.044315338134765625
local_output_nid generation:  0.006043195724487305
local_in_edges_tensor generation:  0.003244161605834961
mini_batch_src_global generation:  0.003517627716064453
r_  generation:  0.045415639877319336
local_output_nid generation:  0.00600886344909668
local_in_edges_tensor generation:  0.003187894821166992
mini_batch_src_global generation:  0.003899812698364258
r_  generation:  0.04618048667907715
local_output_nid generation:  0.006100177764892578
local_in_edges_tensor generation:  0.0032274723052978516
mini_batch_src_global generation:  0.003890514373779297
r_  generation:  0.04674100875854492
local_output_nid generation:  0.006110191345214844
local_in_edges_tensor generation:  0.003206968307495117
mini_batch_src_global generation:  0.0039081573486328125
r_  generation:  0.047132015228271484
----------------------check_connections_block total spend ----------------------------- 0.5659582614898682
generate_one_block  0.06176328659057617
generate_one_block  0.06401371955871582
generate_one_block  0.06183767318725586
generate_one_block  0.06047630310058594
generate_one_block  0.0650169849395752
generate_one_block  0.0615081787109375
generate_one_block  0.06186246871948242
generate_one_block  0.06197953224182129
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.043750762939453125
gen group dst list time:  0.016326904296875
time for parepare:  0.02001500129699707
local_output_nid generation:  0.015151500701904297
local_in_edges_tensor generation:  0.03633522987365723
mini_batch_src_global generation:  0.038294315338134766
r_  generation:  0.3602910041809082
local_output_nid generation:  0.02361464500427246
local_in_edges_tensor generation:  0.03532528877258301
mini_batch_src_global generation:  0.053858041763305664
r_  generation:  0.37300729751586914
local_output_nid generation:  0.023222684860229492
local_in_edges_tensor generation:  0.028159141540527344
mini_batch_src_global generation:  0.044586181640625
r_  generation:  0.3770332336425781
local_output_nid generation:  0.023056745529174805
local_in_edges_tensor generation:  0.024569988250732422
mini_batch_src_global generation:  0.044565677642822266
r_  generation:  0.3708486557006836
local_output_nid generation:  0.023270845413208008
local_in_edges_tensor generation:  0.025003910064697266
mini_batch_src_global generation:  0.04613494873046875
r_  generation:  0.3787679672241211
local_output_nid generation:  0.023541927337646484
local_in_edges_tensor generation:  0.02939152717590332
mini_batch_src_global generation:  0.04671907424926758
r_  generation:  0.37839603424072266
local_output_nid generation:  0.023303747177124023
local_in_edges_tensor generation:  0.028106212615966797
mini_batch_src_global generation:  0.045670509338378906
r_  generation:  0.3867518901824951
local_output_nid generation:  0.023189783096313477
local_in_edges_tensor generation:  0.029036283493041992
mini_batch_src_global generation:  0.04717612266540527
r_  generation:  0.37807416915893555
----------------------check_connections_block total spend ----------------------------- 4.438495635986328
generate_one_block  0.4984242916107178
generate_one_block  0.504857063293457
generate_one_block  0.49703049659729004
generate_one_block  0.47870326042175293
generate_one_block  0.49469900131225586
generate_one_block  0.5116558074951172
generate_one_block  0.4999086856842041
generate_one_block  0.4960622787475586
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03713274002075195
gen group dst list time:  0.03660082817077637
time for parepare:  0.019601821899414062
local_output_nid generation:  0.02945089340209961
local_in_edges_tensor generation:  0.04737567901611328
mini_batch_src_global generation:  0.05602002143859863
r_  generation:  0.5386343002319336
local_output_nid generation:  0.03925013542175293
local_in_edges_tensor generation:  0.057501792907714844
mini_batch_src_global generation:  0.06698966026306152
r_  generation:  0.5475003719329834
local_output_nid generation:  0.03942251205444336
local_in_edges_tensor generation:  0.05189061164855957
mini_batch_src_global generation:  0.061644792556762695
r_  generation:  0.5514693260192871
local_output_nid generation:  0.03959393501281738
local_in_edges_tensor generation:  0.037041425704956055
mini_batch_src_global generation:  0.06002998352050781
r_  generation:  0.5651161670684814
local_output_nid generation:  0.040007829666137695
local_in_edges_tensor generation:  0.036604881286621094
mini_batch_src_global generation:  0.06166410446166992
r_  generation:  0.5651347637176514
local_output_nid generation:  0.03970479965209961
local_in_edges_tensor generation:  0.041283607482910156
mini_batch_src_global generation:  0.06603169441223145
r_  generation:  0.5680210590362549
local_output_nid generation:  0.03959488868713379
local_in_edges_tensor generation:  0.03959822654724121
mini_batch_src_global generation:  0.06368756294250488
r_  generation:  0.5718255043029785
local_output_nid generation:  0.03963637351989746
local_in_edges_tensor generation:  0.04144787788391113
mini_batch_src_global generation:  0.0672004222869873
r_  generation:  0.5702593326568604
----------------------check_connections_block total spend ----------------------------- 6.641694784164429
generate_one_block  0.7126696109771729
generate_one_block  0.725987434387207
generate_one_block  0.7200748920440674
generate_one_block  0.7242600917816162
generate_one_block  0.7035729885101318
generate_one_block  0.7201533317565918
generate_one_block  0.7336373329162598
generate_one_block  0.7079942226409912
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  11.080190420150757
block generation total time  9.729690790176392
average batch blocks generation time:  1.216211348772049
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.10233211517333984  GigaBytes
Max Memory Allocated: 0.10233211517333984  GigaBytes

torch.Size([162544, 128])
torch.Size([145797, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4979248046875 GB
    Memory Allocated: 0.952082633972168  GigaBytes
Max Memory Allocated: 1.0180740356445312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8690185546875 GB
    Memory Allocated: 0.10488080978393555  GigaBytes
Max Memory Allocated: 1.092501163482666  GigaBytes

torch.Size([162817, 128])
torch.Size([146344, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8709716796875 GB
    Memory Allocated: 0.9574947357177734  GigaBytes
Max Memory Allocated: 1.092501163482666  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.10479021072387695  GigaBytes
Max Memory Allocated: 1.0992956161499023  GigaBytes

torch.Size([162553, 128])
torch.Size([145760, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.9506707191467285  GigaBytes
Max Memory Allocated: 1.0992956161499023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.1044921875  GigaBytes
Max Memory Allocated: 1.0992956161499023  GigaBytes

torch.Size([162697, 128])
torch.Size([146071, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.9487299919128418  GigaBytes
Max Memory Allocated: 1.0992956161499023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.10574007034301758  GigaBytes
Max Memory Allocated: 1.0992956161499023  GigaBytes

torch.Size([162618, 128])
torch.Size([145716, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.9518566131591797  GigaBytes
Max Memory Allocated: 1.0992956161499023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.10503625869750977  GigaBytes
Max Memory Allocated: 1.0992956161499023  GigaBytes

torch.Size([162829, 128])
torch.Size([146587, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.9578056335449219  GigaBytes
Max Memory Allocated: 1.0992956161499023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.10530281066894531  GigaBytes
Max Memory Allocated: 1.0992956161499023  GigaBytes

torch.Size([162699, 128])
torch.Size([145755, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.9531383514404297  GigaBytes
Max Memory Allocated: 1.0992956161499023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.10470342636108398  GigaBytes
Max Memory Allocated: 1.0992956161499023  GigaBytes

torch.Size([162505, 128])
torch.Size([145617, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.9504995346069336  GigaBytes
Max Memory Allocated: 1.0992956161499023  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06968370079994202 |0.05618542432785034 |0.10042586922645569 |0.00010034441947937012 |0.015459597110748291 |0.0016756057739257812 |
----------------------------------------------------------pseudo_mini_loss sum 6.250718593597412
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3057857
Number of first layer input nodes during this epoch:  1301262
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.14118289947509766  GigaBytes
Max Memory Allocated: 1.0992956161499023  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028357505798339844
random selection method range initialization spend 0.005643606185913086
time for parepare:  0.017599821090698242
local_output_nid generation:  0.00442051887512207
local_in_edges_tensor generation:  0.006638050079345703
mini_batch_src_global generation:  0.0037889480590820312
r_  generation:  0.045171499252319336
local_output_nid generation:  0.0059359073638916016
local_in_edges_tensor generation:  0.003403186798095703
mini_batch_src_global generation:  0.004880428314208984
r_  generation:  0.04362368583679199
local_output_nid generation:  0.006107807159423828
local_in_edges_tensor generation:  0.0034661293029785156
mini_batch_src_global generation:  0.0033190250396728516
r_  generation:  0.04648756980895996
local_output_nid generation:  0.006796598434448242
local_in_edges_tensor generation:  0.013018369674682617
mini_batch_src_global generation:  0.007856369018554688
r_  generation:  0.04850316047668457
local_output_nid generation:  0.007445096969604492
local_in_edges_tensor generation:  0.0035991668701171875
mini_batch_src_global generation:  0.003915548324584961
r_  generation:  0.04623723030090332
local_output_nid generation:  0.006270408630371094
local_in_edges_tensor generation:  0.003273487091064453
mini_batch_src_global generation:  0.0038793087005615234
r_  generation:  0.04644322395324707
local_output_nid generation:  0.006430149078369141
local_in_edges_tensor generation:  0.0035521984100341797
mini_batch_src_global generation:  0.004037618637084961
r_  generation:  0.04764223098754883
local_output_nid generation:  0.006356477737426758
local_in_edges_tensor generation:  0.0031974315643310547
mini_batch_src_global generation:  0.004137277603149414
r_  generation:  0.046651363372802734
----------------------check_connections_block total spend ----------------------------- 0.6111669540405273
generate_one_block  0.06117534637451172
generate_one_block  0.0620417594909668
generate_one_block  0.06073355674743652
generate_one_block  0.06044936180114746
generate_one_block  0.062192678451538086
generate_one_block  0.061777353286743164
generate_one_block  0.06659698486328125
generate_one_block  0.06196284294128418
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05907702445983887
gen group dst list time:  0.016417264938354492
time for parepare:  0.021210193634033203
local_output_nid generation:  0.014724016189575195
local_in_edges_tensor generation:  0.05082082748413086
mini_batch_src_global generation:  0.036870718002319336
r_  generation:  0.3674192428588867
local_output_nid generation:  0.02077007293701172
local_in_edges_tensor generation:  0.03522372245788574
mini_batch_src_global generation:  0.045623779296875
r_  generation:  0.3764832019805908
local_output_nid generation:  0.019317150115966797
local_in_edges_tensor generation:  0.028731346130371094
mini_batch_src_global generation:  0.04769396781921387
r_  generation:  0.37862110137939453
local_output_nid generation:  0.01931452751159668
local_in_edges_tensor generation:  0.0281829833984375
mini_batch_src_global generation:  0.04537320137023926
r_  generation:  0.37792539596557617
local_output_nid generation:  0.01961684226989746
local_in_edges_tensor generation:  0.028629779815673828
mini_batch_src_global generation:  0.0489201545715332
r_  generation:  0.38575291633605957
local_output_nid generation:  0.01943516731262207
local_in_edges_tensor generation:  0.02179574966430664
mini_batch_src_global generation:  0.04665112495422363
r_  generation:  0.38239359855651855
local_output_nid generation:  0.019536972045898438
local_in_edges_tensor generation:  0.023479700088500977
mini_batch_src_global generation:  0.04776644706726074
r_  generation:  0.3918266296386719
local_output_nid generation:  0.019485950469970703
local_in_edges_tensor generation:  0.021971464157104492
mini_batch_src_global generation:  0.046611785888671875
r_  generation:  0.3789808750152588
----------------------check_connections_block total spend ----------------------------- 4.458592653274536
generate_one_block  0.5099179744720459
generate_one_block  0.5339756011962891
generate_one_block  0.5064592361450195
generate_one_block  0.514493465423584
generate_one_block  0.5070383548736572
generate_one_block  0.5090196132659912
generate_one_block  0.5109333992004395
generate_one_block  0.5282485485076904
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04797220230102539
gen group dst list time:  0.03779888153076172
time for parepare:  0.019461631774902344
local_output_nid generation:  0.028949499130249023
local_in_edges_tensor generation:  0.07155799865722656
mini_batch_src_global generation:  0.056089162826538086
r_  generation:  0.5670113563537598
local_output_nid generation:  0.03897452354431152
local_in_edges_tensor generation:  0.06400227546691895
mini_batch_src_global generation:  0.06510281562805176
r_  generation:  0.5465397834777832
local_output_nid generation:  0.039557695388793945
local_in_edges_tensor generation:  0.04754781723022461
mini_batch_src_global generation:  0.061676025390625
r_  generation:  0.5582361221313477
local_output_nid generation:  0.03839302062988281
local_in_edges_tensor generation:  0.040576934814453125
mini_batch_src_global generation:  0.060411930084228516
r_  generation:  0.561753511428833
local_output_nid generation:  0.04769301414489746
local_in_edges_tensor generation:  0.03572368621826172
mini_batch_src_global generation:  0.06274867057800293
r_  generation:  0.5673625469207764
local_output_nid generation:  0.03667283058166504
local_in_edges_tensor generation:  0.04735732078552246
mini_batch_src_global generation:  0.06215548515319824
r_  generation:  0.5670301914215088
local_output_nid generation:  0.03606700897216797
local_in_edges_tensor generation:  0.0461268424987793
mini_batch_src_global generation:  0.0632164478302002
r_  generation:  0.5688719749450684
local_output_nid generation:  0.03663015365600586
local_in_edges_tensor generation:  0.041107177734375
mini_batch_src_global generation:  0.0634610652923584
r_  generation:  0.5758035182952881
----------------------check_connections_block total spend ----------------------------- 6.740478992462158
generate_one_block  0.73211669921875
generate_one_block  0.7197303771972656
generate_one_block  0.718083381652832
generate_one_block  0.7139875888824463
generate_one_block  0.7176649570465088
generate_one_block  0.7185931205749512
generate_one_block  0.7194576263427734
generate_one_block  0.7182116508483887
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.14118289947509766  GigaBytes
Max Memory Allocated: 1.0992956161499023  GigaBytes

connection checking time:  11.199071645736694
block generation total time  9.877931594848633
average batch blocks generation time:  1.234741449356079
block dataloader generation time/epoch 23.307363748550415
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.10701179504394531  GigaBytes
Max Memory Allocated: 1.0992956161499023  GigaBytes

torch.Size([162603, 128])
torch.Size([146174, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9588737487792969  GigaBytes
Max Memory Allocated: 1.0992956161499023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1059408187866211  GigaBytes
Max Memory Allocated: 1.1005873680114746  GigaBytes

torch.Size([162639, 128])
torch.Size([145748, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.955193042755127  GigaBytes
Max Memory Allocated: 1.1005873680114746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1072235107421875  GigaBytes
Max Memory Allocated: 1.1005873680114746  GigaBytes

torch.Size([162823, 128])
torch.Size([146497, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9588141441345215  GigaBytes
Max Memory Allocated: 1.1005873680114746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10644340515136719  GigaBytes
Max Memory Allocated: 1.1005873680114746  GigaBytes

torch.Size([162613, 128])
torch.Size([145837, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.952812671661377  GigaBytes
Max Memory Allocated: 1.1005873680114746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10720491409301758  GigaBytes
Max Memory Allocated: 1.1005873680114746  GigaBytes

torch.Size([162406, 128])
torch.Size([145952, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9541301727294922  GigaBytes
Max Memory Allocated: 1.1005873680114746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10660886764526367  GigaBytes
Max Memory Allocated: 1.1005873680114746  GigaBytes

torch.Size([162708, 128])
torch.Size([146075, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9547643661499023  GigaBytes
Max Memory Allocated: 1.1005873680114746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1072549819946289  GigaBytes
Max Memory Allocated: 1.1005873680114746  GigaBytes

torch.Size([162399, 128])
torch.Size([146038, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9568724632263184  GigaBytes
Max Memory Allocated: 1.1005873680114746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10588788986206055  GigaBytes
Max Memory Allocated: 1.1005873680114746  GigaBytes

torch.Size([162789, 128])
torch.Size([146157, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9542269706726074  GigaBytes
Max Memory Allocated: 1.1005873680114746  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08685743808746338 |0.019597262144088745 |0.003761768341064453 |9.384751319885254e-05 |0.003785431385040283 |0.0018107891082763672 |
----------------------------------------------------------pseudo_mini_loss sum 3.223844051361084
Total (block generation + training)time/epoch 24.295424222946167
Training time/epoch 0.9877829551696777
Training time without block to device /epoch 0.8310048580169678
Training time without total dataloading part /epoch 0.06293916702270508
load block tensor time/epoch 0.694859504699707
block to device time/epoch 0.15677809715270996
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3059470
Number of first layer input nodes during this epoch:  1300980
