Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648445084.1821823
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027474164962768555
random selection method range initialization spend 0.006269216537475586
time for parepare:  0.01835012435913086
local_output_nid generation:  0.0010938644409179688
local_in_edges_tensor generation:  0.004107475280761719
mini_batch_src_global generation:  0.0015616416931152344
r_  generation:  0.010088920593261719
local_output_nid generation:  0.00124359130859375
local_in_edges_tensor generation:  0.0010285377502441406
mini_batch_src_global generation:  0.0015666484832763672
r_  generation:  0.009409666061401367
local_output_nid generation:  0.0013272762298583984
local_in_edges_tensor generation:  0.0009055137634277344
mini_batch_src_global generation:  0.0011374950408935547
r_  generation:  0.010094881057739258
local_output_nid generation:  0.0014007091522216797
local_in_edges_tensor generation:  0.0008533000946044922
mini_batch_src_global generation:  0.0010056495666503906
r_  generation:  0.009080886840820312
local_output_nid generation:  0.0014047622680664062
local_in_edges_tensor generation:  0.0008616447448730469
mini_batch_src_global generation:  0.0010750293731689453
r_  generation:  0.01000213623046875
local_output_nid generation:  0.0014071464538574219
local_in_edges_tensor generation:  0.0008480548858642578
mini_batch_src_global generation:  0.0010509490966796875
r_  generation:  0.009831428527832031
local_output_nid generation:  0.0014362335205078125
local_in_edges_tensor generation:  0.0008182525634765625
mini_batch_src_global generation:  0.0010225772857666016
r_  generation:  0.00943756103515625
local_output_nid generation:  0.0014178752899169922
local_in_edges_tensor generation:  0.0008175373077392578
mini_batch_src_global generation:  0.0009763240814208984
r_  generation:  0.009645700454711914
local_output_nid generation:  0.0014567375183105469
local_in_edges_tensor generation:  0.0008535385131835938
mini_batch_src_global generation:  0.001012563705444336
r_  generation:  0.009267807006835938
local_output_nid generation:  0.0014524459838867188
local_in_edges_tensor generation:  0.0007965564727783203
mini_batch_src_global generation:  0.0009634494781494141
r_  generation:  0.00945734977722168
local_output_nid generation:  0.0014410018920898438
local_in_edges_tensor generation:  0.0008168220520019531
mini_batch_src_global generation:  0.001077413558959961
r_  generation:  0.009961843490600586
local_output_nid generation:  0.0014410018920898438
local_in_edges_tensor generation:  0.0008170604705810547
mini_batch_src_global generation:  0.0010509490966796875
r_  generation:  0.010144233703613281
local_output_nid generation:  0.00148773193359375
local_in_edges_tensor generation:  0.0008335113525390625
mini_batch_src_global generation:  0.0010461807250976562
r_  generation:  0.00951695442199707
local_output_nid generation:  0.0014395713806152344
local_in_edges_tensor generation:  0.0007927417755126953
mini_batch_src_global generation:  0.0010073184967041016
r_  generation:  0.009819984436035156
local_output_nid generation:  0.001463174819946289
local_in_edges_tensor generation:  0.0008254051208496094
mini_batch_src_global generation:  0.0010907649993896484
r_  generation:  0.009738922119140625
local_output_nid generation:  0.001420736312866211
local_in_edges_tensor generation:  0.0007944107055664062
mini_batch_src_global generation:  0.0009868144989013672
r_  generation:  0.009510040283203125
local_output_nid generation:  0.0014331340789794922
local_in_edges_tensor generation:  0.0007979869842529297
mini_batch_src_global generation:  0.0010075569152832031
r_  generation:  0.009994983673095703
local_output_nid generation:  0.0014379024505615234
local_in_edges_tensor generation:  0.0008018016815185547
mini_batch_src_global generation:  0.0010175704956054688
r_  generation:  0.010074615478515625
local_output_nid generation:  0.0014274120330810547
local_in_edges_tensor generation:  0.0007932186126708984
mini_batch_src_global generation:  0.0010373592376708984
r_  generation:  0.009944677352905273
local_output_nid generation:  0.001428365707397461
local_in_edges_tensor generation:  0.0008156299591064453
mini_batch_src_global generation:  0.0009975433349609375
r_  generation:  0.00972437858581543
local_output_nid generation:  0.0014636516571044922
local_in_edges_tensor generation:  0.0008015632629394531
mini_batch_src_global generation:  0.001004934310913086
r_  generation:  0.009804487228393555
local_output_nid generation:  0.0014739036560058594
local_in_edges_tensor generation:  0.0008139610290527344
mini_batch_src_global generation:  0.0009963512420654297
r_  generation:  0.00995635986328125
local_output_nid generation:  0.0014810562133789062
local_in_edges_tensor generation:  0.0008182525634765625
mini_batch_src_global generation:  0.0010061264038085938
r_  generation:  0.009720087051391602
local_output_nid generation:  0.0014791488647460938
local_in_edges_tensor generation:  0.0008158683776855469
mini_batch_src_global generation:  0.0010526180267333984
r_  generation:  0.010355234146118164
local_output_nid generation:  0.0014460086822509766
local_in_edges_tensor generation:  0.0008006095886230469
mini_batch_src_global generation:  0.001020669937133789
r_  generation:  0.010001182556152344
local_output_nid generation:  0.0014472007751464844
local_in_edges_tensor generation:  0.0008001327514648438
mini_batch_src_global generation:  0.0010197162628173828
r_  generation:  0.009997129440307617
local_output_nid generation:  0.0014576911926269531
local_in_edges_tensor generation:  0.0008156299591064453
mini_batch_src_global generation:  0.0010285377502441406
r_  generation:  0.009723186492919922
local_output_nid generation:  0.0014231204986572266
local_in_edges_tensor generation:  0.0008184909820556641
mini_batch_src_global generation:  0.0010275840759277344
r_  generation:  0.010551929473876953
local_output_nid generation:  0.0014736652374267578
local_in_edges_tensor generation:  0.0008275508880615234
mini_batch_src_global generation:  0.00106048583984375
r_  generation:  0.010390281677246094
local_output_nid generation:  0.0014815330505371094
local_in_edges_tensor generation:  0.005623817443847656
mini_batch_src_global generation:  0.001285552978515625
r_  generation:  0.01003408432006836
local_output_nid generation:  0.0013494491577148438
local_in_edges_tensor generation:  0.0008518695831298828
mini_batch_src_global generation:  0.0011494159698486328
r_  generation:  0.010465860366821289
local_output_nid generation:  0.0014259815216064453
local_in_edges_tensor generation:  0.0008192062377929688
mini_batch_src_global generation:  0.0010457038879394531
r_  generation:  0.009627103805541992
----------------------check_connections_block total spend ----------------------------- 0.537369966506958
generate_one_block  0.015813827514648438
generate_one_block  0.015112876892089844
generate_one_block  0.015917062759399414
generate_one_block  0.014325141906738281
generate_one_block  0.015799522399902344
generate_one_block  0.015178203582763672
generate_one_block  0.01468038558959961
generate_one_block  0.015041589736938477
generate_one_block  0.014235496520996094
generate_one_block  0.014688253402709961
generate_one_block  0.015032529830932617
generate_one_block  0.015337944030761719
generate_one_block  0.014543294906616211
generate_one_block  0.015072107315063477
generate_one_block  0.014774084091186523
generate_one_block  0.014377355575561523
generate_one_block  0.014892578125
generate_one_block  0.015287160873413086
generate_one_block  0.014926671981811523
generate_one_block  0.014456987380981445
generate_one_block  0.014677762985229492
generate_one_block  0.014634370803833008
generate_one_block  0.01433873176574707
generate_one_block  0.015676021575927734
generate_one_block  0.014686107635498047
generate_one_block  0.014798879623413086
generate_one_block  0.014546394348144531
generate_one_block  0.015439748764038086
generate_one_block  0.01526784896850586
generate_one_block  0.014586687088012695
generate_one_block  0.015473127365112305
generate_one_block  0.014256715774536133
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0475921630859375
gen group dst list time:  0.022799968719482422
time for parepare:  0.018735647201538086
local_output_nid generation:  0.005285739898681641
local_in_edges_tensor generation:  0.015390396118164062
mini_batch_src_global generation:  0.015803813934326172
r_  generation:  0.1632215976715088
local_output_nid generation:  0.00822138786315918
local_in_edges_tensor generation:  0.012775421142578125
mini_batch_src_global generation:  0.019968271255493164
r_  generation:  0.16863751411437988
local_output_nid generation:  0.008394002914428711
local_in_edges_tensor generation:  0.013303518295288086
mini_batch_src_global generation:  0.01903557777404785
r_  generation:  0.17979741096496582
local_output_nid generation:  0.007766246795654297
local_in_edges_tensor generation:  0.009819269180297852
mini_batch_src_global generation:  0.0186004638671875
r_  generation:  0.16448569297790527
local_output_nid generation:  0.008322954177856445
local_in_edges_tensor generation:  0.01172947883605957
mini_batch_src_global generation:  0.022223472595214844
r_  generation:  0.1851487159729004
local_output_nid generation:  0.008093595504760742
local_in_edges_tensor generation:  0.013060808181762695
mini_batch_src_global generation:  0.02105116844177246
r_  generation:  0.17623329162597656
local_output_nid generation:  0.011536836624145508
local_in_edges_tensor generation:  0.01029515266418457
mini_batch_src_global generation:  0.020969390869140625
r_  generation:  0.17360877990722656
local_output_nid generation:  0.008066415786743164
local_in_edges_tensor generation:  0.011452436447143555
mini_batch_src_global generation:  0.020965099334716797
r_  generation:  0.17747020721435547
local_output_nid generation:  0.007876873016357422
local_in_edges_tensor generation:  0.011786222457885742
mini_batch_src_global generation:  0.021541595458984375
r_  generation:  0.17330503463745117
local_output_nid generation:  0.00779271125793457
local_in_edges_tensor generation:  0.009830951690673828
mini_batch_src_global generation:  0.02115178108215332
r_  generation:  0.17276501655578613
local_output_nid generation:  0.008136749267578125
local_in_edges_tensor generation:  0.011511564254760742
mini_batch_src_global generation:  0.021413087844848633
r_  generation:  0.18554449081420898
local_output_nid generation:  0.008132696151733398
local_in_edges_tensor generation:  0.013620853424072266
mini_batch_src_global generation:  0.022781848907470703
r_  generation:  0.18302392959594727
local_output_nid generation:  0.007866144180297852
local_in_edges_tensor generation:  0.011307954788208008
mini_batch_src_global generation:  0.021056652069091797
r_  generation:  0.1736922264099121
local_output_nid generation:  0.008148670196533203
local_in_edges_tensor generation:  0.01188802719116211
mini_batch_src_global generation:  0.02314448356628418
r_  generation:  0.18314576148986816
local_output_nid generation:  0.008066415786743164
local_in_edges_tensor generation:  0.014360666275024414
mini_batch_src_global generation:  0.021479129791259766
r_  generation:  0.1792285442352295
local_output_nid generation:  0.0077054500579833984
local_in_edges_tensor generation:  0.009945869445800781
mini_batch_src_global generation:  0.02144455909729004
r_  generation:  0.1712188720703125
local_output_nid generation:  0.007951498031616211
local_in_edges_tensor generation:  0.01000356674194336
mini_batch_src_global generation:  0.022804975509643555
r_  generation:  0.18232941627502441
local_output_nid generation:  0.008256912231445312
local_in_edges_tensor generation:  0.013225078582763672
mini_batch_src_global generation:  0.03223896026611328
r_  generation:  0.18220233917236328
local_output_nid generation:  0.008196353912353516
local_in_edges_tensor generation:  0.013286352157592773
mini_batch_src_global generation:  0.022192716598510742
r_  generation:  0.1874985694885254
local_output_nid generation:  0.00789642333984375
local_in_edges_tensor generation:  0.010078191757202148
mini_batch_src_global generation:  0.026223182678222656
r_  generation:  0.18459129333496094
local_output_nid generation:  0.00792837142944336
local_in_edges_tensor generation:  0.009716033935546875
mini_batch_src_global generation:  0.02177906036376953
r_  generation:  0.18003320693969727
local_output_nid generation:  0.008018732070922852
local_in_edges_tensor generation:  0.010420083999633789
mini_batch_src_global generation:  0.02202153205871582
r_  generation:  0.17609548568725586
local_output_nid generation:  0.00796818733215332
local_in_edges_tensor generation:  0.012487649917602539
mini_batch_src_global generation:  0.021474838256835938
r_  generation:  0.17448902130126953
local_output_nid generation:  0.008510351181030273
local_in_edges_tensor generation:  0.013755321502685547
mini_batch_src_global generation:  0.024124860763549805
r_  generation:  0.18722200393676758
local_output_nid generation:  0.008030176162719727
local_in_edges_tensor generation:  0.013396024703979492
mini_batch_src_global generation:  0.02248096466064453
r_  generation:  0.18469834327697754
local_output_nid generation:  0.008048772811889648
local_in_edges_tensor generation:  0.011702537536621094
mini_batch_src_global generation:  0.023495197296142578
r_  generation:  0.1795203685760498
local_output_nid generation:  0.007895708084106445
local_in_edges_tensor generation:  0.010033130645751953
mini_batch_src_global generation:  0.02177143096923828
r_  generation:  0.17600131034851074
local_output_nid generation:  0.008265018463134766
local_in_edges_tensor generation:  0.0102386474609375
mini_batch_src_global generation:  0.023209333419799805
r_  generation:  0.18489670753479004
local_output_nid generation:  0.00826120376586914
local_in_edges_tensor generation:  0.014435529708862305
mini_batch_src_global generation:  0.022717714309692383
r_  generation:  0.18503141403198242
local_output_nid generation:  0.008021354675292969
local_in_edges_tensor generation:  0.01577591896057129
mini_batch_src_global generation:  0.022542238235473633
r_  generation:  0.17987370491027832
local_output_nid generation:  0.008159875869750977
local_in_edges_tensor generation:  0.010234594345092773
mini_batch_src_global generation:  0.022676706314086914
r_  generation:  0.1852867603302002
local_output_nid generation:  0.00791168212890625
local_in_edges_tensor generation:  0.009892940521240234
mini_batch_src_global generation:  0.02201557159423828
r_  generation:  0.17370891571044922
----------------------check_connections_block total spend ----------------------------- 8.34042739868164
generate_one_block  0.23289847373962402
generate_one_block  0.2325916290283203
generate_one_block  0.261871337890625
generate_one_block  0.21580004692077637
generate_one_block  0.24106359481811523
generate_one_block  0.2310934066772461
generate_one_block  0.2229931354522705
generate_one_block  0.2291245460510254
generate_one_block  0.21974968910217285
generate_one_block  0.2183847427368164
generate_one_block  0.23366427421569824
generate_one_block  0.23426008224487305
generate_one_block  0.22246050834655762
generate_one_block  0.2336587905883789
generate_one_block  0.223891019821167
generate_one_block  0.2469468116760254
generate_one_block  0.22982144355773926
generate_one_block  0.2301487922668457
generate_one_block  0.23232102394104004
generate_one_block  0.22550630569458008
generate_one_block  0.22556400299072266
generate_one_block  0.22320103645324707
generate_one_block  0.23157501220703125
generate_one_block  0.24481415748596191
generate_one_block  0.2284376621246338
generate_one_block  0.2315983772277832
generate_one_block  0.22160100936889648
generate_one_block  0.2418363094329834
generate_one_block  0.22977948188781738
generate_one_block  0.23031830787658691
generate_one_block  0.2393817901611328
generate_one_block  0.2245028018951416
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0639641284942627
gen group dst list time:  0.11561369895935059
time for parepare:  0.02142333984375
local_output_nid generation:  0.02359175682067871
local_in_edges_tensor generation:  0.050254106521606445
mini_batch_src_global generation:  0.04721784591674805
r_  generation:  0.487607479095459
local_output_nid generation:  0.030208587646484375
local_in_edges_tensor generation:  0.05359911918640137
mini_batch_src_global generation:  0.057624101638793945
r_  generation:  0.4929065704345703
local_output_nid generation:  0.029879093170166016
local_in_edges_tensor generation:  0.045868873596191406
mini_batch_src_global generation:  0.056067705154418945
r_  generation:  0.5021481513977051
local_output_nid generation:  0.028124332427978516
local_in_edges_tensor generation:  0.03267264366149902
mini_batch_src_global generation:  0.057021379470825195
r_  generation:  0.4994833469390869
local_output_nid generation:  0.02870917320251465
local_in_edges_tensor generation:  0.05002593994140625
mini_batch_src_global generation:  0.061597585678100586
r_  generation:  0.5070288181304932
local_output_nid generation:  0.028289079666137695
local_in_edges_tensor generation:  0.036183834075927734
mini_batch_src_global generation:  0.05916714668273926
r_  generation:  0.5302035808563232
local_output_nid generation:  0.028601408004760742
local_in_edges_tensor generation:  0.035784006118774414
mini_batch_src_global generation:  0.05905437469482422
r_  generation:  0.5153205394744873
local_output_nid generation:  0.028468608856201172
local_in_edges_tensor generation:  0.03676915168762207
mini_batch_src_global generation:  0.05977582931518555
r_  generation:  0.5158684253692627
local_output_nid generation:  0.02854752540588379
local_in_edges_tensor generation:  0.03632545471191406
mini_batch_src_global generation:  0.059154510498046875
r_  generation:  0.5143091678619385
local_output_nid generation:  0.028155803680419922
local_in_edges_tensor generation:  0.04007744789123535
mini_batch_src_global generation:  0.059752702713012695
r_  generation:  0.504535436630249
local_output_nid generation:  0.028207778930664062
local_in_edges_tensor generation:  0.035906076431274414
mini_batch_src_global generation:  0.058699607849121094
r_  generation:  0.5089001655578613
local_output_nid generation:  0.028676748275756836
local_in_edges_tensor generation:  0.04484677314758301
mini_batch_src_global generation:  0.058542728424072266
r_  generation:  0.5058422088623047
local_output_nid generation:  0.028141021728515625
local_in_edges_tensor generation:  0.031604766845703125
mini_batch_src_global generation:  0.05882430076599121
r_  generation:  0.5099029541015625
local_output_nid generation:  0.028255939483642578
local_in_edges_tensor generation:  0.049689531326293945
mini_batch_src_global generation:  0.05901360511779785
r_  generation:  0.5065357685089111
local_output_nid generation:  0.028122901916503906
local_in_edges_tensor generation:  0.03665637969970703
mini_batch_src_global generation:  0.0587770938873291
r_  generation:  0.512824535369873
local_output_nid generation:  0.027945995330810547
local_in_edges_tensor generation:  0.03993105888366699
mini_batch_src_global generation:  0.05955815315246582
r_  generation:  0.5044543743133545
local_output_nid generation:  0.02808690071105957
local_in_edges_tensor generation:  0.03611946105957031
mini_batch_src_global generation:  0.058431386947631836
r_  generation:  0.5031037330627441
local_output_nid generation:  0.028206348419189453
local_in_edges_tensor generation:  0.04067850112915039
mini_batch_src_global generation:  0.05799603462219238
r_  generation:  0.5018572807312012
local_output_nid generation:  0.028902769088745117
local_in_edges_tensor generation:  0.03677082061767578
mini_batch_src_global generation:  0.06264638900756836
r_  generation:  0.5142910480499268
local_output_nid generation:  0.028156518936157227
local_in_edges_tensor generation:  0.03596353530883789
mini_batch_src_global generation:  0.06137895584106445
r_  generation:  0.5028302669525146
local_output_nid generation:  0.0283510684967041
local_in_edges_tensor generation:  0.03188657760620117
mini_batch_src_global generation:  0.05917692184448242
r_  generation:  0.5100393295288086
local_output_nid generation:  0.028723955154418945
local_in_edges_tensor generation:  0.04024028778076172
mini_batch_src_global generation:  0.05868864059448242
r_  generation:  0.5110502243041992
local_output_nid generation:  0.028476476669311523
local_in_edges_tensor generation:  0.036183834075927734
mini_batch_src_global generation:  0.059012413024902344
r_  generation:  0.5270266532897949
local_output_nid generation:  0.02916264533996582
local_in_edges_tensor generation:  0.04679083824157715
mini_batch_src_global generation:  0.06432533264160156
r_  generation:  0.5330910682678223
local_output_nid generation:  0.029811859130859375
local_in_edges_tensor generation:  0.04379916191101074
mini_batch_src_global generation:  0.0589601993560791
r_  generation:  0.5211403369903564
local_output_nid generation:  0.028926610946655273
local_in_edges_tensor generation:  0.032262325286865234
mini_batch_src_global generation:  0.06086325645446777
r_  generation:  0.5096502304077148
local_output_nid generation:  0.02850055694580078
local_in_edges_tensor generation:  0.03173208236694336
mini_batch_src_global generation:  0.05826902389526367
r_  generation:  0.5008924007415771
local_output_nid generation:  0.028496980667114258
local_in_edges_tensor generation:  0.04515361785888672
mini_batch_src_global generation:  0.06287145614624023
r_  generation:  0.5091307163238525
local_output_nid generation:  0.03171801567077637
local_in_edges_tensor generation:  0.03196978569030762
mini_batch_src_global generation:  0.05828452110290527
r_  generation:  0.5078017711639404
local_output_nid generation:  0.02860879898071289
local_in_edges_tensor generation:  0.03199577331542969
mini_batch_src_global generation:  0.059772491455078125
r_  generation:  0.5103185176849365
local_output_nid generation:  0.028537273406982422
local_in_edges_tensor generation:  0.03492164611816406
mini_batch_src_global generation:  0.0588531494140625
r_  generation:  0.511582612991333
local_output_nid generation:  0.028293609619140625
local_in_edges_tensor generation:  0.03685593605041504
mini_batch_src_global generation:  0.059966325759887695
r_  generation:  0.5096051692962646
----------------------check_connections_block total spend ----------------------------- 23.800782918930054
generate_one_block  0.7812390327453613
generate_one_block  0.6607844829559326
generate_one_block  0.6559529304504395
generate_one_block  0.634253978729248
generate_one_block  0.6563055515289307
generate_one_block  0.649052619934082
generate_one_block  0.6350834369659424
generate_one_block  0.6421546936035156
generate_one_block  0.6290285587310791
generate_one_block  0.6354355812072754
generate_one_block  0.6439263820648193
generate_one_block  0.6586158275604248
generate_one_block  0.6285347938537598
generate_one_block  0.6564347743988037
generate_one_block  0.6450328826904297
generate_one_block  0.6317079067230225
generate_one_block  0.6399040222167969
generate_one_block  0.6417186260223389
generate_one_block  0.6595745086669922
generate_one_block  0.6276614665985107
generate_one_block  0.6462371349334717
generate_one_block  0.6430301666259766
generate_one_block  0.6295297145843506
generate_one_block  0.6648974418640137
generate_one_block  0.6583549976348877
generate_one_block  0.6437630653381348
generate_one_block  0.6411228179931641
generate_one_block  0.6726508140563965
generate_one_block  0.6977393627166748
generate_one_block  0.6399154663085938
generate_one_block  0.6533191204071045
generate_one_block  0.6569578647613525
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  32.141210317611694
block generation total time  28.250779628753662
average batch blocks generation time:  0.8828368633985519
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1737060546875 GB
    Memory Allocated: 0.08943891525268555  GigaBytes
Max Memory Allocated: 0.08943891525268555  GigaBytes

torch.Size([149858, 128])
torch.Size([109807, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9822998046875 GB
    Memory Allocated: 0.6105961799621582  GigaBytes
Max Memory Allocated: 0.6349120140075684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.08966970443725586  GigaBytes
Max Memory Allocated: 0.7184014320373535  GigaBytes

torch.Size([149643, 128])
torch.Size([109146, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.6047496795654297  GigaBytes
Max Memory Allocated: 0.7184014320373535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3358154296875 GB
    Memory Allocated: 0.09082794189453125  GigaBytes
Max Memory Allocated: 0.7184014320373535  GigaBytes

torch.Size([150485, 128])
torch.Size([110991, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7674560546875 GB
    Memory Allocated: 0.6182284355163574  GigaBytes
Max Memory Allocated: 0.7184014320373535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.08974456787109375  GigaBytes
Max Memory Allocated: 0.7223296165466309  GigaBytes

torch.Size([150264, 128])
torch.Size([109015, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.5997219085693359  GigaBytes
Max Memory Allocated: 0.7223296165466309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09093284606933594  GigaBytes
Max Memory Allocated: 0.7223296165466309  GigaBytes

torch.Size([150437, 128])
torch.Size([111104, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6185617446899414  GigaBytes
Max Memory Allocated: 0.7223296165466309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09014415740966797  GigaBytes
Max Memory Allocated: 0.72320556640625  GigaBytes

torch.Size([150502, 128])
torch.Size([110503, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6109986305236816  GigaBytes
Max Memory Allocated: 0.72320556640625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09047985076904297  GigaBytes
Max Memory Allocated: 0.72320556640625  GigaBytes

torch.Size([150748, 128])
torch.Size([110323, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6090178489685059  GigaBytes
Max Memory Allocated: 0.72320556640625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09010696411132812  GigaBytes
Max Memory Allocated: 0.72320556640625  GigaBytes

torch.Size([150482, 128])
torch.Size([109890, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6099915504455566  GigaBytes
Max Memory Allocated: 0.72320556640625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09039020538330078  GigaBytes
Max Memory Allocated: 0.72320556640625  GigaBytes

torch.Size([150152, 128])
torch.Size([109310, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6028180122375488  GigaBytes
Max Memory Allocated: 0.72320556640625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.08936834335327148  GigaBytes
Max Memory Allocated: 0.72320556640625  GigaBytes

torch.Size([149635, 128])
torch.Size([108066, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.5960755348205566  GigaBytes
Max Memory Allocated: 0.72320556640625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09070205688476562  GigaBytes
Max Memory Allocated: 0.72320556640625  GigaBytes

torch.Size([150297, 128])
torch.Size([109440, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6074838638305664  GigaBytes
Max Memory Allocated: 0.72320556640625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09033727645874023  GigaBytes
Max Memory Allocated: 0.72320556640625  GigaBytes

torch.Size([150715, 128])
torch.Size([110807, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6136608123779297  GigaBytes
Max Memory Allocated: 0.72320556640625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09029483795166016  GigaBytes
Max Memory Allocated: 0.72320556640625  GigaBytes

torch.Size([149855, 128])
torch.Size([108758, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6002044677734375  GigaBytes
Max Memory Allocated: 0.72320556640625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09041070938110352  GigaBytes
Max Memory Allocated: 0.72320556640625  GigaBytes

torch.Size([150947, 128])
torch.Size([110957, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6128621101379395  GigaBytes
Max Memory Allocated: 0.72320556640625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09047889709472656  GigaBytes
Max Memory Allocated: 0.72320556640625  GigaBytes

torch.Size([150152, 128])
torch.Size([109516, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6055102348327637  GigaBytes
Max Memory Allocated: 0.72320556640625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.08956003189086914  GigaBytes
Max Memory Allocated: 0.72320556640625  GigaBytes

torch.Size([150133, 128])
torch.Size([108777, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.5981030464172363  GigaBytes
Max Memory Allocated: 0.72320556640625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.089630126953125  GigaBytes
Max Memory Allocated: 0.72320556640625  GigaBytes

torch.Size([149490, 128])
torch.Size([109248, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6036601066589355  GigaBytes
Max Memory Allocated: 0.72320556640625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.08959770202636719  GigaBytes
Max Memory Allocated: 0.72320556640625  GigaBytes

torch.Size([149534, 128])
torch.Size([109092, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6055946350097656  GigaBytes
Max Memory Allocated: 0.72320556640625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09071636199951172  GigaBytes
Max Memory Allocated: 0.72320556640625  GigaBytes

torch.Size([150923, 128])
torch.Size([111152, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6151447296142578  GigaBytes
Max Memory Allocated: 0.72320556640625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.08939409255981445  GigaBytes
Max Memory Allocated: 0.72320556640625  GigaBytes

torch.Size([149409, 128])
torch.Size([108752, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.600529670715332  GigaBytes
Max Memory Allocated: 0.72320556640625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09046363830566406  GigaBytes
Max Memory Allocated: 0.72320556640625  GigaBytes

torch.Size([150335, 128])
torch.Size([109211, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.603973388671875  GigaBytes
Max Memory Allocated: 0.72320556640625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.08989858627319336  GigaBytes
Max Memory Allocated: 0.72320556640625  GigaBytes

torch.Size([150365, 128])
torch.Size([109999, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6082868576049805  GigaBytes
Max Memory Allocated: 0.72320556640625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09033012390136719  GigaBytes
Max Memory Allocated: 0.72320556640625  GigaBytes

torch.Size([150621, 128])
torch.Size([109444, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6037640571594238  GigaBytes
Max Memory Allocated: 0.72320556640625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09051275253295898  GigaBytes
Max Memory Allocated: 0.72320556640625  GigaBytes

torch.Size([150793, 128])
torch.Size([111805, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6238880157470703  GigaBytes
Max Memory Allocated: 0.72320556640625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09056854248046875  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

torch.Size([150484, 128])
torch.Size([110017, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6095023155212402  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09007072448730469  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

torch.Size([150496, 128])
torch.Size([109904, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6090493202209473  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09037017822265625  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

torch.Size([150130, 128])
torch.Size([108983, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6030178070068359  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09010457992553711  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

torch.Size([150189, 128])
torch.Size([110369, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6126036643981934  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.0906219482421875  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

torch.Size([149976, 128])
torch.Size([109771, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6105771064758301  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.08980417251586914  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

torch.Size([149987, 128])
torch.Size([109345, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6034913063049316  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09067153930664062  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

torch.Size([149849, 128])
torch.Size([109708, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6111602783203125  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.08983850479125977  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

torch.Size([150449, 128])
torch.Size([109635, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6049633026123047  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.051795028150081635 |0.027676254510879517 |0.028168395161628723 |9.289383888244629e-05 |0.006907030940055847 |0.005167961120605469 |
----------------------------------------------------------pseudo_mini_loss sum 6.3133978843688965
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9159453
Number of first layer input nodes during this epoch:  4807335
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.11308860778808594  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023705005645751953
random selection method range initialization spend 0.006703615188598633
time for parepare:  0.019155263900756836
local_output_nid generation:  0.0012288093566894531
local_in_edges_tensor generation:  0.007119417190551758
mini_batch_src_global generation:  0.0023450851440429688
r_  generation:  0.011114835739135742
local_output_nid generation:  0.0015463829040527344
local_in_edges_tensor generation:  0.0009698867797851562
mini_batch_src_global generation:  0.001645803451538086
r_  generation:  0.010131120681762695
local_output_nid generation:  0.0015468597412109375
local_in_edges_tensor generation:  0.0008597373962402344
mini_batch_src_global generation:  0.0011749267578125
r_  generation:  0.009678125381469727
local_output_nid generation:  0.0015556812286376953
local_in_edges_tensor generation:  0.0008358955383300781
mini_batch_src_global generation:  0.001033782958984375
r_  generation:  0.009690523147583008
local_output_nid generation:  0.001506805419921875
local_in_edges_tensor generation:  0.0008220672607421875
mini_batch_src_global generation:  0.0010371208190917969
r_  generation:  0.009905576705932617
local_output_nid generation:  0.0014863014221191406
local_in_edges_tensor generation:  0.002262592315673828
mini_batch_src_global generation:  0.0010995864868164062
r_  generation:  0.009827136993408203
local_output_nid generation:  0.0015225410461425781
local_in_edges_tensor generation:  0.0008032321929931641
mini_batch_src_global generation:  0.0010352134704589844
r_  generation:  0.010037899017333984
local_output_nid generation:  0.001489877700805664
local_in_edges_tensor generation:  0.0007865428924560547
mini_batch_src_global generation:  0.0010204315185546875
r_  generation:  0.010077476501464844
local_output_nid generation:  0.0015461444854736328
local_in_edges_tensor generation:  0.0008015632629394531
mini_batch_src_global generation:  0.0010004043579101562
r_  generation:  0.009541511535644531
local_output_nid generation:  0.0014996528625488281
local_in_edges_tensor generation:  0.0007727146148681641
mini_batch_src_global generation:  0.0010733604431152344
r_  generation:  0.010318517684936523
local_output_nid generation:  0.0014851093292236328
local_in_edges_tensor generation:  0.0008068084716796875
mini_batch_src_global generation:  0.0010344982147216797
r_  generation:  0.009938716888427734
local_output_nid generation:  0.0014853477478027344
local_in_edges_tensor generation:  0.0007660388946533203
mini_batch_src_global generation:  0.0010311603546142578
r_  generation:  0.012315034866333008
local_output_nid generation:  0.0014872550964355469
local_in_edges_tensor generation:  0.0007836818695068359
mini_batch_src_global generation:  0.0010590553283691406
r_  generation:  0.010528802871704102
local_output_nid generation:  0.0014958381652832031
local_in_edges_tensor generation:  0.0007655620574951172
mini_batch_src_global generation:  0.0010180473327636719
r_  generation:  0.009722709655761719
local_output_nid generation:  0.0014882087707519531
local_in_edges_tensor generation:  0.0007526874542236328
mini_batch_src_global generation:  0.0010485649108886719
r_  generation:  0.009723663330078125
local_output_nid generation:  0.001477956771850586
local_in_edges_tensor generation:  0.0007481575012207031
mini_batch_src_global generation:  0.001010894775390625
r_  generation:  0.009742498397827148
local_output_nid generation:  0.0014851093292236328
local_in_edges_tensor generation:  0.0008018016815185547
mini_batch_src_global generation:  0.0010614395141601562
r_  generation:  0.010134220123291016
local_output_nid generation:  0.0014748573303222656
local_in_edges_tensor generation:  0.0007615089416503906
mini_batch_src_global generation:  0.0010807514190673828
r_  generation:  0.010076522827148438
local_output_nid generation:  0.0014717578887939453
local_in_edges_tensor generation:  0.0007345676422119141
mini_batch_src_global generation:  0.0010578632354736328
r_  generation:  0.011632919311523438
local_output_nid generation:  0.001497507095336914
local_in_edges_tensor generation:  0.0007708072662353516
mini_batch_src_global generation:  0.001047372817993164
r_  generation:  0.010263681411743164
local_output_nid generation:  0.001550912857055664
local_in_edges_tensor generation:  0.0007946491241455078
mini_batch_src_global generation:  0.0010766983032226562
r_  generation:  0.010417461395263672
local_output_nid generation:  0.00154876708984375
local_in_edges_tensor generation:  0.0007610321044921875
mini_batch_src_global generation:  0.001047372817993164
r_  generation:  0.009917020797729492
local_output_nid generation:  0.0015118122100830078
local_in_edges_tensor generation:  0.0007796287536621094
mini_batch_src_global generation:  0.0010499954223632812
r_  generation:  0.010083913803100586
local_output_nid generation:  0.0015299320220947266
local_in_edges_tensor generation:  0.0007648468017578125
mini_batch_src_global generation:  0.0010480880737304688
r_  generation:  0.010169744491577148
local_output_nid generation:  0.0014963150024414062
local_in_edges_tensor generation:  0.0008041858673095703
mini_batch_src_global generation:  0.0010764598846435547
r_  generation:  0.01023244857788086
local_output_nid generation:  0.0029506683349609375
local_in_edges_tensor generation:  0.0007815361022949219
mini_batch_src_global generation:  0.001050710678100586
r_  generation:  0.00995326042175293
local_output_nid generation:  0.001519918441772461
local_in_edges_tensor generation:  0.0007746219635009766
mini_batch_src_global generation:  0.0010917186737060547
r_  generation:  0.010473966598510742
local_output_nid generation:  0.0014851093292236328
local_in_edges_tensor generation:  0.0007524490356445312
mini_batch_src_global generation:  0.0010752677917480469
r_  generation:  0.010662078857421875
local_output_nid generation:  0.0014989376068115234
local_in_edges_tensor generation:  0.0007526874542236328
mini_batch_src_global generation:  0.0010144710540771484
r_  generation:  0.010259151458740234
local_output_nid generation:  0.0015189647674560547
local_in_edges_tensor generation:  0.0007584095001220703
mini_batch_src_global generation:  0.0010678768157958984
r_  generation:  0.010219573974609375
local_output_nid generation:  0.0014934539794921875
local_in_edges_tensor generation:  0.0007567405700683594
mini_batch_src_global generation:  0.0010385513305664062
r_  generation:  0.009864091873168945
local_output_nid generation:  0.0014805793762207031
local_in_edges_tensor generation:  0.0007414817810058594
mini_batch_src_global generation:  0.0010228157043457031
r_  generation:  0.01263737678527832
----------------------check_connections_block total spend ----------------------------- 0.556708574295044
generate_one_block  0.019684553146362305
generate_one_block  0.018086910247802734
generate_one_block  0.015289306640625
generate_one_block  0.01482701301574707
generate_one_block  0.015154600143432617
generate_one_block  0.016631364822387695
generate_one_block  0.015049219131469727
generate_one_block  0.01460409164428711
generate_one_block  0.014405012130737305
generate_one_block  0.015398740768432617
generate_one_block  0.014479637145996094
generate_one_block  0.014688730239868164
generate_one_block  0.017497539520263672
generate_one_block  0.014097929000854492
generate_one_block  0.014463186264038086
generate_one_block  0.014394521713256836
generate_one_block  0.01520991325378418
generate_one_block  0.015325307846069336
generate_one_block  0.014677286148071289
generate_one_block  0.017284393310546875
generate_one_block  0.014934778213500977
generate_one_block  0.014580249786376953
generate_one_block  0.014692068099975586
generate_one_block  0.015001773834228516
generate_one_block  0.0155792236328125
generate_one_block  0.01475214958190918
generate_one_block  0.017638444900512695
generate_one_block  0.014701128005981445
generate_one_block  0.014269828796386719
generate_one_block  0.014946460723876953
generate_one_block  0.014464378356933594
generate_one_block  0.014747858047485352
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04765629768371582
gen group dst list time:  0.021445512771606445
time for parepare:  0.019286394119262695
local_output_nid generation:  0.0056035518646240234
local_in_edges_tensor generation:  0.017311811447143555
mini_batch_src_global generation:  0.019106149673461914
r_  generation:  0.16808390617370605
local_output_nid generation:  0.008655309677124023
local_in_edges_tensor generation:  0.015267133712768555
mini_batch_src_global generation:  0.024880170822143555
r_  generation:  0.17809152603149414
local_output_nid generation:  0.008786439895629883
local_in_edges_tensor generation:  0.03458285331726074
mini_batch_src_global generation:  0.022591114044189453
r_  generation:  0.19393420219421387
local_output_nid generation:  0.011852502822875977
local_in_edges_tensor generation:  0.018421173095703125
mini_batch_src_global generation:  0.02490711212158203
r_  generation:  0.17751550674438477
local_output_nid generation:  0.00886988639831543
local_in_edges_tensor generation:  0.015806913375854492
mini_batch_src_global generation:  0.022043943405151367
r_  generation:  0.1886439323425293
local_output_nid generation:  0.008359432220458984
local_in_edges_tensor generation:  0.008991718292236328
mini_batch_src_global generation:  0.0223691463470459
r_  generation:  0.19271469116210938
local_output_nid generation:  0.008560419082641602
local_in_edges_tensor generation:  0.010456323623657227
mini_batch_src_global generation:  0.024535179138183594
r_  generation:  0.18791532516479492
local_output_nid generation:  0.008445262908935547
local_in_edges_tensor generation:  0.011993885040283203
mini_batch_src_global generation:  0.022538423538208008
r_  generation:  0.18073558807373047
local_output_nid generation:  0.008375406265258789
local_in_edges_tensor generation:  0.008805513381958008
mini_batch_src_global generation:  0.022379159927368164
r_  generation:  0.18459868431091309
local_output_nid generation:  0.009156942367553711
local_in_edges_tensor generation:  0.012332439422607422
mini_batch_src_global generation:  0.023223400115966797
r_  generation:  0.19381928443908691
local_output_nid generation:  0.008686542510986328
local_in_edges_tensor generation:  0.008804559707641602
mini_batch_src_global generation:  0.022536754608154297
r_  generation:  0.18338799476623535
local_output_nid generation:  0.009752511978149414
local_in_edges_tensor generation:  0.018633127212524414
mini_batch_src_global generation:  0.02507615089416504
r_  generation:  0.1930842399597168
local_output_nid generation:  0.011113643646240234
local_in_edges_tensor generation:  0.012083292007446289
mini_batch_src_global generation:  0.02417755126953125
r_  generation:  0.19172096252441406
local_output_nid generation:  0.00859832763671875
local_in_edges_tensor generation:  0.010896444320678711
mini_batch_src_global generation:  0.02248978614807129
r_  generation:  0.17592191696166992
local_output_nid generation:  0.008636474609375
local_in_edges_tensor generation:  0.010034561157226562
mini_batch_src_global generation:  0.021929025650024414
r_  generation:  0.17993950843811035
local_output_nid generation:  0.0086517333984375
local_in_edges_tensor generation:  0.010087966918945312
mini_batch_src_global generation:  0.02183985710144043
r_  generation:  0.17610597610473633
local_output_nid generation:  0.008848190307617188
local_in_edges_tensor generation:  0.010225772857666016
mini_batch_src_global generation:  0.023862123489379883
r_  generation:  0.18488550186157227
local_output_nid generation:  0.00878453254699707
local_in_edges_tensor generation:  0.009015798568725586
mini_batch_src_global generation:  0.02299332618713379
r_  generation:  0.18757891654968262
local_output_nid generation:  0.008512020111083984
local_in_edges_tensor generation:  0.01091766357421875
mini_batch_src_global generation:  0.022673606872558594
r_  generation:  0.18312621116638184
local_output_nid generation:  0.008360147476196289
local_in_edges_tensor generation:  0.011500120162963867
mini_batch_src_global generation:  0.023059368133544922
r_  generation:  0.18372154235839844
local_output_nid generation:  0.008419513702392578
local_in_edges_tensor generation:  0.011979341506958008
mini_batch_src_global generation:  0.02273726463317871
r_  generation:  0.18837761878967285
local_output_nid generation:  0.00821065902709961
local_in_edges_tensor generation:  0.008569002151489258
mini_batch_src_global generation:  0.022464275360107422
r_  generation:  0.18038606643676758
local_output_nid generation:  0.008374691009521484
local_in_edges_tensor generation:  0.011608123779296875
mini_batch_src_global generation:  0.023651838302612305
r_  generation:  0.18558955192565918
local_output_nid generation:  0.009319305419921875
local_in_edges_tensor generation:  0.01096034049987793
mini_batch_src_global generation:  0.02523326873779297
r_  generation:  0.19881224632263184
local_output_nid generation:  0.010559320449829102
local_in_edges_tensor generation:  0.019609451293945312
mini_batch_src_global generation:  0.02706003189086914
r_  generation:  0.1853790283203125
local_output_nid generation:  0.008337736129760742
local_in_edges_tensor generation:  0.011380434036254883
mini_batch_src_global generation:  0.022869348526000977
r_  generation:  0.18345165252685547
local_output_nid generation:  0.008659124374389648
local_in_edges_tensor generation:  0.010027647018432617
mini_batch_src_global generation:  0.025452852249145508
r_  generation:  0.19388246536254883
local_output_nid generation:  0.008445024490356445
local_in_edges_tensor generation:  0.01194143295288086
mini_batch_src_global generation:  0.023283720016479492
r_  generation:  0.18588495254516602
local_output_nid generation:  0.008193016052246094
local_in_edges_tensor generation:  0.009018421173095703
mini_batch_src_global generation:  0.02214646339416504
r_  generation:  0.1789696216583252
local_output_nid generation:  0.008434295654296875
local_in_edges_tensor generation:  0.009451150894165039
mini_batch_src_global generation:  0.03791403770446777
r_  generation:  0.18726587295532227
local_output_nid generation:  0.008351564407348633
local_in_edges_tensor generation:  0.008889198303222656
mini_batch_src_global generation:  0.02730846405029297
r_  generation:  0.1813511848449707
local_output_nid generation:  0.008295297622680664
local_in_edges_tensor generation:  0.009720325469970703
mini_batch_src_global generation:  0.03236031532287598
r_  generation:  0.18473052978515625
----------------------check_connections_block total spend ----------------------------- 8.702744483947754
generate_one_block  0.23284268379211426
generate_one_block  0.23076367378234863
generate_one_block  0.23708367347717285
generate_one_block  0.22458958625793457
generate_one_block  0.258852481842041
generate_one_block  0.22799110412597656
generate_one_block  0.23388433456420898
generate_one_block  0.22562861442565918
generate_one_block  0.22374248504638672
generate_one_block  0.23460936546325684
generate_one_block  0.22112727165222168
generate_one_block  0.22385454177856445
generate_one_block  0.2386317253112793
generate_one_block  0.22455239295959473
generate_one_block  0.21915698051452637
generate_one_block  0.2218494415283203
generate_one_block  0.22945523262023926
generate_one_block  0.22847628593444824
generate_one_block  0.22685647010803223
generate_one_block  0.2633793354034424
generate_one_block  0.23528742790222168
generate_one_block  0.22672200202941895
generate_one_block  0.2267000675201416
generate_one_block  0.23271632194519043
generate_one_block  0.23298239707946777
generate_one_block  0.22335505485534668
generate_one_block  0.2460167407989502
generate_one_block  0.23235249519348145
generate_one_block  0.2182614803314209
generate_one_block  0.22896790504455566
generate_one_block  0.2209784984588623
generate_one_block  0.2213730812072754
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.10273861885070801
gen group dst list time:  0.112823486328125
time for parepare:  0.019386768341064453
local_output_nid generation:  0.024149179458618164
local_in_edges_tensor generation:  0.07110261917114258
mini_batch_src_global generation:  0.04978680610656738
r_  generation:  0.4988076686859131
local_output_nid generation:  0.030139684677124023
local_in_edges_tensor generation:  0.047728776931762695
mini_batch_src_global generation:  0.061747074127197266
r_  generation:  0.49728846549987793
local_output_nid generation:  0.02984023094177246
local_in_edges_tensor generation:  0.043740034103393555
mini_batch_src_global generation:  0.05688071250915527
r_  generation:  0.5083847045898438
local_output_nid generation:  0.028835535049438477
local_in_edges_tensor generation:  0.029597759246826172
mini_batch_src_global generation:  0.05821824073791504
r_  generation:  0.5056679248809814
local_output_nid generation:  0.02861928939819336
local_in_edges_tensor generation:  0.033455848693847656
mini_batch_src_global generation:  0.05776262283325195
r_  generation:  0.5064578056335449
local_output_nid generation:  0.02853870391845703
local_in_edges_tensor generation:  0.0339503288269043
mini_batch_src_global generation:  0.05945110321044922
r_  generation:  0.5085818767547607
local_output_nid generation:  0.028487205505371094
local_in_edges_tensor generation:  0.02929401397705078
mini_batch_src_global generation:  0.0622713565826416
r_  generation:  0.5150027275085449
local_output_nid generation:  0.028349637985229492
local_in_edges_tensor generation:  0.03397774696350098
mini_batch_src_global generation:  0.059258222579956055
r_  generation:  0.5010702610015869
local_output_nid generation:  0.028638601303100586
local_in_edges_tensor generation:  0.03869032859802246
mini_batch_src_global generation:  0.06288957595825195
r_  generation:  0.5143072605133057
local_output_nid generation:  0.02962017059326172
local_in_edges_tensor generation:  0.04266786575317383
mini_batch_src_global generation:  0.06365442276000977
r_  generation:  0.5075263977050781
local_output_nid generation:  0.028560400009155273
local_in_edges_tensor generation:  0.030126333236694336
mini_batch_src_global generation:  0.05930519104003906
r_  generation:  0.51051926612854
local_output_nid generation:  0.02867913246154785
local_in_edges_tensor generation:  0.02973318099975586
mini_batch_src_global generation:  0.06026339530944824
r_  generation:  0.5076155662536621
local_output_nid generation:  0.028948068618774414
local_in_edges_tensor generation:  0.03442239761352539
mini_batch_src_global generation:  0.05943584442138672
r_  generation:  0.5118215084075928
local_output_nid generation:  0.028789997100830078
local_in_edges_tensor generation:  0.03842926025390625
mini_batch_src_global generation:  0.05883216857910156
r_  generation:  0.5067038536071777
local_output_nid generation:  0.028949499130249023
local_in_edges_tensor generation:  0.03383684158325195
mini_batch_src_global generation:  0.058461666107177734
r_  generation:  0.5076944828033447
local_output_nid generation:  0.028693675994873047
local_in_edges_tensor generation:  0.03954720497131348
mini_batch_src_global generation:  0.0593264102935791
r_  generation:  0.506843090057373
local_output_nid generation:  0.029166698455810547
local_in_edges_tensor generation:  0.034371137619018555
mini_batch_src_global generation:  0.05879545211791992
r_  generation:  0.5151293277740479
local_output_nid generation:  0.03336071968078613
local_in_edges_tensor generation:  0.04565620422363281
mini_batch_src_global generation:  0.06353473663330078
r_  generation:  0.5088651180267334
local_output_nid generation:  0.028851747512817383
local_in_edges_tensor generation:  0.03932356834411621
mini_batch_src_global generation:  0.05880165100097656
r_  generation:  0.5144152641296387
local_output_nid generation:  0.028821706771850586
local_in_edges_tensor generation:  0.04517102241516113
mini_batch_src_global generation:  0.05972647666931152
r_  generation:  0.5323085784912109
local_output_nid generation:  0.031870365142822266
local_in_edges_tensor generation:  0.029315948486328125
mini_batch_src_global generation:  0.06208062171936035
r_  generation:  0.5118036270141602
local_output_nid generation:  0.029443979263305664
local_in_edges_tensor generation:  0.029535770416259766
mini_batch_src_global generation:  0.05948972702026367
r_  generation:  0.5086054801940918
local_output_nid generation:  0.029539823532104492
local_in_edges_tensor generation:  0.02957439422607422
mini_batch_src_global generation:  0.05810427665710449
r_  generation:  0.5151374340057373
local_output_nid generation:  0.02927422523498535
local_in_edges_tensor generation:  0.03830885887145996
mini_batch_src_global generation:  0.05914878845214844
r_  generation:  0.5067780017852783
local_output_nid generation:  0.029834508895874023
local_in_edges_tensor generation:  0.04276752471923828
mini_batch_src_global generation:  0.05838751792907715
r_  generation:  0.5157225131988525
local_output_nid generation:  0.029776811599731445
local_in_edges_tensor generation:  0.029870033264160156
mini_batch_src_global generation:  0.05894899368286133
r_  generation:  0.5099198818206787
local_output_nid generation:  0.0296328067779541
local_in_edges_tensor generation:  0.029886960983276367
mini_batch_src_global generation:  0.06457948684692383
r_  generation:  0.5195455551147461
local_output_nid generation:  0.029717683792114258
local_in_edges_tensor generation:  0.0426030158996582
mini_batch_src_global generation:  0.059828758239746094
r_  generation:  0.5121257305145264
local_output_nid generation:  0.02923274040222168
local_in_edges_tensor generation:  0.029809236526489258
mini_batch_src_global generation:  0.059032440185546875
r_  generation:  0.5066676139831543
local_output_nid generation:  0.029536008834838867
local_in_edges_tensor generation:  0.04809212684631348
mini_batch_src_global generation:  0.059462547302246094
r_  generation:  0.5099172592163086
local_output_nid generation:  0.029392719268798828
local_in_edges_tensor generation:  0.029662609100341797
mini_batch_src_global generation:  0.059923410415649414
r_  generation:  0.5198347568511963
local_output_nid generation:  0.02926802635192871
local_in_edges_tensor generation:  0.03379058837890625
mini_batch_src_global generation:  0.06256341934204102
r_  generation:  0.5055499076843262
----------------------check_connections_block total spend ----------------------------- 23.810884952545166
generate_one_block  0.6616005897521973
generate_one_block  0.6582398414611816
generate_one_block  0.6516931056976318
generate_one_block  0.6338117122650146
generate_one_block  0.7486157417297363
generate_one_block  0.6404240131378174
generate_one_block  0.6457817554473877
generate_one_block  0.6433343887329102
generate_one_block  0.6437599658966064
generate_one_block  0.6522870063781738
generate_one_block  0.6445987224578857
generate_one_block  0.6354002952575684
generate_one_block  0.6480975151062012
generate_one_block  0.643857479095459
generate_one_block  0.6421244144439697
generate_one_block  0.6466028690338135
generate_one_block  0.6451919078826904
generate_one_block  0.6812460422515869
generate_one_block  0.7053637504577637
generate_one_block  0.6481566429138184
generate_one_block  0.6446247100830078
generate_one_block  0.6645450592041016
generate_one_block  0.648190975189209
generate_one_block  0.6764545440673828
generate_one_block  0.6880819797515869
generate_one_block  0.654170036315918
generate_one_block  0.6787436008453369
generate_one_block  0.6565566062927246
generate_one_block  0.6371128559112549
generate_one_block  0.6583456993103027
generate_one_block  0.6507964134216309
generate_one_block  0.6515059471130371
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.11308860778808594  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

connection checking time:  32.51362943649292
block generation total time  28.40235733985901
average batch blocks generation time:  0.887573666870594
block dataloader generation time/epoch 63.716171979904175
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.09224653244018555  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

torch.Size([150671, 128])
torch.Size([110599, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.6123905181884766  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.09192895889282227  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

torch.Size([150647, 128])
torch.Size([110495, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.6132164001464844  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.09238147735595703  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

torch.Size([150237, 128])
torch.Size([110955, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.6181597709655762  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.0917201042175293  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

torch.Size([150571, 128])
torch.Size([110419, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.6121630668640137  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.092376708984375  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

torch.Size([150480, 128])
torch.Size([110212, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.6144771575927734  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.09154129028320312  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

torch.Size([150322, 128])
torch.Size([109439, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.6068463325500488  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.09235286712646484  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

torch.Size([150269, 128])
torch.Size([110148, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.6140885353088379  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.091461181640625  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

torch.Size([150064, 128])
torch.Size([109476, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.6080179214477539  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.09217262268066406  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

torch.Size([150318, 128])
torch.Size([110007, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.6094589233398438  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.09192323684692383  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

torch.Size([150573, 128])
torch.Size([110512, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.614410400390625  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.09213924407958984  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

torch.Size([150343, 128])
torch.Size([110031, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.6098203659057617  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.0915689468383789  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

torch.Size([150458, 128])
torch.Size([109682, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.6097536087036133  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.0924234390258789  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

torch.Size([150539, 128])
torch.Size([110175, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.6147599220275879  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.091339111328125  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

torch.Size([150196, 128])
torch.Size([109168, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.6030688285827637  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.09198284149169922  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

torch.Size([150033, 128])
torch.Size([109176, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.6034054756164551  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.09113073348999023  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

torch.Size([149903, 128])
torch.Size([108759, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.6015200614929199  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.09225273132324219  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

torch.Size([150609, 128])
torch.Size([110236, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.6114416122436523  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.09166479110717773  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

torch.Size([150503, 128])
torch.Size([109969, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.6116433143615723  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.0921783447265625  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

torch.Size([150284, 128])
torch.Size([110090, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.6107335090637207  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.09139871597290039  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

torch.Size([149895, 128])
torch.Size([109384, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.6074113845825195  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.09219169616699219  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

torch.Size([150027, 128])
torch.Size([109507, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.6081118583679199  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.09121322631835938  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

torch.Size([149898, 128])
torch.Size([109182, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.6034612655639648  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.09215068817138672  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

torch.Size([150764, 128])
torch.Size([109653, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.6109089851379395  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.09135198593139648  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

torch.Size([149861, 128])
torch.Size([109218, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.6066098213195801  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.09231090545654297  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

torch.Size([150878, 128])
torch.Size([111172, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.616767406463623  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.09153985977172852  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

torch.Size([150257, 128])
torch.Size([109726, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.6100449562072754  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.092529296875  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

torch.Size([150049, 128])
torch.Size([110638, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.6165037155151367  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.09188222885131836  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

torch.Size([150647, 128])
torch.Size([110650, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.6129755973815918  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.0919942855834961  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

torch.Size([150155, 128])
torch.Size([109033, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.602846622467041  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.0918264389038086  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

torch.Size([150600, 128])
torch.Size([110168, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.6118888854980469  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.09205341339111328  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

torch.Size([150290, 128])
torch.Size([109289, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.6064229011535645  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.09152078628540039  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

torch.Size([150455, 128])
torch.Size([109471, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 0.6072807312011719  GigaBytes
Max Memory Allocated: 0.7305879592895508  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04860196262598038 |0.017755024135112762 |0.003648042678833008 |9.141117334365845e-05 |0.003379024565219879 |0.0016255378723144531 |
----------------------------------------------------------pseudo_mini_loss sum 3.245595693588257
Total (block generation + training)time/epoch 66.14008736610413
Training time/epoch 2.4235997200012207
Training time without block to device /epoch 1.8554389476776123
Training time without total dataloading part /epoch 0.2294168472290039
load block tensor time/epoch 1.555262804031372
block to device time/epoch 0.5681607723236084
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9167954
Number of first layer input nodes during this epoch:  4810796
