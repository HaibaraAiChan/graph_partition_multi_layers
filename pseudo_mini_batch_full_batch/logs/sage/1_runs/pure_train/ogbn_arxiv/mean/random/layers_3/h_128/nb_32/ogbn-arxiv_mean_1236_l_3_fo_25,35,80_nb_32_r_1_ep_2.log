Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648442043.4311054
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027550458908081055
random selection method range initialization spend 0.0060422420501708984
time for parepare:  0.01870560646057129
local_output_nid generation:  0.0011043548583984375
local_in_edges_tensor generation:  0.004202365875244141
mini_batch_src_global generation:  0.0015590190887451172
r_  generation:  0.01031637191772461
local_output_nid generation:  0.0012750625610351562
local_in_edges_tensor generation:  0.0009989738464355469
mini_batch_src_global generation:  0.0015993118286132812
r_  generation:  0.009320974349975586
local_output_nid generation:  0.0013573169708251953
local_in_edges_tensor generation:  0.0009145736694335938
mini_batch_src_global generation:  0.0011289119720458984
r_  generation:  0.009546756744384766
local_output_nid generation:  0.0014066696166992188
local_in_edges_tensor generation:  0.0008747577667236328
mini_batch_src_global generation:  0.0009617805480957031
r_  generation:  0.009176492691040039
local_output_nid generation:  0.0014104843139648438
local_in_edges_tensor generation:  0.0008563995361328125
mini_batch_src_global generation:  0.0009274482727050781
r_  generation:  0.008882284164428711
local_output_nid generation:  0.001435995101928711
local_in_edges_tensor generation:  0.0008451938629150391
mini_batch_src_global generation:  0.0010075569152832031
r_  generation:  0.00947260856628418
local_output_nid generation:  0.0014319419860839844
local_in_edges_tensor generation:  0.0008535385131835938
mini_batch_src_global generation:  0.0009789466857910156
r_  generation:  0.009514808654785156
local_output_nid generation:  0.0014374256134033203
local_in_edges_tensor generation:  0.0008416175842285156
mini_batch_src_global generation:  0.0009388923645019531
r_  generation:  0.009349346160888672
local_output_nid generation:  0.001438140869140625
local_in_edges_tensor generation:  0.0008103847503662109
mini_batch_src_global generation:  0.0010564327239990234
r_  generation:  0.009702920913696289
local_output_nid generation:  0.001425027847290039
local_in_edges_tensor generation:  0.000820159912109375
mini_batch_src_global generation:  0.001012563705444336
r_  generation:  0.009803295135498047
local_output_nid generation:  0.0014505386352539062
local_in_edges_tensor generation:  0.0008289813995361328
mini_batch_src_global generation:  0.0010056495666503906
r_  generation:  0.009986400604248047
local_output_nid generation:  0.001455068588256836
local_in_edges_tensor generation:  0.0008003711700439453
mini_batch_src_global generation:  0.0009989738464355469
r_  generation:  0.010018348693847656
local_output_nid generation:  0.001447439193725586
local_in_edges_tensor generation:  0.0007948875427246094
mini_batch_src_global generation:  0.0010027885437011719
r_  generation:  0.009792327880859375
local_output_nid generation:  0.0014338493347167969
local_in_edges_tensor generation:  0.0008025169372558594
mini_batch_src_global generation:  0.0010366439819335938
r_  generation:  0.01038503646850586
local_output_nid generation:  0.001451730728149414
local_in_edges_tensor generation:  0.0008342266082763672
mini_batch_src_global generation:  0.0010862350463867188
r_  generation:  0.01009988784790039
local_output_nid generation:  0.001451253890991211
local_in_edges_tensor generation:  0.0008151531219482422
mini_batch_src_global generation:  0.0011272430419921875
r_  generation:  0.010576248168945312
local_output_nid generation:  0.0014605522155761719
local_in_edges_tensor generation:  0.0008091926574707031
mini_batch_src_global generation:  0.0010521411895751953
r_  generation:  0.010008573532104492
local_output_nid generation:  0.001451253890991211
local_in_edges_tensor generation:  0.000823974609375
mini_batch_src_global generation:  0.001041412353515625
r_  generation:  0.009746551513671875
local_output_nid generation:  0.0014553070068359375
local_in_edges_tensor generation:  0.0008282661437988281
mini_batch_src_global generation:  0.0010390281677246094
r_  generation:  0.010039806365966797
local_output_nid generation:  0.0014748573303222656
local_in_edges_tensor generation:  0.000835418701171875
mini_batch_src_global generation:  0.0010957717895507812
r_  generation:  0.010123968124389648
local_output_nid generation:  0.0014693737030029297
local_in_edges_tensor generation:  0.0008175373077392578
mini_batch_src_global generation:  0.0010535717010498047
r_  generation:  0.009947538375854492
local_output_nid generation:  0.0014488697052001953
local_in_edges_tensor generation:  0.000820159912109375
mini_batch_src_global generation:  0.0010204315185546875
r_  generation:  0.010079622268676758
local_output_nid generation:  0.001474142074584961
local_in_edges_tensor generation:  0.0008177757263183594
mini_batch_src_global generation:  0.0010678768157958984
r_  generation:  0.010414361953735352
local_output_nid generation:  0.0014772415161132812
local_in_edges_tensor generation:  0.0008189678192138672
mini_batch_src_global generation:  0.001028299331665039
r_  generation:  0.009786367416381836
local_output_nid generation:  0.0014710426330566406
local_in_edges_tensor generation:  0.0008261203765869141
mini_batch_src_global generation:  0.001046895980834961
r_  generation:  0.009970664978027344
local_output_nid generation:  0.0014672279357910156
local_in_edges_tensor generation:  0.0008153915405273438
mini_batch_src_global generation:  0.0010600090026855469
r_  generation:  0.010203361511230469
local_output_nid generation:  0.0015075206756591797
local_in_edges_tensor generation:  0.0008456707000732422
mini_batch_src_global generation:  0.0010333061218261719
r_  generation:  0.00976705551147461
local_output_nid generation:  0.0014584064483642578
local_in_edges_tensor generation:  0.0008280277252197266
mini_batch_src_global generation:  0.0010068416595458984
r_  generation:  0.010030746459960938
local_output_nid generation:  0.0014548301696777344
local_in_edges_tensor generation:  0.0008177757263183594
mini_batch_src_global generation:  0.0010099411010742188
r_  generation:  0.009814739227294922
local_output_nid generation:  0.0014719963073730469
local_in_edges_tensor generation:  0.005641460418701172
mini_batch_src_global generation:  0.0013082027435302734
r_  generation:  0.010509729385375977
local_output_nid generation:  0.0013499259948730469
local_in_edges_tensor generation:  0.0008502006530761719
mini_batch_src_global generation:  0.0011837482452392578
r_  generation:  0.010332107543945312
local_output_nid generation:  0.0014061927795410156
local_in_edges_tensor generation:  0.0008528232574462891
mini_batch_src_global generation:  0.0011379718780517578
r_  generation:  0.009885549545288086
----------------------check_connections_block total spend ----------------------------- 0.5414886474609375
generate_one_block  0.015302658081054688
generate_one_block  0.014868736267089844
generate_one_block  0.015280723571777344
generate_one_block  0.014444589614868164
generate_one_block  0.014201641082763672
generate_one_block  0.014386177062988281
generate_one_block  0.014565467834472656
generate_one_block  0.014381170272827148
generate_one_block  0.015105247497558594
generate_one_block  0.015116214752197266
generate_one_block  0.015132904052734375
generate_one_block  0.015105009078979492
generate_one_block  0.014723539352416992
generate_one_block  0.015427827835083008
generate_one_block  0.015121221542358398
generate_one_block  0.01564955711364746
generate_one_block  0.014796257019042969
generate_one_block  0.014658451080322266
generate_one_block  0.014796733856201172
generate_one_block  0.015311241149902344
generate_one_block  0.015074014663696289
generate_one_block  0.0148468017578125
generate_one_block  0.01558685302734375
generate_one_block  0.014676570892333984
generate_one_block  0.015023946762084961
generate_one_block  0.015279293060302734
generate_one_block  0.014553070068359375
generate_one_block  0.014557838439941406
generate_one_block  0.014771461486816406
generate_one_block  0.015301704406738281
generate_one_block  0.015722036361694336
generate_one_block  0.014761686325073242
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.042406558990478516
gen group dst list time:  0.023378372192382812
time for parepare:  0.02001667022705078
local_output_nid generation:  0.005450010299682617
local_in_edges_tensor generation:  0.013733863830566406
mini_batch_src_global generation:  0.01287388801574707
r_  generation:  0.1289656162261963
local_output_nid generation:  0.01024937629699707
local_in_edges_tensor generation:  0.012850522994995117
mini_batch_src_global generation:  0.016405820846557617
r_  generation:  0.13825750350952148
local_output_nid generation:  0.010531187057495117
local_in_edges_tensor generation:  0.013451337814331055
mini_batch_src_global generation:  0.015547513961791992
r_  generation:  0.14304852485656738
local_output_nid generation:  0.009912729263305664
local_in_edges_tensor generation:  0.0092926025390625
mini_batch_src_global generation:  0.018811464309692383
r_  generation:  0.140883207321167
local_output_nid generation:  0.009697914123535156
local_in_edges_tensor generation:  0.008966445922851562
mini_batch_src_global generation:  0.016046524047851562
r_  generation:  0.14150452613830566
local_output_nid generation:  0.00995779037475586
local_in_edges_tensor generation:  0.010292530059814453
mini_batch_src_global generation:  0.016793489456176758
r_  generation:  0.146864652633667
local_output_nid generation:  0.015015602111816406
local_in_edges_tensor generation:  0.024153470993041992
mini_batch_src_global generation:  0.027138948440551758
r_  generation:  0.1546623706817627
local_output_nid generation:  0.01002955436706543
local_in_edges_tensor generation:  0.010823249816894531
mini_batch_src_global generation:  0.018818378448486328
r_  generation:  0.14315176010131836
local_output_nid generation:  0.008371591567993164
local_in_edges_tensor generation:  0.009432554244995117
mini_batch_src_global generation:  0.019109487533569336
r_  generation:  0.1493511199951172
local_output_nid generation:  0.008419036865234375
local_in_edges_tensor generation:  0.009403705596923828
mini_batch_src_global generation:  0.018439531326293945
r_  generation:  0.1462700366973877
local_output_nid generation:  0.00834202766418457
local_in_edges_tensor generation:  0.010510683059692383
mini_batch_src_global generation:  0.018260478973388672
r_  generation:  0.14911937713623047
local_output_nid generation:  0.008393287658691406
local_in_edges_tensor generation:  0.008299589157104492
mini_batch_src_global generation:  0.018552541732788086
r_  generation:  0.14949917793273926
local_output_nid generation:  0.008153676986694336
local_in_edges_tensor generation:  0.010505199432373047
mini_batch_src_global generation:  0.018321514129638672
r_  generation:  0.14733386039733887
local_output_nid generation:  0.008395671844482422
local_in_edges_tensor generation:  0.009548664093017578
mini_batch_src_global generation:  0.020156383514404297
r_  generation:  0.15519976615905762
local_output_nid generation:  0.008269786834716797
local_in_edges_tensor generation:  0.009565114974975586
mini_batch_src_global generation:  0.018892765045166016
r_  generation:  0.14971208572387695
local_output_nid generation:  0.008501768112182617
local_in_edges_tensor generation:  0.009858369827270508
mini_batch_src_global generation:  0.020501375198364258
r_  generation:  0.1563410758972168
local_output_nid generation:  0.00822305679321289
local_in_edges_tensor generation:  0.007951736450195312
mini_batch_src_global generation:  0.018646717071533203
r_  generation:  0.14898920059204102
local_output_nid generation:  0.008203744888305664
local_in_edges_tensor generation:  0.00940704345703125
mini_batch_src_global generation:  0.0193634033203125
r_  generation:  0.14840960502624512
local_output_nid generation:  0.008154869079589844
local_in_edges_tensor generation:  0.009387493133544922
mini_batch_src_global generation:  0.02098226547241211
r_  generation:  0.14774417877197266
local_output_nid generation:  0.008327245712280273
local_in_edges_tensor generation:  0.010640859603881836
mini_batch_src_global generation:  0.018564701080322266
r_  generation:  0.15375018119812012
local_output_nid generation:  0.008381366729736328
local_in_edges_tensor generation:  0.009592533111572266
mini_batch_src_global generation:  0.01891183853149414
r_  generation:  0.15267300605773926
local_output_nid generation:  0.008196353912353516
local_in_edges_tensor generation:  0.00931549072265625
mini_batch_src_global generation:  0.018500089645385742
r_  generation:  0.150132417678833
local_output_nid generation:  0.008536338806152344
local_in_edges_tensor generation:  0.01122593879699707
mini_batch_src_global generation:  0.019134044647216797
r_  generation:  0.15833663940429688
local_output_nid generation:  0.008071660995483398
local_in_edges_tensor generation:  0.00817728042602539
mini_batch_src_global generation:  0.01841115951538086
r_  generation:  0.14906668663024902
local_output_nid generation:  0.008239507675170898
local_in_edges_tensor generation:  0.008509159088134766
mini_batch_src_global generation:  0.018625497817993164
r_  generation:  0.15489649772644043
local_output_nid generation:  0.008254766464233398
local_in_edges_tensor generation:  0.009328842163085938
mini_batch_src_global generation:  0.018587112426757812
r_  generation:  0.15633225440979004
local_output_nid generation:  0.008244514465332031
local_in_edges_tensor generation:  0.008628129959106445
mini_batch_src_global generation:  0.018285751342773438
r_  generation:  0.14987945556640625
local_output_nid generation:  0.008146286010742188
local_in_edges_tensor generation:  0.008423328399658203
mini_batch_src_global generation:  0.01794266700744629
r_  generation:  0.1458742618560791
local_output_nid generation:  0.008301496505737305
local_in_edges_tensor generation:  0.010564088821411133
mini_batch_src_global generation:  0.01804184913635254
r_  generation:  0.1485137939453125
local_output_nid generation:  0.008398056030273438
local_in_edges_tensor generation:  0.009987115859985352
mini_batch_src_global generation:  0.01883673667907715
r_  generation:  0.15649724006652832
local_output_nid generation:  0.008365631103515625
local_in_edges_tensor generation:  0.011171579360961914
mini_batch_src_global generation:  0.020459651947021484
r_  generation:  0.15851449966430664
local_output_nid generation:  0.008318185806274414
local_in_edges_tensor generation:  0.008285284042358398
mini_batch_src_global generation:  0.018376588821411133
r_  generation:  0.1517620086669922
----------------------check_connections_block total spend ----------------------------- 7.108347415924072
generate_one_block  0.19804978370666504
generate_one_block  0.18349099159240723
generate_one_block  0.21810269355773926
generate_one_block  0.18198013305664062
generate_one_block  0.18048691749572754
generate_one_block  0.18414735794067383
generate_one_block  0.18353962898254395
generate_one_block  0.18417882919311523
generate_one_block  0.19205069541931152
generate_one_block  0.18825149536132812
generate_one_block  0.18922710418701172
generate_one_block  0.19054126739501953
generate_one_block  0.1844315528869629
generate_one_block  0.19728875160217285
generate_one_block  0.18904709815979004
generate_one_block  0.22476601600646973
generate_one_block  0.18642020225524902
generate_one_block  0.1898329257965088
generate_one_block  0.18491339683532715
generate_one_block  0.20624327659606934
generate_one_block  0.1933448314666748
generate_one_block  0.19339394569396973
generate_one_block  0.20014190673828125
generate_one_block  0.18549060821533203
generate_one_block  0.20365452766418457
generate_one_block  0.19544672966003418
generate_one_block  0.18578004837036133
generate_one_block  0.19295954704284668
generate_one_block  0.18695425987243652
generate_one_block  0.2033708095550537
generate_one_block  0.20605206489562988
generate_one_block  0.19297099113464355
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04787278175354004
gen group dst list time:  0.10788774490356445
time for parepare:  0.018948078155517578
local_output_nid generation:  0.02200031280517578
local_in_edges_tensor generation:  0.052228450775146484
mini_batch_src_global generation:  0.03960132598876953
r_  generation:  0.4127490520477295
local_output_nid generation:  0.031490325927734375
local_in_edges_tensor generation:  0.04132699966430664
mini_batch_src_global generation:  0.04677128791809082
r_  generation:  0.3992023468017578
local_output_nid generation:  0.02896904945373535
local_in_edges_tensor generation:  0.04063725471496582
mini_batch_src_global generation:  0.046758174896240234
r_  generation:  0.4059772491455078
local_output_nid generation:  0.02735614776611328
local_in_edges_tensor generation:  0.02998065948486328
mini_batch_src_global generation:  0.04701828956604004
r_  generation:  0.4175128936767578
local_output_nid generation:  0.027275800704956055
local_in_edges_tensor generation:  0.041863441467285156
mini_batch_src_global generation:  0.05087542533874512
r_  generation:  0.41092896461486816
local_output_nid generation:  0.02787637710571289
local_in_edges_tensor generation:  0.036997318267822266
mini_batch_src_global generation:  0.04746556282043457
r_  generation:  0.4091954231262207
local_output_nid generation:  0.029323101043701172
local_in_edges_tensor generation:  0.027987003326416016
mini_batch_src_global generation:  0.0480189323425293
r_  generation:  0.4073476791381836
local_output_nid generation:  0.027543067932128906
local_in_edges_tensor generation:  0.033829450607299805
mini_batch_src_global generation:  0.04778623580932617
r_  generation:  0.4069674015045166
local_output_nid generation:  0.027621984481811523
local_in_edges_tensor generation:  0.027820825576782227
mini_batch_src_global generation:  0.048445701599121094
r_  generation:  0.4192490577697754
local_output_nid generation:  0.027808189392089844
local_in_edges_tensor generation:  0.031540870666503906
mini_batch_src_global generation:  0.048913002014160156
r_  generation:  0.405580997467041
local_output_nid generation:  0.027852535247802734
local_in_edges_tensor generation:  0.034059762954711914
mini_batch_src_global generation:  0.04763078689575195
r_  generation:  0.42888474464416504
local_output_nid generation:  0.027803659439086914
local_in_edges_tensor generation:  0.027949094772338867
mini_batch_src_global generation:  0.0484461784362793
r_  generation:  0.41123247146606445
local_output_nid generation:  0.027690649032592773
local_in_edges_tensor generation:  0.029926061630249023
mini_batch_src_global generation:  0.047560930252075195
r_  generation:  0.40347838401794434
local_output_nid generation:  0.027657032012939453
local_in_edges_tensor generation:  0.034459590911865234
mini_batch_src_global generation:  0.05217480659484863
r_  generation:  0.4156837463378906
local_output_nid generation:  0.027665138244628906
local_in_edges_tensor generation:  0.038278818130493164
mini_batch_src_global generation:  0.05565166473388672
r_  generation:  0.432955265045166
local_output_nid generation:  0.028825998306274414
local_in_edges_tensor generation:  0.03787088394165039
mini_batch_src_global generation:  0.05440497398376465
r_  generation:  0.4129316806793213
local_output_nid generation:  0.02884387969970703
local_in_edges_tensor generation:  0.03476881980895996
mini_batch_src_global generation:  0.04888105392456055
r_  generation:  0.4113731384277344
local_output_nid generation:  0.027732372283935547
local_in_edges_tensor generation:  0.029898643493652344
mini_batch_src_global generation:  0.051114559173583984
r_  generation:  0.40757083892822266
local_output_nid generation:  0.0274507999420166
local_in_edges_tensor generation:  0.026841163635253906
mini_batch_src_global generation:  0.04789876937866211
r_  generation:  0.41128110885620117
local_output_nid generation:  0.02736377716064453
local_in_edges_tensor generation:  0.02935481071472168
mini_batch_src_global generation:  0.04851698875427246
r_  generation:  0.41287922859191895
local_output_nid generation:  0.027402400970458984
local_in_edges_tensor generation:  0.03363537788391113
mini_batch_src_global generation:  0.04815268516540527
r_  generation:  0.41228365898132324
local_output_nid generation:  0.027480602264404297
local_in_edges_tensor generation:  0.035001516342163086
mini_batch_src_global generation:  0.05080914497375488
r_  generation:  0.43825483322143555
local_output_nid generation:  0.028706789016723633
local_in_edges_tensor generation:  0.03494071960449219
mini_batch_src_global generation:  0.0520474910736084
r_  generation:  0.4162604808807373
local_output_nid generation:  0.02790069580078125
local_in_edges_tensor generation:  0.03021860122680664
mini_batch_src_global generation:  0.04846000671386719
r_  generation:  0.40816307067871094
local_output_nid generation:  0.027496814727783203
local_in_edges_tensor generation:  0.028690814971923828
mini_batch_src_global generation:  0.05069470405578613
r_  generation:  0.41316699981689453
local_output_nid generation:  0.027912139892578125
local_in_edges_tensor generation:  0.025252342224121094
mini_batch_src_global generation:  0.051288604736328125
r_  generation:  0.41164112091064453
local_output_nid generation:  0.02870965003967285
local_in_edges_tensor generation:  0.025556087493896484
mini_batch_src_global generation:  0.04901432991027832
r_  generation:  0.413973331451416
local_output_nid generation:  0.027607440948486328
local_in_edges_tensor generation:  0.031771183013916016
mini_batch_src_global generation:  0.04807782173156738
r_  generation:  0.4086904525756836
local_output_nid generation:  0.027562379837036133
local_in_edges_tensor generation:  0.029075145721435547
mini_batch_src_global generation:  0.047722578048706055
r_  generation:  0.40911316871643066
local_output_nid generation:  0.02971816062927246
local_in_edges_tensor generation:  0.0293118953704834
mini_batch_src_global generation:  0.05156755447387695
r_  generation:  0.4173896312713623
local_output_nid generation:  0.02772355079650879
local_in_edges_tensor generation:  0.03287696838378906
mini_batch_src_global generation:  0.048998355865478516
r_  generation:  0.4184451103210449
local_output_nid generation:  0.027527570724487305
local_in_edges_tensor generation:  0.025205373764038086
mini_batch_src_global generation:  0.04896235466003418
r_  generation:  0.4089076519012451
----------------------check_connections_block total spend ----------------------------- 19.637800931930542
generate_one_block  0.6393225193023682
generate_one_block  0.5259547233581543
generate_one_block  0.5269312858581543
generate_one_block  0.5156760215759277
generate_one_block  0.5179286003112793
generate_one_block  0.5312750339508057
generate_one_block  0.5207161903381348
generate_one_block  0.5272209644317627
generate_one_block  0.5354475975036621
generate_one_block  0.5288822650909424
generate_one_block  0.5277881622314453
generate_one_block  0.5170931816101074
generate_one_block  0.5163650512695312
generate_one_block  0.5355932712554932
generate_one_block  0.5265474319458008
generate_one_block  0.5473034381866455
generate_one_block  0.517796516418457
generate_one_block  0.5344021320343018
generate_one_block  0.5145070552825928
generate_one_block  0.5244019031524658
generate_one_block  0.549511194229126
generate_one_block  0.5252664089202881
generate_one_block  0.5440359115600586
generate_one_block  0.5262923240661621
generate_one_block  0.5264468193054199
generate_one_block  0.5359077453613281
generate_one_block  0.5243666172027588
generate_one_block  0.5246353149414062
generate_one_block  0.5268764495849609
generate_one_block  0.539862871170044
generate_one_block  0.5395700931549072
generate_one_block  0.5173506736755371
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

connection checking time:  26.746148347854614
block generation total time  23.18782615661621
average batch blocks generation time:  0.7246195673942566
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1717529296875 GB
    Memory Allocated: 0.0835719108581543  GigaBytes
Max Memory Allocated: 0.0835719108581543  GigaBytes

torch.Size([146279, 128])
torch.Size([102099, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7088623046875 GB
    Memory Allocated: 0.35985708236694336  GigaBytes
Max Memory Allocated: 0.37122535705566406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.08522605895996094  GigaBytes
Max Memory Allocated: 0.4080777168273926  GigaBytes

torch.Size([146424, 128])
torch.Size([102622, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1014404296875 GB
    Memory Allocated: 0.3612098693847656  GigaBytes
Max Memory Allocated: 0.4080777168273926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.0852346420288086  GigaBytes
Max Memory Allocated: 0.40982723236083984  GigaBytes

torch.Size([146056, 128])
torch.Size([102392, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.36162710189819336  GigaBytes
Max Memory Allocated: 0.40982723236083984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.08417701721191406  GigaBytes
Max Memory Allocated: 0.40982723236083984  GigaBytes

torch.Size([146169, 128])
torch.Size([101987, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.3581967353820801  GigaBytes
Max Memory Allocated: 0.40982723236083984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.0830082893371582  GigaBytes
Max Memory Allocated: 0.40982723236083984  GigaBytes

torch.Size([145223, 128])
torch.Size([100413, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.3562502861022949  GigaBytes
Max Memory Allocated: 0.40982723236083984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.08522224426269531  GigaBytes
Max Memory Allocated: 0.40982723236083984  GigaBytes

torch.Size([146589, 128])
torch.Size([102676, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.36005353927612305  GigaBytes
Max Memory Allocated: 0.40982723236083984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.0842132568359375  GigaBytes
Max Memory Allocated: 0.4098653793334961  GigaBytes

torch.Size([146091, 128])
torch.Size([101481, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.3584012985229492  GigaBytes
Max Memory Allocated: 0.4098653793334961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.0852212905883789  GigaBytes
Max Memory Allocated: 0.4098653793334961  GigaBytes

torch.Size([146044, 128])
torch.Size([101572, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.3602752685546875  GigaBytes
Max Memory Allocated: 0.4098653793334961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.08523368835449219  GigaBytes
Max Memory Allocated: 0.4098653793334961  GigaBytes

torch.Size([146184, 128])
torch.Size([102402, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.3613719940185547  GigaBytes
Max Memory Allocated: 0.4098653793334961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.08522605895996094  GigaBytes
Max Memory Allocated: 0.4098653793334961  GigaBytes

torch.Size([146649, 128])
torch.Size([102705, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.36156749725341797  GigaBytes
Max Memory Allocated: 0.4098653793334961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.08523273468017578  GigaBytes
Max Memory Allocated: 0.4099159240722656  GigaBytes

torch.Size([146412, 128])
torch.Size([102657, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.361691951751709  GigaBytes
Max Memory Allocated: 0.4099159240722656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.08522987365722656  GigaBytes
Max Memory Allocated: 0.4099159240722656  GigaBytes

torch.Size([146329, 128])
torch.Size([102455, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.3612680435180664  GigaBytes
Max Memory Allocated: 0.4099159240722656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.0842428207397461  GigaBytes
Max Memory Allocated: 0.4099159240722656  GigaBytes

torch.Size([145992, 128])
torch.Size([101348, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.3598771095275879  GigaBytes
Max Memory Allocated: 0.4099159240722656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.08523941040039062  GigaBytes
Max Memory Allocated: 0.4099159240722656  GigaBytes

torch.Size([146100, 128])
torch.Size([102472, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.3620915412902832  GigaBytes
Max Memory Allocated: 0.4099159240722656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.08523082733154297  GigaBytes
Max Memory Allocated: 0.4099159240722656  GigaBytes

torch.Size([146217, 128])
torch.Size([102703, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.3614487648010254  GigaBytes
Max Memory Allocated: 0.4099159240722656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.08524227142333984  GigaBytes
Max Memory Allocated: 0.40993547439575195  GigaBytes

torch.Size([146320, 128])
torch.Size([102894, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.3634963035583496  GigaBytes
Max Memory Allocated: 0.40993547439575195  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.08522796630859375  GigaBytes
Max Memory Allocated: 0.410128116607666  GigaBytes

torch.Size([146357, 128])
torch.Size([102083, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.3610076904296875  GigaBytes
Max Memory Allocated: 0.410128116607666  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.08522605895996094  GigaBytes
Max Memory Allocated: 0.410128116607666  GigaBytes

torch.Size([146384, 128])
torch.Size([102394, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.3613548278808594  GigaBytes
Max Memory Allocated: 0.410128116607666  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.08522891998291016  GigaBytes
Max Memory Allocated: 0.410128116607666  GigaBytes

torch.Size([146008, 128])
torch.Size([101985, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.3611154556274414  GigaBytes
Max Memory Allocated: 0.410128116607666  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.08523368835449219  GigaBytes
Max Memory Allocated: 0.410128116607666  GigaBytes

torch.Size([145622, 128])
torch.Size([101836, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.3614006042480469  GigaBytes
Max Memory Allocated: 0.410128116607666  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.08523082733154297  GigaBytes
Max Memory Allocated: 0.410128116607666  GigaBytes

torch.Size([145830, 128])
torch.Size([102026, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.36153507232666016  GigaBytes
Max Memory Allocated: 0.410128116607666  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.08523082733154297  GigaBytes
Max Memory Allocated: 0.410128116607666  GigaBytes

torch.Size([146061, 128])
torch.Size([101931, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.3609428405761719  GigaBytes
Max Memory Allocated: 0.410128116607666  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08523750305175781  GigaBytes
Max Memory Allocated: 0.410128116607666  GigaBytes

torch.Size([146584, 128])
torch.Size([103739, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.3653745651245117  GigaBytes
Max Memory Allocated: 0.410128116607666  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08522224426269531  GigaBytes
Max Memory Allocated: 0.41257762908935547  GigaBytes

torch.Size([146059, 128])
torch.Size([102016, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.36057281494140625  GigaBytes
Max Memory Allocated: 0.41257762908935547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08523082733154297  GigaBytes
Max Memory Allocated: 0.41257762908935547  GigaBytes

torch.Size([145670, 128])
torch.Size([102160, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.361600399017334  GigaBytes
Max Memory Allocated: 0.41257762908935547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08523273468017578  GigaBytes
Max Memory Allocated: 0.41257762908935547  GigaBytes

torch.Size([146323, 128])
torch.Size([102796, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.3616819381713867  GigaBytes
Max Memory Allocated: 0.41257762908935547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08522415161132812  GigaBytes
Max Memory Allocated: 0.41257762908935547  GigaBytes

torch.Size([146661, 128])
torch.Size([102649, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.36102914810180664  GigaBytes
Max Memory Allocated: 0.41257762908935547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08417034149169922  GigaBytes
Max Memory Allocated: 0.41257762908935547  GigaBytes

torch.Size([146254, 128])
torch.Size([101684, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.35831260681152344  GigaBytes
Max Memory Allocated: 0.41257762908935547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.0842294692993164  GigaBytes
Max Memory Allocated: 0.41257762908935547  GigaBytes

torch.Size([146542, 128])
torch.Size([102114, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.35904455184936523  GigaBytes
Max Memory Allocated: 0.41257762908935547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.085235595703125  GigaBytes
Max Memory Allocated: 0.41257762908935547  GigaBytes

torch.Size([146693, 128])
torch.Size([103440, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.36380529403686523  GigaBytes
Max Memory Allocated: 0.41257762908935547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.085235595703125  GigaBytes
Max Memory Allocated: 0.41257762908935547  GigaBytes

torch.Size([146365, 128])
torch.Size([103358, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.3638291358947754  GigaBytes
Max Memory Allocated: 0.41257762908935547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08522701263427734  GigaBytes
Max Memory Allocated: 0.41257762908935547  GigaBytes

torch.Size([146338, 128])
torch.Size([102404, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.3609800338745117  GigaBytes
Max Memory Allocated: 0.41257762908935547  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03440328687429428 |0.02432999014854431 |0.026212796568870544 |9.430944919586182e-05 |0.0049173831939697266 |0.002873659133911133 |
----------------------------------------------------------pseudo_mini_loss sum 5.650261878967285
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  8791477
Number of first layer input nodes during this epoch:  4678829
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.10483932495117188  GigaBytes
Max Memory Allocated: 0.41257762908935547  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02189803123474121
random selection method range initialization spend 0.005503654479980469
time for parepare:  0.016506671905517578
local_output_nid generation:  0.001209259033203125
local_in_edges_tensor generation:  0.005522727966308594
mini_batch_src_global generation:  0.0015895366668701172
r_  generation:  0.010558605194091797
local_output_nid generation:  0.0014498233795166016
local_in_edges_tensor generation:  0.001041412353515625
mini_batch_src_global generation:  0.0014104843139648438
r_  generation:  0.00986623764038086
local_output_nid generation:  0.0015065670013427734
local_in_edges_tensor generation:  0.0008685588836669922
mini_batch_src_global generation:  0.0010356903076171875
r_  generation:  0.009189367294311523
local_output_nid generation:  0.0014994144439697266
local_in_edges_tensor generation:  0.0008335113525390625
mini_batch_src_global generation:  0.0009996891021728516
r_  generation:  0.00963282585144043
local_output_nid generation:  0.0014750957489013672
local_in_edges_tensor generation:  0.0007939338684082031
mini_batch_src_global generation:  0.0009729862213134766
r_  generation:  0.009251594543457031
local_output_nid generation:  0.001468658447265625
local_in_edges_tensor generation:  0.0007796287536621094
mini_batch_src_global generation:  0.0010192394256591797
r_  generation:  0.010025739669799805
local_output_nid generation:  0.0014696121215820312
local_in_edges_tensor generation:  0.0007824897766113281
mini_batch_src_global generation:  0.0010187625885009766
r_  generation:  0.009686946868896484
local_output_nid generation:  0.0014729499816894531
local_in_edges_tensor generation:  0.0007750988006591797
mini_batch_src_global generation:  0.0011074542999267578
r_  generation:  0.009796142578125
local_output_nid generation:  0.001466989517211914
local_in_edges_tensor generation:  0.000774383544921875
mini_batch_src_global generation:  0.0009684562683105469
r_  generation:  0.009652137756347656
local_output_nid generation:  0.0014719963073730469
local_in_edges_tensor generation:  0.0007584095001220703
mini_batch_src_global generation:  0.0009968280792236328
r_  generation:  0.00971221923828125
local_output_nid generation:  0.0014750957489013672
local_in_edges_tensor generation:  0.0007688999176025391
mini_batch_src_global generation:  0.0009613037109375
r_  generation:  0.009289741516113281
local_output_nid generation:  0.0014743804931640625
local_in_edges_tensor generation:  0.0007679462432861328
mini_batch_src_global generation:  0.000993490219116211
r_  generation:  0.01013946533203125
local_output_nid generation:  0.001481771469116211
local_in_edges_tensor generation:  0.0007708072662353516
mini_batch_src_global generation:  0.001008749008178711
r_  generation:  0.009901285171508789
local_output_nid generation:  0.0014755725860595703
local_in_edges_tensor generation:  0.0007793903350830078
mini_batch_src_global generation:  0.0011036396026611328
r_  generation:  0.010257482528686523
local_output_nid generation:  0.001461029052734375
local_in_edges_tensor generation:  0.0007686614990234375
mini_batch_src_global generation:  0.0010385513305664062
r_  generation:  0.010162115097045898
local_output_nid generation:  0.0014760494232177734
local_in_edges_tensor generation:  0.0007672309875488281
mini_batch_src_global generation:  0.0010175704956054688
r_  generation:  0.009850502014160156
local_output_nid generation:  0.0014636516571044922
local_in_edges_tensor generation:  0.0007574558258056641
mini_batch_src_global generation:  0.0010025501251220703
r_  generation:  0.009798765182495117
local_output_nid generation:  0.0014650821685791016
local_in_edges_tensor generation:  0.0007536411285400391
mini_batch_src_global generation:  0.0010001659393310547
r_  generation:  0.009709596633911133
local_output_nid generation:  0.001455545425415039
local_in_edges_tensor generation:  0.0007500648498535156
mini_batch_src_global generation:  0.0010166168212890625
r_  generation:  0.010302305221557617
local_output_nid generation:  0.0014600753784179688
local_in_edges_tensor generation:  0.0007581710815429688
mini_batch_src_global generation:  0.0010368824005126953
r_  generation:  0.010103940963745117
local_output_nid generation:  0.0014679431915283203
local_in_edges_tensor generation:  0.0007598400115966797
mini_batch_src_global generation:  0.001018524169921875
r_  generation:  0.009859800338745117
local_output_nid generation:  0.0014595985412597656
local_in_edges_tensor generation:  0.0007288455963134766
mini_batch_src_global generation:  0.0010178089141845703
r_  generation:  0.009850263595581055
local_output_nid generation:  0.0014715194702148438
local_in_edges_tensor generation:  0.00074005126953125
mini_batch_src_global generation:  0.0010056495666503906
r_  generation:  0.009694576263427734
local_output_nid generation:  0.0014998912811279297
local_in_edges_tensor generation:  0.0007486343383789062
mini_batch_src_global generation:  0.001035928726196289
r_  generation:  0.009955406188964844
local_output_nid generation:  0.0014567375183105469
local_in_edges_tensor generation:  0.0007359981536865234
mini_batch_src_global generation:  0.0010614395141601562
r_  generation:  0.010085105895996094
local_output_nid generation:  0.0014510154724121094
local_in_edges_tensor generation:  0.0007450580596923828
mini_batch_src_global generation:  0.0010578632354736328
r_  generation:  0.010097503662109375
local_output_nid generation:  0.0014691352844238281
local_in_edges_tensor generation:  0.0007452964782714844
mini_batch_src_global generation:  0.001018524169921875
r_  generation:  0.009649515151977539
local_output_nid generation:  0.0014557838439941406
local_in_edges_tensor generation:  0.0007662773132324219
mini_batch_src_global generation:  0.0010876655578613281
r_  generation:  0.010651826858520508
local_output_nid generation:  0.001482248306274414
local_in_edges_tensor generation:  0.0007450580596923828
mini_batch_src_global generation:  0.0010344982147216797
r_  generation:  0.009467601776123047
local_output_nid generation:  0.0014655590057373047
local_in_edges_tensor generation:  0.000774383544921875
mini_batch_src_global generation:  0.0010521411895751953
r_  generation:  0.012935876846313477
local_output_nid generation:  0.0014612674713134766
local_in_edges_tensor generation:  0.0007467269897460938
mini_batch_src_global generation:  0.0010297298431396484
r_  generation:  0.00989222526550293
local_output_nid generation:  0.0014519691467285156
local_in_edges_tensor generation:  0.0007483959197998047
mini_batch_src_global generation:  0.0010623931884765625
r_  generation:  0.010407209396362305
----------------------check_connections_block total spend ----------------------------- 0.534569263458252
generate_one_block  0.0157468318939209
generate_one_block  0.01723957061767578
generate_one_block  0.014565706253051758
generate_one_block  0.0193178653717041
generate_one_block  0.015011310577392578
generate_one_block  0.015383481979370117
generate_one_block  0.014844894409179688
generate_one_block  0.01505279541015625
generate_one_block  0.01455378532409668
generate_one_block  0.014682531356811523
generate_one_block  0.017421483993530273
generate_one_block  0.015626192092895508
generate_one_block  0.01485443115234375
generate_one_block  0.015499353408813477
generate_one_block  0.01532435417175293
generate_one_block  0.014806985855102539
generate_one_block  0.014744758605957031
generate_one_block  0.015954971313476562
generate_one_block  0.015572309494018555
generate_one_block  0.014840364456176758
generate_one_block  0.014968395233154297
generate_one_block  0.014506816864013672
generate_one_block  0.01416015625
generate_one_block  0.014811515808105469
generate_one_block  0.01693415641784668
generate_one_block  0.014920473098754883
generate_one_block  0.01440882682800293
generate_one_block  0.01618647575378418
generate_one_block  0.01400446891784668
generate_one_block  0.014968156814575195
generate_one_block  0.01480412483215332
generate_one_block  0.016047239303588867
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.08091449737548828
gen group dst list time:  0.02631831169128418
time for parepare:  0.02351093292236328
local_output_nid generation:  0.005507230758666992
local_in_edges_tensor generation:  0.025671720504760742
mini_batch_src_global generation:  0.014290094375610352
r_  generation:  0.13942742347717285
local_output_nid generation:  0.008385658264160156
local_in_edges_tensor generation:  0.013485908508300781
mini_batch_src_global generation:  0.01723933219909668
r_  generation:  0.14070343971252441
local_output_nid generation:  0.008394002914428711
local_in_edges_tensor generation:  0.029401779174804688
mini_batch_src_global generation:  0.016828060150146484
r_  generation:  0.13581132888793945
local_output_nid generation:  0.008404970169067383
local_in_edges_tensor generation:  0.010123252868652344
mini_batch_src_global generation:  0.017661094665527344
r_  generation:  0.14432668685913086
local_output_nid generation:  0.00827169418334961
local_in_edges_tensor generation:  0.012236595153808594
mini_batch_src_global generation:  0.01970672607421875
r_  generation:  0.14873909950256348
local_output_nid generation:  0.008182287216186523
local_in_edges_tensor generation:  0.009326934814453125
mini_batch_src_global generation:  0.021065950393676758
r_  generation:  0.15323424339294434
local_output_nid generation:  0.008023262023925781
local_in_edges_tensor generation:  0.011218070983886719
mini_batch_src_global generation:  0.018268108367919922
r_  generation:  0.15320849418640137
local_output_nid generation:  0.00827169418334961
local_in_edges_tensor generation:  0.010566473007202148
mini_batch_src_global generation:  0.01859259605407715
r_  generation:  0.15559649467468262
local_output_nid generation:  0.008108854293823242
local_in_edges_tensor generation:  0.010092496871948242
mini_batch_src_global generation:  0.0182650089263916
r_  generation:  0.1485154628753662
local_output_nid generation:  0.008151769638061523
local_in_edges_tensor generation:  0.009003639221191406
mini_batch_src_global generation:  0.019538402557373047
r_  generation:  0.15306878089904785
local_output_nid generation:  0.008196592330932617
local_in_edges_tensor generation:  0.008301496505737305
mini_batch_src_global generation:  0.01726388931274414
r_  generation:  0.1511213779449463
local_output_nid generation:  0.010066509246826172
local_in_edges_tensor generation:  0.017459392547607422
mini_batch_src_global generation:  0.019611120223999023
r_  generation:  0.15276813507080078
local_output_nid generation:  0.009705781936645508
local_in_edges_tensor generation:  0.013095617294311523
mini_batch_src_global generation:  0.018919706344604492
r_  generation:  0.15607404708862305
local_output_nid generation:  0.009049177169799805
local_in_edges_tensor generation:  0.010577678680419922
mini_batch_src_global generation:  0.02057051658630371
r_  generation:  0.17113399505615234
local_output_nid generation:  0.008952617645263672
local_in_edges_tensor generation:  0.011540412902832031
mini_batch_src_global generation:  0.018934011459350586
r_  generation:  0.1599280834197998
local_output_nid generation:  0.008716821670532227
local_in_edges_tensor generation:  0.008756637573242188
mini_batch_src_global generation:  0.018984317779541016
r_  generation:  0.1538982391357422
local_output_nid generation:  0.008743524551391602
local_in_edges_tensor generation:  0.009402751922607422
mini_batch_src_global generation:  0.018190622329711914
r_  generation:  0.15610313415527344
local_output_nid generation:  0.009484291076660156
local_in_edges_tensor generation:  0.017834186553955078
mini_batch_src_global generation:  0.019945144653320312
r_  generation:  0.15991616249084473
local_output_nid generation:  0.009476184844970703
local_in_edges_tensor generation:  0.012845993041992188
mini_batch_src_global generation:  0.019223928451538086
r_  generation:  0.15711140632629395
local_output_nid generation:  0.010236740112304688
local_in_edges_tensor generation:  0.009091854095458984
mini_batch_src_global generation:  0.01904749870300293
r_  generation:  0.15261578559875488
local_output_nid generation:  0.008305072784423828
local_in_edges_tensor generation:  0.008156061172485352
mini_batch_src_global generation:  0.018595457077026367
r_  generation:  0.15102648735046387
local_output_nid generation:  0.008104562759399414
local_in_edges_tensor generation:  0.008035659790039062
mini_batch_src_global generation:  0.021323442459106445
r_  generation:  0.1441960334777832
local_output_nid generation:  0.00807046890258789
local_in_edges_tensor generation:  0.009714365005493164
mini_batch_src_global generation:  0.029366493225097656
r_  generation:  0.14987754821777344
local_output_nid generation:  0.008260250091552734
local_in_edges_tensor generation:  0.010594844818115234
mini_batch_src_global generation:  0.018777847290039062
r_  generation:  0.150604248046875
local_output_nid generation:  0.008451461791992188
local_in_edges_tensor generation:  0.009595870971679688
mini_batch_src_global generation:  0.01880955696105957
r_  generation:  0.15982437133789062
local_output_nid generation:  0.00835275650024414
local_in_edges_tensor generation:  0.009342432022094727
mini_batch_src_global generation:  0.019032955169677734
r_  generation:  0.1502993106842041
local_output_nid generation:  0.008068323135375977
local_in_edges_tensor generation:  0.009078741073608398
mini_batch_src_global generation:  0.018137693405151367
r_  generation:  0.15496301651000977
local_output_nid generation:  0.009462118148803711
local_in_edges_tensor generation:  0.016768217086791992
mini_batch_src_global generation:  0.019992828369140625
r_  generation:  0.15595650672912598
local_output_nid generation:  0.008095979690551758
local_in_edges_tensor generation:  0.013712882995605469
mini_batch_src_global generation:  0.020292043685913086
r_  generation:  0.1488950252532959
local_output_nid generation:  0.008530616760253906
local_in_edges_tensor generation:  0.01027989387512207
mini_batch_src_global generation:  0.019073009490966797
r_  generation:  0.1603548526763916
local_output_nid generation:  0.010556697845458984
local_in_edges_tensor generation:  0.009420394897460938
mini_batch_src_global generation:  0.018257617950439453
r_  generation:  0.15152668952941895
local_output_nid generation:  0.008715391159057617
local_in_edges_tensor generation:  0.01236581802368164
mini_batch_src_global generation:  0.02068805694580078
r_  generation:  0.16074156761169434
----------------------check_connections_block total spend ----------------------------- 7.314311742782593
generate_one_block  0.2010045051574707
generate_one_block  0.18208956718444824
generate_one_block  0.17205238342285156
generate_one_block  0.18805813789367676
generate_one_block  0.19999432563781738
generate_one_block  0.19529080390930176
generate_one_block  0.1902782917022705
generate_one_block  0.2080833911895752
generate_one_block  0.19065332412719727
generate_one_block  0.1880044937133789
generate_one_block  0.1725482940673828
generate_one_block  0.19321441650390625
generate_one_block  0.19000720977783203
generate_one_block  0.19740939140319824
generate_one_block  0.1926276683807373
generate_one_block  0.18695449829101562
generate_one_block  0.18593692779541016
generate_one_block  0.18288278579711914
generate_one_block  0.19347381591796875
generate_one_block  0.2175583839416504
generate_one_block  0.18808197975158691
generate_one_block  0.1836864948272705
generate_one_block  0.18234467506408691
generate_one_block  0.1878046989440918
generate_one_block  0.19132351875305176
generate_one_block  0.18926215171813965
generate_one_block  0.18226385116577148
generate_one_block  0.20021295547485352
generate_one_block  0.17623233795166016
generate_one_block  0.19002509117126465
generate_one_block  0.18597745895385742
generate_one_block  0.20209908485412598
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04514122009277344
gen group dst list time:  0.10563158988952637
time for parepare:  0.018828868865966797
local_output_nid generation:  0.02252483367919922
local_in_edges_tensor generation:  0.05145072937011719
mini_batch_src_global generation:  0.03699541091918945
r_  generation:  0.4004220962524414
local_output_nid generation:  0.028236865997314453
local_in_edges_tensor generation:  0.040651559829711914
mini_batch_src_global generation:  0.04902148246765137
r_  generation:  0.4009413719177246
local_output_nid generation:  0.027536869049072266
local_in_edges_tensor generation:  0.03332376480102539
mini_batch_src_global generation:  0.057061195373535156
r_  generation:  0.4017179012298584
local_output_nid generation:  0.026661396026611328
local_in_edges_tensor generation:  0.03397631645202637
mini_batch_src_global generation:  0.04811739921569824
r_  generation:  0.40526890754699707
local_output_nid generation:  0.026644229888916016
local_in_edges_tensor generation:  0.033786773681640625
mini_batch_src_global generation:  0.047240495681762695
r_  generation:  0.40811753273010254
local_output_nid generation:  0.026879072189331055
local_in_edges_tensor generation:  0.03446674346923828
mini_batch_src_global generation:  0.04857969284057617
r_  generation:  0.40932345390319824
local_output_nid generation:  0.02667999267578125
local_in_edges_tensor generation:  0.027182340621948242
mini_batch_src_global generation:  0.04785513877868652
r_  generation:  0.4159810543060303
local_output_nid generation:  0.026849031448364258
local_in_edges_tensor generation:  0.030062437057495117
mini_batch_src_global generation:  0.05115199089050293
r_  generation:  0.40523624420166016
local_output_nid generation:  0.0269162654876709
local_in_edges_tensor generation:  0.03040933609008789
mini_batch_src_global generation:  0.04749917984008789
r_  generation:  0.40721607208251953
local_output_nid generation:  0.02676987648010254
local_in_edges_tensor generation:  0.030297040939331055
mini_batch_src_global generation:  0.049039363861083984
r_  generation:  0.4073939323425293
local_output_nid generation:  0.026487350463867188
local_in_edges_tensor generation:  0.02725529670715332
mini_batch_src_global generation:  0.0472564697265625
r_  generation:  0.40355849266052246
local_output_nid generation:  0.026501893997192383
local_in_edges_tensor generation:  0.033255815505981445
mini_batch_src_global generation:  0.04794454574584961
r_  generation:  0.4115715026855469
local_output_nid generation:  0.02845144271850586
local_in_edges_tensor generation:  0.03744816780090332
mini_batch_src_global generation:  0.04781937599182129
r_  generation:  0.41236042976379395
local_output_nid generation:  0.027489185333251953
local_in_edges_tensor generation:  0.030602693557739258
mini_batch_src_global generation:  0.048845529556274414
r_  generation:  0.41182565689086914
local_output_nid generation:  0.026823043823242188
local_in_edges_tensor generation:  0.030135154724121094
mini_batch_src_global generation:  0.047895193099975586
r_  generation:  0.4116179943084717
local_output_nid generation:  0.026805877685546875
local_in_edges_tensor generation:  0.02960205078125
mini_batch_src_global generation:  0.04845094680786133
r_  generation:  0.4043388366699219
local_output_nid generation:  0.026943445205688477
local_in_edges_tensor generation:  0.02681732177734375
mini_batch_src_global generation:  0.04780936241149902
r_  generation:  0.41019201278686523
local_output_nid generation:  0.02680492401123047
local_in_edges_tensor generation:  0.03743910789489746
mini_batch_src_global generation:  0.048125505447387695
r_  generation:  0.4048793315887451
local_output_nid generation:  0.02690291404724121
local_in_edges_tensor generation:  0.03635907173156738
mini_batch_src_global generation:  0.050946950912475586
r_  generation:  0.4108715057373047
local_output_nid generation:  0.026990175247192383
local_in_edges_tensor generation:  0.03497147560119629
mini_batch_src_global generation:  0.048557281494140625
r_  generation:  0.42327260971069336
local_output_nid generation:  0.028113126754760742
local_in_edges_tensor generation:  0.03624463081359863
mini_batch_src_global generation:  0.0540471076965332
r_  generation:  0.4114875793457031
local_output_nid generation:  0.027478933334350586
local_in_edges_tensor generation:  0.03287243843078613
mini_batch_src_global generation:  0.048337459564208984
r_  generation:  0.4069216251373291
local_output_nid generation:  0.027478933334350586
local_in_edges_tensor generation:  0.030657052993774414
mini_batch_src_global generation:  0.04777050018310547
r_  generation:  0.4161980152130127
local_output_nid generation:  0.0291290283203125
local_in_edges_tensor generation:  0.03047657012939453
mini_batch_src_global generation:  0.04923820495605469
r_  generation:  0.4076378345489502
local_output_nid generation:  0.027677297592163086
local_in_edges_tensor generation:  0.03391766548156738
mini_batch_src_global generation:  0.0471653938293457
r_  generation:  0.41315770149230957
local_output_nid generation:  0.027536869049072266
local_in_edges_tensor generation:  0.02684164047241211
mini_batch_src_global generation:  0.050885677337646484
r_  generation:  0.4059574604034424
local_output_nid generation:  0.027493715286254883
local_in_edges_tensor generation:  0.02994084358215332
mini_batch_src_global generation:  0.04813075065612793
r_  generation:  0.4100303649902344
local_output_nid generation:  0.027918338775634766
local_in_edges_tensor generation:  0.034294843673706055
mini_batch_src_global generation:  0.048715829849243164
r_  generation:  0.41079282760620117
local_output_nid generation:  0.027432680130004883
local_in_edges_tensor generation:  0.027339696884155273
mini_batch_src_global generation:  0.04697680473327637
r_  generation:  0.4056816101074219
local_output_nid generation:  0.027678966522216797
local_in_edges_tensor generation:  0.03043198585510254
mini_batch_src_global generation:  0.05278730392456055
r_  generation:  0.4085731506347656
local_output_nid generation:  0.02762007713317871
local_in_edges_tensor generation:  0.030632972717285156
mini_batch_src_global generation:  0.07038593292236328
r_  generation:  0.41247129440307617
local_output_nid generation:  0.027941465377807617
local_in_edges_tensor generation:  0.0317230224609375
mini_batch_src_global generation:  0.06924724578857422
r_  generation:  0.4156820774078369
----------------------check_connections_block total spend ----------------------------- 19.463415384292603
generate_one_block  0.5341348648071289
generate_one_block  0.5363106727600098
generate_one_block  0.5215365886688232
generate_one_block  0.5279295444488525
generate_one_block  0.6279299259185791
generate_one_block  0.5416862964630127
generate_one_block  0.5181770324707031
generate_one_block  0.5350449085235596
generate_one_block  0.5307657718658447
generate_one_block  0.5269160270690918
generate_one_block  0.513749361038208
generate_one_block  0.5381195545196533
generate_one_block  0.5367183685302734
generate_one_block  0.544996976852417
generate_one_block  0.5246446132659912
generate_one_block  0.5764832496643066
generate_one_block  0.5375452041625977
generate_one_block  0.5841834545135498
generate_one_block  0.5503544807434082
generate_one_block  0.5547792911529541
generate_one_block  0.5523736476898193
generate_one_block  0.5346176624298096
generate_one_block  0.5314388275146484
generate_one_block  0.5492620468139648
generate_one_block  0.5726516246795654
generate_one_block  0.5392196178436279
generate_one_block  0.5287446975708008
generate_one_block  0.5472071170806885
generate_one_block  0.5268645286560059
generate_one_block  0.5346336364746094
generate_one_block  0.544165849685669
generate_one_block  0.548424243927002
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.10483932495117188  GigaBytes
Max Memory Allocated: 0.41257762908935547  GigaBytes

connection checking time:  26.777727127075195
block generation total time  23.459046602249146
average batch blocks generation time:  0.7330952063202858
block dataloader generation time/epoch 52.81141185760498
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08580160140991211  GigaBytes
Max Memory Allocated: 0.41257762908935547  GigaBytes

torch.Size([146161, 128])
torch.Size([102530, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.3628697395324707  GigaBytes
Max Memory Allocated: 0.41257762908935547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08579349517822266  GigaBytes
Max Memory Allocated: 0.41257762908935547  GigaBytes

torch.Size([146296, 128])
torch.Size([101744, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.36141014099121094  GigaBytes
Max Memory Allocated: 0.41257762908935547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.0845499038696289  GigaBytes
Max Memory Allocated: 0.41257762908935547  GigaBytes

torch.Size([146336, 128])
torch.Size([101300, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.35857534408569336  GigaBytes
Max Memory Allocated: 0.41257762908935547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.0857992172241211  GigaBytes
Max Memory Allocated: 0.41257762908935547  GigaBytes

torch.Size([145902, 128])
torch.Size([101847, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.3616499900817871  GigaBytes
Max Memory Allocated: 0.41257762908935547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08579254150390625  GigaBytes
Max Memory Allocated: 0.41257762908935547  GigaBytes

torch.Size([145896, 128])
torch.Size([102079, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.36111974716186523  GigaBytes
Max Memory Allocated: 0.41257762908935547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08580589294433594  GigaBytes
Max Memory Allocated: 0.41257762908935547  GigaBytes

torch.Size([146617, 128])
torch.Size([103639, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.3650336265563965  GigaBytes
Max Memory Allocated: 0.41257762908935547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08579444885253906  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

torch.Size([146083, 128])
torch.Size([102078, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.36148786544799805  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.0858011245727539  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

torch.Size([145932, 128])
torch.Size([102676, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.36278533935546875  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08579349517822266  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

torch.Size([146528, 128])
torch.Size([102527, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.36177682876586914  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08579540252685547  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

torch.Size([146048, 128])
torch.Size([101964, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.36165904998779297  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08453845977783203  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

torch.Size([146349, 128])
torch.Size([101117, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.3578004837036133  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.0857992172241211  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

torch.Size([146109, 128])
torch.Size([101846, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.3617992401123047  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08579826354980469  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

torch.Size([145969, 128])
torch.Size([102221, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.3615713119506836  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08580970764160156  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

torch.Size([146198, 128])
torch.Size([103207, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.3649258613586426  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08580303192138672  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

torch.Size([146183, 128])
torch.Size([101990, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.3621826171875  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08579635620117188  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

torch.Size([146211, 128])
torch.Size([101900, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.3616905212402344  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08481025695800781  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

torch.Size([146272, 128])
torch.Size([102282, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.35950326919555664  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08579349517822266  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

torch.Size([146111, 128])
torch.Size([101823, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.36134910583496094  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08580303192138672  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

torch.Size([145736, 128])
torch.Size([102305, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.3621840476989746  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.0857992172241211  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

torch.Size([146157, 128])
torch.Size([102641, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.3623175621032715  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08579826354980469  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

torch.Size([146682, 128])
torch.Size([102360, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.36211156845092773  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08474922180175781  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

torch.Size([145836, 128])
torch.Size([101652, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.35889434814453125  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08469009399414062  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

torch.Size([146277, 128])
torch.Size([101571, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.3586769104003906  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08579730987548828  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

torch.Size([146054, 128])
torch.Size([101966, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.36185121536254883  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.0858011245727539  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

torch.Size([146160, 128])
torch.Size([102598, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.3622002601623535  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.0858001708984375  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

torch.Size([146063, 128])
torch.Size([102315, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.36200714111328125  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08481311798095703  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

torch.Size([146151, 128])
torch.Size([101615, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.35887908935546875  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08581256866455078  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

torch.Size([146859, 128])
torch.Size([103417, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.3652009963989258  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08460617065429688  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

torch.Size([145877, 128])
torch.Size([100640, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.35764265060424805  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.0858001708984375  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

torch.Size([146681, 128])
torch.Size([102657, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.36255311965942383  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08579635620117188  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

torch.Size([146348, 128])
torch.Size([102394, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.36197614669799805  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08580970764160156  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

torch.Size([146350, 128])
torch.Size([103285, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.36504411697387695  GigaBytes
Max Memory Allocated: 0.4127969741821289  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03023906797170639 |0.017813682556152344 |0.0036191940307617188 |9.896606206893921e-05 |0.0032695606350898743 |0.0015177726745605469 |
----------------------------------------------------------pseudo_mini_loss sum 3.601579427719116
Total (block generation + training)time/epoch 54.626330852508545
Training time/epoch 1.8147156238555908
Training time without block to device /epoch 1.2446777820587158
Training time without total dataloading part /epoch 0.22512483596801758
load block tensor time/epoch 0.9676501750946045
block to device time/epoch 0.570037841796875
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  8787540
Number of first layer input nodes during this epoch:  4678432
