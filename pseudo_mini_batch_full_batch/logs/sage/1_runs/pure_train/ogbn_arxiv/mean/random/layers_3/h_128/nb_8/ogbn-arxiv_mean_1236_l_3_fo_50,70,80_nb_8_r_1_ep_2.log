Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648442914.101965
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02744770050048828
random selection method range initialization spend 0.006633281707763672
time for parepare:  0.01883864402770996
local_output_nid generation:  0.004180908203125
local_in_edges_tensor generation:  0.0062711238861083984
mini_batch_src_global generation:  0.0038688182830810547
r_  generation:  0.04180455207824707
local_output_nid generation:  0.005850791931152344
local_in_edges_tensor generation:  0.00324249267578125
mini_batch_src_global generation:  0.004849433898925781
r_  generation:  0.0431218147277832
local_output_nid generation:  0.006073951721191406
local_in_edges_tensor generation:  0.003438234329223633
mini_batch_src_global generation:  0.003294706344604492
r_  generation:  0.045542001724243164
local_output_nid generation:  0.0061109066009521484
local_in_edges_tensor generation:  0.003314495086669922
mini_batch_src_global generation:  0.0036847591400146484
r_  generation:  0.04695248603820801
local_output_nid generation:  0.00615692138671875
local_in_edges_tensor generation:  0.003397703170776367
mini_batch_src_global generation:  0.0037763118743896484
r_  generation:  0.04637598991394043
local_output_nid generation:  0.006123065948486328
local_in_edges_tensor generation:  0.003438711166381836
mini_batch_src_global generation:  0.004054069519042969
r_  generation:  0.04660940170288086
local_output_nid generation:  0.0061113834381103516
local_in_edges_tensor generation:  0.003358602523803711
mini_batch_src_global generation:  0.003954172134399414
r_  generation:  0.04741168022155762
local_output_nid generation:  0.006165504455566406
local_in_edges_tensor generation:  0.0034193992614746094
mini_batch_src_global generation:  0.004050731658935547
r_  generation:  0.04909634590148926
----------------------check_connections_block total spend ----------------------------- 0.5814390182495117
generate_one_block  0.06034684181213379
generate_one_block  0.05977439880371094
generate_one_block  0.06258130073547363
generate_one_block  0.06312775611877441
generate_one_block  0.06513428688049316
generate_one_block  0.0630497932434082
generate_one_block  0.061859846115112305
generate_one_block  0.06260561943054199
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.043747663497924805
gen group dst list time:  0.016594648361206055
time for parepare:  0.019147157669067383
local_output_nid generation:  0.014443397521972656
local_in_edges_tensor generation:  0.035733699798583984
mini_batch_src_global generation:  0.03799772262573242
r_  generation:  0.3536722660064697
local_output_nid generation:  0.01950240135192871
local_in_edges_tensor generation:  0.03367352485656738
mini_batch_src_global generation:  0.043866634368896484
r_  generation:  0.3623316287994385
local_output_nid generation:  0.019436120986938477
local_in_edges_tensor generation:  0.030520915985107422
mini_batch_src_global generation:  0.04427766799926758
r_  generation:  0.3770928382873535
local_output_nid generation:  0.019421100616455078
local_in_edges_tensor generation:  0.024539709091186523
mini_batch_src_global generation:  0.04848122596740723
r_  generation:  0.37703442573547363
local_output_nid generation:  0.01953911781311035
local_in_edges_tensor generation:  0.020381927490234375
mini_batch_src_global generation:  0.046254873275756836
r_  generation:  0.3787670135498047
local_output_nid generation:  0.01968550682067871
local_in_edges_tensor generation:  0.023977279663085938
mini_batch_src_global generation:  0.04758715629577637
r_  generation:  0.3832087516784668
local_output_nid generation:  0.019576072692871094
local_in_edges_tensor generation:  0.024814128875732422
mini_batch_src_global generation:  0.04738974571228027
r_  generation:  0.38636016845703125
local_output_nid generation:  0.019597291946411133
local_in_edges_tensor generation:  0.02444291114807129
mini_batch_src_global generation:  0.050072669982910156
r_  generation:  0.38279080390930176
----------------------check_connections_block total spend ----------------------------- 4.387768745422363
generate_one_block  0.48830437660217285
generate_one_block  0.4823801517486572
generate_one_block  0.5029966831207275
generate_one_block  0.5039904117584229
generate_one_block  0.4939546585083008
generate_one_block  0.5171854496002197
generate_one_block  0.4943821430206299
generate_one_block  0.5021343231201172
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03777647018432617
gen group dst list time:  0.03707098960876465
time for parepare:  0.01905989646911621
local_output_nid generation:  0.028496265411376953
local_in_edges_tensor generation:  0.04684090614318848
mini_batch_src_global generation:  0.05575895309448242
r_  generation:  0.53855299949646
local_output_nid generation:  0.035454750061035156
local_in_edges_tensor generation:  0.05623340606689453
mini_batch_src_global generation:  0.0648648738861084
r_  generation:  0.5440700054168701
local_output_nid generation:  0.03522944450378418
local_in_edges_tensor generation:  0.04191184043884277
mini_batch_src_global generation:  0.0657048225402832
r_  generation:  0.5581104755401611
local_output_nid generation:  0.03544211387634277
local_in_edges_tensor generation:  0.047672271728515625
mini_batch_src_global generation:  0.06471419334411621
r_  generation:  0.5599052906036377
local_output_nid generation:  0.03547406196594238
local_in_edges_tensor generation:  0.037874460220336914
mini_batch_src_global generation:  0.06203007698059082
r_  generation:  0.561572790145874
local_output_nid generation:  0.03530430793762207
local_in_edges_tensor generation:  0.03722333908081055
mini_batch_src_global generation:  0.06300616264343262
r_  generation:  0.5625402927398682
local_output_nid generation:  0.03548693656921387
local_in_edges_tensor generation:  0.05171847343444824
mini_batch_src_global generation:  0.06589245796203613
r_  generation:  0.5658905506134033
local_output_nid generation:  0.035479068756103516
local_in_edges_tensor generation:  0.04145503044128418
mini_batch_src_global generation:  0.06781315803527832
r_  generation:  0.566314697265625
----------------------check_connections_block total spend ----------------------------- 6.605971813201904
generate_one_block  0.7059969902038574
generate_one_block  0.6942822933197021
generate_one_block  0.7141790390014648
generate_one_block  0.7187902927398682
generate_one_block  0.7020237445831299
generate_one_block  0.7081096172332764
generate_one_block  0.7517006397247314
generate_one_block  0.7215790748596191
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

connection checking time:  10.993740558624268
block generation total time  9.701989889144897
average batch blocks generation time:  1.2127487361431122
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.10167980194091797  GigaBytes
Max Memory Allocated: 0.10167980194091797  GigaBytes

torch.Size([162812, 128])
torch.Size([146226, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9608154296875 GB
    Memory Allocated: 0.5779829025268555  GigaBytes
Max Memory Allocated: 0.6082911491394043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2322998046875 GB
    Memory Allocated: 0.10398674011230469  GigaBytes
Max Memory Allocated: 0.647367000579834  GigaBytes

torch.Size([162383, 128])
torch.Size([145349, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2322998046875 GB
    Memory Allocated: 0.5731358528137207  GigaBytes
Max Memory Allocated: 0.647367000579834  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2322998046875 GB
    Memory Allocated: 0.10418462753295898  GigaBytes
Max Memory Allocated: 0.647367000579834  GigaBytes

torch.Size([162698, 128])
torch.Size([146162, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5796685218811035  GigaBytes
Max Memory Allocated: 0.647367000579834  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.10433244705200195  GigaBytes
Max Memory Allocated: 0.6493940353393555  GigaBytes

torch.Size([162533, 128])
torch.Size([146156, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.580040454864502  GigaBytes
Max Memory Allocated: 0.6493940353393555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.10370111465454102  GigaBytes
Max Memory Allocated: 0.650456428527832  GigaBytes

torch.Size([162514, 128])
torch.Size([145635, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.5780501365661621  GigaBytes
Max Memory Allocated: 0.650456428527832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.10430622100830078  GigaBytes
Max Memory Allocated: 0.650456428527832  GigaBytes

torch.Size([162541, 128])
torch.Size([146051, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.5798311233520508  GigaBytes
Max Memory Allocated: 0.650456428527832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.10424280166625977  GigaBytes
Max Memory Allocated: 0.650456428527832  GigaBytes

torch.Size([162752, 128])
torch.Size([146302, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.5785517692565918  GigaBytes
Max Memory Allocated: 0.650456428527832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.10386323928833008  GigaBytes
Max Memory Allocated: 0.650456428527832  GigaBytes

torch.Size([162747, 128])
torch.Size([146392, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.5810375213623047  GigaBytes
Max Memory Allocated: 0.650456428527832  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04419776797294617 |0.04980561137199402 |0.08849671483039856 |0.00010606646537780762 |0.010492146015167236 |0.0037131309509277344 |
----------------------------------------------------------pseudo_mini_loss sum 5.594515323638916
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3058746
Number of first layer input nodes during this epoch:  1300980
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.1404247283935547  GigaBytes
Max Memory Allocated: 0.650667667388916  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023149967193603516
random selection method range initialization spend 0.0057871341705322266
time for parepare:  0.018975257873535156
local_output_nid generation:  0.004639148712158203
local_in_edges_tensor generation:  0.006669759750366211
mini_batch_src_global generation:  0.0037283897399902344
r_  generation:  0.04128885269165039
local_output_nid generation:  0.00707697868347168
local_in_edges_tensor generation:  0.003595590591430664
mini_batch_src_global generation:  0.0047435760498046875
r_  generation:  0.04370737075805664
local_output_nid generation:  0.007350921630859375
local_in_edges_tensor generation:  0.003759622573852539
mini_batch_src_global generation:  0.0031642913818359375
r_  generation:  0.04394412040710449
local_output_nid generation:  0.00743556022644043
local_in_edges_tensor generation:  0.003740549087524414
mini_batch_src_global generation:  0.003520965576171875
r_  generation:  0.04678916931152344
local_output_nid generation:  0.007588386535644531
local_in_edges_tensor generation:  0.003615140914916992
mini_batch_src_global generation:  0.0036585330963134766
r_  generation:  0.04718470573425293
local_output_nid generation:  0.007590055465698242
local_in_edges_tensor generation:  0.0037043094635009766
mini_batch_src_global generation:  0.004025936126708984
r_  generation:  0.04755115509033203
local_output_nid generation:  0.007483482360839844
local_in_edges_tensor generation:  0.0036585330963134766
mini_batch_src_global generation:  0.003979682922363281
r_  generation:  0.0480039119720459
local_output_nid generation:  0.007451295852661133
local_in_edges_tensor generation:  0.0036728382110595703
mini_batch_src_global generation:  0.004210233688354492
r_  generation:  0.048769474029541016
----------------------check_connections_block total spend ----------------------------- 0.60318922996521
generate_one_block  0.06095767021179199
generate_one_block  0.06162452697753906
generate_one_block  0.06373190879821777
generate_one_block  0.06281065940856934
generate_one_block  0.0623171329498291
generate_one_block  0.06427478790283203
generate_one_block  0.07623410224914551
generate_one_block  0.06587362289428711
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06459546089172363
gen group dst list time:  0.018728256225585938
time for parepare:  0.018944263458251953
local_output_nid generation:  0.01445150375366211
local_in_edges_tensor generation:  0.05857729911804199
mini_batch_src_global generation:  0.03542613983154297
r_  generation:  0.35751795768737793
local_output_nid generation:  0.020244359970092773
local_in_edges_tensor generation:  0.0362703800201416
mini_batch_src_global generation:  0.04500722885131836
r_  generation:  0.3684053421020508
local_output_nid generation:  0.01919102668762207
local_in_edges_tensor generation:  0.030034542083740234
mini_batch_src_global generation:  0.04405331611633301
r_  generation:  0.3729391098022461
local_output_nid generation:  0.01920175552368164
local_in_edges_tensor generation:  0.029642581939697266
mini_batch_src_global generation:  0.045050859451293945
r_  generation:  0.378765344619751
local_output_nid generation:  0.01903510093688965
local_in_edges_tensor generation:  0.02361774444580078
mini_batch_src_global generation:  0.0485079288482666
r_  generation:  0.3856618404388428
local_output_nid generation:  0.01931166648864746
local_in_edges_tensor generation:  0.02277970314025879
mini_batch_src_global generation:  0.04600787162780762
r_  generation:  0.3757286071777344
local_output_nid generation:  0.019395112991333008
local_in_edges_tensor generation:  0.031186819076538086
mini_batch_src_global generation:  0.046677589416503906
r_  generation:  0.3846626281738281
local_output_nid generation:  0.019327878952026367
local_in_edges_tensor generation:  0.02615833282470703
mini_batch_src_global generation:  0.048718929290771484
r_  generation:  0.3812069892883301
----------------------check_connections_block total spend ----------------------------- 4.425424098968506
generate_one_block  0.500699520111084
generate_one_block  0.5075027942657471
generate_one_block  0.5229334831237793
generate_one_block  0.5132746696472168
generate_one_block  0.5187351703643799
generate_one_block  0.505744218826294
generate_one_block  0.5101108551025391
generate_one_block  0.5507593154907227
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05393362045288086
gen group dst list time:  0.0397186279296875
time for parepare:  0.019702672958374023
local_output_nid generation:  0.02911853790283203
local_in_edges_tensor generation:  0.05979514122009277
mini_batch_src_global generation:  0.05473804473876953
r_  generation:  0.552969217300415
local_output_nid generation:  0.035799264907836914
local_in_edges_tensor generation:  0.05730247497558594
mini_batch_src_global generation:  0.06936120986938477
r_  generation:  0.5459814071655273
local_output_nid generation:  0.03548121452331543
local_in_edges_tensor generation:  0.04910635948181152
mini_batch_src_global generation:  0.06271767616271973
r_  generation:  0.5589797496795654
local_output_nid generation:  0.03538703918457031
local_in_edges_tensor generation:  0.0381159782409668
mini_batch_src_global generation:  0.06290817260742188
r_  generation:  0.5637772083282471
local_output_nid generation:  0.036672115325927734
local_in_edges_tensor generation:  0.044786691665649414
mini_batch_src_global generation:  0.06989169120788574
r_  generation:  0.5898206233978271
local_output_nid generation:  0.03735518455505371
local_in_edges_tensor generation:  0.06011772155761719
mini_batch_src_global generation:  0.06890082359313965
r_  generation:  0.5649044513702393
local_output_nid generation:  0.037862539291381836
local_in_edges_tensor generation:  0.04813885688781738
mini_batch_src_global generation:  0.06725525856018066
r_  generation:  0.5682179927825928
local_output_nid generation:  0.03693366050720215
local_in_edges_tensor generation:  0.04431557655334473
mini_batch_src_global generation:  0.06325745582580566
r_  generation:  0.5996856689453125
----------------------check_connections_block total spend ----------------------------- 6.767335891723633
generate_one_block  0.7160186767578125
generate_one_block  0.717524528503418
generate_one_block  0.7130248546600342
generate_one_block  0.7033042907714844
generate_one_block  0.7021768093109131
generate_one_block  0.7097713947296143
generate_one_block  0.7251555919647217
generate_one_block  0.7013325691223145
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.1404247283935547  GigaBytes
Max Memory Allocated: 0.650667667388916  GigaBytes

connection checking time:  11.192759990692139
block generation total time  9.818068742752075
average batch blocks generation time:  1.2272585928440094
block dataloader generation time/epoch 23.242663621902466
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.1050577163696289  GigaBytes
Max Memory Allocated: 0.650667667388916  GigaBytes

torch.Size([162678, 128])
torch.Size([145933, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.5791478157043457  GigaBytes
Max Memory Allocated: 0.650667667388916  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.10511350631713867  GigaBytes
Max Memory Allocated: 0.650667667388916  GigaBytes

torch.Size([162446, 128])
torch.Size([145891, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.5793180465698242  GigaBytes
Max Memory Allocated: 0.650667667388916  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.10494089126586914  GigaBytes
Max Memory Allocated: 0.650667667388916  GigaBytes

torch.Size([162706, 128])
torch.Size([146137, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.5788617134094238  GigaBytes
Max Memory Allocated: 0.650667667388916  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.10442972183227539  GigaBytes
Max Memory Allocated: 0.650667667388916  GigaBytes

torch.Size([162620, 128])
torch.Size([145727, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.5806841850280762  GigaBytes
Max Memory Allocated: 0.650667667388916  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.10469675064086914  GigaBytes
Max Memory Allocated: 0.650667667388916  GigaBytes

torch.Size([162506, 128])
torch.Size([145646, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.5790853500366211  GigaBytes
Max Memory Allocated: 0.650667667388916  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.1041560173034668  GigaBytes
Max Memory Allocated: 0.650667667388916  GigaBytes

torch.Size([162742, 128])
torch.Size([145888, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.5794544219970703  GigaBytes
Max Memory Allocated: 0.650667667388916  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.10483407974243164  GigaBytes
Max Memory Allocated: 0.650667667388916  GigaBytes

torch.Size([162595, 128])
torch.Size([146162, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.5800766944885254  GigaBytes
Max Memory Allocated: 0.650667667388916  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.10487747192382812  GigaBytes
Max Memory Allocated: 0.650667667388916  GigaBytes

torch.Size([162655, 128])
torch.Size([145884, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.5789995193481445  GigaBytes
Max Memory Allocated: 0.650667667388916  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04935860633850098 |0.028619110584259033 |0.0038511455059051514 |9.819865226745605e-05 |0.003395676612854004 |0.0013573169708251953 |
----------------------------------------------------------pseudo_mini_loss sum 3.5739431381225586
Total (block generation + training)time/epoch 23.962011575698853
Training time/epoch 0.7191269397735596
Training time without block to device /epoch 0.4901740550994873
Training time without total dataloading part /epoch 0.060117483139038086
load block tensor time/epoch 0.3948688507080078
block to device time/epoch 0.22895288467407227
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3057279
Number of first layer input nodes during this epoch:  1300948
