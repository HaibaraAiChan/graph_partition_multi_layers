Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648479685.492206
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0004115104675292969  GigaBytes
Max Memory Allocated: 0.0004115104675292969  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.02449488639831543
random selection method range initialization spend 0.006419658660888672
time for parepare:  0.018633604049682617
local_output_nid generation:  0.0042951107025146484
local_in_edges_tensor generation:  0.006238460540771484
mini_batch_src_global generation:  0.003332853317260742
r_  generation:  0.037897586822509766
local_output_nid generation:  0.005700111389160156
local_in_edges_tensor generation:  0.0032358169555664062
mini_batch_src_global generation:  0.00424957275390625
r_  generation:  0.038599252700805664
local_output_nid generation:  0.005972862243652344
local_in_edges_tensor generation:  0.0032455921173095703
mini_batch_src_global generation:  0.002824544906616211
r_  generation:  0.03902268409729004
local_output_nid generation:  0.006025791168212891
local_in_edges_tensor generation:  0.0032875537872314453
mini_batch_src_global generation:  0.0029058456420898438
r_  generation:  0.04015207290649414
local_output_nid generation:  0.006006479263305664
local_in_edges_tensor generation:  0.0032415390014648438
mini_batch_src_global generation:  0.0030167102813720703
r_  generation:  0.04024004936218262
local_output_nid generation:  0.0059621334075927734
local_in_edges_tensor generation:  0.003210306167602539
mini_batch_src_global generation:  0.0033795833587646484
r_  generation:  0.041541337966918945
local_output_nid generation:  0.0060558319091796875
local_in_edges_tensor generation:  0.003191709518432617
mini_batch_src_global generation:  0.003390073776245117
r_  generation:  0.04136538505554199
local_output_nid generation:  0.006050586700439453
local_in_edges_tensor generation:  0.0032444000244140625
mini_batch_src_global generation:  0.00337982177734375
r_  generation:  0.041329145431518555
----------------------check_connections_block total spend ----------------------------- 0.5169582366943359
generate_one_block  0.054137229919433594
generate_one_block  0.054871559143066406
generate_one_block  0.05525636672973633
generate_one_block  0.05454397201538086
generate_one_block  0.05815553665161133
generate_one_block  0.05521821975708008
generate_one_block  0.054688215255737305
generate_one_block  0.05521678924560547
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.041290283203125
gen group dst list time:  0.015239953994750977
time for parepare:  0.019424915313720703
local_output_nid generation:  0.013261079788208008
local_in_edges_tensor generation:  0.03267669677734375
mini_batch_src_global generation:  0.028023958206176758
r_  generation:  0.2957468032836914
local_output_nid generation:  0.018674373626708984
local_in_edges_tensor generation:  0.029584646224975586
mini_batch_src_global generation:  0.036928415298461914
r_  generation:  0.30425333976745605
local_output_nid generation:  0.018134117126464844
local_in_edges_tensor generation:  0.02435898780822754
mini_batch_src_global generation:  0.03562784194946289
r_  generation:  0.30954504013061523
local_output_nid generation:  0.01787400245666504
local_in_edges_tensor generation:  0.02161860466003418
mini_batch_src_global generation:  0.036986351013183594
r_  generation:  0.3193693161010742
local_output_nid generation:  0.018041372299194336
local_in_edges_tensor generation:  0.022219419479370117
mini_batch_src_global generation:  0.039972543716430664
r_  generation:  0.313565731048584
local_output_nid generation:  0.018382549285888672
local_in_edges_tensor generation:  0.02819228172302246
mini_batch_src_global generation:  0.03835773468017578
r_  generation:  0.3198525905609131
local_output_nid generation:  0.01816272735595703
local_in_edges_tensor generation:  0.021912097930908203
mini_batch_src_global generation:  0.038398027420043945
r_  generation:  0.31680893898010254
local_output_nid generation:  0.01831650733947754
local_in_edges_tensor generation:  0.018706083297729492
mini_batch_src_global generation:  0.03890538215637207
r_  generation:  0.3224639892578125
----------------------check_connections_block total spend ----------------------------- 3.688810110092163
generate_one_block  0.4063129425048828
generate_one_block  0.4057197570800781
generate_one_block  0.4043152332305908
generate_one_block  0.39894938468933105
generate_one_block  0.40910816192626953
generate_one_block  0.4283182621002197
generate_one_block  0.4078035354614258
generate_one_block  0.4065115451812744
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04042673110961914
gen group dst list time:  0.03565502166748047
time for parepare:  0.01874232292175293
local_output_nid generation:  0.028208255767822266
local_in_edges_tensor generation:  0.04555106163024902
mini_batch_src_global generation:  0.05202078819274902
r_  generation:  0.5126583576202393
local_output_nid generation:  0.034301042556762695
local_in_edges_tensor generation:  0.05476880073547363
mini_batch_src_global generation:  0.05920886993408203
r_  generation:  0.5152151584625244
local_output_nid generation:  0.03461885452270508
local_in_edges_tensor generation:  0.04131007194519043
mini_batch_src_global generation:  0.05624723434448242
r_  generation:  0.5265405178070068
local_output_nid generation:  0.03461170196533203
local_in_edges_tensor generation:  0.04007720947265625
mini_batch_src_global generation:  0.05937838554382324
r_  generation:  0.5197803974151611
local_output_nid generation:  0.034708499908447266
local_in_edges_tensor generation:  0.04051971435546875
mini_batch_src_global generation:  0.0614008903503418
r_  generation:  0.5320436954498291
local_output_nid generation:  0.03462076187133789
local_in_edges_tensor generation:  0.050519704818725586
mini_batch_src_global generation:  0.05986142158508301
r_  generation:  0.5231723785400391
local_output_nid generation:  0.03457069396972656
local_in_edges_tensor generation:  0.04060053825378418
mini_batch_src_global generation:  0.058196306228637695
r_  generation:  0.5337886810302734
local_output_nid generation:  0.0343170166015625
local_in_edges_tensor generation:  0.03771710395812988
mini_batch_src_global generation:  0.06048393249511719
r_  generation:  0.5215086936950684
----------------------check_connections_block total spend ----------------------------- 6.202906608581543
generate_one_block  0.6596992015838623
generate_one_block  0.6642241477966309
generate_one_block  0.6590819358825684
generate_one_block  0.65574049949646
generate_one_block  0.6695671081542969
generate_one_block  0.6706764698028564
generate_one_block  0.6897809505462646
generate_one_block  0.6539990901947021
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.026596784591674805
gen group dst list time:  0.04471707344055176
time for parepare:  0.01893472671508789
local_output_nid generation:  0.033677101135253906
local_in_edges_tensor generation:  0.04297161102294922
mini_batch_src_global generation:  0.0450901985168457
r_  generation:  0.49604296684265137
local_output_nid generation:  0.03884577751159668
local_in_edges_tensor generation:  0.04098176956176758
mini_batch_src_global generation:  0.05701494216918945
r_  generation:  0.503096342086792
local_output_nid generation:  0.03876638412475586
local_in_edges_tensor generation:  0.043694257736206055
mini_batch_src_global generation:  0.05694103240966797
r_  generation:  0.5011253356933594
local_output_nid generation:  0.03844499588012695
local_in_edges_tensor generation:  0.03564715385437012
mini_batch_src_global generation:  0.0546412467956543
r_  generation:  0.5160341262817383
local_output_nid generation:  0.039142608642578125
local_in_edges_tensor generation:  0.03930187225341797
mini_batch_src_global generation:  0.05821585655212402
r_  generation:  0.5078868865966797
local_output_nid generation:  0.03859591484069824
local_in_edges_tensor generation:  0.04337000846862793
mini_batch_src_global generation:  0.05471062660217285
r_  generation:  0.5129470825195312
local_output_nid generation:  0.03858160972595215
local_in_edges_tensor generation:  0.03927350044250488
mini_batch_src_global generation:  0.05506181716918945
r_  generation:  0.5215075016021729
local_output_nid generation:  0.03881430625915527
local_in_edges_tensor generation:  0.038277387619018555
mini_batch_src_global generation:  0.05625724792480469
r_  generation:  0.5174837112426758
----------------------check_connections_block total spend ----------------------------- 6.095316648483276
generate_one_block  0.6485409736633301
generate_one_block  0.6395108699798584
generate_one_block  0.6370890140533447
generate_one_block  0.6368913650512695
generate_one_block  0.6619384288787842
generate_one_block  0.641758918762207
generate_one_block  0.6867070198059082
generate_one_block  0.6355652809143066
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0004115104675292969  GigaBytes
Max Memory Allocated: 0.0004115104675292969  GigaBytes

connection checking time:  15.987033367156982
block generation total time  13.777810096740723
average batch blocks generation time:  1.7222262620925903
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2010498046875 GB
    Memory Allocated: 0.11137819290161133  GigaBytes
Max Memory Allocated: 0.11137819290161133  GigaBytes

torch.Size([165540, 128])
torch.Size([161213, 128])
torch.Size([142089, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3123779296875 GB
    Memory Allocated: 0.9045615196228027  GigaBytes
Max Memory Allocated: 0.9322223663330078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7401123046875 GB
    Memory Allocated: 0.1135091781616211  GigaBytes
Max Memory Allocated: 0.968137264251709  GigaBytes

torch.Size([165359, 128])
torch.Size([160922, 128])
torch.Size([141759, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.9081592559814453  GigaBytes
Max Memory Allocated: 0.968137264251709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.11390495300292969  GigaBytes
Max Memory Allocated: 0.9719743728637695  GigaBytes

torch.Size([165653, 128])
torch.Size([161375, 128])
torch.Size([142122, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.9067893028259277  GigaBytes
Max Memory Allocated: 0.9719743728637695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.11370372772216797  GigaBytes
Max Memory Allocated: 0.9719743728637695  GigaBytes

torch.Size([165393, 128])
torch.Size([160976, 128])
torch.Size([141619, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.9049453735351562  GigaBytes
Max Memory Allocated: 0.9719743728637695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.11437845230102539  GigaBytes
Max Memory Allocated: 0.9719743728637695  GigaBytes

torch.Size([165499, 128])
torch.Size([161196, 128])
torch.Size([142279, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.9082269668579102  GigaBytes
Max Memory Allocated: 0.9719743728637695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.11394453048706055  GigaBytes
Max Memory Allocated: 0.9719743728637695  GigaBytes

torch.Size([165446, 128])
torch.Size([161186, 128])
torch.Size([142346, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.9074277877807617  GigaBytes
Max Memory Allocated: 0.9719743728637695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.11387205123901367  GigaBytes
Max Memory Allocated: 0.9722461700439453  GigaBytes

torch.Size([165516, 128])
torch.Size([161242, 128])
torch.Size([142257, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.9078664779663086  GigaBytes
Max Memory Allocated: 0.9722461700439453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.11351537704467773  GigaBytes
Max Memory Allocated: 0.9727835655212402  GigaBytes

torch.Size([165513, 128])
torch.Size([161155, 128])
torch.Size([141881, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.9067859649658203  GigaBytes
Max Memory Allocated: 0.9727835655212402  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06202313303947449 |0.06831082701683044 |0.09516757726669312 |9.882450103759766e-05 |0.015450149774551392 |0.004784345626831055 |
----------------------------------------------------------pseudo_mini_loss sum 5.811405181884766
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  4292443
Number of first layer input nodes during this epoch:  1323919
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.17044782638549805  GigaBytes
Max Memory Allocated: 0.9727835655212402  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0248410701751709
random selection method range initialization spend 0.005146980285644531
time for parepare:  0.016803264617919922
local_output_nid generation:  0.0044460296630859375
local_in_edges_tensor generation:  0.0065593719482421875
mini_batch_src_global generation:  0.003274202346801758
r_  generation:  0.036124229431152344
local_output_nid generation:  0.005664348602294922
local_in_edges_tensor generation:  0.0031273365020751953
mini_batch_src_global generation:  0.004089832305908203
r_  generation:  0.03698301315307617
local_output_nid generation:  0.005929231643676758
local_in_edges_tensor generation:  0.003123044967651367
mini_batch_src_global generation:  0.002759695053100586
r_  generation:  0.037908077239990234
local_output_nid generation:  0.005938053131103516
local_in_edges_tensor generation:  0.0030927658081054688
mini_batch_src_global generation:  0.0029480457305908203
r_  generation:  0.03980565071105957
local_output_nid generation:  0.0060231685638427734
local_in_edges_tensor generation:  0.003071308135986328
mini_batch_src_global generation:  0.003011465072631836
r_  generation:  0.0397183895111084
local_output_nid generation:  0.0060422420501708984
local_in_edges_tensor generation:  0.0031092166900634766
mini_batch_src_global generation:  0.003190279006958008
r_  generation:  0.041178226470947266
local_output_nid generation:  0.005940437316894531
local_in_edges_tensor generation:  0.003160715103149414
mini_batch_src_global generation:  0.003235340118408203
r_  generation:  0.04091644287109375
local_output_nid generation:  0.0059888362884521484
local_in_edges_tensor generation:  0.003085613250732422
mini_batch_src_global generation:  0.0034019947052001953
r_  generation:  0.041152238845825195
----------------------check_connections_block total spend ----------------------------- 0.5062615871429443
generate_one_block  0.05239439010620117
generate_one_block  0.05300498008728027
generate_one_block  0.05326056480407715
generate_one_block  0.05706524848937988
generate_one_block  0.054060935974121094
generate_one_block  0.054236650466918945
generate_one_block  0.0640709400177002
generate_one_block  0.055394649505615234
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0548708438873291
gen group dst list time:  0.015711307525634766
time for parepare:  0.021079063415527344
local_output_nid generation:  0.013936281204223633
local_in_edges_tensor generation:  0.032773733139038086
mini_batch_src_global generation:  0.0280611515045166
r_  generation:  0.2908608913421631
local_output_nid generation:  0.019150733947753906
local_in_edges_tensor generation:  0.03027057647705078
mini_batch_src_global generation:  0.03592276573181152
r_  generation:  0.30248022079467773
local_output_nid generation:  0.018087148666381836
local_in_edges_tensor generation:  0.027362585067749023
mini_batch_src_global generation:  0.03561806678771973
r_  generation:  0.30857396125793457
local_output_nid generation:  0.018295764923095703
local_in_edges_tensor generation:  0.02329087257385254
mini_batch_src_global generation:  0.037793874740600586
r_  generation:  0.3146631717681885
local_output_nid generation:  0.021927595138549805
local_in_edges_tensor generation:  0.04391288757324219
mini_batch_src_global generation:  0.04894518852233887
r_  generation:  0.3115973472595215
local_output_nid generation:  0.0182187557220459
local_in_edges_tensor generation:  0.02341485023498535
mini_batch_src_global generation:  0.04065752029418945
r_  generation:  0.31533145904541016
local_output_nid generation:  0.018108606338500977
local_in_edges_tensor generation:  0.022461652755737305
mini_batch_src_global generation:  0.03892683982849121
r_  generation:  0.3176710605621338
local_output_nid generation:  0.018113374710083008
local_in_edges_tensor generation:  0.020610809326171875
mini_batch_src_global generation:  0.038980722427368164
r_  generation:  0.3157529830932617
----------------------check_connections_block total spend ----------------------------- 3.7180428504943848
generate_one_block  0.4191570281982422
generate_one_block  0.40784263610839844
generate_one_block  0.40511655807495117
generate_one_block  0.41076135635375977
generate_one_block  0.39801478385925293
generate_one_block  0.4068758487701416
generate_one_block  0.412097692489624
generate_one_block  0.43515968322753906
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.048825979232788086
gen group dst list time:  0.03592967987060547
time for parepare:  0.01878070831298828
local_output_nid generation:  0.027571678161621094
local_in_edges_tensor generation:  0.07584166526794434
mini_batch_src_global generation:  0.054218292236328125
r_  generation:  0.5076448917388916
local_output_nid generation:  0.034209489822387695
local_in_edges_tensor generation:  0.05331611633300781
mini_batch_src_global generation:  0.05995821952819824
r_  generation:  0.5158741474151611
local_output_nid generation:  0.03440356254577637
local_in_edges_tensor generation:  0.03956770896911621
mini_batch_src_global generation:  0.056534767150878906
r_  generation:  0.527428150177002
local_output_nid generation:  0.03438520431518555
local_in_edges_tensor generation:  0.05302882194519043
mini_batch_src_global generation:  0.05910682678222656
r_  generation:  0.5232071876525879
local_output_nid generation:  0.034264564514160156
local_in_edges_tensor generation:  0.03941464424133301
mini_batch_src_global generation:  0.057990074157714844
r_  generation:  0.534705638885498
local_output_nid generation:  0.0346074104309082
local_in_edges_tensor generation:  0.04042792320251465
mini_batch_src_global generation:  0.0635986328125
r_  generation:  0.5235605239868164
local_output_nid generation:  0.03452634811401367
local_in_edges_tensor generation:  0.04354405403137207
mini_batch_src_global generation:  0.05875873565673828
r_  generation:  0.5347824096679688
local_output_nid generation:  0.03466033935546875
local_in_edges_tensor generation:  0.03534102439880371
mini_batch_src_global generation:  0.06436586380004883
r_  generation:  0.528510570526123
----------------------check_connections_block total spend ----------------------------- 6.249238014221191
generate_one_block  0.6688320636749268
generate_one_block  0.6551289558410645
generate_one_block  0.6632585525512695
generate_one_block  0.67276930809021
generate_one_block  0.6648764610290527
generate_one_block  0.672210693359375
generate_one_block  0.6594352722167969
generate_one_block  0.66697096824646
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.038976192474365234
gen group dst list time:  0.045453786849975586
time for parepare:  0.01886582374572754
local_output_nid generation:  0.03373384475708008
local_in_edges_tensor generation:  0.044495582580566406
mini_batch_src_global generation:  0.04623866081237793
r_  generation:  0.5343017578125
local_output_nid generation:  0.040160417556762695
local_in_edges_tensor generation:  0.03484082221984863
mini_batch_src_global generation:  0.058267831802368164
r_  generation:  0.5099978446960449
local_output_nid generation:  0.03873014450073242
local_in_edges_tensor generation:  0.04272770881652832
mini_batch_src_global generation:  0.05817270278930664
r_  generation:  0.5107038021087646
local_output_nid generation:  0.03886771202087402
local_in_edges_tensor generation:  0.04027986526489258
mini_batch_src_global generation:  0.05548262596130371
r_  generation:  0.5181856155395508
local_output_nid generation:  0.0397038459777832
local_in_edges_tensor generation:  0.04373502731323242
mini_batch_src_global generation:  0.05478978157043457
r_  generation:  0.5174217224121094
local_output_nid generation:  0.03902077674865723
local_in_edges_tensor generation:  0.03943896293640137
mini_batch_src_global generation:  0.0559687614440918
r_  generation:  0.5247349739074707
local_output_nid generation:  0.039045095443725586
local_in_edges_tensor generation:  0.042717933654785156
mini_batch_src_global generation:  0.05469632148742676
r_  generation:  0.5249526500701904
local_output_nid generation:  0.0391082763671875
local_in_edges_tensor generation:  0.039370059967041016
mini_batch_src_global generation:  0.05614447593688965
r_  generation:  0.5291614532470703
----------------------check_connections_block total spend ----------------------------- 6.199152946472168
generate_one_block  0.6268291473388672
generate_one_block  0.6449840068817139
generate_one_block  0.6360788345336914
generate_one_block  0.6614744663238525
generate_one_block  0.6354002952575684
generate_one_block  0.6391351222991943
generate_one_block  0.6271021366119385
generate_one_block  0.6450598239898682
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.17044782638549805  GigaBytes
Max Memory Allocated: 0.9727835655212402  GigaBytes

connection checking time:  16.166433811187744
block generation total time  13.734571695327759
average batch blocks generation time:  1.7168214619159698
block dataloader generation time/epoch 32.141467571258545
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.114501953125  GigaBytes
Max Memory Allocated: 0.9727835655212402  GigaBytes

torch.Size([165684, 128])
torch.Size([161449, 128])
torch.Size([142083, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.9080920219421387  GigaBytes
Max Memory Allocated: 0.9727835655212402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.114532470703125  GigaBytes
Max Memory Allocated: 0.9727835655212402  GigaBytes

torch.Size([165472, 128])
torch.Size([160983, 128])
torch.Size([141519, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.9042682647705078  GigaBytes
Max Memory Allocated: 0.9727835655212402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.11438608169555664  GigaBytes
Max Memory Allocated: 0.9727835655212402  GigaBytes

torch.Size([165451, 128])
torch.Size([161022, 128])
torch.Size([141690, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.9046516418457031  GigaBytes
Max Memory Allocated: 0.9727835655212402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.11473989486694336  GigaBytes
Max Memory Allocated: 0.9727835655212402  GigaBytes

torch.Size([165530, 128])
torch.Size([161134, 128])
torch.Size([142272, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.9086160659790039  GigaBytes
Max Memory Allocated: 0.9727835655212402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7440185546875 GB
    Memory Allocated: 0.11425304412841797  GigaBytes
Max Memory Allocated: 0.9737715721130371  GigaBytes

torch.Size([165618, 128])
torch.Size([161382, 128])
torch.Size([142160, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7440185546875 GB
    Memory Allocated: 0.9068655967712402  GigaBytes
Max Memory Allocated: 0.9737715721130371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7440185546875 GB
    Memory Allocated: 0.11468315124511719  GigaBytes
Max Memory Allocated: 0.9737715721130371  GigaBytes

torch.Size([165507, 128])
torch.Size([161293, 128])
torch.Size([142506, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7440185546875 GB
    Memory Allocated: 0.9088201522827148  GigaBytes
Max Memory Allocated: 0.9737715721130371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7440185546875 GB
    Memory Allocated: 0.11435127258300781  GigaBytes
Max Memory Allocated: 0.9738945960998535  GigaBytes

torch.Size([165484, 128])
torch.Size([161009, 128])
torch.Size([141935, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7440185546875 GB
    Memory Allocated: 0.9080023765563965  GigaBytes
Max Memory Allocated: 0.9738945960998535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7440185546875 GB
    Memory Allocated: 0.11471271514892578  GigaBytes
Max Memory Allocated: 0.9738945960998535  GigaBytes

torch.Size([165485, 128])
torch.Size([161215, 128])
torch.Size([142090, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7440185546875 GB
    Memory Allocated: 0.9074058532714844  GigaBytes
Max Memory Allocated: 0.9738945960998535  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06531071662902832 |0.026328712701797485 |0.004812449216842651 |9.253621101379395e-05 |0.01062631607055664 |0.0032439231872558594 |
----------------------------------------------------------pseudo_mini_loss sum 3.7690787315368652
Total (block generation + training)time/epoch 33.05739903450012
Training time/epoch 0.9156198501586914
Training time without block to device /epoch 0.7049901485443115
Training time without total dataloading part /epoch 0.12749433517456055
load block tensor time/epoch 0.5224857330322266
block to device time/epoch 0.21062970161437988
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  4292584
Number of first layer input nodes during this epoch:  1324231
