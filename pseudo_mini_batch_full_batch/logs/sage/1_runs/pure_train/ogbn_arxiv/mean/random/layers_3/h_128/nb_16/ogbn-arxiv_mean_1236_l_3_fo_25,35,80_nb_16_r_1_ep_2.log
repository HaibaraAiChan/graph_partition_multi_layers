Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648441965.7053728
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028118610382080078
random selection method range initialization spend 0.00618433952331543
time for parepare:  0.018794775009155273
local_output_nid generation:  0.0021529197692871094
local_in_edges_tensor generation:  0.0051004886627197266
mini_batch_src_global generation:  0.0019826889038085938
r_  generation:  0.020164012908935547
local_output_nid generation:  0.0026578903198242188
local_in_edges_tensor generation:  0.0016970634460449219
mini_batch_src_global generation:  0.002460956573486328
r_  generation:  0.02024531364440918
local_output_nid generation:  0.0028367042541503906
local_in_edges_tensor generation:  0.0016446113586425781
mini_batch_src_global generation:  0.001504659652709961
r_  generation:  0.019792556762695312
local_output_nid generation:  0.002870321273803711
local_in_edges_tensor generation:  0.0015263557434082031
mini_batch_src_global generation:  0.0015408992767333984
r_  generation:  0.01946115493774414
local_output_nid generation:  0.0028252601623535156
local_in_edges_tensor generation:  0.0015041828155517578
mini_batch_src_global generation:  0.0015056133270263672
r_  generation:  0.020354032516479492
local_output_nid generation:  0.0029366016387939453
local_in_edges_tensor generation:  0.0015265941619873047
mini_batch_src_global generation:  0.0016758441925048828
r_  generation:  0.02135634422302246
local_output_nid generation:  0.0029103755950927734
local_in_edges_tensor generation:  0.0015006065368652344
mini_batch_src_global generation:  0.0017054080963134766
r_  generation:  0.021352529525756836
local_output_nid generation:  0.0029129981994628906
local_in_edges_tensor generation:  0.0016160011291503906
mini_batch_src_global generation:  0.0017390251159667969
r_  generation:  0.02165842056274414
local_output_nid generation:  0.0029227733612060547
local_in_edges_tensor generation:  0.0015330314636230469
mini_batch_src_global generation:  0.0016105175018310547
r_  generation:  0.0207974910736084
local_output_nid generation:  0.00286865234375
local_in_edges_tensor generation:  0.0015194416046142578
mini_batch_src_global generation:  0.001645803451538086
r_  generation:  0.021419286727905273
local_output_nid generation:  0.0028946399688720703
local_in_edges_tensor generation:  0.0014798641204833984
mini_batch_src_global generation:  0.0016832351684570312
r_  generation:  0.021315336227416992
local_output_nid generation:  0.0029218196868896484
local_in_edges_tensor generation:  0.0014681816101074219
mini_batch_src_global generation:  0.0018188953399658203
r_  generation:  0.021363019943237305
local_output_nid generation:  0.0029747486114501953
local_in_edges_tensor generation:  0.0014662742614746094
mini_batch_src_global generation:  0.0017313957214355469
r_  generation:  0.02166581153869629
local_output_nid generation:  0.0029251575469970703
local_in_edges_tensor generation:  0.0014958381652832031
mini_batch_src_global generation:  0.0017504692077636719
r_  generation:  0.021015644073486328
local_output_nid generation:  0.0028753280639648438
local_in_edges_tensor generation:  0.0014965534210205078
mini_batch_src_global generation:  0.0017566680908203125
r_  generation:  0.021633386611938477
local_output_nid generation:  0.002887248992919922
local_in_edges_tensor generation:  0.0014705657958984375
mini_batch_src_global generation:  0.001781463623046875
r_  generation:  0.021554946899414062
----------------------check_connections_block total spend ----------------------------- 0.5405166149139404
generate_one_block  0.030297279357910156
generate_one_block  0.03147435188293457
generate_one_block  0.0326845645904541
generate_one_block  0.030277490615844727
generate_one_block  0.03130483627319336
generate_one_block  0.031439781188964844
generate_one_block  0.031229496002197266
generate_one_block  0.03198862075805664
generate_one_block  0.030682086944580078
generate_one_block  0.0310819149017334
generate_one_block  0.03151369094848633
generate_one_block  0.031138181686401367
generate_one_block  0.031165599822998047
generate_one_block  0.030570507049560547
generate_one_block  0.0312502384185791
generate_one_block  0.03136897087097168
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03691840171813965
gen group dst list time:  0.020413875579833984
time for parepare:  0.01953577995300293
local_output_nid generation:  0.00911402702331543
local_in_edges_tensor generation:  0.021850109100341797
mini_batch_src_global generation:  0.022658586502075195
r_  generation:  0.21366620063781738
local_output_nid generation:  0.015788793563842773
local_in_edges_tensor generation:  0.023060083389282227
mini_batch_src_global generation:  0.02653026580810547
r_  generation:  0.21935319900512695
local_output_nid generation:  0.01535177230834961
local_in_edges_tensor generation:  0.014937162399291992
mini_batch_src_global generation:  0.02563333511352539
r_  generation:  0.2204725742340088
local_output_nid generation:  0.015642881393432617
local_in_edges_tensor generation:  0.019924402236938477
mini_batch_src_global generation:  0.026411056518554688
r_  generation:  0.2268071174621582
local_output_nid generation:  0.015848636627197266
local_in_edges_tensor generation:  0.018975019454956055
mini_batch_src_global generation:  0.03797101974487305
r_  generation:  0.23780488967895508
local_output_nid generation:  0.015793323516845703
local_in_edges_tensor generation:  0.01439523696899414
mini_batch_src_global generation:  0.028661489486694336
r_  generation:  0.23361515998840332
local_output_nid generation:  0.01601696014404297
local_in_edges_tensor generation:  0.020334720611572266
mini_batch_src_global generation:  0.029104232788085938
r_  generation:  0.23516082763671875
local_output_nid generation:  0.01592278480529785
local_in_edges_tensor generation:  0.018662691116333008
mini_batch_src_global generation:  0.029286623001098633
r_  generation:  0.23816967010498047
local_output_nid generation:  0.015756845474243164
local_in_edges_tensor generation:  0.016987323760986328
mini_batch_src_global generation:  0.029040098190307617
r_  generation:  0.23122048377990723
local_output_nid generation:  0.016138076782226562
local_in_edges_tensor generation:  0.016677379608154297
mini_batch_src_global generation:  0.029570341110229492
r_  generation:  0.2360384464263916
local_output_nid generation:  0.015668153762817383
local_in_edges_tensor generation:  0.022492170333862305
mini_batch_src_global generation:  0.029373884201049805
r_  generation:  0.24280810356140137
local_output_nid generation:  0.016081809997558594
local_in_edges_tensor generation:  0.014789342880249023
mini_batch_src_global generation:  0.029801607131958008
r_  generation:  0.23850417137145996
local_output_nid generation:  0.01586604118347168
local_in_edges_tensor generation:  0.01515650749206543
mini_batch_src_global generation:  0.029610395431518555
r_  generation:  0.23875927925109863
local_output_nid generation:  0.015738487243652344
local_in_edges_tensor generation:  0.015072107315063477
mini_batch_src_global generation:  0.029047250747680664
r_  generation:  0.23191571235656738
local_output_nid generation:  0.01594996452331543
local_in_edges_tensor generation:  0.016775131225585938
mini_batch_src_global generation:  0.02942633628845215
r_  generation:  0.23747014999389648
local_output_nid generation:  0.016084909439086914
local_in_edges_tensor generation:  0.018883228302001953
mini_batch_src_global generation:  0.029326677322387695
r_  generation:  0.24006009101867676
----------------------check_connections_block total spend ----------------------------- 5.552141904830933
generate_one_block  0.3074207305908203
generate_one_block  0.30248308181762695
generate_one_block  0.288891077041626
generate_one_block  0.30385899543762207
generate_one_block  0.32531166076660156
generate_one_block  0.30606937408447266
generate_one_block  0.3115091323852539
generate_one_block  0.3162844181060791
generate_one_block  0.30118799209594727
generate_one_block  0.30584168434143066
generate_one_block  0.3128800392150879
generate_one_block  0.31297993659973145
generate_one_block  0.31441569328308105
generate_one_block  0.29932522773742676
generate_one_block  0.30686259269714355
generate_one_block  0.3146793842315674
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03629469871520996
gen group dst list time:  0.060083866119384766
time for parepare:  0.01975846290588379
local_output_nid generation:  0.026221513748168945
local_in_edges_tensor generation:  0.037049293518066406
mini_batch_src_global generation:  0.04422736167907715
r_  generation:  0.442777156829834
local_output_nid generation:  0.03215599060058594
local_in_edges_tensor generation:  0.04648447036743164
mini_batch_src_global generation:  0.052336692810058594
r_  generation:  0.4546477794647217
local_output_nid generation:  0.03106546401977539
local_in_edges_tensor generation:  0.03508806228637695
mini_batch_src_global generation:  0.05055570602416992
r_  generation:  0.45314693450927734
local_output_nid generation:  0.03133869171142578
local_in_edges_tensor generation:  0.0344696044921875
mini_batch_src_global generation:  0.05224895477294922
r_  generation:  0.4537625312805176
local_output_nid generation:  0.03151535987854004
local_in_edges_tensor generation:  0.04698801040649414
mini_batch_src_global generation:  0.0550389289855957
r_  generation:  0.4632580280303955
local_output_nid generation:  0.0314483642578125
local_in_edges_tensor generation:  0.031455278396606445
mini_batch_src_global generation:  0.05318880081176758
r_  generation:  0.45983123779296875
local_output_nid generation:  0.031395912170410156
local_in_edges_tensor generation:  0.0308225154876709
mini_batch_src_global generation:  0.05282926559448242
r_  generation:  0.4677906036376953
local_output_nid generation:  0.03183317184448242
local_in_edges_tensor generation:  0.038722991943359375
mini_batch_src_global generation:  0.05785250663757324
r_  generation:  0.47472572326660156
local_output_nid generation:  0.03321695327758789
local_in_edges_tensor generation:  0.0414423942565918
mini_batch_src_global generation:  0.05966639518737793
r_  generation:  0.47906041145324707
local_output_nid generation:  0.031435251235961914
local_in_edges_tensor generation:  0.02954888343811035
mini_batch_src_global generation:  0.05331587791442871
r_  generation:  0.46524715423583984
local_output_nid generation:  0.03168916702270508
local_in_edges_tensor generation:  0.030089139938354492
mini_batch_src_global generation:  0.0603787899017334
r_  generation:  0.4688277244567871
local_output_nid generation:  0.03161978721618652
local_in_edges_tensor generation:  0.04150056838989258
mini_batch_src_global generation:  0.05635714530944824
r_  generation:  0.46486830711364746
local_output_nid generation:  0.03170323371887207
local_in_edges_tensor generation:  0.03295445442199707
mini_batch_src_global generation:  0.05323457717895508
r_  generation:  0.4703691005706787
local_output_nid generation:  0.03607368469238281
local_in_edges_tensor generation:  0.03411865234375
mini_batch_src_global generation:  0.06194019317626953
r_  generation:  0.4622814655303955
local_output_nid generation:  0.03350424766540527
local_in_edges_tensor generation:  0.038138628005981445
mini_batch_src_global generation:  0.052648305892944336
r_  generation:  0.4711742401123047
local_output_nid generation:  0.033211469650268555
local_in_edges_tensor generation:  0.033686161041259766
mini_batch_src_global generation:  0.05344581604003906
r_  generation:  0.46593189239501953
----------------------check_connections_block total spend ----------------------------- 11.021408796310425
generate_one_block  0.5889277458190918
generate_one_block  0.587200403213501
generate_one_block  0.5844790935516357
generate_one_block  0.5951259136199951
generate_one_block  0.6010441780090332
generate_one_block  0.6012668609619141
generate_one_block  0.6926486492156982
generate_one_block  0.6267185211181641
generate_one_block  0.6154356002807617
generate_one_block  0.5884661674499512
generate_one_block  0.6066610813140869
generate_one_block  0.6172447204589844
generate_one_block  0.5849850177764893
generate_one_block  0.5765750408172607
generate_one_block  0.6167397499084473
generate_one_block  0.6024596691131592
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

connection checking time:  16.573550701141357
block generation total time  14.615979433059692
average batch blocks generation time:  0.9134987145662308
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.09087896347045898  GigaBytes
Max Memory Allocated: 0.09087896347045898  GigaBytes

torch.Size([155179, 128])
torch.Size([125156, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8494873046875 GB
    Memory Allocated: 0.4602479934692383  GigaBytes
Max Memory Allocated: 0.4798698425292969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.09200477600097656  GigaBytes
Max Memory Allocated: 0.5036497116088867  GigaBytes

torch.Size([155235, 128])
torch.Size([124967, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0799560546875 GB
    Memory Allocated: 0.45981931686401367  GigaBytes
Max Memory Allocated: 0.5036497116088867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0799560546875 GB
    Memory Allocated: 0.09177780151367188  GigaBytes
Max Memory Allocated: 0.5036497116088867  GigaBytes

torch.Size([154553, 128])
torch.Size([123755, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0799560546875 GB
    Memory Allocated: 0.4505729675292969  GigaBytes
Max Memory Allocated: 0.5036497116088867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0799560546875 GB
    Memory Allocated: 0.0919179916381836  GigaBytes
Max Memory Allocated: 0.5036497116088867  GigaBytes

torch.Size([154782, 128])
torch.Size([124442, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0799560546875 GB
    Memory Allocated: 0.4533400535583496  GigaBytes
Max Memory Allocated: 0.5036497116088867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0799560546875 GB
    Memory Allocated: 0.09211921691894531  GigaBytes
Max Memory Allocated: 0.5036497116088867  GigaBytes

torch.Size([155093, 128])
torch.Size([125080, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0799560546875 GB
    Memory Allocated: 0.46221351623535156  GigaBytes
Max Memory Allocated: 0.5036497116088867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0799560546875 GB
    Memory Allocated: 0.09206390380859375  GigaBytes
Max Memory Allocated: 0.5058512687683105  GigaBytes

torch.Size([155164, 128])
torch.Size([125075, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0799560546875 GB
    Memory Allocated: 0.46172142028808594  GigaBytes
Max Memory Allocated: 0.5058512687683105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0799560546875 GB
    Memory Allocated: 0.09210491180419922  GigaBytes
Max Memory Allocated: 0.5058512687683105  GigaBytes

torch.Size([154973, 128])
torch.Size([124697, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0799560546875 GB
    Memory Allocated: 0.45752716064453125  GigaBytes
Max Memory Allocated: 0.5058512687683105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0799560546875 GB
    Memory Allocated: 0.09222984313964844  GigaBytes
Max Memory Allocated: 0.5058512687683105  GigaBytes

torch.Size([155050, 128])
torch.Size([125276, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0799560546875 GB
    Memory Allocated: 0.46401309967041016  GigaBytes
Max Memory Allocated: 0.5058512687683105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0799560546875 GB
    Memory Allocated: 0.09201240539550781  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

torch.Size([154981, 128])
torch.Size([124521, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0799560546875 GB
    Memory Allocated: 0.4549264907836914  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0799560546875 GB
    Memory Allocated: 0.09206771850585938  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

torch.Size([154723, 128])
torch.Size([124489, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0799560546875 GB
    Memory Allocated: 0.45697784423828125  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0799560546875 GB
    Memory Allocated: 0.09213066101074219  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

torch.Size([154939, 128])
torch.Size([124646, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0799560546875 GB
    Memory Allocated: 0.4570021629333496  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0799560546875 GB
    Memory Allocated: 0.0922079086303711  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

torch.Size([155130, 128])
torch.Size([125514, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0799560546875 GB
    Memory Allocated: 0.46272945404052734  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0799560546875 GB
    Memory Allocated: 0.09214591979980469  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

torch.Size([154979, 128])
torch.Size([124934, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0799560546875 GB
    Memory Allocated: 0.46196556091308594  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0799560546875 GB
    Memory Allocated: 0.09194755554199219  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

torch.Size([155189, 128])
torch.Size([125151, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0799560546875 GB
    Memory Allocated: 0.45924949645996094  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0799560546875 GB
    Memory Allocated: 0.09209823608398438  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

torch.Size([155158, 128])
torch.Size([125111, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0799560546875 GB
    Memory Allocated: 0.4618353843688965  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0799560546875 GB
    Memory Allocated: 0.09218597412109375  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

torch.Size([155169, 128])
torch.Size([125414, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0799560546875 GB
    Memory Allocated: 0.4626960754394531  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.039935484528541565 |0.035229310393333435 |0.049438416957855225 |9.85562801361084e-05 |0.0059829652309417725 |0.001955747604370117 |
----------------------------------------------------------pseudo_mini_loss sum 5.632710933685303
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5208356
Number of first layer input nodes during this epoch:  2480297
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0799560546875 GB
    Memory Allocated: 0.11725616455078125  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024590253829956055
random selection method range initialization spend 0.0049784183502197266
time for parepare:  0.01847672462463379
local_output_nid generation:  0.002332448959350586
local_in_edges_tensor generation:  0.00920248031616211
mini_batch_src_global generation:  0.0019528865814208984
r_  generation:  0.01987290382385254
local_output_nid generation:  0.003035306930541992
local_in_edges_tensor generation:  0.0017096996307373047
mini_batch_src_global generation:  0.0023107528686523438
r_  generation:  0.02060556411743164
local_output_nid generation:  0.0029959678649902344
local_in_edges_tensor generation:  0.0016345977783203125
mini_batch_src_global generation:  0.0015130043029785156
r_  generation:  0.02121424674987793
local_output_nid generation:  0.0030379295349121094
local_in_edges_tensor generation:  0.0017626285552978516
mini_batch_src_global generation:  0.0015811920166015625
r_  generation:  0.021094322204589844
local_output_nid generation:  0.003016948699951172
local_in_edges_tensor generation:  0.0015926361083984375
mini_batch_src_global generation:  0.0015292167663574219
r_  generation:  0.020902633666992188
local_output_nid generation:  0.0029861927032470703
local_in_edges_tensor generation:  0.0016169548034667969
mini_batch_src_global generation:  0.001556396484375
r_  generation:  0.020844459533691406
local_output_nid generation:  0.0029621124267578125
local_in_edges_tensor generation:  0.0016133785247802734
mini_batch_src_global generation:  0.001605987548828125
r_  generation:  0.022087574005126953
local_output_nid generation:  0.0029587745666503906
local_in_edges_tensor generation:  0.0015223026275634766
mini_batch_src_global generation:  0.0016934871673583984
r_  generation:  0.022426605224609375
local_output_nid generation:  0.0029752254486083984
local_in_edges_tensor generation:  0.0016148090362548828
mini_batch_src_global generation:  0.0016472339630126953
r_  generation:  0.021363496780395508
local_output_nid generation:  0.0030050277709960938
local_in_edges_tensor generation:  0.0016021728515625
mini_batch_src_global generation:  0.001689910888671875
r_  generation:  0.021885156631469727
local_output_nid generation:  0.0029754638671875
local_in_edges_tensor generation:  0.0015411376953125
mini_batch_src_global generation:  0.0017061233520507812
r_  generation:  0.021836519241333008
local_output_nid generation:  0.002926349639892578
local_in_edges_tensor generation:  0.0015306472778320312
mini_batch_src_global generation:  0.0016803741455078125
r_  generation:  0.021423816680908203
local_output_nid generation:  0.0029141902923583984
local_in_edges_tensor generation:  0.0015635490417480469
mini_batch_src_global generation:  0.0017004013061523438
r_  generation:  0.02243828773498535
local_output_nid generation:  0.0029952526092529297
local_in_edges_tensor generation:  0.00156402587890625
mini_batch_src_global generation:  0.0017328262329101562
r_  generation:  0.022320032119750977
local_output_nid generation:  0.0029342174530029297
local_in_edges_tensor generation:  0.0016040802001953125
mini_batch_src_global generation:  0.0017387866973876953
r_  generation:  0.021730899810791016
local_output_nid generation:  0.0029172897338867188
local_in_edges_tensor generation:  0.0015578269958496094
mini_batch_src_global generation:  0.0017490386962890625
r_  generation:  0.022321701049804688
----------------------check_connections_block total spend ----------------------------- 0.5574426651000977
generate_one_block  0.030346393585205078
generate_one_block  0.031236648559570312
generate_one_block  0.03091716766357422
generate_one_block  0.03151440620422363
generate_one_block  0.030725717544555664
generate_one_block  0.032709598541259766
generate_one_block  0.033179283142089844
generate_one_block  0.031942129135131836
generate_one_block  0.030268192291259766
generate_one_block  0.03223395347595215
generate_one_block  0.031104326248168945
generate_one_block  0.031028270721435547
generate_one_block  0.03216099739074707
generate_one_block  0.03226947784423828
generate_one_block  0.030462265014648438
generate_one_block  0.0327911376953125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03774690628051758
gen group dst list time:  0.019269466400146484
time for parepare:  0.018773555755615234
local_output_nid generation:  0.008830070495605469
local_in_edges_tensor generation:  0.028334617614746094
mini_batch_src_global generation:  0.02100968360900879
r_  generation:  0.21922588348388672
local_output_nid generation:  0.013067245483398438
local_in_edges_tensor generation:  0.020921945571899414
mini_batch_src_global generation:  0.02680063247680664
r_  generation:  0.2194061279296875
local_output_nid generation:  0.013106584548950195
local_in_edges_tensor generation:  0.0194704532623291
mini_batch_src_global generation:  0.026084184646606445
r_  generation:  0.2300412654876709
local_output_nid generation:  0.013648271560668945
local_in_edges_tensor generation:  0.01359105110168457
mini_batch_src_global generation:  0.027388572692871094
r_  generation:  0.23164939880371094
local_output_nid generation:  0.013510465621948242
local_in_edges_tensor generation:  0.017425060272216797
mini_batch_src_global generation:  0.028501272201538086
r_  generation:  0.23974823951721191
local_output_nid generation:  0.013046979904174805
local_in_edges_tensor generation:  0.017283201217651367
mini_batch_src_global generation:  0.028287172317504883
r_  generation:  0.23117303848266602
local_output_nid generation:  0.013140201568603516
local_in_edges_tensor generation:  0.013370990753173828
mini_batch_src_global generation:  0.031143665313720703
r_  generation:  0.24206089973449707
local_output_nid generation:  0.012911558151245117
local_in_edges_tensor generation:  0.01732182502746582
mini_batch_src_global generation:  0.02899336814880371
r_  generation:  0.2338697910308838
local_output_nid generation:  0.01280832290649414
local_in_edges_tensor generation:  0.013273000717163086
mini_batch_src_global generation:  0.02903604507446289
r_  generation:  0.23283147811889648
local_output_nid generation:  0.013000249862670898
local_in_edges_tensor generation:  0.017104387283325195
mini_batch_src_global generation:  0.03072667121887207
r_  generation:  0.2424297332763672
local_output_nid generation:  0.012864351272583008
local_in_edges_tensor generation:  0.01525568962097168
mini_batch_src_global generation:  0.02932429313659668
r_  generation:  0.234511137008667
local_output_nid generation:  0.014536619186401367
local_in_edges_tensor generation:  0.013474225997924805
mini_batch_src_global generation:  0.03081965446472168
r_  generation:  0.23428058624267578
local_output_nid generation:  0.013037919998168945
local_in_edges_tensor generation:  0.017748594284057617
mini_batch_src_global generation:  0.029361248016357422
r_  generation:  0.24212431907653809
local_output_nid generation:  0.012971639633178711
local_in_edges_tensor generation:  0.017869949340820312
mini_batch_src_global generation:  0.029384136199951172
r_  generation:  0.24187636375427246
local_output_nid generation:  0.012802600860595703
local_in_edges_tensor generation:  0.013367652893066406
mini_batch_src_global generation:  0.029145240783691406
r_  generation:  0.23442602157592773
local_output_nid generation:  0.01321101188659668
local_in_edges_tensor generation:  0.017305850982666016
mini_batch_src_global generation:  0.030878782272338867
r_  generation:  0.24551677703857422
----------------------check_connections_block total spend ----------------------------- 5.527623414993286
generate_one_block  0.319469690322876
generate_one_block  0.29450130462646484
generate_one_block  0.3092765808105469
generate_one_block  0.30549049377441406
generate_one_block  0.3171236515045166
generate_one_block  0.32413458824157715
generate_one_block  0.3763275146484375
generate_one_block  0.32186460494995117
generate_one_block  0.30404186248779297
generate_one_block  0.31253600120544434
generate_one_block  0.29567956924438477
generate_one_block  0.3021657466888428
generate_one_block  0.3127002716064453
generate_one_block  0.31437134742736816
generate_one_block  0.30024075508117676
generate_one_block  0.3129274845123291
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04631829261779785
gen group dst list time:  0.06972002983093262
time for parepare:  0.018032312393188477
local_output_nid generation:  0.026219606399536133
local_in_edges_tensor generation:  0.05331158638000488
mini_batch_src_global generation:  0.04170989990234375
r_  generation:  0.46012115478515625
local_output_nid generation:  0.03225898742675781
local_in_edges_tensor generation:  0.053292274475097656
mini_batch_src_global generation:  0.06253266334533691
r_  generation:  0.45619940757751465
local_output_nid generation:  0.03408455848693848
local_in_edges_tensor generation:  0.04572749137878418
mini_batch_src_global generation:  0.05151486396789551
r_  generation:  0.4645543098449707
local_output_nid generation:  0.03200078010559082
local_in_edges_tensor generation:  0.03651857376098633
mini_batch_src_global generation:  0.05217552185058594
r_  generation:  0.4597504138946533
local_output_nid generation:  0.03234362602233887
local_in_edges_tensor generation:  0.1041402816772461
mini_batch_src_global generation:  0.05159473419189453
r_  generation:  0.469480037689209
local_output_nid generation:  0.03179311752319336
local_in_edges_tensor generation:  0.03570270538330078
mini_batch_src_global generation:  0.0530390739440918
r_  generation:  0.47118568420410156
local_output_nid generation:  0.031556129455566406
local_in_edges_tensor generation:  0.031217575073242188
mini_batch_src_global generation:  0.05221986770629883
r_  generation:  0.4742865562438965
local_output_nid generation:  0.031978607177734375
local_in_edges_tensor generation:  0.03397512435913086
mini_batch_src_global generation:  0.0532224178314209
r_  generation:  0.4691426753997803
local_output_nid generation:  0.032822370529174805
local_in_edges_tensor generation:  0.037064313888549805
mini_batch_src_global generation:  0.05587339401245117
r_  generation:  0.49213695526123047
local_output_nid generation:  0.03481602668762207
local_in_edges_tensor generation:  0.047229766845703125
mini_batch_src_global generation:  0.053362369537353516
r_  generation:  0.4688382148742676
local_output_nid generation:  0.03265881538391113
local_in_edges_tensor generation:  0.034763336181640625
mini_batch_src_global generation:  0.05159878730773926
r_  generation:  0.46867823600769043
local_output_nid generation:  0.03249311447143555
local_in_edges_tensor generation:  0.03331327438354492
mini_batch_src_global generation:  0.05280447006225586
r_  generation:  0.47161149978637695
local_output_nid generation:  0.032637834548950195
local_in_edges_tensor generation:  0.03358864784240723
mini_batch_src_global generation:  0.05487060546875
r_  generation:  0.474719762802124
local_output_nid generation:  0.03286147117614746
local_in_edges_tensor generation:  0.03473401069641113
mini_batch_src_global generation:  0.05290079116821289
r_  generation:  0.47931623458862305
local_output_nid generation:  0.03256511688232422
local_in_edges_tensor generation:  0.032850027084350586
mini_batch_src_global generation:  0.05267333984375
r_  generation:  0.46906375885009766
local_output_nid generation:  0.03288912773132324
local_in_edges_tensor generation:  0.03865218162536621
mini_batch_src_global generation:  0.05271029472351074
r_  generation:  0.46997547149658203
----------------------check_connections_block total spend ----------------------------- 11.193168640136719
generate_one_block  0.5905203819274902
generate_one_block  0.5942249298095703
generate_one_block  0.5997817516326904
generate_one_block  0.591423749923706
generate_one_block  0.588404655456543
generate_one_block  0.5868422985076904
generate_one_block  0.5900471210479736
generate_one_block  0.5892031192779541
generate_one_block  0.6146905422210693
generate_one_block  0.6028532981872559
generate_one_block  0.5833156108856201
generate_one_block  0.5967004299163818
generate_one_block  0.5890634059906006
generate_one_block  0.5950911045074463
generate_one_block  0.57480788230896
generate_one_block  0.5950198173522949
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0799560546875 GB
    Memory Allocated: 0.11725616455078125  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

connection checking time:  16.720792055130005
block generation total time  14.504841566085815
average batch blocks generation time:  0.9065525978803635
block dataloader generation time/epoch 33.54155158996582
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0799560546875 GB
    Memory Allocated: 0.09272241592407227  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

torch.Size([155196, 128])
torch.Size([124790, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0819091796875 GB
    Memory Allocated: 0.45862674713134766  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0819091796875 GB
    Memory Allocated: 0.09244537353515625  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

torch.Size([154995, 128])
torch.Size([124384, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0819091796875 GB
    Memory Allocated: 0.45447778701782227  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0819091796875 GB
    Memory Allocated: 0.0927419662475586  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

torch.Size([155192, 128])
torch.Size([125252, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0819091796875 GB
    Memory Allocated: 0.4623374938964844  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0819091796875 GB
    Memory Allocated: 0.09261894226074219  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

torch.Size([154656, 128])
torch.Size([124353, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0819091796875 GB
    Memory Allocated: 0.4567251205444336  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0819091796875 GB
    Memory Allocated: 0.0926971435546875  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

torch.Size([155370, 128])
torch.Size([125291, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0819091796875 GB
    Memory Allocated: 0.46236085891723633  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0819091796875 GB
    Memory Allocated: 0.09250450134277344  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

torch.Size([155168, 128])
torch.Size([124584, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0819091796875 GB
    Memory Allocated: 0.45485925674438477  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0819091796875 GB
    Memory Allocated: 0.09279537200927734  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

torch.Size([154970, 128])
torch.Size([124766, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0819091796875 GB
    Memory Allocated: 0.460115909576416  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0819091796875 GB
    Memory Allocated: 0.09264278411865234  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

torch.Size([155223, 128])
torch.Size([124760, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0819091796875 GB
    Memory Allocated: 0.45839786529541016  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0819091796875 GB
    Memory Allocated: 0.09247493743896484  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

torch.Size([154970, 128])
torch.Size([124398, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0819091796875 GB
    Memory Allocated: 0.45452117919921875  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0819091796875 GB
    Memory Allocated: 0.09277629852294922  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

torch.Size([154699, 128])
torch.Size([124936, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0819091796875 GB
    Memory Allocated: 0.4632277488708496  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0819091796875 GB
    Memory Allocated: 0.09249114990234375  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

torch.Size([155255, 128])
torch.Size([124786, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0819091796875 GB
    Memory Allocated: 0.4556717872619629  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0819091796875 GB
    Memory Allocated: 0.09253501892089844  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

torch.Size([155238, 128])
torch.Size([124742, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0819091796875 GB
    Memory Allocated: 0.4558258056640625  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0819091796875 GB
    Memory Allocated: 0.0926980972290039  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

torch.Size([154988, 128])
torch.Size([124862, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0819091796875 GB
    Memory Allocated: 0.4584164619445801  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0819091796875 GB
    Memory Allocated: 0.09273433685302734  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

torch.Size([155508, 128])
torch.Size([125389, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0819091796875 GB
    Memory Allocated: 0.4627804756164551  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0819091796875 GB
    Memory Allocated: 0.09249591827392578  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

torch.Size([155244, 128])
torch.Size([124437, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0819091796875 GB
    Memory Allocated: 0.45422983169555664  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0819091796875 GB
    Memory Allocated: 0.09277534484863281  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

torch.Size([155194, 128])
torch.Size([125405, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0819091796875 GB
    Memory Allocated: 0.4637622833251953  GigaBytes
Max Memory Allocated: 0.5079813003540039  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03998076915740967 |0.013243570923805237 |0.0036618411540985107 |9.37730073928833e-05 |0.0036512911319732666 |0.0028836727142333984 |
----------------------------------------------------------pseudo_mini_loss sum 3.580899715423584
Total (block generation + training)time/epoch 34.549426317214966
Training time/epoch 1.0075898170471191
Training time without block to device /epoch 0.7956926822662354
Training time without total dataloading part /epoch 0.12139415740966797
load block tensor time/epoch 0.6396923065185547
block to device time/epoch 0.2118971347808838
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5208993
Number of first layer input nodes during this epoch:  2481866
